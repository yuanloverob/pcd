{
  "cve_id": "CVE-2015-8364",
  "cve_desc": "Integer overflow in the ff_ivi_init_planes function in libavcodec/ivi.c in FFmpeg before 2.6.5, 2.7.x before 2.7.3, and 2.8.x through 2.8.2 allows remote attackers to cause a denial of service (out-of-bounds heap-memory access) or possibly have unspecified other impact via crafted image dimensions in Indeo Video Interactive data.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "df91aa034b82b77a3c4e01791f4a2b2ff6c82066",
  "patch_info": {
    "commit_hash": "df91aa034b82b77a3c4e01791f4a2b2ff6c82066",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/df91aa034b82b77a3c4e01791f4a2b2ff6c82066",
    "files": [
      "libavcodec/ivi.c"
    ],
    "message": "avcodec/ivi: Check image dimensions\n\nFixes integer overflow\nFixes: 1e32c6c591d940337c20b197ec1c4d3d/asan_heap-oob_4a52e5_8946_0bb0d9e863def56005e49f1d89bdc94d.avi\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "before_after_code_files": [
      "libavcodec/ivi.c||libavcodec/ivi.c"
    ]
  },
  "patch_diff": {
    "libavcodec/ivi.c||libavcodec/ivi.c": [
      "File: libavcodec/ivi.c -> libavcodec/ivi.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "31: #define BITSTREAM_READER_LE",
      "32: #include \"libavutil/attributes.h\"",
      "33: #include \"libavutil/timer.h\"",
      "34: #include \"avcodec.h\"",
      "35: #include \"get_bits.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "33: #include \"libavutil/imgutils.h\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "311:     ivi_free_buffers(planes);",
      "314:         cfg->luma_bands < 1 || cfg->chroma_bands < 1)",
      "315:         return AVERROR_INVALIDDATA;",
      "",
      "[Removed Lines]",
      "313:     if (cfg->pic_width < 1 || cfg->pic_height < 1 ||",
      "",
      "[Added Lines]",
      "314:     if (av_image_check_size(cfg->pic_width, cfg->pic_height, 0, NULL) < 0 ||",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c00d40095bf2039b028fbe2a65e05ee33a12ca81",
      "candidate_info": {
        "commit_hash": "c00d40095bf2039b028fbe2a65e05ee33a12ca81",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/c00d40095bf2039b028fbe2a65e05ee33a12ca81",
        "files": [
          "libavcodec/ivi_common.c"
        ],
        "message": "avcodec/ivi: Check image dimensions\n\nFixes integer overflow\nFixes: 1e32c6c591d940337c20b197ec1c4d3d/asan_heap-oob_4a52e5_8946_0bb0d9e863def56005e49f1d89bdc94d.avi\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit df91aa034b82b77a3c4e01791f4a2b2ff6c82066)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/ivi_common.c||libavcodec/ivi_common.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "libavcodec/ivi_common.c||libavcodec/ivi_common.c": [
          "File: libavcodec/ivi_common.c -> libavcodec/ivi_common.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: #define BITSTREAM_READER_LE",
          "32: #include \"libavutil/attributes.h\"",
          "33: #include \"libavutil/timer.h\"",
          "34: #include \"avcodec.h\"",
          "35: #include \"get_bits.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33: #include \"libavutil/imgutils.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "311:     ivi_free_buffers(planes);",
          "314:         cfg->luma_bands < 1 || cfg->chroma_bands < 1)",
          "315:         return AVERROR_INVALIDDATA;",
          "",
          "[Removed Lines]",
          "313:     if (cfg->pic_width < 1 || cfg->pic_height < 1 ||",
          "",
          "[Added Lines]",
          "314:     if (av_image_check_size(cfg->pic_width, cfg->pic_height, 0, NULL) < 0 ||",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ffaea7a790778ec4f23a22bbb445b77471dbddb1",
      "candidate_info": {
        "commit_hash": "ffaea7a790778ec4f23a22bbb445b77471dbddb1",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/ffaea7a790778ec4f23a22bbb445b77471dbddb1",
        "files": [
          "libavcodec/ivi_common.c"
        ],
        "message": "avcodec/ivi: Check image dimensions\n\nFixes integer overflow\nFixes: 1e32c6c591d940337c20b197ec1c4d3d/asan_heap-oob_4a52e5_8946_0bb0d9e863def56005e49f1d89bdc94d.avi\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit df91aa034b82b77a3c4e01791f4a2b2ff6c82066)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/ivi_common.c||libavcodec/ivi_common.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "libavcodec/ivi_common.c||libavcodec/ivi_common.c": [
          "File: libavcodec/ivi_common.c -> libavcodec/ivi_common.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: #define BITSTREAM_READER_LE",
          "32: #include \"libavutil/attributes.h\"",
          "33: #include \"libavutil/timer.h\"",
          "34: #include \"avcodec.h\"",
          "35: #include \"get_bits.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33: #include \"libavutil/imgutils.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "311:     ivi_free_buffers(planes);",
          "314:         cfg->luma_bands < 1 || cfg->chroma_bands < 1)",
          "315:         return AVERROR_INVALIDDATA;",
          "",
          "[Removed Lines]",
          "313:     if (cfg->pic_width < 1 || cfg->pic_height < 1 ||",
          "",
          "[Added Lines]",
          "314:     if (av_image_check_size(cfg->pic_width, cfg->pic_height, 0, NULL) < 0 ||",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b996cde19323756e647f3aa9c67c4ff2efe3a32d",
      "candidate_info": {
        "commit_hash": "b996cde19323756e647f3aa9c67c4ff2efe3a32d",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/b996cde19323756e647f3aa9c67c4ff2efe3a32d",
        "files": [
          "libavcodec/ivi.c"
        ],
        "message": "avcodec/ivi: Check image dimensions\n\nFixes integer overflow\nFixes: 1e32c6c591d940337c20b197ec1c4d3d/asan_heap-oob_4a52e5_8946_0bb0d9e863def56005e49f1d89bdc94d.avi\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit df91aa034b82b77a3c4e01791f4a2b2ff6c82066)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/ivi.c||libavcodec/ivi.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/ivi.c||libavcodec/ivi.c"
          ],
          "candidate": [
            "libavcodec/ivi.c||libavcodec/ivi.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/ivi.c||libavcodec/ivi.c": [
          "File: libavcodec/ivi.c -> libavcodec/ivi.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: #define BITSTREAM_READER_LE",
          "32: #include \"libavutil/attributes.h\"",
          "33: #include \"libavutil/timer.h\"",
          "34: #include \"avcodec.h\"",
          "35: #include \"get_bits.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33: #include \"libavutil/imgutils.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "311:     ivi_free_buffers(planes);",
          "314:         cfg->luma_bands < 1 || cfg->chroma_bands < 1)",
          "315:         return AVERROR_INVALIDDATA;",
          "",
          "[Removed Lines]",
          "313:     if (cfg->pic_width < 1 || cfg->pic_height < 1 ||",
          "",
          "[Added Lines]",
          "314:     if (av_image_check_size(cfg->pic_width, cfg->pic_height, 0, NULL) < 0 ||",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f64ffbbdc0cc35fa3a478a8e6ca8b2342240bd02",
      "candidate_info": {
        "commit_hash": "f64ffbbdc0cc35fa3a478a8e6ca8b2342240bd02",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/f64ffbbdc0cc35fa3a478a8e6ca8b2342240bd02",
        "files": [
          "libavcodec/ivi.c"
        ],
        "message": "avcodec/ivi: Check image dimensions\n\nFixes integer overflow\nFixes: 1e32c6c591d940337c20b197ec1c4d3d/asan_heap-oob_4a52e5_8946_0bb0d9e863def56005e49f1d89bdc94d.avi\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit df91aa034b82b77a3c4e01791f4a2b2ff6c82066)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/ivi.c||libavcodec/ivi.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/ivi.c||libavcodec/ivi.c"
          ],
          "candidate": [
            "libavcodec/ivi.c||libavcodec/ivi.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/ivi.c||libavcodec/ivi.c": [
          "File: libavcodec/ivi.c -> libavcodec/ivi.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: #define BITSTREAM_READER_LE",
          "32: #include \"libavutil/attributes.h\"",
          "33: #include \"libavutil/timer.h\"",
          "34: #include \"avcodec.h\"",
          "35: #include \"get_bits.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33: #include \"libavutil/imgutils.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "311:     ivi_free_buffers(planes);",
          "314:         cfg->luma_bands < 1 || cfg->chroma_bands < 1)",
          "315:         return AVERROR_INVALIDDATA;",
          "",
          "[Removed Lines]",
          "313:     if (cfg->pic_width < 1 || cfg->pic_height < 1 ||",
          "",
          "[Added Lines]",
          "314:     if (av_image_check_size(cfg->pic_width, cfg->pic_height, 0, NULL) < 0 ||",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f68ff799eb00ec7f38e983c7fbe60c7ff948e401",
      "candidate_info": {
        "commit_hash": "f68ff799eb00ec7f38e983c7fbe60c7ff948e401",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/f68ff799eb00ec7f38e983c7fbe60c7ff948e401",
        "files": [
          "libavcodec/ivi_common.c"
        ],
        "message": "avcodec/ivi: Check image dimensions\n\nFixes integer overflow\nFixes: 1e32c6c591d940337c20b197ec1c4d3d/asan_heap-oob_4a52e5_8946_0bb0d9e863def56005e49f1d89bdc94d.avi\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit df91aa034b82b77a3c4e01791f4a2b2ff6c82066)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/ivi_common.c||libavcodec/ivi_common.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "libavcodec/ivi_common.c||libavcodec/ivi_common.c": [
          "File: libavcodec/ivi_common.c -> libavcodec/ivi_common.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: #define BITSTREAM_READER_LE",
          "32: #include \"libavutil/attributes.h\"",
          "33: #include \"libavutil/timer.h\"",
          "34: #include \"avcodec.h\"",
          "35: #include \"get_bits.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33: #include \"libavutil/imgutils.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "311:     ivi_free_buffers(planes);",
          "314:         cfg->luma_bands < 1 || cfg->chroma_bands < 1)",
          "315:         return AVERROR_INVALIDDATA;",
          "",
          "[Removed Lines]",
          "313:     if (cfg->pic_width < 1 || cfg->pic_height < 1 ||",
          "",
          "[Added Lines]",
          "314:     if (av_image_check_size(cfg->pic_width, cfg->pic_height, 0, NULL) < 0 ||",
          "",
          "---------------"
        ]
      }
    }
  ]
}