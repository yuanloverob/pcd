{
  "cve_id": "CVE-2017-3735",
  "cve_desc": "While parsing an IPAddressFamily extension in an X.509 certificate, it is possible to do a one-byte overread. This would result in an incorrect text display of the certificate. This bug has been present since 2006 and is present in all versions of OpenSSL before 1.0.2m and 1.1.0g.",
  "repo": "openssl/openssl",
  "patch_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
  "patch_info": {
    "commit_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/068b963bb7afc57f5bdd723de0dd15e7795d5822",
    "files": [
      "crypto/x509v3/v3_addr.c"
    ],
    "message": "Avoid out-of-bounds read\n\nFixes CVE 2017-3735\n\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\n(Merged from https://github.com/openssl/openssl/pull/4276)\n\n(cherry picked from commit b23171744b01e473ebbfd6edad70c1c3825ffbcd)",
    "before_after_code_files": [
      "crypto/x509v3/v3_addr.c||crypto/x509v3/v3_addr.c"
    ]
  },
  "patch_diff": {
    "crypto/x509v3/v3_addr.c||crypto/x509v3/v3_addr.c": [
      "File: crypto/x509v3/v3_addr.c -> crypto/x509v3/v3_addr.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "85: unsigned int X509v3_addr_get_afi(const IPAddressFamily *f)",
      "86: {",
      "91: }",
      "",
      "[Removed Lines]",
      "87:     return ((f != NULL &&",
      "88:              f->addressFamily != NULL && f->addressFamily->data != NULL)",
      "89:             ? ((f->addressFamily->data[0] << 8) | (f->addressFamily->data[1]))",
      "90:             : 0);",
      "",
      "[Added Lines]",
      "87:     if (f == NULL",
      "88:             || f->addressFamily == NULL",
      "89:             || f->addressFamily->data == NULL",
      "90:             || f->addressFamily->length < 2)",
      "91:         return 0;",
      "92:     return (f->addressFamily->data[0] << 8) | f->addressFamily->data[1];",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "df50dee414366bd609b1eadae8a0748e13a7226e",
      "candidate_info": {
        "commit_hash": "df50dee414366bd609b1eadae8a0748e13a7226e",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/df50dee414366bd609b1eadae8a0748e13a7226e",
        "files": [
          "include/openssl/e_os2.h"
        ],
        "message": "Cygwin is POSIX, don't say it isn't\n\nMore to the point, Cygwin is a POSIX API.  In our library, the use of\na POSIX API is marked by defining the macro OPENSSL_SYS_UNIX.\nTherefore, that macro shouldn't be undefined when building for Cygwin.\n\nReviewed-by: Andy Polyakov <appro@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/5060)\n\n(cherry picked from commit 33cebb9c0dd6115bc357b5097f7db82b64b10919)",
        "before_after_code_files": [
          "include/openssl/e_os2.h||include/openssl/e_os2.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/openssl/e_os2.h||include/openssl/e_os2.h": [
          "File: include/openssl/e_os2.h -> include/openssl/e_os2.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "49: #  define OPENSSL_SYS_WIN32_UWIN",
          "50: # else",
          "51: #  if defined(__CYGWIN__) || defined(OPENSSL_SYS_CYGWIN)",
          "53: #   define OPENSSL_SYS_WIN32_CYGWIN",
          "54: #  else",
          "55: #   if defined(_WIN32) || defined(OPENSSL_SYS_WIN32)",
          "",
          "[Removed Lines]",
          "52: #   undef OPENSSL_SYS_UNIX",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c7f6ec9e5afc575df260c21ba77cf3a45a8b9b39",
      "candidate_info": {
        "commit_hash": "c7f6ec9e5afc575df260c21ba77cf3a45a8b9b39",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/c7f6ec9e5afc575df260c21ba77cf3a45a8b9b39",
        "files": [
          "test/run_tests.pl"
        ],
        "message": "test/run_tests.pl: don't mask test failures.\n\nSwitch to TAP::Harness inadvertently masked test failures.\nTest::Harness::runtests was terminating with non-zero exit code in case\nof failure[s], while TAP::Harness apparently holds caller responsible\nfor doing so.\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\nReviewed-by: Richard Levitte <levitte@openssl.org>",
        "before_after_code_files": [
          "test/run_tests.pl||test/run_tests.pl"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/run_tests.pl||test/run_tests.pl": [
          "File: test/run_tests.pl -> test/run_tests.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "62:     @tests = map { abs2rel($_, rel2abs(curdir())); } @tests;",
          "64:     my $harness = $TAP_Harness->new(\\%tapargs);",
          "66: }",
          "",
          "[Removed Lines]",
          "65:     $harness->runtests(sort @tests);",
          "",
          "[Added Lines]",
          "65:     my $ret = $harness->runtests(sort @tests);",
          "67:     exit $ret->has_errors if (ref($ret) eq \"TAP::Parser::Aggregator\");",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "bfb10f970f792bf4a13fc6244b8752e70589b9c6",
      "candidate_info": {
        "commit_hash": "bfb10f970f792bf4a13fc6244b8752e70589b9c6",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/bfb10f970f792bf4a13fc6244b8752e70589b9c6",
        "files": [
          "crypto/ocsp/ocsp_vfy.c",
          "test/ocsp-tests/ND1_Cross_Root.pem",
          "test/ocsp-tests/ND1_Issuer_ICA-Cross.pem",
          "test/recipes/80-test_ocsp.t"
        ],
        "message": "Fix OCSP_basic_verify() cert chain construction in case bs->certs is NULL\n\nNow the certs arg is not any more neglected when building the signer cert chain.\nAdded case to test/recipes/80-test_ocsp.t proving fix for 3-level CA hierarchy.\n\nSee also http://rt.openssl.org/Ticket/Display.html?id=4620\n\nReviewed-by: Matt Caswell <matt@openssl.org>\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/4124)\n\n(cherry picked from commit 121738d1cbfffa704eef4073510f13b419e6f08d)",
        "before_after_code_files": [
          "crypto/ocsp/ocsp_vfy.c||crypto/ocsp/ocsp_vfy.c",
          "test/ocsp-tests/ND1_Cross_Root.pem||test/ocsp-tests/ND1_Cross_Root.pem",
          "test/ocsp-tests/ND1_Issuer_ICA-Cross.pem||test/ocsp-tests/ND1_Issuer_ICA-Cross.pem",
          "test/recipes/80-test_ocsp.t||test/recipes/80-test_ocsp.t"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/ocsp/ocsp_vfy.c||crypto/ocsp/ocsp_vfy.c": [
          "File: crypto/ocsp/ocsp_vfy.c -> crypto/ocsp/ocsp_vfy.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "73:                     goto f_err;",
          "74:                 }",
          "75:             }",
          "76:         } else {",
          "77:             untrusted = bs->certs;",
          "78:         }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "76:         } else if (certs != NULL) {",
          "77:             untrusted = certs;",
          "",
          "---------------"
        ],
        "test/ocsp-tests/ND1_Cross_Root.pem||test/ocsp-tests/ND1_Cross_Root.pem": [
          "File: test/ocsp-tests/ND1_Cross_Root.pem -> test/ocsp-tests/ND1_Cross_Root.pem",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: -----BEGIN CERTIFICATE-----",
          "2: MIIENjCCAx6gAwIBAgIBATANBgkqhkiG9w0BAQUFADBvMQswCQYDVQQGEwJTRTEU",
          "3: MBIGA1UEChMLQWRkVHJ1c3QgQUIxJjAkBgNVBAsTHUFkZFRydXN0IEV4dGVybmFs",
          "4: IFRUUCBOZXR3b3JrMSIwIAYDVQQDExlBZGRUcnVzdCBFeHRlcm5hbCBDQSBSb290",
          "5: MB4XDTAwMDUzMDEwNDgzOFoXDTIwMDUzMDEwNDgzOFowbzELMAkGA1UEBhMCU0Ux",
          "6: FDASBgNVBAoTC0FkZFRydXN0IEFCMSYwJAYDVQQLEx1BZGRUcnVzdCBFeHRlcm5h",
          "7: bCBUVFAgTmV0d29yazEiMCAGA1UEAxMZQWRkVHJ1c3QgRXh0ZXJuYWwgQ0EgUm9v",
          "8: dDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALf3GjPm8gAELTngTlvt",
          "9: H7xsD821+iO2zt6bETOXpClMfZOfvUq8k+0DGuOPz+VtUFrWlymUWoCwSXrbLpX9",
          "10: uMq/NzgtHj6RQa1wVsfwTz/oMp50ysiQVOnGXw94nZpAPA6sYapeFI+eh6FqUNzX",
          "11: mk6vBbOmcZSccbNQYArHE504B4YCqOmoaSYYkKtMsE8jqzpPhNjfzp/haW+710LX",
          "12: a0Tkx63ubUFfclpxCDezeWWkWaCUN/cALw3CknLa0Dhy2xSoRcRdKn23tNbE7qzN",
          "13: E0S3ySvdQwAl+mG5aWpYIxG3pzOPVnVZ9c0p10a3CitlttNCbxWyuHv77+ldU9U0",
          "14: WicCAwEAAaOB3DCB2TAdBgNVHQ4EFgQUrb2YejS0Jvf6xCZU7wO94CTLVBowCwYD",
          "15: VR0PBAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wgZkGA1UdIwSBkTCBjoAUrb2YejS0",
          "16: Jvf6xCZU7wO94CTLVBqhc6RxMG8xCzAJBgNVBAYTAlNFMRQwEgYDVQQKEwtBZGRU",
          "17: cnVzdCBBQjEmMCQGA1UECxMdQWRkVHJ1c3QgRXh0ZXJuYWwgVFRQIE5ldHdvcmsx",
          "18: IjAgBgNVBAMTGUFkZFRydXN0IEV4dGVybmFsIENBIFJvb3SCAQEwDQYJKoZIhvcN",
          "19: AQEFBQADggEBALCb4IUlwtYj4g+WBpKdQZic2YR5gdkeWxQHIzZlj7DYd7usQWxH",
          "20: YINRsPkyPef89iYTx4AWpb9a/IfPeHmJIZriTAcKhjW88t5RxNKWt9x+Tu5w/Rw5",
          "21: 6wwCURQtjr0W4MHfRnXnJK3s9EK0hZNwEGe6nQY1ShjTK3rMUUKhemPR5ruhxSvC",
          "22: Nr4TDea9Y355e6cJDUCrat2PisP29owaQgVR1EX1n6diIWgVIEM8med8vSTYqZEX",
          "23: c4g/VhsxOBi0cQ+azcgOno4uG+GMmIPLHzHxREzGBHNJdmAPx/i9F4BrLunMTA5a",
          "24: mnkPIAou1Z5jJh5VkpTYghdae9C8x49OhgQ=",
          "25: -----END CERTIFICATE-----",
          "",
          "---------------"
        ],
        "test/ocsp-tests/ND1_Issuer_ICA-Cross.pem||test/ocsp-tests/ND1_Issuer_ICA-Cross.pem": [
          "File: test/ocsp-tests/ND1_Issuer_ICA-Cross.pem -> test/ocsp-tests/ND1_Issuer_ICA-Cross.pem",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: -----BEGIN CERTIFICATE-----",
          "2: MIIFBjCCA+6gAwIBAgIQEaO00OyNt3+doM1dLVEvQjANBgkqhkiG9w0BAQUFADCB",
          "3: gTELMAkGA1UEBhMCR0IxGzAZBgNVBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4G",
          "4: A1UEBxMHU2FsZm9yZDEaMBgGA1UEChMRQ09NT0RPIENBIExpbWl0ZWQxJzAlBgNV",
          "5: BAMTHkNPTU9ETyBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTAeFw0xMDA1MjQwMDAw",
          "6: MDBaFw0yMDA1MzAxMDQ4MzhaMIGOMQswCQYDVQQGEwJHQjEbMBkGA1UECBMSR3Jl",
          "7: YXRlciBNYW5jaGVzdGVyMRAwDgYDVQQHEwdTYWxmb3JkMRowGAYDVQQKExFDT01P",
          "8: RE8gQ0EgTGltaXRlZDE0MDIGA1UEAxMrQ09NT0RPIEV4dGVuZGVkIFZhbGlkYXRp",
          "9: b24gU2VjdXJlIFNlcnZlciBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC",
          "10: ggEBAMxKljPNJY1n7iiWN4dG8PYEooR/U6qW5h+xAhxu7X0h1Nc8HqLYaS+ot/Wi",
          "11: 7WRYZOFEZTZJQSABjTsT4gjzDPJXOZM3txyTRIOOvy3xoQV12m7ue28b6naDKHRK",
          "12: HCvT9cQDcpOvhs4JjDx11MkKL3Lzrb0OMDyEoXMfAyUUpY/D1vS15N2GevUZumjy",
          "13: hVSiMBHK0ZLLO3QGEqA3q2rYVBHfbJoWlLm0p2XGdC0x801S6VVRn8s+oo12mHDS",
          "14: b6ZlRS8bhbtbbfnywARmE4R6nc4n2PREnr+svpnba0/bWCGwiSe0jzLWS15ykV7f",
          "15: BZ3ZSS/0tm9QH3XLgJ3m0+TR8tMCAwEAAaOCAWkwggFlMB8GA1UdIwQYMBaAFAtY",
          "16: 5YvGTBU3pECpMKkhvkc2Wlb/MB0GA1UdDgQWBBSIRFH/UCppXi2I9CG62Qzyzsvq",
          "17: fDAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADA+BgNVHSAENzA1",
          "18: MDMGBFUdIAAwKzApBggrBgEFBQcCARYdaHR0cHM6Ly9zZWN1cmUuY29tb2RvLmNv",
          "19: bS9DUFMwSQYDVR0fBEIwQDA+oDygOoY4aHR0cDovL2NybC5jb21vZG9jYS5jb20v",
          "20: Q09NT0RPQ2VydGlmaWNhdGlvbkF1dGhvcml0eS5jcmwwdAYIKwYBBQUHAQEEaDBm",
          "21: MD4GCCsGAQUFBzAChjJodHRwOi8vY3J0LmNvbW9kb2NhLmNvbS9DT01PRE9BZGRU",
          "22: cnVzdFNlcnZlckNBLmNydDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuY29tb2Rv",
          "23: Y2EuY29tMA0GCSqGSIb3DQEBBQUAA4IBAQCaQ7+vpHJezX1vf/T8PYy7cOYe3QT9",
          "24: P9ydn7+JdpvyhjH8f7PtKpFTLOKqsOPILHH3FYojHPFpLoH7sbxiC6saVBzZIl40",
          "25: TKX2Iw9dej3bQ81pfhc3Us1TocIR1FN4J2TViUFNFlW7kMvw2OTd3dMJZEgo/zIj",
          "26: hC+Me1UvzymINzR4DzOq/7fylqSbRIC1vmxWVKukgZ4lGChUOn8sY89ZIIwYazgs",
          "27: tN3t40DeDDYlV5rA0WCeXgNol64aO+pF11GZSe5EWVYLXrGPaOqKnsrSyaADfnAl",
          "28: 9DLJTlCDh6I0SD1PNXf82Ijq9n0ezkO21cJqfjhmY03n7jLvDyToKmf6",
          "29: -----END CERTIFICATE-----",
          "30: -----BEGIN CERTIFICATE-----",
          "31: MIIE8TCCA9mgAwIBAgIQbyXcFa/fXqMIVgw7ek/H+DANBgkqhkiG9w0BAQUFADBv",
          "32: MQswCQYDVQQGEwJTRTEUMBIGA1UEChMLQWRkVHJ1c3QgQUIxJjAkBgNVBAsTHUFk",
          "33: ZFRydXN0IEV4dGVybmFsIFRUUCBOZXR3b3JrMSIwIAYDVQQDExlBZGRUcnVzdCBF",
          "34: eHRlcm5hbCBDQSBSb290MB4XDTAwMDUzMDEwNDgzOFoXDTIwMDUzMDEwNDgzOFow",
          "35: gYExCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO",
          "36: BgNVBAcTB1NhbGZvcmQxGjAYBgNVBAoTEUNPTU9ETyBDQSBMaW1pdGVkMScwJQYD",
          "37: VQQDEx5DT01PRE8gQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwggEiMA0GCSqGSIb3",
          "38: DQEBAQUAA4IBDwAwggEKAoIBAQDQQIuLcuORG/dRwRtUBJjTqb/B5opdO4f7u4jO",
          "39: DeMvPwaW8KIpUJmu2zuhV7B0UXHN7UKRTUH+qcjYaoZ3RLtZZpdQXrTULHBEz9o3",
          "40: lUJpPDDEcbNS8CFNodi6OXwcnqMknfKDFpiqFnxDmxVbt640kf7UYiYYRpo/68H5",
          "41: 8ZBX66x6DYvbcjBqZtXgRqNw3GjZ/wRIiXfeten7Z21B6bw5vTLZYgLxsag9bjec",
          "42: 4i/i06Imi8a4VUOI4SM+pdIkOWpHqwDUobOpJf4NP6cdutNRwQuk2qw471VQJAVl",
          "43: RpM0Ty2NrcbUIRnSjsoFYXEHc0flihkSvQRNzk6cpUisuyb3AgMBAAGjggF0MIIB",
          "44: cDAfBgNVHSMEGDAWgBStvZh6NLQm9/rEJlTvA73gJMtUGjAdBgNVHQ4EFgQUC1jl",
          "45: i8ZMFTekQKkwqSG+RzZaVv8wDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMB",
          "46: Af8wEQYDVR0gBAowCDAGBgRVHSAAMEQGA1UdHwQ9MDswOaA3oDWGM2h0dHA6Ly9j",
          "47: cmwudXNlcnRydXN0LmNvbS9BZGRUcnVzdEV4dGVybmFsQ0FSb290LmNybDCBswYI",
          "48: KwYBBQUHAQEEgaYwgaMwPwYIKwYBBQUHMAKGM2h0dHA6Ly9jcnQudXNlcnRydXN0",
          "49: LmNvbS9BZGRUcnVzdEV4dGVybmFsQ0FSb290LnA3YzA5BggrBgEFBQcwAoYtaHR0",
          "50: cDovL2NydC51c2VydHJ1c3QuY29tL0FkZFRydXN0VVROU0dDQ0EuY3J0MCUGCCsG",
          "51: AQUFBzABhhlodHRwOi8vb2NzcC51c2VydHJ1c3QuY29tMA0GCSqGSIb3DQEBBQUA",
          "52: A4IBAQAHYJOZqs7Q00fQNzPeP2S35S6jJQzVMx0Njav2fkZ7WQaS44LE5/X289kF",
          "53: z0k0LTdf9CXH8PtrI3fx8UDXTLtJRTHdAChntylMdagfeTHJNjcPyjVPjPF+3vxG",
          "54: q79om3AjMC63xVx7ivsYE3lLkkKM3CyrbCK3KFOzGkrOG/soDrc6pNoN90AyT99v",
          "55: uwFQ/IfTdtn8+7aEA8rJNhj33Wzbu7qBHKat/ij5z7micV0ZBepKRtxzQe+JlEKx",
          "56: Q4hvNRevHmCDrHqMEHufyfaDbZ76iO4+3e6esL/garnQnweyCROa9aTlyFt5p0c1",
          "57: M2jlVZ6qW8swC53HD79oRIGXi1FK",
          "58: -----END CERTIFICATE-----",
          "",
          "---------------"
        ],
        "test/recipes/80-test_ocsp.t||test/recipes/80-test_ocsp.t": [
          "File: test/recipes/80-test_ocsp.t -> test/recipes/80-test_ocsp.t",
          "--- Hunk 1 ---",
          "[Context before]",
          "29:     my $title = shift;",
          "30:     my $inputfile = shift;",
          "31:     my $CAfile = shift;",
          "32:     my $expected_exit = shift;",
          "34:     run(app([\"openssl\", \"base64\", \"-d\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32:     my $untrusted = shift;",
          "33:     if ($untrusted eq \"\") {",
          "34:         $untrusted = $CAfile;",
          "35:     }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "38:          sub { ok(run(app([\"openssl\", \"ocsp\", \"-respin\", \"ocsp-resp-fff.dat\",",
          "39:                            \"-partial_chain\", @check_time,",
          "40:                            \"-CAfile\", catfile($ocspdir, $CAfile),",
          "42:                            \"-no-CApath\"])),",
          "43:                   $title); });",
          "44:     unlink \"ocsp-resp-fff.dat\";",
          "",
          "[Removed Lines]",
          "41:                            \"-verify_other\", catfile($ocspdir, $CAfile),",
          "",
          "[Added Lines]",
          "45:                            \"-verify_other\", catfile($ocspdir, $untrusted),",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "47: plan tests => 10;",
          "49: subtest \"=== VALID OCSP RESPONSES ===\" => sub {",
          "52:     test_ocsp(\"NON-DELEGATED; Intermediate CA -> EE\",",
          "54:     test_ocsp(\"NON-DELEGATED; Root CA -> Intermediate CA\",",
          "56:     test_ocsp(\"NON-DELEGATED; Root CA -> EE\",",
          "58:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "60:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "62:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "64: };",
          "66: subtest \"=== INVALID SIGNATURE on the OCSP RESPONSE ===\" => sub {",
          "67:     plan tests => 6;",
          "69:     test_ocsp(\"NON-DELEGATED; Intermediate CA -> EE\",",
          "71:     test_ocsp(\"NON-DELEGATED; Root CA -> Intermediate CA\",",
          "73:     test_ocsp(\"NON-DELEGATED; Root CA -> EE\",",
          "75:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "77:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "79:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "81: };",
          "83: subtest \"=== WRONG RESPONDERID in the OCSP RESPONSE ===\" => sub {",
          "84:     plan tests => 6;",
          "86:     test_ocsp(\"NON-DELEGATED; Intermediate CA -> EE\",",
          "88:     test_ocsp(\"NON-DELEGATED; Root CA -> Intermediate CA\",",
          "90:     test_ocsp(\"NON-DELEGATED; Root CA -> EE\",",
          "92:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "94:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "96:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "98: };",
          "100: subtest \"=== WRONG ISSUERNAMEHASH in the OCSP RESPONSE ===\" => sub {",
          "101:     plan tests => 6;",
          "103:     test_ocsp(\"NON-DELEGATED; Intermediate CA -> EE\",",
          "105:     test_ocsp(\"NON-DELEGATED; Root CA -> Intermediate CA\",",
          "107:     test_ocsp(\"NON-DELEGATED; Root CA -> EE\",",
          "109:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "111:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "113:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "115: };",
          "117: subtest \"=== WRONG ISSUERKEYHASH in the OCSP RESPONSE ===\" => sub {",
          "118:     plan tests => 6;",
          "120:     test_ocsp(\"NON-DELEGATED; Intermediate CA -> EE\",",
          "122:     test_ocsp(\"NON-DELEGATED; Root CA -> Intermediate CA\",",
          "124:     test_ocsp(\"NON-DELEGATED; Root CA -> EE\",",
          "126:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "128:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "130:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "132: };",
          "134: subtest \"=== WRONG KEY in the DELEGATED OCSP SIGNING CERTIFICATE ===\" => sub {",
          "135:     plan tests => 3;",
          "137:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "139:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "141:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "143: };",
          "145: subtest \"=== INVALID SIGNATURE on the DELEGATED OCSP SIGNING CERTIFICATE ===\" => sub {",
          "146:     plan tests => 3;",
          "148:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "150:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "152:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "154: };",
          "156: subtest \"=== WRONG SUBJECT NAME in the ISSUER CERTIFICATE ===\" => sub {",
          "157:     plan tests => 6;",
          "159:     test_ocsp(\"NON-DELEGATED; Intermediate CA -> EE\",",
          "161:     test_ocsp(\"NON-DELEGATED; Root CA -> Intermediate CA\",",
          "163:     test_ocsp(\"NON-DELEGATED; Root CA -> EE\",",
          "165:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "167:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "169:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "171: };",
          "173: subtest \"=== WRONG KEY in the ISSUER CERTIFICATE ===\" => sub {",
          "174:     plan tests => 6;",
          "176:     test_ocsp(\"NON-DELEGATED; Intermediate CA -> EE\",",
          "178:     test_ocsp(\"NON-DELEGATED; Root CA -> Intermediate CA\",",
          "180:     test_ocsp(\"NON-DELEGATED; Root CA -> EE\",",
          "182:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "184:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "186:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "188: };",
          "190: subtest \"=== INVALID SIGNATURE on the ISSUER CERTIFICATE ===\" => sub {",
          "",
          "[Removed Lines]",
          "50:     plan tests => 6;",
          "53:        \"ND1.ors\", \"ND1_Issuer_ICA.pem\", 0);",
          "55:        \"ND2.ors\", \"ND2_Issuer_Root.pem\", 0);",
          "57:        \"ND3.ors\", \"ND3_Issuer_Root.pem\", 0);",
          "59:        \"D1.ors\", \"D1_Issuer_ICA.pem\", 0);",
          "61:        \"D2.ors\", \"D2_Issuer_Root.pem\", 0);",
          "63:        \"D3.ors\", \"D3_Issuer_Root.pem\", 0);",
          "70:        \"ISOP_ND1.ors\", \"ND1_Issuer_ICA.pem\", 1);",
          "72:        \"ISOP_ND2.ors\", \"ND2_Issuer_Root.pem\", 1);",
          "74:        \"ISOP_ND3.ors\", \"ND3_Issuer_Root.pem\", 1);",
          "76:        \"ISOP_D1.ors\", \"D1_Issuer_ICA.pem\", 1);",
          "78:        \"ISOP_D2.ors\", \"D2_Issuer_Root.pem\", 1);",
          "80:        \"ISOP_D3.ors\", \"D3_Issuer_Root.pem\", 1);",
          "87:        \"WRID_ND1.ors\", \"ND1_Issuer_ICA.pem\", 1);",
          "89:        \"WRID_ND2.ors\", \"ND2_Issuer_Root.pem\", 1);",
          "91:        \"WRID_ND3.ors\", \"ND3_Issuer_Root.pem\", 1);",
          "93:        \"WRID_D1.ors\", \"D1_Issuer_ICA.pem\", 1);",
          "95:        \"WRID_D2.ors\", \"D2_Issuer_Root.pem\", 1);",
          "97:        \"WRID_D3.ors\", \"D3_Issuer_Root.pem\", 1);",
          "104:        \"WINH_ND1.ors\", \"ND1_Issuer_ICA.pem\", 1);",
          "106:        \"WINH_ND2.ors\", \"ND2_Issuer_Root.pem\", 1);",
          "108:        \"WINH_ND3.ors\", \"ND3_Issuer_Root.pem\", 1);",
          "110:        \"WINH_D1.ors\", \"D1_Issuer_ICA.pem\", 1);",
          "112:        \"WINH_D2.ors\", \"D2_Issuer_Root.pem\", 1);",
          "114:        \"WINH_D3.ors\", \"D3_Issuer_Root.pem\", 1);",
          "121:        \"WIKH_ND1.ors\", \"ND1_Issuer_ICA.pem\", 1);",
          "123:        \"WIKH_ND2.ors\", \"ND2_Issuer_Root.pem\", 1);",
          "125:        \"WIKH_ND3.ors\", \"ND3_Issuer_Root.pem\", 1);",
          "127:        \"WIKH_D1.ors\", \"D1_Issuer_ICA.pem\", 1);",
          "129:        \"WIKH_D2.ors\", \"D2_Issuer_Root.pem\", 1);",
          "131:        \"WIKH_D3.ors\", \"D3_Issuer_Root.pem\", 1);",
          "138:        \"WKDOSC_D1.ors\", \"D1_Issuer_ICA.pem\", 1);",
          "140:        \"WKDOSC_D2.ors\", \"D2_Issuer_Root.pem\", 1);",
          "142:        \"WKDOSC_D3.ors\", \"D3_Issuer_Root.pem\", 1);",
          "149:        \"ISDOSC_D1.ors\", \"D1_Issuer_ICA.pem\", 1);",
          "151:        \"ISDOSC_D2.ors\", \"D2_Issuer_Root.pem\", 1);",
          "153:        \"ISDOSC_D3.ors\", \"D3_Issuer_Root.pem\", 1);",
          "160:        \"ND1.ors\", \"WSNIC_ND1_Issuer_ICA.pem\", 1);",
          "162:        \"ND2.ors\", \"WSNIC_ND2_Issuer_Root.pem\", 1);",
          "164:        \"ND3.ors\", \"WSNIC_ND3_Issuer_Root.pem\", 1);",
          "166:        \"D1.ors\", \"WSNIC_D1_Issuer_ICA.pem\", 1);",
          "168:        \"D2.ors\", \"WSNIC_D2_Issuer_Root.pem\", 1);",
          "170:        \"D3.ors\", \"WSNIC_D3_Issuer_Root.pem\", 1);",
          "177:        \"ND1.ors\", \"WKIC_ND1_Issuer_ICA.pem\", 1);",
          "179:        \"ND2.ors\", \"WKIC_ND2_Issuer_Root.pem\", 1);",
          "181:        \"ND3.ors\", \"WKIC_ND3_Issuer_Root.pem\", 1);",
          "183:        \"D1.ors\", \"WKIC_D1_Issuer_ICA.pem\", 1);",
          "185:        \"D2.ors\", \"WKIC_D2_Issuer_Root.pem\", 1);",
          "187:        \"D3.ors\", \"WKIC_D3_Issuer_Root.pem\", 1);",
          "",
          "[Added Lines]",
          "54:     plan tests => 7;",
          "57:        \"ND1.ors\", \"ND1_Issuer_ICA.pem\", \"\", 0);",
          "59:        \"ND2.ors\", \"ND2_Issuer_Root.pem\", \"\", 0);",
          "61:        \"ND3.ors\", \"ND3_Issuer_Root.pem\", \"\", 0);",
          "62:     test_ocsp(\"NON-DELEGATED; 3-level CA hierarchy\",",
          "63:        \"ND1.ors\", \"ND1_Cross_Root.pem\", \"ND1_Issuer_ICA-Cross.pem\", 0);",
          "65:        \"D1.ors\", \"D1_Issuer_ICA.pem\", \"\", 0);",
          "67:        \"D2.ors\", \"D2_Issuer_Root.pem\", \"\", 0);",
          "69:        \"D3.ors\", \"D3_Issuer_Root.pem\", \"\", 0);",
          "76:        \"ISOP_ND1.ors\", \"ND1_Issuer_ICA.pem\", \"\", 1);",
          "78:        \"ISOP_ND2.ors\", \"ND2_Issuer_Root.pem\", \"\", 1);",
          "80:        \"ISOP_ND3.ors\", \"ND3_Issuer_Root.pem\", \"\", 1);",
          "82:        \"ISOP_D1.ors\", \"D1_Issuer_ICA.pem\", \"\", 1);",
          "84:        \"ISOP_D2.ors\", \"D2_Issuer_Root.pem\", \"\", 1);",
          "86:        \"ISOP_D3.ors\", \"D3_Issuer_Root.pem\", \"\", 1);",
          "93:        \"WRID_ND1.ors\", \"ND1_Issuer_ICA.pem\", \"\", 1);",
          "95:        \"WRID_ND2.ors\", \"ND2_Issuer_Root.pem\", \"\", 1);",
          "97:        \"WRID_ND3.ors\", \"ND3_Issuer_Root.pem\", \"\", 1);",
          "99:        \"WRID_D1.ors\", \"D1_Issuer_ICA.pem\", \"\", 1);",
          "101:        \"WRID_D2.ors\", \"D2_Issuer_Root.pem\", \"\", 1);",
          "103:        \"WRID_D3.ors\", \"D3_Issuer_Root.pem\", \"\", 1);",
          "110:        \"WINH_ND1.ors\", \"ND1_Issuer_ICA.pem\", \"\", 1);",
          "112:        \"WINH_ND2.ors\", \"ND2_Issuer_Root.pem\", \"\", 1);",
          "114:        \"WINH_ND3.ors\", \"ND3_Issuer_Root.pem\", \"\", 1);",
          "116:        \"WINH_D1.ors\", \"D1_Issuer_ICA.pem\", \"\", 1);",
          "118:        \"WINH_D2.ors\", \"D2_Issuer_Root.pem\", \"\", 1);",
          "120:        \"WINH_D3.ors\", \"D3_Issuer_Root.pem\", \"\", 1);",
          "127:        \"WIKH_ND1.ors\", \"ND1_Issuer_ICA.pem\", \"\", 1);",
          "129:        \"WIKH_ND2.ors\", \"ND2_Issuer_Root.pem\", \"\", 1);",
          "131:        \"WIKH_ND3.ors\", \"ND3_Issuer_Root.pem\", \"\", 1);",
          "133:        \"WIKH_D1.ors\", \"D1_Issuer_ICA.pem\", \"\", 1);",
          "135:        \"WIKH_D2.ors\", \"D2_Issuer_Root.pem\", \"\", 1);",
          "137:        \"WIKH_D3.ors\", \"D3_Issuer_Root.pem\", \"\", 1);",
          "144:        \"WKDOSC_D1.ors\", \"D1_Issuer_ICA.pem\", \"\", 1);",
          "146:        \"WKDOSC_D2.ors\", \"D2_Issuer_Root.pem\", \"\", 1);",
          "148:        \"WKDOSC_D3.ors\", \"D3_Issuer_Root.pem\", \"\", 1);",
          "155:        \"ISDOSC_D1.ors\", \"D1_Issuer_ICA.pem\", \"\", 1);",
          "157:        \"ISDOSC_D2.ors\", \"D2_Issuer_Root.pem\", \"\", 1);",
          "159:        \"ISDOSC_D3.ors\", \"D3_Issuer_Root.pem\", \"\", 1);",
          "166:        \"ND1.ors\", \"WSNIC_ND1_Issuer_ICA.pem\", \"\", 1);",
          "168:        \"ND2.ors\", \"WSNIC_ND2_Issuer_Root.pem\", \"\", 1);",
          "170:        \"ND3.ors\", \"WSNIC_ND3_Issuer_Root.pem\", \"\", 1);",
          "172:        \"D1.ors\", \"WSNIC_D1_Issuer_ICA.pem\", \"\", 1);",
          "174:        \"D2.ors\", \"WSNIC_D2_Issuer_Root.pem\", \"\", 1);",
          "176:        \"D3.ors\", \"WSNIC_D3_Issuer_Root.pem\", \"\", 1);",
          "183:        \"ND1.ors\", \"WKIC_ND1_Issuer_ICA.pem\", \"\", 1);",
          "185:        \"ND2.ors\", \"WKIC_ND2_Issuer_Root.pem\", \"\", 1);",
          "187:        \"ND3.ors\", \"WKIC_ND3_Issuer_Root.pem\", \"\", 1);",
          "189:        \"D1.ors\", \"WKIC_D1_Issuer_ICA.pem\", \"\", 1);",
          "191:        \"D2.ors\", \"WKIC_D2_Issuer_Root.pem\", \"\", 1);",
          "193:        \"D3.ors\", \"WKIC_D3_Issuer_Root.pem\", \"\", 1);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "193:     # Expect success, because we're explicitly trusting the issuer certificate.",
          "194:     test_ocsp(\"NON-DELEGATED; Intermediate CA -> EE\",",
          "196:     test_ocsp(\"NON-DELEGATED; Root CA -> Intermediate CA\",",
          "198:     test_ocsp(\"NON-DELEGATED; Root CA -> EE\",",
          "200:     test_ocsp(\"DELEGATED; Intermediate CA -> EE\",",
          "202:     test_ocsp(\"DELEGATED; Root CA -> Intermediate CA\",",
          "204:     test_ocsp(\"DELEGATED; Root CA -> EE\",",
          "206: };",
          "",
          "[Removed Lines]",
          "195:        \"ND1.ors\", \"ISIC_ND1_Issuer_ICA.pem\", 0);",
          "197:        \"ND2.ors\", \"ISIC_ND2_Issuer_Root.pem\", 0);",
          "199:        \"ND3.ors\", \"ISIC_ND3_Issuer_Root.pem\", 0);",
          "201:        \"D1.ors\", \"ISIC_D1_Issuer_ICA.pem\", 0);",
          "203:        \"D2.ors\", \"ISIC_D2_Issuer_Root.pem\", 0);",
          "205:        \"D3.ors\", \"ISIC_D3_Issuer_Root.pem\", 0);",
          "",
          "[Added Lines]",
          "201:        \"ND1.ors\", \"ISIC_ND1_Issuer_ICA.pem\", \"\", 0);",
          "203:        \"ND2.ors\", \"ISIC_ND2_Issuer_Root.pem\", \"\", 0);",
          "205:        \"ND3.ors\", \"ISIC_ND3_Issuer_Root.pem\", \"\", 0);",
          "207:        \"D1.ors\", \"ISIC_D1_Issuer_ICA.pem\", \"\", 0);",
          "209:        \"D2.ors\", \"ISIC_D2_Issuer_Root.pem\", \"\", 0);",
          "211:        \"D3.ors\", \"ISIC_D3_Issuer_Root.pem\", \"\", 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b9ff4ec746daafe520e36c1489a2f843401ab140",
      "candidate_info": {
        "commit_hash": "b9ff4ec746daafe520e36c1489a2f843401ab140",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/b9ff4ec746daafe520e36c1489a2f843401ab140",
        "files": [
          "CHANGES",
          "NEWS",
          "README",
          "include/openssl/opensslv.h"
        ],
        "message": "Prepare for 1.1.0g-dev\n\nReviewed-by: Stephen Henson <steve@openssl.org>",
        "before_after_code_files": [
          "include/openssl/opensslv.h||include/openssl/opensslv.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/openssl/opensslv.h||include/openssl/opensslv.h": [
          "File: include/openssl/opensslv.h -> include/openssl/opensslv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "43: # ifdef OPENSSL_FIPS",
          "45: # else",
          "47: # endif",
          "",
          "[Removed Lines]",
          "42: # define OPENSSL_VERSION_NUMBER  0x1010006fL",
          "44: #  define OPENSSL_VERSION_TEXT    \"OpenSSL 1.1.0f-fips  25 May 2017\"",
          "46: #  define OPENSSL_VERSION_TEXT    \"OpenSSL 1.1.0f  25 May 2017\"",
          "",
          "[Added Lines]",
          "42: # define OPENSSL_VERSION_NUMBER  0x10100070L",
          "44: #  define OPENSSL_VERSION_TEXT    \"OpenSSL 1.1.0g-fips-dev  xx XXX xxxx\"",
          "46: #  define OPENSSL_VERSION_TEXT    \"OpenSSL 1.1.0g-dev  xx XXX xxxx\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4443cf7aa0099e5ce615c18cee249fff77fb0871",
      "candidate_info": {
        "commit_hash": "4443cf7aa0099e5ce615c18cee249fff77fb0871",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/4443cf7aa0099e5ce615c18cee249fff77fb0871",
        "files": [
          "crypto/bn/asm/x86_64-mont5.pl"
        ],
        "message": "bn/asm/x86_64-mont5.pl: fix carry bug in bn_sqrx8x_internal.\n\nCredit to OSS-Fuzz for finding this.\n\nCVE-2017-3736\n\nReviewed-by: Rich Salz <rsalz@openssl.org>",
        "before_after_code_files": [
          "crypto/bn/asm/x86_64-mont5.pl||crypto/bn/asm/x86_64-mont5.pl"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/bn/asm/x86_64-mont5.pl||crypto/bn/asm/x86_64-mont5.pl": [
          "File: crypto/bn/asm/x86_64-mont5.pl -> crypto/bn/asm/x86_64-mont5.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "3099:  .byte 0x67",
          "3100:  sbb %rax,%rax  # mov %cf,%rax",
          "3101:  xor %ebx,%ebx  # cf=0, of=0",
          "3103:  jmp .Lsqrx8x_loop",
          "3106: .Lsqrx8x_break:",
          "3107:  sub 16+8(%rsp),%r8  # consume last carry",
          "3108:  mov 24+8(%rsp),$carry # initial $tptr, borrow $carry",
          "3109:  mov 0*8($aptr),%rdx  # a[8], modulo-scheduled",
          "",
          "[Removed Lines]",
          "3102:  mov %rax,16+8(%rsp)  # offload carry",
          "3105: .align 32",
          "",
          "[Added Lines]",
          "3102:  mov %rax,16+8(%rsp)  # offload carry",
          "3103:  jmp .Lsqrx8x_loop",
          "3106: .Lsqrx8x_break:",
          "3108:  sub 16+8(%rsp),%rbx  # mov 16(%rsp),%cf",
          "3110:  mov 24+8(%rsp),$carry # initial $tptr, borrow $carry",
          "3111:  adcx $zero,%r9",
          "3112:  mov 0*8($aptr),%rdx  # a[8], modulo-scheduled",
          "3113:  adc \\$0,%r10",
          "3114:  mov %r8,0*8($tptr)",
          "",
          "---------------"
        ]
      }
    }
  ]
}