{
  "cve_id": "CVE-2014-3710",
  "cve_desc": "The donote function in readelf.c in file through 5.20, as used in the Fileinfo component in PHP 5.4.34, does not ensure that sufficient note headers are present, which allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted ELF file.",
  "repo": "php/php-src",
  "patch_hash": "1803228597e82218a8c105e67975bc50e6f5bf0d",
  "patch_info": {
    "commit_hash": "1803228597e82218a8c105e67975bc50e6f5bf0d",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/1803228597e82218a8c105e67975bc50e6f5bf0d",
    "files": [
      "ext/fileinfo/libmagic/readelf.c"
    ],
    "message": "Fix bug #68283: fileinfo: out-of-bounds read in elf note headers\n\nUpstream commit\nhttps://github.com/file/file/commit/39c7ac1106be844a5296d3eb5971946cc09ffda0\n\nCVE -2014-3710",
    "before_after_code_files": [
      "ext/fileinfo/libmagic/readelf.c||ext/fileinfo/libmagic/readelf.c"
    ]
  },
  "patch_diff": {
    "ext/fileinfo/libmagic/readelf.c||ext/fileinfo/libmagic/readelf.c": [
      "File: ext/fileinfo/libmagic/readelf.c -> ext/fileinfo/libmagic/readelf.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "372:  uint32_t namesz, descsz;",
      "373:  unsigned char *nbuf = CAST(unsigned char *, vbuf);",
      "375:  (void)memcpy(xnh_addr, &nbuf[offset], xnh_sizeof);",
      "376:  offset += xnh_sizeof;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "375:  if (xnh_sizeof + offset > size) {",
      "379:   return xnh_sizeof + offset;",
      "380:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5b295bf19161b14d6c81151fd89c2f17bd50525c",
      "candidate_info": {
        "commit_hash": "5b295bf19161b14d6c81151fd89c2f17bd50525c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/5b295bf19161b14d6c81151fd89c2f17bd50525c",
        "files": [
          "ext/fileinfo/libmagic/readelf.c"
        ],
        "message": "Fix bug #68283: fileinfo: out-of-bounds read in elf note headers\n\nUpstream commit\nhttps://github.com/file/file/commit/39c7ac1106be844a5296d3eb5971946cc09ffda0\n\nCVE -2014-3710\n\n(cherry picked from commit 1803228597e82218a8c105e67975bc50e6f5bf0d)",
        "before_after_code_files": [
          "ext/fileinfo/libmagic/readelf.c||ext/fileinfo/libmagic/readelf.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/fileinfo/libmagic/readelf.c||ext/fileinfo/libmagic/readelf.c"
          ],
          "candidate": [
            "ext/fileinfo/libmagic/readelf.c||ext/fileinfo/libmagic/readelf.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/fileinfo/libmagic/readelf.c||ext/fileinfo/libmagic/readelf.c": [
          "File: ext/fileinfo/libmagic/readelf.c -> ext/fileinfo/libmagic/readelf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "372:  uint32_t namesz, descsz;",
          "373:  unsigned char *nbuf = CAST(unsigned char *, vbuf);",
          "375:  (void)memcpy(xnh_addr, &nbuf[offset], xnh_sizeof);",
          "376:  offset += xnh_sizeof;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "375:  if (xnh_sizeof + offset > size) {",
          "379:   return xnh_sizeof + offset;",
          "380:  }",
          "",
          "---------------"
        ]
      }
    }
  ]
}