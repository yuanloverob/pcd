{
  "cve_id": "CVE-2014-3551",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in the advanced-grading implementation in Moodle through 2.3.11, 2.4.x before 2.4.11, 2.5.x before 2.5.7, 2.6.x before 2.6.4, and 2.7.x before 2.7.1 allow remote authenticated users to inject arbitrary web script or HTML via a crafted (1) qualification or (2) rating field in a rubric.",
  "repo": "moodle/moodle",
  "patch_hash": "db5a6e6560c963849f8807184ca32efee6779264",
  "patch_info": {
    "commit_hash": "db5a6e6560c963849f8807184ca32efee6779264",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/db5a6e6560c963849f8807184ca32efee6779264",
    "files": [
      "grade/grading/form/guide/js/guide.js"
    ],
    "message": "MDL-46223 Fix frequently used comments in the marking guide\n\nWhen the frequently used comment contains a character like >, re-use it\ndirectly instead of its HTML entitiy.",
    "before_after_code_files": [
      "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
    ]
  },
  "patch_diff": {
    "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js": [
      "File: grade/grading/form/guide/js/guide.js -> grade/grading/form/guide/js/guide.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "10:         currentfocus = e.currentTarget;",
      "11:     });",
      "12:     Y.all('.markingguidecomment').on('click', function(e) {",
      "14:         currentfocus.focus();",
      "15:     });",
      "",
      "[Removed Lines]",
      "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('innerHTML'));",
      "",
      "[Added Lines]",
      "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('text'));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8ecc049f7f020086c1881bdf573af16cf2d9f9c9",
      "candidate_info": {
        "commit_hash": "8ecc049f7f020086c1881bdf573af16cf2d9f9c9",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/8ecc049f7f020086c1881bdf573af16cf2d9f9c9",
        "files": [
          "grade/grading/form/guide/js/guide.js"
        ],
        "message": "MDL-46223 Fix frequently used comments in the marking guide\n\nWhen the frequently used comment contains a character like >, re-use it\ndirectly instead of its HTML entitiy.",
        "before_after_code_files": [
          "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
          ],
          "candidate": [
            "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
          ]
        }
      },
      "candidate_diff": {
        "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js": [
          "File: grade/grading/form/guide/js/guide.js -> grade/grading/form/guide/js/guide.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:         currentfocus = e.currentTarget;",
          "11:     });",
          "12:     Y.all('.markingguidecomment').on('click', function(e) {",
          "14:         currentfocus.focus();",
          "15:     });",
          "",
          "[Removed Lines]",
          "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('innerHTML'));",
          "",
          "[Added Lines]",
          "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('text'));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b5dacb548800ee10d4940c8ebeca48c3c2ae0512",
      "candidate_info": {
        "commit_hash": "b5dacb548800ee10d4940c8ebeca48c3c2ae0512",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/b5dacb548800ee10d4940c8ebeca48c3c2ae0512",
        "files": [
          "grade/grading/form/guide/js/guide.js"
        ],
        "message": "MDL-46223 Fix frequently used comments in the marking guide\n\nWhen the frequently used comment contains a character like >, re-use it\ndirectly instead of its HTML entitiy.",
        "before_after_code_files": [
          "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
          ],
          "candidate": [
            "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
          ]
        }
      },
      "candidate_diff": {
        "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js": [
          "File: grade/grading/form/guide/js/guide.js -> grade/grading/form/guide/js/guide.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:         currentfocus = e.currentTarget;",
          "11:     });",
          "12:     Y.all('.markingguidecomment').on('click', function(e) {",
          "14:         currentfocus.focus();",
          "15:     });",
          "",
          "[Removed Lines]",
          "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('innerHTML'));",
          "",
          "[Added Lines]",
          "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('text'));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e42b6e20bdd5d6f09bc09be22fd7f20736e27085",
      "candidate_info": {
        "commit_hash": "e42b6e20bdd5d6f09bc09be22fd7f20736e27085",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/e42b6e20bdd5d6f09bc09be22fd7f20736e27085",
        "files": [
          "grade/grading/form/guide/js/guide.js"
        ],
        "message": "MDL-46223 Fix frequently used comments in the marking guide\n\nWhen the frequently used comment contains a character like >, re-use it\ndirectly instead of its HTML entitiy.",
        "before_after_code_files": [
          "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
          ],
          "candidate": [
            "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
          ]
        }
      },
      "candidate_diff": {
        "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js": [
          "File: grade/grading/form/guide/js/guide.js -> grade/grading/form/guide/js/guide.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:         currentfocus = e.currentTarget;",
          "11:     });",
          "12:     Y.all('.markingguidecomment').on('click', function(e) {",
          "14:         currentfocus.focus();",
          "15:     });",
          "",
          "[Removed Lines]",
          "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('innerHTML'));",
          "",
          "[Added Lines]",
          "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('text'));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7f4db6f4d9014370df0265ab846ad76235af0cae",
      "candidate_info": {
        "commit_hash": "7f4db6f4d9014370df0265ab846ad76235af0cae",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/7f4db6f4d9014370df0265ab846ad76235af0cae",
        "files": [
          "grade/grading/form/guide/js/guide.js"
        ],
        "message": "MDL-46223 Fix frequently used comments in the marking guide\n\nWhen the frequently used comment contains a character like >, re-use it\ndirectly instead of its HTML entitiy.",
        "before_after_code_files": [
          "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
          ],
          "candidate": [
            "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js"
          ]
        }
      },
      "candidate_diff": {
        "grade/grading/form/guide/js/guide.js||grade/grading/form/guide/js/guide.js": [
          "File: grade/grading/form/guide/js/guide.js -> grade/grading/form/guide/js/guide.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:         currentfocus = e.currentTarget;",
          "11:     });",
          "12:     Y.all('.markingguidecomment').on('click', function(e) {",
          "14:         currentfocus.focus();",
          "15:     });",
          "",
          "[Removed Lines]",
          "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('innerHTML'));",
          "",
          "[Added Lines]",
          "13:         currentfocus.set('value', currentfocus.get('value') + '\\n' + e.currentTarget.get('text'));",
          "",
          "---------------"
        ]
      }
    }
  ]
}