{
  "cve_id": "CVE-2015-8714",
  "cve_desc": "The dissect_dcom_OBJREF function in epan/dissectors/packet-dcom.c in the DCOM dissector in Wireshark 1.12.x before 1.12.9 does not initialize a certain IPv4 data structure, which allows remote attackers to cause a denial of service (application crash) via a crafted packet.",
  "repo": "wireshark/wireshark",
  "patch_hash": "d34267d0503a67235bf259fd2f2f2d2bb8b18cf5",
  "patch_info": {
    "commit_hash": "d34267d0503a67235bf259fd2f2f2d2bb8b18cf5",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/d34267d0503a67235bf259fd2f2f2d2bb8b18cf5",
    "files": [
      "epan/dissectors/packet-dcom.c"
    ],
    "message": "DCOM: ensure to initialize IPv4 variable put on the stack\n\nBug: 11610\nChange-Id: I920b88ab035ff34e7cff9eab8158aa2dabe2faac\nReviewed-on: https://code.wireshark.org/review/11134\nReviewed-by: Martin Kaiser <wireshark@kaiser.cx>",
    "before_after_code_files": [
      "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
    ]
  },
  "patch_diff": {
    "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c": [
      "File: epan/dissectors/packet-dcom.c -> epan/dissectors/packet-dcom.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2060:  gchar ip[4];",
      "2062:  memset(&ipid, 0, sizeof(ipid));",
      "2065:  sub_item = proto_tree_add_item(tree, hf_dcom_objref, tvb, offset, 0, ENC_NA);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2063:  memset(ip, 0, sizeof(ip));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "32e3f8d00f962654e36ef96325eda9c652bf435e",
      "candidate_info": {
        "commit_hash": "32e3f8d00f962654e36ef96325eda9c652bf435e",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/32e3f8d00f962654e36ef96325eda9c652bf435e",
        "files": [
          "epan/dissectors/packet-dcom.c"
        ],
        "message": "DCOM: ensure to initialize IPv4 variable put on the stack\n\nBug: 11610\nChange-Id: I920b88ab035ff34e7cff9eab8158aa2dabe2faac\nReviewed-on: https://code.wireshark.org/review/11134\nReviewed-by: Martin Kaiser <wireshark@kaiser.cx>\n(cherry picked from commit d34267d0503a67235bf259fd2f2f2d2bb8b18cf5)\nReviewed-on: https://code.wireshark.org/review/11136\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\n(cherry picked from commit af920d25e2477b07c89cadcf913cd8d529bc0e71)\nReviewed-on: https://code.wireshark.org/review/13750\nReviewed-by: Balint Reczey <balint@balintreczey.hu>\n(cherry picked from commit 47c80e6938657b1a45fde4fc67b211c396a98685)\nReviewed-on: https://code.wireshark.org/review/14244",
        "before_after_code_files": [
          "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
          ],
          "candidate": [
            "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c": [
          "File: epan/dissectors/packet-dcom.c -> epan/dissectors/packet-dcom.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1920:  gchar ip[4];",
          "1922:  memset(&ipid, 0, sizeof(ipid));",
          "1925:  sub_item = proto_tree_add_item(tree, hf_dcom_objref, tvb, offset, 0, ENC_NA);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1923:  memset(ip, 0, sizeof(ip));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d1b2ca5104e80702334f98b98754a2559afede0b",
      "candidate_info": {
        "commit_hash": "d1b2ca5104e80702334f98b98754a2559afede0b",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/d1b2ca5104e80702334f98b98754a2559afede0b",
        "files": [
          "epan/dissectors/packet-dcom.c"
        ],
        "message": "DCOM: ensure to initialize IPv4 variable put on the stack\n\nBug: 11610\nChange-Id: I920b88ab035ff34e7cff9eab8158aa2dabe2faac\nReviewed-on: https://code.wireshark.org/review/11134\nReviewed-by: Martin Kaiser <wireshark@kaiser.cx>\n(cherry picked from commit d34267d0503a67235bf259fd2f2f2d2bb8b18cf5)\nReviewed-on: https://code.wireshark.org/review/11135\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>",
        "before_after_code_files": [
          "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
          ],
          "candidate": [
            "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c": [
          "File: epan/dissectors/packet-dcom.c -> epan/dissectors/packet-dcom.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2060:  gchar ip[4];",
          "2062:  memset(&ipid, 0, sizeof(ipid));",
          "2065:  sub_item = proto_tree_add_item(tree, hf_dcom_objref, tvb, offset, 0, ENC_NA);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2063:  memset(ip, 0, sizeof(ip));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "47c80e6938657b1a45fde4fc67b211c396a98685",
      "candidate_info": {
        "commit_hash": "47c80e6938657b1a45fde4fc67b211c396a98685",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/47c80e6938657b1a45fde4fc67b211c396a98685",
        "files": [
          "epan/dissectors/packet-dcom.c"
        ],
        "message": "DCOM: ensure to initialize IPv4 variable put on the stack\n\nBug: 11610\nChange-Id: I920b88ab035ff34e7cff9eab8158aa2dabe2faac\nReviewed-on: https://code.wireshark.org/review/11134\nReviewed-by: Martin Kaiser <wireshark@kaiser.cx>\n(cherry picked from commit d34267d0503a67235bf259fd2f2f2d2bb8b18cf5)\nReviewed-on: https://code.wireshark.org/review/11136\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\n(cherry picked from commit af920d25e2477b07c89cadcf913cd8d529bc0e71)\nReviewed-on: https://code.wireshark.org/review/13750\nReviewed-by: Balint Reczey <balint@balintreczey.hu>",
        "before_after_code_files": [
          "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
          ],
          "candidate": [
            "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c": [
          "File: epan/dissectors/packet-dcom.c -> epan/dissectors/packet-dcom.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2035:  gchar ip[4];",
          "2037:  memset(&ipid, 0, sizeof(ipid));",
          "2040:  sub_item = proto_tree_add_item(tree, hf_dcom_objref, tvb, offset, 0, ENC_NA);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2038:  memset(ip, 0, sizeof(ip));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "af920d25e2477b07c89cadcf913cd8d529bc0e71",
      "candidate_info": {
        "commit_hash": "af920d25e2477b07c89cadcf913cd8d529bc0e71",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/af920d25e2477b07c89cadcf913cd8d529bc0e71",
        "files": [
          "epan/dissectors/packet-dcom.c"
        ],
        "message": "DCOM: ensure to initialize IPv4 variable put on the stack\n\nBug: 11610\nChange-Id: I920b88ab035ff34e7cff9eab8158aa2dabe2faac\nReviewed-on: https://code.wireshark.org/review/11134\nReviewed-by: Martin Kaiser <wireshark@kaiser.cx>\n(cherry picked from commit d34267d0503a67235bf259fd2f2f2d2bb8b18cf5)\nReviewed-on: https://code.wireshark.org/review/11136\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>",
        "before_after_code_files": [
          "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
          ],
          "candidate": [
            "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-dcom.c||epan/dissectors/packet-dcom.c": [
          "File: epan/dissectors/packet-dcom.c -> epan/dissectors/packet-dcom.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2035:  gchar ip[4];",
          "2037:  memset(&ipid, 0, sizeof(ipid));",
          "2040:  sub_item = proto_tree_add_item(tree, hf_dcom_objref, tvb, offset, 0, ENC_NA);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2038:  memset(ip, 0, sizeof(ip));",
          "",
          "---------------"
        ]
      }
    }
  ]
}