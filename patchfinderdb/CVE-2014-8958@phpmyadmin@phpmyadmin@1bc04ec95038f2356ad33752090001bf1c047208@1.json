{
  "cve_id": "CVE-2014-8958",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.6, 4.1.x before 4.1.14.7, and 4.2.x before 4.2.12 allow remote authenticated users to inject arbitrary web script or HTML via a crafted (1) database, (2) table, or (3) column name that is improperly handled during rendering of the table browse page; a crafted ENUM value that is improperly handled during rendering of the (4) table print view or (5) zoom search page; or (6) a crafted pma_fontsize cookie that is improperly handled during rendering of the home page.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "1bc04ec95038f2356ad33752090001bf1c047208",
  "patch_info": {
    "commit_hash": "1bc04ec95038f2356ad33752090001bf1c047208",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/1bc04ec95038f2356ad33752090001bf1c047208",
    "files": [
      "ChangeLog",
      "tbl_zoom_select.php"
    ],
    "message": "bug #4579 [security] XSS vulnerability in zoom search page\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
    "before_after_code_files": [
      "tbl_zoom_select.php||tbl_zoom_select.php"
    ]
  },
  "patch_diff": {
    "tbl_zoom_select.php||tbl_zoom_select.php": [
      "File: tbl_zoom_select.php -> tbl_zoom_select.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "81:     }",
      "82:     $key = array_search($field, $table_search->getColumnNames());",
      "83:     $properties = $table_search->getColumnProperties($_REQUEST['it'], $key);",
      "85:     $response->addJSON('field_collation', $properties['collation']);",
      "86:     $response->addJSON('field_operators', $properties['func']);",
      "87:     $response->addJSON('field_value', $properties['value']);",
      "",
      "[Removed Lines]",
      "84:     $response->addJSON('field_type', $properties['type']);",
      "",
      "[Added Lines]",
      "84:     $response->addJSON('field_type', htmlspecialchars($properties['type']));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "37f6b992da784fa38f2821dea91ea8504eb00bf7",
      "candidate_info": {
        "commit_hash": "37f6b992da784fa38f2821dea91ea8504eb00bf7",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/37f6b992da784fa38f2821dea91ea8504eb00bf7",
        "files": [
          "db_datadict.php",
          "db_search.php",
          "db_structure.php",
          "tbl_addfield.php",
          "tbl_export.php",
          "tbl_import.php",
          "tbl_operations.php",
          "tbl_relation.php",
          "tbl_structure.php",
          "tbl_zoom_select.php",
          "view_operations.php"
        ],
        "message": "Fix typos.\n\nSigned-off-by: Hugues Peccatte <hugues.peccatte@gmail.com>",
        "before_after_code_files": [
          "db_datadict.php||db_datadict.php",
          "db_search.php||db_search.php",
          "db_structure.php||db_structure.php",
          "tbl_addfield.php||tbl_addfield.php",
          "tbl_export.php||tbl_export.php",
          "tbl_import.php||tbl_import.php",
          "tbl_operations.php||tbl_operations.php",
          "tbl_relation.php||tbl_relation.php",
          "tbl_structure.php||tbl_structure.php",
          "tbl_zoom_select.php||tbl_zoom_select.php",
          "view_operations.php||view_operations.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tbl_zoom_select.php||tbl_zoom_select.php"
          ],
          "candidate": [
            "tbl_zoom_select.php||tbl_zoom_select.php"
          ]
        }
      },
      "candidate_diff": {
        "db_datadict.php||db_datadict.php": [
          "File: db_datadict.php -> db_datadict.php"
        ],
        "db_search.php||db_search.php": [
          "File: db_search.php -> db_search.php"
        ],
        "db_structure.php||db_structure.php": [
          "File: db_structure.php -> db_structure.php"
        ],
        "tbl_addfield.php||tbl_addfield.php": [
          "File: tbl_addfield.php -> tbl_addfield.php"
        ],
        "tbl_export.php||tbl_export.php": [
          "File: tbl_export.php -> tbl_export.php"
        ],
        "tbl_import.php||tbl_import.php": [
          "File: tbl_import.php -> tbl_import.php"
        ],
        "tbl_operations.php||tbl_operations.php": [
          "File: tbl_operations.php -> tbl_operations.php"
        ],
        "tbl_relation.php||tbl_relation.php": [
          "File: tbl_relation.php -> tbl_relation.php"
        ],
        "tbl_structure.php||tbl_structure.php": [
          "File: tbl_structure.php -> tbl_structure.php"
        ],
        "tbl_zoom_select.php||tbl_zoom_select.php": [
          "File: tbl_zoom_select.php -> tbl_zoom_select.php"
        ],
        "view_operations.php||view_operations.php": [
          "File: view_operations.php -> view_operations.php"
        ]
      }
    },
    {
      "candidate_hash": "72b07cae86c766d03c49ad460d8ab0a1a6a84541",
      "candidate_info": {
        "commit_hash": "72b07cae86c766d03c49ad460d8ab0a1a6a84541",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/72b07cae86c766d03c49ad460d8ab0a1a6a84541",
        "files": [
          "db_search.php",
          "db_structure.php",
          "index.php",
          "tbl_zoom_select.php"
        ],
        "message": "Fix some more coding style\n\nSigned-off-by: Chirayu Chiripal <chirayu.chiripal@gmail.com>",
        "before_after_code_files": [
          "db_search.php||db_search.php",
          "db_structure.php||db_structure.php",
          "index.php||index.php",
          "tbl_zoom_select.php||tbl_zoom_select.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tbl_zoom_select.php||tbl_zoom_select.php"
          ],
          "candidate": [
            "tbl_zoom_select.php||tbl_zoom_select.php"
          ]
        }
      },
      "candidate_diff": {
        "db_search.php||db_search.php": [
          "File: db_search.php -> db_search.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "37: $db_search = new PMA_DbSearch($GLOBALS['db']);",
          "41:     include 'libraries/db_info.inc.php';",
          "42: }",
          "",
          "[Removed Lines]",
          "40: if ( $GLOBALS['is_ajax_request'] != true) {",
          "",
          "[Added Lines]",
          "40: if ($GLOBALS['is_ajax_request'] != true) {",
          "",
          "---------------"
        ],
        "db_structure.php||db_structure.php": [
          "File: db_structure.php -> db_structure.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "244:     if (! $db_is_system_schema) {",
          "245:         list($drop_query, $drop_message)",
          "",
          "[Removed Lines]",
          "238:     list($browse_table, $search_table, $browse_table_label, $empty_table,",
          "239:         $tracking_icon) = PMA_getHtmlForActionLinks(",
          "240:             $current_table, $table_is_view, $tbl_url_query,",
          "241:             $titles, $truename, $db_is_system_schema, $url_query",
          "242:         );",
          "",
          "[Added Lines]",
          "238:     list($browse_table, $search_table, $browse_table_label,",
          "239:         $empty_table, $tracking_icon",
          "240:     ) = PMA_getHtmlForActionLinks(",
          "241:         $current_table, $table_is_view, $tbl_url_query,",
          "242:         $titles, $truename, $db_is_system_schema, $url_query",
          "243:     );",
          "",
          "---------------"
        ],
        "index.php||index.php": [
          "File: index.php -> index.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:     'import.php', 'export.php'",
          "46: if (! empty($_REQUEST['target'])",
          "",
          "[Removed Lines]",
          "41:  $target_blacklist = array (",
          "43:     );",
          "",
          "[Added Lines]",
          "41: $target_blacklist = array (",
          "43: );",
          "",
          "---------------"
        ],
        "tbl_zoom_select.php||tbl_zoom_select.php": [
          "File: tbl_zoom_select.php -> tbl_zoom_select.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "102: $err_url   = $goto . PMA_URL_getCommon(array('db' => $db, 'table' => $table));",
          "106:     $dataLabel = PMA_getDisplayField($db, $table);",
          "107: } else {",
          "108:     $dataLabel = $_POST['dataLabel'];",
          "",
          "[Removed Lines]",
          "105: if ( !isset($_POST['zoom_submit']) || $_POST['dataLabel'] == '') {",
          "",
          "[Added Lines]",
          "105: if (!isset($_POST['zoom_submit']) || $_POST['dataLabel'] == '') {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "58cdd91fc83703a1ab645764fb3708e8e0b7c4a2",
      "candidate_info": {
        "commit_hash": "58cdd91fc83703a1ab645764fb3708e8e0b7c4a2",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/58cdd91fc83703a1ab645764fb3708e8e0b7c4a2",
        "files": [
          "ChangeLog",
          "tbl_zoom_select.php"
        ],
        "message": "bug #4579 [security] XSS vulnerability in zoom search page\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "tbl_zoom_select.php||tbl_zoom_select.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "tbl_zoom_select.php||tbl_zoom_select.php"
          ],
          "candidate": [
            "tbl_zoom_select.php||tbl_zoom_select.php"
          ]
        }
      },
      "candidate_diff": {
        "tbl_zoom_select.php||tbl_zoom_select.php": [
          "File: tbl_zoom_select.php -> tbl_zoom_select.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "95:     }",
          "96:     $key = array_search($field, $table_search->getColumnNames());",
          "97:     $properties = $table_search->getColumnProperties($_REQUEST['it'], $key);",
          "99:     $response->addJSON('field_collation', $properties['collation']);",
          "100:     $response->addJSON('field_operators', $properties['func']);",
          "101:     $response->addJSON('field_value', $properties['value']);",
          "",
          "[Removed Lines]",
          "98:     $response->addJSON('field_type', $properties['type']);",
          "",
          "[Added Lines]",
          "98:     $response->addJSON('field_type', htmlspecialchars($properties['type']));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "816fa880060f37932be291d2918fd5c6ac474ab5",
      "candidate_info": {
        "commit_hash": "816fa880060f37932be291d2918fd5c6ac474ab5",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/816fa880060f37932be291d2918fd5c6ac474ab5",
        "files": [
          "ChangeLog",
          "tbl_zoom_select.php"
        ],
        "message": "bug #4579 [security] XSS vulnerability in zoom search page\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "tbl_zoom_select.php||tbl_zoom_select.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "tbl_zoom_select.php||tbl_zoom_select.php"
          ],
          "candidate": [
            "tbl_zoom_select.php||tbl_zoom_select.php"
          ]
        }
      },
      "candidate_diff": {
        "tbl_zoom_select.php||tbl_zoom_select.php": [
          "File: tbl_zoom_select.php -> tbl_zoom_select.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "81:     }",
          "82:     $key = array_search($field, $table_search->getColumnNames());",
          "83:     $properties = $table_search->getColumnProperties($_REQUEST['it'], $key);",
          "85:     $response->addJSON('field_collation', $properties['collation']);",
          "86:     $response->addJSON('field_operators', $properties['func']);",
          "87:     $response->addJSON('field_value', $properties['value']);",
          "",
          "[Removed Lines]",
          "84:     $response->addJSON('field_type', $properties['type']);",
          "",
          "[Added Lines]",
          "84:     $response->addJSON('field_type', htmlspecialchars($properties['type']));",
          "",
          "---------------"
        ]
      }
    }
  ]
}