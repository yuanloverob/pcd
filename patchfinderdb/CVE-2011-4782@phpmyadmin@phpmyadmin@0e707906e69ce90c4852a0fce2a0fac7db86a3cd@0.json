{
  "cve_id": "CVE-2011-4782",
  "cve_desc": "Cross-site scripting (XSS) vulnerability in libraries/config/ConfigFile.class.php in the setup interface in phpMyAdmin 3.4.x before 3.4.9 allows remote attackers to inject arbitrary web script or HTML via the host parameter.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "0e707906e69ce90c4852a0fce2a0fac7db86a3cd",
  "patch_info": {
    "commit_hash": "0e707906e69ce90c4852a0fce2a0fac7db86a3cd",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/0e707906e69ce90c4852a0fce2a0fac7db86a3cd",
    "files": [
      "ChangeLog",
      "libraries/config/ConfigFile.class.php"
    ],
    "message": "[security] Self-XSS in setup (host parameter), see PMASA-2011-19",
    "before_after_code_files": [
      "libraries/config/ConfigFile.class.php||libraries/config/ConfigFile.class.php"
    ]
  },
  "patch_diff": {
    "libraries/config/ConfigFile.class.php||libraries/config/ConfigFile.class.php": [
      "File: libraries/config/ConfigFile.class.php -> libraries/config/ConfigFile.class.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "425:             return htmlspecialchars($verbose);",
      "426:         }",
      "427:         $host = $this->get(\"Servers/$id/host\");",
      "429:     }",
      "",
      "[Removed Lines]",
      "428:         return empty($host) ? 'localhost' : $host;",
      "",
      "[Added Lines]",
      "428:         return empty($host) ? 'localhost' : htmlspecialchars($host);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "b4296d6acbba0c6143e04c2c54922351c3147a98",
      "candidate_info": {
        "commit_hash": "b4296d6acbba0c6143e04c2c54922351c3147a98",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/b4296d6acbba0c6143e04c2c54922351c3147a98",
        "files": [
          "libraries/config/ConfigFile.class.php",
          "setup/lib/index.lib.php"
        ],
        "message": "Escape in correct places to avoid double escaping sometimes",
        "before_after_code_files": [
          "libraries/config/ConfigFile.class.php||libraries/config/ConfigFile.class.php",
          "setup/lib/index.lib.php||setup/liindex.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "libraries/config/ConfigFile.class.php||libraries/config/ConfigFile.class.php"
          ],
          "candidate": [
            "libraries/config/ConfigFile.class.php||libraries/config/ConfigFile.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/config/ConfigFile.class.php||libraries/config/ConfigFile.class.php": [
          "File: libraries/config/ConfigFile.class.php -> libraries/config/ConfigFile.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "422:         }",
          "423:         $verbose = $this->get(\"Servers/$id/verbose\");",
          "424:         if (!empty($verbose)) {",
          "426:         }",
          "427:         $host = $this->get(\"Servers/$id/host\");",
          "429:     }",
          "",
          "[Removed Lines]",
          "425:             return htmlspecialchars($verbose);",
          "428:         return empty($host) ? 'localhost' : htmlspecialchars($host);",
          "",
          "[Added Lines]",
          "425:             return $verbose;",
          "428:         return empty($host) ? 'localhost' : $host;",
          "",
          "---------------"
        ],
        "setup/lib/index.lib.php||setup/liindex.lib.php": [
          "File: setup/lib/index.lib.php -> setup/liindex.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "279:         if ($server_name == 'localhost') {",
          "280:             $server_name .=  \" [$i]\";",
          "281:         }",
          "283:         if ($cookie_auth_server && $blowfish_secret === null) {",
          "284:             $blowfish_secret = uniqid('', true);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}