{
  "cve_id": "CVE-2016-7411",
  "cve_desc": "ext/standard/var_unserializer.re in PHP before 5.6.26 mishandles object-deserialization failures, which allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via an unserialize call that references a partially constructed object.",
  "repo": "php/php-src",
  "patch_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
  "patch_info": {
    "commit_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
    "files": [
      "Zend/zend_objects_API.c",
      "ext/standard/tests/serialize/bug73052.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #73052 - Memory Corruption in During Deserialized-object Destruction",
    "before_after_code_files": [
      "Zend/zend_objects_API.c||Zend/zend_objects_API.c",
      "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "Zend/zend_objects_API.c||Zend/zend_objects_API.c": [
      "File: Zend/zend_objects_API.c -> Zend/zend_objects_API.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "306: {",
      "307:  zend_object_handle handle = Z_OBJ_HANDLE_P(zobject);",
      "308:  zend_object_store_bucket *obj_bucket = &EG(objects_store).object_buckets[handle];",
      "311:  obj_bucket->destructor_called = 1;",
      "312: }",
      "",
      "[Removed Lines]",
      "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);;",
      "",
      "[Added Lines]",
      "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);",
      "",
      "---------------"
    ],
    "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt": [
      "File: ext/standard/tests/serialize/bug73052.phpt -> ext/standard/tests/serialize/bug73052.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73052: Memory Corruption in During Deserialized-object Destruction",
      "3: --FILE--",
      "4: <?php",
      "6: class obj {",
      "7:     var $ryat;",
      "8:     public function __destruct() {",
      "9:         $this->ryat = null;",
      "10:     }",
      "11: }",
      "13: $poc = 'O:3:\"obj\":1:{';",
      "14: var_dump(unserialize($poc));",
      "15: ?>",
      "16: --EXPECTF--",
      "17: Notice: unserialize(): Error at offset 13 of 13 bytes in %sbug73052.php on line %d",
      "18: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "438:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
      "439:         zend_hash_clean(Z_OBJPROP_PP(rval));",
      "440:      }",
      "441:      ZVAL_NULL(*rval);",
      "442:   return 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "440:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "495: {",
      "496:  YYCTYPE yych;",
      "497:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "494: #line 495 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "495: #line 496 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "551:  yych = *(YYMARKER = ++YYCURSOR);",
      "552:  if (yych == ':') goto yy95;",
      "553: yy3:",
      "555:  { return 0; }",
      "557: yy4:",
      "558:  yych = *(YYMARKER = ++YYCURSOR);",
      "559:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "554: #line 860 \"ext/standard/var_unserializer.re\"",
      "556: #line 557 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "555: #line 861 \"ext/standard/var_unserializer.re\"",
      "557: #line 558 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "596:  goto yy3;",
      "597: yy14:",
      "598:  ++YYCURSOR;",
      "600:  {",
      "602:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "604: }",
      "606: yy16:",
      "607:  yych = *++YYCURSOR;",
      "608:  goto yy3;",
      "",
      "[Removed Lines]",
      "599: #line 854 \"ext/standard/var_unserializer.re\"",
      "605: #line 606 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "600: #line 855 \"ext/standard/var_unserializer.re\"",
      "606: #line 607 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "633:  yych = *++YYCURSOR;",
      "634:  if (yych != '\"') goto yy18;",
      "635:  ++YYCURSOR;",
      "637:  {",
      "638:  size_t len, len2, len3, maxlen;",
      "639:  long elements;",
      "",
      "[Removed Lines]",
      "636: #line 707 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "637: #line 708 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "781:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "782: }",
      "784: yy25:",
      "785:  yych = *++YYCURSOR;",
      "786:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "783: #line 784 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "784: #line 785 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "805:  yych = *++YYCURSOR;",
      "806:  if (yych != '\"') goto yy18;",
      "807:  ++YYCURSOR;",
      "809:  {",
      "810:     if (!var_hash) return 0;",
      "",
      "[Removed Lines]",
      "808: #line 698 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "809: #line 699 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "814:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "815:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "816: }",
      "818: yy32:",
      "819:  yych = *++YYCURSOR;",
      "820:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "817: #line 818 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "818: #line 819 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "835:  yych = *++YYCURSOR;",
      "836:  if (yych != '{') goto yy18;",
      "837:  ++YYCURSOR;",
      "839:  {",
      "840:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "838: #line 677 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "839: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "857:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "858: }",
      "860: yy39:",
      "861:  yych = *++YYCURSOR;",
      "862:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "859: #line 860 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "860: #line 861 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "877:  yych = *++YYCURSOR;",
      "878:  if (yych != '\"') goto yy18;",
      "879:  ++YYCURSOR;",
      "881:  {",
      "882:  size_t len, maxlen;",
      "883:  char *str;",
      "",
      "[Removed Lines]",
      "880: #line 642 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "881: #line 643 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "912:  ZVAL_STRINGL(*rval, str, len, 0);",
      "913:  return 1;",
      "914: }",
      "916: yy46:",
      "917:  yych = *++YYCURSOR;",
      "918:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "915: #line 916 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "916: #line 917 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "933:  yych = *++YYCURSOR;",
      "934:  if (yych != '\"') goto yy18;",
      "935:  ++YYCURSOR;",
      "937:  {",
      "938:  size_t len, maxlen;",
      "939:  char *str;",
      "",
      "[Removed Lines]",
      "936: #line 609 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "937: #line 610 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "966:  ZVAL_STRINGL(*rval, str, len, 1);",
      "967:  return 1;",
      "968: }",
      "970: yy53:",
      "971:  yych = *++YYCURSOR;",
      "972:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "969: #line 970 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "970: #line 971 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1054:  }",
      "1055: yy63:",
      "1056:  ++YYCURSOR;",
      "1058:  {",
      "1059: #if SIZEOF_LONG == 4",
      "1060: use_double:",
      "",
      "[Removed Lines]",
      "1057: #line 599 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1058: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1064:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1065:  return 1;",
      "1066: }",
      "1068: yy65:",
      "1069:  yych = *++YYCURSOR;",
      "1070:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1067: #line 1068 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1123:  yych = *++YYCURSOR;",
      "1124:  if (yych != ';') goto yy18;",
      "1125:  ++YYCURSOR;",
      "1127:  {",
      "1129:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1126: #line 584 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1127: #line 585 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1139:  return 1;",
      "1140: }",
      "1142: yy76:",
      "1143:  yych = *++YYCURSOR;",
      "1144:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1141: #line 1142 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1165:  if (yych <= '9') goto yy79;",
      "1166:  if (yych != ';') goto yy18;",
      "1167:  ++YYCURSOR;",
      "1169:  {",
      "1170: #if SIZEOF_LONG == 4",
      "1171:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1168: #line 557 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1169: #line 558 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1192:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1193:  return 1;",
      "1194: }",
      "1196: yy83:",
      "1197:  yych = *++YYCURSOR;",
      "1198:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1195: #line 1196 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1200:  yych = *++YYCURSOR;",
      "1201:  if (yych != ';') goto yy18;",
      "1202:  ++YYCURSOR;",
      "1204:  {",
      "1206:  INIT_PZVAL(*rval);",
      "1207:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1208:  return 1;",
      "1209: }",
      "1211: yy87:",
      "1212:  ++YYCURSOR;",
      "1214:  {",
      "1216:  INIT_PZVAL(*rval);",
      "1217:  ZVAL_NULL(*rval);",
      "1218:  return 1;",
      "1219: }",
      "1221: yy89:",
      "1222:  yych = *++YYCURSOR;",
      "1223:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1203: #line 550 \"ext/standard/var_unserializer.re\"",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "1213: #line 543 \"ext/standard/var_unserializer.re\"",
      "1220: #line 1221 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1204: #line 551 \"ext/standard/var_unserializer.re\"",
      "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
      "1214: #line 544 \"ext/standard/var_unserializer.re\"",
      "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1240:  if (yych <= '9') goto yy91;",
      "1241:  if (yych != ';') goto yy18;",
      "1242:  ++YYCURSOR;",
      "1244:  {",
      "1245:  long id;",
      "",
      "[Removed Lines]",
      "1243: #line 520 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1244: #line 521 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1264:  return 1;",
      "1265: }",
      "1267: yy95:",
      "1268:  yych = *++YYCURSOR;",
      "1269:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1266: #line 1267 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1286:  if (yych <= '9') goto yy97;",
      "1287:  if (yych != ';') goto yy18;",
      "1288:  ++YYCURSOR;",
      "1290:  {",
      "1291:  long id;",
      "",
      "[Removed Lines]",
      "1289: #line 499 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1290: #line 500 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1308:  return 1;",
      "1309: }",
      "1311: }",
      "1315:  return 0;",
      "",
      "[Removed Lines]",
      "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
      "1312: #line 862 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
      "1313: #line 863 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "442:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
      "443:         zend_hash_clean(Z_OBJPROP_PP(rval));",
      "444:      }",
      "445:      ZVAL_NULL(*rval);",
      "446:   return 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "444:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "2dc24005d9fe1827705276cec52397a57ae66549",
      "candidate_info": {
        "commit_hash": "2dc24005d9fe1827705276cec52397a57ae66549",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/2dc24005d9fe1827705276cec52397a57ae66549",
        "files": [
          "ext/standard/tests/serialize/bug74101.phpt",
          "ext/standard/tests/serialize/bug74614.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-7.0' into PHP-7.1\n\n* PHP-7.0:\n  Fixed bug #74101 and bug #74614",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug74101.phpt||ext/standard/tests/serialize/bug74101.phpt",
          "ext/standard/tests/serialize/bug74614.phpt||ext/standard/tests/serialize/bug74614.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug74101.phpt||ext/standard/tests/serialize/bug74101.phpt": [
          "File: ext/standard/tests/serialize/bug74101.phpt -> ext/standard/tests/serialize/bug74101.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74101: Unserialize Heap Use-After-Free (READ: 1) in zval_get_type",
          "3: --FILE--",
          "4: <?php",
          "5: $s = 'O:9:\"Exception\":799999999999999999999999999997:0i:0;a:0:{}i:2;i:0;i:0;R:2;';",
          "6: var_dump(unserialize($s));",
          "7: ?>",
          "8: --EXPECTF--",
          "9: Notice: unserialize(): Error at offset 48 of 74 bytes in %s on line %d",
          "10: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug74614.phpt||ext/standard/tests/serialize/bug74614.phpt": [
          "File: ext/standard/tests/serialize/bug74614.phpt -> ext/standard/tests/serialize/bug74614.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74614: Use-after-free in PHP7's unserialize()",
          "3: --FILE--",
          "4: <?php",
          "6: unserialize('a:3020000000000000000000000000000001:{i:0;a:0:{}i:1;i:2;i:2;i:3;i:3;i:4;i:4;i:5;i:5;i:6;i:6;i:7;i:7;i:8;i:8;R:2;}');",
          "8: ?>",
          "9: --EXPECTF--",
          "10: Notice: unserialize(): Error at offset 38 of 113 bytes in %s on line %d",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "548:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "550:  ht = Z_OBJPROP_P(rval);",
          "551:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "552:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "553:   if (has_wakeup) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "551:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "552:   return 0;",
          "553:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "617:  start = cursor;",
          "621: {",
          "622:  YYCTYPE yych;",
          "623:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "620: #line 621 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "624: #line 625 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "675: yy2:",
          "676:  ++YYCURSOR;",
          "677: yy3:",
          "679:  { return 0; }",
          "681: yy4:",
          "682:  yych = *(YYMARKER = ++YYCURSOR);",
          "683:  if (yych == ':') goto yy17;",
          "",
          "[Removed Lines]",
          "678: #line 998 \"ext/standard/var_unserializer.re\"",
          "680: #line 681 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "682: #line 1002 \"ext/standard/var_unserializer.re\"",
          "684: #line 685 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "724:  goto yy3;",
          "725: yy15:",
          "726:  ++YYCURSOR;",
          "728:  {",
          "730:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "732: }",
          "734: yy17:",
          "735:  yych = *++YYCURSOR;",
          "736:  if (yybm[0+yych] & 128) {",
          "",
          "[Removed Lines]",
          "727: #line 992 \"ext/standard/var_unserializer.re\"",
          "733: #line 734 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "731: #line 996 \"ext/standard/var_unserializer.re\"",
          "737: #line 738 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "742:  goto yy3;",
          "743: yy19:",
          "744:  ++YYCURSOR;",
          "746:  {",
          "748:  ZVAL_NULL(rval);",
          "749:  return 1;",
          "750: }",
          "752: yy21:",
          "753:  yych = *++YYCURSOR;",
          "754:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "745: #line 676 \"ext/standard/var_unserializer.re\"",
          "751: #line 752 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "749: #line 680 \"ext/standard/var_unserializer.re\"",
          "755: #line 756 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "998:  goto yy18;",
          "999: yy63:",
          "1000:  ++YYCURSOR;",
          "1002:  {",
          "1003:  zend_long id;",
          "",
          "[Removed Lines]",
          "1001: #line 625 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1005: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1025:  return 1;",
          "1026: }",
          "1028: yy65:",
          "1029:  yych = *++YYCURSOR;",
          "1030:  if (yych == '\"') goto yy84;",
          "",
          "[Removed Lines]",
          "1027: #line 1028 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1031: #line 1032 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1035:  goto yy18;",
          "1036: yy67:",
          "1037:  ++YYCURSOR;",
          "1039:  {",
          "1041:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1042:  return 1;",
          "1043: }",
          "1045: yy69:",
          "1046:  ++YYCURSOR;",
          "1047:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "",
          "[Removed Lines]",
          "1038: #line 682 \"ext/standard/var_unserializer.re\"",
          "1044: #line 1045 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1042: #line 686 \"ext/standard/var_unserializer.re\"",
          "1048: #line 1049 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1061:  }",
          "1062: yy71:",
          "1063:  ++YYCURSOR;",
          "1065:  {",
          "1066: #if SIZEOF_ZEND_LONG == 4",
          "1067: use_double:",
          "",
          "[Removed Lines]",
          "1064: #line 730 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1068: #line 734 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1070:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1071:  return 1;",
          "1072: }",
          "1074: yy73:",
          "1075:  yych = *++YYCURSOR;",
          "1076:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1073: #line 1074 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1077: #line 1078 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1092:  goto yy18;",
          "1093: yy76:",
          "1094:  ++YYCURSOR;",
          "1096:  {",
          "1097: #if SIZEOF_ZEND_LONG == 4",
          "1098:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1095: #line 688 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1099: #line 692 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1118:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1119:  return 1;",
          "1120: }",
          "1122: yy78:",
          "1123:  yych = *++YYCURSOR;",
          "1124:  if (yych == '\"') goto yy92;",
          "1125:  goto yy18;",
          "1126: yy79:",
          "1127:  ++YYCURSOR;",
          "1129:  {",
          "1130:  zend_long id;",
          "",
          "[Removed Lines]",
          "1121: #line 1122 \"ext/standard/var_unserializer.c\"",
          "1128: #line 651 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1125: #line 1126 \"ext/standard/var_unserializer.c\"",
          "1132: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1151:  return 1;",
          "1152: }",
          "1154: yy81:",
          "1155:  yych = *++YYCURSOR;",
          "1156:  if (yych == '\"') goto yy94;",
          "1157:  goto yy18;",
          "1158: yy82:",
          "1159:  ++YYCURSOR;",
          "1161:  {",
          "1162:  size_t len, len2, len3, maxlen;",
          "1163:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1153: #line 1154 \"ext/standard/var_unserializer.c\"",
          "1160: #line 840 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1157: #line 1158 \"ext/standard/var_unserializer.c\"",
          "1164: #line 844 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1310:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1311: }",
          "1313: yy84:",
          "1314:  ++YYCURSOR;",
          "1316:  {",
          "1317:  size_t len, maxlen;",
          "1318:  zend_string *str;",
          "",
          "[Removed Lines]",
          "1312: #line 1313 \"ext/standard/var_unserializer.c\"",
          "1315: #line 771 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1316: #line 1317 \"ext/standard/var_unserializer.c\"",
          "1319: #line 775 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1346:  ZVAL_STR(rval, str);",
          "1347:  return 1;",
          "1348: }",
          "1350: yy86:",
          "1351:  ++YYCURSOR;",
          "1353:  {",
          "1354:  zend_long elements = parse_iv(start + 2);",
          "1357:     if (!var_hash) return 0;",
          "1360:   return 0;",
          "1361:  }",
          "",
          "[Removed Lines]",
          "1349: #line 1350 \"ext/standard/var_unserializer.c\"",
          "1352: #line 805 \"ext/standard/var_unserializer.re\"",
          "1359:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "1353: #line 1354 \"ext/standard/var_unserializer.c\"",
          "1356: #line 809 \"ext/standard/var_unserializer.re\"",
          "1363:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1374:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1375: }",
          "1377: yy88:",
          "1378:  yych = *++YYCURSOR;",
          "1379:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1376: #line 1377 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1380: #line 1381 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1398:  goto yy18;",
          "1399: yy92:",
          "1400:  ++YYCURSOR;",
          "1402:  {",
          "1403:  long elements;",
          "1404:     if (!var_hash) return 0;",
          "1406:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1408:   return 0;",
          "1409:  }",
          "1410:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1411: }",
          "1413: yy94:",
          "1414:  ++YYCURSOR;",
          "1416:  {",
          "1417:  size_t len, maxlen;",
          "1418:  char *str;",
          "",
          "[Removed Lines]",
          "1401: #line 829 \"ext/standard/var_unserializer.re\"",
          "1407:  if (elements < 0) {",
          "1412: #line 1413 \"ext/standard/var_unserializer.c\"",
          "1415: #line 739 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1405: #line 833 \"ext/standard/var_unserializer.re\"",
          "1411:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1416: #line 1417 \"ext/standard/var_unserializer.c\"",
          "1419: #line 743 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1444:  ZVAL_STRINGL(rval, str, len);",
          "1445:  return 1;",
          "1446: }",
          "1448: yy96:",
          "1449:  yych = *++YYCURSOR;",
          "1450:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1447: #line 1448 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1451: #line 1452 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1452:  goto yy18;",
          "1453: yy97:",
          "1454:  ++YYCURSOR;",
          "1456:  {",
          "",
          "[Removed Lines]",
          "1455: #line 714 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1459: #line 718 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1469:  return 1;",
          "1470: }",
          "1472: }",
          "1476:  return 0;",
          "",
          "[Removed Lines]",
          "1471: #line 1472 \"ext/standard/var_unserializer.c\"",
          "1473: #line 1000 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1475: #line 1476 \"ext/standard/var_unserializer.c\"",
          "1477: #line 1004 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "552:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "554:  ht = Z_OBJPROP_P(rval);",
          "555:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "556:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "557:   if (has_wakeup) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "555:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "556:   return 0;",
          "557:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "809:     if (!var_hash) return 0;",
          "812:   return 0;",
          "813:  }",
          "",
          "[Removed Lines]",
          "811:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "815:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "831:     if (!var_hash) return 0;",
          "833:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "835:   return 0;",
          "836:  }",
          "837:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "",
          "[Removed Lines]",
          "834:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "838:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e2e99f16e1cea47cc363483d26acfd41f5d2e814",
      "candidate_info": {
        "commit_hash": "e2e99f16e1cea47cc363483d26acfd41f5d2e814",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/e2e99f16e1cea47cc363483d26acfd41f5d2e814",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Cleanup: removed deprecated commented code",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "99:     return &var_hash->data[var_hash->used_slots++];",
          "100: }",
          "136: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "137: {",
          "138:  zend_long i;",
          "",
          "[Removed Lines]",
          "103: #if 0",
          "104: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "105: {",
          "106:  var_entries *var_hash;",
          "108:     if (!var_hashx || !*var_hashx) {",
          "109:         return;",
          "110:     }",
          "112:     var_hash = (*var_hashx)->last_dtor;",
          "113: #if VAR_ENTRIES_DBG",
          "114:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "115: #endif",
          "117:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "118:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "119:   var_hash->used_slots = 0;",
          "120:   var_hash->next = 0;",
          "122:   if (!(*var_hashx)->first_dtor) {",
          "123:    (*var_hashx)->first_dtor = var_hash;",
          "124:   } else {",
          "125:    ((var_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "126:   }",
          "128:   (*var_hashx)->last_dtor = var_hash;",
          "129:  }",
          "131:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "132:  var_hash->used_slots++;",
          "133: }",
          "134: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "272: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "275: #line 280 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "241: #line 246 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "539:  start = cursor;",
          "543: {",
          "544:  YYCTYPE yych;",
          "545:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "542: #line 543 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "508: #line 509 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "599:  yych = *(YYMARKER = ++YYCURSOR);",
          "600:  if (yych == ':') goto yy95;",
          "601: yy3:",
          "603:  { return 0; }",
          "605: yy4:",
          "606:  yych = *(YYMARKER = ++YYCURSOR);",
          "607:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "602: #line 895 \"ext/standard/var_unserializer.re\"",
          "604: #line 605 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "568: #line 851 \"ext/standard/var_unserializer.re\"",
          "570: #line 571 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "644:  goto yy3;",
          "645: yy14:",
          "646:  ++YYCURSOR;",
          "648:  {",
          "650:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "652: }",
          "654: yy16:",
          "655:  yych = *++YYCURSOR;",
          "656:  goto yy3;",
          "",
          "[Removed Lines]",
          "647: #line 889 \"ext/standard/var_unserializer.re\"",
          "653: #line 654 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "613: #line 845 \"ext/standard/var_unserializer.re\"",
          "619: #line 620 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "680:  yych = *++YYCURSOR;",
          "681:  if (yych != '\"') goto yy18;",
          "682:  ++YYCURSOR;",
          "684:  {",
          "685:  size_t len, len2, len3, maxlen;",
          "686:  zend_long elements;",
          "",
          "[Removed Lines]",
          "683: #line 743 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "649: #line 700 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "827:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "828: }",
          "830: yy25:",
          "831:  yych = *++YYCURSOR;",
          "832:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "829: #line 830 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "794: #line 795 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "851:  yych = *++YYCURSOR;",
          "852:  if (yych != '\"') goto yy18;",
          "853:  ++YYCURSOR;",
          "855:  {",
          "856:     if (!var_hash) return 0;",
          "860:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "861:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "862: }",
          "864: yy32:",
          "865:  yych = *++YYCURSOR;",
          "866:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "854: #line 734 \"ext/standard/var_unserializer.re\"",
          "863: #line 864 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "819: #line 693 \"ext/standard/var_unserializer.re\"",
          "826: #line 827 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "881:  yych = *++YYCURSOR;",
          "882:  if (yych != '{') goto yy18;",
          "883:  ++YYCURSOR;",
          "885:  {",
          "886:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "884: #line 710 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "847: #line 669 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "906:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "907: }",
          "909: yy39:",
          "910:  yych = *++YYCURSOR;",
          "911:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "908: #line 909 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "871: #line 872 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "926:  yych = *++YYCURSOR;",
          "927:  if (yych != '\"') goto yy18;",
          "928:  ++YYCURSOR;",
          "930:  {",
          "931:  size_t len, maxlen;",
          "932:  zend_string *str;",
          "",
          "[Removed Lines]",
          "929: #line 682 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "892: #line 641 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "954:  ZVAL_STR(rval, str);",
          "955:  return 1;",
          "956: }",
          "958: yy46:",
          "959:  yych = *++YYCURSOR;",
          "960:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "957: #line 958 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "920: #line 921 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "975:  yych = *++YYCURSOR;",
          "976:  if (yych != '\"') goto yy18;",
          "977:  ++YYCURSOR;",
          "979:  {",
          "980:  size_t len, maxlen;",
          "981:  char *str;",
          "",
          "[Removed Lines]",
          "978: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "941: #line 614 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1002:  ZVAL_STRINGL(rval, str, len);",
          "1003:  return 1;",
          "1004: }",
          "1006: yy53:",
          "1007:  yych = *++YYCURSOR;",
          "1008:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "1005: #line 1006 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "968: #line 969 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1090:  }",
          "1091: yy63:",
          "1092:  ++YYCURSOR;",
          "1094:  {",
          "1095: #if SIZEOF_ZEND_LONG == 4",
          "1096: use_double:",
          "",
          "[Removed Lines]",
          "1093: #line 646 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1056: #line 605 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1099:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1100:  return 1;",
          "1101: }",
          "1103: yy65:",
          "1104:  yych = *++YYCURSOR;",
          "1105:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1102: #line 1103 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1065: #line 1066 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1158:  yych = *++YYCURSOR;",
          "1159:  if (yych != ';') goto yy18;",
          "1160:  ++YYCURSOR;",
          "1162:  {",
          "",
          "[Removed Lines]",
          "1161: #line 630 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1124: #line 589 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1175:  return 1;",
          "1176: }",
          "1178: yy76:",
          "1179:  yych = *++YYCURSOR;",
          "1180:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1177: #line 1178 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1140: #line 1141 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1201:  if (yych <= '9') goto yy79;",
          "1202:  if (yych != ';') goto yy18;",
          "1203:  ++YYCURSOR;",
          "1205:  {",
          "1206: #if SIZEOF_ZEND_LONG == 4",
          "1207:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1204: #line 604 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1167: #line 563 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1227:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1228:  return 1;",
          "1229: }",
          "1231: yy83:",
          "1232:  yych = *++YYCURSOR;",
          "1233:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1235:  yych = *++YYCURSOR;",
          "1236:  if (yych != ';') goto yy18;",
          "1237:  ++YYCURSOR;",
          "1239:  {",
          "1241:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1242:  return 1;",
          "1243: }",
          "1245: yy87:",
          "1246:  ++YYCURSOR;",
          "1248:  {",
          "1250:  ZVAL_NULL(rval);",
          "1251:  return 1;",
          "1252: }",
          "1254: yy89:",
          "1255:  yych = *++YYCURSOR;",
          "1256:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1238: #line 598 \"ext/standard/var_unserializer.re\"",
          "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
          "1247: #line 592 \"ext/standard/var_unserializer.re\"",
          "1253: #line 1254 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1201: #line 557 \"ext/standard/var_unserializer.re\"",
          "1207: #line 1208 \"ext/standard/var_unserializer.c\"",
          "1210: #line 551 \"ext/standard/var_unserializer.re\"",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1273:  if (yych <= '9') goto yy91;",
          "1274:  if (yych != ';') goto yy18;",
          "1275:  ++YYCURSOR;",
          "1277:  {",
          "1278:  zend_long id;",
          "",
          "[Removed Lines]",
          "1276: #line 569 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1239: #line 535 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1285:   return 0;",
          "1286:  }",
          "1294:  ZVAL_COPY(rval, rval_ref);",
          "1297:  return 1;",
          "1298: }",
          "1300: yy95:",
          "1301:  yych = *++YYCURSOR;",
          "1302:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1299: #line 1300 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1255: #line 1256 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1319:  if (yych <= '9') goto yy97;",
          "1320:  if (yych != ';') goto yy18;",
          "1321:  ++YYCURSOR;",
          "1323:  {",
          "1324:  zend_long id;",
          "",
          "[Removed Lines]",
          "1322: #line 547 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1278: #line 513 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1342:  return 1;",
          "1343: }",
          "1345: }",
          "1349:  return 0;",
          "",
          "[Removed Lines]",
          "1344: #line 1345 \"ext/standard/var_unserializer.c\"",
          "1346: #line 897 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1300: #line 1301 \"ext/standard/var_unserializer.c\"",
          "1302: #line 853 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "97:     return &var_hash->data[var_hash->used_slots++];",
          "98: }",
          "134: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "135: {",
          "136:  zend_long i;",
          "",
          "[Removed Lines]",
          "101: #if 0",
          "102: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "103: {",
          "104:  var_entries *var_hash;",
          "106:     if (!var_hashx || !*var_hashx) {",
          "107:         return;",
          "108:     }",
          "110:     var_hash = (*var_hashx)->last_dtor;",
          "111: #if VAR_ENTRIES_DBG",
          "112:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "113: #endif",
          "115:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "116:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "117:   var_hash->used_slots = 0;",
          "118:   var_hash->next = 0;",
          "120:   if (!(*var_hashx)->first_dtor) {",
          "121:    (*var_hashx)->first_dtor = var_hash;",
          "122:   } else {",
          "123:    ((var_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "124:   }",
          "126:   (*var_hashx)->last_dtor = var_hash;",
          "127:  }",
          "129:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "130:  var_hash->used_slots++;",
          "131: }",
          "132: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "24540362b0da5d9bcc41fa043152e69b2e0ca986",
      "candidate_info": {
        "commit_hash": "24540362b0da5d9bcc41fa043152e69b2e0ca986",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/24540362b0da5d9bcc41fa043152e69b2e0ca986",
        "files": [
          "ext/standard/php_var.h",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Re-fixed unserialize",
        "before_after_code_files": [
          "ext/standard/php_var.h||ext/standard/php_var.h",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/php_var.h||ext/standard/php_var.h": [
          "File: ext/standard/php_var.h -> ext/standard/php_var.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "52: PHPAPI void php_var_serialize(smart_str *buf, zval *struc, php_serialize_data_t *var_hash TSRMLS_DC);",
          "53: PHPAPI int php_var_unserialize(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "55: #define PHP_VAR_SERIALIZE_INIT(var_hash_ptr) \\",
          "56: do  { \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "54: PHPAPI int php_var_unserialize_intern(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "113:  } \\",
          "114: } while (0)",
          "117: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hash, zval *val);",
          "118: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval);",
          "119: PHPAPI void var_destroy(php_unserialize_data_t *var_hash);",
          "124: PHPAPI zend_class_entry *php_create_empty_class(char *class_name, int len);",
          "",
          "[Removed Lines]",
          "116: PHPAPI void var_replace(php_unserialize_data_t *var_hash, zval *ozval, zval *nzval);",
          "121: #define PHP_VAR_UNSERIALIZE_ZVAL_CHANGED(var_hash, ozval, nzval) \\",
          "122:  var_replace((var_hash), (ozval), &(nzval))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #define VAR_ENTRIES_DBG 0",
          "31: typedef struct {",
          "33:  long used_slots;",
          "34:  void *next;",
          "35: } var_entries;",
          "38: {",
          "39:  var_entries *var_hash = (*var_hashx)->last;",
          "40: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "32:  zval *data[VAR_ENTRIES_MAX];",
          "37: static inline void var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Added Lines]",
          "32:  zval data[VAR_ENTRIES_MAX];",
          "37: static inline zval *var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "55:   (*var_hashx)->last = var_hash;",
          "56:  }",
          "59: }",
          "61: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "58:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "58:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "59:  return &var_hash->data[var_hash->used_slots++];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "79:   (*var_hashx)->last_dtor = var_hash;",
          "80:  }",
          "84: }",
          "86: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "82:  Z_ADDREF_P(rval);",
          "83:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "83:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "84:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "104:   (*var_hashx)->last_dtor = var_hash;",
          "105:  }",
          "127: }",
          "129: static int var_access(php_unserialize_data_t *var_hashx, long id, zval **store)",
          "",
          "[Removed Lines]",
          "107:  var_hash->data[var_hash->used_slots++] = rval;",
          "108: }",
          "110: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "111: {",
          "112:  long i;",
          "113:  var_entries *var_hash = (*var_hashx)->first;",
          "114: #if VAR_ENTRIES_DBG",
          "115:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "116: #endif",
          "118:  while (var_hash) {",
          "119:   for (i = 0; i < var_hash->used_slots; i++) {",
          "120:    if (var_hash->data[i] == ozval) {",
          "121:     var_hash->data[i] = nzval;",
          "123:    }",
          "124:   }",
          "125:   var_hash = var_hash->next;",
          "126:  }",
          "",
          "[Added Lines]",
          "108:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "109:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "167:  while (var_hash) {",
          "168:   for (i = 0; i < var_hash->used_slots; i++) {",
          "170:   }",
          "171:   next = var_hash->next;",
          "172:   efree(var_hash);",
          "",
          "[Removed Lines]",
          "169:    zval_ptr_dtor(var_hash->data[i]);",
          "",
          "[Added Lines]",
          "152:    zval_ptr_dtor(&var_hash->data[i]);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "226: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "229: #line 234 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "212: #line 217 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "292: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long elements, int objprops)",
          "293: {",
          "294:  while (elements-- > 0) {",
          "299:    return 0;",
          "300:   }",
          "",
          "[Removed Lines]",
          "295:   zval key, data, *old_data;",
          "297:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "298:    zval_dtor(&key);",
          "",
          "[Added Lines]",
          "278:   zval key, *data, d, *old_data;",
          "280:   if (!php_var_unserialize_intern(&key, p, max, NULL TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "304:    return 0;",
          "305:   }",
          "309:    zval_dtor(&key);",
          "310:    return 0;",
          "311:   }",
          "",
          "[Removed Lines]",
          "307:   ZVAL_UNDEF(&data);",
          "308:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "289:   if (var_hash && (*p)[0] != 'R') {",
          "290:    data = var_push(var_hash, data);",
          "291:   } else {",
          "292:    data = &d;",
          "293:   }",
          "295:   ZVAL_UNDEF(data);",
          "296:   if (!php_var_unserialize_intern(data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "316:     if ((old_data = zend_hash_index_find(ht, Z_LVAL(key))) != NULL) {",
          "317:      var_push_dtor(var_hash, old_data);",
          "318:     }",
          "320:     break;",
          "321:    case IS_STRING:",
          "322:     if ((old_data = zend_symtable_find(ht, Z_STR(key))) != NULL) {",
          "323:      var_push_dtor(var_hash, old_data);",
          "324:     }",
          "326:     break;",
          "327:    }",
          "328:   } else {",
          "330:    convert_to_string(&key);",
          "332:   }",
          "334:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "319:     zend_hash_index_update(ht, Z_LVAL(key), &data);",
          "325:     zend_symtable_update(ht, Z_STR(key), &data);",
          "331:    zend_hash_update(ht, Z_STR(key), &data);",
          "",
          "[Added Lines]",
          "307:     zend_hash_index_update(ht, Z_LVAL(key), data);",
          "313:     zend_symtable_update(ht, Z_STR(key), data);",
          "319:    zend_hash_update(ht, Z_STR(key), data);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "425: #endif",
          "427: PHPAPI int php_var_unserialize(UNSERIALIZE_PARAMETER)",
          "428: {",
          "429:  const unsigned char *cursor, *limit, *marker, *start;",
          "430:  zval *rval_ref;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "416: {",
          "417:  if (var_hash && (*p)[0] != 'R') {",
          "418:   var_push(var_hash, rval);",
          "419:  }",
          "421:  return php_var_unserialize_intern(UNSERIALIZE_PASSTHRU);",
          "422: }",
          "424: PHPAPI int php_var_unserialize_intern(UNSERIALIZE_PARAMETER)",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "436:   return 0;",
          "437:  }",
          "443:  start = cursor;",
          "449: {",
          "450:  YYCTYPE yych;",
          "451:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "439:  if (var_hash && cursor[0] != 'R') {",
          "440:   var_push(var_hash, rval);",
          "441:  }",
          "448: #line 449 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "439: #line 440 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "505:  yych = *(YYMARKER = ++YYCURSOR);",
          "506:  if (yych == ':') goto yy95;",
          "507: yy3:",
          "509:  { return 0; }",
          "511: yy4:",
          "512:  yych = *(YYMARKER = ++YYCURSOR);",
          "513:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "508: #line 786 \"ext/standard/var_unserializer.re\"",
          "510: #line 511 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "499: #line 777 \"ext/standard/var_unserializer.re\"",
          "501: #line 502 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "550:  goto yy3;",
          "551: yy14:",
          "552:  ++YYCURSOR;",
          "554:  {",
          "556:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "558: }",
          "560: yy16:",
          "561:  yych = *++YYCURSOR;",
          "562:  goto yy3;",
          "",
          "[Removed Lines]",
          "553: #line 780 \"ext/standard/var_unserializer.re\"",
          "559: #line 560 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "544: #line 771 \"ext/standard/var_unserializer.re\"",
          "550: #line 551 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "586:  yych = *++YYCURSOR;",
          "587:  if (yych != '\"') goto yy18;",
          "588:  ++YYCURSOR;",
          "590:  {",
          "591:  size_t len, len2, len3, maxlen;",
          "592:  long elements;",
          "",
          "[Removed Lines]",
          "589: #line 641 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "580: #line 632 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "726:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "727: }",
          "729: yy25:",
          "730:  yych = *++YYCURSOR;",
          "731:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "728: #line 729 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "719: #line 720 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "750:  yych = *++YYCURSOR;",
          "751:  if (yych != '\"') goto yy18;",
          "752:  ++YYCURSOR;",
          "754:  {",
          "",
          "[Removed Lines]",
          "753: #line 633 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "744: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "758:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "759:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "760: }",
          "762: yy32:",
          "763:  yych = *++YYCURSOR;",
          "764:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "761: #line 762 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "752: #line 753 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "779:  yych = *++YYCURSOR;",
          "780:  if (yych != '{') goto yy18;",
          "781:  ++YYCURSOR;",
          "783:  {",
          "784:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "782: #line 615 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "773: #line 606 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "798:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "799: }",
          "801: yy39:",
          "802:  yych = *++YYCURSOR;",
          "803:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "800: #line 801 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "791: #line 792 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "818:  yych = *++YYCURSOR;",
          "819:  if (yych != '\"') goto yy18;",
          "820:  ++YYCURSOR;",
          "822:  {",
          "823:  size_t len, maxlen;",
          "824:  char *str;",
          "",
          "[Removed Lines]",
          "821: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "812: #line 577 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "847:  ZVAL_STRINGL(rval, str, len);",
          "848:  return 1;",
          "849: }",
          "851: yy46:",
          "852:  yych = *++YYCURSOR;",
          "853:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "850: #line 851 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "841: #line 842 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "868:  yych = *++YYCURSOR;",
          "869:  if (yych != '\"') goto yy18;",
          "870:  ++YYCURSOR;",
          "872:  {",
          "873:  size_t len, maxlen;",
          "874:  char *str;",
          "",
          "[Removed Lines]",
          "871: #line 559 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "862: #line 550 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "895:  ZVAL_STRINGL(rval, str, len);",
          "896:  return 1;",
          "897: }",
          "899: yy53:",
          "900:  yych = *++YYCURSOR;",
          "901:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "898: #line 899 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "889: #line 890 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "983:  }",
          "984: yy63:",
          "985:  ++YYCURSOR;",
          "987:  {",
          "988: #if SIZEOF_LONG == 4",
          "989: use_double:",
          "",
          "[Removed Lines]",
          "986: #line 550 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "977: #line 541 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "992:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "993:  return 1;",
          "994: }",
          "996: yy65:",
          "997:  yych = *++YYCURSOR;",
          "998:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "995: #line 996 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "986: #line 987 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1051:  yych = *++YYCURSOR;",
          "1052:  if (yych != ';') goto yy18;",
          "1053:  ++YYCURSOR;",
          "1055:  {",
          "",
          "[Removed Lines]",
          "1054: #line 534 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1045: #line 525 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1068:  return 1;",
          "1069: }",
          "1071: yy76:",
          "1072:  yych = *++YYCURSOR;",
          "1073:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1070: #line 1071 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1061: #line 1062 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1094:  if (yych <= '9') goto yy79;",
          "1095:  if (yych != ';') goto yy18;",
          "1096:  ++YYCURSOR;",
          "1098:  {",
          "1099: #if SIZEOF_LONG == 4",
          "1100:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1097: #line 508 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1088: #line 499 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1120:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1121:  return 1;",
          "1122: }",
          "1124: yy83:",
          "1125:  yych = *++YYCURSOR;",
          "1126:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1123: #line 1124 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "1128:  yych = *++YYCURSOR;",
          "1129:  if (yych != ';') goto yy18;",
          "1130:  ++YYCURSOR;",
          "1132:  {",
          "1134:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1135:  return 1;",
          "1136: }",
          "1138: yy87:",
          "1139:  ++YYCURSOR;",
          "1141:  {",
          "1143:  ZVAL_NULL(rval);",
          "1144:  return 1;",
          "1145: }",
          "1147: yy89:",
          "1148:  yych = *++YYCURSOR;",
          "1149:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1131: #line 502 \"ext/standard/var_unserializer.re\"",
          "1137: #line 1138 \"ext/standard/var_unserializer.c\"",
          "1140: #line 496 \"ext/standard/var_unserializer.re\"",
          "1146: #line 1147 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1122: #line 493 \"ext/standard/var_unserializer.re\"",
          "1128: #line 1129 \"ext/standard/var_unserializer.c\"",
          "1131: #line 487 \"ext/standard/var_unserializer.re\"",
          "1137: #line 1138 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "1166:  if (yych <= '9') goto yy91;",
          "1167:  if (yych != ';') goto yy18;",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1171:  long id;",
          "",
          "[Removed Lines]",
          "1169: #line 473 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1160: #line 464 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "1190:  return 1;",
          "1191: }",
          "1193: yy95:",
          "1194:  yych = *++YYCURSOR;",
          "1195:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1192: #line 1193 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1183: #line 1184 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "1212:  if (yych <= '9') goto yy97;",
          "1213:  if (yych != ';') goto yy18;",
          "1214:  ++YYCURSOR;",
          "1216:  {",
          "1217:  long id;",
          "",
          "[Removed Lines]",
          "1215: #line 453 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1206: #line 444 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "1233:  return 1;",
          "1234: }",
          "1236: }",
          "1240:  return 0;",
          "",
          "[Removed Lines]",
          "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
          "1237: #line 788 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1226: #line 1227 \"ext/standard/var_unserializer.c\"",
          "1228: #line 779 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "27: #define VAR_ENTRIES_DBG 0",
          "29: typedef struct {",
          "31:  long used_slots;",
          "32:  void *next;",
          "33: } var_entries;",
          "36: {",
          "37:  var_entries *var_hash = (*var_hashx)->last;",
          "38: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "30:  zval *data[VAR_ENTRIES_MAX];",
          "35: static inline void var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Added Lines]",
          "30:  zval data[VAR_ENTRIES_MAX];",
          "35: static inline zval *var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "53:   (*var_hashx)->last = var_hash;",
          "54:  }",
          "57: }",
          "59: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "56:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "56:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "57:  return &var_hash->data[var_hash->used_slots++];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "77:   (*var_hashx)->last_dtor = var_hash;",
          "78:  }",
          "82: }",
          "84: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "80:  Z_ADDREF_P(rval);",
          "81:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "81:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "82:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "102:   (*var_hashx)->last_dtor = var_hash;",
          "103:  }",
          "125: }",
          "127: static int var_access(php_unserialize_data_t *var_hashx, long id, zval **store)",
          "",
          "[Removed Lines]",
          "105:  var_hash->data[var_hash->used_slots++] = rval;",
          "106: }",
          "108: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "109: {",
          "110:  long i;",
          "111:  var_entries *var_hash = (*var_hashx)->first;",
          "112: #if VAR_ENTRIES_DBG",
          "113:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "114: #endif",
          "116:  while (var_hash) {",
          "117:   for (i = 0; i < var_hash->used_slots; i++) {",
          "118:    if (var_hash->data[i] == ozval) {",
          "119:     var_hash->data[i] = nzval;",
          "121:    }",
          "122:   }",
          "123:   var_hash = var_hash->next;",
          "124:  }",
          "",
          "[Added Lines]",
          "106:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "107:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "165:  while (var_hash) {",
          "166:   for (i = 0; i < var_hash->used_slots; i++) {",
          "168:   }",
          "169:   next = var_hash->next;",
          "170:   efree(var_hash);",
          "",
          "[Removed Lines]",
          "167:    zval_ptr_dtor(var_hash->data[i]);",
          "",
          "[Added Lines]",
          "150:    zval_ptr_dtor(&var_hash->data[i]);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "296: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long elements, int objprops)",
          "297: {",
          "298:  while (elements-- > 0) {",
          "303:    return 0;",
          "304:   }",
          "",
          "[Removed Lines]",
          "299:   zval key, data, *old_data;",
          "301:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "302:    zval_dtor(&key);",
          "",
          "[Added Lines]",
          "282:   zval key, *data, d, *old_data;",
          "284:   if (!php_var_unserialize_intern(&key, p, max, NULL TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "308:    return 0;",
          "309:   }",
          "313:    zval_dtor(&key);",
          "314:    return 0;",
          "315:   }",
          "",
          "[Removed Lines]",
          "311:   ZVAL_UNDEF(&data);",
          "312:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "293:   if (var_hash && (*p)[0] != 'R') {",
          "294:    data = var_push(var_hash, data);",
          "295:   } else {",
          "296:    data = &d;",
          "297:   }",
          "299:   ZVAL_UNDEF(data);",
          "300:   if (!php_var_unserialize_intern(data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "320:     if ((old_data = zend_hash_index_find(ht, Z_LVAL(key))) != NULL) {",
          "321:      var_push_dtor(var_hash, old_data);",
          "322:     }",
          "324:     break;",
          "325:    case IS_STRING:",
          "326:     if ((old_data = zend_symtable_find(ht, Z_STR(key))) != NULL) {",
          "327:      var_push_dtor(var_hash, old_data);",
          "328:     }",
          "330:     break;",
          "331:    }",
          "332:   } else {",
          "334:    convert_to_string(&key);",
          "336:   }",
          "338:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "323:     zend_hash_index_update(ht, Z_LVAL(key), &data);",
          "329:     zend_symtable_update(ht, Z_STR(key), &data);",
          "335:    zend_hash_update(ht, Z_STR(key), &data);",
          "",
          "[Added Lines]",
          "311:     zend_hash_index_update(ht, Z_LVAL(key), data);",
          "317:     zend_symtable_update(ht, Z_STR(key), data);",
          "323:    zend_hash_update(ht, Z_STR(key), data);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "429: #endif",
          "431: PHPAPI int php_var_unserialize(UNSERIALIZE_PARAMETER)",
          "432: {",
          "433:  const unsigned char *cursor, *limit, *marker, *start;",
          "434:  zval *rval_ref;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "420: {",
          "421:  if (var_hash && (*p)[0] != 'R') {",
          "422:   var_push(var_hash, rval);",
          "423:  }",
          "425:  return php_var_unserialize_intern(UNSERIALIZE_PASSTHRU);",
          "426: }",
          "428: PHPAPI int php_var_unserialize_intern(UNSERIALIZE_PARAMETER)",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "440:   return 0;",
          "441:  }",
          "447:  start = cursor;",
          "453: \"R:\" iv \";\"  {",
          "",
          "[Removed Lines]",
          "443:  if (var_hash && cursor[0] != 'R') {",
          "444:   var_push(var_hash, rval);",
          "445:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7f527d8047564ab2d36a3cdfd77c96c09a93c9e2",
      "candidate_info": {
        "commit_hash": "7f527d8047564ab2d36a3cdfd77c96c09a93c9e2",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/7f527d8047564ab2d36a3cdfd77c96c09a93c9e2",
        "files": [
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed reference handling in serialize/unserialize",
        "before_after_code_files": [
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "724:  }",
          "726:  ZVAL_UNDEF(&var_already);",
          "728:   if (Z_ISREF_P(struc)) {",
          "729:    smart_str_appendl(buf, \"R:\", 2);",
          "730:    smart_str_append_long(buf, Z_LVAL(var_already));",
          "",
          "[Removed Lines]",
          "727:  if (var_hash && php_add_var_hash(var_hash, struc, &var_already TSRMLS_CC) == FAILURE) {",
          "",
          "[Added Lines]",
          "728:  if (var_hash &&",
          "729:   php_add_var_hash(var_hash, Z_ISREF_P(struc)? Z_REFVAL_P(struc) : struc, &var_already TSRMLS_CC) == FAILURE) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "738:   }",
          "739:  }",
          "741:  switch (Z_TYPE_P(struc)) {",
          "742:   case IS_BOOL:",
          "743:    smart_str_appendl(buf, \"b:\", 2);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "743: again:",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "899:    smart_str_appendc(buf, '}');",
          "900:    return;",
          "901:   }",
          "902:   default:",
          "903:    smart_str_appendl(buf, \"i:0;\", 4);",
          "904:    return;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "905:   case IS_REFERENCE:",
          "906:    struc = Z_REFVAL_P(struc);",
          "907:    goto again;",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "304:    return 0;",
          "305:   }",
          "307:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "308:    zval_dtor(&key);",
          "309:    return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "307:   ZVAL_UNDEF(&data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "448: {",
          "449:  YYCTYPE yych;",
          "450:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "447: #line 448 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "448: #line 449 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "504:  yych = *(YYMARKER = ++YYCURSOR);",
          "505:  if (yych == ':') goto yy95;",
          "506: yy3:",
          "508:  { return 0; }",
          "510: yy4:",
          "511:  yych = *(YYMARKER = ++YYCURSOR);",
          "512:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "507: #line 785 \"ext/standard/var_unserializer.re\"",
          "509: #line 510 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "508: #line 786 \"ext/standard/var_unserializer.re\"",
          "510: #line 511 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "549:  goto yy3;",
          "550: yy14:",
          "551:  ++YYCURSOR;",
          "553:  {",
          "555:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "557: }",
          "559: yy16:",
          "560:  yych = *++YYCURSOR;",
          "561:  goto yy3;",
          "",
          "[Removed Lines]",
          "552: #line 779 \"ext/standard/var_unserializer.re\"",
          "558: #line 559 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "553: #line 780 \"ext/standard/var_unserializer.re\"",
          "559: #line 560 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "585:  yych = *++YYCURSOR;",
          "586:  if (yych != '\"') goto yy18;",
          "587:  ++YYCURSOR;",
          "589:  {",
          "590:  size_t len, len2, len3, maxlen;",
          "591:  long elements;",
          "",
          "[Removed Lines]",
          "588: #line 640 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "589: #line 641 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "725:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "726: }",
          "728: yy25:",
          "729:  yych = *++YYCURSOR;",
          "730:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "727: #line 728 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "728: #line 729 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "749:  yych = *++YYCURSOR;",
          "750:  if (yych != '\"') goto yy18;",
          "751:  ++YYCURSOR;",
          "753:  {",
          "",
          "[Removed Lines]",
          "752: #line 632 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "753: #line 633 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "757:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "758:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "759: }",
          "761: yy32:",
          "762:  yych = *++YYCURSOR;",
          "763:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "760: #line 761 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "761: #line 762 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "778:  yych = *++YYCURSOR;",
          "779:  if (yych != '{') goto yy18;",
          "780:  ++YYCURSOR;",
          "782:  {",
          "783:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "781: #line 614 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "782: #line 615 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "797:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "798: }",
          "800: yy39:",
          "801:  yych = *++YYCURSOR;",
          "802:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "799: #line 800 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "800: #line 801 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "817:  yych = *++YYCURSOR;",
          "818:  if (yych != '\"') goto yy18;",
          "819:  ++YYCURSOR;",
          "821:  {",
          "822:  size_t len, maxlen;",
          "823:  char *str;",
          "",
          "[Removed Lines]",
          "820: #line 585 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "821: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "846:  ZVAL_STRINGL(rval, str, len);",
          "847:  return 1;",
          "848: }",
          "850: yy46:",
          "851:  yych = *++YYCURSOR;",
          "852:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "849: #line 850 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "850: #line 851 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "867:  yych = *++YYCURSOR;",
          "868:  if (yych != '\"') goto yy18;",
          "869:  ++YYCURSOR;",
          "871:  {",
          "872:  size_t len, maxlen;",
          "873:  char *str;",
          "",
          "[Removed Lines]",
          "870: #line 558 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "871: #line 559 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "894:  ZVAL_STRINGL(rval, str, len);",
          "895:  return 1;",
          "896: }",
          "898: yy53:",
          "899:  yych = *++YYCURSOR;",
          "900:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "897: #line 898 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "898: #line 899 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "982:  }",
          "983: yy63:",
          "984:  ++YYCURSOR;",
          "986:  {",
          "987: #if SIZEOF_LONG == 4",
          "988: use_double:",
          "",
          "[Removed Lines]",
          "985: #line 549 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "986: #line 550 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "991:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "992:  return 1;",
          "993: }",
          "995: yy65:",
          "996:  yych = *++YYCURSOR;",
          "997:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "994: #line 995 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "995: #line 996 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1050:  yych = *++YYCURSOR;",
          "1051:  if (yych != ';') goto yy18;",
          "1052:  ++YYCURSOR;",
          "1054:  {",
          "",
          "[Removed Lines]",
          "1053: #line 533 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1054: #line 534 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1067:  return 1;",
          "1068: }",
          "1070: yy76:",
          "1071:  yych = *++YYCURSOR;",
          "1072:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1069: #line 1070 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1070: #line 1071 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1093:  if (yych <= '9') goto yy79;",
          "1094:  if (yych != ';') goto yy18;",
          "1095:  ++YYCURSOR;",
          "1097:  {",
          "1098: #if SIZEOF_LONG == 4",
          "1099:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1096: #line 507 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1097: #line 508 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1119:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1120:  return 1;",
          "1121: }",
          "1123: yy83:",
          "1124:  yych = *++YYCURSOR;",
          "1125:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1122: #line 1123 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1123: #line 1124 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1127:  yych = *++YYCURSOR;",
          "1128:  if (yych != ';') goto yy18;",
          "1129:  ++YYCURSOR;",
          "1131:  {",
          "1133:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1134:  return 1;",
          "1135: }",
          "1137: yy87:",
          "1138:  ++YYCURSOR;",
          "1140:  {",
          "1142:  ZVAL_NULL(rval);",
          "1143:  return 1;",
          "1144: }",
          "1146: yy89:",
          "1147:  yych = *++YYCURSOR;",
          "1148:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1130: #line 501 \"ext/standard/var_unserializer.re\"",
          "1136: #line 1137 \"ext/standard/var_unserializer.c\"",
          "1139: #line 495 \"ext/standard/var_unserializer.re\"",
          "1145: #line 1146 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1131: #line 502 \"ext/standard/var_unserializer.re\"",
          "1137: #line 1138 \"ext/standard/var_unserializer.c\"",
          "1140: #line 496 \"ext/standard/var_unserializer.re\"",
          "1146: #line 1147 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1165:  if (yych <= '9') goto yy91;",
          "1166:  if (yych != ';') goto yy18;",
          "1167:  ++YYCURSOR;",
          "1169:  {",
          "1170:  long id;",
          "",
          "[Removed Lines]",
          "1168: #line 472 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1169: #line 473 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1181:  if (rval == rval_ref) return 0;",
          "1184:   var_push_dtor_no_addref(var_hash, rval);",
          "1185:  }",
          "1186:  ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "1183:  if (rval != NULL) {",
          "",
          "[Added Lines]",
          "1184:  if (!ZVAL_IS_UNDEF(rval)) {",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1189:  return 1;",
          "1190: }",
          "1192: yy95:",
          "1193:  yych = *++YYCURSOR;",
          "1194:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1191: #line 1192 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1192: #line 1193 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1211:  if (yych <= '9') goto yy97;",
          "1212:  if (yych != ';') goto yy18;",
          "1213:  ++YYCURSOR;",
          "1215:  {",
          "1216:  long id;",
          "",
          "[Removed Lines]",
          "1214: #line 452 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1215: #line 453 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1223:   return 0;",
          "1224:  }",
          "1227:   zval_ptr_dtor(rval);",
          "1228:  }",
          "1229:  ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "1226:  if (rval != NULL) {",
          "",
          "[Added Lines]",
          "1227:  if (!ZVAL_IS_UNDEF(rval)) {",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1232:  return 1;",
          "1233: }",
          "1235: }",
          "1239:  return 0;",
          "",
          "[Removed Lines]",
          "1234: #line 1235 \"ext/standard/var_unserializer.c\"",
          "1236: #line 787 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
          "1237: #line 788 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "308:    return 0;",
          "309:   }",
          "311:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "312:    zval_dtor(&key);",
          "313:    return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "311:   ZVAL_UNDEF(&data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "460:   return 0;",
          "461:  }",
          "464:   zval_ptr_dtor(rval);",
          "465:  }",
          "466:  ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "463:  if (rval != NULL) {",
          "",
          "[Added Lines]",
          "464:  if (!ZVAL_IS_UNDEF(rval)) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "484:  if (rval == rval_ref) return 0;",
          "487:   var_push_dtor_no_addref(var_hash, rval);",
          "488:  }",
          "489:  ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "486:  if (rval != NULL) {",
          "",
          "[Added Lines]",
          "487:  if (!ZVAL_IS_UNDEF(rval)) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2c567eae283308bbc1cb9836546b8dbf0146932c",
      "candidate_info": {
        "commit_hash": "2c567eae283308bbc1cb9836546b8dbf0146932c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/2c567eae283308bbc1cb9836546b8dbf0146932c",
        "files": [
          "ext/standard/tests/serialize/bug74101.phpt",
          "ext/standard/tests/serialize/bug74614.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-7.0' into PHP-7.1\n\n* PHP-7.0:\n  Fixed bug #74101 and bug #74614",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug74101.phpt||ext/standard/tests/serialize/bug74101.phpt",
          "ext/standard/tests/serialize/bug74614.phpt||ext/standard/tests/serialize/bug74614.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug74101.phpt||ext/standard/tests/serialize/bug74101.phpt": [
          "File: ext/standard/tests/serialize/bug74101.phpt -> ext/standard/tests/serialize/bug74101.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74101: Unserialize Heap Use-After-Free (READ: 1) in zval_get_type",
          "3: --FILE--",
          "4: <?php",
          "5: $s = 'O:9:\"Exception\":799999999999999999999999999997:0i:0;a:0:{}i:2;i:0;i:0;R:2;';",
          "6: var_dump(unserialize($s));",
          "7: ?>",
          "8: --EXPECTF--",
          "9: Notice: unserialize(): Error at offset 48 of 74 bytes in %s on line %d",
          "10: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug74614.phpt||ext/standard/tests/serialize/bug74614.phpt": [
          "File: ext/standard/tests/serialize/bug74614.phpt -> ext/standard/tests/serialize/bug74614.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74614: Use-after-free in PHP7's unserialize()",
          "3: --FILE--",
          "4: <?php",
          "6: unserialize('a:3020000000000000000000000000000001:{i:0;a:0:{}i:1;i:2;i:2;i:3;i:3;i:4;i:4;i:5;i:5;i:6;i:6;i:7;i:7;i:8;i:8;R:2;}');",
          "8: ?>",
          "9: --EXPECTF--",
          "10: Notice: unserialize(): Error at offset 38 of 113 bytes in %s on line %d",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "548:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "550:  ht = Z_OBJPROP_P(rval);",
          "551:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "552:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "553:   if (has_wakeup) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "551:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "552:   return 0;",
          "553:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "617:  start = cursor;",
          "621: {",
          "622:  YYCTYPE yych;",
          "623:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "620: #line 621 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "624: #line 625 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "675: yy2:",
          "676:  ++YYCURSOR;",
          "677: yy3:",
          "679:  { return 0; }",
          "681: yy4:",
          "682:  yych = *(YYMARKER = ++YYCURSOR);",
          "683:  if (yych == ':') goto yy17;",
          "",
          "[Removed Lines]",
          "678: #line 998 \"ext/standard/var_unserializer.re\"",
          "680: #line 681 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "682: #line 1002 \"ext/standard/var_unserializer.re\"",
          "684: #line 685 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "724:  goto yy3;",
          "725: yy15:",
          "726:  ++YYCURSOR;",
          "728:  {",
          "730:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "732: }",
          "734: yy17:",
          "735:  yych = *++YYCURSOR;",
          "736:  if (yybm[0+yych] & 128) {",
          "",
          "[Removed Lines]",
          "727: #line 992 \"ext/standard/var_unserializer.re\"",
          "733: #line 734 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "731: #line 996 \"ext/standard/var_unserializer.re\"",
          "737: #line 738 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "742:  goto yy3;",
          "743: yy19:",
          "744:  ++YYCURSOR;",
          "746:  {",
          "748:  ZVAL_NULL(rval);",
          "749:  return 1;",
          "750: }",
          "752: yy21:",
          "753:  yych = *++YYCURSOR;",
          "754:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "745: #line 676 \"ext/standard/var_unserializer.re\"",
          "751: #line 752 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "749: #line 680 \"ext/standard/var_unserializer.re\"",
          "755: #line 756 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "998:  goto yy18;",
          "999: yy63:",
          "1000:  ++YYCURSOR;",
          "1002:  {",
          "1003:  zend_long id;",
          "",
          "[Removed Lines]",
          "1001: #line 625 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1005: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1025:  return 1;",
          "1026: }",
          "1028: yy65:",
          "1029:  yych = *++YYCURSOR;",
          "1030:  if (yych == '\"') goto yy84;",
          "",
          "[Removed Lines]",
          "1027: #line 1028 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1031: #line 1032 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1035:  goto yy18;",
          "1036: yy67:",
          "1037:  ++YYCURSOR;",
          "1039:  {",
          "1041:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1042:  return 1;",
          "1043: }",
          "1045: yy69:",
          "1046:  ++YYCURSOR;",
          "1047:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "",
          "[Removed Lines]",
          "1038: #line 682 \"ext/standard/var_unserializer.re\"",
          "1044: #line 1045 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1042: #line 686 \"ext/standard/var_unserializer.re\"",
          "1048: #line 1049 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1061:  }",
          "1062: yy71:",
          "1063:  ++YYCURSOR;",
          "1065:  {",
          "1066: #if SIZEOF_ZEND_LONG == 4",
          "1067: use_double:",
          "",
          "[Removed Lines]",
          "1064: #line 730 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1068: #line 734 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1070:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1071:  return 1;",
          "1072: }",
          "1074: yy73:",
          "1075:  yych = *++YYCURSOR;",
          "1076:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1073: #line 1074 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1077: #line 1078 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1092:  goto yy18;",
          "1093: yy76:",
          "1094:  ++YYCURSOR;",
          "1096:  {",
          "1097: #if SIZEOF_ZEND_LONG == 4",
          "1098:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1095: #line 688 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1099: #line 692 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1118:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1119:  return 1;",
          "1120: }",
          "1122: yy78:",
          "1123:  yych = *++YYCURSOR;",
          "1124:  if (yych == '\"') goto yy92;",
          "1125:  goto yy18;",
          "1126: yy79:",
          "1127:  ++YYCURSOR;",
          "1129:  {",
          "1130:  zend_long id;",
          "",
          "[Removed Lines]",
          "1121: #line 1122 \"ext/standard/var_unserializer.c\"",
          "1128: #line 651 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1125: #line 1126 \"ext/standard/var_unserializer.c\"",
          "1132: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1151:  return 1;",
          "1152: }",
          "1154: yy81:",
          "1155:  yych = *++YYCURSOR;",
          "1156:  if (yych == '\"') goto yy94;",
          "1157:  goto yy18;",
          "1158: yy82:",
          "1159:  ++YYCURSOR;",
          "1161:  {",
          "1162:  size_t len, len2, len3, maxlen;",
          "1163:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1153: #line 1154 \"ext/standard/var_unserializer.c\"",
          "1160: #line 840 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1157: #line 1158 \"ext/standard/var_unserializer.c\"",
          "1164: #line 844 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1310:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1311: }",
          "1313: yy84:",
          "1314:  ++YYCURSOR;",
          "1316:  {",
          "1317:  size_t len, maxlen;",
          "1318:  zend_string *str;",
          "",
          "[Removed Lines]",
          "1312: #line 1313 \"ext/standard/var_unserializer.c\"",
          "1315: #line 771 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1316: #line 1317 \"ext/standard/var_unserializer.c\"",
          "1319: #line 775 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1346:  ZVAL_STR(rval, str);",
          "1347:  return 1;",
          "1348: }",
          "1350: yy86:",
          "1351:  ++YYCURSOR;",
          "1353:  {",
          "1354:  zend_long elements = parse_iv(start + 2);",
          "1357:     if (!var_hash) return 0;",
          "1360:   return 0;",
          "1361:  }",
          "",
          "[Removed Lines]",
          "1349: #line 1350 \"ext/standard/var_unserializer.c\"",
          "1352: #line 805 \"ext/standard/var_unserializer.re\"",
          "1359:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "1353: #line 1354 \"ext/standard/var_unserializer.c\"",
          "1356: #line 809 \"ext/standard/var_unserializer.re\"",
          "1363:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1374:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1375: }",
          "1377: yy88:",
          "1378:  yych = *++YYCURSOR;",
          "1379:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1376: #line 1377 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1380: #line 1381 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1398:  goto yy18;",
          "1399: yy92:",
          "1400:  ++YYCURSOR;",
          "1402:  {",
          "1403:  long elements;",
          "1404:     if (!var_hash) return 0;",
          "1406:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1408:   return 0;",
          "1409:  }",
          "1410:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1411: }",
          "1413: yy94:",
          "1414:  ++YYCURSOR;",
          "1416:  {",
          "1417:  size_t len, maxlen;",
          "1418:  char *str;",
          "",
          "[Removed Lines]",
          "1401: #line 829 \"ext/standard/var_unserializer.re\"",
          "1407:  if (elements < 0) {",
          "1412: #line 1413 \"ext/standard/var_unserializer.c\"",
          "1415: #line 739 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1405: #line 833 \"ext/standard/var_unserializer.re\"",
          "1411:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1416: #line 1417 \"ext/standard/var_unserializer.c\"",
          "1419: #line 743 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1444:  ZVAL_STRINGL(rval, str, len);",
          "1445:  return 1;",
          "1446: }",
          "1448: yy96:",
          "1449:  yych = *++YYCURSOR;",
          "1450:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1447: #line 1448 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1451: #line 1452 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1452:  goto yy18;",
          "1453: yy97:",
          "1454:  ++YYCURSOR;",
          "1456:  {",
          "",
          "[Removed Lines]",
          "1455: #line 714 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1459: #line 718 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1469:  return 1;",
          "1470: }",
          "1472: }",
          "1476:  return 0;",
          "",
          "[Removed Lines]",
          "1471: #line 1472 \"ext/standard/var_unserializer.c\"",
          "1473: #line 1000 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1475: #line 1476 \"ext/standard/var_unserializer.c\"",
          "1477: #line 1004 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "552:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "554:  ht = Z_OBJPROP_P(rval);",
          "555:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "556:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "557:   if (has_wakeup) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "555:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "556:   return 0;",
          "557:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "809:     if (!var_hash) return 0;",
          "812:   return 0;",
          "813:  }",
          "",
          "[Removed Lines]",
          "811:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "815:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "831:     if (!var_hash) return 0;",
          "833:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "835:   return 0;",
          "836:  }",
          "837:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "",
          "[Removed Lines]",
          "834:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "838:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}