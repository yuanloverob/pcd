{
  "cve_id": "CVE-2019-10678",
  "cve_desc": "Domoticz before 4.10579 neglects to categorize \\n and \\r as insecure argument options.",
  "repo": "domoticz/domoticz",
  "patch_hash": "2119afbe74ee0c914c1d5c4c859c594c08b0ad42",
  "patch_info": {
    "commit_hash": "2119afbe74ee0c914c1d5c4c859c594c08b0ad42",
    "repo": "domoticz/domoticz",
    "commit_url": "https://github.com/domoticz/domoticz/commit/2119afbe74ee0c914c1d5c4c859c594c08b0ad42",
    "files": [
      "main/Helper.cpp"
    ],
    "message": "Do not allow enters/returns in arguments (thanks to Fabio Carretto)",
    "before_after_code_files": [
      "main/Helper.cpp||main/Helper.cpp"
    ]
  },
  "patch_diff": {
    "main/Helper.cpp||main/Helper.cpp": [
      "File: main/Helper.cpp -> main/Helper.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "1014:  \"$\",",
      "1015:  \"<\",",
      "1016:  \">\",",
      "1017:  NULL",
      "1018: };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1017:  \"\\n\",",
      "1018:  \"\\r\",",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f037f769677f499fc4244c920cc03b011b162cd1",
      "candidate_info": {
        "commit_hash": "f037f769677f499fc4244c920cc03b011b162cd1",
        "repo": "domoticz/domoticz",
        "commit_url": "https://github.com/domoticz/domoticz/commit/f037f769677f499fc4244c920cc03b011b162cd1",
        "files": [
          "hardware/RFXComSerial.cpp"
        ],
        "message": "RFXCom, firmware flash, making sure it is 100% when ready",
        "before_after_code_files": [
          "hardware/RFXComSerial.cpp||hardware/RFXComSerial.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/domoticz/domoticz/pull/3180"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "hardware/RFXComSerial.cpp||hardware/RFXComSerial.cpp": [
          "File: hardware/RFXComSerial.cpp -> hardware/RFXComSerial.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "415:  m_rxbufferpos = 0;",
          "416:  m_bInBootloaderMode = false;",
          "417:  OpenSerialDevice();",
          "418:  return true;",
          "419: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "417:  m_FirmwareUploadPercentage = 100;",
          "418:  RequestStart();",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "73e38c8c183c0bdfd35f2ba94fb7a9f35d29f26c",
      "candidate_info": {
        "commit_hash": "73e38c8c183c0bdfd35f2ba94fb7a9f35d29f26c",
        "repo": "domoticz/domoticz",
        "commit_url": "https://github.com/domoticz/domoticz/commit/73e38c8c183c0bdfd35f2ba94fb7a9f35d29f26c",
        "files": [
          "www/app/DevicesController.js"
        ],
        "message": "Fixed Temp+Hum log button in devices view",
        "before_after_code_files": [
          "www/app/DevicesController.js||www/app/DevicesController.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/domoticz/domoticz/pull/3180"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "www/app/DevicesController.js||www/app/DevicesController.js": [
          "File: www/app/DevicesController.js -> www/app/DevicesController.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "307:        ) {",
          "308:         itemSubIcons += '&nbsp;<a href=\"#/Devices/'+ item.idx +'/Log\"><img src=\"images/log.png\" title=\"' + $.t('Log') + '\"></a>';",
          "309:        }",
          "311:         itemSubIcons += '&nbsp;<a href=\"#Devices/'+item.idx+'/Log\"><img src=\"images/log.png\" title=\"' + $.t('Log') + '\"></a>';",
          "312:        }",
          "313:        else if ([",
          "",
          "[Removed Lines]",
          "310:        else if (['Temp', 'Thermostat', 'Humidity'].includes(item.Type)) {",
          "",
          "[Added Lines]",
          "310:        else if ((/Temp|Thermostat|Humidity/i).test(item.Type)) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "70aedcf961a3c23ba5bee972b344c8c5f06e8b7a",
      "candidate_info": {
        "commit_hash": "70aedcf961a3c23ba5bee972b344c8c5f06e8b7a",
        "repo": "domoticz/domoticz",
        "commit_url": "https://github.com/domoticz/domoticz/commit/70aedcf961a3c23ba5bee972b344c8c5f06e8b7a",
        "files": [
          "hardware/RFLinkBase.cpp"
        ],
        "message": "RFLink removing debug code",
        "before_after_code_files": [
          "hardware/RFLinkBase.cpp||hardware/RFLinkBase.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/domoticz/domoticz/pull/3180"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "hardware/RFLinkBase.cpp||hardware/RFLinkBase.cpp": [
          "File: hardware/RFLinkBase.cpp -> hardware/RFLinkBase.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "209:  ParseLine(\"20;AF;SelectPlus;ID=1bb4;CHIME=01;\");",
          "210:  ParseLine(\"20;04;Eurodomest;ID=03696b;SWITCH=07;CMD=ALLOFF;\");",
          "213: }",
          "215: CRFLinkBase::~CRFLinkBase()",
          "",
          "[Removed Lines]",
          "212:  ParseLine(\"20;01;Blyss;ID=3fae;SWITCH=G1;CMD=ON;\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "596:  gswitch.seqnbr = 0;",
          "597:  sDecodeRXMessage(this, (const unsigned char *)&gswitch, NULL, BatteryLevel);",
          "601:  return true;",
          "602: }",
          "",
          "[Removed Lines]",
          "599:  WriteToHardware((const char*)&gswitch, sizeof(gswitch));",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2588023472a577de22a84cea2483ea39d3999131",
      "candidate_info": {
        "commit_hash": "2588023472a577de22a84cea2483ea39d3999131",
        "repo": "domoticz/domoticz",
        "commit_url": "https://github.com/domoticz/domoticz/commit/2588023472a577de22a84cea2483ea39d3999131",
        "files": [
          "www/app/report/EnergyMultiCounterReport.js"
        ],
        "message": "Correcting cost calculation for P1 Meter reports with return usage",
        "before_after_code_files": [
          "www/app/report/EnergyMultiCounterReport.js||www/app/report/EnergyMultiCounterReport.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/domoticz/domoticz/pull/3180"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "www/app/report/EnergyMultiCounterReport.js||www/app/report/EnergyMultiCounterReport.js": [
          "File: www/app/report/EnergyMultiCounterReport.js -> www/app/report/EnergyMultiCounterReport.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "104:                 dayRecord.usage = dayRecord.usage1.usage + dayRecord.usage2.usage -",
          "105:                     (includeReturn ? dayRecord.return1.usage + dayRecord.return2.usage : 0);",
          "106:                 dayRecord.cost = dayRecord.usage1.cost + dayRecord.usage2.cost -",
          "109:                 result.years[year].months[month].days[day] = dayRecord",
          "110:             });",
          "",
          "[Removed Lines]",
          "107:                     (includeReturn ? dayRecord.return1.cost - dayRecord.return2.cost : 0);",
          "",
          "[Added Lines]",
          "107:                     (includeReturn ? (dayRecord.return1.cost + dayRecord.return2.cost) : 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "05bd96cef4a459c06f8aac28abffc58604d5b3ed",
      "candidate_info": {
        "commit_hash": "05bd96cef4a459c06f8aac28abffc58604d5b3ed",
        "repo": "domoticz/domoticz",
        "commit_url": "https://github.com/domoticz/domoticz/commit/05bd96cef4a459c06f8aac28abffc58604d5b3ed",
        "files": [
          "www/app/report/EnergyMultiCounterReport.js"
        ],
        "message": "P1 Smart Meter report chart, limit amount of decimals in tooltip",
        "before_after_code_files": [
          "www/app/report/EnergyMultiCounterReport.js||www/app/report/EnergyMultiCounterReport.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/domoticz/domoticz/pull/3180"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "www/app/report/EnergyMultiCounterReport.js||www/app/report/EnergyMultiCounterReport.js": [
          "File: www/app/report/EnergyMultiCounterReport.js -> www/app/report/EnergyMultiCounterReport.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "370:                     min: 0",
          "371:                 },",
          "372:                 tooltip: {",
          "373:                     valueSuffix: ' ' + vm.unit",
          "374:                 },",
          "375:                 plotOptions: {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "373:      valueDecimals: 3,",
          "",
          "---------------"
        ]
      }
    }
  ]
}