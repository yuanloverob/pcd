{
  "cve_id": "CVE-2017-3735",
  "cve_desc": "While parsing an IPAddressFamily extension in an X.509 certificate, it is possible to do a one-byte overread. This would result in an incorrect text display of the certificate. This bug has been present since 2006 and is present in all versions of OpenSSL before 1.0.2m and 1.1.0g.",
  "repo": "openssl/openssl",
  "patch_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
  "patch_info": {
    "commit_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/068b963bb7afc57f5bdd723de0dd15e7795d5822",
    "files": [
      "crypto/x509v3/v3_addr.c"
    ],
    "message": "Avoid out-of-bounds read\n\nFixes CVE 2017-3735\n\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\n(Merged from https://github.com/openssl/openssl/pull/4276)\n\n(cherry picked from commit b23171744b01e473ebbfd6edad70c1c3825ffbcd)",
    "before_after_code_files": [
      "crypto/x509v3/v3_addr.c||crypto/x509v3/v3_addr.c"
    ]
  },
  "patch_diff": {
    "crypto/x509v3/v3_addr.c||crypto/x509v3/v3_addr.c": [
      "File: crypto/x509v3/v3_addr.c -> crypto/x509v3/v3_addr.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "85: unsigned int X509v3_addr_get_afi(const IPAddressFamily *f)",
      "86: {",
      "91: }",
      "",
      "[Removed Lines]",
      "87:     return ((f != NULL &&",
      "88:              f->addressFamily != NULL && f->addressFamily->data != NULL)",
      "89:             ? ((f->addressFamily->data[0] << 8) | (f->addressFamily->data[1]))",
      "90:             : 0);",
      "",
      "[Added Lines]",
      "87:     if (f == NULL",
      "88:             || f->addressFamily == NULL",
      "89:             || f->addressFamily->data == NULL",
      "90:             || f->addressFamily->length < 2)",
      "91:         return 0;",
      "92:     return (f->addressFamily->data[0] << 8) | f->addressFamily->data[1];",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f114b91461abe4ea47c080e2493a6ef0b38ac5ec",
      "candidate_info": {
        "commit_hash": "f114b91461abe4ea47c080e2493a6ef0b38ac5ec",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/f114b91461abe4ea47c080e2493a6ef0b38ac5ec",
        "files": [
          ".travis-apt-pin.preferences",
          ".travis.yml"
        ],
        "message": "Fix travis clang-3.9 builds\n\nSomething environmental changed in travis so that it started preferring\nthe ubuntu clang-3.9 version instead of the llvm.org one. This breaks the\nsanitiser based builds. This change forces travis to de-prioritise the\nubuntu clang packages.\n\n[extended tests]\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/3854)",
        "before_after_code_files": [
          ".travis-apt-pin.preferences||.travis-apt-pin.preferences"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        ".travis-apt-pin.preferences||.travis-apt-pin.preferences": [
          "File: .travis-apt-pin.preferences -> .travis-apt-pin.preferences",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: Package: clang-3.9",
          "2: Pin: release o=Ubuntu",
          "3: Pin-Priority: -1",
          "5: Package: libclang-common-3.9-dev",
          "6: Pin: release o=Ubuntu",
          "7: Pin-Priority: -1",
          "9: Package: libclang1-3.9",
          "10: Pin: release o=Ubuntu",
          "11: Pin-Priority: -1",
          "13: Package: libllvm3.9v4",
          "14: Pin: release o=Ubuntu",
          "15: Pin-Priority: -1",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7dd13abe0ccdbf184303049087eea9a057b94d4b",
      "candidate_info": {
        "commit_hash": "7dd13abe0ccdbf184303049087eea9a057b94d4b",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/7dd13abe0ccdbf184303049087eea9a057b94d4b",
        "files": [
          "crypto/ct/ct_log.c",
          "crypto/pkcs12/p12_mutl.c"
        ],
        "message": "Add checks for alloc failing.\n\nReviewed-by: Paul Dale <paul.dale@oracle.com>\n(Merged from https://github.com/openssl/openssl/pull/4341)\n\n(cherry picked from commit d3c3dfc5778ab2cca0d25c5959c8b814a334addb)",
        "before_after_code_files": [
          "crypto/ct/ct_log.c||crypto/ct/ct_log.c",
          "crypto/pkcs12/p12_mutl.c||crypto/pkcs12/p12_mutl.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/ct/ct_log.c||crypto/ct/ct_log.c": [
          "File: crypto/ct/ct_log.c -> crypto/ct/ct_log.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "198:     char *enabled_logs;",
          "199:     CTLOG_STORE_LOAD_CTX* load_ctx = ctlog_store_load_ctx_new();",
          "201:     load_ctx->log_store = store;",
          "202:     load_ctx->conf = NCONF_new(NULL);",
          "203:     if (load_ctx->conf == NULL)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "201:     if (load_ctx == NULL)",
          "202:         goto end;",
          "",
          "---------------"
        ],
        "crypto/pkcs12/p12_mutl.c||crypto/pkcs12/p12_mutl.c": [
          "File: crypto/pkcs12/p12_mutl.c -> crypto/pkcs12/p12_mutl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "124:         PKCS12err(PKCS12_F_PKCS12_GEN_MAC, PKCS12_R_KEY_GEN_ERROR);",
          "125:         return 0;",
          "126:     }",
          "129:         || !HMAC_Update(hmac, p12->authsafes->d.data->data,",
          "130:                         p12->authsafes->d.data->length)",
          "131:         || !HMAC_Final(hmac, mac, maclen)) {",
          "",
          "[Removed Lines]",
          "127:     hmac = HMAC_CTX_new();",
          "128:     if (!HMAC_Init_ex(hmac, key, md_size, md_type, NULL)",
          "",
          "[Added Lines]",
          "127:     if ((hmac = HMAC_CTX_new()) == NULL",
          "128:         || !HMAC_Init_ex(hmac, key, md_size, md_type, NULL)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "62f494408dc87a264ecb8e94b59dde42d52dfefd",
      "candidate_info": {
        "commit_hash": "62f494408dc87a264ecb8e94b59dde42d52dfefd",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/62f494408dc87a264ecb8e94b59dde42d52dfefd",
        "files": [
          "ssl/ssl_locl.h"
        ],
        "message": "Correct minor typo in ssl_locl.h comment\n\nCLA: trivial\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/4880)\n\n(cherry picked from commit 6aff543b9bf14bdac7f5385a9e56b8785b30f6d8)",
        "before_after_code_files": [
          "ssl/ssl_locl.h||ssl/ssl_locl.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ssl/ssl_locl.h||ssl/ssl_locl.h": [
          "File: ssl/ssl_locl.h -> ssl/ssl_locl.h"
        ]
      }
    },
    {
      "candidate_hash": "94b372b4c9e0f5e0fc7785ad8fee347479854009",
      "candidate_info": {
        "commit_hash": "94b372b4c9e0f5e0fc7785ad8fee347479854009",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/94b372b4c9e0f5e0fc7785ad8fee347479854009",
        "files": [
          "Configurations/10-main.conf"
        ],
        "message": "Remove old config that used non-exist util script\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/5016)\n\n(cherry picked from commit b44a65512a4a0a299f8f817b63df472e74a0007a)",
        "before_after_code_files": [
          "Configurations/10-main.conf||Configurations/10-main.conf"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Configurations/10-main.conf||Configurations/10-main.conf": [
          "File: Configurations/10-main.conf -> Configurations/10-main.conf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1251:         thread_scheme    => \"(unknown)\",",
          "1264:     },",
          "1266: #### Visual C targets",
          "1267: #",
          "1268: # Win64 targets, WIN64I denotes IA-64 and WIN64A - AMD64",
          "",
          "[Removed Lines]",
          "1252:     },",
          "1254: # OS/390 Unix an EBCDIC-based Unix system on IBM mainframe",
          "1255: # You need to compile using the c89.sh wrapper in the tools directory, because the",
          "1256: # IBM compiler does not like the -L switch after any object modules.",
          "1257: #",
          "1258:     \"OS390-Unix\" => {",
          "1259:         inherit_from     => [ \"BASE_unix\" ],",
          "1260:         cc               => \"c89.sh\",",
          "1261:         cflags           => \"-O -DB_ENDIAN -DCHARSET_EBCDIC -DNO_SYS_PARAM_H  -D_ALL_SOURCE\",",
          "1262:         bn_ops           => \"THIRTY_TWO_BIT RC4_CHAR\",",
          "1263:         thread_scheme    => \"(unknown)\",",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "15ab3217799db508dec4c78cbfd185129f8fdfec",
      "candidate_info": {
        "commit_hash": "15ab3217799db508dec4c78cbfd185129f8fdfec",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/15ab3217799db508dec4c78cbfd185129f8fdfec",
        "files": [
          "crypto/dsa/dsa_ameth.c"
        ],
        "message": "Added const-time flag to DSA key decoding to avoid potential leak of privkey\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/4440)\n\n(cherry picked from commit 6364475a990449ef33fc270ac00472f7210220f2)",
        "before_after_code_files": [
          "crypto/dsdsa_ameth.c||crypto/dsa/dsa_ameth.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/dsdsa_ameth.c||crypto/dsa/dsa_ameth.c": [
          "File: crypto/dsdsa_ameth.c -> crypto/dsa/dsa_ameth.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "178:     BN_set_flags(dsa->priv_key, BN_FLG_CONSTTIME);",
          "",
          "---------------"
        ]
      }
    }
  ]
}