{
  "cve_id": "CVE-2015-0278",
  "cve_desc": "libuv before 0.10.34 does not properly drop group privileges, which allows context-dependent attackers to gain privileges via unspecified vectors.",
  "repo": "libuv/libuv",
  "patch_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
  "patch_info": {
    "commit_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
    "repo": "libuv/libuv",
    "commit_url": "https://github.com/libuv/libuv/commit/66ab38918c911bcff025562cf06237d7fedaba0c",
    "files": [
      "src/unix/process.c"
    ],
    "message": "unix: call setgoups before calling setuid/setgid\n\nPartial fix for #1093",
    "before_after_code_files": [
      "src/unix/process.c||src/unix/process.c"
    ]
  },
  "patch_diff": {
    "src/unix/process.c||src/unix/process.c": [
      "File: src/unix/process.c -> src/unix/process.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "330:     _exit(127);",
      "331:   }",
      "333:   if ((options->flags & UV_PROCESS_SETGID) && setgid(options->gid)) {",
      "334:     uv__write_int(error_fd, -errno);",
      "335:     perror(\"setgid()\");",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "333:   if (options->flags & (UV_PROCESS_SETUID | UV_PROCESS_SETGID)) {",
      "341:     SAVE_ERRNO(setgroups(0, NULL));",
      "342:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "3901ec49767a5b66bebe0a46cf851579f5f040c0",
      "candidate_info": {
        "commit_hash": "3901ec49767a5b66bebe0a46cf851579f5f040c0",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/3901ec49767a5b66bebe0a46cf851579f5f040c0",
        "files": [
          "src/unix/tcp.c"
        ],
        "message": "unix: fix uv_tcp_nodelay return value in case of error\n\nFixes #1102",
        "before_after_code_files": [
          "src/unix/tcp.c||src/unix/tcp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/unix/tcp.c||src/unix/tcp.c": [
          "File: src/unix/tcp.c -> src/unix/tcp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "234: int uv__tcp_nodelay(int fd, int on) {",
          "236: }",
          "",
          "[Removed Lines]",
          "235:   return setsockopt(fd, IPPROTO_TCP, TCP_NODELAY, &on, sizeof(on));",
          "",
          "[Added Lines]",
          "235:   if (setsockopt(fd, IPPROTO_TCP, TCP_NODELAY, &on, sizeof(on)))",
          "236:     return -errno;",
          "237:   return 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1daff47ae9df55902f07d3c5b8a3a393306a2f1e",
      "candidate_info": {
        "commit_hash": "1daff47ae9df55902f07d3c5b8a3a393306a2f1e",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/1daff47ae9df55902f07d3c5b8a3a393306a2f1e",
        "files": [
          "ChangeLog",
          "configure.ac",
          "include/uv-version.h"
        ],
        "message": "Now working on v0.11.25",
        "before_after_code_files": [
          "configure.ac||configure.ac",
          "include/uv-version.h||include/uv-version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "configure.ac||configure.ac": [
          "File: configure.ac -> configure.ac",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: # OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.",
          "15: AC_PREREQ(2.57)",
          "17: AC_CONFIG_MACRO_DIR([m4])",
          "18: m4_include([m4/libuv-extra-automake-flags.m4])",
          "19: m4_include([m4/as_case.m4])",
          "",
          "[Removed Lines]",
          "16: AC_INIT([libuv], [0.11.24], [https://github.com/joyent/libuv/issues])",
          "",
          "[Added Lines]",
          "16: AC_INIT([libuv], [0.11.25], [https://github.com/joyent/libuv/issues])",
          "",
          "---------------"
        ],
        "include/uv-version.h||include/uv-version.h": [
          "File: include/uv-version.h -> include/uv-version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: #define UV_VERSION_MAJOR 0",
          "34: #define UV_VERSION_MINOR 11",
          "",
          "[Removed Lines]",
          "35: #define UV_VERSION_PATCH 24",
          "36: #define UV_VERSION_IS_RELEASE 1",
          "",
          "[Added Lines]",
          "35: #define UV_VERSION_PATCH 25",
          "36: #define UV_VERSION_IS_RELEASE 0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "167a8173518894f7caad5dd799a1741cb7562c63",
      "candidate_info": {
        "commit_hash": "167a8173518894f7caad5dd799a1741cb7562c63",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/167a8173518894f7caad5dd799a1741cb7562c63",
        "files": [
          "src/unix/sunos.c"
        ],
        "message": "sunos: fix build breakage introduced in e3a657c",
        "before_after_code_files": [
          "src/unix/sunos.c||src/unix/sunos.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/unix/sunos.c||src/unix/sunos.c": [
          "File: src/unix/sunos.c -> src/unix/sunos.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "580: #ifdef SUNOS_NO_IFADDRS",
          "581:   return -ENOSYS;",
          "582: #else",
          "584:   uv_interface_address_t* address;",
          "586:   if (getifaddrs(&addrs))",
          "587:     return -errno;",
          "",
          "[Removed Lines]",
          "583:   struct ifaddrs *addrs, *ent;",
          "",
          "[Added Lines]",
          "584:   struct sockaddr_dl* sa_addr;",
          "585:   struct ifaddrs* addrs;",
          "586:   struct ifaddrs* ent;",
          "587:   int i;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "556fe1a6598bbd1bee4a98587b4a2329697963d0",
      "candidate_info": {
        "commit_hash": "556fe1a6598bbd1bee4a98587b4a2329697963d0",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/556fe1a6598bbd1bee4a98587b4a2329697963d0",
        "files": [
          "src/unix/linux-core.c"
        ],
        "message": "linux: ignore fractional time in uv_uptime()\n\nBefore this commit, uv_uptime() returned the nanoseconds as the\nfractional part of the uptime.  It's a bit inconsistent with the\noutput on other platforms because those only return whole seconds\n(with the possible exception of Windows.)\n\nThis commit changes linux-core.c to only return whole seconds.",
        "before_after_code_files": [
          "src/unix/linux-core.c||src/unix/linux-core.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/unix/linux-core.c||src/unix/linux-core.c": [
          "File: src/unix/linux-core.c -> src/unix/linux-core.c"
        ]
      }
    },
    {
      "candidate_hash": "aaaefe32cadcfb26d07d625d17d7a2b8cafb4f2d",
      "candidate_info": {
        "commit_hash": "aaaefe32cadcfb26d07d625d17d7a2b8cafb4f2d",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/aaaefe32cadcfb26d07d625d17d7a2b8cafb4f2d",
        "files": [
          "include/uv-errno.h",
          "include/uv.h"
        ],
        "message": "errno: add ETXTBSY\n\nAdd `ETXTBSY` which could be returned by file system reads on some\nunixes and emulate it with -148 (`ERROR_PATH_BUSY`) on windows.",
        "before_after_code_files": [
          "include/uv-errno.h||include/uv-errno.h",
          "include/uv.h||include/uv.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/uv-errno.h||include/uv-errno.h": [
          "File: include/uv-errno.h -> include/uv-errno.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "364: # define UV__ETIMEDOUT (-4039)",
          "365: #endif",
          "367: #if defined(EXDEV) && !defined(_WIN32)",
          "368: # define UV__EXDEV (-EXDEV)",
          "369: #else",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "367: #if defined(ETXTBSY) && !defined(_WIN32)",
          "368: # define UV__ETXTBSY (-ETXTBSY)",
          "369: #else",
          "370: # define UV__ETXTBSY (-4038)",
          "371: #endif",
          "",
          "---------------"
        ],
        "include/uv.h||include/uv.h": [
          "File: include/uv.h -> include/uv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "132:   XX(ESPIPE, \"invalid seek\")                                                  \\",
          "133:   XX(ESRCH, \"no such process\")                                                \\",
          "134:   XX(ETIMEDOUT, \"connection timed out\")                                       \\",
          "135:   XX(EXDEV, \"cross-device link not permitted\")                                \\",
          "136:   XX(UNKNOWN, \"unknown error\")                                                \\",
          "137:   XX(EOF, \"end of file\")                                                      \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "135:   XX(ETXTBSY, \"text file is busy\")                                            \\",
          "",
          "---------------"
        ]
      }
    }
  ]
}