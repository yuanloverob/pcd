{
  "cve_id": "CVE-2016-0790",
  "cve_desc": "Jenkins before 1.650 and LTS before 1.642.2 do not use a constant-time algorithm to verify API tokens, which makes it easier for remote attackers to determine API tokens via a brute-force approach.",
  "repo": "jenkinsci/jenkins",
  "patch_hash": "79e0b64322a6b15e0b80ac6511c9aa74383642be",
  "patch_info": {
    "commit_hash": "79e0b64322a6b15e0b80ac6511c9aa74383642be",
    "repo": "jenkinsci/jenkins",
    "commit_url": "https://github.com/jenkinsci/jenkins/commit/79e0b64322a6b15e0b80ac6511c9aa74383642be",
    "files": [
      "core/src/main/java/jenkins/security/ApiTokenProperty.java"
    ],
    "message": "[FIX SECURITY-241] Compare API tokens in constant time",
    "before_after_code_files": [
      "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java"
    ]
  },
  "patch_diff": {
    "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java": [
      "File: core/src/main/java/jenkins/security/ApiTokenProperty.java -> core/src/main/java/jenkins/security/ApiTokenProperty.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "41: import org.kohsuke.stapler.StaplerResponse;",
      "43: import java.io.IOException;",
      "44: import java.security.SecureRandom;",
      "45: import javax.annotation.Nonnull;",
      "46: import org.apache.commons.lang.StringUtils;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "44: import java.security.MessageDigest;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "109:     }",
      "111:     public boolean matchesPassword(String password) {",
      "113:     }",
      "115:     private boolean hasPermissionToSeeToken() {",
      "",
      "[Removed Lines]",
      "112:         return  getApiTokenInsecure().equals(password);",
      "",
      "[Added Lines]",
      "113:         String token = getApiTokenInsecure();",
      "114:         return MessageDigest.isEqual(password.getBytes(), token.getBytes());",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "def5bdb1984705be3c41be8bca4fd387db084eda",
      "candidate_info": {
        "commit_hash": "def5bdb1984705be3c41be8bca4fd387db084eda",
        "repo": "jenkinsci/jenkins",
        "commit_url": "https://github.com/jenkinsci/jenkins/commit/def5bdb1984705be3c41be8bca4fd387db084eda",
        "files": [
          "core/src/main/java/jenkins/security/ApiTokenProperty.java"
        ],
        "message": "[SECURITY-241] Use US-ASCII to prevent charset issues",
        "before_after_code_files": [
          "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java"
          ],
          "candidate": [
            "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java"
          ]
        }
      },
      "candidate_diff": {
        "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java": [
          "File: core/src/main/java/jenkins/security/ApiTokenProperty.java -> core/src/main/java/jenkins/security/ApiTokenProperty.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "41: import org.kohsuke.stapler.StaplerResponse;",
          "43: import java.io.IOException;",
          "44: import java.security.MessageDigest;",
          "45: import java.security.SecureRandom;",
          "46: import javax.annotation.Nonnull;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44: import java.nio.charset.Charset;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "112:     public boolean matchesPassword(String password) {",
          "113:         String token = getApiTokenInsecure();",
          "115:     }",
          "117:     private boolean hasPermissionToSeeToken() {",
          "",
          "[Removed Lines]",
          "114:         return MessageDigest.isEqual(password.getBytes(), token.getBytes());",
          "",
          "[Added Lines]",
          "115:         return MessageDigest.isEqual(password.getBytes(Charset.forName(\"US-ASCII\")),",
          "116:                 token.getBytes(Charset.forName(\"US-ASCII\")));",
          "",
          "---------------"
        ]
      }
    }
  ]
}