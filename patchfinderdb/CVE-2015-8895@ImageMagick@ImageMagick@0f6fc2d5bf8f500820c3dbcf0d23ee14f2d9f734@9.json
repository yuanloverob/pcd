{
  "cve_id": "CVE-2015-8895",
  "cve_desc": "Integer overflow in coders/icon.c in ImageMagick 6.9.1-3 and later allows remote attackers to cause a denial of service (application crash) via a crafted length value, which triggers a buffer overflow.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734",
  "patch_info": {
    "commit_hash": "0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734",
    "files": [
      "MagickCore/memory.c",
      "MagickCore/studio.h",
      "MagickCore/version.c",
      "MagickCore/version.h",
      "MagickWand/studio.h",
      "coders/icon.c",
      "coders/pict.c",
      "configure",
      "configure.ac"
    ],
    "message": "",
    "before_after_code_files": [
      "MagickCore/memory.c||MagickCore/memory.c",
      "MagickCore/studio.h||MagickCore/studio.h",
      "MagickCore/version.c||MagickCore/version.c",
      "MagickCore/version.h||MagickCore/version.h",
      "MagickWand/studio.h||MagickWand/studio.h",
      "coders/icon.c||coders/icon.c",
      "coders/pict.c||coders/pict.c",
      "configure.ac||configure.ac"
    ]
  },
  "patch_diff": {
    "MagickCore/memory.c||MagickCore/memory.c": [
      "File: MagickCore/memory.c -> MagickCore/memory.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "606:     }",
      "607:   if ((memory_info->blob == NULL) &&",
      "608:       (AcquireMagickResource(MapResource,length) != MagickFalse))",
      "611:         Heap memory failed, try anonymous memory mapping.",
      "",
      "[Removed Lines]",
      "609:     {",
      "",
      "[Added Lines]",
      "609:     {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "615:         memory_info->type=MapVirtualMemory;",
      "616:       else",
      "617:         RelinquishMagickResource(MapResource,length);",
      "619:   if (memory_info->blob == NULL)",
      "621:       int",
      "627:       file=AcquireUniqueFileResource(memory_info->filename);",
      "628:       if (file != -1)",
      "629:         {",
      "",
      "[Removed Lines]",
      "618:     }",
      "620:     {",
      "622:         file;",
      "625:         Anonymous memory mapping failed, try file-backed memory mapping.",
      "",
      "[Added Lines]",
      "619:   if ((memory_info->blob == NULL) &&",
      "620:       (AcquireMagickResource(DiskResource,length) != MagickFalse))",
      "621:     {",
      "623:         file;",
      "628:       file=AcquireUniqueFileResource(memory_info->filename);",
      "629:       if (file == -1)",
      "631:       else",
      "632:         {",
      "633:           if ((lseek(file,length-1,SEEK_SET) < 0) || (write(file,\"\",1) != 1))",
      "634:             RelinquishMagickResource(DiskResource,length);",
      "635:           else",
      "636:             {",
      "637:               if (AcquireMagickResource(MapResource,length) == MagickFalse)",
      "638:                 RelinquishMagickResource(DiskResource,length);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1033: %",
      "1035: MagickExport MemoryInfo *RelinquishVirtualMemory(MemoryInfo *memory_info)",
      "1037:   assert(memory_info != (MemoryInfo *) NULL);",
      "1038:   assert(memory_info->signature == MagickSignature);",
      "1039:   if (memory_info->blob != (void *) NULL)",
      "",
      "[Removed Lines]",
      "1036: {",
      "",
      "[Added Lines]",
      "1048: {",
      "1049:   assert(memory_info != (MemoryInfo *) NULL);",
      "1050:   assert(memory_info->signature == MagickSignature);",
      "1051:   if (memory_info->blob != (void *) NULL)",
      "",
      "---------------"
    ],
    "MagickCore/studio.h||MagickCore/studio.h": [
      "File: MagickCore/studio.h -> MagickCore/studio.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "46: #if defined(_magickcore_inline) && !defined(inline)",
      "47: # define inline  _magickcore_inline",
      "48: #endif",
      "52: # if defined(__cplusplus) || defined(c_plusplus)",
      "53: #  undef inline",
      "54: # endif",
      "",
      "[Removed Lines]",
      "49: #if defined(_magickcore_restrict) && !defined(restrict)",
      "50: # define restrict  _magickcore_restrict",
      "51: #endif",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "75: #  include <stdlib.h>",
      "76: # endif",
      "77: #endif",
      "78: #if defined(MAGICKCORE_HAVE_STRING_H)",
      "79: # if !defined(STDC_HEADERS) && defined(MAGICKCORE_HAVE_MEMORY_H)",
      "80: #  include <memory.h>",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "75: #if defined(_magickcore_restrict) && !defined(restrict)",
      "76: # define restrict  _magickcore_restrict",
      "77: #endif",
      "",
      "---------------"
    ],
    "MagickCore/version.c||MagickCore/version.c": [
      "File: MagickCore/version.c -> MagickCore/version.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "219: %      const char *GetMagickFeatures(void)",
      "220: %",
      "221: %  No parameters are required.",
      "224: MagickExport const char *GetMagickFeatures(void)",
      "225: {",
      "226:   return \"DPC\"",
      "227: #if defined(MAGICKCORE_BUILD_MODULES) || defined(_DLL)",
      "228:   \" Modules\"",
      "229: #endif",
      "230: #if defined(MAGICKCORE_HDRI_SUPPORT)",
      "231:   \" HDRI\"",
      "232: #endif",
      "233: #if defined(MAGICKCORE_OPENCL_SUPPORT)",
      "234:   \" OpenCL\"",
      "235: #endif",
      "",
      "[Removed Lines]",
      "222: %",
      "",
      "[Added Lines]",
      "222: %",
      "224: MagickExport const char *GetMagickFeatures(void)",
      "225: {",
      "226:   return \"DPC\"",
      "231:   \" Cipher\"",
      "232: #endif",
      "233: #if defined(MAGICKCORE_HDRI_SUPPORT)",
      "239: #if defined(MAGICKCORE_OPENCL_SUPPORT)",
      "240:   \" OpenCL\"",
      "241: #endif",
      "",
      "---------------"
    ],
    "MagickCore/version.h||MagickCore/version.h": [
      "File: MagickCore/version.h -> MagickCore/version.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "28: #define MagickPackageName \"ImageMagick\"",
      "29: #define MagickCopyright  \"Copyright (C) 1999-2015 ImageMagick Studio LLC\"",
      "31: #define MagickLibVersion  0x700",
      "32: #define MagickLibVersionText  \"7.0.0\"",
      "33: #define MagickLibVersionNumber  0,0,0",
      "",
      "[Removed Lines]",
      "30: #define MagickSVNRevision  \"18658:18662M\"",
      "",
      "[Added Lines]",
      "30: #define MagickSVNRevision  \"18670M\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "48: #define MagickppLibAddendum  \"-0\"",
      "49: #define MagickppLibInterface  0",
      "50: #define MagickppLibMinInterface  0",
      "52: #define MagickChangeDate   \"20120427\"",
      "53: #define MagickAuthoritativeLicense  \\",
      "54:   \"http://www.imagemagick.org/script/license.php\"",
      "55: #define MagickAuthoritativeURL  \"http://www.imagemagick.org\"",
      "57: #define MagickDelegates \"bzlib djvu mpeg fftw fpx fontconfig freetype jbig jng jpeg lcms lzma openexr pango png ps tiff webp x xml zlib\"",
      "58: #define MagickHomeURL  \"file:///usr/local/share/doc/ImageMagick-7/index.html\"",
      "59: #if (MAGICKCORE_QUANTUM_DEPTH == 8)",
      "",
      "[Removed Lines]",
      "51: #define MagickReleaseDate  \"2015-05-26\"",
      "56: #define MagickFeatures \"DPC HDRI OpenMP\"",
      "",
      "[Added Lines]",
      "51: #define MagickReleaseDate  \"2015-05-29\"",
      "56: #define MagickFeatures \"DPC HDRI Cipher OpenMP\"",
      "",
      "---------------"
    ],
    "MagickWand/studio.h||MagickWand/studio.h": [
      "File: MagickWand/studio.h -> MagickWand/studio.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "46: #if defined(_magickcore_inline) && !defined(inline)",
      "47: # define inline _magickcore_inline",
      "48: #endif",
      "52: # if defined(__cplusplus) || defined(c_plusplus)",
      "53: #  undef inline",
      "54: # endif",
      "",
      "[Removed Lines]",
      "49: #if defined(_magickcore_restrict) && !defined(restrict)",
      "50: # define restrict  _magickcore_restrict",
      "51: #endif",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "77: #  include <stdlib.h>",
      "78: # endif",
      "79: #endif",
      "80: #if defined(MAGICKCORE_HAVE_STRING_H)",
      "81: # if !defined(STDC_HEADERS) && defined(MAGICKCORE_HAVE_MEMORY_H)",
      "82: #  include <memory.h>",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "77: #if defined(_magickcore_restrict) && !defined(restrict)",
      "78: # define restrict  _magickcore_restrict",
      "79: #endif",
      "",
      "---------------"
    ],
    "coders/icon.c||coders/icon.c": [
      "File: coders/icon.c -> coders/icon.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "183:     size_t",
      "184:       size;",
      "189:     size=(size_t)strtol(p,&q,10);",
      "190:     if (p == q || size < 16 || size > 256)",
      "",
      "[Removed Lines]",
      "186:     while ((isspace((int) ((unsigned char) *p)) != 0))",
      "187:       p++;",
      "",
      "[Added Lines]",
      "186:     while ((isspace((int) ((unsigned char) *p)) != 0))",
      "187:       p++;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "355:         unsigned char",
      "359:           Icon image encoded as a compressed PNG image.",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "coders/pict.c||coders/pict.c": [
      "File: coders/pict.c -> coders/pict.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1637:     source_rectangle;",
      "1639:   register const Quantum",
      "1642:   register ssize_t",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1649:     storage_class;",
      "1651:   ssize_t",
      "1654:   unsigned char",
      "",
      "[Removed Lines]",
      "1652:     y;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1682:     Initialize image info.",
      "1685:   size_rectangle.left=0;",
      "1686:   size_rectangle.bottom=(short) image->rows;",
      "1687:   size_rectangle.right=(short) image->columns;",
      "",
      "[Removed Lines]",
      "1684:   size_rectangle.top=0;",
      "",
      "[Added Lines]",
      "1684:   size_rectangle.top=0;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "1711:   y_resolution=image->resolution.y != 0.0 ? image->resolution.y :",
      "1712:     DefaultResolution;",
      "1713:   storage_class=image->storage_class;",
      "1715:     storage_class=DirectClass;",
      "1716:   if (storage_class == DirectClass)",
      "1717:     {",
      "",
      "[Removed Lines]",
      "1714:   if (image_info->compression == JPEGCompression)",
      "",
      "[Added Lines]",
      "1714:   if (image_info->compression == JPEGCompression)",
      "",
      "---------------"
    ],
    "configure.ac||configure.ac": [
      "File: configure.ac -> configure.ac",
      "--- Hunk 1 ---",
      "[Context before]",
      "643: if test \"$enable_cipher\" = 'yes'; then",
      "644:     AC_DEFINE(CIPHER_SUPPORT,1,[permit enciphering and deciphering image pixels])",
      "645: fi",
      "647: # Build a zero-configuration version of ImageMagick.",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "645:     MAGICK_FEATURES=\"Cipher $MAGICK_FEATURES\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "654: if test \"$enable_zero_configuration\" = 'yes'; then",
      "655:     AC_DEFINE(ZERO_CONFIGURATION_SUPPORT,1,[Build self-contained, embeddable, zero-configuration ImageMagick])",
      "657: fi",
      "659: # Build a high dynamic range version of ImageMagick.",
      "",
      "[Removed Lines]",
      "656:     MAGICK_FEATURES=\"Zero-Configuration $MAGICK_FEATURES\"",
      "",
      "[Added Lines]",
      "657:     MAGICK_FEATURES=\"Zero-configuration $MAGICK_FEATURES\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "3996: if test \"$build_modules\" != 'no'; then",
      "3997:     MAGICK_DEP_LIBS=\"$USER_LIBS $LCMS_LIBS $FREETYPE_LIBS $LQR_LIBS $FFTW_LIBS $FONTCONFIG_LIBS $XEXT_LIBS $IPC_LIBS $X11_LIBS $XT_LIBS $LZMA_LIBS $BZLIB_LIBS $ZLIB_LIBS $LTDL_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
      "3998: else",
      "4000: fi",
      "4001: AC_SUBST(MAGICK_DEP_LIBS)",
      "",
      "[Removed Lines]",
      "3999:     MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $OPENJPEG_LIBS $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
      "",
      "[Added Lines]",
      "4000:     MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $LIBOPENJP2_LIB $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f4579fbb8bcbfb808d4ec94ebd853d65169573a4",
      "candidate_info": {
        "commit_hash": "f4579fbb8bcbfb808d4ec94ebd853d65169573a4",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/f4579fbb8bcbfb808d4ec94ebd853d65169573a4",
        "files": [
          "MagickCore/version.h",
          "configure",
          "version.sh"
        ],
        "message": "",
        "before_after_code_files": [
          "MagickCore/version.h||MagickCore/version.h",
          "version.sh||version.sh"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/version.h||MagickCore/version.h"
          ],
          "candidate": [
            "MagickCore/version.h||MagickCore/version.h"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/version.h||MagickCore/version.h": [
          "File: MagickCore/version.h -> MagickCore/version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: #define MagickPackageName \"ImageMagick\"",
          "29: #define MagickCopyright  \"Copyright (C) 1999-2015 ImageMagick Studio LLC\"",
          "31: #define MagickLibVersion  0x700",
          "32: #define MagickLibVersionText  \"7.0.0\"",
          "33: #define MagickLibVersionNumber  0,0,0",
          "35: #define MagickLibInterface  0",
          "36: #define MagickLibMinInterface  0",
          "37: #if defined(_WINDOWS)",
          "",
          "[Removed Lines]",
          "30: #define MagickSVNRevision  \"18490:18494M\"",
          "34: #define MagickLibAddendum  \"-1\"",
          "",
          "[Added Lines]",
          "30: #define MagickSVNRevision  \"18537:18543M\"",
          "34: #define MagickLibAddendum  \"-0\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "45: #endif",
          "46: #define MagickppLibVersionText  \"7.0.0\"",
          "47: #define MagickppLibVersionNumber  0:0:0",
          "49: #define MagickppLibInterface  0",
          "50: #define MagickppLibMinInterface  0",
          "52: #define MagickChangeDate   \"20120427\"",
          "53: #define MagickAuthoritativeLicense  \\",
          "54:   \"http://www.imagemagick.org/script/license.php\"",
          "",
          "[Removed Lines]",
          "48: #define MagickppLibAddendum  \"-1\"",
          "51: #define MagickReleaseDate  \"2015-05-09\"",
          "",
          "[Added Lines]",
          "48: #define MagickppLibAddendum  \"-0\"",
          "51: #define MagickReleaseDate  \"2015-05-12\"",
          "",
          "---------------"
        ],
        "version.sh||version.sh": [
          "File: version.sh -> version.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: PACKAGE_VERSION='7.0.0'",
          "19: PACKAGE_PERL_VERSION='7.00'",
          "20: PACKAGE_LIB_VERSION=\"0x700\"",
          "22: PACKAGE_LIB_VERSION_NUMBER=\"7,0,0,${PACKAGE_RELEASE}\"",
          "23: PACKAGE_RELEASE_DATE_RAW=`date +%F`",
          "24: PACKAGE_RELEASE_DATE_REPRODUCIBLE=`date +%F -d \"${PACKAGE_CHANGE_DATE}\"`",
          "",
          "[Removed Lines]",
          "21: PACKAGE_RELEASE=\"1\"",
          "",
          "[Added Lines]",
          "21: PACKAGE_RELEASE=\"0\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a5b91e7f776c1a9e7285a3c9be17f46696d1f837",
      "candidate_info": {
        "commit_hash": "a5b91e7f776c1a9e7285a3c9be17f46696d1f837",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/a5b91e7f776c1a9e7285a3c9be17f46696d1f837",
        "files": [
          "MagickCore/version.h",
          "configure",
          "configure.ac"
        ],
        "message": "",
        "before_after_code_files": [
          "MagickCore/version.h||MagickCore/version.h",
          "configure.ac||configure.ac"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/version.h||MagickCore/version.h",
            "configure.ac||configure.ac"
          ],
          "candidate": [
            "MagickCore/version.h||MagickCore/version.h",
            "configure.ac||configure.ac"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/version.h||MagickCore/version.h": [
          "File: MagickCore/version.h -> MagickCore/version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: #define MagickPackageName \"ImageMagick\"",
          "29: #define MagickCopyright  \"Copyright (C) 1999-2015 ImageMagick Studio LLC\"",
          "31: #define MagickLibVersion  0x700",
          "32: #define MagickLibVersionText  \"7.0.0\"",
          "33: #define MagickLibVersionNumber  1,0,0",
          "",
          "[Removed Lines]",
          "30: #define MagickSVNRevision  \"17521:17537M\"",
          "",
          "[Added Lines]",
          "30: #define MagickSVNRevision  \"17584:17590M\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "48: #define MagickppLibAddendum  \"-0\"",
          "49: #define MagickppLibInterface  1",
          "50: #define MagickppLibMinInterface  1",
          "52: #define MagickChangeDate   \"20120427\"",
          "53: #define MagickAuthoritativeURL  \"http://www.imagemagick.org\"",
          "54: #define MagickFeatures \"DPC HDRI OpenMP\"",
          "",
          "[Removed Lines]",
          "51: #define MagickReleaseDate  \"2015-01-03\"",
          "",
          "[Added Lines]",
          "51: #define MagickReleaseDate  \"2015-01-07\"",
          "",
          "---------------"
        ],
        "configure.ac||configure.ac": [
          "File: configure.ac -> configure.ac",
          "--- Hunk 1 ---",
          "[Context before]",
          "3687: GSMonoDevice=pbmraw",
          "3688: GSPDFDevice=pdfwrite",
          "3689: GSPSDevice=ps2write",
          "3691: GSVersion='unknown'",
          "3692: if test $have_gs = 'yes'; then",
          "3693:     AC_MSG_RESULT([-------------------------------------------------------------])",
          "",
          "[Removed Lines]",
          "3690: GSEPSDevice=epswrite",
          "",
          "[Added Lines]",
          "3690: GSEPSDevice=eps2write",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "67405bfbf966513ee00a30e8da72f57ef69e636e",
      "candidate_info": {
        "commit_hash": "67405bfbf966513ee00a30e8da72f57ef69e636e",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/67405bfbf966513ee00a30e8da72f57ef69e636e",
        "files": [
          "MagickCore/version.h",
          "Makefile.am",
          "Makefile.in",
          "configure"
        ],
        "message": "",
        "before_after_code_files": [
          "MagickCore/version.h||MagickCore/version.h",
          "Makefile.am||Makefile.am",
          "Makefile.in||Makefile.in"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/version.h||MagickCore/version.h"
          ],
          "candidate": [
            "MagickCore/version.h||MagickCore/version.h"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/version.h||MagickCore/version.h": [
          "File: MagickCore/version.h -> MagickCore/version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: #define MagickPackageName \"ImageMagick\"",
          "29: #define MagickCopyright  \"Copyright (C) 1999-2015 ImageMagick Studio LLC\"",
          "31: #define MagickLibVersion  0x700",
          "32: #define MagickLibVersionText  \"7.0.0\"",
          "33: #define MagickLibVersionNumber  0,0,0",
          "",
          "[Removed Lines]",
          "30: #define MagickSVNRevision  \"18476:18479M\"",
          "",
          "[Added Lines]",
          "30: #define MagickSVNRevision  \"18490:18494M\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "48: #define MagickppLibAddendum  \"-1\"",
          "49: #define MagickppLibInterface  0",
          "50: #define MagickppLibMinInterface  0",
          "52: #define MagickChangeDate   \"20120427\"",
          "53: #define MagickAuthoritativeLicense  \\",
          "54:   \"http://www.imagemagick.org/script/license.php\"",
          "",
          "[Removed Lines]",
          "51: #define MagickReleaseDate  \"2015-05-03\"",
          "",
          "[Added Lines]",
          "51: #define MagickReleaseDate  \"2015-05-05\"",
          "",
          "---------------"
        ],
        "Makefile.am||Makefile.am": [
          "File: Makefile.am -> Makefile.am",
          "--- Hunk 1 ---",
          "[Context before]",
          "239: # Install HTML files",
          "240: pkgdocdir = $(DOCUMENTATION_PATH)",
          "241: DOCDIRSDOXYGEN = www/api/MagickCore www/api/MagickWand",
          "243: DOCDIRS= $(DOCDIRSMANUAL) $(DOCDIRSDOXYGEN)",
          "245: if INSTALL_DOC",
          "",
          "[Removed Lines]",
          "242: DOCDIRSMANUAL = images images/patterns www www/api www/source www/Magick++",
          "",
          "[Added Lines]",
          "242: DOCDIRSMANUAL = images images/patterns www www/css www/js www/api www/source www/Magick++",
          "",
          "---------------"
        ],
        "Makefile.in||Makefile.in": [
          "File: Makefile.in -> Makefile.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "5204: # Install HTML files",
          "5205: pkgdocdir = $(DOCUMENTATION_PATH)",
          "5206: DOCDIRSDOXYGEN = www/api/MagickCore www/api/MagickWand",
          "5208: DOCDIRS = $(DOCDIRSMANUAL) $(DOCDIRSDOXYGEN)",
          "5209: @INSTALL_DOC_TRUE@HTML_INSTALL_DATA_TARGETS = install-data-html",
          "",
          "[Removed Lines]",
          "5207: DOCDIRSMANUAL = images images/patterns www www/api www/source www/Magick++",
          "",
          "[Added Lines]",
          "5207: DOCDIRSMANUAL = images images/patterns www www/css www/js www/api www/source www/Magick++",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8aced97ecd2b02723f8cad14245b81b6c26404b0",
      "candidate_info": {
        "commit_hash": "8aced97ecd2b02723f8cad14245b81b6c26404b0",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/8aced97ecd2b02723f8cad14245b81b6c26404b0",
        "files": [
          "MagickCore/composite-private.h",
          "MagickCore/version.h",
          "PerlMagick/Makefile.PL",
          "PerlMagick/check.sh"
        ],
        "message": "",
        "before_after_code_files": [
          "MagickCore/composite-private.h||MagickCore/composite-private.h",
          "MagickCore/version.h||MagickCore/version.h",
          "PerlMagick/Makefile.PL||PerlMagick/Makefile.PL",
          "PerlMagick/check.sh||PerlMagick/check.sh"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/version.h||MagickCore/version.h"
          ],
          "candidate": [
            "MagickCore/version.h||MagickCore/version.h"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/composite-private.h||MagickCore/composite-private.h": [
          "File: MagickCore/composite-private.h -> MagickCore/composite-private.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "49: {",
          "50:   double",
          "51:     Da,",
          "53:     Sa;",
          "55:   register ssize_t",
          "",
          "[Removed Lines]",
          "52:     gamma,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "59:     Compose pixel p over pixel q with the given alpha.",
          "61:   Sa=QuantumScale*alpha;",
          "65:   for (i=0; i < (ssize_t) GetPixelChannels(image); i++)",
          "66:   {",
          "67:     PixelChannel",
          "",
          "[Removed Lines]",
          "62:   Da=QuantumScale*beta,",
          "63:   gamma=Sa*(-Da)+Sa+Da;",
          "64:   gamma=PerceptibleReciprocal(gamma);",
          "",
          "[Added Lines]",
          "61:   Da=QuantumScale*beta;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "78:     {",
          "79:       case RedPixelChannel:",
          "80:       {",
          "82:           (double) q[i],beta));",
          "83:         break;",
          "84:       }",
          "85:       case GreenPixelChannel:",
          "86:       {",
          "88:           (double) q[i],beta));",
          "89:         break;",
          "90:       }",
          "91:       case BluePixelChannel:",
          "92:       {",
          "94:           (double) q[i],beta));",
          "95:         break;",
          "96:       }",
          "97:       case BlackPixelChannel:",
          "98:       {",
          "100:           (double) q[i],beta));",
          "101:         break;",
          "102:       }",
          "103:       case AlphaPixelChannel:",
          "104:       {",
          "106:         break;",
          "107:       }",
          "108:       default:",
          "",
          "[Removed Lines]",
          "81:         composite[i]=ClampToQuantum(gamma*MagickOver_((double) p->red,alpha,",
          "87:         composite[i]=ClampToQuantum(gamma*MagickOver_((double) p->green,alpha,",
          "93:         composite[i]=ClampToQuantum(gamma*MagickOver_((double) p->blue,alpha,",
          "99:         composite[i]=ClampToQuantum(gamma*MagickOver_((double) p->black,alpha,",
          "105:         composite[i]=ClampToQuantum(QuantumRange*(Sa*(-Da)+Sa+Da));",
          "",
          "[Added Lines]",
          "78:         composite[i]=ClampToQuantum(MagickOver_((double) p->red,alpha,",
          "84:         composite[i]=ClampToQuantum(MagickOver_((double) p->green,alpha,",
          "90:         composite[i]=ClampToQuantum(MagickOver_((double) p->blue,alpha,",
          "96:         composite[i]=ClampToQuantum(MagickOver_((double) p->black,alpha,",
          "102:         composite[i]=ClampToQuantum(QuantumRange*(Sa+Da-Sa*-Da));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "119: {",
          "120:   double",
          "121:     Da,",
          "123:     Sa;",
          "",
          "[Removed Lines]",
          "122:     gamma,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "128:   Sa=QuantumScale*alpha;",
          "129:   Da=QuantumScale*beta,",
          "136:   if (q->colorspace == CMYKColorspace)",
          "138: }",
          "140: static inline double RoundToUnity(const double value)",
          "",
          "[Removed Lines]",
          "130:   gamma=Sa*(-Da)+Sa+Da;",
          "131:   composite->alpha=(double) QuantumRange*gamma;",
          "132:   gamma=PerceptibleReciprocal(gamma);",
          "133:   composite->red=gamma*MagickOver_(p->red,alpha,q->red,beta);",
          "134:   composite->green=gamma*MagickOver_(p->green,alpha,q->green,beta);",
          "135:   composite->blue=gamma*MagickOver_(p->blue,alpha,q->blue,beta);",
          "137:     composite->black=gamma*MagickOver_(p->black,alpha,q->black,beta);",
          "",
          "[Added Lines]",
          "126:   composite->alpha=(double) QuantumRange*(Sa+Da-Sa*Da);",
          "127:   composite->red=MagickOver_(p->red,alpha,q->red,beta);",
          "128:   composite->green=MagickOver_(p->green,alpha,q->green,beta);",
          "129:   composite->blue=MagickOver_(p->blue,alpha,q->blue,beta);",
          "131:     composite->black=MagickOver_(p->black,alpha,q->black,beta);",
          "",
          "---------------"
        ],
        "MagickCore/version.h||MagickCore/version.h": [
          "File: MagickCore/version.h -> MagickCore/version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: #define MagickppLibAddendum  \"-0\"",
          "49: #define MagickppLibInterface  0",
          "50: #define MagickppLibMinInterface  0",
          "52: #define MagickChangeDate   \"20120427\"",
          "53: #define MagickAuthoritativeLicense  \\",
          "54:   \"http://www.imagemagick.org/script/license.php\"",
          "",
          "[Removed Lines]",
          "51: #define MagickReleaseDate  \"2015-05-30\"",
          "",
          "[Added Lines]",
          "51: #define MagickReleaseDate  \"2015-06-02\"",
          "",
          "---------------"
        ],
        "PerlMagick/Makefile.PL||PerlMagick/Makefile.PL": [
          "File: PerlMagick/Makefile.PL -> PerlMagick/Makefile.PL",
          "--- Hunk 1 ---",
          "[Context before]",
          "206:    'INC' => $INC_magick,",
          "208:    # C compiler",
          "211:    # C pre-processor flags (e.g. -I & -D options)",
          "212:    # 'CPPFLAGS' => \"$Config{'cppflags'} -pthread -I/usr/include/pango-1.0 -I/usr/include/cairo -I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include -I/usr/include/pixman-1 -I/usr/include/freetype2 -I/usr/include/libpng16 -I/usr/include/freetype2 -I/usr/include/libdrm -I/usr/include/libpng16 -I/usr/include/freetype2 -I/usr/include/libpng16 -I/usr/include/freetype2 -I/usr/include/libpng16 -DMAGICKCORE_HDRI_ENABLE=1 -DMAGICKCORE_QUANTUM_DEPTH=16 -I/usr/include/libxml2\",",
          "",
          "[Removed Lines]",
          "209:    #'CC' => 'gcc -std=gnu99 -std=gnu99',",
          "",
          "[Added Lines]",
          "209:    #'CC' => 'gcc',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "215:    'CCFLAGS' => $CCFLAGS_magick,",
          "217:    # Linker",
          "220:    # Linker flags for building an executable",
          "221:    'LDFLAGS' =>  $LDFLAGS_magick,",
          "",
          "[Removed Lines]",
          "218:    #'LD' => $Config{'ld'} == $Config{'cc'} ? 'gcc -std=gnu99 -std=gnu99' : $Config{'ld'},",
          "",
          "[Added Lines]",
          "218:    #'LD' => $Config{'ld'} == $Config{'cc'} ? 'gcc' : $Config{'ld'},",
          "",
          "---------------"
        ],
        "PerlMagick/check.sh||PerlMagick/check.sh": [
          "File: PerlMagick/check.sh -> PerlMagick/check.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "43: if test -x PerlMagick -a -f Makefile.aperl ; then",
          "44:   # Static build test incantation",
          "46: elif test -f Makefile -a -f Magick.o; then",
          "47:   # Shared build test incantation",
          "49: else",
          "50:   echo 'PerlMagick has not been built!'",
          "51:   exit 1",
          "",
          "[Removed Lines]",
          "45:   ${MAKE} -f Makefile.aperl CC='gcc -std=gnu99 -std=gnu99' TEST_VERBOSE=1 test",
          "48:   ${MAKE} CC='gcc -std=gnu99 -std=gnu99' TEST_VERBOSE=1 test",
          "",
          "[Added Lines]",
          "45:   ${MAKE} -f Makefile.aperl CC='gcc' TEST_VERBOSE=1 test",
          "48:   ${MAKE} CC='gcc' TEST_VERBOSE=1 test",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "71ffec4d0efd09a7fa3d2330d09d9e6738f66a5c",
      "candidate_info": {
        "commit_hash": "71ffec4d0efd09a7fa3d2330d09d9e6738f66a5c",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/71ffec4d0efd09a7fa3d2330d09d9e6738f66a5c",
        "files": [
          "MagickCore/Makefile.am",
          "MagickCore/option-private.h",
          "MagickCore/option.c",
          "MagickCore/version.h",
          "Makefile.in",
          "configure"
        ],
        "message": "",
        "before_after_code_files": [
          "MagickCore/Makefile.am||MagickCore/Makefile.am",
          "MagickCore/option-private.h||MagickCore/option-private.h",
          "MagickCore/option.c||MagickCore/option.c",
          "MagickCore/version.h||MagickCore/version.h",
          "Makefile.in||Makefile.in"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/version.h||MagickCore/version.h"
          ],
          "candidate": [
            "MagickCore/version.h||MagickCore/version.h"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/Makefile.am||MagickCore/Makefile.am": [
          "File: MagickCore/Makefile.am -> MagickCore/Makefile.am",
          "--- Hunk 1 ---",
          "[Context before]",
          "204:  MagickCore/opencl-private.h \\",
          "205:  MagickCore/option.c \\",
          "206:  MagickCore/option.h \\",
          "207:  MagickCore/paint.c \\",
          "208:  MagickCore/paint.h \\",
          "209:  MagickCore/pixel.c \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "207:  MagickCore/option-private.h \\",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "450:  MagickCore/nt-base.h \\",
          "451:  MagickCore/nt-feature.h \\",
          "452:  MagickCore/opencl-private.h \\",
          "453:   MagickCore/pixel-private.h \\",
          "454:   MagickCore/policy-private.h \\",
          "455:   MagickCore/profile-private.h \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "454:  MagickCore/option-private.h \\",
          "",
          "---------------"
        ],
        "MagickCore/option-private.h||MagickCore/option-private.h": [
          "File: MagickCore/option-private.h -> MagickCore/option-private.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2:   Copyright 1999-2014 ImageMagick Studio LLC, a non-profit organization",
          "3:   dedicated to making software imaging solutions freely available.",
          "5:   You may not use this file except in compliance with the License.",
          "6:   obtain a copy of the License at",
          "8:     http://www.imagemagick.org/script/license.php",
          "10:   Unless required by applicable law or agreed to in writing, software",
          "11:   distributed under the License is distributed on an \"AS IS\" BASIS,",
          "12:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
          "13:   See the License for the specific language governing permissions and",
          "14:   limitations under the License.",
          "16:   MagickCore option private methods.",
          "18: #ifndef _MAGICKCORE_OPTION_PRIVATE_H",
          "19: #define _MAGICKCORE_OPTION_PRIVATE_H",
          "21: #if defined(__cplusplus) || defined(c_plusplus)",
          "22: extern \"C\" {",
          "23: #endif",
          "25: extern MagickPrivate MagickBooleanType",
          "26:   IsOptionMember(const char *,const char *);",
          "28: #if defined(__cplusplus) || defined(c_plusplus)",
          "29: }",
          "30: #endif",
          "32: #endif",
          "",
          "---------------"
        ],
        "MagickCore/option.c||MagickCore/option.c": [
          "File: MagickCore/option.c -> MagickCore/option.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "64: #include \"MagickCore/monitor.h\"",
          "65: #include \"MagickCore/montage.h\"",
          "66: #include \"MagickCore/morphology.h\"",
          "67: #include \"MagickCore/option.h\"",
          "68: #include \"MagickCore/pixel.h\"",
          "69: #include \"MagickCore/policy.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "67: #include \"MagickCore/option.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2370:   option_info=GetOptionInfo(option);",
          "2371:   if (option_info == (const OptionInfo *) NULL)",
          "2372:     return((const char *) NULL);",
          "2373:   for (i=0; option_info[i].mnemonic != (const char *) NULL; i++)",
          "2374:     if (type == option_info[i].type)",
          "2375:       break;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2371:   option_info=GetOptionInfo(option);",
          "2372:   if (option_info == (const OptionInfo *) NULL)",
          "2373:     return((const char *) NULL);",
          "2374:   for (i=0; option_info[i].mnemonic != (const char *) NULL; i++)",
          "2375:     if (type == option_info[i].type)",
          "2376:       break;",
          "2377:   if (option_info[i].mnemonic == (const char *) NULL)",
          "2378:     return(\"undefined\");",
          "2379:   return(option_info[i].mnemonic);",
          "2380: }",
          "2384: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%",
          "2385: %                                                                             %",
          "2386: %                                                                             %",
          "2387: %                                                                             %",
          "2388: %   I s O p t i o n M e m b e r                                               %",
          "2389: %                                                                             %",
          "2390: %                                                                             %",
          "2391: %                                                                             %",
          "2392: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%",
          "2393: %",
          "2394: %  IsOptionMember() returns MagickTrue if the option is a member of the options",
          "2395: %  list (e.g. ICC is a member of xmp,icc,iptc).",
          "2396: %",
          "2397: %  The format of the IsOptionMember function is:",
          "2398: %",
          "2399: %      MagickBooleanType IsOptionMember(const char *option,",
          "2400: %        const char *options)",
          "2401: %",
          "2402: %  A description of each parameter follows:",
          "2403: %",
          "2404: %    o option: an option or option expression (e.g. ICC or *).",
          "2405: %",
          "2406: %    o options: one or more options separated by commas.",
          "2407: %",
          "2408: %",
          "2410: MagickPrivate MagickBooleanType IsOptionMember(const char *option,",
          "2411:   const char *options)",
          "2412: {",
          "2413:   char",
          "2417:   int",
          "2418:     number_options;",
          "2420:   register ssize_t",
          "2421:     i;",
          "2424:     Is option a member of the options list?",
          "2426:   string=ConstantString(options);",
          "2427:   (void) SubstituteString(&string,\",\",\" \");",
          "2428:   option_list=StringToArgv(string,&number_options);",
          "2429:   string=DestroyString(string);",
          "2430:   if (option_list == (char **) NULL)",
          "",
          "---------------"
        ],
        "MagickCore/version.h||MagickCore/version.h": [
          "File: MagickCore/version.h -> MagickCore/version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: #define MagickPackageName \"ImageMagick\"",
          "29: #define MagickCopyright  \"Copyright (C) 1999-2014 ImageMagick Studio LLC\"",
          "31: #define MagickLibVersion  0x700",
          "32: #define MagickLibVersionText  \"7.0.0\"",
          "33: #define MagickLibVersionNumber  1,0,0",
          "",
          "[Removed Lines]",
          "30: #define MagickSVNRevision  \"16049:16055M\"",
          "",
          "[Added Lines]",
          "30: #define MagickSVNRevision  \"16049:16068M\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "48: #define MagickppLibAddendum  \"-0\"",
          "49: #define MagickppLibInterface  1",
          "50: #define MagickppLibMinInterface  1",
          "52: #define MagickChangeDate   \"20120427\"",
          "53: #define MagickAuthoritativeURL  \"http://www.imagemagick.org\"",
          "54: #define MagickFeatures \"DPC HDRI OpenMP\"",
          "",
          "[Removed Lines]",
          "51: #define MagickReleaseDate  \"2014-06-23\"",
          "",
          "[Added Lines]",
          "51: #define MagickReleaseDate  \"2014-06-25\"",
          "",
          "---------------"
        ],
        "Makefile.in||Makefile.in": [
          "File: Makefile.in -> Makefile.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "494:  MagickCore/nt-base.h MagickCore/nt-base-private.h \\",
          "495:  MagickCore/nt-feature.h MagickCore/opencl.c \\",
          "496:  MagickCore/opencl.h MagickCore/opencl-private.h \\",
          "498:  MagickCore/paint.h MagickCore/pixel.c MagickCore/pixel.h \\",
          "499:  MagickCore/pixel-accessor.h MagickCore/pixel-private.h \\",
          "500:  MagickCore/policy.c MagickCore/policy.h \\",
          "",
          "[Removed Lines]",
          "497:  MagickCore/option.c MagickCore/option.h MagickCore/paint.c \\",
          "",
          "[Added Lines]",
          "497:  MagickCore/option.c MagickCore/option.h \\",
          "498:  MagickCore/option-private.h MagickCore/paint.c \\",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4283:  MagickCore/opencl-private.h \\",
          "4284:  MagickCore/option.c \\",
          "4285:  MagickCore/option.h \\",
          "4286:  MagickCore/paint.c \\",
          "4287:  MagickCore/paint.h \\",
          "4288:  MagickCore/pixel.c \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4287:  MagickCore/option-private.h \\",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4524:  MagickCore/nt-base.h \\",
          "4525:  MagickCore/nt-feature.h \\",
          "4526:  MagickCore/opencl-private.h \\",
          "4527:   MagickCore/pixel-private.h \\",
          "4528:   MagickCore/policy-private.h \\",
          "4529:   MagickCore/profile-private.h \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4529:  MagickCore/option-private.h \\",
          "",
          "---------------"
        ]
      }
    }
  ]
}