{
  "cve_id": "CVE-2019-15945",
  "cve_desc": "OpenSC before 0.20.0-rc1 has an out-of-bounds access of an ASN.1 Bitstring in decode_bit_string in libopensc/asn1.c.",
  "repo": "OpenSC/OpenSC",
  "patch_hash": "412a6142c27a5973c61ba540e33cdc22d5608e68",
  "patch_info": {
    "commit_hash": "412a6142c27a5973c61ba540e33cdc22d5608e68",
    "repo": "OpenSC/OpenSC",
    "commit_url": "https://github.com/OpenSC/OpenSC/commit/412a6142c27a5973c61ba540e33cdc22d5608e68",
    "files": [
      "src/libopensc/asn1.c"
    ],
    "message": "fixed out of bounds access of ASN.1 Bitstring\n\nCredit to OSS-Fuzz",
    "before_after_code_files": [
      "src/libopensc/asn1.c||src/libopensc/asn1.c"
    ]
  },
  "patch_diff": {
    "src/libopensc/asn1.c||src/libopensc/asn1.c": [
      "File: src/libopensc/asn1.c -> src/libopensc/asn1.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "570: {",
      "571:  const u8 *in = inbuf;",
      "572:  u8 *out = (u8 *) outbuf;",
      "575:  int i, count = 0;",
      "579:  if (outlen < octets_left)",
      "580:   return SC_ERROR_BUFFER_TOO_SMALL;",
      "581:  if (inlen < 1)",
      "582:   return SC_ERROR_INVALID_ASN1_OBJECT;",
      "583:  while (octets_left) {",
      "",
      "[Removed Lines]",
      "573:  int zero_bits = *in & 0x07;",
      "574:  size_t octets_left = inlen - 1;",
      "577:  memset(outbuf, 0, outlen);",
      "578:  in++;",
      "",
      "[Added Lines]",
      "574:  int zero_bits;",
      "575:  size_t octets_left;",
      "582:  zero_bits = *in & 0x07;",
      "583:  octets_left = inlen - 1;",
      "584:  in++;",
      "585:  memset(outbuf, 0, outlen);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9b4b080be788a602fa8f01ac8d7e29cdaad07902",
      "candidate_info": {
        "commit_hash": "9b4b080be788a602fa8f01ac8d7e29cdaad07902",
        "repo": "OpenSC/OpenSC",
        "commit_url": "https://github.com/OpenSC/OpenSC/commit/9b4b080be788a602fa8f01ac8d7e29cdaad07902",
        "files": [
          "src/libopensc/asn1.c"
        ],
        "message": "fixed compiler warning",
        "before_after_code_files": [
          "src/libopensc/asn1.c||src/libopensc/asn1.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/libopensc/asn1.c||src/libopensc/asn1.c"
          ],
          "candidate": [
            "src/libopensc/asn1.c||src/libopensc/asn1.c"
          ]
        }
      },
      "candidate_diff": {
        "src/libopensc/asn1.c||src/libopensc/asn1.c": [
          "File: src/libopensc/asn1.c -> src/libopensc/asn1.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "574:  int zero_bits;",
          "575:  size_t octets_left;",
          "579:  if (inlen < 1)",
          "580:   return SC_ERROR_INVALID_ASN1_OBJECT;",
          "582:  zero_bits = *in & 0x07;",
          "584:  in++;",
          "587:  while (octets_left) {",
          "",
          "[Removed Lines]",
          "577:  if (outlen < octets_left)",
          "578:   return SC_ERROR_BUFFER_TOO_SMALL;",
          "583:  octets_left = inlen - 1;",
          "585:  memset(outbuf, 0, outlen);",
          "",
          "[Added Lines]",
          "579:  memset(outbuf, 0, outlen);",
          "582:  octets_left = inlen - 1;",
          "583:  if (outlen < octets_left)",
          "584:   return SC_ERROR_BUFFER_TOO_SMALL;",
          "",
          "---------------"
        ]
      }
    }
  ]
}