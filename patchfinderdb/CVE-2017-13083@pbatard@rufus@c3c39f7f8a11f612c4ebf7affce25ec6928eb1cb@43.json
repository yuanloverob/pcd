{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "4670cfaf35e8c7bfbae87104410d5088b59e69b1",
      "candidate_info": {
        "commit_hash": "4670cfaf35e8c7bfbae87104410d5088b59e69b1",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/4670cfaf35e8c7bfbae87104410d5088b59e69b1",
        "files": [
          ".gitignore",
          "ChangeLog.txt",
          "src/.clang/rufus.vcxproj",
          "src/.msvc/rufus.vcxproj",
          "src/rufus.rc"
        ],
        "message": "v2.13 (build 1081)",
        "before_after_code_files": [
          "src/.clang/rufus.vcxproj||src/.clang/rufus.vcxproj",
          "src/.msvc/rufus.vcxproj||src/.msvc/rufus.vcxproj",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/.clang/rufus.vcxproj||src/.clang/rufus.vcxproj": [
          "File: src/.clang/rufus.vcxproj -> src/.clang/rufus.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "113:     </Link>",
          "114:     <ResourceCompile>",
          "115:       <PreprocessorDefinitions>_UNICODE;UNICODE;RUFUS_LOC;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "117:     </ResourceCompile>",
          "118:   </ItemDefinitionGroup>",
          "119:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "",
          "[Removed Lines]",
          "116:       <Culture />",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "142:     </Link>",
          "143:     <ResourceCompile>",
          "144:       <PreprocessorDefinitions>_UNICODE;UNICODE;RUFUS_LOC;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "146:     </ResourceCompile>",
          "147:   </ItemDefinitionGroup>",
          "148:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "",
          "[Removed Lines]",
          "145:       <Culture />",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "168:     </Link>",
          "169:     <ResourceCompile>",
          "170:       <PreprocessorDefinitions>_UNICODE;UNICODE;RUFUS_LOC;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "172:     </ResourceCompile>",
          "173:   </ItemDefinitionGroup>",
          "174:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "",
          "[Removed Lines]",
          "171:       <Culture />",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "197:     </Link>",
          "198:     <ResourceCompile>",
          "199:       <PreprocessorDefinitions>_UNICODE;UNICODE;RUFUS_LOC;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "201:     </ResourceCompile>",
          "202:   </ItemDefinitionGroup>",
          "203:   <ItemGroup>",
          "",
          "[Removed Lines]",
          "200:       <Culture />",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/.msvc/rufus.vcxproj||src/.msvc/rufus.vcxproj": [
          "File: src/.msvc/rufus.vcxproj -> src/.msvc/rufus.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:     </Link>",
          "101:     <ResourceCompile>",
          "102:       <PreprocessorDefinitions>_UNICODE;UNICODE;RUFUS_LOC;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "104:     </ResourceCompile>",
          "105:   </ItemDefinitionGroup>",
          "106:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "",
          "[Removed Lines]",
          "103:       <Culture />",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "129:     </Link>",
          "130:     <ResourceCompile>",
          "131:       <PreprocessorDefinitions>_UNICODE;UNICODE;RUFUS_LOC;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "133:     </ResourceCompile>",
          "134:   </ItemDefinitionGroup>",
          "135:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "",
          "[Removed Lines]",
          "132:       <Culture />",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "153:     </Link>",
          "154:     <ResourceCompile>",
          "155:       <PreprocessorDefinitions>_UNICODE;UNICODE;RUFUS_LOC;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "157:     </ResourceCompile>",
          "158:   </ItemDefinitionGroup>",
          "159:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "",
          "[Removed Lines]",
          "156:       <Culture />",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "180:     </Link>",
          "181:     <ResourceCompile>",
          "182:       <PreprocessorDefinitions>_UNICODE;UNICODE;RUFUS_LOC;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "184:     </ResourceCompile>",
          "185:   </ItemDefinitionGroup>",
          "186:   <ItemGroup>",
          "",
          "[Removed Lines]",
          "183:       <Culture />",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.13.1080\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.13.1081\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,13,1080,0",
          "338:  PRODUCTVERSION 2,13,1080,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,13,1081,0",
          "338:  PRODUCTVERSION 2,13,1081,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1080\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1080\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1081\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1081\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fec0813073638ce0f7eeb162449cfa546eb5af9e",
      "candidate_info": {
        "commit_hash": "fec0813073638ce0f7eeb162449cfa546eb5af9e",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/fec0813073638ce0f7eeb162449cfa546eb5af9e",
        "files": [
          "src/.clang/rufus.vcxproj",
          "src/.msvc/rufus.vcxproj",
          "src/rufus.rc"
        ],
        "message": "[misc] fix MSVC builds",
        "before_after_code_files": [
          "src/.clang/rufus.vcxproj||src/.clang/rufus.vcxproj",
          "src/.msvc/rufus.vcxproj||src/.msvc/rufus.vcxproj",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/.clang/rufus.vcxproj||src/.clang/rufus.vcxproj": [
          "File: src/.clang/rufus.vcxproj -> src/.clang/rufus.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "105:       <AdditionalOptions>-Wno-deprecated-declarations</AdditionalOptions>",
          "106:     </ClCompile>",
          "107:     <Link>",
          "109:       <UACExecutionLevel>RequireAdministrator</UACExecutionLevel>",
          "110:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "111:       <SubSystem>Windows</SubSystem>",
          "",
          "[Removed Lines]",
          "108:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "[Added Lines]",
          "108:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;psapi.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "133:       <AdditionalOptions>-Wno-deprecated-declarations</AdditionalOptions>",
          "134:     </ClCompile>",
          "135:     <Link>",
          "137:       <UACExecutionLevel>RequireAdministrator</UACExecutionLevel>",
          "138:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "139:       <SubSystem>Windows</SubSystem>",
          "",
          "[Removed Lines]",
          "136:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "[Added Lines]",
          "136:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;psapi.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "157:       <AdditionalOptions>-Wno-deprecated-declarations</AdditionalOptions>",
          "158:     </ClCompile>",
          "159:     <Link>",
          "161:       <UACExecutionLevel>RequireAdministrator</UACExecutionLevel>",
          "162:       <GenerateDebugInformation>false</GenerateDebugInformation>",
          "163:       <SubSystem>Windows</SubSystem>",
          "",
          "[Removed Lines]",
          "160:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "[Added Lines]",
          "160:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;psapi.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "185:       <AdditionalOptions>-Wno-deprecated-declarations</AdditionalOptions>",
          "186:     </ClCompile>",
          "187:     <Link>",
          "189:       <UACExecutionLevel>RequireAdministrator</UACExecutionLevel>",
          "190:       <GenerateDebugInformation>false</GenerateDebugInformation>",
          "191:       <SubSystem>Windows</SubSystem>",
          "",
          "[Removed Lines]",
          "188:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "[Added Lines]",
          "188:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;psapi.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "---------------"
        ],
        "src/.msvc/rufus.vcxproj||src/.msvc/rufus.vcxproj": [
          "File: src/.msvc/rufus.vcxproj -> src/.msvc/rufus.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "92:       <Optimization>Disabled</Optimization>",
          "93:     </ClCompile>",
          "94:     <Link>",
          "96:       <UACExecutionLevel>RequireAdministrator</UACExecutionLevel>",
          "97:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "98:       <SubSystem>Windows</SubSystem>",
          "",
          "[Removed Lines]",
          "95:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "[Added Lines]",
          "95:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;psapi.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "120:       <Optimization>Disabled</Optimization>",
          "121:     </ClCompile>",
          "122:     <Link>",
          "124:       <UACExecutionLevel>RequireAdministrator</UACExecutionLevel>",
          "125:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "126:       <SubSystem>Windows</SubSystem>",
          "",
          "[Removed Lines]",
          "123:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "[Added Lines]",
          "123:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;psapi.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "143:       <DisableSpecificWarnings>4091;28252;28253;%(DisableSpecificWarnings)</DisableSpecificWarnings>",
          "144:     </ClCompile>",
          "145:     <Link>",
          "147:       <UACExecutionLevel>RequireAdministrator</UACExecutionLevel>",
          "148:       <GenerateDebugInformation>false</GenerateDebugInformation>",
          "149:       <SubSystem>Windows</SubSystem>",
          "",
          "[Removed Lines]",
          "146:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "[Added Lines]",
          "146:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;psapi.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "169:       <DisableSpecificWarnings>4091;28252;28253;%(DisableSpecificWarnings)</DisableSpecificWarnings>",
          "170:     </ClCompile>",
          "171:     <Link>",
          "173:       <UACExecutionLevel>RequireAdministrator</UACExecutionLevel>",
          "174:       <GenerateDebugInformation>false</GenerateDebugInformation>",
          "175:       <SubSystem>Windows</SubSystem>",
          "",
          "[Removed Lines]",
          "172:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "[Added Lines]",
          "172:       <AdditionalDependencies>setupapi.lib;comctl32.lib;wininet.lib;shlwapi.lib;crypt32.lib;wintrust.lib;psapi.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.15.1095\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.15.1096\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,15,1095,0",
          "338:  PRODUCTVERSION 2,15,1095,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,15,1096,0",
          "338:  PRODUCTVERSION 2,15,1096,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.15.1095\"",
          "361:             VALUE \"ProductVersion\", \"2.15.1095\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.15.1096\"",
          "361:             VALUE \"ProductVersion\", \"2.15.1096\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f18b3fec1ba09302a9db44ba184f94ec42d28cd0",
      "candidate_info": {
        "commit_hash": "f18b3fec1ba09302a9db44ba184f94ec42d28cd0",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/f18b3fec1ba09302a9db44ba184f94ec42d28cd0",
        "files": [
          "res/loc/ChangeLog.txt",
          "res/loc/po/fr-FR.po",
          "res/loc/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] use better terminology for NAND types",
        "before_after_code_files": [
          "res/loc/po/fr-FR.po||res/loc/po/fr-FR.po",
          "res/loc/rufus.loc||res/loc/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/loc/po/fr-FR.po||res/loc/po/fr-FR.po": [
          "File: res/loc/po/fr-FR.po -> res/loc/po/fr-FR.po",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: msgstr \"\"",
          "3: \"Project-Id-Version: 3.2\\n\"",
          "4: \"Report-Msgid-Bugs-To: pete@akeo.ie\\n\"",
          "7: \"Language: fr_FR\\n\"",
          "8: \"MIME-Version: 1.0\\n\"",
          "9: \"Content-Type: text/plain; charset=UTF-8\\n\"",
          "",
          "[Removed Lines]",
          "5: \"POT-Creation-Date: 2018-07-20 14:57+0100\\n\"",
          "6: \"PO-Revision-Date: 2018-07-20 14:57+0100\\n\"",
          "",
          "[Added Lines]",
          "5: \"POT-Creation-Date: 2018-07-20 21:03+0100\\n\"",
          "6: \"PO-Revision-Date: 2018-07-20 21:04+0100\\n\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "593: #. \u2022 MSG_087",
          "594: #.",
          "595: #. This message appears in Advanced format options \u2192 Check device for bad blocks \u2192 dropdown menu",
          "603: #. \u2022 MSG_088",
          "604: msgid \"Image is too big\"",
          "",
          "[Removed Lines]",
          "596: #. %s will be replaced with SLC, MLC or TLC, which is a type of flash memory. In other words, this",
          "597: #. message should mean \"for a flash memory device of type %s\". *Please* try to keep the translation",
          "598: #. as short as possible so that it won't result in an overly large dropdown... It's okay to use a",
          "599: #. translation for \"type\" instead of \"device\"  (e.g. \"for TLC type\"). See also MSG_035.",
          "600: msgid \"for %s devices\"",
          "601: msgstr \"pour type %s\"",
          "",
          "[Added Lines]",
          "596: #. %s will be replaced with SLC, MLC or TLC, which is a type of NAND (or flash memory). In other",
          "597: #. words, this message should mean \"for a flash memory device of type %s\". *Please* try to keep",
          "598: #. the translation as short as possible so that it won't result in an overly large dropdown...",
          "599: #. If you prefer, it's okay to use \"type\" or \"device\" instead of \"NAND\" (e.g. \"for TLC type\").",
          "600: #. See also MSG_035.",
          "601: msgid \"for %s NAND\"",
          "602: msgstr \"pour NAND %s\"",
          "",
          "---------------"
        ],
        "res/loc/rufus.loc||res/loc/rufus.loc": [
          "File: res/loc/rufus.loc -> res/loc/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "227: t MSG_085 \"Downloading '%s'\"",
          "228: t MSG_086 \"No image selected\"",
          "229: # This message appears in Advanced format options \u2192 Check device for bad blocks \u2192 dropdown menu",
          "235: t MSG_088 \"Image is too big\"",
          "236: t MSG_089 \"The image is too big for the selected target.\"",
          "237: t MSG_090 \"Unsupported ISO\"",
          "",
          "[Removed Lines]",
          "230: # %s will be replaced with SLC, MLC or TLC, which is a type of flash memory. In other words, this",
          "231: # message should mean \"for a flash memory device of type %s\". *Please* try to keep the translation",
          "232: # as short as possible so that it won't result in an overly large dropdown... It's okay to use a",
          "233: # translation for \"type\" instead of \"device\"  (e.g. \"for TLC type\"). See also MSG_035.",
          "234: t MSG_087 \"for %s devices\"",
          "",
          "[Added Lines]",
          "230: # %s will be replaced with SLC, MLC or TLC, which is a type of NAND (or flash memory). In other",
          "231: # words, this message should mean \"for a flash memory device of type %s\". *Please* try to keep",
          "232: # the translation as short as possible so that it won't result in an overly large dropdown...",
          "233: # If you prefer, it's okay to use \"type\" or \"device\" instead of \"NAND\" (e.g. \"for TLC type\").",
          "234: # See also MSG_035.",
          "235: t MSG_087 \"for %s NAND\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4620: t IDC_DOWNLOAD \"T\u00e9l\u00e9charger\"",
          "4622: g IDD_NOTIFICATION",
          "4624: t IDYES \"Oui\"",
          "4625: t IDNO \"Non\"",
          "",
          "[Removed Lines]",
          "4623: t IDC_MORE_INFO \"Plus d'info...\"",
          "",
          "[Added Lines]",
          "4624: t IDC_MORE_INFO \"Plus d'information\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4715: t MSG_084 \"Cette image ISO utilise une version obsol\u00e8te du fichier '%s'.\\nLes menus de d\u00e9marrage peuvent de pas fonctionner \u00e0 cause de cela.\\n\\nRufus peut t\u00e9l\u00e9charger une nouvelle version du fichier pour r\u00e9soudre ce probl\u00e8me :\\n- Choisissez 'Oui' pour t\u00e9l\u00e9charger le fichier depuis Internet\\n- Choisissez 'Non' pour garder le fichier de l'image ISO\\nSi vous ne savez pas quoi faire, s\u00e9lectionnez 'Oui'.\\n\\nNote : Le nouveau fichier sera t\u00e9l\u00e9charg\u00e9 dans le r\u00e9pertoire courant. Si un '%s' existe \u00e0 cet endroit, il sera r\u00e9utilis\u00e9 automatiquement.\"",
          "4716: t MSG_085 \"T\u00e9l\u00e9chargement de '%s'\"",
          "4717: t MSG_086 \"Aucune image s\u00e9lectionn\u00e9e\"",
          "4719: t MSG_088 \"Image trop large\"",
          "4720: t MSG_089 \"L'image est trop large pour \u00eatre copi\u00e9e sur le p\u00e9riph\u00e9rique s\u00e9lectionn\u00e9.\"",
          "4721: t MSG_090 \"Image ISO non support\u00e9e\"",
          "",
          "[Removed Lines]",
          "4718: t MSG_087 \"pour type %s\"",
          "",
          "[Added Lines]",
          "4719: t MSG_087 \"pour NAND %s\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.2.1345\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.2.1346\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "394: VS_VERSION_INFO VERSIONINFO",
          "397:  FILEFLAGSMASK 0x3fL",
          "398: #ifdef _DEBUG",
          "399:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "395:  FILEVERSION 3,2,1345,0",
          "396:  PRODUCTVERSION 3,2,1345,0",
          "",
          "[Added Lines]",
          "395:  FILEVERSION 3,2,1346,0",
          "396:  PRODUCTVERSION 3,2,1346,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "411:             VALUE \"Comments\", \"https://akeo.ie\"",
          "412:             VALUE \"CompanyName\", \"Akeo Consulting\"",
          "413:             VALUE \"FileDescription\", \"Rufus\"",
          "415:             VALUE \"InternalName\", \"Rufus\"",
          "416:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "417:             VALUE \"LegalTrademarks\", \"https://www.gnu.org/copyleft/gpl.html\"",
          "418:             VALUE \"OriginalFilename\", \"rufus-3.2.exe\"",
          "419:             VALUE \"ProductName\", \"Rufus\"",
          "421:         END",
          "422:     END",
          "423:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "414:             VALUE \"FileVersion\", \"3.2.1345\"",
          "420:             VALUE \"ProductVersion\", \"3.2.1345\"",
          "",
          "[Added Lines]",
          "414:             VALUE \"FileVersion\", \"3.2.1346\"",
          "420:             VALUE \"ProductVersion\", \"3.2.1346\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "94e4c0905b127666146dd1ac1e42e4865eb3ee55",
      "candidate_info": {
        "commit_hash": "94e4c0905b127666146dd1ac1e42e4865eb3ee55",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/94e4c0905b127666146dd1ac1e42e4865eb3ee55",
        "files": [
          "src/parser.c",
          "src/pki.c",
          "src/rufus.h",
          "src/rufus.rc"
        ],
        "message": "[pki] improve ASN.1 parser\n\n* Enable search from OIDs expressed as strings and ignore non UNIVERSAL classes",
        "before_after_code_files": [
          "src/parser.c||src/parser.c",
          "src/pki.c||src/pki.c",
          "src/rufus.h||src/rufus.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/pki.c||src/pki.c",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/pki.c||src/pki.c",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/parser.c||src/parser.c": [
          "File: src/parser.c -> src/parser.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1266:  return res;",
          "1267: }",
          "1270:    size_t oid_len, uint8_t asn1_type, size_t* data_len, BOOL* matched)",
          "1271: {",
          "1272:  void* ret;",
          "1273:  size_t pos = 0, len, len_len, i;",
          "1274:  uint8_t tag;",
          "1277:  while (pos < buf_len) {",
          "1279:   tag = buf[pos++] & 0x1F;",
          "1282:   len = 0;",
          "1283:   len_len = 1;",
          "1285:    pos++;",
          "1286:   } else {",
          "1287:    if (buf[pos] & 0x80) {",
          "1288:     len_len = buf[pos++] & 0x7F;",
          "1290:     if (len_len > 2) {",
          "1292:      return NULL;",
          "1293:     }",
          "1294:     for (i = 0; i < len_len; i++) {",
          "",
          "[Removed Lines]",
          "1269: static void* get_oid_data_from_asn1_internal(const uint8_t* buf, size_t buf_len, const void* oid,",
          "1275:  BOOL is_sequence;",
          "1278:   is_sequence = buf[pos] & 0x20; // Only need to handle the sequence attribute",
          "1284:   if (tag == 0x05) { // ignore \"NULL\" tag",
          "1291:      uprintf(\"get_oid_data_from_asn1: Length fields larger than 2 bytes are unsupported\");",
          "",
          "[Added Lines]",
          "1269: static void* get_data_from_asn1_internal(const uint8_t* buf, size_t buf_len, const void* oid,",
          "1275:  BOOL is_sequence, is_universal_tag;",
          "1278:   is_sequence = buf[pos] & 0x20;",
          "1279:   is_universal_tag = ((buf[pos] & 0xC0) == 0x00);",
          "1281:   if (tag == 0x1F) {",
          "1282:    uprintf(\"get_data_from_asn1: Long form tags are unsupported\");",
          "1283:    return NULL;",
          "1284:   }",
          "1289:   if ((is_universal_tag) && (tag == 0x05)) { // ignore \"NULL\" tag",
          "1296:      uprintf(\"get_data_from_asn1: Length fields larger than 2 bytes are unsupported\");",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1300:    }",
          "1302:    if (len > buf_len - pos) {",
          "1304:     return NULL;",
          "1305:    }",
          "1306:   }",
          "1308:   if (len != 0) {",
          "1309:    if (is_sequence) {",
          "1311:     if (ret != NULL)",
          "1312:      return ret;",
          "1315:     if ((!*matched) && (tag == 0x06) && (len == oid_len) && (memcmp(&buf[pos], oid, oid_len) == 0)) {",
          "1317:     } else if ((*matched) && (tag == asn1_type)) {",
          "1320:     }",
          "1321:    }",
          "1322:    pos += len;",
          "",
          "[Removed Lines]",
          "1303:     uprintf(\"get_oid_data_from_asn1: Overflow error (computed length %d is larger than remaining data)\", len);",
          "1310:     ret = get_oid_data_from_asn1_internal(&buf[pos], len, oid, oid_len, asn1_type, data_len, matched);",
          "1313:    } else {",
          "1319:      return (void*) &buf[pos];",
          "",
          "[Added Lines]",
          "1308:     uprintf(\"get_data_from_asn1: Overflow error (computed length %d is larger than remaining data)\", len);",
          "1315:     ret = get_data_from_asn1_internal(&buf[pos], len, oid, oid_len, asn1_type, data_len, matched);",
          "1318:    } else if (is_universal_tag) { // Only process tags that belong to the UNIVERSAL class",
          "1324:      return (void*)&buf[pos];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1326:  return NULL;",
          "1327: }",
          "1337: {",
          "1340: }",
          "",
          "[Removed Lines]",
          "1335: void* get_oid_data_from_asn1(const uint8_t* buf, size_t buf_len, const uint8_t* oid, size_t oid_len,",
          "1336:  uint8_t asn1_type, size_t* data_len)",
          "1338:  BOOL matched = (oid == NULL);",
          "1339:  return get_oid_data_from_asn1_internal(buf, buf_len, oid, oid_len, asn1_type, data_len, &matched);",
          "",
          "[Added Lines]",
          "1336: static size_t make_flagged_int(unsigned long value, uint8_t *buf, size_t buflen)",
          "1337: {",
          "1338:  BOOL more = FALSE;",
          "1339:  int shift;",
          "1341:  for (shift = 28; shift > 0; shift -= 7) {",
          "1342:   if (more || value >= ((unsigned long)1 << shift)) {",
          "1343:    buf[buflen++] = (uint8_t) (0x80 | (value >> shift));",
          "1344:    value -= (value >> shift) << shift;",
          "1345:    more = TRUE;",
          "1346:   }",
          "1347:  }",
          "1348:  buf[buflen++] = (uint8_t) value;",
          "1349:  return buflen;",
          "1350: }",
          "1354: static uint8_t* oid_from_str(const char* oid_str, size_t* ret_len)",
          "1355: {",
          "1356:  uint8_t* oid = NULL;",
          "1357:  unsigned long val1 = 0, val;",
          "1358:  const char *endp;",
          "1359:  int arcno = 0;",
          "1360:  size_t oid_len = 0;",
          "1362:  if ((oid_str == NULL) || (oid_str[0] == 0))",
          "1363:   return NULL;",
          "1366:  oid = malloc(1 + strlen(oid_str) + 2);",
          "1367:  if (oid == NULL)",
          "1368:   return NULL;",
          "1370:  do {",
          "1371:   arcno++;",
          "1372:   val = strtoul(oid_str, (char**)&endp, 10);",
          "1373:   if (!isdigit(*oid_str) || !(*endp == '.' || !*endp))",
          "1374:    goto err;",
          "1375:   if (*endp == '.')",
          "1376:    oid_str = endp + 1;",
          "1378:   if (arcno == 1) {",
          "1379:    if (val > 2)",
          "1380:     break; // Not allowed, error caught below.",
          "1381:    val1 = val;",
          "1382:   } else if (arcno == 2) {",
          "1384:    if (val1 < 2) {",
          "1385:     if (val > 39)",
          "1386:      goto err;",
          "1387:     oid[oid_len++] = (uint8_t)(val1 * 40 + val);",
          "1388:    } else {",
          "1389:     val += 80;",
          "1390:     oid_len = make_flagged_int(val, oid, oid_len);",
          "1391:    }",
          "1392:   } else {",
          "1393:    oid_len = make_flagged_int(val, oid, oid_len);",
          "1394:   }",
          "1395:  } while (*endp == '.');",
          "1398:  if (arcno == 1 || oid_len < 2 || oid_len > 254)",
          "1399:   goto err;",
          "1402:  return oid;",
          "1404: err:",
          "1405:  free(oid);",
          "1406:  return NULL;",
          "1407: }",
          "1415: void* get_data_from_asn1(const uint8_t* buf, size_t buf_len, const char* oid_str, uint8_t asn1_type, size_t* data_len)",
          "1417:  void* ret;",
          "1418:  uint8_t* oid = NULL;",
          "1419:  size_t oid_len = 0;",
          "1420:  BOOL matched = ((oid_str == NULL) || (oid_str[0] == 0));",
          "1422:  if (!matched) {",
          "1424:   oid = oid_from_str(oid_str, &oid_len);",
          "1425:   if (oid == NULL) {",
          "1426:    uprintf(\"get_oid_data_from_asn1: Could not convert OID string '%s'\", oid_str);",
          "1427:    return NULL;",
          "1428:   }",
          "1429:  }",
          "1431:  ret = get_data_from_asn1_internal(buf, buf_len, oid, oid_len, asn1_type, data_len, &matched);",
          "1432:  free(oid);",
          "1433:  return ret;",
          "",
          "---------------"
        ],
        "src/pki.c||src/pki.c": [
          "File: src/pki.c -> src/pki.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "240: static uint64_t GetRFC3161TimeStamp(PCMSG_SIGNER_INFO pSignerInfo)",
          "241: {",
          "244:  BOOL r, found = FALSE;",
          "245:  DWORD n, dwSize;",
          "246:  PCRYPT_CONTENT_INFO pCounterSignerInfo = NULL;",
          "",
          "[Removed Lines]",
          "243:  const uint8_t OID_RFC3161_timeStamp[] = { 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x10, 0x01, 0x04 };",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "273:    }",
          "279:     0x04, &timestamp_token_size);",
          "280:    if (timestamp_token) {",
          "283:      0x18, &timestamp_str_size);",
          "284:     if (timestamp_str) {",
          "",
          "[Removed Lines]",
          "276:    timestamp_token = get_oid_data_from_asn1(pCounterSignerInfo->Content.pbData,",
          "277:     pCounterSignerInfo->Content.cbData, OID_RFC3161_timeStamp, sizeof(OID_RFC3161_timeStamp),",
          "281:     timestamp_str = get_oid_data_from_asn1(timestamp_token, timestamp_token_size, NULL, 0,",
          "",
          "[Added Lines]",
          "274:    timestamp_token = get_data_from_asn1(pCounterSignerInfo->Content.pbData,",
          "275:     pCounterSignerInfo->Content.cbData, szOID_TIMESTAMP_TOKEN,",
          "279:     timestamp_str = get_data_from_asn1(timestamp_token, timestamp_token_size, NULL,",
          "",
          "---------------"
        ],
        "src/rufus.h||src/rufus.h": [
          "File: src/rufus.h -> src/rufus.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "478: extern char* replace_in_token_data(const char* filename, const char* token, const char* src, const char* rep, BOOL dos2unix);",
          "479: extern char* replace_char(const char* src, const char c, const char* rep);",
          "480: extern void parse_update(char* buf, size_t len);",
          "483: extern uint8_t WimExtractCheck(void);",
          "484: extern BOOL WimExtractFile(const char* wim_image, int index, const char* src, const char* dst);",
          "485: extern BOOL WimExtractFile_API(const char* image, int index, const char* src, const char* dst);",
          "",
          "[Removed Lines]",
          "481: extern void* get_oid_data_from_asn1(const uint8_t* buf, size_t buf_len, const uint8_t* oid, size_t oid_len,",
          "482:  uint8_t asn1_type, size_t* data_len);",
          "",
          "[Added Lines]",
          "481: extern void* get_data_from_asn1(const uint8_t* buf, size_t buf_len, const char* oid_str, uint8_t asn1_type, size_t* data_len);",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.17.1190\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.17.1191\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,17,1190,0",
          "370:  PRODUCTVERSION 2,17,1190,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,17,1191,0",
          "370:  PRODUCTVERSION 2,17,1191,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.17.1190\"",
          "393:             VALUE \"ProductVersion\", \"2.17.1190\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.17.1191\"",
          "393:             VALUE \"ProductVersion\", \"2.17.1191\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d78357317872a40b307ec9d5693b8e615c416897",
      "candidate_info": {
        "commit_hash": "d78357317872a40b307ec9d5693b8e615c416897",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/d78357317872a40b307ec9d5693b8e615c416897",
        "files": [
          "src/format.c",
          "src/rufus.c",
          "src/rufus.rc"
        ],
        "message": "[syslinux] enable NTFS selection for Syslinux 6.x or later\n\n* Tested with latest Arch, Debian and Ubuntu",
        "before_after_code_files": [
          "src/format.c||src/format.c",
          "src/rufus.c||src/rufus.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/format.c||src/format.c": [
          "File: src/format.c -> src/format.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "930:  if ( (bt == BT_SYSLINUX_V4) || (bt == BT_SYSLINUX_V6) ||",
          "932:   uprintf(using_msg, \"Syslinux\");",
          "933:   r = write_syslinux_mbr(fp);",
          "934:   goto notify;",
          "",
          "[Removed Lines]",
          "931:    ((bt == BT_ISO) && (HAS_SYSLINUX(img_report)) && (IS_FAT(fs))) ) {",
          "",
          "[Added Lines]",
          "931:    ((bt == BT_ISO) && HAS_SYSLINUX(img_report)) ) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1903:    }",
          "1904:   } else if ( (bt == BT_SYSLINUX_V4) || (bt == BT_SYSLINUX_V6) ||",
          "1905:    ((bt == BT_ISO) && (HAS_SYSLINUX(img_report) || HAS_REACTOS(img_report)) &&",
          "1907:    if (!InstallSyslinux(DriveIndex, drive_name[0], fs)) {",
          "1908:     FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_INSTALL_FAILURE;",
          "1909:    }",
          "",
          "[Removed Lines]",
          "1906:     (!HAS_WINDOWS(img_report) || !allow_dual_uefi_bios) && (IS_FAT(fs))) ) {",
          "",
          "[Added Lines]",
          "1906:     (!HAS_WINDOWS(img_report) || !allow_dual_uefi_bios)) ) {",
          "",
          "---------------"
        ],
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1319:      ShellExecuteA(hMainDialog, \"open\", SEVENZIP_URL, NULL, NULL, SW_SHOWNORMAL);",
          "1320:     return FALSE;",
          "1321:    }",
          "1323:      || ((IS_FAT(fs)) && (!HAS_SYSLINUX(img_report)) && (!allow_dual_uefi_bios) && !IS_EFI_BOOTABLE(img_report) &&",
          "1324:       (!HAS_REACTOS(img_report)) && !HAS_KOLIBRIOS(img_report) && (!HAS_GRUB(img_report)))",
          "1325:      || ((IS_FAT(fs)) && (HAS_WINDOWS(img_report) || HAS_INSTALL_WIM(img_report))) ) {",
          "",
          "[Removed Lines]",
          "1322:   } else if ( ((fs == FS_NTFS) && (!HAS_WINDOWS(img_report)) && (!HAS_GRUB(img_report)))",
          "",
          "[Added Lines]",
          "1322:   } else if ( ((fs == FS_NTFS) && !HAS_WINDOWS(img_report) && !HAS_GRUB(img_report) &&",
          "1323:       (!HAS_SYSLINUX(img_report) || (SL_MAJOR(img_report.sl_version) <= 5)))",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1010\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1011\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1010,0",
          "338:  PRODUCTVERSION 2,12,1010,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1011,0",
          "338:  PRODUCTVERSION 2,12,1011,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2016 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1010\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1010\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1011\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1011\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}