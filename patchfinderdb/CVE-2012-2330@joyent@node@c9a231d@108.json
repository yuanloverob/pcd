{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "dce86828273ee2bca41fe2bf41e62ba044544177",
      "candidate_info": {
        "commit_hash": "dce86828273ee2bca41fe2bf41e62ba044544177",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/dce86828273ee2bca41fe2bf41e62ba044544177",
        "files": [
          "doc/api/cluster.markdown",
          "lib/cluster.js"
        ],
        "message": "cluster: English language fixing",
        "before_after_code_files": [
          "lib/cluster.js||licluster.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/cluster.js||licluster.js": [
          "File: lib/cluster.js -> licluster.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "51: var serverHandlers = {};",
          "55: var queryIds = 0;",
          "56: var queryCallbacks = {};",
          "",
          "[Removed Lines]",
          "54: var serverLisenters = {};",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "153: }",
          "157: function handleMessage(worker, inMessage, inHandle) {",
          "",
          "[Removed Lines]",
          "156: var messageHandingObject = {};",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "161:   message.cmd = inMessage.cmd.substr(INTERNAL_PREFIX.length);",
          "163:   var respondUsed = false;",
          "165:     respondUsed = true;",
          "166:     handleResponse(outMessage, outHandler, inMessage, inHandle, worker);",
          "172:   }",
          "",
          "[Removed Lines]",
          "164:   var respond = function(outMessage, outHandler) {",
          "167:   };",
          "170:   if (messageHandingObject[message.cmd]) {",
          "171:     messageHandingObject[message.cmd](message, worker, respond);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "181: if (cluster.isMaster) {",
          "185:     worker.state = 'online';",
          "186:     debug('Worker ' + worker.process.pid + ' online');",
          "187:     worker.emit('online', worker);",
          "",
          "[Removed Lines]",
          "184:   messageHandingObject.online = function(message, worker) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "189:   };",
          "",
          "[Removed Lines]",
          "192:   messageHandingObject.queryServer = function(message, worker, send) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "208:   };",
          "213:     worker.state = 'listening';",
          "",
          "[Removed Lines]",
          "211:   messageHandingObject.listening = function(message, worker) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "226:   };",
          "230:     worker.suicide = true;",
          "231:   };",
          "",
          "[Removed Lines]",
          "229:   messageHandingObject.suicide = function(message, worker) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "236: else if (cluster.isWorker) {",
          "240:     worker.disconnect();",
          "241:   };",
          "242: }",
          "",
          "[Removed Lines]",
          "239:   messageHandingObject.disconnect = function(message, worker) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "412:     this.suicide = true;",
          "416:     var progress = new ProgressTracker(servers, function() {",
          "421:       self.process.disconnect();",
          "422:     });",
          "",
          "[Removed Lines]",
          "415:     var servers = Object.keys(serverLisenters).length;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "429:       progress.check();",
          "432:       var server;",
          "437:         if (server._handle === null) {",
          "",
          "[Removed Lines]",
          "433:       for (var key in serverLisenters) {",
          "434:         server = serverLisenters[key];",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "513:   var key = [address, port, addressType].join(':');",
          "517:   tcpSelf.once('listening', function() {",
          "",
          "[Removed Lines]",
          "514:   serverLisenters[key] = tcpSelf;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "29b2fdb0c513f1735be9e16223b873c71ee7e7ab",
      "candidate_info": {
        "commit_hash": "29b2fdb0c513f1735be9e16223b873c71ee7e7ab",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/29b2fdb0c513f1735be9e16223b873c71ee7e7ab",
        "files": [
          "deps/v8/src/globals.h",
          "deps/v8/src/objects.h",
          "deps/v8/src/v8utils.h"
        ],
        "message": "Force inlining CopyChars and String::Get.\n\nBUG=\nTEST=\n\nReview URL: https://chromiumcodereview.appspot.com/10332054\n\ngit-svn-id: https://v8.googlecode.com/svn/branches/bleeding_edge@11527 ce2b1a6d-e550-0410-aec6-3dcde31c8c00",
        "before_after_code_files": [
          "deps/v8/src/globals.h||deps/v8/src/globals.h",
          "deps/v8/src/objects.h||deps/v8/src/objects.h",
          "deps/v8/src/v8utils.h||deps/v8/src/v8utils.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/v8/src/globals.h||deps/v8/src/globals.h": [
          "File: deps/v8/src/globals.h -> deps/v8/src/globals.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "345: #define INLINE(header) inline __attribute__((always_inline)) header",
          "346: #define NO_INLINE(header) __attribute__((noinline)) header",
          "347: #endif",
          "348: #else",
          "349: #define INLINE(header) inline header",
          "350: #define NO_INLINE(header) header",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "348: #elif defined(_MSC_VER) && !defined(DEBUG)",
          "349: #define INLINE(header) __forceinline header",
          "350: #define NO_INLINE(header) header",
          "",
          "---------------"
        ],
        "deps/v8/src/objects.h||deps/v8/src/objects.h": [
          "File: deps/v8/src/objects.h -> deps/v8/src/objects.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "6829:   inline void Set(int index, uint16_t value);",
          "",
          "[Removed Lines]",
          "6832:   inline uint16_t Get(int index);",
          "",
          "[Added Lines]",
          "6832:   INLINE(uint16_t Get(int index));",
          "",
          "---------------"
        ],
        "deps/v8/src/v8utils.h||deps/v8/src/v8utils.h": [
          "File: deps/v8/src/v8utils.h -> deps/v8/src/v8utils.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "199:                             bool verbose = true);",
          "204: template <typename sourcechar, typename sinkchar>",
          "206:   sinkchar* limit = dest + chars;",
          "207: #ifdef V8_HOST_CAN_READ_UNALIGNED",
          "208:   if (sizeof(*dest) == sizeof(*src)) {",
          "",
          "[Removed Lines]",
          "205: inline void CopyChars(sinkchar* dest, const sourcechar* src, int chars) {",
          "",
          "[Added Lines]",
          "204: INLINE(void CopyChars(sinkchar* dest, const sourcechar* src, int chars));",
          "207: template <typename sourcechar, typename sinkchar>",
          "208: void CopyChars(sinkchar* dest, const sourcechar* src, int chars) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4cbcdb4b2cfac0fb22775180c814258e4b694def",
      "candidate_info": {
        "commit_hash": "4cbcdb4b2cfac0fb22775180c814258e4b694def",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/4cbcdb4b2cfac0fb22775180c814258e4b694def",
        "files": [
          "test/simple/test-debugger-repl-utf8.js",
          "test/simple/test-debugger-repl.js"
        ],
        "message": "test: make debugger-repl tests work with isolates",
        "before_after_code_files": [
          "test/simple/test-debugger-repl-utf8.js||test/simple/test-debugger-repl-utf8.js",
          "test/simple/test-debugger-repl.js||test/simple/test-debugger-repl.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/simple/test-debugger-repl-utf8.js||test/simple/test-debugger-repl-utf8.js": [
          "File: test/simple/test-debugger-repl-utf8.js -> test/simple/test-debugger-repl-utf8.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "76: }",
          "87: addTest('n', [",
          "",
          "[Removed Lines]",
          "79: addTest(null, [",
          "80:   /listening on port 5858/,",
          "81:   /connecting... ok/,",
          "82:   /break in .*:1/,",
          "83:   /1/, /2/, /3/",
          "84: ]);",
          "",
          "[Added Lines]",
          "79: if (process.features.isolates) {",
          "80:   addTest(null, [",
          "81:     /break in .*:1/,",
          "82:     /1/, /2/, /3/",
          "83:   ]);",
          "84: } else {",
          "85:   addTest(null, [",
          "86:     /listening on port 5858/,",
          "87:     /connecting... ok/,",
          "88:     /break in .*:1/,",
          "89:     /1/, /2/, /3/",
          "90:   ]);",
          "91: }",
          "",
          "---------------"
        ],
        "test/simple/test-debugger-repl.js||test/simple/test-debugger-repl.js": [
          "File: test/simple/test-debugger-repl.js -> test/simple/test-debugger-repl.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "81: }",
          "92: addTest('n', [",
          "",
          "[Removed Lines]",
          "84: addTest(null, [",
          "85:   /listening on port 5858/,",
          "86:   /connecting... ok/,",
          "87:   /break in .*:1/,",
          "88:   /1/, /2/, /3/",
          "89: ]);",
          "",
          "[Added Lines]",
          "84: if (process.features.isolates) {",
          "85:   addTest(null, [",
          "86:     /break in .*:1/,",
          "87:     /1/, /2/, /3/",
          "88:   ]);",
          "89: } else {",
          "90:   addTest(null, [",
          "91:     /listening on port 5858/,",
          "92:     /connecting... ok/,",
          "93:     /break in .*:1/,",
          "94:     /1/, /2/, /3/",
          "95:   ]);",
          "96: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "25e8ea17e1f03cd40cc5a6c9c1987bae58313ff5",
      "candidate_info": {
        "commit_hash": "25e8ea17e1f03cd40cc5a6c9c1987bae58313ff5",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/25e8ea17e1f03cd40cc5a6c9c1987bae58313ff5",
        "files": [
          ".gitignore",
          "deps/npm/node_modules/ansi/.npmignore",
          "deps/npm/node_modules/ansi/README.md",
          "deps/npm/node_modules/ansi/lib/ansi.js",
          "deps/npm/node_modules/ansi/lib/newlines.js",
          "deps/npm/node_modules/ansi/package.json",
          "deps/npm/node_modules/chownr/LICENCE",
          "deps/npm/node_modules/fstream-npm/LICENCE",
          "deps/npm/node_modules/mkdirp/.gitignore.orig",
          "deps/npm/node_modules/mkdirp/.gitignore.rej",
          "deps/npm/node_modules/mkdirp/.npmignore",
          "deps/npm/node_modules/mkdirp/.travis.yml",
          "deps/npm/node_modules/node-gyp/node_modules/ansi/examples/imgcat.js",
          "deps/npm/node_modules/node-gyp/node_modules/ansi/examples/yoshi.png",
          "deps/npm/node_modules/node-gyp/node_modules/glob/examples/g.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/examples/usr-local.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/00-setup.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/bash-comparison.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/cwd-test.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/pause-resume.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/root-nomount.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/root.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/zz-cleanup.js",
          "deps/npm/node_modules/npm-registry-client/.npmignore",
          "deps/npm/node_modules/npm-registry-client/README.md",
          "deps/npm/node_modules/npm-registry-client/index.js",
          "deps/npm/node_modules/npm-registry-client/lib/adduser.js",
          "deps/npm/node_modules/npm-registry-client/lib/get.js",
          "deps/npm/node_modules/npm-registry-client/lib/publish.js",
          "deps/npm/node_modules/npm-registry-client/lib/request.js",
          "deps/npm/node_modules/npm-registry-client/lib/star.js",
          "deps/npm/node_modules/npm-registry-client/lib/tag.js",
          "deps/npm/node_modules/npm-registry-client/lib/unpublish.js",
          "deps/npm/node_modules/npm-registry-client/lib/upload.js",
          "deps/npm/node_modules/npm-registry-client/package.json",
          "deps/npm/node_modules/npmlog/LICENSE",
          "deps/npm/node_modules/npmlog/README.md",
          "deps/npm/node_modules/npmlog/log.js",
          "deps/npm/node_modules/npmlog/package.json",
          "deps/npm/node_modules/uid-number/LICENCE"
        ],
        "message": "Do not gitignore npm's node_modules",
        "before_after_code_files": [
          "deps/npm/node_modules/ansi/lib/ansi.js||deps/npm/node_modules/ansi/liansi.js",
          "deps/npm/node_modules/ansi/lib/newlines.js||deps/npm/node_modules/ansi/linewlines.js",
          "deps/npm/node_modules/mkdirp/.gitignore.orig||deps/npm/node_modules/mkdirp/.gitignore.orig",
          "deps/npm/node_modules/node-gyp/node_modules/ansi/examples/imgcat.js||deps/npm/node_modules/node-gyp/node_modules/ansi/examples/imgcat.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/examples/g.js||deps/npm/node_modules/node-gyp/node_modules/gloexamples/g.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/examples/usr-local.js||deps/npm/node_modules/node-gyp/node_modules/gloexamples/usr-local.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/00-setup.js||deps/npm/node_modules/node-gyp/node_modules/glotest/00-setup.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/bash-comparison.js||deps/npm/node_modules/node-gyp/node_modules/glotest/bash-comparison.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/cwd-test.js||deps/npm/node_modules/node-gyp/node_modules/glotest/cwd-test.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/pause-resume.js||deps/npm/node_modules/node-gyp/node_modules/glotest/pause-resume.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/root-nomount.js||deps/npm/node_modules/node-gyp/node_modules/glotest/root-nomount.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/root.js||deps/npm/node_modules/node-gyp/node_modules/glotest/root.js",
          "deps/npm/node_modules/node-gyp/node_modules/glob/test/zz-cleanup.js||deps/npm/node_modules/node-gyp/node_modules/glotest/zz-cleanup.js",
          "deps/npm/node_modules/npm-registry-client/index.js||deps/npm/node_modules/npm-registry-client/index.js",
          "deps/npm/node_modules/npm-registry-client/lib/adduser.js||deps/npm/node_modules/npm-registry-client/liadduser.js",
          "deps/npm/node_modules/npm-registry-client/lib/get.js||deps/npm/node_modules/npm-registry-client/liget.js",
          "deps/npm/node_modules/npm-registry-client/lib/publish.js||deps/npm/node_modules/npm-registry-client/lipublish.js",
          "deps/npm/node_modules/npm-registry-client/lib/request.js||deps/npm/node_modules/npm-registry-client/lirequest.js",
          "deps/npm/node_modules/npm-registry-client/lib/star.js||deps/npm/node_modules/npm-registry-client/listar.js",
          "deps/npm/node_modules/npm-registry-client/lib/tag.js||deps/npm/node_modules/npm-registry-client/litag.js",
          "deps/npm/node_modules/npm-registry-client/lib/unpublish.js||deps/npm/node_modules/npm-registry-client/liunpublish.js",
          "deps/npm/node_modules/npm-registry-client/lib/upload.js||deps/npm/node_modules/npm-registry-client/liupload.js",
          "deps/npm/node_modules/npmlog/log.js||deps/npm/node_modules/npmlog/log.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/npm/node_modules/ansi/lib/ansi.js||deps/npm/node_modules/ansi/liansi.js": [
          "File: deps/npm/node_modules/ansi/lib/ansi.js -> deps/npm/node_modules/ansi/liansi.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/ansi/lib/newlines.js||deps/npm/node_modules/ansi/linewlines.js": [
          "File: deps/npm/node_modules/ansi/lib/newlines.js -> deps/npm/node_modules/ansi/linewlines.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/mkdirp/.gitignore.orig||deps/npm/node_modules/mkdirp/.gitignore.orig": [
          "File: deps/npm/node_modules/mkdirp/.gitignore.orig -> deps/npm/node_modules/mkdirp/.gitignore.orig",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: node_modules/",
          "2: npm-debug.log",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/ansi/examples/imgcat.js||deps/npm/node_modules/node-gyp/node_modules/ansi/examples/imgcat.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/ansi/examples/imgcat.js -> deps/npm/node_modules/node-gyp/node_modules/ansi/examples/imgcat.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: #!/usr/bin/env node",
          "3: var ansi = require('../')",
          "4:   , cursor = ansi(process.stdout)",
          "5:   , tty = require('tty')",
          "6:   , Canvas = require('canvas')",
          "7:   , imageFile = process.argv[2] || __dirname + '/yoshi.png'",
          "8:   , image = require('fs').readFileSync(imageFile)",
          "9:   , pixel = '  '",
          "10:   , alphaThreshold = 0",
          "12: var img = new Canvas.Image();",
          "13: img.src = image;",
          "15: function draw () {",
          "16:   var width = process.stdout.getWindowSize()[0] / pixel.length | 0",
          "17:     , scaleW = img.width > width ? width / img.width : 1",
          "18:     , w = Math.floor(img.width * scaleW)",
          "19:     , h = Math.floor(img.height * scaleW);",
          "21:   var canvas = new Canvas(w, h)",
          "22:     , ctx = canvas.getContext('2d');",
          "24:   ctx.drawImage(img, 0, 0, w, h);",
          "26:   var data = ctx.getImageData(0, 0, w, h).data;",
          "28:   for (var i=0, l=data.length; i<l; i+=4) {",
          "29:     var r = data[i]",
          "30:       , g = data[i+1]",
          "31:       , b = data[i+2]",
          "32:       , alpha = data[i+3];",
          "33:     if (alpha > alphaThreshold) {",
          "34:       cursor.bg.rgb(r, g, b);",
          "35:     } else {",
          "36:       cursor.bg.reset();",
          "37:     }",
          "38:     process.stdout.write(pixel);",
          "39:     if ((i/4|0) % w === (w-1)) {",
          "40:       cursor.bg.reset();",
          "41:       process.stdout.write('\\n');",
          "42:     }",
          "43:   }",
          "44: }",
          "46: draw();",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/examples/g.js||deps/npm/node_modules/node-gyp/node_modules/gloexamples/g.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/examples/g.js -> deps/npm/node_modules/node-gyp/node_modules/gloexamples/g.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/examples/usr-local.js||deps/npm/node_modules/node-gyp/node_modules/gloexamples/usr-local.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/examples/usr-local.js -> deps/npm/node_modules/node-gyp/node_modules/gloexamples/usr-local.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/test/00-setup.js||deps/npm/node_modules/node-gyp/node_modules/glotest/00-setup.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/test/00-setup.js -> deps/npm/node_modules/node-gyp/node_modules/glotest/00-setup.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/test/bash-comparison.js||deps/npm/node_modules/node-gyp/node_modules/glotest/bash-comparison.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/test/bash-comparison.js -> deps/npm/node_modules/node-gyp/node_modules/glotest/bash-comparison.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/test/cwd-test.js||deps/npm/node_modules/node-gyp/node_modules/glotest/cwd-test.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/test/cwd-test.js -> deps/npm/node_modules/node-gyp/node_modules/glotest/cwd-test.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/test/pause-resume.js||deps/npm/node_modules/node-gyp/node_modules/glotest/pause-resume.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/test/pause-resume.js -> deps/npm/node_modules/node-gyp/node_modules/glotest/pause-resume.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/test/root-nomount.js||deps/npm/node_modules/node-gyp/node_modules/glotest/root-nomount.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/test/root-nomount.js -> deps/npm/node_modules/node-gyp/node_modules/glotest/root-nomount.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/test/root.js||deps/npm/node_modules/node-gyp/node_modules/glotest/root.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/test/root.js -> deps/npm/node_modules/node-gyp/node_modules/glotest/root.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/node-gyp/node_modules/glob/test/zz-cleanup.js||deps/npm/node_modules/node-gyp/node_modules/glotest/zz-cleanup.js": [
          "File: deps/npm/node_modules/node-gyp/node_modules/glob/test/zz-cleanup.js -> deps/npm/node_modules/node-gyp/node_modules/glotest/zz-cleanup.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/index.js||deps/npm/node_modules/npm-registry-client/index.js": [
          "File: deps/npm/node_modules/npm-registry-client/index.js -> deps/npm/node_modules/npm-registry-client/index.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4: module.exports = RegClient",
          "6: var fs = require('fs')",
          "7: , url = require('url')",
          "8: , path = require('path')",
          "9: , npmlog",
          "11: try {",
          "12:   npmlog = require(\"npmlog\")",
          "13: } catch (er) {",
          "14:   npmlog = { error: noop, warn: noop, info: noop,",
          "15:              verbose: noop, silly: noop, http: silly,",
          "16:              pause: noop, resume: noop }",
          "17: }",
          "19: function noop () {}",
          "21: function RegClient (options) {",
          "23:   var registry = url.parse(options.registry)",
          "24:   if (!registry.protocol) throw new Error(",
          "25:     'Invalid registry: ' + registry.url)",
          "26:   this.registry = registry.href",
          "28:   this.cache = options.cache",
          "29:   if (!this.cache) throw new Error(\"Cache dir is required\")",
          "31:   this.alwaysAuth = options.alwaysAuth || false",
          "33:   this.auth = options.auth || null",
          "34:   if (this.auth) {",
          "35:     var a = new Buffer(this.auth, \"base64\").toString()",
          "36:     a = a.split(\":\")",
          "37:     this.username = a.shift()",
          "38:     this.password = a.join(\":\")",
          "39:   }",
          "40:   this.email = options.email || null",
          "41:   this.defaultTag = options.tag || \"latest\"",
          "43:   this.ca = options.ca || null",
          "45:   this.strictSSL = options.strictSSL",
          "46:   if (this.strictSSL === undefined) this.strictSSL = true",
          "48:   this.userAgent = options.userAgent",
          "49:   if (this.userAgent === undefined) {",
          "50:     this.userAgent = 'node/' + process.version",
          "51:   }",
          "53:   this.cacheMin = options.cacheMin || 0",
          "54:   this.cacheMax = options.cacheMax || Infinity",
          "56:   this.proxy = options.proxy",
          "57:   this.httpsProxy = options.httpsProxy || options.proxy",
          "59:   this.log = options.log || npmlog",
          "60: }",
          "62: require('fs').readdirSync(__dirname + \"/lib\").forEach(function (f) {",
          "63:   if (!f.match(/\\.js$/)) return",
          "64:   RegClient.prototype[f.replace(/\\.js$/, '')] = require('./lib/' + f)",
          "65: })",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/lib/adduser.js||deps/npm/node_modules/npm-registry-client/liadduser.js": [
          "File: deps/npm/node_modules/npm-registry-client/lib/adduser.js -> deps/npm/node_modules/npm-registry-client/liadduser.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/lib/get.js||deps/npm/node_modules/npm-registry-client/liget.js": [
          "File: deps/npm/node_modules/npm-registry-client/lib/get.js -> deps/npm/node_modules/npm-registry-client/liget.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/lib/publish.js||deps/npm/node_modules/npm-registry-client/lipublish.js": [
          "File: deps/npm/node_modules/npm-registry-client/lib/publish.js -> deps/npm/node_modules/npm-registry-client/lipublish.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/lib/request.js||deps/npm/node_modules/npm-registry-client/lirequest.js": [
          "File: deps/npm/node_modules/npm-registry-client/lib/request.js -> deps/npm/node_modules/npm-registry-client/lirequest.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/lib/star.js||deps/npm/node_modules/npm-registry-client/listar.js": [
          "File: deps/npm/node_modules/npm-registry-client/lib/star.js -> deps/npm/node_modules/npm-registry-client/listar.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/lib/tag.js||deps/npm/node_modules/npm-registry-client/litag.js": [
          "File: deps/npm/node_modules/npm-registry-client/lib/tag.js -> deps/npm/node_modules/npm-registry-client/litag.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/lib/unpublish.js||deps/npm/node_modules/npm-registry-client/liunpublish.js": [
          "File: deps/npm/node_modules/npm-registry-client/lib/unpublish.js -> deps/npm/node_modules/npm-registry-client/liunpublish.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npm-registry-client/lib/upload.js||deps/npm/node_modules/npm-registry-client/liupload.js": [
          "File: deps/npm/node_modules/npm-registry-client/lib/upload.js -> deps/npm/node_modules/npm-registry-client/liupload.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/npm/node_modules/npmlog/log.js||deps/npm/node_modules/npmlog/log.js": [
          "File: deps/npm/node_modules/npmlog/log.js -> deps/npm/node_modules/npmlog/log.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: var EE = require('events').EventEmitter",
          "2: var log = exports = module.exports = new EE",
          "3: var util = require('util')",
          "5: var ansi = require('ansi')",
          "6: log.cursor = ansi(process.stderr)",
          "7: log.stream = process.stderr",
          "10: var colorEnabled = undefined",
          "11: log.enableColor = function () {",
          "12:   colorEnabled = true",
          "13:   this.cursor.enabled = true",
          "14: }",
          "15: log.disableColor = function () {",
          "16:   colorEnabled = false",
          "17:   this.cursor.enabled = false",
          "18: }",
          "21: log.level = 'info'",
          "24: log.pause = function () {",
          "25:   this._paused = true",
          "26: }",
          "28: log.resume = function () {",
          "29:   if (!this._paused) return",
          "30:   this._paused = false",
          "32:   var b = this._buffer",
          "33:   this._buffer = []",
          "34:   b.forEach(function (m) {",
          "35:     this.emitLog(m)",
          "36:   }, this)",
          "37: }",
          "39: log._buffer = []",
          "41: var id = 0",
          "42: log.record = []",
          "43: log.maxRecordSize = 10000",
          "44: log.log = function (lvl, prefix, message) {",
          "45:   var l = this.levels[lvl]",
          "46:   if (l === undefined) {",
          "47:     return this.emit('error', new Error(util.format(",
          "48:       'Undefined log level: %j', lvl)))",
          "49:   }",
          "51:   var a = new Array(arguments.length - 2)",
          "52:   var stack = null",
          "53:   for (var i = 2; i < arguments.length; i ++) {",
          "54:     var arg = a[i-2] = arguments[i]",
          "57:     if (typeof arg === 'object' && arg &&",
          "58:         (arg instanceof Error) && arg.stack) {",
          "59:       arg.stack = stack = arg.stack + ''",
          "60:     }",
          "61:   }",
          "62:   if (stack) a.unshift(stack + '\\n')",
          "63:   message = util.format.apply(util, a)",
          "65:   var m = { id: id++,",
          "66:             level: lvl,",
          "67:             prefix: String(prefix || ''),",
          "68:             message: message,",
          "69:             messageRaw: a }",
          "71:   this.emit('log', m)",
          "72:   this.emit('log.' + lvl, m)",
          "73:   if (m.prefix) this.emit(m.prefix, m)",
          "75:   this.record.push(m)",
          "76:   var mrs = this.maxRecordSize",
          "77:   var n = this.record.length - mrs",
          "78:   if (n > mrs / 10) {",
          "79:     var newSize = Math.floor(mrs * 0.9)",
          "80:     this.record = this.record.slice(-1 * newSize)",
          "81:   }",
          "83:   this.emitLog(m)",
          "84: }",
          "86: log.emitLog = function (m) {",
          "87:   if (this._paused) {",
          "88:     this._buffer.push(m)",
          "89:     return",
          "90:   }",
          "91:   var l = this.levels[m.level]",
          "92:   if (l === undefined) return",
          "93:   if (l < this.levels[this.level]) return",
          "94:   if (l > 0 && !isFinite(l)) return",
          "96:   var style = log.style[m.level]",
          "97:   var disp = log.disp[m.level] || m.level",
          "98:   m.message.split(/\\r?\\n/).forEach(function (line) {",
          "99:     if (this.heading) {",
          "100:       this.write(this.heading, this.headingStyle)",
          "101:       this.write(' ')",
          "102:     }",
          "103:     this.write(disp, log.style[m.level])",
          "104:     var p = m.prefix || ''",
          "105:     if (p) this.write(' ')",
          "106:     this.write(p, this.prefixStyle)",
          "107:     this.write(' ' + line + '\\n')",
          "108:   }, this)",
          "109: }",
          "111: log.write = function (msg, style) {",
          "112:   if (!this.cursor) return",
          "113:   if (this.stream !== this.cursor.stream) {",
          "114:     this.cursor = ansi(this.stream, { enabled: colorEnabled })",
          "115:   }",
          "117:   style = style || {}",
          "118:   if (style.fg) this.cursor.fg[style.fg]()",
          "119:   if (style.bg) this.cursor.bg[style.bg]()",
          "120:   if (style.bold) this.cursor.bold()",
          "121:   if (style.underline) this.cursor.underline()",
          "122:   if (style.inverse) this.cursor.inverse()",
          "123:   if (style.beep) this.cursor.beep()",
          "124:   this.cursor.write(msg).reset()",
          "125: }",
          "127: log.addLevel = function (lvl, n, style, disp) {",
          "128:   if (!disp) disp = lvl",
          "129:   this.levels[lvl] = n",
          "130:   this.style[lvl] = style",
          "131:   if (!this[lvl]) this[lvl] = function () {",
          "132:     var a = new Array(arguments.length + 1)",
          "133:     a[0] = lvl",
          "134:     for (var i = 0; i < arguments.length; i ++) {",
          "135:       a[i + 1] = arguments[i]",
          "136:     }",
          "137:     return this.log.apply(this, a)",
          "138:   }",
          "139:   this.disp[lvl] = disp",
          "140: }",
          "142: log.prefixStyle = { fg: 'magenta' }",
          "143: log.headingStyle = { fg: 'white', bg: 'black' }",
          "145: log.style = {}",
          "146: log.levels = {}",
          "147: log.disp = {}",
          "148: log.addLevel('silly', -Infinity, { inverse: true }, 'sill')",
          "149: log.addLevel('verbose', 1000, { fg: 'blue', bg: 'black' }, 'verb')",
          "150: log.addLevel('info', 2000, { fg: 'green' })",
          "151: log.addLevel('http', 3000, { fg: 'green', bg: 'black' })",
          "152: log.addLevel('warn', 4000, { fg: 'black', bg: 'red' }, 'WARN')",
          "153: log.addLevel('error', 5000, { fg: 'red', bg: 'black' }, 'ERR!')",
          "154: log.addLevel('silent', Infinity)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e6a30bd1077ee6dc4139f423db052c3de50ad1ef",
      "candidate_info": {
        "commit_hash": "e6a30bd1077ee6dc4139f423db052c3de50ad1ef",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/e6a30bd1077ee6dc4139f423db052c3de50ad1ef",
        "files": [
          "src/node_buffer.h",
          "src/stream_wrap.cc"
        ],
        "message": "Fix #2473\n\nTested in production.\n\nSee also http://code.google.com/p/v8/issues/detail?id=1889",
        "before_after_code_files": [
          "src/node_buffer.h||src/node_buffer.h",
          "src/stream_wrap.cc||src/stream_wrap.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_buffer.h||src/node_buffer.h": [
          "File: src/node_buffer.h -> src/node_buffer.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "66: class NODE_EXTERN Buffer: public ObjectWrap {",
          "67:  public:",
          "69:   static bool HasInstance(v8::Handle<v8::Value> val);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "68:   static v8::Persistent<v8::FunctionTemplate> constructor_template;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "99:                      free_callback callback, void *hint); // public constructor",
          "101:   private:",
          "104:   static v8::Handle<v8::Value> New(const v8::Arguments &args);",
          "105:   static v8::Handle<v8::Value> BinarySlice(const v8::Arguments &args);",
          "106:   static v8::Handle<v8::Value> AsciiSlice(const v8::Arguments &args);",
          "",
          "[Removed Lines]",
          "102:   static v8::Persistent<v8::FunctionTemplate> constructor_template;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/stream_wrap.cc||src/stream_wrap.cc": [
          "File: src/stream_wrap.cc -> src/stream_wrap.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "149: }",
          "156:   assert(Buffer::Length(b) == SLAB_SIZE);",
          "157:   slab_used = 0;",
          "159:   return Buffer::Data(b);",
          "160: }",
          "",
          "[Removed Lines]",
          "152: inline char* StreamWrap::NewSlab(Handle<Object> global,",
          "153:                                         Handle<Object> wrap_obj) {",
          "154:   Buffer* b = Buffer::New(SLAB_SIZE);",
          "155:   global->SetHiddenValue(slab_sym, b->handle_);",
          "158:   wrap_obj->SetHiddenValue(slab_sym, b->handle_);",
          "",
          "[Added Lines]",
          "152: char* StreamWrap::NewSlab(Handle<Object> global,",
          "153:                           Handle<Object> wrap_obj) {",
          "154:   HandleScope scope;",
          "155:   Local<Value> arg = Integer::NewFromUnsigned(SLAB_SIZE);",
          "156:   Local<Object> b = Buffer::constructor_template->GetFunction()->",
          "157:     NewInstance(1, &arg);",
          "158:   if (b.IsEmpty()) return NULL;",
          "159:   global->SetHiddenValue(slab_sym, b);",
          "162:   wrap_obj->SetHiddenValue(slab_sym, b);",
          "",
          "---------------"
        ]
      }
    }
  ]
}