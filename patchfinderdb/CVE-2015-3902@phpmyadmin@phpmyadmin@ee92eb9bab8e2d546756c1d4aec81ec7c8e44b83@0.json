{
  "cve_id": "CVE-2015-3902",
  "cve_desc": "Multiple cross-site request forgery (CSRF) vulnerabilities in the setup process in phpMyAdmin 4.0.x before 4.0.10.10, 4.2.x before 4.2.13.3, 4.3.x before 4.3.13.1, and 4.4.x before 4.4.6.1 allow remote attackers to hijack the authentication of administrators for requests that modify the configuration file.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83",
  "patch_info": {
    "commit_hash": "ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83",
    "files": [
      "ChangeLog",
      "libraries/url_generating.lib.php",
      "setup/frames/form.inc.php",
      "setup/frames/index.inc.php",
      "setup/frames/menu.inc.php",
      "setup/frames/servers.inc.php",
      "setup/index.php",
      "setup/lib/form_processing.lib.php",
      "setup/validate.php"
    ],
    "message": "bug #4899 [security] CSRF vulnerability in setup\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
    "before_after_code_files": [
      "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
      "setup/frames/form.inc.php||setup/frames/form.inc.php",
      "setup/frames/index.inc.php||setup/frames/index.inc.php",
      "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
      "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
      "setup/index.php||setup/index.php",
      "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
      "setup/validate.php||setup/validate.php"
    ]
  },
  "patch_diff": {
    "libraries/url_generating.lib.php||libraries/url_generating.lib.php": [
      "File: libraries/url_generating.lib.php -> libraries/url_generating.lib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "179:     if (isset($GLOBALS['server'])",
      "180:         && $GLOBALS['server'] != $GLOBALS['cfg']['ServerDefault']",
      "181:         && ! isset($params['server'])",
      "182:     ) {",
      "183:         $params['server'] = $GLOBALS['server'];",
      "184:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "182:         && ! defined('PMA_SETUP')",
      "",
      "---------------"
    ],
    "setup/frames/form.inc.php||setup/frames/form.inc.php": [
      "File: setup/frames/form.inc.php -> setup/frames/form.inc.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "20: require './libraries/config/setup.forms.php';",
      "24: if (! isset($forms[$formset_id])) {",
      "25:     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php!'));",
      "26: }",
      "",
      "[Removed Lines]",
      "22: $formset_id = filter_input(INPUT_GET, 'formset');",
      "23: $mode = filter_input(INPUT_GET, 'mode');",
      "",
      "[Added Lines]",
      "22: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
      "23: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
      "",
      "---------------"
    ],
    "setup/frames/index.inc.php||setup/frames/index.inc.php": [
      "File: setup/frames/index.inc.php -> setup/frames/index.inc.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "174:         echo '<td>' . htmlspecialchars($cf->getServerDSN($id)) . '</td>';",
      "175:         echo '<td style=\"white-space: nowrap\">';",
      "176:         echo '<small>';",
      "179:             . __('Edit') . '</a>';",
      "180:         echo ' | ';",
      "183:             . __('Delete') . '</a>';",
      "184:         echo '</small>';",
      "185:         echo '</td>';",
      "",
      "[Removed Lines]",
      "177:         echo '<a href=\"?page=servers' . $separator",
      "178:             . 'mode=edit' . $separator . 'id=' . $id . '\">'",
      "181:         echo '<a href=\"?page=servers' . $separator",
      "182:             . 'mode=remove' . $separator . 'id=' . $id . '\">'",
      "",
      "[Added Lines]",
      "177:         echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'",
      "178:             . $separator . 'mode=edit' . $separator . 'id=' . $id . '\">'",
      "181:         echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'",
      "182:             . $separator . 'mode=remove' . $separator . 'id=' . $id . '\">'",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "308: echo '<a href=\"http://www.phpmyadmin.net/\">' . __('phpMyAdmin homepage') . '</a>';",
      "309: echo '<a href=\"http://sourceforge.net/donate/index.php?group_id=23067\">'",
      "310:     .  __('Donate') . '</a>';",
      "313:     . __('Check for latest version') . '</a>';",
      "314: echo '</div>';",
      "",
      "[Removed Lines]",
      "311: echo '<a href=\"?version_check=1' . $separator",
      "312:     . 'token=' . $_SESSION[' PMA_token '] . '\">'",
      "",
      "[Added Lines]",
      "311: echo '<a href=\"' .  PMA_URL_getCommon() . $separator . 'version_check=1\">'",
      "",
      "---------------"
    ],
    "setup/frames/menu.inc.php||setup/frames/menu.inc.php": [
      "File: setup/frames/menu.inc.php -> setup/frames/menu.inc.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "10:     exit;",
      "11: }",
      "15: $separator = PMA_URL_getArgSeparator('html');",
      "16: echo '<ul>';",
      "18:     . ($formset_id === null ? ' class=\"active' : '')",
      "19:     . '\">' . __('Overview') . '</a></li>';",
      "",
      "[Removed Lines]",
      "13: $formset_id = filter_input(INPUT_GET, 'formset');",
      "17: echo '<li><a href=\"index.php\"'",
      "",
      "[Added Lines]",
      "13: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
      "17: echo '<li><a href=\"index.php' . PMA_URL_getCommon() . '\"'",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "28: );",
      "30: foreach ($formsets as $formset => $label) {",
      "32:         . ($formset_id === $formset ? ' class=\"active' : '')",
      "33:         . '\">' . $label . '</a></li>';",
      "34: }",
      "",
      "[Removed Lines]",
      "31:     echo '<li><a href=\"?page=form' . $separator . 'formset=' . $formset . '\" '",
      "",
      "[Added Lines]",
      "31:     echo '<li><a href=\"' . PMA_URL_getCommon() . $separator . 'page=form'",
      "32:         . $separator . 'formset=' . $formset . '\" '",
      "",
      "---------------"
    ],
    "setup/frames/servers.inc.php||setup/frames/servers.inc.php": [
      "File: setup/frames/servers.inc.php -> setup/frames/servers.inc.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "20: require './libraries/config/setup.forms.php';",
      "25: $cf = $GLOBALS['ConfigFile'];",
      "26: $server_exists = !empty($id) && $cf->get(\"Servers/$id\") !== null;",
      "",
      "[Removed Lines]",
      "22: $mode = filter_input(INPUT_GET, 'mode');",
      "23: $id = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
      "",
      "[Added Lines]",
      "22: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
      "23: $id = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
      "",
      "---------------"
    ],
    "setup/index.php||setup/index.php": [
      "File: setup/index.php -> setup/index.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "13: require './lib/common.inc.php';",
      "16: $page = preg_replace('/[^a-z]/', '', $page);",
      "17: if ($page === '') {",
      "18:     $page = 'index';",
      "",
      "[Removed Lines]",
      "15: $page = filter_input(INPUT_GET, 'page');",
      "",
      "[Added Lines]",
      "15: $page = isset($_GET['page']) ? $_GET['page'] : null;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "23: }",
      "27: $action_done = preg_replace('/[^a-z_]/', '', $action_done);",
      "29: PMA_noCacheHeader();",
      "",
      "[Removed Lines]",
      "26: $action_done = filter_input(INPUT_GET, 'action_done');",
      "",
      "[Added Lines]",
      "26: $action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;",
      "",
      "---------------"
    ],
    "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php": [
      "File: setup/lib/form_processing.lib.php -> setup/lib/form_processing.lib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "16: function PMA_Process_formset(FormDisplay $form_display)",
      "17: {",
      "20:         $form_display->fixErrors();",
      "21:         PMA_generateHeader303();",
      "",
      "[Removed Lines]",
      "18:     if (filter_input(INPUT_GET, 'mode') == 'revert') {",
      "",
      "[Added Lines]",
      "18:     if (isset($_GET['mode']) && $_GET['mode'] == 'revert') {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "37:     $separator = PMA_URL_getArgSeparator('html');",
      "40:     $formset = $formset ? \"{$separator}formset=$formset\" : '';",
      "42:     if ($formId === null && $page == 'servers') {",
      "44:         $formId = $form_display->getConfigFile()->getServerCount();",
      "",
      "[Removed Lines]",
      "38:     $page = filter_input(INPUT_GET, 'page');",
      "39:     $formset = filter_input(INPUT_GET, 'formset');",
      "41:     $formId = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
      "",
      "[Added Lines]",
      "38:     $page = isset($_GET['page']) ? $_GET['page'] : null;",
      "39:     $formset = isset($_GET['formset']) ? $_GET['formset'] : null;",
      "41:     $formId = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "48:     <div class=\"error\">",
      "49:         <h4><?php echo __('Warning') ?></h4>",
      "50:         <?php echo __('Submitted form contains errors') ?><br />",
      "52:             <?php echo __('Try to revert erroneous fields to their default values')",
      "53:             ?>",
      "54:         </a>",
      "55:     </div>",
      "56:     <?php $form_display->displayErrors() ?>",
      "58:     &nbsp;",
      "60:         . $separator ?>mode=edit\"><?php echo __('Show form') ?></a>",
      "61:     <?php",
      "62: }",
      "",
      "[Removed Lines]",
      "51:         <a href=\"?page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
      "57:     <a class=\"btn\" href=\"index.php\"><?php echo __('Ignore errors') ?></a>",
      "59:     <a class=\"btn\" href=\"?page=<?php echo $page . $formset . $formId",
      "",
      "[Added Lines]",
      "51:         <a href=\"<?php echo PMA_URL_getCommon() . $separator ?>",
      "52:             page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
      "58:     <a class=\"btn\" href=\"index.php<?php echo PMA_URL_getCommon() ?>\">",
      "59:         <?php echo __('Ignore errors') ?></a>",
      "61:     <a class=\"btn\" href=\"<?php echo PMA_URL_getCommon() . $separator ?>",
      "62:         page=<?php echo $page . $formset . $formId",
      "",
      "---------------"
    ],
    "setup/validate.php||setup/validate.php": [
      "File: setup/validate.php -> setup/validate.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "17: header('Content-type: application/json');",
      "21: if (!($values instanceof stdClass)) {",
      "22:     PMA_fatalError(__('Wrong data'));",
      "23: }",
      "",
      "[Removed Lines]",
      "19: $vids = explode(',', filter_input(INPUT_POST, 'id'));",
      "20: $values = json_decode(filter_input(INPUT_POST, 'values'));",
      "",
      "[Added Lines]",
      "19: $ids = isset($_POST['id']) ? $_POST['id'] : null;",
      "20: $vids = explode(',', $ids);",
      "21: $vals = isset($_POST['values']) ? $_POST['values'] : null;",
      "22: $values = json_decode($vals);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e874e59b6933bd814b201641a4bb7dea493e5ad5",
      "candidate_info": {
        "commit_hash": "e874e59b6933bd814b201641a4bb7dea493e5ad5",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/e874e59b6933bd814b201641a4bb7dea493e5ad5",
        "files": [
          "ChangeLog",
          "libraries/url_generating.lib.php",
          "setup/frames/form.inc.php",
          "setup/frames/index.inc.php",
          "setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php",
          "setup/index.php",
          "setup/lib/form_processing.lib.php",
          "setup/validate.php"
        ],
        "message": "bug #4899 [security] CSRF vulnerability in setup\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
          "setup/frames/form.inc.php||setup/frames/form.inc.php",
          "setup/frames/index.inc.php||setup/frames/index.inc.php",
          "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
          "setup/index.php||setup/index.php",
          "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
          "setup/validate.php||setup/validate.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ],
          "candidate": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/url_generating.lib.php||libraries/url_generating.lib.php": [
          "File: libraries/url_generating.lib.php -> libraries/url_generating.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "179:     if (isset($GLOBALS['server'])",
          "180:         && $GLOBALS['server'] != $GLOBALS['cfg']['ServerDefault']",
          "181:         && ! isset($params['server'])",
          "182:     ) {",
          "183:         $params['server'] = $GLOBALS['server'];",
          "184:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "182:         && ! defined('PMA_SETUP')",
          "",
          "---------------"
        ],
        "setup/frames/form.inc.php||setup/frames/form.inc.php": [
          "File: setup/frames/form.inc.php -> setup/frames/form.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "24: if (! isset($forms[$formset_id])) {",
          "25:     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php!'));",
          "26: }",
          "",
          "[Removed Lines]",
          "22: $formset_id = filter_input(INPUT_GET, 'formset');",
          "23: $mode = filter_input(INPUT_GET, 'mode');",
          "",
          "[Added Lines]",
          "22: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "23: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "",
          "---------------"
        ],
        "setup/frames/index.inc.php||setup/frames/index.inc.php": [
          "File: setup/frames/index.inc.php -> setup/frames/index.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "174:         echo '<td>' . htmlspecialchars($cf->getServerDSN($id)) . '</td>';",
          "175:         echo '<td style=\"white-space: nowrap\">';",
          "176:         echo '<small>';",
          "179:             . __('Edit') . '</a>';",
          "180:         echo ' | ';",
          "183:             . __('Delete') . '</a>';",
          "184:         echo '</small>';",
          "185:         echo '</td>';",
          "",
          "[Removed Lines]",
          "177:         echo '<a href=\"?page=servers' . $separator",
          "178:             . 'mode=edit' . $separator . 'id=' . $id . '\">'",
          "181:         echo '<a href=\"?page=servers' . $separator",
          "182:             . 'mode=remove' . $separator . 'id=' . $id . '\">'",
          "",
          "[Added Lines]",
          "177:         echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'",
          "178:             . $separator . 'mode=edit' . $separator . 'id=' . $id . '\">'",
          "181:         echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'",
          "182:             . $separator . 'mode=remove' . $separator . 'id=' . $id . '\">'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "308: echo '<a href=\"http://www.phpmyadmin.net/\">' . __('phpMyAdmin homepage') . '</a>';",
          "309: echo '<a href=\"http://sourceforge.net/donate/index.php?group_id=23067\">'",
          "310:     .  __('Donate') . '</a>';",
          "313:     . __('Check for latest version') . '</a>';",
          "314: echo '</div>';",
          "",
          "[Removed Lines]",
          "311: echo '<a href=\"?version_check=1' . $separator",
          "312:     . 'token=' . $_SESSION[' PMA_token '] . '\">'",
          "",
          "[Added Lines]",
          "311: echo '<a href=\"' .  PMA_URL_getCommon() . $separator . 'version_check=1\">'",
          "",
          "---------------"
        ],
        "setup/frames/menu.inc.php||setup/frames/menu.inc.php": [
          "File: setup/frames/menu.inc.php -> setup/frames/menu.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:     exit;",
          "11: }",
          "15: $separator = PMA_URL_getArgSeparator('html');",
          "16: echo '<ul>';",
          "18:     . ($formset_id === null ? ' class=\"active' : '')",
          "19:     . '\">' . __('Overview') . '</a></li>';",
          "",
          "[Removed Lines]",
          "13: $formset_id = filter_input(INPUT_GET, 'formset');",
          "17: echo '<li><a href=\"index.php\"'",
          "",
          "[Added Lines]",
          "13: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "17: echo '<li><a href=\"index.php' . PMA_URL_getCommon() . '\"'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "28: );",
          "30: foreach ($formsets as $formset => $label) {",
          "32:         . ($formset_id === $formset ? ' class=\"active' : '')",
          "33:         . '\">' . $label . '</a></li>';",
          "34: }",
          "",
          "[Removed Lines]",
          "31:     echo '<li><a href=\"?page=form' . $separator . 'formset=' . $formset . '\" '",
          "",
          "[Added Lines]",
          "31:     echo '<li><a href=\"' . PMA_URL_getCommon() . $separator . 'page=form'",
          "32:         . $separator . 'formset=' . $formset . '\" '",
          "",
          "---------------"
        ],
        "setup/frames/servers.inc.php||setup/frames/servers.inc.php": [
          "File: setup/frames/servers.inc.php -> setup/frames/servers.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "25: $cf = $GLOBALS['ConfigFile'];",
          "26: $server_exists = !empty($id) && $cf->get(\"Servers/$id\") !== null;",
          "",
          "[Removed Lines]",
          "22: $mode = filter_input(INPUT_GET, 'mode');",
          "23: $id = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "22: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "23: $id = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------"
        ],
        "setup/index.php||setup/index.php": [
          "File: setup/index.php -> setup/index.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: require './lib/common.inc.php';",
          "16: $page = preg_replace('/[^a-z]/', '', $page);",
          "17: if ($page === '') {",
          "18:     $page = 'index';",
          "",
          "[Removed Lines]",
          "15: $page = filter_input(INPUT_GET, 'page');",
          "",
          "[Added Lines]",
          "15: $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "23: }",
          "27: $action_done = preg_replace('/[^a-z_]/', '', $action_done);",
          "29: PMA_noCacheHeader();",
          "",
          "[Removed Lines]",
          "26: $action_done = filter_input(INPUT_GET, 'action_done');",
          "",
          "[Added Lines]",
          "26: $action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;",
          "",
          "---------------"
        ],
        "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php": [
          "File: setup/lib/form_processing.lib.php -> setup/lib/form_processing.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "16: function PMA_Process_formset(FormDisplay $form_display)",
          "17: {",
          "20:         $form_display->fixErrors();",
          "21:         PMA_generateHeader303();",
          "",
          "[Removed Lines]",
          "18:     if (filter_input(INPUT_GET, 'mode') == 'revert') {",
          "",
          "[Added Lines]",
          "18:     if (isset($_GET['mode']) && $_GET['mode'] == 'revert') {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "37:     $separator = PMA_URL_getArgSeparator('html');",
          "40:     $formset = $formset ? \"{$separator}formset=$formset\" : '';",
          "42:     if ($formId === null && $page == 'servers') {",
          "44:         $formId = $form_display->getConfigFile()->getServerCount();",
          "",
          "[Removed Lines]",
          "38:     $page = filter_input(INPUT_GET, 'page');",
          "39:     $formset = filter_input(INPUT_GET, 'formset');",
          "41:     $formId = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "38:     $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "39:     $formset = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "41:     $formId = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "48:     <div class=\"error\">",
          "49:         <h4><?php echo __('Warning') ?></h4>",
          "50:         <?php echo __('Submitted form contains errors') ?><br />",
          "52:             <?php echo __('Try to revert erroneous fields to their default values')",
          "53:             ?>",
          "54:         </a>",
          "55:     </div>",
          "56:     <?php $form_display->displayErrors() ?>",
          "58:     &nbsp;",
          "60:         . $separator ?>mode=edit\"><?php echo __('Show form') ?></a>",
          "61:     <?php",
          "62: }",
          "",
          "[Removed Lines]",
          "51:         <a href=\"?page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
          "57:     <a class=\"btn\" href=\"index.php\"><?php echo __('Ignore errors') ?></a>",
          "59:     <a class=\"btn\" href=\"?page=<?php echo $page . $formset . $formId",
          "",
          "[Added Lines]",
          "51:         <a href=\"<?php echo PMA_URL_getCommon() . $separator ?>",
          "52:             page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
          "58:     <a class=\"btn\" href=\"index.php<?php echo PMA_URL_getCommon() ?>\">",
          "59:         <?php echo __('Ignore errors') ?></a>",
          "61:     <a class=\"btn\" href=\"<?php echo PMA_URL_getCommon() . $separator ?>",
          "62:         page=<?php echo $page . $formset . $formId",
          "",
          "---------------"
        ],
        "setup/validate.php||setup/validate.php": [
          "File: setup/validate.php -> setup/validate.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: header('Content-type: application/json');",
          "21: if (!($values instanceof stdClass)) {",
          "22:     PMA_fatalError(__('Wrong data'));",
          "23: }",
          "",
          "[Removed Lines]",
          "19: $vids = explode(',', filter_input(INPUT_POST, 'id'));",
          "20: $values = json_decode(filter_input(INPUT_POST, 'values'));",
          "",
          "[Added Lines]",
          "19: $ids = isset($_POST['id']) ? $_POST['id'] : null;",
          "20: $vids = explode(',', $ids);",
          "21: $vals = isset($_POST['values']) ? $_POST['values'] : null;",
          "22: $values = json_decode($vals);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d6afe6ccf6e20bf3b8631a64df016f5098804033",
      "candidate_info": {
        "commit_hash": "d6afe6ccf6e20bf3b8631a64df016f5098804033",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/d6afe6ccf6e20bf3b8631a64df016f5098804033",
        "files": [
          "ChangeLog",
          "libraries/url_generating.lib.php",
          "setup/frames/form.inc.php",
          "setup/frames/index.inc.php",
          "setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php",
          "setup/index.php",
          "setup/lib/form_processing.lib.php",
          "setup/validate.php"
        ],
        "message": "bug #4899 [security] CSRF vulnerability in setup\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
          "setup/frames/form.inc.php||setup/frames/form.inc.php",
          "setup/frames/index.inc.php||setup/frames/index.inc.php",
          "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
          "setup/index.php||setup/index.php",
          "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
          "setup/validate.php||setup/validate.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ],
          "candidate": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/url_generating.lib.php||libraries/url_generating.lib.php": [
          "File: libraries/url_generating.lib.php -> libraries/url_generating.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "179:     if (isset($GLOBALS['server'])",
          "180:         && $GLOBALS['server'] != $GLOBALS['cfg']['ServerDefault']",
          "181:         && ! isset($params['server'])",
          "182:     ) {",
          "183:         $params['server'] = $GLOBALS['server'];",
          "184:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "182:         && ! defined('PMA_SETUP')",
          "",
          "---------------"
        ],
        "setup/frames/form.inc.php||setup/frames/form.inc.php": [
          "File: setup/frames/form.inc.php -> setup/frames/form.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "24: if (! isset($forms[$formset_id])) {",
          "25:     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php!'));",
          "26: }",
          "",
          "[Removed Lines]",
          "22: $formset_id = filter_input(INPUT_GET, 'formset');",
          "23: $mode = filter_input(INPUT_GET, 'mode');",
          "",
          "[Added Lines]",
          "22: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "23: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "",
          "---------------"
        ],
        "setup/frames/index.inc.php||setup/frames/index.inc.php": [
          "File: setup/frames/index.inc.php -> setup/frames/index.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "174:         echo '<td>' . htmlspecialchars($cf->getServerDSN($id)) . '</td>';",
          "175:         echo '<td style=\"white-space: nowrap\">';",
          "176:         echo '<small>';",
          "179:             . __('Edit') . '</a>';",
          "180:         echo ' | ';",
          "183:             . __('Delete') . '</a>';",
          "184:         echo '</small>';",
          "185:         echo '</td>';",
          "",
          "[Removed Lines]",
          "177:         echo '<a href=\"?page=servers' . $separator",
          "178:             . 'mode=edit' . $separator . 'id=' . $id . '\">'",
          "181:         echo '<a href=\"?page=servers' . $separator",
          "182:             . 'mode=remove' . $separator . 'id=' . $id . '\">'",
          "",
          "[Added Lines]",
          "177:         echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'",
          "178:             . $separator . 'mode=edit' . $separator . 'id=' . $id . '\">'",
          "181:         echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'",
          "182:             . $separator . 'mode=remove' . $separator . 'id=' . $id . '\">'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "308: echo '<a href=\"http://www.phpmyadmin.net/\">' . __('phpMyAdmin homepage') . '</a>';",
          "309: echo '<a href=\"http://sourceforge.net/donate/index.php?group_id=23067\">'",
          "310:     .  __('Donate') . '</a>';",
          "313:     . __('Check for latest version') . '</a>';",
          "314: echo '</div>';",
          "",
          "[Removed Lines]",
          "311: echo '<a href=\"?version_check=1' . $separator",
          "312:     . 'token=' . $_SESSION[' PMA_token '] . '\">'",
          "",
          "[Added Lines]",
          "311: echo '<a href=\"' .  PMA_URL_getCommon() . $separator . 'version_check=1\">'",
          "",
          "---------------"
        ],
        "setup/frames/menu.inc.php||setup/frames/menu.inc.php": [
          "File: setup/frames/menu.inc.php -> setup/frames/menu.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:     exit;",
          "11: }",
          "15: $separator = PMA_URL_getArgSeparator('html');",
          "16: echo '<ul>';",
          "18:     . ($formset_id === null ? ' class=\"active' : '')",
          "19:     . '\">' . __('Overview') . '</a></li>';",
          "",
          "[Removed Lines]",
          "13: $formset_id = filter_input(INPUT_GET, 'formset');",
          "17: echo '<li><a href=\"index.php\"'",
          "",
          "[Added Lines]",
          "13: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "17: echo '<li><a href=\"index.php' . PMA_URL_getCommon() . '\"'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "28: );",
          "30: foreach ($formsets as $formset => $label) {",
          "32:         . ($formset_id === $formset ? ' class=\"active' : '')",
          "33:         . '\">' . $label . '</a></li>';",
          "34: }",
          "",
          "[Removed Lines]",
          "31:     echo '<li><a href=\"?page=form' . $separator . 'formset=' . $formset . '\" '",
          "",
          "[Added Lines]",
          "31:     echo '<li><a href=\"' . PMA_URL_getCommon() . $separator . 'page=form'",
          "32:         . $separator . 'formset=' . $formset . '\" '",
          "",
          "---------------"
        ],
        "setup/frames/servers.inc.php||setup/frames/servers.inc.php": [
          "File: setup/frames/servers.inc.php -> setup/frames/servers.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "25: $cf = $GLOBALS['ConfigFile'];",
          "26: $server_exists = !empty($id) && $cf->get(\"Servers/$id\") !== null;",
          "",
          "[Removed Lines]",
          "22: $mode = filter_input(INPUT_GET, 'mode');",
          "23: $id = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "22: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "23: $id = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------"
        ],
        "setup/index.php||setup/index.php": [
          "File: setup/index.php -> setup/index.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: require './lib/common.inc.php';",
          "16: $page = preg_replace('/[^a-z]/', '', $page);",
          "17: if ($page === '') {",
          "18:     $page = 'index';",
          "",
          "[Removed Lines]",
          "15: $page = filter_input(INPUT_GET, 'page');",
          "",
          "[Added Lines]",
          "15: $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "23: }",
          "27: $action_done = preg_replace('/[^a-z_]/', '', $action_done);",
          "29: PMA_noCacheHeader();",
          "",
          "[Removed Lines]",
          "26: $action_done = filter_input(INPUT_GET, 'action_done');",
          "",
          "[Added Lines]",
          "26: $action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;",
          "",
          "---------------"
        ],
        "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php": [
          "File: setup/lib/form_processing.lib.php -> setup/lib/form_processing.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "16: function PMA_Process_formset(FormDisplay $form_display)",
          "17: {",
          "20:         $form_display->fixErrors();",
          "21:         PMA_generateHeader303();",
          "",
          "[Removed Lines]",
          "18:     if (filter_input(INPUT_GET, 'mode') == 'revert') {",
          "",
          "[Added Lines]",
          "18:     if (isset($_GET['mode']) && $_GET['mode'] == 'revert') {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "37:     $separator = PMA_URL_getArgSeparator('html');",
          "40:     $formset = $formset ? \"{$separator}formset=$formset\" : '';",
          "42:     if ($formId === null && $page == 'servers') {",
          "44:         $formId = $form_display->getConfigFile()->getServerCount();",
          "",
          "[Removed Lines]",
          "38:     $page = filter_input(INPUT_GET, 'page');",
          "39:     $formset = filter_input(INPUT_GET, 'formset');",
          "41:     $formId = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "38:     $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "39:     $formset = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "41:     $formId = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "48:     <div class=\"error\">",
          "49:         <h4><?php echo __('Warning') ?></h4>",
          "50:         <?php echo __('Submitted form contains errors') ?><br />",
          "52:             <?php echo __('Try to revert erroneous fields to their default values')",
          "53:             ?>",
          "54:         </a>",
          "55:     </div>",
          "56:     <?php $form_display->displayErrors() ?>",
          "58:     &nbsp;",
          "60:         . $separator ?>mode=edit\"><?php echo __('Show form') ?></a>",
          "61:     <?php",
          "62: }",
          "",
          "[Removed Lines]",
          "51:         <a href=\"?page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
          "57:     <a class=\"btn\" href=\"index.php\"><?php echo __('Ignore errors') ?></a>",
          "59:     <a class=\"btn\" href=\"?page=<?php echo $page . $formset . $formId",
          "",
          "[Added Lines]",
          "51:         <a href=\"<?php echo PMA_URL_getCommon() . $separator ?>",
          "52:             page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
          "58:     <a class=\"btn\" href=\"index.php<?php echo PMA_URL_getCommon() ?>\">",
          "59:         <?php echo __('Ignore errors') ?></a>",
          "61:     <a class=\"btn\" href=\"<?php echo PMA_URL_getCommon() . $separator ?>",
          "62:         page=<?php echo $page . $formset . $formId",
          "",
          "---------------"
        ],
        "setup/validate.php||setup/validate.php": [
          "File: setup/validate.php -> setup/validate.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: header('Content-type: application/json');",
          "21: if (!($values instanceof stdClass)) {",
          "22:     PMA_fatalError(__('Wrong data'));",
          "23: }",
          "",
          "[Removed Lines]",
          "19: $vids = explode(',', filter_input(INPUT_POST, 'id'));",
          "20: $values = json_decode(filter_input(INPUT_POST, 'values'));",
          "",
          "[Added Lines]",
          "19: $ids = isset($_POST['id']) ? $_POST['id'] : null;",
          "20: $vids = explode(',', $ids);",
          "21: $vals = isset($_POST['values']) ? $_POST['values'] : null;",
          "22: $values = json_decode($vals);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c903ecf6751684b6af2d079c78b1f0d09ea2bd47",
      "candidate_info": {
        "commit_hash": "c903ecf6751684b6af2d079c78b1f0d09ea2bd47",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/c903ecf6751684b6af2d079c78b1f0d09ea2bd47",
        "files": [
          "ChangeLog",
          "libraries/url_generating.lib.php",
          "setup/frames/form.inc.php",
          "setup/frames/index.inc.php",
          "setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php",
          "setup/index.php",
          "setup/lib/form_processing.lib.php",
          "setup/validate.php"
        ],
        "message": "bug #4899 [security] CSRF vulnerability in setup\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
          "setup/frames/form.inc.php||setup/frames/form.inc.php",
          "setup/frames/index.inc.php||setup/frames/index.inc.php",
          "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
          "setup/index.php||setup/index.php",
          "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
          "setup/validate.php||setup/validate.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ],
          "candidate": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/url_generating.lib.php||libraries/url_generating.lib.php": [
          "File: libraries/url_generating.lib.php -> libraries/url_generating.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "231:     if (isset($GLOBALS['server'])",
          "232:         && $GLOBALS['server'] != $GLOBALS['cfg']['ServerDefault']",
          "233:         && ! isset($params['server'])",
          "234:     ) {",
          "235:         $params['server'] = $GLOBALS['server'];",
          "236:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "234:         && ! defined('PMA_SETUP')",
          "",
          "---------------"
        ],
        "setup/frames/form.inc.php||setup/frames/form.inc.php": [
          "File: setup/frames/form.inc.php -> setup/frames/form.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "24: if (! isset($forms[$formset_id])) {",
          "25:     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php!'));",
          "26: }",
          "",
          "[Removed Lines]",
          "22: $formset_id = filter_input(INPUT_GET, 'formset');",
          "23: $mode = filter_input(INPUT_GET, 'mode');",
          "",
          "[Added Lines]",
          "22: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "23: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "",
          "---------------"
        ],
        "setup/frames/index.inc.php||setup/frames/index.inc.php": [
          "File: setup/frames/index.inc.php -> setup/frames/index.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "173:         echo '<td>' . htmlspecialchars($cf->getServerDSN($id)) . '</td>';",
          "174:         echo '<td style=\"white-space: nowrap\">';",
          "175:         echo '<small>';",
          "178:             . __('Edit') . '</a>';",
          "179:         echo ' | ';",
          "182:             . __('Delete') . '</a>';",
          "183:         echo '</small>';",
          "184:         echo '</td>';",
          "",
          "[Removed Lines]",
          "176:         echo '<a href=\"?page=servers' . $separator",
          "177:             . 'mode=edit' . $separator . 'id=' . $id . '\">'",
          "180:         echo '<a href=\"?page=servers' . $separator",
          "181:             . 'mode=remove' . $separator . 'id=' . $id . '\">'",
          "",
          "[Added Lines]",
          "176:         echo '<a href=\"?' . PMA_URL_getCommon() . $separator . 'page=servers'",
          "177:             . $separator . 'mode=edit' . $separator . 'id=' . $id . '\">'",
          "180:         echo '<a href=\"?' . PMA_URL_getCommon() . $separator . 'page=servers'",
          "181:             . $separator . 'mode=remove' . $separator . 'id=' . $id . '\">'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "307: echo '<a href=\"http://www.phpmyadmin.net/\">' . __('phpMyAdmin homepage') . '</a>';",
          "308: echo '<a href=\"http://sourceforge.net/donate/index.php?group_id=23067\">'",
          "309:     .  __('Donate') . '</a>';",
          "312:     . __('Check for latest version') . '</a>';",
          "313: echo '</div>';",
          "",
          "[Removed Lines]",
          "310: echo '<a href=\"?version_check=1' . $separator",
          "311:     . 'token=' . $_SESSION[' PMA_token '] . '\">'",
          "",
          "[Added Lines]",
          "310: echo '<a href=\"?' .  PMA_URL_getCommon() . $separator . 'version_check=1\">'",
          "",
          "---------------"
        ],
        "setup/frames/menu.inc.php||setup/frames/menu.inc.php": [
          "File: setup/frames/menu.inc.php -> setup/frames/menu.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:     exit;",
          "11: }",
          "15: $separator = PMA_URL_getArgSeparator('html');",
          "16: echo '<ul>';",
          "18:     . ($formset_id === null ? ' class=\"active' : '')",
          "19:     . '\">' . __('Overview') . '</a></li>';",
          "",
          "[Removed Lines]",
          "13: $formset_id = filter_input(INPUT_GET, 'formset');",
          "17: echo '<li><a href=\"index.php\"'",
          "",
          "[Added Lines]",
          "13: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "17: echo '<li><a href=\"index.php?' . PMA_URL_getCommon() . '\"'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "28: );",
          "30: foreach ($formsets as $formset => $label) {",
          "32:         . ($formset_id === $formset ? ' class=\"active' : '')",
          "33:         . '\">' . $label . '</a></li>';",
          "34: }",
          "",
          "[Removed Lines]",
          "31:     echo '<li><a href=\"?page=form' . $separator . 'formset=' . $formset . '\" '",
          "",
          "[Added Lines]",
          "31:     echo '<li><a href=\"?' . PMA_URL_getCommon() . $separator . 'page=form'",
          "32:         . $separator . 'formset=' . $formset . '\" '",
          "",
          "---------------"
        ],
        "setup/frames/servers.inc.php||setup/frames/servers.inc.php": [
          "File: setup/frames/servers.inc.php -> setup/frames/servers.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "25: $cf = $GLOBALS['ConfigFile'];",
          "26: $server_exists = !empty($id) && $cf->get(\"Servers/$id\") !== null;",
          "",
          "[Removed Lines]",
          "22: $mode = filter_input(INPUT_GET, 'mode');",
          "23: $id = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "22: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "23: $id = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------"
        ],
        "setup/index.php||setup/index.php": [
          "File: setup/index.php -> setup/index.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: require './lib/common.inc.php';",
          "16: $page = preg_replace('/[^a-z]/', '', $page);",
          "17: if ($page === '') {",
          "18:     $page = 'index';",
          "",
          "[Removed Lines]",
          "15: $page = filter_input(INPUT_GET, 'page');",
          "",
          "[Added Lines]",
          "15: $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "23: }",
          "27: $action_done = preg_replace('/[^a-z_]/', '', $action_done);",
          "29: PMA_noCacheHeader();",
          "",
          "[Removed Lines]",
          "26: $action_done = filter_input(INPUT_GET, 'action_done');",
          "",
          "[Added Lines]",
          "26: $action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;",
          "",
          "---------------"
        ],
        "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php": [
          "File: setup/lib/form_processing.lib.php -> setup/lib/form_processing.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "16: function PMA_Process_formset(FormDisplay $form_display)",
          "17: {",
          "20:         $form_display->fixErrors();",
          "21:         PMA_generateHeader303();",
          "",
          "[Removed Lines]",
          "18:     if (filter_input(INPUT_GET, 'mode') == 'revert') {",
          "",
          "[Added Lines]",
          "18:     if (isset($_GET['mode']) && $_GET['mode'] == 'revert') {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "37:     $separator = PMA_URL_getArgSeparator('html');",
          "40:     $formset = $formset ? \"{$separator}formset=$formset\" : '';",
          "42:     if ($formId === null && $page == 'servers') {",
          "44:         $formId = $form_display->getConfigFile()->getServerCount();",
          "",
          "[Removed Lines]",
          "38:     $page = filter_input(INPUT_GET, 'page');",
          "39:     $formset = filter_input(INPUT_GET, 'formset');",
          "41:     $formId = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "38:     $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "39:     $formset = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "41:     $formId = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "48:     <div class=\"error\">",
          "49:         <h4><?php echo __('Warning') ?></h4>",
          "50:         <?php echo __('Submitted form contains errors') ?><br />",
          "52:             <?php echo __('Try to revert erroneous fields to their default values')",
          "53:             ?>",
          "54:         </a>",
          "55:     </div>",
          "56:     <?php $form_display->displayErrors() ?>",
          "58:     &nbsp;",
          "60:         . $separator ?>mode=edit\"><?php echo __('Show form') ?></a>",
          "61:     <?php",
          "62: }",
          "",
          "[Removed Lines]",
          "51:         <a href=\"?page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
          "57:     <a class=\"btn\" href=\"index.php\"><?php echo __('Ignore errors') ?></a>",
          "59:     <a class=\"btn\" href=\"?page=<?php echo $page . $formset . $formId",
          "",
          "[Added Lines]",
          "51:         <a href=\"?<?php echo PMA_URL_getCommon() . $separator ?>",
          "52:             page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
          "58:     <a class=\"btn\" href=\"index.php?<?php echo PMA_URL_getCommon() ?>\">",
          "59:         <?php echo __('Ignore errors') ?></a>",
          "61:     <a class=\"btn\" href=\"?<?php echo PMA_URL_getCommon() . $separator ?>",
          "62:         page=<?php echo $page . $formset . $formId",
          "",
          "---------------"
        ],
        "setup/validate.php||setup/validate.php": [
          "File: setup/validate.php -> setup/validate.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: header('Content-type: application/json');",
          "21: if (!($values instanceof stdClass)) {",
          "22:     PMA_fatalError(__('Wrong data'));",
          "23: }",
          "",
          "[Removed Lines]",
          "19: $vids = explode(',', filter_input(INPUT_POST, 'id'));",
          "20: $values = json_decode(filter_input(INPUT_POST, 'values'));",
          "",
          "[Added Lines]",
          "19: $ids = isset($_POST['id']) ? $_POST['id'] : null;",
          "20: $vids = explode(',', $ids);",
          "21: $vals = isset($_POST['values']) ? $_POST['values'] : null;",
          "22: $values = json_decode($vals);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9817bd4030de949ba9ce4cd1b3f047e22d8f66bd",
      "candidate_info": {
        "commit_hash": "9817bd4030de949ba9ce4cd1b3f047e22d8f66bd",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/9817bd4030de949ba9ce4cd1b3f047e22d8f66bd",
        "files": [
          "ChangeLog",
          "libraries/url_generating.lib.php",
          "setup/frames/form.inc.php",
          "setup/frames/index.inc.php",
          "setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php",
          "setup/index.php",
          "setup/lib/form_processing.lib.php",
          "setup/validate.php"
        ],
        "message": "bug #4899 [security] CSRF vulnerability in setup\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
          "setup/frames/form.inc.php||setup/frames/form.inc.php",
          "setup/frames/index.inc.php||setup/frames/index.inc.php",
          "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
          "setup/index.php||setup/index.php",
          "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
          "setup/validate.php||setup/validate.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ],
          "candidate": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/url_generating.lib.php||libraries/url_generating.lib.php": [
          "File: libraries/url_generating.lib.php -> libraries/url_generating.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "179:     if (isset($GLOBALS['server'])",
          "180:         && $GLOBALS['server'] != $GLOBALS['cfg']['ServerDefault']",
          "181:         && ! isset($params['server'])",
          "182:     ) {",
          "183:         $params['server'] = $GLOBALS['server'];",
          "184:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "182:         && ! defined('PMA_SETUP')",
          "",
          "---------------"
        ],
        "setup/frames/form.inc.php||setup/frames/form.inc.php": [
          "File: setup/frames/form.inc.php -> setup/frames/form.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "24: if (! isset($forms[$formset_id])) {",
          "25:     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php!'));",
          "26: }",
          "",
          "[Removed Lines]",
          "22: $formset_id = filter_input(INPUT_GET, 'formset');",
          "23: $mode = filter_input(INPUT_GET, 'mode');",
          "",
          "[Added Lines]",
          "22: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "23: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "",
          "---------------"
        ],
        "setup/frames/index.inc.php||setup/frames/index.inc.php": [
          "File: setup/frames/index.inc.php -> setup/frames/index.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "174:         echo '<td>' . htmlspecialchars($cf->getServerDSN($id)) . '</td>';",
          "175:         echo '<td style=\"white-space: nowrap\">';",
          "176:         echo '<small>';",
          "179:             . __('Edit') . '</a>';",
          "180:         echo ' | ';",
          "183:             . __('Delete') . '</a>';",
          "184:         echo '</small>';",
          "185:         echo '</td>';",
          "",
          "[Removed Lines]",
          "177:         echo '<a href=\"?page=servers' . $separator",
          "178:             . 'mode=edit' . $separator . 'id=' . $id . '\">'",
          "181:         echo '<a href=\"?page=servers' . $separator",
          "182:             . 'mode=remove' . $separator . 'id=' . $id . '\">'",
          "",
          "[Added Lines]",
          "177:         echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'",
          "178:             . $separator . 'mode=edit' . $separator . 'id=' . $id . '\">'",
          "181:         echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'",
          "182:             . $separator . 'mode=remove' . $separator . 'id=' . $id . '\">'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "308: echo '<a href=\"http://www.phpmyadmin.net/\">' . __('phpMyAdmin homepage') . '</a>';",
          "309: echo '<a href=\"http://sourceforge.net/donate/index.php?group_id=23067\">'",
          "310:     .  __('Donate') . '</a>';",
          "313:     . __('Check for latest version') . '</a>';",
          "314: echo '</div>';",
          "",
          "[Removed Lines]",
          "311: echo '<a href=\"?version_check=1' . $separator",
          "312:     . 'token=' . $_SESSION[' PMA_token '] . '\">'",
          "",
          "[Added Lines]",
          "311: echo '<a href=\"' .  PMA_URL_getCommon() . $separator . 'version_check=1\">'",
          "",
          "---------------"
        ],
        "setup/frames/menu.inc.php||setup/frames/menu.inc.php": [
          "File: setup/frames/menu.inc.php -> setup/frames/menu.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "10:     exit;",
          "11: }",
          "15: $separator = PMA_URL_getArgSeparator('html');",
          "16: echo '<ul>';",
          "18:     . ($formset_id === null ? ' class=\"active' : '')",
          "19:     . '\">' . __('Overview') . '</a></li>';",
          "",
          "[Removed Lines]",
          "13: $formset_id = filter_input(INPUT_GET, 'formset');",
          "17: echo '<li><a href=\"index.php\"'",
          "",
          "[Added Lines]",
          "13: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "17: echo '<li><a href=\"index.php' . PMA_URL_getCommon() . '\"'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "28: );",
          "30: foreach ($formsets as $formset => $label) {",
          "32:         . ($formset_id === $formset ? ' class=\"active' : '')",
          "33:         . '\">' . $label . '</a></li>';",
          "34: }",
          "",
          "[Removed Lines]",
          "31:     echo '<li><a href=\"?page=form' . $separator . 'formset=' . $formset . '\" '",
          "",
          "[Added Lines]",
          "31:     echo '<li><a href=\"' . PMA_URL_getCommon() . $separator . 'page=form'",
          "32:         . $separator . 'formset=' . $formset . '\" '",
          "",
          "---------------"
        ],
        "setup/frames/servers.inc.php||setup/frames/servers.inc.php": [
          "File: setup/frames/servers.inc.php -> setup/frames/servers.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "25: $cf = $GLOBALS['ConfigFile'];",
          "26: $server_exists = !empty($id) && $cf->get(\"Servers/$id\") !== null;",
          "",
          "[Removed Lines]",
          "22: $mode = filter_input(INPUT_GET, 'mode');",
          "23: $id = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "22: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "23: $id = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------"
        ],
        "setup/index.php||setup/index.php": [
          "File: setup/index.php -> setup/index.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: require './lib/common.inc.php';",
          "16: $page = preg_replace('/[^a-z]/', '', $page);",
          "17: if ($page === '') {",
          "18:     $page = 'index';",
          "",
          "[Removed Lines]",
          "15: $page = filter_input(INPUT_GET, 'page');",
          "",
          "[Added Lines]",
          "15: $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "23: }",
          "27: $action_done = preg_replace('/[^a-z_]/', '', $action_done);",
          "29: PMA_noCacheHeader();",
          "",
          "[Removed Lines]",
          "26: $action_done = filter_input(INPUT_GET, 'action_done');",
          "",
          "[Added Lines]",
          "26: $action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;",
          "",
          "---------------"
        ],
        "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php": [
          "File: setup/lib/form_processing.lib.php -> setup/lib/form_processing.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "16: function PMA_Process_formset(FormDisplay $form_display)",
          "17: {",
          "20:         $form_display->fixErrors();",
          "21:         PMA_generateHeader303();",
          "",
          "[Removed Lines]",
          "18:     if (filter_input(INPUT_GET, 'mode') == 'revert') {",
          "",
          "[Added Lines]",
          "18:     if (isset($_GET['mode']) && $_GET['mode'] == 'revert') {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "37:     $separator = PMA_URL_getArgSeparator('html');",
          "40:     $formset = $formset ? \"{$separator}formset=$formset\" : '';",
          "42:     if ($formId === null && $page == 'servers') {",
          "44:         $formId = $form_display->getConfigFile()->getServerCount();",
          "",
          "[Removed Lines]",
          "38:     $page = filter_input(INPUT_GET, 'page');",
          "39:     $formset = filter_input(INPUT_GET, 'formset');",
          "41:     $formId = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "38:     $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "39:     $formset = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "41:     $formId = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "48:     <div class=\"error\">",
          "49:         <h4><?php echo __('Warning') ?></h4>",
          "50:         <?php echo __('Submitted form contains errors') ?><br />",
          "52:             <?php echo __('Try to revert erroneous fields to their default values')",
          "53:             ?>",
          "54:         </a>",
          "55:     </div>",
          "56:     <?php $form_display->displayErrors() ?>",
          "58:     &nbsp;",
          "60:         . $separator ?>mode=edit\"><?php echo __('Show form') ?></a>",
          "61:     <?php",
          "62: }",
          "",
          "[Removed Lines]",
          "51:         <a href=\"?page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
          "57:     <a class=\"btn\" href=\"index.php\"><?php echo __('Ignore errors') ?></a>",
          "59:     <a class=\"btn\" href=\"?page=<?php echo $page . $formset . $formId",
          "",
          "[Added Lines]",
          "51:         <a href=\"<?php echo PMA_URL_getCommon() . $separator ?>",
          "52:             page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">",
          "58:     <a class=\"btn\" href=\"index.php<?php echo PMA_URL_getCommon() ?>\">",
          "59:         <?php echo __('Ignore errors') ?></a>",
          "61:     <a class=\"btn\" href=\"<?php echo PMA_URL_getCommon() . $separator ?>",
          "62:         page=<?php echo $page . $formset . $formId",
          "",
          "---------------"
        ],
        "setup/validate.php||setup/validate.php": [
          "File: setup/validate.php -> setup/validate.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: header('Content-type: application/json');",
          "21: if (!($values instanceof stdClass)) {",
          "22:     PMA_fatalError(__('Wrong data'));",
          "23: }",
          "",
          "[Removed Lines]",
          "19: $vids = explode(',', filter_input(INPUT_POST, 'id'));",
          "20: $values = json_decode(filter_input(INPUT_POST, 'values'));",
          "",
          "[Added Lines]",
          "19: $ids = isset($_POST['id']) ? $_POST['id'] : null;",
          "20: $vids = explode(',', $ids);",
          "21: $vals = isset($_POST['values']) ? $_POST['values'] : null;",
          "22: $values = json_decode($vals);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fea1d39fef540afa4105c6fbcc849f7e516f3da8",
      "candidate_info": {
        "commit_hash": "fea1d39fef540afa4105c6fbcc849f7e516f3da8",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/fea1d39fef540afa4105c6fbcc849f7e516f3da8",
        "files": [
          "ChangeLog",
          "libraries/url_generating.lib.php",
          "setup/frames/form.inc.php",
          "setup/frames/index.inc.php",
          "setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php",
          "setup/index.php",
          "setup/lib/form_processing.lib.php",
          "setup/validate.php"
        ],
        "message": "bug #4899 [security] CSRF vulnerability in setup\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
          "setup/frames/form.inc.php||setup/frames/form.inc.php",
          "setup/frames/index.inc.php||setup/frames/index.inc.php",
          "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
          "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
          "setup/index.php||setup/index.php",
          "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
          "setup/validate.php||setup/validate.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ],
          "candidate": [
            "libraries/url_generating.lib.php||libraries/url_generating.lib.php",
            "setup/frames/form.inc.php||setup/frames/form.inc.php",
            "setup/frames/index.inc.php||setup/frames/index.inc.php",
            "setup/frames/menu.inc.php||setup/frames/menu.inc.php",
            "setup/frames/servers.inc.php||setup/frames/servers.inc.php",
            "setup/index.php||setup/index.php",
            "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php",
            "setup/validate.php||setup/validate.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/url_generating.lib.php||libraries/url_generating.lib.php": [
          "File: libraries/url_generating.lib.php -> libraries/url_generating.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "228:     if (isset($GLOBALS['server'])",
          "229:         && $GLOBALS['server'] != $GLOBALS['cfg']['ServerDefault']",
          "230:         && ! isset($params['server'])",
          "231:     ) {",
          "232:         $params['server'] = $GLOBALS['server'];",
          "233:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "231:         && ! defined('PMA_SETUP')",
          "",
          "---------------"
        ],
        "setup/frames/form.inc.php||setup/frames/form.inc.php": [
          "File: setup/frames/form.inc.php -> setup/frames/form.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "24: if (! isset($forms[$formset_id])) {",
          "25:     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php'));",
          "26: }",
          "",
          "[Removed Lines]",
          "22: $formset_id = filter_input(INPUT_GET, 'formset');",
          "23: $mode = filter_input(INPUT_GET, 'mode');",
          "",
          "[Added Lines]",
          "22: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "23: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "",
          "---------------"
        ],
        "setup/frames/index.inc.php||setup/frames/index.inc.php": [
          "File: setup/frames/index.inc.php -> setup/frames/index.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "144:     <td><?php echo htmlspecialchars($cf->getServerDSN($id)) ?></td>",
          "145:     <td style=\"white-space: nowrap\">",
          "146:         <small>",
          "149:         </small>",
          "150:     </td>",
          "151: </tr>",
          "",
          "[Removed Lines]",
          "147:         <a href=\"<?php echo \"?page=servers{$separator}mode=edit{$separator}id=$id\" ?>\"><?php echo __('Edit') ?></a>",
          "148:         | <a href=\"<?php echo \"?page=servers{$separator}mode=remove{$separator}id=$id\" ?>\"><?php echo __('Delete') ?></a>",
          "",
          "[Added Lines]",
          "147:         <a href=\"<?php echo \"?\" . PMA_generate_common_url() . $separator . \"page=servers{$separator}mode=edit{$separator}id=$id\" ?>\"><?php echo __('Edit') ?></a>",
          "148:         | <a href=\"<?php echo \"?\" . PMA_generate_common_url() . $separator . \"page=servers{$separator}mode=remove{$separator}id=$id\" ?>\"><?php echo __('Delete') ?></a>",
          "",
          "---------------"
        ],
        "setup/frames/menu.inc.php||setup/frames/menu.inc.php": [
          "File: setup/frames/menu.inc.php -> setup/frames/menu.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: $separator = PMA_get_arg_separator('html');",
          "14: ?>",
          "15: <ul>",
          "23: </ul>",
          "",
          "[Removed Lines]",
          "16:     <li><a href=\"index.php\"><?php echo __('Overview') ?></a></li>",
          "17:     <li><a href=\"?page=form<?php echo $separator ?>formset=Features\"><?php echo __('Features') ?></a></li>",
          "18:     <li><a href=\"?page=form<?php echo $separator ?>formset=Sql_queries\"><?php echo __('SQL queries') ?></a></li>",
          "19:     <li><a href=\"?page=form<?php echo $separator ?>formset=Navi_panel\"><?php echo __('Navigation panel') ?></a></li>",
          "20:     <li><a href=\"?page=form<?php echo $separator ?>formset=Main_panel\"><?php echo __('Main panel') ?></a></li>",
          "21:     <li><a href=\"?page=form<?php echo $separator ?>formset=Import\"><?php echo __('Import') ?></a></li>",
          "22:     <li><a href=\"?page=form<?php echo $separator ?>formset=Export\"><?php echo __('Export') ?></a></li>",
          "",
          "[Added Lines]",
          "16:     <li><a href=\"index.php?<?php echo PMA_generate_common_url() ?>\"><?php echo __('Overview') ?></a></li>",
          "17:     <li><a href=\"?page=form<?php echo $separator . PMA_generate_common_url() . $separator ?>formset=Features\"><?php echo __('Features') ?></a></li>",
          "18:     <li><a href=\"?page=form<?php echo $separator . PMA_generate_common_url() . $separator ?>formset=Sql_queries\"><?php echo __('SQL queries') ?></a></li>",
          "19:     <li><a href=\"?page=form<?php echo $separator . PMA_generate_common_url() . $separator ?>formset=Navi_panel\"><?php echo __('Navigation panel') ?></a></li>",
          "20:     <li><a href=\"?page=form<?php echo $separator . PMA_generate_common_url() . $separator ?>formset=Main_panel\"><?php echo __('Main panel') ?></a></li>",
          "21:     <li><a href=\"?page=form<?php echo $separator . PMA_generate_common_url() . $separator ?>formset=Import\"><?php echo __('Import') ?></a></li>",
          "22:     <li><a href=\"?page=form<?php echo $separator . PMA_generate_common_url() . $separator ?>formset=Export\"><?php echo __('Export') ?></a></li>",
          "",
          "---------------"
        ],
        "setup/frames/servers.inc.php||setup/frames/servers.inc.php": [
          "File: setup/frames/servers.inc.php -> setup/frames/servers.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "25: $cf = ConfigFile::getInstance();",
          "26: $server_exists = !empty($id) && $cf->get(\"Servers/$id\") !== null;",
          "",
          "[Removed Lines]",
          "22: $mode = filter_input(INPUT_GET, 'mode');",
          "23: $id = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "22: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "23: $id = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------"
        ],
        "setup/index.php||setup/index.php": [
          "File: setup/index.php -> setup/index.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: require './lib/common.inc.php';",
          "16: $page = preg_replace('/[^a-z]/', '', $page);",
          "17: if ($page === '') {",
          "18:     $page = 'index';",
          "",
          "[Removed Lines]",
          "15: $page = filter_input(INPUT_GET, 'page');",
          "",
          "[Added Lines]",
          "15: $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "23: }",
          "27: $action_done = preg_replace('/[^a-z_]/', '', $action_done);",
          "29: PMA_noCacheHeader();",
          "",
          "[Removed Lines]",
          "26: $action_done = filter_input(INPUT_GET, 'action_done');",
          "",
          "[Added Lines]",
          "26: $action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;",
          "",
          "---------------"
        ],
        "setup/lib/form_processing.lib.php||setup/lib/form_processing.lib.php": [
          "File: setup/lib/form_processing.lib.php -> setup/lib/form_processing.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "16: function process_formset(FormDisplay $form_display)",
          "17: {",
          "20:         $form_display->fixErrors();",
          "",
          "[Removed Lines]",
          "18:     if (filter_input(INPUT_GET, 'mode') == 'revert') {",
          "",
          "[Added Lines]",
          "18:     if (isset($_GET['mode']) && $_GET['mode'] == 'revert') {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "31:         if ($form_display->hasErrors()) {",
          "33:             $separator = PMA_get_arg_separator('html');",
          "36:             $formset = $formset ? \"{$separator}formset=$formset\" : '';",
          "38:             if ($id === null && $page == 'servers') {",
          "40:                 $id = ConfigFile::getInstance()->getServerCount();",
          "",
          "[Removed Lines]",
          "34:             $page = filter_input(INPUT_GET, 'page');",
          "35:             $formset = filter_input(INPUT_GET, 'formset');",
          "37:             $id = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
          "",
          "[Added Lines]",
          "34:             $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "35:             $formset = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "37:             $id = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "44:             <div class=\"error\">",
          "45:                 <h4><?php echo __('Warning') ?></h4>",
          "46:                 <?php echo __('Submitted form contains errors') ?><br />",
          "48:             </div>",
          "49:             <?php $form_display->displayErrors() ?>",
          "51:             &nbsp;",
          "53:             <?php",
          "54:         } else {",
          "",
          "[Removed Lines]",
          "47:                 <a href=\"?page=<?php echo $page . $formset . $id . $separator ?>mode=revert\"><?php echo __('Try to revert erroneous fields to their default values') ?></a>",
          "50:             <a class=\"btn\" href=\"index.php\"><?php echo __('Ignore errors') ?></a>",
          "52:             <a class=\"btn\" href=\"?page=<?php echo $page . $formset . $id . $separator ?>mode=edit\"><?php echo __('Show form') ?></a>",
          "",
          "[Added Lines]",
          "47:                 <a href=\"?page=<?php echo $page . $formset . $id . $separator . PMA_generate_common_url() . $separator ?>mode=revert\"><?php echo __('Try to revert erroneous fields to their default values') ?></a>",
          "50:             <a class=\"btn\" href=\"index.php?<?php echo PMA_generate_common_url() ?>\"><?php echo __('Ignore errors') ?></a>",
          "52:             <a class=\"btn\" href=\"?page=<?php echo $page . $formset . $id . $separator . PMA_generate_common_url() . $separator ?>mode=edit\"><?php echo __('Show form') ?></a>",
          "",
          "---------------"
        ],
        "setup/validate.php||setup/validate.php": [
          "File: setup/validate.php -> setup/validate.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: header('Content-type: application/json');",
          "21: if (!($values instanceof stdClass)) {",
          "22:     PMA_fatalError(__('Wrong data'));",
          "23: }",
          "",
          "[Removed Lines]",
          "19: $vids = explode(',', filter_input(INPUT_POST, 'id'));",
          "20: $values = json_decode(filter_input(INPUT_POST, 'values'));",
          "",
          "[Added Lines]",
          "19: $ids = isset($_POST['id']) ? $_POST['id'] : null;",
          "20: $vids = explode(',', $ids);",
          "21: $vals = isset($_POST['values']) ? $_POST['values'] : null;",
          "22: $values = json_decode($vals);",
          "",
          "---------------"
        ]
      }
    }
  ]
}