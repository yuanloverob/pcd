{
  "cve_id": "CVE-2016-7530",
  "cve_desc": "The quantum handling code in ImageMagick allows remote attackers to cause a denial of service (divide-by-zero error or out-of-bounds write) via a crafted file.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "c4e63ad30bc42da691f2b5f82a24516dd6b4dc70",
  "patch_info": {
    "commit_hash": "c4e63ad30bc42da691f2b5f82a24516dd6b4dc70",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/c4e63ad30bc42da691f2b5f82a24516dd6b4dc70",
    "files": [
      "MagickCore/quantum.c"
    ],
    "message": "https://github.com/ImageMagick/ImageMagick/issues/105",
    "before_after_code_files": [
      "MagickCore/quantum.c||MagickCore/quantum.c"
    ]
  },
  "patch_diff": {
    "MagickCore/quantum.c||MagickCore/quantum.c": [
      "File: MagickCore/quantum.c -> MagickCore/quantum.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "304: %",
      "305: %    o quantum_info: the quantum info.",
      "306: %",
      "307: %    o quantum_type: Declare which pixel components to transfer (red, green,",
      "308: %      blue, opacity, RGB, or RGBA).",
      "309: %",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "307: %    o quantum_type: Declare which pixel components to transfer (red, green,",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "322:     case GrayAlphaQuantum: packet_size=2; break;",
      "323:     case IndexAlphaQuantum: packet_size=2; break;",
      "324:     case RGBQuantum: packet_size=3; break;",
      "325:     case BGRQuantum: packet_size=3; break;",
      "328:     case BGRAQuantum: packet_size=4; break;",
      "329:     case CMYKQuantum: packet_size=4; break;",
      "330:     case CMYKAQuantum: packet_size=5; break;",
      "331:     default: break;",
      "",
      "[Removed Lines]",
      "326:     case RGBAQuantum: packet_size=4; break;",
      "327:     case RGBOQuantum: packet_size=4; break;",
      "",
      "[Added Lines]",
      "326:     case BGRQuantum: packet_size=3; break;",
      "328:     case RGBOQuantum: packet_size=4; break;",
      "329:     case BGRAQuantum: packet_size=4; break;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "683:   assert(image->signature == MagickCoreSignature);",
      "684:   if (image->debug != MagickFalse)",
      "685:     (void) LogMagickEvent(TraceEvent,GetMagickModule(),\"%s\",image->filename);",
      "688:   quantum_info->depth=depth;",
      "689:   if (quantum_info->format == FloatingPointQuantumFormat)",
      "690:     {",
      "",
      "[Removed Lines]",
      "686:   assert(quantum_info != (QuantumInfo *) NULL);",
      "687:   assert(quantum_info->signature == MagickCoreSignature);",
      "",
      "[Added Lines]",
      "688:   assert(quantum_info != (QuantumInfo *) NULL);",
      "689:   assert(quantum_info->signature == MagickCoreSignature);",
      "690:   quantum_info->depth=depth;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "92ea28bd83a2eb14daced56f986823c7cad1077d",
      "candidate_info": {
        "commit_hash": "92ea28bd83a2eb14daced56f986823c7cad1077d",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/92ea28bd83a2eb14daced56f986823c7cad1077d",
        "files": [
          "MagickCore/quantum.c"
        ],
        "message": "https://github.com/ImageMagick/ImageMagick/issues/132",
        "before_after_code_files": [
          "MagickCore/quantum.c||MagickCore/quantum.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/quantum.c||MagickCore/quantum.c"
          ],
          "candidate": [
            "MagickCore/quantum.c||MagickCore/quantum.c"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/quantum.c||MagickCore/quantum.c": [
          "File: MagickCore/quantum.c -> MagickCore/quantum.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "304: %",
          "305: %    o quantum_info: the quantum info.",
          "306: %",
          "308: %      blue, opacity, RGB, or RGBA).",
          "309: %",
          "",
          "[Removed Lines]",
          "307: %    o quantum_type: Declare which pixel components to transfer (red, green,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "326:     case BGRQuantum: packet_size=3; break;",
          "327:     case RGBAQuantum: packet_size=4; break;",
          "328:     case RGBOQuantum: packet_size=4; break;",
          "330:     case CMYKQuantum: packet_size=4; break;",
          "333:     case CbYCrQuantum: packet_size=3; break;",
          "334:     case CbYCrYQuantum: packet_size=4; break;",
          "335:     default: break;",
          "336:   }",
          "",
          "[Removed Lines]",
          "329:     case BGRAQuantum: packet_size=4; break;",
          "331:     case CMYKAQuantum: packet_size=5; break;",
          "332:     case CbYCrAQuantum: packet_size=4; break;",
          "",
          "[Added Lines]",
          "329:     case CMYKQuantum: packet_size=4; break;",
          "330:     case CMYKAQuantum: packet_size=5; break;",
          "",
          "---------------"
        ]
      }
    }
  ]
}