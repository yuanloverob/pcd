{
  "cve_id": "CVE-2019-19553",
  "cve_desc": "In Wireshark 3.0.0 to 3.0.6 and 2.6.0 to 2.6.12, the CMS dissector could crash. This was addressed in epan/dissectors/asn1/cms/packet-cms-template.c by ensuring that an object identifier is set to NULL after a ContentInfo dissection.",
  "repo": "wireshark/wireshark",
  "patch_hash": "23850a3342d64b9c9808f14c20bfea6d22b7dc08",
  "patch_info": {
    "commit_hash": "23850a3342d64b9c9808f14c20bfea6d22b7dc08",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/23850a3342d64b9c9808f14c20bfea6d22b7dc08",
    "files": [
      "epan/dissectors/asn1/cms/cms.cnf",
      "epan/dissectors/asn1/cms/packet-cms-template.c",
      "epan/dissectors/packet-cms.c"
    ],
    "message": "CMS: reset object_identifier_id after dissecting ContentInfo\n\nBug: 15961\nChange-Id: I3d6b3e96103b69f88fcb512da81fa20ff6a1c40e\nReviewed-on: https://code.wireshark.org/review/34960\nPetri-Dish: Pascal Quantin <pascal@wireshark.org>\nTested-by: Petri Dish Buildbot\nReviewed-by: Stig Bj\u00f8rlykke <stig@bjorlykke.org>\nReviewed-by: Roland Knall <rknall@gmail.com>",
    "before_after_code_files": [
      "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf",
      "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c",
      "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c"
    ]
  },
  "patch_diff": {
    "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf": [
      "File: epan/dissectors/asn1/cms/cms.cnf -> epan/dissectors/asn1/cms/cms.cnf",
      "--- Hunk 1 ---",
      "[Context before]",
      "122:   top_tree = tree;",
      "123:   %(DEFAULT_BODY)s",
      "124:   content_tvb = NULL;",
      "125:   top_tree = NULL;",
      "127: #.FN_PARS ContentType",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "125:   object_identifier_id = NULL;",
      "",
      "---------------"
    ],
    "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c": [
      "File: epan/dissectors/asn1/cms/packet-cms-template.c -> epan/dissectors/asn1/cms/packet-cms-template.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "47: static tvbuff_t *content_tvb = NULL;",
      "49: static proto_tree *top_tree=NULL;",
      "",
      "[Removed Lines]",
      "46: static const char *object_identifier_id;",
      "",
      "[Added Lines]",
      "46: static const char *object_identifier_id = NULL;",
      "",
      "---------------"
    ],
    "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c": [
      "File: epan/dissectors/packet-cms.c -> epan/dissectors/packet-cms.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "315: static tvbuff_t *content_tvb = NULL;",
      "317: static proto_tree *top_tree=NULL;",
      "",
      "[Removed Lines]",
      "314: static const char *object_identifier_id;",
      "",
      "[Added Lines]",
      "314: static const char *object_identifier_id = NULL;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "374: int",
      "375: dissect_cms_ContentType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "377:    const char *name = NULL;",
      "379:    offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);",
      "",
      "[Removed Lines]",
      "376: #line 131 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "376: #line 132 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "394: static int",
      "395: dissect_cms_T_content(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "397:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
      "",
      "[Removed Lines]",
      "396: #line 141 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "396: #line 142 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "417:                                    ContentInfo_sequence, hf_index, ett_cms_ContentInfo);",
      "419:   content_tvb = NULL;",
      "420:   top_tree = NULL;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "420:   object_identifier_id = NULL;",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "471: static int",
      "472: dissect_cms_T_eContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "475:   offset = dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &content_tvb);",
      "",
      "[Removed Lines]",
      "473: #line 145 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "474: #line 146 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "505: static int",
      "506: dissect_cms_T_attrType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "508:   const char *name = NULL;",
      "510:     offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_attrType, &object_identifier_id);",
      "",
      "[Removed Lines]",
      "507: #line 175 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "508: #line 176 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "525: static int",
      "526: dissect_cms_AttributeValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "529:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
      "",
      "[Removed Lines]",
      "527: #line 185 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "528: #line 186 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "787: static int",
      "788: dissect_cms_T_otherRevInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "790:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
      "",
      "[Removed Lines]",
      "789: #line 169 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "790: #line 170 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "1124: static int",
      "1125: dissect_cms_T_keyAttr(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "1127:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
      "",
      "[Removed Lines]",
      "1126: #line 164 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "1127: #line 165 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "1312: static int",
      "1313: dissect_cms_T_oriValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "1315:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
      "",
      "[Removed Lines]",
      "1314: #line 158 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "1315: #line 159 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "1389: static int",
      "1390: dissect_cms_EncryptedContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "1392:  tvbuff_t *encrypted_tvb;",
      "1393:  proto_item *item;",
      "1395:   offset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,",
      "1396:                                        &encrypted_tvb);",
      "1400:  item = actx->created_item;",
      "",
      "[Removed Lines]",
      "1391: #line 235 \"./asn1/cms/cms.cnf\"",
      "1398: #line 240 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "1392: #line 236 \"./asn1/cms/cms.cnf\"",
      "1399: #line 241 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "1554: static int",
      "1555: dissect_cms_MessageDigest(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "1557:   proto_item *pi;",
      "1558:   int old_offset = offset;",
      "",
      "[Removed Lines]",
      "1556: #line 189 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "1557: #line 190 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "1638: static int",
      "1639: dissect_cms_RC2ParameterVersion(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "1641:   guint32 length = 0;",
      "1643:     offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
      "",
      "[Removed Lines]",
      "1640: #line 225 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "1641: #line 226 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "1716: static int",
      "1717: dissect_cms_T_capability(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "1719:   const char *name = NULL;",
      "1721:     offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_attrType, &object_identifier_id);",
      "",
      "[Removed Lines]",
      "1718: #line 207 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "1719: #line 208 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1737: static int",
      "1738: dissect_cms_T_parameters(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "1741:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
      "",
      "[Removed Lines]",
      "1739: #line 218 \"./asn1/cms/cms.cnf\"",
      "",
      "[Added Lines]",
      "1740: #line 219 \"./asn1/cms/cms.cnf\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e3872f8795eebd3fdcd738bcea13b8450ee3a3a2",
      "candidate_info": {
        "commit_hash": "e3872f8795eebd3fdcd738bcea13b8450ee3a3a2",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/e3872f8795eebd3fdcd738bcea13b8450ee3a3a2",
        "files": [
          "epan/dissectors/asn1/cms/cms.cnf",
          "epan/dissectors/asn1/cms/packet-cms-template.c",
          "epan/dissectors/packet-cms.c"
        ],
        "message": "CMS: reset object_identifier_id after dissecting ContentInfo\n\nBug: 15961\nChange-Id: I3d6b3e96103b69f88fcb512da81fa20ff6a1c40e\nReviewed-on: https://code.wireshark.org/review/34960\nPetri-Dish: Pascal Quantin <pascal@wireshark.org>\nTested-by: Petri Dish Buildbot\nReviewed-by: Stig Bj\u00f8rlykke <stig@bjorlykke.org>\nReviewed-by: Roland Knall <rknall@gmail.com>\n(cherry picked from commit 23850a3342d64b9c9808f14c20bfea6d22b7dc08)\nReviewed-on: https://code.wireshark.org/review/34974\nReviewed-by: Pascal Quantin <pascal@wireshark.org>",
        "before_after_code_files": [
          "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf",
          "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c",
          "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf",
            "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c",
            "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c"
          ],
          "candidate": [
            "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf",
            "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c",
            "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf": [
          "File: epan/dissectors/asn1/cms/cms.cnf -> epan/dissectors/asn1/cms/cms.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "122:   top_tree = tree;",
          "123:   %(DEFAULT_BODY)s",
          "124:   content_tvb = NULL;",
          "125:   top_tree = NULL;",
          "127: #.FN_PARS ContentType",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125:   object_identifier_id = NULL;",
          "",
          "---------------"
        ],
        "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c": [
          "File: epan/dissectors/asn1/cms/packet-cms-template.c -> epan/dissectors/asn1/cms/packet-cms-template.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "47: static tvbuff_t *content_tvb = NULL;",
          "49: static proto_tree *top_tree=NULL;",
          "",
          "[Removed Lines]",
          "46: static const char *object_identifier_id;",
          "",
          "[Added Lines]",
          "46: static const char *object_identifier_id = NULL;",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c": [
          "File: epan/dissectors/packet-cms.c -> epan/dissectors/packet-cms.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "315: static tvbuff_t *content_tvb = NULL;",
          "317: static proto_tree *top_tree=NULL;",
          "",
          "[Removed Lines]",
          "314: static const char *object_identifier_id;",
          "",
          "[Added Lines]",
          "314: static const char *object_identifier_id = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "374: int",
          "375: dissect_cms_ContentType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "377:    const char *name = NULL;",
          "379:    offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);",
          "",
          "[Removed Lines]",
          "376: #line 131 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "376: #line 132 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "394: static int",
          "395: dissect_cms_T_content(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "397:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "396: #line 141 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "396: #line 142 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "417:                                    ContentInfo_sequence, hf_index, ett_cms_ContentInfo);",
          "419:   content_tvb = NULL;",
          "420:   top_tree = NULL;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "420:   object_identifier_id = NULL;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "471: static int",
          "472: dissect_cms_T_eContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "475:   offset = dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &content_tvb);",
          "",
          "[Removed Lines]",
          "473: #line 145 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "474: #line 146 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "505: static int",
          "506: dissect_cms_T_attrType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "508:   const char *name = NULL;",
          "510:     offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_attrType, &object_identifier_id);",
          "",
          "[Removed Lines]",
          "507: #line 175 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "508: #line 176 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "525: static int",
          "526: dissect_cms_AttributeValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "529:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "527: #line 185 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "528: #line 186 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "787: static int",
          "788: dissect_cms_T_otherRevInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "790:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "789: #line 169 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "790: #line 170 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1124: static int",
          "1125: dissect_cms_T_keyAttr(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1127:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "1126: #line 164 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1127: #line 165 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1312: static int",
          "1313: dissect_cms_T_oriValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1315:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "1314: #line 158 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1315: #line 159 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1389: static int",
          "1390: dissect_cms_EncryptedContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1392:  tvbuff_t *encrypted_tvb;",
          "1393:  proto_item *item;",
          "1395:   offset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "1396:                                        &encrypted_tvb);",
          "1400:  item = actx->created_item;",
          "",
          "[Removed Lines]",
          "1391: #line 235 \"./asn1/cms/cms.cnf\"",
          "1398: #line 240 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1392: #line 236 \"./asn1/cms/cms.cnf\"",
          "1399: #line 241 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1554: static int",
          "1555: dissect_cms_MessageDigest(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1557:   proto_item *pi;",
          "1558:   int old_offset = offset;",
          "",
          "[Removed Lines]",
          "1556: #line 189 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1557: #line 190 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1638: static int",
          "1639: dissect_cms_RC2ParameterVersion(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1641:   guint32 length = 0;",
          "1643:     offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "",
          "[Removed Lines]",
          "1640: #line 225 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1641: #line 226 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1716: static int",
          "1717: dissect_cms_T_capability(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1719:   const char *name = NULL;",
          "1721:     offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_attrType, &object_identifier_id);",
          "",
          "[Removed Lines]",
          "1718: #line 207 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1719: #line 208 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1737: static int",
          "1738: dissect_cms_T_parameters(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1741:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "1739: #line 218 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1740: #line 219 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "34d2e0d5318d0a7e9889498c721639e5cbf4ce45",
      "candidate_info": {
        "commit_hash": "34d2e0d5318d0a7e9889498c721639e5cbf4ce45",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/34d2e0d5318d0a7e9889498c721639e5cbf4ce45",
        "files": [
          "epan/dissectors/asn1/cms/cms.cnf",
          "epan/dissectors/asn1/cms/packet-cms-template.c",
          "epan/dissectors/packet-cms.c"
        ],
        "message": "CMS: reset object_identifier_id after dissecting ContentInfo\n\nBug: 15961\nChange-Id: I3d6b3e96103b69f88fcb512da81fa20ff6a1c40e\nReviewed-on: https://code.wireshark.org/review/34960\nPetri-Dish: Pascal Quantin <pascal@wireshark.org>\nTested-by: Petri Dish Buildbot\nReviewed-by: Stig Bj\u00f8rlykke <stig@bjorlykke.org>\nReviewed-by: Roland Knall <rknall@gmail.com>\n(cherry picked from commit 23850a3342d64b9c9808f14c20bfea6d22b7dc08)\nConflicts:\n\tepan/dissectors/packet-cms.c\nReviewed-on: https://code.wireshark.org/review/34975\nReviewed-by: Pascal Quantin <pascal@wireshark.org>",
        "before_after_code_files": [
          "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf",
          "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c",
          "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf",
            "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c",
            "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c"
          ],
          "candidate": [
            "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf",
            "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c",
            "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/asn1/cms/cms.cnf||epan/dissectors/asn1/cms/cms.cnf": [
          "File: epan/dissectors/asn1/cms/cms.cnf -> epan/dissectors/asn1/cms/cms.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "97:   top_tree = tree;",
          "98:   %(DEFAULT_BODY)s",
          "99:   content_tvb = NULL;",
          "100:   top_tree = NULL;",
          "102: #.FN_PARS ContentType",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "100:   object_identifier_id = NULL;",
          "",
          "---------------"
        ],
        "epan/dissectors/asn1/cms/packet-cms-template.c||epan/dissectors/asn1/cms/packet-cms-template.c": [
          "File: epan/dissectors/asn1/cms/packet-cms-template.c -> epan/dissectors/asn1/cms/packet-cms-template.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "47: static tvbuff_t *content_tvb = NULL;",
          "49: static proto_tree *top_tree=NULL;",
          "",
          "[Removed Lines]",
          "46: static const char *object_identifier_id;",
          "",
          "[Added Lines]",
          "46: static const char *object_identifier_id = NULL;",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-cms.c||epan/dissectors/packet-cms.c": [
          "File: epan/dissectors/packet-cms.c -> epan/dissectors/packet-cms.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "313: static tvbuff_t *content_tvb = NULL;",
          "315: static proto_tree *top_tree=NULL;",
          "",
          "[Removed Lines]",
          "312: static const char *object_identifier_id;",
          "",
          "[Added Lines]",
          "312: static const char *object_identifier_id = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "372: int",
          "373: dissect_cms_ContentType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "375:    const char *name = NULL;",
          "377:    offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);",
          "",
          "[Removed Lines]",
          "374: #line 106 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "374: #line 107 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "392: static int",
          "393: dissect_cms_T_content(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "395:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "394: #line 116 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "394: #line 117 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "415:                                    ContentInfo_sequence, hf_index, ett_cms_ContentInfo);",
          "417:   content_tvb = NULL;",
          "418:   top_tree = NULL;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "418:   object_identifier_id = NULL;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "469: static int",
          "470: dissect_cms_T_eContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "473:   offset = dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &content_tvb);",
          "",
          "[Removed Lines]",
          "471: #line 120 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "472: #line 121 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "503: static int",
          "504: dissect_cms_T_attrType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "506:   const char *name = NULL;",
          "508:     offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_attrType, &object_identifier_id);",
          "",
          "[Removed Lines]",
          "505: #line 150 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "506: #line 151 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "523: static int",
          "524: dissect_cms_AttributeValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "527:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "525: #line 160 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "526: #line 161 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "785: static int",
          "786: dissect_cms_T_otherRevInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "788:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "787: #line 144 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "788: #line 145 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1122: static int",
          "1123: dissect_cms_T_keyAttr(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1125:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "1124: #line 139 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1125: #line 140 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1310: static int",
          "1311: dissect_cms_T_oriValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1313:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "1312: #line 133 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1313: #line 134 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1387: static int",
          "1388: dissect_cms_EncryptedContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1390:  tvbuff_t *encrypted_tvb;",
          "1391:  proto_item *item;",
          "1393:   offset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "1394:                                        &encrypted_tvb);",
          "1398:  item = actx->created_item;",
          "",
          "[Removed Lines]",
          "1389: #line 210 \"./asn1/cms/cms.cnf\"",
          "1396: #line 215 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1390: #line 211 \"./asn1/cms/cms.cnf\"",
          "1397: #line 216 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1552: static int",
          "1553: dissect_cms_MessageDigest(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1555:   proto_item *pi;",
          "1556:   int old_offset = offset;",
          "",
          "[Removed Lines]",
          "1554: #line 164 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1555: #line 165 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1627: static int",
          "1628: dissect_cms_RC2ParameterVersion(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1630:   guint32 length = 0;",
          "1632:     offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "",
          "[Removed Lines]",
          "1629: #line 200 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1630: #line 201 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1695: static int",
          "1696: dissect_cms_T_capability(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1698:   const char *name = NULL;",
          "1700:     offset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_attrType, &object_identifier_id);",
          "",
          "[Removed Lines]",
          "1697: #line 182 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1698: #line 183 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1716: static int",
          "1717: dissect_cms_T_parameters(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "1720:   offset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);",
          "",
          "[Removed Lines]",
          "1718: #line 193 \"./asn1/cms/cms.cnf\"",
          "",
          "[Added Lines]",
          "1719: #line 194 \"./asn1/cms/cms.cnf\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}