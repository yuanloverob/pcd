{
  "cve_id": "CVE-2020-11098",
  "cve_desc": "In FreeRDP before version 2.1.2, there is an out-of-bound read in glyph_cache_put. This affects all FreeRDP clients with `+glyph-cache` option enabled This is fixed in version 2.1.2.",
  "repo": "FreeRDP/FreeRDP",
  "patch_hash": "c0fd449ec0870b050d350d6d844b1ea6dad4bc7d",
  "patch_info": {
    "commit_hash": "c0fd449ec0870b050d350d6d844b1ea6dad4bc7d",
    "repo": "FreeRDP/FreeRDP",
    "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/c0fd449ec0870b050d350d6d844b1ea6dad4bc7d",
    "files": [
      "libfreerdp/cache/glyph.c"
    ],
    "message": "Fixed Out-of-bound read in glyph_cache_put\n\nCVE-2020-11098 thanks to @antonio-morales for finding this.",
    "before_after_code_files": [
      "libfreerdp/cache/glyph.c||libfreerdp/cache/glyph.c"
    ]
  },
  "patch_diff": {
    "libfreerdp/cache/glyph.c||libfreerdp/cache/glyph.c": [
      "File: libfreerdp/cache/glyph.c -> libfreerdp/cache/glyph.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "579:   return FALSE;",
      "580:  }",
      "583:  {",
      "584:   WLog_ERR(TAG, \"invalid glyph cache index: %\" PRIu32 \" in cache id: %\" PRIu32 \"\", index, id);",
      "585:   return FALSE;",
      "",
      "[Removed Lines]",
      "582:  if (index > glyphCache->glyphCache[id].number)",
      "",
      "[Added Lines]",
      "582:  if (index >= glyphCache->glyphCache[id].number)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "02c5ec66e5b47fe4cf2fc96e2cd387a18e3f2bb6",
      "candidate_info": {
        "commit_hash": "02c5ec66e5b47fe4cf2fc96e2cd387a18e3f2bb6",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/02c5ec66e5b47fe4cf2fc96e2cd387a18e3f2bb6",
        "files": [
          "libfreerdp/crypto/crypto.c"
        ],
        "message": "Fixed possible integer overflow in crypto_rsa_common\n\nThanks @anticomputer for pointing this out",
        "before_after_code_files": [
          "libfreerdp/crypto/crypto.c||libfreerdp/crypto/crypto.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/FreeRDP/FreeRDP/pull/6295"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "libfreerdp/crypto/crypto.c||libfreerdp/crypto/crypto.c": [
          "File: libfreerdp/crypto/crypto.c -> libfreerdp/crypto/crypto.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "105:  BIGNUM* exp = NULL;",
          "106:  BIGNUM* x = NULL;",
          "107:  BIGNUM* y = NULL;",
          "110:  if (!input || (length < 0) || (exponent_size < 0) || !modulus || !exponent || !output)",
          "111:   return -1;",
          "113:  if (length > bufferSize)",
          "114:   bufferSize = length;",
          "",
          "[Removed Lines]",
          "108:  size_t bufferSize = 2 * key_length + exponent_size;",
          "",
          "[Added Lines]",
          "108:  size_t bufferSize;",
          "113:  if (exponent_size > SIZE_MAX / 2)",
          "114:   return -1;",
          "116:  if (key_length >= SIZE_MAX / 2 - exponent_size)",
          "117:   return -1;",
          "119:  bufferSize = 2ULL * key_length + exponent_size;",
          "",
          "---------------"
        ]
      }
    }
  ]
}