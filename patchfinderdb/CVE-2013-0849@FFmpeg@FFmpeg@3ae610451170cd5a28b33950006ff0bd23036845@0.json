{
  "cve_id": "CVE-2013-0849",
  "cve_desc": "The roq_decode_init function in libavcodec/roqvideodec.c in FFmpeg before 1.1 allows remote attackers to have an unspecified impact via a crafted (1) width or (2) height dimension that is not a multiple of sixteen in id RoQ video data.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "3ae610451170cd5a28b33950006ff0bd23036845",
  "patch_info": {
    "commit_hash": "3ae610451170cd5a28b33950006ff0bd23036845",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/3ae610451170cd5a28b33950006ff0bd23036845",
    "files": [
      "libavcodec/roqvideodec.c"
    ],
    "message": "roqvideodec: check dimensions validity\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "before_after_code_files": [
      "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
    ]
  },
  "patch_diff": {
    "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c": [
      "File: libavcodec/roqvideodec.c -> libavcodec/roqvideodec.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "170:     RoqContext *s = avctx->priv_data;",
      "172:     s->avctx = avctx;",
      "173:     s->width = avctx->width;",
      "174:     s->height = avctx->height;",
      "175:     avcodec_get_frame_defaults(&s->frames[0]);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "174:     if (avctx->width%16 || avctx->height%16) {",
      "175:          av_log_ask_for_sample(avctx, \"dimensions not being a multiple of 16 are unsupported\\n\");",
      "176:          return AVERROR_PATCHWELCOME;",
      "177:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "38e8f78c041bd28f5b8d32f2fd945eae8ce28598",
      "candidate_info": {
        "commit_hash": "38e8f78c041bd28f5b8d32f2fd945eae8ce28598",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/38e8f78c041bd28f5b8d32f2fd945eae8ce28598",
        "files": [
          "libavcodec/roqvideodec.c"
        ],
        "message": "roqvideodec: check dimensions validity\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3ae610451170cd5a28b33950006ff0bd23036845)",
        "before_after_code_files": [
          "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
          ],
          "candidate": [
            "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c": [
          "File: libavcodec/roqvideodec.c -> libavcodec/roqvideodec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "169:     RoqContext *s = avctx->priv_data;",
          "171:     s->avctx = avctx;",
          "172:     s->width = avctx->width;",
          "173:     s->height = avctx->height;",
          "174:     avcodec_get_frame_defaults(&s->frames[0]);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "173:     if (avctx->width%16 || avctx->height%16) {",
          "174:          av_log_ask_for_sample(avctx, \"dimensions not being a multiple of 16 are unsupported\\n\");",
          "175:          return AVERROR_PATCHWELCOME;",
          "176:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6f6cd7dbe539b64ea2ec25d91cad4880206a16af",
      "candidate_info": {
        "commit_hash": "6f6cd7dbe539b64ea2ec25d91cad4880206a16af",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/6f6cd7dbe539b64ea2ec25d91cad4880206a16af",
        "files": [
          "libavcodec/roqvideodec.c"
        ],
        "message": "roqvideodec: check dimensions validity\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3ae610451170cd5a28b33950006ff0bd23036845)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit fee26d352a52eb9f7fcd8d9167fb4a5ba015b612)\n\nCC: libav-stable@libav.org\n\nSigned-off-by: Reinhard Tartler <siretart@tauware.de>\n(cherry picked from commit 488f87be873506abb01d67708a67c10a4dd29283)\n\nSigned-off-by: Reinhard Tartler <siretart@tauware.de>\n(cherry picked from commit 52b18c1fde65efac7f6e6104b76d39bf8d0a34ee)\nSigned-off-by: Reinhard Tartler <siretart@tauware.de>",
        "before_after_code_files": [
          "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
          ],
          "candidate": [
            "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c": [
          "File: libavcodec/roqvideodec.c -> libavcodec/roqvideodec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "159:     RoqContext *s = avctx->priv_data;",
          "161:     s->avctx = avctx;",
          "162:     s->width = avctx->width;",
          "163:     s->height = avctx->height;",
          "164:     s->last_frame    = &s->frames[0];",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "163:     if (avctx->width % 16 || avctx->height % 16) {",
          "164:         av_log(avctx, AV_LOG_ERROR,",
          "165:                \"Dimensions must be a multiple of 16\\n\");",
          "166:         return AVERROR_PATCHWELCOME;",
          "167:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "391e0fc6c90ced6656b74f50f3a487b6dc76ea63",
      "candidate_info": {
        "commit_hash": "391e0fc6c90ced6656b74f50f3a487b6dc76ea63",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/391e0fc6c90ced6656b74f50f3a487b6dc76ea63",
        "files": [
          "libavcodec/roqvideodec.c"
        ],
        "message": "roqvideodec: check dimensions validity\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3ae610451170cd5a28b33950006ff0bd23036845)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
          ],
          "candidate": [
            "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c": [
          "File: libavcodec/roqvideodec.c -> libavcodec/roqvideodec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "157:     RoqContext *s = avctx->priv_data;",
          "159:     s->avctx = avctx;",
          "160:     s->width = avctx->width;",
          "161:     s->height = avctx->height;",
          "162:     avcodec_get_frame_defaults(&s->frames[0]);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "161:     if (avctx->width%16 || avctx->height%16) {",
          "162:          av_log_ask_for_sample(avctx, \"dimensions not being a multiple of 16 are unsupported\\n\");",
          "163:          return AVERROR_PATCHWELCOME;",
          "164:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fee26d352a52eb9f7fcd8d9167fb4a5ba015b612",
      "candidate_info": {
        "commit_hash": "fee26d352a52eb9f7fcd8d9167fb4a5ba015b612",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/fee26d352a52eb9f7fcd8d9167fb4a5ba015b612",
        "files": [
          "libavcodec/roqvideodec.c"
        ],
        "message": "roqvideodec: check dimensions validity\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3ae610451170cd5a28b33950006ff0bd23036845)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
          ],
          "candidate": [
            "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/roqvideodec.c||libavcodec/roqvideodec.c": [
          "File: libavcodec/roqvideodec.c -> libavcodec/roqvideodec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "158:     RoqContext *s = avctx->priv_data;",
          "160:     s->avctx = avctx;",
          "161:     s->width = avctx->width;",
          "162:     s->height = avctx->height;",
          "163:     s->last_frame    = &s->frames[0];",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "162:     if (avctx->width%16 || avctx->height%16) {",
          "163:          av_log(avctx, AV_LOG_ERROR, \"dimensions not being a multiple of 16 are unsupported\\n\");",
          "164:          return AVERROR_PATCHWELCOME;",
          "165:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}