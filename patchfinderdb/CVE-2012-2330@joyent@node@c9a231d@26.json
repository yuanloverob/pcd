{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "de21de920cf93ec40736ada3792a7f85f3eadeda",
      "candidate_info": {
        "commit_hash": "de21de920cf93ec40736ada3792a7f85f3eadeda",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/de21de920cf93ec40736ada3792a7f85f3eadeda",
        "files": [
          "AUTHORS",
          "ChangeLog",
          "deps/v8/SConstruct",
          "doc/about/index.html",
          "doc/community/index.html",
          "doc/index.html",
          "doc/logos/index.html",
          "doc/template.html",
          "src/node_version.h"
        ],
        "message": "2012.02.14, Version 0.7.4 (unstable)\n\n* Upgrade V8 to 3.9.5\n\n* Upgrade npm to 1.1.1\n\n* build: Detect host_arch better (Karl Skomski)\n\n* debugger: export `debug_port` to `process` (Fedor Indutny)\n\n* api docs: CSS bug fixes (isaacs)\n\n* build: use -fPIC for native addons on UNIX (Nathan Rajlich)\n\n* Re-add top-level v8::Locker (Marcel Laverdet)\n\n* Move images out of the dist tarballs (isaacs)\n\n* libuv: Remove uv_export and uv_import (Ben Noordhuis)\n\n* build: Support x64 build on Windows (Igor Zinkovsky)",
        "before_after_code_files": [
          "src/node_version.h||src/node_version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_version.h||src/node_version.h": [
          "File: src/node_version.h -> src/node_version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #define NODE_MAJOR_VERSION 0",
          "30: #define NODE_MINOR_VERSION 7",
          "31: #define NODE_PATCH_VERSION 4",
          "34: #ifndef NODE_STRINGIFY",
          "35: #define NODE_STRINGIFY(n) NODE_STRINGIFY_HELPER(n)",
          "",
          "[Removed Lines]",
          "32: #define NODE_VERSION_IS_RELEASE 0",
          "",
          "[Added Lines]",
          "32: #define NODE_VERSION_IS_RELEASE 1",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "57d53a47e86c310f99e991ea0afb4a3790a54751",
      "candidate_info": {
        "commit_hash": "57d53a47e86c310f99e991ea0afb4a3790a54751",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/57d53a47e86c310f99e991ea0afb4a3790a54751",
        "files": [
          "lib/buffer.js",
          "test/simple/test-buffer.js"
        ],
        "message": "Use parent SlowBuffer, if any, when Buffer is sliced\n\nCloses #3416\nCloses #3477",
        "before_after_code_files": [
          "lib/buffer.js||libuffer.js",
          "test/simple/test-buffer.js||test/simple/test-buffer.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/buffer.js||libuffer.js": [
          "File: lib/buffer.js -> libuffer.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "212:   if (typeof offset === 'number') {",
          "213:     this.length = coerce(encoding);",
          "215:     this.offset = offset;",
          "216:   } else {",
          "",
          "[Removed Lines]",
          "214:     this.parent = subject;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/simple/test-buffer.js||test/simple/test-buffer.js": [
          "File: test/simple/test-buffer.js -> test/simple/test-buffer.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "724: var b = Buffer('xxx');",
          "725: a.write('aaaaaaaa', 'base64');",
          "726: assert.equal(b.toString(), 'xxx');",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "729: Buffer(Buffer(0), 0, 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9a6012edd9330296b7476bc6b7fbda2cd5c8165d",
      "candidate_info": {
        "commit_hash": "9a6012edd9330296b7476bc6b7fbda2cd5c8165d",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/9a6012edd9330296b7476bc6b7fbda2cd5c8165d",
        "files": [
          "src/node.cc"
        ],
        "message": "Re-add top-level v8::Locker\n\n11d1eca9 added a v8 locker to ease development of 3rd party threading\nextensions but it created a condition which would cause node to exit\nuncleanly while in debug mode; it was reverted in 7543c38d.\n\nThe problem here is that the Locker was being disposed after V8 was torn\ndown. Adding some scoping fixes that.",
        "before_after_code_files": [
          "src/node.cc||src/node.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node.cc||src/node.cc": [
          "File: src/node.cc -> src/node.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "2645:   argv = Init(argc, argv);",
          "2670: #ifndef NDEBUG",
          "2673:   V8::Dispose();",
          "2674: #endif  // NDEBUG",
          "",
          "[Removed Lines]",
          "2647:   v8::V8::Initialize();",
          "2648:   v8::HandleScope handle_scope;",
          "2651:   Persistent<v8::Context> context = v8::Context::New();",
          "2652:   v8::Context::Scope context_scope(context);",
          "2654:   Handle<Object> process_l = SetupProcessObject(argc, argv);",
          "2655:   v8_typed_array::AttachBindings(context->Global());",
          "2659:   Load(process_l);",
          "2666:   uv_run(uv_default_loop());",
          "2668:   EmitExit(process_l);",
          "2672:   context.Dispose();",
          "",
          "[Added Lines]",
          "2647:   V8::Initialize();",
          "2648:   Persistent<Context> context;",
          "2649:   {",
          "2650:     Locker locker;",
          "2651:     HandleScope handle_scope;",
          "2654:     Persistent<Context> context = Context::New();",
          "2655:     Context::Scope context_scope(context);",
          "2657:     Handle<Object> process_l = SetupProcessObject(argc, argv);",
          "2658:     v8_typed_array::AttachBindings(context->Global());",
          "2662:     Load(process_l);",
          "2669:     uv_run(uv_default_loop());",
          "2671:     EmitExit(process_l);",
          "2672: #ifndef NDEBUG",
          "2673:     context.Dispose();",
          "2674: #endif",
          "2675:   }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "08e2e570a7dfb8f89b9731cb04dda5d63882be52",
      "candidate_info": {
        "commit_hash": "08e2e570a7dfb8f89b9731cb04dda5d63882be52",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/08e2e570a7dfb8f89b9731cb04dda5d63882be52",
        "files": [
          "Makefile",
          "tools/changelog-head.sh",
          "tools/email-footer.md"
        ],
        "message": "Make rules for release blog post and email message",
        "before_after_code_files": [
          "tools/changelog-head.sh||tools/changelog-head.sh"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tools/changelog-head.sh||tools/changelog-head.sh": [
          "File: tools/changelog-head.sh -> tools/changelog-head.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: #!/bin/bash",
          "2: cat ChangeLog | {",
          "3:   s=-1",
          "4:   while read line; do",
          "5:     if [ \"${line:0:1}\" == \"2\" ]; then",
          "6:       let \"++s\"",
          "7:     fi",
          "8:     if [ $s -eq 1 ]; then",
          "9:       exit",
          "10:     else",
          "11:       echo \"$line\"",
          "12:     fi",
          "13:   done",
          "14: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "412cebec9e0b10eedf3547a1fde3cf56a9374c99",
      "candidate_info": {
        "commit_hash": "412cebec9e0b10eedf3547a1fde3cf56a9374c99",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/412cebec9e0b10eedf3547a1fde3cf56a9374c99",
        "files": [
          "deps/v8/build/common.gypi"
        ],
        "message": "v8: Remove OutputDirectory from build/common.gypi",
        "before_after_code_files": [
          "deps/v8/build/common.gypi||deps/v8/build/common.gypi"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/v8/build/common.gypi||deps/v8/build/common.gypi": [
          "File: deps/v8/build/common.gypi -> deps/v8/build/common.gypi",
          "--- Hunk 1 ---",
          "[Context before]",
          "352:           }],  # OS==\"mac\"",
          "353:           ['OS==\"win\"', {",
          "354:             'msvs_configuration_attributes': {",
          "356:               'IntermediateDirectory': '$(OutDir)\\\\obj\\\\$(ProjectName)',",
          "357:               'CharacterSet': '1',",
          "358:             },",
          "",
          "[Removed Lines]",
          "355:               'OutputDirectory': '<(DEPTH)\\\\build\\\\$(ConfigurationName)',",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}