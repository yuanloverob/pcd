{
  "cve_id": "CVE-2017-3735",
  "cve_desc": "While parsing an IPAddressFamily extension in an X.509 certificate, it is possible to do a one-byte overread. This would result in an incorrect text display of the certificate. This bug has been present since 2006 and is present in all versions of OpenSSL before 1.0.2m and 1.1.0g.",
  "repo": "openssl/openssl",
  "patch_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
  "patch_info": {
    "commit_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/068b963bb7afc57f5bdd723de0dd15e7795d5822",
    "files": [
      "crypto/x509v3/v3_addr.c"
    ],
    "message": "Avoid out-of-bounds read\n\nFixes CVE 2017-3735\n\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\n(Merged from https://github.com/openssl/openssl/pull/4276)\n\n(cherry picked from commit b23171744b01e473ebbfd6edad70c1c3825ffbcd)",
    "before_after_code_files": [
      "crypto/x509v3/v3_addr.c||crypto/x509v3/v3_addr.c"
    ]
  },
  "patch_diff": {
    "crypto/x509v3/v3_addr.c||crypto/x509v3/v3_addr.c": [
      "File: crypto/x509v3/v3_addr.c -> crypto/x509v3/v3_addr.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "85: unsigned int X509v3_addr_get_afi(const IPAddressFamily *f)",
      "86: {",
      "91: }",
      "",
      "[Removed Lines]",
      "87:     return ((f != NULL &&",
      "88:              f->addressFamily != NULL && f->addressFamily->data != NULL)",
      "89:             ? ((f->addressFamily->data[0] << 8) | (f->addressFamily->data[1]))",
      "90:             : 0);",
      "",
      "[Added Lines]",
      "87:     if (f == NULL",
      "88:             || f->addressFamily == NULL",
      "89:             || f->addressFamily->data == NULL",
      "90:             || f->addressFamily->length < 2)",
      "91:         return 0;",
      "92:     return (f->addressFamily->data[0] << 8) | f->addressFamily->data[1];",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "574496c0537ac12b3e313fbcfe271e5e609388ae",
      "candidate_info": {
        "commit_hash": "574496c0537ac12b3e313fbcfe271e5e609388ae",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/574496c0537ac12b3e313fbcfe271e5e609388ae",
        "files": [
          "crypto/x86_64cpuid.pl"
        ],
        "message": "Fix comment typo.\n\nReviewed-by: Ben Kaduk <kaduk@mit.edu>\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/4023)\n\n(cherry picked from commit d67e755418b62fb451ec221c126c9935a06ea63b)",
        "before_after_code_files": [
          "crypto/x86_64cpuid.pl||crypto/x86_64cpuid.pl"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/x86_64cpuid.pl||crypto/x86_64cpuid.pl": [
          "File: crypto/x86_64cpuid.pl -> crypto/x86_64cpuid.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "197: .Lclear_avx:",
          "198:  mov \\$0xefffe7ff,%eax # ~(1<<28|1<<12|1<<11)",
          "199:  and %eax,%r9d  # clear AVX, FMA and AMD XOP bits",
          "201: .Ldone:",
          "202:  shl \\$32,%r9",
          "203:  mov %r10d,%eax",
          "",
          "[Removed Lines]",
          "200:  andl \\$0xffffffdf,8(%rdi) # cleax AVX2, ~(1<<5)",
          "",
          "[Added Lines]",
          "200:  andl \\$0xffffffdf,8(%rdi) # clear AVX2, ~(1<<5)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "22e311ce2e0d9ac0e1cac60a3ac30fc48cedf1de",
      "candidate_info": {
        "commit_hash": "22e311ce2e0d9ac0e1cac60a3ac30fc48cedf1de",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/22e311ce2e0d9ac0e1cac60a3ac30fc48cedf1de",
        "files": [
          "crypto/asn1/a_bitstr.c"
        ],
        "message": "Fix overflow in c2i_ASN1_BIT_STRING.\n\nc2i_ASN1_BIT_STRING takes length as a long but uses it as an int.  Check\nbounds before doing so. Previously, excessively large inputs to the\nfunction could write a single byte outside the target buffer. (This is\nunreachable as asn1_ex_c2i already uses int for the length.)\n\nThanks to NCC for finding this issue. Fix written by Martin Kreichgauer.\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\nReviewed-by: Andy Polyakov <appro@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/4385)\n\n(cherry picked from commit 6b1c8204b33aaedb7df7a009c241412839aaf950)",
        "before_after_code_files": [
          "crypto/asn1/a_bitstr.c||crypto/asn1/a_bitstr.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/asn1/a_bitstr.c||crypto/asn1/a_bitstr.c": [
          "File: crypto/asn1/a_bitstr.c -> crypto/asn1/a_bitstr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10: #include <stdio.h>",
          "11: #include \"internal/cryptlib.h\"",
          "12: #include <openssl/asn1.h>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: #include <limits.h>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88:         goto err;",
          "89:     }",
          "91:     if ((a == NULL) || ((*a) == NULL)) {",
          "92:         if ((ret = ASN1_BIT_STRING_new()) == NULL)",
          "93:             return (NULL);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "92:     if (len > INT_MAX) {",
          "93:         i = ASN1_R_STRING_TOO_LONG;",
          "94:         goto err;",
          "95:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0aa0e13a6a367dc27bfa59bd2ab1e90645c3158b",
      "candidate_info": {
        "commit_hash": "0aa0e13a6a367dc27bfa59bd2ab1e90645c3158b",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/0aa0e13a6a367dc27bfa59bd2ab1e90645c3158b",
        "files": [
          "test/exptest.c"
        ],
        "message": "Fix typo in comment\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/4903)",
        "before_after_code_files": [
          "test/exptest.c||test/exptest.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/exptest.c||test/exptest.c": [
          "File: test/exptest.c -> test/exptest.c"
        ]
      }
    },
    {
      "candidate_hash": "4bcc6a1f5557ceb1e335d39bac308b9cd64f40cd",
      "candidate_info": {
        "commit_hash": "4bcc6a1f5557ceb1e335d39bac308b9cd64f40cd",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/4bcc6a1f5557ceb1e335d39bac308b9cd64f40cd",
        "files": [
          "crypto/bn/asm/x86.pl"
        ],
        "message": "Remove unused file\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/5267)\n(cherry picked from commit a3a5d1b73db46274e2cdedaad42fda5ce5cfb2da)",
        "before_after_code_files": [
          "crypto/bn/asm/x86.pl||crypto/bn/asm/x86.pl"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/bn/asm/x86.pl||crypto/bn/asm/x86.pl": [
          "File: crypto/bn/asm/x86.pl -> crypto/bn/asm/x86.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1c5a2905c6d04cb69ca47078a4624ce4b6d5d540",
      "candidate_info": {
        "commit_hash": "1c5a2905c6d04cb69ca47078a4624ce4b6d5d540",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/1c5a2905c6d04cb69ca47078a4624ce4b6d5d540",
        "files": [
          "config.com"
        ],
        "message": "VMS config.com: better handling of arguments\n\nMost of all, this change preserves casing a bit better\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/5180)\n\n(cherry picked from commit d4deecc203bf3a7bcc5f31529692f5b668c0c2bc)",
        "before_after_code_files": [
          "config.com||config.com"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "config.com||config.com": [
          "File: config.com -> config.com",
          "--- Hunk 1 ---",
          "[Context before]",
          "73: $  P = \"\"",
          "74: $     ENDIF",
          "75: $     IF P .NES. \"\" THEN -",
          "77: $     P1 = P2",
          "78: $     P2 = P3",
          "79: $     P3 = P4",
          "",
          "[Removed Lines]",
          "76:         collected_args = collected_args + \" \" + P1",
          "",
          "[Added Lines]",
          "76:         collected_args = collected_args + \" \"\"\" + P1 + \"\"\"\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87: $",
          "88: $ target = \"vms-''arch'''pointer_size'\"",
          "89: $       IF verbose THEN -",
          "91: $       IF .not. dryrun THEN -",
          "93: $       EXIT $STATUS",
          "",
          "[Removed Lines]",
          "90:            WRITE SYS$OUTPUT \"PERL ''here'Configure \"\"''target'\"\"''collected_args'\"",
          "92:            PERL 'here'Configure \"''target'\" 'debug' 'collected_args'",
          "",
          "[Added Lines]",
          "90:            WRITE SYS$OUTPUT \"PERL ''here'Configure \"\"''target'\"\"\",collected_args",
          "92:            PERL 'here'Configure \"''target'\"'collected_args'",
          "",
          "---------------"
        ]
      }
    }
  ]
}