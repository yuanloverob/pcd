{
  "cve_id": "CVE-2014-8142",
  "cve_desc": "Use-after-free vulnerability in the process_nested_data function in ext/standard/var_unserializer.re in PHP before 5.4.36, 5.5.x before 5.5.20, and 5.6.x before 5.6.4 allows remote attackers to execute arbitrary code via a crafted unserialize call that leverages improper handling of duplicate keys within the serialized properties of an object, a different vulnerability than CVE-2004-1019.",
  "repo": "php/php-src",
  "patch_hash": "630f9c33c23639de85c3fd306b209b538b73b4c9",
  "patch_info": {
    "commit_hash": "630f9c33c23639de85c3fd306b209b538b73b4c9",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/630f9c33c23639de85c3fd306b209b538b73b4c9",
    "files": [
      "NEWS",
      "ext/standard/tests/serialize/bug68594.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #68594 - Use after free vulnerability in unserialize()",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt": [
      "File: ext/standard/tests/serialize/bug68594.phpt -> ext/standard/tests/serialize/bug68594.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #68545 Use after free vulnerability in unserialize()",
      "3: --FILE--",
      "4: <?php",
      "5: for ($i=4; $i<100; $i++) {",
      "6:  $m = new StdClass();",
      "8:  $u = array(1);",
      "10:  $m->aaa = array(1,2,&$u,4,5);",
      "11:  $m->bbb = 1;",
      "12:  $m->ccc = &$u;",
      "13:  $m->ddd = str_repeat(\"A\", $i);",
      "15:  $z = serialize($m);",
      "16:  $z = str_replace(\"bbb\", \"aaa\", $z);",
      "17:  $y = unserialize($z);",
      "18:  $z = serialize($y);",
      "19: }",
      "20: ?>",
      "21: ===DONE===",
      "22: --EXPECTF--",
      "23: ===DONE===",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "343:   } else {",
      "345:    convert_to_string(key);",
      "346:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
      "347:      sizeof data, NULL);",
      "348:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "346:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
      "347:     var_push_dtor(var_hash, old_data);",
      "348:    }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "484: {",
      "485:  YYCTYPE yych;",
      "486:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "483: #line 484 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "486: #line 487 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "540:  yych = *(YYMARKER = ++YYCURSOR);",
      "541:  if (yych == ':') goto yy95;",
      "542: yy3:",
      "544:  { return 0; }",
      "546: yy4:",
      "547:  yych = *(YYMARKER = ++YYCURSOR);",
      "548:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "543: #line 835 \"ext/standard/var_unserializer.re\"",
      "545: #line 546 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "546: #line 838 \"ext/standard/var_unserializer.re\"",
      "548: #line 549 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "585:  goto yy3;",
      "586: yy14:",
      "587:  ++YYCURSOR;",
      "589:  {",
      "591:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "593: }",
      "595: yy16:",
      "596:  yych = *++YYCURSOR;",
      "597:  goto yy3;",
      "",
      "[Removed Lines]",
      "588: #line 829 \"ext/standard/var_unserializer.re\"",
      "594: #line 595 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "591: #line 832 \"ext/standard/var_unserializer.re\"",
      "597: #line 598 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "617:  if (yybm[0+yych] & 128) {",
      "618:   goto yy20;",
      "619:  }",
      "621:  yych = *++YYCURSOR;",
      "622:  if (yych != '\"') goto yy18;",
      "623:  ++YYCURSOR;",
      "625:  {",
      "626:  size_t len, len2, len3, maxlen;",
      "627:  long elements;",
      "",
      "[Removed Lines]",
      "620:  if (yych != ':') goto yy18;",
      "624: #line 683 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "623:  if (yych <= '/') goto yy18;",
      "624:  if (yych >= ';') goto yy18;",
      "628: #line 686 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "768:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "769: }",
      "771: yy25:",
      "772:  yych = *++YYCURSOR;",
      "773:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "770: #line 771 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "774: #line 775 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "792:  yych = *++YYCURSOR;",
      "793:  if (yych != '\"') goto yy18;",
      "794:  ++YYCURSOR;",
      "796:  {",
      "798:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "795: #line 675 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "799: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "800:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "801:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "802: }",
      "804: yy32:",
      "805:  yych = *++YYCURSOR;",
      "806:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "803: #line 804 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "807: #line 808 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "821:  yych = *++YYCURSOR;",
      "822:  if (yych != '{') goto yy18;",
      "823:  ++YYCURSOR;",
      "825:  {",
      "826:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "824: #line 655 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "828: #line 658 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "842:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "843: }",
      "845: yy39:",
      "846:  yych = *++YYCURSOR;",
      "847:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "844: #line 845 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "848: #line 849 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "862:  yych = *++YYCURSOR;",
      "863:  if (yych != '\"') goto yy18;",
      "864:  ++YYCURSOR;",
      "866:  {",
      "867:  size_t len, maxlen;",
      "868:  char *str;",
      "",
      "[Removed Lines]",
      "865: #line 626 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "869: #line 629 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "891:  ZVAL_STRINGL(*rval, str, len, 0);",
      "892:  return 1;",
      "893: }",
      "895: yy46:",
      "896:  yych = *++YYCURSOR;",
      "897:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "894: #line 895 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "898: #line 899 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "912:  yych = *++YYCURSOR;",
      "913:  if (yych != '\"') goto yy18;",
      "914:  ++YYCURSOR;",
      "916:  {",
      "917:  size_t len, maxlen;",
      "918:  char *str;",
      "",
      "[Removed Lines]",
      "915: #line 598 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "919: #line 601 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "940:  ZVAL_STRINGL(*rval, str, len, 1);",
      "941:  return 1;",
      "942: }",
      "944: yy53:",
      "945:  yych = *++YYCURSOR;",
      "946:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "943: #line 944 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "947: #line 948 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1028:  }",
      "1029: yy63:",
      "1030:  ++YYCURSOR;",
      "1032:  {",
      "1033: #if SIZEOF_LONG == 4",
      "1034: use_double:",
      "",
      "[Removed Lines]",
      "1031: #line 588 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1035: #line 591 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1038:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1039:  return 1;",
      "1040: }",
      "1042: yy65:",
      "1043:  yych = *++YYCURSOR;",
      "1044:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1041: #line 1042 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1097:  yych = *++YYCURSOR;",
      "1098:  if (yych != ';') goto yy18;",
      "1099:  ++YYCURSOR;",
      "1101:  {",
      "1103:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1100: #line 573 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1104: #line 576 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1113:  return 1;",
      "1114: }",
      "1116: yy76:",
      "1117:  yych = *++YYCURSOR;",
      "1118:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1115: #line 1116 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1119: #line 1120 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1139:  if (yych <= '9') goto yy79;",
      "1140:  if (yych != ';') goto yy18;",
      "1141:  ++YYCURSOR;",
      "1143:  {",
      "1144: #if SIZEOF_LONG == 4",
      "1145:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1142: #line 546 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1146: #line 549 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1166:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1167:  return 1;",
      "1168: }",
      "1170: yy83:",
      "1171:  yych = *++YYCURSOR;",
      "1172:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1169: #line 1170 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1173: #line 1174 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1174:  yych = *++YYCURSOR;",
      "1175:  if (yych != ';') goto yy18;",
      "1176:  ++YYCURSOR;",
      "1178:  {",
      "1180:  INIT_PZVAL(*rval);",
      "1181:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1182:  return 1;",
      "1183: }",
      "1185: yy87:",
      "1186:  ++YYCURSOR;",
      "1188:  {",
      "1190:  INIT_PZVAL(*rval);",
      "1191:  ZVAL_NULL(*rval);",
      "1192:  return 1;",
      "1193: }",
      "1195: yy89:",
      "1196:  yych = *++YYCURSOR;",
      "1197:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1177: #line 539 \"ext/standard/var_unserializer.re\"",
      "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
      "1187: #line 532 \"ext/standard/var_unserializer.re\"",
      "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1181: #line 542 \"ext/standard/var_unserializer.re\"",
      "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
      "1191: #line 535 \"ext/standard/var_unserializer.re\"",
      "1198: #line 1199 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1214:  if (yych <= '9') goto yy91;",
      "1215:  if (yych != ';') goto yy18;",
      "1216:  ++YYCURSOR;",
      "1218:  {",
      "1219:  long id;",
      "",
      "[Removed Lines]",
      "1217: #line 509 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1221: #line 512 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1238:  return 1;",
      "1239: }",
      "1241: yy95:",
      "1242:  yych = *++YYCURSOR;",
      "1243:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1240: #line 1241 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1260:  if (yych <= '9') goto yy97;",
      "1261:  if (yych != ';') goto yy18;",
      "1262:  ++YYCURSOR;",
      "1264:  {",
      "1265:  long id;",
      "",
      "[Removed Lines]",
      "1263: #line 488 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1267: #line 491 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1282:  return 1;",
      "1283: }",
      "1285: }",
      "1289:  return 0;",
      "",
      "[Removed Lines]",
      "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
      "1286: #line 837 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1288: #line 1289 \"ext/standard/var_unserializer.c\"",
      "1290: #line 840 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "347:   } else {",
      "349:    convert_to_string(key);",
      "350:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
      "351:      sizeof data, NULL);",
      "352:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "350:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
      "351:     var_push_dtor(var_hash, old_data);",
      "352:    }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e8429400d40e3c3aa4b22ba701991d698a2f3b2f",
      "candidate_info": {
        "commit_hash": "e8429400d40e3c3aa4b22ba701991d698a2f3b2f",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/e8429400d40e3c3aa4b22ba701991d698a2f3b2f",
        "files": [
          "ext/standard/tests/serialize/bug70172.phpt",
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fix bug #70172 - Use After Free Vulnerability in unserialize()",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70172.phpt||ext/standard/tests/serialize/bug70172.phpt",
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70172.phpt||ext/standard/tests/serialize/bug70172.phpt": [
          "File: ext/standard/tests/serialize/bug70172.phpt -> ext/standard/tests/serialize/bug70172.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70172 - Use After Free Vulnerability in unserialize()",
          "3: --FILE--",
          "4: <?php",
          "5: class obj implements Serializable {",
          "6:  var $data;",
          "7:  function serialize() {",
          "8:   return serialize($this->data);",
          "9:  }",
          "10:  function unserialize($data) {",
          "11:   $this->data = unserialize($data);",
          "12:  }",
          "13: }",
          "15: $fakezval = ptr2str(1122334455);",
          "16: $fakezval .= ptr2str(0);",
          "17: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "18: $fakezval .= \"\\x01\";",
          "19: $fakezval .= \"\\x00\";",
          "20: $fakezval .= \"\\x00\\x00\";",
          "22: $inner = 'r:2;';",
          "23: $exploit = 'a:2:{i:0;i:1;i:1;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}}';",
          "25: $data = unserialize($exploit);",
          "27: for ($i = 0; $i < 5; $i++) {",
          "28:  $v[$i] = $fakezval.$i;",
          "29: }",
          "31: var_dump($data);",
          "33: function ptr2str($ptr)",
          "34: {",
          "35:  $out = '';",
          "36:  for ($i = 0; $i < 8; $i++) {",
          "37:   $out .= chr($ptr & 0xff);",
          "38:   $ptr >>= 8;",
          "39:  }",
          "40:  return $out;",
          "41: }",
          "42: ?>",
          "43: --EXPECTF--",
          "44: array(2) {",
          "45:   [0]=>",
          "46:   int(1)",
          "47:   [1]=>",
          "48:   object(obj)#%d (1) {",
          "49:     [\"data\"]=>",
          "50:     int(1)",
          "51:   }",
          "52: }",
          "",
          "---------------"
        ],
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "951:  int buf_len;",
          "952:  const unsigned char *p;",
          "953:  php_unserialize_data_t var_hash;",
          "955:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &buf, &buf_len) == FAILURE) {",
          "956:   RETURN_FALSE;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "954:  int oldlevel;",
          "955:  zval *old_rval = return_value;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "970:   }",
          "971:   RETURN_FALSE;",
          "972:  }",
          "973:  PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "974: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "975:  if (return_value != old_rval) {",
          "980:   zval_dtor(old_rval);",
          "982:   zval_copy_ctor(old_rval);",
          "983:   var_push_dtor_no_addref(&var_hash, &return_value);",
          "984:   var_push_dtor_no_addref(&var_hash, &old_rval);",
          "985:  } else {",
          "986:   var_push_dtor(&var_hash, &return_value);",
          "987:  }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "70:  var_hash = (*var_hashx)->last_dtor;",
          "71: #if VAR_ENTRIES_DBG",
          "73: #endif",
          "75:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "72:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "[Added Lines]",
          "72:  fprintf(stderr, \"var_push_dtor(%p, %ld): %d\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "101:     var_hash = (*var_hashx)->last_dtor;",
          "102: #if VAR_ENTRIES_DBG",
          "104: #endif",
          "106:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "103:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "[Added Lines]",
          "103:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "180:  while (var_hash) {",
          "181:   for (i = 0; i < var_hash->used_slots; i++) {",
          "182:    zval_ptr_dtor(&var_hash->data[i]);",
          "183:   }",
          "184:   next = var_hash->next;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "182: #if VAR_ENTRIES_DBG",
          "183:     fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_hash->data[i], Z_REFCOUNT_P(var_hash->data[i]));",
          "184: #endif",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "239: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "242: #line 247 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "245: #line 250 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "488: {",
          "489:  YYCTYPE yych;",
          "490:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "487: #line 488 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "490: #line 491 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "544:  yych = *(YYMARKER = ++YYCURSOR);",
          "545:  if (yych == ':') goto yy95;",
          "546: yy3:",
          "548:  { return 0; }",
          "550: yy4:",
          "551:  yych = *(YYMARKER = ++YYCURSOR);",
          "552:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "547: #line 839 \"ext/standard/var_unserializer.re\"",
          "549: #line 550 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "550: #line 845 \"ext/standard/var_unserializer.re\"",
          "552: #line 553 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "589:  goto yy3;",
          "590: yy14:",
          "591:  ++YYCURSOR;",
          "593:  {",
          "595:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "597: }",
          "599: yy16:",
          "600:  yych = *++YYCURSOR;",
          "601:  goto yy3;",
          "",
          "[Removed Lines]",
          "592: #line 833 \"ext/standard/var_unserializer.re\"",
          "598: #line 599 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "595: #line 839 \"ext/standard/var_unserializer.re\"",
          "601: #line 602 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "626:  yych = *++YYCURSOR;",
          "627:  if (yych != '\"') goto yy18;",
          "628:  ++YYCURSOR;",
          "630:  {",
          "631:  size_t len, len2, len3, maxlen;",
          "632:  long elements;",
          "",
          "[Removed Lines]",
          "629: #line 687 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "632: #line 692 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "642:  zval **args[1];",
          "643:  zval *arg_func_name;",
          "645:  if (*start == 'C') {",
          "646:   custom_object = 1;",
          "647:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "648:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "773:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "774: }",
          "776: yy25:",
          "777:  yych = *++YYCURSOR;",
          "778:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "775: #line 776 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "779: #line 780 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "797:  yych = *++YYCURSOR;",
          "798:  if (yych != '\"') goto yy18;",
          "799:  ++YYCURSOR;",
          "801:  {",
          "803:  INIT_PZVAL(*rval);",
          "805:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "806:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "807: }",
          "809: yy32:",
          "810:  yych = *++YYCURSOR;",
          "811:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "800: #line 679 \"ext/standard/var_unserializer.re\"",
          "808: #line 809 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "804: #line 683 \"ext/standard/var_unserializer.re\"",
          "806:     if (!var_hash) return 0;",
          "813: #line 814 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "826:  yych = *++YYCURSOR;",
          "827:  if (yych != '{') goto yy18;",
          "828:  ++YYCURSOR;",
          "830:  {",
          "831:  long elements = parse_iv(start + 2);",
          "835:  if (elements < 0) {",
          "836:   return 0;",
          "",
          "[Removed Lines]",
          "829: #line 659 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "834: #line 662 \"ext/standard/var_unserializer.re\"",
          "839:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "847:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "848: }",
          "850: yy39:",
          "851:  yych = *++YYCURSOR;",
          "852:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "849: #line 850 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "855: #line 856 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "867:  yych = *++YYCURSOR;",
          "868:  if (yych != '\"') goto yy18;",
          "869:  ++YYCURSOR;",
          "871:  {",
          "872:  size_t len, maxlen;",
          "873:  char *str;",
          "",
          "[Removed Lines]",
          "870: #line 630 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "876: #line 633 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "896:  ZVAL_STRINGL(*rval, str, len, 0);",
          "897:  return 1;",
          "898: }",
          "900: yy46:",
          "901:  yych = *++YYCURSOR;",
          "902:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "899: #line 900 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "905: #line 906 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "917:  yych = *++YYCURSOR;",
          "918:  if (yych != '\"') goto yy18;",
          "919:  ++YYCURSOR;",
          "921:  {",
          "922:  size_t len, maxlen;",
          "923:  char *str;",
          "",
          "[Removed Lines]",
          "920: #line 602 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "926: #line 605 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "945:  ZVAL_STRINGL(*rval, str, len, 1);",
          "946:  return 1;",
          "947: }",
          "949: yy53:",
          "950:  yych = *++YYCURSOR;",
          "951:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "948: #line 949 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "954: #line 955 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1033:  }",
          "1034: yy63:",
          "1035:  ++YYCURSOR;",
          "1037:  {",
          "1038: #if SIZEOF_LONG == 4",
          "1039: use_double:",
          "",
          "[Removed Lines]",
          "1036: #line 592 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1042: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1043:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1044:  return 1;",
          "1045: }",
          "1047: yy65:",
          "1048:  yych = *++YYCURSOR;",
          "1049:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1046: #line 1047 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1052: #line 1053 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1102:  yych = *++YYCURSOR;",
          "1103:  if (yych != ';') goto yy18;",
          "1104:  ++YYCURSOR;",
          "1106:  {",
          "1108:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1105: #line 577 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1111: #line 580 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1118:  return 1;",
          "1119: }",
          "1121: yy76:",
          "1122:  yych = *++YYCURSOR;",
          "1123:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1120: #line 1121 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1126: #line 1127 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1144:  if (yych <= '9') goto yy79;",
          "1145:  if (yych != ';') goto yy18;",
          "1146:  ++YYCURSOR;",
          "1148:  {",
          "1149: #if SIZEOF_LONG == 4",
          "1150:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1147: #line 550 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1153: #line 553 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1171:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1172:  return 1;",
          "1173: }",
          "1175: yy83:",
          "1176:  yych = *++YYCURSOR;",
          "1177:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1174: #line 1175 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1180: #line 1181 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1179:  yych = *++YYCURSOR;",
          "1180:  if (yych != ';') goto yy18;",
          "1181:  ++YYCURSOR;",
          "1183:  {",
          "1185:  INIT_PZVAL(*rval);",
          "1186:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1187:  return 1;",
          "1188: }",
          "1190: yy87:",
          "1191:  ++YYCURSOR;",
          "1193:  {",
          "1195:  INIT_PZVAL(*rval);",
          "1196:  ZVAL_NULL(*rval);",
          "1197:  return 1;",
          "1198: }",
          "1200: yy89:",
          "1201:  yych = *++YYCURSOR;",
          "1202:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1182: #line 543 \"ext/standard/var_unserializer.re\"",
          "1189: #line 1190 \"ext/standard/var_unserializer.c\"",
          "1192: #line 536 \"ext/standard/var_unserializer.re\"",
          "1199: #line 1200 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1188: #line 546 \"ext/standard/var_unserializer.re\"",
          "1195: #line 1196 \"ext/standard/var_unserializer.c\"",
          "1198: #line 539 \"ext/standard/var_unserializer.re\"",
          "1205: #line 1206 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1219:  if (yych <= '9') goto yy91;",
          "1220:  if (yych != ';') goto yy18;",
          "1221:  ++YYCURSOR;",
          "1223:  {",
          "1224:  long id;",
          "",
          "[Removed Lines]",
          "1222: #line 513 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1228: #line 516 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1243:  return 1;",
          "1244: }",
          "1246: yy95:",
          "1247:  yych = *++YYCURSOR;",
          "1248:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1245: #line 1246 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1251: #line 1252 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1265:  if (yych <= '9') goto yy97;",
          "1266:  if (yych != ';') goto yy18;",
          "1267:  ++YYCURSOR;",
          "1269:  {",
          "1270:  long id;",
          "",
          "[Removed Lines]",
          "1268: #line 492 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1274: #line 495 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1278:  }",
          "1280:  if (*rval != NULL) {",
          "1282:  }",
          "1284:  Z_ADDREF_PP(rval);",
          "",
          "[Removed Lines]",
          "1281:   zval_ptr_dtor(rval);",
          "",
          "[Added Lines]",
          "1287:   var_push_dtor_no_addref(var_hash, rval);",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1287:  return 1;",
          "1288: }",
          "1290: }",
          "1294:  return 0;",
          "",
          "[Removed Lines]",
          "1289: #line 1290 \"ext/standard/var_unserializer.c\"",
          "1291: #line 841 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1295: #line 1296 \"ext/standard/var_unserializer.c\"",
          "1297: #line 847 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "68:  var_hash = (*var_hashx)->last_dtor;",
          "69: #if VAR_ENTRIES_DBG",
          "71: #endif",
          "73:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "70:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "[Added Lines]",
          "70:  fprintf(stderr, \"var_push_dtor(%p, %ld): %d\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "99:     var_hash = (*var_hashx)->last_dtor;",
          "100: #if VAR_ENTRIES_DBG",
          "102: #endif",
          "104:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "101:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "[Added Lines]",
          "101:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "178:  while (var_hash) {",
          "179:   for (i = 0; i < var_hash->used_slots; i++) {",
          "180:    zval_ptr_dtor(&var_hash->data[i]);",
          "181:   }",
          "182:   next = var_hash->next;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "180: #if VAR_ENTRIES_DBG",
          "181:     fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_hash->data[i], Z_REFCOUNT_P(var_hash->data[i]));",
          "182: #endif",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "501:  }",
          "503:  if (*rval != NULL) {",
          "505:  }",
          "507:  Z_ADDREF_PP(rval);",
          "",
          "[Removed Lines]",
          "504:   zval_ptr_dtor(rval);",
          "",
          "[Added Lines]",
          "507:   var_push_dtor_no_addref(var_hash, rval);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "660:  long elements = parse_iv(start + 2);",
          "664:  if (elements < 0) {",
          "665:   return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "666:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "677: }",
          "679: \"o:\" iv \":\" [\"] {",
          "681:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "684:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "699:  zval **args[1];",
          "700:  zval *arg_func_name;",
          "702:  if (*start == 'C') {",
          "703:   custom_object = 1;",
          "704:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "707:     if (!var_hash) return 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "caebb76131ffce8ef7d8086f4eff2726c93d329f",
      "candidate_info": {
        "commit_hash": "caebb76131ffce8ef7d8086f4eff2726c93d329f",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/caebb76131ffce8ef7d8086f4eff2726c93d329f",
        "files": [
          "NEWS",
          "ext/standard/tests/serialize/bug69139.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #69139 (Crash in gc_zval_possible_root on unserialize)",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug69139.phpt||ext/standard/tests/serialize/bug69139.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug69139.phpt||ext/standard/tests/serialize/bug69139.phpt": [
          "File: ext/standard/tests/serialize/bug69139.phpt -> ext/standard/tests/serialize/bug69139.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #69139 (Crash in gc_zval_possible_root on unserialize)",
          "3: --FILE--",
          "4: <?php",
          "5: $str = 'a:1126666:{i:0;r:1;i:-09610;r:1;i:-0;i:0;i:0;O:1:\"A\":2119X:i:0;i:0;i:0;i:0;i:0;O:1:\"A\":2116:{i:0;r:5;i:-096766610;r:1;i:-610;r:1;i:0;i:0;';",
          "6: @unserialize($str);",
          "7: echo \"Alive\";",
          "8: ?>",
          "9: --EXPECT--",
          "10: Alive",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "320:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "321:    zval_dtor(key);",
          "322:    FREE_ZVAL(key);",
          "325:    return 0;",
          "326:   }",
          "",
          "[Removed Lines]",
          "323:    zval_dtor(data);",
          "324:    FREE_ZVAL(data);",
          "",
          "[Added Lines]",
          "323:    zval_ptr_dtor(&data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "487: {",
          "488:  YYCTYPE yych;",
          "489:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "486: #line 487 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "485: #line 486 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "543:  yych = *(YYMARKER = ++YYCURSOR);",
          "544:  if (yych == ':') goto yy95;",
          "545: yy3:",
          "547:  { return 0; }",
          "549: yy4:",
          "550:  yych = *(YYMARKER = ++YYCURSOR);",
          "551:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "546: #line 838 \"ext/standard/var_unserializer.re\"",
          "548: #line 549 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "545: #line 837 \"ext/standard/var_unserializer.re\"",
          "547: #line 548 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "588:  goto yy3;",
          "589: yy14:",
          "590:  ++YYCURSOR;",
          "592:  {",
          "594:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "596: }",
          "598: yy16:",
          "599:  yych = *++YYCURSOR;",
          "600:  goto yy3;",
          "",
          "[Removed Lines]",
          "591: #line 832 \"ext/standard/var_unserializer.re\"",
          "597: #line 598 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "590: #line 831 \"ext/standard/var_unserializer.re\"",
          "596: #line 597 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "620:  if (yybm[0+yych] & 128) {",
          "621:   goto yy20;",
          "622:  }",
          "625:  yych = *++YYCURSOR;",
          "626:  if (yych != '\"') goto yy18;",
          "627:  ++YYCURSOR;",
          "629:  {",
          "630:  size_t len, len2, len3, maxlen;",
          "631:  long elements;",
          "",
          "[Removed Lines]",
          "623:  if (yych <= '/') goto yy18;",
          "624:  if (yych >= ';') goto yy18;",
          "628: #line 686 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "622:  if (yych != ':') goto yy18;",
          "626: #line 685 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "772:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "773: }",
          "775: yy25:",
          "776:  yych = *++YYCURSOR;",
          "777:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "774: #line 775 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "772: #line 773 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych != '\"') goto yy18;",
          "798:  ++YYCURSOR;",
          "800:  {",
          "802:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "799: #line 678 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "797: #line 677 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "804:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "805:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "806: }",
          "808: yy32:",
          "809:  yych = *++YYCURSOR;",
          "810:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "807: #line 808 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "805: #line 806 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "825:  yych = *++YYCURSOR;",
          "826:  if (yych != '{') goto yy18;",
          "827:  ++YYCURSOR;",
          "829:  {",
          "830:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "828: #line 658 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "826: #line 657 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "846:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "847: }",
          "849: yy39:",
          "850:  yych = *++YYCURSOR;",
          "851:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "848: #line 849 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "846: #line 847 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "866:  yych = *++YYCURSOR;",
          "867:  if (yych != '\"') goto yy18;",
          "868:  ++YYCURSOR;",
          "870:  {",
          "871:  size_t len, maxlen;",
          "872:  char *str;",
          "",
          "[Removed Lines]",
          "869: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "867: #line 628 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "895:  ZVAL_STRINGL(*rval, str, len, 0);",
          "896:  return 1;",
          "897: }",
          "899: yy46:",
          "900:  yych = *++YYCURSOR;",
          "901:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "898: #line 899 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "896: #line 897 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "916:  yych = *++YYCURSOR;",
          "917:  if (yych != '\"') goto yy18;",
          "918:  ++YYCURSOR;",
          "920:  {",
          "921:  size_t len, maxlen;",
          "922:  char *str;",
          "",
          "[Removed Lines]",
          "919: #line 601 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "917: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "944:  ZVAL_STRINGL(*rval, str, len, 1);",
          "945:  return 1;",
          "946: }",
          "948: yy53:",
          "949:  yych = *++YYCURSOR;",
          "950:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "947: #line 948 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "945: #line 946 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1032:  }",
          "1033: yy63:",
          "1034:  ++YYCURSOR;",
          "1036:  {",
          "1037: #if SIZEOF_LONG == 4",
          "1038: use_double:",
          "",
          "[Removed Lines]",
          "1035: #line 591 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1033: #line 590 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1042:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1043:  return 1;",
          "1044: }",
          "1046: yy65:",
          "1047:  yych = *++YYCURSOR;",
          "1048:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1043: #line 1044 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1101:  yych = *++YYCURSOR;",
          "1102:  if (yych != ';') goto yy18;",
          "1103:  ++YYCURSOR;",
          "1105:  {",
          "1107:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1104: #line 576 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1102: #line 575 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1117:  return 1;",
          "1118: }",
          "1120: yy76:",
          "1121:  yych = *++YYCURSOR;",
          "1122:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1119: #line 1120 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1117: #line 1118 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1143:  if (yych <= '9') goto yy79;",
          "1144:  if (yych != ';') goto yy18;",
          "1145:  ++YYCURSOR;",
          "1147:  {",
          "1148: #if SIZEOF_LONG == 4",
          "1149:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1146: #line 549 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1144: #line 548 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1170:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1171:  return 1;",
          "1172: }",
          "1174: yy83:",
          "1175:  yych = *++YYCURSOR;",
          "1176:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1173: #line 1174 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1171: #line 1172 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1178:  yych = *++YYCURSOR;",
          "1179:  if (yych != ';') goto yy18;",
          "1180:  ++YYCURSOR;",
          "1182:  {",
          "1184:  INIT_PZVAL(*rval);",
          "1185:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1186:  return 1;",
          "1187: }",
          "1189: yy87:",
          "1190:  ++YYCURSOR;",
          "1192:  {",
          "1194:  INIT_PZVAL(*rval);",
          "1195:  ZVAL_NULL(*rval);",
          "1196:  return 1;",
          "1197: }",
          "1199: yy89:",
          "1200:  yych = *++YYCURSOR;",
          "1201:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1181: #line 542 \"ext/standard/var_unserializer.re\"",
          "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
          "1191: #line 535 \"ext/standard/var_unserializer.re\"",
          "1198: #line 1199 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1179: #line 541 \"ext/standard/var_unserializer.re\"",
          "1186: #line 1187 \"ext/standard/var_unserializer.c\"",
          "1189: #line 534 \"ext/standard/var_unserializer.re\"",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1218:  if (yych <= '9') goto yy91;",
          "1219:  if (yych != ';') goto yy18;",
          "1220:  ++YYCURSOR;",
          "1222:  {",
          "1223:  long id;",
          "",
          "[Removed Lines]",
          "1221: #line 512 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1219: #line 511 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1242:  return 1;",
          "1243: }",
          "1245: yy95:",
          "1246:  yych = *++YYCURSOR;",
          "1247:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1242: #line 1243 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1264:  if (yych <= '9') goto yy97;",
          "1265:  if (yych != ';') goto yy18;",
          "1266:  ++YYCURSOR;",
          "1268:  {",
          "1269:  long id;",
          "",
          "[Removed Lines]",
          "1267: #line 491 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1265: #line 490 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1286:  return 1;",
          "1287: }",
          "1289: }",
          "1293:  return 0;",
          "",
          "[Removed Lines]",
          "1288: #line 1289 \"ext/standard/var_unserializer.c\"",
          "1290: #line 840 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1286: #line 1287 \"ext/standard/var_unserializer.c\"",
          "1288: #line 839 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "324:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "325:    zval_dtor(key);",
          "326:    FREE_ZVAL(key);",
          "329:    return 0;",
          "330:   }",
          "",
          "[Removed Lines]",
          "327:    zval_dtor(data);",
          "328:    FREE_ZVAL(data);",
          "",
          "[Added Lines]",
          "327:    zval_ptr_dtor(&data);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "73a69c9c03587dfa1dcfb488e27f5bb42218ed4f",
      "candidate_info": {
        "commit_hash": "73a69c9c03587dfa1dcfb488e27f5bb42218ed4f",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/73a69c9c03587dfa1dcfb488e27f5bb42218ed4f",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed typo",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "470: {",
          "471:  zval retval;",
          "472:  zval fname;",
          "475:  if (Z_TYPE_P(rval) != IS_OBJECT) {",
          "476:   return 0;",
          "477:  }",
          "479:  zend_hash_resize(ht, zend_hash_num_elements(ht) + elements);",
          "480:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "481:   return 0;",
          "",
          "[Removed Lines]",
          "473:  HashTable *ht = Z_OBJPROP_P(rval);",
          "",
          "[Added Lines]",
          "473:  HashTable *ht;",
          "479:  ht = Z_OBJPROP_P(rval);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "529:  start = cursor;",
          "533: {",
          "534:  YYCTYPE yych;",
          "535:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "532: #line 533 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "533: #line 534 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "589:  yych = *(YYMARKER = ++YYCURSOR);",
          "590:  if (yych == ':') goto yy95;",
          "591: yy3:",
          "593:  { return 0; }",
          "595: yy4:",
          "596:  yych = *(YYMARKER = ++YYCURSOR);",
          "597:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "592: #line 880 \"ext/standard/var_unserializer.re\"",
          "594: #line 595 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "593: #line 881 \"ext/standard/var_unserializer.re\"",
          "595: #line 596 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "634:  goto yy3;",
          "635: yy14:",
          "636:  ++YYCURSOR;",
          "638:  {",
          "640:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "642: }",
          "644: yy16:",
          "645:  yych = *++YYCURSOR;",
          "646:  goto yy3;",
          "",
          "[Removed Lines]",
          "637: #line 874 \"ext/standard/var_unserializer.re\"",
          "643: #line 644 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "638: #line 875 \"ext/standard/var_unserializer.re\"",
          "644: #line 645 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "670:  yych = *++YYCURSOR;",
          "671:  if (yych != '\"') goto yy18;",
          "672:  ++YYCURSOR;",
          "674:  {",
          "675:  size_t len, len2, len3, maxlen;",
          "676:  zend_long elements;",
          "",
          "[Removed Lines]",
          "673: #line 729 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "674: #line 730 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "816:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "817: }",
          "819: yy25:",
          "820:  yych = *++YYCURSOR;",
          "821:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "818: #line 819 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "819: #line 820 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "840:  yych = *++YYCURSOR;",
          "841:  if (yych != '\"') goto yy18;",
          "842:  ++YYCURSOR;",
          "844:  {",
          "",
          "[Removed Lines]",
          "843: #line 721 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "844: #line 722 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "848:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "849:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "850: }",
          "852: yy32:",
          "853:  yych = *++YYCURSOR;",
          "854:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "851: #line 852 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "852: #line 853 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "869:  yych = *++YYCURSOR;",
          "870:  if (yych != '{') goto yy18;",
          "871:  ++YYCURSOR;",
          "873:  {",
          "874:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "872: #line 700 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "873: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "891:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "892: }",
          "894: yy39:",
          "895:  yych = *++YYCURSOR;",
          "896:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "893: #line 894 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "894: #line 895 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "911:  yych = *++YYCURSOR;",
          "912:  if (yych != '\"') goto yy18;",
          "913:  ++YYCURSOR;",
          "915:  {",
          "916:  size_t len, maxlen;",
          "917:  zend_string *str;",
          "",
          "[Removed Lines]",
          "914: #line 672 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "915: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "939:  ZVAL_STR(rval, str);",
          "940:  return 1;",
          "941: }",
          "943: yy46:",
          "944:  yych = *++YYCURSOR;",
          "945:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "942: #line 943 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "943: #line 944 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "960:  yych = *++YYCURSOR;",
          "961:  if (yych != '\"') goto yy18;",
          "962:  ++YYCURSOR;",
          "964:  {",
          "965:  size_t len, maxlen;",
          "966:  char *str;",
          "",
          "[Removed Lines]",
          "963: #line 645 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "964: #line 646 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "987:  ZVAL_STRINGL(rval, str, len);",
          "988:  return 1;",
          "989: }",
          "991: yy53:",
          "992:  yych = *++YYCURSOR;",
          "993:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "990: #line 991 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "991: #line 992 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1075:  }",
          "1076: yy63:",
          "1077:  ++YYCURSOR;",
          "1079:  {",
          "1080: #if SIZEOF_ZEND_LONG == 4",
          "1081: use_double:",
          "",
          "[Removed Lines]",
          "1078: #line 636 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1079: #line 637 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1084:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1085:  return 1;",
          "1086: }",
          "1088: yy65:",
          "1089:  yych = *++YYCURSOR;",
          "1090:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1087: #line 1088 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1088: #line 1089 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1143:  yych = *++YYCURSOR;",
          "1144:  if (yych != ';') goto yy18;",
          "1145:  ++YYCURSOR;",
          "1147:  {",
          "",
          "[Removed Lines]",
          "1146: #line 620 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1147: #line 621 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1160:  return 1;",
          "1161: }",
          "1163: yy76:",
          "1164:  yych = *++YYCURSOR;",
          "1165:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1162: #line 1163 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1163: #line 1164 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1186:  if (yych <= '9') goto yy79;",
          "1187:  if (yych != ';') goto yy18;",
          "1188:  ++YYCURSOR;",
          "1190:  {",
          "1191: #if SIZEOF_ZEND_LONG == 4",
          "1192:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1189: #line 594 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1190: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1212:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1213:  return 1;",
          "1214: }",
          "1216: yy83:",
          "1217:  yych = *++YYCURSOR;",
          "1218:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1215: #line 1216 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1220:  yych = *++YYCURSOR;",
          "1221:  if (yych != ';') goto yy18;",
          "1222:  ++YYCURSOR;",
          "1224:  {",
          "1226:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1227:  return 1;",
          "1228: }",
          "1230: yy87:",
          "1231:  ++YYCURSOR;",
          "1233:  {",
          "1235:  ZVAL_NULL(rval);",
          "1236:  return 1;",
          "1237: }",
          "1239: yy89:",
          "1240:  yych = *++YYCURSOR;",
          "1241:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1223: #line 588 \"ext/standard/var_unserializer.re\"",
          "1229: #line 1230 \"ext/standard/var_unserializer.c\"",
          "1232: #line 582 \"ext/standard/var_unserializer.re\"",
          "1238: #line 1239 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1224: #line 589 \"ext/standard/var_unserializer.re\"",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "1233: #line 583 \"ext/standard/var_unserializer.re\"",
          "1239: #line 1240 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1258:  if (yych <= '9') goto yy91;",
          "1259:  if (yych != ';') goto yy18;",
          "1260:  ++YYCURSOR;",
          "1262:  {",
          "1263:  zend_long id;",
          "",
          "[Removed Lines]",
          "1261: #line 559 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1262: #line 560 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1282:  return 1;",
          "1283: }",
          "1285: yy95:",
          "1286:  yych = *++YYCURSOR;",
          "1287:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1285: #line 1286 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1304:  if (yych <= '9') goto yy97;",
          "1305:  if (yych != ';') goto yy18;",
          "1306:  ++YYCURSOR;",
          "1308:  {",
          "1309:  zend_long id;",
          "",
          "[Removed Lines]",
          "1307: #line 537 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1308: #line 538 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1327:  return 1;",
          "1328: }",
          "1330: }",
          "1334:  return 0;",
          "",
          "[Removed Lines]",
          "1329: #line 1330 \"ext/standard/var_unserializer.c\"",
          "1331: #line 882 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1330: #line 1331 \"ext/standard/var_unserializer.c\"",
          "1332: #line 883 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "474: {",
          "475:  zval retval;",
          "476:  zval fname;",
          "479:  if (Z_TYPE_P(rval) != IS_OBJECT) {",
          "480:   return 0;",
          "481:  }",
          "483:  zend_hash_resize(ht, zend_hash_num_elements(ht) + elements);",
          "484:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "485:   return 0;",
          "",
          "[Removed Lines]",
          "477:  HashTable *ht = Z_OBJPROP_P(rval);",
          "",
          "[Added Lines]",
          "477:  HashTable *ht;",
          "483:  ht = Z_OBJPROP_P(rval);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "aa4747c407e07b8d0b297f44c4ea7835b76fd58d",
      "candidate_info": {
        "commit_hash": "aa4747c407e07b8d0b297f44c4ea7835b76fd58d",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/aa4747c407e07b8d0b297f44c4ea7835b76fd58d",
        "files": [
          "ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #70963 (Unserialize shows UNKNOW in result)\n\nThanks to ryat for reportinig",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt": [
          "File: ext/standard/tests/serialize/bug70963.phpt -> ext/standard/tests/serialize/bug70963.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70963 (Unserialize shows UNKNOW in result)",
          "3: --FILE--",
          "4: <?php",
          "5: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;R:3;}'));",
          "6: ?>",
          "7: --EXPECTF--",
          "8: array(2) {",
          "9:   [0]=>",
          "10:   object(Exception)#%d (5) {",
          "11:     [\"message\":protected]=>",
          "12:     string(0) \"\"",
          "13:     [\"string\":\"Exception\":private]=>",
          "14:     string(0) \"\"",
          "15:     [\"code\":protected]=>",
          "16:     int(0)",
          "17:     [\"file\":protected]=>",
          "18:     string(%d) \"%s\"",
          "19:     [\"line\":protected]=>",
          "20:     int(%d)",
          "21:   }",
          "22: }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "565:  yych = *(YYMARKER = ++YYCURSOR);",
          "566:  if (yych == ':') goto yy95;",
          "567: yy3:",
          "569:  { return 0; }",
          "570: #line 571 \"ext/standard/var_unserializer.c\"",
          "571: yy4:",
          "",
          "[Removed Lines]",
          "568: #line 851 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "568: #line 857 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "610:  goto yy3;",
          "611: yy14:",
          "612:  ++YYCURSOR;",
          "614:  {",
          "616:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "",
          "[Removed Lines]",
          "613: #line 845 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "613: #line 851 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "646:  yych = *++YYCURSOR;",
          "647:  if (yych != '\"') goto yy18;",
          "648:  ++YYCURSOR;",
          "650:  {",
          "651:  size_t len, len2, len3, maxlen;",
          "652:  zend_long elements;",
          "",
          "[Removed Lines]",
          "649: #line 700 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "649: #line 706 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "816:  yych = *++YYCURSOR;",
          "817:  if (yych != '\"') goto yy18;",
          "818:  ++YYCURSOR;",
          "820:  {",
          "821:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "819: #line 693 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "819: #line 699 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "844:  yych = *++YYCURSOR;",
          "845:  if (yych != '{') goto yy18;",
          "846:  ++YYCURSOR;",
          "848:  {",
          "849:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "847: #line 669 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "847: #line 675 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "889:  yych = *++YYCURSOR;",
          "890:  if (yych != '\"') goto yy18;",
          "891:  ++YYCURSOR;",
          "893:  {",
          "894:  size_t len, maxlen;",
          "895:  zend_string *str;",
          "",
          "[Removed Lines]",
          "892: #line 641 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "892: #line 647 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych != '\"') goto yy18;",
          "940:  ++YYCURSOR;",
          "942:  {",
          "943:  size_t len, maxlen;",
          "944:  char *str;",
          "",
          "[Removed Lines]",
          "941: #line 614 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "941: #line 620 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1053:  }",
          "1054: yy63:",
          "1055:  ++YYCURSOR;",
          "1057:  {",
          "1058: #if SIZEOF_ZEND_LONG == 4",
          "1059: use_double:",
          "",
          "[Removed Lines]",
          "1056: #line 605 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1056: #line 611 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1121:  yych = *++YYCURSOR;",
          "1122:  if (yych != ';') goto yy18;",
          "1123:  ++YYCURSOR;",
          "1125:  {",
          "",
          "[Removed Lines]",
          "1124: #line 589 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1124: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1164:  if (yych <= '9') goto yy79;",
          "1165:  if (yych != ';') goto yy18;",
          "1166:  ++YYCURSOR;",
          "1168:  {",
          "1169: #if SIZEOF_ZEND_LONG == 4",
          "1170:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1167: #line 563 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1167: #line 569 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych != ';') goto yy18;",
          "1200:  ++YYCURSOR;",
          "1202:  {",
          "1204:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "",
          "[Removed Lines]",
          "1201: #line 557 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1201: #line 563 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1207: #line 1208 \"ext/standard/var_unserializer.c\"",
          "1208: yy87:",
          "1209:  ++YYCURSOR;",
          "1211:  {",
          "1213:  ZVAL_NULL(rval);",
          "",
          "[Removed Lines]",
          "1210: #line 551 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1210: #line 557 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1236:  if (yych <= '9') goto yy91;",
          "1237:  if (yych != ';') goto yy18;",
          "1238:  ++YYCURSOR;",
          "1240:  {",
          "1241:  zend_long id;",
          "",
          "[Removed Lines]",
          "1239: #line 535 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1239: #line 541 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1290:  zval_ptr_dtor(rval);",
          "1291:  if (Z_ISREF_P(rval_ref)) {",
          "1293:  } else {",
          "1296:  }",
          "1298:  return 1;",
          "1299: }",
          "1301: }",
          "1305:  return 0;",
          "",
          "[Removed Lines]",
          "1292:   ZVAL_COPY(rval, rval_ref);",
          "1294:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1295:   ZVAL_COPY(rval, rval_ref);",
          "1300: #line 1301 \"ext/standard/var_unserializer.c\"",
          "1302: #line 853 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1292:  if (!Z_ISUNDEF_P(Z_REFVAL_P(rval_ref))) {",
          "1293:  ZVAL_COPY(rval, rval_ref);",
          "1295:  ZVAL_UNDEF(rval);",
          "1296:  }",
          "1297:  } else if (Z_ISUNDEF_P(rval_ref)) {",
          "1298:  ZVAL_UNDEF(rval);",
          "1299:  } else {",
          "1300:  ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1301:  ZVAL_COPY(rval, rval_ref);",
          "1306: #line 1307 \"ext/standard/var_unserializer.c\"",
          "1308: #line 859 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "524:  zval_ptr_dtor(rval);",
          "525:  if (Z_ISREF_P(rval_ref)) {",
          "527:  } else {",
          "530:  }",
          "532:  return 1;",
          "",
          "[Removed Lines]",
          "526:   ZVAL_COPY(rval, rval_ref);",
          "528:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "529:   ZVAL_COPY(rval, rval_ref);",
          "",
          "[Added Lines]",
          "526:  if (!Z_ISUNDEF_P(Z_REFVAL_P(rval_ref))) {",
          "527:  ZVAL_COPY(rval, rval_ref);",
          "528:  } else {",
          "529:  ZVAL_UNDEF(rval);",
          "530:  }",
          "531:  } else if (Z_ISUNDEF_P(rval_ref)) {",
          "532:  ZVAL_UNDEF(rval);",
          "534:  ZVAL_NEW_REF(rval_ref, rval_ref);",
          "535:  ZVAL_COPY(rval, rval_ref);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "20d93534d5de742fb156e922a5d01255a1f1256e",
      "candidate_info": {
        "commit_hash": "20d93534d5de742fb156e922a5d01255a1f1256e",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/20d93534d5de742fb156e922a5d01255a1f1256e",
        "files": [
          "NEWS",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "standard/tests/serialize/bug68545.phpt"
        ],
        "message": "Fixed bug #68545 NULL pointer dereference in unserialize.c",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "standard/tests/serialize/bug68545.phpt||standard/tests/serialize/bug68545.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "62: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval **rval)",
          "63: {",
          "65: #if VAR_ENTRIES_DBG",
          "66:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "67: #endif",
          "",
          "[Removed Lines]",
          "64:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "",
          "[Added Lines]",
          "64:  var_entries *var_hash;",
          "66:  if (!var_hashx || !*var_hashx) {",
          "67:   return;",
          "68:  }",
          "70:  var_hash = (*var_hashx)->last_dtor;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "227: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "230: #line 235 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "236: #line 241 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "478: {",
          "479:  YYCTYPE yych;",
          "480:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "477: #line 478 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "483: #line 484 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "534:  yych = *(YYMARKER = ++YYCURSOR);",
          "535:  if (yych == ':') goto yy95;",
          "536: yy3:",
          "538:  { return 0; }",
          "540: yy4:",
          "541:  yych = *(YYMARKER = ++YYCURSOR);",
          "542:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "537: #line 829 \"ext/standard/var_unserializer.re\"",
          "539: #line 540 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "543: #line 835 \"ext/standard/var_unserializer.re\"",
          "545: #line 546 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "579:  goto yy3;",
          "580: yy14:",
          "581:  ++YYCURSOR;",
          "583:  {",
          "585:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "587: }",
          "589: yy16:",
          "590:  yych = *++YYCURSOR;",
          "591:  goto yy3;",
          "",
          "[Removed Lines]",
          "582: #line 823 \"ext/standard/var_unserializer.re\"",
          "588: #line 589 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "588: #line 829 \"ext/standard/var_unserializer.re\"",
          "594: #line 595 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "615:  yych = *++YYCURSOR;",
          "616:  if (yych != '\"') goto yy18;",
          "617:  ++YYCURSOR;",
          "619:  {",
          "620:  size_t len, len2, len3, maxlen;",
          "621:  long elements;",
          "",
          "[Removed Lines]",
          "618: #line 677 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "624: #line 683 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "762:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "763: }",
          "765: yy25:",
          "766:  yych = *++YYCURSOR;",
          "767:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "764: #line 765 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "770: #line 771 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "786:  yych = *++YYCURSOR;",
          "787:  if (yych != '\"') goto yy18;",
          "788:  ++YYCURSOR;",
          "790:  {",
          "792:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "789: #line 669 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "795: #line 675 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "794:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "795:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "796: }",
          "798: yy32:",
          "799:  yych = *++YYCURSOR;",
          "800:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "797: #line 798 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "803: #line 804 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "815:  yych = *++YYCURSOR;",
          "816:  if (yych != '{') goto yy18;",
          "817:  ++YYCURSOR;",
          "819:  {",
          "820:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "818: #line 649 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "824: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "836:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "837: }",
          "839: yy39:",
          "840:  yych = *++YYCURSOR;",
          "841:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "838: #line 839 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "844: #line 845 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "856:  yych = *++YYCURSOR;",
          "857:  if (yych != '\"') goto yy18;",
          "858:  ++YYCURSOR;",
          "860:  {",
          "861:  size_t len, maxlen;",
          "862:  char *str;",
          "",
          "[Removed Lines]",
          "859: #line 620 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "865: #line 626 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "885:  ZVAL_STRINGL(*rval, str, len, 0);",
          "886:  return 1;",
          "887: }",
          "889: yy46:",
          "890:  yych = *++YYCURSOR;",
          "891:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "888: #line 889 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "894: #line 895 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "906:  yych = *++YYCURSOR;",
          "907:  if (yych != '\"') goto yy18;",
          "908:  ++YYCURSOR;",
          "910:  {",
          "911:  size_t len, maxlen;",
          "912:  char *str;",
          "",
          "[Removed Lines]",
          "909: #line 592 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "915: #line 598 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "934:  ZVAL_STRINGL(*rval, str, len, 1);",
          "935:  return 1;",
          "936: }",
          "938: yy53:",
          "939:  yych = *++YYCURSOR;",
          "940:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "937: #line 938 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "943: #line 944 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1022:  }",
          "1023: yy63:",
          "1024:  ++YYCURSOR;",
          "1026:  {",
          "1027: #if SIZEOF_LONG == 4",
          "1028: use_double:",
          "",
          "[Removed Lines]",
          "1025: #line 582 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1031: #line 588 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1032:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1033:  return 1;",
          "1034: }",
          "1036: yy65:",
          "1037:  yych = *++YYCURSOR;",
          "1038:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1035: #line 1036 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1041: #line 1042 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1091:  yych = *++YYCURSOR;",
          "1092:  if (yych != ';') goto yy18;",
          "1093:  ++YYCURSOR;",
          "1095:  {",
          "1097:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1094: #line 567 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1100: #line 573 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1107:  return 1;",
          "1108: }",
          "1110: yy76:",
          "1111:  yych = *++YYCURSOR;",
          "1112:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1109: #line 1110 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1115: #line 1116 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1133:  if (yych <= '9') goto yy79;",
          "1134:  if (yych != ';') goto yy18;",
          "1135:  ++YYCURSOR;",
          "1137:  {",
          "1138: #if SIZEOF_LONG == 4",
          "1139:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1136: #line 540 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1142: #line 546 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1160:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1161:  return 1;",
          "1162: }",
          "1164: yy83:",
          "1165:  yych = *++YYCURSOR;",
          "1166:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1163: #line 1164 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1169: #line 1170 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1168:  yych = *++YYCURSOR;",
          "1169:  if (yych != ';') goto yy18;",
          "1170:  ++YYCURSOR;",
          "1172:  {",
          "1174:  INIT_PZVAL(*rval);",
          "1175:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1176:  return 1;",
          "1177: }",
          "1179: yy87:",
          "1180:  ++YYCURSOR;",
          "1182:  {",
          "1184:  INIT_PZVAL(*rval);",
          "1185:  ZVAL_NULL(*rval);",
          "1186:  return 1;",
          "1187: }",
          "1189: yy89:",
          "1190:  yych = *++YYCURSOR;",
          "1191:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1171: #line 533 \"ext/standard/var_unserializer.re\"",
          "1178: #line 1179 \"ext/standard/var_unserializer.c\"",
          "1181: #line 526 \"ext/standard/var_unserializer.re\"",
          "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1177: #line 539 \"ext/standard/var_unserializer.re\"",
          "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
          "1187: #line 532 \"ext/standard/var_unserializer.re\"",
          "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1208:  if (yych <= '9') goto yy91;",
          "1209:  if (yych != ';') goto yy18;",
          "1210:  ++YYCURSOR;",
          "1212:  {",
          "1213:  long id;",
          "",
          "[Removed Lines]",
          "1211: #line 503 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1217: #line 509 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1232:  return 1;",
          "1233: }",
          "1235: yy95:",
          "1236:  yych = *++YYCURSOR;",
          "1237:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1234: #line 1235 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1240: #line 1241 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1254:  if (yych <= '9') goto yy97;",
          "1255:  if (yych != ';') goto yy18;",
          "1256:  ++YYCURSOR;",
          "1258:  {",
          "1259:  long id;",
          "",
          "[Removed Lines]",
          "1257: #line 482 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1263: #line 488 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1276:  return 1;",
          "1277: }",
          "1279: }",
          "1283:  return 0;",
          "",
          "[Removed Lines]",
          "1278: #line 1279 \"ext/standard/var_unserializer.c\"",
          "1280: #line 831 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
          "1286: #line 837 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "60: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval **rval)",
          "61: {",
          "63: #if VAR_ENTRIES_DBG",
          "64:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "65: #endif",
          "",
          "[Removed Lines]",
          "62:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "",
          "[Added Lines]",
          "62:  var_entries *var_hash;",
          "64:  if (!var_hashx || !*var_hashx) {",
          "65:   return;",
          "66:  }",
          "68:  var_hash = (*var_hashx)->last_dtor;",
          "",
          "---------------"
        ],
        "standard/tests/serialize/bug68545.phpt||standard/tests/serialize/bug68545.phpt": [
          "File: standard/tests/serialize/bug68545.phpt -> standard/tests/serialize/bug68545.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68545 NULL pointer dereference in unserialize.c:var_push_dtor",
          "3: --FILE--",
          "4: <?php",
          "5: var_dump(unserialize('a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";s:3:\"bar\";a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"b22\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";s:3:\"bar\";a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";s:3:\"bar\";s:3:\"bar\";'));",
          "6: ?>",
          "7: ===DONE===",
          "8: --EXPECTF--",
          "9: Notice: unserialize(): Error at offset %d of %d bytes in %sbug68545.php on line %d",
          "10: bool(false)",
          "11: ===DONE===",
          "",
          "---------------"
        ]
      }
    }
  ]
}