{
  "cve_id": "CVE-2018-7584",
  "cve_desc": "In PHP through 5.6.33, 7.0.x before 7.0.28, 7.1.x through 7.1.14, and 7.2.x through 7.2.2, there is a stack-based buffer under-read while parsing an HTTP response in the php_stream_url_wrap_http_ex function in ext/standard/http_fopen_wrapper.c. This subsequently results in copying a large string.",
  "repo": "php/php-src",
  "patch_hash": "523f230c831d7b33353203fa34aee4e92ac12bba",
  "patch_info": {
    "commit_hash": "523f230c831d7b33353203fa34aee4e92ac12bba",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/523f230c831d7b33353203fa34aee4e92ac12bba",
    "files": [
      "ext/standard/http_fopen_wrapper.c",
      "ext/standard/tests/http/bug75981.phpt"
    ],
    "message": "Fix bug #75981: prevent reading beyond buffer start",
    "before_after_code_files": [
      "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
      "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
    ]
  },
  "patch_diff": {
    "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c": [
      "File: ext/standard/http_fopen_wrapper.c -> ext/standard/http_fopen_wrapper.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "737:         tmp_line, response_code);",
      "738:     }",
      "739:    }",
      "741:     --tmp_line_len;",
      "743:      --tmp_line_len;",
      "744:     }",
      "745:    }",
      "",
      "[Removed Lines]",
      "740:    if (tmp_line[tmp_line_len - 1] == '\\n') {",
      "742:     if (tmp_line[tmp_line_len - 1] == '\\r') {",
      "",
      "[Added Lines]",
      "740:    if (tmp_line_len >= 1 && tmp_line[tmp_line_len - 1] == '\\n') {",
      "742:     if (tmp_line_len >= 1 &&tmp_line[tmp_line_len - 1] == '\\r') {",
      "",
      "---------------"
    ],
    "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt": [
      "File: ext/standard/tests/http/bug75981.phpt -> ext/standard/tests/http/bug75981.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #75981 (stack-buffer-overflow while parsing HTTP response)",
      "3: --INI--",
      "4: allow_url_fopen=1",
      "5: --SKIPIF--",
      "6: <?php require 'server.inc'; http_server_skipif('tcp://127.0.0.1:12342'); ?>",
      "7: --FILE--",
      "8: <?php",
      "9: require 'server.inc';",
      "11: $options = [",
      "12:   'http' => [",
      "13:     'protocol_version' => '1.1',",
      "14:     'header' => 'Connection: Close'",
      "15:   ],",
      "16: ];",
      "18: $ctx = stream_context_create($options);",
      "20: $responses = [",
      "21:  \"data://text/plain,000000000100\\xA\\xA\"",
      "22: ];",
      "23: $pid = http_server('tcp://127.0.0.1:12342', $responses);",
      "25: echo @file_get_contents('http://127.0.0.1:12342/', false, $ctx);",
      "27: http_server_kill($pid);",
      "29: ?>",
      "30: DONE",
      "31: --EXPECT--",
      "32: DONE",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "36239fee3638a8f4cfe3ca3aba597cb1699abd90",
      "candidate_info": {
        "commit_hash": "36239fee3638a8f4cfe3ca3aba597cb1699abd90",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/36239fee3638a8f4cfe3ca3aba597cb1699abd90",
        "files": [
          "ext/standard/http_fopen_wrapper.c",
          "ext/standard/tests/http/bug75981.phpt"
        ],
        "message": "Fix bug #75981: prevent reading beyond buffer start",
        "before_after_code_files": [
          "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
          "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
            "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
          ],
          "candidate": [
            "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
            "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c": [
          "File: ext/standard/http_fopen_wrapper.c -> ext/standard/http_fopen_wrapper.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "737:         tmp_line, response_code);",
          "738:     }",
          "739:    }",
          "741:     --tmp_line_len;",
          "743:      --tmp_line_len;",
          "744:     }",
          "745:    }",
          "",
          "[Removed Lines]",
          "740:    if (tmp_line[tmp_line_len - 1] == '\\n') {",
          "742:     if (tmp_line[tmp_line_len - 1] == '\\r') {",
          "",
          "[Added Lines]",
          "740:    if (tmp_line_len >= 1 && tmp_line[tmp_line_len - 1] == '\\n') {",
          "742:     if (tmp_line_len >= 1 &&tmp_line[tmp_line_len - 1] == '\\r') {",
          "",
          "---------------"
        ],
        "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt": [
          "File: ext/standard/tests/http/bug75981.phpt -> ext/standard/tests/http/bug75981.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #75981 (stack-buffer-overflow while parsing HTTP response)",
          "3: --INI--",
          "4: allow_url_fopen=1",
          "5: --SKIPIF--",
          "6: <?php require 'server.inc'; http_server_skipif('tcp://127.0.0.1:12342'); ?>",
          "7: --FILE--",
          "8: <?php",
          "9: require 'server.inc';",
          "11: $options = [",
          "12:   'http' => [",
          "13:     'protocol_version' => '1.1',",
          "14:     'header' => 'Connection: Close'",
          "15:   ],",
          "16: ];",
          "18: $ctx = stream_context_create($options);",
          "20: $responses = [",
          "21:  \"data://text/plain,000000000100\\xA\\xA\"",
          "22: ];",
          "23: $pid = http_server('tcp://127.0.0.1:12342', $responses);",
          "25: echo @file_get_contents('http://127.0.0.1:12342/', false, $ctx);",
          "27: http_server_kill($pid);",
          "29: ?>",
          "30: DONE",
          "31: --EXPECT--",
          "32: DONE",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ebbef8503f4b5cdd63b7da49b106f970353c7ac0",
      "candidate_info": {
        "commit_hash": "ebbef8503f4b5cdd63b7da49b106f970353c7ac0",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/ebbef8503f4b5cdd63b7da49b106f970353c7ac0",
        "files": [
          "ext/exif/exif.c",
          "ext/exif/tests/bug76130.phpt",
          "ext/exif/tests/bug76130_1.jpg",
          "ext/exif/tests/bug76130_2.jpg",
          "ext/iconv/iconv.c",
          "ext/iconv/tests/bug76249.phpt",
          "ext/ldap/ldap.c",
          "ext/ldap/tests/bug76248.phpt",
          "ext/phar/phar_object.c",
          "ext/phar/tests/cache_list/frontcontroller10.phpt",
          "ext/phar/tests/cache_list/frontcontroller6.phpt",
          "ext/phar/tests/cache_list/frontcontroller8.phpt",
          "ext/phar/tests/frontcontroller10.phpt",
          "ext/phar/tests/frontcontroller6.phpt",
          "ext/phar/tests/frontcontroller8.phpt",
          "ext/phar/tests/tar/frontcontroller10.phar.phpt",
          "ext/phar/tests/tar/frontcontroller6.phar.phpt",
          "ext/phar/tests/tar/frontcontroller8.phar.phpt",
          "ext/phar/tests/zip/frontcontroller10.phar.phpt",
          "ext/phar/tests/zip/frontcontroller6.phar.phpt",
          "ext/phar/tests/zip/frontcontroller8.phar.phpt"
        ],
        "message": "Merge branch 'PHP-7.1' into PHP-7.2\n\n* PHP-7.1:\n  Fix tsrm_ls\n  Fix #76129 - remove more potential unfiltered outputs for phar\n  Fix test\n  Fix bug #76248 - Malicious LDAP-Server Response causes Crash\n  Fix bug #76249 - fail on invalid sequences\n  Fix #76130: Heap Buffer Overflow (READ: 1786) in exif_iif_add_value\n  Fix bug #75981: prevent reading beyond buffer start\n\n(cherry picked from commit 4c06d929c048158a623a6f285af006f8531d372b)",
        "before_after_code_files": [
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/exif/tests/bug76130.phpt||ext/exif/tests/bug76130.phpt",
          "ext/iconv/iconv.c||ext/iconv/iconv.c",
          "ext/iconv/tests/bug76249.phpt||ext/iconv/tests/bug76249.phpt",
          "ext/ldap/ldap.c||ext/ldap/ldap.c",
          "ext/ldap/tests/bug76248.phpt||ext/ldap/tests/bug76248.phpt",
          "ext/phar/phar_object.c||ext/phar/phar_object.c",
          "ext/phar/tests/cache_list/frontcontroller10.phpt||ext/phar/tests/cache_list/frontcontroller10.phpt",
          "ext/phar/tests/cache_list/frontcontroller6.phpt||ext/phar/tests/cache_list/frontcontroller6.phpt",
          "ext/phar/tests/cache_list/frontcontroller8.phpt||ext/phar/tests/cache_list/frontcontroller8.phpt",
          "ext/phar/tests/frontcontroller10.phpt||ext/phar/tests/frontcontroller10.phpt",
          "ext/phar/tests/frontcontroller6.phpt||ext/phar/tests/frontcontroller6.phpt",
          "ext/phar/tests/frontcontroller8.phpt||ext/phar/tests/frontcontroller8.phpt",
          "ext/phar/tests/tar/frontcontroller10.phar.phpt||ext/phar/tests/tar/frontcontroller10.phar.phpt",
          "ext/phar/tests/tar/frontcontroller6.phar.phpt||ext/phar/tests/tar/frontcontroller6.phar.phpt",
          "ext/phar/tests/tar/frontcontroller8.phar.phpt||ext/phar/tests/tar/frontcontroller8.phar.phpt",
          "ext/phar/tests/zip/frontcontroller10.phar.phpt||ext/phar/tests/zip/frontcontroller10.phar.phpt",
          "ext/phar/tests/zip/frontcontroller6.phar.phpt||ext/phar/tests/zip/frontcontroller6.phar.phpt",
          "ext/phar/tests/zip/frontcontroller8.phar.phpt||ext/phar/tests/zip/frontcontroller8.phar.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2112:   case TAG_FMT_UNDEFINED:",
          "2113:    if (value) {",
          "2114:     if (tag == TAG_MAKER_NOTE) {",
          "2116:     }",
          "",
          "[Removed Lines]",
          "2115:      length = MIN(length, (int) strlen(value));",
          "",
          "[Added Lines]",
          "2115:      length = (int) php_strnlen(value, length);",
          "",
          "---------------"
        ],
        "ext/exif/tests/bug76130.phpt||ext/exif/tests/bug76130.phpt": [
          "File: ext/exif/tests/bug76130.phpt -> ext/exif/tests/bug76130.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #76130 (Heap Buffer Overflow (READ: 1786) in exif_iif_add_value)",
          "3: --DESCRIPTION--",
          "4: This test is meant to exhibit memory issues with the `-m` option. Since a lot of",
          "5: notices and warnings are to be expected anyway, we suppress these, since the are",
          "6: not relevant for this test.",
          "7: --INI--",
          "8: error_reporting=E_ALL & ~E_WARNING & ~E_NOTICE",
          "9: --SKIPIF--",
          "10: <?php",
          "11: if (!extension_loaded('exif')) die('skip exif extension not available');",
          "12: ?>",
          "13: --FILE--",
          "14: <?php",
          "15: exif_read_data(__DIR__ . '/bug76130_1.jpg');",
          "16: exif_read_data(__DIR__ . '/bug76130_2.jpg');",
          "17: ?>",
          "18: ===DONE===",
          "19: --EXPECT--",
          "20: ===DONE===",
          "",
          "---------------"
        ],
        "ext/iconv/iconv.c||ext/iconv/iconv.c": [
          "File: ext/iconv/iconv.c -> ext/iconv/iconv.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2642:         tcnt = 0;",
          "2643:         break;",
          "2644:        }",
          "2645:       }",
          "2646:       break;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2645:       } else {",
          "2646:           php_error_docref(NULL, E_WARNING, \"iconv stream filter (\\\"%s\\\"=>\\\"%s\\\"): invalid multibyte sequence\", self->from_charset, self->to_charset);",
          "2647:           goto out_failure;",
          "",
          "---------------"
        ],
        "ext/iconv/tests/bug76249.phpt||ext/iconv/tests/bug76249.phpt": [
          "File: ext/iconv/tests/bug76249.phpt -> ext/iconv/tests/bug76249.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #76249 (stream filter convert.iconv leads to infinite loop on invalid sequence)",
          "3: --SKIPIF--",
          "4: <?php extension_loaded('iconv') or die('skip iconv extension is not available'); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: $fh = fopen('php://memory', 'rw');",
          "8: fwrite($fh, \"abc\");",
          "9: rewind($fh);",
          "10: stream_filter_append($fh, 'convert.iconv.ucs-2/utf8//IGNORE', STREAM_FILTER_READ, []);",
          "11: $a = stream_get_contents($fh);",
          "12: var_dump(strlen($a));",
          "13: ?>",
          "14: DONE",
          "15: --EXPECTF--",
          "16: Warning: stream_get_contents(): iconv stream filter (\"ucs-2\"=>\"utf8//IGNORE\"): invalid multibyte sequence in %sbug76249.php on line %d",
          "17: int(3)",
          "18: DONE",
          "",
          "---------------"
        ],
        "ext/ldap/ldap.c||ext/ldap/ldap.c": [
          "File: ext/ldap/ldap.c -> ext/ldap/ldap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1243:   add_assoc_long(&tmp1, \"count\", num_attrib);",
          "1244:   dn = ldap_get_dn(ldap, ldap_result_entry);",
          "1246: #if (LDAP_API_VERSION > 2000) || HAVE_NSLDAP || HAVE_ORALDAP || WINDOWS",
          "1247:   ldap_memfree(dn);",
          "1248: #else",
          "",
          "[Removed Lines]",
          "1245:   add_assoc_string(&tmp1, \"dn\", dn);",
          "",
          "[Added Lines]",
          "1245:   if (dn) {",
          "1246:    add_assoc_string(&tmp1, \"dn\", dn);",
          "1247:   } else {",
          "1248:    add_assoc_null(&tmp1, \"dn\");",
          "1249:   }",
          "",
          "---------------"
        ],
        "ext/ldap/tests/bug76248.phpt||ext/ldap/tests/bug76248.phpt": [
          "File: ext/ldap/tests/bug76248.phpt -> ext/ldap/tests/bug76248.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #76248 (Malicious LDAP-Server Response causes Crash)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: require_once('skipif.inc');",
          "6: if (!function_exists('pcntl_fork')) die('skip fork not available');",
          "7: ?>",
          "8: --FILE--",
          "9: <?php",
          "10: $pid = pcntl_fork();",
          "11: const PORT = 12345;",
          "12: if ($pid == 0) {",
          "14:     $server = stream_socket_server(\"tcp://127.0.0.1:12345\");",
          "15:  $socket = stream_socket_accept($server, 3);",
          "16:  fwrite($socket, base64_decode(\"MAwCAQFhBwoBAAQABAAweQIBAmR0BJljbj1yb290LGRjPWV4YW1wbGUsZGM9Y29tMFcwIwQLb2JqZWN0Q2xhc3MxFAQSb3JnYW5pemF0aW9uYWxSb2xlMAwEAmNuMQYEBHJvb3QwIgQLZGVzY3JpcHRpb24xEwQRRGlyZWN0b3J5IE1hbmFnZXIwDAIBAmUHCgEABAAEADB5AgEDZHQEmWNuPXJvb3QsZGM9ZXhhbXBsZSxkYz1jb20wVzAjBAtvYmplY3RDbGFzczEUBBJvcmdhbml6YXRpb25hbFJvbGUwDAQCY24xBgQEcm9vdDAiBAtkZXNjcmlwdGlvbjETBBFEaXJlY3RvcnkgTWFuYWdlcjAMAgEDZQcKAQAEAAQA\"));",
          "17:  fflush($socket);",
          "18: } else {",
          "20:  $ds = ldap_connect(\"127.0.0.1\", PORT);",
          "21:  ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);",
          "22:  $b = ldap_bind($ds, \"cn=root,dc=example,dc=com\", \"secret\");",
          "24:  $s = ldap_search($ds, \"dc=example,dc=com\", \"(cn=root)\");",
          "25:  $tt = ldap_get_entries($ds, $s);",
          "26:  var_dump($tt);",
          "27: }",
          "28: ?>",
          "29: --EXPECT--",
          "30: array(2) {",
          "31:   [\"count\"]=>",
          "32:   int(1)",
          "33:   [0]=>",
          "34:   array(2) {",
          "35:     [\"count\"]=>",
          "36:     int(0)",
          "37:     [\"dn\"]=>",
          "38:     NULL",
          "39:   }",
          "40: }",
          "",
          "---------------"
        ],
        "ext/phar/phar_object.c||ext/phar/phar_object.c": [
          "File: ext/phar/phar_object.c -> ext/phar/phar_object.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "308:  sapi_header_op(SAPI_HEADER_REPLACE, &ctr);",
          "309:  sapi_send_headers();",
          "310:  PHPWRITE(\"<html>\\n <head>\\n  <title>Access Denied</title>\\n </head>\\n <body>\\n  <h1>403 - File \", sizeof(\"<html>\\n <head>\\n  <title>Access Denied</title>\\n </head>\\n <body>\\n  <h1>403 - File \") - 1);",
          "313: }",
          "",
          "[Removed Lines]",
          "311:  PHPWRITE(entry, entry_len);",
          "312:  PHPWRITE(\" Access Denied</h1>\\n </body>\\n</html>\", sizeof(\" Access Denied</h1>\\n </body>\\n</html>\") - 1);",
          "",
          "[Added Lines]",
          "311:  PHPWRITE(\"Access Denied</h1>\\n </body>\\n</html>\", sizeof(\"Access Denied</h1>\\n </body>\\n</html>\") - 1);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "333:  sapi_header_op(SAPI_HEADER_REPLACE, &ctr);",
          "334:  sapi_send_headers();",
          "335:  PHPWRITE(\"<html>\\n <head>\\n  <title>File Not Found</title>\\n </head>\\n <body>\\n  <h1>404 - File \", sizeof(\"<html>\\n <head>\\n  <title>File Not Found</title>\\n </head>\\n <body>\\n  <h1>404 - File \") - 1);",
          "338: }",
          "",
          "[Removed Lines]",
          "336:  PHPWRITE(entry, entry_len);",
          "337:  PHPWRITE(\" Not Found</h1>\\n </body>\\n</html>\",  sizeof(\" Not Found</h1>\\n </body>\\n</html>\") - 1);",
          "",
          "[Added Lines]",
          "335:  PHPWRITE(\"Not Found</h1>\\n </body>\\n</html>\",  sizeof(\"Not Found</h1>\\n </body>\\n</html>\") - 1);",
          "",
          "---------------"
        ],
        "ext/phar/tests/cache_list/frontcontroller10.phpt||ext/phar/tests/cache_list/frontcontroller10.phpt": [
          "File: ext/phar/tests/cache_list/frontcontroller10.phpt -> ext/phar/tests/cache_list/frontcontroller10.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "20:   <title>Access Denied</title>",
          "21:  </head>",
          "22:  <body>",
          "24:  </body>",
          "25: </html>",
          "",
          "[Removed Lines]",
          "23:   <h1>403 - File /hi Access Denied</h1>",
          "",
          "[Added Lines]",
          "23:   <h1>403 - File Access Denied</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/cache_list/frontcontroller6.phpt||ext/phar/tests/cache_list/frontcontroller6.phpt": [
          "File: ext/phar/tests/cache_list/frontcontroller6.phpt -> ext/phar/tests/cache_list/frontcontroller6.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:   <title>File Not Found</title>",
          "19:  </head>",
          "20:  <body>",
          "22:  </body>",
          "23: </html>",
          "",
          "[Removed Lines]",
          "21:   <h1>404 - File /notfound.php Not Found</h1>",
          "",
          "[Added Lines]",
          "21:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/cache_list/frontcontroller8.phpt||ext/phar/tests/cache_list/frontcontroller8.phpt": [
          "File: ext/phar/tests/cache_list/frontcontroller8.phpt -> ext/phar/tests/cache_list/frontcontroller8.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:   <title>File Not Found</title>",
          "19:  </head>",
          "20:  <body>",
          "22:  </body>",
          "23: </html>",
          "",
          "[Removed Lines]",
          "21:   <h1>404 - File /index.php Not Found</h1>",
          "",
          "[Added Lines]",
          "21:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/frontcontroller10.phpt||ext/phar/tests/frontcontroller10.phpt": [
          "File: ext/phar/tests/frontcontroller10.phpt -> ext/phar/tests/frontcontroller10.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:   <title>Access Denied</title>",
          "20:  </head>",
          "21:  <body>",
          "23:  </body>",
          "24: </html>",
          "",
          "[Removed Lines]",
          "22:   <h1>403 - File /hi Access Denied</h1>",
          "",
          "[Added Lines]",
          "22:   <h1>403 - File Access Denied</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/frontcontroller6.phpt||ext/phar/tests/frontcontroller6.phpt": [
          "File: ext/phar/tests/frontcontroller6.phpt -> ext/phar/tests/frontcontroller6.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /notfound.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/frontcontroller8.phpt||ext/phar/tests/frontcontroller8.phpt": [
          "File: ext/phar/tests/frontcontroller8.phpt -> ext/phar/tests/frontcontroller8.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /index.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/tar/frontcontroller10.phar.phpt||ext/phar/tests/tar/frontcontroller10.phar.phpt": [
          "File: ext/phar/tests/tar/frontcontroller10.phar.phpt -> ext/phar/tests/tar/frontcontroller10.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:   <title>Access Denied</title>",
          "20:  </head>",
          "21:  <body>",
          "23:  </body>",
          "24: </html>",
          "",
          "[Removed Lines]",
          "22:   <h1>403 - File /hi Access Denied</h1>",
          "",
          "[Added Lines]",
          "22:   <h1>403 - File Access Denied</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/tar/frontcontroller6.phar.phpt||ext/phar/tests/tar/frontcontroller6.phar.phpt": [
          "File: ext/phar/tests/tar/frontcontroller6.phar.phpt -> ext/phar/tests/tar/frontcontroller6.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /notfound.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/tar/frontcontroller8.phar.phpt||ext/phar/tests/tar/frontcontroller8.phar.phpt": [
          "File: ext/phar/tests/tar/frontcontroller8.phar.phpt -> ext/phar/tests/tar/frontcontroller8.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /index.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/zip/frontcontroller10.phar.phpt||ext/phar/tests/zip/frontcontroller10.phar.phpt": [
          "File: ext/phar/tests/zip/frontcontroller10.phar.phpt -> ext/phar/tests/zip/frontcontroller10.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:   <title>Access Denied</title>",
          "20:  </head>",
          "21:  <body>",
          "23:  </body>",
          "24: </html>",
          "",
          "[Removed Lines]",
          "22:   <h1>403 - File /hi Access Denied</h1>",
          "",
          "[Added Lines]",
          "22:   <h1>403 - File Access Denied</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/zip/frontcontroller6.phar.phpt||ext/phar/tests/zip/frontcontroller6.phar.phpt": [
          "File: ext/phar/tests/zip/frontcontroller6.phar.phpt -> ext/phar/tests/zip/frontcontroller6.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "17:   <title>File Not Found</title>",
          "18:  </head>",
          "19:  <body>",
          "21:  </body>",
          "22: </html>",
          "",
          "[Removed Lines]",
          "20:   <h1>404 - File /notfound.php Not Found</h1>",
          "",
          "[Added Lines]",
          "20:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/zip/frontcontroller8.phar.phpt||ext/phar/tests/zip/frontcontroller8.phar.phpt": [
          "File: ext/phar/tests/zip/frontcontroller8.phar.phpt -> ext/phar/tests/zip/frontcontroller8.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /index.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7ba447cae24ab44234b2b3feaf2ae188ef3e7795",
      "candidate_info": {
        "commit_hash": "7ba447cae24ab44234b2b3feaf2ae188ef3e7795",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/7ba447cae24ab44234b2b3feaf2ae188ef3e7795",
        "files": [
          "ext/exif/exif.c",
          "ext/exif/tests/bug76130.phpt",
          "ext/exif/tests/bug76130_1.jpg",
          "ext/exif/tests/bug76130_2.jpg",
          "ext/iconv/iconv.c",
          "ext/iconv/tests/bug76249.phpt",
          "ext/ldap/ldap.c",
          "ext/ldap/tests/bug76248.phpt",
          "ext/phar/phar_object.c",
          "ext/phar/tests/cache_list/frontcontroller10.phpt",
          "ext/phar/tests/cache_list/frontcontroller6.phpt",
          "ext/phar/tests/cache_list/frontcontroller8.phpt",
          "ext/phar/tests/frontcontroller10.phpt",
          "ext/phar/tests/frontcontroller6.phpt",
          "ext/phar/tests/frontcontroller8.phpt",
          "ext/phar/tests/tar/frontcontroller10.phar.phpt",
          "ext/phar/tests/tar/frontcontroller6.phar.phpt",
          "ext/phar/tests/tar/frontcontroller8.phar.phpt",
          "ext/phar/tests/zip/frontcontroller10.phar.phpt",
          "ext/phar/tests/zip/frontcontroller6.phar.phpt",
          "ext/phar/tests/zip/frontcontroller8.phar.phpt"
        ],
        "message": "Merge branch 'PHP-7.0' into PHP-7.1\n\n* PHP-7.0:\n  Fix tsrm_ls\n  Fix #76129 - remove more potential unfiltered outputs for phar\n  Fix test\n  Fix bug #76248 - Malicious LDAP-Server Response causes Crash\n  Fix bug #76249 - fail on invalid sequences\n  Fix #76130: Heap Buffer Overflow (READ: 1786) in exif_iif_add_value\n  Fix bug #75981: prevent reading beyond buffer start",
        "before_after_code_files": [
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/exif/tests/bug76130.phpt||ext/exif/tests/bug76130.phpt",
          "ext/iconv/iconv.c||ext/iconv/iconv.c",
          "ext/iconv/tests/bug76249.phpt||ext/iconv/tests/bug76249.phpt",
          "ext/ldap/ldap.c||ext/ldap/ldap.c",
          "ext/ldap/tests/bug76248.phpt||ext/ldap/tests/bug76248.phpt",
          "ext/phar/phar_object.c||ext/phar/phar_object.c",
          "ext/phar/tests/cache_list/frontcontroller10.phpt||ext/phar/tests/cache_list/frontcontroller10.phpt",
          "ext/phar/tests/cache_list/frontcontroller6.phpt||ext/phar/tests/cache_list/frontcontroller6.phpt",
          "ext/phar/tests/cache_list/frontcontroller8.phpt||ext/phar/tests/cache_list/frontcontroller8.phpt",
          "ext/phar/tests/frontcontroller10.phpt||ext/phar/tests/frontcontroller10.phpt",
          "ext/phar/tests/frontcontroller6.phpt||ext/phar/tests/frontcontroller6.phpt",
          "ext/phar/tests/frontcontroller8.phpt||ext/phar/tests/frontcontroller8.phpt",
          "ext/phar/tests/tar/frontcontroller10.phar.phpt||ext/phar/tests/tar/frontcontroller10.phar.phpt",
          "ext/phar/tests/tar/frontcontroller6.phar.phpt||ext/phar/tests/tar/frontcontroller6.phar.phpt",
          "ext/phar/tests/tar/frontcontroller8.phar.phpt||ext/phar/tests/tar/frontcontroller8.phar.phpt",
          "ext/phar/tests/zip/frontcontroller10.phar.phpt||ext/phar/tests/zip/frontcontroller10.phar.phpt",
          "ext/phar/tests/zip/frontcontroller6.phar.phpt||ext/phar/tests/zip/frontcontroller6.phar.phpt",
          "ext/phar/tests/zip/frontcontroller8.phar.phpt||ext/phar/tests/zip/frontcontroller8.phar.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1704:   case TAG_FMT_UNDEFINED:",
          "1705:    if (value) {",
          "1706:     if (tag == TAG_MAKER_NOTE) {",
          "1708:     }",
          "",
          "[Removed Lines]",
          "1707:      length = MIN(length, strlen(value));",
          "",
          "[Added Lines]",
          "1707:      length = (int) php_strnlen(value, length);",
          "",
          "---------------"
        ],
        "ext/exif/tests/bug76130.phpt||ext/exif/tests/bug76130.phpt": [
          "File: ext/exif/tests/bug76130.phpt -> ext/exif/tests/bug76130.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #76130 (Heap Buffer Overflow (READ: 1786) in exif_iif_add_value)",
          "3: --DESCRIPTION--",
          "4: This test is meant to exhibit memory issues with the `-m` option. Since a lot of",
          "5: notices and warnings are to be expected anyway, we suppress these, since the are",
          "6: not relevant for this test.",
          "7: --INI--",
          "8: error_reporting=E_ALL & ~E_WARNING & ~E_NOTICE",
          "9: --SKIPIF--",
          "10: <?php",
          "11: if (!extension_loaded('exif')) die('skip exif extension not available');",
          "12: ?>",
          "13: --FILE--",
          "14: <?php",
          "15: exif_read_data(__DIR__ . '/bug76130_1.jpg');",
          "16: exif_read_data(__DIR__ . '/bug76130_2.jpg');",
          "17: ?>",
          "18: ===DONE===",
          "19: --EXPECT--",
          "20: ===DONE===",
          "",
          "---------------"
        ],
        "ext/iconv/iconv.c||ext/iconv/iconv.c": [
          "File: ext/iconv/iconv.c -> ext/iconv/iconv.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2658:         tcnt = 0;",
          "2659:         break;",
          "2660:        }",
          "2661:       }",
          "2662:       break;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2661:       } else {",
          "2662:           php_error_docref(NULL, E_WARNING, \"iconv stream filter (\\\"%s\\\"=>\\\"%s\\\"): invalid multibyte sequence\", self->from_charset, self->to_charset);",
          "2663:           goto out_failure;",
          "",
          "---------------"
        ],
        "ext/iconv/tests/bug76249.phpt||ext/iconv/tests/bug76249.phpt": [
          "File: ext/iconv/tests/bug76249.phpt -> ext/iconv/tests/bug76249.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #76249 (stream filter convert.iconv leads to infinite loop on invalid sequence)",
          "3: --SKIPIF--",
          "4: <?php extension_loaded('iconv') or die('skip iconv extension is not available'); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: $fh = fopen('php://memory', 'rw');",
          "8: fwrite($fh, \"abc\");",
          "9: rewind($fh);",
          "10: stream_filter_append($fh, 'convert.iconv.ucs-2/utf8//IGNORE', STREAM_FILTER_READ, []);",
          "11: $a = stream_get_contents($fh);",
          "12: var_dump(strlen($a));",
          "13: ?>",
          "14: DONE",
          "15: --EXPECTF--",
          "16: Warning: stream_get_contents(): iconv stream filter (\"ucs-2\"=>\"utf8//IGNORE\"): invalid multibyte sequence in %sbug76249.php on line %d",
          "17: int(3)",
          "18: DONE",
          "",
          "---------------"
        ],
        "ext/ldap/ldap.c||ext/ldap/ldap.c": [
          "File: ext/ldap/ldap.c -> ext/ldap/ldap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1171:   add_assoc_long(&tmp1, \"count\", num_attrib);",
          "1172:   dn = ldap_get_dn(ldap, ldap_result_entry);",
          "1174: #if (LDAP_API_VERSION > 2000) || HAVE_NSLDAP || HAVE_ORALDAP || WINDOWS",
          "1175:   ldap_memfree(dn);",
          "1176: #else",
          "",
          "[Removed Lines]",
          "1173:   add_assoc_string(&tmp1, \"dn\", dn);",
          "",
          "[Added Lines]",
          "1173:   if (dn) {",
          "1174:    add_assoc_string(&tmp1, \"dn\", dn);",
          "1175:   } else {",
          "1176:    add_assoc_null(&tmp1, \"dn\");",
          "1177:   }",
          "",
          "---------------"
        ],
        "ext/ldap/tests/bug76248.phpt||ext/ldap/tests/bug76248.phpt": [
          "File: ext/ldap/tests/bug76248.phpt -> ext/ldap/tests/bug76248.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #76248 (Malicious LDAP-Server Response causes Crash)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: require_once('skipif.inc');",
          "6: if (!function_exists('pcntl_fork')) die('skip fork not available');",
          "7: ?>",
          "8: --FILE--",
          "9: <?php",
          "10: $pid = pcntl_fork();",
          "11: const PORT = 12345;",
          "12: if ($pid == 0) {",
          "14:     $server = stream_socket_server(\"tcp://127.0.0.1:12345\");",
          "15:  $socket = stream_socket_accept($server, 3);",
          "16:  fwrite($socket, base64_decode(\"MAwCAQFhBwoBAAQABAAweQIBAmR0BJljbj1yb290LGRjPWV4YW1wbGUsZGM9Y29tMFcwIwQLb2JqZWN0Q2xhc3MxFAQSb3JnYW5pemF0aW9uYWxSb2xlMAwEAmNuMQYEBHJvb3QwIgQLZGVzY3JpcHRpb24xEwQRRGlyZWN0b3J5IE1hbmFnZXIwDAIBAmUHCgEABAAEADB5AgEDZHQEmWNuPXJvb3QsZGM9ZXhhbXBsZSxkYz1jb20wVzAjBAtvYmplY3RDbGFzczEUBBJvcmdhbml6YXRpb25hbFJvbGUwDAQCY24xBgQEcm9vdDAiBAtkZXNjcmlwdGlvbjETBBFEaXJlY3RvcnkgTWFuYWdlcjAMAgEDZQcKAQAEAAQA\"));",
          "17:  fflush($socket);",
          "18: } else {",
          "20:  $ds = ldap_connect(\"127.0.0.1\", PORT);",
          "21:  ldap_set_option($ds, LDAP_OPT_PROTOCOL_VERSION, 3);",
          "22:  $b = ldap_bind($ds, \"cn=root,dc=example,dc=com\", \"secret\");",
          "24:  $s = ldap_search($ds, \"dc=example,dc=com\", \"(cn=root)\");",
          "25:  $tt = ldap_get_entries($ds, $s);",
          "26:  var_dump($tt);",
          "27: }",
          "28: ?>",
          "29: --EXPECT--",
          "30: array(2) {",
          "31:   [\"count\"]=>",
          "32:   int(1)",
          "33:   [0]=>",
          "34:   array(2) {",
          "35:     [\"count\"]=>",
          "36:     int(0)",
          "37:     [\"dn\"]=>",
          "38:     NULL",
          "39:   }",
          "40: }",
          "",
          "---------------"
        ],
        "ext/phar/phar_object.c||ext/phar/phar_object.c": [
          "File: ext/phar/phar_object.c -> ext/phar/phar_object.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "308:  sapi_header_op(SAPI_HEADER_REPLACE, &ctr);",
          "309:  sapi_send_headers();",
          "310:  PHPWRITE(\"<html>\\n <head>\\n  <title>Access Denied</title>\\n </head>\\n <body>\\n  <h1>403 - File \", sizeof(\"<html>\\n <head>\\n  <title>Access Denied</title>\\n </head>\\n <body>\\n  <h1>403 - File \") - 1);",
          "313: }",
          "",
          "[Removed Lines]",
          "311:  PHPWRITE(entry, entry_len);",
          "312:  PHPWRITE(\" Access Denied</h1>\\n </body>\\n</html>\", sizeof(\" Access Denied</h1>\\n </body>\\n</html>\") - 1);",
          "",
          "[Added Lines]",
          "311:  PHPWRITE(\"Access Denied</h1>\\n </body>\\n</html>\", sizeof(\"Access Denied</h1>\\n </body>\\n</html>\") - 1);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "333:  sapi_header_op(SAPI_HEADER_REPLACE, &ctr);",
          "334:  sapi_send_headers();",
          "335:  PHPWRITE(\"<html>\\n <head>\\n  <title>File Not Found</title>\\n </head>\\n <body>\\n  <h1>404 - File \", sizeof(\"<html>\\n <head>\\n  <title>File Not Found</title>\\n </head>\\n <body>\\n  <h1>404 - File \") - 1);",
          "338: }",
          "",
          "[Removed Lines]",
          "336:  PHPWRITE(entry, entry_len);",
          "337:  PHPWRITE(\" Not Found</h1>\\n </body>\\n</html>\",  sizeof(\" Not Found</h1>\\n </body>\\n</html>\") - 1);",
          "",
          "[Added Lines]",
          "335:  PHPWRITE(\"Not Found</h1>\\n </body>\\n</html>\",  sizeof(\"Not Found</h1>\\n </body>\\n</html>\") - 1);",
          "",
          "---------------"
        ],
        "ext/phar/tests/cache_list/frontcontroller10.phpt||ext/phar/tests/cache_list/frontcontroller10.phpt": [
          "File: ext/phar/tests/cache_list/frontcontroller10.phpt -> ext/phar/tests/cache_list/frontcontroller10.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "20:   <title>Access Denied</title>",
          "21:  </head>",
          "22:  <body>",
          "24:  </body>",
          "25: </html>",
          "",
          "[Removed Lines]",
          "23:   <h1>403 - File /hi Access Denied</h1>",
          "",
          "[Added Lines]",
          "23:   <h1>403 - File Access Denied</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/cache_list/frontcontroller6.phpt||ext/phar/tests/cache_list/frontcontroller6.phpt": [
          "File: ext/phar/tests/cache_list/frontcontroller6.phpt -> ext/phar/tests/cache_list/frontcontroller6.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:   <title>File Not Found</title>",
          "19:  </head>",
          "20:  <body>",
          "22:  </body>",
          "23: </html>",
          "",
          "[Removed Lines]",
          "21:   <h1>404 - File /notfound.php Not Found</h1>",
          "",
          "[Added Lines]",
          "21:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/cache_list/frontcontroller8.phpt||ext/phar/tests/cache_list/frontcontroller8.phpt": [
          "File: ext/phar/tests/cache_list/frontcontroller8.phpt -> ext/phar/tests/cache_list/frontcontroller8.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:   <title>File Not Found</title>",
          "19:  </head>",
          "20:  <body>",
          "22:  </body>",
          "23: </html>",
          "",
          "[Removed Lines]",
          "21:   <h1>404 - File /index.php Not Found</h1>",
          "",
          "[Added Lines]",
          "21:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/frontcontroller10.phpt||ext/phar/tests/frontcontroller10.phpt": [
          "File: ext/phar/tests/frontcontroller10.phpt -> ext/phar/tests/frontcontroller10.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:   <title>Access Denied</title>",
          "20:  </head>",
          "21:  <body>",
          "23:  </body>",
          "24: </html>",
          "",
          "[Removed Lines]",
          "22:   <h1>403 - File /hi Access Denied</h1>",
          "",
          "[Added Lines]",
          "22:   <h1>403 - File Access Denied</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/frontcontroller6.phpt||ext/phar/tests/frontcontroller6.phpt": [
          "File: ext/phar/tests/frontcontroller6.phpt -> ext/phar/tests/frontcontroller6.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /notfound.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/frontcontroller8.phpt||ext/phar/tests/frontcontroller8.phpt": [
          "File: ext/phar/tests/frontcontroller8.phpt -> ext/phar/tests/frontcontroller8.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /index.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/tar/frontcontroller10.phar.phpt||ext/phar/tests/tar/frontcontroller10.phar.phpt": [
          "File: ext/phar/tests/tar/frontcontroller10.phar.phpt -> ext/phar/tests/tar/frontcontroller10.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:   <title>Access Denied</title>",
          "20:  </head>",
          "21:  <body>",
          "23:  </body>",
          "24: </html>",
          "",
          "[Removed Lines]",
          "22:   <h1>403 - File /hi Access Denied</h1>",
          "",
          "[Added Lines]",
          "22:   <h1>403 - File Access Denied</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/tar/frontcontroller6.phar.phpt||ext/phar/tests/tar/frontcontroller6.phar.phpt": [
          "File: ext/phar/tests/tar/frontcontroller6.phar.phpt -> ext/phar/tests/tar/frontcontroller6.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /notfound.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/tar/frontcontroller8.phar.phpt||ext/phar/tests/tar/frontcontroller8.phar.phpt": [
          "File: ext/phar/tests/tar/frontcontroller8.phar.phpt -> ext/phar/tests/tar/frontcontroller8.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /index.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/zip/frontcontroller10.phar.phpt||ext/phar/tests/zip/frontcontroller10.phar.phpt": [
          "File: ext/phar/tests/zip/frontcontroller10.phar.phpt -> ext/phar/tests/zip/frontcontroller10.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:   <title>Access Denied</title>",
          "20:  </head>",
          "21:  <body>",
          "23:  </body>",
          "24: </html>",
          "",
          "[Removed Lines]",
          "22:   <h1>403 - File /hi Access Denied</h1>",
          "",
          "[Added Lines]",
          "22:   <h1>403 - File Access Denied</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/zip/frontcontroller6.phar.phpt||ext/phar/tests/zip/frontcontroller6.phar.phpt": [
          "File: ext/phar/tests/zip/frontcontroller6.phar.phpt -> ext/phar/tests/zip/frontcontroller6.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "17:   <title>File Not Found</title>",
          "18:  </head>",
          "19:  <body>",
          "21:  </body>",
          "22: </html>",
          "",
          "[Removed Lines]",
          "20:   <h1>404 - File /notfound.php Not Found</h1>",
          "",
          "[Added Lines]",
          "20:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ],
        "ext/phar/tests/zip/frontcontroller8.phar.phpt||ext/phar/tests/zip/frontcontroller8.phar.phpt": [
          "File: ext/phar/tests/zip/frontcontroller8.phar.phpt -> ext/phar/tests/zip/frontcontroller8.phar.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   <title>File Not Found</title>",
          "17:  </head>",
          "18:  <body>",
          "20:  </body>",
          "21: </html>",
          "",
          "[Removed Lines]",
          "19:   <h1>404 - File /index.php Not Found</h1>",
          "",
          "[Added Lines]",
          "19:   <h1>404 - File Not Found</h1>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7cf491b661ee57a11b79f99416c6296bae2f27a0",
      "candidate_info": {
        "commit_hash": "7cf491b661ee57a11b79f99416c6296bae2f27a0",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/7cf491b661ee57a11b79f99416c6296bae2f27a0",
        "files": [
          "ext/standard/http_fopen_wrapper.c",
          "ext/standard/tests/http/bug75981.phpt"
        ],
        "message": "Fix bug #75981: prevent reading beyond buffer start",
        "before_after_code_files": [
          "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
          "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
            "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
          ],
          "candidate": [
            "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
            "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c": [
          "File: ext/standard/http_fopen_wrapper.c -> ext/standard/http_fopen_wrapper.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "718:         tmp_line, response_code);",
          "719:     }",
          "720:    }",
          "722:     --tmp_line_len;",
          "724:      --tmp_line_len;",
          "725:     }",
          "726:    }",
          "",
          "[Removed Lines]",
          "721:    if (tmp_line[tmp_line_len - 1] == '\\n') {",
          "723:     if (tmp_line[tmp_line_len - 1] == '\\r') {",
          "",
          "[Added Lines]",
          "721:    if (tmp_line_len >= 1 && tmp_line[tmp_line_len - 1] == '\\n') {",
          "723:     if (tmp_line_len >= 1 &&tmp_line[tmp_line_len - 1] == '\\r') {",
          "",
          "---------------"
        ],
        "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt": [
          "File: ext/standard/tests/http/bug75981.phpt -> ext/standard/tests/http/bug75981.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #75981 (stack-buffer-overflow while parsing HTTP response)",
          "3: --INI--",
          "4: allow_url_fopen=1",
          "5: --SKIPIF--",
          "6: <?php require 'server.inc'; http_server_skipif('tcp://127.0.0.1:12342'); ?>",
          "7: --FILE--",
          "8: <?php",
          "9: require 'server.inc';",
          "11: $options = [",
          "12:   'http' => [",
          "13:     'protocol_version' => '1.1',",
          "14:     'header' => 'Connection: Close'",
          "15:   ],",
          "16: ];",
          "18: $ctx = stream_context_create($options);",
          "20: $responses = [",
          "21:  \"data://text/plain,000000000100\\xA\\xA\"",
          "22: ];",
          "23: $pid = http_server('tcp://127.0.0.1:12342', $responses);",
          "25: echo @file_get_contents('http://127.0.0.1:12342/', false, $ctx);",
          "27: http_server_kill($pid);",
          "29: ?>",
          "30: DONE",
          "31: --EXPECT--",
          "32: DONE",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "51fe6b9ebfb9098780b8c50fef50d332cf21480f",
      "candidate_info": {
        "commit_hash": "51fe6b9ebfb9098780b8c50fef50d332cf21480f",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/51fe6b9ebfb9098780b8c50fef50d332cf21480f",
        "files": [
          "ext/standard/http_fopen_wrapper.c",
          "ext/standard/tests/http/bug75981.phpt"
        ],
        "message": "Fix bug #75981: prevent reading beyond buffer start",
        "before_after_code_files": [
          "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
          "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
            "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
          ],
          "candidate": [
            "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c",
            "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/http_fopen_wrapper.c||ext/standard/http_fopen_wrapper.c": [
          "File: ext/standard/http_fopen_wrapper.c -> ext/standard/http_fopen_wrapper.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "736:         tmp_line, response_code);",
          "737:     }",
          "738:    }",
          "740:     --tmp_line_len;",
          "742:      --tmp_line_len;",
          "743:     }",
          "744:    }",
          "",
          "[Removed Lines]",
          "739:    if (tmp_line[tmp_line_len - 1] == '\\n') {",
          "741:     if (tmp_line[tmp_line_len - 1] == '\\r') {",
          "",
          "[Added Lines]",
          "739:    if (tmp_line_len >= 1 && tmp_line[tmp_line_len - 1] == '\\n') {",
          "741:     if (tmp_line_len >= 1 &&tmp_line[tmp_line_len - 1] == '\\r') {",
          "",
          "---------------"
        ],
        "ext/standard/tests/http/bug75981.phpt||ext/standard/tests/http/bug75981.phpt": [
          "File: ext/standard/tests/http/bug75981.phpt -> ext/standard/tests/http/bug75981.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #75981 (stack-buffer-overflow while parsing HTTP response)",
          "3: --INI--",
          "4: allow_url_fopen=1",
          "5: --SKIPIF--",
          "6: <?php require 'server.inc'; http_server_skipif('tcp://127.0.0.1:12342'); ?>",
          "7: --FILE--",
          "8: <?php",
          "9: require 'server.inc';",
          "11: $options = [",
          "12:   'http' => [",
          "13:     'protocol_version' => '1.1',",
          "14:     'header' => 'Connection: Close'",
          "15:   ],",
          "16: ];",
          "18: $ctx = stream_context_create($options);",
          "20: $responses = [",
          "21:  \"data://text/plain,000000000100\\xA\\xA\"",
          "22: ];",
          "23: $pid = http_server('tcp://127.0.0.1:12342', $responses);",
          "25: echo @file_get_contents('http://127.0.0.1:12342/', false, $ctx);",
          "27: http_server_kill($pid);",
          "29: ?>",
          "30: DONE",
          "31: --EXPECT--",
          "32: DONE",
          "",
          "---------------"
        ]
      }
    }
  ]
}