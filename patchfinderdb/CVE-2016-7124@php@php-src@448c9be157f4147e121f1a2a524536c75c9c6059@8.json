{
  "cve_id": "CVE-2016-7124",
  "cve_desc": "ext/standard/var_unserializer.c in PHP before 5.6.25 and 7.x before 7.0.10 mishandles certain invalid objects, which allows remote attackers to cause a denial of service or possibly have unspecified other impact via crafted serialized data that leads to a (1) __destruct call or (2) magic method call.",
  "repo": "php/php-src",
  "patch_hash": "448c9be157f4147e121f1a2a524536c75c9c6059",
  "patch_info": {
    "commit_hash": "448c9be157f4147e121f1a2a524536c75c9c6059",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/448c9be157f4147e121f1a2a524536c75c9c6059",
    "files": [
      "ext/standard/tests/strings/bug72663.phpt",
      "ext/standard/tests/strings/bug72663_2.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #72663 - destroy broken object when unserializing",
    "before_after_code_files": [
      "ext/standard/tests/strings/bug72663.phpt||ext/standard/tests/strings/bug72663.phpt",
      "ext/standard/tests/strings/bug72663_2.phpt||ext/standard/tests/strings/bug72663_2.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/strings/bug72663.phpt||ext/standard/tests/strings/bug72663.phpt": [
      "File: ext/standard/tests/strings/bug72663.phpt -> ext/standard/tests/strings/bug72663.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #72663: Create an Unexpected Object and Don't Invoke __wakeup() in Deserialization",
      "3: --FILE--",
      "4: <?php",
      "5: class obj implements Serializable {",
      "6:     var $data;",
      "7:     function serialize() {",
      "8:         return serialize($this->data);",
      "9:     }",
      "10:     function unserialize($data) {",
      "11:         $this->data = unserialize($data);",
      "12:     }",
      "13: }",
      "15: $inner = 'a:1:{i:0;O:9:\"Exception\":2:{s:7:\"'.\"\\0\".'*'.\"\\0\".'file\";R:4;}';",
      "16: $exploit = 'a:2:{i:0;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}i:1;R:4;}';",
      "18: $data = unserialize($exploit);",
      "19: echo $data[1];",
      "20: ?>",
      "21: DONE",
      "22: --EXPECTF--",
      "23: Notice: unserialize(): Unexpected end of serialized data in %sbug72663.php on line %d",
      "25: Notice: unserialize(): Error at offset 46 of 47 bytes in %sbug72663.php on line %d",
      "26: DONE",
      "",
      "---------------"
    ],
    "ext/standard/tests/strings/bug72663_2.phpt||ext/standard/tests/strings/bug72663_2.phpt": [
      "File: ext/standard/tests/strings/bug72663_2.phpt -> ext/standard/tests/strings/bug72663_2.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #72663: Create an Unexpected Object and Don't Invoke __wakeup() in Deserialization",
      "3: --FILE--",
      "4: <?php",
      "6: ini_set('session.serialize_handler', 'php_serialize');",
      "7: session_start();",
      "8: $sess = 'O:9:\"Exception\":2:{s:7:\"'.\"\\0\".'*'.\"\\0\".'file\";R:1;}';",
      "9: session_decode($sess);",
      "10: var_dump($_SESSION);",
      "11: ?>",
      "12: DONE",
      "13: --EXPECTF--",
      "14: Notice: session_decode(): Unexpected end of serialized data in %sbug72663_2.php on line %d",
      "15: array(0) {",
      "16: }",
      "17: DONE",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "434:  }",
      "436:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_OBJPROP_PP(rval), elements, 1)) {",
      "437:   return 0;",
      "438:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "438:      zend_hash_clean(Z_OBJPROP_PP(rval));",
      "439:      ZVAL_NULL(*rval);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "486: {",
      "487:  YYCTYPE yych;",
      "488:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "485: #line 486 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "488: #line 489 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "542:  yych = *(YYMARKER = ++YYCURSOR);",
      "543:  if (yych == ':') goto yy95;",
      "544: yy3:",
      "546:  { return 0; }",
      "548: yy4:",
      "549:  yych = *(YYMARKER = ++YYCURSOR);",
      "550:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "545: #line 851 \"ext/standard/var_unserializer.re\"",
      "547: #line 548 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "548: #line 854 \"ext/standard/var_unserializer.re\"",
      "550: #line 551 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "587:  goto yy3;",
      "588: yy14:",
      "589:  ++YYCURSOR;",
      "591:  {",
      "593:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "595: }",
      "597: yy16:",
      "598:  yych = *++YYCURSOR;",
      "599:  goto yy3;",
      "",
      "[Removed Lines]",
      "590: #line 845 \"ext/standard/var_unserializer.re\"",
      "596: #line 597 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "593: #line 848 \"ext/standard/var_unserializer.re\"",
      "599: #line 600 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "619:  if (yybm[0+yych] & 128) {",
      "620:   goto yy20;",
      "621:  }",
      "623:  yych = *++YYCURSOR;",
      "624:  if (yych != '\"') goto yy18;",
      "625:  ++YYCURSOR;",
      "627:  {",
      "628:  size_t len, len2, len3, maxlen;",
      "629:  long elements;",
      "",
      "[Removed Lines]",
      "622:  if (yych != ':') goto yy18;",
      "626: #line 698 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "625:  if (yych <= '/') goto yy18;",
      "626:  if (yych >= ';') goto yy18;",
      "630: #line 701 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "771:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "772: }",
      "774: yy25:",
      "775:  yych = *++YYCURSOR;",
      "776:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "773: #line 774 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "777: #line 778 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "795:  yych = *++YYCURSOR;",
      "796:  if (yych != '\"') goto yy18;",
      "797:  ++YYCURSOR;",
      "799:  {",
      "800:     if (!var_hash) return 0;",
      "",
      "[Removed Lines]",
      "798: #line 689 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "802: #line 692 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "804:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "805:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "806: }",
      "808: yy32:",
      "809:  yych = *++YYCURSOR;",
      "810:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "807: #line 808 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "811: #line 812 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "825:  yych = *++YYCURSOR;",
      "826:  if (yych != '{') goto yy18;",
      "827:  ++YYCURSOR;",
      "829:  {",
      "830:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "828: #line 668 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "832: #line 671 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "847:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "848: }",
      "850: yy39:",
      "851:  yych = *++YYCURSOR;",
      "852:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "849: #line 850 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "853: #line 854 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "867:  yych = *++YYCURSOR;",
      "868:  if (yych != '\"') goto yy18;",
      "869:  ++YYCURSOR;",
      "871:  {",
      "872:  size_t len, maxlen;",
      "873:  char *str;",
      "",
      "[Removed Lines]",
      "870: #line 633 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "874: #line 636 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "902:  ZVAL_STRINGL(*rval, str, len, 0);",
      "903:  return 1;",
      "904: }",
      "906: yy46:",
      "907:  yych = *++YYCURSOR;",
      "908:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "905: #line 906 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "909: #line 910 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "923:  yych = *++YYCURSOR;",
      "924:  if (yych != '\"') goto yy18;",
      "925:  ++YYCURSOR;",
      "927:  {",
      "928:  size_t len, maxlen;",
      "929:  char *str;",
      "",
      "[Removed Lines]",
      "926: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "930: #line 603 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "956:  ZVAL_STRINGL(*rval, str, len, 1);",
      "957:  return 1;",
      "958: }",
      "960: yy53:",
      "961:  yych = *++YYCURSOR;",
      "962:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "959: #line 960 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "963: #line 964 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1044:  }",
      "1045: yy63:",
      "1046:  ++YYCURSOR;",
      "1048:  {",
      "1049: #if SIZEOF_LONG == 4",
      "1050: use_double:",
      "",
      "[Removed Lines]",
      "1047: #line 590 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1051: #line 593 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1054:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1055:  return 1;",
      "1056: }",
      "1058: yy65:",
      "1059:  yych = *++YYCURSOR;",
      "1060:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1057: #line 1058 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1061: #line 1062 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1113:  yych = *++YYCURSOR;",
      "1114:  if (yych != ';') goto yy18;",
      "1115:  ++YYCURSOR;",
      "1117:  {",
      "1119:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1116: #line 575 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1120: #line 578 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1129:  return 1;",
      "1130: }",
      "1132: yy76:",
      "1133:  yych = *++YYCURSOR;",
      "1134:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1131: #line 1132 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1135: #line 1136 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1155:  if (yych <= '9') goto yy79;",
      "1156:  if (yych != ';') goto yy18;",
      "1157:  ++YYCURSOR;",
      "1159:  {",
      "1160: #if SIZEOF_LONG == 4",
      "1161:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1158: #line 548 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1162: #line 551 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1182:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1183:  return 1;",
      "1184: }",
      "1186: yy83:",
      "1187:  yych = *++YYCURSOR;",
      "1188:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1185: #line 1186 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1189: #line 1190 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1190:  yych = *++YYCURSOR;",
      "1191:  if (yych != ';') goto yy18;",
      "1192:  ++YYCURSOR;",
      "1194:  {",
      "1196:  INIT_PZVAL(*rval);",
      "1197:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1198:  return 1;",
      "1199: }",
      "1201: yy87:",
      "1202:  ++YYCURSOR;",
      "1204:  {",
      "1206:  INIT_PZVAL(*rval);",
      "1207:  ZVAL_NULL(*rval);",
      "1208:  return 1;",
      "1209: }",
      "1211: yy89:",
      "1212:  yych = *++YYCURSOR;",
      "1213:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1193: #line 541 \"ext/standard/var_unserializer.re\"",
      "1200: #line 1201 \"ext/standard/var_unserializer.c\"",
      "1203: #line 534 \"ext/standard/var_unserializer.re\"",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1197: #line 544 \"ext/standard/var_unserializer.re\"",
      "1204: #line 1205 \"ext/standard/var_unserializer.c\"",
      "1207: #line 537 \"ext/standard/var_unserializer.re\"",
      "1214: #line 1215 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1230:  if (yych <= '9') goto yy91;",
      "1231:  if (yych != ';') goto yy18;",
      "1232:  ++YYCURSOR;",
      "1234:  {",
      "1235:  long id;",
      "",
      "[Removed Lines]",
      "1233: #line 511 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1237: #line 514 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1254:  return 1;",
      "1255: }",
      "1257: yy95:",
      "1258:  yych = *++YYCURSOR;",
      "1259:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1256: #line 1257 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1260: #line 1261 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1276:  if (yych <= '9') goto yy97;",
      "1277:  if (yych != ';') goto yy18;",
      "1278:  ++YYCURSOR;",
      "1280:  {",
      "1281:  long id;",
      "",
      "[Removed Lines]",
      "1279: #line 490 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1283: #line 493 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1298:  return 1;",
      "1299: }",
      "1301: }",
      "1305:  return 0;",
      "",
      "[Removed Lines]",
      "1300: #line 1301 \"ext/standard/var_unserializer.c\"",
      "1302: #line 853 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1304: #line 1305 \"ext/standard/var_unserializer.c\"",
      "1306: #line 856 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "438:  }",
      "440:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_OBJPROP_PP(rval), elements, 1)) {",
      "441:   return 0;",
      "442:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "442:      zend_hash_clean(Z_OBJPROP_PP(rval));",
      "443:      ZVAL_NULL(*rval);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
      "candidate_info": {
        "commit_hash": "fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
        "files": [
          "ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Also fixed 'r'",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt": [
          "File: ext/standard/tests/serialize/bug70963.phpt -> ext/standard/tests/serialize/bug70963.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: --FILE--",
          "4: <?php",
          "5: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;R:3;}'));",
          "6: ?>",
          "7: --EXPECTF--",
          "9:   [0]=>",
          "10:   object(Exception)#%d (5) {",
          "11:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "8: array(2) {",
          "",
          "[Added Lines]",
          "6: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;r:3;}'));",
          "9: array(1) {",
          "10:   [0]=>",
          "11:   object(Exception)#%d (5) {",
          "12:     [\"message\":protected]=>",
          "13:     string(0) \"\"",
          "14:     [\"string\":\"Exception\":private]=>",
          "15:     string(0) \"\"",
          "16:     [\"code\":protected]=>",
          "17:     int(0)",
          "18:     [\"file\":protected]=>",
          "19:     string(%d) \"%s\"",
          "20:     [\"line\":protected]=>",
          "21:     int(%d)",
          "22:   }",
          "23: }",
          "24: array(1) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "365:    }",
          "366:   }",
          "370:   if (!php_var_unserialize_ex(data, p, max, var_hash, classes)) {",
          "371:    return 0;",
          "372:   }",
          "376:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "377:    (*p)--;",
          "",
          "[Removed Lines]",
          "368:   zval_dtor(&key);",
          "374:   var_push_dtor(var_hash, data);",
          "",
          "[Added Lines]",
          "369:    zval_dtor(&key);",
          "373:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "374:    if (Z_TYPE(key) == IS_LONG) {",
          "375:     zend_hash_index_del(ht, Z_LVAL(key));",
          "376:    } else {",
          "377:     zend_hash_del_ind(ht, Z_STR(key));",
          "378:    }",
          "379:   } else {",
          "380:    var_push_dtor(var_hash, data);",
          "381:   }",
          "383:   zval_dtor(&key);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "505:  start = cursor;",
          "509: {",
          "510:  YYCTYPE yych;",
          "511:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "508: #line 509 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "517: #line 518 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "565:  yych = *(YYMARKER = ++YYCURSOR);",
          "566:  if (yych == ':') goto yy95;",
          "567: yy3:",
          "569:  { return 0; }",
          "571: yy4:",
          "572:  yych = *(YYMARKER = ++YYCURSOR);",
          "573:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "568: #line 857 \"ext/standard/var_unserializer.re\"",
          "570: #line 571 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "577: #line 869 \"ext/standard/var_unserializer.re\"",
          "579: #line 580 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "610:  goto yy3;",
          "611: yy14:",
          "612:  ++YYCURSOR;",
          "614:  {",
          "616:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "618: }",
          "620: yy16:",
          "621:  yych = *++YYCURSOR;",
          "622:  goto yy3;",
          "",
          "[Removed Lines]",
          "613: #line 851 \"ext/standard/var_unserializer.re\"",
          "619: #line 620 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "622: #line 863 \"ext/standard/var_unserializer.re\"",
          "628: #line 629 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "646:  yych = *++YYCURSOR;",
          "647:  if (yych != '\"') goto yy18;",
          "648:  ++YYCURSOR;",
          "650:  {",
          "651:  size_t len, len2, len3, maxlen;",
          "652:  zend_long elements;",
          "",
          "[Removed Lines]",
          "649: #line 706 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "658: #line 718 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "792:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "793: }",
          "795: yy25:",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "794: #line 795 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "803: #line 804 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "816:  yych = *++YYCURSOR;",
          "817:  if (yych != '\"') goto yy18;",
          "818:  ++YYCURSOR;",
          "820:  {",
          "821:     if (!var_hash) return 0;",
          "823:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "824:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "825: }",
          "827: yy32:",
          "828:  yych = *++YYCURSOR;",
          "829:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "819: #line 699 \"ext/standard/var_unserializer.re\"",
          "826: #line 827 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "828: #line 711 \"ext/standard/var_unserializer.re\"",
          "835: #line 836 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "844:  yych = *++YYCURSOR;",
          "845:  if (yych != '{') goto yy18;",
          "846:  ++YYCURSOR;",
          "848:  {",
          "849:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "847: #line 675 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "856: #line 687 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "869:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "870: }",
          "872: yy39:",
          "873:  yych = *++YYCURSOR;",
          "874:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "871: #line 872 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "880: #line 881 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "889:  yych = *++YYCURSOR;",
          "890:  if (yych != '\"') goto yy18;",
          "891:  ++YYCURSOR;",
          "893:  {",
          "894:  size_t len, maxlen;",
          "895:  zend_string *str;",
          "",
          "[Removed Lines]",
          "892: #line 647 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "901: #line 659 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "917:  ZVAL_STR(rval, str);",
          "918:  return 1;",
          "919: }",
          "921: yy46:",
          "922:  yych = *++YYCURSOR;",
          "923:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "920: #line 921 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "929: #line 930 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych != '\"') goto yy18;",
          "940:  ++YYCURSOR;",
          "942:  {",
          "943:  size_t len, maxlen;",
          "944:  char *str;",
          "",
          "[Removed Lines]",
          "941: #line 620 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "950: #line 632 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "965:  ZVAL_STRINGL(rval, str, len);",
          "966:  return 1;",
          "967: }",
          "969: yy53:",
          "970:  yych = *++YYCURSOR;",
          "971:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "968: #line 969 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1053:  }",
          "1054: yy63:",
          "1055:  ++YYCURSOR;",
          "1057:  {",
          "1058: #if SIZEOF_ZEND_LONG == 4",
          "1059: use_double:",
          "",
          "[Removed Lines]",
          "1056: #line 611 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1065: #line 623 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1062:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1063:  return 1;",
          "1064: }",
          "1066: yy65:",
          "1067:  yych = *++YYCURSOR;",
          "1068:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1065: #line 1066 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1121:  yych = *++YYCURSOR;",
          "1122:  if (yych != ';') goto yy18;",
          "1123:  ++YYCURSOR;",
          "1125:  {",
          "",
          "[Removed Lines]",
          "1124: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1133: #line 607 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1138:  return 1;",
          "1139: }",
          "1141: yy76:",
          "1142:  yych = *++YYCURSOR;",
          "1143:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1140: #line 1141 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1149: #line 1150 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1164:  if (yych <= '9') goto yy79;",
          "1165:  if (yych != ';') goto yy18;",
          "1166:  ++YYCURSOR;",
          "1168:  {",
          "1169: #if SIZEOF_ZEND_LONG == 4",
          "1170:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1167: #line 569 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1176: #line 581 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1190:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1191:  return 1;",
          "1192: }",
          "1194: yy83:",
          "1195:  yych = *++YYCURSOR;",
          "1196:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1202: #line 1203 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych != ';') goto yy18;",
          "1200:  ++YYCURSOR;",
          "1202:  {",
          "1204:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1205:  return 1;",
          "1206: }",
          "1208: yy87:",
          "1209:  ++YYCURSOR;",
          "1211:  {",
          "1213:  ZVAL_NULL(rval);",
          "1214:  return 1;",
          "1215: }",
          "1217: yy89:",
          "1218:  yych = *++YYCURSOR;",
          "1219:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1201: #line 563 \"ext/standard/var_unserializer.re\"",
          "1207: #line 1208 \"ext/standard/var_unserializer.c\"",
          "1210: #line 557 \"ext/standard/var_unserializer.re\"",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1210: #line 575 \"ext/standard/var_unserializer.re\"",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "1219: #line 569 \"ext/standard/var_unserializer.re\"",
          "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1236:  if (yych <= '9') goto yy91;",
          "1237:  if (yych != ';') goto yy18;",
          "1238:  ++YYCURSOR;",
          "1240:  {",
          "1241:  zend_long id;",
          "",
          "[Removed Lines]",
          "1239: #line 541 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1248: #line 548 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1248:   return 0;",
          "1249:  }",
          "1251:  ZVAL_COPY(rval, rval_ref);",
          "1253:  return 1;",
          "1254: }",
          "1256: yy95:",
          "1257:  yych = *++YYCURSOR;",
          "1258:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1255: #line 1256 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1260:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1261:   ZVAL_UNDEF(rval);",
          "1262:   return 1;",
          "1263:  }",
          "1269: #line 1270 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1275:  if (yych <= '9') goto yy97;",
          "1276:  if (yych != ';') goto yy18;",
          "1277:  ++YYCURSOR;",
          "1279:  {",
          "1280:  zend_long id;",
          "",
          "[Removed Lines]",
          "1278: #line 513 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1292: #line 522 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1288:  }",
          "1290:  zval_ptr_dtor(rval);",
          "1298:   ZVAL_UNDEF(rval);",
          "1299:  } else {",
          "1300:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1301:   ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "1291:  if (Z_ISREF_P(rval_ref)) {",
          "1292:   if (!Z_ISUNDEF_P(Z_REFVAL_P(rval_ref))) {",
          "1293:    ZVAL_COPY(rval, rval_ref);",
          "1294:   } else {",
          "1295:    ZVAL_UNDEF(rval);",
          "1296:   }",
          "1297:  } else if (Z_ISUNDEF_P(rval_ref)) {",
          "",
          "[Added Lines]",
          "1305:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1307:   return 1;",
          "1308:  }",
          "1309:  if (Z_ISREF_P(rval_ref)) {",
          "1310:   ZVAL_COPY(rval, rval_ref);",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1304:  return 1;",
          "1305: }",
          "1307: }",
          "1311:  return 0;",
          "",
          "[Removed Lines]",
          "1306: #line 1307 \"ext/standard/var_unserializer.c\"",
          "1308: #line 859 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1318: #line 1319 \"ext/standard/var_unserializer.c\"",
          "1320: #line 871 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "369:    }",
          "370:   }",
          "374:   if (!php_var_unserialize_ex(data, p, max, var_hash, classes)) {",
          "375:    return 0;",
          "376:   }",
          "380:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "381:    (*p)--;",
          "",
          "[Removed Lines]",
          "372:   zval_dtor(&key);",
          "378:   var_push_dtor(var_hash, data);",
          "",
          "[Added Lines]",
          "373:    zval_dtor(&key);",
          "377:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "378:    if (Z_TYPE(key) == IS_LONG) {",
          "379:     zend_hash_index_del(ht, Z_LVAL(key));",
          "380:    } else {",
          "381:     zend_hash_del_ind(ht, Z_STR(key));",
          "382:    }",
          "383:   } else {",
          "384:    var_push_dtor(var_hash, data);",
          "385:   }",
          "387:   zval_dtor(&key);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "522:  }",
          "524:  zval_ptr_dtor(rval);",
          "532:   ZVAL_UNDEF(rval);",
          "533:  } else {",
          "534:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "535:   ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "525:  if (Z_ISREF_P(rval_ref)) {",
          "526:   if (!Z_ISUNDEF_P(Z_REFVAL_P(rval_ref))) {",
          "527:    ZVAL_COPY(rval, rval_ref);",
          "528:   } else {",
          "529:    ZVAL_UNDEF(rval);",
          "530:   }",
          "531:  } else if (Z_ISUNDEF_P(rval_ref)) {",
          "",
          "[Added Lines]",
          "534:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "536:   return 1;",
          "537:  }",
          "538:  if (Z_ISREF_P(rval_ref)) {",
          "539:   ZVAL_COPY(rval, rval_ref);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "549:   return 0;",
          "550:  }",
          "552:  ZVAL_COPY(rval, rval_ref);",
          "554:  return 1;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "559:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "560:   ZVAL_UNDEF(rval);",
          "561:   return 1;",
          "562:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "41115d3d9dc1f7116ac2d1bb7087a24098885a03",
      "candidate_info": {
        "commit_hash": "41115d3d9dc1f7116ac2d1bb7087a24098885a03",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/41115d3d9dc1f7116ac2d1bb7087a24098885a03",
        "files": [
          "ext/date/lib/parse_date.c",
          "ext/pdo/pdo_sql_parser.c",
          "ext/standard/url_scanner_ex.c",
          "ext/standard/var_unserializer.c",
          "sapi/cli/php_cli.c"
        ],
        "message": "regenerated parser files",
        "before_after_code_files": [
          "ext/date/lib/parse_date.c||ext/date/liparse_date.c",
          "ext/pdo/pdo_sql_parser.c||ext/pdo/pdo_sql_parser.c",
          "ext/standard/url_scanner_ex.c||ext/standard/url_scanner_ex.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "sapi/cli/php_cli.c||sapi/cli/php_cli.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/date/lib/parse_date.c||ext/date/liparse_date.c": [
          "File: ext/date/lib/parse_date.c -> ext/date/liparse_date.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:    +----------------------------------------------------------------------+",
          "5:    | PHP Version 5                                                        |",
          "",
          "[Removed Lines]",
          "2: #line 1 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "840: std:",
          "841:  s->tok = cursor;",
          "842:  s->len = 0;",
          "848: {",
          "849:  YYCTYPE yych;",
          "850:  unsigned int yyaccept = 0;",
          "",
          "[Removed Lines]",
          "843: #line 966 \"ext/date/lib/parse_date.re\"",
          "847: #line 848 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "984:  }",
          "985: yy3:",
          "986:  YYDEBUG(3, *YYCURSOR);",
          "988:  {",
          "989:   int tz_not_found;",
          "990:   DEBUG_OUTPUT(\"tzcorrection | tz\");",
          "",
          "[Removed Lines]",
          "987: #line 1646 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "997:   TIMELIB_DEINIT;",
          "998:   return TIMELIB_TIMEZONE;",
          "999:  }",
          "1001: yy4:",
          "1002:  YYDEBUG(4, *YYCURSOR);",
          "1003:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "1000: #line 1001 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1308:  if (yych <= '9') goto yy1385;",
          "1309: yy12:",
          "1310:  YYDEBUG(12, *YYCURSOR);",
          "1312:  {",
          "1313:   add_error(s, \"Unexpected character\");",
          "1314:   goto std;",
          "1315:  }",
          "1317: yy13:",
          "1318:  YYDEBUG(13, *YYCURSOR);",
          "1319:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "1311: #line 1741 \"ext/date/lib/parse_date.re\"",
          "1316: #line 1317 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2370:  if (yych <= '9') goto yy54;",
          "2371: yy49:",
          "2372:  YYDEBUG(49, *YYCURSOR);",
          "2374:  {",
          "2375:   goto std;",
          "2376:  }",
          "2378: yy50:",
          "2379:  YYDEBUG(50, *YYCURSOR);",
          "2380:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "2373: #line 1730 \"ext/date/lib/parse_date.re\"",
          "2377: #line 2378 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2383:  YYDEBUG(51, *YYCURSOR);",
          "2384:  ++YYCURSOR;",
          "2385:  YYDEBUG(52, *YYCURSOR);",
          "2387:  {",
          "2388:   s->pos = cursor; s->line++;",
          "2389:   goto std;",
          "2390:  }",
          "2392: yy53:",
          "2393:  YYDEBUG(53, *YYCURSOR);",
          "2394:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "2386: #line 1735 \"ext/date/lib/parse_date.re\"",
          "2391: #line 2392 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2775:  if (yych == 's') goto yy73;",
          "2776: yy72:",
          "2777:  YYDEBUG(72, *YYCURSOR);",
          "2779:  {",
          "2780:   timelib_ull i;",
          "2781:   DEBUG_OUTPUT(\"relative\");",
          "",
          "[Removed Lines]",
          "2778: #line 1714 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2790:   TIMELIB_DEINIT;",
          "2791:   return TIMELIB_RELATIVE;",
          "2792:  }",
          "2794: yy73:",
          "2795:  YYDEBUG(73, *YYCURSOR);",
          "2796:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "2793: #line 2794 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3552:  }",
          "3553: yy166:",
          "3554:  YYDEBUG(166, *YYCURSOR);",
          "3556:  {",
          "3557:   const timelib_relunit* relunit;",
          "3558:   DEBUG_OUTPUT(\"daytext\");",
          "",
          "[Removed Lines]",
          "3555: #line 1577 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "3569:   TIMELIB_DEINIT;",
          "3570:   return TIMELIB_WEEKDAY;",
          "3571:  }",
          "3573: yy167:",
          "3574:  YYDEBUG(167, *YYCURSOR);",
          "3575:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "3572: #line 3573 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "4089:  }",
          "4090: yy193:",
          "4091:  YYDEBUG(193, *YYCURSOR);",
          "4093:  {",
          "4094:   DEBUG_OUTPUT(\"monthtext\");",
          "4095:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "4092: #line 1636 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "4098:   TIMELIB_DEINIT;",
          "4099:   return TIMELIB_DATE_TEXT;",
          "4100:  }",
          "4102: yy194:",
          "4103:  YYDEBUG(194, *YYCURSOR);",
          "4104:  ++YYCURSOR;",
          "",
          "[Removed Lines]",
          "4101: #line 4102 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "4149:  }",
          "4150: yy198:",
          "4151:  YYDEBUG(198, *YYCURSOR);",
          "4153:  {",
          "4154:   int length = 0;",
          "4155:   DEBUG_OUTPUT(\"datetextual | datenoyear\");",
          "",
          "[Removed Lines]",
          "4152: #line 1382 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "4162:   TIMELIB_DEINIT;",
          "4163:   return TIMELIB_DATE_TEXT;",
          "4164:  }",
          "4166: yy199:",
          "4167:  YYDEBUG(199, *YYCURSOR);",
          "4168:  yyaccept = 6;",
          "",
          "[Removed Lines]",
          "4165: #line 4166 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "4431:  }",
          "4432: yy222:",
          "4433:  YYDEBUG(222, *YYCURSOR);",
          "4435:  {",
          "4436:   int tz_not_found;",
          "4437:   DEBUG_OUTPUT(\"dateshortwithtimeshort | dateshortwithtimelong | dateshortwithtimelongtz\");",
          "",
          "[Removed Lines]",
          "4434: #line 1684 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "4460:   TIMELIB_DEINIT;",
          "4461:   return TIMELIB_SHORTDATE_WITH_TIME;",
          "4462:  }",
          "4464: yy223:",
          "4465:  YYDEBUG(223, *YYCURSOR);",
          "4466:  yyaccept = 7;",
          "",
          "[Removed Lines]",
          "4463: #line 4464 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "5158:  YYDEBUG(277, *YYCURSOR);",
          "5159:  ++YYCURSOR;",
          "5160:  YYDEBUG(278, *YYCURSOR);",
          "5162:  {",
          "5163:   DEBUG_OUTPUT(\"dateshortwithtimeshort12 | dateshortwithtimelong12\");",
          "5164:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "5161: #line 1660 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "5181:   TIMELIB_DEINIT;",
          "5182:   return TIMELIB_SHORTDATE_WITH_TIME;",
          "5183:  }",
          "5185: yy279:",
          "5186:  YYDEBUG(279, *YYCURSOR);",
          "5187:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "5184: #line 5185 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "5359:  ++YYCURSOR;",
          "5360: yy294:",
          "5361:  YYDEBUG(294, *YYCURSOR);",
          "5363:  {",
          "5364:   int length = 0;",
          "5365:   DEBUG_OUTPUT(\"datenoday\");",
          "",
          "[Removed Lines]",
          "5362: #line 1354 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "5372:   TIMELIB_DEINIT;",
          "5373:   return TIMELIB_DATE_NO_DAY;",
          "5374:  }",
          "5376: yy295:",
          "5377:  YYDEBUG(295, *YYCURSOR);",
          "5378:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "5375: #line 5376 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "6592:  if (yych <= '9') goto yy364;",
          "6593: yy363:",
          "6594:  YYDEBUG(363, *YYCURSOR);",
          "6596:  {",
          "6597:   int length = 0;",
          "6598:   DEBUG_OUTPUT(\"pgtextshort\");",
          "",
          "[Removed Lines]",
          "6595: #line 1498 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "6605:   TIMELIB_DEINIT;",
          "6606:   return TIMELIB_PG_TEXT;",
          "6607:  }",
          "6609: yy364:",
          "6610:  YYDEBUG(364, *YYCURSOR);",
          "6611:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "6608: #line 6609 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "7243:  }",
          "7244: yy392:",
          "7245:  YYDEBUG(392, *YYCURSOR);",
          "7247:  {",
          "7248:   DEBUG_OUTPUT(\"ago\");",
          "7249:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "7246: #line 1556 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "7263:   TIMELIB_DEINIT;",
          "7264:   return TIMELIB_AGO;",
          "7265:  }",
          "7267: yy393:",
          "7268:  YYDEBUG(393, *YYCURSOR);",
          "7269:  yyaccept = 5;",
          "",
          "[Removed Lines]",
          "7266: #line 7267 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "9013:  ++YYCURSOR;",
          "9014: yy454:",
          "9015:  YYDEBUG(454, *YYCURSOR);",
          "9017:  {",
          "9018:   DEBUG_OUTPUT(\"iso8601date4 | iso8601date2 | iso8601dateslash | dateslash\");",
          "9019:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "9016: #line 1259 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "9024:   TIMELIB_DEINIT;",
          "9025:   return TIMELIB_ISO_DATE;",
          "9026:  }",
          "9028: yy455:",
          "9029:  YYDEBUG(455, *YYCURSOR);",
          "9030:  yyaccept = 0;",
          "",
          "[Removed Lines]",
          "9027: #line 9028 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "9584:  }",
          "9585: yy475:",
          "9586:  YYDEBUG(475, *YYCURSOR);",
          "9588:  {",
          "9589:   DEBUG_OUTPUT(\"datenoyearrev\");",
          "9590:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "9587: #line 1396 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "9595:   TIMELIB_DEINIT;",
          "9596:   return TIMELIB_DATE_TEXT;",
          "9597:  }",
          "9599: yy476:",
          "9600:  YYDEBUG(476, *YYCURSOR);",
          "9601:  yyaccept = 10;",
          "",
          "[Removed Lines]",
          "9598: #line 9599 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "9736:  YYDEBUG(487, *YYCURSOR);",
          "9737:  ++YYCURSOR;",
          "9738:  YYDEBUG(488, *YYCURSOR);",
          "9740:  {",
          "9741:   DEBUG_OUTPUT(\"timetiny12 | timeshort12 | timelong12\");",
          "9742:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "9739: #line 1114 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "9752:   TIMELIB_DEINIT;",
          "9753:   return TIMELIB_TIME12;",
          "9754:  }",
          "9756: yy489:",
          "9757:  YYDEBUG(489, *YYCURSOR);",
          "9758:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "9755: #line 9756 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "9765:  }",
          "9766: yy490:",
          "9767:  YYDEBUG(490, *YYCURSOR);",
          "9769:  {",
          "9770:   int tz_not_found;",
          "9771:   DEBUG_OUTPUT(\"timeshort24 | timelong24 | iso8601long\");",
          "",
          "[Removed Lines]",
          "9768: #line 1151 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "9790:   TIMELIB_DEINIT;",
          "9791:   return TIMELIB_TIME24_WITH_ZONE;",
          "9792:  }",
          "9794: yy491:",
          "9795:  YYDEBUG(491, *YYCURSOR);",
          "9796:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "9793: #line 9794 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "10100:  YYDEBUG(522, *YYCURSOR);",
          "10101:  ++YYCURSOR;",
          "10102:  YYDEBUG(523, *YYCURSOR);",
          "10104:  {",
          "10105:   DEBUG_OUTPUT(\"mssqltime\");",
          "10106:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "10103: #line 1131 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "10119:   TIMELIB_DEINIT;",
          "10120:   return TIMELIB_TIME24_WITH_ZONE;",
          "10121:  }",
          "10123: yy524:",
          "10124:  YYDEBUG(524, *YYCURSOR);",
          "10125:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "10122: #line 10123 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "10225:  if (yych <= '9') goto yy540;",
          "10226: yy534:",
          "10227:  YYDEBUG(534, *YYCURSOR);",
          "10229:  {",
          "10230:   int length = 0;",
          "10231:   DEBUG_OUTPUT(\"datefull\");",
          "",
          "[Removed Lines]",
          "10228: #line 1313 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "10239:   TIMELIB_DEINIT;",
          "10240:   return TIMELIB_DATE_FULL;",
          "10241:  }",
          "10243: yy535:",
          "10244:  YYDEBUG(535, *YYCURSOR);",
          "10245:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "10242: #line 10243 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "10976:  YYDEBUG(605, *YYCURSOR);",
          "10977:  ++YYCURSOR;",
          "10978:  YYDEBUG(606, *YYCURSOR);",
          "10980:  {",
          "10981:   DEBUG_OUTPUT(\"pointed date YYYY\");",
          "10982:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "10979: #line 1328 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "10987:   TIMELIB_DEINIT;",
          "10988:   return TIMELIB_DATE_FULL_POINTED;",
          "10989:  }",
          "10991: yy607:",
          "10992:  YYDEBUG(607, *YYCURSOR);",
          "10993:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "10990: #line 10991 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "11023:  if (yych <= '9') goto yy604;",
          "11024: yy611:",
          "11025:  YYDEBUG(611, *YYCURSOR);",
          "11027:  {",
          "11028:   int length = 0;",
          "11029:   DEBUG_OUTPUT(\"pointed date YY\");",
          "",
          "[Removed Lines]",
          "11026: #line 1340 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "11036:   TIMELIB_DEINIT;",
          "11037:   return TIMELIB_DATE_FULL_POINTED;",
          "11038:  }",
          "11040: yy612:",
          "11041:  YYDEBUG(612, *YYCURSOR);",
          "11042:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "11039: #line 11040 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "11677:  }",
          "11678: yy656:",
          "11679:  YYDEBUG(656, *YYCURSOR);",
          "11681:  {",
          "11682:   int length = 0;",
          "11683:   DEBUG_OUTPUT(\"gnudateshort\");",
          "",
          "[Removed Lines]",
          "11680: #line 1299 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 43 ---",
          "[Context before]",
          "11690:   TIMELIB_DEINIT;",
          "11691:   return TIMELIB_ISO_DATE;",
          "11692:  }",
          "11694: yy657:",
          "11695:  YYDEBUG(657, *YYCURSOR);",
          "11696:  yyaccept = 13;",
          "",
          "[Removed Lines]",
          "11693: #line 11694 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 44 ---",
          "[Context before]",
          "11796:  }",
          "11797: yy666:",
          "11798:  YYDEBUG(666, *YYCURSOR);",
          "11800:  {",
          "11801:   int length = 0;",
          "11802:   DEBUG_OUTPUT(\"americanshort | american\");",
          "",
          "[Removed Lines]",
          "11799: #line 1243 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 45 ---",
          "[Context before]",
          "11811:   TIMELIB_DEINIT;",
          "11812:   return TIMELIB_AMERICAN;",
          "11813:  }",
          "11815: yy667:",
          "11816:  YYDEBUG(667, *YYCURSOR);",
          "11817:  yyaccept = 14;",
          "",
          "[Removed Lines]",
          "11814: #line 11815 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 46 ---",
          "[Context before]",
          "12044:  if (yych <= ':') goto yy703;",
          "12045: yy700:",
          "12046:  YYDEBUG(700, *YYCURSOR);",
          "12048:  {",
          "12049:   int tz_not_found;",
          "12050:   DEBUG_OUTPUT(\"clf\");",
          "",
          "[Removed Lines]",
          "12047: #line 1526 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 47 ---",
          "[Context before]",
          "12064:   TIMELIB_DEINIT;",
          "12065:   return TIMELIB_CLF;",
          "12066:  }",
          "12068: yy701:",
          "12069:  YYDEBUG(701, *YYCURSOR);",
          "12070:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12067: #line 12068 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 48 ---",
          "[Context before]",
          "12616:  }",
          "12617: yy763:",
          "12618:  YYDEBUG(763, *YYCURSOR);",
          "12620:  {",
          "12621:   int length = 0;",
          "12622:   DEBUG_OUTPUT(\"iso8601date2\");",
          "",
          "[Removed Lines]",
          "12619: #line 1271 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 49 ---",
          "[Context before]",
          "12629:   TIMELIB_DEINIT;",
          "12630:   return TIMELIB_ISO_DATE;",
          "12631:  }",
          "12633: yy764:",
          "12634:  YYDEBUG(764, *YYCURSOR);",
          "12635:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12632: #line 12633 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 50 ---",
          "[Context before]",
          "12668:  YYDEBUG(770, *YYCURSOR);",
          "12669:  ++YYCURSOR;",
          "12670:  YYDEBUG(771, *YYCURSOR);",
          "12672:  {",
          "12673:   int length = 0;",
          "12674:   DEBUG_OUTPUT(\"pgtextreverse\");",
          "",
          "[Removed Lines]",
          "12671: #line 1512 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 51 ---",
          "[Context before]",
          "12681:   TIMELIB_DEINIT;",
          "12682:   return TIMELIB_PG_TEXT;",
          "12683:  }",
          "12685: yy772:",
          "12686:  YYDEBUG(772, *YYCURSOR);",
          "12687:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12684: #line 12685 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 52 ---",
          "[Context before]",
          "12819:  }",
          "12820: yy783:",
          "12821:  YYDEBUG(783, *YYCURSOR);",
          "12823:  {",
          "12824:   DEBUG_OUTPUT(\"year4\");",
          "12825:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "12822: #line 1547 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 53 ---",
          "[Context before]",
          "12827:   TIMELIB_DEINIT;",
          "12828:   return TIMELIB_CLF;",
          "12829:  }",
          "12831: yy784:",
          "12832:  YYDEBUG(784, *YYCURSOR);",
          "12833:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12830: #line 12831 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 54 ---",
          "[Context before]",
          "12978:  }",
          "12979: yy793:",
          "12980:  YYDEBUG(793, *YYCURSOR);",
          "12982:  {",
          "12983:   int length = 0;",
          "12984:   DEBUG_OUTPUT(\"datenodayrev\");",
          "",
          "[Removed Lines]",
          "12981: #line 1368 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 55 ---",
          "[Context before]",
          "12991:   TIMELIB_DEINIT;",
          "12992:   return TIMELIB_DATE_NO_DAY;",
          "12993:  }",
          "12995: yy794:",
          "12996:  YYDEBUG(794, *YYCURSOR);",
          "12997:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12994: #line 12995 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 56 ---",
          "[Context before]",
          "13206:  if (yych <= '7') goto yy816;",
          "13207: yy814:",
          "13208:  YYDEBUG(814, *YYCURSOR);",
          "13210:  {",
          "13211:   timelib_sll w, d;",
          "13212:   DEBUG_OUTPUT(\"isoweek\");",
          "",
          "[Removed Lines]",
          "13209: #line 1479 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 57 ---",
          "[Context before]",
          "13224:   TIMELIB_DEINIT;",
          "13225:   return TIMELIB_ISO_WEEK;",
          "13226:  }",
          "13228: yy815:",
          "13229:  YYDEBUG(815, *YYCURSOR);",
          "13230:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13227: #line 13228 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 58 ---",
          "[Context before]",
          "13234:  YYDEBUG(816, *YYCURSOR);",
          "13235:  ++YYCURSOR;",
          "13236:  YYDEBUG(817, *YYCURSOR);",
          "13238:  {",
          "13239:   timelib_sll w, d;",
          "13240:   DEBUG_OUTPUT(\"isoweekday\");",
          "",
          "[Removed Lines]",
          "13237: #line 1460 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 59 ---",
          "[Context before]",
          "13252:   TIMELIB_DEINIT;",
          "13253:   return TIMELIB_ISO_WEEK;",
          "13254:  }",
          "13256: yy818:",
          "13257:  YYDEBUG(818, *YYCURSOR);",
          "13258:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13255: #line 13256 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 60 ---",
          "[Context before]",
          "13316:  }",
          "13317: yy821:",
          "13318:  YYDEBUG(821, *YYCURSOR);",
          "13320:  {",
          "13321:   int length = 0;",
          "13322:   DEBUG_OUTPUT(\"pgydotd\");",
          "",
          "[Removed Lines]",
          "13319: #line 1446 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 61 ---",
          "[Context before]",
          "13329:   TIMELIB_DEINIT;",
          "13330:   return TIMELIB_PG_YEARDAY;",
          "13331:  }",
          "13333: yy822:",
          "13334:  YYDEBUG(822, *YYCURSOR);",
          "13335:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13332: #line 13333 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 62 ---",
          "[Context before]",
          "13432:  ++YYCURSOR;",
          "13433: yy842:",
          "13434:  YYDEBUG(842, *YYCURSOR);",
          "13436:  {",
          "13437:   int tz_not_found;",
          "13438:   DEBUG_OUTPUT(\"xmlrpc | xmlrpcnocolon | soap | wddx | exif\");",
          "",
          "[Removed Lines]",
          "13435: #line 1420 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 63 ---",
          "[Context before]",
          "13457:   TIMELIB_DEINIT;",
          "13458:   return TIMELIB_XMLRPC_SOAP;",
          "13459:  }",
          "13461: yy843:",
          "13462:  YYDEBUG(843, *YYCURSOR);",
          "13463:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13460: #line 13461 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 64 ---",
          "[Context before]",
          "13719:  }",
          "13720: yy848:",
          "13721:  YYDEBUG(848, *YYCURSOR);",
          "13723:  {",
          "13724:   DEBUG_OUTPUT(\"datenocolon\");",
          "13725:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "13722: #line 1408 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 65 ---",
          "[Context before]",
          "13730:   TIMELIB_DEINIT;",
          "13731:   return TIMELIB_DATE_NOCOLON;",
          "13732:  }",
          "13734: yy849:",
          "13735:  YYDEBUG(849, *YYCURSOR);",
          "13736:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13733: #line 13734 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 66 ---",
          "[Context before]",
          "14650:  if (yych <= '9') goto yy995;",
          "14651: yy973:",
          "14652:  YYDEBUG(973, *YYCURSOR);",
          "14654:  {",
          "14655:   int length = 0;",
          "14656:   DEBUG_OUTPUT(\"gnudateshorter\");",
          "",
          "[Removed Lines]",
          "14653: #line 1285 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 67 ---",
          "[Context before]",
          "14663:   TIMELIB_DEINIT;",
          "14664:   return TIMELIB_ISO_DATE;",
          "14665:  }",
          "14667: yy974:",
          "14668:  YYDEBUG(974, *YYCURSOR);",
          "14669:  yyaccept = 22;",
          "",
          "[Removed Lines]",
          "14666: #line 14667 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 68 ---",
          "[Context before]",
          "15672:  }",
          "15673: yy1067:",
          "15674:  YYDEBUG(1067, *YYCURSOR);",
          "15676:  {",
          "15677:   DEBUG_OUTPUT(\"gnunocolon\");",
          "15678:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "15675: #line 1177 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 69 ---",
          "[Context before]",
          "15694:   TIMELIB_DEINIT;",
          "15695:   return TIMELIB_GNU_NOCOLON;",
          "15696:  }",
          "15698: yy1068:",
          "15699:  YYDEBUG(1068, *YYCURSOR);",
          "15700:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "15697: #line 15698 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 70 ---",
          "[Context before]",
          "15786:  }",
          "15787: yy1075:",
          "15788:  YYDEBUG(1075, *YYCURSOR);",
          "15790:  {",
          "15791:   int tz_not_found;",
          "15792:   DEBUG_OUTPUT(\"iso8601nocolon\");",
          "",
          "[Removed Lines]",
          "15789: #line 1223 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 71 ---",
          "[Context before]",
          "15805:   TIMELIB_DEINIT;",
          "15806:   return TIMELIB_ISO_NOCOLON;",
          "15807:  }",
          "15809: yy1076:",
          "15810:  YYDEBUG(1076, *YYCURSOR);",
          "15811:  yyaccept = 25;",
          "",
          "[Removed Lines]",
          "15808: #line 15809 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 72 ---",
          "[Context before]",
          "16703:  }",
          "16704: yy1117:",
          "16705:  YYDEBUG(1117, *YYCURSOR);",
          "16707:  {",
          "16708:   timelib_sll i;",
          "16709:   int         behavior = 0;",
          "",
          "[Removed Lines]",
          "16706: #line 1619 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 73 ---",
          "[Context before]",
          "16719:   TIMELIB_DEINIT;",
          "16720:   return TIMELIB_RELATIVE;",
          "16721:  }",
          "16723: yy1118:",
          "16724:  YYDEBUG(1118, *YYCURSOR);",
          "16725:  ++YYCURSOR;",
          "",
          "[Removed Lines]",
          "16722: #line 16723 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 74 ---",
          "[Context before]",
          "16770:  YYDEBUG(1125, *YYCURSOR);",
          "16771:  ++YYCURSOR;",
          "16772:  YYDEBUG(1126, *YYCURSOR);",
          "16774:  {",
          "16775:   timelib_sll i;",
          "16776:   int         behavior = 0;",
          "",
          "[Removed Lines]",
          "16773: #line 1092 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 75 ---",
          "[Context before]",
          "16791:   TIMELIB_DEINIT;",
          "16792:   return TIMELIB_WEEK_DAY_OF_MONTH;",
          "16793:  }",
          "16795: yy1127:",
          "16796:  YYDEBUG(1127, *YYCURSOR);",
          "16797:  yyaccept = 26;",
          "",
          "[Removed Lines]",
          "16794: #line 16795 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 76 ---",
          "[Context before]",
          "16899:  }",
          "16900: yy1141:",
          "16901:  YYDEBUG(1141, *YYCURSOR);",
          "16903:  {",
          "16904:   timelib_sll i;",
          "16905:   int         behavior = 0;",
          "",
          "[Removed Lines]",
          "16902: #line 1595 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 77 ---",
          "[Context before]",
          "16922:   TIMELIB_DEINIT;",
          "16923:   return TIMELIB_RELATIVE;",
          "16924:  }",
          "16926: yy1142:",
          "16927:  YYDEBUG(1142, *YYCURSOR);",
          "16928:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "16925: #line 16926 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 78 ---",
          "[Context before]",
          "19599:  goto yy1297;",
          "19600: yy1294:",
          "19601:  YYDEBUG(1294, *YYCURSOR);",
          "19603:  {",
          "19604:   DEBUG_OUTPUT(\"backof | frontof\");",
          "19605:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "19602: #line 1069 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 79 ---",
          "[Context before]",
          "19621:   TIMELIB_DEINIT;",
          "19622:   return TIMELIB_LF_DAY_OF_MONTH;",
          "19623:  }",
          "19625: yy1295:",
          "19626:  YYDEBUG(1295, *YYCURSOR);",
          "19627:  yyaccept = 28;",
          "",
          "[Removed Lines]",
          "19624: #line 19625 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 80 ---",
          "[Context before]",
          "19882:  YYDEBUG(1315, *YYCURSOR);",
          "19883:  ++YYCURSOR;",
          "19884:  YYDEBUG(1316, *YYCURSOR);",
          "19886:  {",
          "19887:   DEBUG_OUTPUT(\"firstdayof | lastdayof\");",
          "19888:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "19885: #line 1052 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 81 ---",
          "[Context before]",
          "19898:   TIMELIB_DEINIT;",
          "19899:   return TIMELIB_LF_DAY_OF_MONTH;",
          "19900:  }",
          "19902: yy1317:",
          "19903:  YYDEBUG(1317, *YYCURSOR);",
          "19904:  yyaccept = 0;",
          "",
          "[Removed Lines]",
          "19901: #line 19902 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 82 ---",
          "[Context before]",
          "21329:  if (yych <= '9') goto yy1385;",
          "21330: yy1387:",
          "21331:  YYDEBUG(1387, *YYCURSOR);",
          "21333:  {",
          "21334:   timelib_ull i;",
          "",
          "[Removed Lines]",
          "21332: #line 1026 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 83 ---",
          "[Context before]",
          "21354:   TIMELIB_DEINIT;",
          "21355:   return TIMELIB_RELATIVE;",
          "21356:  }",
          "21358: yy1388:",
          "21359:  YYDEBUG(1388, *YYCURSOR);",
          "21360:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "21357: #line 21358 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 84 ---",
          "[Context before]",
          "21790:  ++YYCURSOR;",
          "21791: yy1417:",
          "21792:  YYDEBUG(1417, *YYCURSOR);",
          "21794:  {",
          "21795:   DEBUG_OUTPUT(\"tomorrow\");",
          "21796:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "21793: #line 1014 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 85 ---",
          "[Context before]",
          "21801:   TIMELIB_DEINIT;",
          "21802:   return TIMELIB_RELATIVE;",
          "21803:  }",
          "21805: yy1418:",
          "21806:  YYDEBUG(1418, *YYCURSOR);",
          "21807:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "21804: #line 21805 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 86 ---",
          "[Context before]",
          "21836:  }",
          "21837: yy1420:",
          "21838:  YYDEBUG(1420, *YYCURSOR);",
          "21840:  {",
          "21841:   DEBUG_OUTPUT(\"midnight | today\");",
          "21842:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "21839: #line 1004 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 87 ---",
          "[Context before]",
          "21845:   TIMELIB_DEINIT;",
          "21846:   return TIMELIB_RELATIVE;",
          "21847:  }",
          "21849: yy1421:",
          "21850:  YYDEBUG(1421, *YYCURSOR);",
          "21851:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "21848: #line 21849 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 88 ---",
          "[Context before]",
          "23857:  }",
          "23858: yy1500:",
          "23859:  YYDEBUG(1500, *YYCURSOR);",
          "23861:  {",
          "23862:   DEBUG_OUTPUT(\"now\");",
          "23863:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "23860: #line 983 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 89 ---",
          "[Context before]",
          "23865:   TIMELIB_DEINIT;",
          "23866:   return TIMELIB_RELATIVE;",
          "23867:  }",
          "23869: yy1501:",
          "23870:  YYDEBUG(1501, *YYCURSOR);",
          "23871:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "23868: #line 23869 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 90 ---",
          "[Context before]",
          "24004:  }",
          "24005: yy1508:",
          "24006:  YYDEBUG(1508, *YYCURSOR);",
          "24008:  {",
          "24009:   DEBUG_OUTPUT(\"noon\");",
          "24010:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "24007: #line 992 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 91 ---",
          "[Context before]",
          "24015:   TIMELIB_DEINIT;",
          "24016:   return TIMELIB_RELATIVE;",
          "24017:  }",
          "24019: yy1509:",
          "24020:  YYDEBUG(1509, *YYCURSOR);",
          "24021:  yyaccept = 0;",
          "",
          "[Removed Lines]",
          "24018: #line 24019 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 92 ---",
          "[Context before]",
          "24548:  ++YYCURSOR;",
          "24549: yy1531:",
          "24550:  YYDEBUG(1531, *YYCURSOR);",
          "24552:  {",
          "24553:   DEBUG_OUTPUT(\"yesterday\");",
          "24554:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "24551: #line 971 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 93 ---",
          "[Context before]",
          "24559:   TIMELIB_DEINIT;",
          "24560:   return TIMELIB_RELATIVE;",
          "24561:  }",
          "24563: yy1532:",
          "24564:  YYDEBUG(1532, *YYCURSOR);",
          "24565:  yyaccept = 0;",
          "",
          "[Removed Lines]",
          "24562: #line 24563 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 94 ---",
          "[Context before]",
          "24732:   goto yy1531;",
          "24733:  }",
          "24734: }",
          "24737: }",
          "",
          "[Removed Lines]",
          "24735: #line 1745 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/pdo/pdo_sql_parser.c||ext/pdo/pdo_sql_parser.c": [
          "File: ext/pdo/pdo_sql_parser.c -> ext/pdo/pdo_sql_parser.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:   +----------------------------------------------------------------------+",
          "5:   | PHP Version 5                                                        |",
          "",
          "[Removed Lines]",
          "2: #line 1 \"ext/pdo/pdo_sql_parser.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "47:  char *cursor = s->cur;",
          "49:  s->tok = cursor;",
          "55: {",
          "56:  YYCTYPE yych;",
          "57:  unsigned int yyaccept = 0;",
          "",
          "[Removed Lines]",
          "50:  #line 55 \"ext/pdo/pdo_sql_parser.re\"",
          "54: #line 55 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "79:  yych = *(YYMARKER = ++YYCURSOR);",
          "80:  if (yych >= 0x01) goto yy43;",
          "81: yy4:",
          "83:  { SKIP_ONE(PDO_PARSER_TEXT); }",
          "85: yy5:",
          "86:  yyaccept = 0;",
          "87:  yych = *(YYMARKER = ++YYCURSOR);",
          "",
          "[Removed Lines]",
          "82: #line 63 \"ext/pdo/pdo_sql_parser.re\"",
          "84: #line 85 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "163:  default: goto yy8;",
          "164:  }",
          "165: yy8:",
          "167:  { RET(PDO_PARSER_BIND_POS); }",
          "169: yy9:",
          "170:  ++YYCURSOR;",
          "171:  switch ((yych = *YYCURSOR)) {",
          "",
          "[Removed Lines]",
          "166: #line 62 \"ext/pdo/pdo_sql_parser.re\"",
          "168: #line 169 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "173:  default: goto yy13;",
          "174:  }",
          "175: yy10:",
          "177:  { RET(PDO_PARSER_TEXT); }",
          "179: yy11:",
          "180:  yych = *++YYCURSOR;",
          "181:  switch (yych) {",
          "",
          "[Removed Lines]",
          "176: #line 65 \"ext/pdo/pdo_sql_parser.re\"",
          "178: #line 179 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "210:  default: goto yy14;",
          "211:  }",
          "212: yy16:",
          "214:  { RET(PDO_PARSER_TEXT); }",
          "216: yy17:",
          "217:  ++YYCURSOR;",
          "218:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "213: #line 64 \"ext/pdo/pdo_sql_parser.re\"",
          "215: #line 216 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "290:  default: goto yy31;",
          "291:  }",
          "292: yy31:",
          "294:  { RET(PDO_PARSER_TEXT); }",
          "296: yy32:",
          "297:  ++YYCURSOR;",
          "298:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "293: #line 60 \"ext/pdo/pdo_sql_parser.re\"",
          "295: #line 296 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "364:  default: goto yy34;",
          "365:  }",
          "366: yy34:",
          "368:  { RET(PDO_PARSER_BIND); }",
          "370: yy35:",
          "371:  ++YYCURSOR;",
          "372:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "367: #line 61 \"ext/pdo/pdo_sql_parser.re\"",
          "369: #line 370 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "394:  goto yy37;",
          "395: yy40:",
          "396:  ++YYCURSOR;",
          "398:  { RET(PDO_PARSER_TEXT); }",
          "400: yy42:",
          "401:  ++YYCURSOR;",
          "402:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "397: #line 59 \"ext/pdo/pdo_sql_parser.re\"",
          "399: #line 400 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "416:  goto yy42;",
          "417: yy45:",
          "418:  ++YYCURSOR;",
          "420:  { RET(PDO_PARSER_TEXT); }",
          "422: }",
          "425: }",
          "",
          "[Removed Lines]",
          "419: #line 58 \"ext/pdo/pdo_sql_parser.re\"",
          "421: #line 422 \"ext/pdo/pdo_sql_parser.c\"",
          "423: #line 66 \"ext/pdo/pdo_sql_parser.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/url_scanner_ex.c||ext/standard/url_scanner_ex.c": [
          "File: ext/standard/url_scanner_ex.c -> ext/standard/url_scanner_ex.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:   +----------------------------------------------------------------------+",
          "5:   | PHP Version 5                                                        |",
          "",
          "[Removed Lines]",
          "2: #line 1 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "100:  STD_PHP_INI_ENTRY(\"url_rewriter.tags\", \"a=href,area=href,frame=src,form=,fieldset=\", PHP_INI_ALL, OnUpdateTags, url_adapt_state_ex, php_basic_globals, basic_globals)",
          "101: PHP_INI_END()",
          "106: #define YYFILL(n) goto done",
          "",
          "[Removed Lines]",
          "103: #line 107 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "120: scan:",
          "123: {",
          "124:  YYCTYPE yych;",
          "125:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "122: #line 123 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "165:  if (yych <= '9') goto yy6;",
          "166:  if (yych >= ';') goto yy4;",
          "167:  ++YYCURSOR;",
          "169:  { smart_str_append(dest, url); return; }",
          "171: yy4:",
          "172:  ++YYCURSOR;",
          "174:  { sep = separator; goto scan; }",
          "176: yy6:",
          "177:  ++YYCURSOR;",
          "179:  { bash = p - 1; goto done; }",
          "181: yy8:",
          "182:  ++YYCURSOR;",
          "183:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "168: #line 125 \"ext/standard/url_scanner_ex.re\"",
          "170: #line 171 \"ext/standard/url_scanner_ex.c\"",
          "173: #line 126 \"ext/standard/url_scanner_ex.re\"",
          "175: #line 176 \"ext/standard/url_scanner_ex.c\"",
          "178: #line 127 \"ext/standard/url_scanner_ex.re\"",
          "180: #line 181 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "185:  if (yybm[0+yych] & 128) {",
          "186:   goto yy8;",
          "187:  }",
          "189:  { goto scan; }",
          "191: }",
          "194: done:",
          "",
          "[Removed Lines]",
          "188: #line 128 \"ext/standard/url_scanner_ex.re\"",
          "190: #line 191 \"ext/standard/url_scanner_ex.c\"",
          "192: #line 129 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "374: state_plain:",
          "375:  start = YYCURSOR;",
          "378: {",
          "379:  YYCTYPE yych;",
          "380:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "377: #line 378 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "417:   goto yy15;",
          "418:  }",
          "419:  ++YYCURSOR;",
          "421:  { passthru(STD_ARGS); STATE = STATE_TAG; goto state_tag; }",
          "423: yy15:",
          "424:  ++YYCURSOR;",
          "425:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "420: #line 313 \"ext/standard/url_scanner_ex.re\"",
          "422: #line 423 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "427:  if (yybm[0+yych] & 128) {",
          "428:   goto yy15;",
          "429:  }",
          "431:  { passthru(STD_ARGS); goto state_plain; }",
          "433: }",
          "437: state_tag:",
          "438:  start = YYCURSOR;",
          "441: {",
          "442:  YYCTYPE yych;",
          "443:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "430: #line 314 \"ext/standard/url_scanner_ex.re\"",
          "432: #line 433 \"ext/standard/url_scanner_ex.c\"",
          "434: #line 315 \"ext/standard/url_scanner_ex.re\"",
          "440: #line 441 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "488:  yych = *YYCURSOR;",
          "489:  goto yy25;",
          "490: yy21:",
          "492:  { handle_tag(STD_ARGS); /* Sets STATE */; passthru(STD_ARGS); if (STATE == STATE_PLAIN) goto state_plain; else goto state_next_arg; }",
          "494: yy22:",
          "495:  ++YYCURSOR;",
          "497:  { passthru(STD_ARGS); goto state_plain_begin; }",
          "499: yy24:",
          "500:  ++YYCURSOR;",
          "501:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "491: #line 320 \"ext/standard/url_scanner_ex.re\"",
          "493: #line 494 \"ext/standard/url_scanner_ex.c\"",
          "496: #line 321 \"ext/standard/url_scanner_ex.re\"",
          "498: #line 499 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "506:  }",
          "507:  goto yy21;",
          "508: }",
          "512: state_next_arg_begin:",
          "",
          "[Removed Lines]",
          "509: #line 322 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "515: state_next_arg:",
          "516:  start = YYCURSOR;",
          "519: {",
          "520:  YYCTYPE yych;",
          "521:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "518: #line 519 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "580:  ++YYCURSOR;",
          "581:  if ((yych = *YYCURSOR) == '>') goto yy39;",
          "582: yy29:",
          "584:  { passthru(STD_ARGS); goto state_plain_begin; }",
          "586: yy30:",
          "587:  ++YYCURSOR;",
          "588: yy31:",
          "590:  { passthru(STD_ARGS); handle_form(STD_ARGS); goto state_plain_begin; }",
          "592: yy32:",
          "593:  ++YYCURSOR;",
          "594:  yych = *YYCURSOR;",
          "595:  goto yy38;",
          "596: yy33:",
          "598:  { passthru(STD_ARGS); goto state_next_arg; }",
          "600: yy34:",
          "601:  ++YYCURSOR;",
          "603:  { --YYCURSOR; STATE = STATE_ARG; goto state_arg; }",
          "605: yy36:",
          "606:  yych = *++YYCURSOR;",
          "607:  goto yy29;",
          "",
          "[Removed Lines]",
          "583: #line 333 \"ext/standard/url_scanner_ex.re\"",
          "585: #line 586 \"ext/standard/url_scanner_ex.c\"",
          "589: #line 330 \"ext/standard/url_scanner_ex.re\"",
          "591: #line 592 \"ext/standard/url_scanner_ex.c\"",
          "597: #line 331 \"ext/standard/url_scanner_ex.re\"",
          "599: #line 600 \"ext/standard/url_scanner_ex.c\"",
          "602: #line 332 \"ext/standard/url_scanner_ex.re\"",
          "604: #line 605 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "619:  yych = *YYCURSOR;",
          "620:  goto yy31;",
          "621: }",
          "625: state_arg:",
          "626:  start = YYCURSOR;",
          "629: {",
          "630:  YYCTYPE yych;",
          "631:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "622: #line 334 \"ext/standard/url_scanner_ex.re\"",
          "628: #line 629 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "673:  yych = *YYCURSOR;",
          "674:  goto yy47;",
          "675: yy43:",
          "677:  { passthru(STD_ARGS); handle_arg(STD_ARGS); STATE = STATE_BEFORE_VAL; goto state_before_val; }",
          "679: yy44:",
          "680:  ++YYCURSOR;",
          "682:  { passthru(STD_ARGS); STATE = STATE_NEXT_ARG; goto state_next_arg; }",
          "684: yy46:",
          "685:  ++YYCURSOR;",
          "686:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "676: #line 339 \"ext/standard/url_scanner_ex.re\"",
          "678: #line 679 \"ext/standard/url_scanner_ex.c\"",
          "681: #line 340 \"ext/standard/url_scanner_ex.re\"",
          "683: #line 684 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "691:  }",
          "692:  goto yy43;",
          "693: }",
          "697: state_before_val:",
          "698:  start = YYCURSOR;",
          "701: {",
          "702:  YYCTYPE yych;",
          "703:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "694: #line 341 \"ext/standard/url_scanner_ex.re\"",
          "700: #line 701 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "744:  if (yych == ' ') goto yy57;",
          "745:  if (yych == '=') goto yy55;",
          "746: yy51:",
          "748:  { --YYCURSOR; goto state_next_arg_begin; }",
          "750: yy52:",
          "751:  ++YYCURSOR;",
          "752:  yych = *YYCURSOR;",
          "753:  goto yy56;",
          "754: yy53:",
          "756:  { passthru(STD_ARGS); STATE = STATE_VAL; goto state_val; }",
          "758: yy54:",
          "759:  yych = *++YYCURSOR;",
          "760:  goto yy51;",
          "",
          "[Removed Lines]",
          "747: #line 347 \"ext/standard/url_scanner_ex.re\"",
          "749: #line 750 \"ext/standard/url_scanner_ex.c\"",
          "755: #line 346 \"ext/standard/url_scanner_ex.re\"",
          "757: #line 758 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "776:  YYCURSOR = YYMARKER;",
          "777:  goto yy51;",
          "778: }",
          "783: state_val:",
          "784:  start = YYCURSOR;",
          "787: {",
          "788:  YYCTYPE yych;",
          "789:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "779: #line 348 \"ext/standard/url_scanner_ex.re\"",
          "786: #line 787 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "844:  yych = *(YYMARKER = ++YYCURSOR);",
          "845:  if (yych != '>') goto yy76;",
          "846: yy63:",
          "848:  { passthru(STD_ARGS); goto state_next_arg_begin; }",
          "850: yy64:",
          "851:  yych = *(YYMARKER = ++YYCURSOR);",
          "852:  if (yych == '>') goto yy63;",
          "",
          "[Removed Lines]",
          "847: #line 357 \"ext/standard/url_scanner_ex.re\"",
          "849: #line 850 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "856:  yych = *YYCURSOR;",
          "857:  goto yy69;",
          "858: yy66:",
          "860:  { handle_val(STD_ARGS, 0, ' '); goto state_next_arg_begin; }",
          "862: yy67:",
          "863:  yych = *++YYCURSOR;",
          "864:  goto yy63;",
          "",
          "[Removed Lines]",
          "859: #line 356 \"ext/standard/url_scanner_ex.re\"",
          "861: #line 862 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "885:  goto yy63;",
          "886: yy73:",
          "887:  ++YYCURSOR;",
          "889:  { handle_val(STD_ARGS, 1, '\\''); goto state_next_arg_begin; }",
          "891: yy75:",
          "892:  ++YYCURSOR;",
          "893:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "888: #line 355 \"ext/standard/url_scanner_ex.re\"",
          "890: #line 891 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "898:  }",
          "899:  if (yych >= '>') goto yy72;",
          "900:  ++YYCURSOR;",
          "902:  { handle_val(STD_ARGS, 1, '\"'); goto state_next_arg_begin; }",
          "904: }",
          "908: stop:",
          "",
          "[Removed Lines]",
          "901: #line 354 \"ext/standard/url_scanner_ex.re\"",
          "903: #line 904 \"ext/standard/url_scanner_ex.c\"",
          "905: #line 358 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:   +----------------------------------------------------------------------+",
          "5:   | PHP Version 5                                                        |",
          "",
          "[Removed Lines]",
          "2: #line 1 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "233: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "236: #line 241 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "481:  start = cursor;",
          "485: {",
          "486:  YYCTYPE yych;",
          "487:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "484: #line 485 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "541:  yych = *(YYMARKER = ++YYCURSOR);",
          "542:  if (yych == ':') goto yy95;",
          "543: yy3:",
          "545:  { return 0; }",
          "547: yy4:",
          "548:  yych = *(YYMARKER = ++YYCURSOR);",
          "549:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "544: #line 826 \"ext/standard/var_unserializer.re\"",
          "546: #line 547 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "586:  goto yy3;",
          "587: yy14:",
          "588:  ++YYCURSOR;",
          "590:  {",
          "592:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "594: }",
          "596: yy16:",
          "597:  yych = *++YYCURSOR;",
          "598:  goto yy3;",
          "",
          "[Removed Lines]",
          "589: #line 820 \"ext/standard/var_unserializer.re\"",
          "595: #line 596 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "622:  yych = *++YYCURSOR;",
          "623:  if (yych != '\"') goto yy18;",
          "624:  ++YYCURSOR;",
          "626:  {",
          "627:  size_t len, len2, len3, maxlen;",
          "628:  php_int_t elements;",
          "",
          "[Removed Lines]",
          "625: #line 681 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "762:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "763: }",
          "765: yy25:",
          "766:  yych = *++YYCURSOR;",
          "767:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "764: #line 765 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "786:  yych = *++YYCURSOR;",
          "787:  if (yych != '\"') goto yy18;",
          "788:  ++YYCURSOR;",
          "790:  {",
          "",
          "[Removed Lines]",
          "789: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "794:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "795:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "796: }",
          "798: yy32:",
          "799:  yych = *++YYCURSOR;",
          "800:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "797: #line 798 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "815:  yych = *++YYCURSOR;",
          "816:  if (yych != '{') goto yy18;",
          "817:  ++YYCURSOR;",
          "819:  {",
          "820:  php_int_t elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "818: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "837:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "838: }",
          "840: yy39:",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "839: #line 840 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "857:  yych = *++YYCURSOR;",
          "858:  if (yych != '\"') goto yy18;",
          "859:  ++YYCURSOR;",
          "861:  {",
          "862:  size_t len, maxlen;",
          "863:  zend_string *str;",
          "",
          "[Removed Lines]",
          "860: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "885:  ZVAL_STR(rval, str);",
          "886:  return 1;",
          "887: }",
          "889: yy46:",
          "890:  yych = *++YYCURSOR;",
          "891:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "888: #line 889 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "906:  yych = *++YYCURSOR;",
          "907:  if (yych != '\"') goto yy18;",
          "908:  ++YYCURSOR;",
          "910:  {",
          "911:  size_t len, maxlen;",
          "912:  char *str;",
          "",
          "[Removed Lines]",
          "909: #line 597 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "933:  ZVAL_STRINGL(rval, str, len);",
          "934:  return 1;",
          "935: }",
          "937: yy53:",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "936: #line 937 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1021:  }",
          "1022: yy63:",
          "1023:  ++YYCURSOR;",
          "1025:  {",
          "1026: #if SIZEOF_ZEND_INT == 4",
          "1027: use_double:",
          "",
          "[Removed Lines]",
          "1024: #line 588 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1030:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1031:  return 1;",
          "1032: }",
          "1034: yy65:",
          "1035:  yych = *++YYCURSOR;",
          "1036:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1033: #line 1034 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1089:  yych = *++YYCURSOR;",
          "1090:  if (yych != ';') goto yy18;",
          "1091:  ++YYCURSOR;",
          "1093:  {",
          "",
          "[Removed Lines]",
          "1092: #line 572 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1106:  return 1;",
          "1107: }",
          "1109: yy76:",
          "1110:  yych = *++YYCURSOR;",
          "1111:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1108: #line 1109 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1132:  if (yych <= '9') goto yy79;",
          "1133:  if (yych != ';') goto yy18;",
          "1134:  ++YYCURSOR;",
          "1136:  {",
          "1137: #if SIZEOF_ZEND_INT == 4",
          "1138:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1135: #line 546 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1158:  ZVAL_INT(rval, parse_iv(start + 2));",
          "1159:  return 1;",
          "1160: }",
          "1162: yy83:",
          "1163:  yych = *++YYCURSOR;",
          "1164:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1161: #line 1162 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1166:  yych = *++YYCURSOR;",
          "1167:  if (yych != ';') goto yy18;",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1172:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1173:  return 1;",
          "1174: }",
          "1176: yy87:",
          "1177:  ++YYCURSOR;",
          "1179:  {",
          "1181:  ZVAL_NULL(rval);",
          "1182:  return 1;",
          "1183: }",
          "1185: yy89:",
          "1186:  yych = *++YYCURSOR;",
          "1187:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1169: #line 540 \"ext/standard/var_unserializer.re\"",
          "1175: #line 1176 \"ext/standard/var_unserializer.c\"",
          "1178: #line 534 \"ext/standard/var_unserializer.re\"",
          "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1204:  if (yych <= '9') goto yy91;",
          "1205:  if (yych != ';') goto yy18;",
          "1206:  ++YYCURSOR;",
          "1208:  {",
          "1209:  php_int_t id;",
          "",
          "[Removed Lines]",
          "1207: #line 511 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1228:  return 1;",
          "1229: }",
          "1231: yy95:",
          "1232:  yych = *++YYCURSOR;",
          "1233:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1250:  if (yych <= '9') goto yy97;",
          "1251:  if (yych != ';') goto yy18;",
          "1252:  ++YYCURSOR;",
          "1254:  {",
          "1255:  php_int_t id;",
          "",
          "[Removed Lines]",
          "1253: #line 489 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1273:  return 1;",
          "1274: }",
          "1276: }",
          "1280:  return 0;",
          "",
          "[Removed Lines]",
          "1275: #line 1276 \"ext/standard/var_unserializer.c\"",
          "1277: #line 828 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "sapi/cli/php_cli.c||sapi/cli/php_cli.c": [
          "File: sapi/cli/php_cli.c -> sapi/cli/php_cli.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "252:  return ret != -1;",
          "253: }",
          "256: {",
          "257: #ifdef PHP_WRITE_STDOUT",
          "259: #else",
          "260:  php_size_t ret;",
          "261: #endif",
          "",
          "[Removed Lines]",
          "258:  long ret;",
          "",
          "[Added Lines]",
          "258:  php_int_t ret;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "61ba5f84774938617f78d65c06e5933cff2d8af3",
      "candidate_info": {
        "commit_hash": "61ba5f84774938617f78d65c06e5933cff2d8af3",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/61ba5f84774938617f78d65c06e5933cff2d8af3",
        "files": [
          "ext/standard/tests/serialize/bug25378.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #74111",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug25378.phpt||ext/standard/tests/serialize/bug25378.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug25378.phpt||ext/standard/tests/serialize/bug25378.phpt": [
          "File: ext/standard/tests/serialize/bug25378.phpt -> ext/standard/tests/serialize/bug25378.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: Notice: unserialize(): Error at offset 17 of 33 bytes in %sbug25378.php on line %d",
          "43: bool(false)",
          "46: bool(false)",
          "48: Notice: unserialize(): Error at offset 2 of 13 bytes in %sbug25378.php on line %d",
          "",
          "[Removed Lines]",
          "45: Notice: unserialize(): Error at offset 33 of 32 bytes in %sbug25378.php on line %d",
          "",
          "[Added Lines]",
          "45: Notice: unserialize(): Error at offset 32 of 32 bytes in %sbug25378.php on line %d",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "474: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "475: {",
          "483: }",
          "485: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "",
          "[Removed Lines]",
          "476:  if (*((*p)++) == '}')",
          "477:   return 1;",
          "479: #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE",
          "480:  zval_ptr_dtor(rval);",
          "481: #endif",
          "482:  return 0;",
          "",
          "[Added Lines]",
          "476:  if (*p >= max || **p != '}') {",
          "477:   return 0;",
          "478:  }",
          "480:  (*p)++;",
          "481:  return 1;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "621:  start = cursor;",
          "625: {",
          "626:  YYCTYPE yych;",
          "627:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "624: #line 625 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "623: #line 624 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "679: yy2:",
          "680:  ++YYCURSOR;",
          "681: yy3:",
          "683:  { return 0; }",
          "685: yy4:",
          "686:  yych = *(YYMARKER = ++YYCURSOR);",
          "687:  if (yych == ':') goto yy17;",
          "",
          "[Removed Lines]",
          "682: #line 1002 \"ext/standard/var_unserializer.re\"",
          "684: #line 685 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "681: #line 1001 \"ext/standard/var_unserializer.re\"",
          "683: #line 684 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "728:  goto yy3;",
          "729: yy15:",
          "730:  ++YYCURSOR;",
          "732:  {",
          "734:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "736: }",
          "738: yy17:",
          "739:  yych = *++YYCURSOR;",
          "740:  if (yybm[0+yych] & 128) {",
          "",
          "[Removed Lines]",
          "731: #line 996 \"ext/standard/var_unserializer.re\"",
          "737: #line 738 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "730: #line 995 \"ext/standard/var_unserializer.re\"",
          "736: #line 737 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "746:  goto yy3;",
          "747: yy19:",
          "748:  ++YYCURSOR;",
          "750:  {",
          "752:  ZVAL_NULL(rval);",
          "753:  return 1;",
          "754: }",
          "756: yy21:",
          "757:  yych = *++YYCURSOR;",
          "758:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "749: #line 680 \"ext/standard/var_unserializer.re\"",
          "755: #line 756 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "748: #line 679 \"ext/standard/var_unserializer.re\"",
          "754: #line 755 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1002:  goto yy18;",
          "1003: yy63:",
          "1004:  ++YYCURSOR;",
          "1006:  {",
          "1007:  zend_long id;",
          "",
          "[Removed Lines]",
          "1005: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1004: #line 628 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1029:  return 1;",
          "1030: }",
          "1032: yy65:",
          "1033:  yych = *++YYCURSOR;",
          "1034:  if (yych == '\"') goto yy84;",
          "",
          "[Removed Lines]",
          "1031: #line 1032 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1030: #line 1031 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1039:  goto yy18;",
          "1040: yy67:",
          "1041:  ++YYCURSOR;",
          "1043:  {",
          "1045:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1046:  return 1;",
          "1047: }",
          "1049: yy69:",
          "1050:  ++YYCURSOR;",
          "1051:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "",
          "[Removed Lines]",
          "1042: #line 686 \"ext/standard/var_unserializer.re\"",
          "1048: #line 1049 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1041: #line 685 \"ext/standard/var_unserializer.re\"",
          "1047: #line 1048 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1065:  }",
          "1066: yy71:",
          "1067:  ++YYCURSOR;",
          "1069:  {",
          "1070: #if SIZEOF_ZEND_LONG == 4",
          "1071: use_double:",
          "",
          "[Removed Lines]",
          "1068: #line 734 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1067: #line 733 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1074:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1075:  return 1;",
          "1076: }",
          "1078: yy73:",
          "1079:  yych = *++YYCURSOR;",
          "1080:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1077: #line 1078 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1076: #line 1077 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1096:  goto yy18;",
          "1097: yy76:",
          "1098:  ++YYCURSOR;",
          "1100:  {",
          "1101: #if SIZEOF_ZEND_LONG == 4",
          "1102:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1099: #line 692 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1098: #line 691 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1122:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1123:  return 1;",
          "1124: }",
          "1126: yy78:",
          "1127:  yych = *++YYCURSOR;",
          "1128:  if (yych == '\"') goto yy92;",
          "1129:  goto yy18;",
          "1130: yy79:",
          "1131:  ++YYCURSOR;",
          "1133:  {",
          "1134:  zend_long id;",
          "",
          "[Removed Lines]",
          "1125: #line 1126 \"ext/standard/var_unserializer.c\"",
          "1132: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1124: #line 1125 \"ext/standard/var_unserializer.c\"",
          "1131: #line 654 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1155:  return 1;",
          "1156: }",
          "1158: yy81:",
          "1159:  yych = *++YYCURSOR;",
          "1160:  if (yych == '\"') goto yy94;",
          "1161:  goto yy18;",
          "1162: yy82:",
          "1163:  ++YYCURSOR;",
          "1165:  {",
          "1166:  size_t len, len2, len3, maxlen;",
          "1167:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1157: #line 1158 \"ext/standard/var_unserializer.c\"",
          "1164: #line 844 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1156: #line 1157 \"ext/standard/var_unserializer.c\"",
          "1163: #line 843 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1314:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1315: }",
          "1317: yy84:",
          "1318:  ++YYCURSOR;",
          "1320:  {",
          "1321:  size_t len, maxlen;",
          "1322:  zend_string *str;",
          "",
          "[Removed Lines]",
          "1316: #line 1317 \"ext/standard/var_unserializer.c\"",
          "1319: #line 775 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1315: #line 1316 \"ext/standard/var_unserializer.c\"",
          "1318: #line 774 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1350:  ZVAL_STR(rval, str);",
          "1351:  return 1;",
          "1352: }",
          "1354: yy86:",
          "1355:  ++YYCURSOR;",
          "1357:  {",
          "1358:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "1353: #line 1354 \"ext/standard/var_unserializer.c\"",
          "1356: #line 809 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1352: #line 1353 \"ext/standard/var_unserializer.c\"",
          "1355: #line 808 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1378:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1379: }",
          "1381: yy88:",
          "1382:  yych = *++YYCURSOR;",
          "1383:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1380: #line 1381 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1379: #line 1380 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1402:  goto yy18;",
          "1403: yy92:",
          "1404:  ++YYCURSOR;",
          "1406:  {",
          "1407:  zend_long elements;",
          "1408:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1405: #line 833 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1404: #line 832 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1413:  }",
          "1414:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1415: }",
          "1417: yy94:",
          "1418:  ++YYCURSOR;",
          "1420:  {",
          "1421:  size_t len, maxlen;",
          "1422:  char *str;",
          "",
          "[Removed Lines]",
          "1416: #line 1417 \"ext/standard/var_unserializer.c\"",
          "1419: #line 743 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1415: #line 1416 \"ext/standard/var_unserializer.c\"",
          "1418: #line 742 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1448:  ZVAL_STRINGL(rval, str, len);",
          "1449:  return 1;",
          "1450: }",
          "1452: yy96:",
          "1453:  yych = *++YYCURSOR;",
          "1454:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1451: #line 1452 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1450: #line 1451 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1456:  goto yy18;",
          "1457: yy97:",
          "1458:  ++YYCURSOR;",
          "1460:  {",
          "",
          "[Removed Lines]",
          "1459: #line 718 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1458: #line 717 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1473:  return 1;",
          "1474: }",
          "1476: }",
          "1480:  return 0;",
          "",
          "[Removed Lines]",
          "1475: #line 1476 \"ext/standard/var_unserializer.c\"",
          "1477: #line 1004 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1474: #line 1475 \"ext/standard/var_unserializer.c\"",
          "1476: #line 1003 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "478: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "479: {",
          "487: }",
          "489: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "",
          "[Removed Lines]",
          "480:  if (*((*p)++) == '}')",
          "481:   return 1;",
          "483: #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE",
          "484:  zval_ptr_dtor(rval);",
          "485: #endif",
          "486:  return 0;",
          "",
          "[Added Lines]",
          "480:  if (*p >= max || **p != '}') {",
          "481:   return 0;",
          "482:  }",
          "484:  (*p)++;",
          "485:  return 1;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5bb25776a00e1074d1230a311043b00f7cce9252",
      "candidate_info": {
        "commit_hash": "5bb25776a00e1074d1230a311043b00f7cce9252",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/5bb25776a00e1074d1230a311043b00f7cce9252",
        "files": [
          "Zend/zend.h",
          "Zend/zend_alloc.c",
          "Zend/zend_builtin_functions.c",
          "Zend/zend_compile.c",
          "Zend/zend_constants.c",
          "Zend/zend_constants.h",
          "Zend/zend_exceptions.c",
          "Zend/zend_execute.h",
          "Zend/zend_execute_API.c",
          "Zend/zend_language_scanner.c",
          "Zend/zend_language_scanner.l",
          "Zend/zend_multiply.h",
          "Zend/zend_objects.c",
          "Zend/zend_strtod.c",
          "ext/standard/filters.c",
          "ext/standard/html.c",
          "ext/standard/http.c",
          "ext/standard/info.c",
          "ext/standard/proc_open.c",
          "ext/standard/streamsfuncs.c",
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "further fixes on core",
        "before_after_code_files": [
          "Zend/zend.h||Zend/zend.h",
          "Zend/zend_alloc.c||Zend/zend_alloc.c",
          "Zend/zend_builtin_functions.c||Zend/zend_builtin_functions.c",
          "Zend/zend_compile.c||Zend/zend_compile.c",
          "Zend/zend_constants.c||Zend/zend_constants.c",
          "Zend/zend_constants.h||Zend/zend_constants.h",
          "Zend/zend_exceptions.c||Zend/zend_exceptions.c",
          "Zend/zend_execute.h||Zend/zend_execute.h",
          "Zend/zend_execute_API.c||Zend/zend_execute_API.c",
          "Zend/zend_language_scanner.c||Zend/zend_language_scanner.c",
          "Zend/zend_language_scanner.l||Zend/zend_language_scanner.l",
          "Zend/zend_multiply.h||Zend/zend_multiply.h",
          "Zend/zend_objects.c||Zend/zend_objects.c",
          "Zend/zend_strtod.c||Zend/zend_strtod.c",
          "ext/standard/filters.c||ext/standard/filters.c",
          "ext/standard/html.c||ext/standard/html.c",
          "ext/standard/http.c||ext/standard/http.c",
          "ext/standard/info.c||ext/standard/info.c",
          "ext/standard/proc_open.c||ext/standard/proc_open.c",
          "ext/standard/streamsfuncs.c||ext/standard/streamsfuncs.c",
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/zend.h||Zend/zend.h": [
          "File: Zend/zend.h -> Zend/zend.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "390: # define XtOffset(p_type, field) \\",
          "",
          "[Removed Lines]",
          "391:     ((long) (((char *) (&(((p_type)NULL)->field))) - ((char *) NULL)))",
          "",
          "[Added Lines]",
          "391:     ((zend_int_t) (((char *) (&(((p_type)NULL)->field))) - ((char *) NULL)))",
          "",
          "---------------"
        ],
        "Zend/zend_alloc.c||Zend/zend_alloc.c": [
          "File: Zend/zend_alloc.c -> Zend/zend_alloc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1373: #ifdef ZTS",
          "1374:  if (ZEND_MM_BAD_THREAD_ID(p)) {",
          "1375:   if (!silent) {",
          "1377:    had_problems = 1;",
          "1378:   } else {",
          "1379:    return zend_mm_check_ptr(heap, ptr, 0 ZEND_FILE_LINE_RELAY_CC ZEND_FILE_LINE_ORIG_RELAY_CC);",
          "",
          "[Removed Lines]",
          "1376:    zend_debug_alloc_output(\"Invalid pointer: ((thread_id=0x%0.8X) != (expected=0x%0.8X))\\n\", (long)p->thread_id, (long)tsrm_thread_id());",
          "",
          "[Added Lines]",
          "1376:    zend_debug_alloc_output(\"Invalid pointer: ((thread_id=0x%0.8X) != (expected=0x%0.8X))\\n\", (zend_int_t)p->thread_id, (zend_int_t)tsrm_thread_id());",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2474: static inline size_t safe_address(size_t nmemb, size_t size, size_t offset)",
          "2475: {",
          "2476:  size_t res = nmemb;",
          "2479:  __asm__ (\"mull %3\\n\\taddl %4,%0\\n\\tadcl $0,%1\"",
          "2480:       : \"=&a\"(res), \"=&d\" (overflow)",
          "",
          "[Removed Lines]",
          "2477:  unsigned long overflow = 0;",
          "",
          "[Added Lines]",
          "2477:  zend_uint_t overflow = 0;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2494: static inline size_t safe_address(size_t nmemb, size_t size, size_t offset)",
          "2495: {",
          "2496:         size_t res = nmemb;",
          "2500: # define LP_SUFF \"l\"",
          "",
          "[Removed Lines]",
          "2497:         unsigned long overflow = 0;",
          "",
          "[Added Lines]",
          "2497:         zend_uint_t overflow = 0;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2523: static inline size_t safe_address(size_t nmemb, size_t size, size_t offset)",
          "2524: {",
          "2525:         size_t res;",
          "2528:         __asm__ (\"umlal %0,%1,%2,%3\"",
          "2529:              : \"=r\"(res), \"=r\"(overflow)",
          "",
          "[Removed Lines]",
          "2526:         unsigned long overflow;",
          "",
          "[Added Lines]",
          "2526:         zend_uint_t overflow;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2544: static inline size_t safe_address(size_t nmemb, size_t size, size_t offset)",
          "2545: {",
          "2546:         size_t res;",
          "2549:         __asm__ (\"mul %0,%2,%3\\n\\tumulh %1,%2,%3\\n\\tadds %0,%0,%4\\n\\tadc %1,%1,xzr\"",
          "2550:              : \"=&r\"(res), \"=&r\"(overflow)",
          "",
          "[Removed Lines]",
          "2547:         unsigned long overflow;",
          "",
          "[Added Lines]",
          "2547:         zend_uint_t overflow;",
          "",
          "---------------"
        ],
        "Zend/zend_builtin_functions.c||Zend/zend_builtin_functions.c": [
          "File: Zend/zend_builtin_functions.c -> Zend/zend_builtin_functions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "411: {",
          "412:  int arg_count, first_extra_arg;",
          "413:  zval *arg;",
          "415:  zend_execute_data *ex;",
          "418:   return;",
          "419:  }",
          "",
          "[Removed Lines]",
          "414:  long requested_offset;",
          "417:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"l\", &requested_offset) == FAILURE) {",
          "",
          "[Added Lines]",
          "414:  zend_int_t requested_offset;",
          "417:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"i\", &requested_offset) == FAILURE) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1907: #ifdef ZTS",
          "1908: ZEND_FUNCTION(zend_thread_id)",
          "1909: {",
          "1911: }",
          "1912: #endif",
          "1913: #endif",
          "",
          "[Removed Lines]",
          "1910:  RETURN_INT((long)tsrm_thread_id());",
          "",
          "[Added Lines]",
          "1910:  RETURN_INT((zend_int_t)tsrm_thread_id());",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2111:  const char *include_filename = NULL;",
          "2112:  zval arg_array;",
          "2113:  int indent = 0;",
          "2118:   return;",
          "2119:  }",
          "",
          "[Removed Lines]",
          "2114:  long options = 0;",
          "2115:  long limit = 0;",
          "2117:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|ll\", &options, &limit) == FAILURE) {",
          "",
          "[Added Lines]",
          "2114:  zend_int_t options = 0;",
          "2115:  zend_int_t limit = 0;",
          "2117:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|ii\", &options, &limit) == FAILURE) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2500: ZEND_FUNCTION(debug_backtrace)",
          "2501: {",
          "2506:   return;",
          "2507:  }",
          "",
          "[Removed Lines]",
          "2502:  long options = DEBUG_BACKTRACE_PROVIDE_OBJECT;",
          "2503:  long limit = 0;",
          "2505:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|ll\", &options, &limit) == FAILURE) {",
          "",
          "[Added Lines]",
          "2502:  zend_int_t options = DEBUG_BACKTRACE_PROVIDE_OBJECT;",
          "2503:  zend_int_t limit = 0;",
          "2505:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|ii\", &options, &limit) == FAILURE) {",
          "",
          "---------------"
        ],
        "Zend/zend_compile.c||Zend/zend_compile.c": [
          "File: Zend/zend_compile.c -> Zend/zend_compile.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6312:  if (constant_array) {",
          "6314:   zend_uint size;",
          "6316:   zend_string *str;",
          "6318:   if (init_opline->op1_type != IS_UNUSED) {",
          "",
          "[Removed Lines]",
          "6315:   long num;",
          "",
          "[Added Lines]",
          "6315:   zend_int_t num;",
          "",
          "---------------"
        ],
        "Zend/zend_constants.c||Zend/zend_constants.c": [
          "File: Zend/zend_constants.c -> Zend/zend_constants.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "323:  return c ? &c->value : NULL;",
          "324: }",
          "327: {",
          "328:  zend_constant *c;",
          "329:  const char *colon;",
          "",
          "[Removed Lines]",
          "326: ZEND_API zval *zend_get_constant_ex(zend_string *cname, zend_class_entry *scope, ulong flags TSRMLS_DC)",
          "",
          "[Added Lines]",
          "326: ZEND_API zval *zend_get_constant_ex(zend_string *cname, zend_class_entry *scope, zend_uint_t flags TSRMLS_DC)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "449:  }",
          "450: }",
          "453: {",
          "454:  zend_constant *c;",
          "",
          "[Removed Lines]",
          "452: zend_constant *zend_quick_get_constant(const zval *key, ulong flags TSRMLS_DC)",
          "",
          "[Added Lines]",
          "452: zend_constant *zend_quick_get_constant(const zval *key, zend_uint_t flags TSRMLS_DC)",
          "",
          "---------------"
        ],
        "Zend/zend_constants.h||Zend/zend_constants.h": [
          "File: Zend/zend_constants.h -> Zend/zend_constants.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "67: void clean_non_persistent_constants(TSRMLS_D);",
          "68: ZEND_API zval *zend_get_constant(zend_string *name TSRMLS_DC);",
          "69: ZEND_API zval *zend_get_constant_str(const char *name, uint name_len TSRMLS_DC);",
          "71: ZEND_API void zend_register_bool_constant(const char *name, uint name_len, zend_bool bval, int flags, int module_number TSRMLS_DC);",
          "72: ZEND_API void zend_register_null_constant(const char *name, uint name_len, int flags, int module_number TSRMLS_DC);",
          "73: ZEND_API void zend_register_int_constant(const char *name, uint name_len, zend_int_t lval, int flags, int module_number TSRMLS_DC);",
          "",
          "[Removed Lines]",
          "70: ZEND_API zval *zend_get_constant_ex(zend_string *name, zend_class_entry *scope, ulong flags TSRMLS_DC);",
          "",
          "[Added Lines]",
          "70: ZEND_API zval *zend_get_constant_ex(zend_string *name, zend_class_entry *scope, zend_uint_t flags TSRMLS_DC);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "76: ZEND_API void zend_register_stringl_constant(const char *name, uint name_len, char *strval, uint strlen, int flags, int module_number TSRMLS_DC);",
          "77: ZEND_API int zend_register_constant(zend_constant *c TSRMLS_DC);",
          "78: void zend_copy_constants(HashTable *target, HashTable *sourc);",
          "80: END_EXTERN_C()",
          "82: #define ZEND_CONSTANT_DTOR free_zend_constant",
          "",
          "[Removed Lines]",
          "79: zend_constant *zend_quick_get_constant(const zval *key, ulong flags TSRMLS_DC);",
          "",
          "[Added Lines]",
          "79: zend_constant *zend_quick_get_constant(const zval *key, zend_uint_t flags TSRMLS_DC);",
          "",
          "---------------"
        ],
        "Zend/zend_exceptions.c||Zend/zend_exceptions.c": [
          "File: Zend/zend_exceptions.c -> Zend/zend_exceptions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "459:    TRACE_APPEND_STR(\"true, \");",
          "460:    break;",
          "461:   case IS_RESOURCE: {",
          "463:    char s_tmp[MAX_LENGTH_OF_ZEND_INT + 1];",
          "465:    TRACE_APPEND_STR(\"Resource id #\");",
          "",
          "[Removed Lines]",
          "462:    long lval = Z_RES_HANDLE_P(arg);",
          "",
          "[Added Lines]",
          "462:    zend_int_t lval = Z_RES_HANDLE_P(arg);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "468:    break;",
          "469:   }",
          "470:   case IS_INT: {",
          "472:    char s_tmp[MAX_LENGTH_OF_ZEND_INT + 1];",
          "474:    TRACE_APPEND_STRL(s_tmp, l_tmp);",
          "",
          "[Removed Lines]",
          "471:    long lval = Z_IVAL_P(arg);",
          "",
          "[Added Lines]",
          "471:    zend_int_t lval = Z_IVAL_P(arg);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "584: ZEND_METHOD(exception, getTraceAsString)",
          "585: {",
          "586:  zval *trace, *frame;",
          "588:  zend_string *str, *key;",
          "589:  int num = 0, len;",
          "590:  char s_tmp[MAX_LENGTH_OF_ZEND_INT + 7 + 1 + 1];",
          "",
          "[Removed Lines]",
          "587:  ulong index;",
          "",
          "[Added Lines]",
          "587:  zend_uint_t index;",
          "",
          "---------------"
        ],
        "Zend/zend_execute.h||Zend/zend_execute.h": [
          "File: Zend/zend_execute.h -> Zend/zend_execute.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: ZEND_API int zend_eval_string_ex(char *str, zval *retval_ptr, char *string_name, int handle_exceptions TSRMLS_DC);",
          "49: ZEND_API int zend_eval_stringl_ex(char *str, int str_len, zval *retval_ptr, char *string_name, int handle_exceptions TSRMLS_DC);",
          "52: ZEND_API void zend_verify_arg_error(int error_type, const zend_function *zf, zend_uint arg_num, const char *need_msg, const char *need_kind, const char *given_msg, const char *given_kind, zval *arg TSRMLS_DC);",
          "54: static zend_always_inline void i_zval_ptr_dtor(zval *zval_ptr ZEND_FILE_LINE_DC TSRMLS_DC)",
          "",
          "[Removed Lines]",
          "51: ZEND_API char * zend_verify_arg_class_kind(const zend_arg_info *cur_arg_info, ulong fetch_type, char **class_name, zend_class_entry **pce TSRMLS_DC);",
          "",
          "[Added Lines]",
          "51: ZEND_API char * zend_verify_arg_class_kind(const zend_arg_info *cur_arg_info, zend_uint_t fetch_type, char **class_name, zend_class_entry **pce TSRMLS_DC);",
          "",
          "---------------"
        ],
        "Zend/zend_execute_API.c||Zend/zend_execute_API.c": [
          "File: Zend/zend_execute_API.c -> Zend/zend_execute_API.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1681:  if (execute_data) {",
          "1682:   if (!execute_data->symbol_table) {",
          "1684:    zend_op_array *op_array = &execute_data->func->op_array;",
          "1685:    int i;",
          "",
          "[Removed Lines]",
          "1683:    zend_ulong h = STR_HASH_VAL(name);",
          "",
          "[Added Lines]",
          "1683:    zend_uint_t h = STR_HASH_VAL(name);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1717:  if (execute_data) {",
          "1718:   if (!execute_data->symbol_table) {",
          "1720:    zend_op_array *op_array = &execute_data->func->op_array;",
          "1721:    int i;",
          "",
          "[Removed Lines]",
          "1719:    zend_ulong h = zend_hash_func(name, len);",
          "",
          "[Added Lines]",
          "1719:    zend_uint_t h = zend_hash_func(name, len);",
          "",
          "---------------"
        ],
        "Zend/zend_language_scanner.c||Zend/zend_language_scanner.c": [
          "File: Zend/zend_language_scanner.c -> Zend/zend_language_scanner.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1645:   yyleng = YYCURSOR - SCNG(yy_text);",
          "1646: #line 2153 \"Zend/zend_language_scanner.l\"",
          "1647:   {",
          "1649:  yy_push_state(ST_IN_SCRIPTING TSRMLS_CC);",
          "1650:  yyless(1);",
          "1651:  return T_CURLY_OPEN;",
          "",
          "[Removed Lines]",
          "1648:  Z_IVAL_P(zendlval) = (long) '{';",
          "",
          "[Added Lines]",
          "1648:  Z_IVAL_P(zendlval) = (zend_int_t) '{';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1873:   yyleng = YYCURSOR - SCNG(yy_text);",
          "1874: #line 2153 \"Zend/zend_language_scanner.l\"",
          "1875:   {",
          "1877:  yy_push_state(ST_IN_SCRIPTING TSRMLS_CC);",
          "1878:  yyless(1);",
          "1879:  return T_CURLY_OPEN;",
          "",
          "[Removed Lines]",
          "1876:  Z_IVAL_P(zendlval) = (long) '{';",
          "",
          "[Added Lines]",
          "1876:  Z_IVAL_P(zendlval) = (zend_int_t) '{';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2132:   yyleng = YYCURSOR - SCNG(yy_text);",
          "2133: #line 2153 \"Zend/zend_language_scanner.l\"",
          "2134:   {",
          "2136:  yy_push_state(ST_IN_SCRIPTING TSRMLS_CC);",
          "2137:  yyless(1);",
          "2138:  return T_CURLY_OPEN;",
          "",
          "[Removed Lines]",
          "2135:  Z_IVAL_P(zendlval) = (long) '{';",
          "",
          "[Added Lines]",
          "2135:  Z_IVAL_P(zendlval) = (zend_int_t) '{';",
          "",
          "---------------"
        ],
        "Zend/zend_language_scanner.l||Zend/zend_language_scanner.l": [
          "File: Zend/zend_language_scanner.l -> Zend/zend_language_scanner.l",
          "--- Hunk 1 ---",
          "[Context before]",
          "2153: <ST_DOUBLE_QUOTES,ST_BACKQUOTE,ST_HEREDOC>\"{$\" {",
          "2155:  yy_push_state(ST_IN_SCRIPTING TSRMLS_CC);",
          "2156:  yyless(1);",
          "2157:  return T_CURLY_OPEN;",
          "",
          "[Removed Lines]",
          "2154:  Z_IVAL_P(zendlval) = (long) '{';",
          "",
          "[Added Lines]",
          "2154:  Z_IVAL_P(zendlval) = (zend_int_t) '{';",
          "",
          "---------------"
        ],
        "Zend/zend_multiply.h||Zend/zend_multiply.h": [
          "File: Zend/zend_multiply.h -> Zend/zend_multiply.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "81:  }                \\",
          "82: } while (0)",
          "86: #define ZEND_SIGNED_MULTIPLY_INT(a, b, lval, dval, usedval) do { \\",
          "87:  zend_long64 __result = (zend_long64) (a) * (zend_long64) (b); \\",
          "",
          "[Removed Lines]",
          "84: #elif SIZEOF_LONG == 4 && defined(HAVE_ZEND_LONG64)",
          "",
          "[Added Lines]",
          "84: #elif SIZEOF_ZEND_INT == 4 && defined(HAVE_ZEND_LONG64)",
          "",
          "---------------"
        ],
        "Zend/zend_objects.c||Zend/zend_objects.c": [
          "File: Zend/zend_objects.c -> Zend/zend_objects.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "149:  }",
          "150:  if (old_object->properties) {",
          "151:   zval *prop, new_prop;",
          "153:   zend_string *key;",
          "155:   if (!new_object->properties) {",
          "",
          "[Removed Lines]",
          "152:   ulong num_key;",
          "",
          "[Added Lines]",
          "152:   zend_uint_t num_key;",
          "",
          "---------------"
        ],
        "Zend/zend_strtod.c||Zend/zend_strtod.c": [
          "File: Zend/zend_strtod.c -> Zend/zend_strtod.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "174: #endif",
          "176: #define Long    int32_t",
          "179: #ifdef __cplusplus",
          "180: #include \"malloc.h\"",
          "",
          "[Removed Lines]",
          "177: #define ULong   uint32_t",
          "",
          "[Added Lines]",
          "177: #define zend_uint_t   uint32_t",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "273:  typedef union {",
          "274:       double d;",
          "276:  } _double;",
          "277: #define value(x) ((x).d)",
          "278: #ifdef IEEE_LITTLE_ENDIAN",
          "",
          "[Removed Lines]",
          "275:        ULong ul[2];",
          "",
          "[Added Lines]",
          "275:        zend_uint_t ul[2];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "418: struct Bigint {",
          "419:  struct Bigint *next;",
          "420:  int k, maxwds, sign, wds;",
          "422: };",
          "424: typedef struct Bigint Bigint;",
          "",
          "[Removed Lines]",
          "421:  ULong x[1];",
          "",
          "[Added Lines]",
          "421:  zend_uint_t x[1];",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "519: static char * rv_alloc(int i) {",
          "520:  int j, k, *r;",
          "523:  for(k = 0;",
          "525:    j <<= 1) {",
          "526:   k++;",
          "527:  }",
          "",
          "[Removed Lines]",
          "522:  j = sizeof(ULong);",
          "524:    sizeof(Bigint) - sizeof(ULong) - sizeof(int) + j <= i;",
          "",
          "[Added Lines]",
          "522:  j = sizeof(zend_uint_t);",
          "524:    sizeof(Bigint) - sizeof(zend_uint_t) - sizeof(int) + j <= i;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "549: {",
          "550:  int i, wds;",
          "552: #ifdef Pack_32",
          "554: #endif",
          "555:  Bigint *b1;",
          "",
          "[Removed Lines]",
          "551:  ULong *x, y;",
          "553:  ULong xi, z;",
          "",
          "[Added Lines]",
          "551:  zend_uint_t *x, y;",
          "553:  zend_uint_t xi, z;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "584:  return b;",
          "585: }",
          "588: {",
          "589:  int k = 0;",
          "",
          "[Removed Lines]",
          "587: static int hi0bits(ULong x)",
          "",
          "[Added Lines]",
          "587: static int hi0bits(zend_uint_t x)",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "613:  return k;",
          "614: }",
          "617: {",
          "618:  int k;",
          "621:  if (x & 7) {",
          "622:   if (x & 1) {",
          "",
          "[Removed Lines]",
          "616: static int lo0bits(ULong *y)",
          "619:  ULong x = *y;",
          "",
          "[Added Lines]",
          "616: static int lo0bits(zend_uint_t *y)",
          "619:  zend_uint_t x = *y;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "671: {",
          "672:  Bigint *c;",
          "673:  int k, wa, wb, wc;",
          "676: #ifdef Pack_32",
          "678: #endif",
          "680:  if (a->wds < b->wds) {",
          "",
          "[Removed Lines]",
          "674:  ULong carry, y, z;",
          "675:  ULong *x, *xa, *xae, *xb, *xbe, *xc, *xc0;",
          "677:  ULong z2;",
          "",
          "[Added Lines]",
          "674:  zend_uint_t carry, y, z;",
          "675:  zend_uint_t *x, *xa, *xae, *xb, *xbe, *xc, *xc0;",
          "677:  zend_uint_t z2;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "751:  return c;",
          "752: }",
          "755: {",
          "756:  Bigint *b;",
          "757:  int i, k;",
          "",
          "[Removed Lines]",
          "754: static Bigint * s2b (CONST char *s, int nd0, int nd, ULong y9)",
          "",
          "[Added Lines]",
          "754: static Bigint * s2b (CONST char *s, int nd0, int nd, zend_uint_t y9)",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "830: {",
          "831:  int i, k1, n, n1;",
          "832:  Bigint *b1;",
          "835: #ifdef Pack_32",
          "836:  n = k >> 5;",
          "",
          "[Removed Lines]",
          "833:  ULong *x, *x1, *xe, z;",
          "",
          "[Added Lines]",
          "833:  zend_uint_t *x, *x1, *xe, z;",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "887: static int cmp(Bigint *a, Bigint *b)",
          "888: {",
          "890:  int i, j;",
          "892:  i = a->wds;",
          "",
          "[Removed Lines]",
          "889:  ULong *xa, *xa0, *xb, *xb0;",
          "",
          "[Added Lines]",
          "889:  zend_uint_t *xa, *xa0, *xb, *xb0;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "918:  Bigint *c;",
          "919:  int i, wa, wb;",
          "922: #ifdef Pack_32",
          "923:  Long z;",
          "924: #endif",
          "",
          "[Removed Lines]",
          "921:  ULong *xa, *xae, *xb, *xbe, *xc;",
          "",
          "[Added Lines]",
          "921:  zend_uint_t *xa, *xae, *xb, *xbe, *xc;",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1030: (Bigint *a, int *e)",
          "1031: #endif",
          "1032: {",
          "1034:  int k;",
          "1035:  volatile _double d;",
          "1036: #ifdef VAX",
          "1038: #else",
          "1039: #define d0 word0(d)",
          "1040: #define d1 word1(d)",
          "",
          "[Removed Lines]",
          "1033:  ULong *xa, *xa0, w, y, z;",
          "1037:  ULong d0, d1;",
          "",
          "[Added Lines]",
          "1033:  zend_uint_t *xa, *xa0, w, y, z;",
          "1037:  zend_uint_t d0, d1;",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1097: {",
          "1098:  Bigint *b;",
          "1099:  int de, i, k;",
          "1101:  volatile _double d;",
          "1102: #ifdef VAX",
          "1104: #endif",
          "1106:  value(d) = _d;",
          "",
          "[Removed Lines]",
          "1100:  ULong *x, y, z;",
          "1103:  ULong d0, d1;",
          "",
          "[Added Lines]",
          "1100:  zend_uint_t *x, y, z;",
          "1103:  zend_uint_t d0, d1;",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1283: {",
          "1284:  int n;",
          "1285:  Long borrow, y;",
          "1288: #ifdef Pack_32",
          "1289:  Long z;",
          "1291: #endif",
          "1293:  n = S->wds;",
          "",
          "[Removed Lines]",
          "1286:  ULong carry, q, ys;",
          "1287:  ULong *bx, *bxe, *sx, *sxe;",
          "1290:  ULong si, zs;",
          "",
          "[Added Lines]",
          "1286:  zend_uint_t carry, q, ys;",
          "1287:  zend_uint_t *bx, *bxe, *sx, *sxe;",
          "1290:  zend_uint_t si, zs;",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1481:  Long L;",
          "1482: #ifndef Sudden_Underflow",
          "1483:  int denorm;",
          "1485: #endif",
          "1486:  Bigint *b, *b1, *delta, *mlo, *mhi, *S, *tmp;",
          "1487:  double ds;",
          "",
          "[Removed Lines]",
          "1484:  ULong x;",
          "",
          "[Added Lines]",
          "1484:  zend_uint_t x;",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "2044:  volatile double aadj, aadj1, adj;",
          "2045:  volatile _double rv, rv0;",
          "2046:  Long L;",
          "2048:  Bigint *bb, *bb1, *bd, *bd0, *bs, *delta, *tmp;",
          "2049:  double result;",
          "",
          "[Removed Lines]",
          "2047:  ULong y, z;",
          "",
          "[Added Lines]",
          "2047:  zend_uint_t y, z;",
          "",
          "---------------"
        ],
        "ext/standard/filters.c||ext/standard/filters.c": [
          "File: ext/standard/filters.c -> ext/standard/filters.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1232: }",
          "1234: #if IT_WAS_USED",
          "1236: {",
          "1237:  zval **tmpval;",
          "",
          "[Removed Lines]",
          "1235: static php_conv_err_t php_conv_get_long_prop_ex(const HashTable *ht, long *pretval, char *field_name, size_t field_name_len)",
          "",
          "[Added Lines]",
          "1235: static php_conv_err_t php_conv_get_long_prop_ex(const HashTable *ht, php_int_t *pretval, char *field_name, size_t field_name_len)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1255: }",
          "1256: #endif",
          "1259: {",
          "1260:  zval *tmpval;",
          "",
          "[Removed Lines]",
          "1258: static php_conv_err_t php_conv_get_ulong_prop_ex(const HashTable *ht, unsigned long *pretval, char *field_name, size_t field_name_len)",
          "",
          "[Added Lines]",
          "1258: static php_conv_err_t php_conv_get_ulong_prop_ex(const HashTable *ht, php_uint_t *pretval, char *field_name, size_t field_name_len)",
          "",
          "---------------"
        ],
        "ext/standard/html.c||ext/standard/html.c": [
          "File: ext/standard/html.c -> ext/standard/html.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "856: static inline int resolve_named_entity_html(const char *start, size_t length, const entity_ht *ht, unsigned *uni_cp1, unsigned *uni_cp2)",
          "857: {",
          "858:  const entity_cp_map *s;",
          "861:  s = ht->buckets[hash % ht->num_elems];",
          "862:  while (s->entity) {",
          "",
          "[Removed Lines]",
          "859:  ulong hash = zend_inline_hash_func(start, length);",
          "",
          "[Added Lines]",
          "859:  php_uint_t hash = zend_inline_hash_func(start, length);",
          "",
          "---------------"
        ],
        "ext/standard/http.c||ext/standard/http.c": [
          "File: ext/standard/http.c -> ext/standard/http.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35:  char *newprefix, *p;",
          "36:  const char *prop_name;",
          "37:  int arg_sep_len, newprefix_len, prop_len;",
          "39:  zval *zdata = NULL, copyzval;",
          "41:  if (!ht) {",
          "",
          "[Removed Lines]",
          "38:  ulong idx;",
          "",
          "[Added Lines]",
          "38:  php_uint_t idx;",
          "",
          "---------------"
        ],
        "ext/standard/info.c||ext/standard/info.c": [
          "File: ext/standard/info.c -> ext/standard/info.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "196: {",
          "197:  zval *data, *tmp, tmp2;",
          "198:  zend_string *string_key;",
          "200:  zend_string *key;",
          "202:  key = STR_INIT(name, name_length, 0);",
          "",
          "[Removed Lines]",
          "199:  ulong num_key;",
          "",
          "[Added Lines]",
          "199:  php_uint_t num_key;",
          "",
          "---------------"
        ],
        "ext/standard/proc_open.c||ext/standard/proc_open.c": [
          "File: ext/standard/proc_open.c -> ext/standard/proc_open.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "427:  int i;",
          "428:  zval *descitem = NULL;",
          "429:  zend_string *str_index;",
          "431:  struct php_proc_open_descriptor_item descriptors[PHP_PROC_OPEN_MAX_DESCRIPTORS];",
          "432: #ifdef PHP_WIN32",
          "433:  PROCESS_INFORMATION pi;",
          "",
          "[Removed Lines]",
          "430:  ulong nindex;",
          "",
          "[Added Lines]",
          "430:  php_uint_t nindex;",
          "",
          "---------------"
        ],
        "ext/standard/streamsfuncs.c||ext/standard/streamsfuncs.c": [
          "File: ext/standard/streamsfuncs.c -> ext/standard/streamsfuncs.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "619:  php_stream *stream;",
          "620:  int ret = 0;",
          "621:  zend_string *key;",
          "624:  if (Z_TYPE_P(stream_array) != IS_ARRAY) {",
          "625:   return 0;",
          "",
          "[Removed Lines]",
          "622:  ulong num_ind;",
          "",
          "[Added Lines]",
          "622:  php_uint_t num_ind;",
          "",
          "---------------"
        ],
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:  zend_string *class_name;",
          "101:  int is_temp;",
          "102:  int is_ref = 0;",
          "104:  zend_string *key;",
          "105:  zval *val;",
          "",
          "[Removed Lines]",
          "103:  ulong num;",
          "",
          "[Added Lines]",
          "103:  php_uint_t num;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "171:     php_printf(\"%sobject(unknown class)#%d (%d) {\\n\", COMMON, Z_OBJ_HANDLE_P(struc), myht ? zend_obj_num_elements(myht) : 0);",
          "172:    }",
          "173:    if (myht) {",
          "175:     zend_string *key;",
          "176:     zval *val;",
          "",
          "[Removed Lines]",
          "174:     ulong num;",
          "",
          "[Added Lines]",
          "174:     php_uint_t num;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "271:  zend_string *class_name;",
          "272:  int is_temp = 0;",
          "273:  int is_ref = 0;",
          "275:  zend_string *key;",
          "276:  zval *val;",
          "",
          "[Removed Lines]",
          "274:  ulong index;",
          "",
          "[Added Lines]",
          "274:  php_uint_t index;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "459:  int tmp_len;",
          "460:  zend_string *class_name;",
          "461:  zend_string *ztmp, *ztmp2;",
          "463:  zend_string *key;",
          "464:  zval *val;",
          "",
          "[Removed Lines]",
          "462:  ulong index;",
          "",
          "[Added Lines]",
          "462:  php_uint_t index;",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: typedef struct {",
          "32:  zval *data[VAR_ENTRIES_MAX];",
          "34:  void *next;",
          "35: } var_entries;",
          "37: typedef struct {",
          "38:  zval data[VAR_ENTRIES_MAX];",
          "40:  void *next;",
          "41: } var_dtor_entries;",
          "",
          "[Removed Lines]",
          "33:  long used_slots;",
          "39:  long used_slots;",
          "",
          "[Added Lines]",
          "33:  php_int_t used_slots;",
          "39:  php_int_t used_slots;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "120: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "121: {",
          "123:  var_entries *var_hash = (*var_hashx)->first;",
          "124: #if VAR_ENTRIES_DBG",
          "125:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "",
          "[Removed Lines]",
          "122:  long i;",
          "",
          "[Added Lines]",
          "122:  php_int_t i;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "136:  }",
          "137: }",
          "140: {",
          "141:  var_entries *var_hash = (*var_hashx)->first;",
          "142: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "139: static zval *var_access(php_unserialize_data_t *var_hashx, long id)",
          "",
          "[Added Lines]",
          "139: static zval *var_access(php_unserialize_data_t *var_hashx, php_int_t id)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "158: PHPAPI void var_destroy(php_unserialize_data_t *var_hashx)",
          "159: {",
          "160:  void *next;",
          "162:  var_entries *var_hash = (*var_hashx)->first;",
          "163:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "164: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "161:  long i;",
          "",
          "[Added Lines]",
          "161:  php_int_t i;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "242: {",
          "243:  char cursor;",
          "245:  int neg = 0;",
          "247:  switch (*p) {",
          "",
          "[Removed Lines]",
          "241: static inline long parse_iv2(const unsigned char *p, const unsigned char **q)",
          "244:  long result = 0;",
          "",
          "[Added Lines]",
          "241: static inline php_int_t parse_iv2(const unsigned char *p, const unsigned char **q)",
          "244:  php_int_t result = 0;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "266:  return result;",
          "267: }",
          "270: {",
          "271:  return parse_iv2(p, NULL);",
          "272: }",
          "",
          "[Removed Lines]",
          "269: static inline long parse_iv(const unsigned char *p)",
          "",
          "[Added Lines]",
          "269: static inline php_int_t parse_iv(const unsigned char *p)",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "296: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC",
          "297: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash TSRMLS_CC",
          "300: {",
          "301:  while (elements-- > 0) {",
          "302:   zval key, *data, d, *old_data;",
          "",
          "[Removed Lines]",
          "299: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long elements, int objprops)",
          "",
          "[Added Lines]",
          "299: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, php_int_t elements, int objprops)",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "381: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "382: {",
          "385:  datalen = parse_iv2((*p) + 2, p);",
          "387:  (*p) += 2;",
          "389:  if (datalen < 0 || (*p) + datalen >= max) {",
          "391:   return 0;",
          "392:  }",
          "",
          "[Removed Lines]",
          "383:  long datalen;",
          "390:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "",
          "[Added Lines]",
          "383:  php_int_t datalen;",
          "390:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (php_int_t)(max - (*p)));",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "403:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "404: }",
          "407: {",
          "410:  elements = parse_iv2((*p) + 2, p);",
          "",
          "[Removed Lines]",
          "406: static inline long object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "408:  long elements;",
          "",
          "[Added Lines]",
          "406: static inline php_int_t object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "408:  php_int_t elements;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "426: #ifdef PHP_WIN32",
          "427: # pragma optimize(\"\", off)",
          "428: #endif",
          "430: {",
          "431:  zval retval;",
          "432:  zval fname;",
          "",
          "[Removed Lines]",
          "429: static inline int object_common2(UNSERIALIZE_PARAMETER, long elements)",
          "",
          "[Added Lines]",
          "429: static inline int object_common2(UNSERIALIZE_PARAMETER, php_int_t elements)",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "625: #line 681 \"ext/standard/var_unserializer.re\"",
          "626:  {",
          "627:  size_t len, len2, len3, maxlen;",
          "629:  char *str;",
          "630:  zend_string *class_name;",
          "631:  zend_class_entry *ce;",
          "",
          "[Removed Lines]",
          "628:  long elements;",
          "",
          "[Added Lines]",
          "628:  php_int_t elements;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "817:  ++YYCURSOR;",
          "818: #line 652 \"ext/standard/var_unserializer.re\"",
          "819:  {",
          "",
          "[Removed Lines]",
          "820:  long elements = parse_iv(start + 2);",
          "",
          "[Added Lines]",
          "820:  php_int_t elements = parse_iv(start + 2);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1023:  ++YYCURSOR;",
          "1024: #line 588 \"ext/standard/var_unserializer.re\"",
          "1025:  {",
          "1027: use_double:",
          "1028: #endif",
          "",
          "[Removed Lines]",
          "1026: #if SIZEOF_LONG == 4",
          "",
          "[Added Lines]",
          "1026: #if SIZEOF_ZEND_INT == 4",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1134:  ++YYCURSOR;",
          "1135: #line 546 \"ext/standard/var_unserializer.re\"",
          "1136:  {",
          "1138:  int digits = YYCURSOR - start - 3;",
          "1140:  if (start[2] == '-' || start[2] == '+') {",
          "1141:   digits--;",
          "1142:  }",
          "1145:  if (digits >= MAX_LENGTH_OF_ZEND_INT - 1) {",
          "1146:   if (digits == MAX_LENGTH_OF_ZEND_INT - 1) {",
          "1147:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_ZEND_INT, int_min_digits, MAX_LENGTH_OF_ZEND_INT - 1);",
          "",
          "[Removed Lines]",
          "1137: #if SIZEOF_LONG == 4",
          "",
          "[Added Lines]",
          "1137: #if SIZEOF_ZEND_INT == 4",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1206:  ++YYCURSOR;",
          "1207: #line 511 \"ext/standard/var_unserializer.re\"",
          "1208:  {",
          "1212:  if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1209:  long id;",
          "",
          "[Added Lines]",
          "1209:  php_int_t id;",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1252:  ++YYCURSOR;",
          "1253: #line 489 \"ext/standard/var_unserializer.re\"",
          "1254:  {",
          "1258:  if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1255:  long id;",
          "",
          "[Added Lines]",
          "1255:  php_int_t id;",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: typedef struct {",
          "30:  zval *data[VAR_ENTRIES_MAX];",
          "32:  void *next;",
          "33: } var_entries;",
          "35: typedef struct {",
          "36:  zval data[VAR_ENTRIES_MAX];",
          "38:  void *next;",
          "39: } var_dtor_entries;",
          "",
          "[Removed Lines]",
          "31:  long used_slots;",
          "37:  long used_slots;",
          "",
          "[Added Lines]",
          "31:  php_int_t used_slots;",
          "37:  php_int_t used_slots;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "118: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "119: {",
          "121:  var_entries *var_hash = (*var_hashx)->first;",
          "122: #if VAR_ENTRIES_DBG",
          "123:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "",
          "[Removed Lines]",
          "120:  long i;",
          "",
          "[Added Lines]",
          "120:  php_int_t i;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "134:  }",
          "135: }",
          "138: {",
          "139:  var_entries *var_hash = (*var_hashx)->first;",
          "140: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "137: static zval *var_access(php_unserialize_data_t *var_hashx, long id)",
          "",
          "[Added Lines]",
          "137: static zval *var_access(php_unserialize_data_t *var_hashx, php_int_t id)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "156: PHPAPI void var_destroy(php_unserialize_data_t *var_hashx)",
          "157: {",
          "158:  void *next;",
          "160:  var_entries *var_hash = (*var_hashx)->first;",
          "161:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "162: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "159:  long i;",
          "",
          "[Added Lines]",
          "159:  php_int_t i;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "246: {",
          "247:  char cursor;",
          "249:  int neg = 0;",
          "251:  switch (*p) {",
          "",
          "[Removed Lines]",
          "245: static inline long parse_iv2(const unsigned char *p, const unsigned char **q)",
          "248:  long result = 0;",
          "",
          "[Added Lines]",
          "245: static inline php_int_t parse_iv2(const unsigned char *p, const unsigned char **q)",
          "248:  php_int_t result = 0;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "270:  return result;",
          "271: }",
          "274: {",
          "275:  return parse_iv2(p, NULL);",
          "276: }",
          "",
          "[Removed Lines]",
          "273: static inline long parse_iv(const unsigned char *p)",
          "",
          "[Added Lines]",
          "273: static inline php_int_t parse_iv(const unsigned char *p)",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "300: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC",
          "301: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash TSRMLS_CC",
          "304: {",
          "305:  while (elements-- > 0) {",
          "306:   zval key, *data, d, *old_data;",
          "",
          "[Removed Lines]",
          "303: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long elements, int objprops)",
          "",
          "[Added Lines]",
          "303: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, php_int_t elements, int objprops)",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "385: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "386: {",
          "389:  datalen = parse_iv2((*p) + 2, p);",
          "391:  (*p) += 2;",
          "393:  if (datalen < 0 || (*p) + datalen >= max) {",
          "395:   return 0;",
          "396:  }",
          "",
          "[Removed Lines]",
          "387:  long datalen;",
          "394:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "",
          "[Added Lines]",
          "387:  php_int_t datalen;",
          "394:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (php_int_t)(max - (*p)));",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "407:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "408: }",
          "411: {",
          "414:  elements = parse_iv2((*p) + 2, p);",
          "",
          "[Removed Lines]",
          "410: static inline long object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "412:  long elements;",
          "",
          "[Added Lines]",
          "410: static inline php_int_t object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "412:  php_int_t elements;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "430: #ifdef PHP_WIN32",
          "431: # pragma optimize(\"\", off)",
          "432: #endif",
          "434: {",
          "435:  zval retval;",
          "436:  zval fname;",
          "",
          "[Removed Lines]",
          "433: static inline int object_common2(UNSERIALIZE_PARAMETER, long elements)",
          "",
          "[Added Lines]",
          "433: static inline int object_common2(UNSERIALIZE_PARAMETER, php_int_t elements)",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "489: \"R:\" iv \";\"  {",
          "493:  if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "490:  long id;",
          "",
          "[Added Lines]",
          "490:  php_int_t id;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "509: }",
          "511: \"r:\" iv \";\"  {",
          "515:  if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "512:  long id;",
          "",
          "[Added Lines]",
          "512:  php_int_t id;",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "544: }",
          "546: \"i:\" iv \";\" {",
          "548:  int digits = YYCURSOR - start - 3;",
          "550:  if (start[2] == '-' || start[2] == '+') {",
          "551:   digits--;",
          "552:  }",
          "555:  if (digits >= MAX_LENGTH_OF_ZEND_INT - 1) {",
          "556:   if (digits == MAX_LENGTH_OF_ZEND_INT - 1) {",
          "557:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_ZEND_INT, int_min_digits, MAX_LENGTH_OF_ZEND_INT - 1);",
          "",
          "[Removed Lines]",
          "547: #if SIZEOF_LONG == 4",
          "",
          "[Added Lines]",
          "547: #if SIZEOF_ZEND_INT == 4",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "586: }",
          "588: \"d:\" (iv | nv | nvexp) \";\" {",
          "590: use_double:",
          "591: #endif",
          "",
          "[Removed Lines]",
          "589: #if SIZEOF_LONG == 4",
          "",
          "[Added Lines]",
          "589: #if SIZEOF_ZEND_INT == 4",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "650: }",
          "652: \"a:\" uiv \":\" \"{\" {",
          "",
          "[Removed Lines]",
          "653:  long elements = parse_iv(start + 2);",
          "",
          "[Added Lines]",
          "653:  php_int_t elements = parse_iv(start + 2);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "681: object \":\" uiv \":\" [\"] {",
          "682:  size_t len, len2, len3, maxlen;",
          "684:  char *str;",
          "685:  zend_string *class_name;",
          "686:  zend_class_entry *ce;",
          "",
          "[Removed Lines]",
          "683:  long elements;",
          "",
          "[Added Lines]",
          "683:  php_int_t elements;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
      "candidate_info": {
        "commit_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
        "files": [
          "Zend/zend_objects_API.c",
          "ext/standard/tests/serialize/bug73052.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fix bug #73052 - Memory Corruption in During Deserialized-object Destruction",
        "before_after_code_files": [
          "Zend/zend_objects_API.c||Zend/zend_objects_API.c",
          "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/zend_objects_API.c||Zend/zend_objects_API.c": [
          "File: Zend/zend_objects_API.c -> Zend/zend_objects_API.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "306: {",
          "307:  zend_object_handle handle = Z_OBJ_HANDLE_P(zobject);",
          "308:  zend_object_store_bucket *obj_bucket = &EG(objects_store).object_buckets[handle];",
          "311:  obj_bucket->destructor_called = 1;",
          "312: }",
          "",
          "[Removed Lines]",
          "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);;",
          "",
          "[Added Lines]",
          "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt": [
          "File: ext/standard/tests/serialize/bug73052.phpt -> ext/standard/tests/serialize/bug73052.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73052: Memory Corruption in During Deserialized-object Destruction",
          "3: --FILE--",
          "4: <?php",
          "6: class obj {",
          "7:     var $ryat;",
          "8:     public function __destruct() {",
          "9:         $this->ryat = null;",
          "10:     }",
          "11: }",
          "13: $poc = 'O:3:\"obj\":1:{';",
          "14: var_dump(unserialize($poc));",
          "15: ?>",
          "16: --EXPECTF--",
          "17: Notice: unserialize(): Error at offset 13 of 13 bytes in %sbug73052.php on line %d",
          "18: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "438:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
          "439:         zend_hash_clean(Z_OBJPROP_PP(rval));",
          "440:      }",
          "441:      ZVAL_NULL(*rval);",
          "442:   return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "440:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "495: {",
          "496:  YYCTYPE yych;",
          "497:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "494: #line 495 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "495: #line 496 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "551:  yych = *(YYMARKER = ++YYCURSOR);",
          "552:  if (yych == ':') goto yy95;",
          "553: yy3:",
          "555:  { return 0; }",
          "557: yy4:",
          "558:  yych = *(YYMARKER = ++YYCURSOR);",
          "559:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "554: #line 860 \"ext/standard/var_unserializer.re\"",
          "556: #line 557 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "555: #line 861 \"ext/standard/var_unserializer.re\"",
          "557: #line 558 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "596:  goto yy3;",
          "597: yy14:",
          "598:  ++YYCURSOR;",
          "600:  {",
          "602:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "604: }",
          "606: yy16:",
          "607:  yych = *++YYCURSOR;",
          "608:  goto yy3;",
          "",
          "[Removed Lines]",
          "599: #line 854 \"ext/standard/var_unserializer.re\"",
          "605: #line 606 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "600: #line 855 \"ext/standard/var_unserializer.re\"",
          "606: #line 607 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "633:  yych = *++YYCURSOR;",
          "634:  if (yych != '\"') goto yy18;",
          "635:  ++YYCURSOR;",
          "637:  {",
          "638:  size_t len, len2, len3, maxlen;",
          "639:  long elements;",
          "",
          "[Removed Lines]",
          "636: #line 707 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "637: #line 708 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "781:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "782: }",
          "784: yy25:",
          "785:  yych = *++YYCURSOR;",
          "786:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "783: #line 784 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "784: #line 785 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "805:  yych = *++YYCURSOR;",
          "806:  if (yych != '\"') goto yy18;",
          "807:  ++YYCURSOR;",
          "809:  {",
          "810:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "808: #line 698 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "809: #line 699 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "814:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "815:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "816: }",
          "818: yy32:",
          "819:  yych = *++YYCURSOR;",
          "820:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "817: #line 818 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "818: #line 819 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "835:  yych = *++YYCURSOR;",
          "836:  if (yych != '{') goto yy18;",
          "837:  ++YYCURSOR;",
          "839:  {",
          "840:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "838: #line 677 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "839: #line 678 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "857:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "858: }",
          "860: yy39:",
          "861:  yych = *++YYCURSOR;",
          "862:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "859: #line 860 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "860: #line 861 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "877:  yych = *++YYCURSOR;",
          "878:  if (yych != '\"') goto yy18;",
          "879:  ++YYCURSOR;",
          "881:  {",
          "882:  size_t len, maxlen;",
          "883:  char *str;",
          "",
          "[Removed Lines]",
          "880: #line 642 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "881: #line 643 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "912:  ZVAL_STRINGL(*rval, str, len, 0);",
          "913:  return 1;",
          "914: }",
          "916: yy46:",
          "917:  yych = *++YYCURSOR;",
          "918:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "915: #line 916 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "916: #line 917 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "933:  yych = *++YYCURSOR;",
          "934:  if (yych != '\"') goto yy18;",
          "935:  ++YYCURSOR;",
          "937:  {",
          "938:  size_t len, maxlen;",
          "939:  char *str;",
          "",
          "[Removed Lines]",
          "936: #line 609 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "937: #line 610 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "966:  ZVAL_STRINGL(*rval, str, len, 1);",
          "967:  return 1;",
          "968: }",
          "970: yy53:",
          "971:  yych = *++YYCURSOR;",
          "972:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "969: #line 970 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "970: #line 971 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1054:  }",
          "1055: yy63:",
          "1056:  ++YYCURSOR;",
          "1058:  {",
          "1059: #if SIZEOF_LONG == 4",
          "1060: use_double:",
          "",
          "[Removed Lines]",
          "1057: #line 599 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1058: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1064:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1065:  return 1;",
          "1066: }",
          "1068: yy65:",
          "1069:  yych = *++YYCURSOR;",
          "1070:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1067: #line 1068 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1123:  yych = *++YYCURSOR;",
          "1124:  if (yych != ';') goto yy18;",
          "1125:  ++YYCURSOR;",
          "1127:  {",
          "1129:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1126: #line 584 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1127: #line 585 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1139:  return 1;",
          "1140: }",
          "1142: yy76:",
          "1143:  yych = *++YYCURSOR;",
          "1144:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1141: #line 1142 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1165:  if (yych <= '9') goto yy79;",
          "1166:  if (yych != ';') goto yy18;",
          "1167:  ++YYCURSOR;",
          "1169:  {",
          "1170: #if SIZEOF_LONG == 4",
          "1171:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1168: #line 557 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1169: #line 558 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1192:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1193:  return 1;",
          "1194: }",
          "1196: yy83:",
          "1197:  yych = *++YYCURSOR;",
          "1198:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1195: #line 1196 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1200:  yych = *++YYCURSOR;",
          "1201:  if (yych != ';') goto yy18;",
          "1202:  ++YYCURSOR;",
          "1204:  {",
          "1206:  INIT_PZVAL(*rval);",
          "1207:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1208:  return 1;",
          "1209: }",
          "1211: yy87:",
          "1212:  ++YYCURSOR;",
          "1214:  {",
          "1216:  INIT_PZVAL(*rval);",
          "1217:  ZVAL_NULL(*rval);",
          "1218:  return 1;",
          "1219: }",
          "1221: yy89:",
          "1222:  yych = *++YYCURSOR;",
          "1223:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1203: #line 550 \"ext/standard/var_unserializer.re\"",
          "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
          "1213: #line 543 \"ext/standard/var_unserializer.re\"",
          "1220: #line 1221 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1204: #line 551 \"ext/standard/var_unserializer.re\"",
          "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
          "1214: #line 544 \"ext/standard/var_unserializer.re\"",
          "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1240:  if (yych <= '9') goto yy91;",
          "1241:  if (yych != ';') goto yy18;",
          "1242:  ++YYCURSOR;",
          "1244:  {",
          "1245:  long id;",
          "",
          "[Removed Lines]",
          "1243: #line 520 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1244: #line 521 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1264:  return 1;",
          "1265: }",
          "1267: yy95:",
          "1268:  yych = *++YYCURSOR;",
          "1269:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1266: #line 1267 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1286:  if (yych <= '9') goto yy97;",
          "1287:  if (yych != ';') goto yy18;",
          "1288:  ++YYCURSOR;",
          "1290:  {",
          "1291:  long id;",
          "",
          "[Removed Lines]",
          "1289: #line 499 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1290: #line 500 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1308:  return 1;",
          "1309: }",
          "1311: }",
          "1315:  return 0;",
          "",
          "[Removed Lines]",
          "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
          "1312: #line 862 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
          "1313: #line 863 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "442:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
          "443:         zend_hash_clean(Z_OBJPROP_PP(rval));",
          "444:      }",
          "445:      ZVAL_NULL(*rval);",
          "446:   return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "444:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
          "",
          "---------------"
        ]
      }
    }
  ]
}