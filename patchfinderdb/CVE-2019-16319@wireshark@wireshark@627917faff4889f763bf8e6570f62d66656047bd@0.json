{
  "cve_id": "CVE-2019-16319",
  "cve_desc": "In Wireshark 3.0.0 to 3.0.3 and 2.6.0 to 2.6.10, the Gryphon dissector could go into an infinite loop. This was addressed in plugins/epan/gryphon/packet-gryphon.c by checking for a message length of zero.",
  "repo": "wireshark/wireshark",
  "patch_hash": "627917faff4889f763bf8e6570f62d66656047bd",
  "patch_info": {
    "commit_hash": "627917faff4889f763bf8e6570f62d66656047bd",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/627917faff4889f763bf8e6570f62d66656047bd",
    "files": [
      "plugins/epan/gryphon/packet-gryphon.c"
    ],
    "message": "Gryphon: Prevent endless loop\n\nBug: 16020\nChange-Id: I59c24d3bdb3f3a85f6e498683594ee12db9642a8\nReviewed-on: https://code.wireshark.org/review/34392\nReviewed-by: Michael Mann <mmann78@netscape.net>\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot\nReviewed-by: Anders Broman <a.broman58@gmail.com>",
    "before_after_code_files": [
      "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c"
    ]
  },
  "patch_diff": {
    "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c": [
      "File: plugins/epan/gryphon/packet-gryphon.c -> plugins/epan/gryphon/packet-gryphon.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1195:         proto_tree_add_item(gryphon_tree, hf_gryphon_data, tvb, offset, msglen, ENC_NA);",
      "1197:         return offset;",
      "1198:     }",
      "",
      "[Removed Lines]",
      "1196:         offset += msglen;",
      "",
      "[Added Lines]",
      "1196:         if (msglen != 0) {",
      "1197:             offset += msglen;",
      "1198:         } else {",
      "1199:             offset = tvb_reported_length_remaining(tvb, offset);",
      "1200:         }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "02ddd49885c6a09e936a76aceb726ed06539704a",
      "candidate_info": {
        "commit_hash": "02ddd49885c6a09e936a76aceb726ed06539704a",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/02ddd49885c6a09e936a76aceb726ed06539704a",
        "files": [
          "plugins/epan/gryphon/packet-gryphon.c"
        ],
        "message": "Gryphon: Prevent endless loop\n\nBug: 16020\nChange-Id: I59c24d3bdb3f3a85f6e498683594ee12db9642a8\nReviewed-on: https://code.wireshark.org/review/34392\nReviewed-by: Michael Mann <mmann78@netscape.net>\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot\nReviewed-by: Anders Broman <a.broman58@gmail.com>\n(cherry picked from commit 627917faff4889f763bf8e6570f62d66656047bd)\nReviewed-on: https://code.wireshark.org/review/34396",
        "before_after_code_files": [
          "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c"
          ],
          "candidate": [
            "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c"
          ]
        }
      },
      "candidate_diff": {
        "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c": [
          "File: plugins/epan/gryphon/packet-gryphon.c -> plugins/epan/gryphon/packet-gryphon.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1195:         proto_tree_add_item(gryphon_tree, hf_gryphon_data, tvb, offset, msglen, ENC_NA);",
          "1197:         return offset;",
          "1198:     }",
          "",
          "[Removed Lines]",
          "1196:         offset += msglen;",
          "",
          "[Added Lines]",
          "1196:         if (msglen != 0) {",
          "1197:             offset += msglen;",
          "1198:         } else {",
          "1199:             offset = tvb_reported_length_remaining(tvb, offset);",
          "1200:         }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "eae9aa28b426089819f1dea2a1ef28fe0fa621f7",
      "candidate_info": {
        "commit_hash": "eae9aa28b426089819f1dea2a1ef28fe0fa621f7",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/eae9aa28b426089819f1dea2a1ef28fe0fa621f7",
        "files": [
          "plugins/epan/gryphon/packet-gryphon.c"
        ],
        "message": "Gryphon: Prevent endless loop\n\nBug: 16020\nChange-Id: I59c24d3bdb3f3a85f6e498683594ee12db9642a8\nReviewed-on: https://code.wireshark.org/review/34392\nReviewed-by: Michael Mann <mmann78@netscape.net>\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot\nReviewed-by: Anders Broman <a.broman58@gmail.com>\n(cherry picked from commit 627917faff4889f763bf8e6570f62d66656047bd)\nReviewed-on: https://code.wireshark.org/review/34397",
        "before_after_code_files": [
          "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c"
          ],
          "candidate": [
            "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c"
          ]
        }
      },
      "candidate_diff": {
        "plugins/epan/gryphon/packet-gryphon.c||plugins/epan/gryphon/packet-gryphon.c": [
          "File: plugins/epan/gryphon/packet-gryphon.c -> plugins/epan/gryphon/packet-gryphon.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1195:         proto_tree_add_item(gryphon_tree, hf_gryphon_data, tvb, offset, msglen, ENC_NA);",
          "1197:         return offset;",
          "1198:     }",
          "",
          "[Removed Lines]",
          "1196:         offset += msglen;",
          "",
          "[Added Lines]",
          "1196:         if (msglen != 0) {",
          "1197:             offset += msglen;",
          "1198:         } else {",
          "1199:             offset = tvb_reported_length_remaining(tvb, offset);",
          "1200:         }",
          "",
          "---------------"
        ]
      }
    }
  ]
}