{
  "cve_id": "CVE-2020-13397",
  "cve_desc": "An issue was discovered in FreeRDP before 2.1.1. An out-of-bounds (OOB) read vulnerability has been detected in security_fips_decrypt in libfreerdp/core/security.c due to an uninitialized value.",
  "repo": "FreeRDP/FreeRDP",
  "patch_hash": "d6cd14059b257318f176c0ba3ee0a348826a9ef8",
  "patch_info": {
    "commit_hash": "d6cd14059b257318f176c0ba3ee0a348826a9ef8",
    "repo": "FreeRDP/FreeRDP",
    "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/d6cd14059b257318f176c0ba3ee0a348826a9ef8",
    "files": [
      "libfreerdp/core/security.c"
    ],
    "message": "Fixed GHSL-2020-101 missing NULL check\n\n(cherry picked from commit b207dbba35c505bbc3ad5aadc10b34980c6b7e8e)",
    "before_after_code_files": [
      "libfreerdp/core/security.c||libfreerdp/core/security.c"
    ]
  },
  "patch_diff": {
    "libfreerdp/core/security.c||libfreerdp/core/security.c": [
      "File: libfreerdp/core/security.c -> libfreerdp/core/security.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "816: {",
      "817:  size_t olen;",
      "819:  if (!winpr_Cipher_Update(rdp->fips_decrypt, data, length, data, &olen))",
      "820:   return FALSE;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "819:  if (!rdp || !rdp->fips_decrypt)",
      "820:   return FALSE;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7ab56ab14c8b3e5416eee1777d5c47333dfea852",
      "candidate_info": {
        "commit_hash": "7ab56ab14c8b3e5416eee1777d5c47333dfea852",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/7ab56ab14c8b3e5416eee1777d5c47333dfea852",
        "files": [
          "winpr/libwinpr/utils/collections/PubSub.c"
        ],
        "message": "Fixed #6201: event handler count check\n\n(cherry picked from commit 018eaa44f52b3e9e33bfa80493faf9be57713a3d)",
        "before_after_code_files": [
          "winpr/libwinpr/utils/collections/PubSub.c||winpr/libwinpr/utils/collections/PubSub.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/FreeRDP/FreeRDP/pull/6212"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "winpr/libwinpr/utils/collections/PubSub.c||winpr/libwinpr/utils/collections/PubSub.c": [
          "File: winpr/libwinpr/utils/collections/PubSub.c -> winpr/libwinpr/utils/collections/PubSub.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "112:  {",
          "113:   status = 0;",
          "120:   else",
          "122:    status = -1;",
          "124:  }",
          "126:  if (pubSub->synchronized)",
          "",
          "[Removed Lines]",
          "115:   if (event->EventHandlerCount <= MAX_EVENT_HANDLERS)",
          "116:   {",
          "117:    event->EventHandlers[event->EventHandlerCount] = EventHandler;",
          "118:    event->EventHandlerCount++;",
          "119:   }",
          "121:   {",
          "123:   }",
          "",
          "[Added Lines]",
          "115:   if (event->EventHandlerCount < MAX_EVENT_HANDLERS)",
          "116:    event->EventHandlers[event->EventHandlerCount++] = EventHandler;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "37158cd17f02c64177c8047ca283d1fa22026c7e",
      "candidate_info": {
        "commit_hash": "37158cd17f02c64177c8047ca283d1fa22026c7e",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/37158cd17f02c64177c8047ca283d1fa22026c7e",
        "files": [
          "libfreerdp/codec/planar.c"
        ],
        "message": "Fixed UndefinedBehaviour in planar left shift\n\n(cherry picked from commit 328691c46597c194f01a77a9d33d58b2faa88c9d)",
        "before_after_code_files": [
          "libfreerdp/codec/planar.c||libfreerdp/codec/planar.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/FreeRDP/FreeRDP/pull/6212"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "libfreerdp/codec/planar.c||libfreerdp/codec/planar.c": [
          "File: libfreerdp/codec/planar.c -> libfreerdp/codec/planar.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1170:                                                BYTE* outPlane)",
          "1171: {",
          "1172:  char s2c;",
          "1174:  UINT32 y, x;",
          "1175:  BYTE* outPtr;",
          "1176:  const BYTE *srcPtr, *prevLinePtr;",
          "",
          "[Removed Lines]",
          "1173:  INT32 delta;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1194:  {",
          "1195:   for (x = 0; x < width; x++, outPtr++, srcPtr++, prevLinePtr++)",
          "1196:   {",
          "1198:    s2c = (delta >= 0) ? (char)delta : (char)(~((BYTE)(-delta)) + 1);",
          "1201:   }",
          "1202:  }",
          "",
          "[Removed Lines]",
          "1197:    delta = *srcPtr - *prevLinePtr;",
          "1199:    s2c = (s2c >= 0) ? (s2c << 1) : (char)(((~((BYTE)s2c) + 1) << 1) - 1);",
          "",
          "[Added Lines]",
          "1196:    INT32 delta = *srcPtr - *prevLinePtr;",
          "1198:    s2c = (s2c >= 0) ? ((UINT32)s2c << 1) : (char)(((UINT32)(~((BYTE)s2c) + 1) << 1) - 1);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3fe4650b2c4d09852fc5339f6e1d91fa24213c15",
      "candidate_info": {
        "commit_hash": "3fe4650b2c4d09852fc5339f6e1d91fa24213c15",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/3fe4650b2c4d09852fc5339f6e1d91fa24213c15",
        "files": [
          "channels/audin/client/audin_main.c",
          "channels/disp/client/disp_main.c",
          "channels/drdynvc/client/drdynvc_main.c",
          "channels/echo/client/echo_main.c",
          "channels/geometry/client/geometry_main.c",
          "channels/rdpei/client/rdpei_main.c",
          "channels/rdpgfx/client/rdpgfx_main.c",
          "channels/rdpsnd/client/rdpsnd_main.c",
          "channels/urbdrc/client/urbdrc_main.c",
          "channels/urbdrc/client/urbdrc_main.h",
          "channels/video/client/video_main.c"
        ],
        "message": "Fixed DestroyListener arguments and call order\n\n(cherry picked from commit 0e08727d4ecff2777884a23bc33961f63d52465e)",
        "before_after_code_files": [
          "channels/audin/client/audin_main.c||channels/audin/client/audin_main.c",
          "channels/disp/client/disp_main.c||channels/disp/client/disp_main.c",
          "channels/drdynvc/client/drdynvc_main.c||channels/drdynvc/client/drdynvc_main.c",
          "channels/echo/client/echo_main.c||channels/echo/client/echo_main.c",
          "channels/geometry/client/geometry_main.c||channels/geometry/client/geometry_main.c",
          "channels/rdpei/client/rdpei_main.c||channels/rdpei/client/rdpei_main.c",
          "channels/rdpgfx/client/rdpgfx_main.c||channels/rdpgfx/client/rdpgfx_main.c",
          "channels/rdpsnd/client/rdpsnd_main.c||channels/rdpsnd/client/rdpsnd_main.c",
          "channels/urbdrc/client/urbdrc_main.c||channels/urbdrc/client/urbdrc_main.c",
          "channels/urbdrc/client/urbdrc_main.h||channels/urbdrc/client/urbdrc_main.h",
          "channels/video/client/video_main.c||channels/video/client/video_main.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/FreeRDP/FreeRDP/pull/6212"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "channels/audin/client/audin_main.c||channels/audin/client/audin_main.c": [
          "File: channels/audin/client/audin_main.c -> channels/audin/client/audin_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "101:  FREERDP_DSP_CONTEXT* dsp_context;",
          "102:  wLog* log;",
          "103: };",
          "105: static BOOL audin_process_addin_args(AUDIN_PLUGIN* audin, ADDIN_ARGV* args);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "104:  IWTSListener* listener;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "687:  audin->listener_callback->plugin = pPlugin;",
          "688:  audin->listener_callback->channel_mgr = pChannelMgr;",
          "689:  return pChannelMgr->CreateListener(pChannelMgr, \"AUDIO_INPUT\", 0,",
          "691: }",
          "",
          "[Removed Lines]",
          "690:                                     &audin->listener_callback->iface, NULL);",
          "",
          "[Added Lines]",
          "692:                                     &audin->listener_callback->iface, &audin->listener);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "709:  {",
          "710:   IWTSVirtualChannelManager* mgr = audin->listener_callback->channel_mgr;",
          "711:   if (mgr)",
          "713:  }",
          "714:  audio_formats_free(audin->fixed_format, 1);",
          "",
          "[Removed Lines]",
          "712:    IFCALL(mgr->DestroyListener, mgr, &audin->iface);",
          "",
          "[Added Lines]",
          "714:    IFCALL(mgr->DestroyListener, mgr, audin->listener);",
          "",
          "---------------"
        ],
        "channels/disp/client/disp_main.c||channels/disp/client/disp_main.c": [
          "File: channels/disp/client/disp_main.c -> channels/disp/client/disp_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "326:  {",
          "327:   IWTSVirtualChannelManager* mgr = disp->listener_callback->channel_mgr;",
          "328:   if (mgr)",
          "330:  }",
          "332:  free(disp->listener_callback);",
          "",
          "[Removed Lines]",
          "329:    IFCALL(mgr->DestroyListener, mgr, &disp->iface);",
          "",
          "[Added Lines]",
          "329:    IFCALL(mgr->DestroyListener, mgr, disp->listener);",
          "",
          "---------------"
        ],
        "channels/drdynvc/client/drdynvc_main.c||channels/drdynvc/client/drdynvc_main.c": [
          "File: channels/drdynvc/client/drdynvc_main.c -> channels/drdynvc/client/drdynvc_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "217:   WLog_ERR(TAG, \"Terminated failed with error %\" PRIu32 \"!\", error);",
          "218: }",
          "220: static IWTSVirtualChannelManager* dvcman_new(drdynvcPlugin* plugin)",
          "221: {",
          "222:  wObject* obj;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "221: static void wts_listener_free(void* arg)",
          "222: {",
          "223:  DVCMAN_LISTENER* listener = (DVCMAN_LISTENER*)arg;",
          "224:  dvcman_wtslistener_free(listener);",
          "225: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "248:  if (!dvcman->listeners)",
          "249:   goto fail;",
          "250:  obj = ArrayList_Object(dvcman->listeners);",
          "253:  dvcman->plugin_names = ArrayList_New(TRUE);",
          "254:  if (!dvcman->plugin_names)",
          "",
          "[Removed Lines]",
          "251:  obj->fnObjectFree = dvcman_wtslistener_free;",
          "",
          "[Added Lines]",
          "257:  obj->fnObjectFree = wts_listener_free;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "378: {",
          "379:  DVCMAN* dvcman = (DVCMAN*)pChannelMgr;",
          "382:  ArrayList_Free(dvcman->channels);",
          "383:  ArrayList_Free(dvcman->plugin_names);",
          "386:  StreamPool_Free(dvcman->pool);",
          "387:  free(dvcman);",
          "",
          "[Removed Lines]",
          "381:  ArrayList_Free(dvcman->listeners);",
          "384:  ArrayList_Free(dvcman->plugins);",
          "",
          "[Added Lines]",
          "387:  ArrayList_Free(dvcman->plugins);",
          "390:  ArrayList_Free(dvcman->listeners);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "580: static UINT dvcman_close_channel(IWTSVirtualChannelManager* pChannelMgr, UINT32 ChannelId,",
          "581:                                  BOOL bSendClosePDU)",
          "582: {",
          "584:  DVCMAN_CHANNEL* channel;",
          "585:  UINT error = CHANNEL_RC_OK;",
          "586:  DVCMAN* dvcman = (DVCMAN*)pChannelMgr;",
          "",
          "[Removed Lines]",
          "583:  size_t i;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "614:   }",
          "615:  }",
          "625:  ArrayList_Remove(dvcman->channels, channel);",
          "626:  return error;",
          "627: }",
          "",
          "[Removed Lines]",
          "617:  ArrayList_Lock(dvcman->listeners);",
          "618:  for (i = ArrayList_Count(dvcman->listeners); i > 0; i--)",
          "619:  {",
          "620:   DVCMAN_LISTENER* listener = ArrayList_GetItem(dvcman->listeners, i - 1);",
          "621:   if (strcmp(listener->channel_name, channel->channel_name) == 0)",
          "622:    ArrayList_Remove(dvcman->listeners, listener);",
          "623:  }",
          "624:  ArrayList_Unlock(dvcman->listeners);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "channels/echo/client/echo_main.c||channels/echo/client/echo_main.c": [
          "File: channels/echo/client/echo_main.c -> channels/echo/client/echo_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "59:  IWTSPlugin iface;",
          "61:  ECHO_LISTENER_CALLBACK* listener_callback;",
          "62: };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "62:  IWTSListener* listener;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "143:  echo->listener_callback->channel_mgr = pChannelMgr;",
          "145:  return pChannelMgr->CreateListener(pChannelMgr, \"ECHO\", 0, &echo->listener_callback->iface,",
          "147: }",
          "",
          "[Removed Lines]",
          "146:                                     NULL);",
          "",
          "[Added Lines]",
          "147:                                     &echo->listener);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "158:  {",
          "159:   IWTSVirtualChannelManager* mgr = echo->listener_callback->channel_mgr;",
          "160:   if (mgr)",
          "162:  }",
          "163:  free(echo);",
          "",
          "[Removed Lines]",
          "161:    IFCALL(mgr->DestroyListener, mgr, &echo->iface);",
          "",
          "[Added Lines]",
          "162:    IFCALL(mgr->DestroyListener, mgr, echo->listener);",
          "",
          "---------------"
        ],
        "channels/geometry/client/geometry_main.c||channels/geometry/client/geometry_main.c": [
          "File: channels/geometry/client/geometry_main.c -> channels/geometry/client/geometry_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "431:  {",
          "432:   IWTSVirtualChannelManager* mgr = geometry->listener_callback->channel_mgr;",
          "433:   if (mgr)",
          "435:  }",
          "437:  if (context)",
          "",
          "[Removed Lines]",
          "434:    IFCALL(mgr->DestroyListener, mgr, &geometry->iface);",
          "",
          "[Added Lines]",
          "434:    IFCALL(mgr->DestroyListener, mgr, geometry->listener);",
          "",
          "---------------"
        ],
        "channels/rdpei/client/rdpei_main.c||channels/rdpei/client/rdpei_main.c": [
          "File: channels/rdpei/client/rdpei_main.c -> channels/rdpei/client/rdpei_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "601:  {",
          "602:   IWTSVirtualChannelManager* mgr = rdpei->listener_callback->channel_mgr;",
          "603:   if (mgr)",
          "605:  }",
          "606:  free(rdpei->listener_callback);",
          "607:  free(rdpei->context);",
          "",
          "[Removed Lines]",
          "604:    IFCALL(mgr->DestroyListener, mgr, &rdpei->iface);",
          "",
          "[Added Lines]",
          "604:    IFCALL(mgr->DestroyListener, mgr, rdpei->listener);",
          "",
          "---------------"
        ],
        "channels/rdpgfx/client/rdpgfx_main.c||channels/rdpgfx/client/rdpgfx_main.c": [
          "File: channels/rdpgfx/client/rdpgfx_main.c -> channels/rdpgfx/client/rdpgfx_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1916:  {",
          "1917:   IWTSVirtualChannelManager* mgr = gfx->listener_callback->channel_mgr;",
          "1918:   if (mgr)",
          "1920:  }",
          "1921:  rdpgfx_client_context_free(context);",
          "1922:  return CHANNEL_RC_OK;",
          "",
          "[Removed Lines]",
          "1919:    IFCALL(mgr->DestroyListener, mgr, &gfx->iface);",
          "",
          "[Added Lines]",
          "1919:    IFCALL(mgr->DestroyListener, mgr, gfx->listener);",
          "",
          "---------------"
        ],
        "channels/rdpsnd/client/rdpsnd_main.c||channels/rdpsnd/client/rdpsnd_main.c": [
          "File: channels/rdpsnd/client/rdpsnd_main.c -> channels/rdpsnd/client/rdpsnd_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1560:   {",
          "1561:    IWTSVirtualChannelManager* mgr = rdpsnd->listener_callback->channel_mgr;",
          "1562:    if (mgr)",
          "1564:   }",
          "1565:   free(rdpsnd->listener_callback);",
          "1566:   free(rdpsnd->iface.pInterface);",
          "",
          "[Removed Lines]",
          "1563:     IFCALL(mgr->DestroyListener, mgr, &rdpsnd->iface);",
          "",
          "[Added Lines]",
          "1563:     IFCALL(mgr->DestroyListener, mgr, rdpsnd->listener);",
          "",
          "---------------"
        ],
        "channels/urbdrc/client/urbdrc_main.c||channels/urbdrc/client/urbdrc_main.c": [
          "File: channels/urbdrc/client/urbdrc_main.c -> channels/urbdrc/client/urbdrc_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "688:  CharUpperA(channelName);",
          "689:  status = pChannelMgr->CreateListener(pChannelMgr, channelName, 0,",
          "691:  if (status != CHANNEL_RC_OK)",
          "692:   return status;",
          "",
          "[Removed Lines]",
          "690:                                       &urbdrc->listener_callback->iface, NULL);",
          "",
          "[Added Lines]",
          "690:                                       &urbdrc->listener_callback->iface, &urbdrc->listener);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "713:  {",
          "714:   IWTSVirtualChannelManager* mgr = urbdrc->listener_callback->channel_mgr;",
          "715:   if (mgr)",
          "717:  }",
          "718:  udevman = urbdrc->udevman;",
          "",
          "[Removed Lines]",
          "716:    IFCALL(mgr->DestroyListener, mgr, &urbdrc->iface);",
          "",
          "[Added Lines]",
          "716:    IFCALL(mgr->DestroyListener, mgr, urbdrc->listener);",
          "",
          "---------------"
        ],
        "channels/urbdrc/client/urbdrc_main.h||channels/urbdrc/client/urbdrc_main.h": [
          "File: channels/urbdrc/client/urbdrc_main.h -> channels/urbdrc/client/urbdrc_main.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "84:  char* subsystem;",
          "86:  wLog* log;",
          "87: };",
          "89: typedef BOOL (*PREGISTERURBDRCSERVICE)(IWTSPlugin* plugin, IUDEVMAN* udevman);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "87:  IWTSListener* listener;",
          "",
          "---------------"
        ],
        "channels/video/client/video_main.c||channels/video/client/video_main.c": [
          "File: channels/video/client/video_main.c -> channels/video/client/video_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1088:  {",
          "1089:   IWTSVirtualChannelManager* mgr = video->control_callback->channel_mgr;",
          "1090:   if (mgr)",
          "1092:  }",
          "1093:  if (video->data_callback)",
          "1094:  {",
          "1095:   IWTSVirtualChannelManager* mgr = video->data_callback->channel_mgr;",
          "1096:   if (mgr)",
          "1098:  }",
          "1100:  if (video->context)",
          "",
          "[Removed Lines]",
          "1091:    IFCALL(mgr->DestroyListener, mgr, &video->control_callback->iface);",
          "1097:    IFCALL(mgr->DestroyListener, mgr, &video->data_callback->iface);",
          "",
          "[Added Lines]",
          "1091:    IFCALL(mgr->DestroyListener, mgr, video->controlListener);",
          "1097:    IFCALL(mgr->DestroyListener, mgr, video->dataListener);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a84d2783f918fc85787801566827b639ced6b8b8",
      "candidate_info": {
        "commit_hash": "a84d2783f918fc85787801566827b639ced6b8b8",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/a84d2783f918fc85787801566827b639ced6b8b8",
        "files": [
          "channels/drdynvc/client/drdynvc_main.c"
        ],
        "message": "Fixed drdynvc_send stream release\n\n(cherry picked from commit a497e78d37b63f8f342be56e1732c5a891b5ba0d)",
        "before_after_code_files": [
          "channels/drdynvc/client/drdynvc_main.c||channels/drdynvc/client/drdynvc_main.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/FreeRDP/FreeRDP/pull/6212"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "channels/drdynvc/client/drdynvc_main.c||channels/drdynvc/client/drdynvc_main.c": [
          "File: channels/drdynvc/client/drdynvc_main.c -> channels/drdynvc/client/drdynvc_main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "615:    Stream_Write_UINT8(s, (CLOSE_REQUEST_PDU << 4) | 0x02);",
          "616:    Stream_Write_UINT32(s, ChannelId);",
          "617:    error = drdynvc_send(drdynvc, s);",
          "619:   }",
          "620:  }",
          "",
          "[Removed Lines]",
          "618:    Stream_Release(s);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "758:  switch (status)",
          "759:  {",
          "760:   case CHANNEL_RC_OK:",
          "762:    return CHANNEL_RC_OK;",
          "764:   case CHANNEL_RC_NOT_CONNECTED:",
          "765:    return CHANNEL_RC_OK;",
          "767:   case CHANNEL_RC_BAD_CHANNEL_HANDLE:",
          "768:    WLog_ERR(TAG, \"VirtualChannelWriteEx failed with CHANNEL_RC_BAD_CHANNEL_HANDLE\");",
          "769:    return status;",
          "771:   default:",
          "772:    WLog_Print(drdynvc->log, WLOG_ERROR,",
          "773:               \"VirtualChannelWriteEx failed with %s [%08\" PRIX32 \"]\",",
          "774:               WTSErrorToString(status), status);",
          "",
          "[Removed Lines]",
          "761:    Stream_AddRef(s);",
          "",
          "[Added Lines]",
          "763:    Stream_Release(s);",
          "767:    Stream_Release(s);",
          "772:    Stream_Release(s);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "814:  if (dataSize == 0)",
          "815:  {",
          "816:   dvcman_close_channel(drdynvc->channel_mgr, ChannelId, TRUE);",
          "817:  }",
          "818:  else if (dataSize <= CHANNEL_CHUNK_LENGTH - pos)",
          "819:  {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "818:   Stream_Release(data_out);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "442ac71ec73380af452f51d498aa7a4dfb624008",
      "candidate_info": {
        "commit_hash": "442ac71ec73380af452f51d498aa7a4dfb624008",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/442ac71ec73380af452f51d498aa7a4dfb624008",
        "files": [
          "libfreerdp/core/info.c"
        ],
        "message": "Renamed variable to avoid MSVC define collission\n\n(cherry picked from commit f9e1f21b0ce47d8eeea40314ce6b8b666964dc7d)",
        "before_after_code_files": [
          "libfreerdp/core/info.c||libfreerdp/core/info.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/FreeRDP/FreeRDP/pull/6212"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "libfreerdp/core/info.c||libfreerdp/core/info.c": [
          "File: libfreerdp/core/info.c -> libfreerdp/core/info.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "536: static BOOL rdp_read_info_packet(rdpRdp* rdp, wStream* s, UINT16 tpktlength)",
          "537: {",
          "539:  UINT32 flags;",
          "540:  UINT16 cbDomain;",
          "541:  UINT16 cbUserName;",
          "",
          "[Removed Lines]",
          "538:  BOOL small = FALSE;",
          "",
          "[Added Lines]",
          "538:  BOOL smallsize = FALSE;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "573:  if (settings->RdpVersion < RDP_VERSION_5_PLUS)",
          "",
          "[Removed Lines]",
          "574:   small = TRUE;",
          "",
          "[Added Lines]",
          "574:   smallsize = TRUE;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "583:   return FALSE;",
          "586:   return FALSE;",
          "589:   return FALSE;",
          "591:  if (!rdp_read_info_string(flags, s, cbAlternateShell, &settings->AlternateShell, 512))",
          "",
          "[Removed Lines]",
          "582:  if (!rdp_read_info_string(flags, s, cbDomain, &settings->Domain, small ? 52 : 512))",
          "585:  if (!rdp_read_info_string(flags, s, cbUserName, &settings->Username, small ? 44 : 512))",
          "588:  if (!rdp_read_info_string(flags, s, cbPassword, &settings->Password, small ? 32 : 512))",
          "",
          "[Added Lines]",
          "582:  if (!rdp_read_info_string(flags, s, cbDomain, &settings->Domain, smallsize ? 52 : 512))",
          "585:  if (!rdp_read_info_string(flags, s, cbUserName, &settings->Username, smallsize ? 44 : 512))",
          "588:  if (!rdp_read_info_string(flags, s, cbPassword, &settings->Password, smallsize ? 32 : 512))",
          "",
          "---------------"
        ]
      }
    }
  ]
}