{
  "cve_id": "CVE-2017-6952",
  "cve_desc": "Integer overflow in the cs_winkernel_malloc function in winkernel_mm.c in Capstone 3.0.4 and earlier allows attackers to cause a denial of service (heap-based buffer overflow in a kernel driver) or possibly have unspecified other impact via a large value.",
  "repo": "aquynh/capstone",
  "patch_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
  "patch_info": {
    "commit_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
    "repo": "aquynh/capstone",
    "commit_url": "https://github.com/aquynh/capstone/commit/6fe86eef621b9849f51a5e1e5d73258a93440403",
    "files": [
      "windows/winkernel_mm.c"
    ],
    "message": "provide a validity check to prevent against Integer overflow conditions (#870)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.",
    "before_after_code_files": [
      "windows/winkernel_mm.c||windows/winkernel_mm.c"
    ]
  },
  "patch_diff": {
    "windows/winkernel_mm.c||windows/winkernel_mm.c": [
      "File: windows/winkernel_mm.c -> windows/winkernel_mm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: #include \"winkernel_mm.h\"",
      "5: #include <ntddk.h>",
      "8: static const ULONG CS_WINKERNEL_POOL_TAG = 'kwsC';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "6: #include <Ntintsafe.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "35: #pragma prefast(suppress : 30030)  // Allocating executable POOL_TYPE memory",
      "38:  if (!block) {",
      "39:   return NULL;",
      "40:  }",
      "",
      "[Removed Lines]",
      "36:  CS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "37:    NonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);",
      "",
      "[Added Lines]",
      "37:  size_t number_of_bytes = 0;",
      "38:  CS_WINKERNEL_MEMBLOCK *block = NULL;",
      "42:  if (!NT_SUCCESS(RtlSizeTAdd(size, sizeof(CS_WINKERNEL_MEMBLOCK), &number_of_bytes))) {",
      "43:   return NULL;",
      "44:  }",
      "45:  block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "46:    NonPagedPool, number_of_bytes, CS_WINKERNEL_POOL_TAG);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9f6b28cc0b17bbade880c3eb472f490350598fc6",
      "candidate_info": {
        "commit_hash": "9f6b28cc0b17bbade880c3eb472f490350598fc6",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/9f6b28cc0b17bbade880c3eb472f490350598fc6",
        "files": [
          "arch/AArch64/AArch64Mapping.c",
          "arch/ARM/ARMMapping.c",
          "arch/M68K/M68KInstPrinter.c",
          "arch/Mips/MipsMapping.c",
          "arch/X86/X86Mapping.c"
        ],
        "message": "Add name to relative branch group in supported architectures. (#982)",
        "before_after_code_files": [
          "arch/AArch64/AArch64Mapping.c||arch/AArch64/AArch64Mapping.c",
          "arch/ARM/ARMMapping.c||arch/ARM/ARMMapping.c",
          "arch/M68K/M68KInstPrinter.c||arch/M68K/M68KInstPrinter.c",
          "arch/Mips/MipsMapping.c||arch/Mips/MipsMapping.c",
          "arch/X86/X86Mapping.c||arch/X86/X86Mapping.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/AArch64/AArch64Mapping.c||arch/AArch64/AArch64Mapping.c": [
          "File: arch/AArch64/AArch64Mapping.c -> arch/AArch64/AArch64Mapping.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "836:  { ARM64_GRP_RET, \"return\" },",
          "837:  { ARM64_GRP_PRIVILEGE, \"privilege\" },",
          "838:  { ARM64_GRP_INT, \"int\" },",
          "841:  { ARM64_GRP_CRYPTO, \"crypto\" },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "839:  { ARM64_GRP_BRANCH_RELATIVE, \"branch_relative\" },",
          "",
          "---------------"
        ],
        "arch/ARM/ARMMapping.c||arch/ARM/ARMMapping.c": [
          "File: arch/ARM/ARMMapping.c -> arch/ARM/ARMMapping.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "772:  { ARM_GRP_CALL, \"call\" },",
          "773:  { ARM_GRP_INT, \"int\" },",
          "774:  { ARM_GRP_PRIVILEGE, \"privilege\" },",
          "777:  { ARM_GRP_CRYPTO, \"crypto\" },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "775:  { ARM_GRP_BRANCH_RELATIVE, \"branch_relative\" },",
          "",
          "---------------"
        ],
        "arch/M68K/M68KInstPrinter.c||arch/M68K/M68KInstPrinter.c": [
          "File: arch/M68K/M68KInstPrinter.c -> arch/M68K/M68KInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "350:  { M68K_GRP_JUMP, \"jump\" },",
          "351:  { M68K_GRP_RET , \"ret\" },",
          "352:  { M68K_GRP_IRET, \"iret\" },",
          "353: };",
          "354: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "353:  { M68K_GRP_BRANCH_RELATIVE, \"branch_relative\" },",
          "",
          "---------------"
        ],
        "arch/Mips/MipsMapping.c||arch/Mips/MipsMapping.c": [
          "File: arch/Mips/MipsMapping.c -> arch/Mips/MipsMapping.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "907:  { MIPS_GRP_INT, \"int\" },",
          "908:  { MIPS_GRP_IRET, \"iret\" },",
          "909:  { MIPS_GRP_PRIVILEGE, \"privileged\" },",
          "912:  { MIPS_GRP_BITCOUNT, \"bitcount\" },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "910:  { MIPS_GRP_BRANCH_RELATIVE, \"branch_relative\" },",
          "",
          "---------------"
        ],
        "arch/X86/X86Mapping.c||arch/X86/X86Mapping.c": [
          "File: arch/X86/X86Mapping.c -> arch/X86/X86Mapping.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2377:  { X86_GRP_INT, \"int\" },",
          "2378:  { X86_GRP_IRET, \"iret\" },",
          "2379:  { X86_GRP_PRIVILEGE, \"privilege\" },",
          "2382:  { X86_GRP_VM, \"vm\" },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2380:  { X86_GRP_BRANCH_RELATIVE, \"branch_relative\" },",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "13271a9c7f211adfa38ee533b34c0b8c83da0a64",
      "candidate_info": {
        "commit_hash": "13271a9c7f211adfa38ee533b34c0b8c83da0a64",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/13271a9c7f211adfa38ee533b34c0b8c83da0a64",
        "files": [
          "cstool/cstool.c"
        ],
        "message": "cstool: fix mips64 mode",
        "before_after_code_files": [
          "cstool/cstool.c||cstool/cstool.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "cstool/cstool.c||cstool/cstool.c": [
          "File: cstool/cstool.c -> cstool/cstool.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "192:  if (!strcmp(mode, \"armb\") || !strcmp(mode, \"armbe\") ) {",
          "193:   arch = CS_ARCH_ARM;",
          "195:  }",
          "197:  if (!strcmp(mode, \"arml\")) {",
          "198:   arch = CS_ARCH_ARM;",
          "200:  }",
          "202:  if (!strcmp(mode, \"thumb\")) {",
          "203:   arch = CS_ARCH_ARM;",
          "205:  }",
          "207:  if (!strcmp(mode, \"thumbbe\")) {",
          "208:   arch = CS_ARCH_ARM;",
          "210:  }",
          "212:  if (!strcmp(mode, \"thumble\")) {",
          "213:   arch = CS_ARCH_ARM;",
          "215:  }",
          "217:  if (!strcmp(mode, \"arm64\")) {",
          "",
          "[Removed Lines]",
          "194:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM + CS_MODE_BIG_ENDIAN, &handle);",
          "199:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM + CS_MODE_LITTLE_ENDIAN, &handle);",
          "204:   err = cs_open(CS_ARCH_ARM, CS_MODE_THUMB + CS_MODE_LITTLE_ENDIAN, &handle);",
          "209:   err = cs_open(CS_ARCH_ARM, CS_MODE_THUMB + CS_MODE_BIG_ENDIAN, &handle);",
          "214:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM + CS_MODE_LITTLE_ENDIAN, &handle);",
          "",
          "[Added Lines]",
          "194:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM | CS_MODE_BIG_ENDIAN, &handle);",
          "199:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM | CS_MODE_LITTLE_ENDIAN, &handle);",
          "204:   err = cs_open(CS_ARCH_ARM, CS_MODE_THUMB | CS_MODE_LITTLE_ENDIAN, &handle);",
          "209:   err = cs_open(CS_ARCH_ARM, CS_MODE_THUMB | CS_MODE_BIG_ENDIAN, &handle);",
          "214:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM | CS_MODE_LITTLE_ENDIAN, &handle);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "222:  if (!strcmp(mode, \"mips\")) {",
          "223:   arch = CS_ARCH_MIPS;",
          "225:  }",
          "227:  if (!strcmp(mode, \"mipsbe\")) {",
          "228:   arch = CS_ARCH_MIPS;",
          "230:  }",
          "232:  if (!strcmp(mode, \"mips64\")) {",
          "233:   arch = CS_ARCH_MIPS;",
          "235:  }",
          "237:  if (!strcmp(mode, \"mips64be\")) {",
          "238:   arch = CS_ARCH_MIPS;",
          "240:  }",
          "242:  if (!strcmp(mode, \"x16\")) {",
          "",
          "[Removed Lines]",
          "224:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS32 + CS_MODE_LITTLE_ENDIAN, &handle);",
          "229:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS32 + CS_MODE_BIG_ENDIAN, &handle);",
          "234:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS64 + CS_MODE_BIG_ENDIAN, &handle);",
          "239:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS64 + CS_MODE_BIG_ENDIAN, &handle);",
          "",
          "[Added Lines]",
          "224:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS32 | CS_MODE_LITTLE_ENDIAN, &handle);",
          "229:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS32 | CS_MODE_BIG_ENDIAN, &handle);",
          "234:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS64 | CS_MODE_LITTLE_ENDIAN, &handle);",
          "239:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS64 | CS_MODE_BIG_ENDIAN, &handle);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "287:  if (!strcmp(mode,\"ppc64\")) {",
          "288:   arch = CS_ARCH_PPC;",
          "290:  }",
          "292:  if (!strcmp(mode,\"ppc64be\")) {",
          "293:   arch = CS_ARCH_PPC;",
          "295:  }",
          "297:  if (!strcmp(mode,\"sparc\")) {",
          "",
          "[Removed Lines]",
          "289:   err = cs_open(CS_ARCH_PPC, CS_MODE_64+CS_MODE_LITTLE_ENDIAN, &handle);",
          "294:   err = cs_open(CS_ARCH_PPC,CS_MODE_64+CS_MODE_BIG_ENDIAN, &handle);",
          "",
          "[Added Lines]",
          "289:   err = cs_open(CS_ARCH_PPC, CS_MODE_64 | CS_MODE_LITTLE_ENDIAN, &handle);",
          "294:   err = cs_open(CS_ARCH_PPC,CS_MODE_64 | CS_MODE_BIG_ENDIAN, &handle);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5b80627a5d7f33e6274d883f0a3533b743af30ec",
      "candidate_info": {
        "commit_hash": "5b80627a5d7f33e6274d883f0a3533b743af30ec",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/5b80627a5d7f33e6274d883f0a3533b743af30ec",
        "files": [
          "bindings/python/capstone/__init__.py",
          "bindings/python/test_skipdata.py"
        ],
        "message": "python: cast skipdata function inside binding to simplify the API",
        "before_after_code_files": [
          "bindings/python/capstone/__init__.py||bindings/python/capstone/__init__.py",
          "bindings/python/test_skipdata.py||bindings/python/test_skipdata.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "bindings/python/capstone/__init__.py||bindings/python/capstone/__init__.py": [
          "File: bindings/python/capstone/__init__.py -> bindings/python/capstone/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "786:         _skipdata_opt = _cs_opt_skipdata()",
          "787:         _mnem, _cb, _ud = opt",
          "788:         _skipdata_opt.mnemonic = _mnem.encode()",
          "790:         _skipdata_opt.user_data = ctypes.cast(_ud, ctypes.c_void_p)",
          "791:         status = _cs.cs_option(self.csh, CS_OPT_SKIPDATA_SETUP, ctypes.cast(ctypes.byref(_skipdata_opt), ctypes.c_void_p))",
          "792:         if status != CS_ERR_OK:",
          "",
          "[Removed Lines]",
          "789:         _skipdata_opt.callback = ctypes.cast(_cb, CS_SKIPDATA_CALLBACK)",
          "",
          "[Added Lines]",
          "789:         _skipdata_opt.callback = CS_SKIPDATA_CALLBACK(_cb)",
          "",
          "---------------"
        ],
        "bindings/python/test_skipdata.py||bindings/python/test_skipdata.py": [
          "File: bindings/python/test_skipdata.py -> bindings/python/test_skipdata.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "57:             # NOTE: This example ignores SKIPDATA's callback (first None) & user_data (second None)",
          "59:             # To customize the SKIPDATA callback, uncomment the line below.",
          "62:             for insn in md.disasm(code, 0x1000):",
          "63:                 #bytes = binascii.hexlify(insn.bytes)",
          "",
          "[Removed Lines]",
          "60:             # md.skipdata_setup = (\".db\", CS_SKIPDATA_CALLBACK(testcb), None)",
          "",
          "[Added Lines]",
          "60:             # md.skipdata_setup = (\".db\", testcb, None)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4c6d791ac8826c5c3dc1d842a2775b29e5721b78",
      "candidate_info": {
        "commit_hash": "4c6d791ac8826c5c3dc1d842a2775b29e5721b78",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/4c6d791ac8826c5c3dc1d842a2775b29e5721b78",
        "files": [
          "arch/Mips/MipsMappingInsn.inc"
        ],
        "message": "Annotate MIPS insructions JALR and SYSCALL\n\nAdd the appropriate MIPS_GRP_XXX groups to those instructions.",
        "before_after_code_files": [
          "arch/Mips/MipsMappingInsn.inc||arch/Mips/MipsMappingInsn.inc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/Mips/MipsMappingInsn.inc||arch/Mips/MipsMappingInsn.inc": [
          "File: arch/Mips/MipsMappingInsn.inc -> arch/Mips/MipsMappingInsn.inc",
          "--- Hunk 1 ---",
          "[Context before]",
          "4720: {",
          "4721:  Mips_JALR, MIPS_INS_JALR,",
          "4722: #ifndef CAPSTONE_DIET",
          "4724: #endif",
          "4725: },",
          "4726: {",
          "4727:  Mips_JALR16_MM, MIPS_INS_JALR,",
          "4728: #ifndef CAPSTONE_DIET",
          "4730: #endif",
          "4731: },",
          "4732: {",
          "4733:  Mips_JALR64, MIPS_INS_JALR,",
          "4734: #ifndef CAPSTONE_DIET",
          "4736: #endif",
          "4737: },",
          "4738: {",
          "4739:  Mips_JALRS16_MM, MIPS_INS_JALRS16,",
          "4740: #ifndef CAPSTONE_DIET",
          "4742: #endif",
          "4743: },",
          "4744: {",
          "4745:  Mips_JALRS_MM, MIPS_INS_JALRS,",
          "4746: #ifndef CAPSTONE_DIET",
          "4748: #endif",
          "4749: },",
          "4750: {",
          "4751:  Mips_JALR_HB, MIPS_INS_JALR_HB,",
          "4752: #ifndef CAPSTONE_DIET",
          "4754: #endif",
          "4755: },",
          "4756: {",
          "4757:  Mips_JALR_MM, MIPS_INS_JALR,",
          "4758: #ifndef CAPSTONE_DIET",
          "4760: #endif",
          "4761: },",
          "4762: {",
          "",
          "[Removed Lines]",
          "4723:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_STDENC, MIPS_GRP_NOTINMICROMIPS, 0 }, 0, 0",
          "4729:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MICROMIPS, 0 }, 0, 0",
          "4735:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_STDENC, 0 }, 0, 0",
          "4741:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MICROMIPS, 0 }, 0, 0",
          "4747:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MICROMIPS, 0 }, 0, 0",
          "4753:  { 0 }, { 0 }, { MIPS_GRP_STDENC, MIPS_GRP_MIPS32, 0 }, 0, 1",
          "4759:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MICROMIPS, 0 }, 0, 0",
          "",
          "[Added Lines]",
          "4723:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_STDENC, MIPS_GRP_NOTINMICROMIPS, MIPS_GRP_CALL, 0 }, 0, 0",
          "4729:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MICROMIPS, MIPS_GRP_CALL, 0 }, 0, 0",
          "4735:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_STDENC, MIPS_GRP_CALL, 0 }, 0, 0",
          "4741:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MICROMIPS, MIPS_GRP_CALL, 0 }, 0, 0",
          "4747:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MICROMIPS, MIPS_GRP_CALL, 0 }, 0, 0",
          "4753:  { 0 }, { 0 }, { MIPS_GRP_STDENC, MIPS_GRP_MIPS32, MIPS_GRP_CALL, 0 }, 0, 1",
          "4759:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MICROMIPS, MIPS_GRP_CALL, 0 }, 0, 0",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4876: {",
          "4877:  Mips_JumpLinkReg16, MIPS_INS_JALRC,",
          "4878: #ifndef CAPSTONE_DIET",
          "4880: #endif",
          "4881: },",
          "4882: {",
          "",
          "[Removed Lines]",
          "4879:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MIPS16MODE, 0 }, 0, 0",
          "",
          "[Added Lines]",
          "4879:  { 0 }, { MIPS_REG_RA, 0 }, { MIPS_GRP_MIPS16MODE, MIPS_GRP_CALL, 0 }, 0, 0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "8812: {",
          "8813:  Mips_SYSCALL, MIPS_INS_SYSCALL,",
          "8814: #ifndef CAPSTONE_DIET",
          "8816: #endif",
          "8817: },",
          "8818: {",
          "8819:  Mips_SYSCALL_MM, MIPS_INS_SYSCALL,",
          "8820: #ifndef CAPSTONE_DIET",
          "8822: #endif",
          "8823: },",
          "8824: {",
          "",
          "[Removed Lines]",
          "8815:  { 0 }, { 0 }, { MIPS_GRP_STDENC, 0 }, 0, 0",
          "8821:  { 0 }, { 0 }, { MIPS_GRP_MICROMIPS, 0 }, 0, 0",
          "",
          "[Added Lines]",
          "8815:  { 0 }, { 0 }, { MIPS_GRP_STDENC, MIPS_GRP_INT, 0 }, 0, 0",
          "8821:  { 0 }, { 0 }, { MIPS_GRP_MICROMIPS, MIPS_GRP_INT, 0 }, 0, 0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "69b163a00e284c0c461834d92c1520d732f6b76a",
      "candidate_info": {
        "commit_hash": "69b163a00e284c0c461834d92c1520d732f6b76a",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/69b163a00e284c0c461834d92c1520d732f6b76a",
        "files": [
          "msvc/capstone.sln",
          "msvc/cstool/cstool.vcxproj"
        ],
        "message": "Compile cstool on Windows using Microsoft Visual Studio (VS). (#927)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.\n\n* provide a validity check in malloc() function to prevent against integer overflow conditions\n\n* missing Ntintsafe.h\n\n* use tabs for indentation\n\n* add cstool project",
        "before_after_code_files": [
          "msvc/capstone.sln||msvc/capstone.sln",
          "msvc/cstool/cstool.vcxproj||msvc/cstool/cstool.vcxproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "msvc/capstone.sln||msvc/capstone.sln": [
          "File: msvc/capstone.sln -> msvc/capstone.sln",
          "--- Hunk 1 ---",
          "[Context before]",
          "72:   {FE197816-EF84-4E8D-B29D-E0A6BA2B144B} = {FE197816-EF84-4E8D-B29D-E0A6BA2B144B}",
          "73:  EndProjectSection",
          "74: EndProject",
          "75: Global",
          "76:  GlobalSection(SolutionConfigurationPlatforms) = preSolution",
          "77:   Debug|Win32 = Debug|Win32",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "75: Project(\"{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}\") = \"cstool\", \"cstool\\cstool.vcxproj\", \"{A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}\"",
          "76:  ProjectSection(ProjectDependencies) = postProject",
          "77:   {5B01D900-2359-44CA-9914-6B0C6AFB7BE7} = {5B01D900-2359-44CA-9914-6B0C6AFB7BE7}",
          "78:  EndProjectSection",
          "79: EndProject",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "200:   {C6E4974C-2CAF-499A-802A-FB906F86B4C8}.Debug|x64.ActiveCfg = Debug|x64",
          "201:   {C6E4974C-2CAF-499A-802A-FB906F86B4C8}.Release|Win32.ActiveCfg = Release|Win32",
          "202:   {C6E4974C-2CAF-499A-802A-FB906F86B4C8}.Release|x64.ActiveCfg = Release|x64",
          "203:  EndGlobalSection",
          "204:  GlobalSection(SolutionProperties) = preSolution",
          "205:   HideSolutionNode = FALSE",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "208:   {A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}.Debug|Win32.ActiveCfg = Debug|Win32",
          "209:   {A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}.Debug|Win32.Build.0 = Debug|Win32",
          "210:   {A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}.Debug|x64.ActiveCfg = Debug|x64",
          "211:   {A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}.Debug|x64.Build.0 = Debug|x64",
          "212:   {A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}.Release|Win32.ActiveCfg = Release|Win32",
          "213:   {A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}.Release|Win32.Build.0 = Release|Win32",
          "214:   {A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}.Release|x64.ActiveCfg = Release|x64",
          "215:   {A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}.Release|x64.Build.0 = Release|x64",
          "",
          "---------------"
        ],
        "msvc/cstool/cstool.vcxproj||msvc/cstool/cstool.vcxproj": [
          "File: msvc/cstool/cstool.vcxproj -> msvc/cstool/cstool.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "6:       <Platform>Win32</Platform>",
          "7:     </ProjectConfiguration>",
          "8:     <ProjectConfiguration Include=\"Release|Win32\">",
          "9:       <Configuration>Release</Configuration>",
          "10:       <Platform>Win32</Platform>",
          "11:     </ProjectConfiguration>",
          "12:     <ProjectConfiguration Include=\"Debug|x64\">",
          "13:       <Configuration>Debug</Configuration>",
          "14:       <Platform>x64</Platform>",
          "15:     </ProjectConfiguration>",
          "16:     <ProjectConfiguration Include=\"Release|x64\">",
          "17:       <Configuration>Release</Configuration>",
          "18:       <Platform>x64</Platform>",
          "19:     </ProjectConfiguration>",
          "20:   </ItemGroup>",
          "21:   <PropertyGroup Label=\"Globals\">",
          "22:     <ProjectGuid>{A5AB9988-6B03-4F0D-8D40-9440BBC8B03D}</ProjectGuid>",
          "23:     <Keyword>Win32Proj</Keyword>",
          "24:     <RootNamespace>cstool</RootNamespace>",
          "25:  <ProjectName>cstool</ProjectName>",
          "26:   </PropertyGroup>",
          "27:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "28:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "29:     <ConfigurationType>Application</ConfigurationType>",
          "30:     <UseDebugLibraries>true</UseDebugLibraries>",
          "31:     <CharacterSet>Unicode</CharacterSet>",
          "32:   </PropertyGroup>",
          "33:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "34:     <ConfigurationType>Application</ConfigurationType>",
          "35:     <UseDebugLibraries>false</UseDebugLibraries>",
          "36:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "37:     <CharacterSet>Unicode</CharacterSet>",
          "38:   </PropertyGroup>",
          "39:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "40:     <ConfigurationType>Application</ConfigurationType>",
          "41:     <UseDebugLibraries>true</UseDebugLibraries>",
          "42:     <CharacterSet>Unicode</CharacterSet>",
          "43:   </PropertyGroup>",
          "44:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "45:     <ConfigurationType>Application</ConfigurationType>",
          "46:     <UseDebugLibraries>false</UseDebugLibraries>",
          "47:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "48:     <CharacterSet>Unicode</CharacterSet>",
          "49:   </PropertyGroup>",
          "50:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "51:   <ImportGroup Label=\"ExtensionSettings\">",
          "52:   </ImportGroup>",
          "53:   <ImportGroup Label=\"Shared\">",
          "54:   </ImportGroup>",
          "55:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "56:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "57:   </ImportGroup>",
          "58:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "59:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "60:   </ImportGroup>",
          "61:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "62:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "63:   </ImportGroup>",
          "64:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "65:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "66:   </ImportGroup>",
          "67:   <PropertyGroup Label=\"UserMacros\" />",
          "68:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "69:     <LinkIncremental>true</LinkIncremental>",
          "70:     <IncludePath>..\\..\\include;$(IncludePath)</IncludePath>",
          "71:   </PropertyGroup>",
          "72:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "73:     <LinkIncremental>true</LinkIncremental>",
          "74:     <IncludePath>..\\..\\include;$(IncludePath)</IncludePath>",
          "75:   </PropertyGroup>",
          "76:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "77:     <LinkIncremental>false</LinkIncremental>",
          "78:     <IncludePath>..\\..\\include;$(IncludePath)</IncludePath>",
          "79:   </PropertyGroup>",
          "80:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "81:     <LinkIncremental>false</LinkIncremental>",
          "82:     <IncludePath>..\\..\\include;$(IncludePath)</IncludePath>",
          "83:   </PropertyGroup>",
          "84:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "85:     <ClCompile>",
          "86:       <PrecompiledHeader>",
          "87:       </PrecompiledHeader>",
          "88:       <WarningLevel>Level3</WarningLevel>",
          "89:       <Optimization>Disabled</Optimization>",
          "90:       <PreprocessorDefinitions>WIN32;_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "91:       <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>",
          "92:     </ClCompile>",
          "93:     <Link>",
          "94:       <SubSystem>Console</SubSystem>",
          "95:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "96:       <AdditionalLibraryDirectories>$(OutputPath);%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>",
          "97:       <AdditionalDependencies>capstone.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "98:     </Link>",
          "99:   </ItemDefinitionGroup>",
          "100:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "101:     <ClCompile>",
          "102:       <PrecompiledHeader>",
          "103:       </PrecompiledHeader>",
          "104:       <WarningLevel>Level3</WarningLevel>",
          "105:       <Optimization>Disabled</Optimization>",
          "106:       <PreprocessorDefinitions>_DEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "107:       <RuntimeLibrary>MultiThreadedDebug</RuntimeLibrary>",
          "108:     </ClCompile>",
          "109:     <Link>",
          "110:       <SubSystem>Console</SubSystem>",
          "111:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "112:       <AdditionalLibraryDirectories>$(OutputPath);%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>",
          "113:       <AdditionalDependencies>capstone.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "114:     </Link>",
          "115:   </ItemDefinitionGroup>",
          "116:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "117:     <ClCompile>",
          "118:       <WarningLevel>Level3</WarningLevel>",
          "119:       <PrecompiledHeader>",
          "120:       </PrecompiledHeader>",
          "121:       <Optimization>MaxSpeed</Optimization>",
          "122:       <FunctionLevelLinking>true</FunctionLevelLinking>",
          "123:       <IntrinsicFunctions>true</IntrinsicFunctions>",
          "124:       <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "125:       <RuntimeLibrary>MultiThreaded</RuntimeLibrary>",
          "126:     </ClCompile>",
          "127:     <Link>",
          "128:       <SubSystem>Console</SubSystem>",
          "129:       <EnableCOMDATFolding>true</EnableCOMDATFolding>",
          "130:       <OptimizeReferences>true</OptimizeReferences>",
          "131:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "132:       <AdditionalLibraryDirectories>$(OutputPath);%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>",
          "133:       <AdditionalDependencies>capstone.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "134:     </Link>",
          "135:   </ItemDefinitionGroup>",
          "136:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "137:     <ClCompile>",
          "138:       <WarningLevel>Level3</WarningLevel>",
          "139:       <PrecompiledHeader>",
          "140:       </PrecompiledHeader>",
          "141:       <Optimization>MaxSpeed</Optimization>",
          "142:       <FunctionLevelLinking>true</FunctionLevelLinking>",
          "143:       <IntrinsicFunctions>true</IntrinsicFunctions>",
          "144:       <PreprocessorDefinitions>NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "145:       <RuntimeLibrary>MultiThreaded</RuntimeLibrary>",
          "146:     </ClCompile>",
          "147:     <Link>",
          "148:       <SubSystem>Console</SubSystem>",
          "149:       <EnableCOMDATFolding>true</EnableCOMDATFolding>",
          "150:       <OptimizeReferences>true</OptimizeReferences>",
          "151:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "152:       <AdditionalLibraryDirectories>$(OutputPath);%(AdditionalLibraryDirectories)</AdditionalLibraryDirectories>",
          "153:       <AdditionalDependencies>capstone.lib;%(AdditionalDependencies)</AdditionalDependencies>",
          "154:     </Link>",
          "155:   </ItemDefinitionGroup>",
          "156:   <ItemGroup>",
          "157:     <ClCompile Include=\"..\\..\\cstool\\cstool.c\" />",
          "158:     <ClCompile Include=\"..\\..\\cstool\\cstool_arm.c\" />",
          "159:     <ClCompile Include=\"..\\..\\cstool\\cstool_arm64.c\" />",
          "160:     <ClCompile Include=\"..\\..\\cstool\\cstool_mips.c\" />",
          "161:     <ClCompile Include=\"..\\..\\cstool\\cstool_ppc.c\" />",
          "162:     <ClCompile Include=\"..\\..\\cstool\\cstool_sparc.c\" />",
          "163:     <ClCompile Include=\"..\\..\\cstool\\cstool_systemz.c\" />",
          "164:     <ClCompile Include=\"..\\..\\cstool\\cstool_x86.c\" />",
          "165:     <ClCompile Include=\"..\\..\\cstool\\cstool_xcore.c\" />",
          "166:   </ItemGroup>",
          "167:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.targets\" />",
          "168:   <ImportGroup Label=\"ExtensionTargets\">",
          "169:   </ImportGroup>",
          "170: </Project>",
          "",
          "---------------"
        ]
      }
    }
  ]
}