{
  "cve_id": "CVE-2017-3730",
  "cve_desc": "In OpenSSL 1.1.0 before 1.1.0d, if a malicious server supplies bad parameters for a DHE or ECDHE key exchange then this can result in the client attempting to dereference a NULL pointer leading to a client crash. This could be exploited in a Denial of Service attack.",
  "repo": "openssl/openssl",
  "patch_hash": "efbe126e3ebb9123ac9d058aa2bb044261342aaa",
  "patch_info": {
    "commit_hash": "efbe126e3ebb9123ac9d058aa2bb044261342aaa",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/efbe126e3ebb9123ac9d058aa2bb044261342aaa",
    "files": [
      "ssl/statem/statem_clnt.c"
    ],
    "message": "Fix missing NULL checks in CKE processing\n\nReviewed-by: Rich Salz <rsalz@openssl.org>",
    "before_after_code_files": [
      "ssl/statem/statem_clnt.c||ssl/statem/statem_clnt.c"
    ]
  },
  "patch_diff": {
    "ssl/statem/statem_clnt.c||ssl/statem/statem_clnt.c": [
      "File: ssl/statem/statem_clnt.c -> ssl/statem/statem_clnt.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2258:         return 0;",
      "2259:     }",
      "2260:     ckey = ssl_generate_pkey(skey);",
      "2261:     dh_clnt = EVP_PKEY_get0_DH(ckey);",
      "2263:     if (dh_clnt == NULL || ssl_derive(s, ckey, skey) == 0) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2261:     if (ckey == NULL) {",
      "2262:         SSLerr(SSL_F_TLS_CONSTRUCT_CKE_DHE, ERR_R_INTERNAL_ERROR);",
      "2263:         return 0;",
      "2264:     }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2296:     }",
      "2298:     ckey = ssl_generate_pkey(skey);",
      "2300:     if (ssl_derive(s, ckey, skey) == 0) {",
      "2301:         SSLerr(SSL_F_TLS_CONSTRUCT_CKE_ECDHE, ERR_R_EVP_LIB);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2304:     if (ckey == NULL) {",
      "2305:         SSLerr(SSL_F_TLS_CONSTRUCT_CKE_ECDHE, ERR_R_INTERNAL_ERROR);",
      "2306:         goto err;",
      "2307:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "88bf0d36048569e0dd5e6193c4ec21d2a9da5aba",
      "candidate_info": {
        "commit_hash": "88bf0d36048569e0dd5e6193c4ec21d2a9da5aba",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/88bf0d36048569e0dd5e6193c4ec21d2a9da5aba",
        "files": [
          "crypto/mem_sec.c"
        ],
        "message": "Ensure minsize >= sizeof(SH_LIST)\n\nThe sh_add_to_list function will overwrite subsequent slots in the free list\nfor small allocations.  This causes a segmentation fault if the writes goes\noff the end of the secure memory.  I've not investigated if this problem\ncan overwrite memory without the segmentation fault, but it seems likely.\n\nThis fix limits the minsize to the sizeof of the SH_LIST structure (which\nalso has a side effect of properly aligning the pointers).\n\nThe alternative would be to return an error if minsize is too small.\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/2657)\n\n(cherry picked from commit 70e14ffbaf6a67dab56c24cae01f1248cf3f1e77)",
        "before_after_code_files": [
          "crypto/mem_sec.c||crypto/mem_sec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/mem_sec.c||crypto/mem_sec.c": [
          "File: crypto/mem_sec.c -> crypto/mem_sec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "352:     if (minsize <= 0 || (minsize & (minsize - 1)) != 0)",
          "353:         goto err;",
          "355:     sh.arena_size = size;",
          "356:     sh.minsize = minsize;",
          "357:     sh.bittable_size = (sh.arena_size / sh.minsize) * 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "355:     while (minsize < (int)sizeof(SH_LIST))",
          "356:         minsize *= 2;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c1f138c194d7d7dddb74c3a41215e8de638d7a26",
      "candidate_info": {
        "commit_hash": "c1f138c194d7d7dddb74c3a41215e8de638d7a26",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/c1f138c194d7d7dddb74c3a41215e8de638d7a26",
        "files": [
          "ssl/statem/statem_clnt.c"
        ],
        "message": "Only call memcpy when the length is larger than 0.\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\nGH: #2050\n(cherry picked from commit a19fc66a6b5f99ad00305e152bdb41460d728640)",
        "before_after_code_files": [
          "ssl/statem/statem_clnt.c||ssl/statem/statem_clnt.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [
            "ssl/statem/statem_clnt.c||ssl/statem/statem_clnt.c"
          ],
          "candidate": [
            "ssl/statem/statem_clnt.c||ssl/statem/statem_clnt.c"
          ]
        }
      },
      "candidate_diff": {
        "ssl/statem/statem_clnt.c||ssl/statem/statem_clnt.c": [
          "File: ssl/statem/statem_clnt.c -> ssl/statem/statem_clnt.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1022:         s->session->ssl_version = s->version;",
          "1023:         s->session->session_id_length = session_id_len;",
          "1027:     }",
          "",
          "[Removed Lines]",
          "1025:         memcpy(s->session->session_id, PACKET_data(&session_id),",
          "1026:                session_id_len);",
          "",
          "[Added Lines]",
          "1025:         if (session_id_len > 0)",
          "1026:             memcpy(s->session->session_id, PACKET_data(&session_id),",
          "1027:                    session_id_len);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "90edd7ad0fb0d8b1eb5bb6d587a6359f17a39230",
      "candidate_info": {
        "commit_hash": "90edd7ad0fb0d8b1eb5bb6d587a6359f17a39230",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/90edd7ad0fb0d8b1eb5bb6d587a6359f17a39230",
        "files": [
          "apps/cms.c",
          "apps/crl.c",
          "apps/gendsa.c",
          "apps/ocsp.c",
          "apps/pkcs7.c",
          "apps/pkcs8.c",
          "apps/smime.c",
          "apps/spkac.c",
          "apps/ts.c",
          "apps/x509.c"
        ],
        "message": "Fix various missing option help messages ...\n\nReviewed-by: Andy Polyakov <appro@openssl.org>\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/1585)\n(cherry picked from commit 12d56b2992ebd61e1b30c99ca1898dde42345cf7)",
        "before_after_code_files": [
          "apps/cms.c||apps/cms.c",
          "apps/crl.c||apps/crl.c",
          "apps/gendsa.c||apps/gendsa.c",
          "apps/ocsp.c||apps/ocsp.c",
          "apps/pkcs7.c||apps/pkcs7.c",
          "apps/pkcs8.c||apps/pkcs8.c",
          "apps/smime.c||apps/smime.c",
          "apps/spkac.c||apps/spkac.c",
          "apps/ts.c||apps/ts.c",
          "apps/x509.c||apps/x509.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "apps/cms.c||apps/cms.c": [
          "File: apps/cms.c -> apps/cms.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "99:     {\"decrypt\", OPT_DECRYPT, '-', \"Decrypt encrypted message\"},",
          "100:     {\"sign\", OPT_SIGN, '-', \"Sign message\"},",
          "101:     {\"sign_receipt\", OPT_SIGN_RECEIPT, '-', \"Generate a signed receipt for the message\"},",
          "103:     {\"verify\", OPT_VERIFY, '-', \"Verify signed message\"},",
          "104:     {\"verify_retcode\", OPT_VERIFY_RETCODE, '-'},",
          "105:     {\"verify_receipt\", OPT_VERIFY_RECEIPT, '<'},",
          "",
          "[Removed Lines]",
          "102:     {\"resign\", OPT_RESIGN, '-'},",
          "",
          "[Added Lines]",
          "102:     {\"resign\", OPT_RESIGN, '-', \"Resign a signed message\"},",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "122:      \"Don't include signers certificate when signing\"},",
          "123:     {\"noattr\", OPT_NOATTR, '-', \"Don't include any signed attributes\"},",
          "124:     {\"nodetach\", OPT_NODETACH, '-', \"Use opaque signing\"},",
          "126:     {\"binary\", OPT_BINARY, '-', \"Don't translate message to text\"},",
          "127:     {\"keyid\", OPT_KEYID, '-', \"Use subject key identifier\"},",
          "128:     {\"nosigs\", OPT_NOSIGS, '-', \"Don't verify message signature\"},",
          "129:     {\"no_content_verify\", OPT_NO_CONTENT_VERIFY, '-'},",
          "130:     {\"no_attr_verify\", OPT_NO_ATTR_VERIFY, '-'},",
          "134:     {\"nooldmime\", OPT_NOOLDMIME, '-'},",
          "136:     {\"noout\", OPT_NOOUT, '-', \"For the -cmsout operation do not output the parsed CMS structure\"},",
          "138:     {\"receipt_request_all\", OPT_RR_ALL, '-'},",
          "139:     {\"receipt_request_first\", OPT_RR_FIRST, '-'},",
          "141:     {\"certfile\", OPT_CERTFILE, '<', \"Other certificates file\"},",
          "142:     {\"CAfile\", OPT_CAFILE, '<', \"Trusted certificates file\"},",
          "143:     {\"CApath\", OPT_CAPATH, '/', \"trusted certificates directory\"},",
          "",
          "[Removed Lines]",
          "125:     {\"nosmimecap\", OPT_NOSMIMECAP, '-'},",
          "131:     {\"stream\", OPT_INDEF, '-'},",
          "132:     {\"indef\", OPT_INDEF, '-'},",
          "133:     {\"noindef\", OPT_NOINDEF, '-'},",
          "135:     {\"crlfeol\", OPT_CRLFEOL, '-'},",
          "137:     {\"receipt_request_print\", OPT_RR_PRINT, '-'},",
          "140:     {\"rctform\", OPT_RCTFORM, 'F'},",
          "",
          "[Added Lines]",
          "125:     {\"nosmimecap\", OPT_NOSMIMECAP, '-', \"Omit the SMIMECapabilities attribute\"},",
          "131:     {\"stream\", OPT_INDEF, '-', \"Enable CMS streaming\"},",
          "132:     {\"indef\", OPT_INDEF, '-', \"Same as -stream\"},",
          "133:     {\"noindef\", OPT_NOINDEF, '-', \"Disable CMS streaming\"},",
          "135:     {\"crlfeol\", OPT_CRLFEOL, '-', \"Use CRLF as EOL termination instead of CR only\" },",
          "137:     {\"receipt_request_print\", OPT_RR_PRINT, '-', \"Print CMS Receipt Request\" },",
          "140:     {\"rctform\", OPT_RCTFORM, 'F', \"Receipt file format\"},",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "147:      \"Do not load certificates from the default certificates directory\"},",
          "148:     {\"content\", OPT_CONTENT, '<',",
          "149:      \"Supply or override content for detached signature\"},",
          "151:     {\"secretkey\", OPT_SECRETKEY, 's'},",
          "152:     {\"secretkeyid\", OPT_SECRETKEYID, 's'},",
          "153:     {\"pwri_password\", OPT_PWRI_PASSWORD, 's'},",
          "",
          "[Removed Lines]",
          "150:     {\"print\", OPT_PRINT, '-', \"For the -cmsout operation print out all fields of the CMS structure\"},",
          "",
          "[Added Lines]",
          "150:     {\"print\", OPT_PRINT, '-',",
          "151:      \"For the -cmsout operation print out all fields of the CMS structure\"},",
          "",
          "---------------"
        ],
        "apps/crl.c||apps/crl.c": [
          "File: apps/crl.c -> apps/crl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "41:     {\"fingerprint\", OPT_FINGERPRINT, '-', \"Print the crl fingerprint\"},",
          "42:     {\"crlnumber\", OPT_CRLNUMBER, '-', \"Print CRL number\"},",
          "43:     {\"badsig\", OPT_BADSIG, '-', \"Corrupt last byte of loaded CRL signature (for test)\" },",
          "45:     {\"CApath\", OPT_CAPATH, '/', \"Verify CRL using certificates in dir\"},",
          "46:     {\"CAfile\", OPT_CAFILE, '<', \"Verify CRL using certificates in file name\"},",
          "47:     {\"no-CAfile\", OPT_NOCAFILE, '-',",
          "",
          "[Removed Lines]",
          "44:     {\"gendelta\", OPT_GENDELTA, '<'},",
          "",
          "[Added Lines]",
          "44:     {\"gendelta\", OPT_GENDELTA, '<', \"Other CRL to compare/diff to the Input one\"},",
          "",
          "---------------"
        ],
        "apps/gendsa.c||apps/gendsa.c": [
          "File: apps/gendsa.c -> apps/gendsa.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "34:     {OPT_HELP_STR, 1, '-', \"Valid options are:\\n\"},",
          "35:     {\"help\", OPT_HELP, '-', \"Display this summary\"},",
          "36:     {\"out\", OPT_OUT, '>', \"Output the key to the specified file\"},",
          "38:     {\"rand\", OPT_RAND, 's',",
          "39:      \"Load the file(s) into the random number generator\"},",
          "40:     {\"\", OPT_CIPHER, '-', \"Encrypt the output with any supported cipher\"},",
          "",
          "[Removed Lines]",
          "37:     {\"passout\", OPT_PASSOUT, 's'},",
          "",
          "[Added Lines]",
          "37:     {\"passout\", OPT_PASSOUT, 's', \"Output file pass phrase source\"},",
          "",
          "---------------"
        ],
        "apps/ocsp.c||apps/ocsp.c": [
          "File: apps/ocsp.c -> apps/ocsp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "107:     {\"url\", OPT_URL, 's', \"Responder URL\"},",
          "108:     {\"host\", OPT_HOST, 's', \"TCP/IP hostname:port to connect to\"},",
          "109:     {\"port\", OPT_PORT, 'p', \"Port to run responder on\"},",
          "111:     {\"noverify\", OPT_NOVERIFY, '-', \"Don't verify response at all\"},",
          "112:     {\"nonce\", OPT_NONCE, '-', \"Add OCSP nonce to request\"},",
          "113:     {\"no_nonce\", OPT_NO_NONCE, '-', \"Don't add OCSP nonce to request\"},",
          "",
          "[Removed Lines]",
          "110:     {\"ignore_err\", OPT_IGNORE_ERR, '-'},",
          "",
          "[Added Lines]",
          "110:     {\"ignore_err\", OPT_IGNORE_ERR, '-',",
          "111:      \"Ignore Error response from OCSP responder, and retry \"},",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "124:     {\"no_chain\", OPT_NO_CHAIN, '-', \"Don't chain verify response\"},",
          "125:     {\"no_cert_checks\", OPT_NO_CERT_CHECKS, '-',",
          "126:      \"Don't do additional checks on signing certificate\"},",
          "128:     {\"trust_other\", OPT_TRUST_OTHER, '-',",
          "129:      \"Don't verify additional certificates\"},",
          "130:     {\"no_intern\", OPT_NO_INTERN, '-',",
          "",
          "[Removed Lines]",
          "127:     {\"no_explicit\", OPT_NO_EXPLICIT, '-'},",
          "",
          "[Added Lines]",
          "128:     {\"no_explicit\", OPT_NO_EXPLICIT, '-',",
          "129:      \"Do not explicitly check the chain, just verify the root\"},",
          "",
          "---------------"
        ],
        "apps/pkcs7.c||apps/pkcs7.c": [
          "File: apps/pkcs7.c -> apps/pkcs7.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "33:     {\"out\", OPT_OUT, '>', \"Output file\"},",
          "34:     {\"noout\", OPT_NOOUT, '-', \"Don't output encoded data\"},",
          "35:     {\"text\", OPT_TEXT, '-', \"Print full details of certificates\"},",
          "37:     {\"print_certs\", OPT_PRINT_CERTS, '-',",
          "38:      \"Print_certs  print any certs or crl in the input\"},",
          "39: #ifndef OPENSSL_NO_ENGINE",
          "",
          "[Removed Lines]",
          "36:     {\"print\", OPT_PRINT, '-'},",
          "",
          "[Added Lines]",
          "36:     {\"print\", OPT_PRINT, '-', \"Print out all fields of the PKCS7 structure\"},",
          "",
          "---------------"
        ],
        "apps/pkcs8.c||apps/pkcs8.c": [
          "File: apps/pkcs8.c -> apps/pkcs8.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "38:     {\"nocrypt\", OPT_NOCRYPT, '-', \"Use or expect unencrypted private key\"},",
          "39:     {\"v2\", OPT_V2, 's', \"Use PKCS#5 v2.0 and cipher\"},",
          "40:     {\"v1\", OPT_V1, 's', \"Use PKCS#5 v1.5 and cipher\"},",
          "42:     {\"iter\", OPT_ITER, 'p', \"Specify the iteration count\"},",
          "43:     {\"passin\", OPT_PASSIN, 's', \"Input file pass phrase source\"},",
          "44:     {\"passout\", OPT_PASSOUT, 's', \"Output file pass phrase source\"},",
          "",
          "[Removed Lines]",
          "41:     {\"v2prf\", OPT_V2PRF, 's'},",
          "",
          "[Added Lines]",
          "41:     {\"v2prf\", OPT_V2PRF, 's', \"Set the PRF algorithm to use with PKCS#5 v2.0\"},",
          "",
          "---------------"
        ],
        "apps/smime.c||apps/smime.c": [
          "File: apps/smime.c -> apps/smime.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "88:      \"Do not load the default certificates file\"},",
          "89:     {\"no-CApath\", OPT_NOCAPATH, '-',",
          "90:      \"Do not load certificates from the default certificates directory\"},",
          "99:     {\"rand\", OPT_RAND, 's',",
          "100:      \"Load the file(s) into the random number generator\"},",
          "101:     {\"passin\", OPT_PASSIN, 's', \"Input file pass phrase source\"},",
          "",
          "[Removed Lines]",
          "91:     {\"resign\", OPT_RESIGN, '-'},",
          "92:     {\"nochain\", OPT_NOCHAIN, '-'},",
          "93:     {\"nosmimecap\", OPT_NOSMIMECAP, '-'},",
          "94:     {\"stream\", OPT_STREAM, '-'},",
          "95:     {\"indef\", OPT_INDEF, '-'},",
          "96:     {\"noindef\", OPT_NOINDEF, '-'},",
          "97:     {\"nooldmime\", OPT_NOOLDMIME, '-'},",
          "98:     {\"crlfeol\", OPT_CRLFEOL, '-'},",
          "",
          "[Added Lines]",
          "91:     {\"resign\", OPT_RESIGN, '-', \"Resign a signed message\"},",
          "92:     {\"nochain\", OPT_NOCHAIN, '-',",
          "93:      \"set PKCS7_NOCHAIN so certificates contained in the message are not used as untrusted CAs\" },",
          "94:     {\"nosmimecap\", OPT_NOSMIMECAP, '-', \"Omit the SMIMECapabilities attribute\"},",
          "95:     {\"stream\", OPT_STREAM, '-', \"Enable CMS streaming\" },",
          "96:     {\"indef\", OPT_INDEF, '-', \"Same as -stream\" },",
          "97:     {\"noindef\", OPT_NOINDEF, '-', \"Disable CMS streaming\"},",
          "98:     {\"nooldmime\", OPT_NOOLDMIME, '-', NULL},",
          "99:     {\"crlfeol\", OPT_CRLFEOL, '-', \"Use CRLF as EOL termination instead of CR only\"},",
          "",
          "---------------"
        ],
        "apps/spkac.c||apps/spkac.c": [
          "File: apps/spkac.c -> apps/spkac.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "38:     {\"noout\", OPT_NOOUT, '-', \"Don't print SPKAC\"},",
          "39:     {\"pubkey\", OPT_PUBKEY, '-', \"Output public key\"},",
          "40:     {\"verify\", OPT_VERIFY, '-', \"Verify SPKAC signature\"},",
          "42: #ifndef OPENSSL_NO_ENGINE",
          "43:     {\"engine\", OPT_ENGINE, 's', \"Use engine, possibly a hardware device\"},",
          "44: #endif",
          "",
          "[Removed Lines]",
          "41:     {\"spksect\", OPT_SPKSECT, 's'},",
          "",
          "[Added Lines]",
          "41:     {\"spksect\", OPT_SPKSECT, 's',",
          "42:      \"Specify the name of an SPKAC-dedicated section of configuration\"},",
          "",
          "---------------"
        ],
        "apps/ts.c||apps/ts.c": [
          "File: apps/ts.c -> apps/ts.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "107:     {\"queryfile\", OPT_QUERYFILE, '<', \"File containing a TS query\"},",
          "108:     {\"passin\", OPT_PASSIN, 's', \"Input file pass phrase source\"},",
          "109:     {\"inkey\", OPT_INKEY, '<', \"File with private key for reply\"},",
          "111:     {\"chain\", OPT_CHAIN, '<', \"File with signer CA chain\"},",
          "112:     {\"verify\", OPT_VERIFY, '-', \"Verify a TS response\"},",
          "113:     {\"CApath\", OPT_CAPATH, '/', \"Path to trusted CA files\"},",
          "",
          "[Removed Lines]",
          "110:     {\"signer\", OPT_SIGNER, 's'},",
          "",
          "[Added Lines]",
          "110:     {\"signer\", OPT_SIGNER, 's', \"Signer certificate file\"},",
          "",
          "---------------"
        ],
        "apps/x509.c||apps/x509.c": [
          "File: apps/x509.c -> apps/x509.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "92:     {\"ocsp_uri\", OPT_OCSP_URI, '-', \"Print OCSP Responder URL(s)\"},",
          "93:     {\"trustout\", OPT_TRUSTOUT, '-', \"Output a trusted certificate\"},",
          "94:     {\"clrtrust\", OPT_CLRTRUST, '-', \"Clear all trusted purposes\"},",
          "96:     {\"addtrust\", OPT_ADDTRUST, 's', \"Trust certificate for a given purpose\"},",
          "97:     {\"addreject\", OPT_ADDREJECT, 's',",
          "98:      \"Reject certificate for a given purpose\"},",
          "",
          "[Removed Lines]",
          "95:     {\"clrext\", OPT_CLREXT, '-', \"Clear all rejected purposes\"},",
          "",
          "[Added Lines]",
          "95:     {\"clrext\", OPT_CLREXT, '-', \"Clear all certificate extensions\"},",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "125:     {\"CAform\", OPT_CAFORM, 'F', \"CA format - default PEM\"},",
          "126:     {\"CAkeyform\", OPT_CAKEYFORM, 'F', \"CA key format - default PEM\"},",
          "127:     {\"sigopt\", OPT_SIGOPT, 's', \"Signature parameter in n:v form\"},",
          "131:     {\"badsig\", OPT_BADSIG, '-', \"Corrupt last byte of certificate signature (for test)\"},",
          "132:     {\"\", OPT_MD, '-', \"Any supported digest\"},",
          "133: #ifndef OPENSSL_NO_MD5",
          "",
          "[Removed Lines]",
          "128:     {\"force_pubkey\", OPT_FORCE_PUBKEY, '<'},",
          "129:     {\"next_serial\", OPT_NEXT_SERIAL, '-'},",
          "130:     {\"clrreject\", OPT_CLRREJECT, '-'},",
          "",
          "[Added Lines]",
          "128:     {\"force_pubkey\", OPT_FORCE_PUBKEY, '<', \"Force the Key to put inside certificate\"},",
          "129:     {\"next_serial\", OPT_NEXT_SERIAL, '-', \"Increment current certificate serial number\"},",
          "130:     {\"clrreject\", OPT_CLRREJECT, '-',",
          "131:      \"Clears all the prohibited or rejected uses of the certificate\"},",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "626:                 i2a_ASN1_INTEGER(out, X509_get_serialNumber(x));",
          "627:                 BIO_printf(out, \"\\n\");",
          "628:             } else if (next_serial == i) {",
          "633:                 if (!bnser)",
          "634:                     goto end;",
          "635:                 if (!BN_add_word(bnser, 1))",
          "",
          "[Removed Lines]",
          "629:                 BIGNUM *bnser;",
          "630:                 ASN1_INTEGER *ser;",
          "631:                 ser = X509_get_serialNumber(x);",
          "632:                 bnser = ASN1_INTEGER_to_BN(ser, NULL);",
          "",
          "[Added Lines]",
          "630:                 ASN1_INTEGER *ser = X509_get_serialNumber(x);",
          "631:                 BIGNUM *bnser = ASN1_INTEGER_to_BN(ser, NULL);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "294f7a746e9928ce4ba509e0e8fa181f18e24efd",
      "candidate_info": {
        "commit_hash": "294f7a746e9928ce4ba509e0e8fa181f18e24efd",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/294f7a746e9928ce4ba509e0e8fa181f18e24efd",
        "files": [
          "Configurations/10-main.conf"
        ],
        "message": "VMS: pretend to use -znodelete\n\nVMS only unloads shared libraries at process rundown, so tell the\nOpenSSL code so by pretending we linked with -znodelete.\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/1862)\n(cherry picked from commit 1186a2b3d40e33cbf42d4fd3c7cc679f9f6e14f2)",
        "before_after_code_files": [
          "Configurations/10-main.conf||Configurations/10-main.conf"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Configurations/10-main.conf||Configurations/10-main.conf": [
          "File: Configurations/10-main.conf -> Configurations/10-main.conf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1748:         cflags           => picker(default => \"/STANDARD=(ISOC94,RELAXED)/NOLIST/PREFIX=ALL\",",
          "1749:                                    debug   => \"/NOOPTIMIZE/DEBUG\",",
          "1750:                                    release => \"/OPTIMIZE/NODEBUG\"),",
          "1751:         lflags           => picker(default => \"/MAP\",",
          "1752:                                    debug   => \"/DEBUG/TRACEBACK\",",
          "1753:                                    release => \"/NODEBUG/NOTRACEBACK\"),",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1751:         defines          => add(\"OPENSSL_USE_NODELETE\"),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6db2b1490e5da1255f4158dc8c2d4a2dd87cbe7b",
      "candidate_info": {
        "commit_hash": "6db2b1490e5da1255f4158dc8c2d4a2dd87cbe7b",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/6db2b1490e5da1255f4158dc8c2d4a2dd87cbe7b",
        "files": [
          "apps/rehash.c"
        ],
        "message": "Check for the presence of _WIN32 rather than its value.\n\nReviewed-by: Andy Polyakov <appro@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/2727)\n(cherry picked from commit 46958a043d51633ed36bcfb13ff048a3381366a6)",
        "before_after_code_files": [
          "apps/rehash.c||apps/rehash.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "apps/rehash.c||apps/rehash.c": [
          "File: apps/rehash.c -> apps/rehash.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "287: {",
          "288:     if (*path != '\\0')",
          "289:         path += strlen(path) - 1;",
          "291:     if (*path == ']' || *path == '>' || *path == ':')",
          "292:         return 1;",
          "294:     if (*path == '\\\\')",
          "295:         return 1;",
          "296: # endif",
          "",
          "[Removed Lines]",
          "290: # ifdef __VMS",
          "293: # elif _WIN32",
          "",
          "[Added Lines]",
          "290: # if defined __VMS",
          "293: # elif defined _WIN32",
          "",
          "---------------"
        ]
      }
    }
  ]
}