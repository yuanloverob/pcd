{
  "cve_id": "CVE-2017-8073",
  "cve_desc": "WeeChat before 1.7.1 allows a remote crash by sending a filename via DCC to the IRC plugin. This occurs in the irc_ctcp_dcc_filename_without_quotes function during quote removal, with a buffer overflow.",
  "repo": "weechat/weechat",
  "patch_hash": "2fb346f25f79e412cf0ed314fdf791763c19b70b",
  "patch_info": {
    "commit_hash": "2fb346f25f79e412cf0ed314fdf791763c19b70b",
    "repo": "weechat/weechat",
    "commit_url": "https://github.com/weechat/weechat/commit/2fb346f25f79e412cf0ed314fdf791763c19b70b",
    "files": [
      "src/plugins/irc/irc-ctcp.c"
    ],
    "message": "irc: fix parsing of DCC filename",
    "before_after_code_files": [
      "src/plugins/irc/irc-ctcp.c||src/plugins/irc/irc-ctcp.c"
    ]
  },
  "patch_diff": {
    "src/plugins/irc/irc-ctcp.c||src/plugins/irc/irc-ctcp.c": [
      "File: src/plugins/irc/irc-ctcp.c -> src/plugins/irc/irc-ctcp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "512:     int length;",
      "514:     length = strlen (filename);",
      "516:     {",
      "517:         if ((filename[0] == '\\\"') && (filename[length - 1] == '\\\"'))",
      "518:             return weechat_strndup (filename + 1, length - 2);",
      "",
      "[Removed Lines]",
      "515:     if (length > 0)",
      "",
      "[Added Lines]",
      "515:     if (length > 1)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c6c9566fbb66a71fe38b59cbf4d036c0160429af",
      "candidate_info": {
        "commit_hash": "c6c9566fbb66a71fe38b59cbf4d036c0160429af",
        "repo": "weechat/weechat",
        "commit_url": "https://github.com/weechat/weechat/commit/c6c9566fbb66a71fe38b59cbf4d036c0160429af",
        "files": [
          "src/plugins/irc/irc-ctcp.c"
        ],
        "message": "irc: fix parsing of DCC filename\n\n(cherry picked from commit 2fb346f25f79e412cf0ed314fdf791763c19b70b)",
        "before_after_code_files": [
          "src/plugins/irc/irc-ctcp.c||src/plugins/irc/irc-ctcp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/plugins/irc/irc-ctcp.c||src/plugins/irc/irc-ctcp.c"
          ],
          "candidate": [
            "src/plugins/irc/irc-ctcp.c||src/plugins/irc/irc-ctcp.c"
          ]
        }
      },
      "candidate_diff": {
        "src/plugins/irc/irc-ctcp.c||src/plugins/irc/irc-ctcp.c": [
          "File: src/plugins/irc/irc-ctcp.c -> src/plugins/irc/irc-ctcp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "512:     int length;",
          "514:     length = strlen (filename);",
          "516:     {",
          "517:         if ((filename[0] == '\\\"') && (filename[length - 1] == '\\\"'))",
          "518:             return weechat_strndup (filename + 1, length - 2);",
          "",
          "[Removed Lines]",
          "515:     if (length > 0)",
          "",
          "[Added Lines]",
          "515:     if (length > 1)",
          "",
          "---------------"
        ]
      }
    }
  ]
}