{
  "cve_id": "CVE-2015-8730",
  "cve_desc": "epan/dissectors/packet-nbap.c in the NBAP dissector in Wireshark 1.12.x before 1.12.9 and 2.0.x before 2.0.1 does not validate the number of items, which allows remote attackers to cause a denial of service (invalid read operation and application crash) via a crafted packet.",
  "repo": "wireshark/wireshark",
  "patch_hash": "d2644aef369af0667220b5bd69996915b29d753d",
  "patch_info": {
    "commit_hash": "d2644aef369af0667220b5bd69996915b29d753d",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/d2644aef369af0667220b5bd69996915b29d753d",
    "files": [
      "asn1/nbap/nbap.cnf",
      "epan/dissectors/packet-nbap.c"
    ],
    "message": "[NBAP] Fix SIGSEGV in dissect_nbap_MACdPDU_Size\n\nBug: 11815\nChange-Id: I107cf90df87bdafa23bd4b81acbc25d98773b223\nReviewed-on: https://code.wireshark.org/review/12347\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nReviewed-by: Anders Broman <a.broman58@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
    "before_after_code_files": [
      "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
      "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
    ]
  },
  "patch_diff": {
    "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
      "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
      "--- Hunk 1 ---",
      "[Context before]",
      "1609:     {",
      "1610:         return offset;",
      "1611:     }",
      "1614: #.FN_BODY MACdPDU-Size VAL_PTR = &MACdPDU_Size",
      "1615: %(DEFAULT_BODY)s",
      "",
      "[Removed Lines]",
      "1612:     nbap_edch_channel_info[e_dch_macdflow_id].edch_ddi[num_items-1] = e_dch_ddi_value;",
      "",
      "[Added Lines]",
      "1612:     if(num_items>0)",
      "1613:         nbap_edch_channel_info[e_dch_macdflow_id].edch_ddi[num_items-1] = e_dch_ddi_value;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1618:     {",
      "1619:         return offset;",
      "1620:     }",
      "1623: #.FN_BODY LogicalChannelID VAL_PTR = &logical_channel_id",
      "1625: %(DEFAULT_BODY)s",
      "1631: #.FN_BODY RLC-Mode VAL_PTR = &rlc_mode",
      "1632:     guint32 rlc_mode;",
      "",
      "[Removed Lines]",
      "1621:     nbap_edch_channel_info[e_dch_macdflow_id].edch_macd_pdu_size[num_items-1] = MACdPDU_Size;",
      "1628:     nbap_edch_channel_info[e_dch_macdflow_id].lchId[num_items-1] = logical_channel_id;",
      "",
      "[Added Lines]",
      "1622:     if(num_items>0)",
      "1623:         nbap_edch_channel_info[e_dch_macdflow_id].edch_macd_pdu_size[num_items-1] = MACdPDU_Size;",
      "1629:     if(num_items>0)",
      "1630:         nbap_edch_channel_info[e_dch_macdflow_id].lchId[num_items-1] = logical_channel_id;",
      "",
      "---------------"
    ],
    "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
      "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "10028: static int",
      "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "10032:                                                             0U, 255U, &cfn, FALSE);",
      "",
      "[Removed Lines]",
      "10030: #line 2147 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "10030: #line 2148 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "10281: static int",
      "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
      "10285: address     null_addr;",
      "10286: conversation_t   *conversation = NULL;",
      "",
      "[Removed Lines]",
      "10283: #line 2112 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "10283: #line 2113 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "11503: static int",
      "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
      "",
      "[Removed Lines]",
      "11505: #line 1971 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "11505: #line 1972 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "11637: static int",
      "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
      "",
      "[Removed Lines]",
      "11639: #line 1624 \"../../asn1/nbap/nbap.cnf\"",
      "11646:     nbap_edch_channel_info[e_dch_macdflow_id].lchId[num_items-1] = logical_channel_id;",
      "",
      "[Added Lines]",
      "11639: #line 1626 \"../../asn1/nbap/nbap.cnf\"",
      "11645:     if(num_items>0)",
      "11646:         nbap_edch_channel_info[e_dch_macdflow_id].lchId[num_items-1] = logical_channel_id;",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "11656: static int",
      "11657: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11659:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11660:                                                             1U, 1504U, NULL, TRUE);",
      "",
      "[Removed Lines]",
      "11658: #line 1727 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "11657: #line 1728 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "12079: static int",
      "12080: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "12082:     address     dst_addr;",
      "12083:     transportLayerAddress_ipv4 = 0;",
      "12084:     BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "12081: #line 1978 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "12080: #line 1979 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "12124: static int",
      "12125: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "12127:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "12128:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
      "",
      "[Removed Lines]",
      "12126: #line 1615 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "12125: #line 1616 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "12132:     {",
      "12133:         return offset;",
      "12134:     }",
      "",
      "[Removed Lines]",
      "12135:     nbap_edch_channel_info[e_dch_macdflow_id].edch_macd_pdu_size[num_items-1] = MACdPDU_Size;",
      "",
      "[Added Lines]",
      "12134:     if(num_items>0)",
      "12135:         nbap_edch_channel_info[e_dch_macdflow_id].edch_macd_pdu_size[num_items-1] = MACdPDU_Size;",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "13344: static int",
      "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
      "",
      "[Removed Lines]",
      "13346: #line 2086 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "13346: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "18037:     {",
      "18038:         return offset;",
      "18039:     }",
      "",
      "[Removed Lines]",
      "18040:     nbap_edch_channel_info[e_dch_macdflow_id].edch_ddi[num_items-1] = e_dch_ddi_value;",
      "",
      "[Added Lines]",
      "18040:     if(num_items>0)",
      "18041:         nbap_edch_channel_info[e_dch_macdflow_id].edch_ddi[num_items-1] = e_dch_ddi_value;",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "23305: static int",
      "23306: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "23307: #line 1998 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23308: #line 1999 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "23466: static int",
      "23467: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23471:     address     dst_addr;",
      "",
      "[Removed Lines]",
      "23468: #line 1705 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23469: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "23569: static int",
      "23570: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23572:     guint32 rlc_mode;",
      "23574:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
      "",
      "[Removed Lines]",
      "23571: #line 1632 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23572: #line 1633 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "23610: static int",
      "23611: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23613:     num_items++;",
      "",
      "[Removed Lines]",
      "23612: #line 1696 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23613: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "23644: static int",
      "23645: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23648:     int protocol_ie_id;",
      "23649:     guint32 i;",
      "",
      "[Removed Lines]",
      "23646: #line 1656 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23647: #line 1657 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "23688: static int",
      "23689: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23691:     guint32 hsdsch_physical_layer_category;",
      "23693:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "",
      "[Removed Lines]",
      "23690: #line 1649 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23691: #line 1650 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "23756: static int",
      "23757: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "23758: #line 1757 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23759: #line 1758 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "23893: static int",
      "23894: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23896:     address     dst_addr;",
      "23897:     transportLayerAddress_ipv4 = 0;",
      "23898:     BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "23895: #line 1846 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23896: #line 1847 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "23951: static int",
      "23952: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23954:     num_items = 1;",
      "",
      "[Removed Lines]",
      "23953: #line 1699 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23954: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "24086: static int",
      "24087: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "24088: #line 1866 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24089: #line 1867 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "24208: static int",
      "24209: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "24210: #line 1734 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24211: #line 1735 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "24319: static int",
      "24320: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24322:     num_items++;",
      "",
      "[Removed Lines]",
      "24321: #line 1702 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24322: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "24735: static int",
      "24736: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24739:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
      "",
      "[Removed Lines]",
      "24737: #line 2076 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24738: #line 2077 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "24929: static int",
      "24930: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24932:     num_items++;",
      "",
      "[Removed Lines]",
      "24931: #line 1693 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24932: #line 1694 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "24946: static int",
      "24947: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24949:     num_items = 0;",
      "",
      "[Removed Lines]",
      "24948: #line 1688 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24949: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "28048: static int",
      "28049: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "28052: nbap_com_context_id_t *cur_val;",
      "",
      "[Removed Lines]",
      "28050: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "28051: #line 2091 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 27 ---",
      "[Context before]",
      "41064: actx->pinfo->link_dir=P2P_DIR_DL;",
      "",
      "[Removed Lines]",
      "41067: #line 2139 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "41068: #line 2140 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5bf565690ad9f0771196d8fa237aa37fae3bb7cc",
      "candidate_info": {
        "commit_hash": "5bf565690ad9f0771196d8fa237aa37fae3bb7cc",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/5bf565690ad9f0771196d8fa237aa37fae3bb7cc",
        "files": [
          "asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "NBAP: avoid dereferencing a NULL pointer\n\nBug: 11602\nChange-Id: I56b9db19eca416c288f36c1f3a4faa7e22b38c8f\nReviewed-on: https://code.wireshark.org/review/11109\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1243: #.FN_BODY RL-Specific-E-DCH-Information-Item",
          "1244: address     dst_addr, null_addr;",
          "1245: conversation_t *conversation;",
          "1247: nbap_edch_port_info_t *old_info = NULL;",
          "1249: transportLayerAddress_ipv4 = 0;",
          "",
          "[Removed Lines]",
          "1246: umts_fp_conversation_info_t *umts_fp_conversation_info;",
          "",
          "[Added Lines]",
          "1246: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1263:         conversation = find_conversation(actx->pinfo->fd->num,&dst_addr,",
          "1264:             &null_addr, PT_UDP, BindingID_port,",
          "1265:             0, NO_ADDR_B|NO_PORT_B);",
          "",
          "[Removed Lines]",
          "1270:         if (conversation == NULL || ((umts_fp_conversation_info_t*)conversation_get_proto_data(conversation, proto_fp))->channel == CHANNEL_DCH) {",
          "",
          "[Added Lines]",
          "1266:         if (conversation) {",
          "1267:             umts_fp_conversation_info = (umts_fp_conversation_info_t*)conversation_get_proto_data(conversation, proto_fp);",
          "1268:         }",
          "1273:         if ((conversation == NULL) || (umts_fp_conversation_info && umts_fp_conversation_info->channel == CHANNEL_DCH)) {",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10028: static int",
          "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10032:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10030: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10030: #line 2146 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10281: static int",
          "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10285: address     null_addr;",
          "10286: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10283: #line 2108 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10283: #line 2111 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11503: static int",
          "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11505: #line 1967 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11505: #line 1970 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11637: static int",
          "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11639: #line 1620 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11639: #line 1623 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11656: static int",
          "11657: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11659:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11660:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11658: #line 1723 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11658: #line 1726 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12079: static int",
          "12080: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12082:     address     dst_addr;",
          "12083:     transportLayerAddress_ipv4 = 0;",
          "12084:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12081: #line 1974 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12081: #line 1977 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12124: static int",
          "12125: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12127:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12128:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12126: #line 1611 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12126: #line 1614 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "13344: static int",
          "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13346: #line 2082 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13346: #line 2085 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "18028: static int",
          "18029: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18032:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18033:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18030: #line 1601 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18030: #line 1604 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18162: static int",
          "18163: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18165:     num_items++;",
          "",
          "[Removed Lines]",
          "18164: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18164: #line 1601 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18179: static int",
          "18180: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18182:     num_items = 0;",
          "18184:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18181: #line 1591 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18181: #line 1594 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18212: static int",
          "18213: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18215: umts_fp_conversation_info_t *p_conv_data = NULL;",
          "18216: address     null_addr;",
          "18217: conversation_t   *p_conv;",
          "",
          "[Removed Lines]",
          "18214: #line 1353 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18214: #line 1356 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18395: static int",
          "18396: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18399:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18400:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18397: #line 1586 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18397: #line 1589 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18470: static int",
          "18471: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18473: guint32 no_ddi_entries, i;",
          "18474: address     null_addr;",
          "18475: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18472: #line 1494 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18472: #line 1497 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18612: static int",
          "18613: dissect_nbap_E_DCH_FDD_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18616: address     dst_addr, null_addr;",
          "18617: conversation_t *conversation,*old_conversation = NULL;",
          "",
          "[Removed Lines]",
          "18614: #line 1406 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18614: #line 1409 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "23304: static int",
          "23305: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23306: #line 1994 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23306: #line 1997 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23465: static int",
          "23466: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23470:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23467: #line 1701 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23467: #line 1704 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23568: static int",
          "23569: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23571:     guint32 rlc_mode;",
          "23573:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23570: #line 1628 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23570: #line 1631 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23609: static int",
          "23610: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23612:     num_items++;",
          "",
          "[Removed Lines]",
          "23611: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23611: #line 1695 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23643: static int",
          "23644: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23647:     int protocol_ie_id;",
          "23648:     guint32 i;",
          "",
          "[Removed Lines]",
          "23645: #line 1652 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23645: #line 1655 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23687: static int",
          "23688: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23690:     guint32 hsdsch_physical_layer_category;",
          "23692:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23689: #line 1645 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23689: #line 1648 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23755: static int",
          "23756: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23757: #line 1753 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23757: #line 1756 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23892: static int",
          "23893: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23895:     address     dst_addr;",
          "23896:     transportLayerAddress_ipv4 = 0;",
          "23897:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23894: #line 1842 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23894: #line 1845 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23950: static int",
          "23951: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23953:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23952: #line 1695 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23952: #line 1698 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "24085: static int",
          "24086: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24087: #line 1862 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24087: #line 1865 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "24207: static int",
          "24208: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24209: #line 1730 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24209: #line 1733 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "24318: static int",
          "24319: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24321:     num_items++;",
          "",
          "[Removed Lines]",
          "24320: #line 1698 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24320: #line 1701 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24734: static int",
          "24735: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24738:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24736: #line 2072 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24736: #line 2075 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24928: static int",
          "24929: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24931:     num_items++;",
          "",
          "[Removed Lines]",
          "24930: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24930: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24945: static int",
          "24946: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24948:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24947: #line 1684 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24947: #line 1687 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "28047: static int",
          "28048: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28051: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28049: #line 2086 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28049: #line 2089 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "28780: #line 1244 \"../../asn1/nbap/nbap.cnf\"",
          "28781: address     dst_addr, null_addr;",
          "28782: conversation_t *conversation;",
          "28784: nbap_edch_port_info_t *old_info = NULL;",
          "28786: transportLayerAddress_ipv4 = 0;",
          "",
          "[Removed Lines]",
          "28783: umts_fp_conversation_info_t *umts_fp_conversation_info;",
          "",
          "[Added Lines]",
          "28783: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "28802:         conversation = find_conversation(actx->pinfo->fd->num,&dst_addr,",
          "28803:             &null_addr, PT_UDP, BindingID_port,",
          "28804:             0, NO_ADDR_B|NO_PORT_B);",
          "",
          "[Removed Lines]",
          "28809:         if (conversation == NULL || ((umts_fp_conversation_info_t*)conversation_get_proto_data(conversation, proto_fp))->channel == CHANNEL_DCH) {",
          "",
          "[Added Lines]",
          "28805:         if (conversation) {",
          "28806:             umts_fp_conversation_info = (umts_fp_conversation_info_t*)conversation_get_proto_data(conversation, proto_fp);",
          "28807:         }",
          "28812:         if ((conversation == NULL) || (umts_fp_conversation_info && umts_fp_conversation_info->channel == CHANNEL_DCH)) {",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "41060: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41063: #line 2135 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41066: #line 2138 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9c9fd67d8b8476176046838c3f36e7defcbaff33",
      "candidate_info": {
        "commit_hash": "9c9fd67d8b8476176046838c3f36e7defcbaff33",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/9c9fd67d8b8476176046838c3f36e7defcbaff33",
        "files": [
          "epan/dissectors/asn1/nbap/nbap.cnf",
          "epan/dissectors/asn1/nbap/packet-nbap-template.c",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "packet-nbap.c: Convert some g_ APIs to wmem.\n\nChange-Id: I480dd5c533b53cc90e483f42e974c5f3e660e305\nReviewed-on: https://code.wireshark.org/review/16548\nReviewed-by: Anders Broman <a.broman58@gmail.com>",
        "before_after_code_files": [
          "epan/dissectors/asn1/nbap/nbap.cnf||epan/dissectors/asn1/nbap/nbap.cnf",
          "epan/dissectors/asn1/nbap/packet-nbap-template.c||epan/dissectors/asn1/nbap/packet-nbap-template.c",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/asn1/nbap/nbap.cnf||epan/dissectors/asn1/nbap/nbap.cnf": [
          "File: epan/dissectors/asn1/nbap/nbap.cnf -> epan/dissectors/asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1300:                     umts_fp_conversation_info->com_context_id = com_context_id;",
          "1301:                 }else{",
          "1302:                     nbap_com_context_id_t *cur_val;",
          "1304:                         umts_fp_conversation_info->com_context_id = cur_val->crnc_context;",
          "1305:                     }else{",
          "1306:                         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_set_comm_context_id);",
          "",
          "[Removed Lines]",
          "1303:                     if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "1303:                     if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1313:                     nbap_edch_port_info_t * nbap_edch_port_info;",
          "1318:                     nbap_edch_port_info->crnc_port[e_dch_macdflow_id] = BindingID_port;",
          "",
          "[Removed Lines]",
          "1312:                 if( (old_info = (nbap_edch_port_info_t *)g_tree_lookup(edch_flow_port_map, GINT_TO_POINTER((gint)com_context_id))) == NULL ){",
          "1315:                     nbap_edch_port_info = (nbap_edch_port_info_t *)g_malloc0(sizeof(nbap_edch_port_info_t));",
          "",
          "[Added Lines]",
          "1312:                 if( (old_info = (nbap_edch_port_info_t *)wmem_tree_lookup32(edch_flow_port_map, com_context_id)) == NULL ){",
          "1315:                     nbap_edch_port_info = wmem_new0(wmem_file_scope(), nbap_edch_port_info_t);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1322:                     nbap_debug(\"Frame %%u RL-Specific-E-DCH-Information-Item Start\",",
          "1323:                         actx->pinfo->num);",
          "1326:                         umts_fp_conversation_info->com_context_id,",
          "1327:                         e_dch_macdflow_id,",
          "1328:                         address_to_str(wmem_packet_scope(), &dst_addr),",
          "1329:                         BindingID_port);",
          "1332:                 }else{",
          "1334:                     nbap_debug(\"    Insert in existing edch_flow_port_map com_context_id %%u e_dch_macdflow_id %%u IP %%s Port %%u\",",
          "",
          "[Removed Lines]",
          "1325:                     nbap_debug(\"    g_tree_insert(edch_flow_port_map) com_context_id %%u e_dch_macdflow_id %%u IP %%s Port %%u\",",
          "1331:                     g_tree_insert(edch_flow_port_map, GINT_TO_POINTER((gint)umts_fp_conversation_info->com_context_id), nbap_edch_port_info);",
          "",
          "[Added Lines]",
          "1325:                     nbap_debug(\"    wmem_tree_insert32(edch_flow_port_map) com_context_id %%u e_dch_macdflow_id %%u IP %%s Port %%u\",",
          "1331:                     wmem_tree_insert32(edch_flow_port_map, umts_fp_conversation_info->com_context_id, nbap_edch_port_info);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1477:                     umts_fp_conversation_info->com_context_id = com_context_id;",
          "1478:                 }else{",
          "1479:                     nbap_com_context_id_t * cur_val;",
          "1481:                         umts_fp_conversation_info->com_context_id = cur_val->crnc_context;",
          "1482:                     }else{",
          "1483:                         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_set_comm_context_id);",
          "",
          "[Removed Lines]",
          "1480:                     if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "1481:                     if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1522:     }else{",
          "1523:         nbap_com_context_id_t * cur_val;",
          "1525:             com_context_id= cur_val->crnc_context;",
          "1526:         }else{",
          "1527:             expert_add_info(actx->pinfo, NULL, &ei_nbap_no_find_comm_context_id);",
          "",
          "[Removed Lines]",
          "1524:         if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "1525:         if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1529:     }",
          "1533:         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_find_port_info);",
          "1534:         return offset;",
          "1535:     }",
          "",
          "[Removed Lines]",
          "1532:     if(( old_info = (nbap_edch_port_info_t *)g_tree_lookup(edch_flow_port_map, GINT_TO_POINTER((gint)com_context_id))) == NULL ){",
          "",
          "[Added Lines]",
          "1533:     if(( old_info = (nbap_edch_port_info_t *)wmem_tree_lookup32(edch_flow_port_map, com_context_id)) == NULL ){",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2104: if(crcn_context_present){",
          "2108:             cur_val->crnc_context = com_context_id;",
          "2109:             cur_val->frame_num = actx->pinfo->num;",
          "2111:             com_context_id = -1;",
          "2112:         }",
          "2113:     }",
          "",
          "[Removed Lines]",
          "2105:         if( (nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id)) == NULL ){",
          "2107:             cur_val = g_new(nbap_com_context_id_t,1);",
          "2110:             g_tree_insert(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id), cur_val);",
          "",
          "[Added Lines]",
          "2106:         if( wmem_tree_lookup32(com_context_map, node_b_com_context_id) == NULL ){",
          "2108:             cur_val = wmem_new(wmem_file_scope(), nbap_com_context_id_t);",
          "2111:             wmem_tree_insert32(com_context_map, node_b_com_context_id, cur_val);",
          "",
          "---------------"
        ],
        "epan/dissectors/asn1/nbap/packet-nbap-template.c||epan/dissectors/asn1/nbap/packet-nbap-template.c": [
          "File: epan/dissectors/asn1/nbap/packet-nbap-template.c -> epan/dissectors/asn1/nbap/packet-nbap-template.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "184: guint node_b_com_context_id;",
          "189: typedef struct com_ctxt_{",
          "",
          "[Removed Lines]",
          "186: static GTree * edch_flow_port_map = NULL;",
          "",
          "[Added Lines]",
          "186: static wmem_tree_t* edch_flow_port_map = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "193: }nbap_com_context_id_t;",
          "195: gboolean crcn_context_present = FALSE;",
          "198: struct _nbap_msg_info_for_fp g_nbap_msg_info_for_fp;",
          "",
          "[Removed Lines]",
          "196: static GTree * com_context_map;",
          "",
          "[Added Lines]",
          "196: static wmem_tree_t* com_context_map;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "421:  }",
          "423: }",
          "435: static void nbap_init(void){",
          "436:     guint8 i;",
          "450:     for (i = 0; i < 15; i++) {",
          "451:         lchId_type_table[i+1] = lch_contents[i];",
          "452:     }",
          "453: }",
          "461: static int",
          "462: dissect_nbap(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)",
          "463: {",
          "",
          "[Removed Lines]",
          "424: static gint nbap_key_cmp(gconstpointer a_ptr, gconstpointer b_ptr, gpointer ignore _U_){",
          "425:  if( GPOINTER_TO_INT(a_ptr) > GPOINTER_TO_INT(b_ptr) ){",
          "426:   return  -1;",
          "427:  }",
          "428:  return GPOINTER_TO_INT(a_ptr) < GPOINTER_TO_INT(b_ptr);",
          "429: }",
          "431:    g_free(key);",
          "438:     com_context_map = g_tree_new_full(nbap_key_cmp,",
          "441:                        g_free);",
          "445:     edch_flow_port_map = g_tree_new_full(nbap_key_cmp,",
          "448:                        g_free);",
          "455: static void nbap_cleanup(void){",
          "457:     g_tree_destroy(com_context_map);",
          "458:     g_tree_destroy(edch_flow_port_map);",
          "459: }",
          "",
          "[Added Lines]",
          "428:     com_context_map = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());",
          "431:     edch_flow_port_map = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "546:  nbap_proc_uout_dissector_table = register_dissector_table(\"nbap.proc.uout\", \"NBAP-ELEMENTARY-PROCEDURE UnsuccessfulOutcome\", proto_nbap, FT_STRING, BASE_NONE, DISSECTOR_TABLE_ALLOW_DUPLICATE);",
          "548:  register_init_routine(nbap_init);",
          "550: }",
          "",
          "[Removed Lines]",
          "549:  register_cleanup_routine(nbap_cleanup);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6577: guint node_b_com_context_id;",
          "6582: typedef struct com_ctxt_{",
          "",
          "[Removed Lines]",
          "6579: static GTree * edch_flow_port_map = NULL;",
          "",
          "[Added Lines]",
          "6579: static wmem_tree_t* edch_flow_port_map = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "6586: }nbap_com_context_id_t;",
          "6588: gboolean crcn_context_present = FALSE;",
          "6591: struct _nbap_msg_info_for_fp g_nbap_msg_info_for_fp;",
          "",
          "[Removed Lines]",
          "6589: static GTree * com_context_map;",
          "",
          "[Added Lines]",
          "6589: static wmem_tree_t* com_context_map;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "10050: static int",
          "10051: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10053:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10054:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10052: #line 2151 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10052: #line 2152 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "10303: static int",
          "10304: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10306: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10307: address     null_addr;",
          "10308: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10305: #line 2116 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10305: #line 2117 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11525: static int",
          "11526: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11529:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11530:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11527: #line 1975 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11527: #line 1976 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "11659: static int",
          "11660: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11663:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11664:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11661: #line 1629 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11661: #line 1630 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "11677: static int",
          "11678: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11680:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11681:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11679: #line 1731 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11679: #line 1732 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "12100: static int",
          "12101: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12103:     address     dst_addr;",
          "12104:     transportLayerAddress_ipv4 = 0;",
          "12105:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12102: #line 1982 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12102: #line 1983 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "12145: static int",
          "12146: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12148:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12149:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12147: #line 1619 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12147: #line 1620 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "13366: static int",
          "13367: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13369:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13370:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13368: #line 2090 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13368: #line 2091 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18050: static int",
          "18051: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18054:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18055:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18052: #line 1608 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18052: #line 1609 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18185: static int",
          "18186: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18188:     num_items++;",
          "",
          "[Removed Lines]",
          "18187: #line 1605 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18187: #line 1606 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18202: static int",
          "18203: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18205:     num_items = 0;",
          "18207:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18204: #line 1598 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18204: #line 1599 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18418: static int",
          "18419: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18422:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18423:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18420: #line 1593 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18420: #line 1594 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18493: static int",
          "18494: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18496: guint32 no_ddi_entries, i;",
          "18497: address     null_addr;",
          "18498: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18495: #line 1501 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18495: #line 1502 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "18519:     }else{",
          "18520:         nbap_com_context_id_t * cur_val;",
          "18522:             com_context_id= cur_val->crnc_context;",
          "18523:         }else{",
          "18524:             expert_add_info(actx->pinfo, NULL, &ei_nbap_no_find_comm_context_id);",
          "",
          "[Removed Lines]",
          "18521:         if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "18521:         if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "18526:     }",
          "18530:         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_find_port_info);",
          "18531:         return offset;",
          "18532:     }",
          "",
          "[Removed Lines]",
          "18529:     if(( old_info = (nbap_edch_port_info_t *)g_tree_lookup(edch_flow_port_map, GINT_TO_POINTER((gint)com_context_id))) == NULL ){",
          "",
          "[Added Lines]",
          "18529:     if(( old_info = (nbap_edch_port_info_t *)wmem_tree_lookup32(edch_flow_port_map, com_context_id)) == NULL ){",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "18708:                     umts_fp_conversation_info->com_context_id = com_context_id;",
          "18709:                 }else{",
          "18710:                     nbap_com_context_id_t * cur_val;",
          "18712:                         umts_fp_conversation_info->com_context_id = cur_val->crnc_context;",
          "18713:                     }else{",
          "18714:                         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_set_comm_context_id);",
          "",
          "[Removed Lines]",
          "18711:                     if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "18712:                     if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23331: static int",
          "23332: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23333: #line 2002 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23334: #line 2003 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23492: static int",
          "23493: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23497:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23494: #line 1709 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23495: #line 1710 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23595: static int",
          "23596: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23598:     guint32 rlc_mode;",
          "23600:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23597: #line 1636 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23598: #line 1637 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23636: static int",
          "23637: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23639:     num_items++;",
          "",
          "[Removed Lines]",
          "23638: #line 1700 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23639: #line 1701 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23670: static int",
          "23671: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23674:     int protocol_ie_id;",
          "23675:     guint32 i;",
          "",
          "[Removed Lines]",
          "23672: #line 1660 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23673: #line 1661 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23714: static int",
          "23715: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23717:     guint32 hsdsch_physical_layer_category;",
          "23719:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23716: #line 1653 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23717: #line 1654 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "23782: static int",
          "23783: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23784: #line 1761 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23785: #line 1762 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "23919: static int",
          "23920: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23922:     address     dst_addr;",
          "23923:     transportLayerAddress_ipv4 = 0;",
          "23924:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23921: #line 1850 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23922: #line 1851 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "23977: static int",
          "23978: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23980:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23979: #line 1703 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23980: #line 1704 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24112: static int",
          "24113: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24114: #line 1870 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24115: #line 1871 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24234: static int",
          "24235: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24236: #line 1738 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24237: #line 1739 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24345: static int",
          "24346: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24348:     num_items++;",
          "",
          "[Removed Lines]",
          "24347: #line 1706 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24348: #line 1707 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "24761: static int",
          "24762: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24765:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24763: #line 2080 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24764: #line 2081 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "24955: static int",
          "24956: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24958:     num_items++;",
          "",
          "[Removed Lines]",
          "24957: #line 1697 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24958: #line 1698 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "24972: static int",
          "24973: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24975:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24974: #line 1692 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24975: #line 1693 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "28074: static int",
          "28075: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28078: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28076: #line 2094 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28077: #line 2095 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "28089: if(crcn_context_present){",
          "28093:             cur_val->crnc_context = com_context_id;",
          "28094:             cur_val->frame_num = actx->pinfo->num;",
          "28096:             com_context_id = -1;",
          "28097:         }",
          "28098:     }",
          "",
          "[Removed Lines]",
          "28090:         if( (nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id)) == NULL ){",
          "28092:             cur_val = g_new(nbap_com_context_id_t,1);",
          "28095:             g_tree_insert(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id), cur_val);",
          "",
          "[Added Lines]",
          "28091:         if( wmem_tree_lookup32(com_context_map, node_b_com_context_id) == NULL ){",
          "28093:             cur_val = wmem_new(wmem_file_scope(), nbap_com_context_id_t);",
          "28096:             wmem_tree_insert32(com_context_map, node_b_com_context_id, cur_val);",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "28866:                     umts_fp_conversation_info->com_context_id = com_context_id;",
          "28867:                 }else{",
          "28868:                     nbap_com_context_id_t *cur_val;",
          "28870:                         umts_fp_conversation_info->com_context_id = cur_val->crnc_context;",
          "28871:                     }else{",
          "28872:                         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_set_comm_context_id);",
          "",
          "[Removed Lines]",
          "28869:                     if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "28870:                     if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "28879:                     nbap_edch_port_info_t * nbap_edch_port_info;",
          "28884:                     nbap_edch_port_info->crnc_port[e_dch_macdflow_id] = BindingID_port;",
          "",
          "[Removed Lines]",
          "28878:                 if( (old_info = (nbap_edch_port_info_t *)g_tree_lookup(edch_flow_port_map, GINT_TO_POINTER((gint)com_context_id))) == NULL ){",
          "28881:                     nbap_edch_port_info = (nbap_edch_port_info_t *)g_malloc0(sizeof(nbap_edch_port_info_t));",
          "",
          "[Added Lines]",
          "28879:                 if( (old_info = (nbap_edch_port_info_t *)wmem_tree_lookup32(edch_flow_port_map, com_context_id)) == NULL ){",
          "28882:                     nbap_edch_port_info = wmem_new0(wmem_file_scope(), nbap_edch_port_info_t);",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "28888:                     nbap_debug(\"Frame %u RL-Specific-E-DCH-Information-Item Start\",",
          "28889:                         actx->pinfo->num);",
          "28892:                         umts_fp_conversation_info->com_context_id,",
          "28893:                         e_dch_macdflow_id,",
          "28894:                         address_to_str(wmem_packet_scope(), &dst_addr),",
          "28895:                         BindingID_port);",
          "28898:                 }else{",
          "28900:                     nbap_debug(\"    Insert in existing edch_flow_port_map com_context_id %u e_dch_macdflow_id %u IP %s Port %u\",",
          "",
          "[Removed Lines]",
          "28891:                     nbap_debug(\"    g_tree_insert(edch_flow_port_map) com_context_id %u e_dch_macdflow_id %u IP %s Port %u\",",
          "28897:                     g_tree_insert(edch_flow_port_map, GINT_TO_POINTER((gint)umts_fp_conversation_info->com_context_id), nbap_edch_port_info);",
          "",
          "[Added Lines]",
          "28892:                     nbap_debug(\"    wmem_tree_insert32(edch_flow_port_map) com_context_id %u e_dch_macdflow_id %u IP %s Port %u\",",
          "28898:                     wmem_tree_insert32(edch_flow_port_map, umts_fp_conversation_info->com_context_id, nbap_edch_port_info);",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "41090: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41093: #line 2143 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41094: #line 2144 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "55280:  }",
          "55282: }",
          "55294: static void nbap_init(void){",
          "55295:     guint8 i;",
          "55309:     for (i = 0; i < 15; i++) {",
          "55310:         lchId_type_table[i+1] = lch_contents[i];",
          "55311:     }",
          "55312: }",
          "55320: static int",
          "55321: dissect_nbap(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)",
          "55322: {",
          "",
          "[Removed Lines]",
          "55283: static gint nbap_key_cmp(gconstpointer a_ptr, gconstpointer b_ptr, gpointer ignore _U_){",
          "55284:  if( GPOINTER_TO_INT(a_ptr) > GPOINTER_TO_INT(b_ptr) ){",
          "55285:   return  -1;",
          "55286:  }",
          "55287:  return GPOINTER_TO_INT(a_ptr) < GPOINTER_TO_INT(b_ptr);",
          "55288: }",
          "55290:    g_free(key);",
          "55297:     com_context_map = g_tree_new_full(nbap_key_cmp,",
          "55300:                        g_free);",
          "55304:     edch_flow_port_map = g_tree_new_full(nbap_key_cmp,",
          "55307:                        g_free);",
          "55314: static void nbap_cleanup(void){",
          "55316:     g_tree_destroy(com_context_map);",
          "55317:     g_tree_destroy(edch_flow_port_map);",
          "55318: }",
          "",
          "[Added Lines]",
          "55288:     com_context_map = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());",
          "55291:     edch_flow_port_map = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "68523:         NULL, HFILL }},",
          "68527:  };",
          "",
          "[Removed Lines]",
          "68526: #line 503 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "[Added Lines]",
          "68504: #line 480 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "70163:     &ett_nbap_Outcome,",
          "70167:  };",
          "70169:  static ei_register_info ei[] = {",
          "",
          "[Removed Lines]",
          "70166: #line 512 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "[Added Lines]",
          "70144: #line 489 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "---------------",
          "--- Hunk 43 ---",
          "[Context before]",
          "70201:  nbap_proc_uout_dissector_table = register_dissector_table(\"nbap.proc.uout\", \"NBAP-ELEMENTARY-PROCEDURE UnsuccessfulOutcome\", proto_nbap, FT_STRING, BASE_NONE, DISSECTOR_TABLE_ALLOW_DUPLICATE);",
          "70203:  register_init_routine(nbap_init);",
          "70205: }",
          "",
          "[Removed Lines]",
          "70204:  register_cleanup_routine(nbap_cleanup);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 44 ---",
          "[Context before]",
          "71319: }",
          "",
          "[Removed Lines]",
          "71318: #line 567 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "[Added Lines]",
          "71295: #line 543 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "23379ae3624df82c170f48e5bb3250a97ec61c13",
      "candidate_info": {
        "commit_hash": "23379ae3624df82c170f48e5bb3250a97ec61c13",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/23379ae3624df82c170f48e5bb3250a97ec61c13",
        "files": [
          "asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "NBAP : Verify conversation proto data exists before trying to access it\n\nBug 11841\nChange-Id: Ic0dea6491a68a042ddc0f2dbee19739e4568b18c\nReviewed-on: https://code.wireshark.org/review/12576\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nTested-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1410: address     dst_addr, null_addr;",
          "1411: conversation_t *conversation,*old_conversation = NULL;",
          "1412: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
          "1414: transportLayerAddress_ipv4 = 0;",
          "1415: BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1413: void *conv_proto_data = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1454:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "1455:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "1461:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "1462:                 umts_fp_conversation_info->division          = Division_FDD;",
          "",
          "[Removed Lines]",
          "1457:                 if (old_conversation)",
          "1458:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "1458:                 if (old_conversation) {",
          "1459:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
          "1460:                     if (conv_proto_data)",
          "1461:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
          "1462:                 }",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10028: static int",
          "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10032:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10030: #line 2148 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10030: #line 2151 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10281: static int",
          "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10285: address     null_addr;",
          "10286: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10283: #line 2113 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10283: #line 2116 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11503: static int",
          "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11505: #line 1972 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11505: #line 1975 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11637: static int",
          "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11639: #line 1626 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11639: #line 1629 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11655: static int",
          "11656: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11658:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11659:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11657: #line 1728 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11657: #line 1731 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12078: static int",
          "12079: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12081:     address     dst_addr;",
          "12082:     transportLayerAddress_ipv4 = 0;",
          "12083:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12080: #line 1979 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12080: #line 1982 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12123: static int",
          "12124: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12126:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12127:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12125: #line 1616 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12125: #line 1619 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "13344: static int",
          "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13346: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13346: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "18028: static int",
          "18029: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18032:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18033:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18030: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18030: #line 1608 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18163: static int",
          "18164: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18166:     num_items++;",
          "",
          "[Removed Lines]",
          "18165: #line 1602 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18165: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18180: static int",
          "18181: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18183:     num_items = 0;",
          "18185:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18182: #line 1595 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18182: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18396: static int",
          "18397: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18400:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18401:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18398: #line 1590 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18398: #line 1593 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18471: static int",
          "18472: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18474: guint32 no_ddi_entries, i;",
          "18475: address     null_addr;",
          "18476: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18473: #line 1498 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18473: #line 1501 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18617: address     dst_addr, null_addr;",
          "18618: conversation_t *conversation,*old_conversation = NULL;",
          "18619: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
          "18621: transportLayerAddress_ipv4 = 0;",
          "18622: BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "18620: void *conv_proto_data = NULL;",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18663:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "18664:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "18670:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "18671:                 umts_fp_conversation_info->division          = Division_FDD;",
          "",
          "[Removed Lines]",
          "18666:                 if (old_conversation)",
          "18667:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "18667:                 if (old_conversation) {",
          "18668:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
          "18669:                     if (conv_proto_data)",
          "18670:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
          "18671:                 }",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "23306: static int",
          "23307: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23308: #line 1999 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23311: #line 2002 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23467: static int",
          "23468: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23472:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23469: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23472: #line 1709 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23570: static int",
          "23571: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23573:     guint32 rlc_mode;",
          "23575:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23572: #line 1633 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23575: #line 1636 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23611: static int",
          "23612: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23614:     num_items++;",
          "",
          "[Removed Lines]",
          "23613: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23616: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23645: static int",
          "23646: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23649:     int protocol_ie_id;",
          "23650:     guint32 i;",
          "",
          "[Removed Lines]",
          "23647: #line 1657 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23650: #line 1660 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23689: static int",
          "23690: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23692:     guint32 hsdsch_physical_layer_category;",
          "23694:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23691: #line 1650 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23694: #line 1653 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23757: static int",
          "23758: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23759: #line 1758 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23762: #line 1761 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23894: static int",
          "23895: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23897:     address     dst_addr;",
          "23898:     transportLayerAddress_ipv4 = 0;",
          "23899:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23896: #line 1847 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23899: #line 1850 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23952: static int",
          "23953: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23955:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23954: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23957: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "24087: static int",
          "24088: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24089: #line 1867 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24092: #line 1870 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "24209: static int",
          "24210: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24211: #line 1735 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24214: #line 1738 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "24320: static int",
          "24321: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24323:     num_items++;",
          "",
          "[Removed Lines]",
          "24322: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24325: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24736: static int",
          "24737: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24740:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24738: #line 2077 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24741: #line 2080 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24930: static int",
          "24931: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24933:     num_items++;",
          "",
          "[Removed Lines]",
          "24932: #line 1694 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24935: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24947: static int",
          "24948: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24950:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24949: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24952: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "28049: static int",
          "28050: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28053: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28051: #line 2091 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28054: #line 2094 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "41065: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41068: #line 2140 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41071: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}