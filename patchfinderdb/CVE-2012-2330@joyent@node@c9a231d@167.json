{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0f9d201183396c423bcfc6027ac2ce883e28cec5",
      "candidate_info": {
        "commit_hash": "0f9d201183396c423bcfc6027ac2ce883e28cec5",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/0f9d201183396c423bcfc6027ac2ce883e28cec5",
        "files": [
          "deps/openssl/config/piii/openssl/opensslconf-posix.h",
          "deps/openssl/config/piii/openssl/opensslconf-win32.h",
          "deps/openssl/config/piii/openssl/opensslconf.h"
        ],
        "message": "deps: reapply 0110c90 to bundled openssl",
        "before_after_code_files": [
          "deps/openssl/config/piii/openssl/opensslconf-posix.h||deps/openssl/config/piii/openssl/opensslconf-posix.h",
          "deps/openssl/config/piii/openssl/opensslconf-win32.h||deps/openssl/config/piii/openssl/opensslconf-win32.h",
          "deps/openssl/config/piii/openssl/opensslconf.h||deps/openssl/config/piii/openssl/opensslconf.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/openssl/config/piii/openssl/opensslconf-posix.h||deps/openssl/config/piii/openssl/opensslconf-posix.h": [
          "File: deps/openssl/config/piii/openssl/opensslconf-posix.h -> deps/openssl/config/piii/openssl/opensslconf-posix.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: #ifndef OPENSSL_DOING_MAKEDEPEND",
          "8: #ifndef OPENSSL_NO_CAMELLIA",
          "9: # define OPENSSL_NO_CAMELLIA",
          "10: #endif",
          "11: #ifndef OPENSSL_NO_CAPIENG",
          "12: # define OPENSSL_NO_CAPIENG",
          "13: #endif",
          "14: #ifndef OPENSSL_NO_CMS",
          "15: # define OPENSSL_NO_CMS",
          "16: #endif",
          "17: #ifndef OPENSSL_NO_FIPS",
          "18: # define OPENSSL_NO_FIPS",
          "19: #endif",
          "20: #ifndef OPENSSL_NO_GMP",
          "21: # define OPENSSL_NO_GMP",
          "22: #endif",
          "23: #ifndef OPENSSL_NO_IDEA",
          "24: # define OPENSSL_NO_IDEA",
          "25: #endif",
          "26: #ifndef OPENSSL_NO_JPAKE",
          "27: # define OPENSSL_NO_JPAKE",
          "28: #endif",
          "29: #ifndef OPENSSL_NO_KRB5",
          "30: # define OPENSSL_NO_KRB5",
          "31: #endif",
          "32: #ifndef OPENSSL_NO_MDC2",
          "33: # define OPENSSL_NO_MDC2",
          "34: #endif",
          "35: #ifndef OPENSSL_NO_RC5",
          "36: # define OPENSSL_NO_RC5",
          "37: #endif",
          "38: #ifndef OPENSSL_NO_RFC3779",
          "39: # define OPENSSL_NO_RFC3779",
          "40: #endif",
          "41: #ifndef OPENSSL_NO_SEED",
          "42: # define OPENSSL_NO_SEED",
          "43: #endif",
          "44: #ifndef OPENSSL_NO_ASM",
          "45: # define OPENSSL_NO_ASM",
          "46: #endif",
          "50: #ifndef OPENSSL_THREADS",
          "51: # define OPENSSL_THREADS",
          "52: #endif",
          "53: #ifndef OPENSSL_NO_DYNAMIC_ENGINE",
          "54: # define OPENSSL_NO_DYNAMIC_ENGINE",
          "55: #endif",
          "58:    asks for it.  This is a transient feature that is provided for those",
          "59:    who haven't had the time to do the appropriate changes in their",
          "61: #ifdef OPENSSL_ALGORITHM_DEFINES",
          "62: # if defined(OPENSSL_NO_CAMELLIA) && !defined(NO_CAMELLIA)",
          "63: #  define NO_CAMELLIA",
          "64: # endif",
          "65: # if defined(OPENSSL_NO_CAPIENG) && !defined(NO_CAPIENG)",
          "66: #  define NO_CAPIENG",
          "67: # endif",
          "68: # if defined(OPENSSL_NO_CMS) && !defined(NO_CMS)",
          "69: #  define NO_CMS",
          "70: # endif",
          "71: # if defined(OPENSSL_NO_FIPS) && !defined(NO_FIPS)",
          "72: #  define NO_FIPS",
          "73: # endif",
          "74: # if defined(OPENSSL_NO_GMP) && !defined(NO_GMP)",
          "75: #  define NO_GMP",
          "76: # endif",
          "77: # if defined(OPENSSL_NO_IDEA) && !defined(NO_IDEA)",
          "78: #  define NO_IDEA",
          "79: # endif",
          "80: # if defined(OPENSSL_NO_JPAKE) && !defined(NO_JPAKE)",
          "81: #  define NO_JPAKE",
          "82: # endif",
          "83: # if defined(OPENSSL_NO_KRB5) && !defined(NO_KRB5)",
          "84: #  define NO_KRB5",
          "85: # endif",
          "86: # if defined(OPENSSL_NO_MDC2) && !defined(NO_MDC2)",
          "87: #  define NO_MDC2",
          "88: # endif",
          "89: # if defined(OPENSSL_NO_RC5) && !defined(NO_RC5)",
          "90: #  define NO_RC5",
          "91: # endif",
          "92: # if defined(OPENSSL_NO_RFC3779) && !defined(NO_RFC3779)",
          "93: #  define NO_RFC3779",
          "94: # endif",
          "95: # if defined(OPENSSL_NO_SEED) && !defined(NO_SEED)",
          "96: #  define NO_SEED",
          "97: # endif",
          "98: #endif",
          "100: #define OPENSSL_CPUID_OBJ",
          "104: #ifdef OPENSSL_DOING_MAKEDEPEND",
          "113: #ifndef OPENSSL_FIPS",
          "114: #define OPENSSL_FIPS",
          "115: #endif",
          "117: #endif",
          "120: #undef I386_ONLY",
          "123: #if defined(HEADER_CRYPTLIB_H) && !defined(OPENSSLDIR)",
          "124: #define ENGINESDIR \"/usr/local/ssl/lib/engines\"",
          "125: #define OPENSSLDIR \"/usr/local/ssl\"",
          "126: #endif",
          "127: #endif",
          "129: #undef OPENSSL_UNISTD",
          "130: #define OPENSSL_UNISTD <unistd.h>",
          "131: #if !defined(SWIG)",
          "132: #include <unistd.h>",
          "133: #endif",
          "135: #undef OPENSSL_EXPORT_VAR_AS_FUNCTION",
          "137: #if defined(HEADER_IDEA_H) && !defined(IDEA_INT)",
          "138: #define IDEA_INT unsigned int",
          "139: #endif",
          "141: #if defined(HEADER_MD2_H) && !defined(MD2_INT)",
          "142: #define MD2_INT unsigned int",
          "143: #endif",
          "145: #if defined(HEADER_RC2_H) && !defined(RC2_INT)",
          "147: #define RC2_INT unsigned int",
          "148: #endif",
          "150: #if defined(HEADER_RC4_H)",
          "151: #if !defined(RC4_INT)",
          "159: #define RC4_INT unsigned int",
          "160: #endif",
          "161: #if !defined(RC4_CHUNK)",
          "166: #undef RC4_CHUNK",
          "167: #endif",
          "168: #endif",
          "170: #if (defined(HEADER_NEW_DES_H) || defined(HEADER_DES_H)) && !defined(DES_LONG)",
          "173: #ifndef DES_LONG",
          "174: #define DES_LONG unsigned long",
          "175: #endif",
          "176: #endif",
          "178: #if defined(HEADER_BN_H) && !defined(CONFIG_HEADER_BN_H)",
          "179: #define CONFIG_HEADER_BN_H",
          "180: #define BN_LLONG",
          "188: #undef SIXTY_FOUR_BIT_LONG",
          "189: #undef SIXTY_FOUR_BIT",
          "190: #define THIRTY_TWO_BIT",
          "191: #undef SIXTEEN_BIT",
          "192: #undef EIGHT_BIT",
          "193: #endif",
          "195: #if defined(HEADER_RC4_LOCL_H) && !defined(CONFIG_HEADER_RC4_LOCL_H)",
          "196: #define CONFIG_HEADER_RC4_LOCL_H",
          "199: #define RC4_INDEX",
          "200: #endif",
          "202: #if defined(HEADER_BF_LOCL_H) && !defined(CONFIG_HEADER_BF_LOCL_H)",
          "203: #define CONFIG_HEADER_BF_LOCL_H",
          "204: #undef BF_PTR",
          "207: #if defined(HEADER_DES_LOCL_H) && !defined(CONFIG_HEADER_DES_LOCL_H)",
          "208: #define CONFIG_HEADER_DES_LOCL_H",
          "209: #ifndef DES_DEFAULT_OPTIONS",
          "212: #ifndef DES_PTR",
          "213: #define DES_PTR",
          "214: #endif",
          "219: #ifndef DES_RISC1",
          "220: #define DES_RISC1",
          "221: #endif",
          "223: #ifndef DES_RISC2",
          "224: #undef DES_RISC2",
          "225: #endif",
          "227: #if defined(DES_RISC1) && defined(DES_RISC2)",
          "228: YOU SHOULD NOT HAVE BOTH DES_RISC1 AND DES_RISC2 DEFINED!!!!!",
          "229: #endif",
          "233: #ifndef DES_UNROLL",
          "234: #define DES_UNROLL",
          "235: #endif",
          "240: #if !defined(DES_PTR) && !defined(DES_RISC1) && !defined(DES_RISC2) && !defined(DES_UNROLL)",
          "242:    CPU and OS.  For SGI machines you can use _MIPS_SZLONG (32 or 64) to find",
          "243:    even newer MIPS CPU's, but at the moment one size fits all for",
          "244:    optimization options.  Older Sparc's work better with only UNROLL, but",
          "248: #  define DES_PTR",
          "249: #  define DES_RISC1",
          "250: #  define DES_UNROLL",
          "252: #  define DES_PTR",
          "253: #  define DES_RISC2",
          "254: #  define DES_UNROLL",
          "256: #  define DES_PTR",
          "257: #  define DES_RISC2",
          "265: #  define DES_UNROLL",
          "267: #  define DES_PTR",
          "268: #  define DES_RISC2",
          "269: #  define DES_UNROLL",
          "271: #  define DES_PTR",
          "272: #  define DES_RISC1",
          "273: #  define DES_UNROLL",
          "275: #endif",
          "",
          "---------------"
        ],
        "deps/openssl/config/piii/openssl/opensslconf-win32.h||deps/openssl/config/piii/openssl/opensslconf-win32.h": [
          "File: deps/openssl/config/piii/openssl/opensslconf-win32.h -> deps/openssl/config/piii/openssl/opensslconf-win32.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: #ifndef OPENSSL_SYSNAME_WIN32",
          "6: # define OPENSSL_SYSNAME_WIN32",
          "7: #endif",
          "8: #ifndef OPENSSL_DOING_MAKEDEPEND",
          "11: #ifndef OPENSSL_NO_CAMELLIA",
          "12: # define OPENSSL_NO_CAMELLIA",
          "13: #endif",
          "14: #ifndef OPENSSL_NO_CAPIENG",
          "15: # define OPENSSL_NO_CAPIENG",
          "16: #endif",
          "17: #ifndef OPENSSL_NO_CMS",
          "18: # define OPENSSL_NO_CMS",
          "19: #endif",
          "20: #ifndef OPENSSL_NO_FIPS",
          "21: # define OPENSSL_NO_FIPS",
          "22: #endif",
          "23: #ifndef OPENSSL_NO_GMP",
          "24: # define OPENSSL_NO_GMP",
          "25: #endif",
          "26: #ifndef OPENSSL_NO_IDEA",
          "27: # define OPENSSL_NO_IDEA",
          "28: #endif",
          "29: #ifndef OPENSSL_NO_JPAKE",
          "30: # define OPENSSL_NO_JPAKE",
          "31: #endif",
          "32: #ifndef OPENSSL_NO_KRB5",
          "33: # define OPENSSL_NO_KRB5",
          "34: #endif",
          "35: #ifndef OPENSSL_NO_MDC2",
          "36: # define OPENSSL_NO_MDC2",
          "37: #endif",
          "38: #ifndef OPENSSL_NO_RC5",
          "39: # define OPENSSL_NO_RC5",
          "40: #endif",
          "41: #ifndef OPENSSL_NO_RFC3779",
          "42: # define OPENSSL_NO_RFC3779",
          "43: #endif",
          "44: #ifndef OPENSSL_NO_SEED",
          "45: # define OPENSSL_NO_SEED",
          "46: #endif",
          "47: #ifndef OPENSSL_NO_ASM",
          "48: # define OPENSSL_NO_ASM",
          "49: #endif",
          "53: #ifndef OPENSSL_THREADS",
          "54: # define OPENSSL_THREADS",
          "55: #endif",
          "56: #ifndef OPENSSL_NO_DYNAMIC_ENGINE",
          "57: # define OPENSSL_NO_DYNAMIC_ENGINE",
          "58: #endif",
          "61:    asks for it.  This is a transient feature that is provided for those",
          "62:    who haven't had the time to do the appropriate changes in their",
          "64: #ifdef OPENSSL_ALGORITHM_DEFINES",
          "65: # if defined(OPENSSL_NO_CAMELLIA) && !defined(NO_CAMELLIA)",
          "66: #  define NO_CAMELLIA",
          "67: # endif",
          "68: # if defined(OPENSSL_NO_CAPIENG) && !defined(NO_CAPIENG)",
          "69: #  define NO_CAPIENG",
          "70: # endif",
          "71: # if defined(OPENSSL_NO_CMS) && !defined(NO_CMS)",
          "72: #  define NO_CMS",
          "73: # endif",
          "74: # if defined(OPENSSL_NO_FIPS) && !defined(NO_FIPS)",
          "75: #  define NO_FIPS",
          "76: # endif",
          "77: # if defined(OPENSSL_NO_GMP) && !defined(NO_GMP)",
          "78: #  define NO_GMP",
          "79: # endif",
          "80: # if defined(OPENSSL_NO_IDEA) && !defined(NO_IDEA)",
          "81: #  define NO_IDEA",
          "82: # endif",
          "83: # if defined(OPENSSL_NO_JPAKE) && !defined(NO_JPAKE)",
          "84: #  define NO_JPAKE",
          "85: # endif",
          "86: # if defined(OPENSSL_NO_KRB5) && !defined(NO_KRB5)",
          "87: #  define NO_KRB5",
          "88: # endif",
          "89: # if defined(OPENSSL_NO_MDC2) && !defined(NO_MDC2)",
          "90: #  define NO_MDC2",
          "91: # endif",
          "92: # if defined(OPENSSL_NO_RC5) && !defined(NO_RC5)",
          "93: #  define NO_RC5",
          "94: # endif",
          "95: # if defined(OPENSSL_NO_RFC3779) && !defined(NO_RFC3779)",
          "96: #  define NO_RFC3779",
          "97: # endif",
          "98: # if defined(OPENSSL_NO_SEED) && !defined(NO_SEED)",
          "99: #  define NO_SEED",
          "100: # endif",
          "101: #endif",
          "103: #define OPENSSL_CPUID_OBJ",
          "107: #ifdef OPENSSL_DOING_MAKEDEPEND",
          "116: #ifndef OPENSSL_FIPS",
          "117: #define OPENSSL_FIPS",
          "118: #endif",
          "120: #endif",
          "123: #undef I386_ONLY",
          "126: #if defined(HEADER_CRYPTLIB_H) && !defined(OPENSSLDIR)",
          "127: #define ENGINESDIR \"ssl/lib/engines\"",
          "128: #define OPENSSLDIR \"ssl\"",
          "129: #endif",
          "130: #endif",
          "132: #undef OPENSSL_UNISTD",
          "133: #define OPENSSL_UNISTD <unistd.h>",
          "135: #undef OPENSSL_EXPORT_VAR_AS_FUNCTION",
          "136: #define OPENSSL_EXPORT_VAR_AS_FUNCTION",
          "138: #if defined(HEADER_IDEA_H) && !defined(IDEA_INT)",
          "139: #define IDEA_INT unsigned int",
          "140: #endif",
          "142: #if defined(HEADER_MD2_H) && !defined(MD2_INT)",
          "143: #define MD2_INT unsigned int",
          "144: #endif",
          "146: #if defined(HEADER_RC2_H) && !defined(RC2_INT)",
          "148: #define RC2_INT unsigned int",
          "149: #endif",
          "151: #if defined(HEADER_RC4_H)",
          "152: #if !defined(RC4_INT)",
          "160: #define RC4_INT unsigned int",
          "161: #endif",
          "162: #if !defined(RC4_CHUNK)",
          "167: #undef RC4_CHUNK",
          "168: #endif",
          "169: #endif",
          "171: #if (defined(HEADER_NEW_DES_H) || defined(HEADER_DES_H)) && !defined(DES_LONG)",
          "174: #ifndef DES_LONG",
          "175: #define DES_LONG unsigned long",
          "176: #endif",
          "177: #endif",
          "179: #if defined(HEADER_BN_H) && !defined(CONFIG_HEADER_BN_H)",
          "180: #define CONFIG_HEADER_BN_H",
          "181: #define BN_LLONG",
          "189: #undef SIXTY_FOUR_BIT_LONG",
          "190: #undef SIXTY_FOUR_BIT",
          "191: #define THIRTY_TWO_BIT",
          "192: #undef SIXTEEN_BIT",
          "193: #undef EIGHT_BIT",
          "194: #endif",
          "196: #if defined(HEADER_RC4_LOCL_H) && !defined(CONFIG_HEADER_RC4_LOCL_H)",
          "197: #define CONFIG_HEADER_RC4_LOCL_H",
          "200: #define RC4_INDEX",
          "201: #endif",
          "203: #if defined(HEADER_BF_LOCL_H) && !defined(CONFIG_HEADER_BF_LOCL_H)",
          "204: #define CONFIG_HEADER_BF_LOCL_H",
          "205: #undef BF_PTR",
          "208: #if defined(HEADER_DES_LOCL_H) && !defined(CONFIG_HEADER_DES_LOCL_H)",
          "209: #define CONFIG_HEADER_DES_LOCL_H",
          "210: #ifndef DES_DEFAULT_OPTIONS",
          "213: #ifndef DES_PTR",
          "214: #undef DES_PTR",
          "215: #endif",
          "220: #ifndef DES_RISC1",
          "221: #undef DES_RISC1",
          "222: #endif",
          "224: #ifndef DES_RISC2",
          "225: #undef DES_RISC2",
          "226: #endif",
          "228: #if defined(DES_RISC1) && defined(DES_RISC2)",
          "229: YOU SHOULD NOT HAVE BOTH DES_RISC1 AND DES_RISC2 DEFINED!!!!!",
          "230: #endif",
          "234: #ifndef DES_UNROLL",
          "235: #undef DES_UNROLL",
          "236: #endif",
          "241: #if !defined(DES_PTR) && !defined(DES_RISC1) && !defined(DES_RISC2) && !defined(DES_UNROLL)",
          "243:    CPU and OS.  For SGI machines you can use _MIPS_SZLONG (32 or 64) to find",
          "244:    even newer MIPS CPU's, but at the moment one size fits all for",
          "245:    optimization options.  Older Sparc's work better with only UNROLL, but",
          "249: #  define DES_PTR",
          "250: #  define DES_RISC1",
          "251: #  define DES_UNROLL",
          "253: #  define DES_PTR",
          "254: #  define DES_RISC2",
          "255: #  define DES_UNROLL",
          "257: #  define DES_PTR",
          "258: #  define DES_RISC2",
          "266: #  define DES_UNROLL",
          "268: #  define DES_PTR",
          "269: #  define DES_RISC2",
          "270: #  define DES_UNROLL",
          "272: #  define DES_PTR",
          "273: #  define DES_RISC1",
          "274: #  define DES_UNROLL",
          "276: #endif",
          "",
          "---------------"
        ],
        "deps/openssl/config/piii/openssl/opensslconf.h||deps/openssl/config/piii/openssl/opensslconf.h": [
          "File: deps/openssl/config/piii/openssl/opensslconf.h -> deps/openssl/config/piii/openssl/opensslconf.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "10: #endif",
          "",
          "[Removed Lines]",
          "5: #ifndef OPENSSL_DOING_MAKEDEPEND",
          "8: #ifndef OPENSSL_NO_CAMELLIA",
          "9: # define OPENSSL_NO_CAMELLIA",
          "11: #ifndef OPENSSL_NO_CAPIENG",
          "12: # define OPENSSL_NO_CAPIENG",
          "13: #endif",
          "14: #ifndef OPENSSL_NO_CMS",
          "15: # define OPENSSL_NO_CMS",
          "16: #endif",
          "17: #ifndef OPENSSL_NO_FIPS",
          "18: # define OPENSSL_NO_FIPS",
          "19: #endif",
          "20: #ifndef OPENSSL_NO_GMP",
          "21: # define OPENSSL_NO_GMP",
          "22: #endif",
          "23: #ifndef OPENSSL_NO_IDEA",
          "24: # define OPENSSL_NO_IDEA",
          "25: #endif",
          "26: #ifndef OPENSSL_NO_JPAKE",
          "27: # define OPENSSL_NO_JPAKE",
          "28: #endif",
          "29: #ifndef OPENSSL_NO_KRB5",
          "30: # define OPENSSL_NO_KRB5",
          "31: #endif",
          "32: #ifndef OPENSSL_NO_MDC2",
          "33: # define OPENSSL_NO_MDC2",
          "34: #endif",
          "35: #ifndef OPENSSL_NO_RC5",
          "36: # define OPENSSL_NO_RC5",
          "37: #endif",
          "38: #ifndef OPENSSL_NO_RFC3779",
          "39: # define OPENSSL_NO_RFC3779",
          "40: #endif",
          "41: #ifndef OPENSSL_NO_SEED",
          "42: # define OPENSSL_NO_SEED",
          "43: #endif",
          "44: #ifndef OPENSSL_NO_ASM",
          "45: # define OPENSSL_NO_ASM",
          "46: #endif",
          "50: #ifndef OPENSSL_THREADS",
          "51: # define OPENSSL_THREADS",
          "52: #endif",
          "53: #ifndef OPENSSL_NO_DYNAMIC_ENGINE",
          "54: # define OPENSSL_NO_DYNAMIC_ENGINE",
          "55: #endif",
          "58:    asks for it.  This is a transient feature that is provided for those",
          "59:    who haven't had the time to do the appropriate changes in their",
          "61: #ifdef OPENSSL_ALGORITHM_DEFINES",
          "62: # if defined(OPENSSL_NO_CAMELLIA) && !defined(NO_CAMELLIA)",
          "63: #  define NO_CAMELLIA",
          "64: # endif",
          "65: # if defined(OPENSSL_NO_CAPIENG) && !defined(NO_CAPIENG)",
          "66: #  define NO_CAPIENG",
          "67: # endif",
          "68: # if defined(OPENSSL_NO_CMS) && !defined(NO_CMS)",
          "69: #  define NO_CMS",
          "70: # endif",
          "71: # if defined(OPENSSL_NO_FIPS) && !defined(NO_FIPS)",
          "72: #  define NO_FIPS",
          "73: # endif",
          "74: # if defined(OPENSSL_NO_GMP) && !defined(NO_GMP)",
          "75: #  define NO_GMP",
          "76: # endif",
          "77: # if defined(OPENSSL_NO_IDEA) && !defined(NO_IDEA)",
          "78: #  define NO_IDEA",
          "79: # endif",
          "80: # if defined(OPENSSL_NO_JPAKE) && !defined(NO_JPAKE)",
          "81: #  define NO_JPAKE",
          "82: # endif",
          "83: # if defined(OPENSSL_NO_KRB5) && !defined(NO_KRB5)",
          "84: #  define NO_KRB5",
          "85: # endif",
          "86: # if defined(OPENSSL_NO_MDC2) && !defined(NO_MDC2)",
          "87: #  define NO_MDC2",
          "88: # endif",
          "89: # if defined(OPENSSL_NO_RC5) && !defined(NO_RC5)",
          "90: #  define NO_RC5",
          "91: # endif",
          "92: # if defined(OPENSSL_NO_RFC3779) && !defined(NO_RFC3779)",
          "93: #  define NO_RFC3779",
          "94: # endif",
          "95: # if defined(OPENSSL_NO_SEED) && !defined(NO_SEED)",
          "96: #  define NO_SEED",
          "97: # endif",
          "98: #endif",
          "100: #define OPENSSL_CPUID_OBJ",
          "104: #ifdef OPENSSL_DOING_MAKEDEPEND",
          "113: #ifndef OPENSSL_FIPS",
          "114: #define OPENSSL_FIPS",
          "115: #endif",
          "117: #endif",
          "120: #undef I386_ONLY",
          "123: #if defined(HEADER_CRYPTLIB_H) && !defined(OPENSSLDIR)",
          "124: #define ENGINESDIR \"/usr/local/ssl/lib/engines\"",
          "125: #define OPENSSLDIR \"/usr/local/ssl\"",
          "126: #endif",
          "127: #endif",
          "129: #undef OPENSSL_UNISTD",
          "130: #define OPENSSL_UNISTD <unistd.h>",
          "131: #if !defined(SWIG)",
          "132: #include <unistd.h>",
          "133: #endif",
          "135: #undef OPENSSL_EXPORT_VAR_AS_FUNCTION",
          "137: #if defined(HEADER_IDEA_H) && !defined(IDEA_INT)",
          "138: #define IDEA_INT unsigned int",
          "139: #endif",
          "141: #if defined(HEADER_MD2_H) && !defined(MD2_INT)",
          "142: #define MD2_INT unsigned int",
          "143: #endif",
          "145: #if defined(HEADER_RC2_H) && !defined(RC2_INT)",
          "147: #define RC2_INT unsigned int",
          "148: #endif",
          "150: #if defined(HEADER_RC4_H)",
          "151: #if !defined(RC4_INT)",
          "159: #define RC4_INT unsigned int",
          "160: #endif",
          "161: #if !defined(RC4_CHUNK)",
          "166: #undef RC4_CHUNK",
          "167: #endif",
          "168: #endif",
          "170: #if (defined(HEADER_NEW_DES_H) || defined(HEADER_DES_H)) && !defined(DES_LONG)",
          "173: #ifndef DES_LONG",
          "174: #define DES_LONG unsigned long",
          "175: #endif",
          "176: #endif",
          "178: #if defined(HEADER_BN_H) && !defined(CONFIG_HEADER_BN_H)",
          "179: #define CONFIG_HEADER_BN_H",
          "180: #define BN_LLONG",
          "188: #undef SIXTY_FOUR_BIT_LONG",
          "189: #undef SIXTY_FOUR_BIT",
          "190: #define THIRTY_TWO_BIT",
          "191: #undef SIXTEEN_BIT",
          "192: #undef EIGHT_BIT",
          "193: #endif",
          "195: #if defined(HEADER_RC4_LOCL_H) && !defined(CONFIG_HEADER_RC4_LOCL_H)",
          "196: #define CONFIG_HEADER_RC4_LOCL_H",
          "199: #define RC4_INDEX",
          "200: #endif",
          "202: #if defined(HEADER_BF_LOCL_H) && !defined(CONFIG_HEADER_BF_LOCL_H)",
          "203: #define CONFIG_HEADER_BF_LOCL_H",
          "204: #undef BF_PTR",
          "207: #if defined(HEADER_DES_LOCL_H) && !defined(CONFIG_HEADER_DES_LOCL_H)",
          "208: #define CONFIG_HEADER_DES_LOCL_H",
          "209: #ifndef DES_DEFAULT_OPTIONS",
          "212: #ifndef DES_PTR",
          "213: #define DES_PTR",
          "214: #endif",
          "219: #ifndef DES_RISC1",
          "220: #define DES_RISC1",
          "221: #endif",
          "223: #ifndef DES_RISC2",
          "224: #undef DES_RISC2",
          "225: #endif",
          "227: #if defined(DES_RISC1) && defined(DES_RISC2)",
          "228: YOU SHOULD NOT HAVE BOTH DES_RISC1 AND DES_RISC2 DEFINED!!!!!",
          "229: #endif",
          "233: #ifndef DES_UNROLL",
          "234: #define DES_UNROLL",
          "235: #endif",
          "240: #if !defined(DES_PTR) && !defined(DES_RISC1) && !defined(DES_RISC2) && !defined(DES_UNROLL)",
          "242:    CPU and OS.  For SGI machines you can use _MIPS_SZLONG (32 or 64) to find",
          "243:    even newer MIPS CPU's, but at the moment one size fits all for",
          "244:    optimization options.  Older Sparc's work better with only UNROLL, but",
          "248: #  define DES_PTR",
          "249: #  define DES_RISC1",
          "250: #  define DES_UNROLL",
          "252: #  define DES_PTR",
          "253: #  define DES_RISC2",
          "254: #  define DES_UNROLL",
          "256: #  define DES_PTR",
          "257: #  define DES_RISC2",
          "265: #  define DES_UNROLL",
          "267: #  define DES_PTR",
          "268: #  define DES_RISC2",
          "269: #  define DES_UNROLL",
          "271: #  define DES_PTR",
          "272: #  define DES_RISC1",
          "273: #  define DES_UNROLL",
          "275: #endif",
          "",
          "[Added Lines]",
          "1: #ifdef WIN32",
          "2: #include \"opensslconf-win32.h\"",
          "3: #else",
          "4: #include \"opensslconf-posix.h\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "430d94ef85f2786522671317ccbd034ef921ae14",
      "candidate_info": {
        "commit_hash": "430d94ef85f2786522671317ccbd034ef921ae14",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/430d94ef85f2786522671317ccbd034ef921ae14",
        "files": [
          "src/node.cc",
          "src/node.js",
          "test/simple/test-domain-stack.js",
          "test/simple/test-next-tick-error-spin.js"
        ],
        "message": "nextTick: Preserve depth in error/reentry cases\n\nWhen there is an error that is thrown in a nextTick function, which is\nthen handled by a domain or other process.on('uncaughtException')\nhandler, if the error handler *also* adds a nextTick and triggers\nmultiple MakeCallback events (ie, by doing some I/O), then it would\nskip over the tickDepth check, resulting in an infinite spin.\n\nSolution: Check the tickDepth at the start of the tick processing, and\npreserve it when we are cleaning up in the error case or exiting early\nin the re-entry case.\n\nIn order to make sure that tick callbacks are *eventually* handled, any\ncallback triggered by the underlying spinner in libuv will be processed\nas if starting from a tick depth of 0.",
        "before_after_code_files": [
          "src/node.cc||src/node.cc",
          "src/node.js||src/node.js",
          "test/simple/test-domain-stack.js||test/simple/test-domain-stack.js",
          "test/simple/test-next-tick-error-spin.js||test/simple/test-next-tick-error-spin.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node.cc||src/node.cc": [
          "File: src/node.cc -> src/node.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "248:   TryCatch try_catch;",
          "252:   if (try_catch.HasCaught()) {",
          "253:     FatalException(try_catch);",
          "",
          "[Removed Lines]",
          "250:   cb->Call(process, 0, NULL);",
          "",
          "[Added Lines]",
          "251:   Handle<Value> argv[] = { True() };",
          "252:   cb->Call(process, ARRAY_SIZE(argv), argv);",
          "",
          "---------------"
        ],
        "src/node.js||src/node.js": [
          "File: src/node.js -> src/node.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "261:     process.maxTickDepth = 1000;",
          "265:       nextTickQueue.splice(0, nextTickIndex);",
          "266:       nextTickIndex = 0;",
          "267:       inTick = false;",
          "",
          "[Removed Lines]",
          "263:     function tickDone() {",
          "264:       tickDepth = 0;",
          "",
          "[Added Lines]",
          "263:     function tickDone(tickDepth_) {",
          "264:       tickDepth = tickDepth_ || 0;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "270:       }",
          "271:     }",
          "274:       if (inTick) return;",
          "275:       inTick = true;",
          "279:       do {",
          "280:         tickDepth++;",
          "281:         var nextTickLength = nextTickQueue.length;",
          "",
          "[Removed Lines]",
          "273:     process._tickCallback = function() {",
          "",
          "[Added Lines]",
          "273:     process._tickCallback = function(fromSpinner) {",
          "281:       if (tickDepth >= process.maxTickDepth) {",
          "282:         if (fromSpinner) {",
          "284:           tickDepth = 0;",
          "285:         } else {",
          "286:           if (nextTickQueue.length) {",
          "287:             process._needTickCallback();",
          "288:           }",
          "289:           return;",
          "290:         }",
          "291:       }",
          "293:       if (!nextTickQueue.length) return tickDone();",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "292:             callback();",
          "293:             threw = false;",
          "294:           } finally {",
          "296:           }",
          "297:           if (tock.domain) {",
          "298:             tock.domain.exit();",
          "",
          "[Removed Lines]",
          "295:             if (threw) tickDone();",
          "",
          "[Added Lines]",
          "320:             if (threw) tickDone(tickDepth);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "316:       var tock = { callback: callback };",
          "317:       if (process.domain) tock.domain = process.domain;",
          "318:       nextTickQueue.push(tock);",
          "320:     };",
          "321:   };",
          "",
          "[Removed Lines]",
          "319:       process._needTickCallback();",
          "",
          "[Added Lines]",
          "344:       if (nextTickQueue.length) {",
          "345:         process._needTickCallback();",
          "346:       }",
          "",
          "---------------"
        ],
        "test/simple/test-domain-stack.js||test/simple/test-domain-stack.js": [
          "File: test/simple/test-domain-stack.js -> test/simple/test-domain-stack.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "44: for (var i = 0; i < 1000; i++) {",
          "45:   process.nextTick(foo);",
          "46: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "48: process.on('exit', function(c) {",
          "49:   if (!c) console.log('ok');",
          "50: });",
          "",
          "---------------"
        ],
        "test/simple/test-next-tick-error-spin.js||test/simple/test-next-tick-error-spin.js": [
          "File: test/simple/test-next-tick-error-spin.js -> test/simple/test-next-tick-error-spin.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22: var common = require('../common');",
          "23: var assert = require('assert');",
          "25: if (process.argv[2] !== 'child') {",
          "26:   var spawn = require('child_process').spawn;",
          "27:   var child = spawn(process.execPath, [__filename, 'child'], {",
          "28:     stdio: 'pipe'//'inherit'",
          "29:   });",
          "30:   var timer = setTimeout(function() {",
          "31:     throw new Error('child is hung');",
          "32:   }, 500);",
          "33:   child.on('exit', function(code) {",
          "34:     console.error('ok');",
          "35:     assert(!code);",
          "36:     clearTimeout(timer);",
          "37:   });",
          "38: } else {",
          "40:   var domain = require('domain');",
          "41:   var d = domain.create();",
          "42:   process.maxTickDepth = 10;",
          "45:   d.on('error', function(e) {",
          "46:     console.log('a')",
          "47:     console.log('b')",
          "48:     console.log('c')",
          "49:     console.log('d')",
          "50:     console.log('e')",
          "51:     f();",
          "52:   });",
          "54:   function f() {",
          "55:     process.nextTick(function() {",
          "56:       d.run(function() {",
          "57:         throw(new Error('x'));",
          "58:       });",
          "59:     });",
          "60:   }",
          "62:   f();",
          "63:   setTimeout(function () {",
          "64:     console.error('broke in!');",
          "67:     process.exit(0);",
          "68:   });",
          "69: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a337ac75843ba4547a18d5b7c09930d5f5d954fa",
      "candidate_info": {
        "commit_hash": "a337ac75843ba4547a18d5b7c09930d5f5d954fa",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/a337ac75843ba4547a18d5b7c09930d5f5d954fa",
        "files": [
          "lib/http.js",
          "test/simple/test-http-pipe-fs.js"
        ],
        "message": "http: fix XMLHttpRequest piped in a writable file stream hangs next request\n\nFixes #2263.",
        "before_after_code_files": [
          "lib/http.js||lihttp.js",
          "test/simple/test-http-pipe-fs.js||test/simple/test-http-pipe-fs.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/http.js||lihttp.js": [
          "File: lib/http.js -> lihttp.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "136:       parser.incoming.readable = false;",
          "137:       parser.incoming.emit('end');",
          "138:     }",
          "139:   };",
          "141:   return parser;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/simple/test-http-pipe-fs.js||test/simple/test-http-pipe-fs.js": [
          "File: test/simple/test-http-pipe-fs.js -> test/simple/test-http-pipe-fs.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22: var common = require('../common');",
          "23: var assert = require('assert');",
          "24: var http = require('http');",
          "25: var fs = require('fs');",
          "26: var path = require('path');",
          "28: var file = path.join(common.tmpDir, 'http-pipe-fs-test.txt');",
          "29: var requests = 0;",
          "31: var server = http.createServer(function(req, res) {",
          "32:   ++requests;",
          "33:   var stream = fs.createWriteStream(file);",
          "34:   req.pipe(stream);",
          "35:   stream.on('close', function() {",
          "36:     res.writeHead(200);",
          "37:     res.end();",
          "38:   });",
          "39: }).listen(common.PORT, function() {",
          "40:   http.globalAgent.maxSockets = 1;",
          "42:   for (var i = 0; i < 2; ++i) {",
          "43:     (function(i) {",
          "44:       var req = http.request({",
          "45:         port: common.PORT,",
          "46:         method: 'POST',",
          "47:         headers: {",
          "48:           'Content-Length': 5",
          "49:         }",
          "50:       }, function(res) {",
          "51:         res.on('end', function() {",
          "52:           common.debug('res' + i + ' end');",
          "53:           if (i === 2) {",
          "54:             server.close();",
          "55:           }",
          "56:         });",
          "57:       });",
          "58:       req.on('socket', function(s) {",
          "59:         common.debug('req' + i + ' start');",
          "60:       });",
          "61:       req.end('12345');",
          "62:     }(i + 1));",
          "63:   }",
          "64: });",
          "66: process.on('exit', function() {",
          "67:   assert.equal(requests, 2);",
          "68: });",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ac64c9e54690e7b0bbf26a583d8f4689bb95eb63",
      "candidate_info": {
        "commit_hash": "ac64c9e54690e7b0bbf26a583d8f4689bb95eb63",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/ac64c9e54690e7b0bbf26a583d8f4689bb95eb63",
        "files": [
          "deps/v8/build/common.gypi"
        ],
        "message": "v8: reapply floating patches\n\nNote that 26f754d9 ('fix error handling in SendConnectMessage') is no\nlonger necessary; it was properly fixed upstream in V8 r11609.",
        "before_after_code_files": [
          "deps/v8/build/common.gypi||deps/v8/build/common.gypi"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/v8/build/common.gypi||deps/v8/build/common.gypi": [
          "File: deps/v8/build/common.gypi -> deps/v8/build/common.gypi",
          "--- Hunk 1 ---",
          "[Context before]",
          "324:         },",
          "325:         'conditions': [",
          "326:           ['OS==\"linux\" or OS==\"freebsd\" or OS==\"openbsd\" or OS==\"netbsd\"', {",
          "328:                         '-Wnon-virtual-dtor', '-Woverloaded-virtual' ],",
          "329:           }],",
          "330:         ],",
          "",
          "[Removed Lines]",
          "327:             'cflags': [ '-Wall', '<(werror)', '-W', '-Wno-unused-parameter',",
          "",
          "[Added Lines]",
          "327:             'cflags': [ '-Wno-unused-parameter',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1cdadb1e3b6108bb636213debacf2f93166fbf83",
      "candidate_info": {
        "commit_hash": "1cdadb1e3b6108bb636213debacf2f93166fbf83",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/1cdadb1e3b6108bb636213debacf2f93166fbf83",
        "files": [
          "tools/installer.js"
        ],
        "message": "issue #2697: have 'make install' set npm shebang to use its node",
        "before_after_code_files": [
          "tools/installer.js||tools/installer.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tools/installer.js||tools/installer.js": [
          "File: tools/installer.js -> tools/installer.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "53:   });",
          "54: }",
          "57: function run() {",
          "58:   var cmd = queue.shift();",
          "59:   if (!cmd) return;",
          "66:     run();",
          "68: }",
          "70: if (cmd === 'install') {",
          "",
          "[Removed Lines]",
          "61:   console.log(cmd);",
          "62:   exec(cmd, function(err, stdout, stderr) {",
          "63:     if (stderr) console.error(stderr);",
          "64:     if (err) process.exit(1);",
          "67:   });",
          "",
          "[Added Lines]",
          "57: function shebang(line, file) {",
          "58:   var content = fs.readFileSync(file, 'utf8');",
          "59:   var firstLine = content.split(/\\n/, 1)[0];",
          "60:   var newContent;",
          "61:   if (firstLine.slice(0, 2) === '#!') {",
          "62:     newContent = line + content.slice(firstLine.length);",
          "63:   } else {",
          "64:     newContent = line + '\\n' + content;",
          "65:   }",
          "66:   if (content !== newContent) {",
          "67:     fs.writeFileSync(file, newContent, 'utf8');",
          "68:   }",
          "69: }",
          "76:   if (Array.isArray(cmd) && cmd[0] instanceof Function) {",
          "77:     var func = cmd[0];",
          "78:     var args = cmd.slice(1);",
          "79:     console.log.apply(null, [func.name].concat(args));",
          "80:     func.apply(null, args);",
          "82:   } else {",
          "83:     console.log(cmd);",
          "84:     exec(cmd, function(err, stdout, stderr) {",
          "85:       if (stderr) console.error(stderr);",
          "86:       if (err) process.exit(1);",
          "88:       run();",
          "89:     });",
          "90:   }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "109:     copy('deps/npm', 'lib/node_modules/npm');",
          "110:     queue.push('ln -sf ../lib/node_modules/npm/bin/npm-cli.js ' +",
          "111:                path.join(node_prefix, 'bin/npm'));",
          "112:   }",
          "113: } else {",
          "114:   remove([",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "135:     queue.push([shebang, '#!' + path.join(node_prefix, 'bin/node'),",
          "136:                path.join(node_prefix, 'lib/node_modules/npm/bin/npm-cli.js')]);",
          "",
          "---------------"
        ]
      }
    }
  ]
}