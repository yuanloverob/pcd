{
  "cve_id": "CVE-2016-10048",
  "cve_desc": "Directory traversal vulnerability in magick/module.c in ImageMagick 6.9.4-7 allows remote attackers to load arbitrary modules via unspecified vectors.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "fc6080f1321fd21e86ef916195cc110b05d9effb",
  "patch_info": {
    "commit_hash": "fc6080f1321fd21e86ef916195cc110b05d9effb",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/fc6080f1321fd21e86ef916195cc110b05d9effb",
    "files": [
      "ChangeLog",
      "magick/module.c",
      "magick/xml-tree.c"
    ],
    "message": "Coder path traversal is not authorized, bug report provided by Masaaki Chida",
    "before_after_code_files": [
      "magick/module.c||magick/module.c",
      "magick/xml-tree.c||magick/xml-tree.c"
    ]
  },
  "patch_diff": {
    "magick/module.c||magick/module.c": [
      "File: magick/module.c -> magick/module.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "547: %",
      "549: static MagickBooleanType GetMagickModulePath(const char *filename,",
      "550:   MagickModuleType module_type,char *path,ExceptionInfo *exception)",
      "551: {",
      "552:   char",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "550:   MagickModuleType module_type,char *path,ExceptionInfo *exception)",
      "551: {",
      "552:   char",
      "555:   assert(filename != (const char *) NULL);",
      "556:   (void) LogMagickEvent(TraceEvent,GetMagickModule(),\"%s\",filename);",
      "557:   assert(path != (char *) NULL);",
      "558:   assert(exception != (ExceptionInfo *) NULL);",
      "",
      "---------------"
    ],
    "magick/xml-tree.c||magick/xml-tree.c": [
      "File: magick/xml-tree.c -> magick/xml-tree.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2140:                 ((*p == '\\0') && (terminal != '>')))",
      "2141:               {",
      "2142:                 if (l != 0)",
      "2144:                 (void) ThrowMagickException(exception,GetMagickModule(),",
      "2145:                   OptionWarning,\"ParseError\",\"missing >\");",
      "2146:                 utf8=DestroyString(utf8);",
      "",
      "[Removed Lines]",
      "2143:                   (void) DestroyXMLTreeAttributes(attributes);",
      "",
      "[Added Lines]",
      "2143:                   (void) DestroyXMLTreeAttributes(attributes);",
      "2144:                 (void) ThrowMagickException(exception,GetMagickModule(),",
      "2145:                   OptionWarning,\"ParseError\",\"missing >\");",
      "2146:                 utf8=DestroyString(utf8);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f4a35c363e63a6c43596476d59ceca91886af80c",
      "candidate_info": {
        "commit_hash": "f4a35c363e63a6c43596476d59ceca91886af80c",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/f4a35c363e63a6c43596476d59ceca91886af80c",
        "files": [
          "ChangeLog",
          "MagickCore/configure.c",
          "MagickCore/module.c",
          "MagickCore/xml-tree.c"
        ],
        "message": "Coder path traversal is not authorized, bug report provided by Masaaki Chida",
        "before_after_code_files": [
          "MagickCore/configure.c||MagickCore/configure.c",
          "MagickCore/module.c||MagickCore/module.c",
          "MagickCore/xml-tree.c||MagickCore/xml-tree.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "MagickCore/configure.c||MagickCore/configure.c": [
          "File: MagickCore/configure.c -> MagickCore/configure.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "679:   assert(filename != (const char *) NULL);",
          "681:   assert(exception != (ExceptionInfo *) NULL);",
          "682:   (void) CopyMagickString(path,filename,MagickPathExtent);",
          "",
          "[Removed Lines]",
          "680:   (void) LogMagickEvent(TraceEvent,GetMagickModule(),\"%s\",filename);",
          "",
          "[Added Lines]",
          "680:   (void) LogMagickEvent(TraceEvent,GetMagickModule(),\"%s\",filename);",
          "681:   assert(exception != (ExceptionInfo *) NULL);",
          "",
          "---------------"
        ],
        "MagickCore/module.c||MagickCore/module.c": [
          "File: MagickCore/module.c -> MagickCore/module.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "549: %",
          "551: static MagickBooleanType GetMagickModulePath(const char *filename,",
          "552:   MagickModuleType module_type,char *path,ExceptionInfo *exception)",
          "553: {",
          "554:   char",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "552:   MagickModuleType module_type,char *path,ExceptionInfo *exception)",
          "553: {",
          "554:   char",
          "557:   assert(filename != (const char *) NULL);",
          "558:   (void) LogMagickEvent(TraceEvent,GetMagickModule(),\"%s\",filename);",
          "559:   assert(path != (char *) NULL);",
          "560:   assert(exception != (ExceptionInfo *) NULL);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "590:     {",
          "591:       register char",
          "595:       for (p=module_path-1; p != (char *) NULL; )",
          "596:       {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "625:       {",
          "626:         case MagickImageCoderModule:",
          "627:         default:",
          "629:           directory=MAGICKCORE_CODER_PATH;",
          "630:           break;",
          "631:         }",
          "",
          "[Removed Lines]",
          "628:         {",
          "",
          "[Added Lines]",
          "638:         {",
          "639:           directory=MAGICKCORE_CODER_PATH;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "667:         case MagickImageFilterModule:",
          "668:         {",
          "669:           registery_key=\"FilterModulesPath\";",
          "672:       }",
          "673:       key_value=NTRegistryKeyLookup(registery_key);",
          "674:       if (key_value == (unsigned char *) NULL)",
          "",
          "[Removed Lines]",
          "670:           break;",
          "671:         }",
          "",
          "[Added Lines]",
          "681:           break;",
          "682:         }",
          "",
          "---------------"
        ],
        "MagickCore/xml-tree.c||MagickCore/xml-tree.c": [
          "File: MagickCore/xml-tree.c -> MagickCore/xml-tree.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2141:                 ((*p == '\\0') && (terminal != '>')))",
          "2142:               {",
          "2143:                 if (l != 0)",
          "2145:                 (void) ThrowMagickException(exception,GetMagickModule(),",
          "2146:                   OptionWarning,\"ParseError\",\"missing >\");",
          "2147:                 utf8=DestroyString(utf8);",
          "",
          "[Removed Lines]",
          "2144:                   (void) DestroyXMLTreeAttributes(attributes);",
          "",
          "[Added Lines]",
          "2144:                   (void) DestroyXMLTreeAttributes(attributes);",
          "2145:                 (void) ThrowMagickException(exception,GetMagickModule(),",
          "2146:                   OptionWarning,\"ParseError\",\"missing >\");",
          "2147:                 utf8=DestroyString(utf8);",
          "",
          "---------------"
        ]
      }
    }
  ]
}