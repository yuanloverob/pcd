{
  "cve_id": "CVE-2015-0278",
  "cve_desc": "libuv before 0.10.34 does not properly drop group privileges, which allows context-dependent attackers to gain privileges via unspecified vectors.",
  "repo": "libuv/libuv",
  "patch_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
  "patch_info": {
    "commit_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
    "repo": "libuv/libuv",
    "commit_url": "https://github.com/libuv/libuv/commit/66ab38918c911bcff025562cf06237d7fedaba0c",
    "files": [
      "src/unix/process.c"
    ],
    "message": "unix: call setgoups before calling setuid/setgid\n\nPartial fix for #1093",
    "before_after_code_files": [
      "src/unix/process.c||src/unix/process.c"
    ]
  },
  "patch_diff": {
    "src/unix/process.c||src/unix/process.c": [
      "File: src/unix/process.c -> src/unix/process.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "330:     _exit(127);",
      "331:   }",
      "333:   if ((options->flags & UV_PROCESS_SETGID) && setgid(options->gid)) {",
      "334:     uv__write_int(error_fd, -errno);",
      "335:     perror(\"setgid()\");",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "333:   if (options->flags & (UV_PROCESS_SETUID | UV_PROCESS_SETGID)) {",
      "341:     SAVE_ERRNO(setgroups(0, NULL));",
      "342:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8f3621e4dd2d55befd0f0b8635cf8de17f849aff",
      "candidate_info": {
        "commit_hash": "8f3621e4dd2d55befd0f0b8635cf8de17f849aff",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/8f3621e4dd2d55befd0f0b8635cf8de17f849aff",
        "files": [
          "Makefile.mingw"
        ],
        "message": "build: remove mingw makefile\n\nCommit e52aa6c adds MinGW support to the autotools build.  Remove the\nMakefile, it's no longer needed.",
        "before_after_code_files": [
          "Makefile.mingw||Makefile.mingw"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Makefile.mingw||Makefile.mingw": [
          "File: Makefile.mingw -> Makefile.mingw",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "030666385c898f191808bd107299b2ac3220fc58",
      "candidate_info": {
        "commit_hash": "030666385c898f191808bd107299b2ac3220fc58",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/030666385c898f191808bd107299b2ac3220fc58",
        "files": [
          "src/win/fs.c"
        ],
        "message": "win: replace non-ansi characters in source file\n\nCloses: joyent/libuv#1581",
        "before_after_code_files": [
          "src/win/fs.c||src/win/fs.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/win/fs.c||src/win/fs.c": [
          "File: src/win/fs.c -> src/win/fs.c"
        ]
      }
    },
    {
      "candidate_hash": "6d56e6e132717df13c7ed76e6cc3ee53105759be",
      "candidate_info": {
        "commit_hash": "6d56e6e132717df13c7ed76e6cc3ee53105759be",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/6d56e6e132717df13c7ed76e6cc3ee53105759be",
        "files": [
          "src/win/tcp.c"
        ],
        "message": "windows: remove redundant code in uv_tcp_write\n\nThe overlapped structure is reset twice, it is non necessary.\n\nSigned-off-by: Fedor Indutny <fedor@indutny.com>",
        "before_after_code_files": [
          "src/win/tcp.c||src/win/tcp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/win/tcp.c||src/win/tcp.c": [
          "File: src/win/tcp.c -> src/win/tcp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "810:   req->type = UV_WRITE;",
          "811:   req->handle = (uv_stream_t*) handle;",
          "812:   req->cb = cb;",
          "816:   memset(&(req->overlapped), 0, sizeof(req->overlapped));",
          "",
          "[Removed Lines]",
          "813:   memset(&req->overlapped, 0, sizeof(req->overlapped));",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "aab8d9dab45d03d9df01a7deab7ae1f2ebe9ada3",
      "candidate_info": {
        "commit_hash": "aab8d9dab45d03d9df01a7deab7ae1f2ebe9ada3",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/aab8d9dab45d03d9df01a7deab7ae1f2ebe9ada3",
        "files": [
          "include/uv.h"
        ],
        "message": "doc: clarify return value when UV_RUN_NOWAIT is used\n\nSigned-off-by: Sa\u00fal Ibarra Corretg\u00e9 <saghul@gmail.com>",
        "before_after_code_files": [
          "include/uv.h||include/uv.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/uv.h||include/uv.h": [
          "File: include/uv.h -> include/uv.h"
        ]
      }
    },
    {
      "candidate_hash": "2d89b4b14f098c39701e6e84929f8408c82a4281",
      "candidate_info": {
        "commit_hash": "2d89b4b14f098c39701e6e84929f8408c82a4281",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/2d89b4b14f098c39701e6e84929f8408c82a4281",
        "files": [
          "uv.gyp"
        ],
        "message": "build: avoid double / in paths for dtrace\n\nGYP doesn't resolve or normalize the paths, resulting in the action not\nfiring if the path contains // so take care to avoid that",
        "before_after_code_files": [
          "uv.gyp||uv.gyp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "uv.gyp||uv.gyp": [
          "File: uv.gyp -> uv.gyp",
          "--- Hunk 1 ---",
          "[Context before]",
          "5:     # this is only relevant when dtrace is enabled and libuv is a child project",
          "6:     # as it's necessary to correctly locate the object files for post",
          "7:     # processing.",
          "9:   },",
          "11:   'target_defaults': {",
          "",
          "[Removed Lines]",
          "8:     'uv_parent_path': '',",
          "",
          "[Added Lines]",
          "8:     # XXX gyp is quite sensitive about paths with double / they don't normalize",
          "9:     'uv_parent_path': '/',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "475:               'action_name': 'uv_dtrace_o',",
          "476:               'inputs': [",
          "477:                 'src/unix/uv-dtrace.d',",
          "479:               ],",
          "480:               'outputs': [",
          "482:               ],",
          "483:               'action': [ 'dtrace', '-G', '-xnolibs', '-s', '<@(_inputs)',",
          "484:                 '-o', '<@(_outputs)' ]",
          "",
          "[Removed Lines]",
          "478:                 '<(PRODUCT_DIR)/obj.target/libuv/<(uv_parent_path)/src/unix/core.o',",
          "481:                 '<(PRODUCT_DIR)/obj.target/libuv/<(uv_parent_path)/src/unix/dtrace.o',",
          "",
          "[Added Lines]",
          "479:                 '<(PRODUCT_DIR)/obj.target/libuv<(uv_parent_path)src/unix/core.o',",
          "482:                 '<(PRODUCT_DIR)/obj.target/libuv<(uv_parent_path)src/unix/dtrace.o',",
          "",
          "---------------"
        ]
      }
    }
  ]
}