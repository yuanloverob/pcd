{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "03e01f2a196634097591e87cfa5c1bf4dff6ffd7",
      "candidate_info": {
        "commit_hash": "03e01f2a196634097591e87cfa5c1bf4dff6ffd7",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/03e01f2a196634097591e87cfa5c1bf4dff6ffd7",
        "files": [
          "_chver.sh",
          "_post-commit.sh",
          "_pre-commit.sh",
          "_release.sh",
          "bootstrap.sh",
          "configure",
          "res/freedos/MODE.COM",
          "src/format.h",
          "src/rufus.rc"
        ],
        "message": "[misc] Linux cross compilation fixes\n\n* Closes #850",
        "before_after_code_files": [
          "src/format.h||src/format.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/format.h||src/format.h": [
          "File: src/format.h -> src/format.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: #include <winioctl.h>    // for MEDIA_TYPE",
          "23: #pragma once",
          "",
          "[Removed Lines]",
          "20: #include <Windows.h>",
          "",
          "[Added Lines]",
          "20: #include <windows.h>",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.11.1000\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.11.1001\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "322: VS_VERSION_INFO VERSIONINFO",
          "325:  FILEFLAGSMASK 0x3fL",
          "326: #ifdef _DEBUG",
          "327:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "323:  FILEVERSION 2,11,1000,0",
          "324:  PRODUCTVERSION 2,11,1000,0",
          "",
          "[Added Lines]",
          "323:  FILEVERSION 2,11,1001,0",
          "324:  PRODUCTVERSION 2,11,1001,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "338:         BEGIN",
          "339:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "340:             VALUE \"FileDescription\", \"Rufus\"",
          "342:             VALUE \"InternalName\", \"Rufus\"",
          "343:             VALUE \"LegalCopyright\", \"\ufffd 2011-2016 Pete Batard (GPL v3)\"",
          "344:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "345:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "346:             VALUE \"ProductName\", \"Rufus\"",
          "348:         END",
          "349:     END",
          "350:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "341:             VALUE \"FileVersion\", \"2.11.1000\"",
          "347:             VALUE \"ProductVersion\", \"2.11.1000\"",
          "",
          "[Added Lines]",
          "341:             VALUE \"FileVersion\", \"2.11.1001\"",
          "347:             VALUE \"ProductVersion\", \"2.11.1001\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "293440b2e9e8e4d2029be1fc6af907f41c4dca24",
      "candidate_info": {
        "commit_hash": "293440b2e9e8e4d2029be1fc6af907f41c4dca24",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/293440b2e9e8e4d2029be1fc6af907f41c4dca24",
        "files": [
          "src/pki.c",
          "src/rufus.rc"
        ],
        "message": "[pki] fix a minor initialization issue",
        "before_after_code_files": [
          "src/pki.c||src/pki.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/pki.c||src/pki.c",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/pki.c||src/pki.c",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/pki.c||src/pki.c": [
          "File: src/pki.c -> src/pki.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "139: char* GetSignatureName(const char* path, const char* country_code)",
          "140: {",
          "141:  static char szSubjectName[128];",
          "143:  char *p = NULL, *mpath = NULL;",
          "144:  BOOL r;",
          "145:  HMODULE hm;",
          "",
          "[Removed Lines]",
          "142:  static char szCountry[3];",
          "",
          "[Added Lines]",
          "142:  char szCountry[3] = \"__\";",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.18.1203\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.18.1204\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,18,1203,0",
          "370:  PRODUCTVERSION 2,18,1203,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,18,1204,0",
          "370:  PRODUCTVERSION 2,18,1204,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.18.1203\"",
          "393:             VALUE \"ProductVersion\", \"2.18.1203\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.18.1204\"",
          "393:             VALUE \"ProductVersion\", \"2.18.1204\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "74bacf7b4efa1f1f62c78a1b9eee72cc1601bad6",
      "candidate_info": {
        "commit_hash": "74bacf7b4efa1f1f62c78a1b9eee72cc1601bad6",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/74bacf7b4efa1f1f62c78a1b9eee72cc1601bad6",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] fix some issues in Malay translation",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "9821:  \"Bergantung kepada kelajuan peranti USB anda, operasi ini mungkin mengambil masa yang amat lama.\"",
          "9822:  \"Terutamanya untuk fail besar .\\n\\nKami cadangkan anda biarkan Windows tamat dahulu untuk mengelakkan korupsi.\"",
          "9823:  \"Namun, jika anda kesuntukan masa, anda boleh cabutkan peranti anda...\"",
          "9825: t MSG_082 \"Imej ini sama ada tidak boleh boot, atau ia menggunakan kaedah boot atau mampatan yang tidak disokong oleh Rufus...\"",
          "9826: t MSG_083 \"Gantikan %s?\"",
          "9827: t MSG_084 \"Imej ISO ini menggunakan versi '%s' yang telah lapuk.\\n\"",
          "",
          "[Removed Lines]",
          "9824: t MSG_081 \"ISO tidak disokong\" -> \"Imej tidak disokong\"",
          "",
          "[Added Lines]",
          "9824: t MSG_081 \"Imej tidak disokong\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "9982: # Parameter: the name of an obsolete Syslinux .c32 module. eg: \"Obsolete vesamenu.c32 detected\"",
          "9983: t MSG_204 \"%s lapuk dikesan\"",
          "9984: # Display the name of the ISO selected. eg: \"Using ISO: en_win7_x64_sp1.iso\"",
          "9986: # Typically \"Missing ldlinux.c32 file\"",
          "9987: t MSG_206 \"Tidak menjumpai fail %s\"",
          "9988: # The name proposed by Windows' Computer Management -> Disk Management when you try to format a drive",
          "",
          "[Removed Lines]",
          "9985: t MSG_205 \"Menggunakan ISO: %s\" -> \"Menggunakan imej: %s\"",
          "",
          "[Added Lines]",
          "9985: t MSG_205 \"Menggunakan imej: %s\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "9991: # Same message, once for singular and plural (\"1 device found\", \"2 devices found\")",
          "9992: t MSG_208 \"%d peranti dijumpai\"",
          "9993: t MSG_209 \"%d peranti dijumpai\"",
          "9995: t MSG_211 \"DIBATALKAN\"",
          "9996: t MSG_212 \"GAGAL\"",
          "9997: # Used when a new update has been downloaded and launched",
          "",
          "[Removed Lines]",
          "9994: t MSG_210 \"SELESAI\" -> \"SEDIA\".",
          "",
          "[Added Lines]",
          "9994: t MSG_210 \"SEDIA\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "10025: # Takes the Syslinux version as parameter, eg. \"Installing Syslinux v5...\"",
          "10026: t MSG_234 \"Memasang Syslinux %s...\"",
          "10027: # Bad blocks status. eg: \"Bad Blocks: PASS 1/2 - 12.34% (0/0/1 errors)\"",
          "10029: t MSG_236 \"Blok rosak: menguji dengan corak rawak\"",
          "10030: t MSG_237 \"Blok rosak: Menguji dengan corak 0x%02X\"",
          "10031: # eg. \"Partitioning (MBR)...\"",
          "",
          "[Removed Lines]",
          "10028: t MSG_235 \"Blok rosak: MELEPASI %d/%d - %0.2f%% (%d/%d/%d kesilapan)\" -> \"Blok rosak: %s %d/%d - %0.2f%% (%d/%d/%d kesilapan)\"",
          "",
          "[Added Lines]",
          "10028: t MSG_235 \"Blok rosak: %s %d/%d - %0.2f%% (%d/%d/%d kesilapan)\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "10044: t MSG_250 \"%s dibolehkan\"",
          "10045: t MSG_251 \"%s tidak dibolehkan\"",
          "10046: t MSG_252 \"Menyemak saiz\"",
          "10048: t MSG_254 \"Memaksa pemformatan FAT32 besar\"",
          "10049: t MSG_255 \"NoDriveTypeAutorun akan dipadam apabila keluar\"",
          "10050: t MSG_256 \"Pengesanan cakera palsu\"",
          "",
          "[Removed Lines]",
          "10047: t MSG_253 \"Pengesanan cakera tetap\" -> \"Pengesanan cakera keras\"",
          "",
          "[Added Lines]",
          "10047: t MSG_253 \"Pengesanan cakera keras\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1229\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1230\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "373: VS_VERSION_INFO VERSIONINFO",
          "376:  FILEFLAGSMASK 0x3fL",
          "377: #ifdef _DEBUG",
          "378:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "374:  FILEVERSION 2,18,1229,0",
          "375:  PRODUCTVERSION 2,18,1229,0",
          "",
          "[Added Lines]",
          "374:  FILEVERSION 2,18,1230,0",
          "375:  PRODUCTVERSION 2,18,1230,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "389:         BEGIN",
          "390:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "391:             VALUE \"FileDescription\", \"Rufus\"",
          "393:             VALUE \"InternalName\", \"Rufus\"",
          "394:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "395:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "396:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "397:             VALUE \"ProductName\", \"Rufus\"",
          "399:         END",
          "400:     END",
          "401:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1229\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1229\"",
          "",
          "[Added Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1230\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1230\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e1e7d88d381f1776201c9bcd268dfe8cc99a016b",
      "candidate_info": {
        "commit_hash": "e1e7d88d381f1776201c9bcd268dfe8cc99a016b",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/e1e7d88d381f1776201c9bcd268dfe8cc99a016b",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Persian translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "11103: ################################################################################",
          "11104: l \"fa-IR\" \"Persian (\u0641\u0627\u0631\u0633\u06cc)\" 0x0429",
          "11105: a \"r\"",
          "11107: b \"en-US\"",
          "11109: # Main dialog",
          "",
          "[Removed Lines]",
          "11106: v 1.0.20",
          "",
          "[Added Lines]",
          "11106: v 1.0.21",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11646: t MSG_284 \"\u0641\u0627\u06cc\u0644 \u0627\u062c\u0631\u0627\u06cc\u06cc \u062f\u0627\u0646\u0644\u0648\u062f \u0634\u062f\u0647 \u0627\u0645\u0636\u0627\u06cc \u062f\u06cc\u062c\u06cc\u062a\u0627\u0644 \u0646\u062f\u0627\u0631\u062f.\"",
          "11647: t MSG_285 \"\u0627\u06cc\u0646 \u0641\u0627\u06cc\u0644 \u0627\u062c\u0631\u0627\u06cc\u06cc \u062f\u0627\u0646\u0644\u0648\u062f \u0634\u062f\u0647\u060c \u062a\u0648\u0633\u0637 '%s' \u0627\u0645\u0636\u0627 \u0634\u062f\u0647 \u0627\u0633\u062a.\\n \u0645\u0627 \u0627\u06cc\u0646 \u0627\u0645\u0636\u0627 \u0631\u0627 \u0646\u0645\u06cc\u200c\u0634\u0646\u0627\u0633\u06cc\u0645 \u0648 \"",
          "11648:  \"\u0646\u0627\u0634\u0646\u0627\u0633 \u0628\u0648\u062f\u0646 \u0622\u0646 \u0645\u0645\u06a9\u0646 \u0627\u0633\u062a \u0646\u0634\u0627\u0646\u0647 \u0646\u0648\u0639\u06cc \u0641\u0639\u0627\u0644\u06cc\u062a \u062e\u0631\u0627\u0628\u06a9\u0627\u0631\u0627\u0646\u0647 \u0628\u0627\u0634\u062f...\\n\u0622\u06cc\u0627 \u0645\u0637\u0645\u0626\u0646 \u0647\u0633\u062a\u06cc\u062f \u0645\u06cc\u200c\u062e\u0648\u0627\u0647\u06cc\u062f \u0627\u06cc\u0646 \u0641\u0627\u06cc\u0644 \u0631\u0627 \u0627\u062c\u0631\u0627 \u06a9\u0646\u06cc\u062f\u061f\"",
          "11652: ################################################################################",
          "11653: l \"pl-PL\" \"Polish (Polski)\" 0x0415",
          "",
          "[Removed Lines]",
          "11649: t MSG_286 \"\u062f\u0631\u062d\u0627\u0644 \u0628\u0627\u0632\u0646\u0648\u064a\u0633\u064a \u062f\u0631\u0627\u064a\u0648 \u0628\u0627 \u062f\u0627\u062f\u0647 \u0635\u0641\u0631\u061b \u062f\u0631\u0635\u062f \u067e\u064a\u0634\u0631\u0641\u062a: %0.1f%%\"",
          "11650: t MSG_287 \"\u0634\u0646\u0627\u0633\u0627\u064a\u064a \u062f\u0631\u0627\u064a\u0648\u0647\u0627\u064a \u063a\u064a\u0631 USB\"",
          "",
          "[Added Lines]",
          "11649: t MSG_286 \"\u062f\u0631\u062d\u0627\u0644 \u0628\u0627\u0632\u0646\u0648\u06cc\u0633\u06cc \u062f\u0631\u0627\u06cc\u0648 \u0628\u0627 \u062f\u0627\u062f\u0647 \u0635\u0641\u0631\u061b \u062f\u0631\u0635\u062f \u067e\u06cc\u0634\u0631\u0641\u062a: %0.1f%%\"",
          "11650: t MSG_287 \"\u0634\u0646\u0627\u0633\u0627\u06cc\u06cc \u062f\u0631\u0627\u06cc\u0648\u0647\u0627\u06cc \u063a\u06cc\u0631 USB\"",
          "11651: t MSG_288 \"\u062f\u0633\u062a\u0631\u0633\u06cc\u200c\u0647\u0627\u06cc \u0633\u0637\u062d \u0628\u0627\u0644\u0627 \u0648\u062c\u0648\u062f \u0646\u062f\u0627\u0631\u062f\"",
          "11652: t MSG_289 \"\u0627\u06cc\u0646 \u0646\u0631\u0645\u200c\u0627\u0641\u0632\u0627\u0631 \u0641\u0642\u0637 \u0628\u0627 \u062f\u0633\u062a\u0631\u0633\u06cc\u200c\u0647\u0627\u06cc \u0633\u0637\u062d \u0628\u0627\u0644\u0627 \u0645\u06cc\u200c\u062a\u0648\u0627\u0646\u062f \u0627\u062c\u0631\u0627 \u0634\u0648\u062f\"",
          "11653: t MSG_290 \"\u0627\u06cc\u0646\u062f\u06a9\u0633 \u06af\u0630\u0627\u0631\u06cc \u0641\u0627\u06cc\u0644\"",
          "11654: t MSG_291 \"\u0627\u0646\u062a\u062e\u0627\u0628 \u0646\u0633\u062e\u0647 (\u0648\u0631\u0698\u0646)\"",
          "11655: t MSG_292 \"\u0644\u0637\u0641\u0627\u064b \u0646\u0633\u062e\u0647 \u0648\u06cc\u0646\u062f\u0648\u0632\u06cc \u0631\u0627 \u06a9\u0647 \u0645\u06cc\u200c\u062e\u0648\u0627\u0647\u06cc\u062f \u0646\u0635\u0628 \u06a9\u0646\u06cc\u062f\u061b \u0627\u0646\u062a\u062e\u0627\u0628 \u06a9\u0646\u06cc\u062f:\"",
          "11656: t MSG_293 \"\u0646\u0633\u062e\u0647 \u0648\u06cc\u0646\u062f\u0648\u0632 \u067e\u0634\u062a\u06cc\u0628\u0627\u0646\u06cc \u0646\u0645\u06cc\u200c\u0634\u0648\u062f\"",
          "11657: t MSG_294 \"Rufus \u062f\u06cc\u06af\u0631 \u0627\u06cc\u0646 \u0646\u0633\u062e\u0647 \u0627\u0632 \u0648\u06cc\u0646\u062f\u0648\u0632 \u0631\u0627 \u067e\u0634\u062a\u06cc\u0628\u0627\u0646\u06cc \u0646\u0645\u06cc\u200c\u06a9\u0646\u062f\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1033\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1034\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1033,0",
          "338:  PRODUCTVERSION 2,12,1033,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1034,0",
          "338:  PRODUCTVERSION 2,12,1034,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1033\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1033\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1034\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1034\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f01043feda1f77ad638be2cabd2dace3f051a02b",
      "candidate_info": {
        "commit_hash": "f01043feda1f77ad638be2cabd2dace3f051a02b",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/f01043feda1f77ad638be2cabd2dace3f051a02b",
        "files": [
          "ChangeLog.txt",
          "res/localization/ChangeLog.txt",
          "res/localization/embedded.sed",
          "res/localization/rufus.loc",
          "src/rufus.h",
          "src/rufus.rc"
        ],
        "message": "[misc] fix minor MinGW warnings\n\n* Also update localization to version 1.0.22",
        "before_after_code_files": [
          "res/localization/embedded.sed||res/localization/embedded.sed",
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.h||src/rufus.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/embedded.sed||res/localization/embedded.sed": [
          "File: res/localization/embedded.sed -> res/localization/embedded.sed",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # This sed script removes everything we don't need from rufus.loc, for embedding.",
          "6: # remove empty lines",
          "7: /^$/d",
          "",
          "[Removed Lines]",
          "3: # remove comments (aggressively!)",
          "4: s/#.*$//",
          "",
          "[Added Lines]",
          "3: # remove comments (but not so aggressively as to drop the end of MSG_298!)",
          "4: s/^#.*$//",
          "5: s/[ \\t]#.*$//",
          "",
          "---------------"
        ],
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "93: # http://download.microsoft.com/download/9/5/E/95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5BMS-LCID%5D.pdf",
          "94: # for the LCID (0x####) codes you should use",
          "95: l \"en-US\" \"English (English)\" 0x0409, 0x0809, 0x0c09, 0x1009, 0x1409, 0x1809, 0x1c09, 0x2009, 0x2409, 0x2809, 0x2c09, 0x3009, 0x3409, 0x3809, 0x3c09, 0x4009, 0x4409, 0x4809",
          "98: # Main dialog",
          "99: g IDD_DIALOG",
          "",
          "[Removed Lines]",
          "96: v 1.0.21",
          "",
          "[Added Lines]",
          "96: v 1.0.22",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "558: t MSG_293 \"Unsupported Windows version\"",
          "559: t MSG_294 \"This version of Windows is no longer supported by Rufus.\"",
          "560: t MSG_295 \"Warning: Unofficial version\"",
          "562: t MSG_297 \"Truncated ISO detected\"",
          "563: t MSG_298 \"The ISO file you have selected does not match its declared size: %s of data is missing!\\n\\nIf you obtained \"",
          "564:  \"this file from the Internet, you should try to download a new copy and verify that the MD5 or SHA checksums match \"",
          "",
          "[Removed Lines]",
          "561: t MSG_296 \"This version of Rufus was NOT produced by its official developer(s).\\n\\nAre you sure you want to run it?\"",
          "",
          "[Added Lines]",
          "561: t MSG_296 \"This version of Rufus was not produced by its official developer(s).\\n\\nAre you sure you want to run it?\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "5120: ################################################################################",
          "5121: l \"fr-FR\" \"French (Fran\u00e7ais)\" 0x040c, 0x080c, 0x0c0c, 0x100c, 0x140c, 0x180c, 0x1c0c, 0x200c, 0x240c, 0x280c, 0x2c0c, 0x300c, 0x340c, 0x380c, 0xe40c",
          "5123: b \"en-US\"",
          "5125: g IDD_DIALOG",
          "",
          "[Removed Lines]",
          "5122: v 1.0.21",
          "",
          "[Added Lines]",
          "5122: v 1.0.22",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "5544: t MSG_292 \"S\u00e9lectionnez la version de Windows que vous souhaitez installer :\"",
          "5545: t MSG_293 \"Version de Windows non support\u00e9e\"",
          "5546: t MSG_294 \"Cette version de Windows n'est plus support\u00e9e par Rufus.\"",
          "5548: ################################################################################",
          "5549: l \"de-DE\" \"German (Deutsch)\" 0x0407, 0x0807, 0x0c07, 0x1007, 0x1407",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5547: t MSG_295 \"Alerte: Version non-officielle\"",
          "5548: t MSG_296 \"Cette version de Rufus n'a pas produite par ses d\u00e9veloppeurs officiels.\\n\\nEtes-vous sur de vouloir la lancer ?\"",
          "5549: t MSG_297 \"ISO tronqu\u00e9e d\u00e9tect\u00e9e\"",
          "5550: t MSG_298 \"Le fichier ISO que vous avez s\u00e9lectionn\u00e9 ne fait pas la bonne taille : %s de donn\u00e9es sont manquantes !\\n\\n\"",
          "5551:  \"Si vous avez obtenu ce fichier depuis Internet, vous devriez essayer de le t\u00e9l\u00e9charger \u00e0 nouveau et verifier que \"",
          "5552:  \"le MD5 ou SHA correspond aux valeurs officielles.\\n\\nNotez que vous pouvez calculer le MD5 ou SHA depuis Rufus en \"",
          "5553:  \"cliquant le bouton '#'.\"",
          "",
          "---------------"
        ],
        "src/rufus.h||src/rufus.h": [
          "File: src/rufus.h -> src/rufus.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "116: #ifdef RUFUS_LOGGING",
          "117: extern void _uprintf(const char *format, ...);",
          "118: #define uprintf(...) _uprintf(__VA_ARGS__)",
          "123: #define ubprintf(...) do { safe_sprintf(&ubuffer[ubuffer_pos], UBUFFER_SIZE - ubuffer_pos - 2, __VA_ARGS__); \\",
          "124:  ubuffer_pos = strlen(ubuffer); ubuffer[ubuffer_pos++] = '\\r'; ubuffer[ubuffer_pos++] = '\\n'; \\",
          "125:  ubuffer[ubuffer_pos] = 0; } while(0)",
          "",
          "[Removed Lines]",
          "119: #define vuprintf(...) if (verbose) _uprintf(__VA_ARGS__)",
          "120: #define vvuprintf(...) if (verbose > 1) _uprintf(__VA_ARGS__)",
          "121: #define suprintf(...) if (!bSilent) _uprintf(__VA_ARGS__)",
          "122: #define uuprintf(...) if (usb_debug) _uprintf(__VA_ARGS__)",
          "",
          "[Added Lines]",
          "119: #define vuprintf(...) do { if (verbose) _uprintf(__VA_ARGS__); } while(0)",
          "120: #define vvuprintf(...) do { if (verbose > 1) _uprintf(__VA_ARGS__); } while(0)",
          "121: #define suprintf(...) do { if (!bSilent) _uprintf(__VA_ARGS__); } while(0)",
          "122: #define uuprintf(...) do { if (usb_debug) _uprintf(__VA_ARGS__); } while(0)",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.16.1127\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.16.1128\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,16,1127,0",
          "370:  PRODUCTVERSION 2,16,1127,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,16,1128,0",
          "370:  PRODUCTVERSION 2,16,1128,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1127\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1127\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1128\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1128\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}