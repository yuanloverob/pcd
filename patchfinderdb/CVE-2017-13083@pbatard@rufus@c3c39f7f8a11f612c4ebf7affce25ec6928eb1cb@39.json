{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "99cfa84a5d267f4cebcd31672f752fbe5f3b1d16",
      "candidate_info": {
        "commit_hash": "99cfa84a5d267f4cebcd31672f752fbe5f3b1d16",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/99cfa84a5d267f4cebcd31672f752fbe5f3b1d16",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Finnish translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "4530: ################################################################################",
          "4531: l \"fi-FI\" \"Finnish (Suomi)\" 0x040B",
          "4533: b \"en-US\"",
          "4535: # Main dialog",
          "4536: g IDD_DIALOG",
          "4537: t IDS_DEVICE_TXT \"Laite\"",
          "4540: t IDS_FILE_SYSTEM_TXT \"Tiedostoj\u00e4rjestelm\u00e4\"",
          "4541: t IDS_CLUSTER_SIZE_TXT \"Tilanvarausyksikk\u00f6\"",
          "4543: t IDS_FORMAT_OPTIONS_TXT \"Alustusasetukset\"",
          "4544: t IDC_BAD_BLOCKS \"Vioittuneiden lohkojen tarkistus\"",
          "4545: t IDC_QUICK_FORMAT \"Pika-alustus\"",
          "4546: t IDC_EXTENDED_LABEL \"Luo laajennetut nimi- ja kuvaketiedostot\"",
          "4547: t IDCANCEL \"Sulje\"",
          "4548: t IDC_START \"Aloita\"",
          "4549: t IDC_LIST_USB_HDD \"N\u00e4yt\u00e4 USB-kiintolevyt\"",
          "4550: t IDC_OLD_BIOS_FIXES \"Lis\u00e4\u00e4 korjauksia vanhoja BIOS-versioita varten\"",
          "4553: # About dialog",
          "4554: g IDD_ABOUTBOX",
          "",
          "[Removed Lines]",
          "4532: v 1.0.22",
          "4538: t IDS_BOOT_SELECTION_TXT \"K\u00e4ynnistystyyppi\"",
          "4539: t IDS_PARTITION_TYPE_TXT \"Osion ja kohdej\u00e4rjestelm\u00e4n tyyppi\"",
          "4542: t IDS_LABEL_TXT \"Uuden aseman nimi\"",
          "4551: t IDC_RUFUS_MBR \"K\u00e4yt\u00e4 Rufus-MBR:\u00e4\u00e4, BIOS ID\"",
          "",
          "[Added Lines]",
          "4532: v 1.0.23",
          "4537: t IDS_DRIVE_PROPERTIES_TXT \"Aseman ominaisuudet\"",
          "4539: t IDS_BOOT_SELECTION_TXT \"Boottaustyypin valinta\"",
          "4540: t IDC_SELECT \"Valitse\"",
          "4541: t IDS_IMAGE_OPTION_TXT \"Levykuvan m\u00e4\u00e4ritys\"",
          "4542: t IDS_PARTITION_TYPE_TXT \"Osion tyyppi\"",
          "4543: t IDS_TARGET_SYSTEM_TXT \"Kohdej\u00e4rjestelm\u00e4\"",
          "4546: t IDS_LABEL_TXT \"Aseman nimi\"",
          "4551: t IDS_STATUS_TXT \"Tila\"",
          "4556: t IDC_RUFUS_MBR \"K\u00e4yt\u00e4 Rufus-MBR:\u00e4\u00e4, BIOS ID:ll\u00e4\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4631: t MSG_029 \"Oletus\"",
          "4632: # The following gets appended to the file system, cluster size, etc.",
          "4633: t MSG_030 \"%s (Oletus)\"",
          "4637: # Number of bad block check passes (singular for 1 pass, plural for 2 or more passes)",
          "4638: t MSG_034 \"%d testi\"",
          "4639: t MSG_035 \"%d testi\u00e4\"",
          "",
          "[Removed Lines]",
          "4634: #t MSG_031 \"%s-osiotyyppi BIOS- tai %s\"",
          "4635: #t MSG_032 \"%s-osiotyyppi BIOS\"",
          "4636: #t MSG_033 \"%s-osiotyyppi UEFI\"",
          "",
          "[Added Lines]",
          "4639: t MSG_031 \"BIOS (tai UEFI-CSM)\"",
          "4640: t MSG_032 \"UEFI (ei-CSM)\"",
          "4641: t MSG_033 \"BIOS tai UEFI\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4774:  \"- Valitse 'Peruuta' peruaksesi toiminnon\\n\\n\"",
          "4775:  \"Huomio: Tiedosto ladataan nykyiseen sovelluskansioon ja sit\u00e4 k\u00e4ytet\u00e4\u00e4n \"",
          "4776:  \"automaattisesti sen l\u00f6ytyess\u00e4. Jos vastaavaa ei l\u00f6ydy verkosta, k\u00e4ytet\u00e4\u00e4n vakioversiota.\"",
          "4777: # Tooltips",
          "4778: # Partition Scheme and Target Type",
          "4785: t MSG_153 \"Testikuvio: 0x%02X\"",
          "4786: t MSG_154 \"Testikuvio: 0x%02X, 0x%02X\"",
          "4787: t MSG_155 \"Testikuvio: 0x%02X, 0x%02X, 0x%02X\"",
          "",
          "[Removed Lines]",
          "4779: t MSG_150 \"Yleens\u00e4 turvallisin vaihtoehto. Jos sinulla kuitenkin on UEFI-tietokone ja haluat asentaa \"",
          "4780:  \"k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n EFI-tilassa, tulisi sinun valita muista vaihtoehdoista\"",
          "4781: t MSG_151 \"K\u00e4yt\u00e4 t\u00e4t\u00e4 asentaessasi k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n EFI-tilassa, kun \"",
          "4782:  \"tarvitset p\u00e4\u00e4syn USB-sis\u00e4lt\u00f6\u00f6n Windows XP:ss\u00e4\"",
          "4783: t MSG_152 \"Suositeltu vaihtoehto k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n asentamiseksi EFI-tilassa, kun \"",
          "4784:  \"USB-p\u00e4\u00e4sy\u00e4 ei tarvita Windows XP:lle\"",
          "",
          "[Added Lines]",
          "4782: t MSG_117 \"Tavanomainen Windowsin asennus\"",
          "4783: t MSG_119 \"aseman lis\u00e4asetukset\"",
          "4784: t MSG_120 \"formatoinnin lis\u00e4asetukset\"",
          "4785: t MSG_121 \"N\u00e4yt\u00e4 %s\"",
          "4786: t MSG_122 \"Piilota %s\"",
          "4789: t MSG_150 \"Tietokoneen tyyppi, jonka kanssa aiot k\u00e4ytt\u00e4\u00e4 asemaa. Sinun on m\u00e4\u00e4ritett\u00e4v\u00e4, onko kohdelaitteesi \"",
          "4790:  \" BIOS- vai UEFI-tyyppinen ennen aseman luomista, sill\u00e4 v\u00e4\u00e4r\u00e4n tyypin valinta voi est\u00e4\u00e4 k\u00e4ynnistymisen.\"",
          "4791: t MSG_151 \"'UEFI-CSM' tarkoittaa, ett\u00e4 laite k\u00e4ynnistyy vain emuloidussa BIOS-tilassa (tunnetaan my\u00f6s nimell\u00e4 'Legacy Mode') UEFIn alaisena eik\u00e4 natiivissa UEFI-tilassa.\"",
          "4792: t MSG_152 \"'ei-CSM' tarkoittaa, ett\u00e4 laite k\u00e4ynnistyy vain natiivissa UEFI-tilassa eik\u00e4 emuloidussa BIOS-tilassa (joka tunnetaan my\u00f6s nimell\u00e4 'Legacy Mode').\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "4792: t MSG_160 \"N\u00e4yt\u00e4 tai piilota lis\u00e4asetukset\"",
          "4793: t MSG_161 \"Tarkista laite testikuviolla vioittuneiden lohkojen varalta\"",
          "4794: t MSG_162 \"Poista valintaruudun valinta k\u00e4ytt\u00e4\u00e4ksesi \\\"hidasta\\\" alustustapaa\"",
          "4795: t MSG_164 \"Tapa, jolla asemasta tehd\u00e4\u00e4n boottaava\"",
          "4796: t MSG_165 \"Paina valitaksesi levykuva...\"",
          "4797: t MSG_166 \"Valitse valintaruutu salliaksesi kansainv\u00e4listen merkkien n\u00e4ytt\u00e4misen \"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4803: t MSG_163 \"Tapa, jota k\u00e4ytet\u00e4\u00e4n osioiden luomiseen\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "4939:  \"Valitse tila, jota haluat k\u00e4ytt\u00e4\u00e4 levykuvan kirjoittamiseen:\"",
          "4940: t MSG_276 \"Kirjoita %sna (Suositellaan)\"",
          "4941: t MSG_277 \"Kirjoita %sna\"",
          "4942: t MSG_279 \"Ei-boottaava\"",
          "4945: t MSG_282 \"USB-aseman eksklusiivinen k\u00e4ytt\u00f6\"",
          "4946: t MSG_283 \"Ep\u00e4kelpo allekirjoitus\"",
          "4947: t MSG_284 \"Ladatusta tiedostosta puuttuu digitaalinen allekirjoitus.\"",
          "",
          "[Removed Lines]",
          "4943: t MSG_280 \"Levykuvan valinta\"",
          "4944: t MSG_281 \"(Valitse levykuva)\"",
          "",
          "[Added Lines]",
          "4951: t MSG_278 \"Tarkistetaan ristiriidassa olevien prosessien varalta...\"",
          "4953: t MSG_280 \"Levy tai ISO-levykuva\"",
          "4954: t MSG_281 \"%s (Ole hyv\u00e4 ja valitse)\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "4962: t MSG_298 \"Valitsemasi ISO-levykuva ei vastaa sen ilmoittamaa tiedostokokoa: %s ohjelmatiedosta puuttuu!\\n\\nJos latasit \"",
          "4963:  \"t\u00e4m\u00e4n tiedoston internetist\u00e4, yrit\u00e4 ladata tiedosto uudelleen ja varmista, ett\u00e4 MD5- tai SHA-tarkistussumma t\u00e4sm\u00e4\u00e4 \"",
          "4964:  \"alkuper\u00e4isen summan kanssa.\\n\\nVoit laskea MD5- tai SHA-tarkistussumman Rufuksessa painamalla '#'-painiketta.\"",
          "4967: ################################################################################",
          "4968: l \"fr-FR\" \"French (Fran\u00e7ais)\" 0x040c, 0x080c, 0x0c0c, 0x100c, 0x140c, 0x180c, 0x1c0c, 0x200c, 0x240c, 0x280c, 0x2c0c, 0x300c, 0x340c, 0x380c, 0xe40c",
          "",
          "[Removed Lines]",
          "4965: t MSG_117 \"Tavanomainen Windowsin asennus\"",
          "",
          "[Added Lines]",
          "4975: t MSG_299 \"Aikaleiman vahvistusvirhe\"",
          "4976: t MSG_300 \"Rufus ei pystynyt varmistamaan, ett\u00e4 ladatun p\u00e4ivityksen aikaleima on nykyist\u00e4 tiedostoa uudempi.\\n\\nMahdollisten \"",
          "4977:  \"hy\u00f6kk\u00e4ysmahdollisuuksien est\u00e4miseksi p\u00e4ivitysprosessi on keskeytetty ja lataus tullaan poistamaan. \"",
          "4978:  \"Lis\u00e4tietoja tapahtumasta l\u00f6ytyy Rufuksen lokista.\"",
          "4979: t MSG_301 \"N\u00e4yt\u00e4 sovelluksen asetukset\"",
          "4980: t MSG_302 \"N\u00e4yt\u00e4 tietoa t\u00e4st\u00e4 sovelluksesta\"",
          "4981: t MSG_303 \"N\u00e4yt\u00e4 loki\"",
          "4982: t MSG_304 \"Luo levykuva valitusta laitteesta\"",
          "4983: t MSG_305 \"K\u00e4yt\u00e4 t\u00e4t\u00e4 vaihtoehtoa valitaksesi haluatko k\u00e4ytt\u00e4\u00e4 valittua laitetta Windowsin asentamiseen toiselle levylle, \"",
          "4984:  \"vai haluatko k\u00e4ytt\u00e4\u00e4 Windowsia suoraan t\u00e4lt\u00e4 asemalta (Windows To Go).\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1243\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1244\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "373: VS_VERSION_INFO VERSIONINFO",
          "376:  FILEFLAGSMASK 0x3fL",
          "377: #ifdef _DEBUG",
          "378:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "374:  FILEVERSION 2,18,1243,0",
          "375:  PRODUCTVERSION 2,18,1243,0",
          "",
          "[Added Lines]",
          "374:  FILEVERSION 2,18,1244,0",
          "375:  PRODUCTVERSION 2,18,1244,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "389:         BEGIN",
          "390:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "391:             VALUE \"FileDescription\", \"Rufus\"",
          "393:             VALUE \"InternalName\", \"Rufus\"",
          "394:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "395:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "396:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "397:             VALUE \"ProductName\", \"Rufus\"",
          "399:         END",
          "400:     END",
          "401:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1243\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1243\"",
          "",
          "[Added Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1244\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1244\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "645184f11e45d2ac76f0e608598bed6f106164c0",
      "candidate_info": {
        "commit_hash": "645184f11e45d2ac76f0e608598bed6f106164c0",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/645184f11e45d2ac76f0e608598bed6f106164c0",
        "files": [
          "src/localization.c",
          "src/rufus.rc",
          "src/stdfn.c"
        ],
        "message": "[ui] fix some unwanted display of LTR or RTL strings\n\n* Some English messages could appear RTL in the log\n* Folder paths with RTL strings could appear scrambled in the UI",
        "before_after_code_files": [
          "src/localization.c||src/localization.c",
          "src/rufus.rc||src/rufus.rc",
          "src/stdfn.c||src/stdfn.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/localization.c||src/localization.c": [
          "File: src/localization.c -> src/localization.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "380:  if (format == NULL) {",
          "381:   safe_sprintf(buf[buf_id], LOC_MESSAGE_SIZE-1, \"MSG_%03d UNTRANSLATED\", msg_id - MSG_000);",
          "382:  } else {",
          "384:    if (is_rtf) {",
          "385:     safe_strcpy(&buf[buf_id][pos], LOC_MESSAGE_SIZE - 1, \"\\\\rtlch\");",
          "386:     pos += 6;",
          "",
          "[Removed Lines]",
          "383:   if (right_to_left_mode) {",
          "",
          "[Added Lines]",
          "383:   if (right_to_left_mode && (msg_table != default_msg_table)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391:   va_start(args, msg_id);",
          "392:   safe_vsnprintf(&buf[buf_id][pos], LOC_MESSAGE_SIZE- 1 - 2*pos, format, args);",
          "393:   va_end(args);",
          "395:    safe_strcat(buf[buf_id], LOC_MESSAGE_SIZE - 1, POP_DIRECTIONAL_FORMATTING);",
          "396:    if (is_rtf)",
          "397:     safe_strcat(buf[buf_id], LOC_MESSAGE_SIZE - 1, \"\\\\ltrch\");",
          "",
          "[Removed Lines]",
          "394:   if (right_to_left_mode) {",
          "",
          "[Added Lines]",
          "394:   if (right_to_left_mode && (msg_table != default_msg_table)) {",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.1.1311\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.1.1312\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,1,1311,0",
          "393:  PRODUCTVERSION 3,1,1311,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,1,1312,0",
          "393:  PRODUCTVERSION 3,1,1312,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1311\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1311\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1312\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1312\"",
          "",
          "---------------"
        ],
        "src/stdfn.c||src/stdfn.c": [
          "File: src/stdfn.c -> src/stdfn.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "463:  HANDLE handle;",
          "464:  BOOL r;",
          "465:  BOOL ret = FALSE;",
          "468:  sid = GetSID();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "466:  char* ltr_path;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "505:   goto out;",
          "506:  }",
          "509:  ret = TRUE;",
          "511: out:",
          "",
          "[Removed Lines]",
          "508:  PrintInfoDebug(0, save?MSG_216:MSG_215, path);",
          "",
          "[Added Lines]",
          "511:  ltr_path = malloc(safe_strlen(path) + sizeof(LEFT_TO_RIGHT_EMBEDDING) + sizeof(POP_DIRECTIONAL_FORMATTING));",
          "512:  if (ltr_path == NULL) {",
          "513:   PrintInfoDebug(0, save ? MSG_216 : MSG_215, path);",
          "514:  } else {",
          "515:   sprintf(ltr_path, \"%s%s%s\", LEFT_TO_RIGHT_EMBEDDING, path, POP_DIRECTIONAL_FORMATTING);",
          "516:   PrintInfoDebug(0, save ? MSG_216 : MSG_215, ltr_path);",
          "517:   free(ltr_path);",
          "518:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ee453b00888cda890f1dda8844627f63c0666a4e",
      "candidate_info": {
        "commit_hash": "ee453b00888cda890f1dda8844627f63c0666a4e",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/ee453b00888cda890f1dda8844627f63c0666a4e",
        "files": [
          "res/freedos/COMMAND.COM",
          "res/freedos/DISPLAY.EXE",
          "res/freedos/EGA.CPX",
          "res/freedos/EGA10.CPX",
          "res/freedos/EGA11.CPX",
          "res/freedos/EGA12.CPX",
          "res/freedos/EGA13.CPX",
          "res/freedos/EGA14.CPX",
          "res/freedos/EGA15.CPX",
          "res/freedos/EGA16.CPX",
          "res/freedos/EGA17.CPX",
          "res/freedos/EGA18.CPX",
          "res/freedos/EGA2.CPX",
          "res/freedos/EGA3.CPX",
          "res/freedos/EGA4.CPX",
          "res/freedos/EGA5.CPX",
          "res/freedos/EGA6.CPX",
          "res/freedos/EGA7.CPX",
          "res/freedos/EGA8.CPX",
          "res/freedos/EGA9.CPX",
          "res/freedos/KERNEL.SYS",
          "res/freedos/MODE.COM",
          "res/freedos/readme.txt",
          "src/dos.c",
          "src/rufus.rc"
        ],
        "message": "[dos] update FreeDOS\n\n* Also capitalize some files to match the FreeDOS archives.",
        "before_after_code_files": [
          "src/dos.c||src/dos.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/dos.c||src/dos.c": [
          "File: src/dos.c -> src/dos.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "352: BOOL ExtractFreeDOS(const char* path)",
          "353: {",
          "354:  const char* res_name[] = { \"COMMAND.COM\", \"KERNEL.SYS\", \"DISPLAY.EXE\", \"KEYB.EXE\",",
          "360:  const int res_id[ARRAYSIZE(res_name)] = { IDR_FD_COMMAND_COM, IDR_FD_KERNEL_SYS, IDR_FD_DISPLAY_EXE, IDR_FD_KEYB_EXE,",
          "361:   IDR_FD_MODE_COM, IDR_FD_KB1_SYS, IDR_FD_KB2_SYS, IDR_FD_KB3_SYS, IDR_FD_KB4_SYS, IDR_FD_EGA1_CPX,",
          "362:   IDR_FD_EGA2_CPX, IDR_FD_EGA3_CPX, IDR_FD_EGA4_CPX, IDR_FD_EGA5_CPX, IDR_FD_EGA6_CPX,",
          "",
          "[Removed Lines]",
          "355:   \"MODE.COM\", \"KEYBOARD.SYS\", \"KEYBRD2.SYS\", \"KEYBRD3.SYS\", \"KEYBRD4.SYS\", \"ega.cpx\",",
          "356:   \"ega2.cpx\", \"ega3.cpx\", \"ega4.cpx\", \"ega5.cpx\", \"ega6.cpx\",",
          "357:   \"ega7.cpx\", \"ega8.cpx\", \"ega9.cpx\", \"ega10.cpx\", \"ega11.cpx\",",
          "358:   \"ega12.cpx\", \"ega13.cpx\", \"ega14.cpx\", \"ega15.cpx\", \"ega16.cpx\",",
          "359:   \"ega17.cpx\", \"ega18.cpx\" };",
          "",
          "[Added Lines]",
          "355:   \"MODE.COM\", \"KEYBOARD.SYS\", \"KEYBRD2.SYS\", \"KEYBRD3.SYS\", \"KEYBRD4.SYS\", \"EGA.CPX\",",
          "356:   \"EGA2.CPX\", \"EGA3.CPX\", \"EGA4.CPX\", \"EGA5.CPX\", \"EGA6.CPX\",",
          "357:   \"EGA7.CPX\", \"EGA8.CPX\", \"EGA9.CPX\", \"EGA10.CPX\", \"EGA11.CPX\",",
          "358:   \"EGA12.CPX\", \"EGA13.CPX\", \"EGA14.CPX\", \"EGA15.CPX\", \"EGA16.CPX\",",
          "359:   \"EGA17.CPX\", \"EGA18.CPX\" };",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1019\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1020\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "247:     \"IDR_FD_KB2_SYS          RCDATA                  \"\"../res/freedos/KEYBRD2.SYS\"\"\\r\\n\"",
          "248:     \"IDR_FD_KB3_SYS          RCDATA                  \"\"../res/freedos/KEYBRD3.SYS\"\"\\r\\n\"",
          "249:     \"IDR_FD_KB4_SYS          RCDATA                  \"\"../res/freedos/KEYBRD4.SYS\"\"\\r\\n\"",
          "268:     \"IDR_XT_HOGGER           RCDATA                  \"\"../res/hogger/hogger.exe\"\"\\r\\n\"",
          "269:     \"IDR_UEFI_NTFS           RCDATA                  \"\"../res/uefi/uefi-ntfs.img\"\"\\r\\n\"",
          "270:     \"IDR_TOGO_SAN_POLICY_XML RCDATA                  \"\"../res/togo/san_policy.xml\"\"\\r\\n\"",
          "",
          "[Removed Lines]",
          "250:     \"IDR_FD_EGA1_CPX         RCDATA                  \"\"../res/freedos/ega.cpx\"\"\\r\\n\"",
          "251:     \"IDR_FD_EGA2_CPX         RCDATA                  \"\"../res/freedos/ega2.cpx\"\"\\r\\n\"",
          "252:     \"IDR_FD_EGA3_CPX         RCDATA                  \"\"../res/freedos/ega3.cpx\"\"\\r\\n\"",
          "253:     \"IDR_FD_EGA4_CPX         RCDATA                  \"\"../res/freedos/ega4.cpx\"\"\\r\\n\"",
          "254:     \"IDR_FD_EGA5_CPX         RCDATA                  \"\"../res/freedos/ega5.cpx\"\"\\r\\n\"",
          "255:     \"IDR_FD_EGA6_CPX         RCDATA                  \"\"../res/freedos/ega6.cpx\"\"\\r\\n\"",
          "256:     \"IDR_FD_EGA7_CPX         RCDATA                  \"\"../res/freedos/ega7.cpx\"\"\\r\\n\"",
          "257:     \"IDR_FD_EGA8_CPX         RCDATA                  \"\"../res/freedos/ega8.cpx\"\"\\r\\n\"",
          "258:     \"IDR_FD_EGA9_CPX         RCDATA                  \"\"../res/freedos/ega9.cpx\"\"\\r\\n\"",
          "259:     \"IDR_FD_EGA10_CPX        RCDATA                  \"\"../res/freedos/ega10.cpx\"\"\\r\\n\"",
          "260:     \"IDR_FD_EGA11_CPX        RCDATA                  \"\"../res/freedos/ega11.cpx\"\"\\r\\n\"",
          "261:     \"IDR_FD_EGA12_CPX        RCDATA                  \"\"../res/freedos/ega12.cpx\"\"\\r\\n\"",
          "262:     \"IDR_FD_EGA13_CPX        RCDATA                  \"\"../res/freedos/ega13.cpx\"\"\\r\\n\"",
          "263:     \"IDR_FD_EGA14_CPX        RCDATA                  \"\"../res/freedos/ega14.cpx\"\"\\r\\n\"",
          "264:     \"IDR_FD_EGA15_CPX        RCDATA                  \"\"../res/freedos/ega15.cpx\"\"\\r\\n\"",
          "265:     \"IDR_FD_EGA16_CPX        RCDATA                  \"\"../res/freedos/ega16.cpx\"\"\\r\\n\"",
          "266:     \"IDR_FD_EGA17_CPX        RCDATA                  \"\"../res/freedos/ega17.cpx\"\"\\r\\n\"",
          "267:     \"IDR_FD_EGA18_CPX        RCDATA                  \"\"../res/freedos/ega18.cpx\"\"\\r\\n\"",
          "",
          "[Added Lines]",
          "250:     \"IDR_FD_EGA1_CPX         RCDATA                  \"\"../res/freedos/EGA.CPX\"\"\\r\\n\"",
          "251:     \"IDR_FD_EGA2_CPX         RCDATA                  \"\"../res/freedos/EGA2.CPX\"\"\\r\\n\"",
          "252:     \"IDR_FD_EGA3_CPX         RCDATA                  \"\"../res/freedos/EGA3.CPX\"\"\\r\\n\"",
          "253:     \"IDR_FD_EGA4_CPX         RCDATA                  \"\"../res/freedos/EGA4.CPX\"\"\\r\\n\"",
          "254:     \"IDR_FD_EGA5_CPX         RCDATA                  \"\"../res/freedos/EGA5.CPX\"\"\\r\\n\"",
          "255:     \"IDR_FD_EGA6_CPX         RCDATA                  \"\"../res/freedos/EGA6.CPX\"\"\\r\\n\"",
          "256:     \"IDR_FD_EGA7_CPX         RCDATA                  \"\"../res/freedos/EGA7.CPX\"\"\\r\\n\"",
          "257:     \"IDR_FD_EGA8_CPX         RCDATA                  \"\"../res/freedos/EGA8.CPX\"\"\\r\\n\"",
          "258:     \"IDR_FD_EGA9_CPX         RCDATA                  \"\"../res/freedos/EGA9.CPX\"\"\\r\\n\"",
          "259:     \"IDR_FD_EGA10_CPX        RCDATA                  \"\"../res/freedos/EGA10.CPX\"\"\\r\\n\"",
          "260:     \"IDR_FD_EGA11_CPX        RCDATA                  \"\"../res/freedos/EGA11.CPX\"\"\\r\\n\"",
          "261:     \"IDR_FD_EGA12_CPX        RCDATA                  \"\"../res/freedos/EGA12.CPX\"\"\\r\\n\"",
          "262:     \"IDR_FD_EGA13_CPX        RCDATA                  \"\"../res/freedos/EGA13.CPX\"\"\\r\\n\"",
          "263:     \"IDR_FD_EGA14_CPX        RCDATA                  \"\"../res/freedos/EGA14.CPX\"\"\\r\\n\"",
          "264:     \"IDR_FD_EGA15_CPX        RCDATA                  \"\"../res/freedos/EGA15.CPX\"\"\\r\\n\"",
          "265:     \"IDR_FD_EGA16_CPX        RCDATA                  \"\"../res/freedos/EGA16.CPX\"\"\\r\\n\"",
          "266:     \"IDR_FD_EGA17_CPX        RCDATA                  \"\"../res/freedos/EGA17.CPX\"\"\\r\\n\"",
          "267:     \"IDR_FD_EGA18_CPX        RCDATA                  \"\"../res/freedos/EGA18.CPX\"\"\\r\\n\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1019,0",
          "338:  PRODUCTVERSION 2,12,1019,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1020,0",
          "338:  PRODUCTVERSION 2,12,1020,0",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1019\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1019\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1020\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1020\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "868eea50697c2b617015c687ff374ed33e7e5693",
      "candidate_info": {
        "commit_hash": "868eea50697c2b617015c687ff374ed33e7e5693",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/868eea50697c2b617015c687ff374ed33e7e5693",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] fix Spanish translation",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "15821:  \"el tiempo estimado de formateo es %d:%02d, durante el cual la barra de progreso parecer\u00e1 no moverse. \"",
          "15822:  \"\u00a1Por favor, sea paciente!\"",
          "15823: t MSG_113 \"Volumen UDF de gran tama\u00f1o\"",
          "15827:  \"- Elije 'Si' para conectarse a internet y descargar estos ficheros\\n\"",
          "15828:  \"- Elije 'No' para cancelar la operaci\u00f3n\\n\\n\"",
          "15830: t MSG_115 \"Descarga requerida\"",
          "15834:  \"se adecue con el de su imagen ISO:\\n\"",
          "15835:  \"- Elija 'Si' para conectarse a internet e intentar descargarlo\\n\"",
          "15836:  \"- Elija 'No' para usar la versi\u00f3n por defecto de Rufus\\n\"",
          "",
          "[Removed Lines]",
          "15824: t MSG_114 \"Esta imagen usa Syslinux %s%s pero este programa s\u00f3lo incluye los ficheros de instalaci\u00f3n para\"",
          "15825: \"Syslinux %s%s. \\n\\n Debido a que las nuevas versiones de Syslinux no son compatibles entre si, y no es posible\"",
          "15826: \"para Rufus incluirlas todas, se deben descargar dos ficheros adicionales de internet ('ldlinux.sys' y 'ldlinux.bss'):\\n\"7",
          "15829:  \"Nota: Los ficheros se descargar\u00e1n en la carpeta actual y volver\u00e1n a usarse autom\u00e1ticamente si se encuentran. \\n\"",
          "15831: t MSG_116 \"Esta imagen hace uso de Grub %s pero este programa s\u00f3lo incluye los ficheros de instalaci\u00f3n para\"",
          "15832:  \"Grub %s.\\n\\n Debido a que las diferentes versiones de Grub no son compatibles entre s\u00ed, y no es posible\"",
          "15833:  \"incluir todas, Rufus intentar\u00e1 encontrar una versi\u00f3n del fichero de instalaci\u00f3n de Grub 'core.img' que\"",
          "",
          "[Added Lines]",
          "15824: t MSG_114 \"Esta imagen usa Syslinux %s%s pero este programa s\u00f3lo incluye los ficheros de instalaci\u00f3n para \"",
          "15825:  \"Syslinux %s%s.\\n\\nDebido a que las nuevas versiones de Syslinux no son compatibles entre si, y no es posible \"",
          "15826:  \"para Rufus incluirlas todas, se deben descargar dos ficheros adicionales de internet ('ldlinux.sys' y 'ldlinux.bss'):\\n\"",
          "15829:  \"Nota: Los ficheros se descargar\u00e1n en la carpeta actual y volver\u00e1n a usarse autom\u00e1ticamente si se encuentran.\"",
          "15831: t MSG_116 \"Esta imagen hace uso de Grub %s pero este programa s\u00f3lo incluye los ficheros de instalaci\u00f3n para \"",
          "15832:  \"Grub %s.\\n\\nDebido a que las diferentes versiones de Grub no son compatibles entre s\u00ed, y no es posible \"",
          "15833:  \"incluir todas, Rufus intentar\u00e1 encontrar una versi\u00f3n del fichero de instalaci\u00f3n de Grub 'core.img' que \"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.17.1182\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.17.1183\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,17,1182,0",
          "370:  PRODUCTVERSION 2,17,1182,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,17,1183,0",
          "370:  PRODUCTVERSION 2,17,1183,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.17.1182\"",
          "393:             VALUE \"ProductVersion\", \"2.17.1182\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.17.1183\"",
          "393:             VALUE \"ProductVersion\", \"2.17.1183\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "63eb747cdea03b9e43a39c266be24a5969c8873f",
      "candidate_info": {
        "commit_hash": "63eb747cdea03b9e43a39c266be24a5969c8873f",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/63eb747cdea03b9e43a39c266be24a5969c8873f",
        "files": [
          "src/iso.c",
          "src/parser.c",
          "src/rufus.rc"
        ],
        "message": "[iso] make the lookup for updatable .cfg file more generic\n\n* For ESET and other ISOs, such as Arch derivatives\n* Closes #1013",
        "before_after_code_files": [
          "src/iso.c||src/iso.c",
          "src/parser.c||src/parser.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/iso.c||src/iso.c": [
          "File: src/iso.c -> src/iso.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "57: uint32_t GetInstallWimVersion(const char* iso);",
          "59: typedef struct {",
          "60:  BOOLEAN is_syslinux_cfg;",
          "61:  BOOLEAN is_grub_cfg;",
          "63:  BOOLEAN is_old_c32[NB_OLD_C32];",
          "64: } EXTRACT_PROPS;",
          "",
          "[Removed Lines]",
          "62:  BOOLEAN is_arch_cfg;",
          "",
          "[Added Lines]",
          "60:  BOOLEAN is_cfg;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "83: static const char* grub_dirname = \"/boot/grub/i386-pc\";",
          "84: static const char* grub_cfg = \"grub.cfg\";",
          "85: static const char* syslinux_cfg[] = { \"isolinux.cfg\", \"syslinux.cfg\", \"extlinux.conf\" };",
          "87: static const char* isolinux_bin[] = { \"isolinux.bin\", \"boot.bin\" };",
          "88: static const char* pe_dirname[] = { \"/i386\", \"/minint\" };",
          "89: static const char* pe_file[] = { \"ntdetect.com\", \"setupldr.bin\", \"txtsetup.sif\" };",
          "",
          "[Removed Lines]",
          "86: static const char* arch_cfg[] = { \"archiso_sys.cfg\", \"archiso_sys32.cfg\", \"archiso_sys64.cfg\" };",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "144: static BOOL check_iso_props(const char* psz_dirname, int64_t i_file_length, const char* psz_basename,",
          "145:  const char* psz_fullpath, EXTRACT_PROPS *props)",
          "146: {",
          "149:  memset(props, 0, sizeof(EXTRACT_PROPS));",
          "150:  for (i=0; i<ARRAYSIZE(syslinux_cfg); i++) {",
          "151:   if (safe_stricmp(psz_basename, syslinux_cfg[i]) == 0) {",
          "152:    props->is_syslinux_cfg = TRUE;",
          "153:    if ((scan_only) && (i == 1) && (safe_stricmp(psz_dirname, efi_dirname) == 0))",
          "154:     img_report.has_efi_syslinux = TRUE;",
          "",
          "[Removed Lines]",
          "147:  size_t i, j;",
          "",
          "[Added Lines]",
          "146:  size_t i, j, len;",
          "151:    props->is_cfg = TRUE; // Required for \"extlinux.conf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "161:    props->is_old_c32[i] = TRUE;",
          "162:  }",
          "165:  if (!scan_only) {",
          "171:  }",
          "",
          "[Removed Lines]",
          "166:   for (i = 0; i<ARRAYSIZE(arch_cfg); i++) {",
          "167:    if (safe_stricmp(psz_basename, arch_cfg[i]) == 0) {",
          "168:     props->is_arch_cfg = TRUE;",
          "169:    }",
          "170:   }",
          "",
          "[Added Lines]",
          "166:   len = safe_strlen(psz_basename);",
          "167:   if ((len >= 4) && safe_stricmp(&psz_basename[len-4], \".cfg\") == 0)",
          "168:    props->is_cfg = TRUE;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "280:   iso_label = replace_char(img_report.label, ' ', \"\\\\x20\");",
          "281:   usb_label = replace_char(img_report.usb_label, ' ', \"\\\\x20\");",
          "282:   if ((iso_label != NULL) && (usb_label != NULL)) {",
          "",
          "[Removed Lines]",
          "279:  if ((props->is_syslinux_cfg) || (props->is_grub_cfg) || (props->is_arch_cfg)) {",
          "",
          "[Added Lines]",
          "277:  if (props->is_cfg) {",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "470:    ISO_BLOCKING(safe_closehandle(file_handle));",
          "472:     fix_config(psz_sanpath, psz_path, psz_basename, &props);",
          "473:    safe_free(psz_sanpath);",
          "474:   }",
          "",
          "[Removed Lines]",
          "471:    if (props.is_syslinux_cfg || props.is_grub_cfg || props.is_arch_cfg)",
          "",
          "[Added Lines]",
          "469:    if (props.is_cfg)",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "614:      uprintf(\"  Could not set timestamp: %s\", WindowsErrorString());",
          "615:    }",
          "616:    ISO_BLOCKING(safe_closehandle(file_handle));",
          "618:     fix_config(psz_sanpath, psz_path, psz_basename, &props);",
          "619:    safe_free(psz_sanpath);",
          "620:   }",
          "",
          "[Removed Lines]",
          "617:    if (props.is_syslinux_cfg || props.is_grub_cfg || props.is_arch_cfg)",
          "",
          "[Added Lines]",
          "615:    if (props.is_cfg)",
          "",
          "---------------"
        ],
        "src/parser.c||src/parser.c": [
          "File: src/parser.c -> src/parser.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1131:  }",
          "1133:  if (fread(&bom, sizeof(bom), 1, fd_in) != 1) {",
          "1135:   goto out;",
          "1136:  }",
          "1137:  switch(bom) {",
          "",
          "[Removed Lines]",
          "1134:   uprintf(\"Could not read file '%s'\\n\", filename);",
          "",
          "[Added Lines]",
          "1134:   if (!feof(fd_in))",
          "1135:    uprintf(\"Could not read file '%s'\\n\", filename);",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.18.1208\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.18.1209\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,18,1208,0",
          "370:  PRODUCTVERSION 2,18,1208,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,18,1209,0",
          "370:  PRODUCTVERSION 2,18,1209,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.18.1208\"",
          "393:             VALUE \"ProductVersion\", \"2.18.1208\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.18.1209\"",
          "393:             VALUE \"ProductVersion\", \"2.18.1209\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}