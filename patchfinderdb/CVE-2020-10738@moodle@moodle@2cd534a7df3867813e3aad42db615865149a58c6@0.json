{
  "cve_id": "CVE-2020-10738",
  "cve_desc": "A flaw was found in Moodle versions 3.8 before 3.8.3, 3.7 before 3.7.6, 3.6 before 3.6.10, 3.5 before 3.5.12 and earlier unsupported versions. It was possible to create a SCORM package in such a way that when added to a course, it could be interacted with via web services in order to achieve remote code execution.",
  "repo": "moodle/moodle",
  "patch_hash": "2cd534a7df3867813e3aad42db615865149a58c6",
  "patch_info": {
    "commit_hash": "2cd534a7df3867813e3aad42db615865149a58c6",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/2cd534a7df3867813e3aad42db615865149a58c6",
    "files": [
      "mod/scorm/lang/en/scorm.php",
      "mod/scorm/locallib.php"
    ],
    "message": "MDL-68410 mod_scorm: safer status operator comparison.",
    "before_after_code_files": [
      "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
      "mod/scorm/locallib.php||mod/scorm/locallib.php"
    ]
  },
  "patch_diff": {
    "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php": [
      "File: mod/scorm/lang/en/scorm.php -> mod/scorm/lang/en/scorm.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "244: $string['trackweight_help'] = 'Weight assigned to the question when calculating score.';",
      "245: $string['invalidactivity'] = 'SCORM activity is incorrect';",
      "246: $string['invalidmanifestname'] = 'Only imsmanifest.xml or .zip files may be selected';",
      "247: $string['invalidurl'] = 'Invalid URL specified';",
      "248: $string['invalidurlhttpcheck'] = 'Invalid URL specified. Debug message:<pre>{$a->cmsg}</pre>';",
      "249: $string['invalidhacpsession'] = 'Invalid HACP session';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "247: $string['invalidstatus'] = 'Invalid status';",
      "",
      "---------------"
    ],
    "mod/scorm/locallib.php||mod/scorm/locallib.php": [
      "File: mod/scorm/locallib.php -> mod/scorm/locallib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1583:                     if (isset($usertracks[$sco->identifier])) {",
      "1584:                         $usertrack = $usertracks[$sco->identifier];",
      "1587:                         if ($sco->scormtype == 'sco') {",
      "1589:                         } else {",
      "1590:                             $statusicon = $OUTPUT->pix_icon('asset', get_string('assetlaunched', 'scorm'), 'scorm');",
      "1591:                         }",
      "",
      "[Removed Lines]",
      "1585:                         $strstatus = get_string($usertrack->status, 'scorm');",
      "1588:                             $statusicon = $OUTPUT->pix_icon($usertrack->status, $strstatus, 'scorm');",
      "",
      "[Added Lines]",
      "1587:                         if ($statusstringexists = get_string_manager()->string_exists($usertrack->status, 'scorm')) {",
      "1588:                             $strstatus = get_string($usertrack->status, 'scorm');",
      "1589:                         } else {",
      "1590:                             $strstatus = get_string('invalidstatus', 'scorm');",
      "1591:                         }",
      "1595:                             $statusicon = $OUTPUT->pix_icon($statusstringexists ? $usertrack->status : 'incomplete',",
      "1596:                                 $strstatus, 'scorm');",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2368:                     if (isset($statuses[$value])) {",
      "2369:                         $value = $statuses[$value];",
      "2370:                     }",
      "2371:                     if ($matches[2] == '<>') {",
      "2373:                     } else {",
      "2375:                     }",
      "2377:                 } else {",
      "2378:                     $element = 'false';",
      "2379:                 }",
      "",
      "[Removed Lines]",
      "2372:                         $oper = '!=';",
      "2374:                         $oper = '==';",
      "2376:                     $element = '(\\''.$usertracks[$element]->status.'\\' '.$oper.' \\''.$value.'\\')';",
      "",
      "[Added Lines]",
      "2380:                     $elementprerequisitematch = (strcmp($usertracks[$element]->status, $value) == 0);",
      "2382:                         $element = $elementprerequisitematch ? 'false' : 'true';",
      "2384:                         $element = $elementprerequisitematch ? 'true' : 'false';",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "041ecef9febac47d2a0d597e3d3b14f1bc14e541",
      "candidate_info": {
        "commit_hash": "041ecef9febac47d2a0d597e3d3b14f1bc14e541",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/041ecef9febac47d2a0d597e3d3b14f1bc14e541",
        "files": [
          "mod/scorm/lang/en/scorm.php",
          "mod/scorm/locallib.php"
        ],
        "message": "MDL-68410 mod_scorm: safer status operator comparison.",
        "before_after_code_files": [
          "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
          "mod/scorm/locallib.php||mod/scorm/locallib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
            "mod/scorm/locallib.php||mod/scorm/locallib.php"
          ],
          "candidate": [
            "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
            "mod/scorm/locallib.php||mod/scorm/locallib.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php": [
          "File: mod/scorm/lang/en/scorm.php -> mod/scorm/lang/en/scorm.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "239: $string['trackweight_help'] = 'Weight assigned to the question when calculating score.';",
          "240: $string['invalidactivity'] = 'SCORM activity is incorrect';",
          "241: $string['invalidmanifestname'] = 'Only imsmanifest.xml or .zip files may be selected';",
          "242: $string['invalidurl'] = 'Invalid URL specified';",
          "243: $string['invalidurlhttpcheck'] = 'Invalid URL specified. Debug message:<pre>{$a->cmsg}</pre>';",
          "244: $string['invalidhacpsession'] = 'Invalid HACP session';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "242: $string['invalidstatus'] = 'Invalid status';",
          "",
          "---------------"
        ],
        "mod/scorm/locallib.php||mod/scorm/locallib.php": [
          "File: mod/scorm/locallib.php -> mod/scorm/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1583:                     if (isset($usertracks[$sco->identifier])) {",
          "1584:                         $usertrack = $usertracks[$sco->identifier];",
          "1587:                         if ($sco->scormtype == 'sco') {",
          "1589:                         } else {",
          "1590:                             $statusicon = $OUTPUT->pix_icon('asset', get_string('assetlaunched', 'scorm'), 'scorm');",
          "1591:                         }",
          "",
          "[Removed Lines]",
          "1585:                         $strstatus = get_string($usertrack->status, 'scorm');",
          "1588:                             $statusicon = $OUTPUT->pix_icon($usertrack->status, $strstatus, 'scorm');",
          "",
          "[Added Lines]",
          "1587:                         if ($statusstringexists = get_string_manager()->string_exists($usertrack->status, 'scorm')) {",
          "1588:                             $strstatus = get_string($usertrack->status, 'scorm');",
          "1589:                         } else {",
          "1590:                             $strstatus = get_string('invalidstatus', 'scorm');",
          "1591:                         }",
          "1595:                             $statusicon = $OUTPUT->pix_icon($statusstringexists ? $usertrack->status : 'incomplete',",
          "1596:                                 $strstatus, 'scorm');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2368:                     if (isset($statuses[$value])) {",
          "2369:                         $value = $statuses[$value];",
          "2370:                     }",
          "2371:                     if ($matches[2] == '<>') {",
          "2373:                     } else {",
          "2375:                     }",
          "2377:                 } else {",
          "2378:                     $element = 'false';",
          "2379:                 }",
          "",
          "[Removed Lines]",
          "2372:                         $oper = '!=';",
          "2374:                         $oper = '==';",
          "2376:                     $element = '(\\''.$usertracks[$element]->status.'\\' '.$oper.' \\''.$value.'\\')';",
          "",
          "[Added Lines]",
          "2380:                     $elementprerequisitematch = (strcmp($usertracks[$element]->status, $value) == 0);",
          "2382:                         $element = $elementprerequisitematch ? 'false' : 'true';",
          "2384:                         $element = $elementprerequisitematch ? 'true' : 'false';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fadae3cfe950a89dabb2f8ea831cd5d97de21cfc",
      "candidate_info": {
        "commit_hash": "fadae3cfe950a89dabb2f8ea831cd5d97de21cfc",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/fadae3cfe950a89dabb2f8ea831cd5d97de21cfc",
        "files": [
          "mod/scorm/lang/en/scorm.php",
          "mod/scorm/locallib.php"
        ],
        "message": "MDL-68410 mod_scorm: safer status operator comparison.",
        "before_after_code_files": [
          "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
          "mod/scorm/locallib.php||mod/scorm/locallib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
            "mod/scorm/locallib.php||mod/scorm/locallib.php"
          ],
          "candidate": [
            "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
            "mod/scorm/locallib.php||mod/scorm/locallib.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php": [
          "File: mod/scorm/lang/en/scorm.php -> mod/scorm/lang/en/scorm.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "244: $string['trackweight_help'] = 'Weight assigned to the question when calculating score.';",
          "245: $string['invalidactivity'] = 'SCORM activity is incorrect';",
          "246: $string['invalidmanifestname'] = 'Only imsmanifest.xml or .zip files may be selected';",
          "247: $string['invalidurl'] = 'Invalid URL specified';",
          "248: $string['invalidurlhttpcheck'] = 'Invalid URL specified. Debug message:<pre>{$a->cmsg}</pre>';",
          "249: $string['invalidhacpsession'] = 'Invalid HACP session';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "247: $string['invalidstatus'] = 'Invalid status';",
          "",
          "---------------"
        ],
        "mod/scorm/locallib.php||mod/scorm/locallib.php": [
          "File: mod/scorm/locallib.php -> mod/scorm/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1583:                     if (isset($usertracks[$sco->identifier])) {",
          "1584:                         $usertrack = $usertracks[$sco->identifier];",
          "1587:                         if ($sco->scormtype == 'sco') {",
          "1589:                         } else {",
          "1590:                             $statusicon = $OUTPUT->pix_icon('asset', get_string('assetlaunched', 'scorm'), 'scorm');",
          "1591:                         }",
          "",
          "[Removed Lines]",
          "1585:                         $strstatus = get_string($usertrack->status, 'scorm');",
          "1588:                             $statusicon = $OUTPUT->pix_icon($usertrack->status, $strstatus, 'scorm');",
          "",
          "[Added Lines]",
          "1587:                         if ($statusstringexists = get_string_manager()->string_exists($usertrack->status, 'scorm')) {",
          "1588:                             $strstatus = get_string($usertrack->status, 'scorm');",
          "1589:                         } else {",
          "1590:                             $strstatus = get_string('invalidstatus', 'scorm');",
          "1591:                         }",
          "1595:                             $statusicon = $OUTPUT->pix_icon($statusstringexists ? $usertrack->status : 'incomplete',",
          "1596:                                 $strstatus, 'scorm');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2368:                     if (isset($statuses[$value])) {",
          "2369:                         $value = $statuses[$value];",
          "2370:                     }",
          "2371:                     if ($matches[2] == '<>') {",
          "2373:                     } else {",
          "2375:                     }",
          "2377:                 } else {",
          "2378:                     $element = 'false';",
          "2379:                 }",
          "",
          "[Removed Lines]",
          "2372:                         $oper = '!=';",
          "2374:                         $oper = '==';",
          "2376:                     $element = '(\\''.$usertracks[$element]->status.'\\' '.$oper.' \\''.$value.'\\')';",
          "",
          "[Added Lines]",
          "2380:                     $elementprerequisitematch = (strcmp($usertracks[$element]->status, $value) == 0);",
          "2382:                         $element = $elementprerequisitematch ? 'false' : 'true';",
          "2384:                         $element = $elementprerequisitematch ? 'true' : 'false';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "796a7ea458883407346eb831de6aa13ee5470217",
      "candidate_info": {
        "commit_hash": "796a7ea458883407346eb831de6aa13ee5470217",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/796a7ea458883407346eb831de6aa13ee5470217",
        "files": [
          "mod/scorm/lang/en/scorm.php",
          "mod/scorm/locallib.php"
        ],
        "message": "MDL-68410 mod_scorm: safer status operator comparison.",
        "before_after_code_files": [
          "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
          "mod/scorm/locallib.php||mod/scorm/locallib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
            "mod/scorm/locallib.php||mod/scorm/locallib.php"
          ],
          "candidate": [
            "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
            "mod/scorm/locallib.php||mod/scorm/locallib.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php": [
          "File: mod/scorm/lang/en/scorm.php -> mod/scorm/lang/en/scorm.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "239: $string['trackweight_help'] = 'Weight assigned to the question when calculating score.';",
          "240: $string['invalidactivity'] = 'SCORM activity is incorrect';",
          "241: $string['invalidmanifestname'] = 'Only imsmanifest.xml or .zip files may be selected';",
          "242: $string['invalidurl'] = 'Invalid URL specified';",
          "243: $string['invalidurlhttpcheck'] = 'Invalid URL specified. Debug message:<pre>{$a->cmsg}</pre>';",
          "244: $string['invalidhacpsession'] = 'Invalid HACP session';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "242: $string['invalidstatus'] = 'Invalid status';",
          "",
          "---------------"
        ],
        "mod/scorm/locallib.php||mod/scorm/locallib.php": [
          "File: mod/scorm/locallib.php -> mod/scorm/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1583:                     if (isset($usertracks[$sco->identifier])) {",
          "1584:                         $usertrack = $usertracks[$sco->identifier];",
          "1587:                         if ($sco->scormtype == 'sco') {",
          "1589:                         } else {",
          "1590:                             $statusicon = $OUTPUT->pix_icon('asset', get_string('assetlaunched', 'scorm'), 'scorm');",
          "1591:                         }",
          "",
          "[Removed Lines]",
          "1585:                         $strstatus = get_string($usertrack->status, 'scorm');",
          "1588:                             $statusicon = $OUTPUT->pix_icon($usertrack->status, $strstatus, 'scorm');",
          "",
          "[Added Lines]",
          "1587:                         if ($statusstringexists = get_string_manager()->string_exists($usertrack->status, 'scorm')) {",
          "1588:                             $strstatus = get_string($usertrack->status, 'scorm');",
          "1589:                         } else {",
          "1590:                             $strstatus = get_string('invalidstatus', 'scorm');",
          "1591:                         }",
          "1595:                             $statusicon = $OUTPUT->pix_icon($statusstringexists ? $usertrack->status : 'incomplete',",
          "1596:                                 $strstatus, 'scorm');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2368:                     if (isset($statuses[$value])) {",
          "2369:                         $value = $statuses[$value];",
          "2370:                     }",
          "2371:                     if ($matches[2] == '<>') {",
          "2373:                     } else {",
          "2375:                     }",
          "2377:                 } else {",
          "2378:                     $element = 'false';",
          "2379:                 }",
          "",
          "[Removed Lines]",
          "2372:                         $oper = '!=';",
          "2374:                         $oper = '==';",
          "2376:                     $element = '(\\''.$usertracks[$element]->status.'\\' '.$oper.' \\''.$value.'\\')';",
          "",
          "[Added Lines]",
          "2380:                     $elementprerequisitematch = (strcmp($usertracks[$element]->status, $value) == 0);",
          "2382:                         $element = $elementprerequisitematch ? 'false' : 'true';",
          "2384:                         $element = $elementprerequisitematch ? 'true' : 'false';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3c31f748f151a4529033a68e1590dcc812df2244",
      "candidate_info": {
        "commit_hash": "3c31f748f151a4529033a68e1590dcc812df2244",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/3c31f748f151a4529033a68e1590dcc812df2244",
        "files": [
          "mod/scorm/lang/en/scorm.php",
          "mod/scorm/locallib.php"
        ],
        "message": "MDL-68410 mod_scorm: safer status operator comparison.",
        "before_after_code_files": [
          "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
          "mod/scorm/locallib.php||mod/scorm/locallib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
            "mod/scorm/locallib.php||mod/scorm/locallib.php"
          ],
          "candidate": [
            "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php",
            "mod/scorm/locallib.php||mod/scorm/locallib.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/scorm/lang/en/scorm.php||mod/scorm/lang/en/scorm.php": [
          "File: mod/scorm/lang/en/scorm.php -> mod/scorm/lang/en/scorm.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "239: $string['trackweight_help'] = 'Weight assigned to the question when calculating score.';",
          "240: $string['invalidactivity'] = 'SCORM activity is incorrect';",
          "241: $string['invalidmanifestname'] = 'Only imsmanifest.xml or .zip files may be selected';",
          "242: $string['invalidurl'] = 'Invalid URL specified';",
          "243: $string['invalidurlhttpcheck'] = 'Invalid URL specified. Debug message:<pre>{$a->cmsg}</pre>';",
          "244: $string['invalidhacpsession'] = 'Invalid HACP session';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "242: $string['invalidstatus'] = 'Invalid status';",
          "",
          "---------------"
        ],
        "mod/scorm/locallib.php||mod/scorm/locallib.php": [
          "File: mod/scorm/locallib.php -> mod/scorm/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1583:                     if (isset($usertracks[$sco->identifier])) {",
          "1584:                         $usertrack = $usertracks[$sco->identifier];",
          "1587:                         if ($sco->scormtype == 'sco') {",
          "1589:                         } else {",
          "1590:                             $statusicon = $OUTPUT->pix_icon('asset', get_string('assetlaunched', 'scorm'), 'scorm');",
          "1591:                         }",
          "",
          "[Removed Lines]",
          "1585:                         $strstatus = get_string($usertrack->status, 'scorm');",
          "1588:                             $statusicon = $OUTPUT->pix_icon($usertrack->status, $strstatus, 'scorm');",
          "",
          "[Added Lines]",
          "1587:                         if ($statusstringexists = get_string_manager()->string_exists($usertrack->status, 'scorm')) {",
          "1588:                             $strstatus = get_string($usertrack->status, 'scorm');",
          "1589:                         } else {",
          "1590:                             $strstatus = get_string('invalidstatus', 'scorm');",
          "1591:                         }",
          "1595:                             $statusicon = $OUTPUT->pix_icon($statusstringexists ? $usertrack->status : 'incomplete',",
          "1596:                                 $strstatus, 'scorm');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2368:                     if (isset($statuses[$value])) {",
          "2369:                         $value = $statuses[$value];",
          "2370:                     }",
          "2371:                     if ($matches[2] == '<>') {",
          "2373:                     } else {",
          "2375:                     }",
          "2377:                 } else {",
          "2378:                     $element = 'false';",
          "2379:                 }",
          "",
          "[Removed Lines]",
          "2372:                         $oper = '!=';",
          "2374:                         $oper = '==';",
          "2376:                     $element = '(\\''.$usertracks[$element]->status.'\\' '.$oper.' \\''.$value.'\\')';",
          "",
          "[Added Lines]",
          "2380:                     $elementprerequisitematch = (strcmp($usertracks[$element]->status, $value) == 0);",
          "2382:                         $element = $elementprerequisitematch ? 'false' : 'true';",
          "2384:                         $element = $elementprerequisitematch ? 'true' : 'false';",
          "",
          "---------------"
        ]
      }
    }
  ]
}