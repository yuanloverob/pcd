{
  "cve_id": "CVE-2014-5274",
  "cve_desc": "Cross-site scripting (XSS) vulnerability in the view operations page in phpMyAdmin 4.1.x before 4.1.14.3 and 4.2.x before 4.2.7.1 allows remote authenticated users to inject arbitrary web script or HTML via a crafted view name, related to js/functions.js.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "0cd293f5e13aa245e4a57b8d373597cc0e421b6f",
  "patch_info": {
    "commit_hash": "0cd293f5e13aa245e4a57b8d373597cc0e421b6f",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/0cd293f5e13aa245e4a57b8d373597cc0e421b6f",
    "files": [
      "ChangeLog",
      "js/functions.js"
    ],
    "message": "bug #4505 [security] XSS in view operations page\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
    "before_after_code_files": [
      "js/functions.js||js/functions.js"
    ]
  },
  "patch_diff": {
    "js/functions.js||js/functions.js": [
      "File: js/functions.js -> js/functions.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "3585:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
      "3586:         question += $.sprintf(",
      "3587:             PMA_messages.strDoYouReally,",
      "3589:         );",
      "3591:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
      "",
      "[Removed Lines]",
      "3588:             'DROP VIEW ' + PMA_commonParams.get('table')",
      "",
      "[Added Lines]",
      "3588:             'DROP VIEW ' + escapeHtml(PMA_commonParams.get('table'))",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a5f20214fe6c49c99b040bd2b5113760fe8a068c",
      "candidate_info": {
        "commit_hash": "a5f20214fe6c49c99b040bd2b5113760fe8a068c",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/a5f20214fe6c49c99b040bd2b5113760fe8a068c",
        "files": [
          "js/functions.js",
          "view_operations.php"
        ],
        "message": "Js confirm for drop view in Operations",
        "before_after_code_files": [
          "js/functions.js||js/functions.js",
          "view_operations.php||view_operations.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3465: AJAX.registerTeardown('functions.js', function () {",
          "3466:     $(\"#drop_tbl_anchor.ajax\").die('click');",
          "3467:     $(\"#truncate_tbl_anchor.ajax\").die('click');",
          "3468: });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3467:     $(\"#drop_view_anchor.ajax\").die('click');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3503:         }); // end $.PMA_confirm()",
          "3504:     }); //end of Drop Table Ajax action",
          "3506:     $(\"#truncate_tbl_anchor.ajax\").live('click', function (event) {",
          "3507:         event.preventDefault();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3507:     $(\"#drop_view_anchor.ajax\").live('click', function (event) {",
          "3508:         event.preventDefault();",
          "3512:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
          "3513:         question += $.sprintf(",
          "3514:             PMA_messages.strDoYouReally,",
          "3515:             'DROP VIEW ' + PMA_commonParams.get('table')",
          "3516:         );",
          "3518:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
          "3520:             var $msgbox = PMA_ajaxShowMessage(PMA_messages.strProcessingRequest);",
          "3521:             $.get(url, {'is_js_confirmed': '1', 'ajax_request': true}, function (data) {",
          "3522:                 if (data.success === true) {",
          "3523:                     PMA_ajaxRemoveMessage($msgbox);",
          "3525:                     PMA_reloadNavigation();",
          "3526:                     PMA_commonParams.set('table', '');",
          "3527:                     PMA_commonActions.refreshMain(",
          "3528:                         PMA_commonParams.get('opendb_url'),",
          "3529:                         function () {",
          "3530:                             PMA_ajaxShowMessage(data.message);",
          "3531:                         }",
          "3532:                     );",
          "3533:                 } else {",
          "3534:                     PMA_ajaxShowMessage(data.error, false);",
          "3535:                 }",
          "3536:             }); // end $.get()",
          "3537:         }); // end $.PMA_confirm()",
          "3538:     }); //end of Drop View Ajax action",
          "",
          "---------------"
        ],
        "view_operations.php||view_operations.php": [
          "File: view_operations.php -> view_operations.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "129:     $drop_view_url_params,",
          "130:     'DROP VIEW',",
          "131:     __('Delete the view (DROP)'),",
          "133: );",
          "134: echo '</ul>';",
          "135: echo '</fieldset>';",
          "",
          "[Removed Lines]",
          "132:     ''",
          "",
          "[Added Lines]",
          "132:     'drop_view_anchor'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "65eef3d65411b985250487e14f1121754a91c6d5",
      "candidate_info": {
        "commit_hash": "65eef3d65411b985250487e14f1121754a91c6d5",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/65eef3d65411b985250487e14f1121754a91c6d5",
        "files": [
          "ChangeLog",
          "js/functions.js"
        ],
        "message": "bug #4505 [security] XSS in view operations page\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "js/functions.js||js/functions.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3552:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
          "3553:         question += $.sprintf(",
          "3554:             PMA_messages.strDoYouReally,",
          "3556:         );",
          "3558:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
          "",
          "[Removed Lines]",
          "3555:             'DROP VIEW ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3555:             'DROP VIEW ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a92753bd65e1f8b72c46ed3dda6c362628e0daf7",
      "candidate_info": {
        "commit_hash": "a92753bd65e1f8b72c46ed3dda6c362628e0daf7",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/a92753bd65e1f8b72c46ed3dda6c362628e0daf7",
        "files": [
          "ChangeLog",
          "js/functions.js",
          "js/tbl_structure.js"
        ],
        "message": "bug #4492 [security] XSS in AJAX confirmation messages\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "js/functions.js||js/functions.js",
          "js/tbl_structure.js||js/tbl_structure.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3368:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
          "3369:         question += $.sprintf(",
          "3370:             PMA_messages.strDoYouReally,",
          "3372:         );",
          "3374:         $(this).PMA_confirm(question, $(this).attr('href'), function(url) {",
          "",
          "[Removed Lines]",
          "3371:             'DROP TABLE ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3371:             'DROP TABLE ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3401:         var question = PMA_messages.strTruncateTableStrongWarning + ' ';",
          "3402:         question += $.sprintf(",
          "3403:             PMA_messages.strDoYouReally,",
          "3405:         );",
          "3406:         $(this).PMA_confirm(question, $(this).attr('href'), function(url) {",
          "3407:             PMA_ajaxShowMessage(PMA_messages['strProcessingRequest']);",
          "",
          "[Removed Lines]",
          "3404:             'TRUNCATE ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3404:             'TRUNCATE ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------"
        ],
        "js/tbl_structure.js||js/tbl_structure.js": [
          "File: js/tbl_structure.js -> js/tbl_structure.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "146:         var curr_column_name = $curr_row.children('th').children('label').text();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "147:         curr_column_name = escapeHtml(curr_column_name);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "cd5697027a2ee7e1f7d7000b23be6051cdb0516c",
      "candidate_info": {
        "commit_hash": "cd5697027a2ee7e1f7d7000b23be6051cdb0516c",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/cd5697027a2ee7e1f7d7000b23be6051cdb0516c",
        "files": [
          "ChangeLog",
          "js/functions.js",
          "js/tbl_structure.js"
        ],
        "message": "bug #4492 [security] XSS in AJAX confirmation messages\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "js/functions.js||js/functions.js",
          "js/tbl_structure.js||js/tbl_structure.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3519:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
          "3520:         question += $.sprintf(",
          "3521:             PMA_messages.strDoYouReally,",
          "3523:         );",
          "3525:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
          "",
          "[Removed Lines]",
          "3522:             'DROP TABLE ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3522:             'DROP TABLE ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3585:         var question = PMA_messages.strTruncateTableStrongWarning + ' ';",
          "3586:         question += $.sprintf(",
          "3587:             PMA_messages.strDoYouReally,",
          "3589:         );",
          "3590:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
          "3591:             PMA_ajaxShowMessage(PMA_messages.strProcessingRequest);",
          "",
          "[Removed Lines]",
          "3588:             'TRUNCATE ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3588:             'TRUNCATE ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------"
        ],
        "js/tbl_structure.js||js/tbl_structure.js": [
          "File: js/tbl_structure.js -> js/tbl_structure.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "199:         var curr_column_name = $curr_row.children('th').children('label').text();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "200:         curr_column_name = escapeHtml(curr_column_name);",
          "",
          "---------------"
        ]
      }
    }
  ]
}