{
  "cve_id": "CVE-2014-8142",
  "cve_desc": "Use-after-free vulnerability in the process_nested_data function in ext/standard/var_unserializer.re in PHP before 5.4.36, 5.5.x before 5.5.20, and 5.6.x before 5.6.4 allows remote attackers to execute arbitrary code via a crafted unserialize call that leverages improper handling of duplicate keys within the serialized properties of an object, a different vulnerability than CVE-2004-1019.",
  "repo": "php/php-src",
  "patch_hash": "630f9c33c23639de85c3fd306b209b538b73b4c9",
  "patch_info": {
    "commit_hash": "630f9c33c23639de85c3fd306b209b538b73b4c9",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/630f9c33c23639de85c3fd306b209b538b73b4c9",
    "files": [
      "NEWS",
      "ext/standard/tests/serialize/bug68594.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #68594 - Use after free vulnerability in unserialize()",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt": [
      "File: ext/standard/tests/serialize/bug68594.phpt -> ext/standard/tests/serialize/bug68594.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #68545 Use after free vulnerability in unserialize()",
      "3: --FILE--",
      "4: <?php",
      "5: for ($i=4; $i<100; $i++) {",
      "6:  $m = new StdClass();",
      "8:  $u = array(1);",
      "10:  $m->aaa = array(1,2,&$u,4,5);",
      "11:  $m->bbb = 1;",
      "12:  $m->ccc = &$u;",
      "13:  $m->ddd = str_repeat(\"A\", $i);",
      "15:  $z = serialize($m);",
      "16:  $z = str_replace(\"bbb\", \"aaa\", $z);",
      "17:  $y = unserialize($z);",
      "18:  $z = serialize($y);",
      "19: }",
      "20: ?>",
      "21: ===DONE===",
      "22: --EXPECTF--",
      "23: ===DONE===",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "343:   } else {",
      "345:    convert_to_string(key);",
      "346:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
      "347:      sizeof data, NULL);",
      "348:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "346:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
      "347:     var_push_dtor(var_hash, old_data);",
      "348:    }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "484: {",
      "485:  YYCTYPE yych;",
      "486:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "483: #line 484 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "486: #line 487 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "540:  yych = *(YYMARKER = ++YYCURSOR);",
      "541:  if (yych == ':') goto yy95;",
      "542: yy3:",
      "544:  { return 0; }",
      "546: yy4:",
      "547:  yych = *(YYMARKER = ++YYCURSOR);",
      "548:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "543: #line 835 \"ext/standard/var_unserializer.re\"",
      "545: #line 546 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "546: #line 838 \"ext/standard/var_unserializer.re\"",
      "548: #line 549 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "585:  goto yy3;",
      "586: yy14:",
      "587:  ++YYCURSOR;",
      "589:  {",
      "591:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "593: }",
      "595: yy16:",
      "596:  yych = *++YYCURSOR;",
      "597:  goto yy3;",
      "",
      "[Removed Lines]",
      "588: #line 829 \"ext/standard/var_unserializer.re\"",
      "594: #line 595 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "591: #line 832 \"ext/standard/var_unserializer.re\"",
      "597: #line 598 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "617:  if (yybm[0+yych] & 128) {",
      "618:   goto yy20;",
      "619:  }",
      "621:  yych = *++YYCURSOR;",
      "622:  if (yych != '\"') goto yy18;",
      "623:  ++YYCURSOR;",
      "625:  {",
      "626:  size_t len, len2, len3, maxlen;",
      "627:  long elements;",
      "",
      "[Removed Lines]",
      "620:  if (yych != ':') goto yy18;",
      "624: #line 683 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "623:  if (yych <= '/') goto yy18;",
      "624:  if (yych >= ';') goto yy18;",
      "628: #line 686 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "768:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "769: }",
      "771: yy25:",
      "772:  yych = *++YYCURSOR;",
      "773:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "770: #line 771 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "774: #line 775 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "792:  yych = *++YYCURSOR;",
      "793:  if (yych != '\"') goto yy18;",
      "794:  ++YYCURSOR;",
      "796:  {",
      "798:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "795: #line 675 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "799: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "800:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "801:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "802: }",
      "804: yy32:",
      "805:  yych = *++YYCURSOR;",
      "806:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "803: #line 804 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "807: #line 808 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "821:  yych = *++YYCURSOR;",
      "822:  if (yych != '{') goto yy18;",
      "823:  ++YYCURSOR;",
      "825:  {",
      "826:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "824: #line 655 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "828: #line 658 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "842:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "843: }",
      "845: yy39:",
      "846:  yych = *++YYCURSOR;",
      "847:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "844: #line 845 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "848: #line 849 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "862:  yych = *++YYCURSOR;",
      "863:  if (yych != '\"') goto yy18;",
      "864:  ++YYCURSOR;",
      "866:  {",
      "867:  size_t len, maxlen;",
      "868:  char *str;",
      "",
      "[Removed Lines]",
      "865: #line 626 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "869: #line 629 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "891:  ZVAL_STRINGL(*rval, str, len, 0);",
      "892:  return 1;",
      "893: }",
      "895: yy46:",
      "896:  yych = *++YYCURSOR;",
      "897:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "894: #line 895 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "898: #line 899 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "912:  yych = *++YYCURSOR;",
      "913:  if (yych != '\"') goto yy18;",
      "914:  ++YYCURSOR;",
      "916:  {",
      "917:  size_t len, maxlen;",
      "918:  char *str;",
      "",
      "[Removed Lines]",
      "915: #line 598 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "919: #line 601 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "940:  ZVAL_STRINGL(*rval, str, len, 1);",
      "941:  return 1;",
      "942: }",
      "944: yy53:",
      "945:  yych = *++YYCURSOR;",
      "946:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "943: #line 944 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "947: #line 948 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1028:  }",
      "1029: yy63:",
      "1030:  ++YYCURSOR;",
      "1032:  {",
      "1033: #if SIZEOF_LONG == 4",
      "1034: use_double:",
      "",
      "[Removed Lines]",
      "1031: #line 588 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1035: #line 591 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1038:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1039:  return 1;",
      "1040: }",
      "1042: yy65:",
      "1043:  yych = *++YYCURSOR;",
      "1044:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1041: #line 1042 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1097:  yych = *++YYCURSOR;",
      "1098:  if (yych != ';') goto yy18;",
      "1099:  ++YYCURSOR;",
      "1101:  {",
      "1103:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1100: #line 573 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1104: #line 576 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1113:  return 1;",
      "1114: }",
      "1116: yy76:",
      "1117:  yych = *++YYCURSOR;",
      "1118:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1115: #line 1116 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1119: #line 1120 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1139:  if (yych <= '9') goto yy79;",
      "1140:  if (yych != ';') goto yy18;",
      "1141:  ++YYCURSOR;",
      "1143:  {",
      "1144: #if SIZEOF_LONG == 4",
      "1145:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1142: #line 546 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1146: #line 549 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1166:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1167:  return 1;",
      "1168: }",
      "1170: yy83:",
      "1171:  yych = *++YYCURSOR;",
      "1172:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1169: #line 1170 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1173: #line 1174 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1174:  yych = *++YYCURSOR;",
      "1175:  if (yych != ';') goto yy18;",
      "1176:  ++YYCURSOR;",
      "1178:  {",
      "1180:  INIT_PZVAL(*rval);",
      "1181:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1182:  return 1;",
      "1183: }",
      "1185: yy87:",
      "1186:  ++YYCURSOR;",
      "1188:  {",
      "1190:  INIT_PZVAL(*rval);",
      "1191:  ZVAL_NULL(*rval);",
      "1192:  return 1;",
      "1193: }",
      "1195: yy89:",
      "1196:  yych = *++YYCURSOR;",
      "1197:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1177: #line 539 \"ext/standard/var_unserializer.re\"",
      "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
      "1187: #line 532 \"ext/standard/var_unserializer.re\"",
      "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1181: #line 542 \"ext/standard/var_unserializer.re\"",
      "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
      "1191: #line 535 \"ext/standard/var_unserializer.re\"",
      "1198: #line 1199 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1214:  if (yych <= '9') goto yy91;",
      "1215:  if (yych != ';') goto yy18;",
      "1216:  ++YYCURSOR;",
      "1218:  {",
      "1219:  long id;",
      "",
      "[Removed Lines]",
      "1217: #line 509 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1221: #line 512 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1238:  return 1;",
      "1239: }",
      "1241: yy95:",
      "1242:  yych = *++YYCURSOR;",
      "1243:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1240: #line 1241 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1260:  if (yych <= '9') goto yy97;",
      "1261:  if (yych != ';') goto yy18;",
      "1262:  ++YYCURSOR;",
      "1264:  {",
      "1265:  long id;",
      "",
      "[Removed Lines]",
      "1263: #line 488 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1267: #line 491 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1282:  return 1;",
      "1283: }",
      "1285: }",
      "1289:  return 0;",
      "",
      "[Removed Lines]",
      "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
      "1286: #line 837 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1288: #line 1289 \"ext/standard/var_unserializer.c\"",
      "1290: #line 840 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "347:   } else {",
      "349:    convert_to_string(key);",
      "350:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
      "351:      sizeof data, NULL);",
      "352:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "350:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
      "351:     var_push_dtor(var_hash, old_data);",
      "352:    }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "342240fd7fb6ac0a287eb6f912c4d61d6274d68c",
      "candidate_info": {
        "commit_hash": "342240fd7fb6ac0a287eb6f912c4d61d6274d68c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/342240fd7fb6ac0a287eb6f912c4d61d6274d68c",
        "files": [
          "NEWS",
          "ext/standard/tests/serialize/bug67072_2.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Better fix for bug #67072 with more BC provisions",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug67072_2.phpt||ext/standard/tests/serialize/bug67072_2.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug67072_2.phpt||ext/standard/tests/serialize/bug67072_2.phpt": [
          "File: ext/standard/tests/serialize/bug67072_2.phpt -> ext/standard/tests/serialize/bug67072_2.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #67072 Echoing unserialized \"SplFileObject\" crash - BC break fixes",
          "3: --FILE--",
          "4: <?php",
          "5: class MySplFileObject extends SplFileObject {}",
          "6: class MyArrayObject extends ArrayObject{ var $a = 1; }",
          "7: echo unserialize('O:15:\"MySplFileObject\":1:{s:9:\"*filename\";s:15:\"/home/flag/flag\";}');",
          "9: function testClass($className)",
          "10: {",
          "12:     $object = unserialize(sprintf('O:%d:\"%s\":0:{}', strlen($className), $className));",
          "13:     return $object;",
          "14: }",
          "16: class MyClass {}",
          "17: class MyClassSer implements Serializable {",
          "18:         function serialize() { return \"\";}",
          "19:         function unserialize($data) { }",
          "20: }",
          "21: class MyClassSer2 extends MyClassSer {",
          "22: }",
          "24: $classes = array('stdClass', 'MyClass', 'MyClassSer', 'MyClassSer2', 'SplFileObject', 'MySplFileObject',",
          "25:                  'SplObjectStorage', 'FooBar', 'Closure', 'ArrayObject', 'MyArrayObject',",
          "26:                  'Directory'",
          "27:              );",
          "28: foreach($classes as $cl) {",
          "29:         var_dump(testClass($cl));",
          "30: }",
          "32: ?>",
          "33: ===DONE==",
          "34: --EXPECTF--",
          "35: Warning: Erroneous data format for unserializing 'MySplFileObject' in %s on line 4",
          "37: Notice: unserialize(): Error at offset 26 of 66 bytes in %s on line 4",
          "38: object(stdClass)#%d (0) {",
          "39: }",
          "40: object(MyClass)#%d (0) {",
          "41: }",
          "42: object(MyClassSer)#%d (0) {",
          "43: }",
          "44: object(MyClassSer2)#%d (0) {",
          "45: }",
          "47: Warning: Erroneous data format for unserializing 'SplFileObject' in %s on line 9",
          "49: Notice: unserialize(): Error at offset 24 of 25 bytes in %s on line 9",
          "50: bool(false)",
          "52: Warning: Erroneous data format for unserializing 'MySplFileObject' in %s on line 9",
          "54: Notice: unserialize(): Error at offset 26 of 27 bytes in %s on line 9",
          "55: bool(false)",
          "56: object(SplObjectStorage)#%d (1) {",
          "57:   [\"storage\":\"SplObjectStorage\":private]=>",
          "58:   array(0) {",
          "59:   }",
          "60: }",
          "61: object(__PHP_Incomplete_Class)#%d (1) {",
          "62:   [\"__PHP_Incomplete_Class_Name\"]=>",
          "63:   string(6) \"FooBar\"",
          "64: }",
          "66: Warning: Erroneous data format for unserializing 'Closure' in %s on line 9",
          "68: Notice: unserialize(): Error at offset 17 of 18 bytes in %s on line 9",
          "69: bool(false)",
          "70: object(ArrayObject)#%d (1) {",
          "71:   [\"storage\":\"ArrayObject\":private]=>",
          "72:   array(0) {",
          "73:   }",
          "74: }",
          "75: object(MyArrayObject)#1 (2) {",
          "76:   [\"a\"]=>",
          "77:   int(1)",
          "78:   [\"storage\":\"ArrayObject\":private]=>",
          "79:   array(0) {",
          "80:   }",
          "81: }",
          "82: object(Directory)#1 (0) {",
          "83: }",
          "84: ===DONE==",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "23: #include \"php.h\"",
          "24: #include \"ext/standard/php_var.h\"",
          "25: #include \"php_incomplete_class.h\"",
          "28: #define VAR_ENTRIES_MAX 1024",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "26: #include \"Zend/zend_interfaces.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "226: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "229: #line 234 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "230: #line 235 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "400:  Serializable interface have eventually an inconsistent behavior at this place when",
          "401:  unserialized from a manipulated string. Additionaly the interal classes can possibly",
          "404:   object_init_ex(*rval, ce);",
          "405:  } else {",
          "",
          "[Removed Lines]",
          "403:  if (ce->serialize == NULL || ZEND_INTERNAL_CLASS != ce->type) {",
          "",
          "[Added Lines]",
          "404:  if (ce->serialize == NULL || ce->unserialize == zend_user_unserialize || (ZEND_INTERNAL_CLASS != ce->type && ce->create_object == NULL)) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "477: {",
          "478:  YYCTYPE yych;",
          "479:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "476: #line 477 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "477: #line 478 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "533:  yych = *(YYMARKER = ++YYCURSOR);",
          "534:  if (yych == ':') goto yy95;",
          "535: yy3:",
          "537:  { return 0; }",
          "539: yy4:",
          "540:  yych = *(YYMARKER = ++YYCURSOR);",
          "541:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "536: #line 828 \"ext/standard/var_unserializer.re\"",
          "538: #line 539 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "537: #line 829 \"ext/standard/var_unserializer.re\"",
          "539: #line 540 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "578:  goto yy3;",
          "579: yy14:",
          "580:  ++YYCURSOR;",
          "582:  {",
          "584:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "586: }",
          "588: yy16:",
          "589:  yych = *++YYCURSOR;",
          "590:  goto yy3;",
          "",
          "[Removed Lines]",
          "581: #line 822 \"ext/standard/var_unserializer.re\"",
          "587: #line 588 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "582: #line 823 \"ext/standard/var_unserializer.re\"",
          "588: #line 589 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "614:  yych = *++YYCURSOR;",
          "615:  if (yych != '\"') goto yy18;",
          "616:  ++YYCURSOR;",
          "618:  {",
          "619:  size_t len, len2, len3, maxlen;",
          "620:  long elements;",
          "",
          "[Removed Lines]",
          "617: #line 676 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "618: #line 677 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "761:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "762: }",
          "764: yy25:",
          "765:  yych = *++YYCURSOR;",
          "766:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "763: #line 764 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "764: #line 765 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "785:  yych = *++YYCURSOR;",
          "786:  if (yych != '\"') goto yy18;",
          "787:  ++YYCURSOR;",
          "789:  {",
          "791:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "788: #line 668 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "789: #line 669 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "793:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "794:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "795: }",
          "797: yy32:",
          "798:  yych = *++YYCURSOR;",
          "799:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "796: #line 797 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "797: #line 798 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "814:  yych = *++YYCURSOR;",
          "815:  if (yych != '{') goto yy18;",
          "816:  ++YYCURSOR;",
          "818:  {",
          "819:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "817: #line 648 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "818: #line 649 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "835:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "836: }",
          "838: yy39:",
          "839:  yych = *++YYCURSOR;",
          "840:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "837: #line 838 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "838: #line 839 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "855:  yych = *++YYCURSOR;",
          "856:  if (yych != '\"') goto yy18;",
          "857:  ++YYCURSOR;",
          "859:  {",
          "860:  size_t len, maxlen;",
          "861:  char *str;",
          "",
          "[Removed Lines]",
          "858: #line 619 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "859: #line 620 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "884:  ZVAL_STRINGL(*rval, str, len, 0);",
          "885:  return 1;",
          "886: }",
          "888: yy46:",
          "889:  yych = *++YYCURSOR;",
          "890:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "887: #line 888 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "888: #line 889 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "905:  yych = *++YYCURSOR;",
          "906:  if (yych != '\"') goto yy18;",
          "907:  ++YYCURSOR;",
          "909:  {",
          "910:  size_t len, maxlen;",
          "911:  char *str;",
          "",
          "[Removed Lines]",
          "908: #line 591 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "909: #line 592 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "933:  ZVAL_STRINGL(*rval, str, len, 1);",
          "934:  return 1;",
          "935: }",
          "937: yy53:",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "936: #line 937 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "937: #line 938 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1021:  }",
          "1022: yy63:",
          "1023:  ++YYCURSOR;",
          "1025:  {",
          "1026: #if SIZEOF_LONG == 4",
          "1027: use_double:",
          "",
          "[Removed Lines]",
          "1024: #line 581 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1025: #line 582 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1031:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1032:  return 1;",
          "1033: }",
          "1035: yy65:",
          "1036:  yych = *++YYCURSOR;",
          "1037:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1034: #line 1035 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1035: #line 1036 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1090:  yych = *++YYCURSOR;",
          "1091:  if (yych != ';') goto yy18;",
          "1092:  ++YYCURSOR;",
          "1094:  {",
          "1096:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1093: #line 566 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1094: #line 567 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1106:  return 1;",
          "1107: }",
          "1109: yy76:",
          "1110:  yych = *++YYCURSOR;",
          "1111:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1108: #line 1109 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1109: #line 1110 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1132:  if (yych <= '9') goto yy79;",
          "1133:  if (yych != ';') goto yy18;",
          "1134:  ++YYCURSOR;",
          "1136:  {",
          "1137: #if SIZEOF_LONG == 4",
          "1138:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1135: #line 539 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1136: #line 540 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1159:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1160:  return 1;",
          "1161: }",
          "1163: yy83:",
          "1164:  yych = *++YYCURSOR;",
          "1165:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1162: #line 1163 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1163: #line 1164 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1167:  yych = *++YYCURSOR;",
          "1168:  if (yych != ';') goto yy18;",
          "1169:  ++YYCURSOR;",
          "1171:  {",
          "1173:  INIT_PZVAL(*rval);",
          "1174:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1175:  return 1;",
          "1176: }",
          "1178: yy87:",
          "1179:  ++YYCURSOR;",
          "1181:  {",
          "1183:  INIT_PZVAL(*rval);",
          "1184:  ZVAL_NULL(*rval);",
          "1185:  return 1;",
          "1186: }",
          "1188: yy89:",
          "1189:  yych = *++YYCURSOR;",
          "1190:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1170: #line 532 \"ext/standard/var_unserializer.re\"",
          "1177: #line 1178 \"ext/standard/var_unserializer.c\"",
          "1180: #line 525 \"ext/standard/var_unserializer.re\"",
          "1187: #line 1188 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1171: #line 533 \"ext/standard/var_unserializer.re\"",
          "1178: #line 1179 \"ext/standard/var_unserializer.c\"",
          "1181: #line 526 \"ext/standard/var_unserializer.re\"",
          "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1207:  if (yych <= '9') goto yy91;",
          "1208:  if (yych != ';') goto yy18;",
          "1209:  ++YYCURSOR;",
          "1211:  {",
          "1212:  long id;",
          "",
          "[Removed Lines]",
          "1210: #line 502 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1211: #line 503 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1231:  return 1;",
          "1232: }",
          "1234: yy95:",
          "1235:  yych = *++YYCURSOR;",
          "1236:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1233: #line 1234 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1234: #line 1235 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1253:  if (yych <= '9') goto yy97;",
          "1254:  if (yych != ';') goto yy18;",
          "1255:  ++YYCURSOR;",
          "1257:  {",
          "1258:  long id;",
          "",
          "[Removed Lines]",
          "1256: #line 481 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1257: #line 482 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1275:  return 1;",
          "1276: }",
          "1278: }",
          "1282:  return 0;",
          "",
          "[Removed Lines]",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "1279: #line 830 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1278: #line 1279 \"ext/standard/var_unserializer.c\"",
          "1280: #line 831 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: #include \"php.h\"",
          "22: #include \"ext/standard/php_var.h\"",
          "23: #include \"php_incomplete_class.h\"",
          "26: #define VAR_ENTRIES_MAX 1024",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "24: #include \"Zend/zend_interfaces.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "404:  Serializable interface have eventually an inconsistent behavior at this place when",
          "405:  unserialized from a manipulated string. Additionaly the interal classes can possibly",
          "408:   object_init_ex(*rval, ce);",
          "409:  } else {",
          "",
          "[Removed Lines]",
          "407:  if (ce->serialize == NULL || ZEND_INTERNAL_CLASS != ce->type) {",
          "",
          "[Added Lines]",
          "408:  if (ce->serialize == NULL || ce->unserialize == zend_user_unserialize || (ZEND_INTERNAL_CLASS != ce->type && ce->create_object == NULL)) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "10198311a8a4f4d32988f0cce7d75b7e34f5ad38",
      "candidate_info": {
        "commit_hash": "10198311a8a4f4d32988f0cce7d75b7e34f5ad38",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/10198311a8a4f4d32988f0cce7d75b7e34f5ad38",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #68976 - Use After Free Vulnerability in unserialize()",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "347:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "348:      sizeof data, NULL);",
          "349:   }",
          "351:   zval_dtor(key);",
          "352:   FREE_ZVAL(key);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "350:   var_push_dtor(var_hash, &data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "481: {",
          "482:  YYCTYPE yych;",
          "483:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "480: #line 481 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "481: #line 482 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "537:  yych = *(YYMARKER = ++YYCURSOR);",
          "538:  if (yych == ':') goto yy95;",
          "539: yy3:",
          "541:  { return 0; }",
          "543: yy4:",
          "544:  yych = *(YYMARKER = ++YYCURSOR);",
          "545:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "540: #line 832 \"ext/standard/var_unserializer.re\"",
          "542: #line 543 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "541: #line 833 \"ext/standard/var_unserializer.re\"",
          "543: #line 544 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "582:  goto yy3;",
          "583: yy14:",
          "584:  ++YYCURSOR;",
          "586:  {",
          "588:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "590: }",
          "592: yy16:",
          "593:  yych = *++YYCURSOR;",
          "594:  goto yy3;",
          "",
          "[Removed Lines]",
          "585: #line 826 \"ext/standard/var_unserializer.re\"",
          "591: #line 592 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "586: #line 827 \"ext/standard/var_unserializer.re\"",
          "592: #line 593 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "614:  if (yybm[0+yych] & 128) {",
          "615:   goto yy20;",
          "616:  }",
          "618:  yych = *++YYCURSOR;",
          "619:  if (yych != '\"') goto yy18;",
          "620:  ++YYCURSOR;",
          "622:  {",
          "623:  size_t len, len2, len3, maxlen;",
          "624:  long elements;",
          "",
          "[Removed Lines]",
          "617:  if (yych != ':') goto yy18;",
          "621: #line 680 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "618:  if (yych <= '/') goto yy18;",
          "619:  if (yych >= ';') goto yy18;",
          "623: #line 681 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "765:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "766: }",
          "768: yy25:",
          "769:  yych = *++YYCURSOR;",
          "770:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "767: #line 768 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "769: #line 770 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "789:  yych = *++YYCURSOR;",
          "790:  if (yych != '\"') goto yy18;",
          "791:  ++YYCURSOR;",
          "793:  {",
          "795:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "792: #line 672 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "794: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "797:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "798:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "799: }",
          "801: yy32:",
          "802:  yych = *++YYCURSOR;",
          "803:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "800: #line 801 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "802: #line 803 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "818:  yych = *++YYCURSOR;",
          "819:  if (yych != '{') goto yy18;",
          "820:  ++YYCURSOR;",
          "822:  {",
          "823:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "821: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "823: #line 653 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "839:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "840: }",
          "842: yy39:",
          "843:  yych = *++YYCURSOR;",
          "844:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "841: #line 842 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "843: #line 844 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "859:  yych = *++YYCURSOR;",
          "860:  if (yych != '\"') goto yy18;",
          "861:  ++YYCURSOR;",
          "863:  {",
          "864:  size_t len, maxlen;",
          "865:  char *str;",
          "",
          "[Removed Lines]",
          "862: #line 623 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "864: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "888:  ZVAL_STRINGL(*rval, str, len, 0);",
          "889:  return 1;",
          "890: }",
          "892: yy46:",
          "893:  yych = *++YYCURSOR;",
          "894:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "891: #line 892 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "893: #line 894 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "909:  yych = *++YYCURSOR;",
          "910:  if (yych != '\"') goto yy18;",
          "911:  ++YYCURSOR;",
          "913:  {",
          "914:  size_t len, maxlen;",
          "915:  char *str;",
          "",
          "[Removed Lines]",
          "912: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "914: #line 596 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "937:  ZVAL_STRINGL(*rval, str, len, 1);",
          "938:  return 1;",
          "939: }",
          "941: yy53:",
          "942:  yych = *++YYCURSOR;",
          "943:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "940: #line 941 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "942: #line 943 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1025:  }",
          "1026: yy63:",
          "1027:  ++YYCURSOR;",
          "1029:  {",
          "1030: #if SIZEOF_LONG == 4",
          "1031: use_double:",
          "",
          "[Removed Lines]",
          "1028: #line 585 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1030: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1035:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1036:  return 1;",
          "1037: }",
          "1039: yy65:",
          "1040:  yych = *++YYCURSOR;",
          "1041:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1038: #line 1039 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1040: #line 1041 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1094:  yych = *++YYCURSOR;",
          "1095:  if (yych != ';') goto yy18;",
          "1096:  ++YYCURSOR;",
          "1098:  {",
          "1100:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1097: #line 570 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1099: #line 571 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1110:  return 1;",
          "1111: }",
          "1113: yy76:",
          "1114:  yych = *++YYCURSOR;",
          "1115:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1112: #line 1113 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1136:  if (yych <= '9') goto yy79;",
          "1137:  if (yych != ';') goto yy18;",
          "1138:  ++YYCURSOR;",
          "1140:  {",
          "1141: #if SIZEOF_LONG == 4",
          "1142:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1139: #line 543 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1141: #line 544 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1163:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1164:  return 1;",
          "1165: }",
          "1167: yy83:",
          "1168:  yych = *++YYCURSOR;",
          "1169:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1166: #line 1167 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1168: #line 1169 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1171:  yych = *++YYCURSOR;",
          "1172:  if (yych != ';') goto yy18;",
          "1173:  ++YYCURSOR;",
          "1175:  {",
          "1177:  INIT_PZVAL(*rval);",
          "1178:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1179:  return 1;",
          "1180: }",
          "1182: yy87:",
          "1183:  ++YYCURSOR;",
          "1185:  {",
          "1187:  INIT_PZVAL(*rval);",
          "1188:  ZVAL_NULL(*rval);",
          "1189:  return 1;",
          "1190: }",
          "1192: yy89:",
          "1193:  yych = *++YYCURSOR;",
          "1194:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1174: #line 536 \"ext/standard/var_unserializer.re\"",
          "1181: #line 1182 \"ext/standard/var_unserializer.c\"",
          "1184: #line 529 \"ext/standard/var_unserializer.re\"",
          "1191: #line 1192 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1176: #line 537 \"ext/standard/var_unserializer.re\"",
          "1183: #line 1184 \"ext/standard/var_unserializer.c\"",
          "1186: #line 530 \"ext/standard/var_unserializer.re\"",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1211:  if (yych <= '9') goto yy91;",
          "1212:  if (yych != ';') goto yy18;",
          "1213:  ++YYCURSOR;",
          "1215:  {",
          "1216:  long id;",
          "",
          "[Removed Lines]",
          "1214: #line 506 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1216: #line 507 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1235:  return 1;",
          "1236: }",
          "1238: yy95:",
          "1239:  yych = *++YYCURSOR;",
          "1240:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1237: #line 1238 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1239: #line 1240 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1257:  if (yych <= '9') goto yy97;",
          "1258:  if (yych != ';') goto yy18;",
          "1259:  ++YYCURSOR;",
          "1261:  {",
          "1262:  long id;",
          "",
          "[Removed Lines]",
          "1260: #line 485 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1262: #line 486 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1279:  return 1;",
          "1280: }",
          "1282: }",
          "1286:  return 0;",
          "",
          "[Removed Lines]",
          "1281: #line 1282 \"ext/standard/var_unserializer.c\"",
          "1283: #line 834 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1283: #line 1284 \"ext/standard/var_unserializer.c\"",
          "1285: #line 835 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "351:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "352:      sizeof data, NULL);",
          "353:   }",
          "355:   zval_dtor(key);",
          "356:   FREE_ZVAL(key);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "354:   var_push_dtor(var_hash, &data);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "646572d6d3847d68124b03936719f60936b49a38",
      "candidate_info": {
        "commit_hash": "646572d6d3847d68124b03936719f60936b49a38",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/646572d6d3847d68124b03936719f60936b49a38",
        "files": [
          "NEWS",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #68976 - Use After Free Vulnerability in unserialize()",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "349:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "350:      sizeof data, NULL);",
          "351:   }",
          "353:   zval_dtor(key);",
          "354:   FREE_ZVAL(key);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "352:   var_push_dtor(var_hash, &data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "487: {",
          "488:  YYCTYPE yych;",
          "489:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "486: #line 487 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "487: #line 488 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "543:  yych = *(YYMARKER = ++YYCURSOR);",
          "544:  if (yych == ':') goto yy95;",
          "545: yy3:",
          "547:  { return 0; }",
          "549: yy4:",
          "550:  yych = *(YYMARKER = ++YYCURSOR);",
          "551:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "546: #line 838 \"ext/standard/var_unserializer.re\"",
          "548: #line 549 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "547: #line 839 \"ext/standard/var_unserializer.re\"",
          "549: #line 550 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "588:  goto yy3;",
          "589: yy14:",
          "590:  ++YYCURSOR;",
          "592:  {",
          "594:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "596: }",
          "598: yy16:",
          "599:  yych = *++YYCURSOR;",
          "600:  goto yy3;",
          "",
          "[Removed Lines]",
          "591: #line 832 \"ext/standard/var_unserializer.re\"",
          "597: #line 598 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "592: #line 833 \"ext/standard/var_unserializer.re\"",
          "598: #line 599 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "625:  yych = *++YYCURSOR;",
          "626:  if (yych != '\"') goto yy18;",
          "627:  ++YYCURSOR;",
          "629:  {",
          "630:  size_t len, len2, len3, maxlen;",
          "631:  long elements;",
          "",
          "[Removed Lines]",
          "628: #line 686 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "629: #line 687 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "772:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "773: }",
          "775: yy25:",
          "776:  yych = *++YYCURSOR;",
          "777:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "774: #line 775 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "775: #line 776 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych != '\"') goto yy18;",
          "798:  ++YYCURSOR;",
          "800:  {",
          "802:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "799: #line 678 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "800: #line 679 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "804:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "805:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "806: }",
          "808: yy32:",
          "809:  yych = *++YYCURSOR;",
          "810:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "807: #line 808 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "808: #line 809 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "825:  yych = *++YYCURSOR;",
          "826:  if (yych != '{') goto yy18;",
          "827:  ++YYCURSOR;",
          "829:  {",
          "830:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "828: #line 658 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "829: #line 659 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "846:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "847: }",
          "849: yy39:",
          "850:  yych = *++YYCURSOR;",
          "851:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "848: #line 849 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "849: #line 850 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "866:  yych = *++YYCURSOR;",
          "867:  if (yych != '\"') goto yy18;",
          "868:  ++YYCURSOR;",
          "870:  {",
          "871:  size_t len, maxlen;",
          "872:  char *str;",
          "",
          "[Removed Lines]",
          "869: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "870: #line 630 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "895:  ZVAL_STRINGL(*rval, str, len, 0);",
          "896:  return 1;",
          "897: }",
          "899: yy46:",
          "900:  yych = *++YYCURSOR;",
          "901:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "898: #line 899 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "899: #line 900 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "916:  yych = *++YYCURSOR;",
          "917:  if (yych != '\"') goto yy18;",
          "918:  ++YYCURSOR;",
          "920:  {",
          "921:  size_t len, maxlen;",
          "922:  char *str;",
          "",
          "[Removed Lines]",
          "919: #line 601 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "920: #line 602 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "944:  ZVAL_STRINGL(*rval, str, len, 1);",
          "945:  return 1;",
          "946: }",
          "948: yy53:",
          "949:  yych = *++YYCURSOR;",
          "950:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "947: #line 948 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "948: #line 949 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1032:  }",
          "1033: yy63:",
          "1034:  ++YYCURSOR;",
          "1036:  {",
          "1037: #if SIZEOF_LONG == 4",
          "1038: use_double:",
          "",
          "[Removed Lines]",
          "1035: #line 591 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1036: #line 592 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1042:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1043:  return 1;",
          "1044: }",
          "1046: yy65:",
          "1047:  yych = *++YYCURSOR;",
          "1048:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1046: #line 1047 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1101:  yych = *++YYCURSOR;",
          "1102:  if (yych != ';') goto yy18;",
          "1103:  ++YYCURSOR;",
          "1105:  {",
          "1107:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1104: #line 576 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1105: #line 577 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1117:  return 1;",
          "1118: }",
          "1120: yy76:",
          "1121:  yych = *++YYCURSOR;",
          "1122:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1119: #line 1120 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1120: #line 1121 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1143:  if (yych <= '9') goto yy79;",
          "1144:  if (yych != ';') goto yy18;",
          "1145:  ++YYCURSOR;",
          "1147:  {",
          "1148: #if SIZEOF_LONG == 4",
          "1149:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1146: #line 549 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1147: #line 550 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1170:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1171:  return 1;",
          "1172: }",
          "1174: yy83:",
          "1175:  yych = *++YYCURSOR;",
          "1176:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1173: #line 1174 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1174: #line 1175 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1178:  yych = *++YYCURSOR;",
          "1179:  if (yych != ';') goto yy18;",
          "1180:  ++YYCURSOR;",
          "1182:  {",
          "1184:  INIT_PZVAL(*rval);",
          "1185:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1186:  return 1;",
          "1187: }",
          "1189: yy87:",
          "1190:  ++YYCURSOR;",
          "1192:  {",
          "1194:  INIT_PZVAL(*rval);",
          "1195:  ZVAL_NULL(*rval);",
          "1196:  return 1;",
          "1197: }",
          "1199: yy89:",
          "1200:  yych = *++YYCURSOR;",
          "1201:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1181: #line 542 \"ext/standard/var_unserializer.re\"",
          "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
          "1191: #line 535 \"ext/standard/var_unserializer.re\"",
          "1198: #line 1199 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1182: #line 543 \"ext/standard/var_unserializer.re\"",
          "1189: #line 1190 \"ext/standard/var_unserializer.c\"",
          "1192: #line 536 \"ext/standard/var_unserializer.re\"",
          "1199: #line 1200 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1218:  if (yych <= '9') goto yy91;",
          "1219:  if (yych != ';') goto yy18;",
          "1220:  ++YYCURSOR;",
          "1222:  {",
          "1223:  long id;",
          "",
          "[Removed Lines]",
          "1221: #line 512 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1222: #line 513 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1242:  return 1;",
          "1243: }",
          "1245: yy95:",
          "1246:  yych = *++YYCURSOR;",
          "1247:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1245: #line 1246 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1264:  if (yych <= '9') goto yy97;",
          "1265:  if (yych != ';') goto yy18;",
          "1266:  ++YYCURSOR;",
          "1268:  {",
          "1269:  long id;",
          "",
          "[Removed Lines]",
          "1267: #line 491 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1268: #line 492 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1286:  return 1;",
          "1287: }",
          "1289: }",
          "1293:  return 0;",
          "",
          "[Removed Lines]",
          "1288: #line 1289 \"ext/standard/var_unserializer.c\"",
          "1290: #line 840 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1289: #line 1290 \"ext/standard/var_unserializer.c\"",
          "1291: #line 841 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "353:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "354:      sizeof data, NULL);",
          "355:   }",
          "357:   zval_dtor(key);",
          "358:   FREE_ZVAL(key);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "356:   var_push_dtor(var_hash, &data);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8b0deb8cd2d54fb9f786a87feb95ee2a00771f6f",
      "candidate_info": {
        "commit_hash": "8b0deb8cd2d54fb9f786a87feb95ee2a00771f6f",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/8b0deb8cd2d54fb9f786a87feb95ee2a00771f6f",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "fix unserializer patch",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "366:     if (Z_TYPE_P(old_data) == IS_INDIRECT) {",
          "367:      old_data = Z_INDIRECT_P(old_data);",
          "368:     }",
          "370:     var_push_dtor(var_hash, old_data);",
          "372:    }",
          "374:   }",
          "376:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "369:     zval_ptr_dtor(old_data);",
          "371:     ZVAL_UNDEF(old_data);",
          "373:    data = zend_hash_update(ht, Z_STR(key), &d);",
          "",
          "[Added Lines]",
          "371:    data = zend_hash_update_ind(ht, Z_STR(key), &d);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "509:  start = cursor;",
          "513: {",
          "514:  YYCTYPE yych;",
          "515:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "512: #line 513 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "510: #line 511 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "569:  yych = *(YYMARKER = ++YYCURSOR);",
          "570:  if (yych == ':') goto yy95;",
          "571: yy3:",
          "573:  { return 0; }",
          "575: yy4:",
          "576:  yych = *(YYMARKER = ++YYCURSOR);",
          "577:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "572: #line 860 \"ext/standard/var_unserializer.re\"",
          "574: #line 575 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "570: #line 858 \"ext/standard/var_unserializer.re\"",
          "572: #line 573 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "614:  goto yy3;",
          "615: yy14:",
          "616:  ++YYCURSOR;",
          "618:  {",
          "620:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "622: }",
          "624: yy16:",
          "625:  yych = *++YYCURSOR;",
          "626:  goto yy3;",
          "",
          "[Removed Lines]",
          "617: #line 854 \"ext/standard/var_unserializer.re\"",
          "623: #line 624 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "615: #line 852 \"ext/standard/var_unserializer.re\"",
          "621: #line 622 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "651:  yych = *++YYCURSOR;",
          "652:  if (yych != '\"') goto yy18;",
          "653:  ++YYCURSOR;",
          "655:  {",
          "656:  size_t len, len2, len3, maxlen;",
          "657:  zend_long elements;",
          "",
          "[Removed Lines]",
          "654: #line 709 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "652: #line 707 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "797:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "798: }",
          "800: yy25:",
          "801:  yych = *++YYCURSOR;",
          "802:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "799: #line 800 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "797: #line 798 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "821:  yych = *++YYCURSOR;",
          "822:  if (yych != '\"') goto yy18;",
          "823:  ++YYCURSOR;",
          "825:  {",
          "",
          "[Removed Lines]",
          "824: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "822: #line 699 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "829:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "830:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "831: }",
          "833: yy32:",
          "834:  yych = *++YYCURSOR;",
          "835:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "832: #line 833 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "830: #line 831 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "850:  yych = *++YYCURSOR;",
          "851:  if (yych != '{') goto yy18;",
          "852:  ++YYCURSOR;",
          "854:  {",
          "855:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "853: #line 680 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "851: #line 678 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "872:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "873: }",
          "875: yy39:",
          "876:  yych = *++YYCURSOR;",
          "877:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "874: #line 875 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "872: #line 873 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "892:  yych = *++YYCURSOR;",
          "893:  if (yych != '\"') goto yy18;",
          "894:  ++YYCURSOR;",
          "896:  {",
          "897:  size_t len, maxlen;",
          "898:  zend_string *str;",
          "",
          "[Removed Lines]",
          "895: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "893: #line 650 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "920:  ZVAL_STR(rval, str);",
          "921:  return 1;",
          "922: }",
          "924: yy46:",
          "925:  yych = *++YYCURSOR;",
          "926:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "923: #line 924 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "921: #line 922 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "941:  yych = *++YYCURSOR;",
          "942:  if (yych != '\"') goto yy18;",
          "943:  ++YYCURSOR;",
          "945:  {",
          "946:  size_t len, maxlen;",
          "947:  char *str;",
          "",
          "[Removed Lines]",
          "944: #line 625 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "942: #line 623 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "968:  ZVAL_STRINGL(rval, str, len);",
          "969:  return 1;",
          "970: }",
          "972: yy53:",
          "973:  yych = *++YYCURSOR;",
          "974:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "971: #line 972 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "969: #line 970 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1056:  }",
          "1057: yy63:",
          "1058:  ++YYCURSOR;",
          "1060:  {",
          "1061: #if SIZEOF_ZEND_LONG == 4",
          "1062: use_double:",
          "",
          "[Removed Lines]",
          "1059: #line 616 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1057: #line 614 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1065:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1066:  return 1;",
          "1067: }",
          "1069: yy65:",
          "1070:  yych = *++YYCURSOR;",
          "1071:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1066: #line 1067 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1124:  yych = *++YYCURSOR;",
          "1125:  if (yych != ';') goto yy18;",
          "1126:  ++YYCURSOR;",
          "1128:  {",
          "",
          "[Removed Lines]",
          "1127: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1125: #line 598 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1141:  return 1;",
          "1142: }",
          "1144: yy76:",
          "1145:  yych = *++YYCURSOR;",
          "1146:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1143: #line 1144 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1141: #line 1142 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1167:  if (yych <= '9') goto yy79;",
          "1168:  if (yych != ';') goto yy18;",
          "1169:  ++YYCURSOR;",
          "1171:  {",
          "1172: #if SIZEOF_ZEND_LONG == 4",
          "1173:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1170: #line 574 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1168: #line 572 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1193:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1194:  return 1;",
          "1195: }",
          "1197: yy83:",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1201:  yych = *++YYCURSOR;",
          "1202:  if (yych != ';') goto yy18;",
          "1203:  ++YYCURSOR;",
          "1205:  {",
          "1207:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1208:  return 1;",
          "1209: }",
          "1211: yy87:",
          "1212:  ++YYCURSOR;",
          "1214:  {",
          "1216:  ZVAL_NULL(rval);",
          "1217:  return 1;",
          "1218: }",
          "1220: yy89:",
          "1221:  yych = *++YYCURSOR;",
          "1222:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1204: #line 568 \"ext/standard/var_unserializer.re\"",
          "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
          "1213: #line 562 \"ext/standard/var_unserializer.re\"",
          "1219: #line 1220 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1202: #line 566 \"ext/standard/var_unserializer.re\"",
          "1208: #line 1209 \"ext/standard/var_unserializer.c\"",
          "1211: #line 560 \"ext/standard/var_unserializer.re\"",
          "1217: #line 1218 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1239:  if (yych <= '9') goto yy91;",
          "1240:  if (yych != ';') goto yy18;",
          "1241:  ++YYCURSOR;",
          "1243:  {",
          "1244:  zend_long id;",
          "",
          "[Removed Lines]",
          "1242: #line 539 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1240: #line 537 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1263:  return 1;",
          "1264: }",
          "1266: yy95:",
          "1267:  yych = *++YYCURSOR;",
          "1268:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1265: #line 1266 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1263: #line 1264 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1285:  if (yych <= '9') goto yy97;",
          "1286:  if (yych != ';') goto yy18;",
          "1287:  ++YYCURSOR;",
          "1289:  {",
          "1290:  zend_long id;",
          "",
          "[Removed Lines]",
          "1288: #line 517 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1286: #line 515 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1308:  return 1;",
          "1309: }",
          "1311: }",
          "1315:  return 0;",
          "",
          "[Removed Lines]",
          "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
          "1312: #line 862 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1308: #line 1309 \"ext/standard/var_unserializer.c\"",
          "1310: #line 860 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "370:     if (Z_TYPE_P(old_data) == IS_INDIRECT) {",
          "371:      old_data = Z_INDIRECT_P(old_data);",
          "372:     }",
          "374:     var_push_dtor(var_hash, old_data);",
          "376:    }",
          "378:   }",
          "380:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "373:     zval_ptr_dtor(old_data);",
          "375:     ZVAL_UNDEF(old_data);",
          "377:    data = zend_hash_update(ht, Z_STR(key), &d);",
          "",
          "[Added Lines]",
          "375:    data = zend_hash_update_ind(ht, Z_STR(key), &d);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
      "candidate_info": {
        "commit_hash": "fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
        "files": [
          "ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Also fixed 'r'",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt": [
          "File: ext/standard/tests/serialize/bug70963.phpt -> ext/standard/tests/serialize/bug70963.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: --FILE--",
          "4: <?php",
          "5: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;R:3;}'));",
          "6: ?>",
          "7: --EXPECTF--",
          "9:   [0]=>",
          "10:   object(Exception)#%d (5) {",
          "11:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "8: array(2) {",
          "",
          "[Added Lines]",
          "6: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;r:3;}'));",
          "9: array(1) {",
          "10:   [0]=>",
          "11:   object(Exception)#%d (5) {",
          "12:     [\"message\":protected]=>",
          "13:     string(0) \"\"",
          "14:     [\"string\":\"Exception\":private]=>",
          "15:     string(0) \"\"",
          "16:     [\"code\":protected]=>",
          "17:     int(0)",
          "18:     [\"file\":protected]=>",
          "19:     string(%d) \"%s\"",
          "20:     [\"line\":protected]=>",
          "21:     int(%d)",
          "22:   }",
          "23: }",
          "24: array(1) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "365:    }",
          "366:   }",
          "370:   if (!php_var_unserialize_ex(data, p, max, var_hash, classes)) {",
          "371:    return 0;",
          "372:   }",
          "376:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "377:    (*p)--;",
          "",
          "[Removed Lines]",
          "368:   zval_dtor(&key);",
          "374:   var_push_dtor(var_hash, data);",
          "",
          "[Added Lines]",
          "369:    zval_dtor(&key);",
          "373:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "374:    if (Z_TYPE(key) == IS_LONG) {",
          "375:     zend_hash_index_del(ht, Z_LVAL(key));",
          "376:    } else {",
          "377:     zend_hash_del_ind(ht, Z_STR(key));",
          "378:    }",
          "379:   } else {",
          "380:    var_push_dtor(var_hash, data);",
          "381:   }",
          "383:   zval_dtor(&key);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "505:  start = cursor;",
          "509: {",
          "510:  YYCTYPE yych;",
          "511:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "508: #line 509 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "517: #line 518 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "565:  yych = *(YYMARKER = ++YYCURSOR);",
          "566:  if (yych == ':') goto yy95;",
          "567: yy3:",
          "569:  { return 0; }",
          "571: yy4:",
          "572:  yych = *(YYMARKER = ++YYCURSOR);",
          "573:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "568: #line 857 \"ext/standard/var_unserializer.re\"",
          "570: #line 571 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "577: #line 869 \"ext/standard/var_unserializer.re\"",
          "579: #line 580 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "610:  goto yy3;",
          "611: yy14:",
          "612:  ++YYCURSOR;",
          "614:  {",
          "616:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "618: }",
          "620: yy16:",
          "621:  yych = *++YYCURSOR;",
          "622:  goto yy3;",
          "",
          "[Removed Lines]",
          "613: #line 851 \"ext/standard/var_unserializer.re\"",
          "619: #line 620 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "622: #line 863 \"ext/standard/var_unserializer.re\"",
          "628: #line 629 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "646:  yych = *++YYCURSOR;",
          "647:  if (yych != '\"') goto yy18;",
          "648:  ++YYCURSOR;",
          "650:  {",
          "651:  size_t len, len2, len3, maxlen;",
          "652:  zend_long elements;",
          "",
          "[Removed Lines]",
          "649: #line 706 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "658: #line 718 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "792:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "793: }",
          "795: yy25:",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "794: #line 795 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "803: #line 804 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "816:  yych = *++YYCURSOR;",
          "817:  if (yych != '\"') goto yy18;",
          "818:  ++YYCURSOR;",
          "820:  {",
          "821:     if (!var_hash) return 0;",
          "823:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "824:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "825: }",
          "827: yy32:",
          "828:  yych = *++YYCURSOR;",
          "829:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "819: #line 699 \"ext/standard/var_unserializer.re\"",
          "826: #line 827 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "828: #line 711 \"ext/standard/var_unserializer.re\"",
          "835: #line 836 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "844:  yych = *++YYCURSOR;",
          "845:  if (yych != '{') goto yy18;",
          "846:  ++YYCURSOR;",
          "848:  {",
          "849:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "847: #line 675 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "856: #line 687 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "869:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "870: }",
          "872: yy39:",
          "873:  yych = *++YYCURSOR;",
          "874:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "871: #line 872 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "880: #line 881 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "889:  yych = *++YYCURSOR;",
          "890:  if (yych != '\"') goto yy18;",
          "891:  ++YYCURSOR;",
          "893:  {",
          "894:  size_t len, maxlen;",
          "895:  zend_string *str;",
          "",
          "[Removed Lines]",
          "892: #line 647 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "901: #line 659 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "917:  ZVAL_STR(rval, str);",
          "918:  return 1;",
          "919: }",
          "921: yy46:",
          "922:  yych = *++YYCURSOR;",
          "923:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "920: #line 921 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "929: #line 930 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych != '\"') goto yy18;",
          "940:  ++YYCURSOR;",
          "942:  {",
          "943:  size_t len, maxlen;",
          "944:  char *str;",
          "",
          "[Removed Lines]",
          "941: #line 620 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "950: #line 632 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "965:  ZVAL_STRINGL(rval, str, len);",
          "966:  return 1;",
          "967: }",
          "969: yy53:",
          "970:  yych = *++YYCURSOR;",
          "971:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "968: #line 969 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1053:  }",
          "1054: yy63:",
          "1055:  ++YYCURSOR;",
          "1057:  {",
          "1058: #if SIZEOF_ZEND_LONG == 4",
          "1059: use_double:",
          "",
          "[Removed Lines]",
          "1056: #line 611 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1065: #line 623 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1062:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1063:  return 1;",
          "1064: }",
          "1066: yy65:",
          "1067:  yych = *++YYCURSOR;",
          "1068:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1065: #line 1066 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1121:  yych = *++YYCURSOR;",
          "1122:  if (yych != ';') goto yy18;",
          "1123:  ++YYCURSOR;",
          "1125:  {",
          "",
          "[Removed Lines]",
          "1124: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1133: #line 607 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1138:  return 1;",
          "1139: }",
          "1141: yy76:",
          "1142:  yych = *++YYCURSOR;",
          "1143:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1140: #line 1141 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1149: #line 1150 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1164:  if (yych <= '9') goto yy79;",
          "1165:  if (yych != ';') goto yy18;",
          "1166:  ++YYCURSOR;",
          "1168:  {",
          "1169: #if SIZEOF_ZEND_LONG == 4",
          "1170:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1167: #line 569 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1176: #line 581 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1190:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1191:  return 1;",
          "1192: }",
          "1194: yy83:",
          "1195:  yych = *++YYCURSOR;",
          "1196:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1202: #line 1203 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych != ';') goto yy18;",
          "1200:  ++YYCURSOR;",
          "1202:  {",
          "1204:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1205:  return 1;",
          "1206: }",
          "1208: yy87:",
          "1209:  ++YYCURSOR;",
          "1211:  {",
          "1213:  ZVAL_NULL(rval);",
          "1214:  return 1;",
          "1215: }",
          "1217: yy89:",
          "1218:  yych = *++YYCURSOR;",
          "1219:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1201: #line 563 \"ext/standard/var_unserializer.re\"",
          "1207: #line 1208 \"ext/standard/var_unserializer.c\"",
          "1210: #line 557 \"ext/standard/var_unserializer.re\"",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1210: #line 575 \"ext/standard/var_unserializer.re\"",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "1219: #line 569 \"ext/standard/var_unserializer.re\"",
          "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1236:  if (yych <= '9') goto yy91;",
          "1237:  if (yych != ';') goto yy18;",
          "1238:  ++YYCURSOR;",
          "1240:  {",
          "1241:  zend_long id;",
          "",
          "[Removed Lines]",
          "1239: #line 541 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1248: #line 548 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1248:   return 0;",
          "1249:  }",
          "1251:  ZVAL_COPY(rval, rval_ref);",
          "1253:  return 1;",
          "1254: }",
          "1256: yy95:",
          "1257:  yych = *++YYCURSOR;",
          "1258:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1255: #line 1256 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1260:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1261:   ZVAL_UNDEF(rval);",
          "1262:   return 1;",
          "1263:  }",
          "1269: #line 1270 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1275:  if (yych <= '9') goto yy97;",
          "1276:  if (yych != ';') goto yy18;",
          "1277:  ++YYCURSOR;",
          "1279:  {",
          "1280:  zend_long id;",
          "",
          "[Removed Lines]",
          "1278: #line 513 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1292: #line 522 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1288:  }",
          "1290:  zval_ptr_dtor(rval);",
          "1298:   ZVAL_UNDEF(rval);",
          "1299:  } else {",
          "1300:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1301:   ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "1291:  if (Z_ISREF_P(rval_ref)) {",
          "1292:   if (!Z_ISUNDEF_P(Z_REFVAL_P(rval_ref))) {",
          "1293:    ZVAL_COPY(rval, rval_ref);",
          "1294:   } else {",
          "1295:    ZVAL_UNDEF(rval);",
          "1296:   }",
          "1297:  } else if (Z_ISUNDEF_P(rval_ref)) {",
          "",
          "[Added Lines]",
          "1305:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1307:   return 1;",
          "1308:  }",
          "1309:  if (Z_ISREF_P(rval_ref)) {",
          "1310:   ZVAL_COPY(rval, rval_ref);",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1304:  return 1;",
          "1305: }",
          "1307: }",
          "1311:  return 0;",
          "",
          "[Removed Lines]",
          "1306: #line 1307 \"ext/standard/var_unserializer.c\"",
          "1308: #line 859 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1318: #line 1319 \"ext/standard/var_unserializer.c\"",
          "1320: #line 871 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "369:    }",
          "370:   }",
          "374:   if (!php_var_unserialize_ex(data, p, max, var_hash, classes)) {",
          "375:    return 0;",
          "376:   }",
          "380:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "381:    (*p)--;",
          "",
          "[Removed Lines]",
          "372:   zval_dtor(&key);",
          "378:   var_push_dtor(var_hash, data);",
          "",
          "[Added Lines]",
          "373:    zval_dtor(&key);",
          "377:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "378:    if (Z_TYPE(key) == IS_LONG) {",
          "379:     zend_hash_index_del(ht, Z_LVAL(key));",
          "380:    } else {",
          "381:     zend_hash_del_ind(ht, Z_STR(key));",
          "382:    }",
          "383:   } else {",
          "384:    var_push_dtor(var_hash, data);",
          "385:   }",
          "387:   zval_dtor(&key);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "522:  }",
          "524:  zval_ptr_dtor(rval);",
          "532:   ZVAL_UNDEF(rval);",
          "533:  } else {",
          "534:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "535:   ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "525:  if (Z_ISREF_P(rval_ref)) {",
          "526:   if (!Z_ISUNDEF_P(Z_REFVAL_P(rval_ref))) {",
          "527:    ZVAL_COPY(rval, rval_ref);",
          "528:   } else {",
          "529:    ZVAL_UNDEF(rval);",
          "530:   }",
          "531:  } else if (Z_ISUNDEF_P(rval_ref)) {",
          "",
          "[Added Lines]",
          "534:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "536:   return 1;",
          "537:  }",
          "538:  if (Z_ISREF_P(rval_ref)) {",
          "539:   ZVAL_COPY(rval, rval_ref);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "549:   return 0;",
          "550:  }",
          "552:  ZVAL_COPY(rval, rval_ref);",
          "554:  return 1;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "559:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "560:   ZVAL_UNDEF(rval);",
          "561:   return 1;",
          "562:  }",
          "",
          "---------------"
        ]
      }
    }
  ]
}