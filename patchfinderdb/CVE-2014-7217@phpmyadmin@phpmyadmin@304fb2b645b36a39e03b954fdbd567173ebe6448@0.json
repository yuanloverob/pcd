{
  "cve_id": "CVE-2014-7217",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.4, 4.1.x before 4.1.14.5, and 4.2.x before 4.2.9.1 allow remote authenticated users to inject arbitrary web script or HTML via a crafted ENUM value that is improperly handled during rendering of the (1) table search or (2) table structure page, related to libraries/TableSearch.class.php and libraries/Util.class.php.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "304fb2b645b36a39e03b954fdbd567173ebe6448",
  "patch_info": {
    "commit_hash": "304fb2b645b36a39e03b954fdbd567173ebe6448",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/304fb2b645b36a39e03b954fdbd567173ebe6448",
    "files": [
      "libraries/TableSearch.class.php"
    ],
    "message": "Bug 4544: additional fix for 4.2.x\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
    "before_after_code_files": [
      "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
    ]
  },
  "patch_diff": {
    "libraries/TableSearch.class.php||libraries/TableSearch.class.php": [
      "File: libraries/TableSearch.class.php -> libraries/TableSearch.class.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "992:             $html_output .= '<td>' . $properties['collation'] . '</td>';",
      "993:             $html_output .= '<td>' . $properties['func'] . '</td>';",
      "996:                 . '>' . $properties['value'] . '</td>';",
      "997:             $html_output .= '</tr>';",
      "",
      "[Removed Lines]",
      "995:             $html_output .= '<td data-type=\"' . $properties['type'] . '\"'",
      "",
      "[Added Lines]",
      "995:             $html_output .= '<td data-type=\"'",
      "996:                 . htmlspecialchars($properties['type']) . '\"'",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9cb2f3e29ea7854006b932cab1c2e45767b23f88",
      "candidate_info": {
        "commit_hash": "9cb2f3e29ea7854006b932cab1c2e45767b23f88",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/9cb2f3e29ea7854006b932cab1c2e45767b23f88",
        "files": [
          "libraries/TableSearch.class.php"
        ],
        "message": "Bug 4544: additional fix for 4.2.x\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
          ],
          "candidate": [
            "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/TableSearch.class.php||libraries/TableSearch.class.php": [
          "File: libraries/TableSearch.class.php -> libraries/TableSearch.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "992:             $html_output .= '<td>' . $properties['collation'] . '</td>';",
          "993:             $html_output .= '<td>' . $properties['func'] . '</td>';",
          "996:                 . '>' . $properties['value'] . '</td>';",
          "997:             $html_output .= '</tr>';",
          "",
          "[Removed Lines]",
          "995:             $html_output .= '<td data-type=\"' . $properties['type'] . '\"'",
          "",
          "[Added Lines]",
          "995:             $html_output .= '<td data-type=\"'",
          "996:                 . htmlspecialchars($properties['type']) . '\"'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ff4be7ee5a71f29921089d447e658630ef7cbfef",
      "candidate_info": {
        "commit_hash": "ff4be7ee5a71f29921089d447e658630ef7cbfef",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/ff4be7ee5a71f29921089d447e658630ef7cbfef",
        "files": [
          "libraries/TableSearch.class.php"
        ],
        "message": "Bug 4544: additional fix for 4.2.x\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
          ],
          "candidate": [
            "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/TableSearch.class.php||libraries/TableSearch.class.php": [
          "File: libraries/TableSearch.class.php -> libraries/TableSearch.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "995:             $html_output .= '<td>' . $properties['collation'] . '</td>';",
          "996:             $html_output .= '<td>' . $properties['func'] . '</td>';",
          "999:                 . '>' . $properties['value'] . '</td>';",
          "1000:             $html_output .= '</tr>';",
          "",
          "[Removed Lines]",
          "998:             $html_output .= '<td data-type=\"' . $properties['type'] . '\"'",
          "",
          "[Added Lines]",
          "998:             $html_output .= '<td data-type=\"'",
          "999:                 . htmlspecialchars($properties['type']) . '\"'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2986cdcd8ad182b9072824b19998f507b4e871d7",
      "candidate_info": {
        "commit_hash": "2986cdcd8ad182b9072824b19998f507b4e871d7",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/2986cdcd8ad182b9072824b19998f507b4e871d7",
        "files": [
          "ChangeLog",
          "libraries/TableSearch.class.php"
        ],
        "message": "bug #4419 No more calendar into search tab\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
          ],
          "candidate": [
            "libraries/TableSearch.class.php||libraries/TableSearch.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/TableSearch.class.php||libraries/TableSearch.class.php": [
          "File: libraries/TableSearch.class.php -> libraries/TableSearch.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "986:             $html_output .= '<td>' . $properties['type'] . '</td>';",
          "987:             $html_output .= '<td>' . $properties['collation'] . '</td>';",
          "988:             $html_output .= '<td>' . $properties['func'] . '</td>';",
          "990:             $html_output .= '</tr>';",
          "992:             $html_output .= '<tr><td>';",
          "",
          "[Removed Lines]",
          "989:             $html_output .= '<td>' . $properties['value'] . '</td>';",
          "",
          "[Added Lines]",
          "990:             $html_output .= '<td data-type=\"' . $properties['type'] . '\"'",
          "991:                 . '>' . $properties['value'] . '</td>';",
          "",
          "---------------"
        ]
      }
    }
  ]
}