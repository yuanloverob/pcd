{
  "cve_id": "CVE-2015-5302",
  "cve_desc": "libreport 2.0.7 before 2.6.3 only saves changes to the first file when editing a crash report, which allows remote attackers to obtain sensitive information via unspecified vectors related to the (1) backtrace, (2) cmdline, (3) environ, (4) open_fds, (5) maps, (6) smaps, (7) hostname, (8) remote, (9) ks.cfg, or (10) anaconda-tb file attachment included in a Red Hat Bugzilla bug report.",
  "repo": "abrt/libreport",
  "patch_hash": "257578a23d1537a2d235aaa2b1488ee4f818e360",
  "patch_info": {
    "commit_hash": "257578a23d1537a2d235aaa2b1488ee4f818e360",
    "repo": "abrt/libreport",
    "commit_url": "https://github.com/abrt/libreport/commit/257578a23d1537a2d235aaa2b1488ee4f818e360",
    "files": [
      "src/gui-wizard-gtk/wizard.c"
    ],
    "message": "wizard: fix save users changes after reviewing dump dir files\n\nIf the user reviewed the dump dir's files during reporting the crash, the\nchanges was thrown away and original data was passed to the bugzilla bug\nreport.\n\nreport-gtk saves the first text view buffer and then reloads data from the\nreported problem directory, which causes that the changes made to those text\nviews are thrown away.\n\nFunction save_text_if_changed(), except of saving text, also reload the files\nfrom dump dir and update gui state from the dump dir. The commit moves the\nreloading and updating gui functions away from this function.\n\nRelated to rhbz#1270235\n\nSigned-off-by: Matej Habrnal <mhabrnal@redhat.com>",
    "before_after_code_files": [
      "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c"
    ]
  },
  "patch_diff": {
    "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c": [
      "File: src/gui-wizard-gtk/wizard.c -> src/gui-wizard-gtk/wizard.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "435:         dd_close(dd);",
      "438:     }",
      "439: }",
      "",
      "[Removed Lines]",
      "436:         problem_data_reload_from_dump_dir();",
      "437:         update_gui_state_from_problem_data(/* don't update selected event */ 0);",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "777:         load_text_to_text_view(GTK_TEXT_VIEW(textview), item_name);",
      "779:         if (gtk_dialog_run(GTK_DIALOG(dialog)) == GTK_RESPONSE_OK)",
      "780:             save_text_from_text_view(GTK_TEXT_VIEW(textview), item_name);",
      "782:         gtk_widget_destroy(textview);",
      "783:         gtk_widget_destroy(scrolled);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "778:         {",
      "780:             problem_data_reload_from_dump_dir();",
      "781:             update_gui_state_from_problem_data(/* don't update selected event */ 0);",
      "782:         }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "2710:     save_items_from_notepad();",
      "2711:     save_text_from_text_view(g_tv_comment, FILENAME_COMMENT);",
      "2714:     if (pages[PAGENO_SUMMARY].page_widget == page)",
      "2715:     {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2714:     problem_data_reload_from_dump_dir();",
      "2715:     update_gui_state_from_problem_data(/* don't update selected event */ 0);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "3e4ebd63bb0cb7620202ff288c34db3b51285699",
      "candidate_info": {
        "commit_hash": "3e4ebd63bb0cb7620202ff288c34db3b51285699",
        "repo": "abrt/libreport",
        "commit_url": "https://github.com/abrt/libreport/commit/3e4ebd63bb0cb7620202ff288c34db3b51285699",
        "files": [
          "src/gui-wizard-gtk/wizard.c"
        ],
        "message": "wizard: fix save users changes after reviewing dump dir files\n\nIf the user reviewed the dump dir's files during reporting the crash, the\nchanges was thrown away and original data was passed to the bugzilla bug\nreport.\n\nreport-gtk saves the first text view buffer and then reloads data from the\nreported problem directory, which causes that the changes made to those text\nviews are thrown away.\n\nFunction save_text_if_changed(), except of saving text, also reload the files\nfrom dump dir and update gui state from the dump dir. The commit moves the\nreloading and updating gui functions away from this function.\n\nRelated to rhbz#1270235\n\nSigned-off-by: Matej Habrnal <mhabrnal@redhat.com>",
        "before_after_code_files": [
          "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c"
          ],
          "candidate": [
            "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c"
          ]
        }
      },
      "candidate_diff": {
        "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c": [
          "File: src/gui-wizard-gtk/wizard.c -> src/gui-wizard-gtk/wizard.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "497:         dd_close(dd);",
          "500:     }",
          "501: }",
          "",
          "[Removed Lines]",
          "498:         problem_data_reload_from_dump_dir();",
          "499:         update_gui_state_from_problem_data(/* don't update selected event */ 0);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "839:         load_text_to_text_view(GTK_TEXT_VIEW(textview), item_name);",
          "841:         if (gtk_dialog_run(GTK_DIALOG(dialog)) == GTK_RESPONSE_OK)",
          "842:             save_text_from_text_view(GTK_TEXT_VIEW(textview), item_name);",
          "844:         gtk_widget_destroy(textview);",
          "845:         gtk_widget_destroy(scrolled);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "840:         {",
          "842:             problem_data_reload_from_dump_dir();",
          "843:             update_gui_state_from_problem_data(/* don't update selected event */ 0);",
          "844:         }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2663:     save_items_from_notepad();",
          "2664:     save_text_from_text_view(g_tv_comment, FILENAME_COMMENT);",
          "2667:     if (pages[PAGENO_SUMMARY].page_widget == page)",
          "2668:     {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2667:     problem_data_reload_from_dump_dir();",
          "2668:     update_gui_state_from_problem_data(/* don't update selected event */ 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d82726d9343d10efb62944138f922aa03d867104",
      "candidate_info": {
        "commit_hash": "d82726d9343d10efb62944138f922aa03d867104",
        "repo": "abrt/libreport",
        "commit_url": "https://github.com/abrt/libreport/commit/d82726d9343d10efb62944138f922aa03d867104",
        "files": [
          "src/gui-wizard-gtk/wizard.c"
        ],
        "message": "wizard: fix save users changes after reviewing dump dir files\n\nIf the user reviewed the dump dir's files during reporting the crash, the\nchanges was thrown away and original data was passed to the bugzilla bug\nreport.\n\nreport-gtk saves the first text view buffer and then reloads data from the\nreported problem directory, which causes that the changes made to those text\nviews are thrown away.\n\nFunction save_text_if_changed(), except of saving text, also reload the files\nfrom dump dir and update gui state from the dump dir. The commit moves the\nreloading and updating gui functions away from this function.\n\nRelated to rhbz#1270235\n\nSigned-off-by: Matej Habrnal <mhabrnal@redhat.com>\nSigned-off-by: Jakub Filak <jfilak@redhat.com>",
        "before_after_code_files": [
          "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c"
          ],
          "candidate": [
            "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c"
          ]
        }
      },
      "candidate_diff": {
        "src/gui-wizard-gtk/wizard.c||src/gui-wizard-gtk/wizard.c": [
          "File: src/gui-wizard-gtk/wizard.c -> src/gui-wizard-gtk/wizard.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "519:         struct dump_dir *dd = dd_opendir(g_dump_dir_name, DD_OPEN_READONLY);",
          "520:         dd = steal_if_needed(dd);",
          "521:         if (dd && dd->locked)",
          "523:             dd_save_text(dd, name, new_value);",
          "526:         dd_close(dd);",
          "529:     }",
          "530: }",
          "",
          "[Removed Lines]",
          "522:         {",
          "524:         }",
          "527:         reload_problem_data_from_dump_dir();",
          "528:         update_gui_state_from_problem_data();",
          "",
          "[Added Lines]",
          "523:         else",
          "524:             error_msg(_(\"Failed to save file '%s'\"), name);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "648:         load_text_to_text_view(GTK_TEXT_VIEW(textview), item_name);",
          "650:         if (gtk_dialog_run(GTK_DIALOG(dialog)) == GTK_RESPONSE_OK)",
          "651:             save_text_from_text_view(GTK_TEXT_VIEW(textview), item_name);",
          "653:         gtk_widget_destroy(textview);",
          "654:         gtk_widget_destroy(scrolled);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "649:         {",
          "651:             reload_problem_data_from_dump_dir();",
          "652:             update_gui_state_from_problem_data();",
          "653:         }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2020: {",
          "2022:     save_items_from_notepad();",
          "2025:     update_gui_state_from_problem_data();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2025:     reload_problem_data_from_dump_dir();",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2290:     save_items_from_notepad();",
          "2291:     save_text_from_text_view(g_tv_comment, FILENAME_COMMENT);",
          "2293:     if (pages[PAGENO_SUMMARY].page_widget == page",
          "2294:      || pages[PAGENO_REVIEW_DATA].page_widget == page",
          "2295:     ) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2296:     reload_problem_data_from_dump_dir();",
          "2297:     update_gui_state_from_problem_data();",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2347: #endif",
          "2349:     case PAGENO_EDIT_BACKTRACE:",
          "2352:         break;",
          "2354:     case PAGENO_ANALYZE_SELECTOR:",
          "",
          "[Removed Lines]",
          "2350:         if (!get_problem_item_content_or_NULL(g_cd, FILENAME_BACKTRACE))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}