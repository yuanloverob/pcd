{
  "cve_id": "CVE-2016-7124",
  "cve_desc": "ext/standard/var_unserializer.c in PHP before 5.6.25 and 7.x before 7.0.10 mishandles certain invalid objects, which allows remote attackers to cause a denial of service or possibly have unspecified other impact via crafted serialized data that leads to a (1) __destruct call or (2) magic method call.",
  "repo": "php/php-src",
  "patch_hash": "448c9be157f4147e121f1a2a524536c75c9c6059",
  "patch_info": {
    "commit_hash": "448c9be157f4147e121f1a2a524536c75c9c6059",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/448c9be157f4147e121f1a2a524536c75c9c6059",
    "files": [
      "ext/standard/tests/strings/bug72663.phpt",
      "ext/standard/tests/strings/bug72663_2.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #72663 - destroy broken object when unserializing",
    "before_after_code_files": [
      "ext/standard/tests/strings/bug72663.phpt||ext/standard/tests/strings/bug72663.phpt",
      "ext/standard/tests/strings/bug72663_2.phpt||ext/standard/tests/strings/bug72663_2.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/strings/bug72663.phpt||ext/standard/tests/strings/bug72663.phpt": [
      "File: ext/standard/tests/strings/bug72663.phpt -> ext/standard/tests/strings/bug72663.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #72663: Create an Unexpected Object and Don't Invoke __wakeup() in Deserialization",
      "3: --FILE--",
      "4: <?php",
      "5: class obj implements Serializable {",
      "6:     var $data;",
      "7:     function serialize() {",
      "8:         return serialize($this->data);",
      "9:     }",
      "10:     function unserialize($data) {",
      "11:         $this->data = unserialize($data);",
      "12:     }",
      "13: }",
      "15: $inner = 'a:1:{i:0;O:9:\"Exception\":2:{s:7:\"'.\"\\0\".'*'.\"\\0\".'file\";R:4;}';",
      "16: $exploit = 'a:2:{i:0;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}i:1;R:4;}';",
      "18: $data = unserialize($exploit);",
      "19: echo $data[1];",
      "20: ?>",
      "21: DONE",
      "22: --EXPECTF--",
      "23: Notice: unserialize(): Unexpected end of serialized data in %sbug72663.php on line %d",
      "25: Notice: unserialize(): Error at offset 46 of 47 bytes in %sbug72663.php on line %d",
      "26: DONE",
      "",
      "---------------"
    ],
    "ext/standard/tests/strings/bug72663_2.phpt||ext/standard/tests/strings/bug72663_2.phpt": [
      "File: ext/standard/tests/strings/bug72663_2.phpt -> ext/standard/tests/strings/bug72663_2.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #72663: Create an Unexpected Object and Don't Invoke __wakeup() in Deserialization",
      "3: --FILE--",
      "4: <?php",
      "6: ini_set('session.serialize_handler', 'php_serialize');",
      "7: session_start();",
      "8: $sess = 'O:9:\"Exception\":2:{s:7:\"'.\"\\0\".'*'.\"\\0\".'file\";R:1;}';",
      "9: session_decode($sess);",
      "10: var_dump($_SESSION);",
      "11: ?>",
      "12: DONE",
      "13: --EXPECTF--",
      "14: Notice: session_decode(): Unexpected end of serialized data in %sbug72663_2.php on line %d",
      "15: array(0) {",
      "16: }",
      "17: DONE",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "434:  }",
      "436:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_OBJPROP_PP(rval), elements, 1)) {",
      "437:   return 0;",
      "438:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "438:      zend_hash_clean(Z_OBJPROP_PP(rval));",
      "439:      ZVAL_NULL(*rval);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "486: {",
      "487:  YYCTYPE yych;",
      "488:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "485: #line 486 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "488: #line 489 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "542:  yych = *(YYMARKER = ++YYCURSOR);",
      "543:  if (yych == ':') goto yy95;",
      "544: yy3:",
      "546:  { return 0; }",
      "548: yy4:",
      "549:  yych = *(YYMARKER = ++YYCURSOR);",
      "550:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "545: #line 851 \"ext/standard/var_unserializer.re\"",
      "547: #line 548 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "548: #line 854 \"ext/standard/var_unserializer.re\"",
      "550: #line 551 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "587:  goto yy3;",
      "588: yy14:",
      "589:  ++YYCURSOR;",
      "591:  {",
      "593:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "595: }",
      "597: yy16:",
      "598:  yych = *++YYCURSOR;",
      "599:  goto yy3;",
      "",
      "[Removed Lines]",
      "590: #line 845 \"ext/standard/var_unserializer.re\"",
      "596: #line 597 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "593: #line 848 \"ext/standard/var_unserializer.re\"",
      "599: #line 600 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "619:  if (yybm[0+yych] & 128) {",
      "620:   goto yy20;",
      "621:  }",
      "623:  yych = *++YYCURSOR;",
      "624:  if (yych != '\"') goto yy18;",
      "625:  ++YYCURSOR;",
      "627:  {",
      "628:  size_t len, len2, len3, maxlen;",
      "629:  long elements;",
      "",
      "[Removed Lines]",
      "622:  if (yych != ':') goto yy18;",
      "626: #line 698 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "625:  if (yych <= '/') goto yy18;",
      "626:  if (yych >= ';') goto yy18;",
      "630: #line 701 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "771:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "772: }",
      "774: yy25:",
      "775:  yych = *++YYCURSOR;",
      "776:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "773: #line 774 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "777: #line 778 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "795:  yych = *++YYCURSOR;",
      "796:  if (yych != '\"') goto yy18;",
      "797:  ++YYCURSOR;",
      "799:  {",
      "800:     if (!var_hash) return 0;",
      "",
      "[Removed Lines]",
      "798: #line 689 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "802: #line 692 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "804:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "805:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "806: }",
      "808: yy32:",
      "809:  yych = *++YYCURSOR;",
      "810:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "807: #line 808 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "811: #line 812 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "825:  yych = *++YYCURSOR;",
      "826:  if (yych != '{') goto yy18;",
      "827:  ++YYCURSOR;",
      "829:  {",
      "830:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "828: #line 668 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "832: #line 671 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "847:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "848: }",
      "850: yy39:",
      "851:  yych = *++YYCURSOR;",
      "852:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "849: #line 850 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "853: #line 854 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "867:  yych = *++YYCURSOR;",
      "868:  if (yych != '\"') goto yy18;",
      "869:  ++YYCURSOR;",
      "871:  {",
      "872:  size_t len, maxlen;",
      "873:  char *str;",
      "",
      "[Removed Lines]",
      "870: #line 633 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "874: #line 636 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "902:  ZVAL_STRINGL(*rval, str, len, 0);",
      "903:  return 1;",
      "904: }",
      "906: yy46:",
      "907:  yych = *++YYCURSOR;",
      "908:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "905: #line 906 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "909: #line 910 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "923:  yych = *++YYCURSOR;",
      "924:  if (yych != '\"') goto yy18;",
      "925:  ++YYCURSOR;",
      "927:  {",
      "928:  size_t len, maxlen;",
      "929:  char *str;",
      "",
      "[Removed Lines]",
      "926: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "930: #line 603 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "956:  ZVAL_STRINGL(*rval, str, len, 1);",
      "957:  return 1;",
      "958: }",
      "960: yy53:",
      "961:  yych = *++YYCURSOR;",
      "962:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "959: #line 960 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "963: #line 964 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1044:  }",
      "1045: yy63:",
      "1046:  ++YYCURSOR;",
      "1048:  {",
      "1049: #if SIZEOF_LONG == 4",
      "1050: use_double:",
      "",
      "[Removed Lines]",
      "1047: #line 590 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1051: #line 593 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1054:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1055:  return 1;",
      "1056: }",
      "1058: yy65:",
      "1059:  yych = *++YYCURSOR;",
      "1060:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1057: #line 1058 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1061: #line 1062 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1113:  yych = *++YYCURSOR;",
      "1114:  if (yych != ';') goto yy18;",
      "1115:  ++YYCURSOR;",
      "1117:  {",
      "1119:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1116: #line 575 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1120: #line 578 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1129:  return 1;",
      "1130: }",
      "1132: yy76:",
      "1133:  yych = *++YYCURSOR;",
      "1134:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1131: #line 1132 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1135: #line 1136 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1155:  if (yych <= '9') goto yy79;",
      "1156:  if (yych != ';') goto yy18;",
      "1157:  ++YYCURSOR;",
      "1159:  {",
      "1160: #if SIZEOF_LONG == 4",
      "1161:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1158: #line 548 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1162: #line 551 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1182:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1183:  return 1;",
      "1184: }",
      "1186: yy83:",
      "1187:  yych = *++YYCURSOR;",
      "1188:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1185: #line 1186 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1189: #line 1190 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1190:  yych = *++YYCURSOR;",
      "1191:  if (yych != ';') goto yy18;",
      "1192:  ++YYCURSOR;",
      "1194:  {",
      "1196:  INIT_PZVAL(*rval);",
      "1197:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1198:  return 1;",
      "1199: }",
      "1201: yy87:",
      "1202:  ++YYCURSOR;",
      "1204:  {",
      "1206:  INIT_PZVAL(*rval);",
      "1207:  ZVAL_NULL(*rval);",
      "1208:  return 1;",
      "1209: }",
      "1211: yy89:",
      "1212:  yych = *++YYCURSOR;",
      "1213:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1193: #line 541 \"ext/standard/var_unserializer.re\"",
      "1200: #line 1201 \"ext/standard/var_unserializer.c\"",
      "1203: #line 534 \"ext/standard/var_unserializer.re\"",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1197: #line 544 \"ext/standard/var_unserializer.re\"",
      "1204: #line 1205 \"ext/standard/var_unserializer.c\"",
      "1207: #line 537 \"ext/standard/var_unserializer.re\"",
      "1214: #line 1215 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1230:  if (yych <= '9') goto yy91;",
      "1231:  if (yych != ';') goto yy18;",
      "1232:  ++YYCURSOR;",
      "1234:  {",
      "1235:  long id;",
      "",
      "[Removed Lines]",
      "1233: #line 511 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1237: #line 514 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1254:  return 1;",
      "1255: }",
      "1257: yy95:",
      "1258:  yych = *++YYCURSOR;",
      "1259:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1256: #line 1257 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1260: #line 1261 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1276:  if (yych <= '9') goto yy97;",
      "1277:  if (yych != ';') goto yy18;",
      "1278:  ++YYCURSOR;",
      "1280:  {",
      "1281:  long id;",
      "",
      "[Removed Lines]",
      "1279: #line 490 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1283: #line 493 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1298:  return 1;",
      "1299: }",
      "1301: }",
      "1305:  return 0;",
      "",
      "[Removed Lines]",
      "1300: #line 1301 \"ext/standard/var_unserializer.c\"",
      "1302: #line 853 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1304: #line 1305 \"ext/standard/var_unserializer.c\"",
      "1306: #line 856 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "438:  }",
      "440:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_OBJPROP_PP(rval), elements, 1)) {",
      "441:   return 0;",
      "442:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "442:      zend_hash_clean(Z_OBJPROP_PP(rval));",
      "443:      ZVAL_NULL(*rval);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "2a128950187da8771a09e784572a73ae6e7dcde6",
      "candidate_info": {
        "commit_hash": "2a128950187da8771a09e784572a73ae6e7dcde6",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/2a128950187da8771a09e784572a73ae6e7dcde6",
        "files": [
          "ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-7.1'",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt": [
          "File: ext/standard/tests/serialize/bug70963.phpt -> ext/standard/tests/serialize/bug70963.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;r:3;}'));",
          "7: ?>",
          "8: --EXPECTF--",
          "10:   [0]=>",
          "11:   object(Exception)#%d (6) {",
          "12:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "9: array(1) {",
          "",
          "[Added Lines]",
          "9: array(2) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "22:     [\"previous\":\"Exception\":private]=>",
          "23:     NULL",
          "24:   }",
          "25: }",
          "27:   [0]=>",
          "28:   object(Exception)#%d (6) {",
          "29:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "26: array(1) {",
          "",
          "[Added Lines]",
          "25:   [1]=>",
          "26:   string(4) \"test\"",
          "28: array(2) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "39:     [\"previous\":\"Exception\":private]=>",
          "40:     NULL",
          "41:   }",
          "42: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44:   [1]=>",
          "45:   string(4) \"test\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: #line 1 \"ext/standard/var_unserializer.re\"",
          "4:   +----------------------------------------------------------------------+",
          "5:   | PHP Version 7                                                        |",
          "6:   +----------------------------------------------------------------------+",
          "8:   +----------------------------------------------------------------------+",
          "9:   | This source file is subject to version 3.01 of the PHP license,      |",
          "10:   | that is bundled with this package in the file LICENSE, and is        |",
          "",
          "[Removed Lines]",
          "7:   | Copyright (c) 1997-2016 The PHP Group                                |",
          "",
          "[Added Lines]",
          "7:   | Copyright (c) 1997-2017 The PHP Group                                |",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "72: #define VAR_ENTRIES_MAX 1024",
          "73: #define VAR_ENTRIES_DBG 0",
          "75: typedef struct {",
          "76:  zval *data[VAR_ENTRIES_MAX];",
          "77:  zend_long used_slots;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "76: #define VAR_WAKEUP_FLAG 1",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "140:         (*var_hashx)->last_dtor = var_hash;",
          "141:     }",
          "142:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "143:     return &var_hash->data[var_hash->used_slots++];",
          "144: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "146:  Z_ACCESS_FLAGS(var_hash->data[var_hash->used_slots]) = 0;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "187:  zend_long i;",
          "188:  var_entries *var_hash = (*var_hashx)->first;",
          "189:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "190: #if VAR_ENTRIES_DBG",
          "191:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "192: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "194:  zend_bool wakeup_failed = 0;",
          "195:  zval wakeup_name;",
          "196:  ZVAL_UNDEF(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "200:  while (var_dtor_hash) {",
          "201:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "202: #if VAR_ENTRIES_DBG",
          "203:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "204: #endif",
          "206:   }",
          "207:   next = var_dtor_hash->next;",
          "208:   efree_size(var_dtor_hash, sizeof(var_dtor_entries));",
          "209:   var_dtor_hash = next;",
          "210:  }",
          "211: }",
          "",
          "[Removed Lines]",
          "205:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "",
          "[Added Lines]",
          "210:    zval *zv = &var_dtor_hash->data[i];",
          "216:    if (Z_ACCESS_FLAGS_P(zv) == VAR_WAKEUP_FLAG) {",
          "217:     if (!wakeup_failed) {",
          "218:      zval retval;",
          "219:      if (Z_ISUNDEF(wakeup_name)) {",
          "220:       ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "221:      }",
          "223:      BG(serialize_lock)++;",
          "224:      if (call_user_function_ex(CG(function_table), zv, &wakeup_name, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "225:       wakeup_failed = 1;",
          "226:       GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "227:      }",
          "228:      BG(serialize_lock)--;",
          "230:      zval_ptr_dtor(&retval);",
          "231:     } else {",
          "232:      GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "233:     }",
          "234:    }",
          "236:    zval_ptr_dtor(zv);",
          "243:  zval_ptr_dtor(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "284: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "287: #line 292 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "320: #line 325 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "505: #endif",
          "506: static inline int object_common2(UNSERIALIZE_PARAMETER, zend_long elements)",
          "507: {",
          "510:  HashTable *ht;",
          "511:  zend_bool has_wakeup;",
          "",
          "[Removed Lines]",
          "508:  zval retval;",
          "509:  zval fname;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "530:  ZVAL_DEREF(rval);",
          "531:  if (has_wakeup) {",
          "544:  }",
          "546:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "",
          "[Removed Lines]",
          "532:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "533:   BG(serialize_lock)++;",
          "534:   if (call_user_function_ex(CG(function_table), rval, &fname, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "535:    GC_FLAGS(Z_OBJ_P(rval)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "536:   }",
          "537:   BG(serialize_lock)--;",
          "538:   zval_dtor(&fname);",
          "539:   zval_dtor(&retval);",
          "540:  }",
          "542:  if (EG(exception)) {",
          "543:   return 0;",
          "",
          "[Added Lines]",
          "564:   zval *wakeup_var = var_tmp_var(var_hash);",
          "565:   ZVAL_COPY(wakeup_var, rval);",
          "566:   Z_ACCESS_FLAGS_P(wakeup_var) = VAR_WAKEUP_FLAG;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "595:  start = cursor;",
          "599: {",
          "600:  YYCTYPE yych;",
          "601:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "598: #line 599 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "621: #line 622 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "632:     0,   0,   0,   0,   0,   0,   0,   0,",
          "633:     0,   0,   0,   0,   0,   0,   0,   0,",
          "634:  };",
          "636:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "637:  yych = *YYCURSOR;",
          "638:  switch (yych) {",
          "639:  case 'C':",
          "641:  case 'N': goto yy5;",
          "648:  case 'o': goto yy12;",
          "653:  }",
          "654: yy2:",
          "657: yy3:",
          "659:  { return 0; }",
          "661: yy4:",
          "662:  yych = *(YYMARKER = ++YYCURSOR);",
          "664:  goto yy3;",
          "665: yy5:",
          "666:  yych = *++YYCURSOR;",
          "668:  goto yy3;",
          "669: yy6:",
          "670:  yych = *(YYMARKER = ++YYCURSOR);",
          "672:  goto yy3;",
          "673: yy7:",
          "674:  yych = *(YYMARKER = ++YYCURSOR);",
          "676:  goto yy3;",
          "677: yy8:",
          "678:  yych = *(YYMARKER = ++YYCURSOR);",
          "680:  goto yy3;",
          "681: yy9:",
          "682:  yych = *(YYMARKER = ++YYCURSOR);",
          "684:  goto yy3;",
          "685: yy10:",
          "686:  yych = *(YYMARKER = ++YYCURSOR);",
          "688:  goto yy3;",
          "689: yy11:",
          "690:  yych = *(YYMARKER = ++YYCURSOR);",
          "692:  goto yy3;",
          "693: yy12:",
          "694:  yych = *(YYMARKER = ++YYCURSOR);",
          "696:  goto yy3;",
          "697: yy13:",
          "698:  yych = *(YYMARKER = ++YYCURSOR);",
          "700:  goto yy3;",
          "701: yy14:",
          "702:  ++YYCURSOR;",
          "704:  {",
          "706:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "708: }",
          "713: yy17:",
          "714:  yych = *++YYCURSOR;",
          "715:  if (yybm[0+yych] & 128) {",
          "717:  }",
          "719: yy18:",
          "720:  YYCURSOR = YYMARKER;",
          "721:  goto yy3;",
          "722: yy19:",
          "723:  yych = *++YYCURSOR;",
          "726:  }",
          "727:  goto yy18;",
          "735:  if (yych <= '/') goto yy18;",
          "737:  yych = *++YYCURSOR;",
          "856:   }",
          "873:   }",
          "876:  }",
          "883:  }",
          "887:  }",
          "894:  yych = *++YYCURSOR;",
          "895:  if (yych <= ',') {",
          "897:  } else {",
          "899:   if (yych <= '/') goto yy18;",
          "901:   goto yy18;",
          "902:  }",
          "904:  yych = *++YYCURSOR;",
          "905:  if (yych <= '/') goto yy18;",
          "908:  ++YYCURSOR;",
          "909:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "910:  yych = *YYCURSOR;",
          "925:  }",
          "932:  if (yych <= '/') goto yy18;",
          "934:  goto yy18;",
          "935: yy33:",
          "936:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "640:  case 'O': goto yy13;",
          "642:  case 'R': goto yy2;",
          "643:  case 'S': goto yy10;",
          "644:  case 'a': goto yy11;",
          "645:  case 'b': goto yy6;",
          "646:  case 'd': goto yy8;",
          "647:  case 'i': goto yy7;",
          "649:  case 'r': goto yy4;",
          "650:  case 's': goto yy9;",
          "651:  case '}': goto yy14;",
          "652:  default: goto yy16;",
          "655:  yych = *(YYMARKER = ++YYCURSOR);",
          "656:  if (yych == ':') goto yy95;",
          "658: #line 976 \"ext/standard/var_unserializer.re\"",
          "660: #line 661 \"ext/standard/var_unserializer.c\"",
          "663:  if (yych == ':') goto yy89;",
          "667:  if (yych == ';') goto yy87;",
          "671:  if (yych == ':') goto yy83;",
          "675:  if (yych == ':') goto yy77;",
          "679:  if (yych == ':') goto yy53;",
          "683:  if (yych == ':') goto yy46;",
          "687:  if (yych == ':') goto yy39;",
          "691:  if (yych == ':') goto yy32;",
          "695:  if (yych == ':') goto yy25;",
          "699:  if (yych == ':') goto yy17;",
          "703: #line 970 \"ext/standard/var_unserializer.re\"",
          "709: #line 710 \"ext/standard/var_unserializer.c\"",
          "710: yy16:",
          "711:  yych = *++YYCURSOR;",
          "712:  goto yy3;",
          "716:   goto yy20;",
          "718:  if (yych == '+') goto yy19;",
          "724:  if (yybm[0+yych] & 128) {",
          "725:   goto yy20;",
          "728: yy20:",
          "729:  ++YYCURSOR;",
          "730:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "731:  yych = *YYCURSOR;",
          "732:  if (yybm[0+yych] & 128) {",
          "733:   goto yy20;",
          "734:  }",
          "736:  if (yych >= ';') goto yy18;",
          "738:  if (yych != '\"') goto yy18;",
          "739:  ++YYCURSOR;",
          "740: #line 818 \"ext/standard/var_unserializer.re\"",
          "741:  {",
          "742:  size_t len, len2, len3, maxlen;",
          "743:  zend_long elements;",
          "744:  char *str;",
          "745:  zend_string *class_name;",
          "746:  zend_class_entry *ce;",
          "747:  int incomplete_class = 0;",
          "749:  int custom_object = 0;",
          "751:  zval user_func;",
          "752:  zval retval;",
          "753:  zval args[1];",
          "755:     if (!var_hash) return 0;",
          "756:  if (*start == 'C') {",
          "757:   custom_object = 1;",
          "758:  }",
          "760:  len2 = len = parse_uiv(start + 2);",
          "761:  maxlen = max - YYCURSOR;",
          "762:  if (maxlen < len || len == 0) {",
          "764:   return 0;",
          "765:  }",
          "767:  str = (char*)YYCURSOR;",
          "769:  YYCURSOR += len;",
          "771:  if (*(YYCURSOR) != '\"') {",
          "773:   return 0;",
          "774:  }",
          "775:  if (*(YYCURSOR+1) != ':') {",
          "777:   return 0;",
          "778:  }",
          "780:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "781:  if (len3 != len)",
          "782:  {",
          "784:   return 0;",
          "785:  }",
          "787:  class_name = zend_string_init(str, len, 0);",
          "789:  do {",
          "790:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "791:    incomplete_class = 1;",
          "792:    ce = PHP_IC_ENTRY;",
          "793:    break;",
          "794:   }",
          "797:   BG(serialize_lock)++;",
          "798:   ce = zend_lookup_class(class_name);",
          "799:   if (ce) {",
          "800:    BG(serialize_lock)--;",
          "801:    if (EG(exception)) {",
          "802:     zend_string_release(class_name);",
          "803:     return 0;",
          "804:    }",
          "805:    break;",
          "806:   }",
          "807:   BG(serialize_lock)--;",
          "809:   if (EG(exception)) {",
          "810:    zend_string_release(class_name);",
          "811:    return 0;",
          "812:   }",
          "815:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "816:    incomplete_class = 1;",
          "817:    ce = PHP_IC_ENTRY;",
          "818:    break;",
          "819:   }",
          "822:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "824:   ZVAL_STR_COPY(&args[0], class_name);",
          "825:   BG(serialize_lock)++;",
          "826:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "827:    BG(serialize_lock)--;",
          "828:    if (EG(exception)) {",
          "829:     zend_string_release(class_name);",
          "830:     zval_ptr_dtor(&user_func);",
          "831:     zval_ptr_dtor(&args[0]);",
          "832:     return 0;",
          "833:    }",
          "834:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "835:    incomplete_class = 1;",
          "836:    ce = PHP_IC_ENTRY;",
          "837:    zval_ptr_dtor(&user_func);",
          "838:    zval_ptr_dtor(&args[0]);",
          "839:    break;",
          "840:   }",
          "841:   BG(serialize_lock)--;",
          "842:   zval_ptr_dtor(&retval);",
          "843:   if (EG(exception)) {",
          "844:    zend_string_release(class_name);",
          "845:    zval_ptr_dtor(&user_func);",
          "846:    zval_ptr_dtor(&args[0]);",
          "847:    return 0;",
          "848:   }",
          "851:   BG(serialize_lock)++;",
          "852:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "853:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "854:    incomplete_class = 1;",
          "855:    ce = PHP_IC_ENTRY;",
          "857:   BG(serialize_lock)--;",
          "859:   zval_ptr_dtor(&user_func);",
          "860:   zval_ptr_dtor(&args[0]);",
          "861:   break;",
          "862:  } while (1);",
          "866:  if (custom_object) {",
          "867:   int ret;",
          "869:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "871:   if (ret && incomplete_class) {",
          "872:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "874:   zend_string_release(class_name);",
          "875:   return ret;",
          "878:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "880:  if (elements < 0) {",
          "881:     zend_string_release(class_name);",
          "882:     return 0;",
          "885:  if (incomplete_class) {",
          "886:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "888:  zend_string_release(class_name);",
          "890:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "891: }",
          "892: #line 893 \"ext/standard/var_unserializer.c\"",
          "893: yy25:",
          "896:   if (yych != '+') goto yy18;",
          "898:   if (yych <= '-') goto yy26;",
          "900:   if (yych <= '9') goto yy27;",
          "903: yy26:",
          "906:  if (yych >= ':') goto yy18;",
          "907: yy27:",
          "911:  if (yych <= '/') goto yy18;",
          "912:  if (yych <= '9') goto yy27;",
          "913:  if (yych >= ';') goto yy18;",
          "914:  yych = *++YYCURSOR;",
          "915:  if (yych != '\"') goto yy18;",
          "916:  ++YYCURSOR;",
          "917: #line 807 \"ext/standard/var_unserializer.re\"",
          "918:  {",
          "919:  long elements;",
          "920:     if (!var_hash) return 0;",
          "922:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "923:  if (elements < 0) {",
          "924:   return 0;",
          "926:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "927: }",
          "928: #line 929 \"ext/standard/var_unserializer.c\"",
          "929: yy32:",
          "930:  yych = *++YYCURSOR;",
          "931:  if (yych == '+') goto yy33;",
          "933:  if (yych <= '9') goto yy34;",
          "",
          "[Added Lines]",
          "662:  case 'O': goto yy4;",
          "664:  case 'R': goto yy6;",
          "665:  case 'S': goto yy7;",
          "666:  case 'a': goto yy8;",
          "667:  case 'b': goto yy9;",
          "668:  case 'd': goto yy10;",
          "669:  case 'i': goto yy11;",
          "671:  case 'r': goto yy13;",
          "672:  case 's': goto yy14;",
          "673:  case '}': goto yy15;",
          "674:  default: goto yy2;",
          "677:  ++YYCURSOR;",
          "679: #line 999 \"ext/standard/var_unserializer.re\"",
          "681: #line 682 \"ext/standard/var_unserializer.c\"",
          "684:  if (yych == ':') goto yy17;",
          "688:  if (yych == ';') goto yy19;",
          "692:  if (yych == ':') goto yy21;",
          "696:  if (yych == ':') goto yy22;",
          "700:  if (yych == ':') goto yy23;",
          "704:  if (yych == ':') goto yy24;",
          "708:  if (yych == ':') goto yy25;",
          "712:  if (yych == ':') goto yy26;",
          "716:  if (yych == ':') goto yy27;",
          "720:  if (yych == ':') goto yy28;",
          "723:  yych = *(YYMARKER = ++YYCURSOR);",
          "724:  if (yych == ':') goto yy29;",
          "725:  goto yy3;",
          "726: yy15:",
          "728: #line 993 \"ext/standard/var_unserializer.re\"",
          "734: #line 735 \"ext/standard/var_unserializer.c\"",
          "738:   goto yy31;",
          "740:  if (yych == '+') goto yy30;",
          "745:  ++YYCURSOR;",
          "746: #line 677 \"ext/standard/var_unserializer.re\"",
          "747:  {",
          "749:  ZVAL_NULL(rval);",
          "750:  return 1;",
          "751: }",
          "752: #line 753 \"ext/standard/var_unserializer.c\"",
          "753: yy21:",
          "755:  if (yych <= ',') {",
          "756:   if (yych == '+') goto yy33;",
          "757:   goto yy18;",
          "758:  } else {",
          "759:   if (yych <= '-') goto yy33;",
          "760:   if (yych <= '/') goto yy18;",
          "761:   if (yych <= '9') goto yy34;",
          "762:   goto yy18;",
          "764: yy22:",
          "765:  yych = *++YYCURSOR;",
          "766:  if (yych == '+') goto yy36;",
          "767:  if (yych <= '/') goto yy18;",
          "768:  if (yych <= '9') goto yy37;",
          "770: yy23:",
          "771:  yych = *++YYCURSOR;",
          "772:  if (yych == '+') goto yy39;",
          "774:  if (yych <= '9') goto yy40;",
          "775:  goto yy18;",
          "776: yy24:",
          "778:  if (yych <= '/') goto yy18;",
          "779:  if (yych <= '1') goto yy42;",
          "780:  goto yy18;",
          "781: yy25:",
          "782:  yych = *++YYCURSOR;",
          "783:  if (yych <= '/') {",
          "784:   if (yych <= ',') {",
          "785:    if (yych == '+') goto yy43;",
          "786:    goto yy18;",
          "787:   } else {",
          "788:    if (yych <= '-') goto yy44;",
          "789:    if (yych <= '.') goto yy45;",
          "790:    goto yy18;",
          "792:  } else {",
          "793:   if (yych <= 'I') {",
          "794:    if (yych <= '9') goto yy46;",
          "795:    if (yych <= 'H') goto yy18;",
          "796:    goto yy48;",
          "797:   } else {",
          "798:    if (yych == 'N') goto yy49;",
          "799:    goto yy18;",
          "802: yy26:",
          "803:  yych = *++YYCURSOR;",
          "804:  if (yych <= ',') {",
          "805:   if (yych == '+') goto yy50;",
          "806:   goto yy18;",
          "807:  } else {",
          "808:   if (yych <= '-') goto yy50;",
          "809:   if (yych <= '/') goto yy18;",
          "810:   if (yych <= '9') goto yy51;",
          "811:   goto yy18;",
          "813: yy27:",
          "814:  yych = *++YYCURSOR;",
          "815:  if (yych <= ',') {",
          "816:   if (yych == '+') goto yy53;",
          "817:   goto yy18;",
          "818:  } else {",
          "819:   if (yych <= '-') goto yy53;",
          "820:   if (yych <= '/') goto yy18;",
          "821:   if (yych <= '9') goto yy54;",
          "822:   goto yy18;",
          "824: yy28:",
          "827:   if (yych == '+') goto yy56;",
          "828:   goto yy18;",
          "830:   if (yych <= '-') goto yy56;",
          "832:   if (yych <= '9') goto yy57;",
          "835: yy29:",
          "837:  if (yych == '+') goto yy59;",
          "839:  if (yych <= '9') goto yy60;",
          "840:  goto yy18;",
          "841: yy30:",
          "842:  yych = *++YYCURSOR;",
          "843:  if (yybm[0+yych] & 128) {",
          "844:   goto yy31;",
          "845:  }",
          "846:  goto yy18;",
          "847: yy31:",
          "851:  if (yybm[0+yych] & 128) {",
          "852:   goto yy31;",
          "855:  if (yych <= ':') goto yy62;",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "938:  if (yych >= ':') goto yy18;",
          "939: yy34:",
          "940:  ++YYCURSOR;",
          "942:  yych = *YYCURSOR;",
          "943:  if (yych <= '/') goto yy18;",
          "944:  if (yych <= '9') goto yy34;",
          "981:  yych = *++YYCURSOR;",
          "982:  if (yych <= '/') goto yy18;",
          "983:  if (yych >= ':') goto yy18;",
          "985:  ++YYCURSOR;",
          "986:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "987:  yych = *YYCURSOR;",
          "988:  if (yych <= '/') goto yy18;",
          "1034:  goto yy18;",
          "1036:  yych = *++YYCURSOR;",
          "1037:  if (yych <= '/') goto yy18;",
          "1038:  if (yych >= ':') goto yy18;",
          "1040:  ++YYCURSOR;",
          "1041:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "1042:  yych = *YYCURSOR;",
          "1043:  if (yych <= '/') goto yy18;",
          "1083:  yych = *++YYCURSOR;",
          "1102:  yych = *++YYCURSOR;",
          "1104:  goto yy18;",
          "1106:  yych = *++YYCURSOR;",
          "1107:  if (yych <= '/') {",
          "1110:  } else {",
          "1113:  }",
          "1115:  yych = *++YYCURSOR;",
          "1121:  if (yych <= '/') goto yy18;",
          "1124:  ++YYCURSOR;",
          "1125:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1126:  yych = *YYCURSOR;",
          "1127:  if (yych <= ':') {",
          "1128:   if (yych <= '.') {",
          "1129:    if (yych <= '-') goto yy18;",
          "1131:   } else {",
          "1132:    if (yych <= '/') goto yy18;",
          "1134:    goto yy18;",
          "1135:   }",
          "1136:  } else {",
          "1137:   if (yych <= 'E') {",
          "1139:    if (yych <= 'D') goto yy18;",
          "1141:   } else {",
          "1143:    goto yy18;",
          "1144:   }",
          "1145:  }",
          "1147:  yych = *++YYCURSOR;",
          "1148:  if (yych <= '/') goto yy18;",
          "1149:  if (yych >= ':') goto yy18;",
          "1151:  ++YYCURSOR;",
          "1152:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1153:  yych = *YYCURSOR;",
          "1154:  if (yych <= ';') {",
          "1155:   if (yych <= '/') goto yy18;",
          "1157:   if (yych <= ':') goto yy18;",
          "1158:  } else {",
          "1159:   if (yych <= 'E') {",
          "1160:    if (yych <= 'D') goto yy18;",
          "1162:   } else {",
          "1164:    goto yy18;",
          "1165:   }",
          "1166:  }",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1171: #if SIZEOF_ZEND_LONG == 4",
          "1172: use_double:",
          "",
          "[Removed Lines]",
          "941:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "945:  if (yych >= ';') goto yy18;",
          "946:  yych = *++YYCURSOR;",
          "947:  if (yych != '{') goto yy18;",
          "948:  ++YYCURSOR;",
          "949: #line 783 \"ext/standard/var_unserializer.re\"",
          "950:  {",
          "951:  zend_long elements = parse_iv(start + 2);",
          "954:     if (!var_hash) return 0;",
          "956:  if (elements < 0) {",
          "957:   return 0;",
          "958:  }",
          "960:  array_init_size(rval, elements);",
          "961:  if (elements) {",
          "964:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "965:  }",
          "967:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "968:   return 0;",
          "969:  }",
          "971:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "972: }",
          "973: #line 974 \"ext/standard/var_unserializer.c\"",
          "974: yy39:",
          "975:  yych = *++YYCURSOR;",
          "976:  if (yych == '+') goto yy40;",
          "977:  if (yych <= '/') goto yy18;",
          "978:  if (yych <= '9') goto yy41;",
          "979:  goto yy18;",
          "980: yy40:",
          "984: yy41:",
          "989:  if (yych <= '9') goto yy41;",
          "990:  if (yych >= ';') goto yy18;",
          "991:  yych = *++YYCURSOR;",
          "992:  if (yych != '\"') goto yy18;",
          "993:  ++YYCURSOR;",
          "994: #line 749 \"ext/standard/var_unserializer.re\"",
          "995:  {",
          "996:  size_t len, maxlen;",
          "997:  zend_string *str;",
          "999:  len = parse_uiv(start + 2);",
          "1000:  maxlen = max - YYCURSOR;",
          "1001:  if (maxlen < len) {",
          "1003:   return 0;",
          "1004:  }",
          "1006:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1007:   return 0;",
          "1008:  }",
          "1010:  if (*(YYCURSOR) != '\"') {",
          "1011:   zend_string_free(str);",
          "1013:   return 0;",
          "1014:  }",
          "1016:  if (*(YYCURSOR + 1) != ';') {",
          "1017:   efree(str);",
          "1019:   return 0;",
          "1020:  }",
          "1022:  YYCURSOR += 2;",
          "1025:  ZVAL_STR(rval, str);",
          "1026:  return 1;",
          "1027: }",
          "1028: #line 1029 \"ext/standard/var_unserializer.c\"",
          "1029: yy46:",
          "1030:  yych = *++YYCURSOR;",
          "1031:  if (yych == '+') goto yy47;",
          "1032:  if (yych <= '/') goto yy18;",
          "1033:  if (yych <= '9') goto yy48;",
          "1035: yy47:",
          "1039: yy48:",
          "1044:  if (yych <= '9') goto yy48;",
          "1045:  if (yych >= ';') goto yy18;",
          "1046:  yych = *++YYCURSOR;",
          "1047:  if (yych != '\"') goto yy18;",
          "1048:  ++YYCURSOR;",
          "1049: #line 717 \"ext/standard/var_unserializer.re\"",
          "1050:  {",
          "1051:  size_t len, maxlen;",
          "1052:  char *str;",
          "1054:  len = parse_uiv(start + 2);",
          "1055:  maxlen = max - YYCURSOR;",
          "1056:  if (maxlen < len) {",
          "1058:   return 0;",
          "1059:  }",
          "1061:  str = (char*)YYCURSOR;",
          "1063:  YYCURSOR += len;",
          "1065:  if (*(YYCURSOR) != '\"') {",
          "1067:   return 0;",
          "1068:  }",
          "1070:  if (*(YYCURSOR + 1) != ';') {",
          "1072:   return 0;",
          "1073:  }",
          "1075:  YYCURSOR += 2;",
          "1078:  ZVAL_STRINGL(rval, str, len);",
          "1079:  return 1;",
          "1080: }",
          "1081: #line 1082 \"ext/standard/var_unserializer.c\"",
          "1082: yy53:",
          "1084:  if (yych <= '/') {",
          "1085:   if (yych <= ',') {",
          "1086:    if (yych == '+') goto yy57;",
          "1087:    goto yy18;",
          "1088:   } else {",
          "1089:    if (yych <= '-') goto yy55;",
          "1090:    if (yych <= '.') goto yy60;",
          "1091:    goto yy18;",
          "1092:   }",
          "1093:  } else {",
          "1094:   if (yych <= 'I') {",
          "1095:    if (yych <= '9') goto yy58;",
          "1096:    if (yych <= 'H') goto yy18;",
          "1097:    goto yy56;",
          "1098:   } else {",
          "1099:    if (yych != 'N') goto yy18;",
          "1100:   }",
          "1101:  }",
          "1103:  if (yych == 'A') goto yy76;",
          "1105: yy55:",
          "1108:   if (yych == '.') goto yy60;",
          "1109:   goto yy18;",
          "1111:   if (yych <= '9') goto yy58;",
          "1112:   if (yych != 'I') goto yy18;",
          "1114: yy56:",
          "1116:  if (yych == 'N') goto yy72;",
          "1117:  goto yy18;",
          "1118: yy57:",
          "1119:  yych = *++YYCURSOR;",
          "1120:  if (yych == '.') goto yy60;",
          "1122:  if (yych >= ':') goto yy18;",
          "1123: yy58:",
          "1130:    goto yy70;",
          "1133:    if (yych <= '9') goto yy58;",
          "1138:    if (yych <= ';') goto yy63;",
          "1140:    goto yy65;",
          "1142:    if (yych == 'e') goto yy65;",
          "1146: yy60:",
          "1150: yy61:",
          "1156:   if (yych <= '9') goto yy61;",
          "1161:    goto yy65;",
          "1163:    if (yych == 'e') goto yy65;",
          "1167: yy63:",
          "1169: #line 708 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "863:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "867:  if (yych == ';') goto yy63;",
          "868:  goto yy18;",
          "869: yy36:",
          "873: yy37:",
          "878:  if (yych <= '9') goto yy37;",
          "879:  if (yych <= ':') goto yy65;",
          "881: yy39:",
          "885: yy40:",
          "890:  if (yych <= '9') goto yy40;",
          "891:  if (yych <= ':') goto yy66;",
          "892:  goto yy18;",
          "893: yy42:",
          "895:  if (yych == ';') goto yy67;",
          "896:  goto yy18;",
          "897: yy43:",
          "899:  if (yych == '.') goto yy45;",
          "900:  if (yych <= '/') goto yy18;",
          "901:  if (yych <= '9') goto yy46;",
          "903: yy44:",
          "906:   if (yych != '.') goto yy18;",
          "908:   if (yych <= '9') goto yy46;",
          "909:   if (yych == 'I') goto yy48;",
          "910:   goto yy18;",
          "912: yy45:",
          "915:  if (yych <= '9') goto yy69;",
          "916:  goto yy18;",
          "917: yy46:",
          "924:    goto yy69;",
          "927:    if (yych <= '9') goto yy46;",
          "932:    if (yych <= ';') goto yy71;",
          "934:    goto yy73;",
          "936:    if (yych == 'e') goto yy73;",
          "940: yy48:",
          "941:  yych = *++YYCURSOR;",
          "942:  if (yych == 'N') goto yy74;",
          "943:  goto yy18;",
          "944: yy49:",
          "945:  yych = *++YYCURSOR;",
          "946:  if (yych == 'A') goto yy75;",
          "947:  goto yy18;",
          "948: yy50:",
          "949:  yych = *++YYCURSOR;",
          "950:  if (yych <= '/') goto yy18;",
          "951:  if (yych >= ':') goto yy18;",
          "952: yy51:",
          "953:  ++YYCURSOR;",
          "954:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "955:  yych = *YYCURSOR;",
          "956:  if (yych <= '/') goto yy18;",
          "957:  if (yych <= '9') goto yy51;",
          "958:  if (yych == ';') goto yy76;",
          "959:  goto yy18;",
          "960: yy53:",
          "961:  yych = *++YYCURSOR;",
          "962:  if (yych <= '/') goto yy18;",
          "963:  if (yych >= ':') goto yy18;",
          "964: yy54:",
          "965:  ++YYCURSOR;",
          "966:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "967:  yych = *YYCURSOR;",
          "968:  if (yych <= '/') goto yy18;",
          "969:  if (yych <= '9') goto yy54;",
          "970:  if (yych <= ':') goto yy78;",
          "971:  goto yy18;",
          "972: yy56:",
          "973:  yych = *++YYCURSOR;",
          "974:  if (yych <= '/') goto yy18;",
          "975:  if (yych >= ':') goto yy18;",
          "976: yy57:",
          "977:  ++YYCURSOR;",
          "978:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "979:  yych = *YYCURSOR;",
          "980:  if (yych <= '/') goto yy18;",
          "981:  if (yych <= '9') goto yy57;",
          "982:  if (yych == ';') goto yy79;",
          "983:  goto yy18;",
          "984: yy59:",
          "988: yy60:",
          "989:  ++YYCURSOR;",
          "990:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "991:  yych = *YYCURSOR;",
          "992:  if (yych <= '/') goto yy18;",
          "993:  if (yych <= '9') goto yy60;",
          "994:  if (yych <= ':') goto yy81;",
          "995:  goto yy18;",
          "996: yy62:",
          "997:  yych = *++YYCURSOR;",
          "998:  if (yych == '\"') goto yy82;",
          "999:  goto yy18;",
          "1000: yy63:",
          "1001:  ++YYCURSOR;",
          "1002: #line 626 \"ext/standard/var_unserializer.re\"",
          "1003:  {",
          "1004:  zend_long id;",
          "1007:  if (!var_hash) return 0;",
          "1009:  id = parse_iv(start + 2) - 1;",
          "1010:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1011:   return 0;",
          "1012:  }",
          "1014:  zval_ptr_dtor(rval);",
          "1015:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1016:   ZVAL_UNDEF(rval);",
          "1017:   return 1;",
          "1018:  }",
          "1019:  if (Z_ISREF_P(rval_ref)) {",
          "1020:   ZVAL_COPY(rval, rval_ref);",
          "1021:  } else {",
          "1022:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1023:   ZVAL_COPY(rval, rval_ref);",
          "1024:  }",
          "1026:  return 1;",
          "1027: }",
          "1028: #line 1029 \"ext/standard/var_unserializer.c\"",
          "1029: yy65:",
          "1030:  yych = *++YYCURSOR;",
          "1031:  if (yych == '\"') goto yy84;",
          "1032:  goto yy18;",
          "1033: yy66:",
          "1034:  yych = *++YYCURSOR;",
          "1035:  if (yych == '{') goto yy86;",
          "1036:  goto yy18;",
          "1037: yy67:",
          "1038:  ++YYCURSOR;",
          "1039: #line 683 \"ext/standard/var_unserializer.re\"",
          "1040:  {",
          "1042:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1043:  return 1;",
          "1044: }",
          "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
          "1046: yy69:",
          "1052:   if (yych <= '9') goto yy69;",
          "1057:    goto yy73;",
          "1059:    if (yych == 'e') goto yy73;",
          "1063: yy71:",
          "1065: #line 731 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1175:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1176:  return 1;",
          "1177: }",
          "1180:  yych = *++YYCURSOR;",
          "1181:  if (yych <= ',') {",
          "1183:  } else {",
          "1185:   if (yych <= '/') goto yy18;",
          "1187:   goto yy18;",
          "1188:  }",
          "1190:  yych = *++YYCURSOR;",
          "1206:  goto yy18;",
          "1208:  yych = *++YYCURSOR;",
          "1211:  goto yy18;",
          "1236:  ++YYCURSOR;",
          "1238:  {",
          "1285:  if (start[2] == '-' || start[2] == '+') {",
          "1286:   digits--;",
          "",
          "[Removed Lines]",
          "1178: #line 1179 \"ext/standard/var_unserializer.c\"",
          "1179: yy65:",
          "1182:   if (yych != '+') goto yy18;",
          "1184:   if (yych <= '-') goto yy66;",
          "1186:   if (yych <= '9') goto yy67;",
          "1189: yy66:",
          "1191:  if (yych <= ',') {",
          "1192:   if (yych == '+') goto yy69;",
          "1193:   goto yy18;",
          "1194:  } else {",
          "1195:   if (yych <= '-') goto yy69;",
          "1196:   if (yych <= '/') goto yy18;",
          "1197:   if (yych >= ':') goto yy18;",
          "1198:  }",
          "1199: yy67:",
          "1200:  ++YYCURSOR;",
          "1201:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1202:  yych = *YYCURSOR;",
          "1203:  if (yych <= '/') goto yy18;",
          "1204:  if (yych <= '9') goto yy67;",
          "1205:  if (yych == ';') goto yy63;",
          "1207: yy69:",
          "1209:  if (yych <= '/') goto yy18;",
          "1210:  if (yych <= '9') goto yy67;",
          "1212: yy70:",
          "1213:  ++YYCURSOR;",
          "1214:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1215:  yych = *YYCURSOR;",
          "1216:  if (yych <= ';') {",
          "1217:   if (yych <= '/') goto yy18;",
          "1218:   if (yych <= '9') goto yy70;",
          "1219:   if (yych <= ':') goto yy18;",
          "1220:   goto yy63;",
          "1221:  } else {",
          "1222:   if (yych <= 'E') {",
          "1223:    if (yych <= 'D') goto yy18;",
          "1224:    goto yy65;",
          "1225:   } else {",
          "1226:    if (yych == 'e') goto yy65;",
          "1227:    goto yy18;",
          "1228:   }",
          "1229:  }",
          "1230: yy72:",
          "1231:  yych = *++YYCURSOR;",
          "1232:  if (yych != 'F') goto yy18;",
          "1233: yy73:",
          "1234:  yych = *++YYCURSOR;",
          "1235:  if (yych != ';') goto yy18;",
          "1237: #line 692 \"ext/standard/var_unserializer.re\"",
          "1241:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1242:   ZVAL_DOUBLE(rval, ZEND_NAN);",
          "1243:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1244:   ZVAL_DOUBLE(rval, ZEND_INFINITY);",
          "1245:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1246:   ZVAL_DOUBLE(rval, -ZEND_INFINITY);",
          "1247:  } else {",
          "1248:   ZVAL_NULL(rval);",
          "1249:  }",
          "1251:  return 1;",
          "1252: }",
          "1253: #line 1254 \"ext/standard/var_unserializer.c\"",
          "1254: yy76:",
          "1255:  yych = *++YYCURSOR;",
          "1256:  if (yych == 'N') goto yy73;",
          "1257:  goto yy18;",
          "1258: yy77:",
          "1259:  yych = *++YYCURSOR;",
          "1260:  if (yych <= ',') {",
          "1261:   if (yych != '+') goto yy18;",
          "1262:  } else {",
          "1263:   if (yych <= '-') goto yy78;",
          "1264:   if (yych <= '/') goto yy18;",
          "1265:   if (yych <= '9') goto yy79;",
          "1266:   goto yy18;",
          "1267:  }",
          "1268: yy78:",
          "1269:  yych = *++YYCURSOR;",
          "1270:  if (yych <= '/') goto yy18;",
          "1271:  if (yych >= ':') goto yy18;",
          "1272: yy79:",
          "1273:  ++YYCURSOR;",
          "1274:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1275:  yych = *YYCURSOR;",
          "1276:  if (yych <= '/') goto yy18;",
          "1277:  if (yych <= '9') goto yy79;",
          "1278:  if (yych != ';') goto yy18;",
          "1279:  ++YYCURSOR;",
          "1280: #line 666 \"ext/standard/var_unserializer.re\"",
          "1281:  {",
          "1282: #if SIZEOF_ZEND_LONG == 4",
          "1283:  int digits = YYCURSOR - start - 3;",
          "",
          "[Added Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "1075: yy73:",
          "1078:   if (yych == '+') goto yy88;",
          "1079:   goto yy18;",
          "1081:   if (yych <= '-') goto yy88;",
          "1083:   if (yych <= '9') goto yy89;",
          "1086: yy74:",
          "1088:  if (yych == 'F') goto yy91;",
          "1090: yy75:",
          "1092:  if (yych == 'N') goto yy91;",
          "1094: yy76:",
          "1096: #line 689 \"ext/standard/var_unserializer.re\"",
          "1098: #if SIZEOF_ZEND_LONG == 4",
          "1099:  int digits = YYCURSOR - start - 3;",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1303:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1304:  return 1;",
          "1305: }",
          "1341:  yych = *++YYCURSOR;",
          "1351:  ++YYCURSOR;",
          "1353:  {",
          "1354:  zend_long id;",
          "",
          "[Removed Lines]",
          "1306: #line 1307 \"ext/standard/var_unserializer.c\"",
          "1307: yy83:",
          "1308:  yych = *++YYCURSOR;",
          "1309:  if (yych <= '/') goto yy18;",
          "1310:  if (yych >= '2') goto yy18;",
          "1311:  yych = *++YYCURSOR;",
          "1312:  if (yych != ';') goto yy18;",
          "1313:  ++YYCURSOR;",
          "1314: #line 660 \"ext/standard/var_unserializer.re\"",
          "1315:  {",
          "1317:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1318:  return 1;",
          "1319: }",
          "1320: #line 1321 \"ext/standard/var_unserializer.c\"",
          "1321: yy87:",
          "1322:  ++YYCURSOR;",
          "1323: #line 654 \"ext/standard/var_unserializer.re\"",
          "1324:  {",
          "1326:  ZVAL_NULL(rval);",
          "1327:  return 1;",
          "1328: }",
          "1329: #line 1330 \"ext/standard/var_unserializer.c\"",
          "1330: yy89:",
          "1331:  yych = *++YYCURSOR;",
          "1332:  if (yych <= ',') {",
          "1333:   if (yych != '+') goto yy18;",
          "1334:  } else {",
          "1335:   if (yych <= '-') goto yy90;",
          "1336:   if (yych <= '/') goto yy18;",
          "1337:   if (yych <= '9') goto yy91;",
          "1338:   goto yy18;",
          "1339:  }",
          "1340: yy90:",
          "1342:  if (yych <= '/') goto yy18;",
          "1343:  if (yych >= ':') goto yy18;",
          "1344: yy91:",
          "1345:  ++YYCURSOR;",
          "1346:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1347:  yych = *YYCURSOR;",
          "1348:  if (yych <= '/') goto yy18;",
          "1349:  if (yych <= '9') goto yy91;",
          "1350:  if (yych != ';') goto yy18;",
          "1352: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1122: #line 1123 \"ext/standard/var_unserializer.c\"",
          "1123: yy78:",
          "1125:  if (yych == '\"') goto yy92;",
          "1126:  goto yy18;",
          "1127: yy79:",
          "1129: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1375:  return 1;",
          "1376: }",
          "1377: #line 1378 \"ext/standard/var_unserializer.c\"",
          "1379:  yych = *++YYCURSOR;",
          "1380:  if (yych <= ',') {",
          "1382:  } else {",
          "1383:   if (yych <= '-') goto yy96;",
          "1384:   if (yych <= '/') goto yy18;",
          "1387:  }",
          "1393:  ++YYCURSOR;",
          "1394:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1395:  yych = *YYCURSOR;",
          "1396:  if (yych <= '/') goto yy18;",
          "1399:  ++YYCURSOR;",
          "1401:  {",
          "1409:   return 0;",
          "1410:  }",
          "1416:  }",
          "1419:  } else {",
          "1422:  }",
          "1424:  return 1;",
          "1425: }",
          "1427: }",
          "1431:  return 0;",
          "",
          "[Removed Lines]",
          "1378: yy95:",
          "1381:   if (yych != '+') goto yy18;",
          "1385:   if (yych <= '9') goto yy97;",
          "1386:   goto yy18;",
          "1388: yy96:",
          "1389:  yych = *++YYCURSOR;",
          "1390:  if (yych <= '/') goto yy18;",
          "1391:  if (yych >= ':') goto yy18;",
          "1392: yy97:",
          "1397:  if (yych <= '9') goto yy97;",
          "1398:  if (yych != ';') goto yy18;",
          "1400: #line 603 \"ext/standard/var_unserializer.re\"",
          "1402:  zend_long id;",
          "1405:  if (!var_hash) return 0;",
          "1407:  id = parse_iv(start + 2) - 1;",
          "1408:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1412:  zval_ptr_dtor(rval);",
          "1413:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1414:   ZVAL_UNDEF(rval);",
          "1415:   return 1;",
          "1417:  if (Z_ISREF_P(rval_ref)) {",
          "1418:   ZVAL_COPY(rval, rval_ref);",
          "1420:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1421:   ZVAL_COPY(rval, rval_ref);",
          "1426: #line 1427 \"ext/standard/var_unserializer.c\"",
          "1428: #line 978 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1154: #line 1155 \"ext/standard/var_unserializer.c\"",
          "1155: yy81:",
          "1156:  yych = *++YYCURSOR;",
          "1157:  if (yych == '\"') goto yy94;",
          "1158:  goto yy18;",
          "1159: yy82:",
          "1160:  ++YYCURSOR;",
          "1161: #line 841 \"ext/standard/var_unserializer.re\"",
          "1162:  {",
          "1163:  size_t len, len2, len3, maxlen;",
          "1164:  zend_long elements;",
          "1165:  char *str;",
          "1166:  zend_string *class_name;",
          "1167:  zend_class_entry *ce;",
          "1168:  int incomplete_class = 0;",
          "1170:  int custom_object = 0;",
          "1172:  zval user_func;",
          "1173:  zval retval;",
          "1174:  zval args[1];",
          "1176:     if (!var_hash) return 0;",
          "1177:  if (*start == 'C') {",
          "1178:   custom_object = 1;",
          "1179:  }",
          "1181:  len2 = len = parse_uiv(start + 2);",
          "1182:  maxlen = max - YYCURSOR;",
          "1183:  if (maxlen < len || len == 0) {",
          "1185:   return 0;",
          "1186:  }",
          "1188:  str = (char*)YYCURSOR;",
          "1190:  YYCURSOR += len;",
          "1192:  if (*(YYCURSOR) != '\"') {",
          "1194:   return 0;",
          "1195:  }",
          "1196:  if (*(YYCURSOR+1) != ':') {",
          "1198:   return 0;",
          "1199:  }",
          "1201:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1202:  if (len3 != len)",
          "1203:  {",
          "1205:   return 0;",
          "1206:  }",
          "1208:  class_name = zend_string_init(str, len, 0);",
          "1210:  do {",
          "1211:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "1212:    incomplete_class = 1;",
          "1213:    ce = PHP_IC_ENTRY;",
          "1214:    break;",
          "1215:   }",
          "1218:   BG(serialize_lock)++;",
          "1219:   ce = zend_lookup_class(class_name);",
          "1220:   if (ce) {",
          "1221:    BG(serialize_lock)--;",
          "1222:    if (EG(exception)) {",
          "1223:     zend_string_release(class_name);",
          "1224:     return 0;",
          "1225:    }",
          "1226:    break;",
          "1227:   }",
          "1228:   BG(serialize_lock)--;",
          "1230:   if (EG(exception)) {",
          "1231:    zend_string_release(class_name);",
          "1232:    return 0;",
          "1233:   }",
          "1236:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1237:    incomplete_class = 1;",
          "1238:    ce = PHP_IC_ENTRY;",
          "1239:    break;",
          "1240:   }",
          "1243:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1245:   ZVAL_STR_COPY(&args[0], class_name);",
          "1246:   BG(serialize_lock)++;",
          "1247:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1248:    BG(serialize_lock)--;",
          "1249:    if (EG(exception)) {",
          "1250:     zend_string_release(class_name);",
          "1251:     zval_ptr_dtor(&user_func);",
          "1252:     zval_ptr_dtor(&args[0]);",
          "1253:     return 0;",
          "1254:    }",
          "1255:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1256:    incomplete_class = 1;",
          "1257:    ce = PHP_IC_ENTRY;",
          "1258:    zval_ptr_dtor(&user_func);",
          "1259:    zval_ptr_dtor(&args[0]);",
          "1260:    break;",
          "1261:   }",
          "1262:   BG(serialize_lock)--;",
          "1263:   zval_ptr_dtor(&retval);",
          "1264:   if (EG(exception)) {",
          "1265:    zend_string_release(class_name);",
          "1266:    zval_ptr_dtor(&user_func);",
          "1267:    zval_ptr_dtor(&args[0]);",
          "1268:    return 0;",
          "1269:   }",
          "1272:   BG(serialize_lock)++;",
          "1273:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1274:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1275:    incomplete_class = 1;",
          "1276:    ce = PHP_IC_ENTRY;",
          "1277:   }",
          "1278:   BG(serialize_lock)--;",
          "1280:   zval_ptr_dtor(&user_func);",
          "1281:   zval_ptr_dtor(&args[0]);",
          "1282:   break;",
          "1283:  } while (1);",
          "1287:  if (custom_object) {",
          "1288:   int ret;",
          "1290:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1292:   if (ret && incomplete_class) {",
          "1293:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1294:   }",
          "1295:   zend_string_release(class_name);",
          "1296:   return ret;",
          "1297:  }",
          "1299:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1301:  if (elements < 0) {",
          "1302:     zend_string_release(class_name);",
          "1303:     return 0;",
          "1304:  }",
          "1306:  if (incomplete_class) {",
          "1307:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1308:  }",
          "1309:  zend_string_release(class_name);",
          "1311:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1312: }",
          "1313: #line 1314 \"ext/standard/var_unserializer.c\"",
          "1314: yy84:",
          "1315:  ++YYCURSOR;",
          "1316: #line 772 \"ext/standard/var_unserializer.re\"",
          "1317:  {",
          "1318:  size_t len, maxlen;",
          "1319:  zend_string *str;",
          "1321:  len = parse_uiv(start + 2);",
          "1322:  maxlen = max - YYCURSOR;",
          "1323:  if (maxlen < len) {",
          "1325:   return 0;",
          "1326:  }",
          "1328:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1329:   return 0;",
          "1330:  }",
          "1332:  if (*(YYCURSOR) != '\"') {",
          "1333:   zend_string_free(str);",
          "1335:   return 0;",
          "1336:  }",
          "1338:  if (*(YYCURSOR + 1) != ';') {",
          "1339:   efree(str);",
          "1341:   return 0;",
          "1342:  }",
          "1344:  YYCURSOR += 2;",
          "1347:  ZVAL_STR(rval, str);",
          "1348:  return 1;",
          "1349: }",
          "1350: #line 1351 \"ext/standard/var_unserializer.c\"",
          "1351: yy86:",
          "1352:  ++YYCURSOR;",
          "1353: #line 806 \"ext/standard/var_unserializer.re\"",
          "1354:  {",
          "1355:  zend_long elements = parse_iv(start + 2);",
          "1358:     if (!var_hash) return 0;",
          "1360:  if (elements < 0) {",
          "1361:   return 0;",
          "1362:  }",
          "1364:  array_init_size(rval, elements);",
          "1365:  if (elements) {",
          "1368:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1369:  }",
          "1371:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1372:   return 0;",
          "1373:  }",
          "1375:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1376: }",
          "1378: yy88:",
          "1381:   if (yych == '+') goto yy96;",
          "1382:   goto yy18;",
          "1386:   if (yych >= ':') goto yy18;",
          "1388: yy89:",
          "1393:  if (yych <= '9') goto yy89;",
          "1394:  if (yych == ';') goto yy71;",
          "1395:  goto yy18;",
          "1396: yy91:",
          "1397:  yych = *++YYCURSOR;",
          "1398:  if (yych == ';') goto yy97;",
          "1399:  goto yy18;",
          "1400: yy92:",
          "1402: #line 830 \"ext/standard/var_unserializer.re\"",
          "1404:  long elements;",
          "1405:     if (!var_hash) return 0;",
          "1407:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1408:  if (elements < 0) {",
          "1409:   return 0;",
          "1410:  }",
          "1411:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1412: }",
          "1413: #line 1414 \"ext/standard/var_unserializer.c\"",
          "1414: yy94:",
          "1415:  ++YYCURSOR;",
          "1416: #line 740 \"ext/standard/var_unserializer.re\"",
          "1417:  {",
          "1418:  size_t len, maxlen;",
          "1419:  char *str;",
          "1421:  len = parse_uiv(start + 2);",
          "1422:  maxlen = max - YYCURSOR;",
          "1423:  if (maxlen < len) {",
          "1428:  str = (char*)YYCURSOR;",
          "1430:  YYCURSOR += len;",
          "1432:  if (*(YYCURSOR) != '\"') {",
          "1434:   return 0;",
          "1437:  if (*(YYCURSOR + 1) != ';') {",
          "1439:   return 0;",
          "1440:  }",
          "1442:  YYCURSOR += 2;",
          "1445:  ZVAL_STRINGL(rval, str, len);",
          "1446:  return 1;",
          "1447: }",
          "1448: #line 1449 \"ext/standard/var_unserializer.c\"",
          "1449: yy96:",
          "1450:  yych = *++YYCURSOR;",
          "1451:  if (yych <= '/') goto yy18;",
          "1452:  if (yych <= '9') goto yy89;",
          "1453:  goto yy18;",
          "1454: yy97:",
          "1455:  ++YYCURSOR;",
          "1456: #line 715 \"ext/standard/var_unserializer.re\"",
          "1457:  {",
          "1460:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1461:   ZVAL_DOUBLE(rval, ZEND_NAN);",
          "1462:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1463:   ZVAL_DOUBLE(rval, ZEND_INFINITY);",
          "1464:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1465:   ZVAL_DOUBLE(rval, -ZEND_INFINITY);",
          "1467:   ZVAL_NULL(rval);",
          "1472: #line 1473 \"ext/standard/var_unserializer.c\"",
          "1474: #line 1001 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "70: #define VAR_ENTRIES_MAX 1024",
          "71: #define VAR_ENTRIES_DBG 0",
          "73: typedef struct {",
          "74:  zval *data[VAR_ENTRIES_MAX];",
          "75:  zend_long used_slots;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "74: #define VAR_WAKEUP_FLAG 1",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "138:         (*var_hashx)->last_dtor = var_hash;",
          "139:     }",
          "140:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "141:     return &var_hash->data[var_hash->used_slots++];",
          "142: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "144:  Z_ACCESS_FLAGS(var_hash->data[var_hash->used_slots]) = 0;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "185:  zend_long i;",
          "186:  var_entries *var_hash = (*var_hashx)->first;",
          "187:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "188: #if VAR_ENTRIES_DBG",
          "189:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "190: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "192:  zend_bool wakeup_failed = 0;",
          "193:  zval wakeup_name;",
          "194:  ZVAL_UNDEF(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "198:  while (var_dtor_hash) {",
          "199:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "200: #if VAR_ENTRIES_DBG",
          "201:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "202: #endif",
          "204:   }",
          "205:   next = var_dtor_hash->next;",
          "206:   efree_size(var_dtor_hash, sizeof(var_dtor_entries));",
          "207:   var_dtor_hash = next;",
          "208:  }",
          "209: }",
          "",
          "[Removed Lines]",
          "203:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "",
          "[Added Lines]",
          "208:    zval *zv = &var_dtor_hash->data[i];",
          "214:    if (Z_ACCESS_FLAGS_P(zv) == VAR_WAKEUP_FLAG) {",
          "215:     if (!wakeup_failed) {",
          "216:      zval retval;",
          "217:      if (Z_ISUNDEF(wakeup_name)) {",
          "218:       ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "219:      }",
          "221:      BG(serialize_lock)++;",
          "222:      if (call_user_function_ex(CG(function_table), zv, &wakeup_name, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "223:       wakeup_failed = 1;",
          "224:       GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "225:      }",
          "226:      BG(serialize_lock)--;",
          "228:      zval_ptr_dtor(&retval);",
          "229:     } else {",
          "230:      GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "231:     }",
          "232:    }",
          "234:    zval_ptr_dtor(zv);",
          "241:  zval_ptr_dtor(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "509: #endif",
          "510: static inline int object_common2(UNSERIALIZE_PARAMETER, zend_long elements)",
          "511: {",
          "514:  HashTable *ht;",
          "515:  zend_bool has_wakeup;",
          "",
          "[Removed Lines]",
          "512:  zval retval;",
          "513:  zval fname;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "534:  ZVAL_DEREF(rval);",
          "535:  if (has_wakeup) {",
          "548:  }",
          "550:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "",
          "[Removed Lines]",
          "536:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "537:   BG(serialize_lock)++;",
          "538:   if (call_user_function_ex(CG(function_table), rval, &fname, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "539:    GC_FLAGS(Z_OBJ_P(rval)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "540:   }",
          "541:   BG(serialize_lock)--;",
          "542:   zval_dtor(&fname);",
          "543:   zval_dtor(&retval);",
          "544:  }",
          "546:  if (EG(exception)) {",
          "547:   return 0;",
          "",
          "[Added Lines]",
          "568:   zval *wakeup_var = var_tmp_var(var_hash);",
          "569:   ZVAL_COPY(wakeup_var, rval);",
          "570:   Z_ACCESS_FLAGS_P(wakeup_var) = VAR_WAKEUP_FLAG;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7f0de1a138a69beb7c537fd1ec84afbc91a45b19",
      "candidate_info": {
        "commit_hash": "7f0de1a138a69beb7c537fd1ec84afbc91a45b19",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/7f0de1a138a69beb7c537fd1ec84afbc91a45b19",
        "files": [
          "ext/exif/exif.c",
          "ext/exif/tests/bug73737.phpt",
          "ext/exif/tests/bug73737.tiff",
          "ext/phar/phar.c",
          "ext/phar/tests/bug73764.phar",
          "ext/phar/tests/bug73764.phpt",
          "ext/phar/tests/bug73768.phar",
          "ext/phar/tests/bug73768.phpt",
          "ext/standard/tests/serialize/bug73825.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-5.6' into PHP-7.0\n\n* PHP-5.6:\n  Fix bug #73737 FPE when parsing a tag format\n  Fix bug #73773 - Seg fault when loading hostile phar\n  Fix bug #73825 - Heap out of bounds read on unserialize in finish_nested_data()\n  Fix bug #73768 - Memory corruption when loading hostile phar\n  Fix int overflows in phar (bug #73764)",
        "before_after_code_files": [
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/exif/tests/bug73737.phpt||ext/exif/tests/bug73737.phpt",
          "ext/phar/phar.c||ext/phar/phar.c",
          "ext/phar/tests/bug73764.phpt||ext/phar/tests/bug73764.phpt",
          "ext/phar/tests/bug73768.phpt||ext/phar/tests/bug73768.phpt",
          "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1297:    if (s_den == 0) {",
          "1298:     return 0;",
          "1299:    } else {",
          "1301:    }",
          "1303:   case TAG_FMT_SSHORT:    return php_ifd_get16u(value, motorola_intel);",
          "",
          "[Removed Lines]",
          "1300:     return php_ifd_get32s(value, motorola_intel) / s_den;",
          "",
          "[Added Lines]",
          "1300:     return (size_t)((double)php_ifd_get32s(value, motorola_intel) / s_den);",
          "",
          "---------------"
        ],
        "ext/exif/tests/bug73737.phpt||ext/exif/tests/bug73737.phpt": [
          "File: ext/exif/tests/bug73737.phpt -> ext/exif/tests/bug73737.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73737 (Crash when parsing a tag format)",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded('exif')) print 'skip exif extension not available';?>",
          "5: --FILE--",
          "6: <?php",
          "7:  $exif = exif_thumbnail(__DIR__ . '/bug73737.tiff');",
          "8:  var_dump($exif);",
          "9: ?>",
          "10: --EXPECTF--",
          "11: Warning: exif_thumbnail(bug73737.tiff): Error in TIFF: filesize(x0030) less than start of IFD dir(x10102) in %s line %d",
          "12: bool(false)",
          "",
          "---------------"
        ],
        "ext/phar/phar.c||ext/phar/phar.c": [
          "File: ext/phar/phar.c -> ext/phar/phar.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "984:   if (alias && alias_len && (alias_len != (int)tmp_len || strncmp(alias, buffer, tmp_len)))",
          "985:   {",
          "987:    php_stream_close(fp);",
          "989:    if (signature) {",
          "",
          "[Removed Lines]",
          "986:    buffer[tmp_len] = '\\0';",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "991:    }",
          "993:    if (error) {",
          "995:    }",
          "997:    efree(savebuf);",
          "",
          "[Removed Lines]",
          "994:     spprintf(error, 0, \"cannot load phar \\\"%s\\\" with implicit alias \\\"%s\\\" under different alias \\\"%s\\\"\", fname, buffer, alias);",
          "",
          "[Added Lines]",
          "993:     spprintf(error, 0, \"cannot load phar \\\"%s\\\" with implicit alias \\\"%.*s\\\" under different alias \\\"%s\\\"\", fname, tmp_len, buffer, alias);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1057:  entry.is_persistent = mydata->is_persistent;",
          "1059:  for (manifest_index = 0; manifest_index < manifest_count; ++manifest_index) {",
          "1061:    MAPPHAR_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated manifest entry)\")",
          "1062:   }",
          "",
          "[Removed Lines]",
          "1060:   if (buffer + 4 > endbuffer) {",
          "",
          "[Added Lines]",
          "1059:   if (buffer + 28 > endbuffer) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1071:    entry.manifest_pos = manifest_index;",
          "1072:   }",
          "1075:    MAPPHAR_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated manifest entry)\");",
          "1076:   }",
          "",
          "[Removed Lines]",
          "1074:   if (entry.filename_len + 20 > endbuffer - buffer) {",
          "",
          "[Added Lines]",
          "1073:   if (entry.filename_len > endbuffer - buffer - 24) {",
          "",
          "---------------"
        ],
        "ext/phar/tests/bug73764.phpt||ext/phar/tests/bug73764.phpt": [
          "File: ext/phar/tests/bug73764.phpt -> ext/phar/tests/bug73764.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Phar: PHP bug #73764: Crash while loading hostile phar archive",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded(\"phar\")) die(\"skip\"); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: chdir(__DIR__);",
          "8: try {",
          "9: $p = Phar::LoadPhar('bug73764.phar', 'alias.phar');",
          "10: echo \"OK\\n\";",
          "11: } catch(PharException $e) {",
          "12:  echo $e->getMessage();",
          "13: }",
          "14: ?>",
          "15: --EXPECTF--",
          "16: internal corruption of phar \"%sbug73764.phar\" (truncated manifest entry)",
          "",
          "---------------"
        ],
        "ext/phar/tests/bug73768.phpt||ext/phar/tests/bug73768.phpt": [
          "File: ext/phar/tests/bug73768.phpt -> ext/phar/tests/bug73768.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Phar: PHP bug #73768: Memory corruption when loading hostile phar",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded(\"phar\")) die(\"skip\"); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: chdir(__DIR__);",
          "8: try {",
          "9: $p = Phar::LoadPhar('bug73768.phar', 'alias.phar');",
          "10: echo \"OK\\n\";",
          "11: } catch(PharException $e) {",
          "12:  echo $e->getMessage();",
          "13: }",
          "14: ?>",
          "15: --EXPECTF--",
          "16: cannot load phar \"%sbug73768.phar\" with implicit alias \"\" under different alias \"alias.phar\"",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt": [
          "File: ext/standard/tests/serialize/bug73825.phpt -> ext/standard/tests/serialize/bug73825.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73825 Heap out of bounds read on unserialize in finish_nested_data()",
          "3: --FILE--",
          "4: <?php",
          "5: $obj = unserialize('O:8:\"00000000\":');",
          "6: var_dump($obj);",
          "7: ?>",
          "8: --EXPECTF--",
          "9: Warning: Bad unserialize data in %sbug73825.php on line %d",
          "11: Notice: unserialize(): Error at offset 13 of 15 bytes in %sbug73825.php on line %d",
          "12: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "433: {",
          "434:  zend_long elements;",
          "436:  elements = parse_iv2((*p) + 2, p);",
          "438:  (*p) += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "436:  if( *p >= max - 2) {",
          "437:   zend_error(E_WARNING, \"Bad unserialize data\");",
          "438:   return -1;",
          "439:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "442:  } else {",
          "447:  }",
          "449:  return elements;",
          "",
          "[Removed Lines]",
          "445:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ZSTR_VAL(ce->name));",
          "446:   return 0;",
          "",
          "[Added Lines]",
          "450:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
          "451:   return -1;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "550:  start = cursor;",
          "554: {",
          "555:  YYCTYPE yych;",
          "556:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "553: #line 554 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "558: #line 559 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "587:     0,   0,   0,   0,   0,   0,   0,   0,",
          "588:     0,   0,   0,   0,   0,   0,   0,   0,",
          "589:  };",
          "590:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "591:  yych = *YYCURSOR;",
          "592:  switch (yych) {",
          "593:  case 'C':",
          "595:  case 'N': goto yy5;",
          "602:  case 'o': goto yy12;",
          "607:  }",
          "608: yy2:",
          "610: yy3:",
          "612:  { return 0; }",
          "614: yy4:",
          "615:  yych = *(YYMARKER = ++YYCURSOR);",
          "617:  goto yy3;",
          "618: yy5:",
          "619:  yych = *++YYCURSOR;",
          "621:  goto yy3;",
          "622: yy6:",
          "623:  yych = *(YYMARKER = ++YYCURSOR);",
          "625:  goto yy3;",
          "626: yy7:",
          "627:  yych = *(YYMARKER = ++YYCURSOR);",
          "629:  goto yy3;",
          "630: yy8:",
          "631:  yych = *(YYMARKER = ++YYCURSOR);",
          "633:  goto yy3;",
          "634: yy9:",
          "635:  yych = *(YYMARKER = ++YYCURSOR);",
          "637:  goto yy3;",
          "638: yy10:",
          "639:  yych = *(YYMARKER = ++YYCURSOR);",
          "641:  goto yy3;",
          "642: yy11:",
          "643:  yych = *(YYMARKER = ++YYCURSOR);",
          "645:  goto yy3;",
          "646: yy12:",
          "647:  yych = *(YYMARKER = ++YYCURSOR);",
          "649:  goto yy3;",
          "650: yy13:",
          "651:  yych = *(YYMARKER = ++YYCURSOR);",
          "653:  goto yy3;",
          "654: yy14:",
          "659:  ++YYCURSOR;",
          "661:  {",
          "663:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "665: }",
          "667: yy17:",
          "668:  yych = *++YYCURSOR;",
          "669:  if (yybm[0+yych] & 128) {",
          "671:  }",
          "673: yy18:",
          "674:  YYCURSOR = YYMARKER;",
          "675:  goto yy3;",
          "676: yy19:",
          "686:  yych = *++YYCURSOR;",
          "695:  }",
          "701:  goto yy18;",
          "710:  if (yych <= '/') goto yy18;",
          "714:  yych = *++YYCURSOR;",
          "723:   }",
          "732:   }",
          "733:  }",
          "744:  }",
          "755:  }",
          "757:  yych = *++YYCURSOR;",
          "758:  if (yych <= ',') {",
          "761:  } else {",
          "763:   if (yych <= '/') goto yy18;",
          "765:   goto yy18;",
          "766:  }",
          "768:  yych = *++YYCURSOR;",
          "770:  if (yych <= '/') goto yy18;",
          "780:  ++YYCURSOR;",
          "781:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "782:  yych = *YYCURSOR;",
          "786:  if (yych <= '/') goto yy18;",
          "790:  yych = *++YYCURSOR;",
          "794:  ++YYCURSOR;",
          "797:  if (yych <= '/') goto yy18;",
          "798:  if (yych <= '9') goto yy34;",
          "800:  goto yy18;",
          "802:  yych = *++YYCURSOR;",
          "803:  if (yych <= '/') goto yy18;",
          "804:  if (yych >= ':') goto yy18;",
          "806:  ++YYCURSOR;",
          "807:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "808:  yych = *YYCURSOR;",
          "809:  if (yych <= '/') goto yy18;",
          "814:  yych = *++YYCURSOR;",
          "818:  ++YYCURSOR;",
          "843:  }",
          "871:  }",
          "881:  yych = *++YYCURSOR;",
          "882:  if (yych <= '/') goto yy18;",
          "891:  goto yy18;",
          "893:  yych = *++YYCURSOR;",
          "894:  if (yych <= '/') goto yy18;",
          "895:  if (yych >= ':') goto yy18;",
          "897:  ++YYCURSOR;",
          "898:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "899:  yych = *YYCURSOR;",
          "900:  if (yych <= '/') goto yy18;",
          "905:  yych = *++YYCURSOR;",
          "909:  ++YYCURSOR;",
          "912:  if (yych <= '/') goto yy18;",
          "915:  goto yy18;",
          "917:  yych = *++YYCURSOR;",
          "918:  if (yych <= '/') goto yy18;",
          "919:  if (yych >= ':') goto yy18;",
          "921:  ++YYCURSOR;",
          "922:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "923:  yych = *YYCURSOR;",
          "924:  if (yych <= '/') goto yy18;",
          "929:  yych = *++YYCURSOR;",
          "933:  ++YYCURSOR;",
          "935:  {",
          "943:   return 0;",
          "944:  }",
          "950:  }",
          "956:  }",
          "958:  return 1;",
          "959: }",
          "962:  yych = *++YYCURSOR;",
          "964:  goto yy18;",
          "966:  yych = *++YYCURSOR;",
          "968:  goto yy18;",
          "970:  ++YYCURSOR;",
          "979:  ++YYCURSOR;",
          "980:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "981:  yych = *YYCURSOR;",
          "982:  if (yych <= ';') {",
          "983:   if (yych <= '/') goto yy18;",
          "985:   if (yych <= ':') goto yy18;",
          "986:  } else {",
          "987:   if (yych <= 'E') {",
          "988:    if (yych <= 'D') goto yy18;",
          "990:   } else {",
          "992:    goto yy18;",
          "993:   }",
          "994:  }",
          "996:  ++YYCURSOR;",
          "998:  {",
          "999: #if SIZEOF_ZEND_LONG == 4",
          "1000: use_double:",
          "",
          "[Removed Lines]",
          "594:  case 'O': goto yy4;",
          "596:  case 'R': goto yy6;",
          "597:  case 'S': goto yy7;",
          "598:  case 'a': goto yy8;",
          "599:  case 'b': goto yy9;",
          "600:  case 'd': goto yy10;",
          "601:  case 'i': goto yy11;",
          "603:  case 'r': goto yy13;",
          "604:  case 's': goto yy14;",
          "605:  case '}': goto yy15;",
          "606:  default: goto yy2;",
          "609:  ++YYCURSOR;",
          "611: #line 922 \"ext/standard/var_unserializer.re\"",
          "613: #line 614 \"ext/standard/var_unserializer.c\"",
          "616:  if (yych == ':') goto yy17;",
          "620:  if (yych == ';') goto yy19;",
          "624:  if (yych == ':') goto yy21;",
          "628:  if (yych == ':') goto yy22;",
          "632:  if (yych == ':') goto yy23;",
          "636:  if (yych == ':') goto yy24;",
          "640:  if (yych == ':') goto yy25;",
          "644:  if (yych == ':') goto yy26;",
          "648:  if (yych == ':') goto yy27;",
          "652:  if (yych == ':') goto yy28;",
          "655:  yych = *(YYMARKER = ++YYCURSOR);",
          "656:  if (yych == ':') goto yy29;",
          "657:  goto yy3;",
          "658: yy15:",
          "660: #line 916 \"ext/standard/var_unserializer.re\"",
          "666: #line 667 \"ext/standard/var_unserializer.c\"",
          "670:   goto yy31;",
          "672:  if (yych == '+') goto yy30;",
          "677:  ++YYCURSOR;",
          "678: #line 609 \"ext/standard/var_unserializer.re\"",
          "679:  {",
          "681:  ZVAL_NULL(rval);",
          "682:  return 1;",
          "683: }",
          "684: #line 685 \"ext/standard/var_unserializer.c\"",
          "685: yy21:",
          "687:  if (yych <= ',') {",
          "688:   if (yych == '+') goto yy33;",
          "689:   goto yy18;",
          "690:  } else {",
          "691:   if (yych <= '-') goto yy33;",
          "692:   if (yych <= '/') goto yy18;",
          "693:   if (yych <= '9') goto yy34;",
          "694:   goto yy18;",
          "696: yy22:",
          "697:  yych = *++YYCURSOR;",
          "698:  if (yych == '+') goto yy36;",
          "699:  if (yych <= '/') goto yy18;",
          "700:  if (yych <= '9') goto yy37;",
          "702: yy23:",
          "703:  yych = *++YYCURSOR;",
          "704:  if (yych == '+') goto yy39;",
          "705:  if (yych <= '/') goto yy18;",
          "706:  if (yych <= '9') goto yy40;",
          "707:  goto yy18;",
          "708: yy24:",
          "709:  yych = *++YYCURSOR;",
          "711:  if (yych <= '1') goto yy42;",
          "712:  goto yy18;",
          "713: yy25:",
          "715:  if (yych <= '/') {",
          "716:   if (yych <= ',') {",
          "717:    if (yych == '+') goto yy43;",
          "718:    goto yy18;",
          "719:   } else {",
          "720:    if (yych <= '-') goto yy44;",
          "721:    if (yych <= '.') goto yy45;",
          "722:    goto yy18;",
          "724:  } else {",
          "725:   if (yych <= 'I') {",
          "726:    if (yych <= '9') goto yy46;",
          "727:    if (yych <= 'H') goto yy18;",
          "728:    goto yy48;",
          "729:   } else {",
          "730:    if (yych == 'N') goto yy49;",
          "731:    goto yy18;",
          "734: yy26:",
          "735:  yych = *++YYCURSOR;",
          "736:  if (yych <= ',') {",
          "737:   if (yych == '+') goto yy50;",
          "738:   goto yy18;",
          "739:  } else {",
          "740:   if (yych <= '-') goto yy50;",
          "741:   if (yych <= '/') goto yy18;",
          "742:   if (yych <= '9') goto yy51;",
          "743:   goto yy18;",
          "745: yy27:",
          "746:  yych = *++YYCURSOR;",
          "747:  if (yych <= ',') {",
          "748:   if (yych == '+') goto yy53;",
          "749:   goto yy18;",
          "750:  } else {",
          "751:   if (yych <= '-') goto yy53;",
          "752:   if (yych <= '/') goto yy18;",
          "753:   if (yych <= '9') goto yy54;",
          "754:   goto yy18;",
          "756: yy28:",
          "759:   if (yych == '+') goto yy56;",
          "760:   goto yy18;",
          "762:   if (yych <= '-') goto yy56;",
          "764:   if (yych <= '9') goto yy57;",
          "767: yy29:",
          "769:  if (yych == '+') goto yy59;",
          "771:  if (yych <= '9') goto yy60;",
          "772:  goto yy18;",
          "773: yy30:",
          "774:  yych = *++YYCURSOR;",
          "775:  if (yybm[0+yych] & 128) {",
          "776:   goto yy31;",
          "777:  }",
          "778:  goto yy18;",
          "779: yy31:",
          "783:  if (yybm[0+yych] & 128) {",
          "784:   goto yy31;",
          "785:  }",
          "787:  if (yych <= ':') goto yy62;",
          "788:  goto yy18;",
          "789: yy33:",
          "791:  if (yych <= '/') goto yy18;",
          "792:  if (yych >= ':') goto yy18;",
          "793: yy34:",
          "795:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "796:  yych = *YYCURSOR;",
          "799:  if (yych == ';') goto yy63;",
          "801: yy36:",
          "805: yy37:",
          "810:  if (yych <= '9') goto yy37;",
          "811:  if (yych <= ':') goto yy65;",
          "812:  goto yy18;",
          "813: yy39:",
          "815:  if (yych <= '/') goto yy18;",
          "816:  if (yych >= ':') goto yy18;",
          "817: yy40:",
          "819:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "820:  yych = *YYCURSOR;",
          "821:  if (yych <= '/') goto yy18;",
          "822:  if (yych <= '9') goto yy40;",
          "823:  if (yych <= ':') goto yy66;",
          "824:  goto yy18;",
          "825: yy42:",
          "826:  yych = *++YYCURSOR;",
          "827:  if (yych == ';') goto yy67;",
          "828:  goto yy18;",
          "829: yy43:",
          "830:  yych = *++YYCURSOR;",
          "831:  if (yych == '.') goto yy45;",
          "832:  if (yych <= '/') goto yy18;",
          "833:  if (yych <= '9') goto yy46;",
          "834:  goto yy18;",
          "835: yy44:",
          "836:  yych = *++YYCURSOR;",
          "837:  if (yych <= '/') {",
          "838:   if (yych != '.') goto yy18;",
          "839:  } else {",
          "840:   if (yych <= '9') goto yy46;",
          "841:   if (yych == 'I') goto yy48;",
          "842:   goto yy18;",
          "844: yy45:",
          "845:  yych = *++YYCURSOR;",
          "846:  if (yych <= '/') goto yy18;",
          "847:  if (yych <= '9') goto yy69;",
          "848:  goto yy18;",
          "849: yy46:",
          "850:  ++YYCURSOR;",
          "851:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "852:  yych = *YYCURSOR;",
          "853:  if (yych <= ':') {",
          "854:   if (yych <= '.') {",
          "855:    if (yych <= '-') goto yy18;",
          "856:    goto yy69;",
          "857:   } else {",
          "858:    if (yych <= '/') goto yy18;",
          "859:    if (yych <= '9') goto yy46;",
          "860:    goto yy18;",
          "861:   }",
          "862:  } else {",
          "863:   if (yych <= 'E') {",
          "864:    if (yych <= ';') goto yy71;",
          "865:    if (yych <= 'D') goto yy18;",
          "866:    goto yy73;",
          "867:   } else {",
          "868:    if (yych == 'e') goto yy73;",
          "869:    goto yy18;",
          "870:   }",
          "872: yy48:",
          "873:  yych = *++YYCURSOR;",
          "874:  if (yych == 'N') goto yy74;",
          "875:  goto yy18;",
          "876: yy49:",
          "877:  yych = *++YYCURSOR;",
          "878:  if (yych == 'A') goto yy75;",
          "879:  goto yy18;",
          "880: yy50:",
          "883:  if (yych >= ':') goto yy18;",
          "884: yy51:",
          "885:  ++YYCURSOR;",
          "886:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "887:  yych = *YYCURSOR;",
          "888:  if (yych <= '/') goto yy18;",
          "889:  if (yych <= '9') goto yy51;",
          "890:  if (yych == ';') goto yy76;",
          "892: yy53:",
          "896: yy54:",
          "901:  if (yych <= '9') goto yy54;",
          "902:  if (yych <= ':') goto yy78;",
          "903:  goto yy18;",
          "904: yy56:",
          "906:  if (yych <= '/') goto yy18;",
          "907:  if (yych >= ':') goto yy18;",
          "908: yy57:",
          "910:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "911:  yych = *YYCURSOR;",
          "913:  if (yych <= '9') goto yy57;",
          "914:  if (yych == ';') goto yy79;",
          "916: yy59:",
          "920: yy60:",
          "925:  if (yych <= '9') goto yy60;",
          "926:  if (yych <= ':') goto yy81;",
          "927:  goto yy18;",
          "928: yy62:",
          "930:  if (yych == '\"') goto yy82;",
          "931:  goto yy18;",
          "932: yy63:",
          "934: #line 558 \"ext/standard/var_unserializer.re\"",
          "936:  zend_long id;",
          "939:  if (!var_hash) return 0;",
          "941:  id = parse_iv(start + 2) - 1;",
          "942:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "946:  zval_ptr_dtor(rval);",
          "947:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "948:   ZVAL_UNDEF(rval);",
          "949:   return 1;",
          "951:  if (Z_ISREF_P(rval_ref)) {",
          "952:   ZVAL_COPY(rval, rval_ref);",
          "953:  } else {",
          "954:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "955:   ZVAL_COPY(rval, rval_ref);",
          "960: #line 961 \"ext/standard/var_unserializer.c\"",
          "961: yy65:",
          "963:  if (yych == '\"') goto yy84;",
          "965: yy66:",
          "967:  if (yych == '{') goto yy86;",
          "969: yy67:",
          "971: #line 615 \"ext/standard/var_unserializer.re\"",
          "972:  {",
          "974:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "975:  return 1;",
          "976: }",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "978: yy69:",
          "984:   if (yych <= '9') goto yy69;",
          "989:    goto yy73;",
          "991:    if (yych == 'e') goto yy73;",
          "995: yy71:",
          "997: #line 663 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "600:  case 'O': goto yy13;",
          "602:  case 'R': goto yy2;",
          "603:  case 'S': goto yy10;",
          "604:  case 'a': goto yy11;",
          "605:  case 'b': goto yy6;",
          "606:  case 'd': goto yy8;",
          "607:  case 'i': goto yy7;",
          "609:  case 'r': goto yy4;",
          "610:  case 's': goto yy9;",
          "611:  case '}': goto yy14;",
          "612:  default: goto yy16;",
          "615:  yych = *(YYMARKER = ++YYCURSOR);",
          "616:  if (yych == ':') goto yy95;",
          "618: #line 936 \"ext/standard/var_unserializer.re\"",
          "620: #line 621 \"ext/standard/var_unserializer.c\"",
          "623:  if (yych == ':') goto yy89;",
          "627:  if (yych == ';') goto yy87;",
          "631:  if (yych == ':') goto yy83;",
          "635:  if (yych == ':') goto yy77;",
          "639:  if (yych == ':') goto yy53;",
          "643:  if (yych == ':') goto yy46;",
          "647:  if (yych == ':') goto yy39;",
          "651:  if (yych == ':') goto yy32;",
          "655:  if (yych == ':') goto yy25;",
          "659:  if (yych == ':') goto yy17;",
          "663: #line 930 \"ext/standard/var_unserializer.re\"",
          "669: #line 670 \"ext/standard/var_unserializer.c\"",
          "670: yy16:",
          "671:  yych = *++YYCURSOR;",
          "672:  goto yy3;",
          "676:   goto yy20;",
          "678:  if (yych == '+') goto yy19;",
          "684:  if (yybm[0+yych] & 128) {",
          "685:   goto yy20;",
          "688: yy20:",
          "689:  ++YYCURSOR;",
          "690:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "691:  yych = *YYCURSOR;",
          "692:  if (yybm[0+yych] & 128) {",
          "693:   goto yy20;",
          "694:  }",
          "696:  if (yych >= ';') goto yy18;",
          "698:  if (yych != '\"') goto yy18;",
          "699:  ++YYCURSOR;",
          "700: #line 778 \"ext/standard/var_unserializer.re\"",
          "701:  {",
          "702:  size_t len, len2, len3, maxlen;",
          "703:  zend_long elements;",
          "704:  char *str;",
          "705:  zend_string *class_name;",
          "706:  zend_class_entry *ce;",
          "707:  int incomplete_class = 0;",
          "709:  int custom_object = 0;",
          "711:  zval user_func;",
          "712:  zval retval;",
          "713:  zval args[1];",
          "715:     if (!var_hash) return 0;",
          "716:  if (*start == 'C') {",
          "717:   custom_object = 1;",
          "718:  }",
          "720:  len2 = len = parse_uiv(start + 2);",
          "721:  maxlen = max - YYCURSOR;",
          "722:  if (maxlen < len || len == 0) {",
          "724:   return 0;",
          "725:  }",
          "727:  str = (char*)YYCURSOR;",
          "729:  YYCURSOR += len;",
          "731:  if (*(YYCURSOR) != '\"') {",
          "733:   return 0;",
          "734:  }",
          "735:  if (*(YYCURSOR+1) != ':') {",
          "737:   return 0;",
          "738:  }",
          "740:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "741:  if (len3 != len)",
          "742:  {",
          "744:   return 0;",
          "745:  }",
          "747:  class_name = zend_string_init(str, len, 0);",
          "749:  do {",
          "750:   if(!unserialize_allowed_class(class_name, classes)) {",
          "751:    incomplete_class = 1;",
          "752:    ce = PHP_IC_ENTRY;",
          "753:    break;",
          "757:   BG(serialize_lock)++;",
          "758:   ce = zend_lookup_class(class_name);",
          "759:   if (ce) {",
          "760:    BG(serialize_lock)--;",
          "761:    if (EG(exception)) {",
          "762:     zend_string_release(class_name);",
          "763:     return 0;",
          "764:    }",
          "765:    break;",
          "766:   }",
          "767:   BG(serialize_lock)--;",
          "769:   if (EG(exception)) {",
          "770:    zend_string_release(class_name);",
          "771:    return 0;",
          "772:   }",
          "775:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "776:    incomplete_class = 1;",
          "777:    ce = PHP_IC_ENTRY;",
          "778:    break;",
          "779:   }",
          "782:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "784:   ZVAL_STR_COPY(&args[0], class_name);",
          "785:   BG(serialize_lock)++;",
          "786:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "787:    BG(serialize_lock)--;",
          "788:    if (EG(exception)) {",
          "789:     zend_string_release(class_name);",
          "790:     zval_ptr_dtor(&user_func);",
          "791:     zval_ptr_dtor(&args[0]);",
          "792:     return 0;",
          "793:    }",
          "794:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "795:    incomplete_class = 1;",
          "796:    ce = PHP_IC_ENTRY;",
          "797:    zval_ptr_dtor(&user_func);",
          "798:    zval_ptr_dtor(&args[0]);",
          "799:    break;",
          "800:   }",
          "801:   BG(serialize_lock)--;",
          "802:   zval_ptr_dtor(&retval);",
          "803:   if (EG(exception)) {",
          "804:    zend_string_release(class_name);",
          "805:    zval_ptr_dtor(&user_func);",
          "806:    zval_ptr_dtor(&args[0]);",
          "807:    return 0;",
          "808:   }",
          "811:   BG(serialize_lock)++;",
          "812:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "813:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "814:    incomplete_class = 1;",
          "815:    ce = PHP_IC_ENTRY;",
          "816:   }",
          "817:   BG(serialize_lock)--;",
          "819:   zval_ptr_dtor(&user_func);",
          "820:   zval_ptr_dtor(&args[0]);",
          "821:   break;",
          "822:  } while (1);",
          "826:  if (custom_object) {",
          "827:   int ret;",
          "829:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "831:   if (ret && incomplete_class) {",
          "832:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "834:   zend_string_release(class_name);",
          "835:   return ret;",
          "838:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "840:  if (elements < 0) {",
          "841:     efree(class_name);",
          "842:     return 0;",
          "845:  if (incomplete_class) {",
          "846:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "848:  zend_string_release(class_name);",
          "850:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "851: }",
          "852: #line 853 \"ext/standard/var_unserializer.c\"",
          "853: yy25:",
          "856:   if (yych != '+') goto yy18;",
          "858:   if (yych <= '-') goto yy26;",
          "860:   if (yych <= '9') goto yy27;",
          "863: yy26:",
          "866:  if (yych >= ':') goto yy18;",
          "867: yy27:",
          "872:  if (yych <= '9') goto yy27;",
          "873:  if (yych >= ';') goto yy18;",
          "875:  if (yych != '\"') goto yy18;",
          "877: #line 767 \"ext/standard/var_unserializer.re\"",
          "878:  {",
          "879:  long elements;",
          "880:     if (!var_hash) return 0;",
          "882:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "883:  if (elements < 0) {",
          "884:   return 0;",
          "885:  }",
          "886:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "887: }",
          "888: #line 889 \"ext/standard/var_unserializer.c\"",
          "889: yy32:",
          "890:  yych = *++YYCURSOR;",
          "891:  if (yych == '+') goto yy33;",
          "895: yy33:",
          "899: yy34:",
          "904:  if (yych <= '9') goto yy34;",
          "905:  if (yych >= ';') goto yy18;",
          "907:  if (yych != '{') goto yy18;",
          "909: #line 743 \"ext/standard/var_unserializer.re\"",
          "910:  {",
          "911:  zend_long elements = parse_iv(start + 2);",
          "914:     if (!var_hash) return 0;",
          "916:  if (elements < 0) {",
          "917:   return 0;",
          "920:  array_init_size(rval, elements);",
          "921:  if (elements) {",
          "924:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "927:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "928:   return 0;",
          "929:  }",
          "931:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "932: }",
          "933: #line 934 \"ext/standard/var_unserializer.c\"",
          "934: yy39:",
          "936:  if (yych == '+') goto yy40;",
          "938:  if (yych <= '9') goto yy41;",
          "940: yy40:",
          "944: yy41:",
          "949:  if (yych <= '9') goto yy41;",
          "950:  if (yych >= ';') goto yy18;",
          "952:  if (yych != '\"') goto yy18;",
          "954: #line 709 \"ext/standard/var_unserializer.re\"",
          "955:  {",
          "956:  size_t len, maxlen;",
          "957:  zend_string *str;",
          "959:  len = parse_uiv(start + 2);",
          "960:  maxlen = max - YYCURSOR;",
          "961:  if (maxlen < len) {",
          "963:   return 0;",
          "964:  }",
          "966:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "967:   return 0;",
          "968:  }",
          "970:  if (*(YYCURSOR) != '\"') {",
          "971:   zend_string_free(str);",
          "973:   return 0;",
          "974:  }",
          "976:  if (*(YYCURSOR + 1) != ';') {",
          "977:   efree(str);",
          "979:   return 0;",
          "980:  }",
          "982:  YYCURSOR += 2;",
          "985:  ZVAL_STR(rval, str);",
          "986:  return 1;",
          "987: }",
          "988: #line 989 \"ext/standard/var_unserializer.c\"",
          "989: yy46:",
          "990:  yych = *++YYCURSOR;",
          "991:  if (yych == '+') goto yy47;",
          "993:  if (yych <= '9') goto yy48;",
          "995: yy47:",
          "999: yy48:",
          "1004:  if (yych <= '9') goto yy48;",
          "1005:  if (yych >= ';') goto yy18;",
          "1007:  if (yych != '\"') goto yy18;",
          "1009: #line 677 \"ext/standard/var_unserializer.re\"",
          "1011:  size_t len, maxlen;",
          "1012:  char *str;",
          "1014:  len = parse_uiv(start + 2);",
          "1015:  maxlen = max - YYCURSOR;",
          "1016:  if (maxlen < len) {",
          "1021:  str = (char*)YYCURSOR;",
          "1023:  YYCURSOR += len;",
          "1025:  if (*(YYCURSOR) != '\"') {",
          "1027:   return 0;",
          "1030:  if (*(YYCURSOR + 1) != ';') {",
          "1032:   return 0;",
          "1035:  YYCURSOR += 2;",
          "1038:  ZVAL_STRINGL(rval, str, len);",
          "1041: #line 1042 \"ext/standard/var_unserializer.c\"",
          "1042: yy53:",
          "1043:  yych = *++YYCURSOR;",
          "1044:  if (yych <= '/') {",
          "1045:   if (yych <= ',') {",
          "1046:    if (yych == '+') goto yy57;",
          "1047:    goto yy18;",
          "1048:   } else {",
          "1049:    if (yych <= '-') goto yy55;",
          "1050:    if (yych <= '.') goto yy60;",
          "1051:    goto yy18;",
          "1052:   }",
          "1053:  } else {",
          "1054:   if (yych <= 'I') {",
          "1055:    if (yych <= '9') goto yy58;",
          "1056:    if (yych <= 'H') goto yy18;",
          "1057:    goto yy56;",
          "1058:   } else {",
          "1059:    if (yych != 'N') goto yy18;",
          "1060:   }",
          "1061:  }",
          "1063:  if (yych == 'A') goto yy76;",
          "1065: yy55:",
          "1066:  yych = *++YYCURSOR;",
          "1067:  if (yych <= '/') {",
          "1068:   if (yych == '.') goto yy60;",
          "1069:   goto yy18;",
          "1070:  } else {",
          "1071:   if (yych <= '9') goto yy58;",
          "1072:   if (yych != 'I') goto yy18;",
          "1073:  }",
          "1074: yy56:",
          "1076:  if (yych == 'N') goto yy72;",
          "1078: yy57:",
          "1079:  yych = *++YYCURSOR;",
          "1080:  if (yych == '.') goto yy60;",
          "1081:  if (yych <= '/') goto yy18;",
          "1082:  if (yych >= ':') goto yy18;",
          "1083: yy58:",
          "1085:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1086:  yych = *YYCURSOR;",
          "1087:  if (yych <= ':') {",
          "1088:   if (yych <= '.') {",
          "1089:    if (yych <= '-') goto yy18;",
          "1090:    goto yy70;",
          "1091:   } else {",
          "1092:    if (yych <= '/') goto yy18;",
          "1093:    if (yych <= '9') goto yy58;",
          "1094:    goto yy18;",
          "1095:   }",
          "1096:  } else {",
          "1097:   if (yych <= 'E') {",
          "1098:    if (yych <= ';') goto yy63;",
          "1099:    if (yych <= 'D') goto yy18;",
          "1100:    goto yy65;",
          "1101:   } else {",
          "1102:    if (yych == 'e') goto yy65;",
          "1103:    goto yy18;",
          "1104:   }",
          "1105:  }",
          "1106: yy60:",
          "1107:  yych = *++YYCURSOR;",
          "1108:  if (yych <= '/') goto yy18;",
          "1109:  if (yych >= ':') goto yy18;",
          "1110: yy61:",
          "1116:   if (yych <= '9') goto yy61;",
          "1121:    goto yy65;",
          "1123:    if (yych == 'e') goto yy65;",
          "1127: yy63:",
          "1129: #line 668 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1003:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1004:  return 1;",
          "1005: }",
          "1008:  yych = *++YYCURSOR;",
          "1009:  if (yych <= ',') {",
          "1012:  } else {",
          "1014:   if (yych <= '/') goto yy18;",
          "1016:   goto yy18;",
          "1017:  }",
          "1019:  yych = *++YYCURSOR;",
          "1021:  goto yy18;",
          "1023:  yych = *++YYCURSOR;",
          "1025:  goto yy18;",
          "1027:  ++YYCURSOR;",
          "1045:   } else {",
          "1047:   }",
          "1048:  }",
          "1056:  yych = *++YYCURSOR;",
          "1060:  ++YYCURSOR;",
          "1062:  {",
          "1080:  }",
          "1084:  return 1;",
          "1085: }",
          "1088:  yych = *++YYCURSOR;",
          "1090:  goto yy18;",
          "1092:  ++YYCURSOR;",
          "1094:  {",
          "1138:  }",
          "1186:    }",
          "1226:   }",
          "1229:  }",
          "1239: }",
          "1242:  ++YYCURSOR;",
          "1244:  {",
          "1275:  return 1;",
          "1276: }",
          "1279:  ++YYCURSOR;",
          "1281:  {",
          "1303: }",
          "1306:  yych = *++YYCURSOR;",
          "1307:  if (yych <= ',') {",
          "1310:  } else {",
          "1312:   if (yych <= '/') goto yy18;",
          "1314:  }",
          "1316:  ++YYCURSOR;",
          "1317:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1318:  yych = *YYCURSOR;",
          "1319:  if (yych <= '/') goto yy18;",
          "1328:  ++YYCURSOR;",
          "1330:  {",
          "1348:   return 0;",
          "1349:  }",
          "1357:   return 0;",
          "1358:  }",
          "1363:  }",
          "1369:  return 1;",
          "1370: }",
          "1372: yy96:",
          "1373:  yych = *++YYCURSOR;",
          "1374:  if (yych <= '/') goto yy18;",
          "1377: yy97:",
          "1378:  ++YYCURSOR;",
          "1380:  {",
          "1389:  } else {",
          "1391:  }",
          "1393:  return 1;",
          "1394: }",
          "1396: }",
          "1400:  return 0;",
          "",
          "[Removed Lines]",
          "1006: #line 1007 \"ext/standard/var_unserializer.c\"",
          "1007: yy73:",
          "1010:   if (yych == '+') goto yy88;",
          "1011:   goto yy18;",
          "1013:   if (yych <= '-') goto yy88;",
          "1015:   if (yych <= '9') goto yy89;",
          "1018: yy74:",
          "1020:  if (yych == 'F') goto yy91;",
          "1022: yy75:",
          "1024:  if (yych == 'N') goto yy91;",
          "1026: yy76:",
          "1028: #line 621 \"ext/standard/var_unserializer.re\"",
          "1029:  {",
          "1030: #if SIZEOF_ZEND_LONG == 4",
          "1031:  int digits = YYCURSOR - start - 3;",
          "1033:  if (start[2] == '-' || start[2] == '+') {",
          "1034:   digits--;",
          "1035:  }",
          "1038:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1039:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1040:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1042:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1043:     goto use_double;",
          "1044:    }",
          "1046:    goto use_double;",
          "1049: #endif",
          "1051:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1052:  return 1;",
          "1053: }",
          "1054: #line 1055 \"ext/standard/var_unserializer.c\"",
          "1055: yy78:",
          "1057:  if (yych == '\"') goto yy92;",
          "1058:  goto yy18;",
          "1059: yy79:",
          "1061: #line 584 \"ext/standard/var_unserializer.re\"",
          "1063:  zend_long id;",
          "1066:  if (!var_hash) return 0;",
          "1068:  id = parse_iv(start + 2) - 1;",
          "1069:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1070:   return 0;",
          "1071:  }",
          "1073:  if (rval_ref == rval) {",
          "1074:   return 0;",
          "1075:  }",
          "1077:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1078:   ZVAL_UNDEF(rval);",
          "1079:   return 1;",
          "1082:  ZVAL_COPY(rval, rval_ref);",
          "1086: #line 1087 \"ext/standard/var_unserializer.c\"",
          "1087: yy81:",
          "1089:  if (yych == '\"') goto yy94;",
          "1091: yy82:",
          "1093: #line 769 \"ext/standard/var_unserializer.re\"",
          "1095:  size_t len, len2, len3, maxlen;",
          "1096:  zend_long elements;",
          "1097:  char *str;",
          "1098:  zend_string *class_name;",
          "1099:  zend_class_entry *ce;",
          "1100:  int incomplete_class = 0;",
          "1102:  int custom_object = 0;",
          "1104:  zval user_func;",
          "1105:  zval retval;",
          "1106:  zval args[1];",
          "1108:     if (!var_hash) return 0;",
          "1109:  if (*start == 'C') {",
          "1110:   custom_object = 1;",
          "1111:  }",
          "1113:  len2 = len = parse_uiv(start + 2);",
          "1114:  maxlen = max - YYCURSOR;",
          "1115:  if (maxlen < len || len == 0) {",
          "1117:   return 0;",
          "1118:  }",
          "1120:  str = (char*)YYCURSOR;",
          "1122:  YYCURSOR += len;",
          "1124:  if (*(YYCURSOR) != '\"') {",
          "1126:   return 0;",
          "1127:  }",
          "1128:  if (*(YYCURSOR+1) != ':') {",
          "1130:   return 0;",
          "1131:  }",
          "1133:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1134:  if (len3 != len)",
          "1135:  {",
          "1137:   return 0;",
          "1140:  class_name = zend_string_init(str, len, 0);",
          "1142:  do {",
          "1143:   if(!unserialize_allowed_class(class_name, classes)) {",
          "1144:    incomplete_class = 1;",
          "1145:    ce = PHP_IC_ENTRY;",
          "1146:    break;",
          "1147:   }",
          "1150:   BG(serialize_lock)++;",
          "1151:   ce = zend_lookup_class(class_name);",
          "1152:   if (ce) {",
          "1153:    BG(serialize_lock)--;",
          "1154:    if (EG(exception)) {",
          "1155:     zend_string_release(class_name);",
          "1156:     return 0;",
          "1157:    }",
          "1158:    break;",
          "1159:   }",
          "1160:   BG(serialize_lock)--;",
          "1162:   if (EG(exception)) {",
          "1163:    zend_string_release(class_name);",
          "1164:    return 0;",
          "1165:   }",
          "1168:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1169:    incomplete_class = 1;",
          "1170:    ce = PHP_IC_ENTRY;",
          "1171:    break;",
          "1172:   }",
          "1175:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1177:   ZVAL_STR_COPY(&args[0], class_name);",
          "1178:   BG(serialize_lock)++;",
          "1179:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1180:    BG(serialize_lock)--;",
          "1181:    if (EG(exception)) {",
          "1182:     zend_string_release(class_name);",
          "1183:     zval_ptr_dtor(&user_func);",
          "1184:     zval_ptr_dtor(&args[0]);",
          "1185:     return 0;",
          "1187:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1188:    incomplete_class = 1;",
          "1189:    ce = PHP_IC_ENTRY;",
          "1190:    zval_ptr_dtor(&user_func);",
          "1191:    zval_ptr_dtor(&args[0]);",
          "1192:    break;",
          "1193:   }",
          "1194:   BG(serialize_lock)--;",
          "1195:   zval_ptr_dtor(&retval);",
          "1196:   if (EG(exception)) {",
          "1197:    zend_string_release(class_name);",
          "1198:    zval_ptr_dtor(&user_func);",
          "1199:    zval_ptr_dtor(&args[0]);",
          "1200:    return 0;",
          "1201:   }",
          "1204:   BG(serialize_lock)++;",
          "1205:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1206:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1207:    incomplete_class = 1;",
          "1208:    ce = PHP_IC_ENTRY;",
          "1209:   }",
          "1210:   BG(serialize_lock)--;",
          "1212:   zval_ptr_dtor(&user_func);",
          "1213:   zval_ptr_dtor(&args[0]);",
          "1214:   break;",
          "1215:  } while (1);",
          "1219:  if (custom_object) {",
          "1220:   int ret;",
          "1222:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1224:   if (ret && incomplete_class) {",
          "1225:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1227:   zend_string_release(class_name);",
          "1228:   return ret;",
          "1231:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1233:  if (incomplete_class) {",
          "1234:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1235:  }",
          "1236:  zend_string_release(class_name);",
          "1238:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1240: #line 1241 \"ext/standard/var_unserializer.c\"",
          "1241: yy84:",
          "1243: #line 704 \"ext/standard/var_unserializer.re\"",
          "1245:  size_t len, maxlen;",
          "1246:  zend_string *str;",
          "1248:  len = parse_uiv(start + 2);",
          "1249:  maxlen = max - YYCURSOR;",
          "1250:  if (maxlen < len) {",
          "1252:   return 0;",
          "1253:  }",
          "1255:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1256:   return 0;",
          "1257:  }",
          "1259:  if (*(YYCURSOR) != '\"') {",
          "1260:   zend_string_free(str);",
          "1262:   return 0;",
          "1263:  }",
          "1265:  if (*(YYCURSOR + 1) != ';') {",
          "1266:   efree(str);",
          "1268:   return 0;",
          "1269:  }",
          "1271:  YYCURSOR += 2;",
          "1274:  ZVAL_STR(rval, str);",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "1278: yy86:",
          "1280: #line 738 \"ext/standard/var_unserializer.re\"",
          "1282:  zend_long elements = parse_iv(start + 2);",
          "1285:     if (!var_hash) return 0;",
          "1287:  if (elements < 0) {",
          "1288:   return 0;",
          "1289:  }",
          "1291:  array_init_size(rval, elements);",
          "1292:  if (elements) {",
          "1295:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1296:  }",
          "1298:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1299:   return 0;",
          "1300:  }",
          "1302:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1304: #line 1305 \"ext/standard/var_unserializer.c\"",
          "1305: yy88:",
          "1308:   if (yych == '+') goto yy96;",
          "1309:   goto yy18;",
          "1311:   if (yych <= '-') goto yy96;",
          "1313:   if (yych >= ':') goto yy18;",
          "1315: yy89:",
          "1320:  if (yych <= '9') goto yy89;",
          "1321:  if (yych == ';') goto yy71;",
          "1322:  goto yy18;",
          "1323: yy91:",
          "1324:  yych = *++YYCURSOR;",
          "1325:  if (yych == ';') goto yy97;",
          "1326:  goto yy18;",
          "1327: yy92:",
          "1329: #line 762 \"ext/standard/var_unserializer.re\"",
          "1331:     if (!var_hash) return 0;",
          "1333:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "1334:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "1335: }",
          "1336: #line 1337 \"ext/standard/var_unserializer.c\"",
          "1337: yy94:",
          "1338:  ++YYCURSOR;",
          "1339: #line 672 \"ext/standard/var_unserializer.re\"",
          "1340:  {",
          "1341:  size_t len, maxlen;",
          "1342:  char *str;",
          "1344:  len = parse_uiv(start + 2);",
          "1345:  maxlen = max - YYCURSOR;",
          "1346:  if (maxlen < len) {",
          "1351:  str = (char*)YYCURSOR;",
          "1353:  YYCURSOR += len;",
          "1355:  if (*(YYCURSOR) != '\"') {",
          "1360:  if (*(YYCURSOR + 1) != ';') {",
          "1362:   return 0;",
          "1365:  YYCURSOR += 2;",
          "1368:  ZVAL_STRINGL(rval, str, len);",
          "1371: #line 1372 \"ext/standard/var_unserializer.c\"",
          "1375:  if (yych <= '9') goto yy89;",
          "1376:  goto yy18;",
          "1379: #line 647 \"ext/standard/var_unserializer.re\"",
          "1383:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1384:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1385:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1386:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1387:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1388:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1390:   ZVAL_NULL(rval);",
          "1395: #line 1396 \"ext/standard/var_unserializer.c\"",
          "1397: #line 924 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1138: #line 1139 \"ext/standard/var_unserializer.c\"",
          "1139: yy65:",
          "1142:   if (yych != '+') goto yy18;",
          "1144:   if (yych <= '-') goto yy66;",
          "1146:   if (yych <= '9') goto yy67;",
          "1149: yy66:",
          "1151:  if (yych <= ',') {",
          "1152:   if (yych == '+') goto yy69;",
          "1153:   goto yy18;",
          "1154:  } else {",
          "1155:   if (yych <= '-') goto yy69;",
          "1156:   if (yych <= '/') goto yy18;",
          "1157:   if (yych >= ':') goto yy18;",
          "1158:  }",
          "1159: yy67:",
          "1160:  ++YYCURSOR;",
          "1161:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1162:  yych = *YYCURSOR;",
          "1163:  if (yych <= '/') goto yy18;",
          "1164:  if (yych <= '9') goto yy67;",
          "1165:  if (yych == ';') goto yy63;",
          "1167: yy69:",
          "1169:  if (yych <= '/') goto yy18;",
          "1170:  if (yych <= '9') goto yy67;",
          "1172: yy70:",
          "1174:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1175:  yych = *YYCURSOR;",
          "1176:  if (yych <= ';') {",
          "1177:   if (yych <= '/') goto yy18;",
          "1178:   if (yych <= '9') goto yy70;",
          "1179:   if (yych <= ':') goto yy18;",
          "1180:   goto yy63;",
          "1181:  } else {",
          "1182:   if (yych <= 'E') {",
          "1183:    if (yych <= 'D') goto yy18;",
          "1184:    goto yy65;",
          "1186:    if (yych == 'e') goto yy65;",
          "1187:    goto yy18;",
          "1190: yy72:",
          "1192:  if (yych != 'F') goto yy18;",
          "1193: yy73:",
          "1194:  yych = *++YYCURSOR;",
          "1195:  if (yych != ';') goto yy18;",
          "1197: #line 652 \"ext/standard/var_unserializer.re\"",
          "1201:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1202:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1203:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1204:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1205:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1206:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1207:  } else {",
          "1208:   ZVAL_NULL(rval);",
          "1213: #line 1214 \"ext/standard/var_unserializer.c\"",
          "1214: yy76:",
          "1216:  if (yych == 'N') goto yy73;",
          "1218: yy77:",
          "1219:  yych = *++YYCURSOR;",
          "1220:  if (yych <= ',') {",
          "1221:   if (yych != '+') goto yy18;",
          "1222:  } else {",
          "1223:   if (yych <= '-') goto yy78;",
          "1224:   if (yych <= '/') goto yy18;",
          "1225:   if (yych <= '9') goto yy79;",
          "1226:   goto yy18;",
          "1227:  }",
          "1228: yy78:",
          "1229:  yych = *++YYCURSOR;",
          "1230:  if (yych <= '/') goto yy18;",
          "1231:  if (yych >= ':') goto yy18;",
          "1232: yy79:",
          "1234:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1235:  yych = *YYCURSOR;",
          "1236:  if (yych <= '/') goto yy18;",
          "1237:  if (yych <= '9') goto yy79;",
          "1238:  if (yych != ';') goto yy18;",
          "1239:  ++YYCURSOR;",
          "1240: #line 626 \"ext/standard/var_unserializer.re\"",
          "1242: #if SIZEOF_ZEND_LONG == 4",
          "1243:  int digits = YYCURSOR - start - 3;",
          "1245:  if (start[2] == '-' || start[2] == '+') {",
          "1246:   digits--;",
          "1250:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1251:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1252:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1254:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1255:     goto use_double;",
          "1257:   } else {",
          "1258:    goto use_double;",
          "1261: #endif",
          "1263:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1264:  return 1;",
          "1266: #line 1267 \"ext/standard/var_unserializer.c\"",
          "1267: yy83:",
          "1268:  yych = *++YYCURSOR;",
          "1269:  if (yych <= '/') goto yy18;",
          "1270:  if (yych >= '2') goto yy18;",
          "1271:  yych = *++YYCURSOR;",
          "1272:  if (yych != ';') goto yy18;",
          "1274: #line 620 \"ext/standard/var_unserializer.re\"",
          "1277:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1280: #line 1281 \"ext/standard/var_unserializer.c\"",
          "1281: yy87:",
          "1283: #line 614 \"ext/standard/var_unserializer.re\"",
          "1286:  ZVAL_NULL(rval);",
          "1287:  return 1;",
          "1289: #line 1290 \"ext/standard/var_unserializer.c\"",
          "1290: yy89:",
          "1293:   if (yych != '+') goto yy18;",
          "1295:   if (yych <= '-') goto yy90;",
          "1297:   if (yych <= '9') goto yy91;",
          "1298:   goto yy18;",
          "1300: yy90:",
          "1301:  yych = *++YYCURSOR;",
          "1302:  if (yych <= '/') goto yy18;",
          "1303:  if (yych >= ':') goto yy18;",
          "1304: yy91:",
          "1309:  if (yych <= '9') goto yy91;",
          "1310:  if (yych != ';') goto yy18;",
          "1312: #line 589 \"ext/standard/var_unserializer.re\"",
          "1314:  zend_long id;",
          "1317:  if (!var_hash) return 0;",
          "1319:  id = parse_iv(start + 2) - 1;",
          "1320:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1324:  if (rval_ref == rval) {",
          "1328:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1329:   ZVAL_UNDEF(rval);",
          "1330:   return 1;",
          "1333:  ZVAL_COPY(rval, rval_ref);",
          "1337: #line 1338 \"ext/standard/var_unserializer.c\"",
          "1338: yy95:",
          "1339:  yych = *++YYCURSOR;",
          "1340:  if (yych <= ',') {",
          "1341:   if (yych != '+') goto yy18;",
          "1342:  } else {",
          "1343:   if (yych <= '-') goto yy96;",
          "1344:   if (yych <= '/') goto yy18;",
          "1345:   if (yych <= '9') goto yy97;",
          "1346:   goto yy18;",
          "1347:  }",
          "1351:  if (yych >= ':') goto yy18;",
          "1354:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1355:  yych = *YYCURSOR;",
          "1356:  if (yych <= '/') goto yy18;",
          "1357:  if (yych <= '9') goto yy97;",
          "1358:  if (yych != ';') goto yy18;",
          "1359:  ++YYCURSOR;",
          "1360: #line 563 \"ext/standard/var_unserializer.re\"",
          "1362:  zend_long id;",
          "1365:  if (!var_hash) return 0;",
          "1367:  id = parse_iv(start + 2) - 1;",
          "1368:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1369:   return 0;",
          "1370:  }",
          "1372:  zval_ptr_dtor(rval);",
          "1373:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1374:   ZVAL_UNDEF(rval);",
          "1375:   return 1;",
          "1376:  }",
          "1377:  if (Z_ISREF_P(rval_ref)) {",
          "1378:   ZVAL_COPY(rval, rval_ref);",
          "1380:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1381:   ZVAL_COPY(rval, rval_ref);",
          "1386: #line 1387 \"ext/standard/var_unserializer.c\"",
          "1388: #line 938 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "437: {",
          "438:  zend_long elements;",
          "440:  elements = parse_iv2((*p) + 2, p);",
          "442:  (*p) += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "440:  if( *p >= max - 2) {",
          "441:   zend_error(E_WARNING, \"Bad unserialize data\");",
          "442:   return -1;",
          "443:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "446:  } else {",
          "451:  }",
          "453:  return elements;",
          "",
          "[Removed Lines]",
          "449:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ZSTR_VAL(ce->name));",
          "450:   return 0;",
          "",
          "[Added Lines]",
          "454:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
          "455:   return -1;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "760: }",
          "762: \"o:\" iv \":\" [\"] {",
          "763:     if (!var_hash) return 0;",
          "767: }",
          "769: object \":\" uiv \":\" [\"] {",
          "",
          "[Removed Lines]",
          "765:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "766:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "",
          "[Added Lines]",
          "768:  long elements;",
          "771:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "772:  if (elements < 0) {",
          "773:   return 0;",
          "774:  }",
          "775:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "906:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "908:  if (incomplete_class) {",
          "909:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "910:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "917:  if (elements < 0) {",
          "918:     efree(class_name);",
          "919:     return 0;",
          "920:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9da6f6a3741eccc4904998918ce7972d57f4f04b",
      "candidate_info": {
        "commit_hash": "9da6f6a3741eccc4904998918ce7972d57f4f04b",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/9da6f6a3741eccc4904998918ce7972d57f4f04b",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "- Make valgrind happy with session_decode_error2.phpt",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "388:   zend_hash_exists(&Z_OBJCE_PP(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\"))) {",
          "389:   INIT_PZVAL(&fname);",
          "390:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1, 0);",
          "391:   call_user_function_ex(CG(function_table), rval, &fname, &retval_ptr, 0, 0, 1, NULL TSRMLS_CC);",
          "392:  }",
          "394:  if (retval_ptr)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "391:   BG(serialize_lock)++;",
          "393:   BG(serialize_lock)--;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "403:  const unsigned char *cursor, *limit, *marker, *start;",
          "404:  zval **rval_ref;",
          "408:  if (var_hash && cursor[0] != 'R') {",
          "409:   var_push(var_hash, rval);",
          "",
          "[Removed Lines]",
          "406:  limit = cursor = *p;",
          "",
          "[Added Lines]",
          "408:  limit = max;",
          "409:  cursor = *p;",
          "411:  if (YYCURSOR >= YYLIMIT) {",
          "412:   return 0;",
          "413:  }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "418: {",
          "419:  YYCTYPE yych;",
          "421:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "422:  yych = *YYCURSOR;",
          "",
          "[Removed Lines]",
          "417: #line 418 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "424: #line 425 \"ext/standard/var_unserializer.c\"",
          "427:  static const unsigned char yybm[] = {",
          "428:     0,   0,   0,   0,   0,   0,   0,   0,",
          "429:     0,   0,   0,   0,   0,   0,   0,   0,",
          "430:     0,   0,   0,   0,   0,   0,   0,   0,",
          "431:     0,   0,   0,   0,   0,   0,   0,   0,",
          "432:     0,   0,   0,   0,   0,   0,   0,   0,",
          "433:     0,   0,   0,   0,   0,   0,   0,   0,",
          "434:   128, 128, 128, 128, 128, 128, 128, 128,",
          "435:   128, 128,   0,   0,   0,   0,   0,   0,",
          "436:     0,   0,   0,   0,   0,   0,   0,   0,",
          "437:     0,   0,   0,   0,   0,   0,   0,   0,",
          "438:     0,   0,   0,   0,   0,   0,   0,   0,",
          "439:     0,   0,   0,   0,   0,   0,   0,   0,",
          "440:     0,   0,   0,   0,   0,   0,   0,   0,",
          "441:     0,   0,   0,   0,   0,   0,   0,   0,",
          "442:     0,   0,   0,   0,   0,   0,   0,   0,",
          "443:     0,   0,   0,   0,   0,   0,   0,   0,",
          "444:     0,   0,   0,   0,   0,   0,   0,   0,",
          "445:     0,   0,   0,   0,   0,   0,   0,   0,",
          "446:     0,   0,   0,   0,   0,   0,   0,   0,",
          "447:     0,   0,   0,   0,   0,   0,   0,   0,",
          "448:     0,   0,   0,   0,   0,   0,   0,   0,",
          "449:     0,   0,   0,   0,   0,   0,   0,   0,",
          "450:     0,   0,   0,   0,   0,   0,   0,   0,",
          "451:     0,   0,   0,   0,   0,   0,   0,   0,",
          "452:     0,   0,   0,   0,   0,   0,   0,   0,",
          "453:     0,   0,   0,   0,   0,   0,   0,   0,",
          "454:     0,   0,   0,   0,   0,   0,   0,   0,",
          "455:     0,   0,   0,   0,   0,   0,   0,   0,",
          "456:     0,   0,   0,   0,   0,   0,   0,   0,",
          "457:     0,   0,   0,   0,   0,   0,   0,   0,",
          "458:     0,   0,   0,   0,   0,   0,   0,   0,",
          "459:     0,   0,   0,   0,   0,   0,   0,   0,",
          "460:  };",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "438:  }",
          "439: yy2:",
          "440:  yych = *(YYMARKER = ++YYCURSOR);",
          "445: yy3:",
          "447:  { return 0; }",
          "449: yy4:",
          "450:  yych = *(YYMARKER = ++YYCURSOR);",
          "455: yy5:",
          "456:  yych = *++YYCURSOR;",
          "461: yy6:",
          "462:  yych = *(YYMARKER = ++YYCURSOR);",
          "467: yy7:",
          "468:  yych = *(YYMARKER = ++YYCURSOR);",
          "473: yy8:",
          "474:  yych = *(YYMARKER = ++YYCURSOR);",
          "479: yy9:",
          "480:  yych = *(YYMARKER = ++YYCURSOR);",
          "485: yy10:",
          "486:  yych = *(YYMARKER = ++YYCURSOR);",
          "491: yy11:",
          "492:  yych = *(YYMARKER = ++YYCURSOR);",
          "497: yy12:",
          "498:  yych = *(YYMARKER = ++YYCURSOR);",
          "503: yy13:",
          "504:  yych = *(YYMARKER = ++YYCURSOR);",
          "509: yy14:",
          "510:  ++YYCURSOR;",
          "512:  {",
          "514:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "516: }",
          "518: yy16:",
          "519:  yych = *++YYCURSOR;",
          "520:  goto yy3;",
          "521: yy17:",
          "522:  yych = *++YYCURSOR;",
          "536:  }",
          "537: yy18:",
          "538:  YYCURSOR = YYMARKER;",
          "539:  goto yy3;",
          "540: yy19:",
          "541:  yych = *++YYCURSOR;",
          "554:  }",
          "555: yy20:",
          "556:  ++YYCURSOR;",
          "557:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "558:  yych = *YYCURSOR;",
          "572:  }",
          "574:  yych = *++YYCURSOR;",
          "580:  ++YYCURSOR;",
          "582:  {",
          "583:  size_t len, len2, len3, maxlen;",
          "584:  long elements;",
          "",
          "[Removed Lines]",
          "441:  switch (yych) {",
          "442:  case ':': goto yy95;",
          "443:  default: goto yy3;",
          "444:  }",
          "446: #line 740 \"ext/standard/var_unserializer.re\"",
          "448: #line 449 \"ext/standard/var_unserializer.c\"",
          "451:  switch (yych) {",
          "452:  case ':': goto yy89;",
          "453:  default: goto yy3;",
          "454:  }",
          "457:  switch (yych) {",
          "458:  case ';': goto yy87;",
          "459:  default: goto yy3;",
          "460:  }",
          "463:  switch (yych) {",
          "464:  case ':': goto yy83;",
          "465:  default: goto yy3;",
          "466:  }",
          "469:  switch (yych) {",
          "470:  case ':': goto yy77;",
          "471:  default: goto yy3;",
          "472:  }",
          "475:  switch (yych) {",
          "476:  case ':': goto yy53;",
          "477:  default: goto yy3;",
          "478:  }",
          "481:  switch (yych) {",
          "482:  case ':': goto yy46;",
          "483:  default: goto yy3;",
          "484:  }",
          "487:  switch (yych) {",
          "488:  case ':': goto yy39;",
          "489:  default: goto yy3;",
          "490:  }",
          "493:  switch (yych) {",
          "494:  case ':': goto yy32;",
          "495:  default: goto yy3;",
          "496:  }",
          "499:  switch (yych) {",
          "500:  case ':': goto yy25;",
          "501:  default: goto yy3;",
          "502:  }",
          "505:  switch (yych) {",
          "506:  case ':': goto yy17;",
          "507:  default: goto yy3;",
          "508:  }",
          "511: #line 734 \"ext/standard/var_unserializer.re\"",
          "517: #line 518 \"ext/standard/var_unserializer.c\"",
          "523:  switch (yych) {",
          "524:  case '+': goto yy19;",
          "525:  case '0':",
          "526:  case '1':",
          "527:  case '2':",
          "528:  case '3':",
          "529:  case '4':",
          "530:  case '5':",
          "531:  case '6':",
          "532:  case '7':",
          "533:  case '8':",
          "534:  case '9': goto yy20;",
          "535:  default: goto yy18;",
          "542:  switch (yych) {",
          "543:  case '0':",
          "544:  case '1':",
          "545:  case '2':",
          "546:  case '3':",
          "547:  case '4':",
          "548:  case '5':",
          "549:  case '6':",
          "550:  case '7':",
          "551:  case '8':",
          "552:  case '9': goto yy20;",
          "553:  default: goto yy18;",
          "559:  switch (yych) {",
          "560:  case '0':",
          "561:  case '1':",
          "562:  case '2':",
          "563:  case '3':",
          "564:  case '4':",
          "565:  case '5':",
          "566:  case '6':",
          "567:  case '7':",
          "568:  case '8':",
          "569:  case '9': goto yy20;",
          "570:  case ':': goto yy22;",
          "571:  default: goto yy18;",
          "573: yy22:",
          "575:  switch (yych) {",
          "576:  case '\"': goto yy23;",
          "577:  default: goto yy18;",
          "578:  }",
          "579: yy23:",
          "581: #line 617 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "482:  if (yych == ':') goto yy95;",
          "484: #line 747 \"ext/standard/var_unserializer.re\"",
          "486: #line 487 \"ext/standard/var_unserializer.c\"",
          "489:  if (yych == ':') goto yy89;",
          "490:  goto yy3;",
          "493:  if (yych == ';') goto yy87;",
          "494:  goto yy3;",
          "497:  if (yych == ':') goto yy83;",
          "498:  goto yy3;",
          "501:  if (yych == ':') goto yy77;",
          "502:  goto yy3;",
          "505:  if (yych == ':') goto yy53;",
          "506:  goto yy3;",
          "509:  if (yych == ':') goto yy46;",
          "510:  goto yy3;",
          "513:  if (yych == ':') goto yy39;",
          "514:  goto yy3;",
          "517:  if (yych == ':') goto yy32;",
          "518:  goto yy3;",
          "521:  if (yych == ':') goto yy25;",
          "522:  goto yy3;",
          "525:  if (yych == ':') goto yy17;",
          "526:  goto yy3;",
          "529: #line 741 \"ext/standard/var_unserializer.re\"",
          "535: #line 536 \"ext/standard/var_unserializer.c\"",
          "541:  if (yybm[0+yych] & 128) {",
          "542:   goto yy20;",
          "544:  if (yych == '+') goto yy19;",
          "550:  if (yybm[0+yych] & 128) {",
          "551:   goto yy20;",
          "553:  goto yy18;",
          "558:  if (yybm[0+yych] & 128) {",
          "559:   goto yy20;",
          "561:  if (yych != ':') goto yy18;",
          "563:  if (yych != '\"') goto yy18;",
          "565: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "696:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "697: }",
          "699: yy25:",
          "700:  yych = *++YYCURSOR;",
          "715:  }",
          "716: yy26:",
          "717:  yych = *++YYCURSOR;",
          "731: yy27:",
          "732:  ++YYCURSOR;",
          "733:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "734:  yych = *YYCURSOR;",
          "750:  yych = *++YYCURSOR;",
          "756:  ++YYCURSOR;",
          "758:  {",
          "760:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "698: #line 699 \"ext/standard/var_unserializer.c\"",
          "701:  switch (yych) {",
          "702:  case '+':",
          "703:  case '-': goto yy26;",
          "704:  case '0':",
          "705:  case '1':",
          "706:  case '2':",
          "707:  case '3':",
          "708:  case '4':",
          "709:  case '5':",
          "710:  case '6':",
          "711:  case '7':",
          "712:  case '8':",
          "713:  case '9': goto yy27;",
          "714:  default: goto yy18;",
          "718:  switch (yych) {",
          "719:  case '0':",
          "720:  case '1':",
          "721:  case '2':",
          "722:  case '3':",
          "723:  case '4':",
          "724:  case '5':",
          "725:  case '6':",
          "726:  case '7':",
          "727:  case '8':",
          "728:  case '9': goto yy27;",
          "729:  default: goto yy18;",
          "730:  }",
          "735:  switch (yych) {",
          "736:  case '0':",
          "737:  case '1':",
          "738:  case '2':",
          "739:  case '3':",
          "740:  case '4':",
          "741:  case '5':",
          "742:  case '6':",
          "743:  case '7':",
          "744:  case '8':",
          "745:  case '9': goto yy27;",
          "746:  case ':': goto yy29;",
          "747:  default: goto yy18;",
          "748:  }",
          "749: yy29:",
          "751:  switch (yych) {",
          "752:  case '\"': goto yy30;",
          "753:  default: goto yy18;",
          "754:  }",
          "755: yy30:",
          "757: #line 609 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "682: #line 683 \"ext/standard/var_unserializer.c\"",
          "685:  if (yych <= ',') {",
          "686:   if (yych != '+') goto yy18;",
          "687:  } else {",
          "688:   if (yych <= '-') goto yy26;",
          "689:   if (yych <= '/') goto yy18;",
          "690:   if (yych <= '9') goto yy27;",
          "691:   goto yy18;",
          "695:  if (yych <= '/') goto yy18;",
          "696:  if (yych >= ':') goto yy18;",
          "701:  if (yych <= '/') goto yy18;",
          "702:  if (yych <= '9') goto yy27;",
          "703:  if (yych >= ';') goto yy18;",
          "705:  if (yych != '\"') goto yy18;",
          "707: #line 616 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "762:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "763:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "764: }",
          "766: yy32:",
          "767:  yych = *++YYCURSOR;",
          "782: yy33:",
          "783:  yych = *++YYCURSOR;",
          "797: yy34:",
          "798:  ++YYCURSOR;",
          "799:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "800:  yych = *YYCURSOR;",
          "816:  yych = *++YYCURSOR;",
          "822:  ++YYCURSOR;",
          "824:  {",
          "825:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "765: #line 766 \"ext/standard/var_unserializer.c\"",
          "768:  switch (yych) {",
          "769:  case '+': goto yy33;",
          "770:  case '0':",
          "771:  case '1':",
          "772:  case '2':",
          "773:  case '3':",
          "774:  case '4':",
          "775:  case '5':",
          "776:  case '6':",
          "777:  case '7':",
          "778:  case '8':",
          "779:  case '9': goto yy34;",
          "780:  default: goto yy18;",
          "781:  }",
          "784:  switch (yych) {",
          "785:  case '0':",
          "786:  case '1':",
          "787:  case '2':",
          "788:  case '3':",
          "789:  case '4':",
          "790:  case '5':",
          "791:  case '6':",
          "792:  case '7':",
          "793:  case '8':",
          "794:  case '9': goto yy34;",
          "795:  default: goto yy18;",
          "796:  }",
          "801:  switch (yych) {",
          "802:  case '0':",
          "803:  case '1':",
          "804:  case '2':",
          "805:  case '3':",
          "806:  case '4':",
          "807:  case '5':",
          "808:  case '6':",
          "809:  case '7':",
          "810:  case '8':",
          "811:  case '9': goto yy34;",
          "812:  case ':': goto yy36;",
          "813:  default: goto yy18;",
          "814:  }",
          "815: yy36:",
          "817:  switch (yych) {",
          "818:  case '{': goto yy37;",
          "819:  default: goto yy18;",
          "820:  }",
          "821: yy37:",
          "823: #line 589 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "715: #line 716 \"ext/standard/var_unserializer.c\"",
          "718:  if (yych == '+') goto yy33;",
          "719:  if (yych <= '/') goto yy18;",
          "720:  if (yych <= '9') goto yy34;",
          "721:  goto yy18;",
          "724:  if (yych <= '/') goto yy18;",
          "725:  if (yych >= ':') goto yy18;",
          "730:  if (yych <= '/') goto yy18;",
          "731:  if (yych <= '9') goto yy34;",
          "732:  if (yych >= ';') goto yy18;",
          "734:  if (yych != '{') goto yy18;",
          "736: #line 596 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "841:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "842: }",
          "844: yy39:",
          "845:  yych = *++YYCURSOR;",
          "860: yy40:",
          "861:  yych = *++YYCURSOR;",
          "875: yy41:",
          "876:  ++YYCURSOR;",
          "877:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "878:  yych = *YYCURSOR;",
          "894:  yych = *++YYCURSOR;",
          "900:  ++YYCURSOR;",
          "902:  {",
          "903:  size_t len, maxlen;",
          "904:  char *str;",
          "",
          "[Removed Lines]",
          "843: #line 844 \"ext/standard/var_unserializer.c\"",
          "846:  switch (yych) {",
          "847:  case '+': goto yy40;",
          "848:  case '0':",
          "849:  case '1':",
          "850:  case '2':",
          "851:  case '3':",
          "852:  case '4':",
          "853:  case '5':",
          "854:  case '6':",
          "855:  case '7':",
          "856:  case '8':",
          "857:  case '9': goto yy41;",
          "858:  default: goto yy18;",
          "859:  }",
          "862:  switch (yych) {",
          "863:  case '0':",
          "864:  case '1':",
          "865:  case '2':",
          "866:  case '3':",
          "867:  case '4':",
          "868:  case '5':",
          "869:  case '6':",
          "870:  case '7':",
          "871:  case '8':",
          "872:  case '9': goto yy41;",
          "873:  default: goto yy18;",
          "874:  }",
          "879:  switch (yych) {",
          "880:  case '0':",
          "881:  case '1':",
          "882:  case '2':",
          "883:  case '3':",
          "884:  case '4':",
          "885:  case '5':",
          "886:  case '6':",
          "887:  case '7':",
          "888:  case '8':",
          "889:  case '9': goto yy41;",
          "890:  case ':': goto yy43;",
          "891:  default: goto yy18;",
          "892:  }",
          "893: yy43:",
          "895:  switch (yych) {",
          "896:  case '\"': goto yy44;",
          "897:  default: goto yy18;",
          "898:  }",
          "899: yy44:",
          "901: #line 560 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "756: #line 757 \"ext/standard/var_unserializer.c\"",
          "759:  if (yych == '+') goto yy40;",
          "760:  if (yych <= '/') goto yy18;",
          "761:  if (yych <= '9') goto yy41;",
          "762:  goto yy18;",
          "765:  if (yych <= '/') goto yy18;",
          "766:  if (yych >= ':') goto yy18;",
          "771:  if (yych <= '/') goto yy18;",
          "772:  if (yych <= '9') goto yy41;",
          "773:  if (yych >= ';') goto yy18;",
          "775:  if (yych != '\"') goto yy18;",
          "777: #line 567 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "927:  ZVAL_STRINGL(*rval, str, len, 0);",
          "928:  return 1;",
          "929: }",
          "931: yy46:",
          "932:  yych = *++YYCURSOR;",
          "947: yy47:",
          "948:  yych = *++YYCURSOR;",
          "962: yy48:",
          "963:  ++YYCURSOR;",
          "964:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "965:  yych = *YYCURSOR;",
          "981:  yych = *++YYCURSOR;",
          "987:  ++YYCURSOR;",
          "989:  {",
          "990:  size_t len, maxlen;",
          "991:  char *str;",
          "",
          "[Removed Lines]",
          "930: #line 931 \"ext/standard/var_unserializer.c\"",
          "933:  switch (yych) {",
          "934:  case '+': goto yy47;",
          "935:  case '0':",
          "936:  case '1':",
          "937:  case '2':",
          "938:  case '3':",
          "939:  case '4':",
          "940:  case '5':",
          "941:  case '6':",
          "942:  case '7':",
          "943:  case '8':",
          "944:  case '9': goto yy48;",
          "945:  default: goto yy18;",
          "946:  }",
          "949:  switch (yych) {",
          "950:  case '0':",
          "951:  case '1':",
          "952:  case '2':",
          "953:  case '3':",
          "954:  case '4':",
          "955:  case '5':",
          "956:  case '6':",
          "957:  case '7':",
          "958:  case '8':",
          "959:  case '9': goto yy48;",
          "960:  default: goto yy18;",
          "961:  }",
          "966:  switch (yych) {",
          "967:  case '0':",
          "968:  case '1':",
          "969:  case '2':",
          "970:  case '3':",
          "971:  case '4':",
          "972:  case '5':",
          "973:  case '6':",
          "974:  case '7':",
          "975:  case '8':",
          "976:  case '9': goto yy48;",
          "977:  case ':': goto yy50;",
          "978:  default: goto yy18;",
          "979:  }",
          "980: yy50:",
          "982:  switch (yych) {",
          "983:  case '\"': goto yy51;",
          "984:  default: goto yy18;",
          "985:  }",
          "986: yy51:",
          "988: #line 532 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "806: #line 807 \"ext/standard/var_unserializer.c\"",
          "809:  if (yych == '+') goto yy47;",
          "810:  if (yych <= '/') goto yy18;",
          "811:  if (yych <= '9') goto yy48;",
          "812:  goto yy18;",
          "815:  if (yych <= '/') goto yy18;",
          "816:  if (yych >= ':') goto yy18;",
          "821:  if (yych <= '/') goto yy18;",
          "822:  if (yych <= '9') goto yy48;",
          "823:  if (yych >= ';') goto yy18;",
          "825:  if (yych != '\"') goto yy18;",
          "827: #line 539 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1013:  ZVAL_STRINGL(*rval, str, len, 1);",
          "1014:  return 1;",
          "1015: }",
          "1017: yy53:",
          "1018:  yych = *++YYCURSOR;",
          "1036:  }",
          "1038:  yych = *++YYCURSOR;",
          "1043: yy55:",
          "1044:  yych = *++YYCURSOR;",
          "1059:  }",
          "1060: yy56:",
          "1061:  yych = *++YYCURSOR;",
          "1066: yy57:",
          "1067:  yych = *++YYCURSOR;",
          "1082: yy58:",
          "1083:  ++YYCURSOR;",
          "1084:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1085:  yych = *YYCURSOR;",
          "1102:  }",
          "1103: yy60:",
          "1104:  yych = *++YYCURSOR;",
          "1118: yy61:",
          "1119:  ++YYCURSOR;",
          "1120:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1121:  yych = *YYCURSOR;",
          "1137:  }",
          "1138: yy63:",
          "1139:  ++YYCURSOR;",
          "1141:  {",
          "1142: #if SIZEOF_LONG == 4",
          "1143: use_double:",
          "",
          "[Removed Lines]",
          "1016: #line 1017 \"ext/standard/var_unserializer.c\"",
          "1019:  switch (yych) {",
          "1020:  case '+': goto yy57;",
          "1021:  case '-': goto yy55;",
          "1022:  case '.': goto yy60;",
          "1023:  case '0':",
          "1024:  case '1':",
          "1025:  case '2':",
          "1026:  case '3':",
          "1027:  case '4':",
          "1028:  case '5':",
          "1029:  case '6':",
          "1030:  case '7':",
          "1031:  case '8':",
          "1032:  case '9': goto yy58;",
          "1033:  case 'I': goto yy56;",
          "1034:  case 'N': goto yy54;",
          "1035:  default: goto yy18;",
          "1037: yy54:",
          "1039:  switch (yych) {",
          "1040:  case 'A': goto yy76;",
          "1041:  default: goto yy18;",
          "1042:  }",
          "1045:  switch (yych) {",
          "1046:  case '.': goto yy60;",
          "1047:  case '0':",
          "1048:  case '1':",
          "1049:  case '2':",
          "1050:  case '3':",
          "1051:  case '4':",
          "1052:  case '5':",
          "1053:  case '6':",
          "1054:  case '7':",
          "1055:  case '8':",
          "1056:  case '9': goto yy58;",
          "1057:  case 'I': goto yy56;",
          "1058:  default: goto yy18;",
          "1062:  switch (yych) {",
          "1063:  case 'N': goto yy72;",
          "1064:  default: goto yy18;",
          "1065:  }",
          "1068:  switch (yych) {",
          "1069:  case '.': goto yy60;",
          "1070:  case '0':",
          "1071:  case '1':",
          "1072:  case '2':",
          "1073:  case '3':",
          "1074:  case '4':",
          "1075:  case '5':",
          "1076:  case '6':",
          "1077:  case '7':",
          "1078:  case '8':",
          "1079:  case '9': goto yy58;",
          "1080:  default: goto yy18;",
          "1081:  }",
          "1086:  switch (yych) {",
          "1087:  case '.': goto yy70;",
          "1088:  case '0':",
          "1089:  case '1':",
          "1090:  case '2':",
          "1091:  case '3':",
          "1092:  case '4':",
          "1093:  case '5':",
          "1094:  case '6':",
          "1095:  case '7':",
          "1096:  case '8':",
          "1097:  case '9': goto yy58;",
          "1098:  case ';': goto yy63;",
          "1099:  case 'E':",
          "1100:  case 'e': goto yy65;",
          "1101:  default: goto yy18;",
          "1105:  switch (yych) {",
          "1106:  case '0':",
          "1107:  case '1':",
          "1108:  case '2':",
          "1109:  case '3':",
          "1110:  case '4':",
          "1111:  case '5':",
          "1112:  case '6':",
          "1113:  case '7':",
          "1114:  case '8':",
          "1115:  case '9': goto yy61;",
          "1116:  default: goto yy18;",
          "1117:  }",
          "1122:  switch (yych) {",
          "1123:  case '0':",
          "1124:  case '1':",
          "1125:  case '2':",
          "1126:  case '3':",
          "1127:  case '4':",
          "1128:  case '5':",
          "1129:  case '6':",
          "1130:  case '7':",
          "1131:  case '8':",
          "1132:  case '9': goto yy61;",
          "1133:  case ';': goto yy63;",
          "1134:  case 'E':",
          "1135:  case 'e': goto yy65;",
          "1136:  default: goto yy18;",
          "1140: #line 522 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "855: #line 856 \"ext/standard/var_unserializer.c\"",
          "858:  if (yych <= '/') {",
          "859:   if (yych <= ',') {",
          "860:    if (yych == '+') goto yy57;",
          "861:    goto yy18;",
          "862:   } else {",
          "863:    if (yych <= '-') goto yy55;",
          "864:    if (yych <= '.') goto yy60;",
          "865:    goto yy18;",
          "866:   }",
          "867:  } else {",
          "868:   if (yych <= 'I') {",
          "869:    if (yych <= '9') goto yy58;",
          "870:    if (yych <= 'H') goto yy18;",
          "871:    goto yy56;",
          "872:   } else {",
          "873:    if (yych != 'N') goto yy18;",
          "874:   }",
          "877:  if (yych == 'A') goto yy76;",
          "878:  goto yy18;",
          "881:  if (yych <= '/') {",
          "882:   if (yych == '.') goto yy60;",
          "883:   goto yy18;",
          "884:  } else {",
          "885:   if (yych <= '9') goto yy58;",
          "886:   if (yych != 'I') goto yy18;",
          "890:  if (yych == 'N') goto yy72;",
          "891:  goto yy18;",
          "894:  if (yych == '.') goto yy60;",
          "895:  if (yych <= '/') goto yy18;",
          "896:  if (yych >= ':') goto yy18;",
          "901:  if (yych <= ':') {",
          "902:   if (yych <= '.') {",
          "903:    if (yych <= '-') goto yy18;",
          "904:    goto yy70;",
          "905:   } else {",
          "906:    if (yych <= '/') goto yy18;",
          "907:    if (yych <= '9') goto yy58;",
          "908:    goto yy18;",
          "909:   }",
          "910:  } else {",
          "911:   if (yych <= 'E') {",
          "912:    if (yych <= ';') goto yy63;",
          "913:    if (yych <= 'D') goto yy18;",
          "914:    goto yy65;",
          "915:   } else {",
          "916:    if (yych == 'e') goto yy65;",
          "917:    goto yy18;",
          "918:   }",
          "922:  if (yych <= '/') goto yy18;",
          "923:  if (yych >= ':') goto yy18;",
          "928:  if (yych <= ';') {",
          "929:   if (yych <= '/') goto yy18;",
          "930:   if (yych <= '9') goto yy61;",
          "931:   if (yych <= ':') goto yy18;",
          "932:  } else {",
          "933:   if (yych <= 'E') {",
          "934:    if (yych <= 'D') goto yy18;",
          "935:    goto yy65;",
          "936:   } else {",
          "937:    if (yych == 'e') goto yy65;",
          "938:    goto yy18;",
          "939:   }",
          "943: #line 529 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1147:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1148:  return 1;",
          "1149: }",
          "1151: yy65:",
          "1152:  yych = *++YYCURSOR;",
          "1167:  }",
          "1168: yy66:",
          "1169:  yych = *++YYCURSOR;",
          "1184:  }",
          "1185: yy67:",
          "1186:  ++YYCURSOR;",
          "1187:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1188:  yych = *YYCURSOR;",
          "1203: yy69:",
          "1204:  yych = *++YYCURSOR;",
          "1218: yy70:",
          "1219:  ++YYCURSOR;",
          "1220:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1221:  yych = *YYCURSOR;",
          "1237:  }",
          "1238: yy72:",
          "1239:  yych = *++YYCURSOR;",
          "1244: yy73:",
          "1245:  yych = *++YYCURSOR;",
          "1251:  ++YYCURSOR;",
          "1253:  {",
          "1255:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1150: #line 1151 \"ext/standard/var_unserializer.c\"",
          "1153:  switch (yych) {",
          "1154:  case '+':",
          "1155:  case '-': goto yy66;",
          "1156:  case '0':",
          "1157:  case '1':",
          "1158:  case '2':",
          "1159:  case '3':",
          "1160:  case '4':",
          "1161:  case '5':",
          "1162:  case '6':",
          "1163:  case '7':",
          "1164:  case '8':",
          "1165:  case '9': goto yy67;",
          "1166:  default: goto yy18;",
          "1170:  switch (yych) {",
          "1171:  case '+':",
          "1172:  case '-': goto yy69;",
          "1173:  case '0':",
          "1174:  case '1':",
          "1175:  case '2':",
          "1176:  case '3':",
          "1177:  case '4':",
          "1178:  case '5':",
          "1179:  case '6':",
          "1180:  case '7':",
          "1181:  case '8':",
          "1182:  case '9': goto yy67;",
          "1183:  default: goto yy18;",
          "1189:  switch (yych) {",
          "1190:  case '0':",
          "1191:  case '1':",
          "1192:  case '2':",
          "1193:  case '3':",
          "1194:  case '4':",
          "1195:  case '5':",
          "1196:  case '6':",
          "1197:  case '7':",
          "1198:  case '8':",
          "1199:  case '9': goto yy67;",
          "1200:  case ';': goto yy63;",
          "1201:  default: goto yy18;",
          "1202:  }",
          "1205:  switch (yych) {",
          "1206:  case '0':",
          "1207:  case '1':",
          "1208:  case '2':",
          "1209:  case '3':",
          "1210:  case '4':",
          "1211:  case '5':",
          "1212:  case '6':",
          "1213:  case '7':",
          "1214:  case '8':",
          "1215:  case '9': goto yy67;",
          "1216:  default: goto yy18;",
          "1217:  }",
          "1222:  switch (yych) {",
          "1223:  case '0':",
          "1224:  case '1':",
          "1225:  case '2':",
          "1226:  case '3':",
          "1227:  case '4':",
          "1228:  case '5':",
          "1229:  case '6':",
          "1230:  case '7':",
          "1231:  case '8':",
          "1232:  case '9': goto yy70;",
          "1233:  case ';': goto yy63;",
          "1234:  case 'E':",
          "1235:  case 'e': goto yy65;",
          "1236:  default: goto yy18;",
          "1240:  switch (yych) {",
          "1241:  case 'F': goto yy73;",
          "1242:  default: goto yy18;",
          "1243:  }",
          "1246:  switch (yych) {",
          "1247:  case ';': goto yy74;",
          "1248:  default: goto yy18;",
          "1249:  }",
          "1250: yy74:",
          "1252: #line 507 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "953: #line 954 \"ext/standard/var_unserializer.c\"",
          "956:  if (yych <= ',') {",
          "957:   if (yych != '+') goto yy18;",
          "958:  } else {",
          "959:   if (yych <= '-') goto yy66;",
          "960:   if (yych <= '/') goto yy18;",
          "961:   if (yych <= '9') goto yy67;",
          "962:   goto yy18;",
          "966:  if (yych <= ',') {",
          "967:   if (yych == '+') goto yy69;",
          "968:   goto yy18;",
          "969:  } else {",
          "970:   if (yych <= '-') goto yy69;",
          "971:   if (yych <= '/') goto yy18;",
          "972:   if (yych >= ':') goto yy18;",
          "978:  if (yych <= '/') goto yy18;",
          "979:  if (yych <= '9') goto yy67;",
          "980:  if (yych == ';') goto yy63;",
          "981:  goto yy18;",
          "984:  if (yych <= '/') goto yy18;",
          "985:  if (yych <= '9') goto yy67;",
          "986:  goto yy18;",
          "991:  if (yych <= ';') {",
          "992:   if (yych <= '/') goto yy18;",
          "993:   if (yych <= '9') goto yy70;",
          "994:   if (yych <= ':') goto yy18;",
          "995:   goto yy63;",
          "996:  } else {",
          "997:   if (yych <= 'E') {",
          "998:    if (yych <= 'D') goto yy18;",
          "999:    goto yy65;",
          "1000:   } else {",
          "1001:    if (yych == 'e') goto yy65;",
          "1002:    goto yy18;",
          "1003:   }",
          "1007:  if (yych != 'F') goto yy18;",
          "1010:  if (yych != ';') goto yy18;",
          "1012: #line 514 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1265:  return 1;",
          "1266: }",
          "1268: yy76:",
          "1269:  yych = *++YYCURSOR;",
          "1274: yy77:",
          "1275:  yych = *++YYCURSOR;",
          "1290:  }",
          "1291: yy78:",
          "1292:  yych = *++YYCURSOR;",
          "1306: yy79:",
          "1307:  ++YYCURSOR;",
          "1308:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1309:  yych = *YYCURSOR;",
          "1325:  ++YYCURSOR;",
          "1327:  {",
          "1328: #if SIZEOF_LONG == 4",
          "1329:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
          "1270:  switch (yych) {",
          "1271:  case 'N': goto yy73;",
          "1272:  default: goto yy18;",
          "1273:  }",
          "1276:  switch (yych) {",
          "1277:  case '+':",
          "1278:  case '-': goto yy78;",
          "1279:  case '0':",
          "1280:  case '1':",
          "1281:  case '2':",
          "1282:  case '3':",
          "1283:  case '4':",
          "1284:  case '5':",
          "1285:  case '6':",
          "1286:  case '7':",
          "1287:  case '8':",
          "1288:  case '9': goto yy79;",
          "1289:  default: goto yy18;",
          "1293:  switch (yych) {",
          "1294:  case '0':",
          "1295:  case '1':",
          "1296:  case '2':",
          "1297:  case '3':",
          "1298:  case '4':",
          "1299:  case '5':",
          "1300:  case '6':",
          "1301:  case '7':",
          "1302:  case '8':",
          "1303:  case '9': goto yy79;",
          "1304:  default: goto yy18;",
          "1305:  }",
          "1310:  switch (yych) {",
          "1311:  case '0':",
          "1312:  case '1':",
          "1313:  case '2':",
          "1314:  case '3':",
          "1315:  case '4':",
          "1316:  case '5':",
          "1317:  case '6':",
          "1318:  case '7':",
          "1319:  case '8':",
          "1320:  case '9': goto yy79;",
          "1321:  case ';': goto yy81;",
          "1322:  default: goto yy18;",
          "1323:  }",
          "1324: yy81:",
          "1326: #line 480 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1027: #line 1028 \"ext/standard/var_unserializer.c\"",
          "1030:  if (yych == 'N') goto yy73;",
          "1031:  goto yy18;",
          "1034:  if (yych <= ',') {",
          "1035:   if (yych != '+') goto yy18;",
          "1036:  } else {",
          "1037:   if (yych <= '-') goto yy78;",
          "1038:   if (yych <= '/') goto yy18;",
          "1039:   if (yych <= '9') goto yy79;",
          "1040:   goto yy18;",
          "1044:  if (yych <= '/') goto yy18;",
          "1045:  if (yych >= ':') goto yy18;",
          "1050:  if (yych <= '/') goto yy18;",
          "1051:  if (yych <= '9') goto yy79;",
          "1052:  if (yych != ';') goto yy18;",
          "1054: #line 487 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1350:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1351:  return 1;",
          "1352: }",
          "1354: yy83:",
          "1355:  yych = *++YYCURSOR;",
          "1362:  yych = *++YYCURSOR;",
          "1368:  ++YYCURSOR;",
          "1370:  {",
          "1372:  INIT_PZVAL(*rval);",
          "1373:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1374:  return 1;",
          "1375: }",
          "1377: yy87:",
          "1378:  ++YYCURSOR;",
          "1380:  {",
          "1382:  INIT_PZVAL(*rval);",
          "1383:  ZVAL_NULL(*rval);",
          "1384:  return 1;",
          "1385: }",
          "1387: yy89:",
          "1388:  yych = *++YYCURSOR;",
          "1403:  }",
          "1404: yy90:",
          "1405:  yych = *++YYCURSOR;",
          "1419: yy91:",
          "1420:  ++YYCURSOR;",
          "1421:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1422:  yych = *YYCURSOR;",
          "1438:  ++YYCURSOR;",
          "1440:  {",
          "1441:  long id;",
          "",
          "[Removed Lines]",
          "1353: #line 1354 \"ext/standard/var_unserializer.c\"",
          "1356:  switch (yych) {",
          "1357:  case '0':",
          "1358:  case '1': goto yy84;",
          "1359:  default: goto yy18;",
          "1360:  }",
          "1361: yy84:",
          "1363:  switch (yych) {",
          "1364:  case ';': goto yy85;",
          "1365:  default: goto yy18;",
          "1366:  }",
          "1367: yy85:",
          "1369: #line 473 \"ext/standard/var_unserializer.re\"",
          "1376: #line 1377 \"ext/standard/var_unserializer.c\"",
          "1379: #line 466 \"ext/standard/var_unserializer.re\"",
          "1386: #line 1387 \"ext/standard/var_unserializer.c\"",
          "1389:  switch (yych) {",
          "1390:  case '+':",
          "1391:  case '-': goto yy90;",
          "1392:  case '0':",
          "1393:  case '1':",
          "1394:  case '2':",
          "1395:  case '3':",
          "1396:  case '4':",
          "1397:  case '5':",
          "1398:  case '6':",
          "1399:  case '7':",
          "1400:  case '8':",
          "1401:  case '9': goto yy91;",
          "1402:  default: goto yy18;",
          "1406:  switch (yych) {",
          "1407:  case '0':",
          "1408:  case '1':",
          "1409:  case '2':",
          "1410:  case '3':",
          "1411:  case '4':",
          "1412:  case '5':",
          "1413:  case '6':",
          "1414:  case '7':",
          "1415:  case '8':",
          "1416:  case '9': goto yy91;",
          "1417:  default: goto yy18;",
          "1418:  }",
          "1423:  switch (yych) {",
          "1424:  case '0':",
          "1425:  case '1':",
          "1426:  case '2':",
          "1427:  case '3':",
          "1428:  case '4':",
          "1429:  case '5':",
          "1430:  case '6':",
          "1431:  case '7':",
          "1432:  case '8':",
          "1433:  case '9': goto yy91;",
          "1434:  case ';': goto yy93;",
          "1435:  default: goto yy18;",
          "1436:  }",
          "1437: yy93:",
          "1439: #line 443 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1081: #line 1082 \"ext/standard/var_unserializer.c\"",
          "1084:  if (yych <= '/') goto yy18;",
          "1085:  if (yych >= '2') goto yy18;",
          "1087:  if (yych != ';') goto yy18;",
          "1089: #line 480 \"ext/standard/var_unserializer.re\"",
          "1096: #line 1097 \"ext/standard/var_unserializer.c\"",
          "1099: #line 473 \"ext/standard/var_unserializer.re\"",
          "1106: #line 1107 \"ext/standard/var_unserializer.c\"",
          "1109:  if (yych <= ',') {",
          "1110:   if (yych != '+') goto yy18;",
          "1111:  } else {",
          "1112:   if (yych <= '-') goto yy90;",
          "1113:   if (yych <= '/') goto yy18;",
          "1114:   if (yych <= '9') goto yy91;",
          "1115:   goto yy18;",
          "1119:  if (yych <= '/') goto yy18;",
          "1120:  if (yych >= ':') goto yy18;",
          "1125:  if (yych <= '/') goto yy18;",
          "1126:  if (yych <= '9') goto yy91;",
          "1127:  if (yych != ';') goto yy18;",
          "1129: #line 450 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1460:  return 1;",
          "1461: }",
          "1463: yy95:",
          "1464:  yych = *++YYCURSOR;",
          "1479:  }",
          "1480: yy96:",
          "1481:  yych = *++YYCURSOR;",
          "1495: yy97:",
          "1496:  ++YYCURSOR;",
          "1497:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1498:  yych = *YYCURSOR;",
          "1514:  ++YYCURSOR;",
          "1516:  {",
          "1517:  long id;",
          "",
          "[Removed Lines]",
          "1462: #line 1463 \"ext/standard/var_unserializer.c\"",
          "1465:  switch (yych) {",
          "1466:  case '+':",
          "1467:  case '-': goto yy96;",
          "1468:  case '0':",
          "1469:  case '1':",
          "1470:  case '2':",
          "1471:  case '3':",
          "1472:  case '4':",
          "1473:  case '5':",
          "1474:  case '6':",
          "1475:  case '7':",
          "1476:  case '8':",
          "1477:  case '9': goto yy97;",
          "1478:  default: goto yy18;",
          "1482:  switch (yych) {",
          "1483:  case '0':",
          "1484:  case '1':",
          "1485:  case '2':",
          "1486:  case '3':",
          "1487:  case '4':",
          "1488:  case '5':",
          "1489:  case '6':",
          "1490:  case '7':",
          "1491:  case '8':",
          "1492:  case '9': goto yy97;",
          "1493:  default: goto yy18;",
          "1494:  }",
          "1499:  switch (yych) {",
          "1500:  case '0':",
          "1501:  case '1':",
          "1502:  case '2':",
          "1503:  case '3':",
          "1504:  case '4':",
          "1505:  case '5':",
          "1506:  case '6':",
          "1507:  case '7':",
          "1508:  case '8':",
          "1509:  case '9': goto yy97;",
          "1510:  case ';': goto yy99;",
          "1511:  default: goto yy18;",
          "1512:  }",
          "1513: yy99:",
          "1515: #line 422 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1152: #line 1153 \"ext/standard/var_unserializer.c\"",
          "1155:  if (yych <= ',') {",
          "1156:   if (yych != '+') goto yy18;",
          "1157:  } else {",
          "1158:   if (yych <= '-') goto yy96;",
          "1159:   if (yych <= '/') goto yy18;",
          "1160:   if (yych <= '9') goto yy97;",
          "1161:   goto yy18;",
          "1165:  if (yych <= '/') goto yy18;",
          "1166:  if (yych >= ':') goto yy18;",
          "1171:  if (yych <= '/') goto yy18;",
          "1172:  if (yych <= '9') goto yy97;",
          "1173:  if (yych != ';') goto yy18;",
          "1175: #line 429 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1534:  return 1;",
          "1535: }",
          "1537: }",
          "1541:  return 0;",
          "",
          "[Removed Lines]",
          "1536: #line 1537 \"ext/standard/var_unserializer.c\"",
          "1538: #line 742 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "1198: #line 749 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "409:  const unsigned char *cursor, *limit, *marker, *start;",
          "410:  zval **rval_ref;",
          "414:  if (var_hash && cursor[0] != 'R') {",
          "415:   var_push(var_hash, rval);",
          "",
          "[Removed Lines]",
          "412:  limit = cursor = *p;",
          "",
          "[Added Lines]",
          "412:  limit = max;",
          "413:  cursor = *p;",
          "415:  if (YYCURSOR >= YYLIMIT) {",
          "416:   return 0;",
          "417:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "aeb30576f6e6f4458c922a5c7ac15ec1a25625f9",
      "candidate_info": {
        "commit_hash": "aeb30576f6e6f4458c922a5c7ac15ec1a25625f9",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/aeb30576f6e6f4458c922a5c7ac15ec1a25625f9",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "standard/tests/serialize/bug68545.phpt"
        ],
        "message": "Merge branch 'PHP-5.6'\n\n* PHP-5.6:\n  updated NEWS\n  Fixed bug #68545 NULL pointer dereference in unserialize.c\n  Updated NEWS\n  Updated NEWS\n\nConflicts:\n\text/standard/var_unserializer.c\n\text/standard/var_unserializer.re",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "standard/tests/serialize/bug68545.phpt||standard/tests/serialize/bug68545.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "67: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "68: {",
          "70: #if VAR_ENTRIES_DBG",
          "71:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "72: #endif",
          "",
          "[Removed Lines]",
          "69:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "",
          "[Added Lines]",
          "69:  var_dtor_entries *var_hash;",
          "71:  if (!var_hashx || !*var_hashx) {",
          "72:   return;",
          "73:  }",
          "75:  var_hash = (*var_hashx)->last_dtor;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "253: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "256: #line 261 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "262: #line 267 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "509:  start = cursor;",
          "513: {",
          "514:  YYCTYPE yych;",
          "515:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "512: #line 513 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "518: #line 519 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "569:  yych = *(YYMARKER = ++YYCURSOR);",
          "570:  if (yych == ':') goto yy95;",
          "571: yy3:",
          "573:  { return 0; }",
          "575: yy4:",
          "576:  yych = *(YYMARKER = ++YYCURSOR);",
          "577:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "572: #line 860 \"ext/standard/var_unserializer.re\"",
          "574: #line 575 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "578: #line 866 \"ext/standard/var_unserializer.re\"",
          "580: #line 581 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "614:  goto yy3;",
          "615: yy14:",
          "616:  ++YYCURSOR;",
          "618:  {",
          "620:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "622: }",
          "624: yy16:",
          "625:  yych = *++YYCURSOR;",
          "626:  goto yy3;",
          "",
          "[Removed Lines]",
          "617: #line 854 \"ext/standard/var_unserializer.re\"",
          "623: #line 624 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "623: #line 860 \"ext/standard/var_unserializer.re\"",
          "629: #line 630 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "646:  if (yybm[0+yych] & 128) {",
          "647:   goto yy20;",
          "648:  }",
          "651:  yych = *++YYCURSOR;",
          "652:  if (yych != '\"') goto yy18;",
          "653:  ++YYCURSOR;",
          "655:  {",
          "656:  size_t len, len2, len3, maxlen;",
          "657:  zend_long elements;",
          "",
          "[Removed Lines]",
          "649:  if (yych <= '/') goto yy18;",
          "650:  if (yych >= ';') goto yy18;",
          "654: #line 709 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "655:  if (yych != ':') goto yy18;",
          "659: #line 715 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "797:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "798: }",
          "800: yy25:",
          "801:  yych = *++YYCURSOR;",
          "802:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "799: #line 800 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "804: #line 805 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "821:  yych = *++YYCURSOR;",
          "822:  if (yych != '\"') goto yy18;",
          "823:  ++YYCURSOR;",
          "825:  {",
          "",
          "[Removed Lines]",
          "824: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "829: #line 707 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "829:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "830:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "831: }",
          "833: yy32:",
          "834:  yych = *++YYCURSOR;",
          "835:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "832: #line 833 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "837: #line 838 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "850:  yych = *++YYCURSOR;",
          "851:  if (yych != '{') goto yy18;",
          "852:  ++YYCURSOR;",
          "854:  {",
          "855:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "853: #line 680 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "858: #line 686 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "872:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "873: }",
          "875: yy39:",
          "876:  yych = *++YYCURSOR;",
          "877:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "874: #line 875 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "879: #line 880 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "892:  yych = *++YYCURSOR;",
          "893:  if (yych != '\"') goto yy18;",
          "894:  ++YYCURSOR;",
          "896:  {",
          "897:  size_t len, maxlen;",
          "898:  zend_string *str;",
          "",
          "[Removed Lines]",
          "895: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "900: #line 658 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "920:  ZVAL_STR(rval, str);",
          "921:  return 1;",
          "922: }",
          "924: yy46:",
          "925:  yych = *++YYCURSOR;",
          "926:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "923: #line 924 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "928: #line 929 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "941:  yych = *++YYCURSOR;",
          "942:  if (yych != '\"') goto yy18;",
          "943:  ++YYCURSOR;",
          "945:  {",
          "946:  size_t len, maxlen;",
          "947:  char *str;",
          "",
          "[Removed Lines]",
          "944: #line 625 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "949: #line 631 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "968:  ZVAL_STRINGL(rval, str, len);",
          "969:  return 1;",
          "970: }",
          "972: yy53:",
          "973:  yych = *++YYCURSOR;",
          "974:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "971: #line 972 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "976: #line 977 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1056:  }",
          "1057: yy63:",
          "1058:  ++YYCURSOR;",
          "1060:  {",
          "1061: #if SIZEOF_ZEND_LONG == 4",
          "1062: use_double:",
          "",
          "[Removed Lines]",
          "1059: #line 616 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1064: #line 622 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1065:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1066:  return 1;",
          "1067: }",
          "1069: yy65:",
          "1070:  yych = *++YYCURSOR;",
          "1071:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1073: #line 1074 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1124:  yych = *++YYCURSOR;",
          "1125:  if (yych != ';') goto yy18;",
          "1126:  ++YYCURSOR;",
          "1128:  {",
          "",
          "[Removed Lines]",
          "1127: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1132: #line 606 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1141:  return 1;",
          "1142: }",
          "1144: yy76:",
          "1145:  yych = *++YYCURSOR;",
          "1146:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1143: #line 1144 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1148: #line 1149 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1167:  if (yych <= '9') goto yy79;",
          "1168:  if (yych != ';') goto yy18;",
          "1169:  ++YYCURSOR;",
          "1171:  {",
          "1172: #if SIZEOF_ZEND_LONG == 4",
          "1173:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1170: #line 574 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1175: #line 580 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1193:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1194:  return 1;",
          "1195: }",
          "1197: yy83:",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1201: #line 1202 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1201:  yych = *++YYCURSOR;",
          "1202:  if (yych != ';') goto yy18;",
          "1203:  ++YYCURSOR;",
          "1205:  {",
          "1207:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1208:  return 1;",
          "1209: }",
          "1211: yy87:",
          "1212:  ++YYCURSOR;",
          "1214:  {",
          "1216:  ZVAL_NULL(rval);",
          "1217:  return 1;",
          "1218: }",
          "1220: yy89:",
          "1221:  yych = *++YYCURSOR;",
          "1222:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1204: #line 568 \"ext/standard/var_unserializer.re\"",
          "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
          "1213: #line 562 \"ext/standard/var_unserializer.re\"",
          "1219: #line 1220 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1209: #line 574 \"ext/standard/var_unserializer.re\"",
          "1215: #line 1216 \"ext/standard/var_unserializer.c\"",
          "1218: #line 568 \"ext/standard/var_unserializer.re\"",
          "1224: #line 1225 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1239:  if (yych <= '9') goto yy91;",
          "1240:  if (yych != ';') goto yy18;",
          "1241:  ++YYCURSOR;",
          "1243:  {",
          "1244:  zend_long id;",
          "",
          "[Removed Lines]",
          "1242: #line 539 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1247: #line 545 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1263:  return 1;",
          "1264: }",
          "1266: yy95:",
          "1267:  yych = *++YYCURSOR;",
          "1268:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1265: #line 1266 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1270: #line 1271 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1285:  if (yych <= '9') goto yy97;",
          "1286:  if (yych != ';') goto yy18;",
          "1287:  ++YYCURSOR;",
          "1289:  {",
          "1290:  zend_long id;",
          "",
          "[Removed Lines]",
          "1288: #line 517 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1293: #line 523 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1308:  return 1;",
          "1309: }",
          "1311: }",
          "1315:  return 0;",
          "",
          "[Removed Lines]",
          "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
          "1312: #line 862 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1315: #line 1316 \"ext/standard/var_unserializer.c\"",
          "1317: #line 868 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "65: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "66: {",
          "68: #if VAR_ENTRIES_DBG",
          "69:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "70: #endif",
          "",
          "[Removed Lines]",
          "67:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "",
          "[Added Lines]",
          "67:  var_dtor_entries *var_hash;",
          "69:  if (!var_hashx || !*var_hashx) {",
          "70:   return;",
          "71:  }",
          "73:  var_hash = (*var_hashx)->last_dtor;",
          "",
          "---------------"
        ],
        "standard/tests/serialize/bug68545.phpt||standard/tests/serialize/bug68545.phpt": [
          "File: standard/tests/serialize/bug68545.phpt -> standard/tests/serialize/bug68545.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68545 NULL pointer dereference in unserialize.c:var_push_dtor",
          "3: --FILE--",
          "4: <?php",
          "5: var_dump(unserialize('a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";s:3:\"bar\";a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"b22\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";s:3:\"bar\";a:6:{a:6:{s:3:\"322\";s:3:\"bar\";s:3:\"bar\";s:3:\"foo\";s:3:\"bar\";s:3:\"bar\";'));",
          "6: ?>",
          "7: ===DONE===",
          "8: --EXPECTF--",
          "9: Notice: unserialize(): Error at offset %d of %d bytes in %sbug68545.php on line %d",
          "10: bool(false)",
          "11: ===DONE===",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "24540362b0da5d9bcc41fa043152e69b2e0ca986",
      "candidate_info": {
        "commit_hash": "24540362b0da5d9bcc41fa043152e69b2e0ca986",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/24540362b0da5d9bcc41fa043152e69b2e0ca986",
        "files": [
          "ext/standard/php_var.h",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Re-fixed unserialize",
        "before_after_code_files": [
          "ext/standard/php_var.h||ext/standard/php_var.h",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/php_var.h||ext/standard/php_var.h": [
          "File: ext/standard/php_var.h -> ext/standard/php_var.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "52: PHPAPI void php_var_serialize(smart_str *buf, zval *struc, php_serialize_data_t *var_hash TSRMLS_DC);",
          "53: PHPAPI int php_var_unserialize(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "55: #define PHP_VAR_SERIALIZE_INIT(var_hash_ptr) \\",
          "56: do  { \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "54: PHPAPI int php_var_unserialize_intern(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "113:  } \\",
          "114: } while (0)",
          "117: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hash, zval *val);",
          "118: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval);",
          "119: PHPAPI void var_destroy(php_unserialize_data_t *var_hash);",
          "124: PHPAPI zend_class_entry *php_create_empty_class(char *class_name, int len);",
          "",
          "[Removed Lines]",
          "116: PHPAPI void var_replace(php_unserialize_data_t *var_hash, zval *ozval, zval *nzval);",
          "121: #define PHP_VAR_UNSERIALIZE_ZVAL_CHANGED(var_hash, ozval, nzval) \\",
          "122:  var_replace((var_hash), (ozval), &(nzval))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #define VAR_ENTRIES_DBG 0",
          "31: typedef struct {",
          "33:  long used_slots;",
          "34:  void *next;",
          "35: } var_entries;",
          "38: {",
          "39:  var_entries *var_hash = (*var_hashx)->last;",
          "40: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "32:  zval *data[VAR_ENTRIES_MAX];",
          "37: static inline void var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Added Lines]",
          "32:  zval data[VAR_ENTRIES_MAX];",
          "37: static inline zval *var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "55:   (*var_hashx)->last = var_hash;",
          "56:  }",
          "59: }",
          "61: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "58:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "58:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "59:  return &var_hash->data[var_hash->used_slots++];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "79:   (*var_hashx)->last_dtor = var_hash;",
          "80:  }",
          "84: }",
          "86: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "82:  Z_ADDREF_P(rval);",
          "83:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "83:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "84:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "104:   (*var_hashx)->last_dtor = var_hash;",
          "105:  }",
          "127: }",
          "129: static int var_access(php_unserialize_data_t *var_hashx, long id, zval **store)",
          "",
          "[Removed Lines]",
          "107:  var_hash->data[var_hash->used_slots++] = rval;",
          "108: }",
          "110: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "111: {",
          "112:  long i;",
          "113:  var_entries *var_hash = (*var_hashx)->first;",
          "114: #if VAR_ENTRIES_DBG",
          "115:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "116: #endif",
          "118:  while (var_hash) {",
          "119:   for (i = 0; i < var_hash->used_slots; i++) {",
          "120:    if (var_hash->data[i] == ozval) {",
          "121:     var_hash->data[i] = nzval;",
          "123:    }",
          "124:   }",
          "125:   var_hash = var_hash->next;",
          "126:  }",
          "",
          "[Added Lines]",
          "108:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "109:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "167:  while (var_hash) {",
          "168:   for (i = 0; i < var_hash->used_slots; i++) {",
          "170:   }",
          "171:   next = var_hash->next;",
          "172:   efree(var_hash);",
          "",
          "[Removed Lines]",
          "169:    zval_ptr_dtor(var_hash->data[i]);",
          "",
          "[Added Lines]",
          "152:    zval_ptr_dtor(&var_hash->data[i]);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "226: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "229: #line 234 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "212: #line 217 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "292: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long elements, int objprops)",
          "293: {",
          "294:  while (elements-- > 0) {",
          "299:    return 0;",
          "300:   }",
          "",
          "[Removed Lines]",
          "295:   zval key, data, *old_data;",
          "297:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "298:    zval_dtor(&key);",
          "",
          "[Added Lines]",
          "278:   zval key, *data, d, *old_data;",
          "280:   if (!php_var_unserialize_intern(&key, p, max, NULL TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "304:    return 0;",
          "305:   }",
          "309:    zval_dtor(&key);",
          "310:    return 0;",
          "311:   }",
          "",
          "[Removed Lines]",
          "307:   ZVAL_UNDEF(&data);",
          "308:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "289:   if (var_hash && (*p)[0] != 'R') {",
          "290:    data = var_push(var_hash, data);",
          "291:   } else {",
          "292:    data = &d;",
          "293:   }",
          "295:   ZVAL_UNDEF(data);",
          "296:   if (!php_var_unserialize_intern(data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "316:     if ((old_data = zend_hash_index_find(ht, Z_LVAL(key))) != NULL) {",
          "317:      var_push_dtor(var_hash, old_data);",
          "318:     }",
          "320:     break;",
          "321:    case IS_STRING:",
          "322:     if ((old_data = zend_symtable_find(ht, Z_STR(key))) != NULL) {",
          "323:      var_push_dtor(var_hash, old_data);",
          "324:     }",
          "326:     break;",
          "327:    }",
          "328:   } else {",
          "330:    convert_to_string(&key);",
          "332:   }",
          "334:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "319:     zend_hash_index_update(ht, Z_LVAL(key), &data);",
          "325:     zend_symtable_update(ht, Z_STR(key), &data);",
          "331:    zend_hash_update(ht, Z_STR(key), &data);",
          "",
          "[Added Lines]",
          "307:     zend_hash_index_update(ht, Z_LVAL(key), data);",
          "313:     zend_symtable_update(ht, Z_STR(key), data);",
          "319:    zend_hash_update(ht, Z_STR(key), data);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "425: #endif",
          "427: PHPAPI int php_var_unserialize(UNSERIALIZE_PARAMETER)",
          "428: {",
          "429:  const unsigned char *cursor, *limit, *marker, *start;",
          "430:  zval *rval_ref;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "416: {",
          "417:  if (var_hash && (*p)[0] != 'R') {",
          "418:   var_push(var_hash, rval);",
          "419:  }",
          "421:  return php_var_unserialize_intern(UNSERIALIZE_PASSTHRU);",
          "422: }",
          "424: PHPAPI int php_var_unserialize_intern(UNSERIALIZE_PARAMETER)",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "436:   return 0;",
          "437:  }",
          "443:  start = cursor;",
          "449: {",
          "450:  YYCTYPE yych;",
          "451:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "439:  if (var_hash && cursor[0] != 'R') {",
          "440:   var_push(var_hash, rval);",
          "441:  }",
          "448: #line 449 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "439: #line 440 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "505:  yych = *(YYMARKER = ++YYCURSOR);",
          "506:  if (yych == ':') goto yy95;",
          "507: yy3:",
          "509:  { return 0; }",
          "511: yy4:",
          "512:  yych = *(YYMARKER = ++YYCURSOR);",
          "513:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "508: #line 786 \"ext/standard/var_unserializer.re\"",
          "510: #line 511 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "499: #line 777 \"ext/standard/var_unserializer.re\"",
          "501: #line 502 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "550:  goto yy3;",
          "551: yy14:",
          "552:  ++YYCURSOR;",
          "554:  {",
          "556:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "558: }",
          "560: yy16:",
          "561:  yych = *++YYCURSOR;",
          "562:  goto yy3;",
          "",
          "[Removed Lines]",
          "553: #line 780 \"ext/standard/var_unserializer.re\"",
          "559: #line 560 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "544: #line 771 \"ext/standard/var_unserializer.re\"",
          "550: #line 551 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "586:  yych = *++YYCURSOR;",
          "587:  if (yych != '\"') goto yy18;",
          "588:  ++YYCURSOR;",
          "590:  {",
          "591:  size_t len, len2, len3, maxlen;",
          "592:  long elements;",
          "",
          "[Removed Lines]",
          "589: #line 641 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "580: #line 632 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "726:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "727: }",
          "729: yy25:",
          "730:  yych = *++YYCURSOR;",
          "731:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "728: #line 729 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "719: #line 720 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "750:  yych = *++YYCURSOR;",
          "751:  if (yych != '\"') goto yy18;",
          "752:  ++YYCURSOR;",
          "754:  {",
          "",
          "[Removed Lines]",
          "753: #line 633 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "744: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "758:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "759:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "760: }",
          "762: yy32:",
          "763:  yych = *++YYCURSOR;",
          "764:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "761: #line 762 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "752: #line 753 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "779:  yych = *++YYCURSOR;",
          "780:  if (yych != '{') goto yy18;",
          "781:  ++YYCURSOR;",
          "783:  {",
          "784:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "782: #line 615 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "773: #line 606 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "798:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "799: }",
          "801: yy39:",
          "802:  yych = *++YYCURSOR;",
          "803:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "800: #line 801 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "791: #line 792 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "818:  yych = *++YYCURSOR;",
          "819:  if (yych != '\"') goto yy18;",
          "820:  ++YYCURSOR;",
          "822:  {",
          "823:  size_t len, maxlen;",
          "824:  char *str;",
          "",
          "[Removed Lines]",
          "821: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "812: #line 577 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "847:  ZVAL_STRINGL(rval, str, len);",
          "848:  return 1;",
          "849: }",
          "851: yy46:",
          "852:  yych = *++YYCURSOR;",
          "853:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "850: #line 851 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "841: #line 842 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "868:  yych = *++YYCURSOR;",
          "869:  if (yych != '\"') goto yy18;",
          "870:  ++YYCURSOR;",
          "872:  {",
          "873:  size_t len, maxlen;",
          "874:  char *str;",
          "",
          "[Removed Lines]",
          "871: #line 559 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "862: #line 550 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "895:  ZVAL_STRINGL(rval, str, len);",
          "896:  return 1;",
          "897: }",
          "899: yy53:",
          "900:  yych = *++YYCURSOR;",
          "901:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "898: #line 899 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "889: #line 890 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "983:  }",
          "984: yy63:",
          "985:  ++YYCURSOR;",
          "987:  {",
          "988: #if SIZEOF_LONG == 4",
          "989: use_double:",
          "",
          "[Removed Lines]",
          "986: #line 550 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "977: #line 541 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "992:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "993:  return 1;",
          "994: }",
          "996: yy65:",
          "997:  yych = *++YYCURSOR;",
          "998:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "995: #line 996 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "986: #line 987 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1051:  yych = *++YYCURSOR;",
          "1052:  if (yych != ';') goto yy18;",
          "1053:  ++YYCURSOR;",
          "1055:  {",
          "",
          "[Removed Lines]",
          "1054: #line 534 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1045: #line 525 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1068:  return 1;",
          "1069: }",
          "1071: yy76:",
          "1072:  yych = *++YYCURSOR;",
          "1073:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1070: #line 1071 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1061: #line 1062 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1094:  if (yych <= '9') goto yy79;",
          "1095:  if (yych != ';') goto yy18;",
          "1096:  ++YYCURSOR;",
          "1098:  {",
          "1099: #if SIZEOF_LONG == 4",
          "1100:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1097: #line 508 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1088: #line 499 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1120:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1121:  return 1;",
          "1122: }",
          "1124: yy83:",
          "1125:  yych = *++YYCURSOR;",
          "1126:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1123: #line 1124 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "1128:  yych = *++YYCURSOR;",
          "1129:  if (yych != ';') goto yy18;",
          "1130:  ++YYCURSOR;",
          "1132:  {",
          "1134:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1135:  return 1;",
          "1136: }",
          "1138: yy87:",
          "1139:  ++YYCURSOR;",
          "1141:  {",
          "1143:  ZVAL_NULL(rval);",
          "1144:  return 1;",
          "1145: }",
          "1147: yy89:",
          "1148:  yych = *++YYCURSOR;",
          "1149:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1131: #line 502 \"ext/standard/var_unserializer.re\"",
          "1137: #line 1138 \"ext/standard/var_unserializer.c\"",
          "1140: #line 496 \"ext/standard/var_unserializer.re\"",
          "1146: #line 1147 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1122: #line 493 \"ext/standard/var_unserializer.re\"",
          "1128: #line 1129 \"ext/standard/var_unserializer.c\"",
          "1131: #line 487 \"ext/standard/var_unserializer.re\"",
          "1137: #line 1138 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "1166:  if (yych <= '9') goto yy91;",
          "1167:  if (yych != ';') goto yy18;",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1171:  long id;",
          "",
          "[Removed Lines]",
          "1169: #line 473 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1160: #line 464 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "1190:  return 1;",
          "1191: }",
          "1193: yy95:",
          "1194:  yych = *++YYCURSOR;",
          "1195:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1192: #line 1193 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1183: #line 1184 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "1212:  if (yych <= '9') goto yy97;",
          "1213:  if (yych != ';') goto yy18;",
          "1214:  ++YYCURSOR;",
          "1216:  {",
          "1217:  long id;",
          "",
          "[Removed Lines]",
          "1215: #line 453 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1206: #line 444 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "1233:  return 1;",
          "1234: }",
          "1236: }",
          "1240:  return 0;",
          "",
          "[Removed Lines]",
          "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
          "1237: #line 788 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1226: #line 1227 \"ext/standard/var_unserializer.c\"",
          "1228: #line 779 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "27: #define VAR_ENTRIES_DBG 0",
          "29: typedef struct {",
          "31:  long used_slots;",
          "32:  void *next;",
          "33: } var_entries;",
          "36: {",
          "37:  var_entries *var_hash = (*var_hashx)->last;",
          "38: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "30:  zval *data[VAR_ENTRIES_MAX];",
          "35: static inline void var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Added Lines]",
          "30:  zval data[VAR_ENTRIES_MAX];",
          "35: static inline zval *var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "53:   (*var_hashx)->last = var_hash;",
          "54:  }",
          "57: }",
          "59: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "56:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "56:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "57:  return &var_hash->data[var_hash->used_slots++];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "77:   (*var_hashx)->last_dtor = var_hash;",
          "78:  }",
          "82: }",
          "84: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "80:  Z_ADDREF_P(rval);",
          "81:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "81:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "82:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "102:   (*var_hashx)->last_dtor = var_hash;",
          "103:  }",
          "125: }",
          "127: static int var_access(php_unserialize_data_t *var_hashx, long id, zval **store)",
          "",
          "[Removed Lines]",
          "105:  var_hash->data[var_hash->used_slots++] = rval;",
          "106: }",
          "108: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "109: {",
          "110:  long i;",
          "111:  var_entries *var_hash = (*var_hashx)->first;",
          "112: #if VAR_ENTRIES_DBG",
          "113:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "114: #endif",
          "116:  while (var_hash) {",
          "117:   for (i = 0; i < var_hash->used_slots; i++) {",
          "118:    if (var_hash->data[i] == ozval) {",
          "119:     var_hash->data[i] = nzval;",
          "121:    }",
          "122:   }",
          "123:   var_hash = var_hash->next;",
          "124:  }",
          "",
          "[Added Lines]",
          "106:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "107:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "165:  while (var_hash) {",
          "166:   for (i = 0; i < var_hash->used_slots; i++) {",
          "168:   }",
          "169:   next = var_hash->next;",
          "170:   efree(var_hash);",
          "",
          "[Removed Lines]",
          "167:    zval_ptr_dtor(var_hash->data[i]);",
          "",
          "[Added Lines]",
          "150:    zval_ptr_dtor(&var_hash->data[i]);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "296: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long elements, int objprops)",
          "297: {",
          "298:  while (elements-- > 0) {",
          "303:    return 0;",
          "304:   }",
          "",
          "[Removed Lines]",
          "299:   zval key, data, *old_data;",
          "301:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "302:    zval_dtor(&key);",
          "",
          "[Added Lines]",
          "282:   zval key, *data, d, *old_data;",
          "284:   if (!php_var_unserialize_intern(&key, p, max, NULL TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "308:    return 0;",
          "309:   }",
          "313:    zval_dtor(&key);",
          "314:    return 0;",
          "315:   }",
          "",
          "[Removed Lines]",
          "311:   ZVAL_UNDEF(&data);",
          "312:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "293:   if (var_hash && (*p)[0] != 'R') {",
          "294:    data = var_push(var_hash, data);",
          "295:   } else {",
          "296:    data = &d;",
          "297:   }",
          "299:   ZVAL_UNDEF(data);",
          "300:   if (!php_var_unserialize_intern(data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "320:     if ((old_data = zend_hash_index_find(ht, Z_LVAL(key))) != NULL) {",
          "321:      var_push_dtor(var_hash, old_data);",
          "322:     }",
          "324:     break;",
          "325:    case IS_STRING:",
          "326:     if ((old_data = zend_symtable_find(ht, Z_STR(key))) != NULL) {",
          "327:      var_push_dtor(var_hash, old_data);",
          "328:     }",
          "330:     break;",
          "331:    }",
          "332:   } else {",
          "334:    convert_to_string(&key);",
          "336:   }",
          "338:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "323:     zend_hash_index_update(ht, Z_LVAL(key), &data);",
          "329:     zend_symtable_update(ht, Z_STR(key), &data);",
          "335:    zend_hash_update(ht, Z_STR(key), &data);",
          "",
          "[Added Lines]",
          "311:     zend_hash_index_update(ht, Z_LVAL(key), data);",
          "317:     zend_symtable_update(ht, Z_STR(key), data);",
          "323:    zend_hash_update(ht, Z_STR(key), data);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "429: #endif",
          "431: PHPAPI int php_var_unserialize(UNSERIALIZE_PARAMETER)",
          "432: {",
          "433:  const unsigned char *cursor, *limit, *marker, *start;",
          "434:  zval *rval_ref;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "420: {",
          "421:  if (var_hash && (*p)[0] != 'R') {",
          "422:   var_push(var_hash, rval);",
          "423:  }",
          "425:  return php_var_unserialize_intern(UNSERIALIZE_PASSTHRU);",
          "426: }",
          "428: PHPAPI int php_var_unserialize_intern(UNSERIALIZE_PARAMETER)",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "440:   return 0;",
          "441:  }",
          "447:  start = cursor;",
          "453: \"R:\" iv \";\"  {",
          "",
          "[Removed Lines]",
          "443:  if (var_hash && cursor[0] != 'R') {",
          "444:   var_push(var_hash, rval);",
          "445:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}