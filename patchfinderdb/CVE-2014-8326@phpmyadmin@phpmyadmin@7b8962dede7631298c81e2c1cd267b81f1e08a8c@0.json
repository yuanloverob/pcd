{
  "cve_id": "CVE-2014-8326",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.5, 4.1.x before 4.1.14.6, and 4.2.x before 4.2.10.1 allow remote authenticated users to inject arbitrary web script or HTML via a crafted (1) database name or (2) table name, related to the libraries/DatabaseInterface.class.php code for SQL debug output and the js/server_status_monitor.js code for the server monitor page.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "7b8962dede7631298c81e2c1cd267b81f1e08a8c",
  "patch_info": {
    "commit_hash": "7b8962dede7631298c81e2c1cd267b81f1e08a8c",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/7b8962dede7631298c81e2c1cd267b81f1e08a8c",
    "files": [
      "ChangeLog",
      "js/server_status_monitor.js"
    ],
    "message": "bug #4563 [security] XSS in monitor query analyzer\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
    "before_after_code_files": [
      "js/server_status_monitor.js||js/server_status_monitor.js"
    ]
  },
  "patch_diff": {
    "js/server_status_monitor.js||js/server_status_monitor.js": [
      "File: js/server_status_monitor.js -> js/server_status_monitor.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "1855:             if (name == 'user_host') {",
      "1856:                 return value.replace(/(\\[.*?\\])+/g, '');",
      "1857:             }",
      "1859:         };",
      "1861:         for (var i = 0, l = rows.length; i < l; i++) {",
      "",
      "[Removed Lines]",
      "1858:             return value;",
      "",
      "[Added Lines]",
      "1858:             return escapeHtml(value);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2011:             for (i = 0, l = data.explain.length; i < l; i++) {",
      "2012:                 explain += '<div class=\"explain-' + i + '\"' + (i > 0 ?  'style=\"display:none;\"' : '') + '>';",
      "2013:                 $.each(data.explain[i], function (key, value) {",
      "2016:                     if (key == 'type' && value.toLowerCase() == 'all') {",
      "2017:                         value = '<span class=\"attention\">' + value + '</span>';",
      "",
      "[Removed Lines]",
      "2014:                     value = (value === null) ? 'null' : value;",
      "",
      "[Added Lines]",
      "2014:                     value = (value === null) ? 'null' : escapeHtml(value);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a150ea1df477fcc9a79bbdf3f26b40d9e333bcf1",
      "candidate_info": {
        "commit_hash": "a150ea1df477fcc9a79bbdf3f26b40d9e333bcf1",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/a150ea1df477fcc9a79bbdf3f26b40d9e333bcf1",
        "files": [
          "ChangeLog",
          "js/server_status_monitor.js"
        ],
        "message": "bug #4563 [security] XSS in monitor query analyzer\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "js/server_status_monitor.js||js/server_status_monitor.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "js/server_status_monitor.js||js/server_status_monitor.js"
          ],
          "candidate": [
            "js/server_status_monitor.js||js/server_status_monitor.js"
          ]
        }
      },
      "candidate_diff": {
        "js/server_status_monitor.js||js/server_status_monitor.js": [
          "File: js/server_status_monitor.js -> js/server_status_monitor.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "1991:                 case 'user_host':",
          "1992:                     return value.replace(/(\\[.*?\\])+/g, '');",
          "1993:             }",
          "1995:         };",
          "1997:         for (var i = 0, l = rows.length; i < l; i++) {",
          "",
          "[Removed Lines]",
          "1994:             return value;",
          "",
          "[Added Lines]",
          "1994:             return escapeHtml(value);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2144:             for (var i = 0, l = data.explain.length; i < l; i++) {",
          "2145:                 explain += '<div class=\"explain-' + i + '\"' + (i>0? 'style=\"display:none;\"' : '' ) + '>';",
          "2146:                 $.each(data.explain[i], function(key, value) {",
          "2149:                     if (key == 'type' && value.toLowerCase() == 'all') {",
          "2150:                         value = '<span class=\"attention\">' + value + '</span>';",
          "",
          "[Removed Lines]",
          "2147:                     value = (value == null)?'null':value;",
          "",
          "[Added Lines]",
          "2147:                     value = (value == null)?'null': escapeHtml(value);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0092f608d37d0ce7acea30ec9e7e995ef1a6e06c",
      "candidate_info": {
        "commit_hash": "0092f608d37d0ce7acea30ec9e7e995ef1a6e06c",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/0092f608d37d0ce7acea30ec9e7e995ef1a6e06c",
        "files": [
          "ChangeLog",
          "js/server_status_monitor.js"
        ],
        "message": "bug #4563 [security] XSS in monitor query analyzer\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "js/server_status_monitor.js||js/server_status_monitor.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "js/server_status_monitor.js||js/server_status_monitor.js"
          ],
          "candidate": [
            "js/server_status_monitor.js||js/server_status_monitor.js"
          ]
        }
      },
      "candidate_diff": {
        "js/server_status_monitor.js||js/server_status_monitor.js": [
          "File: js/server_status_monitor.js -> js/server_status_monitor.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "1824:             if (name == 'user_host') {",
          "1825:                 return value.replace(/(\\[.*?\\])+/g, '');",
          "1826:             }",
          "1828:         };",
          "1830:         for (var i = 0, l = rows.length; i < l; i++) {",
          "",
          "[Removed Lines]",
          "1827:             return value;",
          "",
          "[Added Lines]",
          "1827:             return escapeHtml(value);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1980:             for (i = 0, l = data.explain.length; i < l; i++) {",
          "1981:                 explain += '<div class=\"explain-' + i + '\"' + (i > 0 ?  'style=\"display:none;\"' : '') + '>';",
          "1982:                 $.each(data.explain[i], function (key, value) {",
          "1985:                     if (key == 'type' && value.toLowerCase() == 'all') {",
          "1986:                         value = '<span class=\"attention\">' + value + '</span>';",
          "",
          "[Removed Lines]",
          "1983:                     value = (value === null) ? 'null' : value;",
          "",
          "[Added Lines]",
          "1983:                     value = (value === null) ? 'null' : escapeHtml(value);",
          "",
          "---------------"
        ]
      }
    }
  ]
}