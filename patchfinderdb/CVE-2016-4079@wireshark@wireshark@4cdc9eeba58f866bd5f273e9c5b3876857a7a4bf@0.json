{
  "cve_id": "CVE-2016-4079",
  "cve_desc": "epan/dissectors/packet-pktc.c in the PKTC dissector in Wireshark 1.12.x before 1.12.11 and 2.0.x before 2.0.3 does not verify BER identifiers, which allows remote attackers to cause a denial of service (out-of-bounds write and application crash) via a crafted packet.",
  "repo": "wireshark/wireshark",
  "patch_hash": "4cdc9eeba58f866bd5f273e9c5b3876857a7a4bf",
  "patch_info": {
    "commit_hash": "4cdc9eeba58f866bd5f273e9c5b3876857a7a4bf",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/4cdc9eeba58f866bd5f273e9c5b3876857a7a4bf",
    "files": [
      "epan/dissectors/packet-pktc.c"
    ],
    "message": "PKTC must be stricter with its Kerberos application choices.\n\nThe PKTC dissector calls the Kerberos dissector assuming certain application values.  Because different application values can have different \"private\" data, corruption can occur.\nEnsure the Kerberos application values match the preceding comments by checking the ber identifier before calling the Kerberos dissector.\n\nBug: 12206\nChange-Id: I9b04837f93a56681cae3816278315cf01da17544\nReviewed-on: https://code.wireshark.org/review/14520\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>",
    "before_after_code_files": [
      "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
    ]
  },
  "patch_diff": {
    "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c": [
      "File: epan/dissectors/packet-pktc.c -> epan/dissectors/packet-pktc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "36: #include <epan/to_str.h>",
      "37: #include <epan/asn1.h>",
      "38: #include \"packet-pktc.h\"",
      "39: #include \"packet-kerberos.h\"",
      "40: #include \"packet-snmp.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "39: #include \"packet-ber.h\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "96: static expert_field ei_pktc_unknown_kmmid = EI_INIT;",
      "97: static expert_field ei_pktc_unknown_doi = EI_INIT;",
      "99: #define KMMID_WAKEUP            0x01",
      "100: #define KMMID_AP_REQUEST        0x02",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "99: static expert_field ei_pktc_unknown_kerberos_application = EI_INIT;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "548:     proto_tree *pktc_mtafqdn_tree;",
      "549:     proto_item *item;",
      "550:     tvbuff_t *pktc_mtafqdn_tvb;",
      "552:     col_set_str(pinfo->cinfo, COL_PROTOCOL, \"PKTC\");",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "553:     gint8              ber_class;",
      "554:     gboolean           pc;",
      "555:     gint32             tag;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "561:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
      "565:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
      "568:     proto_item_set_len(item, offset);",
      "569:     return tvb_captured_length(tvb);",
      "",
      "[Removed Lines]",
      "562:     offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
      "566:     offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
      "",
      "[Added Lines]",
      "567:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
      "568:     if ((tag == 10) || (tag == 11)) {",
      "569:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
      "570:     } else {",
      "571:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected 10 or 11\", tag);",
      "572:         return tvb_captured_length(tvb);",
      "573:     }",
      "577:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
      "578:     if (tag == 20) {",
      "579:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
      "580:     } else {",
      "581:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected 20\", tag);",
      "582:     }",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "776:     static ei_register_info ei[] = {",
      "777:         { &ei_pktc_unknown_kmmid, { \"pktc.mtafqdn.unknown_kmmid\", PI_PROTOCOL, PI_WARN, \"Unknown KMMID\", EXPFILL }},",
      "778:         { &ei_pktc_unknown_doi, { \"pktc.mtafqdn.unknown_doi\", PI_PROTOCOL, PI_WARN, \"Unknown DOI\", EXPFILL }},",
      "779:     };",
      "781:     expert_module_t* expert_pktc;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "795:         { &ei_pktc_unknown_kerberos_application, { \"pktc.mtafqdn.unknown_kerberos_application\", PI_PROTOCOL, PI_WARN, \"Unknown Kerberos application\", EXPFILL }},",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "14709e9a8f584a6f15affbfaa1164407b79a38f7",
      "candidate_info": {
        "commit_hash": "14709e9a8f584a6f15affbfaa1164407b79a38f7",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/14709e9a8f584a6f15affbfaa1164407b79a38f7",
        "files": [
          "asn1/kerberos/kerberos.cnf",
          "epan/dissectors/packet-kerberos.c",
          "epan/dissectors/packet-kerberos.h",
          "epan/dissectors/packet-pktc.c"
        ],
        "message": "PKTC must be stricter with its Kerberos application choices.\n\nThe PKTC dissector calls the Kerberos dissector assuming certain application values.  Because different application values can have different \"private\" data, corruption can occur.\nEnsure the Kerberos application values match the preceding comments by checking the ber identifier before calling the Kerberos dissector.\n\n(cherry picked from commit 4cdc9eeba58f866bd5f273e9c5b3876857a7a4bf)\n\n(cherry picked from commit 44469711f8310a53f39f535b0ad54cbb3d1fec9e)\n\nBug: 12206\nChange-Id: I5ffd94d86f0a4689169c47b58662988c5b8e433d\nReviewed-on: https://code.wireshark.org/review/14541\nReviewed-by: Michael Mann <mmann78@netscape.net>\nReviewed-on: https://code.wireshark.org/review/15447\nReviewed-by: Balint Reczey <balint@balintreczey.hu>",
        "before_after_code_files": [
          "asn1/kerberos/kerberos.cnf||asn1/kerberos/kerberos.cnf",
          "epan/dissectors/packet-kerberos.c||epan/dissectors/packet-kerberos.c",
          "epan/dissectors/packet-kerberos.h||epan/dissectors/packet-kerberos.h",
          "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
          ],
          "candidate": [
            "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/kerberos/kerberos.cnf||asn1/kerberos/kerberos.cnf": [
          "File: asn1/kerberos/kerberos.cnf -> asn1/kerberos/kerberos.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #.EXPORTS",
          "6: ChangePasswdData",
          "8: #.FIELD_RENAME",
          "9: #EncryptedData/etype encryptedData_etype",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: Applications ONLY_ENUM",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "62: #.MAKE_DEFINES",
          "63: ADDR-TYPE TYPE_PREFIX",
          "65: #.FN_BODY MESSAGE-TYPE VAL_PTR = &msgtype",
          "66: guint32 msgtype;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "65: Applications TYPE_PREFIX",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-kerberos.c||epan/dissectors/packet-kerberos.c": [
          "File: epan/dissectors/packet-kerberos.c -> epan/dissectors/packet-kerberos.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3722: static const ber_choice_t Applications_choice[] = {",
          "3741:   { 0, NULL, 0, 0, 0, NULL }",
          "3742: };",
          "",
          "[Removed Lines]",
          "3723:   {   1, &hf_kerberos_ticket     , BER_CLASS_APP, 1, BER_FLAGS_NOOWNTAG, dissect_kerberos_Ticket },",
          "3724:   {   2, &hf_kerberos_authenticator, BER_CLASS_APP, 2, BER_FLAGS_NOOWNTAG, dissect_kerberos_Authenticator },",
          "3725:   {   3, &hf_kerberos_encTicketPart, BER_CLASS_APP, 3, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTicketPart },",
          "3726:   {  10, &hf_kerberos_as_req     , BER_CLASS_APP, 10, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REQ },",
          "3727:   {  11, &hf_kerberos_as_rep     , BER_CLASS_APP, 11, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REP },",
          "3728:   {  12, &hf_kerberos_tgs_req    , BER_CLASS_APP, 12, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REQ },",
          "3729:   {  13, &hf_kerberos_tgs_rep    , BER_CLASS_APP, 13, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REP },",
          "3730:   {  14, &hf_kerberos_ap_req     , BER_CLASS_APP, 14, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REQ },",
          "3731:   {  15, &hf_kerberos_ap_rep     , BER_CLASS_APP, 15, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REP },",
          "3732:   {  20, &hf_kerberos_krb_safe   , BER_CLASS_APP, 20, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_SAFE },",
          "3733:   {  21, &hf_kerberos_krb_priv   , BER_CLASS_APP, 21, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_PRIV },",
          "3734:   {  22, &hf_kerberos_krb_cred   , BER_CLASS_APP, 22, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_CRED },",
          "3735:   {  25, &hf_kerberos_encASRepPart, BER_CLASS_APP, 25, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncASRepPart },",
          "3736:   {  26, &hf_kerberos_encTGSRepPart, BER_CLASS_APP, 26, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTGSRepPart },",
          "3737:   {  27, &hf_kerberos_encAPRepPart, BER_CLASS_APP, 27, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncAPRepPart },",
          "3738:   {  28, &hf_kerberos_encKrbPrivPart, BER_CLASS_APP, 28, BER_FLAGS_NOOWNTAG, dissect_kerberos_ENC_KRB_PRIV_PART },",
          "3739:   {  29, &hf_kerberos_encKrbCredPart, BER_CLASS_APP, 29, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncKrbCredPart },",
          "3740:   {  30, &hf_kerberos_krb_error  , BER_CLASS_APP, 30, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_ERROR },",
          "",
          "[Added Lines]",
          "3723:   { KERBEROS_APPLICATIONS_TICKET, &hf_kerberos_ticket     , BER_CLASS_APP, 1, BER_FLAGS_NOOWNTAG, dissect_kerberos_Ticket },",
          "3724:   { KERBEROS_APPLICATIONS_AUTHENTICATOR, &hf_kerberos_authenticator, BER_CLASS_APP, 2, BER_FLAGS_NOOWNTAG, dissect_kerberos_Authenticator },",
          "3725:   { KERBEROS_APPLICATIONS_ENCTICKETPART, &hf_kerberos_encTicketPart, BER_CLASS_APP, 3, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTicketPart },",
          "3726:   { KERBEROS_APPLICATIONS_AS_REQ, &hf_kerberos_as_req     , BER_CLASS_APP, 10, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REQ },",
          "3727:   { KERBEROS_APPLICATIONS_AS_REP, &hf_kerberos_as_rep     , BER_CLASS_APP, 11, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REP },",
          "3728:   { KERBEROS_APPLICATIONS_TGS_REQ, &hf_kerberos_tgs_req    , BER_CLASS_APP, 12, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REQ },",
          "3729:   { KERBEROS_APPLICATIONS_TGS_REP, &hf_kerberos_tgs_rep    , BER_CLASS_APP, 13, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REP },",
          "3730:   { KERBEROS_APPLICATIONS_AP_REQ, &hf_kerberos_ap_req     , BER_CLASS_APP, 14, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REQ },",
          "3731:   { KERBEROS_APPLICATIONS_AP_REP, &hf_kerberos_ap_rep     , BER_CLASS_APP, 15, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REP },",
          "3732:   { KERBEROS_APPLICATIONS_KRB_SAFE, &hf_kerberos_krb_safe   , BER_CLASS_APP, 20, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_SAFE },",
          "3733:   { KERBEROS_APPLICATIONS_KRB_PRIV, &hf_kerberos_krb_priv   , BER_CLASS_APP, 21, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_PRIV },",
          "3734:   { KERBEROS_APPLICATIONS_KRB_CRED, &hf_kerberos_krb_cred   , BER_CLASS_APP, 22, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_CRED },",
          "3735:   { KERBEROS_APPLICATIONS_ENCASREPPART, &hf_kerberos_encASRepPart, BER_CLASS_APP, 25, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncASRepPart },",
          "3736:   { KERBEROS_APPLICATIONS_ENCTGSREPPART, &hf_kerberos_encTGSRepPart, BER_CLASS_APP, 26, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTGSRepPart },",
          "3737:   { KERBEROS_APPLICATIONS_ENCAPREPPART, &hf_kerberos_encAPRepPart, BER_CLASS_APP, 27, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncAPRepPart },",
          "3738:   { KERBEROS_APPLICATIONS_ENCKRBPRIVPART, &hf_kerberos_encKrbPrivPart, BER_CLASS_APP, 28, BER_FLAGS_NOOWNTAG, dissect_kerberos_ENC_KRB_PRIV_PART },",
          "3739:   { KERBEROS_APPLICATIONS_ENCKRBCREDPART, &hf_kerberos_encKrbCredPart, BER_CLASS_APP, 29, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncKrbCredPart },",
          "3740:   { KERBEROS_APPLICATIONS_KRB_ERROR, &hf_kerberos_krb_error  , BER_CLASS_APP, 30, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_ERROR },",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-kerberos.h||epan/dissectors/packet-kerberos.h": [
          "File: epan/dissectors/packet-kerberos.h -> epan/dissectors/packet-kerberos.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "107: #line 1 \"../../asn1/kerberos/packet-kerberos-exp.h\"",
          "108: int dissect_kerberos_ChangePasswdData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "110: #define KERBEROS_APPLICATIONS_TICKET   1",
          "111: #define KERBEROS_APPLICATIONS_AUTHENTICATOR   2",
          "112: #define KERBEROS_APPLICATIONS_ENCTICKETPART   3",
          "113: #define KERBEROS_APPLICATIONS_AS_REQ  10",
          "114: #define KERBEROS_APPLICATIONS_AS_REP  11",
          "115: #define KERBEROS_APPLICATIONS_TGS_REQ  12",
          "116: #define KERBEROS_APPLICATIONS_TGS_REP  13",
          "117: #define KERBEROS_APPLICATIONS_AP_REQ  14",
          "118: #define KERBEROS_APPLICATIONS_AP_REP  15",
          "119: #define KERBEROS_APPLICATIONS_KRB_SAFE  20",
          "120: #define KERBEROS_APPLICATIONS_KRB_PRIV  21",
          "121: #define KERBEROS_APPLICATIONS_KRB_CRED  22",
          "122: #define KERBEROS_APPLICATIONS_ENCASREPPART  25",
          "123: #define KERBEROS_APPLICATIONS_ENCTGSREPPART  26",
          "124: #define KERBEROS_APPLICATIONS_ENCAPREPPART  27",
          "125: #define KERBEROS_APPLICATIONS_ENCKRBPRIVPART  28",
          "126: #define KERBEROS_APPLICATIONS_ENCKRBCREDPART  29",
          "127: #define KERBEROS_APPLICATIONS_KRB_ERROR  30",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c": [
          "File: epan/dissectors/packet-pktc.c -> epan/dissectors/packet-pktc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: #include <epan/packet.h>",
          "34: #include <epan/exceptions.h>",
          "35: #include <epan/to_str.h>",
          "36: #include <epan/asn1.h>",
          "37: #include \"packet-pktc.h\"",
          "38: #include \"packet-kerberos.h\"",
          "39: #include \"packet-snmp.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: #include <epan/expert.h>",
          "39: #include \"packet-ber.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "91: static gint ett_pktc_mtafqdn = -1;",
          "99: static const value_string kmmid_types[] = {",
          "100:     { KMMID_WAKEUP  , \"Wake Up\" },",
          "101:     { KMMID_AP_REQUEST  , \"AP Request\" },",
          "",
          "[Removed Lines]",
          "93: #define KMMID_WAKEUP  0x01",
          "94: #define KMMID_AP_REQUEST 0x02",
          "95: #define KMMID_AP_REPLY  0x03",
          "96: #define KMMID_SEC_PARAM_REC 0x04",
          "97: #define KMMID_REKEY  0x05",
          "98: #define KMMID_ERROR_REPLY 0x06",
          "",
          "[Added Lines]",
          "95: static expert_field ei_pktc_unknown_kerberos_application = EI_INIT;",
          "97: #define KMMID_WAKEUP            0x01",
          "98: #define KMMID_AP_REQUEST        0x02",
          "99: #define KMMID_AP_REPLY          0x03",
          "100: #define KMMID_SEC_PARAM_REC     0x04",
          "101: #define KMMID_REKEY             0x05",
          "102: #define KMMID_ERROR_REPLY       0x06",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "553:     proto_tree *pktc_mtafqdn_tree = NULL;",
          "554:     proto_item *item = NULL;",
          "555:     tvbuff_t *pktc_mtafqdn_tvb;",
          "557:     col_set_str(pinfo->cinfo, COL_PROTOCOL, \"PKTC\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "561:     gint8              ber_class;",
          "562:     gboolean           pc;",
          "563:     gint32             tag;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "568:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
          "572:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
          "575:     proto_item_set_len(item, offset);",
          "576: }",
          "",
          "[Removed Lines]",
          "569:     offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
          "573:     offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
          "",
          "[Added Lines]",
          "577:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
          "578:     if ((tag == KERBEROS_APPLICATIONS_AP_REQ) || (tag == KERBEROS_APPLICATIONS_AP_REP)) {",
          "579:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
          "580:     } else {",
          "581:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected KRB_AP_RE[QP]\", tag);",
          "582:         return;",
          "583:     }",
          "587:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
          "588:     if (tag == KERBEROS_APPLICATIONS_KRB_SAFE) {",
          "589:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
          "590:     } else {",
          "591:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected KRB_SAFE\", tag);",
          "592:     }",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "780:         &ett_pktc_mtafqdn,",
          "781:     };",
          "783:     proto_register_field_array(proto_pktc, hf, array_length(hf));",
          "784:     proto_register_subtree_array(ett, array_length(ett));",
          "785: }",
          "787: void",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "802:     static ei_register_info ei[] = {",
          "803:         { &ei_pktc_unknown_kerberos_application, { \"pktc.mtafqdn.unknown_kerberos_application\", PI_PROTOCOL, PI_WARN, \"Unknown Kerberos application\", EXPFILL }},",
          "804:     };",
          "806:     expert_module_t* expert_pktc;",
          "810:     expert_pktc = expert_register_protocol(proto_pktc);",
          "811:     expert_register_field_array(expert_pktc, ei, array_length(ei));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "44469711f8310a53f39f535b0ad54cbb3d1fec9e",
      "candidate_info": {
        "commit_hash": "44469711f8310a53f39f535b0ad54cbb3d1fec9e",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/44469711f8310a53f39f535b0ad54cbb3d1fec9e",
        "files": [
          "asn1/kerberos/kerberos.cnf",
          "epan/dissectors/packet-kerberos.c",
          "epan/dissectors/packet-kerberos.h",
          "epan/dissectors/packet-pktc.c"
        ],
        "message": "PKTC must be stricter with its Kerberos application choices.\n\nThe PKTC dissector calls the Kerberos dissector assuming certain application values.  Because different application values can have different \"private\" data, corruption can occur.\nEnsure the Kerberos application values match the preceding comments by checking the ber identifier before calling the Kerberos dissector.\n\n# Conflicts:\n#\tepan/dissectors/packet-kerberos.c\n#\tepan/dissectors/packet-pktc.c\n\n(cherry picked from commit 4cdc9eeba58f866bd5f273e9c5b3876857a7a4bf)\n\nBug: 12206\nChange-Id: I5ffd94d86f0a4689169c47b58662988c5b8e433d\nReviewed-on: https://code.wireshark.org/review/14541\nReviewed-by: Michael Mann <mmann78@netscape.net>",
        "before_after_code_files": [
          "asn1/kerberos/kerberos.cnf||asn1/kerberos/kerberos.cnf",
          "epan/dissectors/packet-kerberos.c||epan/dissectors/packet-kerberos.c",
          "epan/dissectors/packet-kerberos.h||epan/dissectors/packet-kerberos.h",
          "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
          ],
          "candidate": [
            "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/kerberos/kerberos.cnf||asn1/kerberos/kerberos.cnf": [
          "File: asn1/kerberos/kerberos.cnf -> asn1/kerberos/kerberos.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #.EXPORTS",
          "6: ChangePasswdData",
          "8: #.FIELD_RENAME",
          "9: #EncryptedData/etype encryptedData_etype",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: Applications ONLY_ENUM",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "62: #.MAKE_DEFINES",
          "63: ADDR-TYPE TYPE_PREFIX",
          "65: #.FN_BODY MESSAGE-TYPE VAL_PTR = &msgtype",
          "66: guint32 msgtype;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "65: Applications TYPE_PREFIX",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-kerberos.c||epan/dissectors/packet-kerberos.c": [
          "File: epan/dissectors/packet-kerberos.c -> epan/dissectors/packet-kerberos.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2030: static int",
          "2031: dissect_kerberos_ENCTYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2033:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2034:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2035:                                                 &(private_data->etype));",
          "",
          "[Removed Lines]",
          "2032: #line 223 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2032: #line 225 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2055: static int",
          "2056: dissect_kerberos_T_encryptedTicketData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2058: #ifdef HAVE_KERBEROS",
          "2059:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_ticket_data);",
          "2060: #else",
          "",
          "[Removed Lines]",
          "2057: #line 227 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2057: #line 229 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2139: static int",
          "2140: dissect_kerberos_CKSUMTYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2142:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2143:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2144:                                                 &(private_data->checksum_type));",
          "",
          "[Removed Lines]",
          "2141: #line 284 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2141: #line 286 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2154: static int",
          "2155: dissect_kerberos_T_checksum(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2157:  tvbuff_t *next_tvb;",
          "2158:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "2156: #line 288 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2156: #line 290 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2221: static int",
          "2222: dissect_kerberos_T_keytype(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2224:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2226:  offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "",
          "[Removed Lines]",
          "2223: #line 302 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2223: #line 304 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2237: static int",
          "2238: dissect_kerberos_T_keyvalue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2240:  tvbuff_t *out_tvb;",
          "2241:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "2239: #line 309 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2239: #line 311 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2262: static int",
          "2263: dissect_kerberos_EncryptionKey(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2265:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2267:    offset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,",
          "",
          "[Removed Lines]",
          "2264: #line 318 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2264: #line 320 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2284: static int",
          "2285: dissect_kerberos_T_ad_type(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2287:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2288:  offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2289:          &(private_data->ad_type));",
          "",
          "[Removed Lines]",
          "2286: #line 329 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2286: #line 331 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2298: static int",
          "2299: dissect_kerberos_T_ad_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2301:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2303:  switch(private_data->ad_type){",
          "",
          "[Removed Lines]",
          "2300: #line 334 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2300: #line 336 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "2444: static int",
          "2445: dissect_kerberos_ADDR_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2447:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2448:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2449:                                                 &(private_data->addr_type));",
          "",
          "[Removed Lines]",
          "2446: #line 345 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2446: #line 347 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "2459: static int",
          "2460: dissect_kerberos_T_address(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2462:  gint8 appclass;",
          "2463:  gboolean pc;",
          "2464:  gint32 tag;",
          "",
          "[Removed Lines]",
          "2461: #line 172 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2461: #line 174 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "2592: static int",
          "2593: dissect_kerberos_MESSAGE_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2595: guint32 msgtype;",
          "2597:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "",
          "[Removed Lines]",
          "2594: #line 66 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2594: #line 68 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "2604:  if (gbl_do_col_info) {",
          "2605:   col_add_str(actx->pinfo->cinfo, COL_INFO,",
          "2606:    val_to_str(msgtype, krb5_msg_types,",
          "",
          "[Removed Lines]",
          "2603: #line 71 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2603: #line 73 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "2663: static int",
          "2664: dissect_kerberos_PADATA_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2666:  kerberos_private_data_t* private_data = kerberos_get_private_data(actx);",
          "2667:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2668:                                                 &(private_data->padata_type));",
          "2673:  if(tree){",
          "2674:   proto_item_append_text(tree, \" %s\",",
          "2675:    val_to_str(private_data->padata_type, krb5_preauthentication_types,",
          "",
          "[Removed Lines]",
          "2665: #line 119 \"../../asn1/kerberos/kerberos.cnf\"",
          "2672: #line 122 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2665: #line 121 \"../../asn1/kerberos/kerberos.cnf\"",
          "2672: #line 124 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "2685: static int",
          "2686: dissect_kerberos_T_padata_value(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2688:  proto_tree *sub_tree=tree;",
          "2689:  kerberos_private_data_t* private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "2687: #line 129 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2687: #line 131 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "2812: static int",
          "2813: dissect_kerberos_T_encryptedAuthorizationData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2815: #ifdef HAVE_KERBEROS",
          "2816:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_authenticator_data);",
          "2817: #else",
          "",
          "[Removed Lines]",
          "2814: #line 235 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2814: #line 237 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "2875: static int",
          "2876: dissect_kerberos_KDC_REQ_BODY(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2878:  conversation_t *conversation;",
          "",
          "[Removed Lines]",
          "2877: #line 349 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2877: #line 351 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "2936: static int",
          "2937: dissect_kerberos_T_encryptedKDCREPData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2939: #ifdef HAVE_KERBEROS",
          "2940:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_KDC_REP_data);",
          "2941: #else",
          "",
          "[Removed Lines]",
          "2938: #line 243 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2938: #line 245 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "3066: static int",
          "3067: dissect_kerberos_T_encryptedAPREPData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3069: #ifdef HAVE_KERBEROS",
          "3070:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_AP_REP_data);",
          "3071: #else",
          "",
          "[Removed Lines]",
          "3068: #line 259 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3068: #line 261 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "3127: static int",
          "3128: dissect_kerberos_T_kRB_SAFE_BODY_user_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3130:  tvbuff_t *new_tvb;",
          "3131:  offset=dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &new_tvb);",
          "3132:  if (new_tvb) {",
          "",
          "[Removed Lines]",
          "3129: #line 372 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3129: #line 374 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "3189: static int",
          "3190: dissect_kerberos_T_encryptedKrbPrivData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3192: #ifdef HAVE_KERBEROS",
          "3193:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_PRIV_data);",
          "3194: #else",
          "",
          "[Removed Lines]",
          "3191: #line 267 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3191: #line 269 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "3250: static int",
          "3251: dissect_kerberos_T_encryptedKrbCredData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3253: #ifdef HAVE_KERBEROS",
          "3254:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_CRED_data);",
          "3255: #else",
          "",
          "[Removed Lines]",
          "3252: #line 275 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3252: #line 277 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "3449: static int",
          "3450: dissect_kerberos_T_encKrbPrivPart_user_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3452:  tvbuff_t *new_tvb;",
          "3453:  offset=dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &new_tvb);",
          "3454:  if (new_tvb) {",
          "",
          "[Removed Lines]",
          "3451: #line 379 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3451: #line 381 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "3632: static int",
          "3633: dissect_kerberos_ERROR_CODE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3635:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "3636:                                                 &krb5_errorcode);",
          "3642:  if(krb5_errorcode) {",
          "3643:   col_add_fstr(actx->pinfo->cinfo, COL_INFO,",
          "3644:    \"KRB Error: %s\",",
          "",
          "[Removed Lines]",
          "3634: #line 84 \"../../asn1/kerberos/kerberos.cnf\"",
          "3641: #line 87 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3634: #line 86 \"../../asn1/kerberos/kerberos.cnf\"",
          "3641: #line 89 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "3656: static int",
          "3657: dissect_kerberos_T_e_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3659:  switch(krb5_errorcode){",
          "3660:  case KRB5_ET_KRB5KDC_ERR_BADOPTION:",
          "3661:  case KRB5_ET_KRB5KDC_ERR_CLIENT_REVOKED:",
          "",
          "[Removed Lines]",
          "3658: #line 97 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3658: #line 99 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "3723: static const ber_choice_t Applications_choice[] = {",
          "3742:   { 0, NULL, 0, 0, 0, NULL }",
          "3743: };",
          "",
          "[Removed Lines]",
          "3724:   {   1, &hf_kerberos_ticket     , BER_CLASS_APP, 1, BER_FLAGS_NOOWNTAG, dissect_kerberos_Ticket },",
          "3725:   {   2, &hf_kerberos_authenticator, BER_CLASS_APP, 2, BER_FLAGS_NOOWNTAG, dissect_kerberos_Authenticator },",
          "3726:   {   3, &hf_kerberos_encTicketPart, BER_CLASS_APP, 3, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTicketPart },",
          "3727:   {  10, &hf_kerberos_as_req     , BER_CLASS_APP, 10, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REQ },",
          "3728:   {  11, &hf_kerberos_as_rep     , BER_CLASS_APP, 11, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REP },",
          "3729:   {  12, &hf_kerberos_tgs_req    , BER_CLASS_APP, 12, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REQ },",
          "3730:   {  13, &hf_kerberos_tgs_rep    , BER_CLASS_APP, 13, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REP },",
          "3731:   {  14, &hf_kerberos_ap_req     , BER_CLASS_APP, 14, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REQ },",
          "3732:   {  15, &hf_kerberos_ap_rep     , BER_CLASS_APP, 15, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REP },",
          "3733:   {  20, &hf_kerberos_krb_safe   , BER_CLASS_APP, 20, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_SAFE },",
          "3734:   {  21, &hf_kerberos_krb_priv   , BER_CLASS_APP, 21, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_PRIV },",
          "3735:   {  22, &hf_kerberos_krb_cred   , BER_CLASS_APP, 22, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_CRED },",
          "3736:   {  25, &hf_kerberos_encASRepPart, BER_CLASS_APP, 25, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncASRepPart },",
          "3737:   {  26, &hf_kerberos_encTGSRepPart, BER_CLASS_APP, 26, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTGSRepPart },",
          "3738:   {  27, &hf_kerberos_encAPRepPart, BER_CLASS_APP, 27, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncAPRepPart },",
          "3739:   {  28, &hf_kerberos_encKrbPrivPart, BER_CLASS_APP, 28, BER_FLAGS_NOOWNTAG, dissect_kerberos_ENC_KRB_PRIV_PART },",
          "3740:   {  29, &hf_kerberos_encKrbCredPart, BER_CLASS_APP, 29, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncKrbCredPart },",
          "3741:   {  30, &hf_kerberos_krb_error  , BER_CLASS_APP, 30, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_ERROR },",
          "",
          "[Added Lines]",
          "3724:   { KERBEROS_APPLICATIONS_TICKET, &hf_kerberos_ticket     , BER_CLASS_APP, 1, BER_FLAGS_NOOWNTAG, dissect_kerberos_Ticket },",
          "3725:   { KERBEROS_APPLICATIONS_AUTHENTICATOR, &hf_kerberos_authenticator, BER_CLASS_APP, 2, BER_FLAGS_NOOWNTAG, dissect_kerberos_Authenticator },",
          "3726:   { KERBEROS_APPLICATIONS_ENCTICKETPART, &hf_kerberos_encTicketPart, BER_CLASS_APP, 3, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTicketPart },",
          "3727:   { KERBEROS_APPLICATIONS_AS_REQ, &hf_kerberos_as_req     , BER_CLASS_APP, 10, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REQ },",
          "3728:   { KERBEROS_APPLICATIONS_AS_REP, &hf_kerberos_as_rep     , BER_CLASS_APP, 11, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REP },",
          "3729:   { KERBEROS_APPLICATIONS_TGS_REQ, &hf_kerberos_tgs_req    , BER_CLASS_APP, 12, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REQ },",
          "3730:   { KERBEROS_APPLICATIONS_TGS_REP, &hf_kerberos_tgs_rep    , BER_CLASS_APP, 13, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REP },",
          "3731:   { KERBEROS_APPLICATIONS_AP_REQ, &hf_kerberos_ap_req     , BER_CLASS_APP, 14, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REQ },",
          "3732:   { KERBEROS_APPLICATIONS_AP_REP, &hf_kerberos_ap_rep     , BER_CLASS_APP, 15, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REP },",
          "3733:   { KERBEROS_APPLICATIONS_KRB_SAFE, &hf_kerberos_krb_safe   , BER_CLASS_APP, 20, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_SAFE },",
          "3734:   { KERBEROS_APPLICATIONS_KRB_PRIV, &hf_kerberos_krb_priv   , BER_CLASS_APP, 21, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_PRIV },",
          "3735:   { KERBEROS_APPLICATIONS_KRB_CRED, &hf_kerberos_krb_cred   , BER_CLASS_APP, 22, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_CRED },",
          "3736:   { KERBEROS_APPLICATIONS_ENCASREPPART, &hf_kerberos_encASRepPart, BER_CLASS_APP, 25, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncASRepPart },",
          "3737:   { KERBEROS_APPLICATIONS_ENCTGSREPPART, &hf_kerberos_encTGSRepPart, BER_CLASS_APP, 26, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTGSRepPart },",
          "3738:   { KERBEROS_APPLICATIONS_ENCAPREPPART, &hf_kerberos_encAPRepPart, BER_CLASS_APP, 27, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncAPRepPart },",
          "3739:   { KERBEROS_APPLICATIONS_ENCKRBPRIVPART, &hf_kerberos_encKrbPrivPart, BER_CLASS_APP, 28, BER_FLAGS_NOOWNTAG, dissect_kerberos_ENC_KRB_PRIV_PART },",
          "3740:   { KERBEROS_APPLICATIONS_ENCKRBCREDPART, &hf_kerberos_encKrbCredPart, BER_CLASS_APP, 29, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncKrbCredPart },",
          "3741:   { KERBEROS_APPLICATIONS_KRB_ERROR, &hf_kerberos_krb_error  , BER_CLASS_APP, 30, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_ERROR },",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "3756: static int",
          "3757: dissect_kerberos_T_pA_ENC_TIMESTAMP_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3759: #ifdef HAVE_KERBEROS",
          "3760:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_PA_ENC_TIMESTAMP);",
          "3761: #else",
          "",
          "[Removed Lines]",
          "3758: #line 251 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3758: #line 253 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-kerberos.h||epan/dissectors/packet-kerberos.h": [
          "File: epan/dissectors/packet-kerberos.h -> epan/dissectors/packet-kerberos.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "107: #line 1 \"../../asn1/kerberos/packet-kerberos-exp.h\"",
          "108: int dissect_kerberos_ChangePasswdData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "110: #define KERBEROS_APPLICATIONS_TICKET   1",
          "111: #define KERBEROS_APPLICATIONS_AUTHENTICATOR   2",
          "112: #define KERBEROS_APPLICATIONS_ENCTICKETPART   3",
          "113: #define KERBEROS_APPLICATIONS_AS_REQ  10",
          "114: #define KERBEROS_APPLICATIONS_AS_REP  11",
          "115: #define KERBEROS_APPLICATIONS_TGS_REQ  12",
          "116: #define KERBEROS_APPLICATIONS_TGS_REP  13",
          "117: #define KERBEROS_APPLICATIONS_AP_REQ  14",
          "118: #define KERBEROS_APPLICATIONS_AP_REP  15",
          "119: #define KERBEROS_APPLICATIONS_KRB_SAFE  20",
          "120: #define KERBEROS_APPLICATIONS_KRB_PRIV  21",
          "121: #define KERBEROS_APPLICATIONS_KRB_CRED  22",
          "122: #define KERBEROS_APPLICATIONS_ENCASREPPART  25",
          "123: #define KERBEROS_APPLICATIONS_ENCTGSREPPART  26",
          "124: #define KERBEROS_APPLICATIONS_ENCAPREPPART  27",
          "125: #define KERBEROS_APPLICATIONS_ENCKRBPRIVPART  28",
          "126: #define KERBEROS_APPLICATIONS_ENCKRBCREDPART  29",
          "127: #define KERBEROS_APPLICATIONS_KRB_ERROR  30",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c": [
          "File: epan/dissectors/packet-pktc.c -> epan/dissectors/packet-pktc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: #include <epan/packet.h>",
          "34: #include <epan/exceptions.h>",
          "35: #include <epan/to_str.h>",
          "36: #include <epan/asn1.h>",
          "37: #include \"packet-pktc.h\"",
          "38: #include \"packet-kerberos.h\"",
          "39: #include \"packet-snmp.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: #include <epan/expert.h>",
          "39: #include \"packet-ber.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "91: static gint ett_pktc_mtafqdn = -1;",
          "99: static const value_string kmmid_types[] = {",
          "100:     { KMMID_WAKEUP  , \"Wake Up\" },",
          "101:     { KMMID_AP_REQUEST  , \"AP Request\" },",
          "",
          "[Removed Lines]",
          "93: #define KMMID_WAKEUP  0x01",
          "94: #define KMMID_AP_REQUEST 0x02",
          "95: #define KMMID_AP_REPLY  0x03",
          "96: #define KMMID_SEC_PARAM_REC 0x04",
          "97: #define KMMID_REKEY  0x05",
          "98: #define KMMID_ERROR_REPLY 0x06",
          "",
          "[Added Lines]",
          "95: static expert_field ei_pktc_unknown_kerberos_application = EI_INIT;",
          "97: #define KMMID_WAKEUP            0x01",
          "98: #define KMMID_AP_REQUEST        0x02",
          "99: #define KMMID_AP_REPLY          0x03",
          "100: #define KMMID_SEC_PARAM_REC     0x04",
          "101: #define KMMID_REKEY             0x05",
          "102: #define KMMID_ERROR_REPLY       0x06",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "553:     proto_tree *pktc_mtafqdn_tree = NULL;",
          "554:     proto_item *item = NULL;",
          "555:     tvbuff_t *pktc_mtafqdn_tvb;",
          "557:     col_set_str(pinfo->cinfo, COL_PROTOCOL, \"PKTC\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "561:     gint8              ber_class;",
          "562:     gboolean           pc;",
          "563:     gint32             tag;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "568:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
          "572:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
          "575:     proto_item_set_len(item, offset);",
          "576: }",
          "",
          "[Removed Lines]",
          "569:     offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
          "573:     offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
          "",
          "[Added Lines]",
          "577:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
          "578:     if ((tag == KERBEROS_APPLICATIONS_AP_REQ) || (tag == KERBEROS_APPLICATIONS_AP_REP)) {",
          "579:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
          "580:     } else {",
          "581:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected KRB_AP_RE[QP]\", tag);",
          "582:         return;",
          "583:     }",
          "587:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
          "588:     if (tag == KERBEROS_APPLICATIONS_KRB_SAFE) {",
          "589:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
          "590:     } else {",
          "591:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected KRB_SAFE\", tag);",
          "592:     }",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "780:         &ett_pktc_mtafqdn,",
          "781:     };",
          "783:     proto_register_field_array(proto_pktc, hf, array_length(hf));",
          "784:     proto_register_subtree_array(ett, array_length(ett));",
          "785: }",
          "787: void",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "802:     static ei_register_info ei[] = {",
          "803:         { &ei_pktc_unknown_kerberos_application, { \"pktc.mtafqdn.unknown_kerberos_application\", PI_PROTOCOL, PI_WARN, \"Unknown Kerberos application\", EXPFILL }},",
          "804:     };",
          "806:     expert_module_t* expert_pktc;",
          "810:     expert_pktc = expert_register_protocol(proto_pktc);",
          "811:     expert_register_field_array(expert_pktc, ei, array_length(ei));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "69d348c12a2d86e5fa75189cd2dd5f4f3784dcfc",
      "candidate_info": {
        "commit_hash": "69d348c12a2d86e5fa75189cd2dd5f4f3784dcfc",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/69d348c12a2d86e5fa75189cd2dd5f4f3784dcfc",
        "files": [
          "epan/dissectors/asn1/kerberos/kerberos.cnf",
          "epan/dissectors/packet-kerberos.c",
          "epan/dissectors/packet-kerberos.h",
          "epan/dissectors/packet-pktc.c"
        ],
        "message": "Bugfix \"typo\" from I9b04837f93\n\nChange-Id: Iafc67ced1af0fbb27545acb0e1569b8b8ccd9451\nReviewed-on: https://code.wireshark.org/review/14544\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>",
        "before_after_code_files": [
          "epan/dissectors/asn1/kerberos/kerberos.cnf||epan/dissectors/asn1/kerberos/kerberos.cnf",
          "epan/dissectors/packet-kerberos.c||epan/dissectors/packet-kerberos.c",
          "epan/dissectors/packet-kerberos.h||epan/dissectors/packet-kerberos.h",
          "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
          ],
          "candidate": [
            "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/asn1/kerberos/kerberos.cnf||epan/dissectors/asn1/kerberos/kerberos.cnf": [
          "File: epan/dissectors/asn1/kerberos/kerberos.cnf -> epan/dissectors/asn1/kerberos/kerberos.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #.EXPORTS",
          "6: ChangePasswdData",
          "8: #.FIELD_RENAME",
          "9: #EncryptedData/etype encryptedData_etype",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: Applications ONLY_ENUM",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "62: #.MAKE_DEFINES",
          "63: ADDR-TYPE TYPE_PREFIX",
          "65: #.FN_BODY MESSAGE-TYPE VAL_PTR = &msgtype",
          "66: guint32 msgtype;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "65: Applications TYPE_PREFIX",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-kerberos.c||epan/dissectors/packet-kerberos.c": [
          "File: epan/dissectors/packet-kerberos.c -> epan/dissectors/packet-kerberos.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2379: static int",
          "2380: dissect_kerberos_ENCTYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2382:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2383:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2384:                                                 &(private_data->etype));",
          "",
          "[Removed Lines]",
          "2381: #line 223 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2381: #line 225 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2404: static int",
          "2405: dissect_kerberos_T_encryptedTicketData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2407: #ifdef HAVE_KERBEROS",
          "2408:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_ticket_data);",
          "2409: #else",
          "",
          "[Removed Lines]",
          "2406: #line 227 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2406: #line 229 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2530: static int",
          "2531: dissect_kerberos_CKSUMTYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2533:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2534:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2535:                                                 &(private_data->checksum_type));",
          "",
          "[Removed Lines]",
          "2532: #line 284 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2532: #line 286 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2545: static int",
          "2546: dissect_kerberos_T_checksum(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2548:  tvbuff_t *next_tvb;",
          "2549:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "2547: #line 288 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2547: #line 290 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2612: static int",
          "2613: dissect_kerberos_T_keytype(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2615:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2617:  offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "",
          "[Removed Lines]",
          "2614: #line 302 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2614: #line 304 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2628: static int",
          "2629: dissect_kerberos_T_keyvalue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2631:  tvbuff_t *out_tvb;",
          "2632:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "2630: #line 309 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2630: #line 311 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2653: static int",
          "2654: dissect_kerberos_EncryptionKey(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2656:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2658:    offset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,",
          "",
          "[Removed Lines]",
          "2655: #line 318 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2655: #line 320 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2675: static int",
          "2676: dissect_kerberos_T_ad_type(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2678:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2679:  offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2680:          &(private_data->ad_type));",
          "",
          "[Removed Lines]",
          "2677: #line 329 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2677: #line 331 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2688: static int",
          "2689: dissect_kerberos_T_ad_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2691:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2693:  switch(private_data->ad_type){",
          "",
          "[Removed Lines]",
          "2690: #line 336 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2690: #line 338 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "2837: static int",
          "2838: dissect_kerberos_ADDR_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2840:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2841:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2842:                                                 &(private_data->addr_type));",
          "",
          "[Removed Lines]",
          "2839: #line 350 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2839: #line 352 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "2852: static int",
          "2853: dissect_kerberos_T_address(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2855:  gint8 appclass;",
          "2856:  gboolean pc;",
          "2857:  gint32 tag;",
          "",
          "[Removed Lines]",
          "2854: #line 172 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2854: #line 174 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "2985: static int",
          "2986: dissect_kerberos_MESSAGE_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2988: guint32 msgtype;",
          "2990:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "",
          "[Removed Lines]",
          "2987: #line 66 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2987: #line 68 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "2997:  if (gbl_do_col_info) {",
          "2998:   col_add_str(actx->pinfo->cinfo, COL_INFO,",
          "2999:    val_to_str(msgtype, krb5_msg_types,",
          "",
          "[Removed Lines]",
          "2996: #line 71 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2996: #line 73 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "3056: static int",
          "3057: dissect_kerberos_PADATA_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3059:  kerberos_private_data_t* private_data = kerberos_get_private_data(actx);",
          "3060:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "3061:                                                 &(private_data->padata_type));",
          "3066:  if(tree){",
          "3067:   proto_item_append_text(tree, \" %s\",",
          "3068:    val_to_str(private_data->padata_type, krb5_preauthentication_types,",
          "",
          "[Removed Lines]",
          "3058: #line 119 \"./asn1/kerberos/kerberos.cnf\"",
          "3065: #line 122 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3058: #line 121 \"./asn1/kerberos/kerberos.cnf\"",
          "3065: #line 124 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "3078: static int",
          "3079: dissect_kerberos_T_padata_value(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3081:  proto_tree *sub_tree=tree;",
          "3082:  kerberos_private_data_t* private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "3080: #line 129 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3080: #line 131 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "3205: static int",
          "3206: dissect_kerberos_T_encryptedAuthorizationData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3208: #ifdef HAVE_KERBEROS",
          "3209:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_authenticator_data);",
          "3210: #else",
          "",
          "[Removed Lines]",
          "3207: #line 235 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3207: #line 237 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "3268: static int",
          "3269: dissect_kerberos_KDC_REQ_BODY(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3271:  conversation_t *conversation;",
          "",
          "[Removed Lines]",
          "3270: #line 354 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3270: #line 356 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "3329: static int",
          "3330: dissect_kerberos_T_encryptedKDCREPData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3332: #ifdef HAVE_KERBEROS",
          "3333:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_KDC_REP_data);",
          "3334: #else",
          "",
          "[Removed Lines]",
          "3331: #line 243 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3331: #line 245 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "3459: static int",
          "3460: dissect_kerberos_T_encryptedAPREPData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3462: #ifdef HAVE_KERBEROS",
          "3463:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_AP_REP_data);",
          "3464: #else",
          "",
          "[Removed Lines]",
          "3461: #line 259 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3461: #line 261 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "3520: static int",
          "3521: dissect_kerberos_T_kRB_SAFE_BODY_user_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3523:  tvbuff_t *new_tvb;",
          "3524:  offset=dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &new_tvb);",
          "3525:  if (new_tvb) {",
          "",
          "[Removed Lines]",
          "3522: #line 377 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3522: #line 379 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "3582: static int",
          "3583: dissect_kerberos_T_encryptedKrbPrivData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3585: #ifdef HAVE_KERBEROS",
          "3586:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_PRIV_data);",
          "3587: #else",
          "",
          "[Removed Lines]",
          "3584: #line 267 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3584: #line 269 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "3643: static int",
          "3644: dissect_kerberos_T_encryptedKrbCredData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3646: #ifdef HAVE_KERBEROS",
          "3647:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_CRED_data);",
          "3648: #else",
          "",
          "[Removed Lines]",
          "3645: #line 275 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3645: #line 277 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "3842: static int",
          "3843: dissect_kerberos_T_encKrbPrivPart_user_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3845:  tvbuff_t *new_tvb;",
          "3846:  offset=dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &new_tvb);",
          "3847:  if (new_tvb) {",
          "",
          "[Removed Lines]",
          "3844: #line 384 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3844: #line 386 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "4053: static int",
          "4054: dissect_kerberos_ERROR_CODE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "4056:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "4057:                                                 &krb5_errorcode);",
          "4063:  if(krb5_errorcode) {",
          "4064:   col_add_fstr(actx->pinfo->cinfo, COL_INFO,",
          "4065:    \"KRB Error: %s\",",
          "",
          "[Removed Lines]",
          "4055: #line 84 \"./asn1/kerberos/kerberos.cnf\"",
          "4062: #line 87 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "4055: #line 86 \"./asn1/kerberos/kerberos.cnf\"",
          "4062: #line 89 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "4077: static int",
          "4078: dissect_kerberos_T_e_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "4080:  switch(krb5_errorcode){",
          "4081:  case KRB5_ET_KRB5KDC_ERR_BADOPTION:",
          "4082:  case KRB5_ET_KRB5KDC_ERR_CLIENT_REVOKED:",
          "",
          "[Removed Lines]",
          "4079: #line 97 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "4079: #line 99 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "4144: static const ber_choice_t Applications_choice[] = {",
          "4163:   { 0, NULL, 0, 0, 0, NULL }",
          "4164: };",
          "",
          "[Removed Lines]",
          "4145:   {   1, &hf_kerberos_ticket     , BER_CLASS_APP, 1, BER_FLAGS_NOOWNTAG, dissect_kerberos_Ticket },",
          "4146:   {   2, &hf_kerberos_authenticator, BER_CLASS_APP, 2, BER_FLAGS_NOOWNTAG, dissect_kerberos_Authenticator },",
          "4147:   {   3, &hf_kerberos_encTicketPart, BER_CLASS_APP, 3, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTicketPart },",
          "4148:   {  10, &hf_kerberos_as_req     , BER_CLASS_APP, 10, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REQ },",
          "4149:   {  11, &hf_kerberos_as_rep     , BER_CLASS_APP, 11, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REP },",
          "4150:   {  12, &hf_kerberos_tgs_req    , BER_CLASS_APP, 12, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REQ },",
          "4151:   {  13, &hf_kerberos_tgs_rep    , BER_CLASS_APP, 13, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REP },",
          "4152:   {  14, &hf_kerberos_ap_req     , BER_CLASS_APP, 14, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REQ },",
          "4153:   {  15, &hf_kerberos_ap_rep     , BER_CLASS_APP, 15, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REP },",
          "4154:   {  20, &hf_kerberos_krb_safe   , BER_CLASS_APP, 20, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_SAFE },",
          "4155:   {  21, &hf_kerberos_krb_priv   , BER_CLASS_APP, 21, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_PRIV },",
          "4156:   {  22, &hf_kerberos_krb_cred   , BER_CLASS_APP, 22, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_CRED },",
          "4157:   {  25, &hf_kerberos_encASRepPart, BER_CLASS_APP, 25, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncASRepPart },",
          "4158:   {  26, &hf_kerberos_encTGSRepPart, BER_CLASS_APP, 26, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTGSRepPart },",
          "4159:   {  27, &hf_kerberos_encAPRepPart, BER_CLASS_APP, 27, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncAPRepPart },",
          "4160:   {  28, &hf_kerberos_encKrbPrivPart, BER_CLASS_APP, 28, BER_FLAGS_NOOWNTAG, dissect_kerberos_ENC_KRB_PRIV_PART },",
          "4161:   {  29, &hf_kerberos_encKrbCredPart, BER_CLASS_APP, 29, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncKrbCredPart },",
          "4162:   {  30, &hf_kerberos_krb_error  , BER_CLASS_APP, 30, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_ERROR },",
          "",
          "[Added Lines]",
          "4145:   { KERBEROS_APPLICATIONS_TICKET, &hf_kerberos_ticket     , BER_CLASS_APP, 1, BER_FLAGS_NOOWNTAG, dissect_kerberos_Ticket },",
          "4146:   { KERBEROS_APPLICATIONS_AUTHENTICATOR, &hf_kerberos_authenticator, BER_CLASS_APP, 2, BER_FLAGS_NOOWNTAG, dissect_kerberos_Authenticator },",
          "4147:   { KERBEROS_APPLICATIONS_ENCTICKETPART, &hf_kerberos_encTicketPart, BER_CLASS_APP, 3, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTicketPart },",
          "4148:   { KERBEROS_APPLICATIONS_AS_REQ, &hf_kerberos_as_req     , BER_CLASS_APP, 10, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REQ },",
          "4149:   { KERBEROS_APPLICATIONS_AS_REP, &hf_kerberos_as_rep     , BER_CLASS_APP, 11, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REP },",
          "4150:   { KERBEROS_APPLICATIONS_TGS_REQ, &hf_kerberos_tgs_req    , BER_CLASS_APP, 12, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REQ },",
          "4151:   { KERBEROS_APPLICATIONS_TGS_REP, &hf_kerberos_tgs_rep    , BER_CLASS_APP, 13, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REP },",
          "4152:   { KERBEROS_APPLICATIONS_AP_REQ, &hf_kerberos_ap_req     , BER_CLASS_APP, 14, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REQ },",
          "4153:   { KERBEROS_APPLICATIONS_AP_REP, &hf_kerberos_ap_rep     , BER_CLASS_APP, 15, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REP },",
          "4154:   { KERBEROS_APPLICATIONS_KRB_SAFE, &hf_kerberos_krb_safe   , BER_CLASS_APP, 20, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_SAFE },",
          "4155:   { KERBEROS_APPLICATIONS_KRB_PRIV, &hf_kerberos_krb_priv   , BER_CLASS_APP, 21, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_PRIV },",
          "4156:   { KERBEROS_APPLICATIONS_KRB_CRED, &hf_kerberos_krb_cred   , BER_CLASS_APP, 22, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_CRED },",
          "4157:   { KERBEROS_APPLICATIONS_ENCASREPPART, &hf_kerberos_encASRepPart, BER_CLASS_APP, 25, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncASRepPart },",
          "4158:   { KERBEROS_APPLICATIONS_ENCTGSREPPART, &hf_kerberos_encTGSRepPart, BER_CLASS_APP, 26, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTGSRepPart },",
          "4159:   { KERBEROS_APPLICATIONS_ENCAPREPPART, &hf_kerberos_encAPRepPart, BER_CLASS_APP, 27, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncAPRepPart },",
          "4160:   { KERBEROS_APPLICATIONS_ENCKRBPRIVPART, &hf_kerberos_encKrbPrivPart, BER_CLASS_APP, 28, BER_FLAGS_NOOWNTAG, dissect_kerberos_ENC_KRB_PRIV_PART },",
          "4161:   { KERBEROS_APPLICATIONS_ENCKRBCREDPART, &hf_kerberos_encKrbCredPart, BER_CLASS_APP, 29, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncKrbCredPart },",
          "4162:   { KERBEROS_APPLICATIONS_KRB_ERROR, &hf_kerberos_krb_error  , BER_CLASS_APP, 30, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_ERROR },",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "4177: static int",
          "4178: dissect_kerberos_T_pA_ENC_TIMESTAMP_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "4180: #ifdef HAVE_KERBEROS",
          "4181:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_PA_ENC_TIMESTAMP);",
          "4182: #else",
          "",
          "[Removed Lines]",
          "4179: #line 251 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "4179: #line 253 \"./asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-kerberos.h||epan/dissectors/packet-kerberos.h": [
          "File: epan/dissectors/packet-kerberos.h -> epan/dissectors/packet-kerberos.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "149: #line 1 \"./asn1/kerberos/packet-kerberos-exp.h\"",
          "150: int dissect_kerberos_ChangePasswdData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "152: #define KERBEROS_APPLICATIONS_TICKET   1",
          "153: #define KERBEROS_APPLICATIONS_AUTHENTICATOR   2",
          "154: #define KERBEROS_APPLICATIONS_ENCTICKETPART   3",
          "155: #define KERBEROS_APPLICATIONS_AS_REQ  10",
          "156: #define KERBEROS_APPLICATIONS_AS_REP  11",
          "157: #define KERBEROS_APPLICATIONS_TGS_REQ  12",
          "158: #define KERBEROS_APPLICATIONS_TGS_REP  13",
          "159: #define KERBEROS_APPLICATIONS_AP_REQ  14",
          "160: #define KERBEROS_APPLICATIONS_AP_REP  15",
          "161: #define KERBEROS_APPLICATIONS_KRB_SAFE  20",
          "162: #define KERBEROS_APPLICATIONS_KRB_PRIV  21",
          "163: #define KERBEROS_APPLICATIONS_KRB_CRED  22",
          "164: #define KERBEROS_APPLICATIONS_ENCASREPPART  25",
          "165: #define KERBEROS_APPLICATIONS_ENCTGSREPPART  26",
          "166: #define KERBEROS_APPLICATIONS_ENCAPREPPART  27",
          "167: #define KERBEROS_APPLICATIONS_ENCKRBPRIVPART  28",
          "168: #define KERBEROS_APPLICATIONS_ENCKRBCREDPART  29",
          "169: #define KERBEROS_APPLICATIONS_KRB_ERROR  30",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c": [
          "File: epan/dissectors/packet-pktc.c -> epan/dissectors/packet-pktc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "567:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
          "568:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
          "570:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
          "571:     } else {",
          "572:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected 10 or 11\", tag);",
          "",
          "[Removed Lines]",
          "569:     if ((tag == 10) || (tag == 11)) {",
          "",
          "[Added Lines]",
          "569:     if ((tag == KERBEROS_APPLICATIONS_AP_REQ) || (tag == KERBEROS_APPLICATIONS_AP_REP)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "577:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
          "578:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
          "580:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
          "581:     } else {",
          "582:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected 20\", tag);",
          "",
          "[Removed Lines]",
          "579:     if (tag == 20) {",
          "",
          "[Added Lines]",
          "579:     if (tag == KERBEROS_APPLICATIONS_KRB_SAFE) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "99d549fc0208075345662a0ad6aeedfeda90bf29",
      "candidate_info": {
        "commit_hash": "99d549fc0208075345662a0ad6aeedfeda90bf29",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/99d549fc0208075345662a0ad6aeedfeda90bf29",
        "files": [
          "asn1/kerberos/kerberos.cnf",
          "epan/dissectors/packet-kerberos.c",
          "epan/dissectors/packet-kerberos.h",
          "epan/dissectors/packet-pktc.c"
        ],
        "message": "PKTC must be stricter with its Kerberos application choices.\n\nThe PKTC dissector calls the Kerberos dissector assuming certain application values.  Because different application values can have different \"private\" data, corruption can occur.\nEnsure the Kerberos application values match the preceding comments by checking the ber identifier before calling the Kerberos dissector.\n\nBug: 12206\nChange-Id: I9b04837f93a56681cae3816278315cf01da17544\nReviewed-on: https://code.wireshark.org/review/14540\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
        "before_after_code_files": [
          "asn1/kerberos/kerberos.cnf||asn1/kerberos/kerberos.cnf",
          "epan/dissectors/packet-kerberos.c||epan/dissectors/packet-kerberos.c",
          "epan/dissectors/packet-kerberos.h||epan/dissectors/packet-kerberos.h",
          "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
          ],
          "candidate": [
            "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/kerberos/kerberos.cnf||asn1/kerberos/kerberos.cnf": [
          "File: asn1/kerberos/kerberos.cnf -> asn1/kerberos/kerberos.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #.EXPORTS",
          "6: ChangePasswdData",
          "8: #.FIELD_RENAME",
          "9: #EncryptedData/etype encryptedData_etype",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: Applications ONLY_ENUM",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "62: #.MAKE_DEFINES",
          "63: ADDR-TYPE TYPE_PREFIX",
          "65: #.FN_BODY MESSAGE-TYPE VAL_PTR = &msgtype",
          "66: guint32 msgtype;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "65: Applications TYPE_PREFIX",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-kerberos.c||epan/dissectors/packet-kerberos.c": [
          "File: epan/dissectors/packet-kerberos.c -> epan/dissectors/packet-kerberos.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2359: static int",
          "2360: dissect_kerberos_ENCTYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2362:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2363:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2364:                                                 &(private_data->etype));",
          "",
          "[Removed Lines]",
          "2361: #line 223 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2361: #line 225 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2384: static int",
          "2385: dissect_kerberos_T_encryptedTicketData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2387: #ifdef HAVE_KERBEROS",
          "2388:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_ticket_data);",
          "2389: #else",
          "",
          "[Removed Lines]",
          "2386: #line 227 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2386: #line 229 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2471: static int",
          "2472: dissect_kerberos_CKSUMTYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2474:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2475:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2476:                                                 &(private_data->checksum_type));",
          "",
          "[Removed Lines]",
          "2473: #line 284 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2473: #line 286 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2486: static int",
          "2487: dissect_kerberos_T_checksum(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2489:  tvbuff_t *next_tvb;",
          "2490:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "2488: #line 288 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2488: #line 290 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2553: static int",
          "2554: dissect_kerberos_T_keytype(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2556:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2558:  offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "",
          "[Removed Lines]",
          "2555: #line 302 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2555: #line 304 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2569: static int",
          "2570: dissect_kerberos_T_keyvalue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2572:  tvbuff_t *out_tvb;",
          "2573:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "2571: #line 309 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2571: #line 311 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2594: static int",
          "2595: dissect_kerberos_EncryptionKey(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2597:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2599:    offset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,",
          "",
          "[Removed Lines]",
          "2596: #line 318 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2596: #line 320 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2616: static int",
          "2617: dissect_kerberos_T_ad_type(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2619:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2620:  offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2621:          &(private_data->ad_type));",
          "",
          "[Removed Lines]",
          "2618: #line 329 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2618: #line 331 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2629: static int",
          "2630: dissect_kerberos_T_ad_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2632:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2634:  switch(private_data->ad_type){",
          "",
          "[Removed Lines]",
          "2631: #line 336 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2631: #line 338 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "2778: static int",
          "2779: dissect_kerberos_ADDR_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2781:  kerberos_private_data_t *private_data = kerberos_get_private_data(actx);",
          "2782:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "2783:                                                 &(private_data->addr_type));",
          "",
          "[Removed Lines]",
          "2780: #line 350 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2780: #line 352 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "2793: static int",
          "2794: dissect_kerberos_T_address(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2796:  gint8 appclass;",
          "2797:  gboolean pc;",
          "2798:  gint32 tag;",
          "",
          "[Removed Lines]",
          "2795: #line 172 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2795: #line 174 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "2926: static int",
          "2927: dissect_kerberos_MESSAGE_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "2929: guint32 msgtype;",
          "2931:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "",
          "[Removed Lines]",
          "2928: #line 66 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2928: #line 68 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "2938:  if (gbl_do_col_info) {",
          "2939:   col_add_str(actx->pinfo->cinfo, COL_INFO,",
          "2940:    val_to_str(msgtype, krb5_msg_types,",
          "",
          "[Removed Lines]",
          "2937: #line 71 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2937: #line 73 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "2997: static int",
          "2998: dissect_kerberos_PADATA_TYPE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3000:  kerberos_private_data_t* private_data = kerberos_get_private_data(actx);",
          "3001:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "3002:                                                 &(private_data->padata_type));",
          "3007:  if(tree){",
          "3008:   proto_item_append_text(tree, \" %s\",",
          "3009:    val_to_str(private_data->padata_type, krb5_preauthentication_types,",
          "",
          "[Removed Lines]",
          "2999: #line 119 \"../../asn1/kerberos/kerberos.cnf\"",
          "3006: #line 122 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "2999: #line 121 \"../../asn1/kerberos/kerberos.cnf\"",
          "3006: #line 124 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "3019: static int",
          "3020: dissect_kerberos_T_padata_value(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3022:  proto_tree *sub_tree=tree;",
          "3023:  kerberos_private_data_t* private_data = kerberos_get_private_data(actx);",
          "",
          "[Removed Lines]",
          "3021: #line 129 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3021: #line 131 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "3146: static int",
          "3147: dissect_kerberos_T_encryptedAuthorizationData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3149: #ifdef HAVE_KERBEROS",
          "3150:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_authenticator_data);",
          "3151: #else",
          "",
          "[Removed Lines]",
          "3148: #line 235 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3148: #line 237 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "3209: static int",
          "3210: dissect_kerberos_KDC_REQ_BODY(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3212:  conversation_t *conversation;",
          "",
          "[Removed Lines]",
          "3211: #line 354 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3211: #line 356 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "3270: static int",
          "3271: dissect_kerberos_T_encryptedKDCREPData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3273: #ifdef HAVE_KERBEROS",
          "3274:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_KDC_REP_data);",
          "3275: #else",
          "",
          "[Removed Lines]",
          "3272: #line 243 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3272: #line 245 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "3400: static int",
          "3401: dissect_kerberos_T_encryptedAPREPData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3403: #ifdef HAVE_KERBEROS",
          "3404:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_AP_REP_data);",
          "3405: #else",
          "",
          "[Removed Lines]",
          "3402: #line 259 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3402: #line 261 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "3461: static int",
          "3462: dissect_kerberos_T_kRB_SAFE_BODY_user_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3464:  tvbuff_t *new_tvb;",
          "3465:  offset=dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &new_tvb);",
          "3466:  if (new_tvb) {",
          "",
          "[Removed Lines]",
          "3463: #line 377 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3463: #line 379 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "3523: static int",
          "3524: dissect_kerberos_T_encryptedKrbPrivData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3526: #ifdef HAVE_KERBEROS",
          "3527:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_PRIV_data);",
          "3528: #else",
          "",
          "[Removed Lines]",
          "3525: #line 267 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3525: #line 269 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "3584: static int",
          "3585: dissect_kerberos_T_encryptedKrbCredData_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3587: #ifdef HAVE_KERBEROS",
          "3588:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_CRED_data);",
          "3589: #else",
          "",
          "[Removed Lines]",
          "3586: #line 275 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3586: #line 277 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "3783: static int",
          "3784: dissect_kerberos_T_encKrbPrivPart_user_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3786:  tvbuff_t *new_tvb;",
          "3787:  offset=dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &new_tvb);",
          "3788:  if (new_tvb) {",
          "",
          "[Removed Lines]",
          "3785: #line 384 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3785: #line 386 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "3966: static int",
          "3967: dissect_kerberos_ERROR_CODE(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3969:   offset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,",
          "3970:                                                 &krb5_errorcode);",
          "3976:  if(krb5_errorcode) {",
          "3977:   col_add_fstr(actx->pinfo->cinfo, COL_INFO,",
          "3978:    \"KRB Error: %s\",",
          "",
          "[Removed Lines]",
          "3968: #line 84 \"../../asn1/kerberos/kerberos.cnf\"",
          "3975: #line 87 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3968: #line 86 \"../../asn1/kerberos/kerberos.cnf\"",
          "3975: #line 89 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "3990: static int",
          "3991: dissect_kerberos_T_e_data(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "3993:  switch(krb5_errorcode){",
          "3994:  case KRB5_ET_KRB5KDC_ERR_BADOPTION:",
          "3995:  case KRB5_ET_KRB5KDC_ERR_CLIENT_REVOKED:",
          "",
          "[Removed Lines]",
          "3992: #line 97 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "3992: #line 99 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "4057: static const ber_choice_t Applications_choice[] = {",
          "4076:   { 0, NULL, 0, 0, 0, NULL }",
          "4077: };",
          "",
          "[Removed Lines]",
          "4058:   {   1, &hf_kerberos_ticket     , BER_CLASS_APP, 1, BER_FLAGS_NOOWNTAG, dissect_kerberos_Ticket },",
          "4059:   {   2, &hf_kerberos_authenticator, BER_CLASS_APP, 2, BER_FLAGS_NOOWNTAG, dissect_kerberos_Authenticator },",
          "4060:   {   3, &hf_kerberos_encTicketPart, BER_CLASS_APP, 3, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTicketPart },",
          "4061:   {  10, &hf_kerberos_as_req     , BER_CLASS_APP, 10, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REQ },",
          "4062:   {  11, &hf_kerberos_as_rep     , BER_CLASS_APP, 11, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REP },",
          "4063:   {  12, &hf_kerberos_tgs_req    , BER_CLASS_APP, 12, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REQ },",
          "4064:   {  13, &hf_kerberos_tgs_rep    , BER_CLASS_APP, 13, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REP },",
          "4065:   {  14, &hf_kerberos_ap_req     , BER_CLASS_APP, 14, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REQ },",
          "4066:   {  15, &hf_kerberos_ap_rep     , BER_CLASS_APP, 15, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REP },",
          "4067:   {  20, &hf_kerberos_krb_safe   , BER_CLASS_APP, 20, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_SAFE },",
          "4068:   {  21, &hf_kerberos_krb_priv   , BER_CLASS_APP, 21, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_PRIV },",
          "4069:   {  22, &hf_kerberos_krb_cred   , BER_CLASS_APP, 22, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_CRED },",
          "4070:   {  25, &hf_kerberos_encASRepPart, BER_CLASS_APP, 25, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncASRepPart },",
          "4071:   {  26, &hf_kerberos_encTGSRepPart, BER_CLASS_APP, 26, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTGSRepPart },",
          "4072:   {  27, &hf_kerberos_encAPRepPart, BER_CLASS_APP, 27, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncAPRepPart },",
          "4073:   {  28, &hf_kerberos_encKrbPrivPart, BER_CLASS_APP, 28, BER_FLAGS_NOOWNTAG, dissect_kerberos_ENC_KRB_PRIV_PART },",
          "4074:   {  29, &hf_kerberos_encKrbCredPart, BER_CLASS_APP, 29, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncKrbCredPart },",
          "4075:   {  30, &hf_kerberos_krb_error  , BER_CLASS_APP, 30, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_ERROR },",
          "",
          "[Added Lines]",
          "4058:   { KERBEROS_APPLICATIONS_TICKET, &hf_kerberos_ticket     , BER_CLASS_APP, 1, BER_FLAGS_NOOWNTAG, dissect_kerberos_Ticket },",
          "4059:   { KERBEROS_APPLICATIONS_AUTHENTICATOR, &hf_kerberos_authenticator, BER_CLASS_APP, 2, BER_FLAGS_NOOWNTAG, dissect_kerberos_Authenticator },",
          "4060:   { KERBEROS_APPLICATIONS_ENCTICKETPART, &hf_kerberos_encTicketPart, BER_CLASS_APP, 3, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTicketPart },",
          "4061:   { KERBEROS_APPLICATIONS_AS_REQ, &hf_kerberos_as_req     , BER_CLASS_APP, 10, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REQ },",
          "4062:   { KERBEROS_APPLICATIONS_AS_REP, &hf_kerberos_as_rep     , BER_CLASS_APP, 11, BER_FLAGS_NOOWNTAG, dissect_kerberos_AS_REP },",
          "4063:   { KERBEROS_APPLICATIONS_TGS_REQ, &hf_kerberos_tgs_req    , BER_CLASS_APP, 12, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REQ },",
          "4064:   { KERBEROS_APPLICATIONS_TGS_REP, &hf_kerberos_tgs_rep    , BER_CLASS_APP, 13, BER_FLAGS_NOOWNTAG, dissect_kerberos_TGS_REP },",
          "4065:   { KERBEROS_APPLICATIONS_AP_REQ, &hf_kerberos_ap_req     , BER_CLASS_APP, 14, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REQ },",
          "4066:   { KERBEROS_APPLICATIONS_AP_REP, &hf_kerberos_ap_rep     , BER_CLASS_APP, 15, BER_FLAGS_NOOWNTAG, dissect_kerberos_AP_REP },",
          "4067:   { KERBEROS_APPLICATIONS_KRB_SAFE, &hf_kerberos_krb_safe   , BER_CLASS_APP, 20, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_SAFE },",
          "4068:   { KERBEROS_APPLICATIONS_KRB_PRIV, &hf_kerberos_krb_priv   , BER_CLASS_APP, 21, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_PRIV },",
          "4069:   { KERBEROS_APPLICATIONS_KRB_CRED, &hf_kerberos_krb_cred   , BER_CLASS_APP, 22, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_CRED },",
          "4070:   { KERBEROS_APPLICATIONS_ENCASREPPART, &hf_kerberos_encASRepPart, BER_CLASS_APP, 25, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncASRepPart },",
          "4071:   { KERBEROS_APPLICATIONS_ENCTGSREPPART, &hf_kerberos_encTGSRepPart, BER_CLASS_APP, 26, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncTGSRepPart },",
          "4072:   { KERBEROS_APPLICATIONS_ENCAPREPPART, &hf_kerberos_encAPRepPart, BER_CLASS_APP, 27, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncAPRepPart },",
          "4073:   { KERBEROS_APPLICATIONS_ENCKRBPRIVPART, &hf_kerberos_encKrbPrivPart, BER_CLASS_APP, 28, BER_FLAGS_NOOWNTAG, dissect_kerberos_ENC_KRB_PRIV_PART },",
          "4074:   { KERBEROS_APPLICATIONS_ENCKRBCREDPART, &hf_kerberos_encKrbCredPart, BER_CLASS_APP, 29, BER_FLAGS_NOOWNTAG, dissect_kerberos_EncKrbCredPart },",
          "4075:   { KERBEROS_APPLICATIONS_KRB_ERROR, &hf_kerberos_krb_error  , BER_CLASS_APP, 30, BER_FLAGS_NOOWNTAG, dissect_kerberos_KRB_ERROR },",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "4090: static int",
          "4091: dissect_kerberos_T_pA_ENC_TIMESTAMP_cipher(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "4093: #ifdef HAVE_KERBEROS",
          "4094:  offset=dissect_ber_octet_string_wcb(FALSE, actx, tree, tvb, offset, hf_index, dissect_krb5_decrypt_PA_ENC_TIMESTAMP);",
          "4095: #else",
          "",
          "[Removed Lines]",
          "4092: #line 251 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "[Added Lines]",
          "4092: #line 253 \"../../asn1/kerberos/kerberos.cnf\"",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-kerberos.h||epan/dissectors/packet-kerberos.h": [
          "File: epan/dissectors/packet-kerberos.h -> epan/dissectors/packet-kerberos.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "114: #line 1 \"../../asn1/kerberos/packet-kerberos-exp.h\"",
          "115: int dissect_kerberos_ChangePasswdData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "117: #define KERBEROS_APPLICATIONS_TICKET   1",
          "118: #define KERBEROS_APPLICATIONS_AUTHENTICATOR   2",
          "119: #define KERBEROS_APPLICATIONS_ENCTICKETPART   3",
          "120: #define KERBEROS_APPLICATIONS_AS_REQ  10",
          "121: #define KERBEROS_APPLICATIONS_AS_REP  11",
          "122: #define KERBEROS_APPLICATIONS_TGS_REQ  12",
          "123: #define KERBEROS_APPLICATIONS_TGS_REP  13",
          "124: #define KERBEROS_APPLICATIONS_AP_REQ  14",
          "125: #define KERBEROS_APPLICATIONS_AP_REP  15",
          "126: #define KERBEROS_APPLICATIONS_KRB_SAFE  20",
          "127: #define KERBEROS_APPLICATIONS_KRB_PRIV  21",
          "128: #define KERBEROS_APPLICATIONS_KRB_CRED  22",
          "129: #define KERBEROS_APPLICATIONS_ENCASREPPART  25",
          "130: #define KERBEROS_APPLICATIONS_ENCTGSREPPART  26",
          "131: #define KERBEROS_APPLICATIONS_ENCAPREPPART  27",
          "132: #define KERBEROS_APPLICATIONS_ENCKRBPRIVPART  28",
          "133: #define KERBEROS_APPLICATIONS_ENCKRBCREDPART  29",
          "134: #define KERBEROS_APPLICATIONS_KRB_ERROR  30",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-pktc.c||epan/dissectors/packet-pktc.c": [
          "File: epan/dissectors/packet-pktc.c -> epan/dissectors/packet-pktc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "36: #include <epan/to_str.h>",
          "37: #include <epan/asn1.h>",
          "38: #include \"packet-pktc.h\"",
          "39: #include \"packet-kerberos.h\"",
          "40: #include \"packet-snmp.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "39: #include \"packet-ber.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "96: static expert_field ei_pktc_unknown_kmmid = EI_INIT;",
          "97: static expert_field ei_pktc_unknown_doi = EI_INIT;",
          "99: #define KMMID_WAKEUP            0x01",
          "100: #define KMMID_AP_REQUEST        0x02",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "99: static expert_field ei_pktc_unknown_kerberos_application = EI_INIT;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "554:     proto_tree *pktc_mtafqdn_tree;",
          "555:     proto_item *item;",
          "556:     tvbuff_t *pktc_mtafqdn_tvb;",
          "558:     col_set_str(pinfo->cinfo, COL_PROTOCOL, \"PKTC\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "559:     gint8              ber_class;",
          "560:     gboolean           pc;",
          "561:     gint32             tag;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "567:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
          "571:     pktc_mtafqdn_tvb = tvb_new_subset_remaining(tvb, offset);",
          "574:     proto_item_set_len(item, offset);",
          "575: }",
          "",
          "[Removed Lines]",
          "568:     offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
          "572:     offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
          "",
          "[Added Lines]",
          "573:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
          "574:     if ((tag == KERBEROS_APPLICATIONS_AP_REQ) || (tag == KERBEROS_APPLICATIONS_AP_REP)) {",
          "575:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, NULL);",
          "576:     } else {",
          "577:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected KRB_AP_RE[QP]\", tag);",
          "578:         return;",
          "579:     }",
          "583:     get_ber_identifier(pktc_mtafqdn_tvb, 0, &ber_class, &pc, &tag);",
          "584:     if (tag == KERBEROS_APPLICATIONS_KRB_SAFE) {",
          "585:         offset += dissect_kerberos_main(pktc_mtafqdn_tvb, pinfo, pktc_mtafqdn_tree, FALSE, cb);",
          "586:     } else {",
          "587:         expert_add_info_format(pinfo, item, &ei_pktc_unknown_kerberos_application, \"Unknown Kerberos application (%d), expected KRB_SAFE\", tag);",
          "588:     }",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "780:     static ei_register_info ei[] = {",
          "781:         { &ei_pktc_unknown_kmmid, { \"pktc.mtafqdn.unknown_kmmid\", PI_PROTOCOL, PI_WARN, \"Unknown KMMID\", EXPFILL }},",
          "782:         { &ei_pktc_unknown_doi, { \"pktc.mtafqdn.unknown_doi\", PI_PROTOCOL, PI_WARN, \"Unknown DOI\", EXPFILL }},",
          "783:     };",
          "785:     expert_module_t* expert_pktc;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "799:         { &ei_pktc_unknown_kerberos_application, { \"pktc.mtafqdn.unknown_kerberos_application\", PI_PROTOCOL, PI_WARN, \"Unknown Kerberos application\", EXPFILL }},",
          "",
          "---------------"
        ]
      }
    }
  ]
}