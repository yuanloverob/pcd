{
  "cve_id": "CVE-2012-0852",
  "cve_desc": "The adpcm_decode_frame function in adpcm.c in libavcodec in FFmpeg before 0.9.1 and in Libav 0.5.x before 0.5.9, 0.6.x before 0.6.6, 0.7.x before 0.7.6, and 0.8.x before 0.8.3 allows remote attackers to cause a denial of service (application crash) and possibly execute arbitrary code via an ADPCM file with the number of channels not equal to two.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "608708009f69ba4cecebf05120c696167494c897",
  "patch_info": {
    "commit_hash": "608708009f69ba4cecebf05120c696167494c897",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/608708009f69ba4cecebf05120c696167494c897",
    "files": [
      "libavcodec/adpcm.c"
    ],
    "message": "adpcm: Fix crash Fixes half of Ticket794 Bug found by: Oana Stratulat\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "before_after_code_files": [
      "libavcodec/adpcm.c||libavcodec/adpcm.c"
    ]
  },
  "patch_diff": {
    "libavcodec/adpcm.c||libavcodec/adpcm.c": [
      "File: libavcodec/adpcm.c -> libavcodec/adpcm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "821:         src += 4; // skip sample count (already read)",
      "823:         current_left_sample   = (int16_t)bytestream_get_le16(&src);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "821:         if(avctx->channels != 2)",
      "822:             return AVERROR_INVALIDDATA;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "25cadd366bce02e3d1fc070ee6dd9f208e2b11c9",
      "candidate_info": {
        "commit_hash": "25cadd366bce02e3d1fc070ee6dd9f208e2b11c9",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/25cadd366bce02e3d1fc070ee6dd9f208e2b11c9",
        "files": [
          "libavcodec/adpcm.c"
        ],
        "message": "adpcm: Fix crash Fixes half of Ticket794 Bug found by: Oana Stratulat\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 608708009f69ba4cecebf05120c696167494c897)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/adpcm.c||libavcodec/adpcm.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/adpcm.c||libavcodec/adpcm.c"
          ],
          "candidate": [
            "libavcodec/adpcm.c||libavcodec/adpcm.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/adpcm.c||libavcodec/adpcm.c": [
          "File: libavcodec/adpcm.c -> libavcodec/adpcm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "821:         src += 4; // skip sample count (already read)",
          "823:         current_left_sample   = (int16_t)bytestream_get_le16(&src);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "821:         if(avctx->channels != 2)",
          "822:             return AVERROR_INVALIDDATA;",
          "",
          "---------------"
        ]
      }
    }
  ]
}