{
  "cve_id": "CVE-2011-1940",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 3.3.x before 3.3.10.1 and 3.4.x before 3.4.1 allow remote attackers to inject arbitrary web script or HTML via a crafted table name that triggers improper HTML rendering on a Tracking page, related to (1) libraries/tbl_links.inc.php and (2) tbl_tracking.php.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "7e10c132a3887c8ebfd7a8eee356b28375f1e287",
  "patch_info": {
    "commit_hash": "7e10c132a3887c8ebfd7a8eee356b28375f1e287",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/7e10c132a3887c8ebfd7a8eee356b28375f1e287",
    "files": [
      "libraries/tbl_links.inc.php",
      "tbl_tracking.php"
    ],
    "message": "XSS in Tracking page, more",
    "before_after_code_files": [
      "libraries/tbl_links.inc.php||libraries/tbl_links.inc.php",
      "tbl_tracking.php||tbl_tracking.php"
    ]
  },
  "patch_diff": {
    "libraries/tbl_links.inc.php||libraries/tbl_links.inc.php": [
      "File: libraries/tbl_links.inc.php -> libraries/tbl_links.inc.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "113: if(PMA_Tracker::isActive() and PMA_Tracker::isTracked($GLOBALS[\"db\"], $GLOBALS[\"table\"]))",
      "114: {",
      "116:     $msg->display();",
      "117: }",
      "",
      "[Removed Lines]",
      "115:     $msg = PMA_Message::notice('<a href=\"tbl_tracking.php?'.$url_query.'\">'.sprintf(__('Tracking of %s.%s is activated.'), $GLOBALS[\"db\"], $GLOBALS[\"table\"]).'</a>');",
      "",
      "[Added Lines]",
      "115:     $msg = PMA_Message::notice('<a href=\"tbl_tracking.php?'.$url_query.'\">'.sprintf(__('Tracking of %s.%s is activated.'), htmlspecialchars($GLOBALS[\"db\"]), htmlspecialchars($GLOBALS[\"table\"])).'</a>');",
      "",
      "---------------"
    ],
    "tbl_tracking.php||tbl_tracking.php": [
      "File: tbl_tracking.php -> tbl_tracking.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "179:     $tracking_set = rtrim($tracking_set, ',');",
      "181:     if (PMA_Tracker::createVersion($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'], $tracking_set )) {",
      "183:         $msg->display();",
      "184:     }",
      "185: }",
      "",
      "[Removed Lines]",
      "182:         $msg = PMA_Message::success(sprintf(__('Version %s is created, tracking for %s.%s is activated.'), $_REQUEST['version'], $GLOBALS['db'], $GLOBALS['table']));",
      "",
      "[Added Lines]",
      "182:         $msg = PMA_Message::success(sprintf(__('Version %s is created, tracking for %s.%s is activated.'), $_REQUEST['version'], htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table'])));",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "188: if (isset($_REQUEST['submit_deactivate_now'])) {",
      "189:     if (PMA_Tracker::deactivateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
      "191:         $msg->display();",
      "192:     }",
      "193: }",
      "",
      "[Removed Lines]",
      "190:         $msg = PMA_Message::success(sprintf(__('Tracking for %s.%s , version %s is deactivated.'), $GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version']));",
      "",
      "[Added Lines]",
      "190:         $msg = PMA_Message::success(sprintf(__('Tracking for %s.%s , version %s is deactivated.'), htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table']), $_REQUEST['version']));",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "196: if (isset($_REQUEST['submit_activate_now'])) {",
      "197:     if (PMA_Tracker::activateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
      "199:         $msg->display();",
      "200:     }",
      "201: }",
      "",
      "[Removed Lines]",
      "198:         $msg = PMA_Message::success(sprintf(__('Tracking for %s.%s , version %s is activated.'), $GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version']));",
      "",
      "[Added Lines]",
      "198:         $msg = PMA_Message::success(sprintf(__('Tracking for %s.%s , version %s is activated.'), htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table']), $_REQUEST['version']));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "1300510d3686b40adefafb7f1778a6f06d0a553a",
      "candidate_info": {
        "commit_hash": "1300510d3686b40adefafb7f1778a6f06d0a553a",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/1300510d3686b40adefafb7f1778a6f06d0a553a",
        "files": [
          "libraries/tbl_links.inc.php",
          "tbl_tracking.php"
        ],
        "message": "XSS in Tracking page, more",
        "before_after_code_files": [
          "libraries/tbl_links.inc.php||libraries/tbl_links.inc.php",
          "tbl_tracking.php||tbl_tracking.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/tbl_links.inc.php||libraries/tbl_links.inc.php",
            "tbl_tracking.php||tbl_tracking.php"
          ],
          "candidate": [
            "libraries/tbl_links.inc.php||libraries/tbl_links.inc.php",
            "tbl_tracking.php||tbl_tracking.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/tbl_links.inc.php||libraries/tbl_links.inc.php": [
          "File: libraries/tbl_links.inc.php -> libraries/tbl_links.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "137: if(PMA_Tracker::isActive() and PMA_Tracker::isTracked($GLOBALS[\"db\"], $GLOBALS[\"table\"]))",
          "138: {",
          "140:     $msg->display();",
          "141: }",
          "",
          "[Removed Lines]",
          "139:     $msg = PMA_Message::notice('<a href=\"tbl_tracking.php?'.$url_query.'\">'.sprintf($strTrackingActivated, $GLOBALS[\"db\"], $GLOBALS[\"table\"]).'</a>');",
          "",
          "[Added Lines]",
          "139:     $msg = PMA_Message::notice('<a href=\"tbl_tracking.php?'.$url_query.'\">'.sprintf($strTrackingActivated, htmlspecialchars($GLOBALS[\"db\"]), htmlspecialchars($GLOBALS[\"table\"])).'</a>');",
          "",
          "---------------"
        ],
        "tbl_tracking.php||tbl_tracking.php": [
          "File: tbl_tracking.php -> tbl_tracking.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "185:     $tracking_set = rtrim($tracking_set, ',');",
          "187:     if (PMA_Tracker::createVersion($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'], $tracking_set )) {",
          "189:         $msg->display();",
          "190:     }",
          "191: }",
          "",
          "[Removed Lines]",
          "188:         $msg = PMA_Message::success(sprintf($strTrackingVersionCreated, $_REQUEST['version'], $GLOBALS['db'], $GLOBALS['table']));",
          "",
          "[Added Lines]",
          "188:         $msg = PMA_Message::success(sprintf($strTrackingVersionCreated, $_REQUEST['version'], htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table'])));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "194: if (isset($_REQUEST['submit_deactivate_now'])) {",
          "195:     if (PMA_Tracker::deactivateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "197:         $msg->display();",
          "198:     }",
          "199: }",
          "",
          "[Removed Lines]",
          "196:         $msg = PMA_Message::success(sprintf($strTrackingVersionDeactivated, $GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version']));",
          "",
          "[Added Lines]",
          "196:         $msg = PMA_Message::success(sprintf($strTrackingVersionDeactivated, htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table']), $_REQUEST['version']));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "202: if (isset($_REQUEST['submit_activate_now'])) {",
          "203:     if (PMA_Tracker::activateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "205:         $msg->display();",
          "206:     }",
          "207: }",
          "",
          "[Removed Lines]",
          "204:         $msg = PMA_Message::success(sprintf($strTrackingVersionActivated, $GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version']));",
          "",
          "[Added Lines]",
          "204:         $msg = PMA_Message::success(sprintf($strTrackingVersionActivated, htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table']), $_REQUEST['version']));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7553544cd1c1c95ea7bcd29f4cafdc427a85a9f8",
      "candidate_info": {
        "commit_hash": "7553544cd1c1c95ea7bcd29f4cafdc427a85a9f8",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/7553544cd1c1c95ea7bcd29f4cafdc427a85a9f8",
        "files": [
          "tbl_tracking.php"
        ],
        "message": "Escape version before printing",
        "before_after_code_files": [
          "tbl_tracking.php||tbl_tracking.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tbl_tracking.php||tbl_tracking.php"
          ],
          "candidate": [
            "tbl_tracking.php||tbl_tracking.php"
          ]
        }
      },
      "candidate_diff": {
        "tbl_tracking.php||tbl_tracking.php": [
          "File: tbl_tracking.php -> tbl_tracking.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "180:     $tracking_set = rtrim($tracking_set, ',');",
          "182:     if (PMA_Tracker::createVersion($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'], $tracking_set )) {",
          "184:         $msg->display();",
          "185:     }",
          "186: }",
          "",
          "[Removed Lines]",
          "183:         $msg = PMA_Message::success(sprintf(__('Version %s is created, tracking for %s.%s is activated.'), $_REQUEST['version'], htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table'])));",
          "",
          "[Added Lines]",
          "183:         $msg = PMA_Message::success(sprintf(__('Version %s is created, tracking for %s.%s is activated.'), htmlspecialchars($_REQUEST['version']), htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table'])));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "189: if (isset($_REQUEST['submit_deactivate_now'])) {",
          "190:     if (PMA_Tracker::deactivateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "192:         $msg->display();",
          "193:     }",
          "194: }",
          "",
          "[Removed Lines]",
          "191:         $msg = PMA_Message::success(sprintf(__('Tracking for %s.%s , version %s is deactivated.'), htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table']), $_REQUEST['version']));",
          "",
          "[Added Lines]",
          "191:         $msg = PMA_Message::success(sprintf(__('Tracking for %s.%s , version %s is deactivated.'), htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table']), htmlspecialchars($_REQUEST['version'])));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "197: if (isset($_REQUEST['submit_activate_now'])) {",
          "198:     if (PMA_Tracker::activateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "200:         $msg->display();",
          "201:     }",
          "202: }",
          "",
          "[Removed Lines]",
          "199:         $msg = PMA_Message::success(sprintf(__('Tracking for %s.%s , version %s is activated.'), htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table']), $_REQUEST['version']));",
          "",
          "[Added Lines]",
          "199:         $msg = PMA_Message::success(sprintf(__('Tracking for %s.%s , version %s is activated.'), htmlspecialchars($GLOBALS['db']), htmlspecialchars($GLOBALS['table']), htmlspecialchars($_REQUEST['version'])));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "254:         $drop_create_statements .= $data['ddlog'][1]['statement'];",
          "255:     }",
          "260:     $temp = unserialize($data['schema_snapshot']);",
          "",
          "[Removed Lines]",
          "257:     PMA_showMessage(sprintf(__('Version %s snapshot (SQL code)'), $_REQUEST['version']), $drop_create_statements);",
          "",
          "[Added Lines]",
          "257:     PMA_showMessage(sprintf(__('Version %s snapshot (SQL code)'), htmlspecialchars($_REQUEST['version'])), $drop_create_statements);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5078a87eaec1224e0c4a708ccf9de963e27ddb7b",
      "candidate_info": {
        "commit_hash": "5078a87eaec1224e0c4a708ccf9de963e27ddb7b",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/5078a87eaec1224e0c4a708ccf9de963e27ddb7b",
        "files": [
          "tbl_tracking.php"
        ],
        "message": "Merge remote-tracking branch 'origin/QA_3_5'\n\nConflicts:\n\ttbl_tracking.php",
        "before_after_code_files": [
          "tbl_tracking.php||tbl_tracking.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tbl_tracking.php||tbl_tracking.php"
          ],
          "candidate": [
            "tbl_tracking.php||tbl_tracking.php"
          ]
        }
      },
      "candidate_diff": {
        "tbl_tracking.php||tbl_tracking.php": [
          "File: tbl_tracking.php -> tbl_tracking.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "170:     $tracking_set = rtrim($tracking_set, ',');",
          "172:     if (PMA_Tracker::createVersion($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'], $tracking_set )) {",
          "174:         $msg->display();",
          "175:     }",
          "176: }",
          "",
          "[Removed Lines]",
          "173:         $msg = PMA_Message::success(sprintf(__('Version %1$s was created, tracking for %2$s is active.'), $_REQUEST['version'], htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table'])));",
          "",
          "[Added Lines]",
          "173:         $msg = PMA_Message::success(sprintf(__('Version %1$s was created, tracking for %2$s is active.'), htmlspecialchars($_REQUEST['version']), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table'])));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "179: if (isset($_REQUEST['submit_deactivate_now'])) {",
          "180:     if (PMA_Tracker::deactivateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "182:         $msg->display();",
          "183:     }",
          "184: }",
          "",
          "[Removed Lines]",
          "181:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s was deactivated at version %2$s.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), $_REQUEST['version']));",
          "",
          "[Added Lines]",
          "181:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s was deactivated at version %2$s.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), htmlspecialchars($_REQUEST['version'])));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "187: if (isset($_REQUEST['submit_activate_now'])) {",
          "188:     if (PMA_Tracker::activateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "190:         $msg->display();",
          "191:     }",
          "192: }",
          "",
          "[Removed Lines]",
          "189:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s was activated at version %2$s.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), $_REQUEST['version']));",
          "",
          "[Added Lines]",
          "189:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s was activated at version %2$s.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), htmlspecialchars($_REQUEST['version'])));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "243:         $drop_create_statements .= $data['ddlog'][1]['statement'];",
          "244:     }",
          "249:     $temp = unserialize($data['schema_snapshot']);",
          "",
          "[Removed Lines]",
          "246:     PMA_showMessage(sprintf(__('Version %s snapshot (SQL code)'), $_REQUEST['version']), $drop_create_statements);",
          "",
          "[Added Lines]",
          "246:     PMA_showMessage(sprintf(__('Version %s snapshot (SQL code)'), htmlspecialchars($_REQUEST['version'])), $drop_create_statements);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4ef49f3a4b7cd8c4ece4154d9446d66111794e79",
      "candidate_info": {
        "commit_hash": "4ef49f3a4b7cd8c4ece4154d9446d66111794e79",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/4ef49f3a4b7cd8c4ece4154d9446d66111794e79",
        "files": [
          "tbl_tracking.php"
        ],
        "message": "Better messages for tracking changes",
        "before_after_code_files": [
          "tbl_tracking.php||tbl_tracking.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tbl_tracking.php||tbl_tracking.php"
          ],
          "candidate": [
            "tbl_tracking.php||tbl_tracking.php"
          ]
        }
      },
      "candidate_diff": {
        "tbl_tracking.php||tbl_tracking.php": [
          "File: tbl_tracking.php -> tbl_tracking.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "170:     $tracking_set = rtrim($tracking_set, ',');",
          "172:     if (PMA_Tracker::createVersion($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'], $tracking_set )) {",
          "174:         $msg->display();",
          "175:     }",
          "176: }",
          "",
          "[Removed Lines]",
          "173:         $msg = PMA_Message::success(sprintf(__('Version %1$s is created, tracking for %2$s is activated.'), $_REQUEST['version'], htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table'])));",
          "",
          "[Added Lines]",
          "173:         $msg = PMA_Message::success(sprintf(__('Version %1$s was created, tracking for %2$s is active.'), $_REQUEST['version'], htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table'])));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "179: if (isset($_REQUEST['submit_deactivate_now'])) {",
          "180:     if (PMA_Tracker::deactivateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "182:         $msg->display();",
          "183:     }",
          "184: }",
          "",
          "[Removed Lines]",
          "181:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s, version %2$s is deactivated.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), $_REQUEST['version']));",
          "",
          "[Added Lines]",
          "181:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s was deactivated at version %2$s.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), $_REQUEST['version']));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "187: if (isset($_REQUEST['submit_activate_now'])) {",
          "188:     if (PMA_Tracker::activateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "190:         $msg->display();",
          "191:     }",
          "192: }",
          "",
          "[Removed Lines]",
          "189:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s, version %2$s is activated.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), $_REQUEST['version']));",
          "",
          "[Added Lines]",
          "189:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s was activated at version %2$s.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), $_REQUEST['version']));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9142b354349534d25f857a047ecee04f3526b97c",
      "candidate_info": {
        "commit_hash": "9142b354349534d25f857a047ecee04f3526b97c",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/9142b354349534d25f857a047ecee04f3526b97c",
        "files": [
          "tbl_tracking.php"
        ],
        "message": "Wrap long lines",
        "before_after_code_files": [
          "tbl_tracking.php||tbl_tracking.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tbl_tracking.php||tbl_tracking.php"
          ],
          "candidate": [
            "tbl_tracking.php||tbl_tracking.php"
          ]
        }
      },
      "candidate_diff": {
        "tbl_tracking.php||tbl_tracking.php": [
          "File: tbl_tracking.php -> tbl_tracking.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "170:     $tracking_set = rtrim($tracking_set, ',');",
          "172:     if (PMA_Tracker::createVersion($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'], $tracking_set )) {",
          "174:         $msg->display();",
          "175:     }",
          "176: }",
          "",
          "[Removed Lines]",
          "173:         $msg = PMA_Message::success(sprintf(__('Version %1$s was created, tracking for %2$s is active.'), htmlspecialchars($_REQUEST['version']), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table'])));",
          "",
          "[Added Lines]",
          "173:         $msg = PMA_Message::success(sprintf(",
          "174:             __('Version %1$s was created, tracking for %2$s is active.'),",
          "175:             htmlspecialchars($_REQUEST['version']),",
          "176:             htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table'])",
          "177:         ));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "179: if (isset($_REQUEST['submit_deactivate_now'])) {",
          "180:     if (PMA_Tracker::deactivateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "182:         $msg->display();",
          "183:     }",
          "184: }",
          "",
          "[Removed Lines]",
          "181:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s was deactivated at version %2$s.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), htmlspecialchars($_REQUEST['version'])));",
          "",
          "[Added Lines]",
          "185:         $msg = PMA_Message::success(sprintf(",
          "186:             __('Tracking for %1$s was deactivated at version %2$s.'),",
          "187:             htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']),",
          "188:             htmlspecialchars($_REQUEST['version'])",
          "189:         ));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "187: if (isset($_REQUEST['submit_activate_now'])) {",
          "188:     if (PMA_Tracker::activateTracking($GLOBALS['db'], $GLOBALS['table'], $_REQUEST['version'])) {",
          "190:         $msg->display();",
          "191:     }",
          "192: }",
          "",
          "[Removed Lines]",
          "189:         $msg = PMA_Message::success(sprintf(__('Tracking for %1$s was activated at version %2$s.'), htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']), htmlspecialchars($_REQUEST['version'])));",
          "",
          "[Added Lines]",
          "197:         $msg = PMA_Message::success(sprintf(",
          "198:             __('Tracking for %1$s was activated at version %2$s.'),",
          "199:             htmlspecialchars($GLOBALS['db'] . '.' . $GLOBALS['table']),",
          "200:             htmlspecialchars($_REQUEST['version'])",
          "201:         ));",
          "",
          "---------------"
        ]
      }
    }
  ]
}