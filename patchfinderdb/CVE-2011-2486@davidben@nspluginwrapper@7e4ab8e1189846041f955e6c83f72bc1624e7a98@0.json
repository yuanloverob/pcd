{
  "cve_id": "CVE-2011-2486",
  "cve_desc": "nspluginwrapper before 1.4.4 does not properly provide access to NPNVprivateModeBool variable settings, which could prevent Firefox plugins from determining if they should run in Private Browsing mode and allow remote attackers to bypass intended access restrictions, as demonstrated using Flash.",
  "repo": "davidben/nspluginwrapper",
  "patch_hash": "7e4ab8e1189846041f955e6c83f72bc1624e7a98",
  "patch_info": {
    "commit_hash": "7e4ab8e1189846041f955e6c83f72bc1624e7a98",
    "repo": "davidben/nspluginwrapper",
    "commit_url": "https://github.com/davidben/nspluginwrapper/commit/7e4ab8e1189846041f955e6c83f72bc1624e7a98",
    "files": [
      "src/npw-rpc.c",
      "src/npw-viewer.c",
      "src/utils.c"
    ],
    "message": "Support all the new variables added",
    "before_after_code_files": [
      "src/npw-rpc.c||src/npw-rpc.c",
      "src/npw-viewer.c||src/npw-viewer.c",
      "src/utils.c||src/utils.c"
    ]
  },
  "patch_diff": {
    "src/npw-rpc.c||src/npw-rpc.c": [
      "File: src/npw-rpc.c -> src/npw-rpc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "41:   case NPNVisOfflineBool:",
      "42:   case NPNVSupportsXEmbedBool:",
      "43:   case NPNVSupportsWindowless:",
      "44:  type = RPC_TYPE_BOOLEAN;",
      "45:  break;",
      "46:   case NPNVToolkit:",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "44:   case NPNVprivateModeBool:",
      "45:   case NPNVsupportsAdvancedKeyHandling:",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "65:   case NPPVpluginNameString:",
      "66:   case NPPVpluginDescriptionString:",
      "67:   case NPPVformValue: // byte values of 0 does not appear in the UTF-8 encoding but for U+0000",
      "68:  type = RPC_TYPE_STRING;",
      "69:  break;",
      "70:   case NPPVpluginWindowSize:",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "70:   case NPPVpluginNativeAccessibleAtkPlugId:",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "76:   case NPPVpluginTransparentBool:",
      "77:   case NPPVjavascriptPushCallerBool:",
      "78:   case NPPVpluginKeepLibraryInMemory:",
      "79:  type = RPC_TYPE_BOOLEAN;",
      "80:  break;",
      "81:   case NPPVpluginScriptableNPObject:",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "82:   case NPPVpluginUrlRequestsDisplayedBool:",
      "83:   case NPPVpluginWantsAllNetworkStreams:",
      "84:   case NPPVpluginCancelSrcStream:",
      "85:   case NPPVSupportsAdvancedKeyHandling:",
      "",
      "---------------"
    ],
    "src/npw-viewer.c||src/npw-viewer.c": [
      "File: src/npw-viewer.c -> src/npw-viewer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1302:   case NPNVSupportsXEmbedBool:",
      "1303:   case NPNVWindowNPObject:",
      "1304:   case NPNVPluginElementNPObject:",
      "1305:  return g_NPN_GetValue_real(instance, variable, value);",
      "1306:   default:",
      "1307:  switch (variable & 0xff) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1305:   case NPNVprivateModeBool:",
      "1306:   case NPNVsupportsAdvancedKeyHandling:",
      "",
      "---------------"
    ],
    "src/utils.c||src/utils.c": [
      "File: src/utils.c -> src/utils.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "247:  _(NPPVpluginNeedsXEmbed);",
      "248:  _(NPPVpluginScriptableNPObject);",
      "249:  _(NPPVformValue);",
      "250: #undef _",
      "251:   default:",
      "252:  switch (variable & 0xff) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "250:  _(NPPVpluginUrlRequestsDisplayedBool);",
      "251:  _(NPPVpluginWantsAllNetworkStreams);",
      "252:  _(NPPVpluginNativeAccessibleAtkPlugId);",
      "253:  _(NPPVpluginCancelSrcStream);",
      "254:  _(NPPVSupportsAdvancedKeyHandling);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "283:  _(NPNVWindowNPObject);",
      "284:  _(NPNVPluginElementNPObject);",
      "285:  _(NPNVSupportsWindowless);",
      "286: #undef _",
      "287:   default:",
      "288:  switch (variable & 0xff) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "291:  _(NPNVprivateModeBool);",
      "292:  _(NPNVsupportsAdvancedKeyHandling);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "00534b2b7cd3992745269aca71858f55544d0008",
      "candidate_info": {
        "commit_hash": "00534b2b7cd3992745269aca71858f55544d0008",
        "repo": "davidben/nspluginwrapper",
        "commit_url": "https://github.com/davidben/nspluginwrapper/commit/00534b2b7cd3992745269aca71858f55544d0008",
        "files": [
          "npapi/npapi.h",
          "src/npw-rpc.c",
          "src/utils.c"
        ],
        "message": "Pull in NPAPI SDK changes for DOM cursor control\n\nAlso update our code to support this variable and the change in\ncapitalization of NPPVsupportsAdvancedKeyHandling. No NPAPI version bump\nor additional hooks are required to support DOM cursor control.",
        "before_after_code_files": [
          "npapi/npapi.h||npapi/npapi.h",
          "src/npw-rpc.c||src/npw-rpc.c",
          "src/utils.c||src/utils.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/npw-rpc.c||src/npw-rpc.c",
            "src/utils.c||src/utils.c"
          ],
          "candidate": [
            "src/npw-rpc.c||src/npw-rpc.c",
            "src/utils.c||src/utils.c"
          ]
        }
      },
      "candidate_diff": {
        "npapi/npapi.h||npapi/npapi.h": [
          "File: npapi/npapi.h -> npapi/npapi.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "367:   NPPVpluginCancelSrcStream = 20,",
          "371: #if defined(XP_MACOSX)",
          "",
          "[Removed Lines]",
          "369:   NPPVSupportsAdvancedKeyHandling = 21",
          "",
          "[Added Lines]",
          "369:   NPPVsupportsAdvancedKeyHandling = 21,",
          "371:   NPPVpluginUsesDOMForCursorBool = 22",
          "",
          "---------------"
        ],
        "src/npw-rpc.c||src/npw-rpc.c": [
          "File: src/npw-rpc.c -> src/npw-rpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "82:   case NPPVpluginUrlRequestsDisplayedBool:",
          "83:   case NPPVpluginWantsAllNetworkStreams:",
          "84:   case NPPVpluginCancelSrcStream:",
          "86:  type = RPC_TYPE_BOOLEAN;",
          "87:  break;",
          "88:   case NPPVpluginScriptableNPObject:",
          "",
          "[Removed Lines]",
          "85:   case NPPVSupportsAdvancedKeyHandling:",
          "",
          "[Added Lines]",
          "85:   case NPPVsupportsAdvancedKeyHandling:",
          "86:   case NPPVpluginUsesDOMForCursorBool:",
          "",
          "---------------"
        ],
        "src/utils.c||src/utils.c": [
          "File: src/utils.c -> src/utils.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "253:  _(NPPVpluginWantsAllNetworkStreams);",
          "254:  _(NPPVpluginNativeAccessibleAtkPlugId);",
          "255:  _(NPPVpluginCancelSrcStream);",
          "257: #undef _",
          "258:   default:",
          "259:  switch (variable & 0xff) {",
          "",
          "[Removed Lines]",
          "256:  _(NPPVSupportsAdvancedKeyHandling);",
          "",
          "[Added Lines]",
          "256:  _(NPPVsupportsAdvancedKeyHandling);",
          "257:  _(NPPVpluginUsesDOMForCursorBool);",
          "",
          "---------------"
        ]
      }
    }
  ]
}