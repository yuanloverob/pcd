{
  "cve_id": "CVE-2014-3668",
  "cve_desc": "Buffer overflow in the date_from_ISO8601 function in the mkgmtime implementation in libxmlrpc/xmlrpc.c in the XMLRPC extension in PHP before 5.4.34, 5.5.x before 5.5.18, and 5.6.x before 5.6.2 allows remote attackers to cause a denial of service (application crash) via (1) a crafted first argument to the xmlrpc_set_type function or (2) a crafted argument to the xmlrpc_decode function, related to an out-of-bounds read operation.",
  "repo": "php/php-src",
  "patch_hash": "88412772d295ebf7dd34409534507dc9bcac726e",
  "patch_info": {
    "commit_hash": "88412772d295ebf7dd34409534507dc9bcac726e",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/88412772d295ebf7dd34409534507dc9bcac726e",
    "files": [
      "NEWS",
      "ext/xmlrpc/libxmlrpc/xmlrpc.c",
      "ext/xmlrpc/tests/bug68027.phpt"
    ],
    "message": "Fix bug #68027 - fix date parsing in XMLRPC lib",
    "before_after_code_files": [
      "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
      "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
    ]
  },
  "patch_diff": {
    "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
      "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "219:    n = 10;",
      "220:    tm.tm_mon = 0;",
      "221:    for(i = 0; i < 2; i++) {",
      "223:       tm.tm_mon += (text[i+4]-'0')*n;",
      "224:       n /= 10;",
      "225:    }",
      "226:    tm.tm_mon --;",
      "228:    n = 10;",
      "229:    tm.tm_mday = 0;",
      "230:    for(i = 0; i < 2; i++) {",
      "232:       tm.tm_mday += (text[i+6]-'0')*n;",
      "233:       n /= 10;",
      "234:    }",
      "",
      "[Removed Lines]",
      "222:       XMLRPC_IS_NUMBER(text[i])",
      "231:       XMLRPC_IS_NUMBER(text[i])",
      "",
      "[Added Lines]",
      "222:       XMLRPC_IS_NUMBER(text[i+4])",
      "227:    if(tm.tm_mon < 0 || tm.tm_mon > 11) {",
      "228:        return -1;",
      "229:    }",
      "234:       XMLRPC_IS_NUMBER(text[i+6])",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "236:    n = 10;",
      "237:    tm.tm_hour = 0;",
      "238:    for(i = 0; i < 2; i++) {",
      "240:       tm.tm_hour += (text[i+9]-'0')*n;",
      "241:       n /= 10;",
      "242:    }",
      "",
      "[Removed Lines]",
      "239:       XMLRPC_IS_NUMBER(text[i])",
      "",
      "[Added Lines]",
      "242:       XMLRPC_IS_NUMBER(text[i+9])",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "244:    n = 10;",
      "245:    tm.tm_min = 0;",
      "246:    for(i = 0; i < 2; i++) {",
      "248:       tm.tm_min += (text[i+12]-'0')*n;",
      "249:       n /= 10;",
      "250:    }",
      "",
      "[Removed Lines]",
      "247:       XMLRPC_IS_NUMBER(text[i])",
      "",
      "[Added Lines]",
      "250:       XMLRPC_IS_NUMBER(text[i+12])",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "252:    n = 10;",
      "253:    tm.tm_sec = 0;",
      "254:    for(i = 0; i < 2; i++) {",
      "256:       tm.tm_sec += (text[i+15]-'0')*n;",
      "257:       n /= 10;",
      "258:    }",
      "",
      "[Removed Lines]",
      "255:       XMLRPC_IS_NUMBER(text[i])",
      "",
      "[Added Lines]",
      "258:       XMLRPC_IS_NUMBER(text[i+15])",
      "",
      "---------------"
    ],
    "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt": [
      "File: ext/xmlrpc/tests/bug68027.phpt -> ext/xmlrpc/tests/bug68027.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #68027 (buffer overflow in mkgmtime() function)",
      "3: --SKIPIF--",
      "4: <?php",
      "5: if (!extension_loaded(\"xmlrpc\")) print \"skip\";",
      "6: ?>",
      "7: --FILE--",
      "8: <?php",
      "10: $d = '6-01-01 20:00:00';",
      "11: xmlrpc_set_type($d, 'datetime');",
      "12: var_dump($d);",
      "13: $datetime = \"2001-0-08T21:46:40-0400\";",
      "14: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
      "15: print_r($obj);",
      "17: $datetime = \"34770-0-08T21:46:40-0400\";",
      "18: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
      "19: print_r($obj);",
      "21: echo \"Done\\n\";",
      "22: ?>",
      "23: --EXPECTF--",
      "24: object(stdClass)#1 (3) {",
      "25:   [\"scalar\"]=>",
      "26:   string(16) \"6-01-01 20:00:00\"",
      "27:   [\"xmlrpc_type\"]=>",
      "28:   string(8) \"datetime\"",
      "29:   [\"timestamp\"]=>",
      "30:   int(%d)",
      "31: }",
      "32: stdClass Object",
      "33: (",
      "34:     [scalar] => 2001-0-08T21:46:40-0400",
      "35:     [xmlrpc_type] => datetime",
      "36:     [timestamp] => %s",
      "37: )",
      "38: stdClass Object",
      "39: (",
      "40:     [scalar] => 34770-0-08T21:46:40-0400",
      "41:     [xmlrpc_type] => datetime",
      "42:     [timestamp] => %d",
      "43: )",
      "44: Done",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "44035de79f5b9646064d9bdd0329a946b0c5372a",
      "candidate_info": {
        "commit_hash": "44035de79f5b9646064d9bdd0329a946b0c5372a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/44035de79f5b9646064d9bdd0329a946b0c5372a",
        "files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt"
        ],
        "message": "Fix bug #68027 - fix date parsing in XMLRPC lib",
        "before_after_code_files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ],
          "candidate": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
          "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "219:    n = 10;",
          "220:    tm.tm_mon = 0;",
          "221:    for(i = 0; i < 2; i++) {",
          "223:       tm.tm_mon += (text[i+4]-'0')*n;",
          "224:       n /= 10;",
          "225:    }",
          "226:    tm.tm_mon --;",
          "228:    n = 10;",
          "229:    tm.tm_mday = 0;",
          "230:    for(i = 0; i < 2; i++) {",
          "232:       tm.tm_mday += (text[i+6]-'0')*n;",
          "233:       n /= 10;",
          "234:    }",
          "",
          "[Removed Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i])",
          "231:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i+4])",
          "227:    if(tm.tm_mon < 0 || tm.tm_mon > 11) {",
          "228:        return -1;",
          "229:    }",
          "234:       XMLRPC_IS_NUMBER(text[i+6])",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "236:    n = 10;",
          "237:    tm.tm_hour = 0;",
          "238:    for(i = 0; i < 2; i++) {",
          "240:       tm.tm_hour += (text[i+9]-'0')*n;",
          "241:       n /= 10;",
          "242:    }",
          "",
          "[Removed Lines]",
          "239:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "242:       XMLRPC_IS_NUMBER(text[i+9])",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "244:    n = 10;",
          "245:    tm.tm_min = 0;",
          "246:    for(i = 0; i < 2; i++) {",
          "248:       tm.tm_min += (text[i+12]-'0')*n;",
          "249:       n /= 10;",
          "250:    }",
          "",
          "[Removed Lines]",
          "247:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "250:       XMLRPC_IS_NUMBER(text[i+12])",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "252:    n = 10;",
          "253:    tm.tm_sec = 0;",
          "254:    for(i = 0; i < 2; i++) {",
          "256:       tm.tm_sec += (text[i+15]-'0')*n;",
          "257:       n /= 10;",
          "258:    }",
          "",
          "[Removed Lines]",
          "255:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "258:       XMLRPC_IS_NUMBER(text[i+15])",
          "",
          "---------------"
        ],
        "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt": [
          "File: ext/xmlrpc/tests/bug68027.phpt -> ext/xmlrpc/tests/bug68027.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68027 (buffer overflow in mkgmtime() function)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded(\"xmlrpc\")) print \"skip\";",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "10: $d = '6-01-01 20:00:00';",
          "11: xmlrpc_set_type($d, 'datetime');",
          "12: var_dump($d);",
          "13: $datetime = \"2001-0-08T21:46:40-0400\";",
          "14: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "15: print_r($obj);",
          "17: $datetime = \"34770-0-08T21:46:40-0400\";",
          "18: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "19: print_r($obj);",
          "21: echo \"Done\\n\";",
          "22: ?>",
          "23: --EXPECTF--",
          "24: object(stdClass)#1 (3) {",
          "25:   [\"scalar\"]=>",
          "26:   string(16) \"6-01-01 20:00:00\"",
          "27:   [\"xmlrpc_type\"]=>",
          "28:   string(8) \"datetime\"",
          "29:   [\"timestamp\"]=>",
          "30:   int(%d)",
          "31: }",
          "32: stdClass Object",
          "33: (",
          "34:     [scalar] => 2001-0-08T21:46:40-0400",
          "35:     [xmlrpc_type] => datetime",
          "36:     [timestamp] => %s",
          "37: )",
          "38: stdClass Object",
          "39: (",
          "40:     [scalar] => 34770-0-08T21:46:40-0400",
          "41:     [xmlrpc_type] => datetime",
          "42:     [timestamp] => %d",
          "43: )",
          "44: Done",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2b261789a6db3d3eb62752f0a2576b3acdd9e3a7",
      "candidate_info": {
        "commit_hash": "2b261789a6db3d3eb62752f0a2576b3acdd9e3a7",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/2b261789a6db3d3eb62752f0a2576b3acdd9e3a7",
        "files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt"
        ],
        "message": "Fix bug #68027 - fix date parsing in XMLRPC lib",
        "before_after_code_files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ],
          "candidate": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
          "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "219:    n = 10;",
          "220:    tm.tm_mon = 0;",
          "221:    for(i = 0; i < 2; i++) {",
          "223:       tm.tm_mon += (text[i+4]-'0')*n;",
          "224:       n /= 10;",
          "225:    }",
          "226:    tm.tm_mon --;",
          "228:    n = 10;",
          "229:    tm.tm_mday = 0;",
          "230:    for(i = 0; i < 2; i++) {",
          "232:       tm.tm_mday += (text[i+6]-'0')*n;",
          "233:       n /= 10;",
          "234:    }",
          "",
          "[Removed Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i])",
          "231:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i+4])",
          "227:    if(tm.tm_mon < 0 || tm.tm_mon > 11) {",
          "228:        return -1;",
          "229:    }",
          "234:       XMLRPC_IS_NUMBER(text[i+6])",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "236:    n = 10;",
          "237:    tm.tm_hour = 0;",
          "238:    for(i = 0; i < 2; i++) {",
          "240:       tm.tm_hour += (text[i+9]-'0')*n;",
          "241:       n /= 10;",
          "242:    }",
          "",
          "[Removed Lines]",
          "239:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "242:       XMLRPC_IS_NUMBER(text[i+9])",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "244:    n = 10;",
          "245:    tm.tm_min = 0;",
          "246:    for(i = 0; i < 2; i++) {",
          "248:       tm.tm_min += (text[i+12]-'0')*n;",
          "249:       n /= 10;",
          "250:    }",
          "",
          "[Removed Lines]",
          "247:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "250:       XMLRPC_IS_NUMBER(text[i+12])",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "252:    n = 10;",
          "253:    tm.tm_sec = 0;",
          "254:    for(i = 0; i < 2; i++) {",
          "256:       tm.tm_sec += (text[i+15]-'0')*n;",
          "257:       n /= 10;",
          "258:    }",
          "",
          "[Removed Lines]",
          "255:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "258:       XMLRPC_IS_NUMBER(text[i+15])",
          "",
          "---------------"
        ],
        "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt": [
          "File: ext/xmlrpc/tests/bug68027.phpt -> ext/xmlrpc/tests/bug68027.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68027 (buffer overflow in mkgmtime() function)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded(\"xmlrpc\")) print \"skip\";",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "10: $d = '6-01-01 20:00:00';",
          "11: xmlrpc_set_type($d, 'datetime');",
          "12: var_dump($d);",
          "13: $datetime = \"2001-0-08T21:46:40-0400\";",
          "14: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "15: print_r($obj);",
          "17: $datetime = \"34770-0-08T21:46:40-0400\";",
          "18: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "19: print_r($obj);",
          "21: echo \"Done\\n\";",
          "22: ?>",
          "23: --EXPECTF--",
          "24: object(stdClass)#1 (3) {",
          "25:   [\"scalar\"]=>",
          "26:   string(16) \"6-01-01 20:00:00\"",
          "27:   [\"xmlrpc_type\"]=>",
          "28:   string(8) \"datetime\"",
          "29:   [\"timestamp\"]=>",
          "30:   int(%d)",
          "31: }",
          "32: stdClass Object",
          "33: (",
          "34:     [scalar] => 2001-0-08T21:46:40-0400",
          "35:     [xmlrpc_type] => datetime",
          "36:     [timestamp] => %s",
          "37: )",
          "38: stdClass Object",
          "39: (",
          "40:     [scalar] => 34770-0-08T21:46:40-0400",
          "41:     [xmlrpc_type] => datetime",
          "42:     [timestamp] => %d",
          "43: )",
          "44: Done",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2142d78281fe093043b50897d8a22f00910dfd0c",
      "candidate_info": {
        "commit_hash": "2142d78281fe093043b50897d8a22f00910dfd0c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/2142d78281fe093043b50897d8a22f00910dfd0c",
        "files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt"
        ],
        "message": "Fix bug #68027 - fix date parsing in XMLRPC lib",
        "before_after_code_files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ],
          "candidate": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
          "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "219:    n = 10;",
          "220:    tm.tm_mon = 0;",
          "221:    for(i = 0; i < 2; i++) {",
          "223:       tm.tm_mon += (text[i+4]-'0')*n;",
          "224:       n /= 10;",
          "225:    }",
          "226:    tm.tm_mon --;",
          "228:    n = 10;",
          "229:    tm.tm_mday = 0;",
          "230:    for(i = 0; i < 2; i++) {",
          "232:       tm.tm_mday += (text[i+6]-'0')*n;",
          "233:       n /= 10;",
          "234:    }",
          "",
          "[Removed Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i])",
          "231:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i+4])",
          "227:    if(tm.tm_mon < 0 || tm.tm_mon > 11) {",
          "228:        return -1;",
          "229:    }",
          "234:       XMLRPC_IS_NUMBER(text[i+6])",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "236:    n = 10;",
          "237:    tm.tm_hour = 0;",
          "238:    for(i = 0; i < 2; i++) {",
          "240:       tm.tm_hour += (text[i+9]-'0')*n;",
          "241:       n /= 10;",
          "242:    }",
          "",
          "[Removed Lines]",
          "239:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "242:       XMLRPC_IS_NUMBER(text[i+9])",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "244:    n = 10;",
          "245:    tm.tm_min = 0;",
          "246:    for(i = 0; i < 2; i++) {",
          "248:       tm.tm_min += (text[i+12]-'0')*n;",
          "249:       n /= 10;",
          "250:    }",
          "",
          "[Removed Lines]",
          "247:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "250:       XMLRPC_IS_NUMBER(text[i+12])",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "252:    n = 10;",
          "253:    tm.tm_sec = 0;",
          "254:    for(i = 0; i < 2; i++) {",
          "256:       tm.tm_sec += (text[i+15]-'0')*n;",
          "257:       n /= 10;",
          "258:    }",
          "",
          "[Removed Lines]",
          "255:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "258:       XMLRPC_IS_NUMBER(text[i+15])",
          "",
          "---------------"
        ],
        "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt": [
          "File: ext/xmlrpc/tests/bug68027.phpt -> ext/xmlrpc/tests/bug68027.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68027 (buffer overflow in mkgmtime() function)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded(\"xmlrpc\")) print \"skip\";",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "10: $d = '6-01-01 20:00:00';",
          "11: xmlrpc_set_type($d, 'datetime');",
          "12: var_dump($d);",
          "13: $datetime = \"2001-0-08T21:46:40-0400\";",
          "14: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "15: print_r($obj);",
          "17: $datetime = \"34770-0-08T21:46:40-0400\";",
          "18: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "19: print_r($obj);",
          "21: echo \"Done\\n\";",
          "22: ?>",
          "23: --EXPECTF--",
          "24: object(stdClass)#1 (3) {",
          "25:   [\"scalar\"]=>",
          "26:   string(16) \"6-01-01 20:00:00\"",
          "27:   [\"xmlrpc_type\"]=>",
          "28:   string(8) \"datetime\"",
          "29:   [\"timestamp\"]=>",
          "30:   int(%d)",
          "31: }",
          "32: stdClass Object",
          "33: (",
          "34:     [scalar] => 2001-0-08T21:46:40-0400",
          "35:     [xmlrpc_type] => datetime",
          "36:     [timestamp] => %s",
          "37: )",
          "38: stdClass Object",
          "39: (",
          "40:     [scalar] => 34770-0-08T21:46:40-0400",
          "41:     [xmlrpc_type] => datetime",
          "42:     [timestamp] => %d",
          "43: )",
          "44: Done",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5f64da15bb9c292e610454492af11975780b5eef",
      "candidate_info": {
        "commit_hash": "5f64da15bb9c292e610454492af11975780b5eef",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/5f64da15bb9c292e610454492af11975780b5eef",
        "files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt"
        ],
        "message": "Fix bug #68027 - fix date parsing in XMLRPC lib",
        "before_after_code_files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ],
          "candidate": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
          "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "219:    n = 10;",
          "220:    tm.tm_mon = 0;",
          "221:    for(i = 0; i < 2; i++) {",
          "223:       tm.tm_mon += (text[i+4]-'0')*n;",
          "224:       n /= 10;",
          "225:    }",
          "226:    tm.tm_mon --;",
          "228:    n = 10;",
          "229:    tm.tm_mday = 0;",
          "230:    for(i = 0; i < 2; i++) {",
          "232:       tm.tm_mday += (text[i+6]-'0')*n;",
          "233:       n /= 10;",
          "234:    }",
          "",
          "[Removed Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i])",
          "231:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i+4])",
          "227:    if(tm.tm_mon < 0 || tm.tm_mon > 11) {",
          "228:        return -1;",
          "229:    }",
          "234:       XMLRPC_IS_NUMBER(text[i+6])",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "236:    n = 10;",
          "237:    tm.tm_hour = 0;",
          "238:    for(i = 0; i < 2; i++) {",
          "240:       tm.tm_hour += (text[i+9]-'0')*n;",
          "241:       n /= 10;",
          "242:    }",
          "",
          "[Removed Lines]",
          "239:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "242:       XMLRPC_IS_NUMBER(text[i+9])",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "244:    n = 10;",
          "245:    tm.tm_min = 0;",
          "246:    for(i = 0; i < 2; i++) {",
          "248:       tm.tm_min += (text[i+12]-'0')*n;",
          "249:       n /= 10;",
          "250:    }",
          "",
          "[Removed Lines]",
          "247:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "250:       XMLRPC_IS_NUMBER(text[i+12])",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "252:    n = 10;",
          "253:    tm.tm_sec = 0;",
          "254:    for(i = 0; i < 2; i++) {",
          "256:       tm.tm_sec += (text[i+15]-'0')*n;",
          "257:       n /= 10;",
          "258:    }",
          "",
          "[Removed Lines]",
          "255:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "258:       XMLRPC_IS_NUMBER(text[i+15])",
          "",
          "---------------"
        ],
        "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt": [
          "File: ext/xmlrpc/tests/bug68027.phpt -> ext/xmlrpc/tests/bug68027.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68027 (buffer overflow in mkgmtime() function)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded(\"xmlrpc\")) print \"skip\";",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "10: $d = '6-01-01 20:00:00';",
          "11: xmlrpc_set_type($d, 'datetime');",
          "12: var_dump($d);",
          "13: $datetime = \"2001-0-08T21:46:40-0400\";",
          "14: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "15: print_r($obj);",
          "17: $datetime = \"34770-0-08T21:46:40-0400\";",
          "18: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "19: print_r($obj);",
          "21: echo \"Done\\n\";",
          "22: ?>",
          "23: --EXPECTF--",
          "24: object(stdClass)#1 (3) {",
          "25:   [\"scalar\"]=>",
          "26:   string(16) \"6-01-01 20:00:00\"",
          "27:   [\"xmlrpc_type\"]=>",
          "28:   string(8) \"datetime\"",
          "29:   [\"timestamp\"]=>",
          "30:   int(%d)",
          "31: }",
          "32: stdClass Object",
          "33: (",
          "34:     [scalar] => 2001-0-08T21:46:40-0400",
          "35:     [xmlrpc_type] => datetime",
          "36:     [timestamp] => %s",
          "37: )",
          "38: stdClass Object",
          "39: (",
          "40:     [scalar] => 34770-0-08T21:46:40-0400",
          "41:     [xmlrpc_type] => datetime",
          "42:     [timestamp] => %d",
          "43: )",
          "44: Done",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "886b8efbee605b6e5caa2e8d52475077757175fc",
      "candidate_info": {
        "commit_hash": "886b8efbee605b6e5caa2e8d52475077757175fc",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/886b8efbee605b6e5caa2e8d52475077757175fc",
        "files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt"
        ],
        "message": "Fix bug #68027 - fix date parsing in XMLRPC lib",
        "before_after_code_files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ],
          "candidate": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
          "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "219:    n = 10;",
          "220:    tm.tm_mon = 0;",
          "221:    for(i = 0; i < 2; i++) {",
          "223:       tm.tm_mon += (text[i+4]-'0')*n;",
          "224:       n /= 10;",
          "225:    }",
          "226:    tm.tm_mon --;",
          "228:    n = 10;",
          "229:    tm.tm_mday = 0;",
          "230:    for(i = 0; i < 2; i++) {",
          "232:       tm.tm_mday += (text[i+6]-'0')*n;",
          "233:       n /= 10;",
          "234:    }",
          "",
          "[Removed Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i])",
          "231:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "222:       XMLRPC_IS_NUMBER(text[i+4])",
          "227:    if(tm.tm_mon < 0 || tm.tm_mon > 11) {",
          "228:        return -1;",
          "229:    }",
          "234:       XMLRPC_IS_NUMBER(text[i+6])",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "236:    n = 10;",
          "237:    tm.tm_hour = 0;",
          "238:    for(i = 0; i < 2; i++) {",
          "240:       tm.tm_hour += (text[i+9]-'0')*n;",
          "241:       n /= 10;",
          "242:    }",
          "",
          "[Removed Lines]",
          "239:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "242:       XMLRPC_IS_NUMBER(text[i+9])",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "244:    n = 10;",
          "245:    tm.tm_min = 0;",
          "246:    for(i = 0; i < 2; i++) {",
          "248:       tm.tm_min += (text[i+12]-'0')*n;",
          "249:       n /= 10;",
          "250:    }",
          "",
          "[Removed Lines]",
          "247:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "250:       XMLRPC_IS_NUMBER(text[i+12])",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "252:    n = 10;",
          "253:    tm.tm_sec = 0;",
          "254:    for(i = 0; i < 2; i++) {",
          "256:       tm.tm_sec += (text[i+15]-'0')*n;",
          "257:       n /= 10;",
          "258:    }",
          "",
          "[Removed Lines]",
          "255:       XMLRPC_IS_NUMBER(text[i])",
          "",
          "[Added Lines]",
          "258:       XMLRPC_IS_NUMBER(text[i+15])",
          "",
          "---------------"
        ],
        "ext/xmlrpc/tests/bug68027.phpt||ext/xmlrpc/tests/bug68027.phpt": [
          "File: ext/xmlrpc/tests/bug68027.phpt -> ext/xmlrpc/tests/bug68027.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68027 (buffer overflow in mkgmtime() function)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded(\"xmlrpc\")) print \"skip\";",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "10: $d = '6-01-01 20:00:00';",
          "11: xmlrpc_set_type($d, 'datetime');",
          "12: var_dump($d);",
          "13: $datetime = \"2001-0-08T21:46:40-0400\";",
          "14: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "15: print_r($obj);",
          "17: $datetime = \"34770-0-08T21:46:40-0400\";",
          "18: $obj = xmlrpc_decode(\"<?xml version=\\\"1.0\\\"?><methodResponse><params><param><value><dateTime.iso8601>$datetime</dateTime.iso8601></value></param></params></methodResponse>\");",
          "19: print_r($obj);",
          "21: echo \"Done\\n\";",
          "22: ?>",
          "23: --EXPECTF--",
          "24: object(stdClass)#1 (3) {",
          "25:   [\"scalar\"]=>",
          "26:   string(16) \"6-01-01 20:00:00\"",
          "27:   [\"xmlrpc_type\"]=>",
          "28:   string(8) \"datetime\"",
          "29:   [\"timestamp\"]=>",
          "30:   int(%d)",
          "31: }",
          "32: stdClass Object",
          "33: (",
          "34:     [scalar] => 2001-0-08T21:46:40-0400",
          "35:     [xmlrpc_type] => datetime",
          "36:     [timestamp] => %s",
          "37: )",
          "38: stdClass Object",
          "39: (",
          "40:     [scalar] => 34770-0-08T21:46:40-0400",
          "41:     [xmlrpc_type] => datetime",
          "42:     [timestamp] => %d",
          "43: )",
          "44: Done",
          "",
          "---------------"
        ]
      }
    }
  ]
}