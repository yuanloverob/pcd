{
  "cve_id": "CVE-2015-8900",
  "cve_desc": "The ReadHDRImage function in coders/hdr.c in ImageMagick 6.x and 7.x allows remote attackers to cause a denial of service (infinite loop) via a crafted HDR file.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "97aa7d7cfd2027f6ba7ce42caf8b798541b9cdc6",
  "patch_info": {
    "commit_hash": "97aa7d7cfd2027f6ba7ce42caf8b798541b9cdc6",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/97aa7d7cfd2027f6ba7ce42caf8b798541b9cdc6",
    "files": [
      "coders/hdr.c"
    ],
    "message": "Fixed infinite loop and added checks for the sscanf result.",
    "before_after_code_files": [
      "coders/hdr.c||coders/hdr.c"
    ]
  },
  "patch_diff": {
    "coders/hdr.c||coders/hdr.c": [
      "File: coders/hdr.c -> coders/hdr.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "274:             c=ReadBlobByte(image);",
      "275:           }",
      "276:           if (LocaleCompare(keyword,\"Y\") == 0)",
      "278:           if (value_expected == MagickFalse)",
      "279:             continue;",
      "280:           p=value;",
      "",
      "[Removed Lines]",
      "277:             value_expected=MagickTrue;",
      "",
      "[Added Lines]",
      "277:             value_expected=MagickTrue;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "319:             {",
      "320:               if (LocaleCompare(keyword,\"primaries\") == 0)",
      "321:                 {",
      "334:                   image->chromaticity.blue_primary.x=chromaticity[4];",
      "335:                   image->chromaticity.blue_primary.y=chromaticity[5];",
      "336:                   image->chromaticity.white_point.x=white_point[0],",
      "",
      "[Removed Lines]",
      "322:                   float",
      "323:                     chromaticity[6],",
      "324:                     white_point[2];",
      "326:                   (void) sscanf(value,\"%g %g %g %g %g %g %g %g\",",
      "327:                     &chromaticity[0],&chromaticity[1],&chromaticity[2],",
      "328:                     &chromaticity[3],&chromaticity[4],&chromaticity[5],",
      "329:                     &white_point[0],&white_point[1]);",
      "330:                   image->chromaticity.red_primary.x=chromaticity[0];",
      "331:                   image->chromaticity.red_primary.y=chromaticity[1];",
      "332:                   image->chromaticity.green_primary.x=chromaticity[2];",
      "333:                   image->chromaticity.green_primary.y=chromaticity[3];",
      "",
      "[Added Lines]",
      "322:                   float",
      "323:                     chromaticity[6],",
      "324:                     white_point[2];",
      "326:                   if (sscanf(value,\"%g %g %g %g %g %g %g %g\",&chromaticity[0],",
      "327:                       &chromaticity[1],&chromaticity[2],&chromaticity[3],",
      "328:                       &chromaticity[4],&chromaticity[5],&white_point[0],",
      "329:                       &white_point[1]) == 8)",
      "330:                     {",
      "331:                       image->chromaticity.red_primary.x=chromaticity[0];",
      "332:                       image->chromaticity.red_primary.y=chromaticity[1];",
      "333:                       image->chromaticity.green_primary.x=chromaticity[2];",
      "334:                       image->chromaticity.green_primary.y=chromaticity[3];",
      "335:                       image->chromaticity.blue_primary.x=chromaticity[4];",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "350:               if (strcmp(keyword,target) == 0)",
      "351:                 {",
      "356:                   (void) sscanf(value,\"%d +X %d\",&height,&width);",
      "357:                   image->columns=(size_t) width;",
      "",
      "[Removed Lines]",
      "352:                   int",
      "353:                     height,",
      "354:                     width;",
      "",
      "[Added Lines]",
      "354:                   int",
      "355:                     height,",
      "356:                     width;",
      "358:                   if (sscanf(value,\"%d +X %d\",&height,&width) == 2)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "49c1cb3d17f2d45bc8d422e4b4c3e00b909b7714",
      "candidate_info": {
        "commit_hash": "49c1cb3d17f2d45bc8d422e4b4c3e00b909b7714",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/49c1cb3d17f2d45bc8d422e4b4c3e00b909b7714",
        "files": [
          "coders/hdr.c"
        ],
        "message": "",
        "before_after_code_files": [
          "coders/hdr.c||coders/hdr.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "coders/hdr.c||coders/hdr.c"
          ],
          "candidate": [
            "coders/hdr.c||coders/hdr.c"
          ]
        }
      },
      "candidate_diff": {
        "coders/hdr.c||coders/hdr.c": [
          "File: coders/hdr.c -> coders/hdr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "319:             {",
          "320:               if (LocaleCompare(keyword,\"primaries\") == 0)",
          "321:                 {",
          "326:                   if (sscanf(value,\"%g %g %g %g %g %g %g %g\",&chromaticity[0],",
          "327:                       &chromaticity[1],&chromaticity[2],&chromaticity[3],",
          "328:                       &chromaticity[4],&chromaticity[5],&white_point[0],",
          "",
          "[Removed Lines]",
          "322:                   float",
          "323:                     chromaticity[6],",
          "324:                     white_point[2];",
          "",
          "[Added Lines]",
          "322:                   float",
          "323:                     chromaticity[6],",
          "324:                     white_point[2];",
          "326:                   int",
          "327:                     count;",
          "329:                   count=sscanf(value,\"%g %g %g %g %g %g %g %g\",&chromaticity[0],",
          "",
          "---------------"
        ]
      }
    }
  ]
}