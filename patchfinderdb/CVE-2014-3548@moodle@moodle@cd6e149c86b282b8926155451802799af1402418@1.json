{
  "cve_id": "CVE-2014-3548",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in Moodle through 2.3.11, 2.4.x before 2.4.11, 2.5.x before 2.5.7, 2.6.x before 2.6.4, and 2.7.x before 2.7.1 allow remote attackers to inject arbitrary web script or HTML via vectors that trigger an AJAX exception dialog.",
  "repo": "moodle/moodle",
  "patch_hash": "cd6e149c86b282b8926155451802799af1402418",
  "patch_info": {
    "commit_hash": "cd6e149c86b282b8926155451802799af1402418",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/cd6e149c86b282b8926155451802799af1402418",
    "files": [
      "lib/yui/build/moodle-core-notification-ajaxexception/moodle-core-notification-ajaxexception-debug.js",
      "lib/yui/build/moodle-core-notification-ajaxexception/moodle-core-notification-ajaxexception-min.js",
      "lib/yui/build/moodle-core-notification-ajaxexception/moodle-core-notification-ajaxexception.js",
      "lib/yui/build/moodle-core-notification-dialogue/moodle-core-notification-dialogue-debug.js",
      "lib/yui/build/moodle-core-notification-dialogue/moodle-core-notification-dialogue-min.js",
      "lib/yui/build/moodle-core-notification-dialogue/moodle-core-notification-dialogue.js",
      "lib/yui/build/moodle-core-notification-exception/moodle-core-notification-exception-debug.js",
      "lib/yui/build/moodle-core-notification-exception/moodle-core-notification-exception-min.js",
      "lib/yui/build/moodle-core-notification-exception/moodle-core-notification-exception.js",
      "lib/yui/src/notification/js/ajaxexception.js",
      "lib/yui/src/notification/js/exception.js",
      "lib/yui/src/notification/meta/notification.json"
    ],
    "message": "MDL-45471 javascript: Escape content of exception dialogs",
    "before_after_code_files": [
      "lib/yui/src/notification/js/ajaxexception.js||lib/yui/src/notification/js/ajaxexception.js",
      "lib/yui/src/notification/js/exception.js||lib/yui/src/notification/js/exception.js"
    ]
  },
  "patch_diff": {
    "lib/yui/src/notification/js/ajaxexception.js||lib/yui/src/notification/js/ajaxexception.js": [
      "File: lib/yui/src/notification/js/ajaxexception.js -> lib/yui/src/notification/js/ajaxexception.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "30:             delay = this.get('hideTimeoutDelay');",
      "31:         this.get(BASE).addClass('moodle-dialogue-exception');",
      "32:         this.setStdModContent(Y.WidgetStdMod.HEADER,",
      "34:         content = Y.Node.create('<div class=\"moodle-ajaxexception\"></div>')",
      "36:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>URL:</label> ' +",
      "37:                         this.get('reproductionlink')+'</div>'))",
      "38:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>Debug info:</label> ' +",
      "40:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>' +",
      "42:         if (M.cfg.developerdebug) {",
      "43:             content.all('.moodle-exception-param').removeClass('hidden');",
      "44:         }",
      "",
      "[Removed Lines]",
      "33:                 '<h1 id=\"moodle-dialogue-'+this.get('COUNT')+'-header-text\">' + config.name + '</h1>', Y.WidgetStdMod.REPLACE);",
      "35:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+this.get('error')+'</div>'))",
      "39:                         this.get('debuginfo')+'</div>'))",
      "41:                         this.get('stacktrace')+'</pre></div>'));",
      "",
      "[Added Lines]",
      "33:                 '<h1 id=\"moodle-dialogue-'+this.get('COUNT')+'-header-text\">' + Y.Escape.html(config.name) + '</h1>',",
      "34:                 Y.WidgetStdMod.REPLACE);",
      "36:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+Y.Escape.html(this.get('error'))+'</div>'))",
      "40:                         Y.Escape.html(this.get('debuginfo'))+'</div>'))",
      "42:                         Y.Escape.html(this.get('stacktrace'))+'</pre></div>'));",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "111:         reproductionlink : {",
      "112:             setter : function(link) {",
      "113:                 if (link !== null) {",
      "114:                     link = '<a href=\"'+link+'\">'+link.replace(M.cfg.wwwroot, '')+'</a>';",
      "115:                 }",
      "116:                 return link;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "115:                     link = Y.Escape.html(link);",
      "",
      "---------------"
    ],
    "lib/yui/src/notification/js/exception.js||lib/yui/src/notification/js/exception.js": [
      "File: lib/yui/src/notification/js/exception.js -> lib/yui/src/notification/js/exception.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "46:             delay = this.get('hideTimeoutDelay');",
      "47:         this.get(BASE).addClass('moodle-dialogue-exception');",
      "48:         this.setStdModContent(Y.WidgetStdMod.HEADER,",
      "50:         content = Y.Node.create('<div class=\"moodle-exception\"></div>')",
      "52:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-filename\"><label>File:</label> ' +",
      "54:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-linenumber\"><label>Line:</label> ' +",
      "56:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>' +",
      "57:                         this.get('stack')+'</pre></div>'));",
      "58:         if (M.cfg.developerdebug) {",
      "",
      "[Removed Lines]",
      "49:                 '<h1 id=\"moodle-dialogue-'+config.COUNT+'-header-text\">' + config.name + '</h1>', Y.WidgetStdMod.REPLACE);",
      "51:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+this.get('message')+'</div>'))",
      "53:                         this.get('fileName')+'</div>'))",
      "55:                         this.get('lineNumber')+'</div>'))",
      "",
      "[Added Lines]",
      "49:                 '<h1 id=\"moodle-dialogue-'+config.COUNT+'-header-text\">' + Y.Escape.html(config.name) + '</h1>',",
      "50:                 Y.WidgetStdMod.REPLACE);",
      "52:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+Y.Escape.html(this.get('message'))+'</div>'))",
      "54:                         Y.Escape.html(this.get('fileName'))+'</div>'))",
      "56:                         Y.Escape.html(this.get('lineNumber'))+'</div>'))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "134:         stack : {",
      "135:             setter : function(str) {",
      "137:                     pattern = new RegExp('^(.+)@('+M.cfg.wwwroot+')?(.{0,75}).*:(\\\\d+)$'),",
      "138:                     i;",
      "139:                 for (i in lines) {",
      "",
      "[Removed Lines]",
      "136:                 var lines = str.split(\"\\n\"),",
      "",
      "[Added Lines]",
      "137:                 var lines = Y.Escape.html(str).split(\"\\n\"),",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "53ca351f7af8d80a0ff0aba27a1c278fb731d288",
      "candidate_info": {
        "commit_hash": "53ca351f7af8d80a0ff0aba27a1c278fb731d288",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/53ca351f7af8d80a0ff0aba27a1c278fb731d288",
        "files": [
          "lib/yui/build/moodle-core-notification-ajaxexception/moodle-core-notification-ajaxexception-debug.js",
          "lib/yui/build/moodle-core-notification-ajaxexception/moodle-core-notification-ajaxexception-min.js",
          "lib/yui/build/moodle-core-notification-ajaxexception/moodle-core-notification-ajaxexception.js",
          "lib/yui/build/moodle-core-notification-dialogue/moodle-core-notification-dialogue-debug.js",
          "lib/yui/build/moodle-core-notification-dialogue/moodle-core-notification-dialogue-min.js",
          "lib/yui/build/moodle-core-notification-dialogue/moodle-core-notification-dialogue.js",
          "lib/yui/build/moodle-core-notification-exception/moodle-core-notification-exception-debug.js",
          "lib/yui/build/moodle-core-notification-exception/moodle-core-notification-exception-min.js",
          "lib/yui/build/moodle-core-notification-exception/moodle-core-notification-exception.js",
          "lib/yui/src/notification/js/ajaxexception.js",
          "lib/yui/src/notification/js/exception.js",
          "lib/yui/src/notification/meta/notification.json"
        ],
        "message": "MDL-45471 javascript: Escape content of exception dialogs",
        "before_after_code_files": [
          "lib/yui/src/notification/js/ajaxexception.js||lib/yui/src/notification/js/ajaxexception.js",
          "lib/yui/src/notification/js/exception.js||lib/yui/src/notification/js/exception.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/yui/src/notification/js/ajaxexception.js||lib/yui/src/notification/js/ajaxexception.js",
            "lib/yui/src/notification/js/exception.js||lib/yui/src/notification/js/exception.js"
          ],
          "candidate": [
            "lib/yui/src/notification/js/ajaxexception.js||lib/yui/src/notification/js/ajaxexception.js",
            "lib/yui/src/notification/js/exception.js||lib/yui/src/notification/js/exception.js"
          ]
        }
      },
      "candidate_diff": {
        "lib/yui/src/notification/js/ajaxexception.js||lib/yui/src/notification/js/ajaxexception.js": [
          "File: lib/yui/src/notification/js/ajaxexception.js -> lib/yui/src/notification/js/ajaxexception.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "30:             delay = this.get('hideTimeoutDelay');",
          "31:         this.get(BASE).addClass('moodle-dialogue-exception');",
          "32:         this.setStdModContent(Y.WidgetStdMod.HEADER,",
          "34:         content = Y.Node.create('<div class=\"moodle-ajaxexception\"></div>')",
          "36:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>URL:</label> ' +",
          "37:                         this.get('reproductionlink')+'</div>'))",
          "38:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>Debug info:</label> ' +",
          "40:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>' +",
          "42:         if (M.cfg.developerdebug) {",
          "43:             content.all('.moodle-exception-param').removeClass('hidden');",
          "44:         }",
          "",
          "[Removed Lines]",
          "33:                 '<h1 id=\"moodle-dialogue-'+this.get('COUNT')+'-header-text\">' + config.name + '</h1>', Y.WidgetStdMod.REPLACE);",
          "35:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+this.get('error')+'</div>'))",
          "39:                         this.get('debuginfo')+'</div>'))",
          "41:                         this.get('stacktrace')+'</pre></div>'));",
          "",
          "[Added Lines]",
          "33:                 '<h1 id=\"moodle-dialogue-'+this.get('COUNT')+'-header-text\">' + Y.Escape.html(config.name) + '</h1>',",
          "34:                 Y.WidgetStdMod.REPLACE);",
          "36:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+Y.Escape.html(this.get('error'))+'</div>'))",
          "40:                         Y.Escape.html(this.get('debuginfo'))+'</div>'))",
          "42:                         Y.Escape.html(this.get('stacktrace'))+'</pre></div>'));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "111:         reproductionlink : {",
          "112:             setter : function(link) {",
          "113:                 if (link !== null) {",
          "114:                     link = '<a href=\"'+link+'\">'+link.replace(M.cfg.wwwroot, '')+'</a>';",
          "115:                 }",
          "116:                 return link;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "115:                     link = Y.Escape.html(link);",
          "",
          "---------------"
        ],
        "lib/yui/src/notification/js/exception.js||lib/yui/src/notification/js/exception.js": [
          "File: lib/yui/src/notification/js/exception.js -> lib/yui/src/notification/js/exception.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "46:             delay = this.get('hideTimeoutDelay');",
          "47:         this.get(BASE).addClass('moodle-dialogue-exception');",
          "48:         this.setStdModContent(Y.WidgetStdMod.HEADER,",
          "50:         content = Y.Node.create('<div class=\"moodle-exception\"></div>')",
          "52:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-filename\"><label>File:</label> ' +",
          "54:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-linenumber\"><label>Line:</label> ' +",
          "56:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>' +",
          "57:                         this.get('stack')+'</pre></div>'));",
          "58:         if (M.cfg.developerdebug) {",
          "",
          "[Removed Lines]",
          "49:                 '<h1 id=\"moodle-dialogue-'+config.COUNT+'-header-text\">' + config.name + '</h1>', Y.WidgetStdMod.REPLACE);",
          "51:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+this.get('message')+'</div>'))",
          "53:                         this.get('fileName')+'</div>'))",
          "55:                         this.get('lineNumber')+'</div>'))",
          "",
          "[Added Lines]",
          "49:                 '<h1 id=\"moodle-dialogue-'+config.COUNT+'-header-text\">' + Y.Escape.html(config.name) + '</h1>',",
          "50:                 Y.WidgetStdMod.REPLACE);",
          "52:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+Y.Escape.html(this.get('message'))+'</div>'))",
          "54:                         Y.Escape.html(this.get('fileName'))+'</div>'))",
          "56:                         Y.Escape.html(this.get('lineNumber'))+'</div>'))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "134:         stack : {",
          "135:             setter : function(str) {",
          "137:                     pattern = new RegExp('^(.+)@('+M.cfg.wwwroot+')?(.{0,75}).*:(\\\\d+)$'),",
          "138:                     i;",
          "139:                 for (i in lines) {",
          "",
          "[Removed Lines]",
          "136:                 var lines = str.split(\"\\n\"),",
          "",
          "[Added Lines]",
          "137:                 var lines = Y.Escape.html(str).split(\"\\n\"),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6eb787b873f5d3718dc8a74f798ee528d600d8fe",
      "candidate_info": {
        "commit_hash": "6eb787b873f5d3718dc8a74f798ee528d600d8fe",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/6eb787b873f5d3718dc8a74f798ee528d600d8fe",
        "files": [
          "lib/yui/build/moodle-core-notification/moodle-core-notification-debug.js",
          "lib/yui/build/moodle-core-notification/moodle-core-notification-min.js",
          "lib/yui/build/moodle-core-notification/moodle-core-notification.js",
          "lib/yui/src/notification/js/notification.js",
          "lib/yui/src/notification/meta/notification.json"
        ],
        "message": "MDL-45471 javascript: Escape content of exception dialogs",
        "before_after_code_files": [
          "lib/yui/src/notification/js/notification.js||lib/yui/src/notification/js/notification.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/yui/src/notification/js/notification.js||lib/yui/src/notification/js/notification.js": [
          "File: lib/yui/src/notification/js/notification.js -> lib/yui/src/notification/js/notification.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "300:             delay = this.get('hideTimeoutDelay');",
          "301:         this.get(BASE).addClass('moodle-dialogue-exception');",
          "302:         this.setStdModContent(Y.WidgetStdMod.HEADER, '<h1 id=\"moodle-dialogue-'+this.get('COUNT')+'-header-text\">'",
          "304:         content = Y.Node.create('<div class=\"moodle-exception\"></div>')",
          "306:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-filename\"><label>File:</label> '",
          "308:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-linenumber\"><label>Line:</label> '",
          "310:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>'",
          "311:                         + this.get('stack')+'</pre></div>'));",
          "312:         if (M.cfg.developerdebug) {",
          "",
          "[Removed Lines]",
          "303:                 + config.name + '</h1>', Y.WidgetStdMod.REPLACE);",
          "305:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+this.get('message')+'</div>'))",
          "307:                         + this.get('fileName')+'</div>'))",
          "309:                         + this.get('lineNumber')+'</div>'))",
          "",
          "[Added Lines]",
          "303:                 + Y.Escape.html(config.name) + '</h1>', Y.WidgetStdMod.REPLACE);",
          "305:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+Y.Escape.html(this.get('message'))+'</div>'))",
          "307:                         + Y.Escape.html(this.get('fileName'))+'</div>'))",
          "309:                         + Y.Escape.html(this.get('lineNumber'))+'</div>'))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "349:         },",
          "350:         stack : {",
          "351:             setter : function(str) {",
          "353:                     pattern = new RegExp('^(.+)@('+M.cfg.wwwroot+')?(.{0,75}).*:(\\\\d+)$'),",
          "354:                     i;",
          "355:                 for (i in lines) {",
          "",
          "[Removed Lines]",
          "352:                 var lines = str.split(\"\\n\"),",
          "",
          "[Added Lines]",
          "352:                 var lines = Y.Escape.html(str).split(\"\\n\"),",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "380:             delay = this.get('hideTimeoutDelay');",
          "381:         this.get(BASE).addClass('moodle-dialogue-exception');",
          "382:         this.setStdModContent(Y.WidgetStdMod.HEADER, '<h1 id=\"moodle-dialogue-'+this.get('COUNT')+'-header-text\">'",
          "384:         content = Y.Node.create('<div class=\"moodle-ajaxexception\"></div>')",
          "386:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>URL:</label> '",
          "387:                         + this.get('reproductionlink')+'</div>'))",
          "388:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>Debug info:</label> '",
          "390:                 .append(Y.Node.create('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>'",
          "392:         if (M.cfg.developerdebug) {",
          "393:             content.all('.moodle-exception-param').removeClass('hidden');",
          "394:         }",
          "",
          "[Removed Lines]",
          "383:                 + config.name + '</h1>', Y.WidgetStdMod.REPLACE);",
          "385:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+this.get('error')+'</div>'))",
          "389:                         + this.get('debuginfo')+'</div>'))",
          "391:                         + this.get('stacktrace')+'</pre></div>'));",
          "",
          "[Added Lines]",
          "383:                 + Y.Escape.html(config.name) + '</h1>', Y.WidgetStdMod.REPLACE);",
          "385:                 .append(Y.Node.create('<div class=\"moodle-exception-message\">'+Y.Escape.html(this.get('error'))+'</div>'))",
          "389:                         + Y.Escape.html(this.get('debuginfo'))+'</div>'))",
          "391:                         + Y.Escape.html(this.get('stacktrace'))+'</pre></div>'));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "425:         reproductionlink : {",
          "426:             setter : function(link) {",
          "427:                 if (link !== null) {",
          "428:                     link = '<a href=\"'+link+'\">'+link.replace(M.cfg.wwwroot, '')+'</a>';",
          "429:                 }",
          "430:                 return link;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "428:                     link = Y.Escape.html(link);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a1ae35173b54ed0c2c3736dfa78cad9899a55d4e",
      "candidate_info": {
        "commit_hash": "a1ae35173b54ed0c2c3736dfa78cad9899a55d4e",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/a1ae35173b54ed0c2c3736dfa78cad9899a55d4e",
        "files": [
          "lib/yui/notification/notification.js"
        ],
        "message": "MDL-45471 javascript: Escape content of exception dialogs",
        "before_after_code_files": [
          "lib/yui/notification/notification.js||lib/yui/notification/notification.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/yui/notification/notification.js||lib/yui/notification/notification.js": [
          "File: lib/yui/notification/notification.js -> lib/yui/notification/notification.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "254:     _keypress : null,",
          "255:     initializer : function(config) {",
          "256:         this.get(BASE).addClass('moodle-dialogue-exception');",
          "258:         var content = C('<div class=\"moodle-exception\"></div>')",
          "262:                     .append(C('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>'+this.get('stack')+'</pre></div>'));",
          "263:         if (M.cfg.developerdebug) {",
          "264:             content.all('.moodle-exception-param').removeClass('hidden');",
          "",
          "[Removed Lines]",
          "257:         this.setStdModContent(Y.WidgetStdMod.HEADER, '<h1 id=\"moodle-dialogue-'+COUNT+'-header-text\">' + config.name + '</h1>', Y.WidgetStdMod.REPLACE);",
          "259:                     .append(C('<div class=\"moodle-exception-message\">'+this.get('message')+'</div>'))",
          "260:                     .append(C('<div class=\"moodle-exception-param hidden param-filename\"><label>File:</label> '+this.get('fileName')+'</div>'))",
          "261:                     .append(C('<div class=\"moodle-exception-param hidden param-linenumber\"><label>Line:</label> '+this.get('lineNumber')+'</div>'))",
          "",
          "[Added Lines]",
          "257:         this.setStdModContent(Y.WidgetStdMod.HEADER, '<h1 id=\"moodle-dialogue-'+COUNT+'-header-text\">' + Y.Escape.html(config.name) + '</h1>', Y.WidgetStdMod.REPLACE);",
          "259:                     .append(C('<div class=\"moodle-exception-message\">'+Y.Escape.html(this.get('message'))+'</div>'))",
          "260:                     .append(C('<div class=\"moodle-exception-param hidden param-filename\"><label>File:</label> '+Y.Escape.html(this.get('fileName'))+'</div>'))",
          "261:                     .append(C('<div class=\"moodle-exception-param hidden param-linenumber\"><label>Line:</label> '+Y.Escape.html(this.get('lineNumber'))+'</div>'))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "300:         },",
          "301:         stack : {",
          "302:             setter : function(str) {",
          "304:                 var pattern = new RegExp('^(.+)@('+M.cfg.wwwroot+')?(.{0,75}).*:(\\\\d+)$');",
          "305:                 for (var i in lines) {",
          "306:                     lines[i] = lines[i].replace(pattern, \"<div class='stacktrace-line'>ln: $4</div><div class='stacktrace-file'>$3</div><div class='stacktrace-call'>$1</div>\");",
          "",
          "[Removed Lines]",
          "303:                 var lines = str.split(\"\\n\");",
          "",
          "[Added Lines]",
          "303:                 var lines = Y.Escape.html(str).split(\"\\n\");",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "325:     _keypress : null,",
          "326:     initializer : function(config) {",
          "327:         this.get(BASE).addClass('moodle-dialogue-exception');",
          "329:         var content = C('<div class=\"moodle-ajaxexception\"></div>')",
          "331:                     .append(C('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>URL:</label> '+this.get('reproductionlink')+'</div>'))",
          "334:         if (M.cfg.developerdebug) {",
          "335:             content.all('.moodle-exception-param').removeClass('hidden');",
          "336:         }",
          "",
          "[Removed Lines]",
          "328:         this.setStdModContent(Y.WidgetStdMod.HEADER, '<h1 id=\"moodle-dialogue-'+COUNT+'-header-text\">' + config.name + '</h1>', Y.WidgetStdMod.REPLACE);",
          "330:                     .append(C('<div class=\"moodle-exception-message\">'+this.get('error')+'</div>'))",
          "332:                     .append(C('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>Debug info:</label> '+this.get('debuginfo')+'</div>'))",
          "333:                     .append(C('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>'+this.get('stacktrace')+'</pre></div>'));",
          "",
          "[Added Lines]",
          "328:         this.setStdModContent(Y.WidgetStdMod.HEADER, '<h1 id=\"moodle-dialogue-'+COUNT+'-header-text\">' + Y.Escape.html(config.name) + '</h1>', Y.WidgetStdMod.REPLACE);",
          "330:                     .append(C('<div class=\"moodle-exception-message\">'+Y.Escape.html(this.get('error'))+'</div>'))",
          "332:                     .append(C('<div class=\"moodle-exception-param hidden param-debuginfo\"><label>Debug info:</label> '+Y.Escape.html(this.get('debuginfo'))+'</div>'))",
          "333:                     .append(C('<div class=\"moodle-exception-param hidden param-stacktrace\"><label>Stack trace:</label> <pre>'+Y.Escape.html(this.get('stacktrace'))+'</pre></div>'));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "369:         reproductionlink : {",
          "370:             setter : function(link) {",
          "371:                 if (link !== null) {",
          "372:                     link = '<a href=\"'+link+'\">'+link.replace(M.cfg.wwwroot, '')+'</a>';",
          "373:                 }",
          "374:                 return link;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "372:                     link = Y.Escape.html(link)",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "389: M.core.exception = EXCEPTION;",
          "390: M.core.ajaxException = AJAXEXCEPTION;",
          "",
          "[Removed Lines]",
          "392: }, '@VERSION@', {requires:['base','node','panel','event-key', 'moodle-core-notification-skin', 'dd-plugin']});",
          "",
          "[Added Lines]",
          "393: }, '@VERSION@', {requires:['base','node','panel','escape','event-key', 'moodle-core-notification-skin', 'dd-plugin']});",
          "",
          "---------------"
        ]
      }
    }
  ]
}