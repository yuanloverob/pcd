{
  "cve_id": "CVE-2014-3515",
  "cve_desc": "The SPL component in PHP before 5.4.30 and 5.5.x before 5.5.14 incorrectly anticipates that certain data structures will have the array data type after unserialization, which allows remote attackers to execute arbitrary code via a crafted string that triggers use of a Hashtable destructor, related to \"type confusion\" issues in (1) ArrayObject and (2) SPLObjectStorage.",
  "repo": "php/php-src",
  "patch_hash": "88223c5245e9b470e1e6362bfd96829562ffe6ab",
  "patch_info": {
    "commit_hash": "88223c5245e9b470e1e6362bfd96829562ffe6ab",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/88223c5245e9b470e1e6362bfd96829562ffe6ab",
    "files": [
      "NEWS",
      "ext/spl/spl_array.c",
      "ext/spl/spl_observer.c",
      "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
    ],
    "message": "Fix bug #67492: unserialize() SPL ArrayObject / SPLObjectStorage Type Confusion",
    "before_after_code_files": [
      "ext/spl/spl_array.c||ext/spl/spl_array.c",
      "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
      "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
    ]
  },
  "patch_diff": {
    "ext/spl/spl_array.c||ext/spl/spl_array.c": [
      "File: ext/spl/spl_array.c -> ext/spl/spl_array.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1808:  ++p;",
      "1810:  ALLOC_INIT_ZVAL(pmembers);",
      "1812:   zval_ptr_dtor(&pmembers);",
      "1813:   goto outexcept;",
      "1814:  }",
      "",
      "[Removed Lines]",
      "1811:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
      "",
      "[Added Lines]",
      "1811:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
      "",
      "---------------"
    ],
    "ext/spl/spl_observer.c||ext/spl/spl_observer.c": [
      "File: ext/spl/spl_observer.c -> ext/spl/spl_observer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "898:  ++p;",
      "900:  ALLOC_INIT_ZVAL(pmembers);",
      "902:   zval_ptr_dtor(&pmembers);",
      "903:   goto outexcept;",
      "904:  }",
      "",
      "[Removed Lines]",
      "901:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
      "",
      "[Added Lines]",
      "901:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
      "",
      "---------------"
    ],
    "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt": [
      "File: ext/spl/tests/SplObjectStorage_unserialize_bad.phpt -> ext/spl/tests/SplObjectStorage_unserialize_bad.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "7: 'x:i:2;i:0;,i:1;;i:0;,i:2;;m:a:0:{}',",
      "8: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};R:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
      "9: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};r:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
      "10: );",
      "11: foreach($badblobs as $blob) {",
      "12: try {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "10: 'x:i:1;O:8:\"stdClass\":0:{},N;;m:s:40:\"1234567890123456789012345678901234567890\"',",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "17:  echo $e->getMessage().\"\\n\";",
      "18: }",
      "19: }",
      "20: --EXPECTF--",
      "21: Error at offset 6 of 34 bytes",
      "22: Error at offset 46 of 89 bytes",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "21: echo \"DONE\\n\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "42:     }",
      "43:   }",
      "44: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "47: Error at offset 79 of 78 bytes",
      "48: DONE",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a374dfab567ff7f0ab0dc150f14cc891b0340b47",
      "candidate_info": {
        "commit_hash": "a374dfab567ff7f0ab0dc150f14cc891b0340b47",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/a374dfab567ff7f0ab0dc150f14cc891b0340b47",
        "files": [
          "ext/spl/spl_array.c",
          "ext/spl/spl_observer.c",
          "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
        ],
        "message": "Fix bug #67492: unserialize() SPL ArrayObject / SPLObjectStorage Type Confusion",
        "before_after_code_files": [
          "ext/spl/spl_array.c||ext/spl/spl_array.c",
          "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
          "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/spl/spl_array.c||ext/spl/spl_array.c",
            "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
            "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
          ],
          "candidate": [
            "ext/spl/spl_array.c||ext/spl/spl_array.c",
            "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
            "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/spl/spl_array.c||ext/spl/spl_array.c": [
          "File: ext/spl/spl_array.c -> ext/spl/spl_array.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1804:  ++p;",
          "1806:  ALLOC_INIT_ZVAL(pmembers);",
          "1808:   zval_ptr_dtor(&pmembers);",
          "1809:   goto outexcept;",
          "1810:  }",
          "",
          "[Removed Lines]",
          "1807:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "1807:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/spl/spl_observer.c||ext/spl/spl_observer.c": [
          "File: ext/spl/spl_observer.c -> ext/spl/spl_observer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "914:  ++p;",
          "916:  ALLOC_INIT_ZVAL(pmembers);",
          "918:   zval_ptr_dtor(&pmembers);",
          "919:   goto outexcept;",
          "920:  }",
          "",
          "[Removed Lines]",
          "917:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "917:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt": [
          "File: ext/spl/tests/SplObjectStorage_unserialize_bad.phpt -> ext/spl/tests/SplObjectStorage_unserialize_bad.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: 'x:i:2;i:0;,i:1;;i:0;,i:2;;m:a:0:{}',",
          "8: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};R:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "9: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};r:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "10: );",
          "11: foreach($badblobs as $blob) {",
          "12: try {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: 'x:i:1;O:8:\"stdClass\":0:{},N;;m:s:40:\"1234567890123456789012345678901234567890\"',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "17:  echo $e->getMessage().\"\\n\";",
          "18: }",
          "19: }",
          "20: --EXPECTF--",
          "21: Error at offset 6 of 34 bytes",
          "22: Error at offset 46 of 89 bytes",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: echo \"DONE\\n\";",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "42:     }",
          "43:   }",
          "44: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "47: Error at offset 79 of 78 bytes",
          "48: DONE",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b03993dde90b59a6b80ede62a6a268c5b4d390f6",
      "candidate_info": {
        "commit_hash": "b03993dde90b59a6b80ede62a6a268c5b4d390f6",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/b03993dde90b59a6b80ede62a6a268c5b4d390f6",
        "files": [
          "ext/spl/spl_array.c",
          "ext/spl/spl_observer.c",
          "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
        ],
        "message": "Fix bug #67492: unserialize() SPL ArrayObject / SPLObjectStorage Type Confusion",
        "before_after_code_files": [
          "ext/spl/spl_array.c||ext/spl/spl_array.c",
          "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
          "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/spl/spl_array.c||ext/spl/spl_array.c",
            "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
            "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
          ],
          "candidate": [
            "ext/spl/spl_array.c||ext/spl/spl_array.c",
            "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
            "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/spl/spl_array.c||ext/spl/spl_array.c": [
          "File: ext/spl/spl_array.c -> ext/spl/spl_array.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1804:  ++p;",
          "1806:  ALLOC_INIT_ZVAL(pmembers);",
          "1808:   zval_ptr_dtor(&pmembers);",
          "1809:   goto outexcept;",
          "1810:  }",
          "",
          "[Removed Lines]",
          "1807:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "1807:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/spl/spl_observer.c||ext/spl/spl_observer.c": [
          "File: ext/spl/spl_observer.c -> ext/spl/spl_observer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "914:  ++p;",
          "916:  ALLOC_INIT_ZVAL(pmembers);",
          "918:   zval_ptr_dtor(&pmembers);",
          "919:   goto outexcept;",
          "920:  }",
          "",
          "[Removed Lines]",
          "917:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "917:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt": [
          "File: ext/spl/tests/SplObjectStorage_unserialize_bad.phpt -> ext/spl/tests/SplObjectStorage_unserialize_bad.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: 'x:i:2;i:0;,i:1;;i:0;,i:2;;m:a:0:{}',",
          "8: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};R:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "9: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};r:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "10: );",
          "11: foreach($badblobs as $blob) {",
          "12: try {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: 'x:i:1;O:8:\"stdClass\":0:{},N;;m:s:40:\"1234567890123456789012345678901234567890\"',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "17:  echo $e->getMessage().\"\\n\";",
          "18: }",
          "19: }",
          "20: --EXPECTF--",
          "21: Error at offset 6 of 34 bytes",
          "22: Error at offset 46 of 89 bytes",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: echo \"DONE\\n\";",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "42:     }",
          "43:   }",
          "44: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "47: Error at offset 79 of 78 bytes",
          "48: DONE",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c74efe1b2efd7222b27d36f383623cd19ed0e102",
      "candidate_info": {
        "commit_hash": "c74efe1b2efd7222b27d36f383623cd19ed0e102",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/c74efe1b2efd7222b27d36f383623cd19ed0e102",
        "files": [
          "ext/spl/spl_array.c",
          "ext/spl/spl_observer.c",
          "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
        ],
        "message": "Fix bug #67492: unserialize() SPL ArrayObject / SPLObjectStorage Type Confusion\n\nConflicts:\n\text/spl/spl_array.c\n\text/spl/tests/SplObjectStorage_unserialize_bad.phpt",
        "before_after_code_files": [
          "ext/spl/spl_array.c||ext/spl/spl_array.c",
          "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
          "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "ext/spl/spl_array.c||ext/spl/spl_array.c",
            "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
            "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
          ],
          "candidate": [
            "ext/spl/spl_array.c||ext/spl/spl_array.c",
            "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
            "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/spl/spl_array.c||ext/spl/spl_array.c": [
          "File: ext/spl/spl_array.c -> ext/spl/spl_array.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1816:  ++p;",
          "1818:  ALLOC_INIT_ZVAL(pmembers);",
          "1820:   zval_ptr_dtor(&pmembers);",
          "1821:   goto outexcept;",
          "1822:  }",
          "",
          "[Removed Lines]",
          "1819:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, var_hash_p TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "1819:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, var_hash_p TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/spl/spl_observer.c||ext/spl/spl_observer.c": [
          "File: ext/spl/spl_observer.c -> ext/spl/spl_observer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "801:  ++p;",
          "803:  ALLOC_INIT_ZVAL(pmembers);",
          "805:   zval_ptr_dtor(&pmembers);",
          "806:   goto outexcept;",
          "807:  }",
          "",
          "[Removed Lines]",
          "804:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "804:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt": [
          "File: ext/spl/tests/SplObjectStorage_unserialize_bad.phpt -> ext/spl/tests/SplObjectStorage_unserialize_bad.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: $badblobs = array(",
          "7: 'x:i:2;i:0;,i:1;;i:0;,i:2;;m:a:0:{}',",
          "10: );",
          "11: foreach($badblobs as $blob) {",
          "12: try {",
          "",
          "[Removed Lines]",
          "8: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};R:1;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "9: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};r:1;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "",
          "[Added Lines]",
          "8: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};R:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "9: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};r:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "10: 'x:i:1;O:8:\"stdClass\":0:{},N;;m:s:40:\"1234567890123456789012345678901234567890\"',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "17:  echo $e->getMessage().\"\\n\";",
          "18: }",
          "19: }",
          "20: --EXPECTF--",
          "21: Error at offset 6 of 34 bytes",
          "22: Error at offset 46 of 89 bytes",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: echo \"DONE\\n\";",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "42:     }",
          "43:   }",
          "44: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "47: Error at offset 79 of 78 bytes",
          "48: DONE",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d9c5a1d26815cfe05be5803cb0c02254c534efaa",
      "candidate_info": {
        "commit_hash": "d9c5a1d26815cfe05be5803cb0c02254c534efaa",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/d9c5a1d26815cfe05be5803cb0c02254c534efaa",
        "files": [
          "ext/spl/spl_array.c",
          "ext/spl/spl_observer.c",
          "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
        ],
        "message": "Fix bug #67492: unserialize() SPL ArrayObject / SPLObjectStorage Type Confusion",
        "before_after_code_files": [
          "ext/spl/spl_array.c||ext/spl/spl_array.c",
          "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
          "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/spl/spl_array.c||ext/spl/spl_array.c",
            "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
            "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
          ],
          "candidate": [
            "ext/spl/spl_array.c||ext/spl/spl_array.c",
            "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
            "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/spl/spl_array.c||ext/spl/spl_array.c": [
          "File: ext/spl/spl_array.c -> ext/spl/spl_array.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1796:  ++p;",
          "1798:  ALLOC_INIT_ZVAL(pmembers);",
          "1800:   zval_ptr_dtor(&pmembers);",
          "1801:   goto outexcept;",
          "1802:  }",
          "",
          "[Removed Lines]",
          "1799:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "1799:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/spl/spl_observer.c||ext/spl/spl_observer.c": [
          "File: ext/spl/spl_observer.c -> ext/spl/spl_observer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "898:  ++p;",
          "900:  ALLOC_INIT_ZVAL(pmembers);",
          "902:   zval_ptr_dtor(&pmembers);",
          "903:   goto outexcept;",
          "904:  }",
          "",
          "[Removed Lines]",
          "901:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "901:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash TSRMLS_CC) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/spl/tests/SplObjectStorage_unserialize_bad.phpt||ext/spl/tests/SplObjectStorage_unserialize_bad.phpt": [
          "File: ext/spl/tests/SplObjectStorage_unserialize_bad.phpt -> ext/spl/tests/SplObjectStorage_unserialize_bad.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: 'x:i:2;i:0;,i:1;;i:0;,i:2;;m:a:0:{}',",
          "8: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};R:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "9: 'x:i:3;O:8:\"stdClass\":0:{},O:8:\"stdClass\":0:{};r:2;,i:1;;O:8:\"stdClass\":0:{},r:2;;m:a:0:{}',",
          "10: );",
          "11: foreach($badblobs as $blob) {",
          "12: try {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10: 'x:i:1;O:8:\"stdClass\":0:{},N;;m:s:40:\"1234567890123456789012345678901234567890\"',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "17:  echo $e->getMessage().\"\\n\";",
          "18: }",
          "19: }",
          "20: --EXPECTF--",
          "21: Error at offset 6 of 34 bytes",
          "22: Error at offset 46 of 89 bytes",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: echo \"DONE\\n\";",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "42:     }",
          "43:   }",
          "44: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "47: Error at offset 79 of 78 bytes",
          "48: DONE",
          "",
          "---------------"
        ]
      }
    }
  ]
}