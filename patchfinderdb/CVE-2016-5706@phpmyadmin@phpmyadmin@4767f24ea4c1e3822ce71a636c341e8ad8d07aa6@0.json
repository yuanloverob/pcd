{
  "cve_id": "CVE-2016-5706",
  "cve_desc": "js/get_scripts.js.php in phpMyAdmin 4.0.x before 4.0.10.16, 4.4.x before 4.4.15.7, and 4.6.x before 4.6.3 allows remote attackers to cause a denial of service via a large array in the scripts parameter.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "4767f24ea4c1e3822ce71a636c341e8ad8d07aa6",
  "patch_info": {
    "commit_hash": "4767f24ea4c1e3822ce71a636c341e8ad8d07aa6",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/4767f24ea4c1e3822ce71a636c341e8ad8d07aa6",
    "files": [
      "js/get_scripts.js.php"
    ],
    "message": "Limit number of included scripts in get_scripts.js.php\n\nThis avoids potential DOS, the limit is same as we use for generating\nthe URLs.\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
    "before_after_code_files": [
      "js/get_scripts.js.php||js/get_scripts.js.php"
    ]
  },
  "patch_diff": {
    "js/get_scripts.js.php||js/get_scripts.js.php": [
      "File: js/get_scripts.js.php -> js/get_scripts.js.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "37: $_GET['scripts'] = json_decode($_GET['scripts']);",
      "38: if (! empty($_GET['scripts']) && is_array($_GET['scripts'])) {",
      "41:         $script_name = 'js';",
      "",
      "[Removed Lines]",
      "39:     foreach ($_GET['scripts'] as $script) {",
      "",
      "[Added Lines]",
      "40:     foreach (array_slice($_GET['scripts'], 0, 10) as $script) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "abb3685c8702de887988fee31a97ef4d80d856a1",
      "candidate_info": {
        "commit_hash": "abb3685c8702de887988fee31a97ef4d80d856a1",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/abb3685c8702de887988fee31a97ef4d80d856a1",
        "files": [
          "js/get_scripts.js.php"
        ],
        "message": "Limit number of included scripts in get_scripts.js.php\n\nThis avoids potential DOS, the limit is same as we use for generating\nthe URLs.\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
        "before_after_code_files": [
          "js/get_scripts.js.php||js/get_scripts.js.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "js/get_scripts.js.php||js/get_scripts.js.php"
          ],
          "candidate": [
            "js/get_scripts.js.php||js/get_scripts.js.php"
          ]
        }
      },
      "candidate_diff": {
        "js/get_scripts.js.php||js/get_scripts.js.php": [
          "File: js/get_scripts.js.php -> js/get_scripts.js.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "36: $_GET['scripts'] = json_decode($_GET['scripts']);",
          "37: if (! empty($_GET['scripts']) && is_array($_GET['scripts'])) {",
          "40:         $script_name = 'js';",
          "",
          "[Removed Lines]",
          "38:     foreach ($_GET['scripts'] as $script) {",
          "",
          "[Added Lines]",
          "39:     foreach (array_slice($_GET['scripts'], 0, 10) as $script) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "805225a28c1428d7809e613c731c2126960e98df",
      "candidate_info": {
        "commit_hash": "805225a28c1428d7809e613c731c2126960e98df",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/805225a28c1428d7809e613c731c2126960e98df",
        "files": [
          "js/get_scripts.js.php"
        ],
        "message": "Limit number of included scripts in get_scripts.js.php\n\nThis avoids potential DOS, the limit is same as we use for generating\nthe URLs.\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
        "before_after_code_files": [
          "js/get_scripts.js.php||js/get_scripts.js.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "js/get_scripts.js.php||js/get_scripts.js.php"
          ],
          "candidate": [
            "js/get_scripts.js.php||js/get_scripts.js.php"
          ]
        }
      },
      "candidate_diff": {
        "js/get_scripts.js.php||js/get_scripts.js.php": [
          "File: js/get_scripts.js.php -> js/get_scripts.js.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: header('Expires: ' . gmdate('D, d M Y H:i:s', time() + 3600) . ' GMT');",
          "16: if (! empty($_GET['scripts']) && is_array($_GET['scripts'])) {",
          "19:         $script_name = 'js';",
          "20:         $path = explode(\"/\", $script);",
          "",
          "[Removed Lines]",
          "17:     foreach ($_GET['scripts'] as $script) {",
          "",
          "[Added Lines]",
          "18:     foreach (array_slice($_GET['scripts'], 0, 10) as $script) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}