{
  "cve_id": "CVE-2022-24764",
  "cve_desc": "PJSIP is a free and open source multimedia communication library written in C. Versions 2.12 and prior contain a stack buffer overflow vulnerability that affects PJSUA2 users or users that call the API `pjmedia_sdp_print(), pjmedia_sdp_media_print()`. Applications that do not use PJSUA2 and do not directly call `pjmedia_sdp_print()` or `pjmedia_sdp_media_print()` should not be affected. A patch is available on the `master` branch of the `pjsip/pjproject` GitHub repository. There are currently no known workarounds.",
  "repo": "pjsip/pjproject",
  "patch_hash": "560a1346f87aabe126509bb24930106dea292b00",
  "patch_info": {
    "commit_hash": "560a1346f87aabe126509bb24930106dea292b00",
    "repo": "pjsip/pjproject",
    "commit_url": "https://github.com/pjsip/pjproject/commit/560a1346f87aabe126509bb24930106dea292b00",
    "files": [
      "pjmedia/src/pjmedia/sdp.c"
    ],
    "message": "Merge pull request from GHSA-f5qg-pqcg-765m",
    "before_after_code_files": [
      "pjmedia/src/pjmedia/sdp.c||pjmedia/src/pjmedia/sdp.c"
    ]
  },
  "patch_diff": {
    "pjmedia/src/pjmedia/sdp.c||pjmedia/src/pjmedia/sdp.c": [
      "File: pjmedia/src/pjmedia/sdp.c -> pjmedia/src/pjmedia/sdp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "733:     pj_memcpy(p, m->desc.transport.ptr, m->desc.transport.slen);",
      "734:     p += m->desc.transport.slen;",
      "735:     for (i=0; i<m->desc.fmt_count; ++i) {",
      "739:     }",
      "744:     if (m->conn) {",
      "",
      "[Removed Lines]",
      "737:  pj_memcpy(p, m->desc.fmt[i].ptr, m->desc.fmt[i].slen);",
      "738:  p += m->desc.fmt[i].slen;",
      "",
      "[Added Lines]",
      "736:  if (end-p > m->desc.fmt[i].slen) {",
      "738:      pj_memcpy(p, m->desc.fmt[i].ptr, m->desc.fmt[i].slen);",
      "739:      p += m->desc.fmt[i].slen;",
      "740:  } else {",
      "741:      return -1;",
      "742:  }",
      "743:     }",
      "745:     if (end-p >= 2) {",
      "748:     } else {",
      "749:  return -1;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a847fa76808738bdd59c7cb33e6786eaae80f048",
      "candidate_info": {
        "commit_hash": "a847fa76808738bdd59c7cb33e6786eaae80f048",
        "repo": "pjsip/pjproject",
        "commit_url": "https://github.com/pjsip/pjproject/commit/a847fa76808738bdd59c7cb33e6786eaae80f048",
        "files": [
          "pjmedia/src/pjmedia/sdp.c"
        ],
        "message": "Merge pull request from GHSA-f5qg-pqcg-765m",
        "before_after_code_files": [
          "pjmedia/src/pjmedia/sdp.c||pjmedia/src/pjmedia/sdp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "pjmedia/src/pjmedia/sdp.c||pjmedia/src/pjmedia/sdp.c"
          ],
          "candidate": [
            "pjmedia/src/pjmedia/sdp.c||pjmedia/src/pjmedia/sdp.c"
          ]
        }
      },
      "candidate_diff": {
        "pjmedia/src/pjmedia/sdp.c||pjmedia/src/pjmedia/sdp.c": [
          "File: pjmedia/src/pjmedia/sdp.c -> pjmedia/src/pjmedia/sdp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "733:     pj_memcpy(p, m->desc.transport.ptr, m->desc.transport.slen);",
          "734:     p += m->desc.transport.slen;",
          "735:     for (i=0; i<m->desc.fmt_count; ++i) {",
          "739:     }",
          "744:     if (m->conn) {",
          "",
          "[Removed Lines]",
          "737:  pj_memcpy(p, m->desc.fmt[i].ptr, m->desc.fmt[i].slen);",
          "738:  p += m->desc.fmt[i].slen;",
          "",
          "[Added Lines]",
          "736:  if (end-p > m->desc.fmt[i].slen) {",
          "738:      pj_memcpy(p, m->desc.fmt[i].ptr, m->desc.fmt[i].slen);",
          "739:      p += m->desc.fmt[i].slen;",
          "740:  } else {",
          "741:      return -1;",
          "742:  }",
          "743:     }",
          "745:     if (end-p >= 2) {",
          "748:     } else {",
          "749:  return -1;",
          "",
          "---------------"
        ]
      }
    }
  ]
}