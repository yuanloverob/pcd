{
  "cve_id": "CVE-2019-12109",
  "cve_desc": "A Denial Of Service vulnerability in MiniUPnP MiniUPnPd through 2.1 exists due to a NULL pointer dereference in GetOutboundPinholeTimeout in upnpsoap.c for rem_port.",
  "repo": "miniupnp/miniupnp",
  "patch_hash": "13585f15c7f7dc28bbbba1661efb280d530d114c",
  "patch_info": {
    "commit_hash": "13585f15c7f7dc28bbbba1661efb280d530d114c",
    "repo": "miniupnp/miniupnp",
    "commit_url": "https://github.com/miniupnp/miniupnp/commit/13585f15c7f7dc28bbbba1661efb280d530d114c",
    "files": [
      "miniupnpd/upnpsoap.c"
    ],
    "message": "GetOutboundPinholeTimeout: check args",
    "before_after_code_files": [
      "miniupnpd/upnpsoap.c||miniupnpd/upnpsoap.c"
    ]
  },
  "patch_diff": {
    "miniupnpd/upnpsoap.c||miniupnpd/upnpsoap.c": [
      "File: miniupnpd/upnpsoap.c -> miniupnpd/upnpsoap.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1850:  rem_port = GetValueFromNameValueList(&data, \"RemotePort\");",
      "1851:  protocol = GetValueFromNameValueList(&data, \"Protocol\");",
      "1853:  rport = (unsigned short)atoi(rem_port);",
      "1854:  iport = (unsigned short)atoi(int_port);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1853:  if (!int_port || !ext_port || !protocol)",
      "1854:  {",
      "1855:   ClearNameValueList(&data);",
      "1856:   SoapError(h, 402, \"Invalid Args\");",
      "1857:   return;",
      "1858:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "86030db849260dd8fb2ed975b9890aef1b62b692",
      "candidate_info": {
        "commit_hash": "86030db849260dd8fb2ed975b9890aef1b62b692",
        "repo": "miniupnp/miniupnp",
        "commit_url": "https://github.com/miniupnp/miniupnp/commit/86030db849260dd8fb2ed975b9890aef1b62b692",
        "files": [
          "miniupnpd/upnpsoap.c"
        ],
        "message": "fix error from commit 13585f15c7f7dc28bbbba1661efb280d530d114c",
        "before_after_code_files": [
          "miniupnpd/upnpsoap.c||miniupnpd/upnpsoap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "miniupnpd/upnpsoap.c||miniupnpd/upnpsoap.c"
          ],
          "candidate": [
            "miniupnpd/upnpsoap.c||miniupnpd/upnpsoap.c"
          ]
        }
      },
      "candidate_diff": {
        "miniupnpd/upnpsoap.c||miniupnpd/upnpsoap.c": [
          "File: miniupnpd/upnpsoap.c -> miniupnpd/upnpsoap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1850:  rem_port = GetValueFromNameValueList(&data, \"RemotePort\");",
          "1851:  protocol = GetValueFromNameValueList(&data, \"Protocol\");",
          "1854:  {",
          "1855:   ClearNameValueList(&data);",
          "1856:   SoapError(h, 402, \"Invalid Args\");",
          "",
          "[Removed Lines]",
          "1853:  if (!int_port || !ext_port || !protocol)",
          "",
          "[Added Lines]",
          "1853:  if (!int_port || !rem_port || !protocol)",
          "",
          "---------------"
        ]
      }
    }
  ]
}