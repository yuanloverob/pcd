{
  "cve_id": "CVE-2017-3731",
  "cve_desc": "If an SSL/TLS server or client is running on a 32-bit host, and a specific cipher is being used, then a truncated packet can cause that server or client to perform an out-of-bounds read, usually resulting in a crash. For OpenSSL 1.1.0, the crash can be triggered when using CHACHA20/POLY1305; users should upgrade to 1.1.0d. For Openssl 1.0.2, the crash can be triggered when using RC4-MD5; users who have not disabled that algorithm should update to 1.0.2k.",
  "repo": "openssl/openssl",
  "patch_hash": "00d965474b22b54e4275232bc71ee0c699c5cd21",
  "patch_info": {
    "commit_hash": "00d965474b22b54e4275232bc71ee0c699c5cd21",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/00d965474b22b54e4275232bc71ee0c699c5cd21",
    "files": [
      "crypto/evp/e_aes.c",
      "crypto/evp/e_chacha20_poly1305.c"
    ],
    "message": "crypto/evp: harden AEAD ciphers.\n\nOriginally a crash in 32-bit build was reported CHACHA20-POLY1305\ncipher. The crash is triggered by truncated packet and is result\nof excessive hashing to the edge of accessible memory. Since hash\noperation is read-only it is not considered to be exploitable\nbeyond a DoS condition. Other ciphers were hardened.\n\nThanks to Robert \u015awi\u0119cki for report.\n\nCVE-2017-3731\n\nReviewed-by: Rich Salz <rsalz@openssl.org>",
    "before_after_code_files": [
      "crypto/evp/e_aes.c||crypto/evp/e_aes.c",
      "crypto/evp/e_chacha20_poly1305.c||crypto/evp/e_chacha20_poly1305.c"
    ]
  },
  "patch_diff": {
    "crypto/evp/e_aes.c||crypto/evp/e_aes.c": [
      "File: crypto/evp/e_aes.c -> crypto/evp/e_aes.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1388:                 EVP_CIPHER_CTX_buf_noconst(c)[arg - 2] << 8",
      "1389:                 | EVP_CIPHER_CTX_buf_noconst(c)[arg - 1];",
      "1391:             len -= EVP_GCM_TLS_EXPLICIT_IV_LEN;",
      "1394:                 len -= EVP_GCM_TLS_TAG_LEN;",
      "1395:             EVP_CIPHER_CTX_buf_noconst(c)[arg - 2] = len >> 8;",
      "1396:             EVP_CIPHER_CTX_buf_noconst(c)[arg - 1] = len & 0xff;",
      "1397:         }",
      "",
      "[Removed Lines]",
      "1393:             if (!EVP_CIPHER_CTX_encrypting(c))",
      "",
      "[Added Lines]",
      "1391:             if (len < EVP_GCM_TLS_EXPLICIT_IV_LEN)",
      "1392:                 return 0;",
      "1395:             if (!EVP_CIPHER_CTX_encrypting(c)) {",
      "1396:                 if (len < EVP_GCM_TLS_TAG_LEN)",
      "1397:                     return 0;",
      "1399:             }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1946:                 EVP_CIPHER_CTX_buf_noconst(c)[arg - 2] << 8",
      "1947:                 | EVP_CIPHER_CTX_buf_noconst(c)[arg - 1];",
      "1949:             len -= EVP_CCM_TLS_EXPLICIT_IV_LEN;",
      "1952:                 len -= cctx->M;",
      "1953:             EVP_CIPHER_CTX_buf_noconst(c)[arg - 2] = len >> 8;",
      "1954:             EVP_CIPHER_CTX_buf_noconst(c)[arg - 1] = len & 0xff;",
      "1955:         }",
      "",
      "[Removed Lines]",
      "1951:             if (!EVP_CIPHER_CTX_encrypting(c))",
      "",
      "[Added Lines]",
      "1954:             if (len < EVP_CCM_TLS_EXPLICIT_IV_LEN)",
      "1955:                 return 0;",
      "1958:             if (!EVP_CIPHER_CTX_encrypting(c)) {",
      "1959:                 if (len < cctx->M)",
      "1960:                     return 0;",
      "1962:             }",
      "",
      "---------------"
    ],
    "crypto/evp/e_chacha20_poly1305.c||crypto/evp/e_chacha20_poly1305.c": [
      "File: crypto/evp/e_chacha20_poly1305.c -> crypto/evp/e_chacha20_poly1305.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "398:             len = aad[EVP_AEAD_TLS1_AAD_LEN - 2] << 8 |",
      "399:                   aad[EVP_AEAD_TLS1_AAD_LEN - 1];",
      "400:             if (!ctx->encrypt) {",
      "402:                 memcpy(temp, aad, EVP_AEAD_TLS1_AAD_LEN - 2);",
      "403:                 aad = temp;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "401:                 if (len < POLY1305_BLOCK_SIZE)",
      "402:                     return 0;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a2dcdb57af656b9b623e68e6c7f6b52cb5d0fa48",
      "candidate_info": {
        "commit_hash": "a2dcdb57af656b9b623e68e6c7f6b52cb5d0fa48",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/a2dcdb57af656b9b623e68e6c7f6b52cb5d0fa48",
        "files": [
          "CHANGES",
          "Configure",
          "apps/passwd.c",
          "crypto/aes/asm/aesni-sha1-x86_64.pl",
          "crypto/bio/b_addr.c",
          "crypto/bn/asm/sparcv9-mont.pl",
          "crypto/pem/pem_lib.c",
          "crypto/sha/asm/sha1-586.pl",
          "crypto/sha/asm/sha1-x86_64.pl",
          "crypto/x86cpuid.pl",
          "doc/README",
          "doc/crypto/BN_rand.pod",
          "doc/crypto/SCT_new.pod",
          "doc/crypto/X509_VERIFY_PARAM_set_flags.pod",
          "doc/ssl/SSL_SESSION_get0_peer.pod",
          "doc/ssl/SSL_set_bio.pod",
          "include/internal/dso.h",
          "include/openssl/bio.h",
          "include/openssl/objects.h",
          "include/openssl/x509.h",
          "ssl/record/ssl3_record.c",
          "ssl/ssl_lib.c",
          "ssl/statem/statem_clnt.c",
          "ssl/statem/statem_srvr.c",
          "ssl/t1_lib.c",
          "test/recipes/70-test_sslrecords.t",
          "test/sslapitest.c",
          "test/ssltest_old.c",
          "test/testlib/OpenSSL/Test.pm"
        ],
        "message": "More typo fixes\n\nBackport of 69687aa829bc8bdcaf5468eb3dd0ada13700b7aa\n(Merged from #3069)\n\nReviewed-by: Andy Polyakov <appro@openssl.org>\nReviewed-by: Richard Levitte <levitte@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/3079)",
        "before_after_code_files": [
          "apps/passwd.c||apps/passwd.c",
          "crypto/aes/asm/aesni-sha1-x86_64.pl||crypto/aes/asm/aesni-sha1-x86_64.pl",
          "crypto/bio/b_addr.c||crypto/bio/b_addr.c",
          "crypto/bn/asm/sparcv9-mont.pl||crypto/bn/asm/sparcv9-mont.pl",
          "crypto/pem/pem_lib.c||crypto/pem/pem_lib.c",
          "crypto/shasm/sha1-586.pl||crypto/sha/asm/sha1-586.pl",
          "crypto/shasm/sha1-x86_64.pl||crypto/sha/asm/sha1-x86_64.pl",
          "crypto/x86cpuid.pl||crypto/x86cpuid.pl",
          "include/internal/dso.h||include/internal/dso.h",
          "include/openssl/bio.h||include/openssl/bio.h",
          "include/openssl/objects.h||include/openssl/objects.h",
          "include/openssl/x509.h||include/openssl/x509.h",
          "ssl/record/ssl3_record.c||ssl/record/ssl3_record.c",
          "ssl/ssl_lib.c||ssl/ssl_lib.c",
          "ssl/statem/statem_clnt.c||ssl/statem/statem_clnt.c",
          "ssl/statem/statem_srvr.c||ssl/statem/statem_srvr.c",
          "ssl/t1_lib.c||ssl/t1_lib.c",
          "test/recipes/70-test_sslrecords.t||test/recipes/70-test_sslrecords.t",
          "test/sslapitest.c||test/sslapitest.c",
          "test/ssltest_old.c||test/ssltest_old.c",
          "test/testlib/OpenSSL/Test.pm||test/testliOpenSSL/Test.pm"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "apps/passwd.c||apps/passwd.c": [
          "File: apps/passwd.c -> apps/passwd.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "55: OPTIONS passwd_options[] = {",
          "56:     {\"help\", OPT_HELP, '-', \"Display this summary\"},",
          "58:     {\"noverify\", OPT_NOVERIFY, '-',",
          "59:      \"Never verify when reading password from terminal\"},",
          "60:     {\"quiet\", OPT_QUIET, '-', \"No warnings\"},",
          "",
          "[Removed Lines]",
          "57:     {\"in\", OPT_IN, '<', \"Pead passwords from file\"},",
          "",
          "[Added Lines]",
          "57:     {\"in\", OPT_IN, '<', \"Read passwords from file\"},",
          "",
          "---------------"
        ],
        "crypto/aes/asm/aesni-sha1-x86_64.pl||crypto/aes/asm/aesni-sha1-x86_64.pl": [
          "File: crypto/aes/asm/aesni-sha1-x86_64.pl -> crypto/aes/asm/aesni-sha1-x86_64.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "307:     $r++; unshift(@rndkey,pop(@rndkey));",
          "308: };",
          "311: { use integer;",
          "312:   my $body = shift;",
          "313:   my @insns = (&$body,&$body,&$body,&$body); # 40 instructions",
          "",
          "[Removed Lines]",
          "310: sub Xupdate_ssse3_16_31()  # recall that $Xi starts wtih 4",
          "",
          "[Added Lines]",
          "310: sub Xupdate_ssse3_16_31()  # recall that $Xi starts with 4",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1146:     $r++; unshift(@rndkey,pop(@rndkey));",
          "1147: };",
          "1150: { use integer;",
          "1151:   my $body = shift;",
          "1152:   my @insns = (&$body,&$body,&$body,&$body); # 40 instructions",
          "",
          "[Removed Lines]",
          "1149: sub Xupdate_avx_16_31()  # recall that $Xi starts wtih 4",
          "",
          "[Added Lines]",
          "1149: sub Xupdate_avx_16_31()  # recall that $Xi starts with 4",
          "",
          "---------------"
        ],
        "crypto/bio/b_addr.c||crypto/bio/b_addr.c": [
          "File: crypto/bio/b_addr.c -> crypto/bio/b_addr.c"
        ],
        "crypto/bn/asm/sparcv9-mont.pl||crypto/bn/asm/sparcv9-mont.pl": [
          "File: crypto/bn/asm/sparcv9-mont.pl -> crypto/bn/asm/sparcv9-mont.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: # instructions...",
          "32: # (*) Engine accessing the driver in question is on my TODO list.",
          "34: # improvement on single-threaded RSA sign. It should be noted",
          "35: # that 6-10x improvement coefficient does not actually mean",
          "36: # something extraordinary in terms of absolute [single-threaded]",
          "",
          "[Removed Lines]",
          "33: # For reference, acceleator is estimated to give 6 to 10 times",
          "",
          "[Added Lines]",
          "33: # For reference, accelerator is estimated to give 6 to 10 times",
          "",
          "---------------"
        ],
        "crypto/pem/pem_lib.c||crypto/pem/pem_lib.c": [
          "File: crypto/pem/pem_lib.c -> crypto/pem/pem_lib.c"
        ],
        "crypto/shasm/sha1-586.pl||crypto/sha/asm/sha1-586.pl": [
          "File: crypto/shasm/sha1-586.pl -> crypto/sha/asm/sha1-586.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "660: # SSE instruction sequence is first broken to groups of independent",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "669: # contain current K_XX_XX constant and is used to calculate X[-1]+K",
          "676: sub Xupdate_ssse3_16_31()  # recall that $Xi starts with 4",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1199: sub Xupdate_avx_16_31()  # recall that $Xi starts with 4",
          "",
          "---------------"
        ],
        "crypto/shasm/sha1-x86_64.pl||crypto/sha/asm/sha1-x86_64.pl": [
          "File: crypto/shasm/sha1-x86_64.pl -> crypto/sha/asm/sha1-x86_64.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "554: sub Xupdate_ssse3_16_31()  # recall that $Xi starts with 4",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1007: sub Xupdate_avx_16_31()  # recall that $Xi starts with 4",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1479: sub Xupdate_avx2_16_31()  # recall that $Xi starts with 4",
          "",
          "---------------"
        ],
        "crypto/x86cpuid.pl||crypto/x86cpuid.pl": [
          "File: crypto/x86cpuid.pl -> crypto/x86cpuid.pl",
          "--- Hunk 1 ---",
          "[Context before]",
          "283: &set_label(\"spin\");",
          "284:  &lea (\"ebx\",&DWP(0,\"eax\",\"ecx\"));",
          "285:  &nop ();",
          "287:  &jne (&label(\"spin\"));",
          "288:  &mov (\"eax\",\"ebx\"); # OpenSSL expects the new value",
          "289:  &pop (\"ebx\");",
          "",
          "[Removed Lines]",
          "286:  &data_word(0x1ab10ff0); # lock; cmpxchg %ebx,(%edx) # %eax is envolved and is always reloaded",
          "",
          "[Added Lines]",
          "286:  &data_word(0x1ab10ff0); # lock; cmpxchg %ebx,(%edx) # %eax is involved and is always reloaded",
          "",
          "---------------"
        ],
        "include/internal/dso.h||include/internal/dso.h": [
          "File: include/internal/dso.h -> include/internal/dso.h"
        ],
        "include/openssl/bio.h||include/openssl/bio.h": [
          "File: include/openssl/bio.h -> include/openssl/bio.h"
        ],
        "include/openssl/objects.h||include/openssl/objects.h": [
          "File: include/openssl/objects.h -> include/openssl/objects.h"
        ],
        "include/openssl/x509.h||include/openssl/x509.h": [
          "File: include/openssl/x509.h -> include/openssl/x509.h"
        ],
        "ssl/record/ssl3_record.c||ssl/record/ssl3_record.c": [
          "File: ssl/record/ssl3_record.c -> ssl/record/ssl3_record.c"
        ],
        "ssl/ssl_lib.c||ssl/ssl_lib.c": [
          "File: ssl/ssl_lib.c -> ssl/ssl_lib.c"
        ],
        "ssl/statem/statem_clnt.c||ssl/statem/statem_clnt.c": [
          "File: ssl/statem/statem_clnt.c -> ssl/statem/statem_clnt.c"
        ],
        "ssl/statem/statem_srvr.c||ssl/statem/statem_srvr.c": [
          "File: ssl/statem/statem_srvr.c -> ssl/statem/statem_srvr.c"
        ],
        "ssl/t1_lib.c||ssl/t1_lib.c": [
          "File: ssl/t1_lib.c -> ssl/t1_lib.c"
        ],
        "test/recipes/70-test_sslrecords.t||test/recipes/70-test_sslrecords.t": [
          "File: test/recipes/70-test_sslrecords.t -> test/recipes/70-test_sslrecords.t",
          "--- Hunk 1 ---",
          "[Context before]",
          "112: $proxy->start();",
          "113: ok(TLSProxy::Message->fail(), \"Alert before SSLv2 ClientHello test\");",
          "117: #Test 10: Sending an unrecognised record type in TLS1.2 should fail",
          "118: $proxy->clear();",
          "",
          "[Removed Lines]",
          "115: #Unregcognised record type tests",
          "",
          "[Added Lines]",
          "115: #Unrecognised record type tests",
          "",
          "---------------"
        ],
        "test/sslapitest.c||test/sslapitest.c": [
          "File: test/sslapitest.c -> test/sslapitest.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "45:     int certlen;",
          "47:     if (certbio == NULL) {",
          "49:         goto end;",
          "50:     }",
          "51:     chaincert = PEM_read_bio_X509(certbio, NULL, NULL, NULL);",
          "",
          "[Removed Lines]",
          "48:         printf(\"Can't load the certficate file\\n\");",
          "",
          "[Added Lines]",
          "48:         printf(\"Can't load the certificate file\\n\");",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336:     certbio = BIO_new_file(cert, \"r\");",
          "337:     if (certbio == NULL) {",
          "339:         goto end;",
          "340:     }",
          "341:     id = OCSP_RESPID_new();",
          "",
          "[Removed Lines]",
          "338:         printf(\"Can't load the certficate file\\n\");",
          "",
          "[Added Lines]",
          "338:         printf(\"Can't load the certificate file\\n\");",
          "",
          "---------------"
        ],
        "test/ssltest_old.c||test/ssltest_old.c": [
          "File: test/ssltest_old.c -> test/ssltest_old.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1860:             goto err;",
          "1861:         }",
          "1862:         if (SSL_version(c_ssl) != version) {",
          "1864:                 \"Expected: %s, got %s\\n\", should_negotiate, SSL_get_version(c_ssl));",
          "1865:             ret = 1;",
          "1866:             goto err;",
          "",
          "[Removed Lines]",
          "1863:             BIO_printf(bio_err, \"Unxpected version negotiated. \"",
          "",
          "[Added Lines]",
          "1862:             BIO_printf(bio_err, \"Unexpected version negotiated. \"",
          "",
          "---------------"
        ],
        "test/testlib/OpenSSL/Test.pm||test/testliOpenSSL/Test.pm": [
          "File: test/testlib/OpenSSL/Test.pm -> test/testliOpenSSL/Test.pm",
          "--- Hunk 1 ---",
          "[Context before]",
          "964:  # Make sure to quotify the program file on platforms that may",
          "965:  # have spaces or similar in their path name.",
          "966:  # To our knowledge, VMS is the exception where quotifying should",
          "968:  ($prog) = quotify($prog) unless $^O eq \"VMS\";",
          "969:  return $prefix.$prog;",
          "970:     }",
          "",
          "[Removed Lines]",
          "967:  # never happem.",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fd18736a6b970c9b772f9c1b3cda4adcd20c63e2",
      "candidate_info": {
        "commit_hash": "fd18736a6b970c9b772f9c1b3cda4adcd20c63e2",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/fd18736a6b970c9b772f9c1b3cda4adcd20c63e2",
        "files": [
          "test/evp_test.c"
        ],
        "message": "Update evp_test to make sure passing partial block to \"Update\" is ok\n\nThe previous commit fixed a bug where a partial block had been passed to\nan \"Update\" function and it wasn't properly handled. We should catch this\ntype of error in evp_test.\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/2275)\n(cherry picked from commit 0b96d77a62d8ac9a45ac1dda47560ced676b5b8d)",
        "before_after_code_files": [
          "test/evp_test.c||test/evp_test.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/evp_test.c||test/evp_test.c": [
          "File: test/evp_test.c -> test/evp_test.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "880: }",
          "882: static int cipher_test_enc(struct evp_test *t, int enc,",
          "884: {",
          "885:     struct cipher_data *cdat = t->data;",
          "886:     unsigned char *in, *out, *tmp = NULL;",
          "889:     EVP_CIPHER_CTX *ctx = NULL;",
          "890:     const char *err;",
          "891:     err = \"INTERNAL_ERROR\";",
          "",
          "[Removed Lines]",
          "883:                            size_t out_misalign, size_t inp_misalign)",
          "887:     size_t in_len, out_len;",
          "888:     int tmplen, tmpflen;",
          "",
          "[Added Lines]",
          "883:                            size_t out_misalign, size_t inp_misalign, int frag)",
          "887:     size_t in_len, out_len, donelen = 0;",
          "888:     int tmplen, chunklen, tmpflen;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "983:         }",
          "984:     }",
          "985:     if (cdat->aad) {",
          "989:         }",
          "990:     }",
          "991:     EVP_CIPHER_CTX_set_padding(ctx, 0);",
          "992:     err = \"CIPHERUPDATE_ERROR\";",
          "995:     if (cdat->aead == EVP_CIPH_CCM_MODE)",
          "996:         tmpflen = 0;",
          "997:     else {",
          "",
          "[Removed Lines]",
          "986:         if (!EVP_CipherUpdate(ctx, NULL, &tmplen, cdat->aad, cdat->aad_len)) {",
          "987:             err = \"AAD_SET_ERROR\";",
          "988:             goto err;",
          "993:     if (!EVP_CipherUpdate(ctx, tmp + out_misalign, &tmplen, in, in_len))",
          "994:         goto err;",
          "",
          "[Added Lines]",
          "986:         err = \"AAD_SET_ERROR\";",
          "987:         if (!frag) {",
          "988:             if (!EVP_CipherUpdate(ctx, NULL, &chunklen, cdat->aad,",
          "989:                                   cdat->aad_len))",
          "990:                 goto err;",
          "991:         } else {",
          "995:             if (cdat->aad_len > 0) {",
          "996:                 if (!EVP_CipherUpdate(ctx, NULL, &chunklen, cdat->aad, 1))",
          "997:                     goto err;",
          "998:                 donelen++;",
          "999:             }",
          "1000:             if (cdat->aad_len > 2) {",
          "1001:                 if (!EVP_CipherUpdate(ctx, NULL, &chunklen, cdat->aad + donelen,",
          "1002:                                       cdat->aad_len - 2))",
          "1003:                     goto err;",
          "1004:                 donelen += cdat->aad_len - 2;",
          "1005:             }",
          "1006:             if (cdat->aad_len > 1",
          "1007:                     && !EVP_CipherUpdate(ctx, NULL, &chunklen,",
          "1008:                                          cdat->aad + donelen, 1))",
          "1009:                 goto err;",
          "1014:     tmplen = 0;",
          "1015:     donelen = 0;",
          "1016:     if (!frag) {",
          "1018:         if (!EVP_CipherUpdate(ctx, tmp + out_misalign, &tmplen, in, in_len))",
          "1019:             goto err;",
          "1020:     } else {",
          "1022:         if (in_len > 0) {",
          "1023:             if (!EVP_CipherUpdate(ctx, tmp + out_misalign, &chunklen, in, 1))",
          "1024:                 goto err;",
          "1025:             tmplen += chunklen;",
          "1026:             donelen = 1;",
          "1027:         }",
          "1028:         if (in_len > 2) {",
          "1029:             if (!EVP_CipherUpdate(ctx, tmp + out_misalign + tmplen, &chunklen,",
          "1030:                                   in + donelen, in_len - 2))",
          "1031:                 goto err;",
          "1032:             tmplen += chunklen;",
          "1033:             donelen += in_len - 2;",
          "1034:         }",
          "1035:         if (in_len > 1 ) {",
          "1036:             if (!EVP_CipherUpdate(ctx, tmp + out_misalign + tmplen, &chunklen,",
          "1037:                                   in + donelen, 1))",
          "1038:                 goto err;",
          "1039:             tmplen += chunklen;",
          "1040:         }",
          "1041:     }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1032: static int cipher_test_run(struct evp_test *t)",
          "1033: {",
          "1034:     struct cipher_data *cdat = t->data;",
          "1036:     size_t out_misalign, inp_misalign;",
          "1038:     if (!cdat->key) {",
          "",
          "[Removed Lines]",
          "1035:     int rv;",
          "",
          "[Added Lines]",
          "1082:     int rv, frag = 0;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1050:         t->err = \"NO_TAG\";",
          "1051:         return 0;",
          "1052:     }",
          "1054:         static char aux_err[64];",
          "1055:         t->aux_err = aux_err;",
          "1056:         for (inp_misalign = (size_t)-1; inp_misalign != 2; inp_misalign++) {",
          "1057:             if (inp_misalign == (size_t)-1) {",
          "1061:             } else {",
          "1063:                              out_misalign ? \"misaligned\" : \"aligned\",",
          "1065:             }",
          "1066:             if (cdat->enc) {",
          "1069:                 if (rv != 1) {",
          "1070:                     if (rv < 0)",
          "",
          "[Removed Lines]",
          "1053:     for (out_misalign = 0; out_misalign <= 1; out_misalign++) {",
          "1059:                 BIO_snprintf(aux_err, sizeof(aux_err), \"%s in-place\",",
          "1060:                              out_misalign ? \"misaligned\" : \"aligned\");",
          "1062:                 BIO_snprintf(aux_err, sizeof(aux_err), \"%s output and %s input\",",
          "1064:                              inp_misalign ? \"misaligned\" : \"aligned\");",
          "1067:                 rv = cipher_test_enc(t, 1, out_misalign, inp_misalign);",
          "",
          "[Added Lines]",
          "1100:     for (out_misalign = 0; out_misalign <= 1;) {",
          "1104:             if (frag && inp_misalign == (size_t)-1)",
          "1105:                  continue;",
          "1109:                 BIO_snprintf(aux_err, sizeof(aux_err),",
          "1110:                              \"%s in-place, %sfragmented\",",
          "1111:                              out_misalign ? \"misaligned\" : \"aligned\",",
          "1112:                              frag ? \"\" : \"not \");",
          "1114:                 BIO_snprintf(aux_err, sizeof(aux_err),",
          "1115:                              \"%s output and %s input, %sfragmented\",",
          "1117:                              inp_misalign ? \"misaligned\" : \"aligned\",",
          "1118:                              frag ? \"\" : \"not \");",
          "1121:                 rv = cipher_test_enc(t, 1, out_misalign, inp_misalign, frag);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1073:                 }",
          "1074:             }",
          "1075:             if (cdat->enc != 1) {",
          "1078:                 if (rv != 1) {",
          "1079:                     if (rv < 0)",
          "",
          "[Removed Lines]",
          "1076:                 rv = cipher_test_enc(t, 0, out_misalign, inp_misalign);",
          "",
          "[Added Lines]",
          "1130:                 rv = cipher_test_enc(t, 0, out_misalign, inp_misalign, frag);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1082:                 }",
          "1083:             }",
          "1084:         }",
          "1085:     }",
          "1086:     t->aux_err = NULL;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1140:         if (out_misalign == 1 && frag == 0) {",
          "1145:             if (cdat->aead == EVP_CIPH_CCM_MODE",
          "1146:                     || EVP_CIPHER_mode(cdat->cipher) == EVP_CIPH_XTS_MODE",
          "1147:                      || EVP_CIPHER_mode(cdat->cipher) == EVP_CIPH_WRAP_MODE)",
          "1148:                 break;",
          "1149:             out_misalign = 0;",
          "1150:             frag++;",
          "1151:         } else {",
          "1152:             out_misalign++;",
          "1153:         }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "848dc9619049f6aaad91b367eed309d987009e5e",
      "candidate_info": {
        "commit_hash": "848dc9619049f6aaad91b367eed309d987009e5e",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/848dc9619049f6aaad91b367eed309d987009e5e",
        "files": [
          "Configurations/10-main.conf",
          "crypto/init.c"
        ],
        "message": "Link using -znodelete\n\nInstead of deliberately leaking a reference to ourselves, use nodelete\nwhich does this more neatly. Only for Linux at the moment.\n\nReviewed-by: Tim Hudson <tjh@openssl.org>\n(cherry picked from commit b6d5ba1a9f004d637acac18ae3519fe063b6b5e1)",
        "before_after_code_files": [
          "Configurations/10-main.conf||Configurations/10-main.conf",
          "crypto/init.c||crypto/init.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Configurations/10-main.conf||Configurations/10-main.conf": [
          "File: Configurations/10-main.conf -> Configurations/10-main.conf",
          "--- Hunk 1 ---",
          "[Context before]",
          "631:         thread_scheme    => \"pthreads\",",
          "632:         dso_scheme       => \"dlfcn\",",
          "633:         shared_target    => \"linux-shared\",",
          "635:         shared_extension => \".so.\\$(SHLIB_MAJOR).\\$(SHLIB_MINOR)\",",
          "636:     },",
          "637:     \"linux-generic64\" => {",
          "",
          "[Removed Lines]",
          "634:         shared_cflag     => \"-fPIC\",",
          "",
          "[Added Lines]",
          "634:         shared_cflag     => \"-fPIC -DOPENSSL_USE_NODELETE\",",
          "635:         shared_ldflag    => \"-znodelete\",",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "647:         inherit_from     => [ \"linux-generic64\", asm(\"ppc64_asm\") ],",
          "648:         cflags           => add(\"-m64 -DB_ENDIAN\"),",
          "649:         perlasm_scheme   => \"linux64\",",
          "651:         multilib         => \"64\",",
          "652:     },",
          "653:     \"linux-ppc64le\" => {",
          "654:         inherit_from     => [ \"linux-generic64\", asm(\"ppc64_asm\") ],",
          "655:         cflags           => add(\"-m64 -DL_ENDIAN\"),",
          "656:         perlasm_scheme   => \"linux64le\",",
          "658:     },",
          "660:     \"linux-armv4\" => {",
          "",
          "[Removed Lines]",
          "650:         shared_ldflag    => \"-m64\",",
          "657:         shared_ldflag    => \"-m64\",",
          "",
          "[Added Lines]",
          "651:         shared_ldflag    => add(\"-m64\"),",
          "658:         shared_ldflag    => add(\"-m64\"),",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "710:         inherit_from     => [ \"linux-generic32\", asm(\"mips32_asm\") ],",
          "711:         cflags           => add(\"-mabi=32 -DBN_DIV3W\"),",
          "712:         perlasm_scheme   => \"o32\",",
          "714:     },",
          "715:     # mips32 and mips64 below refer to contemporary MIPS Architecture",
          "716:     # specifications, MIPS32 and MIPS64, rather than to kernel bitness.",
          "",
          "[Removed Lines]",
          "713:         shared_ldflag    => \"-mabi=32\",",
          "",
          "[Added Lines]",
          "714:         shared_ldflag    => add(\"-mabi=32\"),",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "719:         cflags           => add(\"-mabi=n32 -DBN_DIV3W\"),",
          "720:         bn_ops           => \"SIXTY_FOUR_BIT RC4_CHAR\",",
          "721:         perlasm_scheme   => \"n32\",",
          "723:         multilib         => \"32\",",
          "724:     },",
          "725:     \"linux64-mips64\" => {",
          "726:         inherit_from     => [ \"linux-generic64\", asm(\"mips64_asm\") ],",
          "727:         cflags           => add(\"-mabi=64 -DBN_DIV3W\"),",
          "728:         perlasm_scheme   => \"64\",",
          "730:         multilib         => \"64\",",
          "731:     },",
          "",
          "[Removed Lines]",
          "722:         shared_ldflag    => \"-mabi=n32\",",
          "729:         shared_ldflag    => \"-mabi=64\",",
          "",
          "[Added Lines]",
          "723:         shared_ldflag    => add(\"-mabi=n32\"),",
          "730:         shared_ldflag    => add(\"-mabi=64\"),",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "753:         cflags           => add(\"-m64 -DL_ENDIAN\"),",
          "754:         bn_ops           => \"SIXTY_FOUR_BIT_LONG\",",
          "755:         perlasm_scheme   => \"elf\",",
          "757:         multilib         => \"64\",",
          "758:     },",
          "759:     \"linux-x86_64-clang\" => {",
          "",
          "[Removed Lines]",
          "756:         shared_ldflag    => \"-m64\",",
          "",
          "[Added Lines]",
          "757:         shared_ldflag    => add(\"-m64\"),",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "779:         inherit_from     => [ \"linux-generic64\", asm(\"s390x_asm\") ],",
          "780:         cflags           => add(\"-m64 -DB_ENDIAN\"),",
          "781:         perlasm_scheme   => \"64\",",
          "783:         multilib         => \"64\",",
          "784:     },",
          "785:     \"linux32-s390x\" => {",
          "",
          "[Removed Lines]",
          "782:         shared_ldflag    => \"-m64\",",
          "",
          "[Added Lines]",
          "783:         shared_ldflag    => add(\"-m64\"),",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "803:         cflags           => add(\"-m31 -Wa,-mzarch -DB_ENDIAN\"),",
          "804:         bn_asm_src       => sub { my $r=join(\" \",@_); $r=~s|asm/s390x\\.S|bn_asm.c|; $r; },",
          "805:         perlasm_scheme   => \"31\",",
          "807:         multilib         => \"/highgprs\",",
          "808:     },",
          "",
          "[Removed Lines]",
          "806:         shared_ldflag    => \"-m31\",",
          "",
          "[Added Lines]",
          "807:         shared_ldflag    => add(\"-m31\"),",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "819:         # but -Wa,-Av8plus should do the trick no matter what.",
          "820:         inherit_from     => [ \"linux-generic32\", asm(\"sparcv9_asm\") ],",
          "821:         cflags           => add(\"-m32 -mcpu=ultrasparc -Wa,-Av8plus -DB_ENDIAN -DBN_DIV2W\"),",
          "823:     },",
          "824:     \"linux64-sparcv9\" => {",
          "825:         # GCC 3.1 is a requirement",
          "826:         inherit_from     => [ \"linux-generic64\", asm(\"sparcv9_asm\") ],",
          "827:         cflags           => add(\"-m64 -mcpu=ultrasparc -DB_ENDIAN\"),",
          "828:         bn_ops           => \"BN_LLONG RC4_CHAR\",",
          "830:         multilib         => \"64\",",
          "831:     },",
          "",
          "[Removed Lines]",
          "822:         shared_ldflag    => \"-m32\",",
          "829:         shared_ldflag    => \"-m64\",",
          "",
          "[Added Lines]",
          "823:         shared_ldflag    => add(\"-m32\"),",
          "830:         shared_ldflag    => add(\"-m64\"),",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "855:         dso_scheme       => \"dlfcn\",",
          "856:         shared_target    => \"linux-shared\",",
          "857:         shared_cflag     => \"--pic\",",
          "859:         shared_extension => \".so.\\$(SHLIB_MAJOR).\\$(SHLIB_MINOR)\",",
          "860:         ranlib           => \"true\",",
          "861:     },",
          "",
          "[Removed Lines]",
          "858:         shared_ldflag    => \"-z --sysv --shared\",",
          "",
          "[Added Lines]",
          "859:         shared_ldflag    => add(\"-z --sysv --shared\"),",
          "",
          "---------------"
        ],
        "crypto/init.c||crypto/init.c": [
          "File: crypto/init.c -> crypto/init.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "81:     OPENSSL_cpuid_setup();",
          "82:     base_inited = 1;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "84: #ifndef OPENSSL_USE_NODELETE",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "91:         dso = DSO_dsobyaddr(&base_inited, DSO_FLAG_NO_UNLOAD_ON_FREE);",
          "92:         DSO_free(dso);",
          "93:     }",
          "95:     return 1;",
          "96: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "95: #endif",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "588: {",
          "589:     OPENSSL_INIT_STOP *newhand;",
          "596:     {",
          "597:         DSO *dso = NULL;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "593: #ifndef OPENSSL_USE_NODELETE",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "605:         dso = DSO_dsobyaddr(handlersym.sym, DSO_FLAG_NO_UNLOAD_ON_FREE);",
          "606:         DSO_free(dso);",
          "607:     }",
          "609:     newhand = OPENSSL_malloc(sizeof(*newhand));",
          "610:     if (newhand == NULL)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "611: #endif",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f096bbd71984fa8311939ff7422975e1c88d8362",
      "candidate_info": {
        "commit_hash": "f096bbd71984fa8311939ff7422975e1c88d8362",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/f096bbd71984fa8311939ff7422975e1c88d8362",
        "files": [
          "crypto/rsa/rsa_err.c",
          "crypto/rsa/rsa_pmeth.c",
          "include/openssl/rsa.h"
        ],
        "message": "Check input length to pkey_rsa_verify()\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/2065)\n(cherry picked from commit 71bbc79b7d3b1195a7a7dd5f547d52ddce32d6f0)",
        "before_after_code_files": [
          "crypto/rsrsa_err.c||crypto/rsa/rsa_err.c",
          "crypto/rsrsa_pmeth.c||crypto/rsa/rsa_pmeth.c",
          "include/openssl/rsa.h||include/openssl/rsa.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/rsrsa_err.c||crypto/rsa/rsa_err.c": [
          "File: crypto/rsrsa_err.c -> crypto/rsa/rsa_err.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29:     {ERR_FUNC(RSA_F_PKEY_RSA_VERIFY), \"pkey_rsa_verify\"},",
          "",
          "---------------"
        ],
        "crypto/rsrsa_pmeth.c||crypto/rsa/rsa_pmeth.c": [
          "File: crypto/rsrsa_pmeth.c -> crypto/rsa/rsa_pmeth.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "232:         if (tbslen != (size_t)EVP_MD_size(rctx->md)) {",
          "233:             RSAerr(RSA_F_PKEY_RSA_VERIFY, RSA_R_INVALID_DIGEST_LENGTH);",
          "234:             return -1;",
          "235:         }",
          "",
          "---------------"
        ],
        "include/openssl/rsa.h||include/openssl/rsa.h": [
          "File: include/openssl/rsa.h -> include/openssl/rsa.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "468: # define RSA_F_PKEY_RSA_CTRL                              143",
          "469: # define RSA_F_PKEY_RSA_CTRL_STR                          144",
          "470: # define RSA_F_PKEY_RSA_SIGN                              142",
          "471: # define RSA_F_PKEY_RSA_VERIFYRECOVER                     141",
          "472: # define RSA_F_RSA_ALGOR_TO_MD                            156",
          "473: # define RSA_F_RSA_BUILTIN_KEYGEN                         129",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "471: # define RSA_F_PKEY_RSA_VERIFY                            149",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e4815a0bd2bcb00abea63f651284100028e3436c",
      "candidate_info": {
        "commit_hash": "e4815a0bd2bcb00abea63f651284100028e3436c",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/e4815a0bd2bcb00abea63f651284100028e3436c",
        "files": [
          "test/recipes/70-test_sslrecords.t",
          "util/TLSProxy/Record.pm"
        ],
        "message": "Add a test for unrecognised record types\n\nWe should fail if we receive an unrecognised record type\n\nReviewed-by: Tim Hudson <tjh@openssl.org>\n(cherry picked from commit 1f3e70a450364e3152973380ea4d3bb6694f3980)",
        "before_after_code_files": [
          "test/recipes/70-test_sslrecords.t||test/recipes/70-test_sslrecords.t",
          "util/TLSProxy/Record.pm||util/TLSProxy/Record.pm"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/recipes/70-test_sslrecords.t||test/recipes/70-test_sslrecords.t": [
          "File: test/recipes/70-test_sslrecords.t -> test/recipes/70-test_sslrecords.t",
          "--- Hunk 1 ---",
          "[Context before]",
          "38: my $content_type = TLSProxy::Record::RT_APPLICATION_DATA;",
          "39: my $inject_recs_num = 1;",
          "40: $proxy->start() or plan skip_all => \"Unable to start up Proxy for tests\";",
          "42: ok(TLSProxy::Message->fail(), \"Out of context empty records test\");",
          "44: #Test 2: Injecting in context empty records should succeed",
          "",
          "[Removed Lines]",
          "41: plan tests => 9;",
          "",
          "[Added Lines]",
          "41: my $num_tests = 10;",
          "42: if (!disabled(\"tls1_1\")) {",
          "43:     $num_tests++;",
          "44: }",
          "45: plan tests => $num_tests;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "107: $proxy->clear();",
          "108: $proxy->start();",
          "109: ok(TLSProxy::Message->fail(), \"Alert before SSLv2 ClientHello test\");",
          "110: sub add_empty_recs_filter",
          "111: {",
          "112:     my $proxy = shift;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "115: #Unregcognised record type tests",
          "117: #Test 10: Sending an unrecognised record type in TLS1.2 should fail",
          "118: $proxy->clear();",
          "119: $proxy->filter(\\&add_unknown_record_type);",
          "120: $proxy->start();",
          "121: ok(TLSProxy::Message->fail(), \"Unrecognised record type in TLS1.2\");",
          "123: #Test 11: Sending an unrecognised record type in TLS1.1 should fail",
          "124: if (!disabled(\"tls1_1\")) {",
          "125:     $proxy->clear();",
          "126:     $proxy->clientflags(\"-tls1_1\");",
          "127:     $proxy->start();",
          "128:     ok(TLSProxy::Message->fail(), \"Unrecognised record type in TLS1.1\");",
          "129: }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "333:     }",
          "335: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "358: sub add_unknown_record_type",
          "359: {",
          "360:     my $proxy = shift;",
          "362:     # We'll change a record after the initial version neg has taken place",
          "363:     if ($proxy->flight != 2) {",
          "364:         return;",
          "365:     }",
          "367:     my $lastrec = ${$proxy->record_list}[-1];",
          "368:     my $record = TLSProxy::Record->new(",
          "369:         2,",
          "370:         TLSProxy::Record::RT_UNKNOWN,",
          "371:         $lastrec->version(),",
          "372:         1,",
          "373:         0,",
          "374:         1,",
          "375:         1,",
          "376:         \"X\",",
          "377:         \"X\"",
          "378:     );",
          "380:     unshift @{$proxy->record_list}, $record;",
          "381: }",
          "",
          "---------------"
        ],
        "util/TLSProxy/Record.pm||util/TLSProxy/Record.pm": [
          "File: util/TLSProxy/Record.pm -> util/TLSProxy/Record.pm",
          "--- Hunk 1 ---",
          "[Context before]",
          "22:     RT_APPLICATION_DATA => 23,",
          "23:     RT_HANDSHAKE => 22,",
          "24:     RT_ALERT => 21,",
          "26: };",
          "28: my %record_type = (",
          "29:     RT_APPLICATION_DATA, \"APPLICATION DATA\",",
          "30:     RT_HANDSHAKE, \"HANDSHAKE\",",
          "31:     RT_ALERT, \"ALERT\",",
          "33: );",
          "35: use constant {",
          "",
          "[Removed Lines]",
          "25:     RT_CCS => 20",
          "32:     RT_CCS, \"CCS\"",
          "",
          "[Added Lines]",
          "25:     RT_CCS => 20,",
          "26:     RT_UNKNOWN => 100",
          "33:     RT_CCS, \"CCS\",",
          "34:     RT_UNKNOWN, \"UNKNOWN\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}