{
  "cve_id": "CVE-2014-0063",
  "cve_desc": "Multiple stack-based buffer overflows in PostgreSQL before 8.4.20, 9.0.x before 9.0.16, 9.1.x before 9.1.12, 9.2.x before 9.2.7, and 9.3.x before 9.3.3 allow remote authenticated users to cause a denial of service (crash) or possibly execute arbitrary code via vectors related to an incorrect MAXDATELEN constant and datetime values involving (1) intervals, (2) timestamps, or (3) timezones, a different vulnerability than CVE-2014-0065.",
  "repo": "postgres/postgres",
  "patch_hash": "4318daecc959886d001a6e79c6ea853e8b1dfb4b",
  "patch_info": {
    "commit_hash": "4318daecc959886d001a6e79c6ea853e8b1dfb4b",
    "repo": "postgres/postgres",
    "commit_url": "https://github.com/postgres/postgres/commit/4318daecc959886d001a6e79c6ea853e8b1dfb4b",
    "files": [
      "src/include/utils/datetime.h",
      "src/interfaces/ecpg/pgtypeslib/datetime.c",
      "src/interfaces/ecpg/pgtypeslib/dt.h",
      "src/interfaces/ecpg/pgtypeslib/dt_common.c",
      "src/interfaces/ecpg/pgtypeslib/interval.c",
      "src/interfaces/ecpg/pgtypeslib/timestamp.c",
      "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c",
      "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout",
      "src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc",
      "src/test/regress/expected/interval.out",
      "src/test/regress/sql/interval.sql"
    ],
    "message": "Fix handling of wide datetime input/output.\n\nMany server functions use the MAXDATELEN constant to size a buffer for\nparsing or displaying a datetime value.  It was much too small for the\nlongest possible interval output and slightly too small for certain\nvalid timestamp input, particularly input with a long timezone name.\nThe long input was rejected needlessly; the long output caused\ninterval_out() to overrun its buffer.  ECPG's pgtypes library has a copy\nof the vulnerable functions, which bore the same vulnerabilities along\nwith some of its own.  In contrast to the server, certain long inputs\ncaused stack overflow rather than failing cleanly.  Back-patch to 8.4\n(all supported versions).\n\nReported by Daniel Sch\u00fcssler, reviewed by Tom Lane.\n\nSecurity: CVE-2014-0063",
    "before_after_code_files": [
      "src/include/utils/datetime.h||src/include/utils/datetime.h",
      "src/interfaces/ecpg/pgtypeslib/datetime.c||src/interfaces/ecpg/pgtypeslib/datetime.c",
      "src/interfaces/ecpg/pgtypeslib/dt.h||src/interfaces/ecpg/pgtypeslib/dt.h",
      "src/interfaces/ecpg/pgtypeslib/dt_common.c||src/interfaces/ecpg/pgtypeslib/dt_common.c",
      "src/interfaces/ecpg/pgtypeslib/interval.c||src/interfaces/ecpg/pgtypeslib/interval.c",
      "src/interfaces/ecpg/pgtypeslib/timestamp.c||src/interfaces/ecpg/pgtypeslib/timestamp.c",
      "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c",
      "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout",
      "src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc||src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc",
      "src/test/regress/sql/interval.sql||src/test/regress/sql/interval.sql"
    ]
  },
  "patch_diff": {
    "src/include/utils/datetime.h||src/include/utils/datetime.h": [
      "File: src/include/utils/datetime.h -> src/include/utils/datetime.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "188: #define DTK_DATE_M  (DTK_M(YEAR) | DTK_M(MONTH) | DTK_M(DAY))",
      "189: #define DTK_TIME_M  (DTK_M(HOUR) | DTK_M(MINUTE) | DTK_ALL_SECS_M)",
      "199: typedef struct",
      "",
      "[Removed Lines]",
      "191: #define MAXDATELEN  63  /* maximum possible length of an input date",
      "193: #define MAXDATEFIELDS 25  /* maximum possible number of fields in a date",
      "195: #define TOKMAXLEN  10  /* only this many chars are stored in",
      "",
      "[Added Lines]",
      "197: #define MAXDATELEN  128",
      "199: #define MAXDATEFIELDS 25",
      "201: #define TOKMAXLEN  10",
      "",
      "---------------"
    ],
    "src/interfaces/ecpg/pgtypeslib/datetime.c||src/interfaces/ecpg/pgtypeslib/datetime.c": [
      "File: src/interfaces/ecpg/pgtypeslib/datetime.c -> src/interfaces/ecpg/pgtypeslib/datetime.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "60:  int   nf;",
      "61:  char    *field[MAXDATEFIELDS];",
      "62:  int   ftype[MAXDATEFIELDS];",
      "64:  char    *realptr;",
      "65:  char   **ptr = (endptr != NULL) ? endptr : &realptr;",
      "67:  bool  EuroDates = FALSE;",
      "69:  errno = 0;",
      "71:  {",
      "72:   errno = PGTYPES_DATE_BAD_DATE;",
      "73:   return INT_MIN;",
      "",
      "[Removed Lines]",
      "63:  char  lowstr[MAXDATELEN + 1];",
      "70:  if (strlen(str) >= sizeof(lowstr))",
      "",
      "[Added Lines]",
      "63:  char  lowstr[MAXDATELEN + MAXDATEFIELDS];",
      "70:  if (strlen(str) > MAXDATELEN)",
      "",
      "---------------"
    ],
    "src/interfaces/ecpg/pgtypeslib/dt.h||src/interfaces/ecpg/pgtypeslib/dt.h": [
      "File: src/interfaces/ecpg/pgtypeslib/dt.h -> src/interfaces/ecpg/pgtypeslib/dt.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "192: #define DTK_DATE_M  (DTK_M(YEAR) | DTK_M(MONTH) | DTK_M(DAY))",
      "193: #define DTK_TIME_M  (DTK_M(HOUR) | DTK_M(MINUTE) | DTK_M(SECOND))",
      "203: typedef struct",
      "",
      "[Removed Lines]",
      "195: #define MAXDATELEN  63  /* maximum possible length of an input date",
      "197: #define MAXDATEFIELDS 25  /* maximum possible number of fields in a date",
      "199: #define TOKMAXLEN  10  /* only this many chars are stored in",
      "",
      "[Added Lines]",
      "201: #define MAXDATELEN  128",
      "203: #define MAXDATEFIELDS 25",
      "205: #define TOKMAXLEN  10",
      "",
      "---------------"
    ],
    "src/interfaces/ecpg/pgtypeslib/dt_common.c||src/interfaces/ecpg/pgtypeslib/dt_common.c": [
      "File: src/interfaces/ecpg/pgtypeslib/dt_common.c -> src/interfaces/ecpg/pgtypeslib/dt_common.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1171:  if ((cp = strchr(str, '.')) != NULL)",
      "1172:  {",
      "1173: #ifdef HAVE_INT64_TIMESTAMP",
      "1184: #else",
      "",
      "[Removed Lines]",
      "1174:   char  fstr[MAXDATELEN + 1];",
      "1180:   strcpy(fstr, (cp + 1));",
      "1181:   strcpy(fstr + strlen(fstr), \"000000\");",
      "",
      "[Added Lines]",
      "1174:   char  fstr[7];",
      "1175:   int   i;",
      "1177:   cp++;",
      "1187:   for (i = 0; i < 6; i++)",
      "1188:    fstr[i] = *cp != '\\0' ? *cp++ : '0';",
      "1189:   fstr[i] = '\\0';",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1531:   else if (*cp == '.')",
      "1532:   {",
      "1533: #ifdef HAVE_INT64_TIMESTAMP",
      "1544: #else",
      "1545:    str = cp;",
      "",
      "[Removed Lines]",
      "1534:    char  fstr[MAXDATELEN + 1];",
      "1540:    strncpy(fstr, (cp + 1), 7);",
      "1541:    strcpy(fstr + strlen(fstr), \"000000\");",
      "",
      "[Added Lines]",
      "1541:    char  fstr[7];",
      "1542:    int   i;",
      "1544:    cp++;",
      "1554:    for (i = 0; i < 6; i++)",
      "1555:     fstr[i] = *cp != '\\0' ? *cp++ : '0';",
      "1556:    fstr[i] = '\\0';",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1678:  while (*(*endstr) != '\\0')",
      "1679:  {",
      "1680:   field[nf] = lp;",
      "1683:   if (isdigit((unsigned char) *(*endstr)))",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1699:   if (nf >= MAXDATEFIELDS)",
      "1700:    return -1;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "1820:   nf++;",
      "1823:  }",
      "",
      "[Removed Lines]",
      "1821:   if (nf > MAXDATEFIELDS)",
      "1822:    return -1;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "src/interfaces/ecpg/pgtypeslib/interval.c||src/interfaces/ecpg/pgtypeslib/interval.c": [
      "File: src/interfaces/ecpg/pgtypeslib/interval.c -> src/interfaces/ecpg/pgtypeslib/interval.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1094:  tm->tm_sec = 0;",
      "1095:  fsec = 0;",
      "1098:  {",
      "1099:   errno = PGTYPES_INTVL_BAD_INTERVAL;",
      "1100:   return NULL;",
      "",
      "[Removed Lines]",
      "1097:  if (strlen(str) >= sizeof(lowstr))",
      "",
      "[Added Lines]",
      "1097:  if (strlen(str) > MAXDATELEN)",
      "",
      "---------------"
    ],
    "src/interfaces/ecpg/pgtypeslib/timestamp.c||src/interfaces/ecpg/pgtypeslib/timestamp.c": [
      "File: src/interfaces/ecpg/pgtypeslib/timestamp.c -> src/interfaces/ecpg/pgtypeslib/timestamp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "294:  char    *realptr;",
      "295:  char   **ptr = (endptr != NULL) ? endptr : &realptr;",
      "298:  {",
      "299:   errno = PGTYPES_TS_BAD_TIMESTAMP;",
      "300:   return (noresult);",
      "",
      "[Removed Lines]",
      "297:  if (strlen(str) >= sizeof(lowstr))",
      "",
      "[Added Lines]",
      "297:  if (strlen(str) > MAXDATELEN)",
      "",
      "---------------"
    ],
    "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c": [
      "File: src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c -> src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "45:       \"1999.008\",",
      "46:       \"J2451187\",",
      "47:       \"January 8, 99 BC\",",
      "48:       NULL };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "52:       \"........................Xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"",
      "53:       \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",",
      "55:       \".........................aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"",
      "56:       \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "52:       \"1:59 PDT\",",
      "53:       \"13:24:40 -8:00\",",
      "54:       \"13:24:40.495+3\",",
      "55:       NULL };",
      "57: char *intervals[] = { \"1 minute\",",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "64:       \"13:24:40.123456789+3\",",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "77:  date date1 ;",
      "80:  timestamp ts1 , ts2 ;",
      "83:  char * text ;",
      "86:  interval * i1 ;",
      "89:  date * dc ;",
      "94:  int i, j;",
      "",
      "[Removed Lines]",
      "76: #line 52 \"dt_test2.pgc\"",
      "79: #line 53 \"dt_test2.pgc\"",
      "82: #line 54 \"dt_test2.pgc\"",
      "85: #line 55 \"dt_test2.pgc\"",
      "88: #line 56 \"dt_test2.pgc\"",
      "91: #line 57 \"dt_test2.pgc\"",
      "",
      "[Added Lines]",
      "86: #line 62 \"dt_test2.pgc\"",
      "89: #line 63 \"dt_test2.pgc\"",
      "92: #line 64 \"dt_test2.pgc\"",
      "95: #line 65 \"dt_test2.pgc\"",
      "98: #line 66 \"dt_test2.pgc\"",
      "101: #line 67 \"dt_test2.pgc\"",
      "",
      "---------------"
    ],
    "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout": [
      "File: src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout -> src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout",
      "--- Hunk 1 ---",
      "[Context before]",
      "8: TS[3,1]: 1999-01-08 01:59:00",
      "9: TS[3,2]: 1999-01-08 13:24:40",
      "10: TS[3,3]: 1999-01-08 13:24:40.495",
      "11: Date[4]: 1999-01-08 (N - F)",
      "12: TS[4,0]: 1999-01-08 00:04:00",
      "13: TS[4,1]: 1999-01-08 01:59:00",
      "14: TS[4,2]: 1999-01-08 13:24:40",
      "15: TS[4,3]: 1999-01-08 13:24:40.495",
      "16: Date[5]: 1999-01-08 (N - F)",
      "17: TS[5,0]: 1999-01-08 00:04:00",
      "18: TS[5,1]: 1999-01-08 01:59:00",
      "19: TS[5,2]: 1999-01-08 13:24:40",
      "20: TS[5,3]: 1999-01-08 13:24:40.495",
      "21: Date[6]: 1999-01-18 (N - F)",
      "22: TS[6,0]: 1999-01-18 00:04:00",
      "23: TS[6,1]: 1999-01-18 01:59:00",
      "24: TS[6,2]: 1999-01-18 13:24:40",
      "25: TS[6,3]: 1999-01-18 13:24:40.495",
      "26: Date[7]: 2003-01-02 (N - F)",
      "27: TS[7,0]: 2003-01-02 00:04:00",
      "28: TS[7,1]: 2003-01-02 01:59:00",
      "29: TS[7,2]: 2003-01-02 13:24:40",
      "30: TS[7,3]: 2003-01-02 13:24:40.495",
      "31: Date[8]: 1999-01-08 (N - F)",
      "32: TS[8,0]: 1999-01-08 00:04:00",
      "33: TS[8,1]: 1999-01-08 01:59:00",
      "34: TS[8,2]: 1999-01-08 13:24:40",
      "35: TS[8,3]: 1999-01-08 13:24:40.495",
      "36: Date[9]: 1999-01-08 (N - F)",
      "37: TS[9,0]: 1999-01-08 00:04:00",
      "38: TS[9,1]: 1999-01-08 01:59:00",
      "39: TS[9,2]: 1999-01-08 13:24:40",
      "40: TS[9,3]: 1999-01-08 13:24:40.495",
      "41: Date[10]: 1999-01-08 (N - F)",
      "42: TS[10,0]: 1999-01-08 00:04:00",
      "43: TS[10,1]: 1999-01-08 01:59:00",
      "44: TS[10,2]: 1999-01-08 13:24:40",
      "45: TS[10,3]: 1999-01-08 13:24:40.495",
      "46: Date[11]: 1999-01-08 (N - F)",
      "47: TS[11,0]: 1999-01-08 00:04:00",
      "48: TS[11,1]: 1999-01-08 01:59:00",
      "49: TS[11,2]: 1999-01-08 13:24:40",
      "50: TS[11,3]: 1999-01-08 13:24:40.495",
      "51: Date[12]: 1999-01-08 (N - F)",
      "52: TS[12,0]: 1999-01-08 00:04:00",
      "53: TS[12,1]: 1999-01-08 01:59:00",
      "54: TS[12,2]: 1999-01-08 13:24:40",
      "55: TS[12,3]: 1999-01-08 13:24:40.495",
      "56: Date[13]: 2006-01-08 (N - F)",
      "57: TS[13,0]: 2006-01-08 00:04:00",
      "58: TS[13,1]: 2006-01-08 01:59:00",
      "59: TS[13,2]: 2006-01-08 13:24:40",
      "60: TS[13,3]: 2006-01-08 13:24:40.495",
      "61: Date[14]: 1999-01-08 (N - F)",
      "62: TS[14,0]: 1999-01-08 00:04:00",
      "63: TS[14,1]: 1999-01-08 01:59:00",
      "64: TS[14,2]: 1999-01-08 13:24:40",
      "65: TS[14,3]: 1999-01-08 13:24:40.495",
      "66: Date[15]: 1999-01-08 (N - F)",
      "67: TS[15,0]: 1999-01-08 00:04:00",
      "68: TS[15,1]: 1999-01-08 01:59:00",
      "69: TS[15,2]: 1999-01-08 13:24:40",
      "70: TS[15,3]: 1999-01-08 13:24:40.495",
      "71: Date[16]: 1999-01-08 (N - F)",
      "72: TS[16,0]: 1999-01-08 00:04:00",
      "73: TS[16,1]: 1999-01-08 01:59:00",
      "74: TS[16,2]: 1999-01-08 13:24:40",
      "75: TS[16,3]: 1999-01-08 13:24:40.495",
      "76: Date[17]: 1999-01-08 (N - F)",
      "77: TS[17,0]: 1999-01-08 00:04:00",
      "78: TS[17,1]: 1999-01-08 01:59:00",
      "79: TS[17,2]: 1999-01-08 13:24:40",
      "80: TS[17,3]: 1999-01-08 13:24:40.495",
      "81: Date[18]: 1999-01-08 (N - F)",
      "82: TS[18,0]: 1999-01-08 00:04:00",
      "83: TS[18,1]: 1999-01-08 01:59:00",
      "84: TS[18,2]: 1999-01-08 13:24:40",
      "85: TS[18,3]: 1999-01-08 13:24:40.495",
      "86: Date[19]: 0099-01-08 BC (N - F)",
      "87: TS[19,0]: 0099-01-08 00:04:00 BC",
      "88: TS[19,1]: 0099-01-08 01:59:00 BC",
      "89: TS[19,2]: 0099-01-08 13:24:40 BC",
      "90: interval[0]: @ 1 min",
      "91: interval_copy[0]: @ 1 min",
      "92: interval[1]: @ 1 day 12 hours 59 mins 10 secs",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "11: TS[3,4]: 1999-01-08 13:24:40.123456",
      "17: TS[4,4]: 1999-01-08 13:24:40.123456",
      "23: TS[5,4]: 1999-01-08 13:24:40.123456",
      "29: TS[6,4]: 1999-01-18 13:24:40.123456",
      "35: TS[7,4]: 2003-01-02 13:24:40.123456",
      "41: TS[8,4]: 1999-01-08 13:24:40.123456",
      "47: TS[9,4]: 1999-01-08 13:24:40.123456",
      "53: TS[10,4]: 1999-01-08 13:24:40.123456",
      "59: TS[11,4]: 1999-01-08 13:24:40.123456",
      "65: TS[12,4]: 1999-01-08 13:24:40.123456",
      "71: TS[13,4]: 2006-01-08 13:24:40.123456",
      "77: TS[14,4]: 1999-01-08 13:24:40.123456",
      "83: TS[15,4]: 1999-01-08 13:24:40.123456",
      "89: TS[16,4]: 1999-01-08 13:24:40.123456",
      "95: TS[17,4]: 1999-01-08 13:24:40.123456",
      "101: TS[18,4]: 1999-01-08 13:24:40.123456",
      "106: TS[19,4]: 0099-01-08 13:24:40.123456 BC",
      "107: Date[20]: - (N - T)",
      "108: Date[21]: - (N - T)",
      "",
      "---------------"
    ],
    "src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc||src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc": [
      "File: src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc -> src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc",
      "--- Hunk 1 ---",
      "[Context before]",
      "27:       \"1999.008\",",
      "28:       \"J2451187\",",
      "29:       \"January 8, 99 BC\",",
      "30:       NULL };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "34:       \"........................Xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"",
      "35:       \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",",
      "37:       \".........................aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"",
      "38:       \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "34:       \"1:59 PDT\",",
      "35:       \"13:24:40 -8:00\",",
      "36:       \"13:24:40.495+3\",",
      "37:       NULL };",
      "39: char *intervals[] = { \"1 minute\",",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "46:       \"13:24:40.123456789+3\",",
      "",
      "---------------"
    ],
    "src/test/regress/sql/interval.sql||src/test/regress/sql/interval.sql": [
      "File: src/test/regress/sql/interval.sql -> src/test/regress/sql/interval.sql",
      "--- Hunk 1 ---",
      "[Context before]",
      "108: -- test long interval input",
      "109: select '4 millenniums 5 centuries 4 decades 1 year 4 months 4 days 17 minutes 31 seconds'::interval;",
      "112: -- test justify_hours() and justify_days()",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "111: -- test long interval output",
      "112: select '100000000y 10mon -1000000000d -1000000000h -10min -10.000001s ago'::interval;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5d320a16ca544d6e125e962ed325463ad8bec240",
      "candidate_info": {
        "commit_hash": "5d320a16ca544d6e125e962ed325463ad8bec240",
        "repo": "postgres/postgres",
        "commit_url": "https://github.com/postgres/postgres/commit/5d320a16ca544d6e125e962ed325463ad8bec240",
        "files": [
          "doc/src/sgml/ref/grant.sgml",
          "src/backend/commands/user.c",
          "src/backend/utils/adt/acl.c",
          "src/test/regress/expected/privileges.out",
          "src/test/regress/sql/privileges.sql"
        ],
        "message": "Shore up ADMIN OPTION restrictions.\n\nGranting a role without ADMIN OPTION is supposed to prevent the grantee\nfrom adding or removing members from the granted role.  Issuing SET ROLE\nbefore the GRANT bypassed that, because the role itself had an implicit\nright to add or remove members.  Plug that hole by recognizing that\nimplicit right only when the session user matches the current role.\nAdditionally, do not recognize it during a security-restricted operation\nor during execution of a SECURITY DEFINER function.  The restriction on\nSECURITY DEFINER is not security-critical.  However, it seems best for a\nuser testing his own SECURITY DEFINER function to see the same behavior\nothers will see.  Back-patch to 8.4 (all supported versions).\n\nThe SQL standards do not conflate roles and users as PostgreSQL does;\nonly SQL roles have members, and only SQL users initiate sessions.  An\napplication using PostgreSQL users and roles as SQL users and roles will\nnever attempt to grant membership in the role that is the session user,\nso the implicit right to add or remove members will never arise.\n\nThe security impact was mostly that a role member could revoke access\nfrom others, contrary to the wishes of his own grantor.  Unapproved role\nmember additions are less notable, because the member can still largely\nachieve that by creating a view or a SECURITY DEFINER function.\n\nReviewed by Andres Freund and Tom Lane.  Reported, independently, by\nJonas Sundman and Noah Misch.\n\nSecurity: CVE-2014-0060",
        "before_after_code_files": [
          "src/backend/commands/user.c||src/backend/commands/user.c",
          "src/backend/utils/adt/acl.c||src/backend/utils/adt/acl.c",
          "src/test/regress/sql/privileges.sql||src/test/regress/sql/privileges.sql"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/backend/commands/user.c||src/backend/commands/user.c": [
          "File: src/backend/commands/user.c -> src/backend/commands/user.c"
        ],
        "src/backend/utils/adt/acl.c||src/backend/utils/adt/acl.c": [
          "File: src/backend/utils/adt/acl.c -> src/backend/utils/adt/acl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4644:  List    *roles_list;",
          "4645:  ListCell   *l;",
          "4652:  if (superuser_arg(member))",
          "4653:   return true;",
          "",
          "[Removed Lines]",
          "4648:  if (member == role)",
          "4649:   return true;",
          "",
          "[Added Lines]",
          "4653:  if (member == role)",
          "4682:   return member == GetSessionUserId() &&",
          "4683:    !InLocalUserIdChange() && !InSecurityRestrictedOperation();",
          "",
          "---------------"
        ],
        "src/test/regress/sql/privileges.sql||src/test/regress/sql/privileges.sql": [
          "File: src/test/regress/sql/privileges.sql -> src/test/regress/sql/privileges.sql",
          "--- Hunk 1 ---",
          "[Context before]",
          "38: ALTER GROUP regressgroup2 ADD USER regressuser2; -- duplicate",
          "39: ALTER GROUP regressgroup2 DROP USER regressuser2;",
          "42: -- test owner privileges",
          "",
          "[Removed Lines]",
          "40: ALTER GROUP regressgroup2 ADD USER regressuser4;",
          "",
          "[Added Lines]",
          "40: GRANT regressgroup2 TO regressuser4 WITH ADMIN OPTION;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "472: SELECT has_table_privilege('regressuser1', 'atest4', 'SELECT WITH GRANT OPTION'); -- true",
          "475: -- has_sequence_privilege tests",
          "476: \\c -",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "475: -- Admin options",
          "477: SET SESSION AUTHORIZATION regressuser4;",
          "478: CREATE FUNCTION dogrant_ok() RETURNS void LANGUAGE sql SECURITY DEFINER AS",
          "479:  'GRANT regressgroup2 TO regressuser5';",
          "480: GRANT regressgroup2 TO regressuser5; -- ok: had ADMIN OPTION",
          "481: SET ROLE regressgroup2;",
          "482: GRANT regressgroup2 TO regressuser5; -- fails: SET ROLE suspended privilege",
          "484: SET SESSION AUTHORIZATION regressuser1;",
          "485: GRANT regressgroup2 TO regressuser5; -- fails: no ADMIN OPTION",
          "486: SELECT dogrant_ok();   -- ok: SECURITY DEFINER conveys ADMIN",
          "487: SET ROLE regressgroup2;",
          "488: GRANT regressgroup2 TO regressuser5; -- fails: SET ROLE did not help",
          "490: SET SESSION AUTHORIZATION regressgroup2;",
          "491: GRANT regressgroup2 TO regressuser5; -- ok: a role can self-admin",
          "492: CREATE FUNCTION dogrant_fails() RETURNS void LANGUAGE sql SECURITY DEFINER AS",
          "493:  'GRANT regressgroup2 TO regressuser5';",
          "494: SELECT dogrant_fails();   -- fails: no self-admin in SECURITY DEFINER",
          "495: DROP FUNCTION dogrant_fails();",
          "497: SET SESSION AUTHORIZATION regressuser4;",
          "498: DROP FUNCTION dogrant_ok();",
          "499: REVOKE regressgroup2 FROM regressuser5;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b9c3bb1b320afadbf292c408d213b48b1655072c",
      "candidate_info": {
        "commit_hash": "b9c3bb1b320afadbf292c408d213b48b1655072c",
        "repo": "postgres/postgres",
        "commit_url": "https://github.com/postgres/postgres/commit/b9c3bb1b320afadbf292c408d213b48b1655072c",
        "files": [
          "src/include/utils/datetime.h",
          "src/interfaces/ecpg/pgtypeslib/datetime.c",
          "src/interfaces/ecpg/pgtypeslib/dt.h",
          "src/interfaces/ecpg/pgtypeslib/dt_common.c",
          "src/interfaces/ecpg/pgtypeslib/interval.c",
          "src/interfaces/ecpg/pgtypeslib/timestamp.c",
          "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c",
          "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout",
          "src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc",
          "src/test/regress/expected/interval.out",
          "src/test/regress/sql/interval.sql"
        ],
        "message": "Fix handling of wide datetime input/output.\n\nMany server functions use the MAXDATELEN constant to size a buffer for\nparsing or displaying a datetime value.  It was much too small for the\nlongest possible interval output and slightly too small for certain\nvalid timestamp input, particularly input with a long timezone name.\nThe long input was rejected needlessly; the long output caused\ninterval_out() to overrun its buffer.  ECPG's pgtypes library has a copy\nof the vulnerable functions, which bore the same vulnerabilities along\nwith some of its own.  In contrast to the server, certain long inputs\ncaused stack overflow rather than failing cleanly.  Back-patch to 8.4\n(all supported versions).\n\nReported by Daniel Sch\u00fcssler, reviewed by Tom Lane.\n\nSecurity: CVE-2014-0063",
        "before_after_code_files": [
          "src/include/utils/datetime.h||src/include/utils/datetime.h",
          "src/interfaces/ecpg/pgtypeslib/datetime.c||src/interfaces/ecpg/pgtypeslib/datetime.c",
          "src/interfaces/ecpg/pgtypeslib/dt.h||src/interfaces/ecpg/pgtypeslib/dt.h",
          "src/interfaces/ecpg/pgtypeslib/dt_common.c||src/interfaces/ecpg/pgtypeslib/dt_common.c",
          "src/interfaces/ecpg/pgtypeslib/interval.c||src/interfaces/ecpg/pgtypeslib/interval.c",
          "src/interfaces/ecpg/pgtypeslib/timestamp.c||src/interfaces/ecpg/pgtypeslib/timestamp.c",
          "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c",
          "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout",
          "src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc||src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc",
          "src/test/regress/sql/interval.sql||src/test/regress/sql/interval.sql"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/include/utils/datetime.h||src/include/utils/datetime.h",
            "src/interfaces/ecpg/pgtypeslib/datetime.c||src/interfaces/ecpg/pgtypeslib/datetime.c",
            "src/interfaces/ecpg/pgtypeslib/dt.h||src/interfaces/ecpg/pgtypeslib/dt.h",
            "src/interfaces/ecpg/pgtypeslib/dt_common.c||src/interfaces/ecpg/pgtypeslib/dt_common.c",
            "src/interfaces/ecpg/pgtypeslib/interval.c||src/interfaces/ecpg/pgtypeslib/interval.c",
            "src/interfaces/ecpg/pgtypeslib/timestamp.c||src/interfaces/ecpg/pgtypeslib/timestamp.c",
            "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c",
            "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout",
            "src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc||src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc",
            "src/test/regress/sql/interval.sql||src/test/regress/sql/interval.sql"
          ],
          "candidate": [
            "src/include/utils/datetime.h||src/include/utils/datetime.h",
            "src/interfaces/ecpg/pgtypeslib/datetime.c||src/interfaces/ecpg/pgtypeslib/datetime.c",
            "src/interfaces/ecpg/pgtypeslib/dt.h||src/interfaces/ecpg/pgtypeslib/dt.h",
            "src/interfaces/ecpg/pgtypeslib/dt_common.c||src/interfaces/ecpg/pgtypeslib/dt_common.c",
            "src/interfaces/ecpg/pgtypeslib/interval.c||src/interfaces/ecpg/pgtypeslib/interval.c",
            "src/interfaces/ecpg/pgtypeslib/timestamp.c||src/interfaces/ecpg/pgtypeslib/timestamp.c",
            "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c",
            "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout",
            "src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc||src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc",
            "src/test/regress/sql/interval.sql||src/test/regress/sql/interval.sql"
          ]
        }
      },
      "candidate_diff": {
        "src/include/utils/datetime.h||src/include/utils/datetime.h": [
          "File: src/include/utils/datetime.h -> src/include/utils/datetime.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "188: #define DTK_DATE_M  (DTK_M(YEAR) | DTK_M(MONTH) | DTK_M(DAY))",
          "189: #define DTK_TIME_M  (DTK_M(HOUR) | DTK_M(MINUTE) | DTK_ALL_SECS_M)",
          "199: typedef struct",
          "",
          "[Removed Lines]",
          "191: #define MAXDATELEN  63  /* maximum possible length of an input date",
          "193: #define MAXDATEFIELDS 25  /* maximum possible number of fields in a date",
          "195: #define TOKMAXLEN  10  /* only this many chars are stored in",
          "",
          "[Added Lines]",
          "197: #define MAXDATELEN  128",
          "199: #define MAXDATEFIELDS 25",
          "201: #define TOKMAXLEN  10",
          "",
          "---------------"
        ],
        "src/interfaces/ecpg/pgtypeslib/datetime.c||src/interfaces/ecpg/pgtypeslib/datetime.c": [
          "File: src/interfaces/ecpg/pgtypeslib/datetime.c -> src/interfaces/ecpg/pgtypeslib/datetime.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "61:  int   nf;",
          "62:  char    *field[MAXDATEFIELDS];",
          "63:  int   ftype[MAXDATEFIELDS];",
          "65:  char    *realptr;",
          "66:  char   **ptr = (endptr != NULL) ? endptr : &realptr;",
          "68:  bool  EuroDates = FALSE;",
          "70:  errno = 0;",
          "72:  {",
          "73:   errno = PGTYPES_DATE_BAD_DATE;",
          "74:   return INT_MIN;",
          "",
          "[Removed Lines]",
          "64:  char  lowstr[MAXDATELEN + 1];",
          "71:  if (strlen(str) >= sizeof(lowstr))",
          "",
          "[Added Lines]",
          "64:  char  lowstr[MAXDATELEN + MAXDATEFIELDS];",
          "71:  if (strlen(str) > MAXDATELEN)",
          "",
          "---------------"
        ],
        "src/interfaces/ecpg/pgtypeslib/dt.h||src/interfaces/ecpg/pgtypeslib/dt.h": [
          "File: src/interfaces/ecpg/pgtypeslib/dt.h -> src/interfaces/ecpg/pgtypeslib/dt.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "192: #define DTK_DATE_M  (DTK_M(YEAR) | DTK_M(MONTH) | DTK_M(DAY))",
          "193: #define DTK_TIME_M  (DTK_M(HOUR) | DTK_M(MINUTE) | DTK_M(SECOND))",
          "203: typedef struct",
          "",
          "[Removed Lines]",
          "195: #define MAXDATELEN  63  /* maximum possible length of an input date",
          "197: #define MAXDATEFIELDS 25  /* maximum possible number of fields in a date",
          "199: #define TOKMAXLEN  10  /* only this many chars are stored in",
          "",
          "[Added Lines]",
          "201: #define MAXDATELEN  128",
          "203: #define MAXDATEFIELDS 25",
          "205: #define TOKMAXLEN  10",
          "",
          "---------------"
        ],
        "src/interfaces/ecpg/pgtypeslib/dt_common.c||src/interfaces/ecpg/pgtypeslib/dt_common.c": [
          "File: src/interfaces/ecpg/pgtypeslib/dt_common.c -> src/interfaces/ecpg/pgtypeslib/dt_common.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1161:  if ((cp = strchr(str, '.')) != NULL)",
          "1162:  {",
          "1163: #ifdef HAVE_INT64_TIMESTAMP",
          "1174: #else",
          "",
          "[Removed Lines]",
          "1164:   char  fstr[MAXDATELEN + 1];",
          "1170:   strcpy(fstr, (cp + 1));",
          "1171:   strcpy(fstr + strlen(fstr), \"000000\");",
          "",
          "[Added Lines]",
          "1164:   char  fstr[7];",
          "1165:   int   i;",
          "1167:   cp++;",
          "1177:   for (i = 0; i < 6; i++)",
          "1178:    fstr[i] = *cp != '\\0' ? *cp++ : '0';",
          "1179:   fstr[i] = '\\0';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1521:   else if (*cp == '.')",
          "1522:   {",
          "1523: #ifdef HAVE_INT64_TIMESTAMP",
          "1534: #else",
          "1535:    str = cp;",
          "",
          "[Removed Lines]",
          "1524:    char  fstr[MAXDATELEN + 1];",
          "1530:    strncpy(fstr, (cp + 1), 7);",
          "1531:    strcpy(fstr + strlen(fstr), \"000000\");",
          "",
          "[Added Lines]",
          "1531:    char  fstr[7];",
          "1532:    int   i;",
          "1534:    cp++;",
          "1544:    for (i = 0; i < 6; i++)",
          "1545:     fstr[i] = *cp != '\\0' ? *cp++ : '0';",
          "1546:    fstr[i] = '\\0';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1668:  while (*(*endstr) != '\\0')",
          "1669:  {",
          "1670:   field[nf] = lp;",
          "1673:   if (isdigit((unsigned char) *(*endstr)))",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1689:   if (nf >= MAXDATEFIELDS)",
          "1690:    return -1;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1810:   nf++;",
          "1813:  }",
          "",
          "[Removed Lines]",
          "1811:   if (nf > MAXDATEFIELDS)",
          "1812:    return -1;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/interfaces/ecpg/pgtypeslib/interval.c||src/interfaces/ecpg/pgtypeslib/interval.c": [
          "File: src/interfaces/ecpg/pgtypeslib/interval.c -> src/interfaces/ecpg/pgtypeslib/interval.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1092:  tm->tm_sec = 0;",
          "1093:  fsec = 0;",
          "1096:  {",
          "1097:   errno = PGTYPES_INTVL_BAD_INTERVAL;",
          "1098:   return NULL;",
          "",
          "[Removed Lines]",
          "1095:  if (strlen(str) >= sizeof(lowstr))",
          "",
          "[Added Lines]",
          "1095:  if (strlen(str) > MAXDATELEN)",
          "",
          "---------------"
        ],
        "src/interfaces/ecpg/pgtypeslib/timestamp.c||src/interfaces/ecpg/pgtypeslib/timestamp.c": [
          "File: src/interfaces/ecpg/pgtypeslib/timestamp.c -> src/interfaces/ecpg/pgtypeslib/timestamp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "297:  char    *realptr;",
          "298:  char   **ptr = (endptr != NULL) ? endptr : &realptr;",
          "301:  {",
          "302:   errno = PGTYPES_TS_BAD_TIMESTAMP;",
          "303:   return (noresult);",
          "",
          "[Removed Lines]",
          "300:  if (strlen(str) >= sizeof(lowstr))",
          "",
          "[Added Lines]",
          "300:  if (strlen(str) > MAXDATELEN)",
          "",
          "---------------"
        ],
        "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c": [
          "File: src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c -> src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "45:       \"1999.008\",",
          "46:       \"J2451187\",",
          "47:       \"January 8, 99 BC\",",
          "48:       NULL };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:       \"........................Xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"",
          "53:       \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",",
          "55:       \".........................aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"",
          "56:       \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "52:       \"1:59 PDT\",",
          "53:       \"13:24:40 -8:00\",",
          "54:       \"13:24:40.495+3\",",
          "55:       NULL };",
          "57: char *intervals[] = { \"1 minute\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "64:       \"13:24:40.123456789+3\",",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "77:  date date1 ;",
          "80:  timestamp ts1 , ts2 ;",
          "83:  char * text ;",
          "86:  interval * i1 ;",
          "89:  date * dc ;",
          "94:  int i, j;",
          "",
          "[Removed Lines]",
          "76: #line 52 \"dt_test2.pgc\"",
          "79: #line 53 \"dt_test2.pgc\"",
          "82: #line 54 \"dt_test2.pgc\"",
          "85: #line 55 \"dt_test2.pgc\"",
          "88: #line 56 \"dt_test2.pgc\"",
          "91: #line 57 \"dt_test2.pgc\"",
          "",
          "[Added Lines]",
          "86: #line 62 \"dt_test2.pgc\"",
          "89: #line 63 \"dt_test2.pgc\"",
          "92: #line 64 \"dt_test2.pgc\"",
          "95: #line 65 \"dt_test2.pgc\"",
          "98: #line 66 \"dt_test2.pgc\"",
          "101: #line 67 \"dt_test2.pgc\"",
          "",
          "---------------"
        ],
        "src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout||src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout": [
          "File: src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout -> src/interfaces/ecpg/test/expected/pgtypeslib-dt_test2.stdout",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: TS[3,1]: 1999-01-08 01:59:00",
          "9: TS[3,2]: 1999-01-08 13:24:40",
          "10: TS[3,3]: 1999-01-08 13:24:40.495",
          "11: Date[4]: 1999-01-08 (N - F)",
          "12: TS[4,0]: 1999-01-08 00:04:00",
          "13: TS[4,1]: 1999-01-08 01:59:00",
          "14: TS[4,2]: 1999-01-08 13:24:40",
          "15: TS[4,3]: 1999-01-08 13:24:40.495",
          "16: Date[5]: 1999-01-08 (N - F)",
          "17: TS[5,0]: 1999-01-08 00:04:00",
          "18: TS[5,1]: 1999-01-08 01:59:00",
          "19: TS[5,2]: 1999-01-08 13:24:40",
          "20: TS[5,3]: 1999-01-08 13:24:40.495",
          "21: Date[6]: 1999-01-18 (N - F)",
          "22: TS[6,0]: 1999-01-18 00:04:00",
          "23: TS[6,1]: 1999-01-18 01:59:00",
          "24: TS[6,2]: 1999-01-18 13:24:40",
          "25: TS[6,3]: 1999-01-18 13:24:40.495",
          "26: Date[7]: 2003-01-02 (N - F)",
          "27: TS[7,0]: 2003-01-02 00:04:00",
          "28: TS[7,1]: 2003-01-02 01:59:00",
          "29: TS[7,2]: 2003-01-02 13:24:40",
          "30: TS[7,3]: 2003-01-02 13:24:40.495",
          "31: Date[8]: 1999-01-08 (N - F)",
          "32: TS[8,0]: 1999-01-08 00:04:00",
          "33: TS[8,1]: 1999-01-08 01:59:00",
          "34: TS[8,2]: 1999-01-08 13:24:40",
          "35: TS[8,3]: 1999-01-08 13:24:40.495",
          "36: Date[9]: 1999-01-08 (N - F)",
          "37: TS[9,0]: 1999-01-08 00:04:00",
          "38: TS[9,1]: 1999-01-08 01:59:00",
          "39: TS[9,2]: 1999-01-08 13:24:40",
          "40: TS[9,3]: 1999-01-08 13:24:40.495",
          "41: Date[10]: 1999-01-08 (N - F)",
          "42: TS[10,0]: 1999-01-08 00:04:00",
          "43: TS[10,1]: 1999-01-08 01:59:00",
          "44: TS[10,2]: 1999-01-08 13:24:40",
          "45: TS[10,3]: 1999-01-08 13:24:40.495",
          "46: Date[11]: 1999-01-08 (N - F)",
          "47: TS[11,0]: 1999-01-08 00:04:00",
          "48: TS[11,1]: 1999-01-08 01:59:00",
          "49: TS[11,2]: 1999-01-08 13:24:40",
          "50: TS[11,3]: 1999-01-08 13:24:40.495",
          "51: Date[12]: 1999-01-08 (N - F)",
          "52: TS[12,0]: 1999-01-08 00:04:00",
          "53: TS[12,1]: 1999-01-08 01:59:00",
          "54: TS[12,2]: 1999-01-08 13:24:40",
          "55: TS[12,3]: 1999-01-08 13:24:40.495",
          "56: Date[13]: 2006-01-08 (N - F)",
          "57: TS[13,0]: 2006-01-08 00:04:00",
          "58: TS[13,1]: 2006-01-08 01:59:00",
          "59: TS[13,2]: 2006-01-08 13:24:40",
          "60: TS[13,3]: 2006-01-08 13:24:40.495",
          "61: Date[14]: 1999-01-08 (N - F)",
          "62: TS[14,0]: 1999-01-08 00:04:00",
          "63: TS[14,1]: 1999-01-08 01:59:00",
          "64: TS[14,2]: 1999-01-08 13:24:40",
          "65: TS[14,3]: 1999-01-08 13:24:40.495",
          "66: Date[15]: 1999-01-08 (N - F)",
          "67: TS[15,0]: 1999-01-08 00:04:00",
          "68: TS[15,1]: 1999-01-08 01:59:00",
          "69: TS[15,2]: 1999-01-08 13:24:40",
          "70: TS[15,3]: 1999-01-08 13:24:40.495",
          "71: Date[16]: 1999-01-08 (N - F)",
          "72: TS[16,0]: 1999-01-08 00:04:00",
          "73: TS[16,1]: 1999-01-08 01:59:00",
          "74: TS[16,2]: 1999-01-08 13:24:40",
          "75: TS[16,3]: 1999-01-08 13:24:40.495",
          "76: Date[17]: 1999-01-08 (N - F)",
          "77: TS[17,0]: 1999-01-08 00:04:00",
          "78: TS[17,1]: 1999-01-08 01:59:00",
          "79: TS[17,2]: 1999-01-08 13:24:40",
          "80: TS[17,3]: 1999-01-08 13:24:40.495",
          "81: Date[18]: 1999-01-08 (N - F)",
          "82: TS[18,0]: 1999-01-08 00:04:00",
          "83: TS[18,1]: 1999-01-08 01:59:00",
          "84: TS[18,2]: 1999-01-08 13:24:40",
          "85: TS[18,3]: 1999-01-08 13:24:40.495",
          "86: Date[19]: 0099-01-08 BC (N - F)",
          "87: TS[19,0]: 0099-01-08 00:04:00 BC",
          "88: TS[19,1]: 0099-01-08 01:59:00 BC",
          "89: TS[19,2]: 0099-01-08 13:24:40 BC",
          "90: interval[0]: @ 1 min",
          "91: interval_copy[0]: @ 1 min",
          "92: interval[1]: @ 1 day 12 hours 59 mins 10 secs",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: TS[3,4]: 1999-01-08 13:24:40.123456",
          "17: TS[4,4]: 1999-01-08 13:24:40.123456",
          "23: TS[5,4]: 1999-01-08 13:24:40.123456",
          "29: TS[6,4]: 1999-01-18 13:24:40.123456",
          "35: TS[7,4]: 2003-01-02 13:24:40.123456",
          "41: TS[8,4]: 1999-01-08 13:24:40.123456",
          "47: TS[9,4]: 1999-01-08 13:24:40.123456",
          "53: TS[10,4]: 1999-01-08 13:24:40.123456",
          "59: TS[11,4]: 1999-01-08 13:24:40.123456",
          "65: TS[12,4]: 1999-01-08 13:24:40.123456",
          "71: TS[13,4]: 2006-01-08 13:24:40.123456",
          "77: TS[14,4]: 1999-01-08 13:24:40.123456",
          "83: TS[15,4]: 1999-01-08 13:24:40.123456",
          "89: TS[16,4]: 1999-01-08 13:24:40.123456",
          "95: TS[17,4]: 1999-01-08 13:24:40.123456",
          "101: TS[18,4]: 1999-01-08 13:24:40.123456",
          "106: TS[19,4]: 0099-01-08 13:24:40.123456 BC",
          "107: Date[20]: - (N - T)",
          "108: Date[21]: - (N - T)",
          "",
          "---------------"
        ],
        "src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc||src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc": [
          "File: src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc -> src/interfaces/ecpg/test/pgtypeslib/dt_test2.pgc",
          "--- Hunk 1 ---",
          "[Context before]",
          "27:       \"1999.008\",",
          "28:       \"J2451187\",",
          "29:       \"January 8, 99 BC\",",
          "30:       NULL };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "34:       \"........................Xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"",
          "35:       \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",",
          "37:       \".........................aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"",
          "38:       \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "34:       \"1:59 PDT\",",
          "35:       \"13:24:40 -8:00\",",
          "36:       \"13:24:40.495+3\",",
          "37:       NULL };",
          "39: char *intervals[] = { \"1 minute\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "46:       \"13:24:40.123456789+3\",",
          "",
          "---------------"
        ],
        "src/test/regress/sql/interval.sql||src/test/regress/sql/interval.sql": [
          "File: src/test/regress/sql/interval.sql -> src/test/regress/sql/interval.sql",
          "--- Hunk 1 ---",
          "[Context before]",
          "108: -- test long interval input",
          "109: select '4 millenniums 5 centuries 4 decades 1 year 4 months 4 days 17 minutes 31 seconds'::interval;",
          "112: -- test justify_hours() and justify_days()",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "111: -- test long interval output",
          "112: select '100000000y 10mon -1000000000d -1000000000h -10min -10.000001s ago'::interval;",
          "",
          "---------------"
        ]
      }
    }
  ]
}