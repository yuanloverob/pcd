{
  "cve_id": "CVE-2016-9389",
  "cve_desc": "The jpc_irct and jpc_iict functions in jpc_mct.c in JasPer before 1.900.14 allow remote attackers to cause a denial of service (assertion failure).",
  "repo": "mdadams/jasper",
  "patch_hash": "dee11ec440d7908d1daf69f40a3324b27cf213ba",
  "patch_info": {
    "commit_hash": "dee11ec440d7908d1daf69f40a3324b27cf213ba",
    "repo": "mdadams/jasper",
    "commit_url": "https://github.com/mdadams/jasper/commit/dee11ec440d7908d1daf69f40a3324b27cf213ba",
    "files": [
      "src/libjasper/base/jas_image.c",
      "src/libjasper/include/jasper/jas_image.h",
      "src/libjasper/jpc/jpc_dec.c"
    ],
    "message": "The component domains must be the same for the ICT/RCT in the JPC codec. This was previously enforced with an assertion. Now, it is handled in a more graceful manner.",
    "before_after_code_files": [
      "src/libjasper/base/jas_image.c||src/libjasper/base/jas_image.c",
      "src/libjasper/include/jasper/jas_image.h||src/libjasper/include/jasper/jas_image.h",
      "src/libjasper/jpc/jpc_dec.c||src/libjasper/jpc/jpc_dec.c"
    ]
  },
  "patch_diff": {
    "src/libjasper/base/jas_image.c||src/libjasper/base/jas_image.c": [
      "File: src/libjasper/base/jas_image.c -> src/libjasper/base/jas_image.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "77: #include <assert.h>",
      "78: #include <ctype.h>",
      "79: #include <inttypes.h>",
      "81: #include \"jasper/jas_math.h\"",
      "82: #include \"jasper/jas_image.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "80: #include <stdbool.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "658: uint_fast32_t jas_image_rawsize(jas_image_t *image)",
      "659: {",
      "660:  uint_fast32_t rawsize;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "659: bool jas_image_cmpt_domains_same(jas_image_t *image)",
      "660: {",
      "661:  int cmptno;",
      "662:  jas_image_cmpt_t *cmpt;",
      "663:  jas_image_cmpt_t *cmpt0;",
      "665:  cmpt0 = image->cmpts_[0];",
      "666:  for (cmptno = 1; cmptno < image->numcmpts_; ++cmptno) {",
      "667:   cmpt = image->cmpts_[cmptno];",
      "668:   if (cmpt->tlx_ != cmpt0->tlx_ || cmpt->tly_ != cmpt0->tly_ ||",
      "669:     cmpt->hstep_ != cmpt0->hstep_ || cmpt->vstep_ != cmpt0->vstep_ ||",
      "670:     cmpt->width_ != cmpt0->width_ || cmpt->height_ != cmpt0->height_) {",
      "671:    return 0;",
      "672:   }",
      "673:  }",
      "674:  return 1;",
      "675: }",
      "",
      "---------------"
    ],
    "src/libjasper/include/jasper/jas_image.h||src/libjasper/include/jasper/jas_image.h": [
      "File: src/libjasper/include/jasper/jas_image.h -> src/libjasper/include/jasper/jas_image.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "79: #include <jasper/jas_seq.h>",
      "80: #include <jasper/jas_cm.h>",
      "81: #include <stdio.h>",
      "83: #ifdef __cplusplus",
      "84: extern \"C\" {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "82: #include <stdbool.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "399:  ((image)->cmpts_[cmptno]->tly_ + (image)->cmpts_[cmptno]->height_ * \\",
      "400:    (image)->cmpts_[cmptno]->vstep_)",
      "404: uint_fast32_t jas_image_rawsize(jas_image_t *image);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "404: bool jas_image_cmpt_domains_same(jas_image_t *image);",
      "",
      "---------------"
    ],
    "src/libjasper/jpc/jpc_dec.c||src/libjasper/jpc/jpc_dec.c": [
      "File: src/libjasper/jpc/jpc_dec.c -> src/libjasper/jpc/jpc_dec.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1091:    jas_eprintf(\"RCT requires at least three components\\n\");",
      "1092:    return -1;",
      "1093:   }",
      "1094:   jpc_irct(tile->tcomps[0].data, tile->tcomps[1].data,",
      "1095:     tile->tcomps[2].data);",
      "1096:   break;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1094:   if (!jas_image_cmpt_domains_same(dec->image)) {",
      "1095:    jas_eprintf(\"RCT requires all components have the same domain\\n\");",
      "1096:    return -1;",
      "1097:   }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1099:    jas_eprintf(\"ICT requires at least three components\\n\");",
      "1100:    return -1;",
      "1101:   }",
      "1102:   jpc_iict(tile->tcomps[0].data, tile->tcomps[1].data,",
      "1103:     tile->tcomps[2].data);",
      "1104:   break;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1106:   if (!jas_image_cmpt_domains_same(dec->image)) {",
      "1107:    jas_eprintf(\"RCT requires all components have the same domain\\n\");",
      "1108:    return -1;",
      "1109:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7e452109a3e7eb52685d48c0b293a551c1535ea6",
      "candidate_info": {
        "commit_hash": "7e452109a3e7eb52685d48c0b293a551c1535ea6",
        "repo": "mdadams/jasper",
        "commit_url": "https://github.com/mdadams/jasper/commit/7e452109a3e7eb52685d48c0b293a551c1535ea6",
        "files": [
          "CMakeLists.txt",
          "build/my_build",
          "src/libjasper/CMakeLists.txt",
          "src/libjasper/include/jasper/jas_config.h.in",
          "src/libjasper/include/jasper/jas_debug.h",
          "src/libjasper/include/jasper/jas_dll.h",
          "src/libjasper/include/jasper/jas_getopt.h",
          "src/libjasper/include/jasper/jas_image.h",
          "src/libjasper/include/jasper/jas_init.h",
          "src/libjasper/include/jasper/jas_malloc.h",
          "src/libjasper/include/jasper/jas_seq.h",
          "src/libjasper/include/jasper/jas_stream.h",
          "src/libjasper/include/jasper/jas_string.h",
          "src/libjasper/include/jasper/jas_tmr.h",
          "src/libjasper/include/jasper/jas_tvp.h",
          "src/libjasper/include/jasper/jas_version.h"
        ],
        "message": "Some preliminary changes for moving towards DLL support for Windows.",
        "before_after_code_files": [
          "src/libjasper/include/jasper/jas_config.h.in||src/libjasper/include/jasper/jas_config.h.in",
          "src/libjasper/include/jasper/jas_debug.h||src/libjasper/include/jasper/jas_debug.h",
          "src/libjasper/include/jasper/jas_dll.h||src/libjasper/include/jasper/jas_dll.h",
          "src/libjasper/include/jasper/jas_getopt.h||src/libjasper/include/jasper/jas_getopt.h",
          "src/libjasper/include/jasper/jas_image.h||src/libjasper/include/jasper/jas_image.h",
          "src/libjasper/include/jasper/jas_init.h||src/libjasper/include/jasper/jas_init.h",
          "src/libjasper/include/jasper/jas_malloc.h||src/libjasper/include/jasper/jas_malloc.h",
          "src/libjasper/include/jasper/jas_seq.h||src/libjasper/include/jasper/jas_seq.h",
          "src/libjasper/include/jasper/jas_stream.h||src/libjasper/include/jasper/jas_stream.h",
          "src/libjasper/include/jasper/jas_string.h||src/libjasper/include/jasper/jas_string.h",
          "src/libjasper/include/jasper/jas_tmr.h||src/libjasper/include/jasper/jas_tmr.h",
          "src/libjasper/include/jasper/jas_tvp.h||src/libjasper/include/jasper/jas_tvp.h",
          "src/libjasper/include/jasper/jas_version.h||src/libjasper/include/jasper/jas_version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/libjasper/include/jasper/jas_image.h||src/libjasper/include/jasper/jas_image.h"
          ],
          "candidate": [
            "src/libjasper/include/jasper/jas_image.h||src/libjasper/include/jasper/jas_image.h"
          ]
        }
      },
      "candidate_diff": {
        "src/libjasper/include/jasper/jas_config.h.in||src/libjasper/include/jasper/jas_config.h.in": [
          "File: src/libjasper/include/jasper/jas_config.h.in -> src/libjasper/include/jasper/jas_config.h.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #ifndef JAS_CONFIG_H",
          "2: #define JAS_CONFIG_H",
          "4: #define JAS_CONFIGURE",
          "6: #if defined(_MSC_VER)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4: #cmakedefine JAS_DLL 1",
          "6: #include <jasper/jas_dll.h>",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_debug.h||src/libjasper/include/jasper/jas_debug.h": [
          "File: src/libjasper/include/jasper/jas_debug.h -> src/libjasper/include/jasper/jas_debug.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "98: #endif",
          "107: int jas_eprintf(const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "101: int jas_getdbglevel(void);",
          "104: int jas_setdbglevel(int dbglevel);",
          "",
          "[Added Lines]",
          "101: JAS_DLLEXPORT int jas_getdbglevel(void);",
          "104: JAS_DLLEXPORT int jas_setdbglevel(int dbglevel);",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_dll.h||src/libjasper/include/jasper/jas_dll.h": [
          "File: src/libjasper/include/jasper/jas_dll.h -> src/libjasper/include/jasper/jas_dll.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: #ifndef JAS_DLL_H",
          "2: #define JAS_DLL_H",
          "4: #if defined(JAS_DLL)",
          "5:  #if defined(_WIN32)",
          "6:   #if defined(JAS_BUILDING_DLL)",
          "7:    #define JAS_DLLEXPORT __declspec(dllexport)",
          "8:   #else",
          "9:    #define JAS_DLLEXPORT __declspec(dllimport)",
          "10:   #endif",
          "11:   #define JAS_DLLLOCAL",
          "12:  #elif defined(JAS_HAVE_VISIBILITY)",
          "13:   #if defined(JAS_BUILDING_DLL)",
          "14:    #define JAS_DLLEXPORT __attribute__ ((visibility(\"default\")))",
          "15:    #define JAS_DLLLOCAL __attribute__ ((visibility(\"hidden\")))",
          "16:   #else",
          "17:    #define JAS_DLLEXPORT",
          "18:    #define JAS_DLLLOCAL",
          "19:   #endif",
          "20:  #else",
          "21:   #define JAS_DLLEXPORT",
          "22:   #define JAS_DLLLOCAL",
          "23:  #endif",
          "24: #else",
          "25:  #define JAS_DLLEXPORT",
          "26:  #define JAS_DLLLOCAL",
          "27: #endif",
          "29: #endif",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_getopt.h||src/libjasper/include/jasper/jas_getopt.h": [
          "File: src/libjasper/include/jasper/jas_getopt.h -> src/libjasper/include/jasper/jas_getopt.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "128: #ifdef __cplusplus",
          "129: }",
          "",
          "[Removed Lines]",
          "126: int jas_getopt(int argc, char **argv, jas_opt_t *opts);",
          "",
          "[Added Lines]",
          "126: JAS_DLLEXPORT int jas_getopt(int argc, char **argv, jas_opt_t *opts);",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_image.h||src/libjasper/include/jasper/jas_image.h": [
          "File: src/libjasper/include/jasper/jas_image.h -> src/libjasper/include/jasper/jas_image.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "311:   jas_image_cmptparm_t *cmptparms, jas_clrspc_t clrspc);",
          "314: jas_image_t *jas_image_create0(void);",
          "323: #define jas_image_width(image) \\",
          "",
          "[Removed Lines]",
          "310: jas_image_t *jas_image_create(int numcmpts,",
          "317: jas_image_t *jas_image_copy(jas_image_t *image);",
          "320: void jas_image_destroy(jas_image_t *image);",
          "",
          "[Added Lines]",
          "310: JAS_DLLEXPORT jas_image_t *jas_image_create(int numcmpts,",
          "317: JAS_DLLEXPORT jas_image_t *jas_image_copy(jas_image_t *image);",
          "320: JAS_DLLEXPORT void jas_image_destroy(jas_image_t *image);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "409:    (image)->cmpts_[cmptno]->vstep_)",
          "423:   const char *optstr);",
          "429:   jas_image_coord_t y, jas_image_coord_t width, jas_image_coord_t height,",
          "430:   jas_matrix_t *data);",
          "",
          "[Removed Lines]",
          "412: bool jas_image_cmpt_domains_same(jas_image_t *image);",
          "416: uint_fast32_t jas_image_rawsize(jas_image_t *image);",
          "419: jas_image_t *jas_image_decode(jas_stream_t *in, int fmt, const char *optstr);",
          "422: int jas_image_encode(jas_image_t *image, jas_stream_t *out, int fmt,",
          "428: int jas_image_readcmpt(jas_image_t *image, int cmptno, jas_image_coord_t x,",
          "",
          "[Added Lines]",
          "412: JAS_DLLEXPORT bool jas_image_cmpt_domains_same(jas_image_t *image);",
          "416: JAS_DLLEXPORT uint_fast32_t jas_image_rawsize(jas_image_t *image);",
          "419: JAS_DLLEXPORT jas_image_t *jas_image_decode(jas_stream_t *in, int fmt, const char *optstr);",
          "422: JAS_DLLEXPORT int jas_image_encode(jas_image_t *image, jas_stream_t *out, int fmt,",
          "428: JAS_DLLEXPORT int jas_image_readcmpt(jas_image_t *image, int cmptno, jas_image_coord_t x,",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "435:   jas_matrix_t *data);",
          "442:   jas_image_cmptparm_t *cmptparm);",
          "446:   jas_image_t *srcimage, int srccmptno);",
          "448: #define JAS_IMAGE_CDT_GETSGND(dtype) (((dtype) >> 7) & 1)",
          "",
          "[Removed Lines]",
          "438: void jas_image_delcmpt(jas_image_t *image, int cmptno);",
          "441: int jas_image_addcmpt(jas_image_t *image, int cmptno,",
          "445: int jas_image_copycmpt(jas_image_t *dstimage, int dstcmptno,",
          "",
          "[Added Lines]",
          "438: JAS_DLLEXPORT void jas_image_delcmpt(jas_image_t *image, int cmptno);",
          "441: JAS_DLLEXPORT int jas_image_addcmpt(jas_image_t *image, int cmptno,",
          "445: JAS_DLLEXPORT int jas_image_copycmpt(jas_image_t *dstimage, int dstcmptno,",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "453: #define jas_image_cmptdtype(image, cmptno) \\",
          "454:  (JAS_IMAGE_CDT_SETSGND((image)->cmpts_[cmptno]->sgnd_) | JAS_IMAGE_CDT_SETPREC((image)->cmpts_[cmptno]->prec_))",
          "457:   int_fast32_t *lutents, int dtype, int newcmptno);",
          "461:   int_fast32_t v);",
          "474:   jas_image_fmtops_t *ops);",
          "495: #define jas_image_cmprof(image) ((image)->cmprof_)",
          "",
          "[Removed Lines]",
          "456: int jas_image_depalettize(jas_image_t *image, int cmptno, int numlutents,",
          "459: int jas_image_readcmptsample(jas_image_t *image, int cmptno, int x, int y);",
          "460: void jas_image_writecmptsample(jas_image_t *image, int cmptno, int x, int y,",
          "463: int jas_image_getcmptbytype(jas_image_t *image, int ctype);",
          "470: void jas_image_clearfmts(void);",
          "473: int jas_image_addfmt(int id, char *name, char *ext, char *desc,",
          "477: int jas_image_strtofmt(char *s);",
          "480: char *jas_image_fmttostr(int fmt);",
          "483: jas_image_fmtinfo_t *jas_image_lookupfmtbyid(int id);",
          "486: jas_image_fmtinfo_t *jas_image_lookupfmtbyname(const char *name);",
          "489: int jas_image_fmtfromname(char *filename);",
          "492: int jas_image_getfmt(jas_stream_t *in);",
          "",
          "[Added Lines]",
          "456: JAS_DLLEXPORT int jas_image_depalettize(jas_image_t *image, int cmptno, int numlutents,",
          "459: JAS_DLLEXPORT int jas_image_readcmptsample(jas_image_t *image, int cmptno, int x, int y);",
          "460: JAS_DLLEXPORT void jas_image_writecmptsample(jas_image_t *image, int cmptno, int x, int y,",
          "463: JAS_DLLEXPORT int jas_image_getcmptbytype(jas_image_t *image, int ctype);",
          "470: JAS_DLLEXPORT void jas_image_clearfmts(void);",
          "473: JAS_DLLEXPORT int jas_image_addfmt(int id, char *name, char *ext, char *desc,",
          "477: JAS_DLLEXPORT int jas_image_strtofmt(char *s);",
          "480: JAS_DLLEXPORT char *jas_image_fmttostr(int fmt);",
          "483: JAS_DLLEXPORT jas_image_fmtinfo_t *jas_image_lookupfmtbyid(int id);",
          "486: JAS_DLLEXPORT jas_image_fmtinfo_t *jas_image_lookupfmtbyname(const char *name);",
          "489: JAS_DLLEXPORT int jas_image_fmtfromname(char *filename);",
          "492: JAS_DLLEXPORT int jas_image_getfmt(jas_stream_t *in);",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_init.h||src/libjasper/include/jasper/jas_init.h": [
          "File: src/libjasper/include/jasper/jas_init.h -> src/libjasper/include/jasper/jas_init.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "76: int jas_init(void);",
          "80: #ifdef __cplusplus",
          "81: }",
          "",
          "[Removed Lines]",
          "78: void jas_cleanup(void);",
          "",
          "[Added Lines]",
          "79: JAS_DLLEXPORT void jas_cleanup(void);",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_malloc.h||src/libjasper/include/jasper/jas_malloc.h": [
          "File: src/libjasper/include/jasper/jas_malloc.h -> src/libjasper/include/jasper/jas_malloc.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "112: #if defined(JAS_DEFAULT_MAX_MEM_USAGE)",
          "118: #endif",
          "",
          "[Removed Lines]",
          "114: void jas_set_max_mem_usage(size_t max_mem);",
          "116: size_t jas_get_mem_usage();",
          "",
          "[Added Lines]",
          "114: JAS_DLLEXPORT void jas_set_max_mem_usage(size_t max_mem);",
          "116: JAS_DLLEXPORT size_t jas_get_mem_usage();",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_seq.h||src/libjasper/include/jasper/jas_seq.h": [
          "File: src/libjasper/include/jasper/jas_seq.h -> src/libjasper/include/jasper/jas_seq.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "192:  (max((matrix)->numrows_, (matrix)->numcols_))",
          "207:   jas_matind_t c0, jas_matind_t r1, jas_matind_t c1);",
          "",
          "[Removed Lines]",
          "195: jas_matrix_t *jas_matrix_create(jas_matind_t numrows, jas_matind_t numcols);",
          "198: void jas_matrix_destroy(jas_matrix_t *matrix);",
          "201: int jas_matrix_resize(jas_matrix_t *matrix, jas_matind_t numrows, jas_matind_t numcols);",
          "203: int jas_matrix_output(jas_matrix_t *matrix, FILE *out);",
          "206: void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, jas_matind_t r0,",
          "",
          "[Added Lines]",
          "195: JAS_DLLEXPORT jas_matrix_t *jas_matrix_create(jas_matind_t numrows, jas_matind_t numcols);",
          "198: JAS_DLLEXPORT void jas_matrix_destroy(jas_matrix_t *matrix);",
          "201: JAS_DLLEXPORT int jas_matrix_resize(jas_matrix_t *matrix, jas_matind_t numrows, jas_matind_t numcols);",
          "203: JAS_DLLEXPORT int jas_matrix_output(jas_matrix_t *matrix, FILE *out);",
          "206: JAS_DLLEXPORT void jas_matrix_bindsub(jas_matrix_t *mat0, jas_matrix_t *mat1, jas_matind_t r0,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "215:   (jas_matrix_bindsub((mat0), (mat1), 0, (c), (mat1)->numrows_ - 1, (c)))",
          "219:   jas_seqent_t maxval);",
          "234: #define jas_matrix_rowstep(matrix) \\",
          "",
          "[Removed Lines]",
          "218: void jas_matrix_clip(jas_matrix_t *matrix, jas_seqent_t minval,",
          "222: void jas_matrix_asl(jas_matrix_t *matrix, int n);",
          "225: void jas_matrix_asr(jas_matrix_t *matrix, int n);",
          "228: void jas_matrix_divpow2(jas_matrix_t *matrix, int n);",
          "231: void jas_matrix_setall(jas_matrix_t *matrix, jas_seqent_t val);",
          "",
          "[Added Lines]",
          "218: JAS_DLLEXPORT void jas_matrix_clip(jas_matrix_t *matrix, jas_seqent_t minval,",
          "222: JAS_DLLEXPORT void jas_matrix_asl(jas_matrix_t *matrix, int n);",
          "225: JAS_DLLEXPORT void jas_matrix_asr(jas_matrix_t *matrix, int n);",
          "228: JAS_DLLEXPORT void jas_matrix_divpow2(jas_matrix_t *matrix, int n);",
          "231: JAS_DLLEXPORT void jas_matrix_setall(jas_matrix_t *matrix, jas_seqent_t val);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "239:  (((matrix)->numrows_ > 1) ? (jas_matrix_rowstep(matrix)) : (1))",
          "248: #define jas_seqent_asl jas_fast32_asl",
          "249: #define jas_seqent_asr jas_fast32_asr",
          "",
          "[Removed Lines]",
          "242: int jas_matrix_cmp(jas_matrix_t *mat0, jas_matrix_t *mat1);",
          "244: jas_matrix_t *jas_matrix_copy(jas_matrix_t *x);",
          "246: jas_matrix_t *jas_matrix_input(FILE *);",
          "",
          "[Added Lines]",
          "242: JAS_DLLEXPORT int jas_matrix_cmp(jas_matrix_t *mat0, jas_matrix_t *mat1);",
          "244: JAS_DLLEXPORT jas_matrix_t *jas_matrix_copy(jas_matrix_t *x);",
          "246: JAS_DLLEXPORT jas_matrix_t *jas_matrix_input(FILE *);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "258:   jas_matind_t xend, jas_matind_t yend);",
          "260: #define jas_seq2d_destroy(s) \\",
          "",
          "[Removed Lines]",
          "255: jas_seq2d_t *jas_seq2d_copy(jas_seq2d_t *x);",
          "257: jas_matrix_t *jas_seq2d_create(jas_matind_t xstart, jas_matind_t ystart,",
          "",
          "[Added Lines]",
          "255: JAS_DLLEXPORT jas_seq2d_t *jas_seq2d_copy(jas_seq2d_t *x);",
          "257: JAS_DLLEXPORT jas_matrix_t *jas_seq2d_create(jas_matind_t xstart, jas_matind_t ystart,",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "285: #define jas_seq2d_size(s) \\",
          "286:  (jas_seq2d_width(s) * jas_seq2d_height(s))",
          "289:   jas_matind_t ystart, jas_matind_t xend, jas_matind_t yend);",
          "",
          "[Removed Lines]",
          "288: void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, jas_matind_t xstart,",
          "",
          "[Added Lines]",
          "288: JAS_DLLEXPORT void jas_seq2d_bindsub(jas_matrix_t *s, jas_matrix_t *s1, jas_matind_t xstart,",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_stream.h||src/libjasper/include/jasper/jas_stream.h": [
          "File: src/libjasper/include/jasper/jas_stream.h -> src/libjasper/include/jasper/jas_stream.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "292: jas_stream_t *jas_stream_fopen(const char *filename, const char *mode);",
          "295: jas_stream_t *jas_stream_memopen(char *buf, int bufsize);",
          "299: jas_stream_t *jas_stream_memopen2(char *buf, size_t bufsize);",
          "302: jas_stream_t *jas_stream_fdopen(int fd, const char *mode);",
          "305: jas_stream_t *jas_stream_freopen(const char *path, const char *mode, FILE *fp);",
          "308: jas_stream_t *jas_stream_tmpfile(void);",
          "311: int jas_stream_close(jas_stream_t *stream);",
          "",
          "[Added Lines]",
          "292: JAS_DLLEXPORT jas_stream_t *jas_stream_fopen(const char *filename, const char *mode);",
          "295: JAS_DLLEXPORT jas_stream_t *jas_stream_memopen(char *buf, int bufsize);",
          "299: JAS_DLLEXPORT jas_stream_t *jas_stream_memopen2(char *buf, size_t bufsize);",
          "302: JAS_DLLEXPORT jas_stream_t *jas_stream_fdopen(int fd, const char *mode);",
          "305: JAS_DLLEXPORT jas_stream_t *jas_stream_freopen(const char *path, const char *mode, FILE *fp);",
          "308: JAS_DLLEXPORT jas_stream_t *jas_stream_tmpfile(void);",
          "311: JAS_DLLEXPORT int jas_stream_close(jas_stream_t *stream);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "331:  (((const jas_stream_t *)(stream))->rwlimit_)",
          "337: #define jas_stream_getrwcount(stream) \\",
          "338:  (((const jas_stream_t *)(stream))->rwcnt_)",
          "",
          "[Removed Lines]",
          "334: int jas_stream_setrwlimit(jas_stream_t *stream, long rwlimit);",
          "341: long jas_stream_setrwcount(jas_stream_t *stream, long rwcnt);",
          "",
          "[Added Lines]",
          "334: JAS_DLLEXPORT int jas_stream_setrwlimit(jas_stream_t *stream, long rwlimit);",
          "341: JAS_DLLEXPORT long jas_stream_setrwcount(jas_stream_t *stream, long rwcnt);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "359: #endif",
          "",
          "[Removed Lines]",
          "362: int jas_stream_read(jas_stream_t *stream, void *buf, int cnt);",
          "365: int jas_stream_write(jas_stream_t *stream, const void *buf, int cnt);",
          "368: int jas_stream_printf(jas_stream_t *stream, const char *fmt, ...);",
          "371: int jas_stream_puts(jas_stream_t *stream, const char *s);",
          "374: char *jas_stream_gets(jas_stream_t *stream, char *buf, int bufsize);",
          "",
          "[Added Lines]",
          "362: JAS_DLLEXPORT int jas_stream_read(jas_stream_t *stream, void *buf, int cnt);",
          "365: JAS_DLLEXPORT int jas_stream_write(jas_stream_t *stream, const void *buf, int cnt);",
          "368: JAS_DLLEXPORT int jas_stream_printf(jas_stream_t *stream, const char *fmt, ...);",
          "371: JAS_DLLEXPORT int jas_stream_puts(jas_stream_t *stream, const char *s);",
          "374: JAS_DLLEXPORT char *jas_stream_gets(jas_stream_t *stream, char *buf, int bufsize);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "380:    ((int)(*(stream)->ptr_)))",
          "",
          "[Removed Lines]",
          "383: int jas_stream_ungetc(jas_stream_t *stream, int c);",
          "390: int jas_stream_isseekable(jas_stream_t *stream);",
          "393: long jas_stream_seek(jas_stream_t *stream, long offset, int origin);",
          "396: long jas_stream_tell(jas_stream_t *stream);",
          "399: int jas_stream_rewind(jas_stream_t *stream);",
          "406: int jas_stream_flush(jas_stream_t *stream);",
          "413: int jas_stream_copy(jas_stream_t *dst, jas_stream_t *src, int n);",
          "416: int jas_stream_display(jas_stream_t *stream, FILE *fp, int n);",
          "419: int jas_stream_gobble(jas_stream_t *stream, int n);",
          "422: int jas_stream_pad(jas_stream_t *stream, int n, int c);",
          "426: long jas_stream_length(jas_stream_t *stream);",
          "",
          "[Added Lines]",
          "383: JAS_DLLEXPORT int jas_stream_ungetc(jas_stream_t *stream, int c);",
          "390: JAS_DLLEXPORT int jas_stream_isseekable(jas_stream_t *stream);",
          "393: JAS_DLLEXPORT long jas_stream_seek(jas_stream_t *stream, long offset, int origin);",
          "396: JAS_DLLEXPORT long jas_stream_tell(jas_stream_t *stream);",
          "399: JAS_DLLEXPORT int jas_stream_rewind(jas_stream_t *stream);",
          "406: JAS_DLLEXPORT int jas_stream_flush(jas_stream_t *stream);",
          "413: JAS_DLLEXPORT int jas_stream_copy(jas_stream_t *dst, jas_stream_t *src, int n);",
          "416: JAS_DLLEXPORT int jas_stream_display(jas_stream_t *stream, FILE *fp, int n);",
          "419: JAS_DLLEXPORT int jas_stream_gobble(jas_stream_t *stream, int n);",
          "422: JAS_DLLEXPORT int jas_stream_pad(jas_stream_t *stream, int n, int c);",
          "426: JAS_DLLEXPORT long jas_stream_length(jas_stream_t *stream);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "465: #ifdef __cplusplus",
          "466: }",
          "",
          "[Removed Lines]",
          "460: int jas_stream_fillbuf(jas_stream_t *stream, int getflag);",
          "461: int jas_stream_flushbuf(jas_stream_t *stream, int c);",
          "462: int jas_stream_getc_func(jas_stream_t *stream);",
          "463: int jas_stream_putc_func(jas_stream_t *stream, int c);",
          "",
          "[Added Lines]",
          "460: JAS_DLLEXPORT int jas_stream_fillbuf(jas_stream_t *stream, int getflag);",
          "461: JAS_DLLEXPORT int jas_stream_flushbuf(jas_stream_t *stream, int c);",
          "462: JAS_DLLEXPORT int jas_stream_getc_func(jas_stream_t *stream);",
          "463: JAS_DLLEXPORT int jas_stream_putc_func(jas_stream_t *stream, int c);",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_string.h||src/libjasper/include/jasper/jas_string.h": [
          "File: src/libjasper/include/jasper/jas_string.h -> src/libjasper/include/jasper/jas_string.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "93: #ifdef __cplusplus",
          "94: }",
          "",
          "[Removed Lines]",
          "91: char *jas_strdup(const char *);",
          "",
          "[Added Lines]",
          "91: JAS_DLLEXPORT char *jas_strdup(const char *);",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_tmr.h||src/libjasper/include/jasper/jas_tmr.h": [
          "File: src/libjasper/include/jasper/jas_tmr.h -> src/libjasper/include/jasper/jas_tmr.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "95: #endif",
          "101: #ifdef __cplusplus",
          "102: }",
          "",
          "[Removed Lines]",
          "97: void jas_tmr_start(jas_tmr_t *tmr);",
          "98: void jas_tmr_stop(jas_tmr_t *tmr);",
          "99: double jas_tmr_get(jas_tmr_t *tmr);",
          "",
          "[Added Lines]",
          "97: JAS_DLLEXPORT void jas_tmr_start(jas_tmr_t *tmr);",
          "98: JAS_DLLEXPORT void jas_tmr_stop(jas_tmr_t *tmr);",
          "99: JAS_DLLEXPORT double jas_tmr_get(jas_tmr_t *tmr);",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_tvp.h||src/libjasper/include/jasper/jas_tvp.h": [
          "File: src/libjasper/include/jasper/jas_tvp.h -> src/libjasper/include/jasper/jas_tvp.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "124:   exists (i.e., the pointer is nonnull); otherwise, a pointer to a dummy",
          "125:   object is returned.  This is useful in some situations to avoid checking",
          "148: #ifdef __cplusplus",
          "149: }",
          "",
          "[Removed Lines]",
          "121: jas_taginfo_t *jas_taginfos_lookup(jas_taginfo_t *taginfos, const char *name);",
          "127: jas_taginfo_t *jas_taginfo_nonull(jas_taginfo_t *taginfo);",
          "134: jas_tvparser_t *jas_tvparser_create(const char *s);",
          "137: void jas_tvparser_destroy(jas_tvparser_t *tvparser);",
          "140: int jas_tvparser_next(jas_tvparser_t *tvparser);",
          "143: char *jas_tvparser_gettag(jas_tvparser_t *tvparser);",
          "146: char *jas_tvparser_getval(jas_tvparser_t *tvparser);",
          "",
          "[Added Lines]",
          "121: JAS_DLLEXPORT jas_taginfo_t *jas_taginfos_lookup(jas_taginfo_t *taginfos, const char *name);",
          "127: JAS_DLLEXPORT jas_taginfo_t *jas_taginfo_nonull(jas_taginfo_t *taginfo);",
          "134: JAS_DLLEXPORT jas_tvparser_t *jas_tvparser_create(const char *s);",
          "137: JAS_DLLEXPORT void jas_tvparser_destroy(jas_tvparser_t *tvparser);",
          "140: JAS_DLLEXPORT int jas_tvparser_next(jas_tvparser_t *tvparser);",
          "143: JAS_DLLEXPORT char *jas_tvparser_gettag(jas_tvparser_t *tvparser);",
          "146: JAS_DLLEXPORT char *jas_tvparser_getval(jas_tvparser_t *tvparser);",
          "",
          "---------------"
        ],
        "src/libjasper/include/jasper/jas_version.h||src/libjasper/include/jasper/jas_version.h": [
          "File: src/libjasper/include/jasper/jas_version.h -> src/libjasper/include/jasper/jas_version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "112: const char *jas_getversion(void);",
          "",
          "[Added Lines]",
          "112: JAS_DLLEXPORT const char *jas_getversion(void);",
          "",
          "---------------"
        ]
      }
    }
  ]
}