{
  "cve_id": "CVE-2012-0037",
  "cve_desc": "Redland Raptor (aka libraptor) before 2.0.7, as used by OpenOffice 3.3 and 3.4 Beta, LibreOffice before 3.4.6 and 3.5.x before 3.5.1, and other products, allows user-assisted remote attackers to read arbitrary files via a crafted XML external entity (XXE) declaration and reference in an RDF document.",
  "repo": "dajobe/raptor",
  "patch_hash": "a676f235309a59d4aa78eeffd2574ae5d341fcb0",
  "patch_info": {
    "commit_hash": "a676f235309a59d4aa78eeffd2574ae5d341fcb0",
    "repo": "dajobe/raptor",
    "commit_url": "https://github.com/dajobe/raptor/commit/a676f235309a59d4aa78eeffd2574ae5d341fcb0",
    "files": [
      "ChangeLog",
      "NEWS.html",
      "RELEASE.html",
      "docs/raptor-1-to-2-map.tsv",
      "librdfa/rdfa.c",
      "src/raptor2.h.in",
      "src/raptor_libxml.c",
      "src/raptor_option.c",
      "src/raptor_rdfxml.c",
      "src/raptor_rss.c",
      "src/raptor_turtle_writer.c"
    ],
    "message": "CVE-2012-0037\n\nEnforce entity loading policy in raptor_libxml_resolveEntity\nand raptor_libxml_getEntity by checking for file URIs and network URIs.\n\nAdd RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES / loadExternalEntities for\nturning on loading of XML external entity loading, disabled by default.\n\nThis affects all the parsers that use SAX2: rdfxml, rss-tag-soup (and\naliases) and rdfa.",
    "before_after_code_files": [
      "NEWS.html||NEWS.html",
      "RELEASE.html||RELEASE.html",
      "librdfa/rdfa.c||librdfa/rdfa.c",
      "src/raptor2.h.in||src/raptor2.h.in",
      "src/raptor_libxml.c||src/raptor_libxml.c",
      "src/raptor_option.c||src/raptor_option.c",
      "src/raptor_rdfxml.c||src/raptor_rdfxml.c",
      "src/raptor_rss.c||src/raptor_rss.c",
      "src/raptor_turtle_writer.c||src/raptor_turtle_writer.c"
    ]
  },
  "patch_diff": {
    "NEWS.html||NEWS.html": [
      "File: NEWS.html -> NEWS.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "9: <h1 style=\"text-align:center\">Raptor RDF Syntax Library - News</h1>",
      "17: Removed Expat support<br />",
      "18: Removed internal Unicode NFC code for better and optional <a href=\"http://www.icu-project.org/\">ICU</a><br />",
      "20: Fixed reported <a href=\"http://bugs.librdf.org/\">issues</a>:",
      "21: <a href=\"http://bugs.librdf.org/mantis/view.php?id=448\">0000448</a> and",
      "22: <a href=\"http://bugs.librdf.org/mantis/view.php?id=469\">0000469</a>",
      "23: </p>",
      "26: <h2 id=\"D2011-11-27-V2.0.6\">2011-11-27 Raptor2 Version 2.0.6 Released</h2>",
      "",
      "[Removed Lines]",
      "11: <h2 id=\"D2012-XX-XX-V2.0.7\">2012-XX-XX Raptor2 Version 2.0.7 Released</h2>",
      "13: <p>Not yet released.",
      "14: </p>",
      "16: <p>",
      "19: Added new options for denying file requests and SSL certificate verifying<br />",
      "",
      "[Added Lines]",
      "11: <h2 id=\"D2012-03-22-V2.0.7\">2012-03-22 Raptor2 Version 2.0.7 Released</h2>",
      "13: <p>CVE-2012-0037 fixed<br />",
      "16: Added options for denying file requests and XML entity loading<br />",
      "17: Added options for SSL certificate verifying<br />",
      "23: <p>See the <a href=\"RELEASE.html#rel2_0_7\">Raptor2 2.0.7 Release Notes</a>",
      "24: for the full details of the changes.</p>",
      "",
      "---------------"
    ],
    "RELEASE.html||RELEASE.html": [
      "File: RELEASE.html -> RELEASE.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "12: <h2 id=\"rel2_0_7\"><a name=\"rel2_0_7\">Raptor2 2.0.7 changes</a></h2>",
      "17: <p>Issues Fixed:</p>",
      "18: <ul>",
      "",
      "[Removed Lines]",
      "14: <p>Not yet released.",
      "15: </p>",
      "",
      "[Added Lines]",
      "14: <p>CVE-2012-0037 fixed</p>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "39:   <dt><code>RAPTOR_OPTION_NO_FILE</code><br/></dt>",
      "40:   <dd>Deny file requests during parsing.</dd>",
      "42:   <dt><code>RAPTOR_OPTION_WWW_SSL_VERIFY_PEER</code><br/></dt>",
      "43:   <dd>Controls verifying an SSL peer during parsing / WWW.  Takes an",
      "44:   integer value: non-0 to verify peer SSL certificate (default",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "41:   <dt><code>RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES</code><br/></dt>",
      "42:   <dd>Deny loading of XML external entity loading. Disabled by",
      "43:   default.</dd>",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "54: <h3>Parser class changes</h3>",
      "56: <p>RDF/JSON parser handles an API change between YAJL V1 and V2.",
      "57: </p>",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "59: <p>The RDF/XML, RSS Tag Soup and RDFa parsers now pass on network,",
      "60: file and entity loading parser options to the internal SAX2 to enable",
      "61: enforcing of network, file and entity loading policy.</p>",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "65: <h3>SAX2 class changes</h3>",
      "70: </p>",
      "73: <h3>URI class changes</h3>",
      "",
      "[Removed Lines]",
      "67: <p>",
      "68: Added <code>raptor_sax2_set_uri_filter()</code> to set a URI filter",
      "69: for any SAX2 calls that do internal lookups of URIs.",
      "",
      "[Added Lines]",
      "74: <p>Added <code>raptor_sax2_set_uri_filter()</code> to set a URI",
      "75: filter for any SAX2 calls that do internal lookups of URIs.",
      "78: <p>Control file and network loading inside SAX2.  Option",
      "79: <code>RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES</code> now enforces",
      "80: loading external XML entities and is by default enabled.  If enabled,",
      "81: <code>RAPTOR_OPTION_NO_FILE</code> and",
      "82: <code>RAPTOR_OPTION_NO_NET</code> are also checked.  All URIs loaded",
      "83: are also passed through any URI filter, if set by",
      "84: <code>raptor_sax2_set_uri_filter()</code>.",
      "85: </p>",
      "",
      "---------------"
    ],
    "librdfa/rdfa.c||librdfa/rdfa.c": [
      "File: librdfa/rdfa.c -> librdfa/rdfa.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1230:      raptor_sax2_set_option(context->sax2,",
      "1231:                             RAPTOR_OPTION_NO_FILE, NULL,",
      "1232:                             RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_NO_FILE));",
      "1233:      if(rdf_parser->uri_filter)",
      "1234:        raptor_sax2_set_uri_filter(context->sax2, rdf_parser->uri_filter,",
      "1235:                                   rdf_parser->uri_filter_user_data);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1233:      raptor_sax2_set_option(context->sax2,",
      "1234:                             RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES, NULL,",
      "1235:                             RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES));",
      "",
      "---------------"
    ],
    "src/raptor2.h.in||src/raptor2.h.in": [
      "File: src/raptor2.h.in -> src/raptor2.h.in",
      "--- Hunk 1 ---",
      "[Context before]",
      "574:   RAPTOR_OPTION_NO_FILE,",
      "575:   RAPTOR_OPTION_WWW_SSL_VERIFY_PEER,",
      "576:   RAPTOR_OPTION_WWW_SSL_VERIFY_HOST,",
      "578: } raptor_option;",
      "",
      "[Removed Lines]",
      "577:   RAPTOR_OPTION_LAST = RAPTOR_OPTION_WWW_SSL_VERIFY_HOST",
      "",
      "[Added Lines]",
      "578:   RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES,",
      "579:   RAPTOR_OPTION_LAST = RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES",
      "",
      "---------------"
    ],
    "src/raptor_libxml.c||src/raptor_libxml.c": [
      "File: src/raptor_libxml.c -> src/raptor_libxml.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "146: static xmlParserInputPtr",
      "147: raptor_libxml_resolveEntity(void* user_data,",
      "149:   raptor_sax2* sax2 = (raptor_sax2*)user_data;",
      "151: }",
      "154: static xmlEntityPtr",
      "156:   raptor_sax2* sax2 = (raptor_sax2*)user_data;",
      "158: }",
      "",
      "[Removed Lines]",
      "148:                             const xmlChar *publicId, const xmlChar *systemId) {",
      "150:   return libxml2_resolveEntity(sax2->xc, publicId, systemId);",
      "155: raptor_libxml_getEntity(void* user_data, const xmlChar *name) {",
      "157:   return libxml2_getEntity(sax2->xc, name);",
      "",
      "[Added Lines]",
      "148:                             const xmlChar *publicId, const xmlChar *systemId)",
      "149: {",
      "151:   xmlParserCtxtPtr ctxt = sax2->xc;",
      "152:   const unsigned char *uri_string = NULL;",
      "153:   xmlParserInputPtr entity_input;",
      "154:   int load_entity = 0;",
      "156:   if(ctxt->input)",
      "157:     uri_string = RAPTOR_GOOD_CAST(const unsigned char *, ctxt->input->filename);",
      "159:   if(!uri_string)",
      "160:     uri_string = RAPTOR_GOOD_CAST(const unsigned char *, ctxt->directory);",
      "162:   load_entity = RAPTOR_OPTIONS_GET_NUMERIC(sax2, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES);",
      "163:   if(load_entity)",
      "164:     load_entity = raptor_sax2_check_load_uri_string(sax2, uri_string);",
      "166:   if(load_entity) {",
      "167:     entity_input = xmlLoadExternalEntity(RAPTOR_GOOD_CAST(const char*, uri_string),",
      "168:                                          RAPTOR_GOOD_CAST(const char*, publicId),",
      "169:                                          ctxt);",
      "170:   } else {",
      "171:     RAPTOR_DEBUG4(\"Not loading entity URI %s by policy for publicId '%s' systemId '%s'\\n\", uri_string, publicId, systemId);",
      "172:   }",
      "174:   return entity_input;",
      "179: raptor_libxml_getEntity(void* user_data, const xmlChar *name)",
      "180: {",
      "182:   xmlParserCtxtPtr xc = sax2->xc;",
      "183:   xmlEntityPtr ret = NULL;",
      "185:   if(!xc)",
      "186:     return NULL;",
      "188:   if(!xc->inSubset) {",
      "190:     ret = xmlGetPredefinedEntity(name);",
      "191:     if(ret) {",
      "192:       RAPTOR_DEBUG2(\"Entity '%s' found in predefined set\\n\", name);",
      "193:       return ret;",
      "194:     }",
      "195:   }",
      "200:   if(xc->myDoc && (xc->myDoc->standalone == 1)) {",
      "201:     RAPTOR_DEBUG2(\"Entity '%s' document is standalone\\n\", name);",
      "203:     if(xc->inSubset == 2) {",
      "204:       xc->myDoc->standalone = 0;",
      "205:       ret = xmlGetDocEntity(xc->myDoc, name);",
      "206:       xc->myDoc->standalone = 1;",
      "207:     } else {",
      "208:       ret = xmlGetDocEntity(xc->myDoc, name);",
      "209:       if(!ret) {",
      "210:         xc->myDoc->standalone = 0;",
      "211:         ret = xmlGetDocEntity(xc->myDoc, name);",
      "212:         xc->myDoc->standalone = 1;",
      "213:       }",
      "214:     }",
      "215:   } else {",
      "216:     ret = xmlGetDocEntity(xc->myDoc, name);",
      "217:   }",
      "219:   if(ret && !ret->children &&",
      "220:     (ret->etype == XML_EXTERNAL_GENERAL_PARSED_ENTITY)) {",
      "224:     int val = 0;",
      "225:     xmlNodePtr children;",
      "226:     int load_entity = 0;",
      "228:     load_entity = RAPTOR_OPTIONS_GET_NUMERIC(sax2, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES);",
      "229:     if(load_entity)",
      "230:       load_entity = raptor_sax2_check_load_uri_string(sax2, ret->URI);",
      "232:     if(!load_entity) {",
      "233:       RAPTOR_DEBUG2(\"Not getting entity URI %s by policy\\n\", ret->URI);",
      "234:       children = xmlNewText((const xmlChar*)\"\");",
      "235:     } else {",
      "239:       sax2->enabled = 0;",
      "240:       val = xmlParseCtxtExternalEntity(xc, ret->URI, ret->ExternalID, &children);",
      "241:       sax2->enabled = 1;",
      "242:     }",
      "244:     if(!val) {",
      "245:       xmlAddChildList((xmlNodePtr)ret, children);",
      "246:     } else {",
      "247:       xc->validate = 0;",
      "248:       return NULL;",
      "249:     }",
      "251:     ret->owner = 1;",
      "254:     if(!ret->checked)",
      "255:       ret->checked = 1;",
      "256:   }",
      "258:   return ret;",
      "",
      "---------------"
    ],
    "src/raptor_option.c||src/raptor_option.c": [
      "File: src/raptor_option.c -> src/raptor_option.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "295:     RAPTOR_OPTION_VALUE_TYPE_INT,",
      "296:     \"wwwSslVerifyHost\",",
      "297:     \"SSL verify host matching\"",
      "298:   }",
      "299: };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "298:   },",
      "299:   { RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES,",
      "300:     (raptor_option_area)(RAPTOR_OPTION_AREA_PARSER | RAPTOR_OPTION_AREA_SAX2),",
      "301:     RAPTOR_OPTION_VALUE_TYPE_BOOL,",
      "302:     \"loadExternalEntities\",",
      "303:     \"Parsers and SAX2 should load external entities.\"",
      "",
      "---------------"
    ],
    "src/raptor_rdfxml.c||src/raptor_rdfxml.c": [
      "File: src/raptor_rdfxml.c -> src/raptor_rdfxml.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1004:   raptor_sax2_set_option(rdf_xml_parser->sax2,",
      "1005:                          RAPTOR_OPTION_NO_FILE, NULL,",
      "1006:                          RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_NO_FILE));",
      "1007:   if(rdf_parser->uri_filter)",
      "1008:     raptor_sax2_set_uri_filter(rdf_xml_parser->sax2, rdf_parser->uri_filter,",
      "1009:                                rdf_parser->uri_filter_user_data);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1007:   raptor_sax2_set_option(rdf_xml_parser->sax2,",
      "1008:                          RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES, NULL,",
      "1009:                          RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES));",
      "",
      "---------------"
    ],
    "src/raptor_rss.c||src/raptor_rss.c": [
      "File: src/raptor_rss.c -> src/raptor_rss.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "252:   raptor_sax2_set_option(rss_parser->sax2,",
      "253:                          RAPTOR_OPTION_NO_FILE, NULL,",
      "254:                          RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_NO_FILE));",
      "255:   if(rdf_parser->uri_filter)",
      "256:     raptor_sax2_set_uri_filter(rss_parser->sax2, rdf_parser->uri_filter,",
      "257:                                rdf_parser->uri_filter_user_data);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "255:   raptor_sax2_set_option(rss_parser->sax2,",
      "256:                          RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES, NULL,",
      "257:                          RAPTOR_OPTIONS_GET_NUMERIC(rdf_parser, RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES));",
      "",
      "---------------"
    ],
    "src/raptor_turtle_writer.c||src/raptor_turtle_writer.c": [
      "File: src/raptor_turtle_writer.c -> src/raptor_turtle_writer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "706:     case RAPTOR_OPTION_NO_NET:",
      "707:     case RAPTOR_OPTION_NO_FILE:",
      "710:     case RAPTOR_OPTION_RELATIVE_URIS:",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "708:     case RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES:",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "830:     case RAPTOR_OPTION_NO_NET:",
      "831:     case RAPTOR_OPTION_NO_FILE:",
      "834:     case RAPTOR_OPTION_RELATIVE_URIS:",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "833:     case RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES:",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "331b048cd08dd4cbd87a83d790b2dc63ab56392b",
      "candidate_info": {
        "commit_hash": "331b048cd08dd4cbd87a83d790b2dc63ab56392b",
        "repo": "dajobe/raptor",
        "commit_url": "https://github.com/dajobe/raptor/commit/331b048cd08dd4cbd87a83d790b2dc63ab56392b",
        "files": [
          "src/raptor_libxml.c"
        ],
        "message": "(raptor_libxml_resolveEntity): Init entity_input [clang]",
        "before_after_code_files": [
          "src/raptor_libxml.c||src/raptor_libxml.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/raptor_libxml.c||src/raptor_libxml.c"
          ],
          "candidate": [
            "src/raptor_libxml.c||src/raptor_libxml.c"
          ]
        }
      },
      "candidate_diff": {
        "src/raptor_libxml.c||src/raptor_libxml.c": [
          "File: src/raptor_libxml.c -> src/raptor_libxml.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "150:   raptor_sax2* sax2 = (raptor_sax2*)user_data;",
          "151:   xmlParserCtxtPtr ctxt = sax2->xc;",
          "152:   const unsigned char *uri_string = NULL;",
          "154:   int load_entity = 0;",
          "156:   if(ctxt->input)",
          "",
          "[Removed Lines]",
          "153:   xmlParserInputPtr entity_input;",
          "",
          "[Added Lines]",
          "153:   xmlParserInputPtr entity_input = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ce893f4133305c4adae3201559aba9ac8cc7566b",
      "candidate_info": {
        "commit_hash": "ce893f4133305c4adae3201559aba9ac8cc7566b",
        "repo": "dajobe/raptor",
        "commit_url": "https://github.com/dajobe/raptor/commit/ce893f4133305c4adae3201559aba9ac8cc7566b",
        "files": [
          "ChangeLog",
          "NEWS.html",
          "RELEASE.html"
        ],
        "message": "2.0.7",
        "before_after_code_files": [
          "NEWS.html||NEWS.html",
          "RELEASE.html||RELEASE.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "NEWS.html||NEWS.html",
            "RELEASE.html||RELEASE.html"
          ],
          "candidate": [
            "NEWS.html||NEWS.html",
            "RELEASE.html||RELEASE.html"
          ]
        }
      },
      "candidate_diff": {
        "NEWS.html||NEWS.html": [
          "File: NEWS.html -> NEWS.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: <p>Not yet released.",
          "14: </p>",
          "16: <h2 id=\"D2011-11-27-V2.0.6\">2011-11-27 Raptor2 Version 2.0.6 Released</h2>",
          "18: <p>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "16: <p>",
          "17: Removed Expat support<br />",
          "18: Removed internal Unicode NFC code for better and optional <a href=\"http://www.icu-project.org/\">ICU</a><br />",
          "19: Added new options for denying file requests and SSL certificate verifying<br />",
          "20: Fixed reported <a href=\"http://bugs.librdf.org/\">issues</a>:",
          "21: <a href=\"http://bugs.librdf.org/mantis/view.php?id=448\">0000448</a> and",
          "22: <a href=\"http://bugs.librdf.org/mantis/view.php?id=469\">0000469</a>",
          "23: </p>",
          "",
          "---------------"
        ],
        "RELEASE.html||RELEASE.html": [
          "File: RELEASE.html -> RELEASE.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: no parser that requires an XML parser, libxml2 will not be required.",
          "27: </p>",
          "30: <h3>Options changes</h3>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29: <p>Removed internal Unicode NFC checking code used for checking",
          "30: RDF/XML literals conformance which was expensive to check and a large",
          "31: of compiled-in static dataset that was rather out of date.  Replaced",
          "32: with optional compiled use of <a href=\"http://www.icu-project.org/\">ICU</a>.",
          "33: If ICU is not explicitly configured, no literal checking is done.</p>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "98: </p>",
          "101: <h2 id=\"rel2_0_6\"><a name=\"rel2_0_6\">Raptor2 2.0.6 changes</a></h2>",
          "103: <p>Fixed expat support which was broken in 2.0.5</p>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "106: <h3>Build changes</h3>",
          "108: <p>Added <code>--with-icu-config=</code><em>PATH</em> option",
          "109: to enable use of ICU for NFC checking.</p>",
          "111: <p>Requires automake 1.11.2+ for <code>-Wextra-portability</code></p>",
          "113: <p><code>configure</code> uses <code>AM_PROG_AR</code> to make",
          "114: automake <code>-Wextra-portability</code> happy.",
          "115: </p>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "eb9b47f0034baa45abb5203b85279ad4984e3025",
      "candidate_info": {
        "commit_hash": "eb9b47f0034baa45abb5203b85279ad4984e3025",
        "repo": "dajobe/raptor",
        "commit_url": "https://github.com/dajobe/raptor/commit/eb9b47f0034baa45abb5203b85279ad4984e3025",
        "files": [
          "NEWS.html",
          "RELEASE.html",
          "configure.ac"
        ],
        "message": "Bumped version to 2.0.7",
        "before_after_code_files": [
          "NEWS.html||NEWS.html",
          "RELEASE.html||RELEASE.html",
          "configure.ac||configure.ac"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "NEWS.html||NEWS.html",
            "RELEASE.html||RELEASE.html"
          ],
          "candidate": [
            "NEWS.html||NEWS.html",
            "RELEASE.html||RELEASE.html"
          ]
        }
      },
      "candidate_diff": {
        "NEWS.html||NEWS.html": [
          "File: NEWS.html -> NEWS.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: <h1 style=\"text-align:center\">Raptor RDF Syntax Library - News</h1>",
          "11: <h2 id=\"D2011-11-27-V2.0.6\">2011-11-27 Raptor2 Version 2.0.6 Released</h2>",
          "13: <p>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11: <h2 id=\"D2011-XX-XX-V2.0.7\">2011-XX-XX Raptor2 Version 2.0.7 Released</h2>",
          "13: <p>Not yet released.",
          "14: </p>",
          "",
          "---------------"
        ],
        "RELEASE.html||RELEASE.html": [
          "File: RELEASE.html -> RELEASE.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: <h1 style=\"text-align:center\">Raptor RDF Syntax Library - Release Notes</h1>",
          "12: <h2 id=\"rel2_0_6\"><a name=\"rel2_0_6\">Raptor2 2.0.6 changes</a></h2>",
          "14: <p>Fixed expat support which was broken in 2.0.5</p>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "12: <h2 id=\"rel2_0_7\"><a name=\"rel2_0_7\">Raptor2 2.0.7 changes</a></h2>",
          "14: <p>Not yet released.",
          "15: </p>",
          "",
          "---------------"
        ],
        "configure.ac||configure.ac": [
          "File: configure.ac -> configure.ac",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: AC_PREREQ(2.62)",
          "28: AC_CONFIG_SRCDIR([src/raptor_general.c])",
          "29: AM_CONFIG_HEADER([src/raptor_config.h])",
          "30: AC_CONFIG_AUX_DIR(build)",
          "",
          "[Removed Lines]",
          "27: AC_INIT(Raptor RDF Parser and Serializer library, 2.0.6, http://bugs.librdf.org/, raptor2)",
          "",
          "[Added Lines]",
          "27: AC_INIT(Raptor RDF Parser and Serializer library, 2.0.7, http://bugs.librdf.org/, raptor2)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "be0639ef59d00ca64dd8493a6f6661fb1d6178f6",
      "candidate_info": {
        "commit_hash": "be0639ef59d00ca64dd8493a6f6661fb1d6178f6",
        "repo": "dajobe/raptor",
        "commit_url": "https://github.com/dajobe/raptor/commit/be0639ef59d00ca64dd8493a6f6661fb1d6178f6",
        "files": [
          "RELEASE.html"
        ],
        "message": "RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES words",
        "before_after_code_files": [
          "RELEASE.html||RELEASE.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "RELEASE.html||RELEASE.html"
          ],
          "candidate": [
            "RELEASE.html||RELEASE.html"
          ]
        }
      },
      "candidate_diff": {
        "RELEASE.html||RELEASE.html": [
          "File: RELEASE.html -> RELEASE.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: <p>Added new options:</p>",
          "43: <dl>",
          "44:   <dt><code>RAPTOR_OPTION_NO_FILE</code><br/></dt>",
          "47:   <dt><code>RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES</code><br/></dt>",
          "49:   default.</dd>",
          "51:   <dt><code>RAPTOR_OPTION_WWW_SSL_VERIFY_PEER</code><br/></dt>",
          "",
          "[Removed Lines]",
          "45:   <dd>Deny file requests during parsing.</dd>",
          "48:   <dd>Deny loading of XML external entity loading. Disabled by",
          "",
          "[Added Lines]",
          "45:   <dd>Deny file requests during parsing.  Enabled by default.</dd>",
          "48:   <dd>Allow loading of XML external entity loading. Disabled by",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "660fe085ac9f5b93338fb2d7b44f35d364207075",
      "candidate_info": {
        "commit_hash": "660fe085ac9f5b93338fb2d7b44f35d364207075",
        "repo": "dajobe/raptor",
        "commit_url": "https://github.com/dajobe/raptor/commit/660fe085ac9f5b93338fb2d7b44f35d364207075",
        "files": [
          "ChangeLog",
          "INSTALL.html",
          "LICENSE.html",
          "NEWS.html",
          "README.html",
          "RELEASE.html",
          "TODO.html",
          "UPGRADING.html"
        ],
        "message": "Changes and docs updates for 2012 including removing some expat references",
        "before_after_code_files": [
          "INSTALL.html||INSTALL.html",
          "LICENSE.html||LICENSE.html",
          "NEWS.html||NEWS.html",
          "README.html||README.html",
          "RELEASE.html||RELEASE.html",
          "TODO.html||TODO.html",
          "UPGRADING.html||UPGRADING.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "NEWS.html||NEWS.html",
            "RELEASE.html||RELEASE.html"
          ],
          "candidate": [
            "NEWS.html||NEWS.html",
            "RELEASE.html||RELEASE.html"
          ]
        }
      },
      "candidate_diff": {
        "INSTALL.html||INSTALL.html": [
          "File: INSTALL.html -> INSTALL.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: and x86 OSX but is also tested on other systems occasionally.",
          "69: </p>",
          "76: <a href=\"http://lloyd.github.com/yajl/\">YAJL</a> to provide JSON",
          "77: parsers if it is available.",
          "78: </p>",
          "",
          "[Removed Lines]",
          "71: <p>Raptor requires an XML parser - either libxml2",
          "72: (2.6.8 or newer) or expat.  It will optionally use libcurl, libxml2",
          "73: for retrieving URIs.  It will optionally use libxslt (requiring",
          "74: libxml2 also) to provide the XSLT functionality for the GRDDL and",
          "75: microformats parser.  It will also optionally use",
          "",
          "[Added Lines]",
          "71: <p>Raptor optionally the libxml2 XML library (2.6.8 or newer) for",
          "72: parsing XML syntaxes.  It will optionally use libcurl, libxml2 or",
          "73: libfetch for retrieving URIs.  It will optionally use libxslt",
          "74: (requiring libxml2 also) to provide the XSLT functionality for the",
          "75: GRDDL and microformats parser.  It will also optionally use",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "144: checks will succeed when this is disabled.",
          "145: </p></dd>",
          "153: <dt><code>--enable-debug</code><br /></dt>",
          "154: <dd><p>Enable debug messages (default not enabled).",
          "155: Maintainer mode automatically enables this.",
          "",
          "[Removed Lines]",
          "147: <dt><tt>--with-expat-source=DIR</tt><br /></dt>",
          "148: <dd><p>Build against a statically compiled expat source tree in",
          "149: directory <em>DIR</em>.  This handles the older and newer style",
          "150: expat source directory structures.",
          "151: </p></dd>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "192: memory was allocated in the same library.",
          "193: </p></dd>",
          "216: <dt><tt>--with-www=NAME</tt><br /></dt>",
          "217: <dd><p>Pick a WWW library to use - either <tt>curl</tt>,",
          "218: <tt>xml</tt> (for libxml), <tt>libwww</tt> for W3C libwww or",
          "",
          "[Removed Lines]",
          "195: <dt><tt>--with-xml-parser=NAME</tt><br /></dt>",
          "196: <dd><p>Pick an XML parser to use - either <tt>libxml</tt> (default)",
          "197: minimum version 2.6.8 or <tt>expat</tt>.  If this option is not given,",
          "198: either will be used, with libxml preferred if both are present.",
          "199: These can either be installed system libraries or source",
          "200: trees in subdirectories of these sources named libxml, expat.",
          "201: </p>",
          "203: <p>Raptor has been tested with various combinations of these libraries",
          "204: including expat 1.95.1, 1.95.2, 1.95.7, 1.95.8 and libxml 2.6.8 onwards.",
          "205: </p>",
          "207: <p>libxml1 is not supported.",
          "208: </p>",
          "210: <p>The libxml2 on Apple OSX 10.3.X is quite broken - the headers do",
          "211: not match the libraries.  Install your own to get something",
          "212: coherent.",
          "213: </p>",
          "214: </dd>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "263: <p>Append to the line any additional options you need like this:",
          "264: </p>",
          "265: <pre>",
          "267: </pre>",
          "",
          "[Removed Lines]",
          "266:    ./configure --prefix=/usr --with-xml-parser=expat",
          "",
          "[Added Lines]",
          "239:    ./configure --prefix=/usr --enable-parsers=rdfxml",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "385: <hr />",
          "389: </body>",
          "390: </html>",
          "",
          "[Removed Lines]",
          "387: <p>Copyright 2000-2011 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright 2000-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "[Added Lines]",
          "360: <p>Copyright 2000-2012 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright 2000-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "---------------"
        ],
        "LICENSE.html||LICENSE.html": [
          "File: LICENSE.html -> LICENSE.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "24:  <blockquote>",
          "25:  <p>",
          "27: Copyright (C) 2000-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a>.",
          "28: All Rights Reserved.",
          "29:  </p>",
          "",
          "[Removed Lines]",
          "26: Copyright (C) 2000-2011 <a href=\"http://www.dajobe.org/\">David Beckett</a><br />",
          "",
          "[Added Lines]",
          "26: Copyright (C) 2000-2012 <a href=\"http://www.dajobe.org/\">David Beckett</a><br />",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "68:    <blockquote>",
          "70:      <p>",
          "72:      Copyright (C) 2000-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a>.",
          "73:      </p>",
          "",
          "[Removed Lines]",
          "71:      Copyright (C) 2000-2011 <a href=\"http://www.dajobe.org/\">David Beckett</a><br />",
          "",
          "[Added Lines]",
          "71:      Copyright (C) 2000-2012 <a href=\"http://www.dajobe.org/\">David Beckett</a><br />",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "94: <hr />",
          "98: </body>",
          "99: </html>",
          "",
          "[Removed Lines]",
          "96: <p>Copyright (C) 2000-2011 <a href=\"http://www.dajobe.org/\">David Beckett</a><br />Copyright (C) 2000-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "[Added Lines]",
          "96: <p>Copyright (C) 2000-2012 <a href=\"http://www.dajobe.org/\">David Beckett</a><br />Copyright (C) 2000-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "---------------"
        ],
        "NEWS.html||NEWS.html": [
          "File: NEWS.html -> NEWS.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: <h1 style=\"text-align:center\">Raptor RDF Syntax Library - News</h1>",
          "13: <p>Not yet released.",
          "14: </p>",
          "",
          "[Removed Lines]",
          "11: <h2 id=\"D2011-XX-XX-V2.0.7\">2011-XX-XX Raptor2 Version 2.0.7 Released</h2>",
          "",
          "[Added Lines]",
          "11: <h2 id=\"D2012-XX-XX-V2.0.7\">2012-XX-XX Raptor2 Version 2.0.7 Released</h2>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "768: <hr />",
          "772: </body>",
          "773: </html>",
          "",
          "[Removed Lines]",
          "770: <p>Copyright (C) 2001-2011 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright (C) 2001-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "[Added Lines]",
          "770: <p>Copyright (C) 2001-2012 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright (C) 2001-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "---------------"
        ],
        "README.html||README.html": [
          "File: README.html -> README.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "70: <li>Fully handles the <a href=\"http://www.w3.org/TR/rdf-syntax-grammar/\">RDF/XML syntax updates</a> for <a href=\"http://www.w3.org/TR/xmlbase/\">XML Base</a>, <code>xml:lang</code>, RDF datatyping and Collections.</li>",
          "71: <li>Handles all RDF vocabularies such as <a href=\"http://www.foaf-project.org/\">FOAF</a>, <a href=\"http://www.purl.org/rss/1.0/\">RSS 1.0</a>, <a href=\"http://dublincore.org/\">Dublin Core</a>, <a href=\"http://www.w3.org/TR/owl-features/\">OWL</a>, <a href=\"http://usefulinc.com/doap\">DOAP</a></li>",
          "72: <li>Handles <code>rdf:resource</code> / <code>resource</code> attributes</li>",
          "74: </ul>",
          "",
          "[Removed Lines]",
          "73: <li>Uses <a href=\"http://expat.sourceforge.net/\">expat</a> and/or (GNOME) <a href=\"http://xmlsoft.org/\">libxml</a> XML parsers as available or required</li>",
          "",
          "[Added Lines]",
          "73: <li>Uses <a href=\"http://xmlsoft.org/\">libxml</a> XML parser</li>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "298: <hr />",
          "302: </body>",
          "303: </html>",
          "",
          "[Removed Lines]",
          "300: <p>Copyright (C) 2000-2011 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright (C) 2000-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "[Added Lines]",
          "300: <p>Copyright (C) 2000-2012 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright (C) 2000-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "---------------"
        ],
        "RELEASE.html||RELEASE.html": [
          "File: RELEASE.html -> RELEASE.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: <p>Not yet released.",
          "15: </p>",
          "18: <h2 id=\"rel2_0_6\"><a name=\"rel2_0_6\">Raptor2 2.0.6 changes</a></h2>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "17: <p>Issues Fixed:</p>",
          "18: <ul>",
          "19:   <li><a href=\"http://bugs.librdf.org/mantis/view.php?id=448\">0000448</a>: Turtle parser does not return error status from turtle_parse_chunk()</li>",
          "20: </ul>",
          "22: <p>Removed Expat support since expat has not had a release in years",
          "23: and libxml2 works well.  This allows some code simplification.",
          "24: Updated <code>configure</code> so that if Raptor is configured with",
          "25: no parser that requires an XML parser, libxml2 will not be required.",
          "26: </p>",
          "29: <h3>Parser class changes</h3>",
          "31: <p>RDF/JSON parser handles an API change between YAJL V1 and V2.",
          "32: </p>",
          "34: <p>Turtle parser now returns parser errors to",
          "35: <code>raptor_parse_chunk()</code>.",
          "36: Fixes <a href=\"http://bugs.librdf.org/mantis/view.php?id=488\">Issue #0000488</a>",
          "37: </p>",
          "40: <h3>SAX2 class changes</h3>",
          "42: <p>",
          "43: Added <code>raptor_sax2_set_uri_filter()</code> to set a URI filter",
          "44: for any SAX2 calls that do internal lookups of URIs.",
          "45: </p>",
          "48: <h3>URI class changes</h3>",
          "50: <p>Added new URI constructor",
          "51: <code>raptor_new_uri_from_uri_or_file_string()</code>",
          "52: to build a URI from a URI string or a filename string, normalizing",
          "53: the result to a <code>file:</code> URI.",
          "54: </p>",
          "56: <p>Added",
          "57: <code>raptor_uri_uri_string_to_counted_filename_fragment()</code> to",
          "58: turn a URI string to a filename and URI fragment along with string",
          "59: output string counts.",
          "60: </p>",
          "62: <p>Added utility methods for checking if a file: URI or filename is a",
          "63: file that exists:",
          "64: <code>raptor_uri_file_exists()</code> and",
          "65: <code>raptor_uri_filename_exists()</code>",
          "66: </p>",
          "69: <h3>WWW class changes</h3>",
          "71: <p>The <code>raptor_www_fetch()</code> call now returns the status",
          "72: from any URI filter that returns a non-0 response.",
          "73: </p>",
          "76: <h3>Other changes</h3>",
          "78: <p>",
          "79: Added option <code>RAPTOR_OPTION_NO_FILE</code> to deny internal file",
          "80: requests.",
          "81: </p>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3922: <hr />",
          "3926: </body>",
          "3927: </html>",
          "",
          "[Removed Lines]",
          "3924: <p>Copyright (C) 2003-2011 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright (C) 2003-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "[Added Lines]",
          "3990: <p>Copyright (C) 2003-2012 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright (C) 2003-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "---------------"
        ],
        "TODO.html||TODO.html": [
          "File: TODO.html -> TODO.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: <hr />",
          "19: </body>",
          "20: </html>",
          "",
          "[Removed Lines]",
          "17: <p>Copyright (C) 2001-2011 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright (C) 2001-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "[Added Lines]",
          "17: <p>Copyright (C) 2001-2012 <a href=\"http://www.dajobe.org/\">Dave Beckett</a><br />Copyright (C) 2001-2005 <a href=\"http://www.bristol.ac.uk/\">University of Bristol</a></p>",
          "",
          "---------------"
        ],
        "UPGRADING.html||UPGRADING.html": [
          "File: UPGRADING.html -> UPGRADING.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "154: <hr />",
          "158: </body>",
          "159: </html>",
          "",
          "[Removed Lines]",
          "156: <p>Copyright 2010-2011 <a href=\"http://www.dajobe.org/\">Dave Beckett</a></p>",
          "",
          "[Added Lines]",
          "156: <p>Copyright 2010-2012 <a href=\"http://www.dajobe.org/\">Dave Beckett</a></p>",
          "",
          "---------------"
        ]
      }
    }
  ]
}