{
  "cve_id": "CVE-2020-8955",
  "cve_desc": "irc_mode_channel_update in plugins/irc/irc-mode.c in WeeChat through 2.7 allows remote attackers to cause a denial of service (buffer overflow and application crash) or possibly have unspecified other impact via a malformed IRC message 324 (channel mode).",
  "repo": "weechat/weechat",
  "patch_hash": "6f4f147d8e86adf9ad34a8ffd7e7f1f23a7e74da",
  "patch_info": {
    "commit_hash": "6f4f147d8e86adf9ad34a8ffd7e7f1f23a7e74da",
    "repo": "weechat/weechat",
    "commit_url": "https://github.com/weechat/weechat/commit/6f4f147d8e86adf9ad34a8ffd7e7f1f23a7e74da",
    "files": [
      "ChangeLog.adoc",
      "src/plugins/irc/irc-mode.c"
    ],
    "message": "irc: fix crash when receiving a malformed message 324 (channel mode)\n\nThanks to Stuart Nevans Locke for reporting the issue.",
    "before_after_code_files": [
      "src/plugins/irc/irc-mode.c||src/plugins/irc/irc-mode.c"
    ]
  },
  "patch_diff": {
    "src/plugins/irc/irc-mode.c||src/plugins/irc/irc-mode.c": [
      "File: src/plugins/irc/irc-mode.c -> src/plugins/irc/irc-mode.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "224:                     current_arg++;",
      "225:                 if (pos[0] == chanmode)",
      "226:                 {",
      "229:                     {",
      "234:                         {",
      "238:                         }",
      "239:                     }",
      "240:                 }",
      "",
      "[Removed Lines]",
      "227:                     chanmode_found = 1;",
      "228:                     if (set_flag == '+')",
      "230:                         str_mode[0] = pos[0];",
      "231:                         str_mode[1] = '\\0';",
      "232:                         strcat (new_modes, str_mode);",
      "233:                         if (argument)",
      "235:                             if (new_args[0])",
      "236:                                 strcat (new_args, \" \");",
      "237:                             strcat (new_args, argument);",
      "",
      "[Added Lines]",
      "227:                     if (!chanmode_found)",
      "229:                         chanmode_found = 1;",
      "230:                         if (set_flag == '+')",
      "232:                             str_mode[0] = pos[0];",
      "233:                             str_mode[1] = '\\0';",
      "234:                             strcat (new_modes, str_mode);",
      "235:                             if (argument)",
      "236:                             {",
      "237:                                 if (new_args[0])",
      "238:                                     strcat (new_args, \" \");",
      "239:                                 strcat (new_args, argument);",
      "240:                             }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "51a739df615f8ec66fbe1e9682ec3c3218254ad7",
      "candidate_info": {
        "commit_hash": "51a739df615f8ec66fbe1e9682ec3c3218254ad7",
        "repo": "weechat/weechat",
        "commit_url": "https://github.com/weechat/weechat/commit/51a739df615f8ec66fbe1e9682ec3c3218254ad7",
        "files": [
          "ChangeLog.adoc",
          "src/plugins/irc/irc-mode.c"
        ],
        "message": "irc: fix crash when receiving a malformed message 324 (channel mode) (CVE-2020-8955)\n\nThanks to Stuart Nevans Locke for reporting the issue.",
        "before_after_code_files": [
          "src/plugins/irc/irc-mode.c||src/plugins/irc/irc-mode.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "src/plugins/irc/irc-mode.c||src/plugins/irc/irc-mode.c"
          ],
          "candidate": [
            "src/plugins/irc/irc-mode.c||src/plugins/irc/irc-mode.c"
          ]
        }
      },
      "candidate_diff": {
        "src/plugins/irc/irc-mode.c||src/plugins/irc/irc-mode.c": [
          "File: src/plugins/irc/irc-mode.c -> src/plugins/irc/irc-mode.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "224:                     current_arg++;",
          "225:                 if (pos[0] == chanmode)",
          "226:                 {",
          "229:                     {",
          "234:                         {",
          "238:                         }",
          "239:                     }",
          "240:                 }",
          "",
          "[Removed Lines]",
          "227:                     chanmode_found = 1;",
          "228:                     if (set_flag == '+')",
          "230:                         str_mode[0] = pos[0];",
          "231:                         str_mode[1] = '\\0';",
          "232:                         strcat (new_modes, str_mode);",
          "233:                         if (argument)",
          "235:                             if (new_args[0])",
          "236:                                 strcat (new_args, \" \");",
          "237:                             strcat (new_args, argument);",
          "",
          "[Added Lines]",
          "227:                     if (!chanmode_found)",
          "229:                         chanmode_found = 1;",
          "230:                         if (set_flag == '+')",
          "232:                             str_mode[0] = pos[0];",
          "233:                             str_mode[1] = '\\0';",
          "234:                             strcat (new_modes, str_mode);",
          "235:                             if (argument)",
          "236:                             {",
          "237:                                 if (new_args[0])",
          "238:                                     strcat (new_args, \" \");",
          "239:                                 strcat (new_args, argument);",
          "240:                             }",
          "",
          "---------------"
        ]
      }
    }
  ]
}