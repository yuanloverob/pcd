{
  "cve_id": "CVE-2014-3587",
  "cve_desc": "Integer overflow in the cdf_read_property_info function in cdf.c in file through 5.19, as used in the Fileinfo component in PHP before 5.4.32 and 5.5.x before 5.5.16, allows remote attackers to cause a denial of service (application crash) via a crafted CDF file.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2012-1571.",
  "repo": "php/php-src",
  "patch_hash": "7ba1409a1aee5925180de546057ddd84ff267947",
  "patch_info": {
    "commit_hash": "7ba1409a1aee5925180de546057ddd84ff267947",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/7ba1409a1aee5925180de546057ddd84ff267947",
    "files": [
      "NEWS",
      "ext/fileinfo/libmagic/cdf.c"
    ],
    "message": "Fix bug #67716 - Segfault in cdf.c",
    "before_after_code_files": [
      "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
    ]
  },
  "patch_diff": {
    "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c": [
      "File: ext/fileinfo/libmagic/cdf.c -> ext/fileinfo/libmagic/cdf.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "820:   q = (const uint8_t *)(const void *)",
      "821:       ((const char *)(const void *)p + ofs",
      "822:       - 2 * sizeof(uint32_t));",
      "824:    DPRINTF((\"Ran of the end %p > %p\\n\", q, e));",
      "825:    goto out;",
      "826:   }",
      "",
      "[Removed Lines]",
      "823:   if (q > e) {",
      "",
      "[Added Lines]",
      "823:   if (q < p || q > e) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "35f32637b08ca6397829138ed45a0768f592f262",
      "candidate_info": {
        "commit_hash": "35f32637b08ca6397829138ed45a0768f592f262",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/35f32637b08ca6397829138ed45a0768f592f262",
        "files": [
          "NEWS",
          "ext/fileinfo/libmagic/cdf.c"
        ],
        "message": "Fix bug #67716 - Segfault in cdf.c",
        "before_after_code_files": [
          "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
          ],
          "candidate": [
            "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c": [
          "File: ext/fileinfo/libmagic/cdf.c -> ext/fileinfo/libmagic/cdf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "820:   q = (const uint8_t *)(const void *)",
          "821:       ((const char *)(const void *)p + ofs",
          "822:       - 2 * sizeof(uint32_t));",
          "824:    DPRINTF((\"Ran of the end %p > %p\\n\", q, e));",
          "825:    goto out;",
          "826:   }",
          "",
          "[Removed Lines]",
          "823:   if (q > e) {",
          "",
          "[Added Lines]",
          "823:   if (q < p || q > e) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "49387b31cf8bda25a85b6932380001be03d6c8b0",
      "candidate_info": {
        "commit_hash": "49387b31cf8bda25a85b6932380001be03d6c8b0",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/49387b31cf8bda25a85b6932380001be03d6c8b0",
        "files": [
          "NEWS",
          "ext/fileinfo/libmagic/cdf.c"
        ],
        "message": "Fix bug #67716 - Segfault in cdf.c",
        "before_after_code_files": [
          "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
          ],
          "candidate": [
            "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c": [
          "File: ext/fileinfo/libmagic/cdf.c -> ext/fileinfo/libmagic/cdf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "820:   q = (const uint8_t *)(const void *)",
          "821:       ((const char *)(const void *)p + ofs",
          "822:       - 2 * sizeof(uint32_t));",
          "824:    DPRINTF((\"Ran of the end %p > %p\\n\", q, e));",
          "825:    goto out;",
          "826:   }",
          "",
          "[Removed Lines]",
          "823:   if (q > e) {",
          "",
          "[Added Lines]",
          "823:   if (q < p || q > e) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "cba5120407fbd0735b9aac5ede2fd02bdfab46a9",
      "candidate_info": {
        "commit_hash": "cba5120407fbd0735b9aac5ede2fd02bdfab46a9",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/cba5120407fbd0735b9aac5ede2fd02bdfab46a9",
        "files": [
          "ext/fileinfo/libmagic/cdf.c"
        ],
        "message": "Fix bug #67716 - Segfault in cdf.c",
        "before_after_code_files": [
          "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
          ],
          "candidate": [
            "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c": [
          "File: ext/fileinfo/libmagic/cdf.c -> ext/fileinfo/libmagic/cdf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "820:   q = (const uint8_t *)(const void *)",
          "821:       ((const char *)(const void *)p + ofs",
          "822:       - 2 * sizeof(uint32_t));",
          "824:    DPRINTF((\"Ran of the end %p > %p\\n\", q, e));",
          "825:    goto out;",
          "826:   }",
          "",
          "[Removed Lines]",
          "823:   if (q > e) {",
          "",
          "[Added Lines]",
          "823:   if (q < p || q > e) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "77b09bfc351d3908b0368beac8787123acacf46c",
      "candidate_info": {
        "commit_hash": "77b09bfc351d3908b0368beac8787123acacf46c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/77b09bfc351d3908b0368beac8787123acacf46c",
        "files": [
          "ext/fileinfo/libmagic/cdf.c"
        ],
        "message": "Fix bug #67716 - Segfault in cdf.c",
        "before_after_code_files": [
          "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
          ],
          "candidate": [
            "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/fileinfo/libmagic/cdf.c||ext/fileinfo/libmagic/cdf.c": [
          "File: ext/fileinfo/libmagic/cdf.c -> ext/fileinfo/libmagic/cdf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "823:   q = (const uint8_t *)(const void *)",
          "824:       ((const char *)(const void *)p + ofs",
          "825:       - 2 * sizeof(uint32_t));",
          "827:    DPRINTF((\"Ran of the end %p > %p\\n\", q, e));",
          "828:    goto out;",
          "829:   }",
          "",
          "[Removed Lines]",
          "826:   if (q > e) {",
          "",
          "[Added Lines]",
          "826:   if (q < p || q > e) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}