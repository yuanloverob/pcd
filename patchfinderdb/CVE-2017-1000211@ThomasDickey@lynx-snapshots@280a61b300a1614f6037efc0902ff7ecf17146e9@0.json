{
  "cve_id": "CVE-2017-1000211",
  "cve_desc": "Lynx before 2.8.9dev.16 is vulnerable to a use after free in the HTML parser resulting in memory disclosure, because HTML_put_string() can append a chunk onto itself.",
  "repo": "ThomasDickey/lynx-snapshots",
  "patch_hash": "280a61b300a1614f6037efc0902ff7ecf17146e9",
  "patch_info": {
    "commit_hash": "280a61b300a1614f6037efc0902ff7ecf17146e9",
    "repo": "ThomasDickey/lynx-snapshots",
    "commit_url": "https://github.com/ThomasDickey/lynx-snapshots/commit/280a61b300a1614f6037efc0902ff7ecf17146e9",
    "files": [
      "CHANGES",
      "PACKAGE/debian/lynx-dev.lintian-overrides",
      "src/HTML.c"
    ],
    "message": "snapshot of project \"lynx\", label v2-8-9dev_15b",
    "before_after_code_files": [
      "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides",
      "src/HTML.c||src/HTML.c"
    ]
  },
  "patch_diff": {
    "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides": [
      "File: PACKAGE/debian/lynx-dev.lintian-overrides -> PACKAGE/debian/lynx-dev.lintian-overrides",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: # Lynx's version-numbering is not understood by lintian, though legal.",
      "4: # This is intentional because it is referenced from the documentation.",
      "5: lynx-dev: extra-license-file usr/share/doc/lynx-dev/COPYING",
      "",
      "[Removed Lines]",
      "2: lynx-dev: rc-version-greater-than-expected-version 2.8.9dev.15 > 2.8.9 (consider using 2.8.9~dev.15)",
      "",
      "[Added Lines]",
      "2: lynx-dev: rc-version-greater-than-expected-version",
      "",
      "---------------"
    ],
    "src/HTML.c||src/HTML.c": [
      "File: src/HTML.c -> src/HTML.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "506: void HTML_put_string(HTStructured * me, const char *s)",
      "507: {",
      "508: #ifdef USE_PRETTYSRC",
      "509:     char *translated_string = NULL;",
      "510: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "508:     HTChunk *target = NULL;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "527:     case HTML_TITLE:",
      "529:  break;",
      "531:     case HTML_STYLE:",
      "533:  break;",
      "535:     case HTML_SCRIPT:",
      "537:  break;",
      "",
      "[Removed Lines]",
      "528:  HTChunkPuts(&me->title, s);",
      "532:  HTChunkPuts(&me->style_block, s);",
      "536:  HTChunkPuts(&me->script, s);",
      "",
      "[Added Lines]",
      "530:  target = &me->title;",
      "534:  target = &me->style_block;",
      "538:  target = &me->script;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "547:  break;",
      "549:     case HTML_OBJECT:",
      "551:  break;",
      "553:     case HTML_TEXTAREA:",
      "555:  break;",
      "557:     case HTML_SELECT:",
      "558:     case HTML_OPTION:",
      "560:  break;",
      "562:     case HTML_MATH:",
      "564:  break;",
      "",
      "[Removed Lines]",
      "550:  HTChunkPuts(&me->object, s);",
      "554:  HTChunkPuts(&me->textarea, s);",
      "559:  HTChunkPuts(&me->option, s);",
      "563:  HTChunkPuts(&me->math, s);",
      "",
      "[Added Lines]",
      "552:  target = &me->object;",
      "556:  target = &me->textarea;",
      "561:  target = &me->option;",
      "565:  target = &me->math;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "652:  }",
      "654: #ifdef USE_PRETTYSRC",
      "655:     if (psrc_convert_string) {",
      "656:  psrc_convert_string = FALSE;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "657:     if (target != NULL) {",
      "658:  if (target->data == s) {",
      "659:      CTRACE((tfp, \"BUG: appending chunk to itself: `%.*s'\\n\",",
      "660:       target->size, target->data));",
      "661:  } else {",
      "662:      HTChunkPuts(target, s);",
      "663:  }",
      "664:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "280a61b300a1614f6037efc0902ff7ecf17146e9",
      "candidate_info": {
        "commit_hash": "280a61b300a1614f6037efc0902ff7ecf17146e9",
        "repo": "ThomasDickey/lynx-snapshots",
        "commit_url": "https://github.com/ThomasDickey/lynx-snapshots/commit/280a61b300a1614f6037efc0902ff7ecf17146e9",
        "files": [
          "CHANGES",
          "PACKAGE/debian/lynx-dev.lintian-overrides",
          "src/HTML.c"
        ],
        "message": "snapshot of project \"lynx\", label v2-8-9dev_15b",
        "before_after_code_files": [
          "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides",
          "src/HTML.c||src/HTML.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides",
            "src/HTML.c||src/HTML.c"
          ],
          "candidate": [
            "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides",
            "src/HTML.c||src/HTML.c"
          ]
        }
      },
      "candidate_diff": {
        "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides": [
          "File: PACKAGE/debian/lynx-dev.lintian-overrides -> PACKAGE/debian/lynx-dev.lintian-overrides",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # Lynx's version-numbering is not understood by lintian, though legal.",
          "4: # This is intentional because it is referenced from the documentation.",
          "5: lynx-dev: extra-license-file usr/share/doc/lynx-dev/COPYING",
          "",
          "[Removed Lines]",
          "2: lynx-dev: rc-version-greater-than-expected-version 2.8.9dev.15 > 2.8.9 (consider using 2.8.9~dev.15)",
          "",
          "[Added Lines]",
          "2: lynx-dev: rc-version-greater-than-expected-version",
          "",
          "---------------"
        ],
        "src/HTML.c||src/HTML.c": [
          "File: src/HTML.c -> src/HTML.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "506: void HTML_put_string(HTStructured * me, const char *s)",
          "507: {",
          "508: #ifdef USE_PRETTYSRC",
          "509:     char *translated_string = NULL;",
          "510: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "508:     HTChunk *target = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "527:     case HTML_TITLE:",
          "529:  break;",
          "531:     case HTML_STYLE:",
          "533:  break;",
          "535:     case HTML_SCRIPT:",
          "537:  break;",
          "",
          "[Removed Lines]",
          "528:  HTChunkPuts(&me->title, s);",
          "532:  HTChunkPuts(&me->style_block, s);",
          "536:  HTChunkPuts(&me->script, s);",
          "",
          "[Added Lines]",
          "530:  target = &me->title;",
          "534:  target = &me->style_block;",
          "538:  target = &me->script;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "547:  break;",
          "549:     case HTML_OBJECT:",
          "551:  break;",
          "553:     case HTML_TEXTAREA:",
          "555:  break;",
          "557:     case HTML_SELECT:",
          "558:     case HTML_OPTION:",
          "560:  break;",
          "562:     case HTML_MATH:",
          "564:  break;",
          "",
          "[Removed Lines]",
          "550:  HTChunkPuts(&me->object, s);",
          "554:  HTChunkPuts(&me->textarea, s);",
          "559:  HTChunkPuts(&me->option, s);",
          "563:  HTChunkPuts(&me->math, s);",
          "",
          "[Added Lines]",
          "552:  target = &me->object;",
          "556:  target = &me->textarea;",
          "561:  target = &me->option;",
          "565:  target = &me->math;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "652:  }",
          "654: #ifdef USE_PRETTYSRC",
          "655:     if (psrc_convert_string) {",
          "656:  psrc_convert_string = FALSE;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "657:     if (target != NULL) {",
          "658:  if (target->data == s) {",
          "659:      CTRACE((tfp, \"BUG: appending chunk to itself: `%.*s'\\n\",",
          "660:       target->size, target->data));",
          "661:  } else {",
          "662:      HTChunkPuts(target, s);",
          "663:  }",
          "664:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4b84022da163df7eff5a1518b088be14be926d4c",
      "candidate_info": {
        "commit_hash": "4b84022da163df7eff5a1518b088be14be926d4c",
        "repo": "ThomasDickey/lynx-snapshots",
        "commit_url": "https://github.com/ThomasDickey/lynx-snapshots/commit/4b84022da163df7eff5a1518b088be14be926d4c",
        "files": [
          "CHANGES",
          "PACKAGE/debian/lynx-dev.lintian-overrides",
          "src/HTML.c"
        ],
        "message": "snapshot of project \"lynx\", label v2-8-9dev_15b",
        "before_after_code_files": [
          "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides",
          "src/HTML.c||src/HTML.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides",
            "src/HTML.c||src/HTML.c"
          ],
          "candidate": [
            "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides",
            "src/HTML.c||src/HTML.c"
          ]
        }
      },
      "candidate_diff": {
        "PACKAGE/debian/lynx-dev.lintian-overrides||PACKAGE/debian/lynx-dev.lintian-overrides": [
          "File: PACKAGE/debian/lynx-dev.lintian-overrides -> PACKAGE/debian/lynx-dev.lintian-overrides",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # Lynx's version-numbering is not understood by lintian, though legal.",
          "4: # This is intentional because it is referenced from the documentation.",
          "5: lynx-dev: extra-license-file usr/share/doc/lynx-dev/COPYING",
          "",
          "[Removed Lines]",
          "2: lynx-dev: rc-version-greater-than-expected-version 2.8.9dev.15 > 2.8.9 (consider using 2.8.9~dev.15)",
          "",
          "[Added Lines]",
          "2: lynx-dev: rc-version-greater-than-expected-version",
          "",
          "---------------"
        ],
        "src/HTML.c||src/HTML.c": [
          "File: src/HTML.c -> src/HTML.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "506: void HTML_put_string(HTStructured * me, const char *s)",
          "507: {",
          "508: #ifdef USE_PRETTYSRC",
          "509:     char *translated_string = NULL;",
          "510: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "508:     HTChunk *target = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "527:     case HTML_TITLE:",
          "529:  break;",
          "531:     case HTML_STYLE:",
          "533:  break;",
          "535:     case HTML_SCRIPT:",
          "537:  break;",
          "",
          "[Removed Lines]",
          "528:  HTChunkPuts(&me->title, s);",
          "532:  HTChunkPuts(&me->style_block, s);",
          "536:  HTChunkPuts(&me->script, s);",
          "",
          "[Added Lines]",
          "530:  target = &me->title;",
          "534:  target = &me->style_block;",
          "538:  target = &me->script;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "547:  break;",
          "549:     case HTML_OBJECT:",
          "551:  break;",
          "553:     case HTML_TEXTAREA:",
          "555:  break;",
          "557:     case HTML_SELECT:",
          "558:     case HTML_OPTION:",
          "560:  break;",
          "562:     case HTML_MATH:",
          "564:  break;",
          "",
          "[Removed Lines]",
          "550:  HTChunkPuts(&me->object, s);",
          "554:  HTChunkPuts(&me->textarea, s);",
          "559:  HTChunkPuts(&me->option, s);",
          "563:  HTChunkPuts(&me->math, s);",
          "",
          "[Added Lines]",
          "552:  target = &me->object;",
          "556:  target = &me->textarea;",
          "561:  target = &me->option;",
          "565:  target = &me->math;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "652:  }",
          "654: #ifdef USE_PRETTYSRC",
          "655:     if (psrc_convert_string) {",
          "656:  psrc_convert_string = FALSE;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "657:     if (target != NULL) {",
          "658:  if (target->data == s) {",
          "659:      CTRACE((tfp, \"BUG: appending chunk to itself: `%.*s'\\n\",",
          "660:       target->size, target->data));",
          "661:  } else {",
          "662:      HTChunkPuts(target, s);",
          "663:  }",
          "664:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}