{
  "cve_id": "CVE-2016-7124",
  "cve_desc": "ext/standard/var_unserializer.c in PHP before 5.6.25 and 7.x before 7.0.10 mishandles certain invalid objects, which allows remote attackers to cause a denial of service or possibly have unspecified other impact via crafted serialized data that leads to a (1) __destruct call or (2) magic method call.",
  "repo": "php/php-src",
  "patch_hash": "448c9be157f4147e121f1a2a524536c75c9c6059",
  "patch_info": {
    "commit_hash": "448c9be157f4147e121f1a2a524536c75c9c6059",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/448c9be157f4147e121f1a2a524536c75c9c6059",
    "files": [
      "ext/standard/tests/strings/bug72663.phpt",
      "ext/standard/tests/strings/bug72663_2.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #72663 - destroy broken object when unserializing",
    "before_after_code_files": [
      "ext/standard/tests/strings/bug72663.phpt||ext/standard/tests/strings/bug72663.phpt",
      "ext/standard/tests/strings/bug72663_2.phpt||ext/standard/tests/strings/bug72663_2.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/strings/bug72663.phpt||ext/standard/tests/strings/bug72663.phpt": [
      "File: ext/standard/tests/strings/bug72663.phpt -> ext/standard/tests/strings/bug72663.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #72663: Create an Unexpected Object and Don't Invoke __wakeup() in Deserialization",
      "3: --FILE--",
      "4: <?php",
      "5: class obj implements Serializable {",
      "6:     var $data;",
      "7:     function serialize() {",
      "8:         return serialize($this->data);",
      "9:     }",
      "10:     function unserialize($data) {",
      "11:         $this->data = unserialize($data);",
      "12:     }",
      "13: }",
      "15: $inner = 'a:1:{i:0;O:9:\"Exception\":2:{s:7:\"'.\"\\0\".'*'.\"\\0\".'file\";R:4;}';",
      "16: $exploit = 'a:2:{i:0;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}i:1;R:4;}';",
      "18: $data = unserialize($exploit);",
      "19: echo $data[1];",
      "20: ?>",
      "21: DONE",
      "22: --EXPECTF--",
      "23: Notice: unserialize(): Unexpected end of serialized data in %sbug72663.php on line %d",
      "25: Notice: unserialize(): Error at offset 46 of 47 bytes in %sbug72663.php on line %d",
      "26: DONE",
      "",
      "---------------"
    ],
    "ext/standard/tests/strings/bug72663_2.phpt||ext/standard/tests/strings/bug72663_2.phpt": [
      "File: ext/standard/tests/strings/bug72663_2.phpt -> ext/standard/tests/strings/bug72663_2.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #72663: Create an Unexpected Object and Don't Invoke __wakeup() in Deserialization",
      "3: --FILE--",
      "4: <?php",
      "6: ini_set('session.serialize_handler', 'php_serialize');",
      "7: session_start();",
      "8: $sess = 'O:9:\"Exception\":2:{s:7:\"'.\"\\0\".'*'.\"\\0\".'file\";R:1;}';",
      "9: session_decode($sess);",
      "10: var_dump($_SESSION);",
      "11: ?>",
      "12: DONE",
      "13: --EXPECTF--",
      "14: Notice: session_decode(): Unexpected end of serialized data in %sbug72663_2.php on line %d",
      "15: array(0) {",
      "16: }",
      "17: DONE",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "434:  }",
      "436:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_OBJPROP_PP(rval), elements, 1)) {",
      "437:   return 0;",
      "438:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "438:      zend_hash_clean(Z_OBJPROP_PP(rval));",
      "439:      ZVAL_NULL(*rval);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "486: {",
      "487:  YYCTYPE yych;",
      "488:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "485: #line 486 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "488: #line 489 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "542:  yych = *(YYMARKER = ++YYCURSOR);",
      "543:  if (yych == ':') goto yy95;",
      "544: yy3:",
      "546:  { return 0; }",
      "548: yy4:",
      "549:  yych = *(YYMARKER = ++YYCURSOR);",
      "550:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "545: #line 851 \"ext/standard/var_unserializer.re\"",
      "547: #line 548 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "548: #line 854 \"ext/standard/var_unserializer.re\"",
      "550: #line 551 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "587:  goto yy3;",
      "588: yy14:",
      "589:  ++YYCURSOR;",
      "591:  {",
      "593:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "595: }",
      "597: yy16:",
      "598:  yych = *++YYCURSOR;",
      "599:  goto yy3;",
      "",
      "[Removed Lines]",
      "590: #line 845 \"ext/standard/var_unserializer.re\"",
      "596: #line 597 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "593: #line 848 \"ext/standard/var_unserializer.re\"",
      "599: #line 600 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "619:  if (yybm[0+yych] & 128) {",
      "620:   goto yy20;",
      "621:  }",
      "623:  yych = *++YYCURSOR;",
      "624:  if (yych != '\"') goto yy18;",
      "625:  ++YYCURSOR;",
      "627:  {",
      "628:  size_t len, len2, len3, maxlen;",
      "629:  long elements;",
      "",
      "[Removed Lines]",
      "622:  if (yych != ':') goto yy18;",
      "626: #line 698 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "625:  if (yych <= '/') goto yy18;",
      "626:  if (yych >= ';') goto yy18;",
      "630: #line 701 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "771:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "772: }",
      "774: yy25:",
      "775:  yych = *++YYCURSOR;",
      "776:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "773: #line 774 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "777: #line 778 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "795:  yych = *++YYCURSOR;",
      "796:  if (yych != '\"') goto yy18;",
      "797:  ++YYCURSOR;",
      "799:  {",
      "800:     if (!var_hash) return 0;",
      "",
      "[Removed Lines]",
      "798: #line 689 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "802: #line 692 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "804:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "805:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "806: }",
      "808: yy32:",
      "809:  yych = *++YYCURSOR;",
      "810:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "807: #line 808 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "811: #line 812 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "825:  yych = *++YYCURSOR;",
      "826:  if (yych != '{') goto yy18;",
      "827:  ++YYCURSOR;",
      "829:  {",
      "830:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "828: #line 668 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "832: #line 671 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "847:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "848: }",
      "850: yy39:",
      "851:  yych = *++YYCURSOR;",
      "852:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "849: #line 850 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "853: #line 854 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "867:  yych = *++YYCURSOR;",
      "868:  if (yych != '\"') goto yy18;",
      "869:  ++YYCURSOR;",
      "871:  {",
      "872:  size_t len, maxlen;",
      "873:  char *str;",
      "",
      "[Removed Lines]",
      "870: #line 633 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "874: #line 636 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "902:  ZVAL_STRINGL(*rval, str, len, 0);",
      "903:  return 1;",
      "904: }",
      "906: yy46:",
      "907:  yych = *++YYCURSOR;",
      "908:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "905: #line 906 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "909: #line 910 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "923:  yych = *++YYCURSOR;",
      "924:  if (yych != '\"') goto yy18;",
      "925:  ++YYCURSOR;",
      "927:  {",
      "928:  size_t len, maxlen;",
      "929:  char *str;",
      "",
      "[Removed Lines]",
      "926: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "930: #line 603 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "956:  ZVAL_STRINGL(*rval, str, len, 1);",
      "957:  return 1;",
      "958: }",
      "960: yy53:",
      "961:  yych = *++YYCURSOR;",
      "962:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "959: #line 960 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "963: #line 964 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1044:  }",
      "1045: yy63:",
      "1046:  ++YYCURSOR;",
      "1048:  {",
      "1049: #if SIZEOF_LONG == 4",
      "1050: use_double:",
      "",
      "[Removed Lines]",
      "1047: #line 590 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1051: #line 593 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1054:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1055:  return 1;",
      "1056: }",
      "1058: yy65:",
      "1059:  yych = *++YYCURSOR;",
      "1060:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1057: #line 1058 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1061: #line 1062 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1113:  yych = *++YYCURSOR;",
      "1114:  if (yych != ';') goto yy18;",
      "1115:  ++YYCURSOR;",
      "1117:  {",
      "1119:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1116: #line 575 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1120: #line 578 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1129:  return 1;",
      "1130: }",
      "1132: yy76:",
      "1133:  yych = *++YYCURSOR;",
      "1134:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1131: #line 1132 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1135: #line 1136 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1155:  if (yych <= '9') goto yy79;",
      "1156:  if (yych != ';') goto yy18;",
      "1157:  ++YYCURSOR;",
      "1159:  {",
      "1160: #if SIZEOF_LONG == 4",
      "1161:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1158: #line 548 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1162: #line 551 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1182:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1183:  return 1;",
      "1184: }",
      "1186: yy83:",
      "1187:  yych = *++YYCURSOR;",
      "1188:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1185: #line 1186 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1189: #line 1190 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1190:  yych = *++YYCURSOR;",
      "1191:  if (yych != ';') goto yy18;",
      "1192:  ++YYCURSOR;",
      "1194:  {",
      "1196:  INIT_PZVAL(*rval);",
      "1197:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1198:  return 1;",
      "1199: }",
      "1201: yy87:",
      "1202:  ++YYCURSOR;",
      "1204:  {",
      "1206:  INIT_PZVAL(*rval);",
      "1207:  ZVAL_NULL(*rval);",
      "1208:  return 1;",
      "1209: }",
      "1211: yy89:",
      "1212:  yych = *++YYCURSOR;",
      "1213:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1193: #line 541 \"ext/standard/var_unserializer.re\"",
      "1200: #line 1201 \"ext/standard/var_unserializer.c\"",
      "1203: #line 534 \"ext/standard/var_unserializer.re\"",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1197: #line 544 \"ext/standard/var_unserializer.re\"",
      "1204: #line 1205 \"ext/standard/var_unserializer.c\"",
      "1207: #line 537 \"ext/standard/var_unserializer.re\"",
      "1214: #line 1215 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1230:  if (yych <= '9') goto yy91;",
      "1231:  if (yych != ';') goto yy18;",
      "1232:  ++YYCURSOR;",
      "1234:  {",
      "1235:  long id;",
      "",
      "[Removed Lines]",
      "1233: #line 511 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1237: #line 514 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1254:  return 1;",
      "1255: }",
      "1257: yy95:",
      "1258:  yych = *++YYCURSOR;",
      "1259:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1256: #line 1257 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1260: #line 1261 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1276:  if (yych <= '9') goto yy97;",
      "1277:  if (yych != ';') goto yy18;",
      "1278:  ++YYCURSOR;",
      "1280:  {",
      "1281:  long id;",
      "",
      "[Removed Lines]",
      "1279: #line 490 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1283: #line 493 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1298:  return 1;",
      "1299: }",
      "1301: }",
      "1305:  return 0;",
      "",
      "[Removed Lines]",
      "1300: #line 1301 \"ext/standard/var_unserializer.c\"",
      "1302: #line 853 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1304: #line 1305 \"ext/standard/var_unserializer.c\"",
      "1306: #line 856 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "438:  }",
      "440:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_OBJPROP_PP(rval), elements, 1)) {",
      "441:   return 0;",
      "442:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "442:      zend_hash_clean(Z_OBJPROP_PP(rval));",
      "443:      ZVAL_NULL(*rval);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "73a69c9c03587dfa1dcfb488e27f5bb42218ed4f",
      "candidate_info": {
        "commit_hash": "73a69c9c03587dfa1dcfb488e27f5bb42218ed4f",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/73a69c9c03587dfa1dcfb488e27f5bb42218ed4f",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed typo",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "470: {",
          "471:  zval retval;",
          "472:  zval fname;",
          "475:  if (Z_TYPE_P(rval) != IS_OBJECT) {",
          "476:   return 0;",
          "477:  }",
          "479:  zend_hash_resize(ht, zend_hash_num_elements(ht) + elements);",
          "480:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "481:   return 0;",
          "",
          "[Removed Lines]",
          "473:  HashTable *ht = Z_OBJPROP_P(rval);",
          "",
          "[Added Lines]",
          "473:  HashTable *ht;",
          "479:  ht = Z_OBJPROP_P(rval);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "529:  start = cursor;",
          "533: {",
          "534:  YYCTYPE yych;",
          "535:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "532: #line 533 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "533: #line 534 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "589:  yych = *(YYMARKER = ++YYCURSOR);",
          "590:  if (yych == ':') goto yy95;",
          "591: yy3:",
          "593:  { return 0; }",
          "595: yy4:",
          "596:  yych = *(YYMARKER = ++YYCURSOR);",
          "597:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "592: #line 880 \"ext/standard/var_unserializer.re\"",
          "594: #line 595 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "593: #line 881 \"ext/standard/var_unserializer.re\"",
          "595: #line 596 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "634:  goto yy3;",
          "635: yy14:",
          "636:  ++YYCURSOR;",
          "638:  {",
          "640:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "642: }",
          "644: yy16:",
          "645:  yych = *++YYCURSOR;",
          "646:  goto yy3;",
          "",
          "[Removed Lines]",
          "637: #line 874 \"ext/standard/var_unserializer.re\"",
          "643: #line 644 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "638: #line 875 \"ext/standard/var_unserializer.re\"",
          "644: #line 645 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "670:  yych = *++YYCURSOR;",
          "671:  if (yych != '\"') goto yy18;",
          "672:  ++YYCURSOR;",
          "674:  {",
          "675:  size_t len, len2, len3, maxlen;",
          "676:  zend_long elements;",
          "",
          "[Removed Lines]",
          "673: #line 729 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "674: #line 730 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "816:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "817: }",
          "819: yy25:",
          "820:  yych = *++YYCURSOR;",
          "821:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "818: #line 819 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "819: #line 820 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "840:  yych = *++YYCURSOR;",
          "841:  if (yych != '\"') goto yy18;",
          "842:  ++YYCURSOR;",
          "844:  {",
          "",
          "[Removed Lines]",
          "843: #line 721 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "844: #line 722 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "848:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "849:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "850: }",
          "852: yy32:",
          "853:  yych = *++YYCURSOR;",
          "854:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "851: #line 852 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "852: #line 853 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "869:  yych = *++YYCURSOR;",
          "870:  if (yych != '{') goto yy18;",
          "871:  ++YYCURSOR;",
          "873:  {",
          "874:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "872: #line 700 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "873: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "891:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "892: }",
          "894: yy39:",
          "895:  yych = *++YYCURSOR;",
          "896:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "893: #line 894 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "894: #line 895 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "911:  yych = *++YYCURSOR;",
          "912:  if (yych != '\"') goto yy18;",
          "913:  ++YYCURSOR;",
          "915:  {",
          "916:  size_t len, maxlen;",
          "917:  zend_string *str;",
          "",
          "[Removed Lines]",
          "914: #line 672 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "915: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "939:  ZVAL_STR(rval, str);",
          "940:  return 1;",
          "941: }",
          "943: yy46:",
          "944:  yych = *++YYCURSOR;",
          "945:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "942: #line 943 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "943: #line 944 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "960:  yych = *++YYCURSOR;",
          "961:  if (yych != '\"') goto yy18;",
          "962:  ++YYCURSOR;",
          "964:  {",
          "965:  size_t len, maxlen;",
          "966:  char *str;",
          "",
          "[Removed Lines]",
          "963: #line 645 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "964: #line 646 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "987:  ZVAL_STRINGL(rval, str, len);",
          "988:  return 1;",
          "989: }",
          "991: yy53:",
          "992:  yych = *++YYCURSOR;",
          "993:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "990: #line 991 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "991: #line 992 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1075:  }",
          "1076: yy63:",
          "1077:  ++YYCURSOR;",
          "1079:  {",
          "1080: #if SIZEOF_ZEND_LONG == 4",
          "1081: use_double:",
          "",
          "[Removed Lines]",
          "1078: #line 636 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1079: #line 637 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1084:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1085:  return 1;",
          "1086: }",
          "1088: yy65:",
          "1089:  yych = *++YYCURSOR;",
          "1090:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1087: #line 1088 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1088: #line 1089 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1143:  yych = *++YYCURSOR;",
          "1144:  if (yych != ';') goto yy18;",
          "1145:  ++YYCURSOR;",
          "1147:  {",
          "",
          "[Removed Lines]",
          "1146: #line 620 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1147: #line 621 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1160:  return 1;",
          "1161: }",
          "1163: yy76:",
          "1164:  yych = *++YYCURSOR;",
          "1165:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1162: #line 1163 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1163: #line 1164 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1186:  if (yych <= '9') goto yy79;",
          "1187:  if (yych != ';') goto yy18;",
          "1188:  ++YYCURSOR;",
          "1190:  {",
          "1191: #if SIZEOF_ZEND_LONG == 4",
          "1192:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1189: #line 594 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1190: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1212:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1213:  return 1;",
          "1214: }",
          "1216: yy83:",
          "1217:  yych = *++YYCURSOR;",
          "1218:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1215: #line 1216 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1220:  yych = *++YYCURSOR;",
          "1221:  if (yych != ';') goto yy18;",
          "1222:  ++YYCURSOR;",
          "1224:  {",
          "1226:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1227:  return 1;",
          "1228: }",
          "1230: yy87:",
          "1231:  ++YYCURSOR;",
          "1233:  {",
          "1235:  ZVAL_NULL(rval);",
          "1236:  return 1;",
          "1237: }",
          "1239: yy89:",
          "1240:  yych = *++YYCURSOR;",
          "1241:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1223: #line 588 \"ext/standard/var_unserializer.re\"",
          "1229: #line 1230 \"ext/standard/var_unserializer.c\"",
          "1232: #line 582 \"ext/standard/var_unserializer.re\"",
          "1238: #line 1239 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1224: #line 589 \"ext/standard/var_unserializer.re\"",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "1233: #line 583 \"ext/standard/var_unserializer.re\"",
          "1239: #line 1240 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1258:  if (yych <= '9') goto yy91;",
          "1259:  if (yych != ';') goto yy18;",
          "1260:  ++YYCURSOR;",
          "1262:  {",
          "1263:  zend_long id;",
          "",
          "[Removed Lines]",
          "1261: #line 559 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1262: #line 560 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1282:  return 1;",
          "1283: }",
          "1285: yy95:",
          "1286:  yych = *++YYCURSOR;",
          "1287:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1285: #line 1286 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1304:  if (yych <= '9') goto yy97;",
          "1305:  if (yych != ';') goto yy18;",
          "1306:  ++YYCURSOR;",
          "1308:  {",
          "1309:  zend_long id;",
          "",
          "[Removed Lines]",
          "1307: #line 537 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1308: #line 538 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1327:  return 1;",
          "1328: }",
          "1330: }",
          "1334:  return 0;",
          "",
          "[Removed Lines]",
          "1329: #line 1330 \"ext/standard/var_unserializer.c\"",
          "1331: #line 882 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1330: #line 1331 \"ext/standard/var_unserializer.c\"",
          "1332: #line 883 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "474: {",
          "475:  zval retval;",
          "476:  zval fname;",
          "479:  if (Z_TYPE_P(rval) != IS_OBJECT) {",
          "480:   return 0;",
          "481:  }",
          "483:  zend_hash_resize(ht, zend_hash_num_elements(ht) + elements);",
          "484:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "485:   return 0;",
          "",
          "[Removed Lines]",
          "477:  HashTable *ht = Z_OBJPROP_P(rval);",
          "",
          "[Added Lines]",
          "477:  HashTable *ht;",
          "483:  ht = Z_OBJPROP_P(rval);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5602f6421372848a6fbb23fbe6bbca47d94dd49a",
      "candidate_info": {
        "commit_hash": "5602f6421372848a6fbb23fbe6bbca47d94dd49a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/5602f6421372848a6fbb23fbe6bbca47d94dd49a",
        "files": [
          "ext/dba/php_dba.h",
          "ext/exif/exif.c",
          "ext/mysqlnd/mysqlnd_priv.h",
          "ext/readline/readline.c",
          "ext/soap/php_http.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "main/php_streams.h",
          "sapi/phpdbg/phpdbg_wait.c"
        ],
        "message": "Eliminate usages of _PP macros\n\nThese are either in debug code (fix them), commented out (drop\nthem) or in dead compatibility macros (drop them).\n\nOne usage was in php_stream_get_from_zval(), which we have not used\nsince at least PHP 5.2 and, judging from the fact that nobody\ncomplained about it causing compile errors in PHP 7, nobody else\nuses it either, so drop it.\n\nThere are still remaining uses in mysqli embedded and odbc birdstep.\nThese probably need to be dropped outright.",
        "before_after_code_files": [
          "ext/dbphp_dba.h||ext/dba/php_dba.h",
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/mysqlnd/mysqlnd_priv.h||ext/mysqlnd/mysqlnd_priv.h",
          "ext/readline/readline.c||ext/readline/readline.c",
          "ext/soap/php_http.c||ext/soap/php_http.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "main/php_streams.h||main/php_streams.h",
          "sapi/phpdbg/phpdbg_wait.c||sapi/phpdbg/phpdbg_wait.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/dbphp_dba.h||ext/dba/php_dba.h": [
          "File: ext/dbphp_dba.h -> ext/dba/php_dba.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4074:  exif_discard_imageinfo(&ImageInfo);",
          "4076: #ifdef EXIF_DEBUG",
          "4078: #endif",
          "4079: }",
          "",
          "[Removed Lines]",
          "4077:  php_error_docref1(NULL, Z_STRVAL_PP(p_name), E_NOTICE, \"done\");",
          "",
          "[Added Lines]",
          "4077:  php_error_docref1(NULL, p_name, E_NOTICE, \"done\");",
          "",
          "---------------"
        ],
        "ext/mysqlnd/mysqlnd_priv.h||ext/mysqlnd/mysqlnd_priv.h": [
          "File: ext/mysqlnd/mysqlnd_priv.h -> ext/mysqlnd/mysqlnd_priv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "23: #ifndef MYSQLND_PRIV_H",
          "24: #define MYSQLND_PRIV_H",
          "36: #ifdef ZTS",
          "37: #include \"TSRM.h\"",
          "38: #endif",
          "44: #define MYSQLND_STR_W_LEN(str)  str, (sizeof(str) - 1)",
          "46: #define MYSQLND_DEBUG_DUMP_TIME    1",
          "",
          "[Removed Lines]",
          "26: #ifndef Z_ADDREF_P",
          "28: #define Z_ADDREF_P(pz)    (++(pz)->refcount)",
          "29: #define Z_DELREF_P(pz)    (--(pz)->refcount)",
          "30: #define Z_REFCOUNT_P(pz)   ((pz)->refcount)",
          "31: #define Z_SET_REFCOUNT_P(pz, rc) ((pz)->refcount = rc)",
          "32: #define Z_REFCOUNT_PP(ppz)   Z_REFCOUNT_P(*(ppz))",
          "33: #define Z_DELREF_PP(ppz)   Z_DELREF_P(*(ppz))",
          "34: #endif",
          "40: #ifndef pestrndup",
          "41: #define pestrndup(s, length, persistent) ((persistent)?zend_strndup((s),(length)):estrndup((s),(length)))",
          "42: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/readline/readline.c||ext/readline/readline.c": [
          "File: ext/readline/readline.c -> ext/readline/readline.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "305:    oldval = rl_erase_empty_line;",
          "306:    if (value) {",
          "307:     convert_to_long_ex(value);",
          "309:    }",
          "310:    RETVAL_LONG(oldval);",
          "311: #endif",
          "",
          "[Removed Lines]",
          "308:     rl_erase_empty_line = Z_LVAL_PP(value);",
          "",
          "[Added Lines]",
          "308:     rl_erase_empty_line = Z_LVAL_P(value);",
          "",
          "---------------"
        ],
        "ext/soap/php_http.c||ext/soap/php_http.c": [
          "File: ext/soap/php_http.c -> ext/soap/php_http.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "700:       PHP_MD5Update(&md5ctx, (unsigned char*)phpurl->query, strlen(phpurl->query));",
          "701:      }",
          "713:      PHP_MD5Final(hash, &md5ctx);",
          "714:      make_digest(HA2, hash);",
          "",
          "[Removed Lines]",
          "705:      if (zend_hash_find(Z_ARRVAL_PP(digest), \"qop\", sizeof(\"qop\"), (void **)&tmp) == SUCCESS &&",
          "706:          Z_TYPE_PP(tmp) == IS_STRING &&",
          "707:          Z_STRLEN_PP(tmp) == sizeof(\"auth-int\")-1 &&",
          "708:          stricmp(Z_STRVAL_PP(tmp), \"auth-int\") == 0) {",
          "709:       PHP_MD5Update(&md5ctx, \":\", 1);",
          "710:       PHP_MD5Update(&md5ctx, HEntity, HASHHEXLEN);",
          "711:      }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "44: {",
          "45:  var_entries *var_hash = (*var_hashx)->last;",
          "46: #if VAR_ENTRIES_DBG",
          "48: #endif",
          "50:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "47:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "[Added Lines]",
          "47:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "104:  zend_long i;",
          "105:  var_entries *var_hash = (*var_hashx)->first;",
          "106: #if VAR_ENTRIES_DBG",
          "108: #endif",
          "110:  while (var_hash) {",
          "",
          "[Removed Lines]",
          "107:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "",
          "[Added Lines]",
          "107:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(nzval));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "651:  if (yybm[0+yych] & 128) {",
          "652:   goto yy20;",
          "653:  }",
          "656:  yych = *++YYCURSOR;",
          "657:  if (yych != '\"') goto yy18;",
          "658:  ++YYCURSOR;",
          "",
          "[Removed Lines]",
          "654:  if (yych <= '/') goto yy18;",
          "655:  if (yych >= ';') goto yy18;",
          "",
          "[Added Lines]",
          "654:  if (yych != ':') goto yy18;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "802:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "803: }",
          "805: yy25:",
          "806:  yych = *++YYCURSOR;",
          "807:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "804: #line 805 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "803: #line 804 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "833:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "834:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "835: }",
          "837: yy32:",
          "838:  yych = *++YYCURSOR;",
          "839:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "836: #line 837 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "835: #line 836 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "879:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "880: }",
          "882: yy39:",
          "883:  yych = *++YYCURSOR;",
          "884:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "881: #line 882 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "880: #line 881 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "927:  ZVAL_STR(rval, str);",
          "928:  return 1;",
          "929: }",
          "931: yy46:",
          "932:  yych = *++YYCURSOR;",
          "933:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "930: #line 931 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "929: #line 930 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "975:  ZVAL_STRINGL(rval, str, len);",
          "976:  return 1;",
          "977: }",
          "979: yy53:",
          "980:  yych = *++YYCURSOR;",
          "981:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "978: #line 979 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1072:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1073:  return 1;",
          "1074: }",
          "1076: yy65:",
          "1077:  yych = *++YYCURSOR;",
          "1078:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1075: #line 1076 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1148:  return 1;",
          "1149: }",
          "1151: yy76:",
          "1152:  yych = *++YYCURSOR;",
          "1153:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1150: #line 1151 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1149: #line 1150 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1200:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1201:  return 1;",
          "1202: }",
          "1204: yy83:",
          "1205:  yych = *++YYCURSOR;",
          "1206:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1203: #line 1204 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1202: #line 1203 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1214:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1215:  return 1;",
          "1216: }",
          "1218: yy87:",
          "1219:  ++YYCURSOR;",
          "1220: #line 573 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1217: #line 1218 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1223:  ZVAL_NULL(rval);",
          "1224:  return 1;",
          "1225: }",
          "1227: yy89:",
          "1228:  yych = *++YYCURSOR;",
          "1229:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1226: #line 1227 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1272:  return 1;",
          "1273: }",
          "1275: yy95:",
          "1276:  yych = *++YYCURSOR;",
          "1277:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1274: #line 1275 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1273: #line 1274 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1321:  return 1;",
          "1322: }",
          "1324: }",
          "1325: #line 875 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1323: #line 1324 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1322: #line 1323 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: {",
          "43:  var_entries *var_hash = (*var_hashx)->last;",
          "44: #if VAR_ENTRIES_DBG",
          "46: #endif",
          "48:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "45:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "[Added Lines]",
          "45:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "102:  zend_long i;",
          "103:  var_entries *var_hash = (*var_hashx)->first;",
          "104: #if VAR_ENTRIES_DBG",
          "106: #endif",
          "108:  while (var_hash) {",
          "",
          "[Removed Lines]",
          "105:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "",
          "[Added Lines]",
          "105:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(nzval));",
          "",
          "---------------"
        ],
        "main/php_streams.h||main/php_streams.h": [
          "File: main/php_streams.h -> main/php_streams.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "568: #define php_stream_open_wrapper(path, mode, options, opened) _php_stream_open_wrapper_ex((path), (mode), (options), (opened), NULL STREAMS_CC)",
          "569: #define php_stream_open_wrapper_ex(path, mode, options, opened, context) _php_stream_open_wrapper_ex((path), (mode), (options), (opened), (context) STREAMS_CC)",
          "578: PHPAPI void php_stream_wrapper_log_error(php_stream_wrapper *wrapper, int options, const char *fmt, ...) PHP_ATTRIBUTE_FORMAT(printf, 3, 4);",
          "",
          "[Removed Lines]",
          "571: #define php_stream_get_from_zval(stream, zstream, mode, options, opened, context) \\",
          "572:   if (Z_TYPE_PP((zstream)) == IS_RESOURCE) { \\",
          "573:    php_stream_from_zval((stream), (zstream)); \\",
          "574:   } else (stream) = Z_TYPE_PP((zstream)) == IS_STRING ?  \\",
          "575:    php_stream_open_wrapper_ex(Z_STRVAL_PP((zstream)), (mode), (options), (opened), (context)) : NULL",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "sapi/phpdbg/phpdbg_wait.c||sapi/phpdbg/phpdbg_wait.c": [
          "File: sapi/phpdbg/phpdbg_wait.c -> sapi/phpdbg/phpdbg_wait.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "281:     pefree(elm, zend_extensions.persistent);",
          "282:     zend_extensions.count--;",
          "283:    } else {",
          "289:     zend_hash_del(Z_ARRVAL_P(zvp), strkey);",
          "290:    }",
          "291:   }",
          "",
          "[Removed Lines]",
          "285:     if (Z_TYPE(key) == IS_LONG) {",
          "286:      zend_hash_index_del(Z_ARRVAL_PP(zvpp), Z_LVAL(key));",
          "287:     }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d02f953faf4afdd1576acb1380e4cd3c050ac599",
      "candidate_info": {
        "commit_hash": "d02f953faf4afdd1576acb1380e4cd3c050ac599",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/d02f953faf4afdd1576acb1380e4cd3c050ac599",
        "files": [
          "ext/standard/tests/serialize/bug74101.phpt",
          "ext/standard/tests/serialize/bug74614.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #74101 and bug #74614",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug74101.phpt||ext/standard/tests/serialize/bug74101.phpt",
          "ext/standard/tests/serialize/bug74614.phpt||ext/standard/tests/serialize/bug74614.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug74101.phpt||ext/standard/tests/serialize/bug74101.phpt": [
          "File: ext/standard/tests/serialize/bug74101.phpt -> ext/standard/tests/serialize/bug74101.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74101: Unserialize Heap Use-After-Free (READ: 1) in zval_get_type",
          "3: --FILE--",
          "4: <?php",
          "5: $s = 'O:9:\"Exception\":799999999999999999999999999997:0i:0;a:0:{}i:2;i:0;i:0;R:2;';",
          "6: var_dump(unserialize($s));",
          "7: ?>",
          "8: --EXPECTF--",
          "9: Notice: unserialize(): Error at offset 48 of 74 bytes in %s on line %d",
          "10: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug74614.phpt||ext/standard/tests/serialize/bug74614.phpt": [
          "File: ext/standard/tests/serialize/bug74614.phpt -> ext/standard/tests/serialize/bug74614.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74614: Use-after-free in PHP7's unserialize()",
          "3: --FILE--",
          "4: <?php",
          "6: unserialize('a:3020000000000000000000000000000001:{i:0;a:0:{}i:1;i:2;i:2;i:3;i:3;i:4;i:4;i:5;i:5;i:6;i:6;i:7;i:7;i:8;i:8;R:2;}');",
          "8: ?>",
          "9: --EXPECTF--",
          "10: Notice: unserialize(): Error at offset 38 of 113 bytes in %s on line %d",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "503:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "505:  ht = Z_OBJPROP_P(rval);",
          "506:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "507:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "508:   if (has_wakeup) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "506:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "507:   return 0;",
          "508:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "578:  start = cursor;",
          "582: {",
          "583:  YYCTYPE yych;",
          "584:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "581: #line 582 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "585: #line 586 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "636: yy2:",
          "637:  ++YYCURSOR;",
          "638: yy3:",
          "640:  { return 0; }",
          "642: yy4:",
          "643:  yych = *(YYMARKER = ++YYCURSOR);",
          "644:  if (yych == ':') goto yy17;",
          "",
          "[Removed Lines]",
          "639: #line 959 \"ext/standard/var_unserializer.re\"",
          "641: #line 642 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "643: #line 963 \"ext/standard/var_unserializer.re\"",
          "645: #line 646 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "685:  goto yy3;",
          "686: yy15:",
          "687:  ++YYCURSOR;",
          "689:  {",
          "691:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "693: }",
          "695: yy17:",
          "696:  yych = *++YYCURSOR;",
          "697:  if (yybm[0+yych] & 128) {",
          "",
          "[Removed Lines]",
          "688: #line 953 \"ext/standard/var_unserializer.re\"",
          "694: #line 695 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "692: #line 957 \"ext/standard/var_unserializer.re\"",
          "698: #line 699 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "703:  goto yy3;",
          "704: yy19:",
          "705:  ++YYCURSOR;",
          "707:  {",
          "709:  ZVAL_NULL(rval);",
          "710:  return 1;",
          "711: }",
          "713: yy21:",
          "714:  yych = *++YYCURSOR;",
          "715:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "706: #line 637 \"ext/standard/var_unserializer.re\"",
          "712: #line 713 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "710: #line 641 \"ext/standard/var_unserializer.re\"",
          "716: #line 717 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "959:  goto yy18;",
          "960: yy63:",
          "961:  ++YYCURSOR;",
          "963:  {",
          "964:  zend_long id;",
          "",
          "[Removed Lines]",
          "962: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "966: #line 590 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "986:  return 1;",
          "987: }",
          "989: yy65:",
          "990:  yych = *++YYCURSOR;",
          "991:  if (yych == '\"') goto yy84;",
          "",
          "[Removed Lines]",
          "988: #line 989 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "992: #line 993 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "996:  goto yy18;",
          "997: yy67:",
          "998:  ++YYCURSOR;",
          "1000:  {",
          "1002:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1003:  return 1;",
          "1004: }",
          "1006: yy69:",
          "1007:  ++YYCURSOR;",
          "1008:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "",
          "[Removed Lines]",
          "999: #line 643 \"ext/standard/var_unserializer.re\"",
          "1005: #line 1006 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1003: #line 647 \"ext/standard/var_unserializer.re\"",
          "1009: #line 1010 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1022:  }",
          "1023: yy71:",
          "1024:  ++YYCURSOR;",
          "1026:  {",
          "1027: #if SIZEOF_ZEND_LONG == 4",
          "1028: use_double:",
          "",
          "[Removed Lines]",
          "1025: #line 691 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1029: #line 695 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1031:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1032:  return 1;",
          "1033: }",
          "1035: yy73:",
          "1036:  yych = *++YYCURSOR;",
          "1037:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1034: #line 1035 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1038: #line 1039 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1053:  goto yy18;",
          "1054: yy76:",
          "1055:  ++YYCURSOR;",
          "1057:  {",
          "1058: #if SIZEOF_ZEND_LONG == 4",
          "1059:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1056: #line 649 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1060: #line 653 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1079:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1080:  return 1;",
          "1081: }",
          "1083: yy78:",
          "1084:  yych = *++YYCURSOR;",
          "1085:  if (yych == '\"') goto yy92;",
          "1086:  goto yy18;",
          "1087: yy79:",
          "1088:  ++YYCURSOR;",
          "1090:  {",
          "1091:  zend_long id;",
          "",
          "[Removed Lines]",
          "1082: #line 1083 \"ext/standard/var_unserializer.c\"",
          "1089: #line 612 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1086: #line 1087 \"ext/standard/var_unserializer.c\"",
          "1093: #line 616 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1112:  return 1;",
          "1113: }",
          "1115: yy81:",
          "1116:  yych = *++YYCURSOR;",
          "1117:  if (yych == '\"') goto yy94;",
          "1118:  goto yy18;",
          "1119: yy82:",
          "1120:  ++YYCURSOR;",
          "1122:  {",
          "1123:  size_t len, len2, len3, maxlen;",
          "1124:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "1121: #line 801 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1118: #line 1119 \"ext/standard/var_unserializer.c\"",
          "1125: #line 805 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1271:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1272: }",
          "1274: yy84:",
          "1275:  ++YYCURSOR;",
          "1277:  {",
          "1278:  size_t len, maxlen;",
          "1279:  zend_string *str;",
          "",
          "[Removed Lines]",
          "1273: #line 1274 \"ext/standard/var_unserializer.c\"",
          "1276: #line 732 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "1280: #line 736 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1307:  ZVAL_STR(rval, str);",
          "1308:  return 1;",
          "1309: }",
          "1311: yy86:",
          "1312:  ++YYCURSOR;",
          "1314:  {",
          "1315:  zend_long elements = parse_iv(start + 2);",
          "1318:     if (!var_hash) return 0;",
          "1321:   return 0;",
          "1322:  }",
          "",
          "[Removed Lines]",
          "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
          "1313: #line 766 \"ext/standard/var_unserializer.re\"",
          "1320:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "1314: #line 1315 \"ext/standard/var_unserializer.c\"",
          "1317: #line 770 \"ext/standard/var_unserializer.re\"",
          "1324:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1335:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1336: }",
          "1338: yy88:",
          "1339:  yych = *++YYCURSOR;",
          "1340:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1337: #line 1338 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1341: #line 1342 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1359:  goto yy18;",
          "1360: yy92:",
          "1361:  ++YYCURSOR;",
          "1363:  {",
          "1364:  long elements;",
          "1365:     if (!var_hash) return 0;",
          "1367:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1369:   return 0;",
          "1370:  }",
          "1371:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1372: }",
          "1374: yy94:",
          "1375:  ++YYCURSOR;",
          "1377:  {",
          "1378:  size_t len, maxlen;",
          "1379:  char *str;",
          "",
          "[Removed Lines]",
          "1362: #line 790 \"ext/standard/var_unserializer.re\"",
          "1368:  if (elements < 0) {",
          "1373: #line 1374 \"ext/standard/var_unserializer.c\"",
          "1376: #line 700 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1366: #line 794 \"ext/standard/var_unserializer.re\"",
          "1372:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1377: #line 1378 \"ext/standard/var_unserializer.c\"",
          "1380: #line 704 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1405:  ZVAL_STRINGL(rval, str, len);",
          "1406:  return 1;",
          "1407: }",
          "1409: yy96:",
          "1410:  yych = *++YYCURSOR;",
          "1411:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1408: #line 1409 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1412: #line 1413 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1413:  goto yy18;",
          "1414: yy97:",
          "1415:  ++YYCURSOR;",
          "1417:  {",
          "",
          "[Removed Lines]",
          "1416: #line 675 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1420: #line 679 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1430:  return 1;",
          "1431: }",
          "1433: }",
          "1437:  return 0;",
          "",
          "[Removed Lines]",
          "1432: #line 1433 \"ext/standard/var_unserializer.c\"",
          "1434: #line 961 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1436: #line 1437 \"ext/standard/var_unserializer.c\"",
          "1438: #line 965 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "507:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "509:  ht = Z_OBJPROP_P(rval);",
          "510:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "511:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "512:   if (has_wakeup) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "510:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "511:   return 0;",
          "512:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "770:     if (!var_hash) return 0;",
          "773:   return 0;",
          "774:  }",
          "",
          "[Removed Lines]",
          "772:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "776:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "792:     if (!var_hash) return 0;",
          "794:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "796:   return 0;",
          "797:  }",
          "798:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "",
          "[Removed Lines]",
          "795:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "799:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0426b916df396a23e5c34514e4f2f0627efdcdf0",
      "candidate_info": {
        "commit_hash": "0426b916df396a23e5c34514e4f2f0627efdcdf0",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/0426b916df396a23e5c34514e4f2f0627efdcdf0",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Implement delayed __wakeup",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: #define VAR_ENTRIES_MAX 1024",
          "29: #define VAR_ENTRIES_DBG 0",
          "31: typedef struct {",
          "32:  zval *data[VAR_ENTRIES_MAX];",
          "33:  long used_slots;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "31: #define VAR_WAKEUP_FLAG 1",
          "32: #define WITH_WAKEUP_FLAG(zv_ptr) ((zval *) ((zend_uintptr_t) zv_ptr | VAR_WAKEUP_FLAG))",
          "33: #define WITHOUT_WAKEUP_FLAG(zv_ptr) ((zval *) ((zend_uintptr_t) zv_ptr & ~VAR_WAKEUP_FLAG))",
          "34: #define HAS_WAKEUP_FLAG(zv_ptr) ((zend_uintptr_t) zv_ptr & VAR_WAKEUP_FLAG)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "58:  var_hash->data[var_hash->used_slots++] = *rval;",
          "59: }",
          "62: {",
          "63:  var_entries *var_hash;",
          "65:  if (!var_hashx || !*var_hashx) {",
          "67:  }",
          "69:  var_hash = (*var_hashx)->last_dtor;",
          "",
          "[Removed Lines]",
          "61: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval **rval)",
          "66:   return;",
          "",
          "[Added Lines]",
          "66: static inline zval **get_var_push_dtor_slot(php_unserialize_data_t *var_hashx)",
          "71:   return NULL;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "85:   (*var_hashx)->last_dtor = var_hash;",
          "86:  }",
          "88:  Z_ADDREF_PP(rval);",
          "90: }",
          "92: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval **rval)",
          "",
          "[Removed Lines]",
          "89:  var_hash->data[var_hash->used_slots++] = *rval;",
          "",
          "[Added Lines]",
          "93:  return &var_hash->data[var_hash->used_slots++];",
          "94: }",
          "96: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval **rval)",
          "97: {",
          "98:  zval **slot = get_var_push_dtor_slot(var_hashx);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "164:  void *next;",
          "165:  long i;",
          "166:  var_entries *var_hash = (*var_hashx)->first;",
          "167: #if VAR_ENTRIES_DBG",
          "168:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "169: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "178:  zend_bool wakeup_failed = 0;",
          "179:  TSRMLS_FETCH();",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "179:  while (var_hash) {",
          "180:   for (i = 0; i < var_hash->used_slots; i++) {",
          "181: #if VAR_ENTRIES_DBG",
          "182:     fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_hash->data[i], Z_REFCOUNT_P(var_hash->data[i]));",
          "183: #endif",
          "185:   }",
          "186:   next = var_hash->next;",
          "187:   efree(var_hash);",
          "",
          "[Removed Lines]",
          "184:    zval_ptr_dtor(&var_hash->data[i]);",
          "",
          "[Added Lines]",
          "195:    zval *zv = var_hash->data[i];",
          "200:    if (HAS_WAKEUP_FLAG(zv)) {",
          "201:     zv = WITHOUT_WAKEUP_FLAG(zv);",
          "202:     if (!wakeup_failed) {",
          "203:      zval *retval_ptr = NULL;",
          "204:      zval wakeup_name;",
          "205:      INIT_PZVAL(&wakeup_name);",
          "206:      ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1, 0);",
          "208:      BG(serialize_lock)++;",
          "209:      if (call_user_function_ex(CG(function_table), &zv, &wakeup_name, &retval_ptr, 0, 0, 1, NULL TSRMLS_CC) == FAILURE || retval_ptr == NULL) {",
          "210:       wakeup_failed = 1;",
          "211:       zend_object_store_ctor_failed(zv TSRMLS_CC);",
          "212:      }",
          "213:      BG(serialize_lock)--;",
          "215:      if (retval_ptr) {",
          "216:       zval_ptr_dtor(&retval_ptr);",
          "217:      }",
          "218:     } else {",
          "219:      zend_object_store_ctor_failed(zv TSRMLS_CC);",
          "220:     }",
          "221:    }",
          "223:    zval_ptr_dtor(&zv);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "241: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "244: #line 249 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "283: #line 288 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "431: #endif",
          "432: static inline int object_common2(UNSERIALIZE_PARAMETER, long elements)",
          "433: {",
          "437:  if (Z_TYPE_PP(rval) != IS_OBJECT) {",
          "438:   return 0;",
          "439:  }",
          "441:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_OBJPROP_PP(rval), elements, 1)) {",
          "447:      ZVAL_NULL(*rval);",
          "448:   return 0;",
          "449:  }",
          "",
          "[Removed Lines]",
          "434:  zval *retval_ptr = NULL;",
          "435:  zval fname;",
          "443:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
          "444:         zend_hash_clean(Z_OBJPROP_PP(rval));",
          "445:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
          "446:      }",
          "",
          "[Added Lines]",
          "479:   if (Z_TYPE_PP(rval) == IS_OBJECT) {",
          "480:    zend_hash_clean(Z_OBJPROP_PP(rval));",
          "481:    zend_object_store_ctor_failed(*rval TSRMLS_CC);",
          "482:   }",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "453:     }",
          "455:  if (Z_OBJCE_PP(rval) != PHP_IC_ENTRY &&",
          "470:  }",
          "472:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "",
          "[Removed Lines]",
          "456:   zend_hash_exists(&Z_OBJCE_PP(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\"))) {",
          "457:   INIT_PZVAL(&fname);",
          "458:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1, 0);",
          "459:   BG(serialize_lock)++;",
          "460:   call_user_function_ex(CG(function_table), rval, &fname, &retval_ptr, 0, 0, 1, NULL TSRMLS_CC);",
          "461:   BG(serialize_lock)--;",
          "462:  }",
          "464:  if (retval_ptr) {",
          "465:   zval_ptr_dtor(&retval_ptr);",
          "466:  }",
          "468:  if (EG(exception)) {",
          "469:   return 0;",
          "",
          "[Added Lines]",
          "492:   zend_hash_exists(&Z_OBJCE_PP(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\"))",
          "493:  ) {",
          "495:   zval **slot = get_var_push_dtor_slot(var_hash);",
          "496:   zval *zv = *rval;",
          "497:   Z_ADDREF_P(zv);",
          "498:   if (PZVAL_IS_REF(zv)) {",
          "499:    SEPARATE_ZVAL(&zv);",
          "500:   }",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "501: {",
          "502:  YYCTYPE yych;",
          "503:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "500: #line 501 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "532: #line 533 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "534:     0,   0,   0,   0,   0,   0,   0,   0,",
          "535:     0,   0,   0,   0,   0,   0,   0,   0,",
          "536:  };",
          "538:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "539:  yych = *YYCURSOR;",
          "540:  switch (yych) {",
          "541:  case 'C':",
          "543:  case 'N': goto yy5;",
          "550:  case 'o': goto yy12;",
          "555:  }",
          "556: yy2:",
          "559: yy3:",
          "561:  { return 0; }",
          "563: yy4:",
          "564:  yych = *(YYMARKER = ++YYCURSOR);",
          "566:  goto yy3;",
          "567: yy5:",
          "568:  yych = *++YYCURSOR;",
          "570:  goto yy3;",
          "571: yy6:",
          "572:  yych = *(YYMARKER = ++YYCURSOR);",
          "574:  goto yy3;",
          "575: yy7:",
          "576:  yych = *(YYMARKER = ++YYCURSOR);",
          "578:  goto yy3;",
          "579: yy8:",
          "580:  yych = *(YYMARKER = ++YYCURSOR);",
          "582:  goto yy3;",
          "583: yy9:",
          "584:  yych = *(YYMARKER = ++YYCURSOR);",
          "586:  goto yy3;",
          "587: yy10:",
          "588:  yych = *(YYMARKER = ++YYCURSOR);",
          "590:  goto yy3;",
          "591: yy11:",
          "592:  yych = *(YYMARKER = ++YYCURSOR);",
          "594:  goto yy3;",
          "595: yy12:",
          "596:  yych = *(YYMARKER = ++YYCURSOR);",
          "598:  goto yy3;",
          "599: yy13:",
          "600:  yych = *(YYMARKER = ++YYCURSOR);",
          "602:  goto yy3;",
          "603: yy14:",
          "604:  ++YYCURSOR;",
          "606:  {",
          "608:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "610: }",
          "615: yy17:",
          "616:  yych = *++YYCURSOR;",
          "617:  if (yybm[0+yych] & 128) {",
          "619:  }",
          "621: yy18:",
          "622:  YYCURSOR = YYMARKER;",
          "623:  goto yy3;",
          "624: yy19:",
          "625:  yych = *++YYCURSOR;",
          "628:  }",
          "629:  goto yy18;",
          "637:  if (yych <= '/') goto yy18;",
          "639:  yych = *++YYCURSOR;",
          "756:   } else {",
          "760:   }",
          "777:   }",
          "780:  }",
          "787:  }",
          "791:  }",
          "798:  yych = *++YYCURSOR;",
          "799:  if (yych <= ',') {",
          "801:  } else {",
          "803:   if (yych <= '/') goto yy18;",
          "805:   goto yy18;",
          "806:  }",
          "808:  yych = *++YYCURSOR;",
          "809:  if (yych <= '/') goto yy18;",
          "812:  ++YYCURSOR;",
          "813:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "814:  yych = *YYCURSOR;",
          "815:  if (yych <= '/') goto yy18;",
          "818:  yych = *++YYCURSOR;",
          "820:  ++YYCURSOR;",
          "838:  if (yych <= '/') goto yy18;",
          "839:  if (yych <= '9') goto yy34;",
          "840:  goto yy18;",
          "842:  yych = *++YYCURSOR;",
          "843:  if (yych <= '/') goto yy18;",
          "844:  if (yych >= ':') goto yy18;",
          "846:  ++YYCURSOR;",
          "847:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "848:  yych = *YYCURSOR;",
          "849:  if (yych <= '/') goto yy18;",
          "852:  yych = *++YYCURSOR;",
          "854:  ++YYCURSOR;",
          "864:  }",
          "872:  }",
          "878:  yych = *++YYCURSOR;",
          "880:  if (yych <= '/') goto yy18;",
          "882:  goto yy18;",
          "884:  yych = *++YYCURSOR;",
          "885:  if (yych <= '/') goto yy18;",
          "886:  if (yych >= ':') goto yy18;",
          "888:  ++YYCURSOR;",
          "889:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "890:  yych = *YYCURSOR;",
          "891:  if (yych <= '/') goto yy18;",
          "894:  yych = *++YYCURSOR;",
          "896:  ++YYCURSOR;",
          "936:  if (yych <= '/') goto yy18;",
          "938:  goto yy18;",
          "940:  yych = *++YYCURSOR;",
          "941:  if (yych <= '/') goto yy18;",
          "942:  if (yych >= ':') goto yy18;",
          "944:  ++YYCURSOR;",
          "945:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "946:  yych = *YYCURSOR;",
          "947:  if (yych <= '/') goto yy18;",
          "950:  yych = *++YYCURSOR;",
          "952:  ++YYCURSOR;",
          "954:  {",
          "971:   return 0;",
          "972:  }",
          "977:  }",
          "984:  return 1;",
          "985: }",
          "1007:  yych = *++YYCURSOR;",
          "1009:  goto yy18;",
          "1020:  yych = *++YYCURSOR;",
          "1022:  goto yy18;",
          "1029:  ++YYCURSOR;",
          "1056:  ++YYCURSOR;",
          "1057:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1058:  yych = *YYCURSOR;",
          "1059:  if (yych <= ';') {",
          "1060:   if (yych <= '/') goto yy18;",
          "1062:   if (yych <= ':') goto yy18;",
          "1063:  } else {",
          "1064:   if (yych <= 'E') {",
          "1065:    if (yych <= 'D') goto yy18;",
          "1067:   } else {",
          "1069:    goto yy18;",
          "1070:   }",
          "1071:  }",
          "1073:  ++YYCURSOR;",
          "1075:  {",
          "1076: #if SIZEOF_LONG == 4",
          "1077: use_double:",
          "",
          "[Removed Lines]",
          "542:  case 'O': goto yy13;",
          "544:  case 'R': goto yy2;",
          "545:  case 'S': goto yy10;",
          "546:  case 'a': goto yy11;",
          "547:  case 'b': goto yy6;",
          "548:  case 'd': goto yy8;",
          "549:  case 'i': goto yy7;",
          "551:  case 'r': goto yy4;",
          "552:  case 's': goto yy9;",
          "553:  case '}': goto yy14;",
          "554:  default: goto yy16;",
          "557:  yych = *(YYMARKER = ++YYCURSOR);",
          "558:  if (yych == ':') goto yy95;",
          "560: #line 877 \"ext/standard/var_unserializer.re\"",
          "562: #line 563 \"ext/standard/var_unserializer.c\"",
          "565:  if (yych == ':') goto yy89;",
          "569:  if (yych == ';') goto yy87;",
          "573:  if (yych == ':') goto yy83;",
          "577:  if (yych == ':') goto yy77;",
          "581:  if (yych == ':') goto yy53;",
          "585:  if (yych == ':') goto yy46;",
          "589:  if (yych == ':') goto yy39;",
          "593:  if (yych == ':') goto yy32;",
          "597:  if (yych == ':') goto yy25;",
          "601:  if (yych == ':') goto yy17;",
          "605: #line 871 \"ext/standard/var_unserializer.re\"",
          "611: #line 612 \"ext/standard/var_unserializer.c\"",
          "612: yy16:",
          "613:  yych = *++YYCURSOR;",
          "614:  goto yy3;",
          "618:   goto yy20;",
          "620:  if (yych == '+') goto yy19;",
          "626:  if (yybm[0+yych] & 128) {",
          "627:   goto yy20;",
          "630: yy20:",
          "631:  ++YYCURSOR;",
          "632:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "633:  yych = *YYCURSOR;",
          "634:  if (yybm[0+yych] & 128) {",
          "635:   goto yy20;",
          "636:  }",
          "638:  if (yych >= ';') goto yy18;",
          "640:  if (yych != '\"') goto yy18;",
          "641:  ++YYCURSOR;",
          "642: #line 717 \"ext/standard/var_unserializer.re\"",
          "643:  {",
          "644:  size_t len, len2, len3, maxlen;",
          "645:  long elements;",
          "646:  char *class_name;",
          "647:  zend_class_entry *ce;",
          "648:  zend_class_entry **pce;",
          "649:  int incomplete_class = 0;",
          "651:  int custom_object = 0;",
          "653:  zval *user_func;",
          "654:  zval *retval_ptr;",
          "655:  zval **args[1];",
          "656:  zval *arg_func_name;",
          "658:     if (!var_hash) return 0;",
          "659:  if (*start == 'C') {",
          "660:   custom_object = 1;",
          "661:  }",
          "663:  INIT_PZVAL(*rval);",
          "664:  len2 = len = parse_uiv(start + 2);",
          "665:  maxlen = max - YYCURSOR;",
          "666:  if (maxlen < len || len == 0) {",
          "668:   return 0;",
          "669:  }",
          "671:  class_name = (char*)YYCURSOR;",
          "673:  YYCURSOR += len;",
          "675:  if (*(YYCURSOR) != '\"') {",
          "677:   return 0;",
          "678:  }",
          "679:  if (*(YYCURSOR+1) != ':') {",
          "681:   return 0;",
          "682:  }",
          "684:  len3 = strspn(class_name, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "685:  if (len3 != len)",
          "686:  {",
          "688:   return 0;",
          "689:  }",
          "691:  class_name = estrndup(class_name, len);",
          "693:  do {",
          "695:   BG(serialize_lock)++;",
          "696:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "697:    BG(serialize_lock)--;",
          "698:    if (EG(exception)) {",
          "699:     efree(class_name);",
          "700:     return 0;",
          "701:    }",
          "702:    ce = *pce;",
          "703:    break;",
          "704:   }",
          "705:   BG(serialize_lock)--;",
          "707:   if (EG(exception)) {",
          "708:    efree(class_name);",
          "709:    return 0;",
          "710:   }",
          "713:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "714:    incomplete_class = 1;",
          "715:    ce = PHP_IC_ENTRY;",
          "716:    break;",
          "717:   }",
          "720:   MAKE_STD_ZVAL(user_func);",
          "721:   ZVAL_STRING(user_func, PG(unserialize_callback_func), 1);",
          "722:   args[0] = &arg_func_name;",
          "723:   MAKE_STD_ZVAL(arg_func_name);",
          "724:   ZVAL_STRING(arg_func_name, class_name, 1);",
          "725:   BG(serialize_lock)++;",
          "726:   if (call_user_function_ex(CG(function_table), NULL, user_func, &retval_ptr, 1, args, 0, NULL TSRMLS_CC) != SUCCESS) {",
          "727:    BG(serialize_lock)--;",
          "728:    if (EG(exception)) {",
          "729:     efree(class_name);",
          "730:     zval_ptr_dtor(&user_func);",
          "731:     zval_ptr_dtor(&arg_func_name);",
          "732:     return 0;",
          "733:    }",
          "734:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"defined (%s) but not found\", user_func->value.str.val);",
          "735:    incomplete_class = 1;",
          "736:    ce = PHP_IC_ENTRY;",
          "737:    zval_ptr_dtor(&user_func);",
          "738:    zval_ptr_dtor(&arg_func_name);",
          "739:    break;",
          "740:   }",
          "741:   BG(serialize_lock)--;",
          "742:   if (retval_ptr) {",
          "743:    zval_ptr_dtor(&retval_ptr);",
          "744:   }",
          "745:   if (EG(exception)) {",
          "746:    efree(class_name);",
          "747:    zval_ptr_dtor(&user_func);",
          "748:    zval_ptr_dtor(&arg_func_name);",
          "749:    return 0;",
          "750:   }",
          "753:   BG(serialize_lock)++;",
          "754:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "755:    ce = *pce;",
          "757:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Function %s() hasn't defined the class it was called for\", user_func->value.str.val);",
          "758:    incomplete_class = 1;",
          "759:    ce = PHP_IC_ENTRY;",
          "761:   BG(serialize_lock)--;",
          "763:   zval_ptr_dtor(&user_func);",
          "764:   zval_ptr_dtor(&arg_func_name);",
          "765:   break;",
          "766:  } while (1);",
          "770:  if (custom_object) {",
          "771:   int ret;",
          "773:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "775:   if (ret && incomplete_class) {",
          "776:    php_store_class_name(*rval, class_name, len2);",
          "778:   efree(class_name);",
          "779:   return ret;",
          "782:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "784:  if (elements < 0) {",
          "785:     efree(class_name);",
          "786:     return 0;",
          "789:  if (incomplete_class) {",
          "790:   php_store_class_name(*rval, class_name, len2);",
          "792:  efree(class_name);",
          "794:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "795: }",
          "796: #line 797 \"ext/standard/var_unserializer.c\"",
          "797: yy25:",
          "800:   if (yych != '+') goto yy18;",
          "802:   if (yych <= '-') goto yy26;",
          "804:   if (yych <= '9') goto yy27;",
          "807: yy26:",
          "810:  if (yych >= ':') goto yy18;",
          "811: yy27:",
          "816:  if (yych <= '9') goto yy27;",
          "817:  if (yych >= ';') goto yy18;",
          "819:  if (yych != '\"') goto yy18;",
          "821: #line 704 \"ext/standard/var_unserializer.re\"",
          "822:  {",
          "823:  long elements;",
          "824:     if (!var_hash) return 0;",
          "826:  INIT_PZVAL(*rval);",
          "828:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "829:  if (elements < 0) {",
          "830:   return 0;",
          "831:  }",
          "832:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "833: }",
          "834: #line 835 \"ext/standard/var_unserializer.c\"",
          "835: yy32:",
          "836:  yych = *++YYCURSOR;",
          "837:  if (yych == '+') goto yy33;",
          "841: yy33:",
          "845: yy34:",
          "850:  if (yych <= '9') goto yy34;",
          "851:  if (yych >= ';') goto yy18;",
          "853:  if (yych != '{') goto yy18;",
          "855: #line 683 \"ext/standard/var_unserializer.re\"",
          "856:  {",
          "857:  long elements = parse_iv(start + 2);",
          "860:     if (!var_hash) return 0;",
          "862:  if (elements < 0) {",
          "863:   return 0;",
          "866:  INIT_PZVAL(*rval);",
          "868:  array_init_size(*rval, elements);",
          "870:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_PP(rval), elements, 0)) {",
          "871:   return 0;",
          "874:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "875: }",
          "876: #line 877 \"ext/standard/var_unserializer.c\"",
          "877: yy39:",
          "879:  if (yych == '+') goto yy40;",
          "881:  if (yych <= '9') goto yy41;",
          "883: yy40:",
          "887: yy41:",
          "892:  if (yych <= '9') goto yy41;",
          "893:  if (yych >= ';') goto yy18;",
          "895:  if (yych != '\"') goto yy18;",
          "897: #line 648 \"ext/standard/var_unserializer.re\"",
          "898:  {",
          "899:  size_t len, maxlen;",
          "900:  char *str;",
          "902:  len = parse_uiv(start + 2);",
          "903:  maxlen = max - YYCURSOR;",
          "904:  if (maxlen < len) {",
          "906:   return 0;",
          "907:  }",
          "909:  if ((str = unserialize_str(&YYCURSOR, &len, maxlen)) == NULL) {",
          "910:   return 0;",
          "911:  }",
          "913:  if (*(YYCURSOR) != '\"') {",
          "914:   efree(str);",
          "916:   return 0;",
          "917:  }",
          "919:  if (*(YYCURSOR + 1) != ';') {",
          "920:   efree(str);",
          "922:   return 0;",
          "923:  }",
          "925:  YYCURSOR += 2;",
          "928:  INIT_PZVAL(*rval);",
          "929:  ZVAL_STRINGL(*rval, str, len, 0);",
          "930:  return 1;",
          "931: }",
          "932: #line 933 \"ext/standard/var_unserializer.c\"",
          "933: yy46:",
          "934:  yych = *++YYCURSOR;",
          "935:  if (yych == '+') goto yy47;",
          "937:  if (yych <= '9') goto yy48;",
          "939: yy47:",
          "943: yy48:",
          "948:  if (yych <= '9') goto yy48;",
          "949:  if (yych >= ';') goto yy18;",
          "951:  if (yych != '\"') goto yy18;",
          "953: #line 615 \"ext/standard/var_unserializer.re\"",
          "955:  size_t len, maxlen;",
          "956:  char *str;",
          "958:  len = parse_uiv(start + 2);",
          "959:  maxlen = max - YYCURSOR;",
          "960:  if (maxlen < len) {",
          "962:   return 0;",
          "963:  }",
          "965:  str = (char*)YYCURSOR;",
          "967:  YYCURSOR += len;",
          "969:  if (*(YYCURSOR) != '\"') {",
          "974:  if (*(YYCURSOR + 1) != ';') {",
          "976:   return 0;",
          "979:  YYCURSOR += 2;",
          "982:  INIT_PZVAL(*rval);",
          "983:  ZVAL_STRINGL(*rval, str, len, 1);",
          "986: #line 987 \"ext/standard/var_unserializer.c\"",
          "987: yy53:",
          "988:  yych = *++YYCURSOR;",
          "989:  if (yych <= '/') {",
          "990:   if (yych <= ',') {",
          "991:    if (yych == '+') goto yy57;",
          "992:    goto yy18;",
          "993:   } else {",
          "994:    if (yych <= '-') goto yy55;",
          "995:    if (yych <= '.') goto yy60;",
          "996:    goto yy18;",
          "997:   }",
          "998:  } else {",
          "999:   if (yych <= 'I') {",
          "1000:    if (yych <= '9') goto yy58;",
          "1001:    if (yych <= 'H') goto yy18;",
          "1002:    goto yy56;",
          "1003:   } else {",
          "1004:    if (yych != 'N') goto yy18;",
          "1005:   }",
          "1006:  }",
          "1008:  if (yych == 'A') goto yy76;",
          "1010: yy55:",
          "1011:  yych = *++YYCURSOR;",
          "1012:  if (yych <= '/') {",
          "1013:   if (yych == '.') goto yy60;",
          "1014:   goto yy18;",
          "1015:  } else {",
          "1016:   if (yych <= '9') goto yy58;",
          "1017:   if (yych != 'I') goto yy18;",
          "1018:  }",
          "1019: yy56:",
          "1021:  if (yych == 'N') goto yy72;",
          "1023: yy57:",
          "1024:  yych = *++YYCURSOR;",
          "1025:  if (yych == '.') goto yy60;",
          "1026:  if (yych <= '/') goto yy18;",
          "1027:  if (yych >= ':') goto yy18;",
          "1028: yy58:",
          "1030:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1031:  yych = *YYCURSOR;",
          "1032:  if (yych <= ':') {",
          "1033:   if (yych <= '.') {",
          "1034:    if (yych <= '-') goto yy18;",
          "1035:    goto yy70;",
          "1036:   } else {",
          "1037:    if (yych <= '/') goto yy18;",
          "1038:    if (yych <= '9') goto yy58;",
          "1039:    goto yy18;",
          "1040:   }",
          "1041:  } else {",
          "1042:   if (yych <= 'E') {",
          "1043:    if (yych <= ';') goto yy63;",
          "1044:    if (yych <= 'D') goto yy18;",
          "1045:    goto yy65;",
          "1046:   } else {",
          "1047:    if (yych == 'e') goto yy65;",
          "1048:    goto yy18;",
          "1049:   }",
          "1050:  }",
          "1051: yy60:",
          "1052:  yych = *++YYCURSOR;",
          "1053:  if (yych <= '/') goto yy18;",
          "1054:  if (yych >= ':') goto yy18;",
          "1055: yy61:",
          "1061:   if (yych <= '9') goto yy61;",
          "1066:    goto yy65;",
          "1068:    if (yych == 'e') goto yy65;",
          "1072: yy63:",
          "1074: #line 605 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "573:  case 'O': goto yy4;",
          "575:  case 'R': goto yy6;",
          "576:  case 'S': goto yy7;",
          "577:  case 'a': goto yy8;",
          "578:  case 'b': goto yy9;",
          "579:  case 'd': goto yy10;",
          "580:  case 'i': goto yy11;",
          "582:  case 'r': goto yy13;",
          "583:  case 's': goto yy14;",
          "584:  case '}': goto yy15;",
          "585:  default: goto yy2;",
          "588:  ++YYCURSOR;",
          "590: #line 909 \"ext/standard/var_unserializer.re\"",
          "592: #line 593 \"ext/standard/var_unserializer.c\"",
          "595:  if (yych == ':') goto yy17;",
          "599:  if (yych == ';') goto yy19;",
          "603:  if (yych == ':') goto yy21;",
          "607:  if (yych == ':') goto yy22;",
          "611:  if (yych == ':') goto yy23;",
          "615:  if (yych == ':') goto yy24;",
          "619:  if (yych == ':') goto yy25;",
          "623:  if (yych == ':') goto yy26;",
          "627:  if (yych == ':') goto yy27;",
          "631:  if (yych == ':') goto yy28;",
          "634:  yych = *(YYMARKER = ++YYCURSOR);",
          "635:  if (yych == ':') goto yy29;",
          "636:  goto yy3;",
          "637: yy15:",
          "639: #line 903 \"ext/standard/var_unserializer.re\"",
          "645: #line 646 \"ext/standard/var_unserializer.c\"",
          "649:   goto yy31;",
          "651:  if (yych == '+') goto yy30;",
          "656:  ++YYCURSOR;",
          "657: #line 581 \"ext/standard/var_unserializer.re\"",
          "658:  {",
          "660:  INIT_PZVAL(*rval);",
          "661:  ZVAL_NULL(*rval);",
          "662:  return 1;",
          "663: }",
          "664: #line 665 \"ext/standard/var_unserializer.c\"",
          "665: yy21:",
          "667:  if (yych <= ',') {",
          "668:   if (yych == '+') goto yy33;",
          "669:   goto yy18;",
          "670:  } else {",
          "671:   if (yych <= '-') goto yy33;",
          "672:   if (yych <= '/') goto yy18;",
          "673:   if (yych <= '9') goto yy34;",
          "674:   goto yy18;",
          "676: yy22:",
          "677:  yych = *++YYCURSOR;",
          "678:  if (yych == '+') goto yy36;",
          "679:  if (yych <= '/') goto yy18;",
          "680:  if (yych <= '9') goto yy37;",
          "682: yy23:",
          "683:  yych = *++YYCURSOR;",
          "684:  if (yych == '+') goto yy39;",
          "686:  if (yych <= '9') goto yy40;",
          "687:  goto yy18;",
          "688: yy24:",
          "690:  if (yych <= '/') goto yy18;",
          "691:  if (yych <= '1') goto yy42;",
          "692:  goto yy18;",
          "693: yy25:",
          "694:  yych = *++YYCURSOR;",
          "695:  if (yych <= '/') {",
          "696:   if (yych <= ',') {",
          "697:    if (yych == '+') goto yy43;",
          "698:    goto yy18;",
          "700:    if (yych <= '-') goto yy44;",
          "701:    if (yych <= '.') goto yy45;",
          "702:    goto yy18;",
          "704:  } else {",
          "705:   if (yych <= 'I') {",
          "706:    if (yych <= '9') goto yy46;",
          "707:    if (yych <= 'H') goto yy18;",
          "708:    goto yy48;",
          "709:   } else {",
          "710:    if (yych == 'N') goto yy49;",
          "711:    goto yy18;",
          "714: yy26:",
          "715:  yych = *++YYCURSOR;",
          "716:  if (yych <= ',') {",
          "717:   if (yych == '+') goto yy50;",
          "718:   goto yy18;",
          "719:  } else {",
          "720:   if (yych <= '-') goto yy50;",
          "721:   if (yych <= '/') goto yy18;",
          "722:   if (yych <= '9') goto yy51;",
          "723:   goto yy18;",
          "725: yy27:",
          "726:  yych = *++YYCURSOR;",
          "727:  if (yych <= ',') {",
          "728:   if (yych == '+') goto yy53;",
          "729:   goto yy18;",
          "730:  } else {",
          "731:   if (yych <= '-') goto yy53;",
          "732:   if (yych <= '/') goto yy18;",
          "733:   if (yych <= '9') goto yy54;",
          "734:   goto yy18;",
          "736: yy28:",
          "739:   if (yych == '+') goto yy56;",
          "740:   goto yy18;",
          "742:   if (yych <= '-') goto yy56;",
          "744:   if (yych <= '9') goto yy57;",
          "747: yy29:",
          "749:  if (yych == '+') goto yy59;",
          "751:  if (yych <= '9') goto yy60;",
          "752:  goto yy18;",
          "753: yy30:",
          "754:  yych = *++YYCURSOR;",
          "755:  if (yybm[0+yych] & 128) {",
          "756:   goto yy31;",
          "757:  }",
          "758:  goto yy18;",
          "759: yy31:",
          "763:  if (yybm[0+yych] & 128) {",
          "764:   goto yy31;",
          "765:  }",
          "767:  if (yych <= ':') goto yy62;",
          "768:  goto yy18;",
          "769: yy33:",
          "771:  if (yych <= '/') goto yy18;",
          "772:  if (yych >= ':') goto yy18;",
          "773: yy34:",
          "775:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "776:  yych = *YYCURSOR;",
          "779:  if (yych == ';') goto yy63;",
          "781: yy36:",
          "785: yy37:",
          "790:  if (yych <= '9') goto yy37;",
          "791:  if (yych <= ':') goto yy65;",
          "792:  goto yy18;",
          "793: yy39:",
          "795:  if (yych <= '/') goto yy18;",
          "796:  if (yych >= ':') goto yy18;",
          "797: yy40:",
          "799:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "800:  yych = *YYCURSOR;",
          "801:  if (yych <= '/') goto yy18;",
          "802:  if (yych <= '9') goto yy40;",
          "803:  if (yych <= ':') goto yy66;",
          "804:  goto yy18;",
          "805: yy42:",
          "806:  yych = *++YYCURSOR;",
          "807:  if (yych == ';') goto yy67;",
          "808:  goto yy18;",
          "809: yy43:",
          "810:  yych = *++YYCURSOR;",
          "811:  if (yych == '.') goto yy45;",
          "812:  if (yych <= '/') goto yy18;",
          "813:  if (yych <= '9') goto yy46;",
          "814:  goto yy18;",
          "815: yy44:",
          "816:  yych = *++YYCURSOR;",
          "817:  if (yych <= '/') {",
          "818:   if (yych != '.') goto yy18;",
          "819:  } else {",
          "820:   if (yych <= '9') goto yy46;",
          "821:   if (yych == 'I') goto yy48;",
          "822:   goto yy18;",
          "824: yy45:",
          "825:  yych = *++YYCURSOR;",
          "826:  if (yych <= '/') goto yy18;",
          "827:  if (yych <= '9') goto yy69;",
          "828:  goto yy18;",
          "829: yy46:",
          "830:  ++YYCURSOR;",
          "831:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "832:  yych = *YYCURSOR;",
          "833:  if (yych <= ':') {",
          "834:   if (yych <= '.') {",
          "835:    if (yych <= '-') goto yy18;",
          "836:    goto yy69;",
          "837:   } else {",
          "838:    if (yych <= '/') goto yy18;",
          "839:    if (yych <= '9') goto yy46;",
          "840:    goto yy18;",
          "841:   }",
          "842:  } else {",
          "843:   if (yych <= 'E') {",
          "844:    if (yych <= ';') goto yy71;",
          "845:    if (yych <= 'D') goto yy18;",
          "846:    goto yy73;",
          "847:   } else {",
          "848:    if (yych == 'e') goto yy73;",
          "849:    goto yy18;",
          "850:   }",
          "852: yy48:",
          "853:  yych = *++YYCURSOR;",
          "854:  if (yych == 'N') goto yy74;",
          "855:  goto yy18;",
          "856: yy49:",
          "858:  if (yych == 'A') goto yy75;",
          "859:  goto yy18;",
          "860: yy50:",
          "861:  yych = *++YYCURSOR;",
          "862:  if (yych <= '/') goto yy18;",
          "863:  if (yych >= ':') goto yy18;",
          "864: yy51:",
          "865:  ++YYCURSOR;",
          "866:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "867:  yych = *YYCURSOR;",
          "869:  if (yych <= '9') goto yy51;",
          "870:  if (yych == ';') goto yy76;",
          "872: yy53:",
          "876: yy54:",
          "881:  if (yych <= '9') goto yy54;",
          "882:  if (yych <= ':') goto yy78;",
          "883:  goto yy18;",
          "884: yy56:",
          "886:  if (yych <= '/') goto yy18;",
          "887:  if (yych >= ':') goto yy18;",
          "888: yy57:",
          "890:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "891:  yych = *YYCURSOR;",
          "893:  if (yych <= '9') goto yy57;",
          "894:  if (yych == ';') goto yy79;",
          "896: yy59:",
          "900: yy60:",
          "905:  if (yych <= '9') goto yy60;",
          "906:  if (yych <= ':') goto yy81;",
          "907:  goto yy18;",
          "908: yy62:",
          "910:  if (yych == '\"') goto yy82;",
          "911:  goto yy18;",
          "912: yy63:",
          "914: #line 537 \"ext/standard/var_unserializer.re\"",
          "916:  long id;",
          "919:  if (!var_hash) return 0;",
          "921:  id = parse_iv(start + 2) - 1;",
          "922:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "926:  if (*rval != NULL) {",
          "927:   var_push_dtor_no_addref(var_hash, rval);",
          "930:  Z_ADDREF_PP(rval);",
          "931:  Z_SET_ISREF_PP(rval);",
          "935: #line 936 \"ext/standard/var_unserializer.c\"",
          "936: yy65:",
          "938:  if (yych == '\"') goto yy84;",
          "940: yy66:",
          "942:  if (yych == '{') goto yy86;",
          "944: yy67:",
          "946: #line 588 \"ext/standard/var_unserializer.re\"",
          "947:  {",
          "949:  INIT_PZVAL(*rval);",
          "950:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "951:  return 1;",
          "952: }",
          "953: #line 954 \"ext/standard/var_unserializer.c\"",
          "954: yy69:",
          "960:   if (yych <= '9') goto yy69;",
          "965:    goto yy73;",
          "967:    if (yych == 'e') goto yy73;",
          "971: yy71:",
          "973: #line 637 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1081:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1082:  return 1;",
          "1083: }",
          "1086:  yych = *++YYCURSOR;",
          "1087:  if (yych <= ',') {",
          "1089:  } else {",
          "1091:   if (yych <= '/') goto yy18;",
          "1093:   goto yy18;",
          "1094:  }",
          "1096:  yych = *++YYCURSOR;",
          "1112:  goto yy18;",
          "1114:  yych = *++YYCURSOR;",
          "1117:  goto yy18;",
          "1142:  ++YYCURSOR;",
          "1144:  {",
          "1190:  if (start[2] == '-' || start[2] == '+') {",
          "1191:   digits--;",
          "",
          "[Removed Lines]",
          "1084: #line 1085 \"ext/standard/var_unserializer.c\"",
          "1085: yy65:",
          "1088:   if (yych != '+') goto yy18;",
          "1090:   if (yych <= '-') goto yy66;",
          "1092:   if (yych <= '9') goto yy67;",
          "1095: yy66:",
          "1097:  if (yych <= ',') {",
          "1098:   if (yych == '+') goto yy69;",
          "1099:   goto yy18;",
          "1100:  } else {",
          "1101:   if (yych <= '-') goto yy69;",
          "1102:   if (yych <= '/') goto yy18;",
          "1103:   if (yych >= ':') goto yy18;",
          "1104:  }",
          "1105: yy67:",
          "1106:  ++YYCURSOR;",
          "1107:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1108:  yych = *YYCURSOR;",
          "1109:  if (yych <= '/') goto yy18;",
          "1110:  if (yych <= '9') goto yy67;",
          "1111:  if (yych == ';') goto yy63;",
          "1113: yy69:",
          "1115:  if (yych <= '/') goto yy18;",
          "1116:  if (yych <= '9') goto yy67;",
          "1118: yy70:",
          "1119:  ++YYCURSOR;",
          "1120:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1121:  yych = *YYCURSOR;",
          "1122:  if (yych <= ';') {",
          "1123:   if (yych <= '/') goto yy18;",
          "1124:   if (yych <= '9') goto yy70;",
          "1125:   if (yych <= ':') goto yy18;",
          "1126:   goto yy63;",
          "1127:  } else {",
          "1128:   if (yych <= 'E') {",
          "1129:    if (yych <= 'D') goto yy18;",
          "1130:    goto yy65;",
          "1131:   } else {",
          "1132:    if (yych == 'e') goto yy65;",
          "1133:    goto yy18;",
          "1134:   }",
          "1135:  }",
          "1136: yy72:",
          "1137:  yych = *++YYCURSOR;",
          "1138:  if (yych != 'F') goto yy18;",
          "1139: yy73:",
          "1140:  yych = *++YYCURSOR;",
          "1141:  if (yych != ';') goto yy18;",
          "1143: #line 590 \"ext/standard/var_unserializer.re\"",
          "1146:  INIT_PZVAL(*rval);",
          "1148:  if (!strncmp(start + 2, \"NAN\", 3)) {",
          "1149:   ZVAL_DOUBLE(*rval, php_get_nan());",
          "1150:  } else if (!strncmp(start + 2, \"INF\", 3)) {",
          "1151:   ZVAL_DOUBLE(*rval, php_get_inf());",
          "1152:  } else if (!strncmp(start + 2, \"-INF\", 4)) {",
          "1153:   ZVAL_DOUBLE(*rval, -php_get_inf());",
          "1154:  }",
          "1156:  return 1;",
          "1157: }",
          "1158: #line 1159 \"ext/standard/var_unserializer.c\"",
          "1159: yy76:",
          "1160:  yych = *++YYCURSOR;",
          "1161:  if (yych == 'N') goto yy73;",
          "1162:  goto yy18;",
          "1163: yy77:",
          "1164:  yych = *++YYCURSOR;",
          "1165:  if (yych <= ',') {",
          "1166:   if (yych != '+') goto yy18;",
          "1167:  } else {",
          "1168:   if (yych <= '-') goto yy78;",
          "1169:   if (yych <= '/') goto yy18;",
          "1170:   if (yych <= '9') goto yy79;",
          "1171:   goto yy18;",
          "1172:  }",
          "1173: yy78:",
          "1174:  yych = *++YYCURSOR;",
          "1175:  if (yych <= '/') goto yy18;",
          "1176:  if (yych >= ':') goto yy18;",
          "1177: yy79:",
          "1178:  ++YYCURSOR;",
          "1179:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1180:  yych = *YYCURSOR;",
          "1181:  if (yych <= '/') goto yy18;",
          "1182:  if (yych <= '9') goto yy79;",
          "1183:  if (yych != ';') goto yy18;",
          "1184:  ++YYCURSOR;",
          "1185: #line 563 \"ext/standard/var_unserializer.re\"",
          "1186:  {",
          "1187: #if SIZEOF_LONG == 4",
          "1188:  int digits = YYCURSOR - start - 3;",
          "",
          "[Added Lines]",
          "983: #line 984 \"ext/standard/var_unserializer.c\"",
          "984: yy73:",
          "987:   if (yych == '+') goto yy88;",
          "988:   goto yy18;",
          "990:   if (yych <= '-') goto yy88;",
          "992:   if (yych <= '9') goto yy89;",
          "995: yy74:",
          "997:  if (yych == 'F') goto yy91;",
          "999: yy75:",
          "1001:  if (yych == 'N') goto yy91;",
          "1003: yy76:",
          "1005: #line 595 \"ext/standard/var_unserializer.re\"",
          "1007: #if SIZEOF_LONG == 4",
          "1008:  int digits = YYCURSOR - start - 3;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1209:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1210:  return 1;",
          "1211: }",
          "1249:  yych = *++YYCURSOR;",
          "1259:  ++YYCURSOR;",
          "1261:  {",
          "1262:  long id;",
          "",
          "[Removed Lines]",
          "1212: #line 1213 \"ext/standard/var_unserializer.c\"",
          "1213: yy83:",
          "1214:  yych = *++YYCURSOR;",
          "1215:  if (yych <= '/') goto yy18;",
          "1216:  if (yych >= '2') goto yy18;",
          "1217:  yych = *++YYCURSOR;",
          "1218:  if (yych != ';') goto yy18;",
          "1219:  ++YYCURSOR;",
          "1220: #line 556 \"ext/standard/var_unserializer.re\"",
          "1221:  {",
          "1223:  INIT_PZVAL(*rval);",
          "1224:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1225:  return 1;",
          "1226: }",
          "1227: #line 1228 \"ext/standard/var_unserializer.c\"",
          "1228: yy87:",
          "1229:  ++YYCURSOR;",
          "1230: #line 549 \"ext/standard/var_unserializer.re\"",
          "1231:  {",
          "1233:  INIT_PZVAL(*rval);",
          "1234:  ZVAL_NULL(*rval);",
          "1235:  return 1;",
          "1236: }",
          "1237: #line 1238 \"ext/standard/var_unserializer.c\"",
          "1238: yy89:",
          "1239:  yych = *++YYCURSOR;",
          "1240:  if (yych <= ',') {",
          "1241:   if (yych != '+') goto yy18;",
          "1242:  } else {",
          "1243:   if (yych <= '-') goto yy90;",
          "1244:   if (yych <= '/') goto yy18;",
          "1245:   if (yych <= '9') goto yy91;",
          "1246:   goto yy18;",
          "1247:  }",
          "1248: yy90:",
          "1250:  if (yych <= '/') goto yy18;",
          "1251:  if (yych >= ':') goto yy18;",
          "1252: yy91:",
          "1253:  ++YYCURSOR;",
          "1254:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1255:  yych = *YYCURSOR;",
          "1256:  if (yych <= '/') goto yy18;",
          "1257:  if (yych <= '9') goto yy91;",
          "1258:  if (yych != ';') goto yy18;",
          "1260: #line 526 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1032: #line 1033 \"ext/standard/var_unserializer.c\"",
          "1033: yy78:",
          "1035:  if (yych == '\"') goto yy92;",
          "1036:  goto yy18;",
          "1037: yy79:",
          "1039: #line 558 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1281:  return 1;",
          "1282: }",
          "1285:  yych = *++YYCURSOR;",
          "1286:  if (yych <= ',') {",
          "1288:  } else {",
          "1289:   if (yych <= '-') goto yy96;",
          "1290:   if (yych <= '/') goto yy18;",
          "1293:  }",
          "1299:  ++YYCURSOR;",
          "1300:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1301:  yych = *YYCURSOR;",
          "1302:  if (yych <= '/') goto yy18;",
          "1305:  ++YYCURSOR;",
          "1307:  {",
          "1315:   return 0;",
          "1316:  }",
          "1320:  }",
          "1325:  return 1;",
          "1326: }",
          "1328: }",
          "1332:  return 0;",
          "",
          "[Removed Lines]",
          "1283: #line 1284 \"ext/standard/var_unserializer.c\"",
          "1284: yy95:",
          "1287:   if (yych != '+') goto yy18;",
          "1291:   if (yych <= '9') goto yy97;",
          "1292:   goto yy18;",
          "1294: yy96:",
          "1295:  yych = *++YYCURSOR;",
          "1296:  if (yych <= '/') goto yy18;",
          "1297:  if (yych >= ':') goto yy18;",
          "1298: yy97:",
          "1303:  if (yych <= '9') goto yy97;",
          "1304:  if (yych != ';') goto yy18;",
          "1306: #line 505 \"ext/standard/var_unserializer.re\"",
          "1308:  long id;",
          "1311:  if (!var_hash) return 0;",
          "1313:  id = parse_iv(start + 2) - 1;",
          "1314:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "1318:  if (*rval != NULL) {",
          "1319:   var_push_dtor_no_addref(var_hash, rval);",
          "1322:  Z_ADDREF_PP(rval);",
          "1323:  Z_SET_ISREF_PP(rval);",
          "1327: #line 1328 \"ext/standard/var_unserializer.c\"",
          "1329: #line 879 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1062: #line 1063 \"ext/standard/var_unserializer.c\"",
          "1063: yy81:",
          "1064:  yych = *++YYCURSOR;",
          "1065:  if (yych == '\"') goto yy94;",
          "1066:  goto yy18;",
          "1067: yy82:",
          "1068:  ++YYCURSOR;",
          "1069: #line 749 \"ext/standard/var_unserializer.re\"",
          "1070:  {",
          "1071:  size_t len, len2, len3, maxlen;",
          "1072:  long elements;",
          "1073:  char *class_name;",
          "1074:  zend_class_entry *ce;",
          "1075:  zend_class_entry **pce;",
          "1076:  int incomplete_class = 0;",
          "1078:  int custom_object = 0;",
          "1080:  zval *user_func;",
          "1081:  zval *retval_ptr;",
          "1082:  zval **args[1];",
          "1083:  zval *arg_func_name;",
          "1085:     if (!var_hash) return 0;",
          "1086:  if (*start == 'C') {",
          "1087:   custom_object = 1;",
          "1088:  }",
          "1090:  INIT_PZVAL(*rval);",
          "1091:  len2 = len = parse_uiv(start + 2);",
          "1092:  maxlen = max - YYCURSOR;",
          "1093:  if (maxlen < len || len == 0) {",
          "1095:   return 0;",
          "1096:  }",
          "1098:  class_name = (char*)YYCURSOR;",
          "1100:  YYCURSOR += len;",
          "1102:  if (*(YYCURSOR) != '\"') {",
          "1104:   return 0;",
          "1105:  }",
          "1106:  if (*(YYCURSOR+1) != ':') {",
          "1108:   return 0;",
          "1109:  }",
          "1111:  len3 = strspn(class_name, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1112:  if (len3 != len)",
          "1113:  {",
          "1115:   return 0;",
          "1116:  }",
          "1118:  class_name = estrndup(class_name, len);",
          "1120:  do {",
          "1122:   BG(serialize_lock)++;",
          "1123:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "1124:    BG(serialize_lock)--;",
          "1125:    if (EG(exception)) {",
          "1126:     efree(class_name);",
          "1127:     return 0;",
          "1128:    }",
          "1129:    ce = *pce;",
          "1130:    break;",
          "1131:   }",
          "1132:   BG(serialize_lock)--;",
          "1134:   if (EG(exception)) {",
          "1135:    efree(class_name);",
          "1136:    return 0;",
          "1137:   }",
          "1140:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1141:    incomplete_class = 1;",
          "1142:    ce = PHP_IC_ENTRY;",
          "1143:    break;",
          "1144:   }",
          "1147:   MAKE_STD_ZVAL(user_func);",
          "1148:   ZVAL_STRING(user_func, PG(unserialize_callback_func), 1);",
          "1149:   args[0] = &arg_func_name;",
          "1150:   MAKE_STD_ZVAL(arg_func_name);",
          "1151:   ZVAL_STRING(arg_func_name, class_name, 1);",
          "1152:   BG(serialize_lock)++;",
          "1153:   if (call_user_function_ex(CG(function_table), NULL, user_func, &retval_ptr, 1, args, 0, NULL TSRMLS_CC) != SUCCESS) {",
          "1154:    BG(serialize_lock)--;",
          "1155:    if (EG(exception)) {",
          "1156:     efree(class_name);",
          "1157:     zval_ptr_dtor(&user_func);",
          "1158:     zval_ptr_dtor(&arg_func_name);",
          "1159:     return 0;",
          "1160:    }",
          "1161:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"defined (%s) but not found\", user_func->value.str.val);",
          "1162:    incomplete_class = 1;",
          "1163:    ce = PHP_IC_ENTRY;",
          "1164:    zval_ptr_dtor(&user_func);",
          "1165:    zval_ptr_dtor(&arg_func_name);",
          "1166:    break;",
          "1167:   }",
          "1168:   BG(serialize_lock)--;",
          "1169:   if (retval_ptr) {",
          "1170:    zval_ptr_dtor(&retval_ptr);",
          "1171:   }",
          "1172:   if (EG(exception)) {",
          "1173:    efree(class_name);",
          "1174:    zval_ptr_dtor(&user_func);",
          "1175:    zval_ptr_dtor(&arg_func_name);",
          "1176:    return 0;",
          "1177:   }",
          "1180:   BG(serialize_lock)++;",
          "1181:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "1182:    ce = *pce;",
          "1183:   } else {",
          "1184:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Function %s() hasn't defined the class it was called for\", user_func->value.str.val);",
          "1185:    incomplete_class = 1;",
          "1186:    ce = PHP_IC_ENTRY;",
          "1187:   }",
          "1188:   BG(serialize_lock)--;",
          "1190:   zval_ptr_dtor(&user_func);",
          "1191:   zval_ptr_dtor(&arg_func_name);",
          "1192:   break;",
          "1193:  } while (1);",
          "1197:  if (custom_object) {",
          "1198:   int ret;",
          "1200:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1202:   if (ret && incomplete_class) {",
          "1203:    php_store_class_name(*rval, class_name, len2);",
          "1204:   }",
          "1205:   efree(class_name);",
          "1206:   return ret;",
          "1207:  }",
          "1209:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1211:  if (elements < 0) {",
          "1212:     efree(class_name);",
          "1213:     return 0;",
          "1214:  }",
          "1216:  if (incomplete_class) {",
          "1217:   php_store_class_name(*rval, class_name, len2);",
          "1218:  }",
          "1219:  efree(class_name);",
          "1221:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1222: }",
          "1223: #line 1224 \"ext/standard/var_unserializer.c\"",
          "1224: yy84:",
          "1225:  ++YYCURSOR;",
          "1226: #line 680 \"ext/standard/var_unserializer.re\"",
          "1227:  {",
          "1228:  size_t len, maxlen;",
          "1229:  char *str;",
          "1231:  len = parse_uiv(start + 2);",
          "1232:  maxlen = max - YYCURSOR;",
          "1233:  if (maxlen < len) {",
          "1235:   return 0;",
          "1236:  }",
          "1238:  if ((str = unserialize_str(&YYCURSOR, &len, maxlen)) == NULL) {",
          "1239:   return 0;",
          "1240:  }",
          "1242:  if (*(YYCURSOR) != '\"') {",
          "1243:   efree(str);",
          "1245:   return 0;",
          "1246:  }",
          "1248:  if (*(YYCURSOR + 1) != ';') {",
          "1249:   efree(str);",
          "1251:   return 0;",
          "1252:  }",
          "1254:  YYCURSOR += 2;",
          "1257:  INIT_PZVAL(*rval);",
          "1258:  ZVAL_STRINGL(*rval, str, len, 0);",
          "1259:  return 1;",
          "1260: }",
          "1261: #line 1262 \"ext/standard/var_unserializer.c\"",
          "1262: yy86:",
          "1263:  ++YYCURSOR;",
          "1264: #line 715 \"ext/standard/var_unserializer.re\"",
          "1265:  {",
          "1266:  long elements = parse_iv(start + 2);",
          "1269:     if (!var_hash) return 0;",
          "1271:  if (elements < 0) {",
          "1272:   return 0;",
          "1273:  }",
          "1275:  INIT_PZVAL(*rval);",
          "1277:  array_init_size(*rval, elements);",
          "1279:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_PP(rval), elements, 0)) {",
          "1280:   return 0;",
          "1281:  }",
          "1283:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1284: }",
          "1285: #line 1286 \"ext/standard/var_unserializer.c\"",
          "1286: yy88:",
          "1289:   if (yych == '+') goto yy96;",
          "1290:   goto yy18;",
          "1294:   if (yych >= ':') goto yy18;",
          "1296: yy89:",
          "1301:  if (yych <= '9') goto yy89;",
          "1302:  if (yych == ';') goto yy71;",
          "1303:  goto yy18;",
          "1304: yy91:",
          "1305:  yych = *++YYCURSOR;",
          "1306:  if (yych == ';') goto yy97;",
          "1307:  goto yy18;",
          "1308: yy92:",
          "1310: #line 736 \"ext/standard/var_unserializer.re\"",
          "1312:  long elements;",
          "1313:     if (!var_hash) return 0;",
          "1315:  INIT_PZVAL(*rval);",
          "1317:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1318:  if (elements < 0) {",
          "1321:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1322: }",
          "1323: #line 1324 \"ext/standard/var_unserializer.c\"",
          "1324: yy94:",
          "1325:  ++YYCURSOR;",
          "1326: #line 647 \"ext/standard/var_unserializer.re\"",
          "1327:  {",
          "1328:  size_t len, maxlen;",
          "1329:  char *str;",
          "1331:  len = parse_uiv(start + 2);",
          "1332:  maxlen = max - YYCURSOR;",
          "1333:  if (maxlen < len) {",
          "1335:   return 0;",
          "1336:  }",
          "1338:  str = (char*)YYCURSOR;",
          "1340:  YYCURSOR += len;",
          "1342:  if (*(YYCURSOR) != '\"') {",
          "1344:   return 0;",
          "1345:  }",
          "1347:  if (*(YYCURSOR + 1) != ';') {",
          "1349:   return 0;",
          "1350:  }",
          "1352:  YYCURSOR += 2;",
          "1355:  INIT_PZVAL(*rval);",
          "1356:  ZVAL_STRINGL(*rval, str, len, 1);",
          "1357:  return 1;",
          "1358: }",
          "1359: #line 1360 \"ext/standard/var_unserializer.c\"",
          "1360: yy96:",
          "1361:  yych = *++YYCURSOR;",
          "1362:  if (yych <= '/') goto yy18;",
          "1363:  if (yych <= '9') goto yy89;",
          "1364:  goto yy18;",
          "1365: yy97:",
          "1366:  ++YYCURSOR;",
          "1367: #line 622 \"ext/standard/var_unserializer.re\"",
          "1368:  {",
          "1370:  INIT_PZVAL(*rval);",
          "1372:  if (!strncmp(start + 2, \"NAN\", 3)) {",
          "1373:   ZVAL_DOUBLE(*rval, php_get_nan());",
          "1374:  } else if (!strncmp(start + 2, \"INF\", 3)) {",
          "1375:   ZVAL_DOUBLE(*rval, php_get_inf());",
          "1376:  } else if (!strncmp(start + 2, \"-INF\", 4)) {",
          "1377:   ZVAL_DOUBLE(*rval, -php_get_inf());",
          "1382: #line 1383 \"ext/standard/var_unserializer.c\"",
          "1384: #line 911 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: #define VAR_ENTRIES_MAX 1024",
          "27: #define VAR_ENTRIES_DBG 0",
          "29: typedef struct {",
          "30:  zval *data[VAR_ENTRIES_MAX];",
          "31:  long used_slots;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29: #define VAR_WAKEUP_FLAG 1",
          "30: #define WITH_WAKEUP_FLAG(zv_ptr) ((zval *) ((zend_uintptr_t) zv_ptr | VAR_WAKEUP_FLAG))",
          "31: #define WITHOUT_WAKEUP_FLAG(zv_ptr) ((zval *) ((zend_uintptr_t) zv_ptr & ~VAR_WAKEUP_FLAG))",
          "32: #define HAS_WAKEUP_FLAG(zv_ptr) ((zend_uintptr_t) zv_ptr & VAR_WAKEUP_FLAG)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "56:  var_hash->data[var_hash->used_slots++] = *rval;",
          "57: }",
          "60: {",
          "61:  var_entries *var_hash;",
          "63:  if (!var_hashx || !*var_hashx) {",
          "65:  }",
          "67:  var_hash = (*var_hashx)->last_dtor;",
          "",
          "[Removed Lines]",
          "59: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval **rval)",
          "64:   return;",
          "",
          "[Added Lines]",
          "64: static inline zval **get_var_push_dtor_slot(php_unserialize_data_t *var_hashx)",
          "69:   return NULL;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "83:   (*var_hashx)->last_dtor = var_hash;",
          "84:  }",
          "86:  Z_ADDREF_PP(rval);",
          "88: }",
          "90: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval **rval)",
          "",
          "[Removed Lines]",
          "87:  var_hash->data[var_hash->used_slots++] = *rval;",
          "",
          "[Added Lines]",
          "91:  return &var_hash->data[var_hash->used_slots++];",
          "92: }",
          "94: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval **rval)",
          "95: {",
          "96:  zval **slot = get_var_push_dtor_slot(var_hashx);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "162:  void *next;",
          "163:  long i;",
          "164:  var_entries *var_hash = (*var_hashx)->first;",
          "165: #if VAR_ENTRIES_DBG",
          "166:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "167: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "176:  zend_bool wakeup_failed = 0;",
          "177:  TSRMLS_FETCH();",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "177:  while (var_hash) {",
          "178:   for (i = 0; i < var_hash->used_slots; i++) {",
          "179: #if VAR_ENTRIES_DBG",
          "180:     fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_hash->data[i], Z_REFCOUNT_P(var_hash->data[i]));",
          "181: #endif",
          "183:   }",
          "184:   next = var_hash->next;",
          "185:   efree(var_hash);",
          "",
          "[Removed Lines]",
          "182:    zval_ptr_dtor(&var_hash->data[i]);",
          "",
          "[Added Lines]",
          "193:    zval *zv = var_hash->data[i];",
          "198:    if (HAS_WAKEUP_FLAG(zv)) {",
          "199:     zv = WITHOUT_WAKEUP_FLAG(zv);",
          "200:     if (!wakeup_failed) {",
          "201:      zval *retval_ptr = NULL;",
          "202:      zval wakeup_name;",
          "203:      INIT_PZVAL(&wakeup_name);",
          "204:      ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1, 0);",
          "206:      BG(serialize_lock)++;",
          "207:      if (call_user_function_ex(CG(function_table), &zv, &wakeup_name, &retval_ptr, 0, 0, 1, NULL TSRMLS_CC) == FAILURE || retval_ptr == NULL) {",
          "208:       wakeup_failed = 1;",
          "209:       zend_object_store_ctor_failed(zv TSRMLS_CC);",
          "210:      }",
          "211:      BG(serialize_lock)--;",
          "213:      if (retval_ptr) {",
          "214:       zval_ptr_dtor(&retval_ptr);",
          "215:      }",
          "216:     } else {",
          "217:      zend_object_store_ctor_failed(zv TSRMLS_CC);",
          "218:     }",
          "219:    }",
          "221:    zval_ptr_dtor(&zv);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "435: #endif",
          "436: static inline int object_common2(UNSERIALIZE_PARAMETER, long elements)",
          "437: {",
          "441:  if (Z_TYPE_PP(rval) != IS_OBJECT) {",
          "442:   return 0;",
          "443:  }",
          "445:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_OBJPROP_PP(rval), elements, 1)) {",
          "451:      ZVAL_NULL(*rval);",
          "452:   return 0;",
          "453:  }",
          "",
          "[Removed Lines]",
          "438:  zval *retval_ptr = NULL;",
          "439:  zval fname;",
          "447:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
          "448:         zend_hash_clean(Z_OBJPROP_PP(rval));",
          "449:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
          "450:      }",
          "",
          "[Added Lines]",
          "483:   if (Z_TYPE_PP(rval) == IS_OBJECT) {",
          "484:    zend_hash_clean(Z_OBJPROP_PP(rval));",
          "485:    zend_object_store_ctor_failed(*rval TSRMLS_CC);",
          "486:   }",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "457:     }",
          "459:  if (Z_OBJCE_PP(rval) != PHP_IC_ENTRY &&",
          "474:  }",
          "476:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "",
          "[Removed Lines]",
          "460:   zend_hash_exists(&Z_OBJCE_PP(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\"))) {",
          "461:   INIT_PZVAL(&fname);",
          "462:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1, 0);",
          "463:   BG(serialize_lock)++;",
          "464:   call_user_function_ex(CG(function_table), rval, &fname, &retval_ptr, 0, 0, 1, NULL TSRMLS_CC);",
          "465:   BG(serialize_lock)--;",
          "466:  }",
          "468:  if (retval_ptr) {",
          "469:   zval_ptr_dtor(&retval_ptr);",
          "470:  }",
          "472:  if (EG(exception)) {",
          "473:   return 0;",
          "",
          "[Added Lines]",
          "496:   zend_hash_exists(&Z_OBJCE_PP(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\"))",
          "497:  ) {",
          "499:   zval **slot = get_var_push_dtor_slot(var_hash);",
          "500:   zval *zv = *rval;",
          "501:   Z_ADDREF_P(zv);",
          "502:   if (PZVAL_IS_REF(zv)) {",
          "503:    SEPARATE_ZVAL(&zv);",
          "504:   }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9b1a224d4e994219a6ef1d1d8fdcc1b0598ba3ab",
      "candidate_info": {
        "commit_hash": "9b1a224d4e994219a6ef1d1d8fdcc1b0598ba3ab",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/9b1a224d4e994219a6ef1d1d8fdcc1b0598ba3ab",
        "files": [
          "Zend/zend_API.c",
          "ext/exif/exif.c",
          "ext/gmp/gmp.c",
          "ext/gmp/tests/bug70284.phpt",
          "ext/hash/hash_haval.c",
          "ext/hash/tests/bug70312.phpt",
          "ext/hash/tests/hash_file_basic1.phpt",
          "ext/hash/tests/hash_hmac_basic.phpt",
          "ext/hash/tests/hash_hmac_file_basic.phpt",
          "ext/pcre/php_pcre.c",
          "ext/pcre/tests/bug70345.phpt",
          "ext/session/session.c",
          "ext/session/tests/session_decode_error2.phpt",
          "ext/soap/soap.c",
          "ext/soap/tests/bug70388.phpt",
          "ext/spl/spl_dllist.c",
          "ext/spl/tests/bug70155.phpt",
          "ext/spl/tests/bug70365.phpt",
          "ext/spl/tests/bug70366.phpt",
          "ext/standard/tests/serialize/bug70172.phpt",
          "ext/standard/tests/serialize/bug70172_2.phpt",
          "ext/standard/tests/serialize/bug70219.phpt",
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "ext/xsl/xsltprocessor.c",
          "ext/zip/php_zip.c",
          "ext/zip/tests/bug70350.phpt"
        ],
        "message": "Merge branch 'PHP-5.6'\n\n* PHP-5.6: (21 commits)\n  fix unit tests\n  update NEWS\n  add NEWS for fixes\n  Improve fix for #70172\n  Fix bug #70312 - HAVAL gives wrong hashes in specific cases\n  fix test\n  add test\n  Fix bug #70366 - use-after-free vulnerability in unserialize() with SplDoublyLinkedList\n  Fix bug #70365 - use-after-free vulnerability in unserialize() with SplObjectStorage\n  Fix bug #70172 - Use After Free Vulnerability in unserialize()\n  Fix bug #70388 - SOAP serialize_function_call() type confusion\n  Fixed bug #70350: ZipArchive::extractTo allows for directory traversal when creating directories\n  Improve fix for #70385\n  Fix bug #70345 (Multiple vulnerabilities related to PCRE functions)\n  Fix bug #70385 (Buffer over-read in exif_read_data with TIFF IFD tag byte value of 32 bytes)\n  Fix bug #70219 (Use after free vulnerability in session deserializer)\n  Fix bug ##70284 (Use after free vulnerability in unserialize() with GMP)\n  Fix for bug #69782\n  Add CVE IDs asigned (post release) to PHP 5.4.43\n  Add CVE IDs asigned to #69085 (PHP 5.4.39)\n  ...\n\nConflicts:\n\text/exif/exif.c\n\text/gmp/gmp.c\n\text/pcre/php_pcre.c\n\text/session/session.c\n\text/session/tests/session_decode_variation3.phpt\n\text/soap/soap.c\n\text/spl/spl_observer.c\n\text/standard/var.c\n\text/standard/var_unserializer.c\n\text/standard/var_unserializer.re\n\text/xsl/xsltprocessor.c",
        "before_after_code_files": [
          "Zend/zend_API.c||Zend/zend_API.c",
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/gmp/gmp.c||ext/gmp/gmp.c",
          "ext/gmp/tests/bug70284.phpt||ext/gmp/tests/bug70284.phpt",
          "ext/hash/hash_haval.c||ext/hash/hash_haval.c",
          "ext/hash/tests/bug70312.phpt||ext/hash/tests/bug70312.phpt",
          "ext/hash/tests/hash_file_basic1.phpt||ext/hash/tests/hash_file_basic1.phpt",
          "ext/hash/tests/hash_hmac_basic.phpt||ext/hash/tests/hash_hmac_basic.phpt",
          "ext/hash/tests/hash_hmac_file_basic.phpt||ext/hash/tests/hash_hmac_file_basic.phpt",
          "ext/pcre/php_pcre.c||ext/pcre/php_pcre.c",
          "ext/pcre/tests/bug70345.phpt||ext/pcre/tests/bug70345.phpt",
          "ext/session/session.c||ext/session/session.c",
          "ext/session/tests/session_decode_error2.phpt||ext/session/tests/session_decode_error2.phpt",
          "ext/soap/soap.c||ext/soap/soap.c",
          "ext/soap/tests/bug70388.phpt||ext/soap/tests/bug70388.phpt",
          "ext/spl/spl_dllist.c||ext/spl/spl_dllist.c",
          "ext/spl/tests/bug70155.phpt||ext/spl/tests/bug70155.phpt",
          "ext/spl/tests/bug70365.phpt||ext/spl/tests/bug70365.phpt",
          "ext/spl/tests/bug70366.phpt||ext/spl/tests/bug70366.phpt",
          "ext/standard/tests/serialize/bug70172.phpt||ext/standard/tests/serialize/bug70172.phpt",
          "ext/standard/tests/serialize/bug70172_2.phpt||ext/standard/tests/serialize/bug70172_2.phpt",
          "ext/standard/tests/serialize/bug70219.phpt||ext/standard/tests/serialize/bug70219.phpt",
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "ext/xsl/xsltprocessor.c||ext/xsl/xsltprocessor.c",
          "ext/zip/php_zip.c||ext/zip/php_zip.c",
          "ext/zip/tests/bug70350.phpt||ext/zip/tests/bug70350.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/zend_API.c||Zend/zend_API.c": [
          "File: Zend/zend_API.c -> Zend/zend_API.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1243: {",
          "1244:     zval *prop, tmp;",
          "1245:     zend_string *key;",
          "1246:     zend_property_info *property_info;",
          "1260:    }",
          "1261:   } else {",
          "1262:    if (!object->properties) {",
          "1263:     rebuild_object_properties(object);",
          "1264:    }",
          "1266:    zval_add_ref(prop);",
          "1267:   }",
          "1268:  } ZEND_HASH_FOREACH_END();",
          "",
          "[Removed Lines]",
          "1248:  ZEND_HASH_FOREACH_STR_KEY_VAL(properties, key, prop) {",
          "1249:   property_info = zend_get_property_info(object->ce, key, 1);",
          "1250:   if (property_info != ZEND_WRONG_PROPERTY_INFO &&",
          "1251:       property_info &&",
          "1252:       (property_info->flags & ZEND_ACC_STATIC) == 0) {",
          "1253:    zval *slot = OBJ_PROP(object, property_info->offset);",
          "1254:    zval_ptr_dtor(slot);",
          "1255:    ZVAL_COPY_VALUE(slot, prop);",
          "1256:    zval_add_ref(slot);",
          "1257:    if (object->properties) {",
          "1258:     ZVAL_INDIRECT(&tmp, slot);",
          "1259:     zend_hash_update(object->properties, key, &tmp);",
          "1265:    prop = zend_hash_update(object->properties, key, prop);",
          "",
          "[Added Lines]",
          "1246:     zend_long h;",
          "1249:     ZEND_HASH_FOREACH_KEY_VAL(properties, h, key, prop) {",
          "1250:   if(key) {",
          "1251:    property_info = zend_get_property_info(object->ce, key, 1);",
          "1252:    if (property_info != ZEND_WRONG_PROPERTY_INFO &&",
          "1253:     property_info &&",
          "1254:     (property_info->flags & ZEND_ACC_STATIC) == 0) {",
          "1255:     zval *slot = OBJ_PROP(object, property_info->offset);",
          "1256:     zval_ptr_dtor(slot);",
          "1257:     ZVAL_COPY_VALUE(slot, prop);",
          "1258:     zval_add_ref(slot);",
          "1259:     if (object->properties) {",
          "1260:      ZVAL_INDIRECT(&tmp, slot);",
          "1261:      zend_hash_update(object->properties, key, &tmp);",
          "1262:     }",
          "1263:    } else {",
          "1264:     if (!object->properties) {",
          "1265:      rebuild_object_properties(object);",
          "1266:     }",
          "1267:     prop = zend_hash_update(object->properties, key, prop);",
          "1268:     zval_add_ref(prop);",
          "1274:    prop = zend_hash_index_update(object->properties, h, prop);",
          "",
          "---------------"
        ],
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2945:      if (length<byte_count-1) {",
          "2947:       ImageInfo->CopyrightPhotographer  = estrdup(value_ptr);",
          "2949:       spprintf(&ImageInfo->Copyright, 0, \"%s, %s\", value_ptr, value_ptr+length+1);",
          "2953:      } else {",
          "2955:      }",
          "2956:     }",
          "2957:     break;",
          "",
          "[Removed Lines]",
          "2948:       ImageInfo->CopyrightEditor        = estrdup(value_ptr+length+1);",
          "2954:       ImageInfo->Copyright = estrdup(value_ptr);",
          "",
          "[Added Lines]",
          "2948:       ImageInfo->CopyrightEditor        = estrndup(value_ptr+length+1, byte_count-length-1);",
          "2954:       ImageInfo->Copyright = estrndup(value_ptr, byte_count);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3042:     break;",
          "3044:    case TAG_MAKE:",
          "3046:     break;",
          "3047:    case TAG_MODEL:",
          "3049:     break;",
          "3051:    case TAG_MAKER_NOTE:",
          "",
          "[Removed Lines]",
          "3045:     ImageInfo->make = estrdup(value_ptr);",
          "3048:     ImageInfo->model = estrdup(value_ptr);",
          "",
          "[Added Lines]",
          "3045:     ImageInfo->make = estrndup(value_ptr, byte_count);",
          "3048:     ImageInfo->model = estrndup(value_ptr, byte_count);",
          "",
          "---------------"
        ],
        "ext/gmp/gmp.c||ext/gmp/gmp.c": [
          "File: ext/gmp/gmp.c -> ext/gmp/gmp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "585: {",
          "586:  mpz_ptr gmpnum;",
          "587:  const unsigned char *p, *max;",
          "589:  int retval = FAILURE;",
          "590:  php_unserialize_data_t unserialize_data = (php_unserialize_data_t) data;",
          "593:  PHP_VAR_UNSERIALIZE_INIT(unserialize_data);",
          "594:  gmp_create(object, &gmpnum);",
          "596:  p = buf;",
          "597:  max = buf + buf_len;",
          "602:  ) {",
          "603:   zend_throw_exception(NULL, \"Could not unserialize number\", 0);",
          "604:   goto exit;",
          "605:  }",
          "611:  ) {",
          "612:   zend_throw_exception(NULL, \"Could not unserialize properties\", 0);",
          "613:   goto exit;",
          "614:  }",
          "617:   zend_hash_copy(",
          "619:    (copy_ctor_func_t) zval_add_ref",
          "620:   );",
          "621:  }",
          "623:  retval = SUCCESS;",
          "624: exit:",
          "626:  PHP_VAR_UNSERIALIZE_DESTROY(unserialize_data);",
          "627:  return retval;",
          "628: }",
          "",
          "[Removed Lines]",
          "588:  zval zv;",
          "592:  ZVAL_UNDEF(&zv);",
          "599:  if (!php_var_unserialize(&zv, &p, max, &unserialize_data)",
          "600:   || Z_TYPE(zv) != IS_STRING",
          "601:   || convert_to_gmp(gmpnum, &zv, 10) == FAILURE",
          "606:  zval_dtor(&zv);",
          "607:  ZVAL_UNDEF(&zv);",
          "609:  if (!php_var_unserialize(&zv, &p, max, &unserialize_data)",
          "610:   || Z_TYPE(zv) != IS_ARRAY",
          "616:  if (zend_hash_num_elements(Z_ARRVAL(zv)) != 0) {",
          "618:    zend_std_get_properties(object), Z_ARRVAL(zv),",
          "625:  zval_dtor(&zv);",
          "",
          "[Added Lines]",
          "588:  zval *zv;",
          "598:  zv = var_tmp_var(&unserialize_data);",
          "599:  if (!php_var_unserialize(zv, &p, max, &unserialize_data)",
          "600:   || Z_TYPE_P(zv) != IS_STRING",
          "601:   || convert_to_gmp(gmpnum, zv, 10) == FAILURE",
          "607:  zv = var_tmp_var(&unserialize_data);",
          "608:  if (!php_var_unserialize(zv, &p, max, &unserialize_data)",
          "609:   || Z_TYPE_P(zv) != IS_ARRAY",
          "615:  if (zend_hash_num_elements(Z_ARRVAL_P(zv)) != 0) {",
          "617:    zend_std_get_properties(object), Z_ARRVAL_P(zv),",
          "",
          "---------------"
        ],
        "ext/gmp/tests/bug70284.phpt||ext/gmp/tests/bug70284.phpt": [
          "File: ext/gmp/tests/bug70284.phpt -> ext/gmp/tests/bug70284.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70284 (Use after free vulnerability in unserialize() with GMP)",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded(\"gmp\")) print \"skip\"; ?>",
          "5: --FILE--",
          "6: <?php",
          "8: $inner = 'r:2;a:1:{i:0;a:1:{i:0;r:4;}}';",
          "9: $exploit = 'a:2:{i:0;s:1:\"1\";i:1;C:3:\"GMP\":'.strlen($inner).':{'.$inner.'}}';",
          "11: $data = unserialize($exploit);",
          "13: $fakezval = ptr2str(1122334455);",
          "14: $fakezval .= ptr2str(0);",
          "15: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "16: $fakezval .= \"\\x01\";",
          "17: $fakezval .= \"\\x00\";",
          "18: $fakezval .= \"\\x00\\x00\";",
          "20: for ($i = 0; $i < 5; $i++) {",
          "21:  $v[$i] = $fakezval.$i;",
          "22: }",
          "24: var_dump($data);",
          "26: function ptr2str($ptr)",
          "27: {",
          "28: $out = '';",
          "29:  for ($i = 0; $i < 8; $i++) {",
          "30:   $out .= chr($ptr & 0xff);",
          "31:   $ptr >>= 8;",
          "32:  }",
          "33:  return $out;",
          "34: }",
          "35: ?>",
          "36: --EXPECTF--",
          "37: array(2) {",
          "38:   [0]=>",
          "39:   string(1) \"1\"",
          "40:   [1]=>",
          "41:   object(GMP)#%d (2) {",
          "42:     [0]=>",
          "43:     array(1) {",
          "44:       [0]=>",
          "45:       string(1) \"1\"",
          "46:     }",
          "47:     [\"num\"]=>",
          "48:     string(1) \"1\"",
          "49:   }",
          "50: }",
          "",
          "---------------"
        ],
        "ext/hash/hash_haval.c||ext/hash/hash_haval.c": [
          "File: ext/hash/hash_haval.c -> ext/hash/hash_haval.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "341:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "339:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "339:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "394:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "395:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "393:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "393:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "448:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "449:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "447:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "447:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "488:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "489:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "487:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "487:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "529:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "530:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "528:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "528:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------"
        ],
        "ext/hash/tests/bug70312.phpt||ext/hash/tests/bug70312.phpt": [
          "File: ext/hash/tests/bug70312.phpt -> ext/hash/tests/bug70312.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70312 HAVAL gives wrong hashes in specific cases",
          "3: --SKIPIF--",
          "4: <?php if(!extension_loaded(\"hash\")) print \"skip\"; ?>",
          "5: --FILE--",
          "6: <?php",
          "7: var_dump(hash('haval128,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "8: var_dump(hash('haval160,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "9: var_dump(hash('haval192,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "10: var_dump(hash('haval224,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "11: var_dump(hash('haval256,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "12: ?>",
          "13: --EXPECTF--",
          "14: string(32) \"f3f0d23819b87228b4b70ee350afaa9d\"",
          "15: string(40) \"aded6485e137f11d7292212ba3fa961714df0564\"",
          "16: string(48) \"e53da2b16269fe732e9a898a96707a9f28404d7333b02286\"",
          "17: string(56) \"c574fb307f0817b514b9bb2e7c4bfaffb7ad667aca3c8b523fefcf10\"",
          "18: string(64) \"fb73c19300b14d5cb393d929bf005e6c2d459a4c9c009e9813af1d2d3637ee8f\"",
          "",
          "---------------"
        ],
        "ext/hash/tests/hash_file_basic1.phpt||ext/hash/tests/hash_file_basic1.phpt": [
          "File: ext/hash/tests/hash_file_basic1.phpt -> ext/hash/tests/hash_file_basic1.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "64: adler32: ff87222e",
          "65: crc32: 61664d33",
          "66: gost: d9e65f0c0c2ef944e4f8a01f4a46365c4f33a2853756878182a7f03e1490a4cd",
          "68: md2: 70f791c0d8fa9edd7d08e32fcba8c354",
          "69: md4: a9d034b16bb290c57a645afd6f14cd3b",
          "70: md5: 704bf818448f5bbb94061332d2c889aa",
          "",
          "[Removed Lines]",
          "67: haval128,3: 8bb81269aca8b7f87829020d76a4e841",
          "",
          "[Added Lines]",
          "67: haval128,3: c25962b13383c3ed9f13817c8f2ae7d6",
          "",
          "---------------"
        ],
        "ext/hash/tests/hash_hmac_basic.phpt||ext/hash/tests/hash_hmac_basic.phpt": [
          "File: ext/hash/tests/hash_hmac_basic.phpt -> ext/hash/tests/hash_hmac_basic.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "45: adler32: 12c803f7",
          "46: crc32: 96859101",
          "47: gost: a4a3c80bdf3f8665bf07376a34dc9c1b11af7c813f4928f62e39f0c0dc564dad",
          "49: md2: 6d111dab563025e4cb5f4425c991fa12",
          "50: md4: 10cdbfe843000c623f8b8da0d5d20b0b",
          "51: md5: 2a632783e2812cf23de100d7d6a463ae",
          "",
          "[Removed Lines]",
          "48: haval128,3: 82cd0f4bd36729b5c80c33efa8c13ac5",
          "",
          "[Added Lines]",
          "48: haval128,3: 4d1318607f0406bd1b7bd50907772672",
          "",
          "---------------"
        ],
        "ext/hash/tests/hash_hmac_file_basic.phpt||ext/hash/tests/hash_hmac_file_basic.phpt": [
          "File: ext/hash/tests/hash_hmac_file_basic.phpt -> ext/hash/tests/hash_hmac_file_basic.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "73: adler32: 0f8c02f9",
          "74: crc32: f2a60b9c",
          "75: gost: 94c39a40d5db852a8dc3d24e37eebf2d53e3d711457c59cd02b614f792a9d918",
          "77: md2: a685475e600314bb549ab4f33c3b27cb",
          "78: md4: cbc6bff781f48f57378d3effa27553e4",
          "79: md5: 8bddf39dd1c566c27acc7fa85ec36acf",
          "",
          "[Removed Lines]",
          "76: haval128,3: e8fcff647f1a675acb429130fb94a17e",
          "",
          "[Added Lines]",
          "76: haval128,3: f1cea637451097d790354a86de3f54a3",
          "",
          "---------------"
        ],
        "ext/pcre/php_pcre.c||ext/pcre/php_pcre.c": [
          "File: ext/pcre/php_pcre.c -> ext/pcre/php_pcre.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "759:    if (subpats != NULL) {",
          "762:      if (subpat_names) {",
          "763:       efree(subpat_names);",
          "764:      }",
          "",
          "[Removed Lines]",
          "761:     if (pcre_get_substring_list(subject, offsets, count, &stringlist) < 0) {",
          "",
          "[Added Lines]",
          "761:     if ((offsets[1] - offsets[0] < 0) || pcre_get_substring_list(subject, offsets, count, &stringlist) < 0) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1177:   piece = subject + start_offset;",
          "1181:    if (UNEXPECTED(replace_count)) {",
          "1182:     ++*replace_count;",
          "1183:    }",
          "",
          "[Removed Lines]",
          "1180:   if (EXPECTED(count > 0 && limit)) {",
          "",
          "[Added Lines]",
          "1180:   if (EXPECTED(count > 0 && (offsets[1] - offsets[0] >= 0) && limit)) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1799:   }",
          "1803:    if (!no_empty || &subject[offsets[0]] != last_match) {",
          "1805:     if (offset_capture) {",
          "",
          "[Removed Lines]",
          "1802:   if (count > 0) {",
          "",
          "[Added Lines]",
          "1802:   if (count > 0 && (offsets[1] - offsets[0] >= 0)) {",
          "",
          "---------------"
        ],
        "ext/pcre/tests/bug70345.phpt||ext/pcre/tests/bug70345.phpt": [
          "File: ext/pcre/tests/bug70345.phpt -> ext/pcre/tests/bug70345.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70345 (Multiple vulnerabilities related to PCRE functions)",
          "3: --FILE--",
          "4: <?php",
          "5: $regex = '/(?=xyz\\K)/';",
          "6: $subject = \"aaaaxyzaaaa\";",
          "8: $v = preg_split($regex, $subject);",
          "9: print_r($v);",
          "11: $regex = '/(a(?=xyz\\K))/';",
          "12: $subject = \"aaaaxyzaaaa\";",
          "13: preg_match($regex, $subject, $matches);",
          "15: var_dump($matches);",
          "16: --EXPECTF--",
          "17: Array",
          "18: (",
          "19:     [0] => aaaaxyzaaaa",
          "20: )",
          "22: Warning: preg_match(): Get subpatterns list failed in %s on line %d",
          "23: array(0) {",
          "24: }",
          "",
          "---------------"
        ],
        "ext/session/session.c||ext/session/session.c": [
          "File: ext/session/session.c -> ext/session/session.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "65: static int php_session_rfc1867_callback(unsigned int event, void *event_data, void **extra);",
          "66: static int (*php_session_rfc1867_orig_callback)(unsigned int event, void *event_data, void **extra);",
          "69: zend_class_entry *php_session_class_entry;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "67: static void php_session_track_init(void);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "139: {",
          "140:  int retval = SUCCESS;",
          "142:  if (PS(session_status) != php_session_active) {",
          "143:   php_error_docref(NULL, E_WARNING, \"Trying to destroy uninitialized session\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "142:  zend_string *var_name;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "235:  }",
          "236:  if (PS(serializer)->decode(ZSTR_VAL(data), ZSTR_LEN(data)) == FAILURE) {",
          "237:   php_session_destroy();",
          "238:   php_error_docref(NULL, E_WARNING, \"Failed to decode session object. Session has been destroyed\");",
          "239:   return FAILURE;",
          "240:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "240:   php_session_track_init();",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "952:     var_replace(&var_hash, &current, zv);",
          "953:    } else {",
          "954:     zval_ptr_dtor(&current);",
          "955:    }",
          "956:   }",
          "957:   PS_ADD_VARL(name);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "958:     PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "959:     return FAILURE;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1042:     var_replace(&var_hash, &current, zv);",
          "1043:    } else {",
          "1044:     zval_ptr_dtor(&current);",
          "1045:    }",
          "1046:   }",
          "1047:   PS_ADD_VARL(name);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1050:     PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1051:     return FAILURE;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2169:  }",
          "2171:  if (php_session_decode(str) == FAILURE) {",
          "2174:  }",
          "2175:  RETURN_TRUE;",
          "2176: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2179:   RETURN_FALSE;",
          "",
          "---------------"
        ],
        "ext/session/tests/session_decode_error2.phpt||ext/session/tests/session_decode_error2.phpt": [
          "File: ext/session/tests/session_decode_error2.phpt -> ext/session/tests/session_decode_error2.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: var_dump(session_start());",
          "20: for($index = 0; $index < strlen($data); $index++) {",
          "21:     echo \"\\n-- Iteration $index --\\n\";",
          "22:     $encoded = substr($data, 0, $index);",
          "23:     var_dump(session_decode($encoded));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21:  if(session_status() != PHP_SESSION_ACTIVE) { session_start(); }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "53: }",
          "55: -- Iteration 4 --",
          "60: }",
          "62: -- Iteration 5 --",
          "67: }",
          "69: -- Iteration 6 --",
          "74: }",
          "76: -- Iteration 7 --",
          "81: }",
          "83: -- Iteration 8 --",
          "88: }",
          "90: -- Iteration 9 --",
          "95: }",
          "97: -- Iteration 10 --",
          "102: }",
          "104: -- Iteration 11 --",
          "109: }",
          "111: -- Iteration 12 --",
          "116: }",
          "118: -- Iteration 13 --",
          "123: }",
          "125: -- Iteration 14 --",
          "130: }",
          "132: -- Iteration 15 --",
          "137: }",
          "139: -- Iteration 16 --",
          "144: }",
          "146: -- Iteration 17 --",
          "151: }",
          "153: -- Iteration 18 --",
          "158: }",
          "160: -- Iteration 19 --",
          "165: }",
          "167: -- Iteration 20 --",
          "172: }",
          "174: -- Iteration 21 --",
          "179: }",
          "181: -- Iteration 22 --",
          "186: }",
          "188: -- Iteration 23 --",
          "193: }",
          "195: -- Iteration 24 --",
          "200: }",
          "202: -- Iteration 25 --",
          "207: }",
          "209: -- Iteration 26 --",
          "214: }",
          "216: -- Iteration 27 --",
          "221: }",
          "223: -- Iteration 28 --",
          "228: }",
          "230: -- Iteration 29 --",
          "235: }",
          "237: -- Iteration 30 --",
          "242: }",
          "244: -- Iteration 31 --",
          "249: }",
          "251: -- Iteration 32 --",
          "256: }",
          "258: -- Iteration 33 --",
          "263: }",
          "265: -- Iteration 34 --",
          "",
          "[Removed Lines]",
          "56: bool(true)",
          "57: array(1) {",
          "58:   [\"foo\"]=>",
          "59:   NULL",
          "63: bool(true)",
          "64: array(1) {",
          "65:   [\"foo\"]=>",
          "66:   NULL",
          "70: bool(true)",
          "71: array(1) {",
          "72:   [\"foo\"]=>",
          "73:   NULL",
          "77: bool(true)",
          "78: array(1) {",
          "79:   [\"foo\"]=>",
          "80:   NULL",
          "84: bool(true)",
          "85: array(1) {",
          "86:   [\"foo\"]=>",
          "87:   NULL",
          "91: bool(true)",
          "92: array(1) {",
          "93:   [\"foo\"]=>",
          "94:   NULL",
          "98: bool(true)",
          "99: array(1) {",
          "100:   [\"foo\"]=>",
          "101:   NULL",
          "105: bool(true)",
          "106: array(1) {",
          "107:   [\"foo\"]=>",
          "108:   NULL",
          "112: bool(true)",
          "113: array(1) {",
          "114:   [\"foo\"]=>",
          "115:   NULL",
          "119: bool(true)",
          "120: array(1) {",
          "121:   [\"foo\"]=>",
          "122:   NULL",
          "126: bool(true)",
          "127: array(1) {",
          "128:   [\"foo\"]=>",
          "129:   NULL",
          "133: bool(true)",
          "134: array(1) {",
          "135:   [\"foo\"]=>",
          "136:   NULL",
          "140: bool(true)",
          "141: array(1) {",
          "142:   [\"foo\"]=>",
          "143:   NULL",
          "147: bool(true)",
          "148: array(1) {",
          "149:   [\"foo\"]=>",
          "150:   NULL",
          "154: bool(true)",
          "155: array(1) {",
          "156:   [\"foo\"]=>",
          "157:   NULL",
          "161: bool(true)",
          "162: array(1) {",
          "163:   [\"foo\"]=>",
          "164:   NULL",
          "168: bool(true)",
          "169: array(1) {",
          "170:   [\"foo\"]=>",
          "171:   NULL",
          "175: bool(true)",
          "176: array(1) {",
          "177:   [\"foo\"]=>",
          "178:   NULL",
          "182: bool(true)",
          "183: array(1) {",
          "184:   [\"foo\"]=>",
          "185:   NULL",
          "189: bool(true)",
          "190: array(1) {",
          "191:   [\"foo\"]=>",
          "192:   NULL",
          "196: bool(true)",
          "197: array(1) {",
          "198:   [\"foo\"]=>",
          "199:   NULL",
          "203: bool(true)",
          "204: array(1) {",
          "205:   [\"foo\"]=>",
          "206:   NULL",
          "210: bool(true)",
          "211: array(1) {",
          "212:   [\"foo\"]=>",
          "213:   NULL",
          "217: bool(true)",
          "218: array(1) {",
          "219:   [\"foo\"]=>",
          "220:   NULL",
          "224: bool(true)",
          "225: array(1) {",
          "226:   [\"foo\"]=>",
          "227:   NULL",
          "231: bool(true)",
          "232: array(1) {",
          "233:   [\"foo\"]=>",
          "234:   NULL",
          "238: bool(true)",
          "239: array(1) {",
          "240:   [\"foo\"]=>",
          "241:   NULL",
          "245: bool(true)",
          "246: array(1) {",
          "247:   [\"foo\"]=>",
          "248:   NULL",
          "252: bool(true)",
          "253: array(1) {",
          "254:   [\"foo\"]=>",
          "255:   NULL",
          "259: bool(true)",
          "260: array(1) {",
          "261:   [\"foo\"]=>",
          "262:   NULL",
          "",
          "[Added Lines]",
          "58: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "59: bool(false)",
          "60: array(0) {",
          "65: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "66: bool(false)",
          "67: array(0) {",
          "72: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "73: bool(false)",
          "74: array(0) {",
          "79: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "80: bool(false)",
          "81: array(0) {",
          "86: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "87: bool(false)",
          "88: array(0) {",
          "93: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "94: bool(false)",
          "95: array(0) {",
          "100: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "101: bool(false)",
          "102: array(0) {",
          "107: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "108: bool(false)",
          "109: array(0) {",
          "114: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "115: bool(false)",
          "116: array(0) {",
          "121: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "122: bool(false)",
          "123: array(0) {",
          "128: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "129: bool(false)",
          "130: array(0) {",
          "135: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "136: bool(false)",
          "137: array(0) {",
          "142: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "143: bool(false)",
          "144: array(0) {",
          "149: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "150: bool(false)",
          "151: array(0) {",
          "156: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "157: bool(false)",
          "158: array(0) {",
          "163: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "164: bool(false)",
          "165: array(0) {",
          "170: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "171: bool(false)",
          "172: array(0) {",
          "177: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "178: bool(false)",
          "179: array(0) {",
          "184: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "185: bool(false)",
          "186: array(0) {",
          "191: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "192: bool(false)",
          "193: array(0) {",
          "198: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "199: bool(false)",
          "200: array(0) {",
          "205: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "206: bool(false)",
          "207: array(0) {",
          "212: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "213: bool(false)",
          "214: array(0) {",
          "219: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "220: bool(false)",
          "221: array(0) {",
          "226: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "227: bool(false)",
          "228: array(0) {",
          "233: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "234: bool(false)",
          "235: array(0) {",
          "240: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "241: bool(false)",
          "242: array(0) {",
          "247: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "248: bool(false)",
          "249: array(0) {",
          "254: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "255: bool(false)",
          "256: array(0) {",
          "261: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "262: bool(false)",
          "263: array(0) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "333: }",
          "335: -- Iteration 39 --",
          "349: }",
          "351: -- Iteration 40 --",
          "365: }",
          "367: -- Iteration 41 --",
          "381: }",
          "383: -- Iteration 42 --",
          "397: }",
          "399: -- Iteration 43 --",
          "",
          "[Removed Lines]",
          "336: bool(true)",
          "337: array(2) {",
          "338:   [\"foo\"]=>",
          "339:   array(3) {",
          "340:     [0]=>",
          "341:     int(1)",
          "342:     [1]=>",
          "343:     int(2)",
          "344:     [2]=>",
          "345:     int(3)",
          "346:   }",
          "347:   [\"guff\"]=>",
          "348:   NULL",
          "352: bool(true)",
          "353: array(2) {",
          "354:   [\"foo\"]=>",
          "355:   array(3) {",
          "356:     [0]=>",
          "357:     int(1)",
          "358:     [1]=>",
          "359:     int(2)",
          "360:     [2]=>",
          "361:     int(3)",
          "362:   }",
          "363:   [\"guff\"]=>",
          "364:   NULL",
          "368: bool(true)",
          "369: array(2) {",
          "370:   [\"foo\"]=>",
          "371:   array(3) {",
          "372:     [0]=>",
          "373:     int(1)",
          "374:     [1]=>",
          "375:     int(2)",
          "376:     [2]=>",
          "377:     int(3)",
          "378:   }",
          "379:   [\"guff\"]=>",
          "380:   NULL",
          "384: bool(true)",
          "385: array(2) {",
          "386:   [\"foo\"]=>",
          "387:   array(3) {",
          "388:     [0]=>",
          "389:     int(1)",
          "390:     [1]=>",
          "391:     int(2)",
          "392:     [2]=>",
          "393:     int(3)",
          "394:   }",
          "395:   [\"guff\"]=>",
          "396:   NULL",
          "",
          "[Added Lines]",
          "338: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "339: bool(false)",
          "340: array(0) {",
          "345: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "346: bool(false)",
          "347: array(0) {",
          "352: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "353: bool(false)",
          "354: array(0) {",
          "359: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "360: bool(false)",
          "361: array(0) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "512: }",
          "514: -- Iteration 48 --",
          "537: }",
          "539: -- Iteration 49 --",
          "562: }",
          "564: -- Iteration 50 --",
          "587: }",
          "589: -- Iteration 51 --",
          "612: }",
          "",
          "[Removed Lines]",
          "515: bool(true)",
          "516: array(3) {",
          "517:   [\"foo\"]=>",
          "518:   &array(3) {",
          "519:     [0]=>",
          "520:     int(1)",
          "521:     [1]=>",
          "522:     int(2)",
          "523:     [2]=>",
          "524:     int(3)",
          "525:   }",
          "526:   [\"guff\"]=>",
          "527:   &array(3) {",
          "528:     [0]=>",
          "529:     int(1)",
          "530:     [1]=>",
          "531:     int(2)",
          "532:     [2]=>",
          "533:     int(3)",
          "534:   }",
          "535:   [\"blah\"]=>",
          "536:   NULL",
          "540: bool(true)",
          "541: array(3) {",
          "542:   [\"foo\"]=>",
          "543:   &array(3) {",
          "544:     [0]=>",
          "545:     int(1)",
          "546:     [1]=>",
          "547:     int(2)",
          "548:     [2]=>",
          "549:     int(3)",
          "550:   }",
          "551:   [\"guff\"]=>",
          "552:   &array(3) {",
          "553:     [0]=>",
          "554:     int(1)",
          "555:     [1]=>",
          "556:     int(2)",
          "557:     [2]=>",
          "558:     int(3)",
          "559:   }",
          "560:   [\"blah\"]=>",
          "561:   NULL",
          "565: bool(true)",
          "566: array(3) {",
          "567:   [\"foo\"]=>",
          "568:   &array(3) {",
          "569:     [0]=>",
          "570:     int(1)",
          "571:     [1]=>",
          "572:     int(2)",
          "573:     [2]=>",
          "574:     int(3)",
          "575:   }",
          "576:   [\"guff\"]=>",
          "577:   &array(3) {",
          "578:     [0]=>",
          "579:     int(1)",
          "580:     [1]=>",
          "581:     int(2)",
          "582:     [2]=>",
          "583:     int(3)",
          "584:   }",
          "585:   [\"blah\"]=>",
          "586:   NULL",
          "590: bool(true)",
          "591: array(3) {",
          "592:   [\"foo\"]=>",
          "593:   &array(3) {",
          "594:     [0]=>",
          "595:     int(1)",
          "596:     [1]=>",
          "597:     int(2)",
          "598:     [2]=>",
          "599:     int(3)",
          "600:   }",
          "601:   [\"guff\"]=>",
          "602:   &array(3) {",
          "603:     [0]=>",
          "604:     int(1)",
          "605:     [1]=>",
          "606:     int(2)",
          "607:     [2]=>",
          "608:     int(3)",
          "609:   }",
          "610:   [\"blah\"]=>",
          "611:   NULL",
          "613: bool(true)",
          "614: Done",
          "",
          "[Added Lines]",
          "481: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "482: bool(false)",
          "483: array(0) {",
          "488: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "489: bool(false)",
          "490: array(0) {",
          "495: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "496: bool(false)",
          "497: array(0) {",
          "502: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "503: bool(false)",
          "504: array(0) {",
          "507: Warning: session_destroy(): Trying to destroy uninitialized session in %s/session_decode_error2.php on line %d",
          "508: bool(false)",
          "509: Done",
          "",
          "---------------"
        ],
        "ext/soap/soap.c||ext/soap/soap.c": [
          "File: ext/soap/soap.c -> ext/soap/soap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1505:    add_soap_fault_ex(&exception_object, this_ptr, \"Server\", \"Internal Error\", NULL, NULL);",
          "1506:   }",
          "1507:   soap_server_fault_ex(function, &exception_object, NULL);",
          "1509: }",
          "",
          "[Removed Lines]",
          "1508:  }",
          "",
          "[Added Lines]",
          "1508:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2924:     free_soap_headers = 1;",
          "2925:    }",
          "2926:    ZEND_HASH_FOREACH_VAL(default_headers, tmp) {",
          "2929:    } ZEND_HASH_FOREACH_END();",
          "2930:   } else {",
          "2931:    soap_headers = Z_ARRVAL_P(tmp);",
          "",
          "[Removed Lines]",
          "2927:     Z_ADDREF_P(tmp);",
          "2928:     zend_hash_next_index_insert(soap_headers, tmp);",
          "",
          "[Added Lines]",
          "2927:     if(Z_TYPE_P(tmp) == IS_OBJECT) {",
          "2928:      Z_ADDREF_P(tmp);",
          "2929:      zend_hash_next_index_insert(soap_headers, tmp);",
          "2930:     }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4332:   zval* header;",
          "4334:   ZEND_HASH_FOREACH_VAL(soap_headers, header) {",
          "4336:    zval *name, *ns, *tmp;",
          "4338:    if ((name = zend_hash_str_find(ht, \"name\", sizeof(\"name\")-1)) != NULL &&",
          "4339:        Z_TYPE_P(name) == IS_STRING &&",
          "4340:        (ns = zend_hash_str_find(ht, \"namespace\", sizeof(\"namespace\")-1)) != NULL &&",
          "",
          "[Removed Lines]",
          "4335:    HashTable *ht = Z_OBJPROP_P(header);",
          "",
          "[Added Lines]",
          "4337:    HashTable *ht;",
          "4340:    if (Z_TYPE_P(header) != IS_OBJECT) {",
          "4341:     continue;",
          "4342:    }",
          "4344:    ht = Z_OBJPROP_P(header);",
          "",
          "---------------"
        ],
        "ext/soap/tests/bug70388.phpt||ext/soap/tests/bug70388.phpt": [
          "File: ext/soap/tests/bug70388.phpt -> ext/soap/tests/bug70388.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70388 (SOAP serialize_function_call() type confusion / RCE)",
          "3: --SKIPIF--",
          "4: <?php require_once('skipif.inc'); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: $dummy = unserialize('O:10:\"SoapClient\":3:{s:3:\"uri\";s:1:\"X\";s:8:\"location\";s:22:\"http://localhost/a.xml\";s:17:\"__default_headers\";a:1:{i:1;s:1337:\"'.str_repeat(\"X\", 1337).'\";}}');",
          "8: try {",
          "9:  var_dump($dummy->notexisting());",
          "10: } catch(Exception $e) {",
          "11:  var_dump($e->getMessage());",
          "12:  var_dump(get_class($e));",
          "13: }",
          "14: ?>",
          "15: --EXPECTF--",
          "16: string(%d) \"%s\"",
          "17: string(9) \"SoapFault\"",
          "",
          "---------------"
        ],
        "ext/spl/spl_dllist.c||ext/spl/spl_dllist.c": [
          "File: ext/spl/spl_dllist.c -> ext/spl/spl_dllist.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1210:   if (!php_var_unserialize(elem, &p, s + buf_len, &var_hash)) {",
          "1211:    goto error;",
          "1212:   }",
          "1214:   spl_ptr_llist_push(intern->llist, elem);",
          "1215:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1213:   var_push_dtor(&var_hash, elem);",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70155.phpt||ext/spl/tests/bug70155.phpt": [
          "File: ext/spl/tests/bug70155.phpt -> ext/spl/tests/bug70155.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70155 Use After Free Vulnerability in unserialize() with SPLArrayObject",
          "3: --FILE--",
          "4: <?php",
          "5: $inner = 'x:i:0;O:12:\"DateInterval\":1:{s:1:\"y\";i:3;};m:a:1:{i:0;R:2;}';",
          "6: $exploit = 'C:11:\"ArrayObject\":'.strlen($inner).':{'.$inner.'}';",
          "7: $data = unserialize($exploit);",
          "9: var_dump($data);",
          "10: ?>",
          "11: ===DONE===",
          "12: --EXPECTF--",
          "13: object(ArrayObject)#1 (2) {",
          "14:   [0]=>",
          "15:   int(0)",
          "16:   [\"storage\":\"ArrayObject\":private]=>",
          "17:   object(DateInterval)#2 (15) {",
          "18:     [\"y\"]=>",
          "19:     int(3)",
          "20:     [\"m\"]=>",
          "21:     int(-1)",
          "22:     [\"d\"]=>",
          "23:     int(-1)",
          "24:     [\"h\"]=>",
          "25:     int(-1)",
          "26:     [\"i\"]=>",
          "27:     int(-1)",
          "28:     [\"s\"]=>",
          "29:     int(-1)",
          "30:     [\"weekday\"]=>",
          "31:     int(-1)",
          "32:     [\"weekday_behavior\"]=>",
          "33:     int(-1)",
          "34:     [\"first_last_day_of\"]=>",
          "35:     int(-1)",
          "36:     [\"invert\"]=>",
          "37:     int(0)",
          "38:     [\"days\"]=>",
          "39:     int(-1)",
          "40:     [\"special_type\"]=>",
          "41:     int(0)",
          "42:     [\"special_amount\"]=>",
          "43:     int(-1)",
          "44:     [\"have_weekday_relative\"]=>",
          "45:     int(0)",
          "46:     [\"have_special_relative\"]=>",
          "47:     int(0)",
          "48:   }",
          "49: }",
          "50: ===DONE===",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70365.phpt||ext/spl/tests/bug70365.phpt": [
          "File: ext/spl/tests/bug70365.phpt -> ext/spl/tests/bug70365.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70365 use-after-free vulnerability in unserialize() with SplObjectStorage",
          "3: --FILE--",
          "4: <?php",
          "5: class obj {",
          "6:  var $ryat;",
          "7:  function __wakeup() {",
          "8:   $this->ryat = 1;",
          "9:  }",
          "10: }",
          "12: $fakezval = ptr2str(1122334455);",
          "13: $fakezval .= ptr2str(0);",
          "14: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "15: $fakezval .= \"\\x01\";",
          "16: $fakezval .= \"\\x00\";",
          "17: $fakezval .= \"\\x00\\x00\";",
          "19: $inner = 'x:i:1;O:8:\"stdClass\":0:{},i:1;;m:a:0:{}';",
          "20: $exploit = 'a:5:{i:0;i:1;i:1;C:16:\"SplObjectStorage\":'.strlen($inner).':{'.$inner.'}i:2;O:3:\"obj\":1:{s:4:\"ryat\";R:3;}i:3;R:6;i:4;s:'.strlen($fakezval).':\"'.$fakezval.'\";}';",
          "22: $data = unserialize($exploit);",
          "24: var_dump($data);",
          "26: function ptr2str($ptr)",
          "27: {",
          "28:  $out = '';",
          "29:  for ($i = 0; $i < 8; $i++) {",
          "30:   $out .= chr($ptr & 0xff);",
          "31:   $ptr >>= 8;",
          "32:  }",
          "33:  return $out;",
          "34: }",
          "35: --EXPECTF--",
          "36: array(5) {",
          "37:   [0]=>",
          "38:   int(1)",
          "39:   [1]=>",
          "40:   &int(1)",
          "41:   [2]=>",
          "42:   object(obj)#%d (1) {",
          "43:     [\"ryat\"]=>",
          "44:     &int(1)",
          "45:   }",
          "46:   [3]=>",
          "47:   int(1)",
          "48:   [4]=>",
          "49:   string(24) \"%s\"",
          "50: }",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70366.phpt||ext/spl/tests/bug70366.phpt": [
          "File: ext/spl/tests/bug70366.phpt -> ext/spl/tests/bug70366.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70366 use-after-free vulnerability in unserialize() with SplDoublyLinkedList",
          "3: --FILE--",
          "4: <?php",
          "5: class obj {",
          "6:  var $ryat;",
          "7:  function __wakeup() {",
          "8:   $this->ryat = 1;",
          "9:  }",
          "10: }",
          "12: $fakezval = ptr2str(1122334455);",
          "13: $fakezval .= ptr2str(0);",
          "14: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "15: $fakezval .= \"\\x01\";",
          "16: $fakezval .= \"\\x00\";",
          "17: $fakezval .= \"\\x00\\x00\";",
          "19: $inner = 'i:1234;:i:1;';",
          "20: $exploit = 'a:5:{i:0;i:1;i:1;C:19:\"SplDoublyLinkedList\":'.strlen($inner).':{'.$inner.'}i:2;O:3:\"obj\":1:{s:4:\"ryat\";R:3;}i:3;a:1:{i:0;R:5;}i:4;s:'.strlen($fakezval).':\"'.$fakezval.'\";}';",
          "22: $data = unserialize($exploit);",
          "24: var_dump($data);",
          "26: function ptr2str($ptr)",
          "27: {",
          "28:  $out = '';",
          "29:  for ($i = 0; $i < 8; $i++) {",
          "30:   $out .= chr($ptr & 0xff);",
          "31:   $ptr >>= 8;",
          "32:  }",
          "33:  return $out;",
          "34: }",
          "35: ?>",
          "36: --EXPECTF--",
          "37: array(5) {",
          "38:   [0]=>",
          "39:   int(1)",
          "40:   [1]=>",
          "41:   &int(1)",
          "42:   [2]=>",
          "43:   object(obj)#%d (1) {",
          "44:     [\"ryat\"]=>",
          "45:     &int(1)",
          "46:   }",
          "47:   [3]=>",
          "48:   array(1) {",
          "49:     [0]=>",
          "50:     int(1)",
          "51:   }",
          "52:   [4]=>",
          "53:   string(24) \"%s\"",
          "54: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70172.phpt||ext/standard/tests/serialize/bug70172.phpt": [
          "File: ext/standard/tests/serialize/bug70172.phpt -> ext/standard/tests/serialize/bug70172.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70172 - Use After Free Vulnerability in unserialize()",
          "3: --XFAIL--",
          "4: Memory leak on debug build, needs fix.",
          "5: --FILE--",
          "6: <?php",
          "7: class obj implements Serializable {",
          "8:  var $data;",
          "9:  function serialize() {",
          "10:   return serialize($this->data);",
          "11:  }",
          "12:  function unserialize($data) {",
          "13:   $this->data = unserialize($data);",
          "14:  }",
          "15: }",
          "17: $fakezval = ptr2str(1122334455);",
          "18: $fakezval .= ptr2str(0);",
          "19: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "20: $fakezval .= \"\\x01\";",
          "21: $fakezval .= \"\\x00\";",
          "22: $fakezval .= \"\\x00\\x00\";",
          "24: $inner = 'r:2;';",
          "25: $exploit = 'a:2:{i:0;i:1;i:1;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}}';",
          "27: $data = unserialize($exploit);",
          "29: for ($i = 0; $i < 5; $i++) {",
          "30:  $v[$i] = $fakezval.$i;",
          "31: }",
          "33: var_dump($data);",
          "35: function ptr2str($ptr)",
          "36: {",
          "37:  $out = '';",
          "38:  for ($i = 0; $i < 8; $i++) {",
          "39:   $out .= chr($ptr & 0xff);",
          "40:   $ptr >>= 8;",
          "41:  }",
          "42:  return $out;",
          "43: }",
          "44: ?>",
          "45: --EXPECTF--",
          "46: array(2) {",
          "47:   [0]=>",
          "48:   int(1)",
          "49:   [1]=>",
          "50:   object(obj)#%d (1) {",
          "51:     [\"data\"]=>",
          "52:     int(1)",
          "53:   }",
          "54: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70172_2.phpt||ext/standard/tests/serialize/bug70172_2.phpt": [
          "File: ext/standard/tests/serialize/bug70172_2.phpt -> ext/standard/tests/serialize/bug70172_2.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70172 - Use After Free Vulnerability in unserialize()",
          "3: --FILE--",
          "4: <?php",
          "5: class obj implements Serializable {",
          "6:  var $data;",
          "7:  function serialize() {",
          "8:   return serialize($this->data);",
          "9:  }",
          "10:  function unserialize($data) {",
          "11:   $this->data = unserialize($data);",
          "12:  }",
          "13: }",
          "15: class obj2 {",
          "16:  var $ryat;",
          "17:  function __wakeup() {",
          "18:   $this->ryat = 1;",
          "19:  }",
          "20: }",
          "22: $fakezval = ptr2str(1122334455);",
          "23: $fakezval .= ptr2str(0);",
          "24: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "25: $fakezval .= \"\\x01\";",
          "26: $fakezval .= \"\\x00\";",
          "27: $fakezval .= \"\\x00\\x00\";",
          "29: $inner = 'r:2;';",
          "30: $exploit = 'a:2:{i:0;O:4:\"obj2\":1:{s:4:\"ryat\";C:3:\"obj\":'.strlen($inner).':{'.$inner.'}}i:1;a:1:{i:0;a:1:{i:0;R:4;}}}';",
          "32: $data = unserialize($exploit);",
          "34: for ($i = 0; $i < 5; $i++) {",
          "35:  $v[$i] = $fakezval.$i;",
          "36: }",
          "38: var_dump($data);",
          "40: function ptr2str($ptr)",
          "41: {",
          "42:  $out = '';",
          "43:  for ($i = 0; $i < 8; $i++) {",
          "44:   $out .= chr($ptr & 0xff);",
          "45:   $ptr >>= 8;",
          "46:  }",
          "47:  return $out;",
          "48: }",
          "49: ?>",
          "50: --EXPECTF--",
          "51: array(2) {",
          "52:   [0]=>",
          "53:   object(obj2)#%d (1) {",
          "54:     [\"ryat\"]=>",
          "55:     int(1)",
          "56:   }",
          "57:   [1]=>",
          "58:   array(1) {",
          "59:     [0]=>",
          "60:     array(1) {",
          "61:       [0]=>",
          "62:       &object(obj2)#%d (1) {",
          "63:         [\"ryat\"]=>",
          "64:         int(1)",
          "65:       }",
          "66:     }",
          "67:   }",
          "68: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70219.phpt||ext/standard/tests/serialize/bug70219.phpt": [
          "File: ext/standard/tests/serialize/bug70219.phpt -> ext/standard/tests/serialize/bug70219.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70219 Use after free vulnerability in session deserializer",
          "3: --FILE--",
          "4: <?php",
          "5: class obj implements Serializable {",
          "6:     var $data;",
          "7:     function serialize() {",
          "8:         return serialize($this->data);",
          "9:     }",
          "10:     function unserialize($data) {",
          "11:         session_start();",
          "12:         session_decode($data);",
          "13:     }",
          "14: }",
          "16: $inner = 'ryat|a:1:{i:0;a:1:{i:1;';",
          "17: $exploit = 'a:2:{i:0;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}i:1;R:4;}';",
          "19: $data = unserialize($exploit);",
          "21: for ($i = 0; $i < 5; $i++) {",
          "22:     $v[$i] = 'hi'.$i;",
          "23: }",
          "25: var_dump($data);",
          "26: ?>",
          "27: --EXPECTF--",
          "28: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s on line %d",
          "29: array(2) {",
          "30:   [0]=>",
          "31:   object(obj)#%d (1) {",
          "32:     [\"data\"]=>",
          "33:     NULL",
          "34:   }",
          "35:   [1]=>",
          "36:   &array(1) {",
          "37:     [\"data\"]=>",
          "38:     NULL",
          "39:   }",
          "40: }",
          "",
          "---------------"
        ],
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1045:  php_unserialize_data_t var_hash;",
          "1046:  zval *options = NULL, *classes = NULL;",
          "1047:  HashTable *class_hash = NULL;",
          "1049:  if (zend_parse_parameters(ZEND_NUM_ARGS(), \"s|a\", &buf, &buf_len, &options) == FAILURE) {",
          "1050:   RETURN_FALSE;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1048:  zval *old_rval = return_value;",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "103: #if 0",
          "104: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "105: {",
          "107: #if VAR_ENTRIES_DBG",
          "109: #endif",
          "111:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "106:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "108:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "[Added Lines]",
          "106:  var_entries *var_hash;",
          "108:     if (!var_hashx || !*var_hashx) {",
          "109:         return;",
          "110:     }",
          "112:     var_hash = (*var_hashx)->last_dtor;",
          "114:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "184:  while (var_dtor_hash) {",
          "185:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "186:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "187:   }",
          "188:   next = var_dtor_hash->next;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "192: #if VAR_ENTRIES_DBG",
          "193:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "194: #endif",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "263: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "266: #line 271 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "275: #line 280 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "530:  start = cursor;",
          "534: {",
          "535:  YYCTYPE yych;",
          "536:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "533: #line 534 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "542: #line 543 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "590:  yych = *(YYMARKER = ++YYCURSOR);",
          "591:  if (yych == ':') goto yy95;",
          "592: yy3:",
          "594:  { return 0; }",
          "596: yy4:",
          "597:  yych = *(YYMARKER = ++YYCURSOR);",
          "598:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "593: #line 881 \"ext/standard/var_unserializer.re\"",
          "595: #line 596 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "602: #line 893 \"ext/standard/var_unserializer.re\"",
          "604: #line 605 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "635:  goto yy3;",
          "636: yy14:",
          "637:  ++YYCURSOR;",
          "639:  {",
          "641:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "643: }",
          "645: yy16:",
          "646:  yych = *++YYCURSOR;",
          "647:  goto yy3;",
          "",
          "[Removed Lines]",
          "638: #line 875 \"ext/standard/var_unserializer.re\"",
          "644: #line 645 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "647: #line 887 \"ext/standard/var_unserializer.re\"",
          "653: #line 654 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "667:  if (yybm[0+yych] & 128) {",
          "668:   goto yy20;",
          "669:  }",
          "671:  yych = *++YYCURSOR;",
          "672:  if (yych != '\"') goto yy18;",
          "673:  ++YYCURSOR;",
          "675:  {",
          "676:  size_t len, len2, len3, maxlen;",
          "677:  zend_long elements;",
          "",
          "[Removed Lines]",
          "670:  if (yych != ':') goto yy18;",
          "674: #line 730 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "679:  if (yych <= '/') goto yy18;",
          "680:  if (yych >= ';') goto yy18;",
          "684: #line 741 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "686:  zval retval;",
          "687:  zval args[1];",
          "689:  if (*start == 'C') {",
          "690:   custom_object = 1;",
          "691:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "699:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "817:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "818: }",
          "820: yy25:",
          "821:  yych = *++YYCURSOR;",
          "822:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "819: #line 820 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "830: #line 831 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yych != '\"') goto yy18;",
          "843:  ++YYCURSOR;",
          "845:  {",
          "849:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "850:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "851: }",
          "853: yy32:",
          "854:  yych = *++YYCURSOR;",
          "855:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "844: #line 722 \"ext/standard/var_unserializer.re\"",
          "852: #line 853 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "855: #line 732 \"ext/standard/var_unserializer.re\"",
          "857:     if (!var_hash) return 0;",
          "864: #line 865 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "870:  yych = *++YYCURSOR;",
          "871:  if (yych != '{') goto yy18;",
          "872:  ++YYCURSOR;",
          "874:  {",
          "875:  zend_long elements = parse_iv(start + 2);",
          "879:  if (elements < 0) {",
          "880:   return 0;",
          "",
          "[Removed Lines]",
          "873: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "885: #line 710 \"ext/standard/var_unserializer.re\"",
          "890:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "892:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "893: }",
          "895: yy39:",
          "896:  yych = *++YYCURSOR;",
          "897:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "894: #line 895 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "907: #line 908 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "912:  yych = *++YYCURSOR;",
          "913:  if (yych != '\"') goto yy18;",
          "914:  ++YYCURSOR;",
          "916:  {",
          "917:  size_t len, maxlen;",
          "918:  zend_string *str;",
          "",
          "[Removed Lines]",
          "915: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "928: #line 682 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "940:  ZVAL_STR(rval, str);",
          "941:  return 1;",
          "942: }",
          "944: yy46:",
          "945:  yych = *++YYCURSOR;",
          "946:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "943: #line 944 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "956: #line 957 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "961:  yych = *++YYCURSOR;",
          "962:  if (yych != '\"') goto yy18;",
          "963:  ++YYCURSOR;",
          "965:  {",
          "966:  size_t len, maxlen;",
          "967:  char *str;",
          "",
          "[Removed Lines]",
          "964: #line 646 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "977: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "988:  ZVAL_STRINGL(rval, str, len);",
          "989:  return 1;",
          "990: }",
          "992: yy53:",
          "993:  yych = *++YYCURSOR;",
          "994:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "991: #line 992 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1004: #line 1005 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1076:  }",
          "1077: yy63:",
          "1078:  ++YYCURSOR;",
          "1080:  {",
          "1081: #if SIZEOF_ZEND_LONG == 4",
          "1082: use_double:",
          "",
          "[Removed Lines]",
          "1079: #line 637 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1092: #line 646 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1085:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1086:  return 1;",
          "1087: }",
          "1089: yy65:",
          "1090:  yych = *++YYCURSOR;",
          "1091:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1088: #line 1089 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1101: #line 1102 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1144:  yych = *++YYCURSOR;",
          "1145:  if (yych != ';') goto yy18;",
          "1146:  ++YYCURSOR;",
          "1148:  {",
          "",
          "[Removed Lines]",
          "1147: #line 621 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1160: #line 630 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1161:  return 1;",
          "1162: }",
          "1164: yy76:",
          "1165:  yych = *++YYCURSOR;",
          "1166:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1163: #line 1164 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1176: #line 1177 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1187:  if (yych <= '9') goto yy79;",
          "1188:  if (yych != ';') goto yy18;",
          "1189:  ++YYCURSOR;",
          "1191:  {",
          "1192: #if SIZEOF_ZEND_LONG == 4",
          "1193:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1190: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1203: #line 604 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1213:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1214:  return 1;",
          "1215: }",
          "1217: yy83:",
          "1218:  yych = *++YYCURSOR;",
          "1219:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1229: #line 1230 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1221:  yych = *++YYCURSOR;",
          "1222:  if (yych != ';') goto yy18;",
          "1223:  ++YYCURSOR;",
          "1225:  {",
          "1227:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1228:  return 1;",
          "1229: }",
          "1231: yy87:",
          "1232:  ++YYCURSOR;",
          "1234:  {",
          "1236:  ZVAL_NULL(rval);",
          "1237:  return 1;",
          "1238: }",
          "1240: yy89:",
          "1241:  yych = *++YYCURSOR;",
          "1242:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1224: #line 589 \"ext/standard/var_unserializer.re\"",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "1233: #line 583 \"ext/standard/var_unserializer.re\"",
          "1239: #line 1240 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1237: #line 598 \"ext/standard/var_unserializer.re\"",
          "1243: #line 1244 \"ext/standard/var_unserializer.c\"",
          "1246: #line 592 \"ext/standard/var_unserializer.re\"",
          "1252: #line 1253 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1259:  if (yych <= '9') goto yy91;",
          "1260:  if (yych != ';') goto yy18;",
          "1261:  ++YYCURSOR;",
          "1263:  {",
          "1264:  zend_long id;",
          "",
          "[Removed Lines]",
          "1262: #line 560 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1275: #line 569 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1283:  return 1;",
          "1284: }",
          "1286: yy95:",
          "1287:  yych = *++YYCURSOR;",
          "1288:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1285: #line 1286 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1298: #line 1299 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1305:  if (yych <= '9') goto yy97;",
          "1306:  if (yych != ';') goto yy18;",
          "1307:  ++YYCURSOR;",
          "1309:  {",
          "1310:  zend_long id;",
          "",
          "[Removed Lines]",
          "1308: #line 538 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1321: #line 547 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1328:  return 1;",
          "1329: }",
          "1331: }",
          "1335:  return 0;",
          "",
          "[Removed Lines]",
          "1330: #line 1331 \"ext/standard/var_unserializer.c\"",
          "1332: #line 883 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1343: #line 1344 \"ext/standard/var_unserializer.c\"",
          "1345: #line 895 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "101: #if 0",
          "102: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "103: {",
          "105: #if VAR_ENTRIES_DBG",
          "107: #endif",
          "109:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "104:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "106:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "[Added Lines]",
          "104:  var_entries *var_hash;",
          "106:     if (!var_hashx || !*var_hashx) {",
          "107:         return;",
          "108:     }",
          "110:     var_hash = (*var_hashx)->last_dtor;",
          "112:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "182:  while (var_dtor_hash) {",
          "183:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "184:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "185:   }",
          "186:   next = var_dtor_hash->next;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "190: #if VAR_ENTRIES_DBG",
          "191:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "192: #endif",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "702:  zend_long elements = parse_iv(start + 2);",
          "706:  if (elements < 0) {",
          "707:   return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "714:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "720: }",
          "722: \"o:\" iv \":\" [\"] {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "733:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "741:  zval retval;",
          "742:  zval args[1];",
          "744:  if (*start == 'C') {",
          "745:   custom_object = 1;",
          "746:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "755:     if (!var_hash) return 0;",
          "",
          "---------------"
        ],
        "ext/xsl/xsltprocessor.c||ext/xsl/xsltprocessor.c": [
          "File: ext/xsl/xsltprocessor.c -> ext/xsl/xsltprocessor.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "218:  if (error == 1) {",
          "219:   for (i = nargs - 1; i >= 0; i--) {",
          "220:    obj = valuePop(ctxt);",
          "222:   }",
          "223:   return;",
          "224:  }",
          "",
          "[Removed Lines]",
          "221:    xmlXPathFreeObject(obj);",
          "",
          "[Added Lines]",
          "221:    if (obj) {",
          "222:     xmlXPathFreeObject(obj);",
          "223:    }",
          "",
          "---------------"
        ],
        "ext/zip/php_zip.c||ext/zip/php_zip.c": [
          "File: ext/zip/php_zip.c -> ext/zip/php_zip.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "173:  if (path_cleaned_len > 1 && IS_SLASH(path_cleaned[path_cleaned_len - 1])) {",
          "175:   is_dir_only = 1;",
          "176:  } else {",
          "177:   memcpy(file_dirname, path_cleaned, path_cleaned_len);",
          "",
          "[Removed Lines]",
          "174:   len = spprintf(&file_dirname_fullpath, 0, \"%s/%s\", dest, file);",
          "",
          "[Added Lines]",
          "174:   len = spprintf(&file_dirname_fullpath, 0, \"%s/%s\", dest, path_cleaned);",
          "",
          "---------------"
        ],
        "ext/zip/tests/bug70350.phpt||ext/zip/tests/bug70350.phpt": [
          "File: ext/zip/tests/bug70350.phpt -> ext/zip/tests/bug70350.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70350 (ZipArchive::extractTo allows for directory traversal when creating directories)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if(!extension_loaded('zip')) die('skip');",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "10: $dir = dirname(__FILE__).\"/bug70350\";",
          "11: mkdir($dir);",
          "12: $archive = new ZipArchive();",
          "13: $archive->open(\"$dir/a.zip\",ZipArchive::CREATE);",
          "14: $archive->addEmptyDir(\"../down2/\");",
          "15: $archive->close();",
          "17: $archive2 = new ZipArchive();",
          "18: $archive2->open(\"$dir/a.zip\");",
          "19: $archive2->extractTo($dir);",
          "20: $archive2->close();",
          "21: var_dump(file_exists(\"$dir/down2/\"));",
          "22: var_dump(file_exists(\"../down2/\"));",
          "23: ?>",
          "24: --CLEAN--",
          "25: <?php",
          "26: $dir = dirname(__FILE__).\"/bug70350\";",
          "27: rmdir(\"$dir/down2\");",
          "28: unlink(\"$dir/a.zip\");",
          "29: rmdir($dir);",
          "30: ?>",
          "31: --EXPECT--",
          "32: bool(true)",
          "33: bool(false)",
          "",
          "---------------"
        ]
      }
    }
  ]
}