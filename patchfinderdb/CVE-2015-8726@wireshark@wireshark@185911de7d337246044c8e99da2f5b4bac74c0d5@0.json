{
  "cve_id": "CVE-2015-8726",
  "cve_desc": "wiretap/vwr.c in the VeriWave file parser in Wireshark 1.12.x before 1.12.9 and 2.0.x before 2.0.1 does not validate certain signature and Modulation and Coding Scheme (MCS) data, which allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted file.",
  "repo": "wireshark/wireshark",
  "patch_hash": "185911de7d337246044c8e99da2f5b4bac74c0d5",
  "patch_info": {
    "commit_hash": "185911de7d337246044c8e99da2f5b4bac74c0d5",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/185911de7d337246044c8e99da2f5b4bac74c0d5",
    "files": [
      "wiretap/vwr.c"
    ],
    "message": "Add bounds checking to find_signature.\n\nBug: 11791\nChange-Id: Ibaa2c16229c1b78818283ba5f954b09f3894dc60\nReviewed-on: https://code.wireshark.org/review/12270\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
    "before_after_code_files": [
      "wiretap/vwr.c||wiretap/vwr.c"
    ]
  },
  "patch_diff": {
    "wiretap/vwr.c||wiretap/vwr.c": [
      "File: wiretap/vwr.c -> wiretap/vwr.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2212:     for (tgt = pay_off; tgt < (rec_size); tgt++) {",
      "2215:                 if (m_ptr[tgt + 4] != flow_seq)",
      "2216:                     continue;",
      "",
      "[Removed Lines]",
      "2214:             if (m_ptr[tgt + 15] == 0xe2) {",
      "",
      "[Added Lines]",
      "2214:             if ((tgt + 15 < rec_size) && (m_ptr[tgt + 15] == 0xe2)) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2223:                 return (tgt);",
      "2224:             }",
      "",
      "[Removed Lines]",
      "2225:             else",
      "",
      "[Added Lines]",
      "2225:             else if (tgt + SIG_FSQ_OFF < rec_size)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e4267dd4d03b81c74cd6bc9f574f3f10936ee354",
      "candidate_info": {
        "commit_hash": "e4267dd4d03b81c74cd6bc9f574f3f10936ee354",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/e4267dd4d03b81c74cd6bc9f574f3f10936ee354",
        "files": [
          "wiretap/vwr.c"
        ],
        "message": "Add bounds checking to find_signature.\n\nBug: 11791\nChange-Id: Ibaa2c16229c1b78818283ba5f954b09f3894dc60\nReviewed-on: https://code.wireshark.org/review/12270\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 185911de7d337246044c8e99da2f5b4bac74c0d5)\nReviewed-on: https://code.wireshark.org/review/12294",
        "before_after_code_files": [
          "wiretap/vwr.c||wiretap/vwr.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "wiretap/vwr.c||wiretap/vwr.c"
          ],
          "candidate": [
            "wiretap/vwr.c||wiretap/vwr.c"
          ]
        }
      },
      "candidate_diff": {
        "wiretap/vwr.c||wiretap/vwr.c": [
          "File: wiretap/vwr.c -> wiretap/vwr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2212:     for (tgt = pay_off; tgt < (rec_size); tgt++) {",
          "2215:                 if (m_ptr[tgt + 4] != flow_seq)",
          "2216:                     continue;",
          "",
          "[Removed Lines]",
          "2214:             if (m_ptr[tgt + 15] == 0xe2) {",
          "",
          "[Added Lines]",
          "2214:             if ((tgt + 15 < rec_size) && (m_ptr[tgt + 15] == 0xe2)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2223:                 return (tgt);",
          "2224:             }",
          "",
          "[Removed Lines]",
          "2225:             else",
          "",
          "[Added Lines]",
          "2225:             else if (tgt + SIG_FSQ_OFF < rec_size)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "51ccf92c014f6e1423ce74e62f7ebf8647e316e1",
      "candidate_info": {
        "commit_hash": "51ccf92c014f6e1423ce74e62f7ebf8647e316e1",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/51ccf92c014f6e1423ce74e62f7ebf8647e316e1",
        "files": [
          "wiretap/vwr.c"
        ],
        "message": "Add bounds checking to find_signature.\n\nBug: 11791\nChange-Id: Ibaa2c16229c1b78818283ba5f954b09f3894dc60\nReviewed-on: https://code.wireshark.org/review/12270\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 185911de7d337246044c8e99da2f5b4bac74c0d5)\nReviewed-on: https://code.wireshark.org/review/12294\n(cherry picked from commit e4267dd4d03b81c74cd6bc9f574f3f10936ee354)\nReviewed-on: https://code.wireshark.org/review/12295",
        "before_after_code_files": [
          "wiretap/vwr.c||wiretap/vwr.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "wiretap/vwr.c||wiretap/vwr.c"
          ],
          "candidate": [
            "wiretap/vwr.c||wiretap/vwr.c"
          ]
        }
      },
      "candidate_diff": {
        "wiretap/vwr.c||wiretap/vwr.c": [
          "File: wiretap/vwr.c -> wiretap/vwr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2051:     for (tgt = pay_off; tgt < (rec_size); tgt++) {",
          "2054:                 if (m_ptr[tgt + 4] != flow_seq)",
          "2055:                     continue;",
          "",
          "[Removed Lines]",
          "2053:             if (m_ptr[tgt + 15] == 0xe2) {",
          "",
          "[Added Lines]",
          "2053:             if ((tgt + 15 < rec_size) && (m_ptr[tgt + 15] == 0xe2)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2062:                 return (tgt);",
          "2063:             }",
          "",
          "[Removed Lines]",
          "2064:             else",
          "",
          "[Added Lines]",
          "2064:             else if (tgt + SIG_FSQ_OFF < rec_size)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4667397d5d81fc9d2994218fa731d0b617c31b02",
      "candidate_info": {
        "commit_hash": "4667397d5d81fc9d2994218fa731d0b617c31b02",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/4667397d5d81fc9d2994218fa731d0b617c31b02",
        "files": [
          "wiretap/vwr.c"
        ],
        "message": "Add bounds checking to find_signature.\n\nBug: 11791\nChange-Id: Ibaa2c16229c1b78818283ba5f954b09f3894dc60\nReviewed-on: https://code.wireshark.org/review/12270\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 185911de7d337246044c8e99da2f5b4bac74c0d5)\nReviewed-on: https://code.wireshark.org/review/12294\n(cherry picked from commit e4267dd4d03b81c74cd6bc9f574f3f10936ee354)\nReviewed-on: https://code.wireshark.org/review/12295\n(cherry picked from commit 51ccf92c014f6e1423ce74e62f7ebf8647e316e1)\nReviewed-on: https://code.wireshark.org/review/13767\nReviewed-by: Balint Reczey <balint@balintreczey.hu>",
        "before_after_code_files": [
          "wiretap/vwr.c||wiretap/vwr.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "wiretap/vwr.c||wiretap/vwr.c"
          ],
          "candidate": [
            "wiretap/vwr.c||wiretap/vwr.c"
          ]
        }
      },
      "candidate_diff": {
        "wiretap/vwr.c||wiretap/vwr.c": [
          "File: wiretap/vwr.c -> wiretap/vwr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2051:     for (tgt = pay_off; tgt < (rec_size); tgt++) {",
          "2054:                 if (m_ptr[tgt + 4] != flow_seq)",
          "2055:                     continue;",
          "",
          "[Removed Lines]",
          "2053:             if (m_ptr[tgt + 15] == 0xe2) {",
          "",
          "[Added Lines]",
          "2053:             if ((tgt + 15 < rec_size) && (m_ptr[tgt + 15] == 0xe2)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2062:                 return (tgt);",
          "2063:             }",
          "",
          "[Removed Lines]",
          "2064:             else",
          "",
          "[Added Lines]",
          "2064:             else if (tgt + SIG_FSQ_OFF < rec_size)",
          "",
          "---------------"
        ]
      }
    }
  ]
}