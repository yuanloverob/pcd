{
  "cve_id": "CVE-2018-17206",
  "cve_desc": "An issue was discovered in Open vSwitch (OvS) 2.7.x through 2.7.6. The decode_bundle function inside lib/ofp-actions.c is affected by a buffer over-read issue during BUNDLE action decoding.",
  "repo": "openvswitch/ovs",
  "patch_hash": "9237a63c47bd314b807cda0bd2216264e82edbe8",
  "patch_info": {
    "commit_hash": "9237a63c47bd314b807cda0bd2216264e82edbe8",
    "repo": "openvswitch/ovs",
    "commit_url": "https://github.com/openvswitch/ovs/commit/9237a63c47bd314b807cda0bd2216264e82edbe8",
    "files": [
      "lib/ofp-actions.c"
    ],
    "message": "ofp-actions: Avoid buffer overread in BUNDLE action decoding.\n\nReported-at: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=9052\nSigned-off-by: Ben Pfaff <blp@ovn.org>\nAcked-by: Justin Pettit <jpettit@ovn.org>",
    "before_after_code_files": [
      "lib/ofp-actions.c||lib/ofp-actions.c"
    ]
  },
  "patch_diff": {
    "lib/ofp-actions.c||lib/ofp-actions.c": [
      "File: lib/ofp-actions.c -> lib/ofp-actions.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1357:     }",
      "1359:     if (slaves_size < bundle->n_slaves * sizeof(ovs_be16)) {",
      "1366:     }",
      "1368:     for (i = 0; i < bundle->n_slaves; i++) {",
      "",
      "[Removed Lines]",
      "1360:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
      "1361:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
      "1362:                      \"for %\"PRIu16\" slaves.\",",
      "1363:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
      "1364:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
      "1365:         error = OFPERR_OFPBAC_BAD_LEN;",
      "",
      "[Added Lines]",
      "1360:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
      "1361:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
      "1362:                      \"for %\"PRIu16\" slaves.\",",
      "1363:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
      "1364:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
      "1365:         error = OFPERR_OFPBAC_BAD_LEN;",
      "1366:     } else {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d69fee374bc94fa4ff9836aef7b2855a565dd83f",
      "candidate_info": {
        "commit_hash": "d69fee374bc94fa4ff9836aef7b2855a565dd83f",
        "repo": "openvswitch/ovs",
        "commit_url": "https://github.com/openvswitch/ovs/commit/d69fee374bc94fa4ff9836aef7b2855a565dd83f",
        "files": [
          "lib/ofp-actions.c"
        ],
        "message": "ofp-actions: Avoid buffer overread in BUNDLE action decoding.\n\nReported-at: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=9052\nSigned-off-by: Ben Pfaff <blp@ovn.org>\nAcked-by: Justin Pettit <jpettit@ovn.org>",
        "before_after_code_files": [
          "lib/ofp-actions.c||lib/ofp-actions.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ],
          "candidate": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ]
        }
      },
      "candidate_diff": {
        "lib/ofp-actions.c||lib/ofp-actions.c": [
          "File: lib/ofp-actions.c -> lib/ofp-actions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1398:     }",
          "1400:     if (slaves_size < bundle->n_slaves * sizeof(ovs_be16)) {",
          "1407:     }",
          "1409:     for (i = 0; i < bundle->n_slaves; i++) {",
          "",
          "[Removed Lines]",
          "1401:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1402:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1403:                      \"for %u slaves.\",",
          "1404:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1405:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1406:         error = OFPERR_OFPBAC_BAD_LEN;",
          "",
          "[Added Lines]",
          "1401:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1402:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1403:                      \"for %u slaves.\",",
          "1404:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1405:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1406:         error = OFPERR_OFPBAC_BAD_LEN;",
          "1407:     } else {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ee47d61ba1c97cf67a68f0191dec1f93bfafc0a0",
      "candidate_info": {
        "commit_hash": "ee47d61ba1c97cf67a68f0191dec1f93bfafc0a0",
        "repo": "openvswitch/ovs",
        "commit_url": "https://github.com/openvswitch/ovs/commit/ee47d61ba1c97cf67a68f0191dec1f93bfafc0a0",
        "files": [
          "lib/ofp-actions.c"
        ],
        "message": "ofp-actions: Avoid buffer overread in BUNDLE action decoding.\n\nReported-at: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=9052\nSigned-off-by: Ben Pfaff <blp@ovn.org>\nAcked-by: Justin Pettit <jpettit@ovn.org>",
        "before_after_code_files": [
          "lib/ofp-actions.c||lib/ofp-actions.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ],
          "candidate": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ]
        }
      },
      "candidate_diff": {
        "lib/ofp-actions.c||lib/ofp-actions.c": [
          "File: lib/ofp-actions.c -> lib/ofp-actions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1304:     }",
          "1306:     if (slaves_size < bundle->n_slaves * sizeof(ovs_be16)) {",
          "1313:     }",
          "1315:     for (i = 0; i < bundle->n_slaves; i++) {",
          "",
          "[Removed Lines]",
          "1307:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1308:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1309:                      \"for %\"PRIu16\" slaves.\",",
          "1310:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1311:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1312:         error = OFPERR_OFPBAC_BAD_LEN;",
          "",
          "[Added Lines]",
          "1307:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1308:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1309:                      \"for %\"PRIu16\" slaves.\",",
          "1310:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1311:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1312:         error = OFPERR_OFPBAC_BAD_LEN;",
          "1313:     } else {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5026a263d7846077eee540de42192d27da513226",
      "candidate_info": {
        "commit_hash": "5026a263d7846077eee540de42192d27da513226",
        "repo": "openvswitch/ovs",
        "commit_url": "https://github.com/openvswitch/ovs/commit/5026a263d7846077eee540de42192d27da513226",
        "files": [
          "lib/ofp-actions.c"
        ],
        "message": "ofp-actions: Avoid buffer overread in BUNDLE action decoding.\n\nReported-at: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=9052\nSigned-off-by: Ben Pfaff <blp@ovn.org>\nAcked-by: Justin Pettit <jpettit@ovn.org>",
        "before_after_code_files": [
          "lib/ofp-actions.c||lib/ofp-actions.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ],
          "candidate": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ]
        }
      },
      "candidate_diff": {
        "lib/ofp-actions.c||lib/ofp-actions.c": [
          "File: lib/ofp-actions.c -> lib/ofp-actions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1380:     }",
          "1382:     if (slaves_size < bundle->n_slaves * sizeof(ovs_be16)) {",
          "1389:     }",
          "1391:     for (i = 0; i < bundle->n_slaves; i++) {",
          "",
          "[Removed Lines]",
          "1383:         VLOG_WARN_RL(&rll, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1384:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1385:                      \"for %u slaves.\",",
          "1386:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1387:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1388:         error = OFPERR_OFPBAC_BAD_LEN;",
          "",
          "[Added Lines]",
          "1383:         VLOG_WARN_RL(&rll, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1384:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1385:                      \"for %u slaves.\",",
          "1386:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1387:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1388:         error = OFPERR_OFPBAC_BAD_LEN;",
          "1389:     } else {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e1b5444c2f2ed4bda2c75597468f067ae104319d",
      "candidate_info": {
        "commit_hash": "e1b5444c2f2ed4bda2c75597468f067ae104319d",
        "repo": "openvswitch/ovs",
        "commit_url": "https://github.com/openvswitch/ovs/commit/e1b5444c2f2ed4bda2c75597468f067ae104319d",
        "files": [
          "lib/ofp-actions.c"
        ],
        "message": "ofp-actions: Avoid buffer overread in BUNDLE action decoding.\n\nReported-at: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=9052\nSigned-off-by: Ben Pfaff <blp@ovn.org>\nAcked-by: Justin Pettit <jpettit@ovn.org>",
        "before_after_code_files": [
          "lib/ofp-actions.c||lib/ofp-actions.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ],
          "candidate": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ]
        }
      },
      "candidate_diff": {
        "lib/ofp-actions.c||lib/ofp-actions.c": [
          "File: lib/ofp-actions.c -> lib/ofp-actions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1081:     }",
          "1083:     if (slaves_size < bundle->n_slaves * sizeof(ovs_be16)) {",
          "1090:     }",
          "1092:     for (i = 0; i < bundle->n_slaves; i++) {",
          "",
          "[Removed Lines]",
          "1084:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1085:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1086:                      \"for %\"PRIu16\" slaves.\",",
          "1087:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1088:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1089:         error = OFPERR_OFPBAC_BAD_LEN;",
          "",
          "[Added Lines]",
          "1084:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1085:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1086:                      \"for %\"PRIu16\" slaves.\",",
          "1087:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1088:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1089:         error = OFPERR_OFPBAC_BAD_LEN;",
          "1090:     } else {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "20626d38c1a1d4cebb5a6911ea3cb6a7f4f993f8",
      "candidate_info": {
        "commit_hash": "20626d38c1a1d4cebb5a6911ea3cb6a7f4f993f8",
        "repo": "openvswitch/ovs",
        "commit_url": "https://github.com/openvswitch/ovs/commit/20626d38c1a1d4cebb5a6911ea3cb6a7f4f993f8",
        "files": [
          "lib/ofp-actions.c"
        ],
        "message": "ofp-actions: Avoid buffer overread in BUNDLE action decoding.\n\nReported-at: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=9052\nSigned-off-by: Ben Pfaff <blp@ovn.org>\nAcked-by: Justin Pettit <jpettit@ovn.org>",
        "before_after_code_files": [
          "lib/ofp-actions.c||lib/ofp-actions.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ],
          "candidate": [
            "lib/ofp-actions.c||lib/ofp-actions.c"
          ]
        }
      },
      "candidate_diff": {
        "lib/ofp-actions.c||lib/ofp-actions.c": [
          "File: lib/ofp-actions.c -> lib/ofp-actions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1388:     }",
          "1390:     if (slaves_size < bundle->n_slaves * sizeof(ovs_be16)) {",
          "1397:     }",
          "1399:     for (i = 0; i < bundle->n_slaves; i++) {",
          "",
          "[Removed Lines]",
          "1391:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1392:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1393:                      \"for %u slaves.\",",
          "1394:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1395:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1396:         error = OFPERR_OFPBAC_BAD_LEN;",
          "",
          "[Added Lines]",
          "1391:         VLOG_WARN_RL(&rl, \"Nicira action %s only has %\"PRIuSIZE\" bytes \"",
          "1392:                      \"allocated for slaves.  %\"PRIuSIZE\" bytes are required \"",
          "1393:                      \"for %u slaves.\",",
          "1394:                      load ? \"bundle_load\" : \"bundle\", slaves_size,",
          "1395:                      bundle->n_slaves * sizeof(ovs_be16), bundle->n_slaves);",
          "1396:         error = OFPERR_OFPBAC_BAD_LEN;",
          "1397:     } else {",
          "",
          "---------------"
        ]
      }
    }
  ]
}