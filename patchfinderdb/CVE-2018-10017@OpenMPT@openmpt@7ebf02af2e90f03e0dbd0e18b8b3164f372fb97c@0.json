{
  "cve_id": "CVE-2018-10017",
  "cve_desc": "soundlib/Snd_fx.cpp in OpenMPT before 1.27.07.00 and libopenmpt before 0.3.8 allows remote attackers to cause a denial of service (out-of-bounds read) via an IT or MO3 file with many nested pattern loops.",
  "repo": "OpenMPT/openmpt",
  "patch_hash": "7ebf02af2e90f03e0dbd0e18b8b3164f372fb97c",
  "patch_info": {
    "commit_hash": "7ebf02af2e90f03e0dbd0e18b8b3164f372fb97c",
    "repo": "OpenMPT/openmpt",
    "commit_url": "https://github.com/OpenMPT/openmpt/commit/7ebf02af2e90f03e0dbd0e18b8b3164f372fb97c",
    "files": [
      "soundlib/Snd_fx.cpp"
    ],
    "message": "[Fix] Possible out-of-bounds read when computing length of some IT files with pattern loops (OpenMPT: formats that are converted to IT, libopenmpt: IT/ITP/MO3), caught with afl-fuzz.\n\ngit-svn-id: https://source.openmpt.org/svn/openmpt/trunk/OpenMPT@10027 56274372-70c3-4bfc-bfc3-4c3a0b034d27",
    "before_after_code_files": [
      "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp"
    ]
  },
  "patch_diff": {
    "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp": [
      "File: soundlib/Snd_fx.cpp -> soundlib/Snd_fx.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "1204:    if(GetType() == MOD_TYPE_IT)",
      "1205:    {",
      "1208:     {",
      "1209:      if((pChn->rowCommand.command == CMD_S3MCMDEX && pChn->rowCommand.param >= 0xB1 && pChn->rowCommand.param <= 0xBF))",
      "1210:      {",
      "",
      "[Removed Lines]",
      "1207:     for(CHANNELINDEX nChn = 0; nChn < GetNumChannels(); nChn++)",
      "",
      "[Added Lines]",
      "1207:     pChn = playState.Chn;",
      "1208:     for(CHANNELINDEX nChn = 0; nChn < GetNumChannels(); nChn++, pChn++)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6ee5c1d535b6041194a8decdd1ac255d2df96a6a",
      "candidate_info": {
        "commit_hash": "6ee5c1d535b6041194a8decdd1ac255d2df96a6a",
        "repo": "OpenMPT/openmpt",
        "commit_url": "https://github.com/OpenMPT/openmpt/commit/6ee5c1d535b6041194a8decdd1ac255d2df96a6a",
        "files": [
          "soundlib/Snd_fx.cpp"
        ],
        "message": "Merged revision(s) 10027 from trunk/OpenMPT: [Fix] Possible out-of-bounds read when computing length of some IT files with pattern loops (OpenMPT: formats that are converted to IT, libopenmpt: IT/ITP/MO3), caught with afl-fuzz. ........\n\ngit-svn-id: https://source.openmpt.org/svn/openmpt/branches/OpenMPT-1.27@10028 56274372-70c3-4bfc-bfc3-4c3a0b034d27",
        "before_after_code_files": [
          "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp"
          ],
          "candidate": [
            "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp"
          ]
        }
      },
      "candidate_diff": {
        "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp": [
          "File: soundlib/Snd_fx.cpp -> soundlib/Snd_fx.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "1174:    if(GetType() == MOD_TYPE_IT)",
          "1175:    {",
          "1178:     {",
          "1179:      if((pChn->rowCommand.command == CMD_S3MCMDEX && pChn->rowCommand.param >= 0xB1 && pChn->rowCommand.param <= 0xBF))",
          "1180:      {",
          "",
          "[Removed Lines]",
          "1177:     for(CHANNELINDEX nChn = 0; nChn < GetNumChannels(); nChn++)",
          "",
          "[Added Lines]",
          "1177:     pChn = playState.Chn;",
          "1178:     for(CHANNELINDEX nChn = 0; nChn < GetNumChannels(); nChn++, pChn++)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a6fc87a1da201fc224d9d1d9621d5c97550f3362",
      "candidate_info": {
        "commit_hash": "a6fc87a1da201fc224d9d1d9621d5c97550f3362",
        "repo": "OpenMPT/openmpt",
        "commit_url": "https://github.com/OpenMPT/openmpt/commit/a6fc87a1da201fc224d9d1d9621d5c97550f3362",
        "files": [
          "soundlib/Snd_fx.cpp"
        ],
        "message": "Merged revision(s) 10027 from trunk/OpenMPT: [Fix] Possible out-of-bounds read when computing length of some IT files with pattern loops (OpenMPT: formats that are converted to IT, libopenmpt: IT/ITP/MO3), caught with afl-fuzz. ........\n\ngit-svn-id: https://source.openmpt.org/svn/openmpt/branches/OpenMPT-1.26@10029 56274372-70c3-4bfc-bfc3-4c3a0b034d27",
        "before_after_code_files": [
          "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp"
          ],
          "candidate": [
            "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp"
          ]
        }
      },
      "candidate_diff": {
        "soundlib/Snd_fx.cpp||soundlib/Snd_fx.cpp": [
          "File: soundlib/Snd_fx.cpp -> soundlib/Snd_fx.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "1078:    if(GetType() == MOD_TYPE_IT)",
          "1079:    {",
          "1082:     {",
          "1083:      if((pChn->rowCommand.command == CMD_S3MCMDEX && pChn->rowCommand.param >= 0xB1 && pChn->rowCommand.param <= 0xBF))",
          "1084:      {",
          "",
          "[Removed Lines]",
          "1081:     for(CHANNELINDEX nChn = 0; nChn < GetNumChannels(); nChn++)",
          "",
          "[Added Lines]",
          "1081:     pChn = playState.Chn;",
          "1082:     for(CHANNELINDEX nChn = 0; nChn < GetNumChannels(); nChn++, pChn++)",
          "",
          "---------------"
        ]
      }
    }
  ]
}