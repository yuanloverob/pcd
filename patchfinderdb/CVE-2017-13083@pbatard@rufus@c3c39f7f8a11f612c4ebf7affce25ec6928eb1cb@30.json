{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c877284d2a1531c19e053452c97fdb3c84c79dde",
      "candidate_info": {
        "commit_hash": "c877284d2a1531c19e053452c97fdb3c84c79dde",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/c877284d2a1531c19e053452c97fdb3c84c79dde",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Korean translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "8810: ################################################################################",
          "8811: l \"ko-KR\" \"Korean (\ud55c\uad6d\uc5b4)\" 0x0412",
          "8813: b \"en-US\"",
          "8815: # Main dialog",
          "",
          "[Removed Lines]",
          "8812: v 1.0.20",
          "",
          "[Added Lines]",
          "8812: v 1.0.21",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "9246:  \"\uadf8\ub798\ub3c4 \uc774 \ud30c\uc77c\uc744 \uc2e4\ud589\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\"",
          "9247: t MSG_286 \"\ub4dc\ub77c\uc774\ube0c \uc81c\ub85c\ud544: %0.1f%% \uc644\ub8cc\"",
          "9248: t MSG_287 \"\ube44 \uc774\ub3d9\uc2dd USB \ub4dc\ub77c\uc774\ube0c \uac80\ucd9c\"",
          "9250: ################################################################################",
          "9251: l \"lv-LV\" \"Latvian (Latvie\u0161u)\" 0x0426",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9249: t MSG_288 \"\uad8c\ud55c \uc0c1\uc2b9 \uc2e4\ud328\"",
          "9250: t MSG_289 \"\uc774 \uc751\uc6a9 \ud504\ub85c\uadf8\ub7a8\uc740 \uc0c1\uc2b9\ub41c \uad8c\ud55c\uc73c\ub85c\ub9cc \uc2e4\ud589\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\"",
          "9251: t MSG_290 \"\ud30c\uc77c \uc778\ub371\uc2f1\"",
          "9252: t MSG_291 \"\ubc84\uc804 \uc120\ud0dd\"",
          "9253: t MSG_292 \"\uc124\uce58\ud560 Windows \ubc84\uc804\uc744 \uc120\ud0dd\ud558\uc2ed\uc2dc\uc624.:\"",
          "9254: t MSG_293 \"\uc9c0\uc6d0\ub418\uc9c0 \uc54a\ub294 Windows \ubc84\uc804\"",
          "9255: t MSG_294 \"\uc774 Windows \ubc84\uc804\uc740 Rufus\uc5d0\uc11c \ub354 \uc774\uc0c1 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.13.1061\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.13.1062\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,13,1061,0",
          "338:  PRODUCTVERSION 2,13,1061,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,13,1062,0",
          "338:  PRODUCTVERSION 2,13,1062,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1061\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1061\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1062\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1062\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a394b9731a450f4815faf4f4e161d2f79e48ceac",
      "candidate_info": {
        "commit_hash": "a394b9731a450f4815faf4f4e161d2f79e48ceac",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/a394b9731a450f4815faf4f4e161d2f79e48ceac",
        "files": [
          "res/localization/ChangeLog.txt",
          "res/localization/casper_test.iso",
          "res/localization/rufus.loc",
          "src/iso.c",
          "src/rufus.c",
          "src/rufus.h",
          "src/rufus.rc",
          "src/ui.c",
          "src/ui.h"
        ],
        "message": "[ui] add positioning, resizing & filling of the persistence controls\n\n* Also add a test ISO to display these controls\n* The intent is to use the next round of translation to get these new UI elements localized,\n  as any translation work takes _months_, and it is a precondition to start working on #691.\n* Also fix new issues with image options when switching language",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/iso.c||src/iso.c",
          "src/rufus.c||src/rufus.c",
          "src/rufus.h||src/rufus.h",
          "src/rufus.rc||src/rufus.rc",
          "src/ui.c||src/ui.c",
          "src/ui.h||src/ui.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "424: t MSG_197 \"Nonstandard sector size detected\"",
          "425: t MSG_198 \"'Windows To Go' can only be installed on a GPT partitioned drive if it has \"",
          "426:  \"the FIXED attribute set. The current drive was not detected as FIXED.\"",
          "428: # Status messages - these messages will appear on the status bar",
          "429: t MSG_201 \"Cancelling - Please wait...\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "427: t MSG_199 \"Persistent partition size\"",
          "",
          "---------------"
        ],
        "src/iso.c||src/iso.c": [
          "File: src/iso.c -> src/iso.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "89: static const char* reactos_name = \"setupldr.sys\"; // TODO: freeldr.sys doesn't seem to work",
          "90: static const char* kolibri_name = \"kolibri.img\";",
          "91: static const char* autorun_name = \"autorun.inf\";",
          "92: static const char* stupid_antivirus = \"  NOTE: This is usually caused by a poorly designed security solution. \"",
          "93:  \"See https://rufus.akeo.ie/compatibility.\\r\\n  This file will be skipped for now, but you should really \"",
          "94:  \"look into using a *SMARTER* antivirus solution.\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "92: static const char* casper_name = \"CASPER\";",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "193:    if (safe_stricmp(psz_basename, kolibri_name) == 0) {",
          "194:     img_report.has_kolibrios = TRUE;",
          "195:    }",
          "196:    if (safe_stricmp(psz_basename, bootmgr_efi_name) == 0) {",
          "197:     img_report.has_efi |= 1;",
          "198:    }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "197:    if (safe_stricmp(psz_basename, casper_name) == 0) {",
          "198:     img_report.has_casper = TRUE;",
          "199:    }",
          "",
          "---------------"
        ],
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "105: BOOL use_fake_units, preserve_timestamps = FALSE;",
          "106: BOOL zero_drive = FALSE, list_non_usb_removable_drives = FALSE, enable_file_indexing, large_drive = FALSE, write_as_image = FALSE;",
          "107: float fScale = 1.0f;",
          "109: int default_fs, fs, bt, pt, tt; // file system, boot type, partition type, target type",
          "110: char szFolderPath[MAX_PATH], app_dir[MAX_PATH], system_dir[MAX_PATH], temp_dir[MAX_PATH], sysnative_dir[MAX_PATH];",
          "111: char embedded_sl_version_str[2][12] = { \"?.??\", \"?.??\" };",
          "",
          "[Removed Lines]",
          "108: int dialog_showing = 0, selection_default, windows_to_go_selection = 0;",
          "",
          "[Added Lines]",
          "108: int dialog_showing = 0, selection_default = BT_IMAGE, windows_to_go_selection = 0, persistence_unit_selection = 0;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1568:   uprintf(\"If you think you can help update this translation, please e-mail the author of this application\");",
          "1569:  }",
          "1572:  CreateTaskbarList();",
          "1573:  SetTaskbarProgressState(TASKBAR_NORMAL);",
          "",
          "[Removed Lines]",
          "1571:  selection_default = BT_IMAGE;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1591:  IGNORE_RETVAL(ComboBox_SetItemData(hCtrl, ComboBox_AddStringU(hCtrl, lmprintf(MSG_117)), FALSE));",
          "1592:  IGNORE_RETVAL(ComboBox_SetItemData(hCtrl, ComboBox_AddStringU(hCtrl, lmprintf(MSG_118)), TRUE));",
          "1595:  IGNORE_RETVAL(ComboBox_SetItemData(hDiskID, ComboBox_AddStringU(hDiskID, lmprintf(MSG_030, LEFT_TO_RIGHT_EMBEDDING \"0x80\" POP_DIRECTIONAL_FORMATTING)), 0x80));",
          "1596:  for (i=1; i<=7; i++) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1594:  hCtrl = GetDlgItem(hMainDialog, IDC_PERSISTENCE_UNITS);",
          "1595:  for (i = 0; i < 3; i++)",
          "1596:   IGNORE_RETVAL(ComboBox_SetItemData(hCtrl, ComboBox_AddStringU(hCtrl, lmprintf(MSG_022 + i)), i));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1614:  AdjustForLowDPI(hDlg);",
          "1616:  SendMessage(hLogDialog, UM_RESIZE_BUTTONS, 0, 0);",
          "1618:  CreateStatusBar();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1622:  SendMessage(GetDlgItem(hDlg, IDC_PERSISTENCE_SIZE), EM_LIMITTEXT, 7, 0);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1856: static INT_PTR CALLBACK MainCallback(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)",
          "1857: {",
          "1858:  static DWORD DeviceNum = 0;",
          "1860:  static BOOL first_log_display = TRUE, isMarquee = FALSE, queued_hotplug_event = FALSE;",
          "1861:  static ULONG ulRegister = 0;",
          "1862:  static LPITEMIDLIST pidlDesktop = NULL;",
          "1863:  static SHChangeNotifyEntry NotifyEntry;",
          "1864:  static DWORD_PTR thread_affinity[4];",
          "",
          "[Removed Lines]",
          "1859:  static uint64_t LastRefresh = 0;",
          "",
          "[Added Lines]",
          "1865:  static uint64_t LastRefresh = 0, pos;",
          "1868:  static LONG lPos;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2039:    SetFileSystemAndClusterSize(NULL);",
          "2040:    windows_to_go_selection = ComboBox_GetCurSel(GetDlgItem(hDlg, IDC_IMAGE_OPTION));",
          "2041:    break;",
          "2042:   case IDC_NB_PASSES:",
          "2043:    if (HIWORD(wParam) != CBN_SELCHANGE)",
          "2044:     break;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2049:   case IDC_PERSISTENCE_UNITS:",
          "2050:    if (HIWORD(wParam) != CBN_SELCHANGE)",
          "2051:     break;",
          "2052:    if (ComboBox_GetCurSel(GetDlgItem(hDlg, IDC_PERSISTENCE_UNITS)) == persistence_unit_selection)",
          "2053:     break;",
          "2054:    GetWindowTextA(GetDlgItem(hMainDialog, IDC_PERSISTENCE_SIZE), tmp, sizeof(tmp));",
          "2055:    pos = atol(tmp) * MB;",
          "2056:    for (i = 0; i < persistence_unit_selection; i++)",
          "2057:     pos *= 1024;",
          "2058:    persistence_unit_selection = ComboBox_GetCurSel(GetDlgItem(hDlg, IDC_PERSISTENCE_UNITS));",
          "2060:    SetPersistenceSlider(pos, SelectedDrive.DiskSize - 4 * GB);",
          "2061:    break;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2379:   }",
          "2380:   break;",
          "2382:  case WM_DROPFILES:",
          "2383:   droppedFileInfo = (HDROP)wParam;",
          "2384:   wbuffer = calloc(MAX_PATH, sizeof(wchar_t));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2402:  case WM_HSCROLL:",
          "2403:   lPos = (LONG)SendMessage(GetDlgItem(hMainDialog, IDC_PERSISTENCE_SLIDER), TBM_GETPOS, 0, 0);",
          "2404:   sprintf(tmp, \"%ld\", lPos);",
          "2405:   SetWindowTextA(GetDlgItem(hMainDialog, IDC_PERSISTENCE_SIZE), tmp);",
          "2406:   break;",
          "",
          "---------------"
        ],
        "src/rufus.h||src/rufus.h": [
          "File: src/rufus.h -> src/rufus.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "282: #define IS_EFI_BOOTABLE(r)  (r.has_efi != 0)",
          "283: #define IS_BIOS_BOOTABLE(r) (HAS_BOOTMGR(r) || HAS_SYSLINUX(r) || HAS_WINPE(r) || HAS_GRUB(r) || HAS_REACTOS(r) || HAS_KOLIBRIOS(r))",
          "284: #define HAS_WINTOGO(r)      (HAS_BOOTMGR(r) && IS_EFI_BOOTABLE(r) && HAS_INSTALL_WIM(r) && (r.install_wim_version < MAX_WIM_VERSION))",
          "291: #define IS_FAT(fs)          ((fs == FS_FAT16) || (fs == FS_FAT32))",
          "293: typedef struct {",
          "",
          "[Removed Lines]",
          "285: #ifdef RUFUS_TEST",
          "287: #define HAS_PERSISTENCE(r)  HAS_SYSLINUX(r)",
          "288: #else",
          "289: #define HAS_PERSISTENCE(r)  FALSE",
          "290: #endif",
          "",
          "[Added Lines]",
          "285: #define HAS_PERSISTENCE(r)  (r.has_casper)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "320:  BOOLEAN uses_minint;",
          "321:  BOOLEAN compression_type;",
          "322:  BOOLEAN is_vhd;",
          "323:  uint16_t sl_version; // Syslinux/Isolinux version",
          "324:  char sl_version_str[12];",
          "325:  char sl_version_ext[32];",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "318:  BOOLEAN has_casper;",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.2.1330\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.2.1331\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "47:     LTEXT           \"Image option\",IDS_IMAGE_OPTION_TXT,8,65,216,8",
          "48:     COMBOBOX        IDC_IMAGE_OPTION,8,74,96,30,CBS_DROPDOWNLIST | WS_VSCROLL | WS_TABSTOP",
          "49:     CONTROL         \"\",IDC_PERSISTENCE_SLIDER,\"msctls_trackbar32\",TBS_BOTH | TBS_NOTICKS | WS_TABSTOP,125,76,34,8",
          "51:     COMBOBOX        IDC_PERSISTENCE_UNITS,200,74,24,30,CBS_DROPDOWNLIST | WS_VSCROLL | WS_TABSTOP",
          "52:     LTEXT           \"Partition scheme\",IDS_PARTITION_TYPE_TXT,8,87,96,8",
          "53:     COMBOBOX        IDC_PARTITION_TYPE,8,96,96,30,CBS_DROPDOWNLIST | WS_VSCROLL | WS_TABSTOP",
          "",
          "[Removed Lines]",
          "50:     EDITTEXT        IDC_PERSISTENCE_SIZE,160,74,36,12,ES_AUTOHSCROLL",
          "",
          "[Added Lines]",
          "50:     EDITTEXT        IDC_PERSISTENCE_SIZE,160,74,36,12,ES_AUTOHSCROLL | ES_NUMBER,WS_EX_RIGHT",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "394: VS_VERSION_INFO VERSIONINFO",
          "397:  FILEFLAGSMASK 0x3fL",
          "398: #ifdef _DEBUG",
          "399:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "395:  FILEVERSION 3,2,1330,0",
          "396:  PRODUCTVERSION 3,2,1330,0",
          "",
          "[Added Lines]",
          "395:  FILEVERSION 3,2,1331,0",
          "396:  PRODUCTVERSION 3,2,1331,0",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "410:         BEGIN",
          "411:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "412:             VALUE \"FileDescription\", \"Rufus\"",
          "414:             VALUE \"InternalName\", \"Rufus\"",
          "415:             VALUE \"LegalCopyright\", \"\u00a9 2011-2018 Pete Batard (GPL v3)\"",
          "416:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "417:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "418:             VALUE \"ProductName\", \"Rufus\"",
          "420:         END",
          "421:     END",
          "422:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "413:             VALUE \"FileVersion\", \"3.2.1330\"",
          "419:             VALUE \"ProductVersion\", \"3.2.1330\"",
          "",
          "[Added Lines]",
          "413:             VALUE \"FileVersion\", \"3.2.1331\"",
          "419:             VALUE \"ProductVersion\", \"3.2.1331\"",
          "",
          "---------------"
        ],
        "src/ui.c||src/ui.c": [
          "File: src/ui.c -> src/ui.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: #include <string.h>",
          "31: #include <winioctl.h>",
          "32: #include <assert.h>",
          "35: #include \"rufus.h\"",
          "36: #include \"drive.h\"",
          "",
          "[Removed Lines]",
          "33: #include <intrin.h>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "298:  GetWindowRect(hCtrl, &rc);",
          "299:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "300:  SetWindowPos(hCtrl, hAdvancedFormatToolbar, rc.left, rc.top, rc.right - rc.left, ddh, SWP_NOZORDER);",
          "301:  GetWindowRect(hProgress, &rc);",
          "302:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "303:  SetWindowPos(hProgress, hNBPasses, rc.left, rc.top, rc.right - rc.left, ddh, SWP_NOZORDER);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "300:  hCtrl = GetDlgItem(hDlg, IDC_PERSISTENCE_SIZE);",
          "301:  GetWindowRect(hCtrl, &rc);",
          "302:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "303:  SetWindowPos(hCtrl, GetDlgItem(hDlg, IDC_PERSISTENCE_SLIDER), rc.left, rc.top, rc.right - rc.left, ddh, SWP_NOZORDER);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "392:  SendMessage(hHashToolbar, TB_SETPADDING, 0, MAKELPARAM(sz.cx + 3, sz.cy + 2));",
          "393:  SetWindowPos(hHashToolbar, hBootType, mw + bsw + ssw, rc.top, sbw, ddbh, 0);",
          "396:  hCtrl = GetDlgItem(hDlg, IDS_CSM_HELP_TXT);",
          "397:  GetWindowRect(hCtrl, &rc);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "399:  hCtrl = GetDlgItem(hDlg, IDC_PERSISTENCE_SLIDER);",
          "400:  GetWindowRect(hCtrl, &rc);",
          "401:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "402:  SetWindowPos(hCtrl, hTargetSystem, mw, rc.top, bsw, rc.bottom - rc.top, 0);",
          "405:  hCtrl = GetDlgItem(hDlg, IDC_PERSISTENCE_UNITS);",
          "406:  GetWindowRect(hCtrl, &rc);",
          "407:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "408:  sz.cx = fw - (rc.right - rc.left);",
          "409:  SetWindowPos(hCtrl, hTargetSystem, mw + sz.cx, rc.top, rc.right - rc.left, rc.bottom - rc.top, 0);",
          "412:  hCtrl = GetDlgItem(hDlg, IDC_PERSISTENCE_SIZE);",
          "413:  GetWindowRect(hCtrl, &rc);",
          "414:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "415:  SetWindowPos(hCtrl, hTargetSystem, mw + bsw + ssw, rc.top, sz.cx - bsw - 2*ssw, rc.bottom - rc.top, 0);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "613:  InvalidateRect(hMainDialog, NULL, TRUE);",
          "614: }",
          "617: void ToggleImageOption(uint8_t mask)",
          "618: {",
          "619:  int i, shift = (popcnt8(image_options) >= 2) ? 0 : rh;",
          "621:  assert(popcnt8(mask) <= 1);",
          "623:  if (mask & IMOP_WINTOGO) {",
          "624:   if (nWindowsVersion < WINDOWS_8)",
          "625:    return;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "638: void SetPersistenceSlider(uint64_t pos, uint64_t max)",
          "639: {",
          "640:  char tmp[12];",
          "641:  int i;",
          "642:  IGNORE_RETVAL(ComboBox_SetCurSel(GetDlgItem(hMainDialog, IDC_PERSISTENCE_UNITS), persistence_unit_selection));",
          "643:  pos /= MB;",
          "644:  max /= MB;",
          "645:  for (i = 0; i < persistence_unit_selection; i++) {",
          "646:   pos /= 1024;",
          "647:   max /= 1024;",
          "648:  }",
          "649:  SendMessage(GetDlgItem(hMainDialog, IDC_PERSISTENCE_SLIDER), TBM_SETRANGEMIN, (WPARAM)FALSE, (LPARAM)0);",
          "650:  SendMessage(GetDlgItem(hMainDialog, IDC_PERSISTENCE_SLIDER), TBM_SETRANGEMAX, (WPARAM)FALSE, (LPARAM)max);",
          "651:  SendMessage(GetDlgItem(hMainDialog, IDC_PERSISTENCE_SLIDER), TBM_SETPOS, (WPARAM)TRUE, (LPARAM)pos);",
          "652:  static_sprintf(tmp, \"%ld\", (LONG)pos);",
          "653:  SetWindowTextA(GetDlgItem(hMainDialog, IDC_PERSISTENCE_SIZE), tmp);",
          "654: }",
          "659:  static BOOL relaunch = FALSE;",
          "660:  static char image_option_txt[128] = \"\";",
          "666:  if (mask == 0) {",
          "667:   if (relaunch) {",
          "668:    if ((selection_default == BT_IMAGE) && (image_path != NULL))",
          "669:     goto skip;",
          "670:   } else {",
          "671:    relaunch = TRUE;",
          "673:    GetWindowTextU(GetDlgItem(hMainDialog, IDS_IMAGE_OPTION_TXT), image_option_txt, sizeof(image_option_txt));",
          "674:   }",
          "675:  }",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "649:   }",
          "650:  }",
          "653:  for (i = 0; i < ARRAYSIZE(image_option_toggle_ids); i++) {",
          "654:   ShowWindow(GetDlgItem(hMainDialog, image_option_toggle_ids[i][0]),",
          "655:    (image_options & image_option_toggle_ids[i][1]) ? SW_SHOW : SW_HIDE);",
          "656:  }",
          "659:  InvalidateRect(hMainDialog, NULL, TRUE);",
          "660: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "706: skip:",
          "713:  if (image_options & IMOP_WINTOGO) {",
          "714:   SetWindowTextU(GetDlgItem(hMainDialog, IDS_IMAGE_OPTION_TXT), image_option_txt);",
          "715:   IGNORE_RETVAL(ComboBox_SetCurSel(GetDlgItem(hMainDialog, IDC_IMAGE_OPTION), windows_to_go_selection));",
          "716:  } else if (image_options & IMOP_PERSISTENCE) {",
          "717:   SetWindowTextU(GetDlgItem(hMainDialog, IDS_IMAGE_OPTION_TXT), lmprintf(MSG_199));",
          "719:   uint64_t max_size = SelectedDrive.DiskSize - 4 * GB;",
          "720:   SetPersistenceSlider(max_size / 2, max_size);",
          "721:  }",
          "",
          "---------------"
        ],
        "src/ui.h||src/ui.h": [
          "File: src/ui.h -> src/ui.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "50: extern loc_cmd* selected_locale;",
          "51: extern const char *sfd_name, *flash_type[BADLOCKS_PATTERN_TYPES];",
          "52: extern char *short_image_path;",
          "54: extern int selection_default, cbw, ddw, ddbh, bh;",
          "56: extern void SetComboEntry(HWND hDlg, int data);",
          "",
          "[Removed Lines]",
          "53: extern int advanced_device_section_height, advanced_format_section_height, windows_to_go_selection;",
          "",
          "[Added Lines]",
          "53: extern int advanced_device_section_height, advanced_format_section_height;",
          "54: extern int windows_to_go_selection, persistence_unit_selection;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "61: extern void PositionMainControls(HWND hDlg);",
          "62: extern void AdjustForLowDPI(HWND hDlg);",
          "63: extern void SetSectionHeaders(HWND hDlg);",
          "64: extern void ToggleAdvancedDeviceOptions(BOOL enable);",
          "65: extern void ToggleAdvancedFormatOptions(BOOL enable);",
          "66: extern void ToggleImageOption(uint8_t mask);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "65: extern void SetPersistenceSlider(uint64_t pos, uint64_t max);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "40b0d9e0d21748aa465ef96674f407fc11d20f40",
      "candidate_info": {
        "commit_hash": "40b0d9e0d21748aa465ef96674f407fc11d20f40",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/40b0d9e0d21748aa465ef96674f407fc11d20f40",
        "files": [
          "src/rufus.c",
          "src/rufus.rc",
          "src/ui.h"
        ],
        "message": "[ui] minor cosmetic improvements",
        "before_after_code_files": [
          "src/rufus.c||src/rufus.c",
          "src/rufus.rc||src/rufus.rc",
          "src/ui.h||src/ui.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: static int64_t last_iso_blocking_status;",
          "69: static int windows_to_go_selection = 0, selected_pt = -1, selected_fs = -1;",
          "70: static int selection_default, row_height, advanced_device_section_height, advanced_format_section_height, image_index;",
          "72: static int ddh, bw, hw, fw; // DropDown Height, Main button width, half dropdown width, full dropdown width",
          "73: static int sw, mw, bsw, sbw, ssw, tw, dbw; // See GetFullWidth() for details on how these values are used",
          "74: static UINT_PTR UM_LANGUAGE_MENU_MAX = UM_LANGUAGE_MENU;",
          "",
          "[Removed Lines]",
          "71: static int device_vpos, format_vpos, status_vpos;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1202:  if (!enable)",
          "1203:   shift = -shift;",
          "1208:  utf8_to_wchar_no_alloc(lmprintf((enable) ? MSG_122 : MSG_121, lmprintf(MSG_119)), wtbtext[0], ARRAYSIZE(wtbtext[0]));",
          "",
          "[Removed Lines]",
          "1204:  format_vpos += shift;",
          "1205:  status_vpos += shift;",
          "",
          "[Added Lines]",
          "1203:  section_vpos[1] += shift;",
          "1204:  section_vpos[2] += shift;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1246:  if (!enable)",
          "1247:   shift = -shift;",
          "1251:  utf8_to_wchar_no_alloc(lmprintf((enable) ? MSG_122 : MSG_121, lmprintf(MSG_120)), wtbtext[1], ARRAYSIZE(wtbtext[0]));",
          "",
          "[Removed Lines]",
          "1248:  status_vpos += shift;",
          "",
          "[Added Lines]",
          "1247:  section_vpos[2] += shift;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1287:  display_togo_option = !display_togo_option;",
          "1288:  if (!display_togo_option)",
          "1289:   shift = -shift;",
          "1294:  for (i = 0; i<ARRAYSIZE(image_option_move_ids); i++)",
          "",
          "[Removed Lines]",
          "1290:  format_vpos += shift;",
          "1291:  status_vpos += shift;",
          "",
          "[Added Lines]",
          "1289:  section_vpos[1] += shift;",
          "1290:  section_vpos[2] += shift;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2353:  GetWindowRect(hCtrl, &rc);",
          "2354:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "2355:  sz = GetTextSize(hCtrl, NULL);",
          "2357:  hCtrl = GetDlgItem(hDlg, IDS_FORMAT_OPTIONS_TXT);",
          "2358:  GetWindowRect(hCtrl, &rc);",
          "2359:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "2360:  sz = GetTextSize(hCtrl, NULL);",
          "2362:  hCtrl = GetDlgItem(hDlg, IDS_STATUS_TXT);",
          "2363:  GetWindowRect(hCtrl, &rc);",
          "2364:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "2365:  sz = GetTextSize(hCtrl, NULL);",
          "",
          "[Removed Lines]",
          "2356:  device_vpos = rc.top + 2 * sz.cy / 3;",
          "2361:  format_vpos = rc.top + 2 * sz.cy / 3;",
          "2366:  status_vpos = rc.top + 2 * sz.cy / 3;",
          "",
          "[Added Lines]",
          "2355:  section_vpos[0] = rc.top + 2 * sz.cy / 3;",
          "2360:  section_vpos[1] = rc.top + 2 * sz.cy / 3;",
          "2365:  section_vpos[2] = rc.top + 2 * sz.cy / 3;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2468:   }",
          "2469:  }",
          "2473:  advanced_device_section_height += 3 * ddy;",
          "2474:  advanced_format_section_height += 3 * ddy + 1;",
          "",
          "[Removed Lines]",
          "2471:  format_vpos += 9 * ddy;",
          "2472:  status_vpos += 16 * ddy + 1;",
          "",
          "[Added Lines]",
          "2470:  section_vpos[1] += 9 * ddy;",
          "2471:  section_vpos[2] += 16 * ddy + 1;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2484:  SIZE sz;",
          "2485:  HFONT hf;",
          "2486:  wchar_t wtmp[128];",
          "2490:  hf = CreateFontA(-MulDiv(14, GetDeviceCaps(GetDC(hMainDialog), LOGPIXELSY), 72), 0, 0, 0,",
          "2491:   FW_SEMIBOLD, FALSE, FALSE, FALSE, DEFAULT_CHARSET, 0, 0, PROOF_QUALITY, 0, \"Segoe UI\");",
          "2496:   memset(wtmp, 0, sizeof(wtmp));",
          "2497:   GetWindowTextW(hCtrl, wtmp, ARRAYSIZE(wtmp));",
          "2499:   SetWindowTextW(hCtrl, wtmp);",
          "2500:   GetWindowRect(hCtrl, &rc);",
          "2501:   MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "",
          "[Removed Lines]",
          "2487:  int i, control[3] = { IDS_DRIVE_PROPERTIES_TXT, IDS_FORMAT_OPTIONS_TXT, IDS_STATUS_TXT };",
          "2493:  for (i = 0; i < ARRAYSIZE(control); i++) {",
          "2494:   SendDlgItemMessageA(hDlg, control[i], WM_SETFONT, (WPARAM)hf, TRUE);",
          "2495:   hCtrl = GetDlgItem(hDlg, control[i]);",
          "2498:   wtmp[wcslen(wtmp)] = ' ';",
          "",
          "[Added Lines]",
          "2486:  size_t wlen;",
          "2487:  int i;",
          "2493:  for (i = 0; i < ARRAYSIZE(section_control_ids); i++) {",
          "2494:   SendDlgItemMessageA(hDlg, section_control_ids[i], WM_SETFONT, (WPARAM)hf, TRUE);",
          "2495:   hCtrl = GetDlgItem(hDlg, section_control_ids[i]);",
          "2498:   wlen = wcslen(wtmp);",
          "2499:   wtmp[wlen++] = L' ';",
          "2500:   wtmp[wlen++] = L' ';",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2508: void OnPaint(HDC hdc)",
          "2509: {",
          "2510:  HPEN hp = CreatePen(0, (fScale < 1.5f)?2:3, RGB(0, 0, 0));",
          "2511:  SelectObject(hdc, hp);",
          "2518: }",
          "2520: static void InitDialog(HWND hDlg)",
          "",
          "[Removed Lines]",
          "2512:  MoveToEx(hdc, mw + 10, device_vpos, NULL);",
          "2513:  LineTo(hdc, mw + fw, device_vpos);",
          "2514:  MoveToEx(hdc, mw + 10, format_vpos, NULL);",
          "2515:  LineTo(hdc, mw + fw, format_vpos);",
          "2516:  MoveToEx(hdc, mw + 10, status_vpos, NULL);",
          "2517:  LineTo(hdc, mw + fw, status_vpos);",
          "",
          "[Added Lines]",
          "2512:  int i;",
          "2515:  for (i = 0; i < ARRAYSIZE(section_vpos); i++) {",
          "2516:   MoveToEx(hdc, mw + 10, section_vpos[i], NULL);",
          "2517:   LineTo(hdc, mw + fw, section_vpos[i]);",
          "2518:  }",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "3496:   SetBkMode((HDC)wParam, TRANSPARENT);",
          "3497:   CreateStaticFont((HDC)wParam, &hyperlink_font, FALSE);",
          "3498:   SelectObject((HDC)wParam, hyperlink_font);",
          "3500:   return (INT_PTR)CreateSolidBrush(GetSysColor(COLOR_BTNFACE));",
          "3502:  case WM_NOTIFY:",
          "",
          "[Removed Lines]",
          "3499:   SetTextColor((HDC)wParam, RGB(0, 0, 125)); // DARK_BLUE",
          "",
          "[Added Lines]",
          "3500:   SetTextColor((HDC)wParam, TOOLBAR_ICON_COLOR);",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1274\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1275\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,0,1274,0",
          "393:  PRODUCTVERSION 3,0,1274,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,0,1275,0",
          "393:  PRODUCTVERSION 3,0,1275,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.0.1274\"",
          "416:             VALUE \"ProductVersion\", \"3.0.1274\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.0.1275\"",
          "416:             VALUE \"ProductVersion\", \"3.0.1275\"",
          "",
          "---------------"
        ],
        "src/ui.h||src/ui.h": [
          "File: src/ui.h -> src/ui.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: #define PROGRESS_BAR_PAUSED_COLOR   RGB(0xDA, 0xCB, 0x26)",
          "32: #define PROGRESS_BAR_ERROR_COLOR   RGB(0xDA, 0x26, 0x26)",
          "34: static int image_option_move_ids[] = {",
          "35:  IDS_PARTITION_TYPE_TXT,",
          "36:  IDC_PARTITION_TYPE,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: #define TOOLBAR_ICON_COLOR     RGB(0x29, 0x80, 0xB9)",
          "37: static int section_control_ids[] = {",
          "38:  IDS_DRIVE_PROPERTIES_TXT,",
          "39:  IDS_FORMAT_OPTIONS_TXT,",
          "40:  IDS_STATUS_TXT",
          "41: };",
          "43: static int section_vpos[ARRAYSIZE(section_control_ids)];",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "08b6ce38c253e8fe342091488f8c335ccf84e918",
      "candidate_info": {
        "commit_hash": "08b6ce38c253e8fe342091488f8c335ccf84e918",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/08b6ce38c253e8fe342091488f8c335ccf84e918",
        "files": [
          "src/drive.c",
          "src/rufus.rc"
        ],
        "message": "[core] fix a potential Could not get Disk Extents message\n\n* Reported in #880",
        "before_after_code_files": [
          "src/drive.c||src/drive.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/drive.c||src/drive.c": [
          "File: src/drive.c -> src/drive.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "197:  HANDLE hDrive = INVALID_HANDLE_VALUE, hVolume = INVALID_HANDLE_VALUE;",
          "198:  size_t len;",
          "199:  char path[MAX_PATH];",
          "201:  DWORD size;",
          "202:  UINT drive_type;",
          "203:  int i, j;",
          "",
          "[Removed Lines]",
          "200:  VOLUME_DISK_EXTENTS DiskExtents;",
          "",
          "[Added Lines]",
          "200:  VOLUME_DISK_EXTENTS_REDEF DiskExtents;",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1015\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1016\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1015,0",
          "338:  PRODUCTVERSION 2,12,1015,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1016,0",
          "338:  PRODUCTVERSION 2,12,1016,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1015\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1015\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1016\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1016\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "476ef267d2d26496b7e5989c224da0f6e1341b77",
      "candidate_info": {
        "commit_hash": "476ef267d2d26496b7e5989c224da0f6e1341b77",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/476ef267d2d26496b7e5989c224da0f6e1341b77",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Romanian translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "13194: ################################################################################",
          "13195: l \"ro-RO\" \"Romanian (Rom\u00e2n\u0103)\" 0x0418, 0x0818",
          "13197: b \"en-US\"",
          "13199: g IDD_DIALOG",
          "",
          "[Removed Lines]",
          "13196: v 1.0.21",
          "",
          "[Added Lines]",
          "13196: v 1.0.22",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "13614: t MSG_292 \"Selecta\u021bi versiunea de Windows pentru instalare: \"",
          "13615: t MSG_293 \"Versiune Windows neacceptat\u0103\"",
          "13616: t MSG_294 \"Aceast\u0103 versiune Windows nu mai este suportat\u0103 de Rufus.\"",
          "13618: ################################################################################",
          "13619: l \"ru-RU\" \"Russian (\u0420\u0443\u0441\u0441\u043a\u0438\u0439)\" 0x0419, 0x0819",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "13617: t MSG_295 \"Aten\u021bie: versiune neoficial\u0103\"",
          "13618: t MSG_296 \"Aceast\u0103 versiune de Rufus nu a fost produs\u0103 de dezvoltatorul oficial.\\n\\nSigur dori\u021bi s\u0103 \u00eel rula\u021bi?\"",
          "13619: t MSG_297 \"S-a detectat un ISO trunchiat\"",
          "13620: t MSG_298 \"Fi\u0219ierul ISO pe care l-a\u021bi selectat nu se potrive\u0219te dimensiunii sale declarate: %s de date lipsesc!\\n\\nDac\u0103 a\u021bi ob\u021binut \"",
          "13621:  \"acest fi\u0219ier de pe Internet, ar trebui s\u0103 \u00eencerca\u021bi s\u0103 desc\u0103rca\u021bi o copie nou\u0103 \u0219i s\u0103 verifica\u021bi dac\u0103 sumele de control MD5 sau SHA se potrivesc \"",
          "13622:  \"cu cele oficiale.\\n\\nRe\u021bine\u021bi c\u0103 pute\u021bi calcula MD5 sau SHA \u00een Rufus f\u0103c\u00e2nd clic pe butonul '#'.\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.16.1140\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.16.1141\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,16,1140,0",
          "370:  PRODUCTVERSION 2,16,1140,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,16,1141,0",
          "370:  PRODUCTVERSION 2,16,1141,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1140\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1140\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1141\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1141\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}