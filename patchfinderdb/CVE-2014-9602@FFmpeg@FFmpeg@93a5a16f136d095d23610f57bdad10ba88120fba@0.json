{
  "cve_id": "CVE-2014-9602",
  "cve_desc": "libavcodec/xface.h in FFmpeg before 2.5.2 establishes certain digits and words array dimensions that do not satisfy a required mathematical relationship, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted X-Face image data.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "93a5a16f136d095d23610f57bdad10ba88120fba",
  "patch_info": {
    "commit_hash": "93a5a16f136d095d23610f57bdad10ba88120fba",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/93a5a16f136d095d23610f57bdad10ba88120fba",
    "files": [
      "libavcodec/xface.h"
    ],
    "message": "avcodec/xface: correct the XFACE_MAX_* values\n\nFixes out of array access\n\nFixes: asan_stack-oob_32c12e5_2536_cov_2442316831_lena.xface\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "before_after_code_files": [
      "libavcodec/xface.h||libavcodec/xface.h"
    ]
  },
  "patch_diff": {
    "libavcodec/xface.h||libavcodec/xface.h": [
      "File: libavcodec/xface.h -> libavcodec/xface.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "50: #define XFACE_BITSPERWORD 8",
      "51: #define XFACE_WORDCARRY (1 << XFACE_BITSPERWORD)",
      "52: #define XFACE_WORDMASK (XFACE_WORDCARRY - 1)",
      "",
      "[Removed Lines]",
      "48: #define XFACE_MAX_DIGITS 704",
      "54: #define XFACE_MAX_WORDS ((XFACE_PIXELS * 2 + XFACE_BITSPERWORD - 1) / XFACE_BITSPERWORD)",
      "",
      "[Added Lines]",
      "47: #define XFACE_MAX_DIGITS 666",
      "54: #define XFACE_MAX_WORDS 546",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "991ef3a67ec66b3f4e11752eff48b6ae925a1ba7",
      "candidate_info": {
        "commit_hash": "991ef3a67ec66b3f4e11752eff48b6ae925a1ba7",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/991ef3a67ec66b3f4e11752eff48b6ae925a1ba7",
        "files": [
          "libavcodec/xface.h"
        ],
        "message": "avcodec/xface: correct the XFACE_MAX_* values\n\nFixes out of array access\n\nFixes: asan_stack-oob_32c12e5_2536_cov_2442316831_lena.xface\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 93a5a16f136d095d23610f57bdad10ba88120fba)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/xface.h||libavcodec/xface.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/xface.h||libavcodec/xface.h"
          ],
          "candidate": [
            "libavcodec/xface.h||libavcodec/xface.h"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/xface.h||libavcodec/xface.h": [
          "File: libavcodec/xface.h -> libavcodec/xface.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "50: #define XFACE_BITSPERWORD 8",
          "51: #define XFACE_WORDCARRY (1 << XFACE_BITSPERWORD)",
          "52: #define XFACE_WORDMASK (XFACE_WORDCARRY - 1)",
          "",
          "[Removed Lines]",
          "48: #define XFACE_MAX_DIGITS 704",
          "54: #define XFACE_MAX_WORDS ((XFACE_PIXELS * 2 + XFACE_BITSPERWORD - 1) / XFACE_BITSPERWORD)",
          "",
          "[Added Lines]",
          "47: #define XFACE_MAX_DIGITS 666",
          "54: #define XFACE_MAX_WORDS 546",
          "",
          "---------------"
        ]
      }
    }
  ]
}