{
  "cve_id": "CVE-2016-7151",
  "cve_desc": "Capstone 3.0.4 has an out-of-bounds vulnerability (SEGV caused by a read memory access) in X86_insn_reg_intel in arch/X86/X86Mapping.c.",
  "repo": "aquynh/capstone",
  "patch_hash": "87a25bb543c8e4c09b48d4b4a6c7db31ce58df06",
  "patch_info": {
    "commit_hash": "87a25bb543c8e4c09b48d4b4a6c7db31ce58df06",
    "repo": "aquynh/capstone",
    "commit_url": "https://github.com/aquynh/capstone/commit/87a25bb543c8e4c09b48d4b4a6c7db31ce58df06",
    "files": [
      "arch/X86/X86Mapping.c"
    ],
    "message": "x86: fast path checking for X86_insn_reg_intel()",
    "before_after_code_files": [
      "arch/X86/X86Mapping.c||arch/X86/X86Mapping.c"
    ]
  },
  "patch_diff": {
    "arch/X86/X86Mapping.c||arch/X86/X86Mapping.c": [
      "File: arch/X86/X86Mapping.c -> arch/X86/X86Mapping.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2930:  return (l - r);",
      "2931: }",
      "2937: x86_reg X86_insn_reg_intel(unsigned int id, enum cs_ac_type *access)",
      "2938: {",
      "2939:  unsigned int first = 0;",
      "2940:  unsigned int last = ARR_SIZE(insn_regs_intel) - 1;",
      "2943:  if (!intel_regs_sorted) {",
      "2944:   memcpy(insn_regs_intel_sorted, insn_regs_intel,",
      "",
      "[Removed Lines]",
      "2933: static bool intel_regs_sorted = false;",
      "2941:  unsigned int mid = ARR_SIZE(insn_regs_intel) / 2;",
      "",
      "[Added Lines]",
      "2938:  static bool intel_regs_sorted = false;",
      "2941:  unsigned int mid;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2949:   intel_regs_sorted = true;",
      "2950:  }",
      "2952:  while (first <= last) {",
      "2953:   if (insn_regs_intel_sorted[mid].insn < id) {",
      "2954:    first = mid + 1;",
      "2955:   } else if (insn_regs_intel_sorted[mid].insn == id) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2952:  if (insn_regs_intel_sorted[0].insn > id ||",
      "2953:    insn_regs_intel_sorted[last].insn < id) {",
      "2954:   return 0;",
      "2955:  }",
      "2958:   mid = (first + last) / 2;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "2962:     break;",
      "2963:    last = mid - 1;",
      "2964:   }",
      "2966:  }",
      "",
      "[Removed Lines]",
      "2965:   mid = (first + last) / 2;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8ae679e0dee211a7ea0cbebb50a978e63414877a",
      "candidate_info": {
        "commit_hash": "8ae679e0dee211a7ea0cbebb50a978e63414877a",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/8ae679e0dee211a7ea0cbebb50a978e63414877a",
        "files": [
          "msvc/capstone_static/capstone_static.vcxproj"
        ],
        "message": "Added compile configurations for WDK",
        "before_after_code_files": [
          "msvc/capstone_static/capstone_static.vcxproj||msvc/capstone_static/capstone_static.vcxproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "msvc/capstone_static/capstone_static.vcxproj||msvc/capstone_static/capstone_static.vcxproj": [
          "File: msvc/capstone_static/capstone_static.vcxproj -> msvc/capstone_static/capstone_static.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "6:       <Platform>Win32</Platform>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "4:     <ProjectConfiguration Include=\"Debug_WDK|Win32\">",
          "5:       <Configuration>Debug_WDK</Configuration>",
          "6:       <Platform>Win32</Platform>",
          "7:     </ProjectConfiguration>",
          "8:     <ProjectConfiguration Include=\"Debug_WDK|x64\">",
          "9:       <Configuration>Debug_WDK</Configuration>",
          "10:       <Platform>x64</Platform>",
          "11:     </ProjectConfiguration>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "9:       <Configuration>Debug</Configuration>",
          "10:       <Platform>x64</Platform>",
          "11:     </ProjectConfiguration>",
          "12:     <ProjectConfiguration Include=\"Release|Win32\">",
          "13:       <Configuration>Release</Configuration>",
          "14:       <Platform>Win32</Platform>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "20:     <ProjectConfiguration Include=\"Release_WDK|Win32\">",
          "21:       <Configuration>Release_WDK</Configuration>",
          "22:       <Platform>Win32</Platform>",
          "23:     </ProjectConfiguration>",
          "24:     <ProjectConfiguration Include=\"Release_WDK|x64\">",
          "25:       <Configuration>Release_WDK</Configuration>",
          "26:       <Platform>x64</Platform>",
          "27:     </ProjectConfiguration>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "67:     <Keyword>Win32Proj</Keyword>",
          "68:     <RootNamespace>capstonewin32</RootNamespace>",
          "69:     <ProjectName>capstone_static</ProjectName>",
          "70:   </PropertyGroup>",
          "71:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "72:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "73:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "74:     <UseDebugLibraries>true</UseDebugLibraries>",
          "75:     <CharacterSet>Unicode</CharacterSet>",
          "76:   </PropertyGroup>",
          "77:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "78:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "79:     <UseDebugLibraries>true</UseDebugLibraries>",
          "80:     <CharacterSet>Unicode</CharacterSet>",
          "81:   </PropertyGroup>",
          "82:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "83:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "84:     <UseDebugLibraries>false</UseDebugLibraries>",
          "85:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "86:     <CharacterSet>Unicode</CharacterSet>",
          "87:   </PropertyGroup>",
          "88:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "89:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "90:     <UseDebugLibraries>false</UseDebugLibraries>",
          "91:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "92:     <CharacterSet>Unicode</CharacterSet>",
          "93:   </PropertyGroup>",
          "94:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "95:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "86:     <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>",
          "93:     <PlatformToolset>v140</PlatformToolset>",
          "94:   </PropertyGroup>",
          "95:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\" Label=\"Configuration\">",
          "96:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "97:     <UseDebugLibraries>true</UseDebugLibraries>",
          "98:     <CharacterSet>Unicode</CharacterSet>",
          "99:     <PlatformToolset>v140</PlatformToolset>",
          "105:     <PlatformToolset>v140</PlatformToolset>",
          "106:   </PropertyGroup>",
          "107:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\" Label=\"Configuration\">",
          "108:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "109:     <UseDebugLibraries>true</UseDebugLibraries>",
          "110:     <CharacterSet>Unicode</CharacterSet>",
          "111:     <PlatformToolset>v140</PlatformToolset>",
          "118:     <PlatformToolset>v140</PlatformToolset>",
          "119:   </PropertyGroup>",
          "120:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\" Label=\"Configuration\">",
          "121:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "122:     <UseDebugLibraries>false</UseDebugLibraries>",
          "123:     <CharacterSet>Unicode</CharacterSet>",
          "124:     <PlatformToolset>v140</PlatformToolset>",
          "131:     <PlatformToolset>v140</PlatformToolset>",
          "132:   </PropertyGroup>",
          "133:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\" Label=\"Configuration\">",
          "134:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "135:     <UseDebugLibraries>false</UseDebugLibraries>",
          "136:     <CharacterSet>Unicode</CharacterSet>",
          "137:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "97:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "98:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "99:   </ImportGroup>",
          "100:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"PropertySheets\">",
          "101:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "102:   </ImportGroup>",
          "103:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "104:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "105:   </ImportGroup>",
          "106:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"PropertySheets\">",
          "107:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "108:   </ImportGroup>",
          "109:   <PropertyGroup Label=\"UserMacros\" />",
          "110:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "111:     <TargetName>capstone</TargetName>",
          "112:   </PropertyGroup>",
          "113:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "114:     <TargetName>capstone</TargetName>",
          "115:   </PropertyGroup>",
          "116:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "117:     <TargetName>capstone</TargetName>",
          "118:   </PropertyGroup>",
          "119:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "120:     <TargetName>capstone</TargetName>",
          "121:   </PropertyGroup>",
          "122:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "123:     <ClCompile>",
          "124:       <PrecompiledHeader>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "145:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\" Label=\"PropertySheets\">",
          "146:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "147:   </ImportGroup>",
          "151:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\" Label=\"PropertySheets\">",
          "152:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "153:   </ImportGroup>",
          "157:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\" Label=\"PropertySheets\">",
          "158:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "159:   </ImportGroup>",
          "163:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\" Label=\"PropertySheets\">",
          "164:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "165:   </ImportGroup>",
          "170:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\">",
          "171:     <TargetName>capstone</TargetName>",
          "172:   </PropertyGroup>",
          "176:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\">",
          "177:     <TargetName>capstone</TargetName>",
          "178:   </PropertyGroup>",
          "182:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\">",
          "183:     <TargetName>capstone</TargetName>",
          "184:   </PropertyGroup>",
          "188:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\">",
          "189:     <TargetName>capstone</TargetName>",
          "190:   </PropertyGroup>",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "135:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "136:     </Link>",
          "137:   </ItemDefinitionGroup>",
          "138:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "139:     <ClCompile>",
          "140:       <PrecompiledHeader>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "207:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\">",
          "208:     <ClCompile>",
          "209:       <PrecompiledHeader>",
          "210:       </PrecompiledHeader>",
          "211:       <WarningLevel>Level3</WarningLevel>",
          "212:       <Optimization>Disabled</Optimization>",
          "213:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;_DEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "214:       <SDLCheck>true</SDLCheck>",
          "215:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "216:       <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>",
          "217:       <BasicRuntimeChecks>Default</BasicRuntimeChecks>",
          "218:       <RuntimeLibrary />",
          "219:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "220:     </ClCompile>",
          "221:     <Link>",
          "222:       <SubSystem>Windows</SubSystem>",
          "223:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "224:     </Link>",
          "225:   </ItemDefinitionGroup>",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "151:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "152:     </Link>",
          "153:   </ItemDefinitionGroup>",
          "154:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "155:     <ClCompile>",
          "156:       <WarningLevel>Level3</WarningLevel>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "242:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\">",
          "243:     <ClCompile>",
          "244:       <PrecompiledHeader>",
          "245:       </PrecompiledHeader>",
          "246:       <WarningLevel>Level3</WarningLevel>",
          "247:       <Optimization>Disabled</Optimization>",
          "248:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;_DEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "249:       <SDLCheck>true</SDLCheck>",
          "250:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "251:       <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>",
          "252:       <BasicRuntimeChecks>Default</BasicRuntimeChecks>",
          "253:       <RuntimeLibrary />",
          "254:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "255:     </ClCompile>",
          "256:     <Link>",
          "257:       <SubSystem>Windows</SubSystem>",
          "258:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "259:     </Link>",
          "260:   </ItemDefinitionGroup>",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "171:       <OptimizeReferences>true</OptimizeReferences>",
          "172:     </Link>",
          "173:   </ItemDefinitionGroup>",
          "174:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "175:     <ClCompile>",
          "176:       <WarningLevel>Level3</WarningLevel>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "281:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\">",
          "282:     <ClCompile>",
          "283:       <WarningLevel>Level3</WarningLevel>",
          "284:       <PrecompiledHeader>",
          "285:       </PrecompiledHeader>",
          "286:       <Optimization>MaxSpeed</Optimization>",
          "287:       <FunctionLevelLinking>true</FunctionLevelLinking>",
          "288:       <IntrinsicFunctions>true</IntrinsicFunctions>",
          "289:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;NDEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "290:       <SDLCheck>true</SDLCheck>",
          "291:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "292:       <RuntimeLibrary>",
          "293:       </RuntimeLibrary>",
          "294:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "295:     </ClCompile>",
          "296:     <Link>",
          "297:       <SubSystem>Windows</SubSystem>",
          "298:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "299:       <EnableCOMDATFolding>true</EnableCOMDATFolding>",
          "300:       <OptimizeReferences>true</OptimizeReferences>",
          "301:     </Link>",
          "302:   </ItemDefinitionGroup>",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "191:       <OptimizeReferences>true</OptimizeReferences>",
          "192:     </Link>",
          "193:   </ItemDefinitionGroup>",
          "194:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.targets\" />",
          "195:   <ImportGroup Label=\"ExtensionTargets\">",
          "196:   </ImportGroup>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "323:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\">",
          "324:     <ClCompile>",
          "325:       <WarningLevel>Level3</WarningLevel>",
          "326:       <PrecompiledHeader>",
          "327:       </PrecompiledHeader>",
          "328:       <Optimization>MaxSpeed</Optimization>",
          "329:       <FunctionLevelLinking>true</FunctionLevelLinking>",
          "330:       <IntrinsicFunctions>true</IntrinsicFunctions>",
          "331:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;NDEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "332:       <SDLCheck>true</SDLCheck>",
          "333:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "334:       <RuntimeLibrary>",
          "335:       </RuntimeLibrary>",
          "336:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "337:     </ClCompile>",
          "338:     <Link>",
          "339:       <SubSystem>Windows</SubSystem>",
          "340:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "341:       <EnableCOMDATFolding>true</EnableCOMDATFolding>",
          "342:       <OptimizeReferences>true</OptimizeReferences>",
          "343:     </Link>",
          "344:   </ItemDefinitionGroup>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "541e890cc31834396c4e4d516227c909efbb7a4b",
      "candidate_info": {
        "commit_hash": "541e890cc31834396c4e4d516227c909efbb7a4b",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/541e890cc31834396c4e4d516227c909efbb7a4b",
        "files": [
          "contrib/objdump/objdump-m68k.py"
        ],
        "message": "[python][contrib][objdump] fixup op.register_bits access",
        "before_after_code_files": [
          "contrib/objdump/objdump-m68k.py||contriobjdump/objdump-m68k.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "contrib/objdump/objdump-m68k.py||contriobjdump/objdump-m68k.py": [
          "File: contrib/objdump/objdump-m68k.py -> contriobjdump/objdump-m68k.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "150:     if op.address_mode in [ M68K_AM_PCI_INDEX_8_BIT_DISP, M68K_AM_AREGI_INDEX_8_BIT_DISP ]:",
          "151:         disp = op.mem.disp",
          "153:             disp = extsign8(op.mem.disp)",
          "155:             disp = extsign1632(op.mem.disp)",
          "157:         str = dump_op_reg(insn, op.mem.base_reg) + \"@(\" + \"{0:016x}\".format(disp) + \",\" + dump_op_reg(insn, op.mem.index_reg) + \":\" + map_index_size_str[op.mem.index_size]",
          "160:         return str + \")\"",
          "",
          "[Removed Lines]",
          "152:         if op.mem.register_bits == 2:",
          "154:         if op.mem.register_bits == 4:",
          "158:         if op.mem.register_bits:",
          "159:             str += format(\":%u\" % (op.mem.register_bits))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "165:         str += format(\"@(%016x)@(%016x\" % (extsign1632(op.mem.in_disp), extsign1632(op.mem.out_disp)))",
          "166:         if op.mem.index_reg:",
          "167:             str += \",\" + dump_op_reg(insn, op.mem.index_reg) + \":\" + map_index_size_str[op.mem.index_size]",
          "170:         str += \")\"",
          "171:         return str",
          "",
          "[Removed Lines]",
          "168:         if op.mem.register_bits:",
          "169:             str += format(\":%u\" % (op.mem.register_bits))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f177f92a7c9bea2dd7259577175cfa13579ec425",
      "candidate_info": {
        "commit_hash": "f177f92a7c9bea2dd7259577175cfa13579ec425",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/f177f92a7c9bea2dd7259577175cfa13579ec425",
        "files": [
          "arch/AArch64/AArch64BaseInfo.c",
          "arch/Sparc/SparcInstPrinter.c",
          "arch/XCore/XCoreInstPrinter.c",
          "cs.c",
          "windows/winkernel_mm.c"
        ],
        "message": "suppress MSVC code analysis (PREfast) warnings\n\nSigned-off-by: Satoshi Tanda <tanda.sat@gmail.com>",
        "before_after_code_files": [
          "arch/AArch64/AArch64BaseInfo.c||arch/AArch64/AArch64BaseInfo.c",
          "arch/Sparc/SparcInstPrinter.c||arch/Sparc/SparcInstPrinter.c",
          "arch/XCore/XCoreInstPrinter.c||arch/XCore/XCoreInstPrinter.c",
          "cs.c||cs.c",
          "windows/winkernel_mm.c||windows/winkernel_mm.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/AArch64/AArch64BaseInfo.c||arch/AArch64/AArch64BaseInfo.c": [
          "File: arch/AArch64/AArch64BaseInfo.c -> arch/AArch64/AArch64BaseInfo.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: #ifdef CAPSTONE_HAS_ARM64",
          "19: #if defined (WIN32) || defined (WIN64) || defined (_WIN32) || defined (_WIN64)",
          "21: #endif",
          "23: #include \"../../utils.h\"",
          "",
          "[Removed Lines]",
          "20: #pragma warning(disable:4996)",
          "",
          "[Added Lines]",
          "20: #pragma warning(disable:4996)   // disable MSVC's warning on strcpy()",
          "21: #pragma warning(disable:28719)  // disable MSVC's warning on strcpy()",
          "",
          "---------------"
        ],
        "arch/Sparc/SparcInstPrinter.c||arch/Sparc/SparcInstPrinter.c": [
          "File: arch/Sparc/SparcInstPrinter.c -> arch/Sparc/SparcInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: #define _CRT_SECURE_NO_WARNINGS",
          "21: #endif",
          "23: #include <stdio.h>",
          "24: #include <stdlib.h>",
          "25: #include <string.h>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "23: #if defined (WIN32) || defined (WIN64) || defined (_WIN32) || defined (_WIN64)",
          "24: #pragma warning(disable:28719)  // disable MSVC's warning on strncpy()",
          "25: #endif",
          "",
          "---------------"
        ],
        "arch/XCore/XCoreInstPrinter.c||arch/XCore/XCoreInstPrinter.c": [
          "File: arch/XCore/XCoreInstPrinter.c -> arch/XCore/XCoreInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "17: #ifdef CAPSTONE_HAS_XCORE",
          "19: #include <stdio.h>",
          "20: #include <stdlib.h>",
          "21: #include <string.h>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "19: #if defined (WIN32) || defined (WIN64) || defined (_WIN32) || defined (_WIN64)",
          "20: #pragma warning(disable : 4996)   // disable MSVC's warning on strcpy()",
          "21: #pragma warning(disable : 28719)  // disable MSVC's warning on strcpy()",
          "22: #endif",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "46:  char *p, *p2;",
          "47:  char tmp[128];",
          "54:  strcpy(tmp, code); // safe because code is way shorter than 128 bytes",
          "60:  p = strchr(tmp, ' ');",
          "",
          "[Removed Lines]",
          "50: #ifdef _MSC_VER",
          "51: #pragma warning(push)",
          "52: #pragma warning(disable : 4996)",
          "53: #endif",
          "55: #ifdef _MSC_VER",
          "56: #pragma warning(pop)",
          "57: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "cs.c||cs.c": [
          "File: cs.c -> cs.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: #if defined (WIN32) || defined (WIN64) || defined (_WIN32) || defined (_WIN64)",
          "5: #endif",
          "6: #if defined(CAPSTONE_HAS_OSXKERNEL)",
          "7: #include <libkern/libkern.h>",
          "",
          "[Removed Lines]",
          "4: #pragma warning(disable:4996)",
          "",
          "[Added Lines]",
          "4: #pragma warning(disable:4996)   // disable MSVC's warning on strcpy()",
          "5: #pragma warning(disable:28719)  // disable MSVC's warning on strcpy()",
          "",
          "---------------"
        ],
        "windows/winkernel_mm.c||windows/winkernel_mm.c": [
          "File: windows/winkernel_mm.c -> windows/winkernel_mm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "32:  NT_ASSERT(size);",
          "34:  CS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
          "35:    NonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);",
          "36:  if (!block) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: #pragma prefast(suppress : 30030)  // Allocating executable POOL_TYPE memory",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fbfa991cae29068297582e2e04d1a2376925ec27",
      "candidate_info": {
        "commit_hash": "fbfa991cae29068297582e2e04d1a2376925ec27",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/fbfa991cae29068297582e2e04d1a2376925ec27",
        "files": [
          "COMPILE_CMAKE.TXT",
          "nmake.bat"
        ],
        "message": "add nmake.bat",
        "before_after_code_files": [
          "nmake.bat||nmake.bat"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "nmake.bat||nmake.bat": [
          "File: nmake.bat -> nmake.bat",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: :: Capstone disassembler engine (www.capstone-engine.org)",
          "2: :: Build Capstone libs (capstone.dll & capstone.lib) on Windows with CMake & Nmake",
          "3: :: By Nguyen Anh Quynh, 2017",
          "5: cmake -DCMAKE_BUILD_TYPE=Release -G \"NMake Makefiles\" ..",
          "6: nmake",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f585a84966f8f5de951705d746b264900ba205c5",
      "candidate_info": {
        "commit_hash": "f585a84966f8f5de951705d746b264900ba205c5",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/f585a84966f8f5de951705d746b264900ba205c5",
        "files": [
          "bindings/java/capstone/Ppc_const.java",
          "bindings/ocaml/ppc_const.ml",
          "bindings/python/capstone/__init__.py",
          "bindings/python/capstone/ppc_const.py",
          "cstool/cstool.c",
          "include/capstone.h"
        ],
        "message": "add CS_VERSION_{MAJOR, MINOR, EXTRA}",
        "before_after_code_files": [
          "bindings/javcapstone/Ppc_const.java||bindings/java/capstone/Ppc_const.java",
          "bindings/ocaml/ppc_const.ml||bindings/ocaml/ppc_const.ml",
          "bindings/python/capstone/__init__.py||bindings/python/capstone/__init__.py",
          "bindings/python/capstone/ppc_const.py||bindings/python/capstone/ppc_const.py",
          "cstool/cstool.c||cstool/cstool.c",
          "include/capstone.h||include/capstone.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "bindings/javcapstone/Ppc_const.java||bindings/java/capstone/Ppc_const.java": [
          "File: bindings/javcapstone/Ppc_const.java -> bindings/java/capstone/Ppc_const.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "210:  public static final int PPC_OP_INVALID = 0;",
          "211:  public static final int PPC_OP_REG = 1;",
          "212:  public static final int PPC_OP_IMM = 2;",
          "213:  public static final int PPC_OP_MEM = 3;",
          "214:  public static final int PPC_OP_CRX = 64;",
          "",
          "---------------"
        ],
        "bindings/ocaml/ppc_const.ml||bindings/ocaml/ppc_const.ml": [
          "File: bindings/ocaml/ppc_const.ml -> bindings/ocaml/ppc_const.ml",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: let _PPC_BH_PLUS = 1;;",
          "21: let _PPC_BH_MINUS = 2;;",
          "31: (* PPC registers *)",
          "33: let _PPC_REG_INVALID = 0;;",
          "",
          "[Removed Lines]",
          "23: (* Operand type for instruction's operands *)",
          "25: let _PPC_OP_INVALID = 0;;",
          "26: let _PPC_OP_REG = 1;;",
          "27: let _PPC_OP_IMM = 2;;",
          "28: let _PPC_OP_MEM = 3;;",
          "29: let _PPC_OP_CRX = 64;;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "210: let _PPC_REG_CR1EQ = 177;;",
          "211: let _PPC_REG_ENDING = 178;;",
          "213: (* PPC instruction *)",
          "215: let _PPC_INS_INVALID = 0;;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "205: (* Operand type for instruction's operands *)",
          "207: let _PPC_OP_INVALID = 0;;",
          "208: let _PPC_OP_REG = 1;;",
          "209: let _PPC_OP_IMM = 2;;",
          "210: let _PPC_OP_MEM = 3;;",
          "211: let _PPC_OP_CRX = 64;;",
          "",
          "---------------"
        ],
        "bindings/python/capstone/__init__.py||bindings/python/capstone/__init__.py": [
          "File: bindings/python/capstone/__init__.py -> bindings/python/capstone/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:     'CS_API_MAJOR',",
          "20:     'CS_API_MINOR',",
          "22:     'CS_ARCH_ARM',",
          "23:     'CS_ARCH_ARM64',",
          "24:     'CS_ARCH_MIPS',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22:     'CS_VERSION_MAJOR',",
          "23:     'CS_VERSION_MINOR',",
          "24:     'CS_VERSION_EXTRA',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "100: CS_API_MAJOR = 3",
          "101: CS_API_MINOR = 0",
          "105: # architectures",
          "106: CS_ARCH_ARM = 0",
          "",
          "[Removed Lines]",
          "103: __version__ = \"%s.%s\" %(CS_API_MAJOR, CS_API_MINOR)",
          "",
          "[Added Lines]",
          "107: # Package version",
          "108: CS_VERSION_MAJOR = CS_API_MAJOR",
          "109: CS_VERSION_MINOR = CS_API_MINOR",
          "110: CS_VERSION_EXTRA = 5",
          "112: __version__ = \"%u.%u.%u\" %(CS_VERSION_MAJOR, CS_VERSION_MINOR, CS_VERSION_EXTRA)",
          "",
          "---------------"
        ],
        "bindings/python/capstone/ppc_const.py||bindings/python/capstone/ppc_const.py": [
          "File: bindings/python/capstone/ppc_const.py -> bindings/python/capstone/ppc_const.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: PPC_BH_PLUS = 1",
          "21: PPC_BH_MINUS = 2",
          "31: # PPC registers",
          "33: PPC_REG_INVALID = 0",
          "",
          "[Removed Lines]",
          "23: # Operand type for instruction's operands",
          "25: PPC_OP_INVALID = 0",
          "26: PPC_OP_REG = 1",
          "27: PPC_OP_IMM = 2",
          "28: PPC_OP_MEM = 3",
          "29: PPC_OP_CRX = 64",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "210: PPC_REG_CR1EQ = 177",
          "211: PPC_REG_ENDING = 178",
          "213: # PPC instruction",
          "215: PPC_INS_INVALID = 0",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "205: # Operand type for instruction's operands",
          "207: PPC_OP_INVALID = 0",
          "208: PPC_OP_REG = 1",
          "209: PPC_OP_IMM = 2",
          "210: PPC_OP_MEM = 3",
          "211: PPC_OP_CRX = 64",
          "",
          "---------------"
        ],
        "cstool/cstool.c||cstool/cstool.c": [
          "File: cstool/cstool.c -> cstool/cstool.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "74: static void usage(char *prog)",
          "75: {",
          "77:  printf(\"Syntax: %s [-d] <arch+mode> <assembly-hexstring> [start-address-in-hex-format]\\n\", prog);",
          "78:  printf(\"\\nThe following <arch+mode> options are supported:\\n\");",
          "",
          "[Removed Lines]",
          "76:  printf(\"Cstool v%s for Capstone Disassembler Engine (core v%u.%u)\\n\\n\", VERSION, CS_API_MAJOR, CS_API_MINOR);",
          "",
          "[Added Lines]",
          "76:  printf(\"Cstool v%s for Capstone Disassembler Engine (core v%u.%u.%u)\\n\\n\", VERSION, CS_VERSION_MAJOR, CS_VERSION_MINOR, CS_VERSION_EXTRA);",
          "",
          "---------------"
        ],
        "include/capstone.h||include/capstone.h": [
          "File: include/capstone.h -> include/capstone.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "54: #define CS_API_MAJOR 3",
          "55: #define CS_API_MINOR 0",
          "59: #define CS_MAKE_VERSION(major, minor) ((major << 8) + minor)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "58: #define CS_VERSION_MAJOR CS_API_MAJOR",
          "59: #define CS_VERSION_MINOR CS_API_MINOR",
          "60: #define CS_VERSION_EXTRA 5",
          "",
          "---------------"
        ]
      }
    }
  ]
}