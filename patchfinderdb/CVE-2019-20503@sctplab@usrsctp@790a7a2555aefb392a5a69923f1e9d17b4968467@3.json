{
  "cve_id": "CVE-2019-20503",
  "cve_desc": "usrsctp before 2019-12-20 has out-of-bounds reads in sctp_load_addresses_from_init.",
  "repo": "sctplab/usrsctp",
  "patch_hash": "790a7a2555aefb392a5a69923f1e9d17b4968467",
  "patch_info": {
    "commit_hash": "790a7a2555aefb392a5a69923f1e9d17b4968467",
    "repo": "sctplab/usrsctp",
    "commit_url": "https://github.com/sctplab/usrsctp/commit/790a7a2555aefb392a5a69923f1e9d17b4968467",
    "files": [
      "usrsctplib/netinet/sctp_auth.c",
      "usrsctplib/netinet/sctp_pcb.c"
    ],
    "message": "Improve input validation for some parameters having a too small reported length.\n\nThanks to Natalie Silvanovich from Google for finding one of these\nissues in the SCTP userland stack and reporting it.",
    "before_after_code_files": [
      "usrsctplib/netinet/sctp_auth.c||usrsctplib/netinet/sctp_auth.c",
      "usrsctplib/netinet/sctp_pcb.c||usrsctplib/netinet/sctp_pcb.c"
    ]
  },
  "patch_diff": {
    "usrsctplib/netinet/sctp_auth.c||usrsctplib/netinet/sctp_auth.c": [
      "File: usrsctplib/netinet/sctp_auth.c -> usrsctplib/netinet/sctp_auth.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "35: #ifdef __FreeBSD__",
      "36: #include <sys/cdefs.h>",
      "38: #endif",
      "40: #include <netinet/sctp_os.h>",
      "",
      "[Removed Lines]",
      "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_auth.c 352438 2019-09-17 09:46:42Z tuexen $\");",
      "",
      "[Added Lines]",
      "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_auth.c 355931 2019-12-20 15:25:08Z tuexen $\");",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1421:   ptype = ntohs(phdr->param_type);",
      "1422:   plen = ntohs(phdr->param_length);",
      "1425:    break;",
      "1427:   if (ptype == SCTP_RANDOM) {",
      "",
      "[Removed Lines]",
      "1424:   if ((plen == 0) || (offset + plen > length))",
      "",
      "[Added Lines]",
      "1424:   if ((plen < sizeof(struct sctp_paramhdr)) ||",
      "1425:       (offset + plen > length))",
      "",
      "---------------"
    ],
    "usrsctplib/netinet/sctp_pcb.c||usrsctplib/netinet/sctp_pcb.c": [
      "File: usrsctplib/netinet/sctp_pcb.c -> usrsctplib/netinet/sctp_pcb.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "35: #ifdef __FreeBSD__",
      "36: #include <sys/cdefs.h>",
      "38: #endif",
      "40: #include <netinet/sctp_os.h>",
      "",
      "[Removed Lines]",
      "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_pcb.c 353477 2019-10-13 16:14:04Z markj $\");",
      "",
      "[Added Lines]",
      "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_pcb.c 355931 2019-12-20 15:25:08Z tuexen $\");",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "7247:   if (offset + plen > limit) {",
      "7248:    break;",
      "7249:   }",
      "7251:    break;",
      "7252:   }",
      "7253: #ifdef INET",
      "",
      "[Removed Lines]",
      "7250:   if (plen == 0) {",
      "",
      "[Added Lines]",
      "7250:   if (plen < sizeof(struct sctp_paramhdr)) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "7463:    if (plen > sizeof(lstore)) {",
      "7464:     return (-23);",
      "7465:    }",
      "7466:    phdr = sctp_get_next_param(m, offset,",
      "7467:          (struct sctp_paramhdr *)&lstore,",
      "7468:          plen);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "7466:    if (plen < sizeof(struct sctp_asconf_addrv4_param)) {",
      "7467:     return (-101);",
      "7468:    }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "31f4eb54578c5766cca51191a7aedb834989b0df",
      "candidate_info": {
        "commit_hash": "31f4eb54578c5766cca51191a7aedb834989b0df",
        "repo": "sctplab/usrsctp",
        "commit_url": "https://github.com/sctplab/usrsctp/commit/31f4eb54578c5766cca51191a7aedb834989b0df",
        "files": [
          "usrsctplib/netinet/sctp_input.c",
          "usrsctplib/netinet/sctp_output.c",
          "usrsctplib/netinet/sctp_pcb.c",
          "usrsctplib/netinet/sctp_structs.h",
          "usrsctplib/netinet/sctp_usrreq.c",
          "usrsctplib/netinet/sctputil.c",
          "usrsctplib/netinet/sctputil.h"
        ],
        "message": "Improve concurrent send() calls",
        "before_after_code_files": [
          "usrsctplib/netinet/sctp_input.c||usrsctplinetinet/sctp_input.c",
          "usrsctplib/netinet/sctp_output.c||usrsctplinetinet/sctp_output.c",
          "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c",
          "usrsctplib/netinet/sctp_structs.h||usrsctplinetinet/sctp_structs.h",
          "usrsctplib/netinet/sctp_usrreq.c||usrsctplinetinet/sctp_usrreq.c",
          "usrsctplib/netinet/sctputil.c||usrsctplinetinet/sctputil.c",
          "usrsctplib/netinet/sctputil.h||usrsctplinetinet/sctputil.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "usrsctplib/netinet/sctp_input.c||usrsctplinetinet/sctp_input.c": [
          "File: usrsctplib/netinet/sctp_input.c -> usrsctplinetinet/sctp_input.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__) && !defined(__Userspace__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_input.c 363194 2020-07-14 20:32:50Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "906:  SCTP_TCB_LOCK(stcb);",
          "907:  atomic_subtract_int(&stcb->asoc.refcnt, 1);",
          "908: #endif",
          "910:  (void)sctp_free_assoc(stcb->sctp_ep, stcb, SCTP_NORMAL_PROC,",
          "911:          SCTP_FROM_SCTP_INPUT + SCTP_LOC_8);",
          "912: #if defined(__APPLE__) && !defined(__Userspace__)",
          "",
          "[Removed Lines]",
          "909:  SCTP_ADD_SUBSTATE(stcb, SCTP_STATE_WAS_ABORTED);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2069:   SCTP_TCB_SEND_LOCK(stcb);",
          "2072:   for (i = 0; i < stcb->asoc.streamoutcnt; i++) {",
          "2073:    stcb->asoc.strmout[i].chunks_on_queues = 0;",
          "2074: #if defined(SCTP_DETAILED_STR_STATS)",
          "",
          "[Removed Lines]",
          "2071:   sctp_report_all_outbound(stcb, 0, 1, SCTP_SO_LOCKED);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_output.c||usrsctplinetinet/sctp_output.c": [
          "File: usrsctplib/netinet/sctp_output.c -> usrsctplinetinet/sctp_output.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__) && !defined(__Userspace__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_output.c 362178 2020-06-14 16:05:08Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "14193:    if (sinfo_flags & SCTP_UNORDERED) {",
          "14194:     SCTP_STAT_INCR(sctps_sends_with_unord);",
          "14195:    }",
          "14196:    TAILQ_INSERT_TAIL(&strm->outqueue, sp, next);",
          "14197:    stcb->asoc.ss_functions.sctp_ss_add_to_stream(stcb, asoc, strm, sp, 1);",
          "14198:    SCTP_TCB_SEND_UNLOCK(stcb);",
          "14199:   } else {",
          "14200:    SCTP_TCB_SEND_LOCK(stcb);",
          "14201:    sp = TAILQ_LAST(&strm->outqueue, sctp_streamhead);",
          "14202:    SCTP_TCB_SEND_UNLOCK(stcb);",
          "14203:    if (sp == NULL) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "14266:     }",
          "14268:     SCTP_TCB_SEND_LOCK(stcb);",
          "14273:      sctp_m_freem(mm);",
          "14275:       SCTP_LTRACE_ERR_RET(NULL, stcb, NULL, SCTP_FROM_SCTP_OUTPUT, ECONNRESET);",
          "14276:       error = ECONNRESET;",
          "14277:      }",
          "",
          "[Removed Lines]",
          "14269:     if (stcb->asoc.state & SCTP_STATE_ABOUT_TO_BE_FREED) {",
          "14274:      if (stcb->asoc.state & SCTP_PCB_FLAGS_WAS_ABORTED) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "14514:    }",
          "14515:   }",
          "14516:   SCTP_TCB_SEND_LOCK(stcb);",
          "14518:    SCTP_TCB_SEND_UNLOCK(stcb);",
          "14519:    goto out_unlocked;",
          "14520:   }",
          "",
          "[Removed Lines]",
          "14517:   if (stcb->asoc.state & SCTP_STATE_ABOUT_TO_BE_FREED) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "14530:     strm->last_msg_incomplete = 0;",
          "14531:     asoc->stream_locked = 0;",
          "14532:    }",
          "14533:   } else {",
          "14534:    SCTP_PRINTF(\"Huh no sp TSNH?\\n\");",
          "14535:    strm->last_msg_incomplete = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c": [
          "File: usrsctplib/netinet/sctp_pcb.c -> usrsctplinetinet/sctp_pcb.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__) && !defined(__Userspace__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_pcb.c 363456 2020-07-23 19:43:49Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "5468:   return (1);",
          "5469:  }",
          "5470:  if (stcb->asoc.alternate) {",
          "5471:   sctp_free_remote_addr(stcb->asoc.alternate);",
          "5472:   stcb->asoc.alternate = NULL;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "5504:    sctp_timer_start(SCTP_TIMER_TYPE_ASOCKILL, inp, stcb, NULL);",
          "5506:    SCTP_TCB_UNLOCK(stcb);",
          "5507: #ifdef SCTP_LOG_CLOSING",
          "5508:    sctp_log_closing(inp, stcb, 8);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "5564:    SCTP_CLEAR_SUBSTATE(stcb, SCTP_STATE_IN_ACCEPT_QUEUE);",
          "5565:    sctp_timer_start(SCTP_TIMER_TYPE_ASOCKILL, inp, stcb, NULL);",
          "5566:   }",
          "5567:   SCTP_TCB_UNLOCK(stcb);",
          "5568:   if ((inp->sctp_flags & SCTP_PCB_FLAGS_SOCKET_ALLGONE) ||",
          "5569:       (inp->sctp_flags & SCTP_PCB_FLAGS_SOCKET_GONE))",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "5602:  if (from_inpcbfree == SCTP_NORMAL_PROC) {",
          "5603:   atomic_add_int(&stcb->asoc.refcnt, 1);",
          "5605:   SCTP_TCB_UNLOCK(stcb);",
          "5606:   SCTP_INP_INFO_WLOCK();",
          "5607:   SCTP_INP_WLOCK(inp);",
          "5608:   SCTP_TCB_LOCK(stcb);",
          "5609:  }",
          "5611:  if ((inp->sctp_flags & SCTP_PCB_FLAGS_SOCKET_ALLGONE) ||",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "5656:    SCTP_INP_INFO_WUNLOCK();",
          "5657:    SCTP_INP_WUNLOCK(inp);",
          "5658:   }",
          "5659:   SCTP_TCB_UNLOCK(stcb);",
          "5660:   return (0);",
          "5661:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "5691:  for (i = 0; i < asoc->streamoutcnt; i++) {",
          "5692:   struct sctp_stream_out *outs;",
          "",
          "[Removed Lines]",
          "5690:  SCTP_TCB_SEND_LOCK(stcb);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "5718:    sctp_free_a_strmoq(stcb, sp, SCTP_SO_LOCKED);",
          "5719:   }",
          "5720:  }",
          "5723:  TAILQ_FOREACH_SAFE(strrst, &asoc->resetHead, next_resp, nstrrst) {",
          "5724:   TAILQ_REMOVE(&asoc->resetHead, strrst, next_resp);",
          "",
          "[Removed Lines]",
          "5721:  SCTP_TCB_SEND_UNLOCK(stcb);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "5923:  SCTP_TCB_UNLOCK(stcb);",
          "5924:  SCTP_TCB_LOCK_DESTROY(stcb);",
          "5925:  SCTP_TCB_SEND_LOCK_DESTROY(stcb);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_structs.h||usrsctplinetinet/sctp_structs.h": [
          "File: usrsctplib/netinet/sctp_structs.h -> usrsctplinetinet/sctp_structs.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__) && !defined(__Userspace__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #ifndef _NETINET_SCTP_STRUCTS_H_",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_structs.h 362106 2020-06-12 16:31:13Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "584:  uint8_t  sender_all_done;",
          "585:  uint8_t  put_last_out;",
          "586:  uint8_t  discard_rest;",
          "587: };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_usrreq.c||usrsctplinetinet/sctp_usrreq.c": [
          "File: usrsctplib/netinet/sctp_usrreq.c -> usrsctplinetinet/sctp_usrreq.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__) && !defined(__Userspace__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_usrreq.c 363275 2020-07-17 15:09:49Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctputil.c||usrsctplinetinet/sctputil.c": [
          "File: usrsctplib/netinet/sctputil.c -> usrsctplinetinet/sctputil.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__) && !defined(__Userspace__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctputil.c 364247 2020-08-15 11:22:07Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4443: }",
          "4445: void",
          "4447: {",
          "4448:  struct sctp_association *asoc;",
          "4449:  struct sctp_stream_out *outs;",
          "",
          "[Removed Lines]",
          "4446: sctp_report_all_outbound(struct sctp_tcb *stcb, uint16_t error, int holds_lock, int so_locked)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4472:   return;",
          "4473:  }",
          "4479:  TAILQ_FOREACH_SAFE(chk, &asoc->sent_queue, sctp_next, nchk) {",
          "4480:   TAILQ_REMOVE(&asoc->sent_queue, chk, sctp_next);",
          "",
          "[Removed Lines]",
          "4475:  if (holds_lock == 0) {",
          "4476:   SCTP_TCB_SEND_LOCK(stcb);",
          "4477:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "4552:   }",
          "4553:  }",
          "4558: }",
          "4560: void",
          "",
          "[Removed Lines]",
          "4555:  if (holds_lock == 0) {",
          "4556:   SCTP_TCB_SEND_UNLOCK(stcb);",
          "4557:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "4581:      (stcb->asoc.state & SCTP_STATE_CLOSED_SOCKET)) {",
          "4582:   return;",
          "4583:  }",
          "4586:  if (from_peer) {",
          "4587:   sctp_ulp_notify(SCTP_NOTIFY_ASSOC_REM_ABORTED, stcb, error, abort, so_locked);",
          "4588:  } else {",
          "",
          "[Removed Lines]",
          "4585:  sctp_report_all_outbound(stcb, error, 0, so_locked);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "4618:  if (stcb != NULL) {",
          "4620:   sctp_abort_notification(stcb, 0, 0, NULL, SCTP_SO_NOT_LOCKED);",
          "4623: #if defined(__APPLE__) && !defined(__Userspace__)",
          "4624:   so = SCTP_INP_SO(inp);",
          "",
          "[Removed Lines]",
          "4621:   SCTP_ADD_SUBSTATE(stcb, SCTP_STATE_WAS_ABORTED);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "4740:    }",
          "4741:   }",
          "4742:   return;",
          "4745:  }",
          "4747:  sctp_send_abort_tcb(stcb, op_err, so_locked);",
          "",
          "[Removed Lines]",
          "4743:  } else {",
          "4744:   SCTP_ADD_SUBSTATE(stcb, SCTP_STATE_WAS_ABORTED);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctputil.h||usrsctplinetinet/sctputil.h": [
          "File: usrsctplib/netinet/sctputil.h -> usrsctplinetinet/sctputil.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__) && !defined(__Userspace__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #ifndef _NETINET_SCTP_UTIL_H_",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctputil.h 363323 2020-07-19 12:34:19Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "180: void sctp_stop_association_timers(struct sctp_tcb *, bool);",
          "184: int sctp_expand_mapping_array(struct sctp_association *, uint32_t);",
          "",
          "[Removed Lines]",
          "182: void sctp_report_all_outbound(struct sctp_tcb *, uint16_t, int, int);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0cf6777bcfbec1ed18443a1d41b2b494435a83da",
      "candidate_info": {
        "commit_hash": "0cf6777bcfbec1ed18443a1d41b2b494435a83da",
        "repo": "sctplab/usrsctp",
        "commit_url": "https://github.com/sctplab/usrsctp/commit/0cf6777bcfbec1ed18443a1d41b2b494435a83da",
        "files": [
          "usrsctplib/netinet/sctp_pcb.c"
        ],
        "message": "Sync with FreeBSD.",
        "before_after_code_files": [
          "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c": [
          "File: usrsctplib/netinet/sctp_pcb.c -> usrsctplinetinet/sctp_pcb.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_pcb.c 357775 2020-02-11 20:02:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "5395:   SCTP_MALLOC(twait_block, struct sctp_tagblock *,",
          "5396:       sizeof(struct sctp_tagblock), SCTP_M_TIMW);",
          "5397:   if (twait_block == NULL) {",
          "5401:    return;",
          "5402:   }",
          "5403:   memset(twait_block, 0, sizeof(struct sctp_tagblock));",
          "",
          "[Removed Lines]",
          "5398: #ifdef INVARIANTS",
          "5399:    panic(\"Can not alloc tagblock\");",
          "5400: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "5514:  else",
          "5515:   so = inp->sctp_socket;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "5640:   so = NULL;",
          "",
          "[Removed Lines]",
          "5642:  if ((inp->sctp_flags & SCTP_PCB_FLAGS_TCPTYPE) ||",
          "5643:      (inp->sctp_flags & SCTP_PCB_FLAGS_IN_TCPPOOL)) {",
          "5648:   if (inp->sctp_flags & SCTP_PCB_FLAGS_CONNECTED) {",
          "5649:    inp->sctp_flags &= ~SCTP_PCB_FLAGS_CONNECTED;",
          "5650:    inp->sctp_flags |= SCTP_PCB_FLAGS_WAS_CONNECTED;",
          "5651:    if (so) {",
          "5652:     SOCKBUF_LOCK(&so->so_rcv);",
          "5653:     so->so_state &= ~(SS_ISCONNECTING |",
          "5654:         SS_ISDISCONNECTING |",
          "5655:         SS_ISCONFIRMING |",
          "5656:         SS_ISCONNECTED);",
          "5657:     so->so_state |= SS_ISDISCONNECTED;",
          "5658: #if defined(__APPLE__)",
          "5659:     socantrcvmore(so);",
          "5660: #else",
          "5661:     socantrcvmore_locked(so);",
          "5662: #endif",
          "5663:     socantsendmore(so);",
          "5664:     sctp_sowwakeup(inp, so);",
          "5665:     sctp_sorwakeup(inp, so);",
          "5666:     SCTP_SOWAKEUP(so);",
          "5667:    }",
          "5668:   }",
          "5669:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "61f66833b255c52f6536e1603368f41d33673c1e",
      "candidate_info": {
        "commit_hash": "61f66833b255c52f6536e1603368f41d33673c1e",
        "repo": "sctplab/usrsctp",
        "commit_url": "https://github.com/sctplab/usrsctp/commit/61f66833b255c52f6536e1603368f41d33673c1e",
        "files": [
          "usrsctplib/netinet/sctp_indata.c",
          "usrsctplib/netinet/sctp_output.c",
          "usrsctplib/netinet/sctp_pcb.c",
          "usrsctplib/netinet/sctputil.c",
          "usrsctplib/netinet/sctputil.h"
        ],
        "message": "Cleanup timer handling.\n\nThis is part of https://github.com/sctplab/usrsctp/pull/417\nThanks to Taylor Brandstetter for providing the patch.",
        "before_after_code_files": [
          "usrsctplib/netinet/sctp_indata.c||usrsctplinetinet/sctp_indata.c",
          "usrsctplib/netinet/sctp_output.c||usrsctplinetinet/sctp_output.c",
          "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c",
          "usrsctplib/netinet/sctputil.c||usrsctplinetinet/sctputil.c",
          "usrsctplib/netinet/sctputil.h||usrsctplinetinet/sctputil.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "usrsctplib/netinet/sctp_indata.c||usrsctplinetinet/sctp_indata.c": [
          "File: usrsctplib/netinet/sctp_indata.c -> usrsctplinetinet/sctp_indata.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_indata.c 357500 2020-02-04 12:34:16Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2653:     sctp_send_sack(stcb, SCTP_SO_NOT_LOCKED);",
          "2654:    }",
          "2655:   } else {",
          "",
          "[Removed Lines]",
          "2652:     (void)SCTP_OS_TIMER_STOP(&stcb->asoc.dack_timer.timer);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_output.c||usrsctplinetinet/sctp_output.c": [
          "File: usrsctplib/netinet/sctp_output.c -> usrsctplinetinet/sctp_output.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_output.c 357197 2020-01-28 10:09:05Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "8962:       if (SCTP_OS_TIMER_PENDING(&stcb->asoc.dack_timer.timer)) {",
          "8963:        sctp_timer_stop(SCTP_TIMER_TYPE_RECV,",
          "8965:                        SCTP_FROM_SCTP_OUTPUT + SCTP_LOC_1);",
          "8966:       }",
          "8967:      }",
          "",
          "[Removed Lines]",
          "8964:          inp, stcb, net,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "10479:       sctp_timer_stop(SCTP_TIMER_TYPE_SEND, inp, stcb, net,",
          "10481:       sctp_timer_start(SCTP_TIMER_TYPE_SEND, inp, stcb, net);",
          "10482:      }",
          "10483:     }",
          "",
          "[Removed Lines]",
          "10480:         SCTP_FROM_SCTP_OUTPUT + SCTP_LOC_2);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "10604:  if (SCTP_OS_TIMER_PENDING(&stcb->asoc.dack_timer.timer)) {",
          "10605:   sctp_send_sack(stcb, so_locked);",
          "10607:  }",
          "10608:  while (asoc->sent_queue_retran_cnt) {",
          "",
          "[Removed Lines]",
          "10606:   (void)SCTP_OS_TIMER_STOP(&stcb->asoc.dack_timer.timer);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c": [
          "File: usrsctplib/netinet/sctp_pcb.c -> usrsctplinetinet/sctp_pcb.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_pcb.c 357501 2020-02-04 14:01:07Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4105:     SCTP_CLEAR_SUBSTATE(asoc, SCTP_STATE_IN_ACCEPT_QUEUE);",
          "4106:     sctp_timer_start(SCTP_TIMER_TYPE_ASOCKILL, inp, asoc, NULL);",
          "4107:    }",
          "4109:    SCTP_TCB_UNLOCK(asoc);",
          "4110:    continue;",
          "4111:   }",
          "",
          "[Removed Lines]",
          "4108:           cnt++;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4134:  }",
          "4135:  if (cnt) {",
          "4138: #ifdef SCTP_LOG_CLOSING",
          "4139:   sctp_log_closing(inp, NULL, 3);",
          "4140: #endif",
          "",
          "[Removed Lines]",
          "4137:   (void)SCTP_OS_TIMER_STOP(&inp->sctp_ep.signature_change.timer);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "4153:  if ((inp->refcount) ||",
          "4154:      (being_refed) ||",
          "4155:      (inp->sctp_flags & SCTP_PCB_FLAGS_CLOSE_IP)) {",
          "4157: #ifdef SCTP_LOG_CLOSING",
          "4158:   sctp_log_closing(inp, NULL, 4);",
          "4159: #endif",
          "",
          "[Removed Lines]",
          "4156:   (void)SCTP_OS_TIMER_STOP(&inp->sctp_ep.signature_change.timer);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "5531:    return (0);",
          "5532:   }",
          "5533:  }",
          "5564:  if ((stcb->asoc.state & SCTP_STATE_ABOUT_TO_BE_FREED) == 0) {",
          "5565:   SCTP_ADD_SUBSTATE(stcb, SCTP_STATE_ABOUT_TO_BE_FREED);",
          "",
          "[Removed Lines]",
          "5535:  (void)SCTP_OS_TIMER_STOP(&asoc->dack_timer.timer);",
          "5536:  asoc->dack_timer.self = NULL;",
          "5537:  (void)SCTP_OS_TIMER_STOP(&asoc->strreset_timer.timer);",
          "5544:  if (asoc->strreset_timer.type == SCTP_TIMER_TYPE_STRRESET)",
          "5545:   asoc->strreset_timer.self = NULL;",
          "5546:  (void)SCTP_OS_TIMER_STOP(&asoc->asconf_timer.timer);",
          "5547:  asoc->asconf_timer.self = NULL;",
          "5548:  (void)SCTP_OS_TIMER_STOP(&asoc->autoclose_timer.timer);",
          "5549:  asoc->autoclose_timer.self = NULL;",
          "5550:  (void)SCTP_OS_TIMER_STOP(&asoc->shut_guard_timer.timer);",
          "5551:  asoc->shut_guard_timer.self = NULL;",
          "5553:  (void)SCTP_OS_TIMER_STOP(&asoc->delete_prim_timer.timer);",
          "5554:  asoc->delete_prim_timer.self = NULL;",
          "5555:  TAILQ_FOREACH(net, &asoc->nets, sctp_next) {",
          "5556:   (void)SCTP_OS_TIMER_STOP(&net->rxt_timer.timer);",
          "5557:   net->rxt_timer.self = NULL;",
          "5558:   (void)SCTP_OS_TIMER_STOP(&net->pmtu_timer.timer);",
          "5559:   net->pmtu_timer.self = NULL;",
          "5560:   (void)SCTP_OS_TIMER_STOP(&net->hb_timer.timer);",
          "5561:   net->hb_timer.self = NULL;",
          "5562:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "5731:  (void)SCTP_OS_TIMER_STOP(&asoc->strreset_timer.timer);",
          "5732:  (void)SCTP_OS_TIMER_STOP(&asoc->dack_timer.timer);",
          "5733:  (void)SCTP_OS_TIMER_STOP(&asoc->strreset_timer.timer);",
          "5734:  (void)SCTP_OS_TIMER_STOP(&asoc->asconf_timer.timer);",
          "5735:  (void)SCTP_OS_TIMER_STOP(&asoc->shut_guard_timer.timer);",
          "5736:  (void)SCTP_OS_TIMER_STOP(&asoc->autoclose_timer.timer);",
          "5737:  TAILQ_FOREACH(net, &asoc->nets, sctp_next) {",
          "5738:   (void)SCTP_OS_TIMER_STOP(&net->rxt_timer.timer);",
          "5739:   (void)SCTP_OS_TIMER_STOP(&net->pmtu_timer.timer);",
          "5740:   (void)SCTP_OS_TIMER_STOP(&net->hb_timer.timer);",
          "5741:  }",
          "5743:  asoc->strreset_timer.type = SCTP_TIMER_TYPE_NONE;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "8065:   asoc->last_revoke_count = cnt;",
          "8068:   sctp_send_sack(stcb, SCTP_SO_NOT_LOCKED);",
          "8069:   sctp_chunk_output(stcb->sctp_ep, stcb, SCTP_OUTPUT_FROM_DRAIN, SCTP_SO_NOT_LOCKED);",
          "",
          "[Removed Lines]",
          "8066:   (void)SCTP_OS_TIMER_STOP(&stcb->asoc.dack_timer.timer);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctputil.c||usrsctplinetinet/sctputil.c": [
          "File: usrsctplib/netinet/sctputil.c -> usrsctplinetinet/sctputil.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctputil.c 357501 2020-02-04 14:01:07Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "811: void",
          "812: sctp_stop_timers_for_shutdown(struct sctp_tcb *stcb)",
          "813: {",
          "815:  struct sctp_nets *net;",
          "826:  }",
          "827: }",
          "",
          "[Removed Lines]",
          "814:  struct sctp_association *asoc;",
          "817:  asoc = &stcb->asoc;",
          "819:  (void)SCTP_OS_TIMER_STOP(&asoc->dack_timer.timer);",
          "820:  (void)SCTP_OS_TIMER_STOP(&asoc->strreset_timer.timer);",
          "821:  (void)SCTP_OS_TIMER_STOP(&asoc->asconf_timer.timer);",
          "822:  (void)SCTP_OS_TIMER_STOP(&asoc->autoclose_timer.timer);",
          "823:  TAILQ_FOREACH(net, &asoc->nets, sctp_next) {",
          "824:   (void)SCTP_OS_TIMER_STOP(&net->pmtu_timer.timer);",
          "825:   (void)SCTP_OS_TIMER_STOP(&net->hb_timer.timer);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctputil.h||usrsctplinetinet/sctputil.h": [
          "File: usrsctplib/netinet/sctputil.h -> usrsctplinetinet/sctputil.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #ifndef _NETINET_SCTP_UTIL_H_",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctputil.h 352592 2019-09-22 10:40:15Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "177: void sctp_stop_timers_for_shutdown(struct sctp_tcb *);",
          "179: void sctp_report_all_outbound(struct sctp_tcb *, uint16_t, int, int",
          "180: #if !defined(__APPLE__) && !defined(SCTP_SO_LOCK_TESTING)",
          "181:     SCTP_UNUSED",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8123b1c8449d46d47d3337e0ccb873fa8c238fce",
      "candidate_info": {
        "commit_hash": "8123b1c8449d46d47d3337e0ccb873fa8c238fce",
        "repo": "sctplab/usrsctp",
        "commit_url": "https://github.com/sctplab/usrsctp/commit/8123b1c8449d46d47d3337e0ccb873fa8c238fce",
        "files": [
          "usrsctplib/netinet/sctp_asconf.c",
          "usrsctplib/netinet/sctp_auth.c",
          "usrsctplib/netinet/sctp_input.c",
          "usrsctplib/netinet/sctp_output.c",
          "usrsctplib/netinet/sctp_output.h",
          "usrsctplib/netinet/sctp_pcb.c",
          "usrsctplib/netinet/sctp_peeloff.c",
          "usrsctplib/netinet/sctp_timer.c",
          "usrsctplib/netinet/sctp_usrreq.c",
          "usrsctplib/netinet/sctputil.c",
          "usrsctplib/netinet/sctputil.h",
          "usrsctplib/netinet6/sctp6_usrreq.c"
        ],
        "message": "ifdef cleanup, no functional change.",
        "before_after_code_files": [
          "usrsctplib/netinet/sctp_asconf.c||usrsctplinetinet/sctp_asconf.c",
          "usrsctplib/netinet/sctp_auth.c||usrsctplinetinet/sctp_auth.c",
          "usrsctplib/netinet/sctp_input.c||usrsctplinetinet/sctp_input.c",
          "usrsctplib/netinet/sctp_output.c||usrsctplinetinet/sctp_output.c",
          "usrsctplib/netinet/sctp_output.h||usrsctplinetinet/sctp_output.h",
          "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c",
          "usrsctplib/netinet/sctp_peeloff.c||usrsctplinetinet/sctp_peeloff.c",
          "usrsctplib/netinet/sctp_timer.c||usrsctplinetinet/sctp_timer.c",
          "usrsctplib/netinet/sctp_usrreq.c||usrsctplinetinet/sctp_usrreq.c",
          "usrsctplib/netinet/sctputil.c||usrsctplinetinet/sctputil.c",
          "usrsctplib/netinet/sctputil.h||usrsctplinetinet/sctputil.h",
          "usrsctplib/netinet6/sctp6_usrreq.c||usrsctplinetinet6/sctp6_usrreq.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "usrsctplib/netinet/sctp_asconf.c||usrsctplinetinet/sctp_asconf.c": [
          "File: usrsctplib/netinet/sctp_asconf.c -> usrsctplinetinet/sctp_asconf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_asconf.c 361243 2020-05-19 07:23:35Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "56: #if defined(__APPLE__)",
          "57: #define APPLE_FILE_NO 1",
          "58: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1207:   }",
          "1208:  }",
          "1209: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1239:    sctp_path_check_and_react(stcb, addr);",
          "1240:    return;",
          "1241:   }",
          "1244:   sctp_asconf_nets_cleanup(stcb, addr->ifn_p);",
          "1245:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_auth.c||usrsctplinetinet/sctp_auth.c": [
          "File: usrsctplib/netinet/sctp_auth.c -> usrsctplinetinet/sctp_auth.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_auth.c 361895 2020-06-07 14:39:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "567: }",
          "569: void",
          "575: {",
          "576:  sctp_sharedkey_t *skey;",
          "",
          "[Removed Lines]",
          "570: sctp_auth_key_release(struct sctp_tcb *stcb, uint16_t key_id, int so_locked",
          "571: #if !defined(__APPLE__)",
          "572:  SCTP_UNUSED",
          "573: #endif",
          "574: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1750: void",
          "1751: sctp_notify_authentication(struct sctp_tcb *stcb, uint32_t indication,",
          "1757: {",
          "1758:  struct mbuf *m_notify;",
          "1759:  struct sctp_authkey_event *auth;",
          "",
          "[Removed Lines]",
          "1752:       uint16_t keyid, uint16_t alt_keyid, int so_locked",
          "1753: #if !defined(__APPLE__)",
          "1754:  SCTP_UNUSED",
          "1755: #endif",
          "1756: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_input.c||usrsctplinetinet/sctp_input.c": [
          "File: usrsctplib/netinet/sctp_input.c -> usrsctplinetinet/sctp_input.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_input.c 361895 2020-06-07 14:39:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "63: #include <sys/smp.h>",
          "64: #endif",
          "71: static void",
          "72: sctp_stop_all_cookie_timers(struct sctp_tcb *stcb)",
          "73: {",
          "",
          "[Removed Lines]",
          "66: #if defined(__APPLE__)",
          "67: #define APPLE_FILE_NO 2",
          "68: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "244: int",
          "250: {",
          "251:  int unsent_data;",
          "252:  unsigned int i;",
          "",
          "[Removed Lines]",
          "245: sctp_is_there_unsent_data(struct sctp_tcb *stcb, int so_locked",
          "246: #if !defined(__APPLE__)",
          "247:  SCTP_UNUSED",
          "248: #endif",
          "249: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_output.c||usrsctplinetinet/sctp_output.c": [
          "File: usrsctplib/netinet/sctp_output.c -> usrsctplinetinet/sctp_output.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_output.c 361895 2020-06-07 14:39:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "78: #include <netinet6/sctp6_var.h>",
          "79: #endif",
          "85: #if defined(__APPLE__)",
          "86: #if !(defined(APPLE_LEOPARD) || defined(APPLE_SNOWLEOPARD))",
          "87: #define SCTP_MAX_LINKHDR 16",
          "",
          "[Removed Lines]",
          "81: #if defined(__APPLE__)",
          "82: #define APPLE_FILE_NO 3",
          "83: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4112: #if defined(__FreeBSD__)",
          "4113:     uint8_t mflowtype, uint32_t mflowid,",
          "4114: #endif",
          "4122: {",
          "",
          "[Removed Lines]",
          "4115: #if !defined(__APPLE__)",
          "4116:     int so_locked SCTP_UNUSED",
          "4117: #else",
          "4118:     int so_locked",
          "4119: #endif",
          "4120:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "5093: void",
          "5099: {",
          "5100:  struct mbuf *m, *m_last;",
          "5101:  struct sctp_nets *net;",
          "",
          "[Removed Lines]",
          "5094: sctp_send_initiate(struct sctp_inpcb *inp, struct sctp_tcb *stcb, int so_locked",
          "5095: #if !defined(__APPLE__)",
          "5096:     SCTP_UNUSED",
          "5097: #endif",
          "5098:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "7138:         int *num_out,",
          "7139:         int *reason_code,",
          "7140:         int control_only, int from_where,",
          "7147: static void",
          "7148: sctp_sendall_iterator(struct sctp_inpcb *inp, struct sctp_tcb *stcb, void *ptr,",
          "",
          "[Removed Lines]",
          "7141:         struct timeval *now, int *now_filled, int frag_point, int so_locked",
          "7142: #if !defined(__APPLE__)",
          "7143:         SCTP_UNUSED",
          "7144: #endif",
          "7145:                       );",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "7617: }",
          "7619: static void",
          "7625: {",
          "7626:  struct sctp_tmit_chunk *chk, *nchk;",
          "",
          "[Removed Lines]",
          "7620: sctp_clean_up_ctl(struct sctp_tcb *stcb, struct sctp_association *asoc, int so_locked",
          "7621: #if !defined(__APPLE__)",
          "7622:  SCTP_UNUSED",
          "7623: #endif",
          "7624: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "7724:                       int *giveup,",
          "7725:                       int eeor_mode,",
          "7726:                       int *bail,",
          "7732: {",
          "7734:  struct sctp_association *asoc;",
          "",
          "[Removed Lines]",
          "7727:                       int so_locked",
          "7728: #if !defined(__APPLE__)",
          "7729:                       SCTP_UNUSED",
          "7730: #endif",
          "7731:  )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "8251: static void",
          "8252: sctp_fill_outqueue(struct sctp_tcb *stcb,",
          "8258: {",
          "8259:  struct sctp_association *asoc;",
          "8260:  struct sctp_stream_out *strq;",
          "",
          "[Removed Lines]",
          "8253:     struct sctp_nets *net, int frag_point, int eeor_mode, int *quit_now, int so_locked",
          "8254: #if !defined(__APPLE__)",
          "8255:  SCTP_UNUSED",
          "8256: #endif",
          "8257: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "8378:         int *num_out,",
          "8379:         int *reason_code,",
          "8380:         int control_only, int from_where,",
          "8386: {",
          "",
          "[Removed Lines]",
          "8381:         struct timeval *now, int *now_filled, int frag_point, int so_locked",
          "8382: #if !defined(__APPLE__)",
          "8383:         SCTP_UNUSED",
          "8384: #endif",
          "8385:  )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "10002: sctp_chunk_retransmission(struct sctp_inpcb *inp,",
          "10003:     struct sctp_tcb *stcb,",
          "10004:     struct sctp_association *asoc,",
          "10010: {",
          "",
          "[Removed Lines]",
          "10005:     int *cnt_out, struct timeval *now, int *now_filled, int *fr_done, int so_locked",
          "10006: #if !defined(__APPLE__)",
          "10007:     SCTP_UNUSED",
          "10008: #endif",
          "10009:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "10566: sctp_chunk_output(struct sctp_inpcb *inp,",
          "10567:     struct sctp_tcb *stcb,",
          "10568:     int from_where,",
          "10574: {",
          "",
          "[Removed Lines]",
          "10569:     int so_locked",
          "10570: #if !defined(__APPLE__)",
          "10571:     SCTP_UNUSED",
          "10572: #endif",
          "10573:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "11102: }",
          "11104: void",
          "11110: {",
          "",
          "[Removed Lines]",
          "11105: sctp_send_sack(struct sctp_tcb *stcb, int so_locked",
          "11106: #if !defined(__APPLE__)",
          "11107:  SCTP_UNUSED",
          "11108: #endif",
          "11109: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "11498: }",
          "11500: void",
          "11506: {",
          "11507:  struct mbuf *m_abort, *m, *m_last;",
          "11508:  struct mbuf *m_out, *m_end = NULL;",
          "",
          "[Removed Lines]",
          "11501: sctp_send_abort_tcb(struct sctp_tcb *stcb, struct mbuf *operr, int so_locked",
          "11502: #if !defined(__APPLE__)",
          "11503:     SCTP_UNUSED",
          "11504: #endif",
          "11505:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "12069: }",
          "12071: void",
          "12077: {",
          "12078:  struct sctp_tmit_chunk *chk;",
          "12079:  struct sctp_heartbeat_chunk *hb;",
          "",
          "[Removed Lines]",
          "12072: sctp_send_hb(struct sctp_tcb *stcb, struct sctp_nets *net,int so_locked",
          "12073: #if !defined(__APPLE__)",
          "12074:  SCTP_UNUSED",
          "12075: #endif",
          "12076: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_output.h||usrsctplinetinet/sctp_output.h": [
          "File: usrsctplib/netinet/sctp_output.h -> usrsctplinetinet/sctp_output.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #ifndef _NETINET_SCTP_OUTPUT_H_",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_output.h 361895 2020-06-07 14:39:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "78: sctp_v4src_match_nexthop(struct sctp_ifa *sifa, sctp_route_t *ro);",
          "79: #endif",
          "87: void",
          "88: sctp_send_initiate_ack(struct sctp_inpcb *, struct sctp_tcb *,",
          "",
          "[Removed Lines]",
          "81: void sctp_send_initiate(struct sctp_inpcb *, struct sctp_tcb *, int",
          "82: #if !defined(__APPLE__)",
          "83:     SCTP_UNUSED",
          "84: #endif",
          "85:     );",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "167:     struct proc *, int);",
          "168: #endif",
          "181: void send_forward_tsn(struct sctp_tcb *, struct sctp_association *);",
          "",
          "[Removed Lines]",
          "170: void sctp_chunk_output(struct sctp_inpcb *, struct sctp_tcb *, int, int",
          "171: #if !defined(__APPLE__)",
          "172:     SCTP_UNUSED",
          "173: #endif",
          "174:     );",
          "175: void sctp_send_abort_tcb(struct sctp_tcb *, struct mbuf *, int",
          "176: #if !defined(__APPLE__)",
          "177:     SCTP_UNUSED",
          "178: #endif",
          "179:     );",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c": [
          "File: usrsctplib/netinet/sctp_pcb.c -> usrsctplinetinet/sctp_pcb.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_pcb.c 361934 2020-06-08 20:23:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "76: #endif",
          "77: #endif",
          "83: #if defined(__FreeBSD__)",
          "84: VNET_DEFINE(struct sctp_base_info, system_base_info);",
          "85: #else",
          "",
          "[Removed Lines]",
          "79: #if defined(__APPLE__)",
          "80: #define APPLE_FILE_NO 4",
          "81: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_peeloff.c||usrsctplinetinet/sctp_peeloff.c": [
          "File: usrsctplib/netinet/sctp_peeloff.c -> usrsctplinetinet/sctp_peeloff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_peeloff.c 337708 2018-08-13 13:58:45Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "49: #include <netinet/sctputil.h>",
          "50: #include <netinet/sctp_auth.h>",
          "56: int",
          "57: sctp_can_peel_off(struct socket *head, sctp_assoc_t assoc_id)",
          "58: {",
          "",
          "[Removed Lines]",
          "52: #if defined(__APPLE__)",
          "53: #define APPLE_FILE_NO 5",
          "54: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_timer.c||usrsctplinetinet/sctp_timer.c": [
          "File: usrsctplib/netinet/sctp_timer.c -> usrsctplinetinet/sctp_timer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #define _IP_VHL",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_timer.c 360878 2020-05-10 17:19:19Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "62: #endif",
          "63: #endif",
          "69: void",
          "70: sctp_audit_retranmission_queue(struct sctp_association *asoc)",
          "71: {",
          "",
          "[Removed Lines]",
          "65: #if defined(__APPLE__)",
          "66: #define APPLE_FILE_NO 6",
          "67: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_usrreq.c||usrsctplinetinet/sctp_usrreq.c": [
          "File: usrsctplib/netinet/sctp_usrreq.c -> usrsctplinetinet/sctp_usrreq.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_usrreq.c 361895 2020-06-07 14:39:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "69: #include <netinet/sctp_peeloff.h>",
          "76: extern const struct sctp_cc_functions sctp_cc_functions[];",
          "77: extern const struct sctp_ss_functions sctp_ss_functions[];",
          "",
          "[Removed Lines]",
          "72: #if defined(__APPLE__)",
          "73: #define APPLE_FILE_NO 7",
          "74: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctputil.c||usrsctplinetinet/sctputil.c": [
          "File: usrsctplib/netinet/sctputil.c -> usrsctplinetinet/sctputil.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctputil.c 361934 2020-06-08 20:23:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "71: #endif",
          "72: #endif",
          "78: #if defined(__Windows__)",
          "79: #if !defined(SCTP_LOCAL_TRACE_BUF)",
          "80: #include \"eventrace_netinet.h\"",
          "",
          "[Removed Lines]",
          "74: #if defined(__APPLE__)",
          "75: #define APPLE_FILE_NO 8",
          "76: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3234: static void",
          "3235: sctp_notify_assoc_change(uint16_t state, struct sctp_tcb *stcb,",
          "3241: {",
          "3242:  struct mbuf *m_notify;",
          "3243:  struct sctp_assoc_change *sac;",
          "",
          "[Removed Lines]",
          "3236:     uint16_t error, struct sctp_abort_chunk *abort, uint8_t from_peer, int so_locked",
          "3237: #if !defined(__APPLE__)",
          "3238:     SCTP_UNUSED",
          "3239: #endif",
          "3240:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "3395: static void",
          "3396: sctp_notify_peer_addr_change(struct sctp_tcb *stcb, uint32_t state,",
          "3402: {",
          "3403:  struct mbuf *m_notify;",
          "3404:  struct sctp_paddr_change *spc;",
          "",
          "[Removed Lines]",
          "3397:     struct sockaddr *sa, uint32_t error, int so_locked",
          "3398: #if !defined(__APPLE__)",
          "3399:     SCTP_UNUSED",
          "3400: #endif",
          "3401: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "3501: static void",
          "3502: sctp_notify_send_failed(struct sctp_tcb *stcb, uint8_t sent, uint32_t error,",
          "3508: {",
          "3509:  struct mbuf *m_notify;",
          "3510:  struct sctp_send_failed *ssf;",
          "",
          "[Removed Lines]",
          "3503:     struct sctp_tmit_chunk *chk, int so_locked",
          "3504: #if !defined(__APPLE__)",
          "3505:     SCTP_UNUSED",
          "3506: #endif",
          "3507:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3637: static void",
          "3638: sctp_notify_send_failed2(struct sctp_tcb *stcb, uint32_t error,",
          "3644: {",
          "3645:  struct mbuf *m_notify;",
          "3646:  struct sctp_send_failed *ssf;",
          "",
          "[Removed Lines]",
          "3639:     struct sctp_stream_queue_pending *sp, int so_locked",
          "3640: #if !defined(__APPLE__)",
          "3641:                          SCTP_UNUSED",
          "3642: #endif",
          "3643:                          )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "3787: static void",
          "3788: sctp_notify_partial_delivery_indication(struct sctp_tcb *stcb, uint32_t error,",
          "3794: {",
          "3795:  struct mbuf *m_notify;",
          "3796:  struct sctp_pdapi_event *pdapi;",
          "",
          "[Removed Lines]",
          "3789:      uint32_t val, int so_locked",
          "3790: #if !defined(__APPLE__)",
          "3791:                              SCTP_UNUSED",
          "3792: #endif",
          "3793:                                         )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "3950: static void",
          "3951: sctp_notify_sender_dry_event(struct sctp_tcb *stcb,",
          "3957: {",
          "3958:  struct mbuf *m_notify;",
          "3959:  struct sctp_sender_dry_event *event;",
          "",
          "[Removed Lines]",
          "3952:                              int so_locked",
          "3953: #if !defined(__APPLE__)",
          "3954:                              SCTP_UNUSED",
          "3955: #endif",
          "3956:                              )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "4241: void",
          "4242: sctp_ulp_notify(uint32_t notification, struct sctp_tcb *stcb,",
          "4248: {",
          "4249:  if ((stcb == NULL) ||",
          "4250:      (stcb->sctp_ep->sctp_flags & SCTP_PCB_FLAGS_SOCKET_GONE) ||",
          "",
          "[Removed Lines]",
          "4243:     uint32_t error, void *data, int so_locked",
          "4244: #if !defined(__APPLE__)",
          "4245:     SCTP_UNUSED",
          "4246: #endif",
          "4247:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "4445: }",
          "4447: void",
          "4453: {",
          "4454:  struct sctp_association *asoc;",
          "4455:  struct sctp_stream_out *outs;",
          "",
          "[Removed Lines]",
          "4448: sctp_report_all_outbound(struct sctp_tcb *stcb, uint16_t error, int holds_lock, int so_locked",
          "4449: #if !defined(__APPLE__)",
          "4450:     SCTP_UNUSED",
          "4451: #endif",
          "4452:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "4566: void",
          "4567: sctp_abort_notification(struct sctp_tcb *stcb, uint8_t from_peer, uint16_t error,",
          "4573: {",
          "4574:  if (stcb == NULL) {",
          "4575:   return;",
          "",
          "[Removed Lines]",
          "4568:    struct sctp_abort_chunk *abort, int so_locked",
          "4569: #if !defined(__APPLE__)",
          "4570:     SCTP_UNUSED",
          "4571: #endif",
          "4572:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "4715: void",
          "4716: sctp_abort_an_association(struct sctp_inpcb *inp, struct sctp_tcb *stcb,",
          "4717:                           struct mbuf *op_err,",
          "4723: {",
          "4724: #if defined(__APPLE__)",
          "4725:  struct socket *so;",
          "",
          "[Removed Lines]",
          "4718:                           int so_locked",
          "4719: #if !defined(__APPLE__)",
          "4720:                           SCTP_UNUSED",
          "4721: #endif",
          "4722: )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "5348:     struct sockbuf *sb,",
          "5349:     int end,",
          "5350:     int inp_read_lock_held,",
          "5356: {",
          "",
          "[Removed Lines]",
          "5351:     int so_locked",
          "5352: #if !defined(__APPLE__)",
          "5353:     SCTP_UNUSED",
          "5354: #endif",
          "5355:     )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "5545: int",
          "5546: sctp_release_pr_sctp_chunk(struct sctp_tcb *stcb, struct sctp_tmit_chunk *tp1,",
          "5552: {",
          "5553:  struct sctp_stream_out *strq;",
          "5554:  struct sctp_tmit_chunk *chk = NULL, *tp2;",
          "",
          "[Removed Lines]",
          "5547:       uint8_t sent, int so_locked",
          "5548: #if !defined(__APPLE__)",
          "5549:       SCTP_UNUSED",
          "5550: #endif",
          "5551:  )",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctputil.h||usrsctplinetinet/sctputil.h": [
          "File: usrsctplib/netinet/sctputil.h -> usrsctplinetinet/sctputil.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #if defined(__FreeBSD__)",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #ifndef _NETINET_SCTP_UTIL_H_",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctputil.h 361895 2020-06-07 14:39:20Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "130:     struct sockbuf *sb,",
          "131:     int end,",
          "132:     int inpread_locked,",
          "139: void sctp_iterator_worker(void);",
          "",
          "[Removed Lines]",
          "133:     int so_locked",
          "134: #if !defined(__APPLE__)",
          "135:     SCTP_UNUSED",
          "136: #endif",
          "137:     );",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "162: struct mbuf *",
          "163: sctp_pad_lastmbuf(struct mbuf *, int, struct mbuf *);",
          "171: void",
          "172: sctp_pull_off_control_to_new_inp(struct sctp_inpcb *old_inp,",
          "",
          "[Removed Lines]",
          "165: void sctp_ulp_notify(uint32_t, struct sctp_tcb *, uint32_t, void *, int",
          "166: #if !defined(__APPLE__)",
          "167:     SCTP_UNUSED",
          "168: #endif",
          "169:     );",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "180: void sctp_stop_association_timers(struct sctp_tcb *, bool);",
          "188: int sctp_expand_mapping_array(struct sctp_association *, uint32_t);",
          "190: void sctp_abort_notification(struct sctp_tcb *, uint8_t, uint16_t,",
          "198: void",
          "",
          "[Removed Lines]",
          "182: void sctp_report_all_outbound(struct sctp_tcb *, uint16_t, int, int",
          "183: #if !defined(__APPLE__)",
          "184:     SCTP_UNUSED",
          "185: #endif",
          "186:     );",
          "191:         struct sctp_abort_chunk *, int",
          "192: #if !defined(__APPLE__)",
          "193:     SCTP_UNUSED",
          "194: #endif",
          "195:     );",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "209: void",
          "210: sctp_abort_an_association(struct sctp_inpcb *, struct sctp_tcb *,",
          "217: void sctp_handle_ootb(struct mbuf *, int, int,",
          "218:                       struct sockaddr *, struct sockaddr *,",
          "",
          "[Removed Lines]",
          "211:     struct mbuf *, int",
          "212: #if !defined(__APPLE__)",
          "213:     SCTP_UNUSED",
          "214: #endif",
          "215: );",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "280: int",
          "281: sctp_release_pr_sctp_chunk(struct sctp_tcb *, struct sctp_tmit_chunk *,",
          "288: struct mbuf *sctp_generate_cause(uint16_t, char *);",
          "289: struct mbuf *sctp_generate_no_user_data_cause(uint32_t);",
          "",
          "[Removed Lines]",
          "282:     uint8_t, int",
          "283: #if !defined(__APPLE__)",
          "284:     SCTP_UNUSED",
          "285: #endif",
          "286: );",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet6/sctp6_usrreq.c||usrsctplinetinet6/sctp6_usrreq.c": [
          "File: usrsctplib/netinet6/sctp6_usrreq.c -> usrsctplinetinet6/sctp6_usrreq.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "62: #include <netinet/icmp6.h>",
          "63: #include <netinet/udp.h>",
          "64: #endif",
          "68: #if defined(__Userspace__)",
          "69: int ip6_v6only=0;",
          "70: #endif",
          "",
          "[Removed Lines]",
          "65: #if defined(__APPLE__)",
          "66: #define APPLE_FILE_NO 9",
          "67: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d07a5f27630b1250655337791adf2a4c171a6712",
      "candidate_info": {
        "commit_hash": "d07a5f27630b1250655337791adf2a4c171a6712",
        "repo": "sctplab/usrsctp",
        "commit_url": "https://github.com/sctplab/usrsctp/commit/d07a5f27630b1250655337791adf2a4c171a6712",
        "files": [
          "usrsctplib/netinet/sctp_asconf.c",
          "usrsctplib/netinet/sctp_asconf.h",
          "usrsctplib/netinet/sctp_indata.c",
          "usrsctplib/netinet/sctp_input.c",
          "usrsctplib/netinet/sctp_output.c",
          "usrsctplib/netinet/sctp_pcb.c",
          "usrsctplib/netinet/sctp_timer.c",
          "usrsctplib/netinet/sctp_usrreq.c",
          "usrsctplib/netinet/sctputil.c"
        ],
        "message": "Cleanup starting and stopping timers.",
        "before_after_code_files": [
          "usrsctplib/netinet/sctp_asconf.c||usrsctplinetinet/sctp_asconf.c",
          "usrsctplib/netinet/sctp_asconf.h||usrsctplinetinet/sctp_asconf.h",
          "usrsctplib/netinet/sctp_indata.c||usrsctplinetinet/sctp_indata.c",
          "usrsctplib/netinet/sctp_input.c||usrsctplinetinet/sctp_input.c",
          "usrsctplib/netinet/sctp_output.c||usrsctplinetinet/sctp_output.c",
          "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c",
          "usrsctplib/netinet/sctp_timer.c||usrsctplinetinet/sctp_timer.c",
          "usrsctplib/netinet/sctp_usrreq.c||usrsctplinetinet/sctp_usrreq.c",
          "usrsctplib/netinet/sctputil.c||usrsctplinetinet/sctputil.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "usrsctplib/netinet/sctp_asconf.c||usrsctplinetinet/sctp_asconf.c": [
          "File: usrsctplib/netinet/sctp_asconf.c -> usrsctplinetinet/sctp_asconf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_asconf.c 357197 2020-01-28 10:09:05Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "957: void",
          "959: {",
          "964:    SCTP_FROM_SCTP_ASCONF + SCTP_LOC_2);",
          "965:  stcb->asoc.asconf_seq_out_acked = stcb->asoc.asconf_seq_out;",
          "",
          "[Removed Lines]",
          "958: sctp_asconf_cleanup(struct sctp_tcb *stcb, struct sctp_nets *net)",
          "963:  sctp_timer_stop(SCTP_TIMER_TYPE_ASCONF, stcb->sctp_ep, stcb, net,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1740:  if (serial_num == asoc->asconf_seq_out - 1) {",
          "1743:     SCTP_FROM_SCTP_ASCONF + SCTP_LOC_5);",
          "1744:  }",
          "",
          "[Removed Lines]",
          "1742:   sctp_timer_stop(SCTP_TIMER_TYPE_ASCONF, stcb->sctp_ep, stcb, net,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_asconf.h||usrsctplinetinet/sctp_asconf.h": [
          "File: usrsctplib/netinet/sctp_asconf.h -> usrsctplinetinet/sctp_asconf.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #ifndef _NETINET_SCTP_ASCONF_H_",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_asconf.h 324056 2017-09-27 13:05:23Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "50: extern struct mbuf *sctp_compose_asconf(struct sctp_tcb *, int *, int);",
          "",
          "[Removed Lines]",
          "48: extern void sctp_asconf_cleanup(struct sctp_tcb *, struct sctp_nets *);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_indata.c||usrsctplinetinet/sctp_indata.c": [
          "File: usrsctplib/netinet/sctp_indata.c -> usrsctplinetinet/sctp_indata.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_indata.c 357705 2020-02-09 22:05:41Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4378:    sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWN,",
          "4379:       stcb->sctp_ep, stcb, netp);",
          "4380:    sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD,",
          "4382:   } else if ((SCTP_GET_STATE(stcb) == SCTP_STATE_SHUTDOWN_RECEIVED) &&",
          "4383:       (asoc->stream_queue_cnt == 0)) {",
          "4384:    struct sctp_nets *netp;",
          "",
          "[Removed Lines]",
          "4381:       stcb->sctp_ep, stcb, netp);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "5094:    sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWN,",
          "5095:       stcb->sctp_ep, stcb, netp);",
          "5096:    sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD,",
          "5098:    return;",
          "5099:   } else if ((SCTP_GET_STATE(stcb) == SCTP_STATE_SHUTDOWN_RECEIVED) &&",
          "5100:       (asoc->stream_queue_cnt == 0)) {",
          "",
          "[Removed Lines]",
          "5097:       stcb->sctp_ep, stcb, netp);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_input.c||usrsctplinetinet/sctp_input.c": [
          "File: usrsctplib/netinet/sctp_input.c -> usrsctplinetinet/sctp_input.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_input.c 355135 2019-11-27 19:32:29Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "895:   error = 0;",
          "896:  }",
          "899:                  SCTP_FROM_SCTP_INPUT + SCTP_LOC_7);",
          "901:  sctp_abort_notification(stcb, 1, error, abort, SCTP_SO_NOT_LOCKED);",
          "",
          "[Removed Lines]",
          "898:  sctp_timer_stop(SCTP_TIMER_TYPE_RECV, stcb->sctp_ep, stcb, net,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1178: }",
          "1180: static void",
          "1183: {",
          "1184:  switch (chunk_type) {",
          "1185:  case SCTP_ASCONF_ACK:",
          "1186:  case SCTP_ASCONF:",
          "1188:   break;",
          "1189:  case SCTP_IFORWARD_CUM_TSN:",
          "1190:  case SCTP_FORWARD_CUM_TSN:",
          "",
          "[Removed Lines]",
          "1181: sctp_process_unrecog_chunk(struct sctp_tcb *stcb, uint8_t chunk_type,",
          "1182:     struct sctp_nets *net)",
          "1187:   sctp_asconf_cleanup(stcb, net);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1362:     struct sctp_error_unrecognized_chunk *unrec_chunk;",
          "1364:     unrec_chunk = (struct sctp_error_unrecognized_chunk *)cause;",
          "1366:    }",
          "1367:    break;",
          "1368:   case SCTP_CAUSE_UNRECOG_PARAM:",
          "",
          "[Removed Lines]",
          "1365:     sctp_process_unrecog_chunk(stcb, unrec_chunk->ch.chunk_type, net);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1731:     SCTP_SET_STATE(stcb, SCTP_STATE_OPEN);",
          "1732:     if (asoc->state & SCTP_STATE_SHUTDOWN_PENDING) {",
          "1733:      sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD,",
          "1735:     }",
          "1736:     SCTP_STAT_INCR_GAUGE32(sctps_currestab);",
          "1737:     sctp_stop_all_cookie_timers(stcb);",
          "",
          "[Removed Lines]",
          "1734:         stcb->sctp_ep, stcb, asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1971:   SCTP_SET_STATE(stcb, SCTP_STATE_OPEN);",
          "1972:   if (asoc->state & SCTP_STATE_SHUTDOWN_PENDING) {",
          "1973:    sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD,",
          "1975:   }",
          "1976:   sctp_stop_all_cookie_timers(stcb);",
          "1977:   sctp_toss_old_cookies(stcb, asoc);",
          "",
          "[Removed Lines]",
          "1974:       stcb->sctp_ep, stcb, asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2042:   if (asoc->state & SCTP_STATE_SHUTDOWN_PENDING) {",
          "2043:    SCTP_SET_STATE(stcb, SCTP_STATE_OPEN);",
          "2044:    sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD,",
          "2047:   } else if (SCTP_GET_STATE(stcb) != SCTP_STATE_SHUTDOWN_SENT) {",
          "",
          "[Removed Lines]",
          "2045:       stcb->sctp_ep, stcb, asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2471:  SCTP_SET_STATE(stcb, SCTP_STATE_OPEN);",
          "2472:  if (asoc->state & SCTP_STATE_SHUTDOWN_PENDING) {",
          "2473:   sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD,",
          "2475:  }",
          "2476:  sctp_stop_all_cookie_timers(stcb);",
          "2477:  SCTP_STAT_INCR_COUNTER32(sctps_passiveestab);",
          "",
          "[Removed Lines]",
          "2474:      stcb->sctp_ep, stcb, asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "3166:   sctp_start_net_timers(stcb);",
          "3167:   if (asoc->state & SCTP_STATE_SHUTDOWN_PENDING) {",
          "3168:    sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD,",
          "3171:   }",
          "",
          "[Removed Lines]",
          "3169:       stcb->sctp_ep, stcb, asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3838:  }",
          "3839:  asoc->str_reset = NULL;",
          "3840:  sctp_timer_stop(SCTP_TIMER_TYPE_STRRESET, stcb->sctp_ep, stcb,",
          "3842:  TAILQ_REMOVE(&asoc->control_send_queue, chk, sctp_next);",
          "3843:  asoc->ctrl_queue_cnt--;",
          "3844:  if (chk->data) {",
          "",
          "[Removed Lines]",
          "3841:                  chk->whoTo, SCTP_FROM_SCTP_INPUT + SCTP_LOC_28);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_output.c||usrsctplinetinet/sctp_output.c": [
          "File: usrsctplib/netinet/sctp_output.c -> usrsctplinetinet/sctp_output.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_output.c 358083 2020-02-18 21:25:17Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "7222:      sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWN, stcb->sctp_ep, stcb,",
          "7223:         net);",
          "7224:      sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD, stcb->sctp_ep, stcb,",
          "7226:      added_control = 1;",
          "7227:      do_chunk_output = 0;",
          "7228:     }",
          "",
          "[Removed Lines]",
          "7225:         asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "7262:       goto no_chunk_output;",
          "7263:      }",
          "7264:      sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD, stcb->sctp_ep, stcb,",
          "7266:     }",
          "7267:    }",
          "",
          "[Removed Lines]",
          "7265:         asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "8962:       if (SCTP_OS_TIMER_PENDING(&stcb->asoc.dack_timer.timer)) {",
          "8963:        sctp_timer_stop(SCTP_TIMER_TYPE_RECV,",
          "8965:                        SCTP_FROM_SCTP_OUTPUT + SCTP_LOC_1);",
          "8966:       }",
          "8967:      }",
          "",
          "[Removed Lines]",
          "8964:                        inp, stcb, net,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "14717:     sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWN, stcb->sctp_ep, stcb,",
          "14718:                      netp);",
          "14719:     sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD, stcb->sctp_ep, stcb,",
          "14721:    }",
          "14722:   } else {",
          "",
          "[Removed Lines]",
          "14720:                      asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "14770:      goto out;",
          "14771:     }",
          "14772:     sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD, stcb->sctp_ep, stcb,",
          "14774:     sctp_feature_off(inp, SCTP_PCB_FLAGS_NODELAY);",
          "14775:    }",
          "14776:   }",
          "",
          "[Removed Lines]",
          "14773:                      asoc->primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_pcb.c||usrsctplinetinet/sctp_pcb.c": [
          "File: usrsctplib/netinet/sctp_pcb.c -> usrsctplinetinet/sctp_pcb.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_pcb.c 357830 2020-02-12 17:05:10Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4030:      sctp_send_shutdown(asoc, netp);",
          "4031:      sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWN, asoc->sctp_ep, asoc,",
          "4032:          netp);",
          "4035:      sctp_chunk_output(inp, asoc, SCTP_OUTPUT_FROM_SHUT_TMR, SCTP_SO_LOCKED);",
          "4036:     }",
          "4037:    } else {",
          "4039:     SCTP_ADD_SUBSTATE(asoc, SCTP_STATE_SHUTDOWN_PENDING);",
          "4042:     if ((*asoc->asoc.ss_functions.sctp_ss_is_user_msgs_incomplete)(asoc, &asoc->asoc)) {",
          "4043:      SCTP_ADD_SUBSTATE(asoc, SCTP_STATE_PARTIAL_MSG_LEFT);",
          "4044:     }",
          "",
          "[Removed Lines]",
          "4033:      sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD, asoc->sctp_ep, asoc,",
          "4034:          asoc->asoc.primary_destination);",
          "4040:     sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD, asoc->sctp_ep, asoc,",
          "4041:        asoc->asoc.primary_destination);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_timer.c||usrsctplinetinet/sctp_timer.c": [
          "File: usrsctplib/netinet/sctp_timer.c -> usrsctplinetinet/sctp_timer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #define _IP_VHL",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_timer.c 359151 2020-03-19 18:55:54Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1208:    SCTPDBG(SCTP_DEBUG_TIMER1, \"asconf_timer: Peer has not responded to our repeated ASCONFs\\n\");",
          "1210:    return (0);",
          "1211:   }",
          "",
          "[Removed Lines]",
          "1209:    sctp_asconf_cleanup(stcb, net);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctp_usrreq.c||usrsctplinetinet/sctp_usrreq.c": [
          "File: usrsctplib/netinet/sctp_usrreq.c -> usrsctplinetinet/sctp_usrreq.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctp_usrreq.c 358083 2020-02-18 21:25:17Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "675:  return (error);",
          "676: }",
          "",
          "[Removed Lines]",
          "678: SYSCTL_PROC(_net_inet_sctp, OID_AUTO, getcred, CTLTYPE_OPAQUE | CTLFLAG_RW,",
          "679:     0, 0, sctp_getcred, \"S,ucred\", \"Get the ucred of a SCTP connection\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1258:      }",
          "1259:      sctp_send_shutdown(stcb,netp);",
          "1260:      sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWN,",
          "1262:      sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD,",
          "1264:      sctp_chunk_output(stcb->sctp_ep, stcb, SCTP_OUTPUT_FROM_T3, SCTP_SO_LOCKED);",
          "1265:     }",
          "1266:    } else {",
          "",
          "[Removed Lines]",
          "1261:         stcb->sctp_ep, stcb, netp);",
          "1263:         stcb->sctp_ep, stcb, netp);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1282:     }",
          "1284:     SCTP_ADD_SUBSTATE(stcb, SCTP_STATE_SHUTDOWN_PENDING);",
          "1287:     if ((*asoc->ss_functions.sctp_ss_is_user_msgs_incomplete)(stcb, asoc)) {",
          "1288:      SCTP_ADD_SUBSTATE(stcb, SCTP_STATE_PARTIAL_MSG_LEFT);",
          "1289:     }",
          "",
          "[Removed Lines]",
          "1285:     sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD, stcb->sctp_ep, stcb,",
          "1286:        netp);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1501:     return (0);",
          "1502:    }",
          "1503:   }",
          "1506:   sctp_chunk_output(inp, stcb, SCTP_OUTPUT_FROM_CLOSING, SCTP_SO_LOCKED);",
          "1507:   SCTP_TCB_UNLOCK(stcb);",
          "",
          "[Removed Lines]",
          "1504:   sctp_timer_start(SCTP_TIMER_TYPE_SHUTDOWNGUARD, stcb->sctp_ep, stcb, netp);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "usrsctplib/netinet/sctputil.c||usrsctplinetinet/sctputil.c": [
          "File: usrsctplib/netinet/sctputil.c -> usrsctplinetinet/sctputil.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: #ifdef __FreeBSD__",
          "36: #include <sys/cdefs.h>",
          "38: #endif",
          "40: #include <netinet/sctp_os.h>",
          "",
          "[Removed Lines]",
          "37: __FBSDID(\"$FreeBSD: head/sys/netinet/sctputil.c 359151 2020-03-19 18:55:54Z tuexen $\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1973:     inp->sctp_ep.secret_key[secret][i] =",
          "1974:         sctp_select_initial_TSN(&inp->sctp_ep);",
          "1975:    }",
          "1977:   }",
          "1978:   did_output = 0;",
          "1979:   break;",
          "",
          "[Removed Lines]",
          "1976:    sctp_timer_start(SCTP_TIMER_TYPE_NEWCOOKIE, inp, stcb, net);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}