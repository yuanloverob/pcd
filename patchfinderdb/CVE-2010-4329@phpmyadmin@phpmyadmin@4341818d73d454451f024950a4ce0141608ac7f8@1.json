{
  "cve_id": "CVE-2010-4329",
  "cve_desc": "Cross-site scripting (XSS) vulnerability in the PMA_linkOrButton function in libraries/common.lib.php in the database (db) search script in phpMyAdmin 2.11.x before 2.11.11.1 and 3.x before 3.3.8.1 allows remote attackers to inject arbitrary web script or HTML via a crafted request.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "4341818d73d454451f024950a4ce0141608ac7f8",
  "patch_info": {
    "commit_hash": "4341818d73d454451f024950a4ce0141608ac7f8",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/4341818d73d454451f024950a4ce0141608ac7f8",
    "files": [
      "libraries/common.lib.php"
    ],
    "message": "bug #3115519: fixed XSS on search",
    "before_after_code_files": [
      "libraries/common.lib.php||libraries/common.lib.php"
    ]
  },
  "patch_diff": {
    "libraries/common.lib.php||libraries/common.lib.php": [
      "File: libraries/common.lib.php -> libraries/common.lib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1634:         $tmp = $tag_params;",
      "1635:         $tag_params = array();",
      "1636:         if (!empty($tmp)) {",
      "1638:         }",
      "1639:         unset($tmp);",
      "1640:     }",
      "",
      "[Removed Lines]",
      "1637:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . $tmp . '\\')';",
      "",
      "[Added Lines]",
      "1637:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . PMA_escapeJsString($tmp) . '\\')';",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6d3b66059afe25da2bb1df00bdac76829f2f940d",
      "candidate_info": {
        "commit_hash": "6d3b66059afe25da2bb1df00bdac76829f2f940d",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/6d3b66059afe25da2bb1df00bdac76829f2f940d",
        "files": [
          "libraries/common.lib.php"
        ],
        "message": "bug #3115519: fixed XSS on search",
        "before_after_code_files": [
          "libraries/common.lib.php||libraries/common.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ],
          "candidate": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.lib.php||libraries/common.lib.php": [
          "File: libraries/common.lib.php -> libraries/common.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1769:         $tmp = $tag_params;",
          "1770:         $tag_params = array();",
          "1771:         if (!empty($tmp)) {",
          "1773:         }",
          "1774:         unset($tmp);",
          "1775:     }",
          "",
          "[Removed Lines]",
          "1772:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . $tmp . '\\')';",
          "",
          "[Added Lines]",
          "1772:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . PMA_escapeJsString($tmp) . '\\')';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fff3afc08e73b1fedafec2490f343bcb3dd541be",
      "candidate_info": {
        "commit_hash": "fff3afc08e73b1fedafec2490f343bcb3dd541be",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/fff3afc08e73b1fedafec2490f343bcb3dd541be",
        "files": [
          "ChangeLog",
          "db_search.php"
        ],
        "message": "bug #3115519: Prevent long queries from being shown in confirmation popup",
        "before_after_code_files": [
          "db_search.php||db_search.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "db_search.php||db_search.php": [
          "File: db_search.php -> db_search.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "257:             $this_url_params['sql_query'] = $newsearchsqls['delete'];",
          "258:             echo '<td>' . PMA_linkOrButton(",
          "259:                     'sql.php' . PMA_generate_common_url($this_url_params),",
          "262:         } else {",
          "263:             echo '<td>&nbsp;</td>' . \"\\n\"",
          "",
          "[Removed Lines]",
          "260:                     __('Delete'), $newsearchsqls['delete']) .  \"</td>\\n\";",
          "",
          "[Added Lines]",
          "260:                     __('Delete'), printf(__('Delete the matches for the \"%s\" table?'), htmlspecialchars($each_table))) .  \"</td>\\n\";",
          "",
          "---------------"
        ]
      }
    }
  ]
}