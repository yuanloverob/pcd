{
  "cve_id": "CVE-2014-0127",
  "cve_desc": "The time-validation implementation in (1) mod/feedback/complete.php and (2) mod/feedback/complete_guest.php in Moodle through 2.3.11, 2.4.x before 2.4.9, 2.5.x before 2.5.5, and 2.6.x before 2.6.2 allows remote authenticated users to bypass intended restrictions on starting a Feedback activity by choosing an unavailable time.",
  "repo": "moodle/moodle",
  "patch_hash": "1298acc7075614d8f24befe7e50edbd695498d66",
  "patch_info": {
    "commit_hash": "1298acc7075614d8f24befe7e50edbd695498d66",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/1298acc7075614d8f24befe7e50edbd695498d66",
    "files": [
      "mod/feedback/complete.php",
      "mod/feedback/complete_guest.php"
    ],
    "message": "MDL-43656 mod_feedback: availablity date logic incorrect",
    "before_after_code_files": [
      "mod/feedback/complete.php||mod/feedback/complete.php",
      "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
    ]
  },
  "patch_diff": {
    "mod/feedback/complete.php||mod/feedback/complete.php": [
      "File: mod/feedback/complete.php -> mod/feedback/complete.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "178: $checktime = time();",
      "181:                             $feedback->timeclose > 0);",
      "183: if ($feedback_is_closed) {",
      "",
      "[Removed Lines]",
      "179: $feedback_is_closed = ($feedback->timeopen > $checktime) OR",
      "180:                       ($feedback->timeclose < $checktime AND",
      "",
      "[Added Lines]",
      "179: $feedback_is_closed = ($feedback->timeopen > $checktime) ||",
      "180:                       ($feedback->timeclose < $checktime &&",
      "",
      "---------------"
    ],
    "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php": [
      "File: mod/feedback/complete_guest.php -> mod/feedback/complete_guest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "178: $checktime = time();",
      "182:                             $feedback->timeclose > 0);",
      "184: if ($feedback_is_closed) {",
      "",
      "[Removed Lines]",
      "180: $feedback_is_closed = ($feedback->timeopen > $checktime) OR",
      "181:                       ($feedback->timeclose < $checktime AND",
      "",
      "[Added Lines]",
      "180: $feedback_is_closed = ($feedback->timeopen > $checktime) ||",
      "181:                       ($feedback->timeclose < $checktime &&",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "71037bf26c1e66c628f952b777a9b068775f7b24",
      "candidate_info": {
        "commit_hash": "71037bf26c1e66c628f952b777a9b068775f7b24",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/71037bf26c1e66c628f952b777a9b068775f7b24",
        "files": [
          "mod/feedback/complete.php",
          "mod/feedback/complete_guest.php"
        ],
        "message": "MDL-43656 mod_feedback: availablity date logic incorrect",
        "before_after_code_files": [
          "mod/feedback/complete.php||mod/feedback/complete.php",
          "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "mod/feedback/complete.php||mod/feedback/complete.php",
            "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
          ],
          "candidate": [
            "mod/feedback/complete.php||mod/feedback/complete.php",
            "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/feedback/complete.php||mod/feedback/complete.php": [
          "File: mod/feedback/complete.php -> mod/feedback/complete.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "178: $checktime = time();",
          "181:                             $feedback->timeclose > 0);",
          "183: if ($feedback_is_closed) {",
          "",
          "[Removed Lines]",
          "179: $feedback_is_closed = ($feedback->timeopen > $checktime) OR",
          "180:                       ($feedback->timeclose < $checktime AND",
          "",
          "[Added Lines]",
          "179: $feedback_is_closed = ($feedback->timeopen > $checktime) ||",
          "180:                       ($feedback->timeclose < $checktime &&",
          "",
          "---------------"
        ],
        "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php": [
          "File: mod/feedback/complete_guest.php -> mod/feedback/complete_guest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "178: $checktime = time();",
          "182:                             $feedback->timeclose > 0);",
          "184: if ($feedback_is_closed) {",
          "",
          "[Removed Lines]",
          "180: $feedback_is_closed = ($feedback->timeopen > $checktime) OR",
          "181:                       ($feedback->timeclose < $checktime AND",
          "",
          "[Added Lines]",
          "180: $feedback_is_closed = ($feedback->timeopen > $checktime) ||",
          "181:                       ($feedback->timeclose < $checktime &&",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7b839b0ec1d3d7fdfe7f76066c49829936a2390e",
      "candidate_info": {
        "commit_hash": "7b839b0ec1d3d7fdfe7f76066c49829936a2390e",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/7b839b0ec1d3d7fdfe7f76066c49829936a2390e",
        "files": [
          "mod/feedback/complete.php",
          "mod/feedback/complete_guest.php"
        ],
        "message": "MDL-43656 mod_feedback: availablity date logic incorrect",
        "before_after_code_files": [
          "mod/feedback/complete.php||mod/feedback/complete.php",
          "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "mod/feedback/complete.php||mod/feedback/complete.php",
            "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
          ],
          "candidate": [
            "mod/feedback/complete.php||mod/feedback/complete.php",
            "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/feedback/complete.php||mod/feedback/complete.php": [
          "File: mod/feedback/complete.php -> mod/feedback/complete.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "178: $checktime = time();",
          "181:                             $feedback->timeclose > 0);",
          "183: if ($feedback_is_closed) {",
          "",
          "[Removed Lines]",
          "179: $feedback_is_closed = ($feedback->timeopen > $checktime) OR",
          "180:                       ($feedback->timeclose < $checktime AND",
          "",
          "[Added Lines]",
          "179: $feedback_is_closed = ($feedback->timeopen > $checktime) ||",
          "180:                       ($feedback->timeclose < $checktime &&",
          "",
          "---------------"
        ],
        "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php": [
          "File: mod/feedback/complete_guest.php -> mod/feedback/complete_guest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "178: $checktime = time();",
          "182:                             $feedback->timeclose > 0);",
          "184: if ($feedback_is_closed) {",
          "",
          "[Removed Lines]",
          "180: $feedback_is_closed = ($feedback->timeopen > $checktime) OR",
          "181:                       ($feedback->timeclose < $checktime AND",
          "",
          "[Added Lines]",
          "180: $feedback_is_closed = ($feedback->timeopen > $checktime) ||",
          "181:                       ($feedback->timeclose < $checktime &&",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "aea324963dfee857315d147bf0c17659bb43991e",
      "candidate_info": {
        "commit_hash": "aea324963dfee857315d147bf0c17659bb43991e",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/aea324963dfee857315d147bf0c17659bb43991e",
        "files": [
          "mod/feedback/complete.php",
          "mod/feedback/complete_guest.php"
        ],
        "message": "MDL-43656 mod_feedback: availablity date logic incorrect",
        "before_after_code_files": [
          "mod/feedback/complete.php||mod/feedback/complete.php",
          "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "mod/feedback/complete.php||mod/feedback/complete.php",
            "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
          ],
          "candidate": [
            "mod/feedback/complete.php||mod/feedback/complete.php",
            "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/feedback/complete.php||mod/feedback/complete.php": [
          "File: mod/feedback/complete.php -> mod/feedback/complete.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "178: $checktime = time();",
          "181:                             $feedback->timeclose > 0);",
          "183: if ($feedback_is_closed) {",
          "",
          "[Removed Lines]",
          "179: $feedback_is_closed = ($feedback->timeopen > $checktime) OR",
          "180:                       ($feedback->timeclose < $checktime AND",
          "",
          "[Added Lines]",
          "179: $feedback_is_closed = ($feedback->timeopen > $checktime) ||",
          "180:                       ($feedback->timeclose < $checktime &&",
          "",
          "---------------"
        ],
        "mod/feedback/complete_guest.php||mod/feedback/complete_guest.php": [
          "File: mod/feedback/complete_guest.php -> mod/feedback/complete_guest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "178: $checktime = time();",
          "182:                             $feedback->timeclose > 0);",
          "184: if ($feedback_is_closed) {",
          "",
          "[Removed Lines]",
          "180: $feedback_is_closed = ($feedback->timeopen > $checktime) OR",
          "181:                       ($feedback->timeclose < $checktime AND",
          "",
          "[Added Lines]",
          "180: $feedback_is_closed = ($feedback->timeopen > $checktime) ||",
          "181:                       ($feedback->timeclose < $checktime &&",
          "",
          "---------------"
        ]
      }
    }
  ]
}