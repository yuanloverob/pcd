{
  "cve_id": "CVE-2020-14404",
  "cve_desc": "An issue was discovered in LibVNCServer before 0.9.13. libvncserver/rre.c allows out-of-bounds access via encodings.",
  "repo": "LibVNC/libvncserver",
  "patch_hash": "74e8a70f2c9a5248d6718ce443e07c7ed314dfff",
  "patch_info": {
    "commit_hash": "74e8a70f2c9a5248d6718ce443e07c7ed314dfff",
    "repo": "LibVNC/libvncserver",
    "commit_url": "https://github.com/LibVNC/libvncserver/commit/74e8a70f2c9a5248d6718ce443e07c7ed314dfff",
    "files": [
      "libvncserver/corre.c",
      "libvncserver/hextile.c",
      "libvncserver/rre.c"
    ],
    "message": "libvncserver: encodings: prevent OOB accesses",
    "before_after_code_files": [
      "libvncserver/corre.c||libvncserver/corre.c",
      "libvncserver/hextile.c||libvncserver/hextile.c",
      "libvncserver/rre.c||libvncserver/rre.c"
    ]
  },
  "patch_diff": {
    "libvncserver/corre.c||libvncserver/corre.c": [
      "File: libvncserver/corre.c -> libvncserver/corre.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "233:             seg = data+(j*w);                                                 \\",
      "234:             if (seg[x] != cl) {break;}                                        \\",
      "235:             i = x;                                                            \\",
      "237:             i -= 1;                                                           \\",
      "238:             if (j == y) vx = hx = i;                                          \\",
      "239:             if (i < vx) vx = i;                                               \\",
      "",
      "[Removed Lines]",
      "236:             while ((seg[i] == cl) && (i < w)) i += 1;                         \\",
      "",
      "[Added Lines]",
      "236:             while ((i < w) && (seg[i] == cl)) i += 1;                         \\",
      "",
      "---------------"
    ],
    "libvncserver/hextile.c||libvncserver/hextile.c": [
      "File: libvncserver/hextile.c -> libvncserver/hextile.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "224:                     seg = data+(j*w);                                           \\",
      "225:                     if (seg[x] != cl2) {break;}                                 \\",
      "226:                     i = x;                                                      \\",
      "228:                     i -= 1;                                                     \\",
      "229:                     if (j == y) vx = hx = i;                                    \\",
      "230:                     if (i < vx) vx = i;                                         \\",
      "",
      "[Removed Lines]",
      "227:                     while ((seg[i] == cl2) && (i < w)) i += 1;                  \\",
      "",
      "[Added Lines]",
      "227:                     while ((i < w) && (seg[i] == cl2)) i += 1;                  \\",
      "",
      "---------------"
    ],
    "libvncserver/rre.c||libvncserver/rre.c": [
      "File: libvncserver/rre.c -> libvncserver/rre.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "200:             seg = data+(j*w);                                                 \\",
      "201:             if (seg[x] != cl) {break;}                                        \\",
      "202:             i = x;                                                            \\",
      "204:             i -= 1;                                                           \\",
      "205:             if (j == y) vx = hx = i;                                          \\",
      "206:             if (i < vx) vx = i;                                               \\",
      "",
      "[Removed Lines]",
      "203:             while ((seg[i] == cl) && (i < w)) i += 1;                         \\",
      "",
      "[Added Lines]",
      "203:             while ((i < w) && (seg[i] == cl)) i += 1;                         \\",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "05767eb3f9a90076b786bc439a8d7afa72baf45d",
      "candidate_info": {
        "commit_hash": "05767eb3f9a90076b786bc439a8d7afa72baf45d",
        "repo": "LibVNC/libvncserver",
        "commit_url": "https://github.com/LibVNC/libvncserver/commit/05767eb3f9a90076b786bc439a8d7afa72baf45d",
        "files": [
          "common/vncauth.c"
        ],
        "message": "common/vncauth: handle memory allocation failure",
        "before_after_code_files": [
          "common/vncauth.c||common/vncauth.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/LibVNC/libvncserver/pull/416"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "common/vncauth.c||common/vncauth.c": [
          "File: common/vncauth.c -> common/vncauth.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "127:     unsigned char *passwd = (unsigned char *)malloc(9);",
          "128:     int out_len;",
          "131:  free(passwd);",
          "132:  return NULL;",
          "133:     }",
          "",
          "[Removed Lines]",
          "130:     if ((fp = fopen(fname,\"r\")) == NULL) {",
          "",
          "[Added Lines]",
          "130:     if (!passwd || (fp = fopen(fname,\"r\")) == NULL) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}