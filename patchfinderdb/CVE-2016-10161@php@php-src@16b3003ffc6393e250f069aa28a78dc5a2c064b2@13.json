{
  "cve_id": "CVE-2016-10161",
  "cve_desc": "The object_common1 function in ext/standard/var_unserializer.c in PHP before 5.6.30, 7.0.x before 7.0.15, and 7.1.x before 7.1.1 allows remote attackers to cause a denial of service (buffer over-read and application crash) via crafted serialized data that is mishandled in a finish_nested_data call.",
  "repo": "php/php-src",
  "patch_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
  "patch_info": {
    "commit_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/16b3003ffc6393e250f069aa28a78dc5a2c064b2",
    "files": [
      "ext/standard/tests/serialize/bug73825.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #73825 - Heap out of bounds read on unserialize in finish_nested_data()",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt": [
      "File: ext/standard/tests/serialize/bug73825.phpt -> ext/standard/tests/serialize/bug73825.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73825 Heap out of bounds read on unserialize in finish_nested_data()",
      "3: --FILE--",
      "4: <?php",
      "5: $obj = unserialize('O:8:\"00000000\":');",
      "6: var_dump($obj);",
      "7: ?>",
      "8: --EXPECTF--",
      "9: Warning: Bad unserialize data in %sbug73825.php on line %d",
      "11: Notice: unserialize(): Error at offset 13 of 15 bytes in %sbug73825.php on line %d",
      "12: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "405: {",
      "406:  long elements;",
      "408:  elements = parse_iv2((*p) + 2, p);",
      "410:  (*p) += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "408:  if( *p >= max - 2) {",
      "409:   zend_error(E_WARNING, \"Bad unserialize data\");",
      "410:   return -1;",
      "411:  }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "417:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
      "419:  }",
      "421:  return elements;",
      "",
      "[Removed Lines]",
      "418:   return 0;",
      "",
      "[Added Lines]",
      "423:   return -1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "496: {",
      "497:  YYCTYPE yych;",
      "498:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "495: #line 496 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "500: #line 501 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "552:  yych = *(YYMARKER = ++YYCURSOR);",
      "553:  if (yych == ':') goto yy95;",
      "554: yy3:",
      "556:  { return 0; }",
      "558: yy4:",
      "559:  yych = *(YYMARKER = ++YYCURSOR);",
      "560:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "555: #line 861 \"ext/standard/var_unserializer.re\"",
      "557: #line 558 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "560: #line 875 \"ext/standard/var_unserializer.re\"",
      "562: #line 563 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "597:  goto yy3;",
      "598: yy14:",
      "599:  ++YYCURSOR;",
      "601:  {",
      "603:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "605: }",
      "607: yy16:",
      "608:  yych = *++YYCURSOR;",
      "609:  goto yy3;",
      "",
      "[Removed Lines]",
      "600: #line 855 \"ext/standard/var_unserializer.re\"",
      "606: #line 607 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "605: #line 869 \"ext/standard/var_unserializer.re\"",
      "611: #line 612 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "634:  yych = *++YYCURSOR;",
      "635:  if (yych != '\"') goto yy18;",
      "636:  ++YYCURSOR;",
      "638:  {",
      "639:  size_t len, len2, len3, maxlen;",
      "640:  long elements;",
      "",
      "[Removed Lines]",
      "637: #line 708 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "642: #line 717 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "775:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
      "777:  if (incomplete_class) {",
      "778:   php_store_class_name(*rval, class_name, len2);",
      "779:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "782:  if (elements < 0) {",
      "783:     efree(class_name);",
      "784:     return 0;",
      "785:  }",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "782:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "783: }",
      "785: yy25:",
      "786:  yych = *++YYCURSOR;",
      "787:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "784: #line 785 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "794: #line 795 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "806:  yych = *++YYCURSOR;",
      "807:  if (yych != '\"') goto yy18;",
      "808:  ++YYCURSOR;",
      "810:  {",
      "811:     if (!var_hash) return 0;",
      "813:  INIT_PZVAL(*rval);",
      "817: }",
      "819: yy32:",
      "820:  yych = *++YYCURSOR;",
      "821:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "809: #line 699 \"ext/standard/var_unserializer.re\"",
      "815:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "816:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "818: #line 819 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "819: #line 704 \"ext/standard/var_unserializer.re\"",
      "821:  long elements;",
      "826:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
      "827:  if (elements < 0) {",
      "828:   return 0;",
      "829:  }",
      "830:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "832: #line 833 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "836:  yych = *++YYCURSOR;",
      "837:  if (yych != '{') goto yy18;",
      "838:  ++YYCURSOR;",
      "840:  {",
      "841:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "839: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "853: #line 683 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "858:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "859: }",
      "861: yy39:",
      "862:  yych = *++YYCURSOR;",
      "863:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "860: #line 861 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "874: #line 875 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "878:  yych = *++YYCURSOR;",
      "879:  if (yych != '\"') goto yy18;",
      "880:  ++YYCURSOR;",
      "882:  {",
      "883:  size_t len, maxlen;",
      "884:  char *str;",
      "",
      "[Removed Lines]",
      "881: #line 643 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "895: #line 648 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "913:  ZVAL_STRINGL(*rval, str, len, 0);",
      "914:  return 1;",
      "915: }",
      "917: yy46:",
      "918:  yych = *++YYCURSOR;",
      "919:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "916: #line 917 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "930: #line 931 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "934:  yych = *++YYCURSOR;",
      "935:  if (yych != '\"') goto yy18;",
      "936:  ++YYCURSOR;",
      "938:  {",
      "939:  size_t len, maxlen;",
      "940:  char *str;",
      "",
      "[Removed Lines]",
      "937: #line 610 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "951: #line 615 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "967:  ZVAL_STRINGL(*rval, str, len, 1);",
      "968:  return 1;",
      "969: }",
      "971: yy53:",
      "972:  yych = *++YYCURSOR;",
      "973:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "970: #line 971 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "984: #line 985 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1055:  }",
      "1056: yy63:",
      "1057:  ++YYCURSOR;",
      "1059:  {",
      "1060: #if SIZEOF_LONG == 4",
      "1061: use_double:",
      "",
      "[Removed Lines]",
      "1058: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1072: #line 605 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1065:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1066:  return 1;",
      "1067: }",
      "1069: yy65:",
      "1070:  yych = *++YYCURSOR;",
      "1071:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1082: #line 1083 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1124:  yych = *++YYCURSOR;",
      "1125:  if (yych != ';') goto yy18;",
      "1126:  ++YYCURSOR;",
      "1128:  {",
      "1130:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1127: #line 585 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1141: #line 590 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1140:  return 1;",
      "1141: }",
      "1143: yy76:",
      "1144:  yych = *++YYCURSOR;",
      "1145:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1156: #line 1157 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1166:  if (yych <= '9') goto yy79;",
      "1167:  if (yych != ';') goto yy18;",
      "1168:  ++YYCURSOR;",
      "1170:  {",
      "1171: #if SIZEOF_LONG == 4",
      "1172:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1169: #line 558 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1183: #line 563 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1193:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1194:  return 1;",
      "1195: }",
      "1197: yy83:",
      "1198:  yych = *++YYCURSOR;",
      "1199:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1201:  yych = *++YYCURSOR;",
      "1202:  if (yych != ';') goto yy18;",
      "1203:  ++YYCURSOR;",
      "1205:  {",
      "1207:  INIT_PZVAL(*rval);",
      "1208:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1209:  return 1;",
      "1210: }",
      "1212: yy87:",
      "1213:  ++YYCURSOR;",
      "1215:  {",
      "1217:  INIT_PZVAL(*rval);",
      "1218:  ZVAL_NULL(*rval);",
      "1219:  return 1;",
      "1220: }",
      "1222: yy89:",
      "1223:  yych = *++YYCURSOR;",
      "1224:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1204: #line 551 \"ext/standard/var_unserializer.re\"",
      "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
      "1214: #line 544 \"ext/standard/var_unserializer.re\"",
      "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1218: #line 556 \"ext/standard/var_unserializer.re\"",
      "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
      "1228: #line 549 \"ext/standard/var_unserializer.re\"",
      "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1241:  if (yych <= '9') goto yy91;",
      "1242:  if (yych != ';') goto yy18;",
      "1243:  ++YYCURSOR;",
      "1245:  {",
      "1246:  long id;",
      "",
      "[Removed Lines]",
      "1244: #line 521 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1258: #line 526 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1265:  return 1;",
      "1266: }",
      "1268: yy95:",
      "1269:  yych = *++YYCURSOR;",
      "1270:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1281: #line 1282 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1287:  if (yych <= '9') goto yy97;",
      "1288:  if (yych != ';') goto yy18;",
      "1289:  ++YYCURSOR;",
      "1291:  {",
      "1292:  long id;",
      "",
      "[Removed Lines]",
      "1290: #line 500 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1304: #line 505 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "1309:  return 1;",
      "1310: }",
      "1312: }",
      "1316:  return 0;",
      "",
      "[Removed Lines]",
      "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
      "1313: #line 863 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1325: #line 1326 \"ext/standard/var_unserializer.c\"",
      "1327: #line 877 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "409: {",
      "410:  long elements;",
      "412:  elements = parse_iv2((*p) + 2, p);",
      "414:  (*p) += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "412:  if( *p >= max - 2) {",
      "413:   zend_error(E_WARNING, \"Bad unserialize data\");",
      "414:   return -1;",
      "415:  }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
      "423:  }",
      "425:  return elements;",
      "",
      "[Removed Lines]",
      "422:   return 0;",
      "",
      "[Added Lines]",
      "427:   return -1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "697: }",
      "699: \"o:\" iv \":\" [\"] {",
      "700:     if (!var_hash) return 0;",
      "702:  INIT_PZVAL(*rval);",
      "706: }",
      "708: object \":\" uiv \":\" [\"] {",
      "",
      "[Removed Lines]",
      "704:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "705:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "",
      "[Added Lines]",
      "705:  long elements;",
      "710:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
      "711:  if (elements < 0) {",
      "712:   return 0;",
      "713:  }",
      "714:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "845:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
      "847:  if (incomplete_class) {",
      "848:   php_store_class_name(*rval, class_name, len2);",
      "849:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "856:  if (elements < 0) {",
      "857:     efree(class_name);",
      "858:     return 0;",
      "859:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "80a178015d6b162ff0ba7a8e8f5a08c88829cc3c",
      "candidate_info": {
        "commit_hash": "80a178015d6b162ff0ba7a8e8f5a08c88829cc3c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/80a178015d6b162ff0ba7a8e8f5a08c88829cc3c",
        "files": [
          "ext/standard/php_var.h",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed unserialize implementation (it's complicated, this issue took me 4 hours :<, need some review)",
        "before_after_code_files": [
          "ext/standard/php_var.h||ext/standard/php_var.h",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/php_var.h||ext/standard/php_var.h": [
          "File: ext/standard/php_var.h -> ext/standard/php_var.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "113:  } \\",
          "114: } while (0)",
          "117: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hash, zval *val);",
          "118: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval);",
          "119: PHPAPI void var_destroy(php_unserialize_data_t *var_hash);",
          "124: PHPAPI zend_class_entry *php_create_empty_class(char *class_name, int len);",
          "",
          "[Removed Lines]",
          "116: PHPAPI void var_replace(php_unserialize_data_t *var_hash, zval *ozval, zval *nzval);",
          "121: #define PHP_VAR_UNSERIALIZE_ZVAL_CHANGED(var_hash, ozval, nzval) \\",
          "122:  var_replace((var_hash), (ozval), &(nzval))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #define VAR_ENTRIES_DBG 0",
          "31: typedef struct {",
          "33:  long used_slots;",
          "34:  void *next;",
          "35: } var_entries;",
          "",
          "[Removed Lines]",
          "32:  zval *data[VAR_ENTRIES_MAX];",
          "",
          "[Added Lines]",
          "32:  zval data[VAR_ENTRIES_MAX];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "55:   (*var_hashx)->last = var_hash;",
          "56:  }",
          "59: }",
          "61: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "58:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "58:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "59:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "79:   (*var_hashx)->last_dtor = var_hash;",
          "80:  }",
          "84: }",
          "86: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "82:  Z_ADDREF_P(rval);",
          "83:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "83:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "84:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "104:   (*var_hashx)->last_dtor = var_hash;",
          "105:  }",
          "127: }",
          "129: static int var_access(php_unserialize_data_t *var_hashx, long id, zval **store)",
          "",
          "[Removed Lines]",
          "107:  var_hash->data[var_hash->used_slots++] = rval;",
          "108: }",
          "110: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "111: {",
          "112:  long i;",
          "113:  var_entries *var_hash = (*var_hashx)->first;",
          "114: #if VAR_ENTRIES_DBG",
          "115:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "116: #endif",
          "118:  while (var_hash) {",
          "119:   for (i = 0; i < var_hash->used_slots; i++) {",
          "120:    if (var_hash->data[i] == ozval) {",
          "121:     var_hash->data[i] = nzval;",
          "123:    }",
          "124:   }",
          "125:   var_hash = var_hash->next;",
          "126:  }",
          "",
          "[Added Lines]",
          "108:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "109:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "167:  while (var_hash) {",
          "168:   for (i = 0; i < var_hash->used_slots; i++) {",
          "170:   }",
          "171:   next = var_hash->next;",
          "172:   efree(var_hash);",
          "",
          "[Removed Lines]",
          "169:    zval_ptr_dtor(var_hash->data[i]);",
          "",
          "[Added Lines]",
          "152:    zval_ptr_dtor(&var_hash->data[i]);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "226: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "229: #line 234 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "212: #line 217 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "299:    return 0;",
          "300:   }",
          "302:   if (Z_TYPE(key) != IS_LONG && Z_TYPE(key) != IS_STRING) {",
          "303:    zval_dtor(&key);",
          "304:    return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "285:   if (var_hash && !Z_ISREF(key)) {",
          "286:    var_push(var_hash, &key);",
          "287:   }",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "310:    return 0;",
          "311:   }",
          "313:   if (!objprops) {",
          "314:    switch (Z_TYPE(key)) {",
          "315:    case IS_LONG:",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "301:   if (var_hash && !Z_ISREF(data)) {",
          "302:    var_push(var_hash, &data);",
          "303:   }",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "436:   return 0;",
          "437:  }",
          "443:  start = cursor;",
          "449: {",
          "450:  YYCTYPE yych;",
          "451:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "439:  if (var_hash && cursor[0] != 'R') {",
          "440:   var_push(var_hash, rval);",
          "441:  }",
          "448: #line 449 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "436: #line 437 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "505:  yych = *(YYMARKER = ++YYCURSOR);",
          "506:  if (yych == ':') goto yy95;",
          "507: yy3:",
          "509:  { return 0; }",
          "511: yy4:",
          "512:  yych = *(YYMARKER = ++YYCURSOR);",
          "513:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "508: #line 786 \"ext/standard/var_unserializer.re\"",
          "510: #line 511 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "496: #line 774 \"ext/standard/var_unserializer.re\"",
          "498: #line 499 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "550:  goto yy3;",
          "551: yy14:",
          "552:  ++YYCURSOR;",
          "554:  {",
          "556:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "558: }",
          "560: yy16:",
          "561:  yych = *++YYCURSOR;",
          "562:  goto yy3;",
          "",
          "[Removed Lines]",
          "553: #line 780 \"ext/standard/var_unserializer.re\"",
          "559: #line 560 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "541: #line 768 \"ext/standard/var_unserializer.re\"",
          "547: #line 548 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "586:  yych = *++YYCURSOR;",
          "587:  if (yych != '\"') goto yy18;",
          "588:  ++YYCURSOR;",
          "590:  {",
          "591:  size_t len, len2, len3, maxlen;",
          "592:  long elements;",
          "",
          "[Removed Lines]",
          "589: #line 641 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "577: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "726:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "727: }",
          "729: yy25:",
          "730:  yych = *++YYCURSOR;",
          "731:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "728: #line 729 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "716: #line 717 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "750:  yych = *++YYCURSOR;",
          "751:  if (yych != '\"') goto yy18;",
          "752:  ++YYCURSOR;",
          "754:  {",
          "",
          "[Removed Lines]",
          "753: #line 633 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "741: #line 621 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "758:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "759:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "760: }",
          "762: yy32:",
          "763:  yych = *++YYCURSOR;",
          "764:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "761: #line 762 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "749: #line 750 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "779:  yych = *++YYCURSOR;",
          "780:  if (yych != '{') goto yy18;",
          "781:  ++YYCURSOR;",
          "783:  {",
          "784:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "782: #line 615 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "770: #line 603 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "798:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "799: }",
          "801: yy39:",
          "802:  yych = *++YYCURSOR;",
          "803:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "800: #line 801 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "788: #line 789 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "818:  yych = *++YYCURSOR;",
          "819:  if (yych != '\"') goto yy18;",
          "820:  ++YYCURSOR;",
          "822:  {",
          "823:  size_t len, maxlen;",
          "824:  char *str;",
          "",
          "[Removed Lines]",
          "821: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "809: #line 574 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "847:  ZVAL_STRINGL(rval, str, len);",
          "848:  return 1;",
          "849: }",
          "851: yy46:",
          "852:  yych = *++YYCURSOR;",
          "853:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "850: #line 851 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "838: #line 839 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "868:  yych = *++YYCURSOR;",
          "869:  if (yych != '\"') goto yy18;",
          "870:  ++YYCURSOR;",
          "872:  {",
          "873:  size_t len, maxlen;",
          "874:  char *str;",
          "",
          "[Removed Lines]",
          "871: #line 559 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "859: #line 547 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "895:  ZVAL_STRINGL(rval, str, len);",
          "896:  return 1;",
          "897: }",
          "899: yy53:",
          "900:  yych = *++YYCURSOR;",
          "901:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "898: #line 899 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "886: #line 887 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "983:  }",
          "984: yy63:",
          "985:  ++YYCURSOR;",
          "987:  {",
          "988: #if SIZEOF_LONG == 4",
          "989: use_double:",
          "",
          "[Removed Lines]",
          "986: #line 550 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "974: #line 538 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "992:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "993:  return 1;",
          "994: }",
          "996: yy65:",
          "997:  yych = *++YYCURSOR;",
          "998:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "995: #line 996 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "983: #line 984 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1051:  yych = *++YYCURSOR;",
          "1052:  if (yych != ';') goto yy18;",
          "1053:  ++YYCURSOR;",
          "1055:  {",
          "",
          "[Removed Lines]",
          "1054: #line 534 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1042: #line 522 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1068:  return 1;",
          "1069: }",
          "1071: yy76:",
          "1072:  yych = *++YYCURSOR;",
          "1073:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1070: #line 1071 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1058: #line 1059 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1094:  if (yych <= '9') goto yy79;",
          "1095:  if (yych != ';') goto yy18;",
          "1096:  ++YYCURSOR;",
          "1098:  {",
          "1099: #if SIZEOF_LONG == 4",
          "1100:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1097: #line 508 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1085: #line 496 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1120:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1121:  return 1;",
          "1122: }",
          "1124: yy83:",
          "1125:  yych = *++YYCURSOR;",
          "1126:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1123: #line 1124 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1111: #line 1112 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1128:  yych = *++YYCURSOR;",
          "1129:  if (yych != ';') goto yy18;",
          "1130:  ++YYCURSOR;",
          "1132:  {",
          "1134:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1135:  return 1;",
          "1136: }",
          "1138: yy87:",
          "1139:  ++YYCURSOR;",
          "1141:  {",
          "1143:  ZVAL_NULL(rval);",
          "1144:  return 1;",
          "1145: }",
          "1147: yy89:",
          "1148:  yych = *++YYCURSOR;",
          "1149:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1131: #line 502 \"ext/standard/var_unserializer.re\"",
          "1137: #line 1138 \"ext/standard/var_unserializer.c\"",
          "1140: #line 496 \"ext/standard/var_unserializer.re\"",
          "1146: #line 1147 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1119: #line 490 \"ext/standard/var_unserializer.re\"",
          "1125: #line 1126 \"ext/standard/var_unserializer.c\"",
          "1128: #line 484 \"ext/standard/var_unserializer.re\"",
          "1134: #line 1135 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1166:  if (yych <= '9') goto yy91;",
          "1167:  if (yych != ';') goto yy18;",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1171:  long id;",
          "",
          "[Removed Lines]",
          "1169: #line 473 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1157: #line 461 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "1190:  return 1;",
          "1191: }",
          "1193: yy95:",
          "1194:  yych = *++YYCURSOR;",
          "1195:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1192: #line 1193 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1180: #line 1181 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "1212:  if (yych <= '9') goto yy97;",
          "1213:  if (yych != ';') goto yy18;",
          "1214:  ++YYCURSOR;",
          "1216:  {",
          "1217:  long id;",
          "",
          "[Removed Lines]",
          "1215: #line 453 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1203: #line 441 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "1233:  return 1;",
          "1234: }",
          "1236: }",
          "1240:  return 0;",
          "",
          "[Removed Lines]",
          "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
          "1237: #line 788 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1223: #line 1224 \"ext/standard/var_unserializer.c\"",
          "1225: #line 776 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "27: #define VAR_ENTRIES_DBG 0",
          "29: typedef struct {",
          "31:  long used_slots;",
          "32:  void *next;",
          "33: } var_entries;",
          "",
          "[Removed Lines]",
          "30:  zval *data[VAR_ENTRIES_MAX];",
          "",
          "[Added Lines]",
          "30:  zval data[VAR_ENTRIES_MAX];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "53:   (*var_hashx)->last = var_hash;",
          "54:  }",
          "57: }",
          "59: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "56:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "56:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "57:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "77:   (*var_hashx)->last_dtor = var_hash;",
          "78:  }",
          "82: }",
          "84: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "",
          "[Removed Lines]",
          "80:  Z_ADDREF_P(rval);",
          "81:  var_hash->data[var_hash->used_slots++] = rval;",
          "",
          "[Added Lines]",
          "81:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "82:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "102:   (*var_hashx)->last_dtor = var_hash;",
          "103:  }",
          "125: }",
          "127: static int var_access(php_unserialize_data_t *var_hashx, long id, zval **store)",
          "",
          "[Removed Lines]",
          "105:  var_hash->data[var_hash->used_slots++] = rval;",
          "106: }",
          "108: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "109: {",
          "110:  long i;",
          "111:  var_entries *var_hash = (*var_hashx)->first;",
          "112: #if VAR_ENTRIES_DBG",
          "113:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "114: #endif",
          "116:  while (var_hash) {",
          "117:   for (i = 0; i < var_hash->used_slots; i++) {",
          "118:    if (var_hash->data[i] == ozval) {",
          "119:     var_hash->data[i] = nzval;",
          "121:    }",
          "122:   }",
          "123:   var_hash = var_hash->next;",
          "124:  }",
          "",
          "[Added Lines]",
          "106:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "107:  var_hash->used_slots++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "165:  while (var_hash) {",
          "166:   for (i = 0; i < var_hash->used_slots; i++) {",
          "168:   }",
          "169:   next = var_hash->next;",
          "170:   efree(var_hash);",
          "",
          "[Removed Lines]",
          "167:    zval_ptr_dtor(var_hash->data[i]);",
          "",
          "[Added Lines]",
          "150:    zval_ptr_dtor(&var_hash->data[i]);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "303:    return 0;",
          "304:   }",
          "306:   if (Z_TYPE(key) != IS_LONG && Z_TYPE(key) != IS_STRING) {",
          "307:    zval_dtor(&key);",
          "308:    return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "289:   if (var_hash && !Z_ISREF(key)) {",
          "290:    var_push(var_hash, &key);",
          "291:   }",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "314:    return 0;",
          "315:   }",
          "317:   if (!objprops) {",
          "318:    switch (Z_TYPE(key)) {",
          "319:    case IS_LONG:",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "305:   if (var_hash && !Z_ISREF(data)) {",
          "306:    var_push(var_hash, &data);",
          "307:   }",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "440:   return 0;",
          "441:  }",
          "447:  start = cursor;",
          "",
          "[Removed Lines]",
          "443:  if (var_hash && cursor[0] != 'R') {",
          "444:   var_push(var_hash, rval);",
          "445:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c85907682a14a6fa174cb4619c4afc8984260202",
      "candidate_info": {
        "commit_hash": "c85907682a14a6fa174cb4619c4afc8984260202",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/c85907682a14a6fa174cb4619c4afc8984260202",
        "files": [
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Improved fix for #71940",
        "before_after_code_files": [
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1040:  if (!php_var_unserialize_ex(return_value, &p, p + buf_len, &var_hash, class_hash)) {",
          "1041:   PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1043:    zend_hash_destroy(class_hash);",
          "1044:    FREE_HASHTABLE(class_hash);",
          "1045:   }",
          "",
          "[Removed Lines]",
          "1042:   if(class_hash) {",
          "",
          "[Added Lines]",
          "1042:   if (class_hash) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1050:   }",
          "1051:   RETURN_FALSE;",
          "1052:  }",
          "1053:  PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1055:   zend_hash_destroy(class_hash);",
          "1056:   FREE_HASHTABLE(class_hash);",
          "1057:  }",
          "",
          "[Removed Lines]",
          "1054:  if(class_hash) {",
          "",
          "[Added Lines]",
          "1055:  var_push_dtor(&var_hash, return_value);",
          "1058:  if (class_hash) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "574:  yych = *(YYMARKER = ++YYCURSOR);",
          "575:  if (yych == ':') goto yy95;",
          "576: yy3:",
          "578:  { return 0; }",
          "579: #line 580 \"ext/standard/var_unserializer.c\"",
          "580: yy4:",
          "",
          "[Removed Lines]",
          "577: #line 886 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "577: #line 884 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "619:  goto yy3;",
          "620: yy14:",
          "621:  ++YYCURSOR;",
          "623:  {",
          "625:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "",
          "[Removed Lines]",
          "622: #line 880 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "622: #line 878 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "655:  yych = *++YYCURSOR;",
          "656:  if (yych != '\"') goto yy18;",
          "657:  ++YYCURSOR;",
          "659:  {",
          "660:  size_t len, len2, len3, maxlen;",
          "661:  zend_long elements;",
          "",
          "[Removed Lines]",
          "658: #line 735 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "658: #line 733 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "825:  yych = *++YYCURSOR;",
          "826:  if (yych != '\"') goto yy18;",
          "827:  ++YYCURSOR;",
          "829:  {",
          "830:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "828: #line 728 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "828: #line 726 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "871:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "872:  }",
          "876:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "877:   return 0;",
          "878:  }",
          "880:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "881: }",
          "883: yy39:",
          "884:  yych = *++YYCURSOR;",
          "885:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "875:  var_push_dtor(var_hash, rval);",
          "882: #line 883 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "880: #line 881 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "934:  ZVAL_STR(rval, str);",
          "935:  return 1;",
          "936: }",
          "938: yy46:",
          "939:  yych = *++YYCURSOR;",
          "940:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "937: #line 938 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "935: #line 936 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "987:  ZVAL_STRINGL(rval, str, len);",
          "988:  return 1;",
          "989: }",
          "991: yy53:",
          "992:  yych = *++YYCURSOR;",
          "993:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "990: #line 991 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "988: #line 989 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1084:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1085:  return 1;",
          "1086: }",
          "1088: yy65:",
          "1089:  yych = *++YYCURSOR;",
          "1090:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1087: #line 1088 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1085: #line 1086 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1160:  return 1;",
          "1161: }",
          "1163: yy76:",
          "1164:  yych = *++YYCURSOR;",
          "1165:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1162: #line 1163 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1160: #line 1161 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1212:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1213:  return 1;",
          "1214: }",
          "1216: yy83:",
          "1217:  yych = *++YYCURSOR;",
          "1218:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1215: #line 1216 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1213: #line 1214 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1226:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1227:  return 1;",
          "1228: }",
          "1230: yy87:",
          "1231:  ++YYCURSOR;",
          "1232: #line 573 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1229: #line 1230 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1227: #line 1228 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1235:  ZVAL_NULL(rval);",
          "1236:  return 1;",
          "1237: }",
          "1239: yy89:",
          "1240:  yych = *++YYCURSOR;",
          "1241:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1238: #line 1239 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1236: #line 1237 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1284:  return 1;",
          "1285: }",
          "1287: yy95:",
          "1288:  yych = *++YYCURSOR;",
          "1289:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1286: #line 1287 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1333:  return 1;",
          "1334: }",
          "1336: }",
          "1340:  return 0;",
          "",
          "[Removed Lines]",
          "1335: #line 1336 \"ext/standard/var_unserializer.c\"",
          "1337: #line 888 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1333: #line 1334 \"ext/standard/var_unserializer.c\"",
          "1335: #line 886 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "716:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "717:  }",
          "721:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "722:   return 0;",
          "723:  }",
          "",
          "[Removed Lines]",
          "720:  var_push_dtor(var_hash, rval);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2075fb2b73c2d56c7acfb29773a2dc68b8d2f29d",
      "candidate_info": {
        "commit_hash": "2075fb2b73c2d56c7acfb29773a2dc68b8d2f29d",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/2075fb2b73c2d56c7acfb29773a2dc68b8d2f29d",
        "files": [
          "ext/exif/exif.c",
          "ext/exif/tests/bug73737.phpt",
          "ext/exif/tests/bug73737.tiff",
          "ext/phar/phar.c",
          "ext/phar/tests/bug73764.phar",
          "ext/phar/tests/bug73764.phpt",
          "ext/phar/tests/bug73768.phar",
          "ext/phar/tests/bug73768.phpt",
          "ext/standard/tests/serialize/bug73825.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-7.0' into PHP-7.1\n\n* PHP-7.0:\n  Fix bug #73737 FPE when parsing a tag format\n  Fix bug #73773 - Seg fault when loading hostile phar\n  Fix bug #73825 - Heap out of bounds read on unserialize in finish_nested_data()\n  Fix bug #73768 - Memory corruption when loading hostile phar\n  Fix int overflows in phar (bug #73764)",
        "before_after_code_files": [
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/exif/tests/bug73737.phpt||ext/exif/tests/bug73737.phpt",
          "ext/phar/phar.c||ext/phar/phar.c",
          "ext/phar/tests/bug73764.phpt||ext/phar/tests/bug73764.phpt",
          "ext/phar/tests/bug73768.phpt||ext/phar/tests/bug73768.phpt",
          "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1297:    if (s_den == 0) {",
          "1298:     return 0;",
          "1299:    } else {",
          "1301:    }",
          "1303:   case TAG_FMT_SSHORT:    return php_ifd_get16u(value, motorola_intel);",
          "",
          "[Removed Lines]",
          "1300:     return php_ifd_get32s(value, motorola_intel) / s_den;",
          "",
          "[Added Lines]",
          "1300:     return (size_t)((double)php_ifd_get32s(value, motorola_intel) / s_den);",
          "",
          "---------------"
        ],
        "ext/exif/tests/bug73737.phpt||ext/exif/tests/bug73737.phpt": [
          "File: ext/exif/tests/bug73737.phpt -> ext/exif/tests/bug73737.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73737 (Crash when parsing a tag format)",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded('exif')) print 'skip exif extension not available';?>",
          "5: --FILE--",
          "6: <?php",
          "7:  $exif = exif_thumbnail(__DIR__ . '/bug73737.tiff');",
          "8:  var_dump($exif);",
          "9: ?>",
          "10: --EXPECTF--",
          "11: Warning: exif_thumbnail(bug73737.tiff): Error in TIFF: filesize(x0030) less than start of IFD dir(x10102) in %s line %d",
          "12: bool(false)",
          "",
          "---------------"
        ],
        "ext/phar/phar.c||ext/phar/phar.c": [
          "File: ext/phar/phar.c -> ext/phar/phar.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "984:   if (alias && alias_len && (alias_len != (int)tmp_len || strncmp(alias, buffer, tmp_len)))",
          "985:   {",
          "987:    php_stream_close(fp);",
          "989:    if (signature) {",
          "",
          "[Removed Lines]",
          "986:    buffer[tmp_len] = '\\0';",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "991:    }",
          "993:    if (error) {",
          "995:    }",
          "997:    efree(savebuf);",
          "",
          "[Removed Lines]",
          "994:     spprintf(error, 0, \"cannot load phar \\\"%s\\\" with implicit alias \\\"%s\\\" under different alias \\\"%s\\\"\", fname, buffer, alias);",
          "",
          "[Added Lines]",
          "993:     spprintf(error, 0, \"cannot load phar \\\"%s\\\" with implicit alias \\\"%.*s\\\" under different alias \\\"%s\\\"\", fname, tmp_len, buffer, alias);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1057:  entry.is_persistent = mydata->is_persistent;",
          "1059:  for (manifest_index = 0; manifest_index < manifest_count; ++manifest_index) {",
          "1061:    MAPPHAR_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated manifest entry)\")",
          "1062:   }",
          "",
          "[Removed Lines]",
          "1060:   if (buffer + 4 > endbuffer) {",
          "",
          "[Added Lines]",
          "1059:   if (buffer + 28 > endbuffer) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1071:    entry.manifest_pos = manifest_index;",
          "1072:   }",
          "1075:    MAPPHAR_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated manifest entry)\");",
          "1076:   }",
          "",
          "[Removed Lines]",
          "1074:   if (entry.filename_len + 20 > (size_t)(endbuffer - buffer)) {",
          "",
          "[Added Lines]",
          "1073:   if (entry.filename_len > (size_t)(endbuffer - buffer - 24)) {",
          "",
          "---------------"
        ],
        "ext/phar/tests/bug73764.phpt||ext/phar/tests/bug73764.phpt": [
          "File: ext/phar/tests/bug73764.phpt -> ext/phar/tests/bug73764.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Phar: PHP bug #73764: Crash while loading hostile phar archive",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded(\"phar\")) die(\"skip\"); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: chdir(__DIR__);",
          "8: try {",
          "9: $p = Phar::LoadPhar('bug73764.phar', 'alias.phar');",
          "10: echo \"OK\\n\";",
          "11: } catch(PharException $e) {",
          "12:  echo $e->getMessage();",
          "13: }",
          "14: ?>",
          "15: --EXPECTF--",
          "16: internal corruption of phar \"%sbug73764.phar\" (truncated manifest entry)",
          "",
          "---------------"
        ],
        "ext/phar/tests/bug73768.phpt||ext/phar/tests/bug73768.phpt": [
          "File: ext/phar/tests/bug73768.phpt -> ext/phar/tests/bug73768.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Phar: PHP bug #73768: Memory corruption when loading hostile phar",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded(\"phar\")) die(\"skip\"); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: chdir(__DIR__);",
          "8: try {",
          "9: $p = Phar::LoadPhar('bug73768.phar', 'alias.phar');",
          "10: echo \"OK\\n\";",
          "11: } catch(PharException $e) {",
          "12:  echo $e->getMessage();",
          "13: }",
          "14: ?>",
          "15: --EXPECTF--",
          "16: cannot load phar \"%sbug73768.phar\" with implicit alias \"\" under different alias \"alias.phar\"",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt": [
          "File: ext/standard/tests/serialize/bug73825.phpt -> ext/standard/tests/serialize/bug73825.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73825 Heap out of bounds read on unserialize in finish_nested_data()",
          "3: --FILE--",
          "4: <?php",
          "5: $obj = unserialize('O:8:\"00000000\":');",
          "6: var_dump($obj);",
          "7: ?>",
          "8: --EXPECTF--",
          "9: Warning: Bad unserialize data in %sbug73825.php on line %d",
          "11: Notice: unserialize(): Error at offset 13 of 15 bytes in %sbug73825.php on line %d",
          "12: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "478: {",
          "479:  zend_long elements;",
          "481:  elements = parse_iv2((*p) + 2, p);",
          "483:  (*p) += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "481:  if( *p >= max - 2) {",
          "482:   zend_error(E_WARNING, \"Bad unserialize data\");",
          "483:   return -1;",
          "484:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "487:  } else {",
          "492:  }",
          "494:  return elements;",
          "",
          "[Removed Lines]",
          "490:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ZSTR_VAL(ce->name));",
          "491:   return 0;",
          "",
          "[Added Lines]",
          "495:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
          "496:   return -1;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "589:  start = cursor;",
          "593: {",
          "594:  YYCTYPE yych;",
          "595:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "592: #line 593 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "597: #line 598 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "626:     0,   0,   0,   0,   0,   0,   0,   0,",
          "627:     0,   0,   0,   0,   0,   0,   0,   0,",
          "628:  };",
          "629:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "630:  yych = *YYCURSOR;",
          "631:  switch (yych) {",
          "632:  case 'C':",
          "634:  case 'N': goto yy5;",
          "641:  case 'o': goto yy12;",
          "646:  }",
          "647: yy2:",
          "649: yy3:",
          "651:  { return 0; }",
          "653: yy4:",
          "654:  yych = *(YYMARKER = ++YYCURSOR);",
          "656:  goto yy3;",
          "657: yy5:",
          "658:  yych = *++YYCURSOR;",
          "660:  goto yy3;",
          "661: yy6:",
          "662:  yych = *(YYMARKER = ++YYCURSOR);",
          "664:  goto yy3;",
          "665: yy7:",
          "666:  yych = *(YYMARKER = ++YYCURSOR);",
          "668:  goto yy3;",
          "669: yy8:",
          "670:  yych = *(YYMARKER = ++YYCURSOR);",
          "672:  goto yy3;",
          "673: yy9:",
          "674:  yych = *(YYMARKER = ++YYCURSOR);",
          "676:  goto yy3;",
          "677: yy10:",
          "678:  yych = *(YYMARKER = ++YYCURSOR);",
          "680:  goto yy3;",
          "681: yy11:",
          "682:  yych = *(YYMARKER = ++YYCURSOR);",
          "684:  goto yy3;",
          "685: yy12:",
          "686:  yych = *(YYMARKER = ++YYCURSOR);",
          "688:  goto yy3;",
          "689: yy13:",
          "690:  yych = *(YYMARKER = ++YYCURSOR);",
          "692:  goto yy3;",
          "693: yy14:",
          "698:  ++YYCURSOR;",
          "700:  {",
          "702:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "704: }",
          "706: yy17:",
          "707:  yych = *++YYCURSOR;",
          "708:  if (yybm[0+yych] & 128) {",
          "710:  }",
          "712: yy18:",
          "713:  YYCURSOR = YYMARKER;",
          "714:  goto yy3;",
          "715: yy19:",
          "725:  yych = *++YYCURSOR;",
          "734:  }",
          "740:  goto yy18;",
          "749:  if (yych <= '/') goto yy18;",
          "753:  yych = *++YYCURSOR;",
          "762:   }",
          "771:   }",
          "772:  }",
          "783:  }",
          "794:  }",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych <= ',') {",
          "800:  } else {",
          "802:   if (yych <= '/') goto yy18;",
          "804:   goto yy18;",
          "805:  }",
          "807:  yych = *++YYCURSOR;",
          "809:  if (yych <= '/') goto yy18;",
          "819:  ++YYCURSOR;",
          "820:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "821:  yych = *YYCURSOR;",
          "825:  if (yych <= '/') goto yy18;",
          "829:  yych = *++YYCURSOR;",
          "833:  ++YYCURSOR;",
          "836:  if (yych <= '/') goto yy18;",
          "837:  if (yych <= '9') goto yy34;",
          "839:  goto yy18;",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yych <= '/') goto yy18;",
          "843:  if (yych >= ':') goto yy18;",
          "845:  ++YYCURSOR;",
          "846:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "847:  yych = *YYCURSOR;",
          "848:  if (yych <= '/') goto yy18;",
          "853:  yych = *++YYCURSOR;",
          "857:  ++YYCURSOR;",
          "882:  }",
          "910:  }",
          "920:  yych = *++YYCURSOR;",
          "921:  if (yych <= '/') goto yy18;",
          "930:  goto yy18;",
          "932:  yych = *++YYCURSOR;",
          "933:  if (yych <= '/') goto yy18;",
          "934:  if (yych >= ':') goto yy18;",
          "936:  ++YYCURSOR;",
          "937:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "938:  yych = *YYCURSOR;",
          "939:  if (yych <= '/') goto yy18;",
          "944:  yych = *++YYCURSOR;",
          "948:  ++YYCURSOR;",
          "951:  if (yych <= '/') goto yy18;",
          "954:  goto yy18;",
          "956:  yych = *++YYCURSOR;",
          "957:  if (yych <= '/') goto yy18;",
          "958:  if (yych >= ':') goto yy18;",
          "960:  ++YYCURSOR;",
          "961:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "962:  yych = *YYCURSOR;",
          "963:  if (yych <= '/') goto yy18;",
          "968:  yych = *++YYCURSOR;",
          "972:  ++YYCURSOR;",
          "974:  {",
          "982:   return 0;",
          "983:  }",
          "989:  }",
          "995:  }",
          "997:  return 1;",
          "998: }",
          "1001:  yych = *++YYCURSOR;",
          "1003:  goto yy18;",
          "1005:  yych = *++YYCURSOR;",
          "1007:  goto yy18;",
          "1009:  ++YYCURSOR;",
          "1018:  ++YYCURSOR;",
          "1019:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1020:  yych = *YYCURSOR;",
          "1021:  if (yych <= ';') {",
          "1022:   if (yych <= '/') goto yy18;",
          "1024:   if (yych <= ':') goto yy18;",
          "1025:  } else {",
          "1026:   if (yych <= 'E') {",
          "1027:    if (yych <= 'D') goto yy18;",
          "1029:   } else {",
          "1031:    goto yy18;",
          "1032:   }",
          "1033:  }",
          "1035:  ++YYCURSOR;",
          "1037:  {",
          "1038: #if SIZEOF_ZEND_LONG == 4",
          "1039: use_double:",
          "",
          "[Removed Lines]",
          "633:  case 'O': goto yy4;",
          "635:  case 'R': goto yy6;",
          "636:  case 'S': goto yy7;",
          "637:  case 'a': goto yy8;",
          "638:  case 'b': goto yy9;",
          "639:  case 'd': goto yy10;",
          "640:  case 'i': goto yy11;",
          "642:  case 'r': goto yy13;",
          "643:  case 's': goto yy14;",
          "644:  case '}': goto yy15;",
          "645:  default: goto yy2;",
          "648:  ++YYCURSOR;",
          "650: #line 961 \"ext/standard/var_unserializer.re\"",
          "652: #line 653 \"ext/standard/var_unserializer.c\"",
          "655:  if (yych == ':') goto yy17;",
          "659:  if (yych == ';') goto yy19;",
          "663:  if (yych == ':') goto yy21;",
          "667:  if (yych == ':') goto yy22;",
          "671:  if (yych == ':') goto yy23;",
          "675:  if (yych == ':') goto yy24;",
          "679:  if (yych == ':') goto yy25;",
          "683:  if (yych == ':') goto yy26;",
          "687:  if (yych == ':') goto yy27;",
          "691:  if (yych == ':') goto yy28;",
          "694:  yych = *(YYMARKER = ++YYCURSOR);",
          "695:  if (yych == ':') goto yy29;",
          "696:  goto yy3;",
          "697: yy15:",
          "699: #line 955 \"ext/standard/var_unserializer.re\"",
          "705: #line 706 \"ext/standard/var_unserializer.c\"",
          "709:   goto yy31;",
          "711:  if (yych == '+') goto yy30;",
          "716:  ++YYCURSOR;",
          "717: #line 648 \"ext/standard/var_unserializer.re\"",
          "718:  {",
          "720:  ZVAL_NULL(rval);",
          "721:  return 1;",
          "722: }",
          "723: #line 724 \"ext/standard/var_unserializer.c\"",
          "724: yy21:",
          "726:  if (yych <= ',') {",
          "727:   if (yych == '+') goto yy33;",
          "728:   goto yy18;",
          "729:  } else {",
          "730:   if (yych <= '-') goto yy33;",
          "731:   if (yych <= '/') goto yy18;",
          "732:   if (yych <= '9') goto yy34;",
          "733:   goto yy18;",
          "735: yy22:",
          "736:  yych = *++YYCURSOR;",
          "737:  if (yych == '+') goto yy36;",
          "738:  if (yych <= '/') goto yy18;",
          "739:  if (yych <= '9') goto yy37;",
          "741: yy23:",
          "742:  yych = *++YYCURSOR;",
          "743:  if (yych == '+') goto yy39;",
          "744:  if (yych <= '/') goto yy18;",
          "745:  if (yych <= '9') goto yy40;",
          "746:  goto yy18;",
          "747: yy24:",
          "748:  yych = *++YYCURSOR;",
          "750:  if (yych <= '1') goto yy42;",
          "751:  goto yy18;",
          "752: yy25:",
          "754:  if (yych <= '/') {",
          "755:   if (yych <= ',') {",
          "756:    if (yych == '+') goto yy43;",
          "757:    goto yy18;",
          "758:   } else {",
          "759:    if (yych <= '-') goto yy44;",
          "760:    if (yych <= '.') goto yy45;",
          "761:    goto yy18;",
          "763:  } else {",
          "764:   if (yych <= 'I') {",
          "765:    if (yych <= '9') goto yy46;",
          "766:    if (yych <= 'H') goto yy18;",
          "767:    goto yy48;",
          "768:   } else {",
          "769:    if (yych == 'N') goto yy49;",
          "770:    goto yy18;",
          "773: yy26:",
          "774:  yych = *++YYCURSOR;",
          "775:  if (yych <= ',') {",
          "776:   if (yych == '+') goto yy50;",
          "777:   goto yy18;",
          "778:  } else {",
          "779:   if (yych <= '-') goto yy50;",
          "780:   if (yych <= '/') goto yy18;",
          "781:   if (yych <= '9') goto yy51;",
          "782:   goto yy18;",
          "784: yy27:",
          "785:  yych = *++YYCURSOR;",
          "786:  if (yych <= ',') {",
          "787:   if (yych == '+') goto yy53;",
          "788:   goto yy18;",
          "789:  } else {",
          "790:   if (yych <= '-') goto yy53;",
          "791:   if (yych <= '/') goto yy18;",
          "792:   if (yych <= '9') goto yy54;",
          "793:   goto yy18;",
          "795: yy28:",
          "798:   if (yych == '+') goto yy56;",
          "799:   goto yy18;",
          "801:   if (yych <= '-') goto yy56;",
          "803:   if (yych <= '9') goto yy57;",
          "806: yy29:",
          "808:  if (yych == '+') goto yy59;",
          "810:  if (yych <= '9') goto yy60;",
          "811:  goto yy18;",
          "812: yy30:",
          "813:  yych = *++YYCURSOR;",
          "814:  if (yybm[0+yych] & 128) {",
          "815:   goto yy31;",
          "816:  }",
          "817:  goto yy18;",
          "818: yy31:",
          "822:  if (yybm[0+yych] & 128) {",
          "823:   goto yy31;",
          "824:  }",
          "826:  if (yych <= ':') goto yy62;",
          "827:  goto yy18;",
          "828: yy33:",
          "830:  if (yych <= '/') goto yy18;",
          "831:  if (yych >= ':') goto yy18;",
          "832: yy34:",
          "834:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "835:  yych = *YYCURSOR;",
          "838:  if (yych == ';') goto yy63;",
          "840: yy36:",
          "844: yy37:",
          "849:  if (yych <= '9') goto yy37;",
          "850:  if (yych <= ':') goto yy65;",
          "851:  goto yy18;",
          "852: yy39:",
          "854:  if (yych <= '/') goto yy18;",
          "855:  if (yych >= ':') goto yy18;",
          "856: yy40:",
          "858:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "859:  yych = *YYCURSOR;",
          "860:  if (yych <= '/') goto yy18;",
          "861:  if (yych <= '9') goto yy40;",
          "862:  if (yych <= ':') goto yy66;",
          "863:  goto yy18;",
          "864: yy42:",
          "865:  yych = *++YYCURSOR;",
          "866:  if (yych == ';') goto yy67;",
          "867:  goto yy18;",
          "868: yy43:",
          "869:  yych = *++YYCURSOR;",
          "870:  if (yych == '.') goto yy45;",
          "871:  if (yych <= '/') goto yy18;",
          "872:  if (yych <= '9') goto yy46;",
          "873:  goto yy18;",
          "874: yy44:",
          "875:  yych = *++YYCURSOR;",
          "876:  if (yych <= '/') {",
          "877:   if (yych != '.') goto yy18;",
          "878:  } else {",
          "879:   if (yych <= '9') goto yy46;",
          "880:   if (yych == 'I') goto yy48;",
          "881:   goto yy18;",
          "883: yy45:",
          "884:  yych = *++YYCURSOR;",
          "885:  if (yych <= '/') goto yy18;",
          "886:  if (yych <= '9') goto yy69;",
          "887:  goto yy18;",
          "888: yy46:",
          "889:  ++YYCURSOR;",
          "890:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "891:  yych = *YYCURSOR;",
          "892:  if (yych <= ':') {",
          "893:   if (yych <= '.') {",
          "894:    if (yych <= '-') goto yy18;",
          "895:    goto yy69;",
          "896:   } else {",
          "897:    if (yych <= '/') goto yy18;",
          "898:    if (yych <= '9') goto yy46;",
          "899:    goto yy18;",
          "900:   }",
          "901:  } else {",
          "902:   if (yych <= 'E') {",
          "903:    if (yych <= ';') goto yy71;",
          "904:    if (yych <= 'D') goto yy18;",
          "905:    goto yy73;",
          "906:   } else {",
          "907:    if (yych == 'e') goto yy73;",
          "908:    goto yy18;",
          "909:   }",
          "911: yy48:",
          "912:  yych = *++YYCURSOR;",
          "913:  if (yych == 'N') goto yy74;",
          "914:  goto yy18;",
          "915: yy49:",
          "916:  yych = *++YYCURSOR;",
          "917:  if (yych == 'A') goto yy75;",
          "918:  goto yy18;",
          "919: yy50:",
          "922:  if (yych >= ':') goto yy18;",
          "923: yy51:",
          "924:  ++YYCURSOR;",
          "925:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "926:  yych = *YYCURSOR;",
          "927:  if (yych <= '/') goto yy18;",
          "928:  if (yych <= '9') goto yy51;",
          "929:  if (yych == ';') goto yy76;",
          "931: yy53:",
          "935: yy54:",
          "940:  if (yych <= '9') goto yy54;",
          "941:  if (yych <= ':') goto yy78;",
          "942:  goto yy18;",
          "943: yy56:",
          "945:  if (yych <= '/') goto yy18;",
          "946:  if (yych >= ':') goto yy18;",
          "947: yy57:",
          "949:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "950:  yych = *YYCURSOR;",
          "952:  if (yych <= '9') goto yy57;",
          "953:  if (yych == ';') goto yy79;",
          "955: yy59:",
          "959: yy60:",
          "964:  if (yych <= '9') goto yy60;",
          "965:  if (yych <= ':') goto yy81;",
          "966:  goto yy18;",
          "967: yy62:",
          "969:  if (yych == '\"') goto yy82;",
          "970:  goto yy18;",
          "971: yy63:",
          "973: #line 597 \"ext/standard/var_unserializer.re\"",
          "975:  zend_long id;",
          "978:  if (!var_hash) return 0;",
          "980:  id = parse_iv(start + 2) - 1;",
          "981:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "985:  zval_ptr_dtor(rval);",
          "986:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "987:   ZVAL_UNDEF(rval);",
          "988:   return 1;",
          "990:  if (Z_ISREF_P(rval_ref)) {",
          "991:   ZVAL_COPY(rval, rval_ref);",
          "992:  } else {",
          "993:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "994:   ZVAL_COPY(rval, rval_ref);",
          "999: #line 1000 \"ext/standard/var_unserializer.c\"",
          "1000: yy65:",
          "1002:  if (yych == '\"') goto yy84;",
          "1004: yy66:",
          "1006:  if (yych == '{') goto yy86;",
          "1008: yy67:",
          "1010: #line 654 \"ext/standard/var_unserializer.re\"",
          "1011:  {",
          "1013:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1014:  return 1;",
          "1015: }",
          "1016: #line 1017 \"ext/standard/var_unserializer.c\"",
          "1017: yy69:",
          "1023:   if (yych <= '9') goto yy69;",
          "1028:    goto yy73;",
          "1030:    if (yych == 'e') goto yy73;",
          "1034: yy71:",
          "1036: #line 702 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "639:  case 'O': goto yy13;",
          "641:  case 'R': goto yy2;",
          "642:  case 'S': goto yy10;",
          "643:  case 'a': goto yy11;",
          "644:  case 'b': goto yy6;",
          "645:  case 'd': goto yy8;",
          "646:  case 'i': goto yy7;",
          "648:  case 'r': goto yy4;",
          "649:  case 's': goto yy9;",
          "650:  case '}': goto yy14;",
          "651:  default: goto yy16;",
          "654:  yych = *(YYMARKER = ++YYCURSOR);",
          "655:  if (yych == ':') goto yy95;",
          "657: #line 975 \"ext/standard/var_unserializer.re\"",
          "659: #line 660 \"ext/standard/var_unserializer.c\"",
          "662:  if (yych == ':') goto yy89;",
          "666:  if (yych == ';') goto yy87;",
          "670:  if (yych == ':') goto yy83;",
          "674:  if (yych == ':') goto yy77;",
          "678:  if (yych == ':') goto yy53;",
          "682:  if (yych == ':') goto yy46;",
          "686:  if (yych == ':') goto yy39;",
          "690:  if (yych == ':') goto yy32;",
          "694:  if (yych == ':') goto yy25;",
          "698:  if (yych == ':') goto yy17;",
          "702: #line 969 \"ext/standard/var_unserializer.re\"",
          "708: #line 709 \"ext/standard/var_unserializer.c\"",
          "709: yy16:",
          "710:  yych = *++YYCURSOR;",
          "711:  goto yy3;",
          "715:   goto yy20;",
          "717:  if (yych == '+') goto yy19;",
          "723:  if (yybm[0+yych] & 128) {",
          "724:   goto yy20;",
          "727: yy20:",
          "728:  ++YYCURSOR;",
          "729:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "730:  yych = *YYCURSOR;",
          "731:  if (yybm[0+yych] & 128) {",
          "732:   goto yy20;",
          "733:  }",
          "735:  if (yych >= ';') goto yy18;",
          "737:  if (yych != '\"') goto yy18;",
          "738:  ++YYCURSOR;",
          "739: #line 817 \"ext/standard/var_unserializer.re\"",
          "740:  {",
          "741:  size_t len, len2, len3, maxlen;",
          "742:  zend_long elements;",
          "743:  char *str;",
          "744:  zend_string *class_name;",
          "745:  zend_class_entry *ce;",
          "746:  int incomplete_class = 0;",
          "748:  int custom_object = 0;",
          "750:  zval user_func;",
          "751:  zval retval;",
          "752:  zval args[1];",
          "754:     if (!var_hash) return 0;",
          "755:  if (*start == 'C') {",
          "756:   custom_object = 1;",
          "757:  }",
          "759:  len2 = len = parse_uiv(start + 2);",
          "760:  maxlen = max - YYCURSOR;",
          "761:  if (maxlen < len || len == 0) {",
          "763:   return 0;",
          "764:  }",
          "766:  str = (char*)YYCURSOR;",
          "768:  YYCURSOR += len;",
          "770:  if (*(YYCURSOR) != '\"') {",
          "772:   return 0;",
          "773:  }",
          "774:  if (*(YYCURSOR+1) != ':') {",
          "776:   return 0;",
          "777:  }",
          "779:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "780:  if (len3 != len)",
          "781:  {",
          "783:   return 0;",
          "784:  }",
          "786:  class_name = zend_string_init(str, len, 0);",
          "788:  do {",
          "789:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "790:    incomplete_class = 1;",
          "791:    ce = PHP_IC_ENTRY;",
          "792:    break;",
          "796:   BG(serialize_lock)++;",
          "797:   ce = zend_lookup_class(class_name);",
          "798:   if (ce) {",
          "799:    BG(serialize_lock)--;",
          "800:    if (EG(exception)) {",
          "801:     zend_string_release(class_name);",
          "802:     return 0;",
          "803:    }",
          "804:    break;",
          "805:   }",
          "806:   BG(serialize_lock)--;",
          "808:   if (EG(exception)) {",
          "809:    zend_string_release(class_name);",
          "810:    return 0;",
          "811:   }",
          "814:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "815:    incomplete_class = 1;",
          "816:    ce = PHP_IC_ENTRY;",
          "817:    break;",
          "818:   }",
          "821:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "823:   ZVAL_STR_COPY(&args[0], class_name);",
          "824:   BG(serialize_lock)++;",
          "825:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "826:    BG(serialize_lock)--;",
          "827:    if (EG(exception)) {",
          "828:     zend_string_release(class_name);",
          "829:     zval_ptr_dtor(&user_func);",
          "830:     zval_ptr_dtor(&args[0]);",
          "831:     return 0;",
          "832:    }",
          "833:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "834:    incomplete_class = 1;",
          "835:    ce = PHP_IC_ENTRY;",
          "836:    zval_ptr_dtor(&user_func);",
          "837:    zval_ptr_dtor(&args[0]);",
          "838:    break;",
          "839:   }",
          "840:   BG(serialize_lock)--;",
          "841:   zval_ptr_dtor(&retval);",
          "842:   if (EG(exception)) {",
          "843:    zend_string_release(class_name);",
          "844:    zval_ptr_dtor(&user_func);",
          "845:    zval_ptr_dtor(&args[0]);",
          "846:    return 0;",
          "847:   }",
          "850:   BG(serialize_lock)++;",
          "851:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "852:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "853:    incomplete_class = 1;",
          "854:    ce = PHP_IC_ENTRY;",
          "855:   }",
          "856:   BG(serialize_lock)--;",
          "858:   zval_ptr_dtor(&user_func);",
          "859:   zval_ptr_dtor(&args[0]);",
          "860:   break;",
          "861:  } while (1);",
          "865:  if (custom_object) {",
          "866:   int ret;",
          "868:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "870:   if (ret && incomplete_class) {",
          "871:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "873:   zend_string_release(class_name);",
          "874:   return ret;",
          "877:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "879:  if (elements < 0) {",
          "880:     efree(class_name);",
          "881:     return 0;",
          "884:  if (incomplete_class) {",
          "885:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "887:  zend_string_release(class_name);",
          "889:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "890: }",
          "891: #line 892 \"ext/standard/var_unserializer.c\"",
          "892: yy25:",
          "895:   if (yych != '+') goto yy18;",
          "897:   if (yych <= '-') goto yy26;",
          "899:   if (yych <= '9') goto yy27;",
          "902: yy26:",
          "905:  if (yych >= ':') goto yy18;",
          "906: yy27:",
          "911:  if (yych <= '9') goto yy27;",
          "912:  if (yych >= ';') goto yy18;",
          "914:  if (yych != '\"') goto yy18;",
          "916: #line 806 \"ext/standard/var_unserializer.re\"",
          "917:  {",
          "918:  long elements;",
          "919:     if (!var_hash) return 0;",
          "921:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "922:  if (elements < 0) {",
          "923:   return 0;",
          "924:  }",
          "925:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "926: }",
          "927: #line 928 \"ext/standard/var_unserializer.c\"",
          "928: yy32:",
          "929:  yych = *++YYCURSOR;",
          "930:  if (yych == '+') goto yy33;",
          "934: yy33:",
          "938: yy34:",
          "943:  if (yych <= '9') goto yy34;",
          "944:  if (yych >= ';') goto yy18;",
          "946:  if (yych != '{') goto yy18;",
          "948: #line 782 \"ext/standard/var_unserializer.re\"",
          "949:  {",
          "950:  zend_long elements = parse_iv(start + 2);",
          "953:     if (!var_hash) return 0;",
          "955:  if (elements < 0) {",
          "956:   return 0;",
          "959:  array_init_size(rval, elements);",
          "960:  if (elements) {",
          "963:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "966:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "967:   return 0;",
          "968:  }",
          "970:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "971: }",
          "972: #line 973 \"ext/standard/var_unserializer.c\"",
          "973: yy39:",
          "975:  if (yych == '+') goto yy40;",
          "977:  if (yych <= '9') goto yy41;",
          "979: yy40:",
          "983: yy41:",
          "988:  if (yych <= '9') goto yy41;",
          "989:  if (yych >= ';') goto yy18;",
          "991:  if (yych != '\"') goto yy18;",
          "993: #line 748 \"ext/standard/var_unserializer.re\"",
          "994:  {",
          "995:  size_t len, maxlen;",
          "996:  zend_string *str;",
          "998:  len = parse_uiv(start + 2);",
          "999:  maxlen = max - YYCURSOR;",
          "1000:  if (maxlen < len) {",
          "1002:   return 0;",
          "1003:  }",
          "1005:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1006:   return 0;",
          "1007:  }",
          "1009:  if (*(YYCURSOR) != '\"') {",
          "1010:   zend_string_free(str);",
          "1012:   return 0;",
          "1013:  }",
          "1015:  if (*(YYCURSOR + 1) != ';') {",
          "1016:   efree(str);",
          "1018:   return 0;",
          "1019:  }",
          "1021:  YYCURSOR += 2;",
          "1024:  ZVAL_STR(rval, str);",
          "1025:  return 1;",
          "1026: }",
          "1027: #line 1028 \"ext/standard/var_unserializer.c\"",
          "1028: yy46:",
          "1029:  yych = *++YYCURSOR;",
          "1030:  if (yych == '+') goto yy47;",
          "1032:  if (yych <= '9') goto yy48;",
          "1034: yy47:",
          "1038: yy48:",
          "1043:  if (yych <= '9') goto yy48;",
          "1044:  if (yych >= ';') goto yy18;",
          "1046:  if (yych != '\"') goto yy18;",
          "1048: #line 716 \"ext/standard/var_unserializer.re\"",
          "1050:  size_t len, maxlen;",
          "1051:  char *str;",
          "1053:  len = parse_uiv(start + 2);",
          "1054:  maxlen = max - YYCURSOR;",
          "1055:  if (maxlen < len) {",
          "1060:  str = (char*)YYCURSOR;",
          "1062:  YYCURSOR += len;",
          "1064:  if (*(YYCURSOR) != '\"') {",
          "1066:   return 0;",
          "1069:  if (*(YYCURSOR + 1) != ';') {",
          "1071:   return 0;",
          "1074:  YYCURSOR += 2;",
          "1077:  ZVAL_STRINGL(rval, str, len);",
          "1080: #line 1081 \"ext/standard/var_unserializer.c\"",
          "1081: yy53:",
          "1082:  yych = *++YYCURSOR;",
          "1083:  if (yych <= '/') {",
          "1084:   if (yych <= ',') {",
          "1085:    if (yych == '+') goto yy57;",
          "1086:    goto yy18;",
          "1087:   } else {",
          "1088:    if (yych <= '-') goto yy55;",
          "1089:    if (yych <= '.') goto yy60;",
          "1090:    goto yy18;",
          "1091:   }",
          "1092:  } else {",
          "1093:   if (yych <= 'I') {",
          "1094:    if (yych <= '9') goto yy58;",
          "1095:    if (yych <= 'H') goto yy18;",
          "1096:    goto yy56;",
          "1097:   } else {",
          "1098:    if (yych != 'N') goto yy18;",
          "1099:   }",
          "1100:  }",
          "1102:  if (yych == 'A') goto yy76;",
          "1104: yy55:",
          "1105:  yych = *++YYCURSOR;",
          "1106:  if (yych <= '/') {",
          "1107:   if (yych == '.') goto yy60;",
          "1108:   goto yy18;",
          "1109:  } else {",
          "1110:   if (yych <= '9') goto yy58;",
          "1111:   if (yych != 'I') goto yy18;",
          "1112:  }",
          "1113: yy56:",
          "1115:  if (yych == 'N') goto yy72;",
          "1117: yy57:",
          "1118:  yych = *++YYCURSOR;",
          "1119:  if (yych == '.') goto yy60;",
          "1120:  if (yych <= '/') goto yy18;",
          "1121:  if (yych >= ':') goto yy18;",
          "1122: yy58:",
          "1124:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1125:  yych = *YYCURSOR;",
          "1126:  if (yych <= ':') {",
          "1127:   if (yych <= '.') {",
          "1128:    if (yych <= '-') goto yy18;",
          "1129:    goto yy70;",
          "1130:   } else {",
          "1131:    if (yych <= '/') goto yy18;",
          "1132:    if (yych <= '9') goto yy58;",
          "1133:    goto yy18;",
          "1134:   }",
          "1135:  } else {",
          "1136:   if (yych <= 'E') {",
          "1137:    if (yych <= ';') goto yy63;",
          "1138:    if (yych <= 'D') goto yy18;",
          "1139:    goto yy65;",
          "1140:   } else {",
          "1141:    if (yych == 'e') goto yy65;",
          "1142:    goto yy18;",
          "1143:   }",
          "1144:  }",
          "1145: yy60:",
          "1146:  yych = *++YYCURSOR;",
          "1147:  if (yych <= '/') goto yy18;",
          "1148:  if (yych >= ':') goto yy18;",
          "1149: yy61:",
          "1155:   if (yych <= '9') goto yy61;",
          "1160:    goto yy65;",
          "1162:    if (yych == 'e') goto yy65;",
          "1166: yy63:",
          "1168: #line 707 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1042:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1043:  return 1;",
          "1044: }",
          "1047:  yych = *++YYCURSOR;",
          "1048:  if (yych <= ',') {",
          "1051:  } else {",
          "1053:   if (yych <= '/') goto yy18;",
          "1055:   goto yy18;",
          "1056:  }",
          "1058:  yych = *++YYCURSOR;",
          "1060:  goto yy18;",
          "1062:  yych = *++YYCURSOR;",
          "1064:  goto yy18;",
          "1066:  ++YYCURSOR;",
          "1084:   } else {",
          "1086:   }",
          "1087:  }",
          "1095:  yych = *++YYCURSOR;",
          "1099:  ++YYCURSOR;",
          "1101:  {",
          "1119:  }",
          "1123:  return 1;",
          "1124: }",
          "1127:  yych = *++YYCURSOR;",
          "1129:  goto yy18;",
          "1131:  ++YYCURSOR;",
          "1133:  {",
          "1177:  }",
          "1225:    }",
          "1265:   }",
          "1268:  }",
          "1278: }",
          "1281:  ++YYCURSOR;",
          "1283:  {",
          "1314:  return 1;",
          "1315: }",
          "1318:  ++YYCURSOR;",
          "1320:  {",
          "1342: }",
          "1345:  yych = *++YYCURSOR;",
          "1346:  if (yych <= ',') {",
          "1349:  } else {",
          "1351:   if (yych <= '/') goto yy18;",
          "1353:  }",
          "1355:  ++YYCURSOR;",
          "1356:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1357:  yych = *YYCURSOR;",
          "1358:  if (yych <= '/') goto yy18;",
          "1367:  ++YYCURSOR;",
          "1369:  {",
          "1387:   return 0;",
          "1388:  }",
          "1396:   return 0;",
          "1397:  }",
          "1402:  }",
          "1408:  return 1;",
          "1409: }",
          "1411: yy96:",
          "1412:  yych = *++YYCURSOR;",
          "1413:  if (yych <= '/') goto yy18;",
          "1416: yy97:",
          "1417:  ++YYCURSOR;",
          "1419:  {",
          "1428:  } else {",
          "1430:  }",
          "1432:  return 1;",
          "1433: }",
          "1435: }",
          "1439:  return 0;",
          "",
          "[Removed Lines]",
          "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
          "1046: yy73:",
          "1049:   if (yych == '+') goto yy88;",
          "1050:   goto yy18;",
          "1052:   if (yych <= '-') goto yy88;",
          "1054:   if (yych <= '9') goto yy89;",
          "1057: yy74:",
          "1059:  if (yych == 'F') goto yy91;",
          "1061: yy75:",
          "1063:  if (yych == 'N') goto yy91;",
          "1065: yy76:",
          "1067: #line 660 \"ext/standard/var_unserializer.re\"",
          "1068:  {",
          "1069: #if SIZEOF_ZEND_LONG == 4",
          "1070:  int digits = YYCURSOR - start - 3;",
          "1072:  if (start[2] == '-' || start[2] == '+') {",
          "1073:   digits--;",
          "1074:  }",
          "1077:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1078:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1079:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1081:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1082:     goto use_double;",
          "1083:    }",
          "1085:    goto use_double;",
          "1088: #endif",
          "1090:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1091:  return 1;",
          "1092: }",
          "1093: #line 1094 \"ext/standard/var_unserializer.c\"",
          "1094: yy78:",
          "1096:  if (yych == '\"') goto yy92;",
          "1097:  goto yy18;",
          "1098: yy79:",
          "1100: #line 623 \"ext/standard/var_unserializer.re\"",
          "1102:  zend_long id;",
          "1105:  if (!var_hash) return 0;",
          "1107:  id = parse_iv(start + 2) - 1;",
          "1108:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1109:   return 0;",
          "1110:  }",
          "1112:  if (rval_ref == rval) {",
          "1113:   return 0;",
          "1114:  }",
          "1116:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1117:   ZVAL_UNDEF(rval);",
          "1118:   return 1;",
          "1121:  ZVAL_COPY(rval, rval_ref);",
          "1125: #line 1126 \"ext/standard/var_unserializer.c\"",
          "1126: yy81:",
          "1128:  if (yych == '\"') goto yy94;",
          "1130: yy82:",
          "1132: #line 808 \"ext/standard/var_unserializer.re\"",
          "1134:  size_t len, len2, len3, maxlen;",
          "1135:  zend_long elements;",
          "1136:  char *str;",
          "1137:  zend_string *class_name;",
          "1138:  zend_class_entry *ce;",
          "1139:  int incomplete_class = 0;",
          "1141:  int custom_object = 0;",
          "1143:  zval user_func;",
          "1144:  zval retval;",
          "1145:  zval args[1];",
          "1147:     if (!var_hash) return 0;",
          "1148:  if (*start == 'C') {",
          "1149:   custom_object = 1;",
          "1150:  }",
          "1152:  len2 = len = parse_uiv(start + 2);",
          "1153:  maxlen = max - YYCURSOR;",
          "1154:  if (maxlen < len || len == 0) {",
          "1156:   return 0;",
          "1157:  }",
          "1159:  str = (char*)YYCURSOR;",
          "1161:  YYCURSOR += len;",
          "1163:  if (*(YYCURSOR) != '\"') {",
          "1165:   return 0;",
          "1166:  }",
          "1167:  if (*(YYCURSOR+1) != ':') {",
          "1169:   return 0;",
          "1170:  }",
          "1172:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1173:  if (len3 != len)",
          "1174:  {",
          "1176:   return 0;",
          "1179:  class_name = zend_string_init(str, len, 0);",
          "1181:  do {",
          "1182:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "1183:    incomplete_class = 1;",
          "1184:    ce = PHP_IC_ENTRY;",
          "1185:    break;",
          "1186:   }",
          "1189:   BG(serialize_lock)++;",
          "1190:   ce = zend_lookup_class(class_name);",
          "1191:   if (ce) {",
          "1192:    BG(serialize_lock)--;",
          "1193:    if (EG(exception)) {",
          "1194:     zend_string_release(class_name);",
          "1195:     return 0;",
          "1196:    }",
          "1197:    break;",
          "1198:   }",
          "1199:   BG(serialize_lock)--;",
          "1201:   if (EG(exception)) {",
          "1202:    zend_string_release(class_name);",
          "1203:    return 0;",
          "1204:   }",
          "1207:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1208:    incomplete_class = 1;",
          "1209:    ce = PHP_IC_ENTRY;",
          "1210:    break;",
          "1211:   }",
          "1214:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1216:   ZVAL_STR_COPY(&args[0], class_name);",
          "1217:   BG(serialize_lock)++;",
          "1218:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1219:    BG(serialize_lock)--;",
          "1220:    if (EG(exception)) {",
          "1221:     zend_string_release(class_name);",
          "1222:     zval_ptr_dtor(&user_func);",
          "1223:     zval_ptr_dtor(&args[0]);",
          "1224:     return 0;",
          "1226:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1227:    incomplete_class = 1;",
          "1228:    ce = PHP_IC_ENTRY;",
          "1229:    zval_ptr_dtor(&user_func);",
          "1230:    zval_ptr_dtor(&args[0]);",
          "1231:    break;",
          "1232:   }",
          "1233:   BG(serialize_lock)--;",
          "1234:   zval_ptr_dtor(&retval);",
          "1235:   if (EG(exception)) {",
          "1236:    zend_string_release(class_name);",
          "1237:    zval_ptr_dtor(&user_func);",
          "1238:    zval_ptr_dtor(&args[0]);",
          "1239:    return 0;",
          "1240:   }",
          "1243:   BG(serialize_lock)++;",
          "1244:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1245:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1246:    incomplete_class = 1;",
          "1247:    ce = PHP_IC_ENTRY;",
          "1248:   }",
          "1249:   BG(serialize_lock)--;",
          "1251:   zval_ptr_dtor(&user_func);",
          "1252:   zval_ptr_dtor(&args[0]);",
          "1253:   break;",
          "1254:  } while (1);",
          "1258:  if (custom_object) {",
          "1259:   int ret;",
          "1261:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1263:   if (ret && incomplete_class) {",
          "1264:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1266:   zend_string_release(class_name);",
          "1267:   return ret;",
          "1270:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1272:  if (incomplete_class) {",
          "1273:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1274:  }",
          "1275:  zend_string_release(class_name);",
          "1277:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1279: #line 1280 \"ext/standard/var_unserializer.c\"",
          "1280: yy84:",
          "1282: #line 743 \"ext/standard/var_unserializer.re\"",
          "1284:  size_t len, maxlen;",
          "1285:  zend_string *str;",
          "1287:  len = parse_uiv(start + 2);",
          "1288:  maxlen = max - YYCURSOR;",
          "1289:  if (maxlen < len) {",
          "1291:   return 0;",
          "1292:  }",
          "1294:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1295:   return 0;",
          "1296:  }",
          "1298:  if (*(YYCURSOR) != '\"') {",
          "1299:   zend_string_free(str);",
          "1301:   return 0;",
          "1302:  }",
          "1304:  if (*(YYCURSOR + 1) != ';') {",
          "1305:   efree(str);",
          "1307:   return 0;",
          "1308:  }",
          "1310:  YYCURSOR += 2;",
          "1313:  ZVAL_STR(rval, str);",
          "1316: #line 1317 \"ext/standard/var_unserializer.c\"",
          "1317: yy86:",
          "1319: #line 777 \"ext/standard/var_unserializer.re\"",
          "1321:  zend_long elements = parse_iv(start + 2);",
          "1324:     if (!var_hash) return 0;",
          "1326:  if (elements < 0) {",
          "1327:   return 0;",
          "1328:  }",
          "1330:  array_init_size(rval, elements);",
          "1331:  if (elements) {",
          "1334:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1335:  }",
          "1337:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1338:   return 0;",
          "1339:  }",
          "1341:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1343: #line 1344 \"ext/standard/var_unserializer.c\"",
          "1344: yy88:",
          "1347:   if (yych == '+') goto yy96;",
          "1348:   goto yy18;",
          "1350:   if (yych <= '-') goto yy96;",
          "1352:   if (yych >= ':') goto yy18;",
          "1354: yy89:",
          "1359:  if (yych <= '9') goto yy89;",
          "1360:  if (yych == ';') goto yy71;",
          "1361:  goto yy18;",
          "1362: yy91:",
          "1363:  yych = *++YYCURSOR;",
          "1364:  if (yych == ';') goto yy97;",
          "1365:  goto yy18;",
          "1366: yy92:",
          "1368: #line 801 \"ext/standard/var_unserializer.re\"",
          "1370:     if (!var_hash) return 0;",
          "1372:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "1373:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "1374: }",
          "1375: #line 1376 \"ext/standard/var_unserializer.c\"",
          "1376: yy94:",
          "1377:  ++YYCURSOR;",
          "1378: #line 711 \"ext/standard/var_unserializer.re\"",
          "1379:  {",
          "1380:  size_t len, maxlen;",
          "1381:  char *str;",
          "1383:  len = parse_uiv(start + 2);",
          "1384:  maxlen = max - YYCURSOR;",
          "1385:  if (maxlen < len) {",
          "1390:  str = (char*)YYCURSOR;",
          "1392:  YYCURSOR += len;",
          "1394:  if (*(YYCURSOR) != '\"') {",
          "1399:  if (*(YYCURSOR + 1) != ';') {",
          "1401:   return 0;",
          "1404:  YYCURSOR += 2;",
          "1407:  ZVAL_STRINGL(rval, str, len);",
          "1410: #line 1411 \"ext/standard/var_unserializer.c\"",
          "1414:  if (yych <= '9') goto yy89;",
          "1415:  goto yy18;",
          "1418: #line 686 \"ext/standard/var_unserializer.re\"",
          "1422:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1423:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1424:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1425:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1426:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1427:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1429:   ZVAL_NULL(rval);",
          "1434: #line 1435 \"ext/standard/var_unserializer.c\"",
          "1436: #line 963 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1177: #line 1178 \"ext/standard/var_unserializer.c\"",
          "1178: yy65:",
          "1181:   if (yych != '+') goto yy18;",
          "1183:   if (yych <= '-') goto yy66;",
          "1185:   if (yych <= '9') goto yy67;",
          "1188: yy66:",
          "1190:  if (yych <= ',') {",
          "1191:   if (yych == '+') goto yy69;",
          "1192:   goto yy18;",
          "1193:  } else {",
          "1194:   if (yych <= '-') goto yy69;",
          "1195:   if (yych <= '/') goto yy18;",
          "1196:   if (yych >= ':') goto yy18;",
          "1197:  }",
          "1198: yy67:",
          "1199:  ++YYCURSOR;",
          "1200:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1201:  yych = *YYCURSOR;",
          "1202:  if (yych <= '/') goto yy18;",
          "1203:  if (yych <= '9') goto yy67;",
          "1204:  if (yych == ';') goto yy63;",
          "1206: yy69:",
          "1208:  if (yych <= '/') goto yy18;",
          "1209:  if (yych <= '9') goto yy67;",
          "1211: yy70:",
          "1213:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1214:  yych = *YYCURSOR;",
          "1215:  if (yych <= ';') {",
          "1216:   if (yych <= '/') goto yy18;",
          "1217:   if (yych <= '9') goto yy70;",
          "1218:   if (yych <= ':') goto yy18;",
          "1219:   goto yy63;",
          "1220:  } else {",
          "1221:   if (yych <= 'E') {",
          "1222:    if (yych <= 'D') goto yy18;",
          "1223:    goto yy65;",
          "1225:    if (yych == 'e') goto yy65;",
          "1226:    goto yy18;",
          "1229: yy72:",
          "1231:  if (yych != 'F') goto yy18;",
          "1232: yy73:",
          "1233:  yych = *++YYCURSOR;",
          "1234:  if (yych != ';') goto yy18;",
          "1236: #line 691 \"ext/standard/var_unserializer.re\"",
          "1240:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1241:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1242:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1243:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1244:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1245:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1246:  } else {",
          "1247:   ZVAL_NULL(rval);",
          "1252: #line 1253 \"ext/standard/var_unserializer.c\"",
          "1253: yy76:",
          "1255:  if (yych == 'N') goto yy73;",
          "1257: yy77:",
          "1258:  yych = *++YYCURSOR;",
          "1259:  if (yych <= ',') {",
          "1260:   if (yych != '+') goto yy18;",
          "1261:  } else {",
          "1262:   if (yych <= '-') goto yy78;",
          "1263:   if (yych <= '/') goto yy18;",
          "1264:   if (yych <= '9') goto yy79;",
          "1265:   goto yy18;",
          "1266:  }",
          "1267: yy78:",
          "1268:  yych = *++YYCURSOR;",
          "1269:  if (yych <= '/') goto yy18;",
          "1270:  if (yych >= ':') goto yy18;",
          "1271: yy79:",
          "1273:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1274:  yych = *YYCURSOR;",
          "1275:  if (yych <= '/') goto yy18;",
          "1276:  if (yych <= '9') goto yy79;",
          "1277:  if (yych != ';') goto yy18;",
          "1278:  ++YYCURSOR;",
          "1279: #line 665 \"ext/standard/var_unserializer.re\"",
          "1281: #if SIZEOF_ZEND_LONG == 4",
          "1282:  int digits = YYCURSOR - start - 3;",
          "1284:  if (start[2] == '-' || start[2] == '+') {",
          "1285:   digits--;",
          "1289:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1290:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1291:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1293:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1294:     goto use_double;",
          "1296:   } else {",
          "1297:    goto use_double;",
          "1300: #endif",
          "1302:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1303:  return 1;",
          "1305: #line 1306 \"ext/standard/var_unserializer.c\"",
          "1306: yy83:",
          "1307:  yych = *++YYCURSOR;",
          "1308:  if (yych <= '/') goto yy18;",
          "1309:  if (yych >= '2') goto yy18;",
          "1310:  yych = *++YYCURSOR;",
          "1311:  if (yych != ';') goto yy18;",
          "1313: #line 659 \"ext/standard/var_unserializer.re\"",
          "1316:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1319: #line 1320 \"ext/standard/var_unserializer.c\"",
          "1320: yy87:",
          "1322: #line 653 \"ext/standard/var_unserializer.re\"",
          "1325:  ZVAL_NULL(rval);",
          "1326:  return 1;",
          "1328: #line 1329 \"ext/standard/var_unserializer.c\"",
          "1329: yy89:",
          "1332:   if (yych != '+') goto yy18;",
          "1334:   if (yych <= '-') goto yy90;",
          "1336:   if (yych <= '9') goto yy91;",
          "1337:   goto yy18;",
          "1339: yy90:",
          "1340:  yych = *++YYCURSOR;",
          "1341:  if (yych <= '/') goto yy18;",
          "1342:  if (yych >= ':') goto yy18;",
          "1343: yy91:",
          "1348:  if (yych <= '9') goto yy91;",
          "1349:  if (yych != ';') goto yy18;",
          "1351: #line 628 \"ext/standard/var_unserializer.re\"",
          "1353:  zend_long id;",
          "1356:  if (!var_hash) return 0;",
          "1358:  id = parse_iv(start + 2) - 1;",
          "1359:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1363:  if (rval_ref == rval) {",
          "1367:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1368:   ZVAL_UNDEF(rval);",
          "1369:   return 1;",
          "1372:  ZVAL_COPY(rval, rval_ref);",
          "1376: #line 1377 \"ext/standard/var_unserializer.c\"",
          "1377: yy95:",
          "1378:  yych = *++YYCURSOR;",
          "1379:  if (yych <= ',') {",
          "1380:   if (yych != '+') goto yy18;",
          "1381:  } else {",
          "1382:   if (yych <= '-') goto yy96;",
          "1383:   if (yych <= '/') goto yy18;",
          "1384:   if (yych <= '9') goto yy97;",
          "1385:   goto yy18;",
          "1386:  }",
          "1390:  if (yych >= ':') goto yy18;",
          "1393:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1394:  yych = *YYCURSOR;",
          "1395:  if (yych <= '/') goto yy18;",
          "1396:  if (yych <= '9') goto yy97;",
          "1397:  if (yych != ';') goto yy18;",
          "1398:  ++YYCURSOR;",
          "1399: #line 602 \"ext/standard/var_unserializer.re\"",
          "1401:  zend_long id;",
          "1404:  if (!var_hash) return 0;",
          "1406:  id = parse_iv(start + 2) - 1;",
          "1407:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1408:   return 0;",
          "1409:  }",
          "1411:  zval_ptr_dtor(rval);",
          "1412:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1413:   ZVAL_UNDEF(rval);",
          "1414:   return 1;",
          "1415:  }",
          "1416:  if (Z_ISREF_P(rval_ref)) {",
          "1417:   ZVAL_COPY(rval, rval_ref);",
          "1419:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1420:   ZVAL_COPY(rval, rval_ref);",
          "1425: #line 1426 \"ext/standard/var_unserializer.c\"",
          "1427: #line 977 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "482: {",
          "483:  zend_long elements;",
          "485:  elements = parse_iv2((*p) + 2, p);",
          "487:  (*p) += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "485:  if( *p >= max - 2) {",
          "486:   zend_error(E_WARNING, \"Bad unserialize data\");",
          "487:   return -1;",
          "488:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "491:  } else {",
          "496:  }",
          "498:  return elements;",
          "",
          "[Removed Lines]",
          "494:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ZSTR_VAL(ce->name));",
          "495:   return 0;",
          "",
          "[Added Lines]",
          "499:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
          "500:   return -1;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "799: }",
          "801: \"o:\" iv \":\" [\"] {",
          "802:     if (!var_hash) return 0;",
          "806: }",
          "808: object \":\" uiv \":\" [\"] {",
          "",
          "[Removed Lines]",
          "804:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "805:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "",
          "[Added Lines]",
          "807:  long elements;",
          "810:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "811:  if (elements < 0) {",
          "812:   return 0;",
          "813:  }",
          "814:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "945:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "947:  if (incomplete_class) {",
          "948:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "949:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "956:  if (elements < 0) {",
          "957:     efree(class_name);",
          "958:     return 0;",
          "959:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a08723d3d313445191470c19e12235a56165600a",
      "candidate_info": {
        "commit_hash": "a08723d3d313445191470c19e12235a56165600a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/a08723d3d313445191470c19e12235a56165600a",
        "files": [
          "Zend/zend_operators.c",
          "ext/mysqlnd/mysqlnd_wireprotocol.c",
          "ext/standard/array.c",
          "ext/standard/basic_functions.c",
          "ext/standard/string.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "main/php_variables.c"
        ],
        "message": "Use interned empty and \"one char\" strings.",
        "before_after_code_files": [
          "Zend/zend_operators.c||Zend/zend_operators.c",
          "ext/mysqlnd/mysqlnd_wireprotocol.c||ext/mysqlnd/mysqlnd_wireprotocol.c",
          "ext/standard/array.c||ext/standard/array.c",
          "ext/standard/basic_functions.c||ext/standard/basic_functions.c",
          "ext/standard/string.c||ext/standard/string.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "main/php_variables.c||main/php_variables.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/zend_operators.c||Zend/zend_operators.c": [
          "File: Zend/zend_operators.c -> Zend/zend_operators.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "537:    break;",
          "538:   }",
          "539:   case IS_LONG: {",
          "541:    break;",
          "542:   }",
          "543:   case IS_DOUBLE: {",
          "",
          "[Removed Lines]",
          "540:    ZVAL_NEW_STR(op, zend_long_to_str(Z_LVAL_P(op)));",
          "",
          "[Added Lines]",
          "540:    ZVAL_STR(op, zend_long_to_str(Z_LVAL_P(op)));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2858: {",
          "2862: }",
          "",
          "[Removed Lines]",
          "2859:  char buf[MAX_LENGTH_OF_LONG + 1];",
          "2860:  char *res = zend_print_long_to_buf(buf + sizeof(buf) - 1, num);",
          "2861:  return zend_string_init(res, buf + sizeof(buf) - 1 - res, 0);",
          "",
          "[Added Lines]",
          "2859:  if ((zend_ulong)num <= 9) {",
          "2860:   return ZSTR_CHAR((zend_uchar)'0' + (zend_uchar)num);",
          "2861:  } else {",
          "2862:   char buf[MAX_LENGTH_OF_LONG + 1];",
          "2863:   char *res = zend_print_long_to_buf(buf + sizeof(buf) - 1, num);",
          "2864:   return zend_string_init(res, buf + sizeof(buf) - 1 - res, 0);",
          "2865:  }",
          "",
          "---------------"
        ],
        "ext/mysqlnd/mysqlnd_wireprotocol.c||ext/mysqlnd/mysqlnd_wireprotocol.c": [
          "File: ext/mysqlnd/mysqlnd_wireprotocol.c -> ext/mysqlnd/mysqlnd_wireprotocol.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1766:     } else if (Z_TYPE_P(current_field) == IS_STRING) {",
          "1768:     }",
          "1769:    } else {",
          "1770:     ZVAL_STRINGL(current_field, (char *)p, len);",
          "1771:    }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1769:    } else if (len == 0) {",
          "1770:     ZVAL_EMPTY_STRING(current_field);",
          "1771:    } else if (len == 1) {",
          "1772:     ZVAL_INTERNED_STR(current_field, ZSTR_CHAR((zend_uchar)*(char *)p));",
          "",
          "---------------"
        ],
        "ext/standard/array.c||ext/standard/array.c": [
          "File: ext/standard/array.c -> ext/standard/array.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3807:   Z_PARAM_VARIADIC('+', args, argc)",
          "3808:  ZEND_PARSE_PARAMETERS_END();",
          "3820:  if (replace) {",
          "3821:   HashTable *dest;",
          "3824:   arg = args;",
          "3825:   dest = zend_array_dup(Z_ARRVAL_P(arg));",
          "",
          "[Removed Lines]",
          "3810:  for (i = 0; i < argc; i++) {",
          "3811:   zval *arg = args + i;",
          "3813:   if (Z_TYPE_P(arg) != IS_ARRAY) {",
          "3814:    php_error_docref(NULL, E_WARNING, \"Argument #%d is not an array\", i + 1);",
          "3815:    RETURN_NULL();",
          "3816:   }",
          "3817:  }",
          "",
          "[Added Lines]",
          "3814:   for (i = 0; i < argc; i++) {",
          "3815:    zval *arg = args + i;",
          "3817:    if (Z_TYPE_P(arg) != IS_ARRAY) {",
          "3818:     php_error_docref(NULL, E_WARNING, \"Argument #%d is not an array\", i + 1);",
          "3819:     RETURN_NULL();",
          "3820:    }",
          "3821:   }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3838:  } else {",
          "3839:   zval *src_entry;",
          "3840:   HashTable *src, *dest;",
          "3842:   arg = args;",
          "3843:   src  = Z_ARRVAL_P(arg);",
          "3846:   dest = Z_ARRVAL_P(return_value);",
          "3847:   if (src->u.flags & HASH_FLAG_PACKED) {",
          "3848:    zend_hash_real_init(dest, 1);",
          "",
          "[Removed Lines]",
          "3845:   array_init_size(return_value, zend_hash_num_elements(src));",
          "",
          "[Added Lines]",
          "3841:   uint32_t count = 0;",
          "3843:   for (i = 0; i < argc; i++) {",
          "3844:    zval *arg = args + i;",
          "3846:    if (Z_TYPE_P(arg) != IS_ARRAY) {",
          "3847:     php_error_docref(NULL, E_WARNING, \"Argument #%d is not an array\", i + 1);",
          "3848:     RETURN_NULL();",
          "3849:    }",
          "3850:    count += zend_hash_num_elements(Z_ARRVAL_P(arg));",
          "3851:   }",
          "3856:   array_init_size(return_value, count);",
          "",
          "---------------"
        ],
        "ext/standard/basic_functions.c||ext/standard/basic_functions.c": [
          "File: ext/standard/basic_functions.c -> ext/standard/basic_functions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5320: PHP_FUNCTION(ini_get)",
          "5321: {",
          "5322:  char *varname, *str;",
          "5325:  ZEND_PARSE_PARAMETERS_START(1, 1)",
          "5326:   Z_PARAM_STRING(varname, varname_len)",
          "",
          "[Removed Lines]",
          "5323:  size_t varname_len;",
          "",
          "[Added Lines]",
          "5323:  size_t varname_len, len;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "5332:   RETURN_FALSE;",
          "5333:  }",
          "5336: }",
          "",
          "[Removed Lines]",
          "5335:  RETURN_STRING(str);",
          "",
          "[Added Lines]",
          "5335:  len = strlen(str);",
          "5336:  if (len == 0) {",
          "5337:   RETURN_EMPTY_STRING();",
          "5338:  } else if (len == 1) {",
          "5339:   RETURN_INTERNED_STR(ZSTR_CHAR((zend_uchar)str[0]));",
          "5340:  }",
          "5341:  RETURN_STRINGL(str, len);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "5445:  if (old_value) {",
          "5447:  } else {",
          "5448:   RETVAL_FALSE;",
          "5449:  }",
          "",
          "[Removed Lines]",
          "5446:   RETVAL_STRING(old_value);",
          "",
          "[Added Lines]",
          "5452:   size_t len = strlen(old_value);",
          "5454:   if (len == 0) {",
          "5455:    RETVAL_EMPTY_STRING();",
          "5456:   } else if (len == 1) {",
          "5457:    RETVAL_INTERNED_STR(ZSTR_CHAR((zend_uchar)old_value[0]));",
          "5458:   } else {",
          "5459:    RETVAL_STRINGL(old_value, len);",
          "5460:   }",
          "",
          "---------------"
        ],
        "ext/standard/string.c||ext/standard/string.c": [
          "File: ext/standard/string.c -> ext/standard/string.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1094:   zend_hash_next_index_insert_new(Z_ARRVAL_P(return_value), &tmp);",
          "1095:  } else {",
          "1096:   do {",
          "1098:    zend_hash_next_index_insert_new(Z_ARRVAL_P(return_value), &tmp);",
          "1099:    p1 = p2 + ZSTR_LEN(delim);",
          "1100:    p2 = (char *) php_memnstr(p1, ZSTR_VAL(delim), ZSTR_LEN(delim), endp);",
          "",
          "[Removed Lines]",
          "1097:    ZVAL_STRINGL(&tmp, p1, p2 - p1);",
          "",
          "[Added Lines]",
          "1097:    size_t l = p2 - p1;",
          "1099:    if (l == 0) {",
          "1100:     ZVAL_EMPTY_STRING(&tmp);",
          "1101:    } else if (l == 1) {",
          "1102:     ZVAL_INTERNED_STR(&tmp, ZSTR_CHAR((zend_uchar)(*p1)));",
          "1103:    } else {",
          "1104:     ZVAL_STRINGL(&tmp, p1, p2 - p1);",
          "1105:    }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2420:   l = ZSTR_LEN(str) - f;",
          "2421:  }",
          "2423:  RETURN_STRINGL(ZSTR_VAL(str) + f, l);",
          "2424: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2431:  if (l == 0) {",
          "2432:   RETURN_EMPTY_STRING();",
          "2433:  } else if (l == 1) {",
          "2434:   RETURN_INTERNED_STR(ZSTR_CHAR((zend_uchar)(ZSTR_VAL(str)[f])));",
          "2435:  } else if (l == ZSTR_LEN(str)) {",
          "2436:   RETURN_STR_COPY(str);",
          "2437:  }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3227: nothing_todo:",
          "3228:   return zend_string_copy(haystack);",
          "3229:  } else {",
          "3231:   (*replace_count)++;",
          "3232:   return new_str;",
          "3233:  }",
          "",
          "[Removed Lines]",
          "3230:   new_str = zend_string_init(str, str_len, 0);",
          "",
          "[Added Lines]",
          "3246:   if (str_len == 0) {",
          "3247:    new_str = ZSTR_EMPTY_ALLOC();",
          "3248:   } else if (str_len == 1) {",
          "3249:    new_str = ZSTR_CHAR((zend_uchar)(*str));",
          "3250:   } else {",
          "3251:    new_str = zend_string_init(str, str_len, 0);",
          "3252:   }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "651:     0,   0,   0,   0,   0,   0,   0,   0,",
          "652:     0,   0,   0,   0,   0,   0,   0,   0,",
          "653:  };",
          "654:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "655:  yych = *YYCURSOR;",
          "656:  switch (yych) {",
          "657:  case 'C':",
          "659:  case 'N': goto yy5;",
          "666:  case 'o': goto yy12;",
          "671:  }",
          "672: yy2:",
          "674: yy3:",
          "676:  { return 0; }",
          "678: yy4:",
          "679:  yych = *(YYMARKER = ++YYCURSOR);",
          "681:  goto yy3;",
          "682: yy5:",
          "683:  yych = *++YYCURSOR;",
          "685:  goto yy3;",
          "686: yy6:",
          "687:  yych = *(YYMARKER = ++YYCURSOR);",
          "689:  goto yy3;",
          "690: yy7:",
          "691:  yych = *(YYMARKER = ++YYCURSOR);",
          "693:  goto yy3;",
          "694: yy8:",
          "695:  yych = *(YYMARKER = ++YYCURSOR);",
          "697:  goto yy3;",
          "698: yy9:",
          "699:  yych = *(YYMARKER = ++YYCURSOR);",
          "701:  goto yy3;",
          "702: yy10:",
          "703:  yych = *(YYMARKER = ++YYCURSOR);",
          "705:  goto yy3;",
          "706: yy11:",
          "707:  yych = *(YYMARKER = ++YYCURSOR);",
          "709:  goto yy3;",
          "710: yy12:",
          "711:  yych = *(YYMARKER = ++YYCURSOR);",
          "713:  goto yy3;",
          "714: yy13:",
          "715:  yych = *(YYMARKER = ++YYCURSOR);",
          "717:  goto yy3;",
          "718: yy14:",
          "723:  ++YYCURSOR;",
          "725:  {",
          "727:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "729: }",
          "731: yy17:",
          "732:  yych = *++YYCURSOR;",
          "733:  if (yybm[0+yych] & 128) {",
          "735:  }",
          "736: yy18:",
          "737:  YYCURSOR = YYMARKER;",
          "738:  goto yy3;",
          "739: yy19:",
          "740:  ++YYCURSOR;",
          "765:  if (yych <= '/') goto yy18;",
          "769:  yych = *++YYCURSOR;",
          "778:   }",
          "787:   }",
          "788:  }",
          "799:  }",
          "811:  yych = *++YYCURSOR;",
          "812:  if (yych <= '/') goto yy18;",
          "816:  ++YYCURSOR;",
          "817:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "818:  yych = *YYCURSOR;",
          "829:  if (yych <= '/') goto yy18;",
          "834:  ++YYCURSOR;",
          "837:  if (yych <= '/') goto yy18;",
          "842:  ++YYCURSOR;",
          "843:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "844:  yych = *YYCURSOR;",
          "845:  if (yych <= '/') goto yy18;",
          "869:  yych = *++YYCURSOR;",
          "874:  ++YYCURSOR;",
          "895:  }",
          "905:  yych = *++YYCURSOR;",
          "906:  if (yych <= '/') goto yy18;",
          "907:  if (yych >= ':') goto yy18;",
          "917:  ++YYCURSOR;",
          "918:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "919:  yych = *YYCURSOR;",
          "920:  if (yych <= '/') goto yy18;",
          "925:  ++YYCURSOR;",
          "928:  if (yych <= '/') goto yy18;",
          "933:  ++YYCURSOR;",
          "934:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "935:  yych = *YYCURSOR;",
          "936:  if (yych <= '/') goto yy18;",
          "941:  yych = *++YYCURSOR;",
          "945:  ++YYCURSOR;",
          "947:  {",
          "955:   return 0;",
          "956:  }",
          "962:  }",
          "965:  } else {",
          "968:  }",
          "970:  return 1;",
          "971: }",
          "974:  yych = *++YYCURSOR;",
          "976:  goto yy18;",
          "978:  yych = *++YYCURSOR;",
          "980:  goto yy18;",
          "982:  ++YYCURSOR;",
          "991:  ++YYCURSOR;",
          "992:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "993:  yych = *YYCURSOR;",
          "994:  if (yych <= ';') {",
          "995:   if (yych <= '/') goto yy18;",
          "997:   if (yych <= ':') goto yy18;",
          "998:  } else {",
          "999:   if (yych <= 'E') {",
          "1000:    if (yych <= 'D') goto yy18;",
          "1002:   } else {",
          "1004:    goto yy18;",
          "1005:   }",
          "1006:  }",
          "1008:  ++YYCURSOR;",
          "1009: #line 727 \"ext/standard/var_unserializer.re\"",
          "1010:  {",
          "",
          "[Removed Lines]",
          "658:  case 'O': goto yy4;",
          "660:  case 'R': goto yy6;",
          "661:  case 'S': goto yy7;",
          "662:  case 'a': goto yy8;",
          "663:  case 'b': goto yy9;",
          "664:  case 'd': goto yy10;",
          "665:  case 'i': goto yy11;",
          "667:  case 'r': goto yy13;",
          "668:  case 's': goto yy14;",
          "669:  case '}': goto yy15;",
          "670:  default: goto yy2;",
          "673:  ++YYCURSOR;",
          "675: #line 1001 \"ext/standard/var_unserializer.re\"",
          "677: #line 678 \"ext/standard/var_unserializer.c\"",
          "680:  if (yych == ':') goto yy17;",
          "684:  if (yych == ';') goto yy19;",
          "688:  if (yych == ':') goto yy21;",
          "692:  if (yych == ':') goto yy22;",
          "696:  if (yych == ':') goto yy23;",
          "700:  if (yych == ':') goto yy24;",
          "704:  if (yych == ':') goto yy25;",
          "708:  if (yych == ':') goto yy26;",
          "712:  if (yych == ':') goto yy27;",
          "716:  if (yych == ':') goto yy28;",
          "719:  yych = *(YYMARKER = ++YYCURSOR);",
          "720:  if (yych == ':') goto yy29;",
          "721:  goto yy3;",
          "722: yy15:",
          "724: #line 995 \"ext/standard/var_unserializer.re\"",
          "730: #line 731 \"ext/standard/var_unserializer.c\"",
          "734:   goto yy30;",
          "741: #line 673 \"ext/standard/var_unserializer.re\"",
          "742:  {",
          "744:  ZVAL_NULL(rval);",
          "745:  return 1;",
          "746: }",
          "747: #line 748 \"ext/standard/var_unserializer.c\"",
          "748: yy21:",
          "749:  yych = *++YYCURSOR;",
          "750:  if (yych <= '/') goto yy18;",
          "751:  if (yych <= '9') goto yy32;",
          "752:  goto yy18;",
          "753: yy22:",
          "754:  yych = *++YYCURSOR;",
          "755:  if (yych <= '/') goto yy18;",
          "756:  if (yych <= '9') goto yy34;",
          "757:  goto yy18;",
          "758: yy23:",
          "759:  yych = *++YYCURSOR;",
          "760:  if (yych <= '/') goto yy18;",
          "761:  if (yych <= '9') goto yy36;",
          "762:  goto yy18;",
          "763: yy24:",
          "764:  yych = *++YYCURSOR;",
          "766:  if (yych <= '1') goto yy38;",
          "767:  goto yy18;",
          "768: yy25:",
          "770:  if (yych <= '/') {",
          "771:   if (yych <= ',') {",
          "772:    if (yych == '+') goto yy39;",
          "773:    goto yy18;",
          "774:   } else {",
          "775:    if (yych <= '-') goto yy40;",
          "776:    if (yych <= '.') goto yy41;",
          "777:    goto yy18;",
          "779:  } else {",
          "780:   if (yych <= 'I') {",
          "781:    if (yych <= '9') goto yy42;",
          "782:    if (yych <= 'H') goto yy18;",
          "783:    goto yy44;",
          "784:   } else {",
          "785:    if (yych == 'N') goto yy45;",
          "786:    goto yy18;",
          "789: yy26:",
          "790:  yych = *++YYCURSOR;",
          "791:  if (yych <= ',') {",
          "792:   if (yych == '+') goto yy46;",
          "793:   goto yy18;",
          "794:  } else {",
          "795:   if (yych <= '-') goto yy46;",
          "796:   if (yych <= '/') goto yy18;",
          "797:   if (yych <= '9') goto yy47;",
          "798:   goto yy18;",
          "800: yy27:",
          "801:  yych = *++YYCURSOR;",
          "802:  if (yych <= '/') goto yy18;",
          "803:  if (yych <= '9') goto yy49;",
          "804:  goto yy18;",
          "805: yy28:",
          "806:  yych = *++YYCURSOR;",
          "807:  if (yych <= '/') goto yy18;",
          "808:  if (yych <= '9') goto yy51;",
          "809:  goto yy18;",
          "810: yy29:",
          "813:  if (yych <= '9') goto yy53;",
          "814:  goto yy18;",
          "815: yy30:",
          "819:  if (yybm[0+yych] & 128) {",
          "820:   goto yy30;",
          "821:  }",
          "822:  if (yych <= '/') goto yy18;",
          "823:  if (yych <= ':') goto yy55;",
          "824:  goto yy18;",
          "825: yy32:",
          "826:  ++YYCURSOR;",
          "827:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "828:  yych = *YYCURSOR;",
          "830:  if (yych <= '9') goto yy32;",
          "831:  if (yych == ';') goto yy56;",
          "832:  goto yy18;",
          "833: yy34:",
          "835:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "836:  yych = *YYCURSOR;",
          "838:  if (yych <= '9') goto yy34;",
          "839:  if (yych <= ':') goto yy58;",
          "840:  goto yy18;",
          "841: yy36:",
          "846:  if (yych <= '9') goto yy36;",
          "847:  if (yych <= ':') goto yy59;",
          "848:  goto yy18;",
          "849: yy38:",
          "850:  yych = *++YYCURSOR;",
          "851:  if (yych == ';') goto yy60;",
          "852:  goto yy18;",
          "853: yy39:",
          "854:  yych = *++YYCURSOR;",
          "855:  if (yych == '.') goto yy41;",
          "856:  if (yych <= '/') goto yy18;",
          "857:  if (yych <= '9') goto yy42;",
          "858:  goto yy18;",
          "859: yy40:",
          "860:  yych = *++YYCURSOR;",
          "861:  if (yych <= '/') {",
          "862:   if (yych != '.') goto yy18;",
          "863:  } else {",
          "864:   if (yych <= '9') goto yy42;",
          "865:   if (yych == 'I') goto yy44;",
          "866:   goto yy18;",
          "867:  }",
          "868: yy41:",
          "870:  if (yych <= '/') goto yy18;",
          "871:  if (yych <= '9') goto yy62;",
          "872:  goto yy18;",
          "873: yy42:",
          "875:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "876:  yych = *YYCURSOR;",
          "877:  if (yych <= ':') {",
          "878:   if (yych <= '.') {",
          "879:    if (yych <= '-') goto yy18;",
          "880:    goto yy62;",
          "881:   } else {",
          "882:    if (yych <= '/') goto yy18;",
          "883:    if (yych <= '9') goto yy42;",
          "884:    goto yy18;",
          "885:   }",
          "886:  } else {",
          "887:   if (yych <= 'E') {",
          "888:    if (yych <= ';') goto yy64;",
          "889:    if (yych <= 'D') goto yy18;",
          "890:    goto yy66;",
          "891:   } else {",
          "892:    if (yych == 'e') goto yy66;",
          "893:    goto yy18;",
          "894:   }",
          "896: yy44:",
          "897:  yych = *++YYCURSOR;",
          "898:  if (yych == 'N') goto yy67;",
          "899:  goto yy18;",
          "900: yy45:",
          "901:  yych = *++YYCURSOR;",
          "902:  if (yych == 'A') goto yy68;",
          "903:  goto yy18;",
          "904: yy46:",
          "908: yy47:",
          "909:  ++YYCURSOR;",
          "910:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "911:  yych = *YYCURSOR;",
          "912:  if (yych <= '/') goto yy18;",
          "913:  if (yych <= '9') goto yy47;",
          "914:  if (yych == ';') goto yy69;",
          "915:  goto yy18;",
          "916: yy49:",
          "921:  if (yych <= '9') goto yy49;",
          "922:  if (yych <= ':') goto yy71;",
          "923:  goto yy18;",
          "924: yy51:",
          "926:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "927:  yych = *YYCURSOR;",
          "929:  if (yych <= '9') goto yy51;",
          "930:  if (yych == ';') goto yy72;",
          "931:  goto yy18;",
          "932: yy53:",
          "937:  if (yych <= '9') goto yy53;",
          "938:  if (yych <= ':') goto yy74;",
          "939:  goto yy18;",
          "940: yy55:",
          "942:  if (yych == '\"') goto yy75;",
          "943:  goto yy18;",
          "944: yy56:",
          "946: #line 622 \"ext/standard/var_unserializer.re\"",
          "948:  zend_long id;",
          "951:  if (!var_hash) return 0;",
          "953:  id = parse_uiv(start + 2) - 1;",
          "954:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "958:  zval_ptr_dtor(rval);",
          "959:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "960:   ZVAL_UNDEF(rval);",
          "961:   return 1;",
          "963:  if (Z_ISREF_P(rval_ref)) {",
          "964:   ZVAL_COPY(rval, rval_ref);",
          "966:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "967:   ZVAL_COPY(rval, rval_ref);",
          "972: #line 973 \"ext/standard/var_unserializer.c\"",
          "973: yy58:",
          "975:  if (yych == '\"') goto yy77;",
          "977: yy59:",
          "979:  if (yych == '{') goto yy79;",
          "981: yy60:",
          "983: #line 679 \"ext/standard/var_unserializer.re\"",
          "984:  {",
          "986:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "987:  return 1;",
          "988: }",
          "989: #line 990 \"ext/standard/var_unserializer.c\"",
          "990: yy62:",
          "996:   if (yych <= '9') goto yy62;",
          "1001:    goto yy66;",
          "1003:    if (yych == 'e') goto yy66;",
          "1007: yy64:",
          "",
          "[Added Lines]",
          "659:  case 'O': goto yy13;",
          "661:  case 'R': goto yy2;",
          "662:  case 'S': goto yy10;",
          "663:  case 'a': goto yy11;",
          "664:  case 'b': goto yy6;",
          "665:  case 'd': goto yy8;",
          "666:  case 'i': goto yy7;",
          "668:  case 'r': goto yy4;",
          "669:  case 's': goto yy9;",
          "670:  case '}': goto yy14;",
          "671:  default: goto yy16;",
          "674:  yych = *(YYMARKER = ++YYCURSOR);",
          "675:  if (yych == ':') goto yy88;",
          "677: #line 1007 \"ext/standard/var_unserializer.re\"",
          "679: #line 680 \"ext/standard/var_unserializer.c\"",
          "682:  if (yych == ':') goto yy83;",
          "686:  if (yych == ';') goto yy81;",
          "690:  if (yych == ':') goto yy77;",
          "694:  if (yych == ':') goto yy71;",
          "698:  if (yych == ':') goto yy48;",
          "702:  if (yych == ':') goto yy42;",
          "706:  if (yych == ':') goto yy36;",
          "710:  if (yych == ':') goto yy30;",
          "714:  if (yych == ':') goto yy24;",
          "718:  if (yych == ':') goto yy17;",
          "722: #line 1001 \"ext/standard/var_unserializer.re\"",
          "728: #line 729 \"ext/standard/var_unserializer.c\"",
          "729: yy16:",
          "730:  yych = *++YYCURSOR;",
          "731:  goto yy3;",
          "735:   goto yy19;",
          "742:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "743:  yych = *YYCURSOR;",
          "744:  if (yybm[0+yych] & 128) {",
          "745:   goto yy19;",
          "746:  }",
          "748:  if (yych >= ';') goto yy18;",
          "750:  if (yych != '\"') goto yy18;",
          "751:  ++YYCURSOR;",
          "752: #line 849 \"ext/standard/var_unserializer.re\"",
          "753:  {",
          "754:  size_t len, len2, len3, maxlen;",
          "755:  zend_long elements;",
          "756:  char *str;",
          "757:  zend_string *class_name;",
          "758:  zend_class_entry *ce;",
          "759:  int incomplete_class = 0;",
          "761:  int custom_object = 0;",
          "763:  zval user_func;",
          "764:  zval retval;",
          "765:  zval args[1];",
          "767:     if (!var_hash) return 0;",
          "768:  if (*start == 'C') {",
          "769:   custom_object = 1;",
          "770:  }",
          "772:  len2 = len = parse_uiv(start + 2);",
          "773:  maxlen = max - YYCURSOR;",
          "774:  if (maxlen < len || len == 0) {",
          "776:   return 0;",
          "777:  }",
          "779:  str = (char*)YYCURSOR;",
          "781:  YYCURSOR += len;",
          "783:  if (*(YYCURSOR) != '\"') {",
          "785:   return 0;",
          "786:  }",
          "787:  if (*(YYCURSOR+1) != ':') {",
          "789:   return 0;",
          "790:  }",
          "792:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "793:  if (len3 != len)",
          "794:  {",
          "796:   return 0;",
          "797:  }",
          "799:  class_name = zend_string_init(str, len, 0);",
          "801:  do {",
          "802:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "803:    incomplete_class = 1;",
          "804:    ce = PHP_IC_ENTRY;",
          "805:    break;",
          "809:   BG(serialize_lock)++;",
          "810:   ce = zend_lookup_class(class_name);",
          "811:   if (ce) {",
          "812:    BG(serialize_lock)--;",
          "813:    if (EG(exception)) {",
          "814:     zend_string_release(class_name);",
          "815:     return 0;",
          "816:    }",
          "817:    break;",
          "818:   }",
          "819:   BG(serialize_lock)--;",
          "821:   if (EG(exception)) {",
          "822:    zend_string_release(class_name);",
          "823:    return 0;",
          "824:   }",
          "827:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "828:    incomplete_class = 1;",
          "829:    ce = PHP_IC_ENTRY;",
          "830:    break;",
          "831:   }",
          "834:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "836:   ZVAL_STR_COPY(&args[0], class_name);",
          "837:   BG(serialize_lock)++;",
          "838:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "839:    BG(serialize_lock)--;",
          "840:    if (EG(exception)) {",
          "841:     zend_string_release(class_name);",
          "842:     zval_ptr_dtor(&user_func);",
          "843:     zval_ptr_dtor(&args[0]);",
          "844:     return 0;",
          "845:    }",
          "846:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "847:    incomplete_class = 1;",
          "848:    ce = PHP_IC_ENTRY;",
          "849:    zval_ptr_dtor(&user_func);",
          "850:    zval_ptr_dtor(&args[0]);",
          "851:    break;",
          "852:   }",
          "853:   BG(serialize_lock)--;",
          "854:   zval_ptr_dtor(&retval);",
          "855:   if (EG(exception)) {",
          "856:    zend_string_release(class_name);",
          "857:    zval_ptr_dtor(&user_func);",
          "858:    zval_ptr_dtor(&args[0]);",
          "859:    return 0;",
          "860:   }",
          "863:   BG(serialize_lock)++;",
          "864:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "865:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "866:    incomplete_class = 1;",
          "867:    ce = PHP_IC_ENTRY;",
          "868:   }",
          "869:   BG(serialize_lock)--;",
          "871:   zval_ptr_dtor(&user_func);",
          "872:   zval_ptr_dtor(&args[0]);",
          "873:   break;",
          "874:  } while (1);",
          "878:  if (custom_object) {",
          "879:   int ret;",
          "881:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "883:   if (ret && incomplete_class) {",
          "884:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "886:   zend_string_release(class_name);",
          "887:   return ret;",
          "890:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "892:  if (elements < 0) {",
          "893:     zend_string_release(class_name);",
          "894:     return 0;",
          "897:  if (incomplete_class) {",
          "898:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "899:  }",
          "900:  zend_string_release(class_name);",
          "902:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "903: }",
          "904: #line 905 \"ext/standard/var_unserializer.c\"",
          "905: yy24:",
          "908:  if (yych >= ':') goto yy18;",
          "909: yy25:",
          "914:  if (yych <= '9') goto yy25;",
          "915:  if (yych >= ';') goto yy18;",
          "916:  yych = *++YYCURSOR;",
          "917:  if (yych != '\"') goto yy18;",
          "919: #line 838 \"ext/standard/var_unserializer.re\"",
          "920:  {",
          "921:  long elements;",
          "922:     if (!var_hash) return 0;",
          "924:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "925:  if (elements < 0) {",
          "926:   return 0;",
          "927:  }",
          "928:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "929: }",
          "930: #line 931 \"ext/standard/var_unserializer.c\"",
          "931: yy30:",
          "932:  yych = *++YYCURSOR;",
          "934:  if (yych >= ':') goto yy18;",
          "935: yy31:",
          "940:  if (yych <= '9') goto yy31;",
          "941:  if (yych >= ';') goto yy18;",
          "943:  if (yych != '{') goto yy18;",
          "945: #line 808 \"ext/standard/var_unserializer.re\"",
          "946:  {",
          "947:  zend_long elements = parse_iv(start + 2);",
          "950:     if (!var_hash) return 0;",
          "952:  if (elements < 0) {",
          "953:   return 0;",
          "956:  array_init_size(rval, elements);",
          "957:  if (elements) {",
          "960:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "961:  }",
          "967:  HT_ALLOW_COW_VIOLATION(Z_ARRVAL_P(rval));",
          "969:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "970:   return 0;",
          "971:  }",
          "973:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "974: }",
          "975: #line 976 \"ext/standard/var_unserializer.c\"",
          "976: yy36:",
          "980: yy37:",
          "985:  if (yych <= '9') goto yy37;",
          "986:  if (yych >= ';') goto yy18;",
          "987:  yych = *++YYCURSOR;",
          "988:  if (yych != '\"') goto yy18;",
          "990: #line 774 \"ext/standard/var_unserializer.re\"",
          "991:  {",
          "992:  size_t len, maxlen;",
          "993:  zend_string *str;",
          "995:  len = parse_uiv(start + 2);",
          "996:  maxlen = max - YYCURSOR;",
          "997:  if (maxlen < len) {",
          "999:   return 0;",
          "1000:  }",
          "1002:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1003:   return 0;",
          "1004:  }",
          "1006:  if (*(YYCURSOR) != '\"') {",
          "1007:   zend_string_free(str);",
          "1009:   return 0;",
          "1010:  }",
          "1012:  if (*(YYCURSOR + 1) != ';') {",
          "1013:   efree(str);",
          "1015:   return 0;",
          "1016:  }",
          "1018:  YYCURSOR += 2;",
          "1021:  ZVAL_STR(rval, str);",
          "1022:  return 1;",
          "1023: }",
          "1024: #line 1025 \"ext/standard/var_unserializer.c\"",
          "1025: yy42:",
          "1026:  yych = *++YYCURSOR;",
          "1028:  if (yych >= ':') goto yy18;",
          "1029: yy43:",
          "1034:  if (yych <= '9') goto yy43;",
          "1035:  if (yych >= ';') goto yy18;",
          "1037:  if (yych != '\"') goto yy18;",
          "1039: #line 736 \"ext/standard/var_unserializer.re\"",
          "1041:  size_t len, maxlen;",
          "1042:  char *str;",
          "1044:  len = parse_uiv(start + 2);",
          "1045:  maxlen = max - YYCURSOR;",
          "1046:  if (maxlen < len) {",
          "1048:   return 0;",
          "1049:  }",
          "1051:  str = (char*)YYCURSOR;",
          "1053:  YYCURSOR += len;",
          "1055:  if (*(YYCURSOR) != '\"') {",
          "1060:  if (*(YYCURSOR + 1) != ';') {",
          "1062:   return 0;",
          "1065:  YYCURSOR += 2;",
          "1068:  if (len == 0) {",
          "1069:   ZVAL_EMPTY_STRING(rval);",
          "1070:  } else if (len == 1) {",
          "1071:   ZVAL_INTERNED_STR(rval, ZSTR_CHAR((zend_uchar)*str));",
          "1073:   ZVAL_STRINGL(rval, str, len);",
          "1077: #line 1078 \"ext/standard/var_unserializer.c\"",
          "1078: yy48:",
          "1079:  yych = *++YYCURSOR;",
          "1080:  if (yych <= '/') {",
          "1081:   if (yych <= ',') {",
          "1082:    if (yych == '+') goto yy52;",
          "1083:    goto yy18;",
          "1084:   } else {",
          "1085:    if (yych <= '-') goto yy50;",
          "1086:    if (yych <= '.') goto yy55;",
          "1087:    goto yy18;",
          "1088:   }",
          "1089:  } else {",
          "1090:   if (yych <= 'I') {",
          "1091:    if (yych <= '9') goto yy53;",
          "1092:    if (yych <= 'H') goto yy18;",
          "1093:    goto yy51;",
          "1094:   } else {",
          "1095:    if (yych != 'N') goto yy18;",
          "1096:   }",
          "1097:  }",
          "1099:  if (yych == 'A') goto yy70;",
          "1101: yy50:",
          "1102:  yych = *++YYCURSOR;",
          "1103:  if (yych <= '/') {",
          "1104:   if (yych == '.') goto yy55;",
          "1105:   goto yy18;",
          "1106:  } else {",
          "1107:   if (yych <= '9') goto yy53;",
          "1108:   if (yych != 'I') goto yy18;",
          "1109:  }",
          "1110: yy51:",
          "1112:  if (yych == 'N') goto yy66;",
          "1114: yy52:",
          "1115:  yych = *++YYCURSOR;",
          "1116:  if (yych == '.') goto yy55;",
          "1117:  if (yych <= '/') goto yy18;",
          "1118:  if (yych >= ':') goto yy18;",
          "1119: yy53:",
          "1121:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "1122:  yych = *YYCURSOR;",
          "1123:  if (yych <= ':') {",
          "1124:   if (yych <= '.') {",
          "1125:    if (yych <= '-') goto yy18;",
          "1126:    goto yy64;",
          "1127:   } else {",
          "1128:    if (yych <= '/') goto yy18;",
          "1129:    if (yych <= '9') goto yy53;",
          "1130:    goto yy18;",
          "1131:   }",
          "1132:  } else {",
          "1133:   if (yych <= 'E') {",
          "1134:    if (yych <= ';') goto yy58;",
          "1135:    if (yych <= 'D') goto yy18;",
          "1136:    goto yy60;",
          "1137:   } else {",
          "1138:    if (yych == 'e') goto yy60;",
          "1139:    goto yy18;",
          "1140:   }",
          "1141:  }",
          "1142: yy55:",
          "1143:  yych = *++YYCURSOR;",
          "1144:  if (yych <= '/') goto yy18;",
          "1145:  if (yych >= ':') goto yy18;",
          "1146: yy56:",
          "1152:   if (yych <= '9') goto yy56;",
          "1157:    goto yy60;",
          "1159:    if (yych == 'e') goto yy60;",
          "1163: yy58:",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1015:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1016:  return 1;",
          "1017: }",
          "1020:  yych = *++YYCURSOR;",
          "1021:  if (yych <= ',') {",
          "1024:  } else {",
          "1026:   if (yych <= '/') goto yy18;",
          "1028:   goto yy18;",
          "1029:  }",
          "1031:  yych = *++YYCURSOR;",
          "1033:  goto yy18;",
          "1035:  yych = *++YYCURSOR;",
          "1037:  goto yy18;",
          "1039:  ++YYCURSOR;",
          "1040: #line 685 \"ext/standard/var_unserializer.re\"",
          "1041:  {",
          "",
          "[Removed Lines]",
          "1018: #line 1019 \"ext/standard/var_unserializer.c\"",
          "1019: yy66:",
          "1022:   if (yych == '+') goto yy81;",
          "1023:   goto yy18;",
          "1025:   if (yych <= '-') goto yy81;",
          "1027:   if (yych <= '9') goto yy82;",
          "1030: yy67:",
          "1032:  if (yych == 'F') goto yy84;",
          "1034: yy68:",
          "1036:  if (yych == 'N') goto yy84;",
          "1038: yy69:",
          "",
          "[Added Lines]",
          "1174: #line 1175 \"ext/standard/var_unserializer.c\"",
          "1175: yy60:",
          "1178:   if (yych != '+') goto yy18;",
          "1180:   if (yych <= '-') goto yy61;",
          "1182:   if (yych <= '9') goto yy62;",
          "1185: yy61:",
          "1187:  if (yych <= '/') goto yy18;",
          "1188:  if (yych >= ':') goto yy18;",
          "1189: yy62:",
          "1190:  ++YYCURSOR;",
          "1191:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1192:  yych = *YYCURSOR;",
          "1193:  if (yych <= '/') goto yy18;",
          "1194:  if (yych <= '9') goto yy62;",
          "1195:  if (yych == ';') goto yy58;",
          "1197: yy64:",
          "1198:  ++YYCURSOR;",
          "1199:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "1200:  yych = *YYCURSOR;",
          "1201:  if (yych <= ';') {",
          "1202:   if (yych <= '/') goto yy18;",
          "1203:   if (yych <= '9') goto yy64;",
          "1204:   if (yych <= ':') goto yy18;",
          "1205:   goto yy58;",
          "1206:  } else {",
          "1207:   if (yych <= 'E') {",
          "1208:    if (yych <= 'D') goto yy18;",
          "1209:    goto yy60;",
          "1210:   } else {",
          "1211:    if (yych == 'e') goto yy60;",
          "1212:    goto yy18;",
          "1213:   }",
          "1214:  }",
          "1215: yy66:",
          "1216:  yych = *++YYCURSOR;",
          "1217:  if (yych != 'F') goto yy18;",
          "1218: yy67:",
          "1219:  yych = *++YYCURSOR;",
          "1220:  if (yych != ';') goto yy18;",
          "1221:  ++YYCURSOR;",
          "1222: #line 711 \"ext/standard/var_unserializer.re\"",
          "1223:  {",
          "1226:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1227:   ZVAL_DOUBLE(rval, ZEND_NAN);",
          "1228:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1229:   ZVAL_DOUBLE(rval, ZEND_INFINITY);",
          "1230:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1231:   ZVAL_DOUBLE(rval, -ZEND_INFINITY);",
          "1232:  } else {",
          "1233:   ZVAL_NULL(rval);",
          "1234:  }",
          "1236:  return 1;",
          "1237: }",
          "1238: #line 1239 \"ext/standard/var_unserializer.c\"",
          "1239: yy70:",
          "1241:  if (yych == 'N') goto yy67;",
          "1243: yy71:",
          "1244:  yych = *++YYCURSOR;",
          "1245:  if (yych <= ',') {",
          "1246:   if (yych != '+') goto yy18;",
          "1247:  } else {",
          "1248:   if (yych <= '-') goto yy72;",
          "1249:   if (yych <= '/') goto yy18;",
          "1250:   if (yych <= '9') goto yy73;",
          "1251:   goto yy18;",
          "1252:  }",
          "1253: yy72:",
          "1254:  yych = *++YYCURSOR;",
          "1255:  if (yych <= '/') goto yy18;",
          "1256:  if (yych >= ':') goto yy18;",
          "1257: yy73:",
          "1258:  ++YYCURSOR;",
          "1259:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1260:  yych = *YYCURSOR;",
          "1261:  if (yych <= '/') goto yy18;",
          "1262:  if (yych <= '9') goto yy73;",
          "1263:  if (yych != ';') goto yy18;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1063:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1064:  return 1;",
          "1065: }",
          "1068:  yych = *++YYCURSOR;",
          "1072:  ++YYCURSOR;",
          "1073: #line 648 \"ext/standard/var_unserializer.re\"",
          "1074:  {",
          "",
          "[Removed Lines]",
          "1066: #line 1067 \"ext/standard/var_unserializer.c\"",
          "1067: yy71:",
          "1069:  if (yych == '\"') goto yy85;",
          "1070:  goto yy18;",
          "1071: yy72:",
          "",
          "[Added Lines]",
          "1291: #line 1292 \"ext/standard/var_unserializer.c\"",
          "1292: yy77:",
          "1294:  if (yych <= '/') goto yy18;",
          "1295:  if (yych >= '2') goto yy18;",
          "1296:  yych = *++YYCURSOR;",
          "1297:  if (yych != ';') goto yy18;",
          "1298:  ++YYCURSOR;",
          "1299: #line 679 \"ext/standard/var_unserializer.re\"",
          "1300:  {",
          "1302:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1303:  return 1;",
          "1304: }",
          "1305: #line 1306 \"ext/standard/var_unserializer.c\"",
          "1306: yy81:",
          "1307:  ++YYCURSOR;",
          "1308: #line 673 \"ext/standard/var_unserializer.re\"",
          "1309:  {",
          "1311:  ZVAL_NULL(rval);",
          "1312:  return 1;",
          "1313: }",
          "1314: #line 1315 \"ext/standard/var_unserializer.c\"",
          "1315: yy83:",
          "1316:  yych = *++YYCURSOR;",
          "1317:  if (yych <= '/') goto yy18;",
          "1318:  if (yych >= ':') goto yy18;",
          "1319: yy84:",
          "1320:  ++YYCURSOR;",
          "1321:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1322:  yych = *YYCURSOR;",
          "1323:  if (yych <= '/') goto yy18;",
          "1324:  if (yych <= '9') goto yy84;",
          "1325:  if (yych != ';') goto yy18;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1096:  return 1;",
          "1097: }",
          "1329:  yych = *++YYCURSOR;",
          "1330:  if (yych <= '/') goto yy18;",
          "1331:  if (yych >= ':') goto yy18;",
          "1333:  ++YYCURSOR;",
          "1334:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1335:  yych = *YYCURSOR;",
          "1336:  if (yych <= '/') goto yy18;",
          "1345:  ++YYCURSOR;",
          "1361:  {",
          "1378:   return 0;",
          "1379:  }",
          "1384:  }",
          "1405:  } else {",
          "1407:  }",
          "1409:  return 1;",
          "1410: }",
          "1412: }",
          "1416:  return 0;",
          "",
          "[Removed Lines]",
          "1098: #line 1099 \"ext/standard/var_unserializer.c\"",
          "1099: yy74:",
          "1100:  yych = *++YYCURSOR;",
          "1101:  if (yych == '\"') goto yy87;",
          "1102:  goto yy18;",
          "1103: yy75:",
          "1104:  ++YYCURSOR;",
          "1105: #line 843 \"ext/standard/var_unserializer.re\"",
          "1106:  {",
          "1107:  size_t len, len2, len3, maxlen;",
          "1108:  zend_long elements;",
          "1109:  char *str;",
          "1110:  zend_string *class_name;",
          "1111:  zend_class_entry *ce;",
          "1112:  int incomplete_class = 0;",
          "1114:  int custom_object = 0;",
          "1116:  zval user_func;",
          "1117:  zval retval;",
          "1118:  zval args[1];",
          "1120:     if (!var_hash) return 0;",
          "1121:  if (*start == 'C') {",
          "1122:   custom_object = 1;",
          "1123:  }",
          "1125:  len2 = len = parse_uiv(start + 2);",
          "1126:  maxlen = max - YYCURSOR;",
          "1127:  if (maxlen < len || len == 0) {",
          "1129:   return 0;",
          "1130:  }",
          "1132:  str = (char*)YYCURSOR;",
          "1134:  YYCURSOR += len;",
          "1136:  if (*(YYCURSOR) != '\"') {",
          "1138:   return 0;",
          "1139:  }",
          "1140:  if (*(YYCURSOR+1) != ':') {",
          "1142:   return 0;",
          "1143:  }",
          "1145:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1146:  if (len3 != len)",
          "1147:  {",
          "1149:   return 0;",
          "1150:  }",
          "1152:  class_name = zend_string_init(str, len, 0);",
          "1154:  do {",
          "1155:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "1156:    incomplete_class = 1;",
          "1157:    ce = PHP_IC_ENTRY;",
          "1158:    break;",
          "1159:   }",
          "1162:   BG(serialize_lock)++;",
          "1163:   ce = zend_lookup_class(class_name);",
          "1164:   if (ce) {",
          "1165:    BG(serialize_lock)--;",
          "1166:    if (EG(exception)) {",
          "1167:     zend_string_release(class_name);",
          "1168:     return 0;",
          "1169:    }",
          "1170:    break;",
          "1171:   }",
          "1172:   BG(serialize_lock)--;",
          "1174:   if (EG(exception)) {",
          "1175:    zend_string_release(class_name);",
          "1176:    return 0;",
          "1177:   }",
          "1180:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1181:    incomplete_class = 1;",
          "1182:    ce = PHP_IC_ENTRY;",
          "1183:    break;",
          "1184:   }",
          "1187:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1189:   ZVAL_STR_COPY(&args[0], class_name);",
          "1190:   BG(serialize_lock)++;",
          "1191:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1192:    BG(serialize_lock)--;",
          "1193:    if (EG(exception)) {",
          "1194:     zend_string_release(class_name);",
          "1195:     zval_ptr_dtor(&user_func);",
          "1196:     zval_ptr_dtor(&args[0]);",
          "1197:     return 0;",
          "1198:    }",
          "1199:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1200:    incomplete_class = 1;",
          "1201:    ce = PHP_IC_ENTRY;",
          "1202:    zval_ptr_dtor(&user_func);",
          "1203:    zval_ptr_dtor(&args[0]);",
          "1204:    break;",
          "1205:   }",
          "1206:   BG(serialize_lock)--;",
          "1207:   zval_ptr_dtor(&retval);",
          "1208:   if (EG(exception)) {",
          "1209:    zend_string_release(class_name);",
          "1210:    zval_ptr_dtor(&user_func);",
          "1211:    zval_ptr_dtor(&args[0]);",
          "1212:    return 0;",
          "1213:   }",
          "1216:   BG(serialize_lock)++;",
          "1217:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1218:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1219:    incomplete_class = 1;",
          "1220:    ce = PHP_IC_ENTRY;",
          "1221:   }",
          "1222:   BG(serialize_lock)--;",
          "1224:   zval_ptr_dtor(&user_func);",
          "1225:   zval_ptr_dtor(&args[0]);",
          "1226:   break;",
          "1227:  } while (1);",
          "1231:  if (custom_object) {",
          "1232:   int ret;",
          "1234:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1236:   if (ret && incomplete_class) {",
          "1237:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1238:   }",
          "1239:   zend_string_release(class_name);",
          "1240:   return ret;",
          "1241:  }",
          "1243:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1245:  if (elements < 0) {",
          "1246:     zend_string_release(class_name);",
          "1247:     return 0;",
          "1248:  }",
          "1250:  if (incomplete_class) {",
          "1251:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1252:  }",
          "1253:  zend_string_release(class_name);",
          "1255:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1256: }",
          "1257: #line 1258 \"ext/standard/var_unserializer.c\"",
          "1258: yy77:",
          "1259:  ++YYCURSOR;",
          "1260: #line 768 \"ext/standard/var_unserializer.re\"",
          "1261:  {",
          "1262:  size_t len, maxlen;",
          "1263:  zend_string *str;",
          "1265:  len = parse_uiv(start + 2);",
          "1266:  maxlen = max - YYCURSOR;",
          "1267:  if (maxlen < len) {",
          "1269:   return 0;",
          "1270:  }",
          "1272:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1273:   return 0;",
          "1274:  }",
          "1276:  if (*(YYCURSOR) != '\"') {",
          "1277:   zend_string_free(str);",
          "1279:   return 0;",
          "1280:  }",
          "1282:  if (*(YYCURSOR + 1) != ';') {",
          "1283:   efree(str);",
          "1285:   return 0;",
          "1286:  }",
          "1288:  YYCURSOR += 2;",
          "1291:  ZVAL_STR(rval, str);",
          "1292:  return 1;",
          "1293: }",
          "1294: #line 1295 \"ext/standard/var_unserializer.c\"",
          "1295: yy79:",
          "1296:  ++YYCURSOR;",
          "1297: #line 802 \"ext/standard/var_unserializer.re\"",
          "1298:  {",
          "1299:  zend_long elements = parse_iv(start + 2);",
          "1302:     if (!var_hash) return 0;",
          "1304:  if (elements < 0) {",
          "1305:   return 0;",
          "1306:  }",
          "1308:  array_init_size(rval, elements);",
          "1309:  if (elements) {",
          "1312:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1313:  }",
          "1319:  HT_ALLOW_COW_VIOLATION(Z_ARRVAL_P(rval));",
          "1321:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1322:   return 0;",
          "1323:  }",
          "1325:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1326: }",
          "1327: #line 1328 \"ext/standard/var_unserializer.c\"",
          "1328: yy81:",
          "1332: yy82:",
          "1337:  if (yych <= '9') goto yy82;",
          "1338:  if (yych == ';') goto yy64;",
          "1339:  goto yy18;",
          "1340: yy84:",
          "1341:  yych = *++YYCURSOR;",
          "1342:  if (yych == ';') goto yy89;",
          "1343:  goto yy18;",
          "1344: yy85:",
          "1346: #line 832 \"ext/standard/var_unserializer.re\"",
          "1347:  {",
          "1348:  long elements;",
          "1349:     if (!var_hash) return 0;",
          "1351:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1352:  if (elements < 0) {",
          "1353:   return 0;",
          "1354:  }",
          "1355:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1356: }",
          "1357: #line 1358 \"ext/standard/var_unserializer.c\"",
          "1358: yy87:",
          "1359:  ++YYCURSOR;",
          "1360: #line 736 \"ext/standard/var_unserializer.re\"",
          "1362:  size_t len, maxlen;",
          "1363:  char *str;",
          "1365:  len = parse_uiv(start + 2);",
          "1366:  maxlen = max - YYCURSOR;",
          "1367:  if (maxlen < len) {",
          "1369:   return 0;",
          "1370:  }",
          "1372:  str = (char*)YYCURSOR;",
          "1374:  YYCURSOR += len;",
          "1376:  if (*(YYCURSOR) != '\"') {",
          "1381:  if (*(YYCURSOR + 1) != ';') {",
          "1383:   return 0;",
          "1386:  YYCURSOR += 2;",
          "1389:  ZVAL_STRINGL(rval, str, len);",
          "1390:  return 1;",
          "1391: }",
          "1392: #line 1393 \"ext/standard/var_unserializer.c\"",
          "1393: yy89:",
          "1394:  ++YYCURSOR;",
          "1395: #line 711 \"ext/standard/var_unserializer.re\"",
          "1396:  {",
          "1399:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1400:   ZVAL_DOUBLE(rval, ZEND_NAN);",
          "1401:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1402:   ZVAL_DOUBLE(rval, ZEND_INFINITY);",
          "1403:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1404:   ZVAL_DOUBLE(rval, -ZEND_INFINITY);",
          "1406:   ZVAL_NULL(rval);",
          "1411: #line 1412 \"ext/standard/var_unserializer.c\"",
          "1413: #line 1003 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1352: #line 1353 \"ext/standard/var_unserializer.c\"",
          "1353: yy88:",
          "1357: yy89:",
          "1362:  if (yych <= '9') goto yy89;",
          "1363:  if (yych != ';') goto yy18;",
          "1365: #line 622 \"ext/standard/var_unserializer.re\"",
          "1367:  zend_long id;",
          "1370:  if (!var_hash) return 0;",
          "1372:  id = parse_uiv(start + 2) - 1;",
          "1373:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1377:  zval_ptr_dtor(rval);",
          "1378:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1379:   ZVAL_UNDEF(rval);",
          "1380:   return 1;",
          "1382:  if (Z_ISREF_P(rval_ref)) {",
          "1383:   ZVAL_COPY(rval, rval_ref);",
          "1385:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1386:   ZVAL_COPY(rval, rval_ref);",
          "1391: #line 1392 \"ext/standard/var_unserializer.c\"",
          "1393: #line 1009 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "761:  YYCURSOR += 2;",
          "765:  return 1;",
          "766: }",
          "",
          "[Removed Lines]",
          "764:  ZVAL_STRINGL(rval, str, len);",
          "",
          "[Added Lines]",
          "764:  if (len == 0) {",
          "765:   ZVAL_EMPTY_STRING(rval);",
          "766:  } else if (len == 1) {",
          "767:   ZVAL_INTERNED_STR(rval, ZSTR_CHAR((zend_uchar)*str));",
          "768:  } else {",
          "769:   ZVAL_STRINGL(rval, str, len);",
          "770:  }",
          "",
          "---------------"
        ],
        "main/php_variables.c||main/php_variables.c": [
          "File: main/php_variables.c -> main/php_variables.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:  assert(strval != NULL);",
          "53:  php_register_variable_ex(var, &new_entry, track_vars_array);",
          "54: }",
          "",
          "[Removed Lines]",
          "52:  ZVAL_NEW_STR(&new_entry, zend_string_init(strval, str_len, 0));",
          "",
          "[Added Lines]",
          "52:  if (str_len == 0) {",
          "53:   ZVAL_EMPTY_STRING(&new_entry);",
          "54:  } else if (str_len == 1) {",
          "55:   ZVAL_INTERNED_STR(&new_entry, ZSTR_CHAR((zend_uchar)*strval));",
          "56:  } else {",
          "57:   ZVAL_NEW_STR(&new_entry, zend_string_init(strval, str_len, 0));",
          "58:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7e042224a26282938b866a49ca3d4af1b368c0cc",
      "candidate_info": {
        "commit_hash": "7e042224a26282938b866a49ca3d4af1b368c0cc",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/7e042224a26282938b866a49ca3d4af1b368c0cc",
        "files": [
          "NEWS",
          "ext/standard/tests/serialize/bug71940.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #71940 (Unserialize crushes on restore object reference)",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug71940.phpt||ext/standard/tests/serialize/bug71940.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug71940.phpt||ext/standard/tests/serialize/bug71940.phpt": [
          "File: ext/standard/tests/serialize/bug71940.phpt -> ext/standard/tests/serialize/bug71940.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #71940 (Unserialize crushes on restore object reference)",
          "3: --FILE--",
          "4: <?php",
          "6: class Identity",
          "7: {",
          "8:     private $role;",
          "10:     public function __construct($role)",
          "11:     {",
          "12:         $this->role = $role;",
          "13:     }",
          "14: }",
          "16: class Entry implements \\Serializable",
          "17: {",
          "18:     private $identity;",
          "20:     public function __construct(Identity $identity)",
          "21:     {",
          "22:         $this->identity = $identity;",
          "23:     }",
          "25:     public function serialize()",
          "26:     {",
          "27:         return serialize(array($this->identity));",
          "28:     }",
          "30:     public function unserialize($serialized)",
          "31:     {",
          "32:         list($this->identity) = unserialize($serialized);",
          "33:     }",
          "34: }",
          "36: $identity = new Identity('test');",
          "37: $identityRef = &$identity;",
          "39: $entry1 = new Entry($identity);",
          "40: $entry2 = new Entry($identityRef);",
          "42: $serialized = serialize([$entry1, $entry2]);",
          "43: print_r(unserialize($serialized));",
          "45: ?>",
          "46: --EXPECTF--",
          "47: Array",
          "48: (",
          "49:     [0] => Entry Object",
          "50:         (",
          "51:             [identity:Entry:private] => Identity Object",
          "52:                 (",
          "53:                     [role:Identity:private] => test",
          "54:                 )",
          "56:         )",
          "58:     [1] => Entry Object",
          "59:         (",
          "60:             [identity:Entry:private] => Identity Object",
          "61:                 (",
          "62:                     [role:Identity:private] => test",
          "63:                 )",
          "65:         )",
          "67: )",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "574:  yych = *(YYMARKER = ++YYCURSOR);",
          "575:  if (yych == ':') goto yy95;",
          "576: yy3:",
          "578:  { return 0; }",
          "579: #line 580 \"ext/standard/var_unserializer.c\"",
          "580: yy4:",
          "",
          "[Removed Lines]",
          "577: #line 884 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "577: #line 886 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "619:  goto yy3;",
          "620: yy14:",
          "621:  ++YYCURSOR;",
          "623:  {",
          "625:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "",
          "[Removed Lines]",
          "622: #line 878 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "622: #line 880 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "655:  yych = *++YYCURSOR;",
          "656:  if (yych != '\"') goto yy18;",
          "657:  ++YYCURSOR;",
          "659:  {",
          "660:  size_t len, len2, len3, maxlen;",
          "661:  zend_long elements;",
          "",
          "[Removed Lines]",
          "658: #line 733 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "658: #line 735 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "825:  yych = *++YYCURSOR;",
          "826:  if (yych != '\"') goto yy18;",
          "827:  ++YYCURSOR;",
          "829:  {",
          "830:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "828: #line 726 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "828: #line 728 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "865:  }",
          "867:  array_init_size(rval, elements);",
          "870:  if (elements) {",
          "871:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "872:  }",
          "874:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "875:   return 0;",
          "876:  }",
          "878:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "879: }",
          "881: yy39:",
          "882:  yych = *++YYCURSOR;",
          "883:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "880: #line 881 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "875:  var_push_dtor(var_hash, rval);",
          "882: #line 883 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "932:  ZVAL_STR(rval, str);",
          "933:  return 1;",
          "934: }",
          "936: yy46:",
          "937:  yych = *++YYCURSOR;",
          "938:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "935: #line 936 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "937: #line 938 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "985:  ZVAL_STRINGL(rval, str, len);",
          "986:  return 1;",
          "987: }",
          "989: yy53:",
          "990:  yych = *++YYCURSOR;",
          "991:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "988: #line 989 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "990: #line 991 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1082:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1083:  return 1;",
          "1084: }",
          "1086: yy65:",
          "1087:  yych = *++YYCURSOR;",
          "1088:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1085: #line 1086 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1087: #line 1088 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1158:  return 1;",
          "1159: }",
          "1161: yy76:",
          "1162:  yych = *++YYCURSOR;",
          "1163:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1160: #line 1161 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1162: #line 1163 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1210:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1211:  return 1;",
          "1212: }",
          "1214: yy83:",
          "1215:  yych = *++YYCURSOR;",
          "1216:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1213: #line 1214 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1215: #line 1216 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1224:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1225:  return 1;",
          "1226: }",
          "1228: yy87:",
          "1229:  ++YYCURSOR;",
          "1230: #line 573 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1227: #line 1228 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1229: #line 1230 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1233:  ZVAL_NULL(rval);",
          "1234:  return 1;",
          "1235: }",
          "1237: yy89:",
          "1238:  yych = *++YYCURSOR;",
          "1239:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1236: #line 1237 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1238: #line 1239 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1282:  return 1;",
          "1283: }",
          "1285: yy95:",
          "1286:  yych = *++YYCURSOR;",
          "1287:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1286: #line 1287 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1331:  return 1;",
          "1332: }",
          "1334: }",
          "1338:  return 0;",
          "",
          "[Removed Lines]",
          "1333: #line 1334 \"ext/standard/var_unserializer.c\"",
          "1335: #line 886 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1335: #line 1336 \"ext/standard/var_unserializer.c\"",
          "1337: #line 888 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "710:  }",
          "712:  array_init_size(rval, elements);",
          "715:  if (elements) {",
          "716:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "717:  }",
          "719:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "720:   return 0;",
          "721:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "720:  var_push_dtor(var_hash, rval);",
          "",
          "---------------"
        ]
      }
    }
  ]
}