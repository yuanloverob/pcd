{
  "cve_id": "CVE-2014-4955",
  "cve_desc": "Cross-site scripting (XSS) vulnerability in the PMA_TRI_getRowForList function in libraries/rte/rte_list.lib.php in phpMyAdmin 4.0.x before 4.0.10.1, 4.1.x before 4.1.14.2, and 4.2.x before 4.2.6 allows remote authenticated users to inject arbitrary web script or HTML via a crafted trigger name that is improperly handled on the database triggers page.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "10014d4dc596b9e3a491bf04f3e708cf1887d5e1",
  "patch_info": {
    "commit_hash": "10014d4dc596b9e3a491bf04f3e708cf1887d5e1",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/10014d4dc596b9e3a491bf04f3e708cf1887d5e1",
    "files": [
      "ChangeLog",
      "libraries/rte/rte_list.lib.php"
    ],
    "message": "bug #4488 [security] XSS injection due to unescaped table name (triggers)\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
    "before_after_code_files": [
      "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
    ]
  },
  "patch_diff": {
    "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php": [
      "File: libraries/rte/rte_list.lib.php -> libraries/rte/rte_list.lib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "259:     $retval .= \"            </td>\\n\";",
      "260:     if (empty($table)) {",
      "261:         $retval .= \"            <td>\\n\";",
      "265:         $retval .= \"            </td>\\n\";",
      "266:     }",
      "267:     $retval .= \"            <td>\\n\";",
      "",
      "[Removed Lines]",
      "262:         $retval .= \"                <a href='db_triggers.php?{$url_query}\"",
      "263:                                      . \"&amp;table={$trigger['table']}'>\"",
      "264:                                      . $trigger['table'] . \"</a>\\n\";",
      "",
      "[Added Lines]",
      "262:         $retval .= \"<a href='db_triggers.php?{$url_query}\"",
      "263:             . \"&amp;table=\" . urlencode($trigger['table']) . \"'>\"",
      "264:             . urlencode($trigger['table']) . \"</a>\";",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a540e6ba878bae1fc352fadb8aad278a69f17365",
      "candidate_info": {
        "commit_hash": "a540e6ba878bae1fc352fadb8aad278a69f17365",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/a540e6ba878bae1fc352fadb8aad278a69f17365",
        "files": [
          "db_operations.php",
          "db_structure.php",
          "db_tracking.php",
          "js/server_status_monitor.js",
          "js/server_status_processes.js",
          "libraries/Header.class.php",
          "libraries/Menu.class.php",
          "libraries/build_html_for_db.lib.php",
          "libraries/db_common.inc.php",
          "libraries/db_table_exists.lib.php",
          "libraries/display_import.lib.php",
          "libraries/navigation/NavigationHeader.class.php",
          "libraries/plugins/auth/AuthenticationCookie.class.php",
          "libraries/relation.lib.php",
          "libraries/replication_gui.lib.php",
          "libraries/rte/rte_footer.lib.php",
          "libraries/rte/rte_list.lib.php",
          "libraries/server_databases.lib.php",
          "libraries/structure.lib.php",
          "libraries/tbl_common.inc.php",
          "libraries/tracking.lib.php",
          "prefs_forms.php"
        ],
        "message": "More fixes to new PMA_URL_getCommon style\n\nSigned-off-by: Ann + J.M <phpMyAdmin@ZweiSteinSoft.de>",
        "before_after_code_files": [
          "db_operations.php||db_operations.php",
          "db_structure.php||db_structure.php",
          "db_tracking.php||db_tracking.php",
          "js/server_status_monitor.js||js/server_status_monitor.js",
          "js/server_status_processes.js||js/server_status_processes.js",
          "libraries/Header.class.php||libraries/Header.class.php",
          "libraries/Menu.class.php||libraries/Menu.class.php",
          "libraries/build_html_for_db.lib.php||libraries/build_html_for_db.lib.php",
          "libraries/db_common.inc.php||libraries/db_common.inc.php",
          "libraries/db_table_exists.lib.php||libraries/db_table_exists.lib.php",
          "libraries/display_import.lib.php||libraries/display_import.lib.php",
          "libraries/navigation/NavigationHeader.class.php||libraries/navigation/NavigationHeader.class.php",
          "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php",
          "libraries/relation.lib.php||libraries/relation.lib.php",
          "libraries/replication_gui.lib.php||libraries/replication_gui.lib.php",
          "libraries/rte/rte_footer.lib.php||libraries/rte/rte_footer.lib.php",
          "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php",
          "libraries/server_databases.lib.php||libraries/server_databases.lib.php",
          "libraries/structure.lib.php||libraries/structure.lib.php",
          "libraries/tbl_common.inc.php||libraries/tbl_common.inc.php",
          "libraries/tracking.lib.php||libraries/tracking.lib.php",
          "prefs_forms.php||prefs_forms.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
          ],
          "candidate": [
            "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "db_operations.php||db_operations.php": [
          "File: db_operations.php -> db_operations.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "264:         );",
          "265:         $message->addParam(",
          "266:             '<a href=\"' . $cfg['PmaAbsoluteUri']",
          "268:             false",
          "269:         );",
          "270:         $message->addParam('</a>', false);",
          "",
          "[Removed Lines]",
          "267:             . 'chk_rel.php?' . $url_query . '\">',",
          "",
          "[Added Lines]",
          "267:             . 'chk_rel.php' . $url_query . '\">',",
          "",
          "---------------"
        ],
        "db_structure.php||db_structure.php": [
          "File: db_structure.php -> db_structure.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "178:     if ($is_show_stats) {",
          "179:         if ($formatted_overhead != '') {",
          "181:                 . $tbl_url_query . '#showusage\">'",
          "182:                 . '<span>' . $formatted_overhead . '</span>'",
          "183:                 . '<span class=\"unit\">' . $overhead_unit . '</span>'",
          "",
          "[Removed Lines]",
          "180:             $overhead = '<a href=\"tbl_structure.php?'",
          "",
          "[Added Lines]",
          "180:             $overhead = '<a href=\"tbl_structure.php'",
          "",
          "---------------"
        ],
        "db_tracking.php||db_tracking.php": [
          "File: db_tracking.php -> db_tracking.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "118:         $table_result = PMA_queryAsControlUser($table_query);",
          "119:         $version_data = $GLOBALS['dbi']->fetchArray($table_result);",
          "122:             . htmlspecialchars($version_data['table_name']);",
          "124:             . htmlspecialchars($version_data['table_name'])",
          "125:             . '&amp;delete_tracking=true&amp';",
          "126:         ?>",
          "",
          "[Removed Lines]",
          "121:         $tmp_link = 'tbl_tracking.php?' . $url_query . '&amp;table='",
          "123:         $delete_link = 'db_tracking.php?' . $url_query . '&amp;table='",
          "",
          "[Added Lines]",
          "121:         $tmp_link = 'tbl_tracking.php' . $url_query . '&amp;table='",
          "123:         $delete_link = 'db_tracking.php' . $url_query . '&amp;table='",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "217:     foreach ($my_tables as $key => $tablename) {",
          "218:         if (PMA_Tracker::getVersion($GLOBALS['db'], $tablename) == -1) {",
          "220:                 . '&amp;table=' . htmlspecialchars($tablename) . '\">';",
          "221:             $my_link .= PMA_Util::getIcon('eye.png', __('Track table'));",
          "222:             $my_link .= '</a>';",
          "",
          "[Removed Lines]",
          "219:             $my_link = '<a href=\"tbl_tracking.php?' . $url_query",
          "",
          "[Added Lines]",
          "219:             $my_link = '<a href=\"tbl_tracking.php' . $url_query",
          "",
          "---------------"
        ],
        "js/server_status_monitor.js||js/server_status_monitor.js": [
          "File: js/server_status_monitor.js -> js/server_status_monitor.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "572:         $('<form />', {",
          "573:             \"class\": \"disableAjax\",",
          "574:             method: \"post\",",
          "576:             style: \"display:none;\"",
          "577:         })",
          "578:         .append(",
          "",
          "[Removed Lines]",
          "575:             action: \"file_echo.php?\" + PMA_commonParams.get('common_query') + \"&filename=1\",",
          "",
          "[Added Lines]",
          "575:             action: \"file_echo.php\" + PMA_commonParams.get('common_query') + \"&filename=1\",",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "590:     $('a[href=\"#importMonitorConfig\"]').click(function (event) {",
          "591:         event.preventDefault();",
          "592:         $('#emptyDialog').dialog({title: PMA_messages.strImportDialogTitle});",
          "594:             '<input type=\"file\" name=\"file\"> <input type=\"hidden\" name=\"import\" value=\"1\"> </form>');",
          "596:         var dlgBtns = {};",
          "",
          "[Removed Lines]",
          "593:         $('#emptyDialog').html(PMA_messages.strImportDialogMessage + ':<br/><form action=\"file_echo.php?' + PMA_commonParams.get('common_query') + '&import=1\" method=\"post\" enctype=\"multipart/form-data\">' +",
          "",
          "[Added Lines]",
          "593:         $('#emptyDialog').html(PMA_messages.strImportDialogMessage + ':<br/><form action=\"file_echo.php' + PMA_commonParams.get('common_query') + '&import=1\" method=\"post\" enctype=\"multipart/form-data\">' +",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "697:                 $.extend(vars, getvars);",
          "698:             }",
          "701:                 function (data) {",
          "702:                     var logVars;",
          "703:                     if (typeof data !== 'undefined' && data.success === true) {",
          "",
          "[Removed Lines]",
          "700:             $.get('server_status_monitor.php?' + PMA_commonParams.get('common_query'), vars,",
          "",
          "[Added Lines]",
          "700:             $.get('server_status_monitor.php' + PMA_commonParams.get('common_query'), vars,",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1354:     function refreshChartGrid() {",
          "1357:             ajax_request: true,",
          "1358:             chart_data: 1,",
          "1359:             type: 'chartgrid',",
          "",
          "[Removed Lines]",
          "1356:         runtime.refreshRequest = $.post('server_status_monitor.php?' + PMA_commonParams.get('common_query'), {",
          "",
          "[Added Lines]",
          "1356:         runtime.refreshRequest = $.post('server_status_monitor.php' + PMA_commonParams.get('common_query'), {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1592:         });",
          "1596:             {   ajax_request: true,",
          "1597:                 log_data: 1,",
          "1598:                 type: opts.src,",
          "",
          "[Removed Lines]",
          "1595:         logRequest = $.get('server_status_monitor.php?' + PMA_commonParams.get('common_query'),",
          "",
          "[Added Lines]",
          "1595:         logRequest = $.get('server_status_monitor.php' + PMA_commonParams.get('common_query'),",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1986:             PMA_messages.strAnalyzing + ' <img class=\"ajaxIcon\" src=\"' +",
          "1987:             pmaThemeImage + 'ajax_clock_small.gif\" alt=\"\">');",
          "1990:             ajax_request: true,",
          "1991:             query_analyzer: true,",
          "1992:             query: codemirror_editor ? codemirror_editor.getValue() : $('#sqlquery').val(),",
          "",
          "[Removed Lines]",
          "1989:         $.post('server_status_monitor.php?' + PMA_commonParams.get('common_query'), {",
          "",
          "[Added Lines]",
          "1989:         $.post('server_status_monitor.php' + PMA_commonParams.get('common_query'), {",
          "",
          "---------------"
        ],
        "js/server_status_processes.js||js/server_status_processes.js": [
          "File: js/server_status_processes.js -> js/server_status_processes.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:     init: function() {",
          "29:         processList.setRefreshLabel();",
          "30:         if (processList.refreshUrl === null) {",
          "32:                 PMA_commonParams.get('common_query');",
          "33:         }",
          "34:         if (processList.refreshInterval === null) {",
          "",
          "[Removed Lines]",
          "31:             processList.refreshUrl = 'server_status_processes.php?' +",
          "",
          "[Added Lines]",
          "31:             processList.refreshUrl = 'server_status_processes.php' +",
          "",
          "---------------"
        ],
        "libraries/Header.class.php||libraries/Header.class.php": [
          "File: libraries/Header.class.php -> libraries/Header.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "221:         $pftext = ! empty($_SESSION['tmpval']['pftext'])",
          "222:             ? $_SESSION['tmpval']['pftext'] : '';",
          "223:         return array(",
          "225:             'opendb_url' => $GLOBALS['cfg']['DefaultTabDatabase'],",
          "226:             'safari_browser' => PMA_USR_BROWSER_AGENT == 'SAFARI' ? 1 : 0,",
          "227:             'collation_connection' => $GLOBALS['collation_connection'],",
          "",
          "[Removed Lines]",
          "224:             'common_query' => PMA_URL_getCommon(array(), 'text', '&'),",
          "",
          "[Added Lines]",
          "224:             'common_query' => PMA_URL_getCommon(array(), 'text'),",
          "",
          "---------------"
        ],
        "libraries/Menu.class.php||libraries/Menu.class.php": [
          "File: libraries/Menu.class.php -> libraries/Menu.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "180:             : ':' . $GLOBALS['cfg']['Server']['port'];",
          "182:         $separator = \"<span class='separator item'>&nbsp;\u00bb</span>\";",
          "185:         if (PMA_Util::showText('TabsMode')) {",
          "186:             $item .= '%4$s: ';",
          "",
          "[Removed Lines]",
          "183:         $item = '<a href=\"%1$s?%2$s\" class=\"item\">';",
          "",
          "[Added Lines]",
          "183:         $item = '<a href=\"%1$s%2$s\" class=\"item\">';",
          "",
          "---------------"
        ],
        "libraries/build_html_for_db.lib.php||libraries/build_html_for_db.lib.php": [
          "File: libraries/build_html_for_db.lib.php -> libraries/build_html_for_db.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "167:                . '<a onclick=\"'",
          "168:                . 'PMA_commonActions.setDb(\\''",
          "169:                . PMA_jsFormat($current['SCHEMA_NAME']) . '\\');'",
          "171:                . '&amp;db=' . urlencode($current['SCHEMA_NAME'])",
          "172:                . '&amp;checkprivsdb=' . urlencode($current['SCHEMA_NAME'])",
          "173:                . '\" title=\"'",
          "",
          "[Removed Lines]",
          "170:                . '\" href=\"server_privileges.php?' . $url_query",
          "",
          "[Added Lines]",
          "170:                . '\" href=\"server_privileges.php' . $url_query",
          "",
          "---------------"
        ],
        "libraries/db_common.inc.php||libraries/db_common.inc.php": [
          "File: libraries/db_common.inc.php -> libraries/db_common.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "52:     }",
          "54:     $uri = $cfg['PmaAbsoluteUri'] . 'index.php'",
          "56:         . (isset($message) ? '&message=' . urlencode($message) : '') . '&reload=1';",
          "57:     if (!$pmaString->strlen($db) || ! $is_db) {",
          "58:         $response = PMA_Response::getInstance();",
          "",
          "[Removed Lines]",
          "55:         . PMA_URL_getCommon(array(), 'text', '&')",
          "",
          "[Added Lines]",
          "55:         . PMA_URL_getCommon(array(), 'text')",
          "",
          "---------------"
        ],
        "libraries/db_table_exists.lib.php||libraries/db_table_exists.lib.php": [
          "File: libraries/db_table_exists.lib.php -> libraries/db_table_exists.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:                 }",
          "43:                 PMA_sendHeaderLocation(",
          "44:                     $cfg['PmaAbsoluteUri'] . 'index.php'",
          "46:                 );",
          "47:             }",
          "48:             exit;",
          "",
          "[Removed Lines]",
          "45:                     . PMA_URL_getCommon($url_params, 'text', '&')",
          "",
          "[Added Lines]",
          "45:                     . PMA_URL_getCommon($url_params, 'text')",
          "",
          "---------------"
        ],
        "libraries/display_import.lib.php||libraries/display_import.lib.php": [
          "File: libraries/display_import.lib.php -> libraries/display_import.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "442: {",
          "444:     $ajax_url = \"import_status.php?id=\" . $upload_id . \"&\"",
          "446:     $promot_str = PMA_jsFormat(",
          "447:         __(",
          "448:             'The file being uploaded is probably larger than '",
          "",
          "[Removed Lines]",
          "445:         . PMA_URL_getCommon(array('import_status'=>1), 'text', '&');",
          "",
          "[Added Lines]",
          "445:         . PMA_URL_getCommon(array('import_status'=>1), 'text');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "460:         __('The file is being processed, please be patient.'),",
          "461:         false",
          "462:     );",
          "466:     $html  = 'var finished = false; ';",
          "",
          "[Removed Lines]",
          "463:     $import_url = PMA_URL_getCommon(array('import_status'=>1), 'text', '&');",
          "",
          "[Added Lines]",
          "463:     $import_url = PMA_URL_getCommon(array('import_status'=>1), 'text');",
          "",
          "---------------"
        ],
        "libraries/navigation/NavigationHeader.class.php||libraries/navigation/NavigationHeader.class.php": [
          "File: libraries/navigation/NavigationHeader.class.php -> libraries/navigation/NavigationHeader.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "156:         if ($GLOBALS['server'] != 0) {",
          "158:             if ($GLOBALS['cfg']['Server']['auth_type'] != 'config') {",
          "160:                 $link .= '&amp;old_usr=' . urlencode($GLOBALS['PHP_AUTH_USER']);",
          "161:                 $retval .= PMA_Util::getNavigationLink(",
          "162:                     $link,",
          "",
          "[Removed Lines]",
          "159:                 $link  = 'index.php?' . $GLOBALS['url_query'];",
          "",
          "[Added Lines]",
          "159:                 $link  = 'index.php' . $GLOBALS['url_query'];",
          "",
          "---------------"
        ],
        "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php": [
          "File: libraries/plugins/auth/AuthenticationCookie.class.php -> libraries/plugins/auth/AuthenticationCookie.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "619:             PMA_Response::getInstance()->disable();",
          "621:             PMA_sendHeaderLocation(",
          "623:                 true",
          "624:             );",
          "625:             if (! defined('TESTSUITE')) {",
          "",
          "[Removed Lines]",
          "622:                 $redirect_url . PMA_URL_getCommon($url_params, 'text', '&'),",
          "",
          "[Added Lines]",
          "622:                 $redirect_url . PMA_URL_getCommon($url_params, 'text'),",
          "",
          "---------------"
        ],
        "libraries/relation.lib.php||libraries/relation.lib.php": [
          "File: libraries/relation.lib.php -> libraries/relation.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1878:     );",
          "1879:     $message->addParam(",
          "1880:         '<a href=\"' . $GLOBALS['cfg']['PmaAbsoluteUri']",
          "1882:         false",
          "1883:     );",
          "1884:     $message->addParam('</a>', false);",
          "",
          "[Removed Lines]",
          "1881:         . 'chk_rel.php?' . $url_query . '\">',",
          "",
          "[Added Lines]",
          "1881:         . 'chk_rel.php' . $url_query . '\">',",
          "",
          "---------------"
        ],
        "libraries/replication_gui.lib.php||libraries/replication_gui.lib.php": [
          "File: libraries/replication_gui.lib.php -> libraries/replication_gui.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "953:             } else {",
          "954:                 PMA_sendHeaderLocation(",
          "955:                     $GLOBALS['cfg']['PmaAbsoluteUri'] . 'server_replication.php'",
          "957:                 );",
          "958:             }",
          "959:         }",
          "",
          "[Removed Lines]",
          "956:                     . PMA_URL_getCommon($GLOBALS['url_params'], 'text', '&')",
          "",
          "[Added Lines]",
          "956:                     . PMA_URL_getCommon($GLOBALS['url_params'], 'text')",
          "",
          "---------------"
        ],
        "libraries/rte/rte_footer.lib.php||libraries/rte/rte_footer.lib.php": [
          "File: libraries/rte/rte_footer.lib.php -> libraries/rte/rte_footer.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "33:     if (PMA_Util::currentUserHasPrivilege($priv, $db, $table)) {",
          "34:         $retval .= \"            <a {$ajax_class['add']} \";",
          "35:         $retval .= \"href='db_\" . $pmaString->strtolower($name) . \"s.php\";",
          "37:         $retval .= \"onclick='$.datepicker.initialized = false;'>\";",
          "38:         $icon = 'b_' . $pmaString->strtolower($name) . '_add.png';",
          "39:         $retval .= PMA_Util::getIcon($icon);",
          "",
          "[Removed Lines]",
          "36:         $retval .= \"?$url_query&amp;add_item=1' \";",
          "",
          "[Added Lines]",
          "36:         $retval .= \"$url_query&amp;add_item=1' \";",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "115:     $retval .= \"        <div class='wrap'>\\n\";",
          "117:     $retval .= PMA_Util::toggleButton(",
          "119:         'sql_query',",
          "120:         $options,",
          "121:         'PMA_slidingMessage(data.sql_query);'",
          "",
          "[Removed Lines]",
          "118:         \"sql.php?$url_query&amp;goto=db_events.php\" . urlencode(\"?db=$db\"),",
          "",
          "[Added Lines]",
          "118:         \"sql.php$url_query&amp;goto=db_events.php\" . urlencode(\"?db=$db\"),",
          "",
          "---------------"
        ],
        "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php": [
          "File: libraries/rte/rte_list.lib.php -> libraries/rte/rte_list.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "153:         && PMA_Util::currentUserHasPrivilege('CREATE ROUTINE', $db)",
          "154:     ) {",
          "155:         $retval .= '                <a ' . $ajax_class['edit']",
          "157:                                          . $url_query",
          "158:                                          . '&amp;edit_item=1'",
          "159:                                          . '&amp;item_name='",
          "",
          "[Removed Lines]",
          "156:                                          . ' href=\"db_routines.php?'",
          "",
          "[Added Lines]",
          "156:                                          . ' href=\"db_routines.php'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "194:                 break;",
          "195:             }",
          "196:             $retval .= '                <a ' . $ajax_class['exec']",
          "198:                                              . $url_query",
          "199:                                              . '&amp;' . $execute_action . '=1'",
          "200:                                              . '&amp;item_name='",
          "",
          "[Removed Lines]",
          "197:                                              . ' href=\"db_routines.php?'",
          "",
          "[Added Lines]",
          "197:                                              . ' href=\"db_routines.php'",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "209:     $retval .= \"            </td>\\n\";",
          "210:     $retval .= \"            <td>\\n\";",
          "211:     $retval .= '                <a ' . $ajax_class['export']",
          "213:                                      . $url_query",
          "214:                                      . '&amp;export_item=1'",
          "215:                                      . '&amp;item_name='",
          "",
          "[Removed Lines]",
          "212:                                      . ' href=\"db_routines.php?'",
          "",
          "[Added Lines]",
          "212:                                      . ' href=\"db_routines.php'",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "219:     $retval .= \"            </td>\\n\";",
          "220:     $retval .= \"            <td>\\n\";",
          "221:     $retval .= '                <a ' . $ajax_class['drop']",
          "223:                                          . $url_query",
          "224:                                          . '&amp;sql_query=' . urlencode($sql_drop)",
          "225:                                          . '&amp;goto=db_routines.php'",
          "",
          "[Removed Lines]",
          "222:                                          . ' href=\"sql.php?'",
          "",
          "[Added Lines]",
          "222:                                          . ' href=\"sql.php'",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "260:     $retval .= \"            </td>\\n\";",
          "261:     if (empty($table)) {",
          "262:         $retval .= \"            <td>\\n\";",
          "264:             . \"&amp;table=\" . urlencode($trigger['table']) . \"'>\"",
          "265:             . urlencode($trigger['table']) . \"</a>\";",
          "266:         $retval .= \"            </td>\\n\";",
          "",
          "[Removed Lines]",
          "263:         $retval .= \"<a href='db_triggers.php?{$url_query}\"",
          "",
          "[Added Lines]",
          "263:         $retval .= \"<a href='db_triggers.php{$url_query}\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "268:     $retval .= \"            <td>\\n\";",
          "269:     if (PMA_Util::currentUserHasPrivilege('TRIGGER', $db, $table)) {",
          "270:         $retval .= '                <a ' . $ajax_class['edit']",
          "272:                                          . $url_query",
          "273:                                          . '&amp;edit_item=1'",
          "274:                                          . '&amp;item_name='",
          "",
          "[Removed Lines]",
          "271:                                          . ' href=\"db_triggers.php?'",
          "",
          "[Added Lines]",
          "271:                                          . ' href=\"db_triggers.php'",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "280:     $retval .= \"            </td>\\n\";",
          "281:     $retval .= \"            <td>\\n\";",
          "282:     $retval .= '                    <a ' . $ajax_class['export']",
          "284:                                          . $url_query",
          "285:                                          . '&amp;export_item=1'",
          "286:                                          . '&amp;item_name='",
          "",
          "[Removed Lines]",
          "283:                                          . ' href=\"db_triggers.php?'",
          "",
          "[Added Lines]",
          "283:                                          . ' href=\"db_triggers.php'",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "290:     $retval .= \"            <td>\\n\";",
          "291:     if (PMA_Util::currentUserHasPrivilege('TRIGGER', $db)) {",
          "292:         $retval .= '                <a ' . $ajax_class['drop']",
          "294:                                          . $url_query",
          "295:                                          . '&amp;sql_query='",
          "296:                                          . urlencode($trigger['drop'])",
          "",
          "[Removed Lines]",
          "293:                                          . ' href=\"sql.php?'",
          "",
          "[Added Lines]",
          "293:                                          . ' href=\"sql.php'",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "344:     $retval .= \"            <td>\\n\";",
          "345:     if (PMA_Util::currentUserHasPrivilege('EVENT', $db)) {",
          "346:         $retval .= '                <a ' . $ajax_class['edit']",
          "348:                                          . $url_query",
          "349:                                          . '&amp;edit_item=1'",
          "350:                                          . '&amp;item_name='",
          "",
          "[Removed Lines]",
          "347:                                          . ' href=\"db_events.php?'",
          "",
          "[Added Lines]",
          "347:                                          . ' href=\"db_events.php'",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "356:     $retval .= \"            </td>\\n\";",
          "357:     $retval .= \"            <td>\\n\";",
          "358:     $retval .= '                <a ' . $ajax_class['export']",
          "360:                                      . $url_query",
          "361:                                      . '&amp;export_item=1'",
          "362:                                      . '&amp;item_name='",
          "",
          "[Removed Lines]",
          "359:                                      . ' href=\"db_events.php?'",
          "",
          "[Added Lines]",
          "359:                                      . ' href=\"db_events.php'",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "366:     $retval .= \"            <td>\\n\";",
          "367:     if (PMA_Util::currentUserHasPrivilege('EVENT', $db)) {",
          "368:         $retval .= '                <a ' . $ajax_class['drop']",
          "370:                                          . $url_query",
          "371:                                          . '&amp;sql_query=' . urlencode($sql_drop)",
          "372:                                          . '&amp;goto=db_events.php'",
          "",
          "[Removed Lines]",
          "369:                                          . ' href=\"sql.php?'",
          "",
          "[Added Lines]",
          "369:                                          . ' href=\"sql.php'",
          "",
          "---------------"
        ],
        "libraries/server_databases.lib.php||libraries/server_databases.lib.php": [
          "File: libraries/server_databases.lib.php -> libraries/server_databases.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "366:     $html  = $notice . $html;",
          "367:     $html .= '<ul><li id=\"li_switch_dbstats\"><strong>' . \"\\n\";",
          "369:         . ' title=\"' . __('Enable Statistics') . '\">' . \"\\n\"",
          "370:         . '            ' . __('Enable Statistics');",
          "371:     $html .= '</a></strong><br />' . \"\\n\";",
          "",
          "[Removed Lines]",
          "368:     $html .= '<a href=\"server_databases.php?' . $url_query . '&amp;dbstats=1\"'",
          "",
          "[Added Lines]",
          "368:     $html .= '<a href=\"server_databases.php' . $url_query . '&amp;dbstats=1\"'",
          "",
          "---------------"
        ],
        "libraries/structure.lib.php||libraries/structure.lib.php": [
          "File: libraries/structure.lib.php -> libraries/structure.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:         $may_have_rows = false;",
          "37:     }",
          "40:     if ($may_have_rows) {",
          "41:         $browse_table .= $titles['Browse'];",
          "42:     } else {",
          "",
          "[Removed Lines]",
          "39:     $browse_table = '<a href=\"sql.php?' . $tbl_url_query . '&amp;pos=0\">';",
          "",
          "[Added Lines]",
          "39:     $browse_table = '<a href=\"sql.php' . $tbl_url_query . '&amp;pos=0\">';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "44:     }",
          "45:     $browse_table .= '</a>';",
          "48:     if ($may_have_rows) {",
          "49:         $search_table .= $titles['Search'];",
          "50:     } else {",
          "",
          "[Removed Lines]",
          "47:     $search_table = '<a href=\"tbl_select.php?' . $tbl_url_query . '\">';",
          "",
          "[Added Lines]",
          "47:     $search_table = '<a href=\"tbl_select.php' . $tbl_url_query . '\">';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "52:     }",
          "53:     $search_table .= '</a>';",
          "56:         . '&amp;pos=0\" title=\"'",
          "57:         . htmlspecialchars($current_table['TABLE_COMMENT']) . '\">'",
          "58:         . $truename . '</a>';",
          "60:     if (!$db_is_system_schema) {",
          "61:         $empty_table = '<a class=\"truncate_table_anchor ajax\"';",
          "63:             . '&amp;sql_query=';",
          "64:         $empty_table .= urlencode(",
          "65:             'TRUNCATE ' . PMA_Util::backquote($current_table['TABLE_NAME'])",
          "",
          "[Removed Lines]",
          "55:     $browse_table_label = '<a href=\"sql.php?' . $tbl_url_query",
          "62:         $empty_table .= ' href=\"sql.php?' . $tbl_url_query",
          "",
          "[Added Lines]",
          "55:     $browse_table_label = '<a href=\"sql.php' . $tbl_url_query",
          "62:         $empty_table .= ' href=\"sql.php' . $tbl_url_query",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "87:     $tracking_icon = '';",
          "88:     if (PMA_Tracker::isActive()) {",
          "89:         if (PMA_Tracker::isTracked($GLOBALS[\"db\"], $truename)) {",
          "91:                 . '&amp;table=' . $truename . '\">'",
          "92:                 . PMA_Util::getImage(",
          "93:                     'eye.png', __('Tracking is active.')",
          "94:                 )",
          "95:                 . '</a>';",
          "96:         } elseif (PMA_Tracker::getVersion($GLOBALS[\"db\"], $truename) > 0) {",
          "98:                 . '&amp;table=' . $truename . '\">'",
          "99:                 . PMA_Util::getImage(",
          "100:                     'eye_grey.png', __('Tracking is not active.')",
          "",
          "[Removed Lines]",
          "90:             $tracking_icon = '<a href=\"tbl_tracking.php?' . $url_query",
          "97:             $tracking_icon = '<a href=\"tbl_tracking.php?' . $url_query",
          "",
          "[Added Lines]",
          "90:             $tracking_icon = '<a href=\"tbl_tracking.php' . $url_query",
          "97:             $tracking_icon = '<a href=\"tbl_tracking.php' . $url_query",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "381: function PMA_getHtmlForTablePrintViewLink($url_query)",
          "382: {",
          "383:     return '<p>'",
          "385:         . PMA_Util::getIcon(",
          "386:             'b_print.png',",
          "387:             __('Print view'),",
          "",
          "[Removed Lines]",
          "384:         . '<a href=\"db_printview.php?' . $url_query . '\" target=\"print_view\">'",
          "",
          "[Added Lines]",
          "384:         . '<a href=\"db_printview.php' . $url_query . '\" target=\"print_view\">'",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "399: function PMA_getHtmlForDataDictionaryLink($url_query)",
          "400: {",
          "402:         . PMA_Util::getIcon(",
          "403:             'b_tblanalyse.png',",
          "404:             __('Data Dictionary'),",
          "",
          "[Removed Lines]",
          "401:     return '<a href=\"db_datadict.php?' . $url_query . '\" target=\"print_view\">'",
          "",
          "[Added Lines]",
          "401:     return '<a href=\"db_datadict.php' . $url_query . '\" target=\"print_view\">'",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "510:     $html_output .= '<td class=\"center\">' . $browse_table . '</td>';",
          "511:     $html_output .= '<td class=\"center\">'",
          "513:         . $titles['Structure'] . '</a></td>';",
          "514:     $html_output .= '<td class=\"center\">' . $search_table . '</td>';",
          "",
          "[Removed Lines]",
          "512:         . '<a href=\"tbl_structure.php?' . $tbl_url_query . '\">'",
          "",
          "[Added Lines]",
          "512:         . '<a href=\"tbl_structure.php' . $tbl_url_query . '\">'",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "566:     $titles, $empty_table, $current_table, $drop_query, $drop_message",
          "567: ) {",
          "568:     $html_output = '<td class=\"insert_table center\">'",
          "570:         . $titles['Insert']",
          "571:         . '</a></td>';",
          "572:     $html_output .= '<td class=\"center\">' . $empty_table . '</td>';",
          "",
          "[Removed Lines]",
          "569:         . '<a href=\"tbl_change.php?' . $tbl_url_query . '\">'",
          "",
          "[Added Lines]",
          "569:         . '<a href=\"tbl_change.php' . $tbl_url_query . '\">'",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "579:         $html_output .= ' view';",
          "580:     }",
          "581:     $html_output .= '\" ';",
          "583:         . '&amp;reload=1&amp;purge=1&amp;sql_query='",
          "584:         . urlencode($drop_query) . '&amp;message_to_show='",
          "585:         . urlencode($drop_message) . '\" >'",
          "",
          "[Removed Lines]",
          "582:     $html_output .= 'href=\"sql.php?' . $tbl_url_query",
          "",
          "[Added Lines]",
          "582:     $html_output .= 'href=\"sql.php' . $tbl_url_query",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "602:     $unit, $overhead",
          "603: ) {",
          "604:      $html_output = '<td class=\"value tbl_size\"><a '",
          "606:         . '<span>' . $formatted_size . '</span> '",
          "607:         . '<span class=\"unit\">' . $unit . '</span>'",
          "608:         . '</a></td>';",
          "",
          "[Removed Lines]",
          "605:         . 'href=\"tbl_structure.php?' . $tbl_url_query . '#showusage\" >'",
          "",
          "[Added Lines]",
          "605:         . 'href=\"tbl_structure.php' . $tbl_url_query . '#showusage\" >'",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1410:     if (! $tbl_is_view && ! $db_is_system_schema) {",
          "1411:         $html_output .= '<td class=\"edit center\">'",
          "1412:             . '<a class=\"change_column_anchor ajax\"'",
          "1414:             . $url_query . '&amp;field=' . $field_encoded",
          "1415:             . '&amp;change_column=1\">'",
          "1416:             . $titles['Change'] . '</a>' . '</td>';",
          "1417:         $html_output .= '<td class=\"drop center\">'",
          "1418:             . '<a class=\"drop_column_anchor ajax\"'",
          "1420:             . urlencode(",
          "1421:                 'ALTER TABLE ' . PMA_Util::backquote($table)",
          "1422:                 . ' DROP ' . PMA_Util::backquote($row['Field']) . ';'",
          "",
          "[Removed Lines]",
          "1413:             . ' href=\"tbl_structure.php?'",
          "1419:             . ' href=\"sql.php?' . $url_query . '&amp;sql_query='",
          "",
          "[Added Lines]",
          "1413:             . ' href=\"tbl_structure.php'",
          "1419:             . ' href=\"sql.php' . $url_query . '&amp;sql_query='",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1602: function PMA_getHtmlForOptionalActionLinks($url_query, $tbl_is_view,",
          "1603:     $db_is_system_schema, $tbl_storage_engine, $cfgRelation",
          "1604: ) {",
          "1606:         . '\" target=\"print_view\">'",
          "1607:         . PMA_Util::getIcon('b_print.png', __('Print view'), true)",
          "1608:         . '</a>';",
          "",
          "[Removed Lines]",
          "1605:     $html_output = '<a href=\"tbl_printview.php?' . $url_query",
          "",
          "[Added Lines]",
          "1605:     $html_output = '<a href=\"tbl_printview.php' . $url_query",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1614:         if ($cfgRelation['relwork']",
          "1615:             || PMA_Util::isForeignKeySupported($tbl_storage_engine)",
          "1616:         ) {",
          "1618:                 . PMA_Util::getIcon(",
          "1619:                     'b_relations.png', __('Relation view'), true",
          "1620:                 )",
          "1621:                 . '</a>';",
          "1622:         }",
          "1623:         if (!PMA_DRIZZLE) {",
          "1625:                 . '&amp;session_max_rows=all&amp;sql_query=' . urlencode(",
          "1626:                     'SELECT * FROM ' . PMA_Util::backquote($GLOBALS['table'])",
          "1627:                     . ' PROCEDURE ANALYSE()'",
          "",
          "[Removed Lines]",
          "1617:             $html_output .= '<a href=\"tbl_relation.php?' . $url_query . '\">'",
          "1624:             $html_output .= '<a href=\"sql.php?' . $url_query",
          "",
          "[Added Lines]",
          "1617:             $html_output .= '<a href=\"tbl_relation.php' . $url_query . '\">'",
          "1624:             $html_output .= '<a href=\"sql.php' . $url_query",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1635:             $html_output .= PMA_Util::showMySQLDocu('procedure_analyse') . \"\\n\";",
          "1636:         }",
          "1637:         if (PMA_Tracker::isActive()) {",
          "1639:                 . PMA_Util::getIcon('eye.png', __('Track table'), true)",
          "1640:                 . '</a>';",
          "1641:         }",
          "1642:         $html_output .= '<a href=\"#\" id=\"move_columns_anchor\">'",
          "1643:             . PMA_Util::getIcon('b_move.png', __('Move columns'), true)",
          "1644:             . '</a>';",
          "1646:             . PMA_Util::getIcon('normalize.png', __('Improve table structure'), true)",
          "1647:             . '</a>';",
          "1648:     }",
          "",
          "[Removed Lines]",
          "1638:             $html_output .= '<a href=\"tbl_tracking.php?' . $url_query . '\">'",
          "1645:         $html_output .= '<a href=\"normalization.php?' . $url_query . '\">'",
          "",
          "[Added Lines]",
          "1638:             $html_output .= '<a href=\"tbl_tracking.php' . $url_query . '\">'",
          "1645:         $html_output .= '<a href=\"normalization.php' . $url_query . '\">'",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1745: {",
          "1746:     $html_output = '<tr class=\"tblFooters\">';",
          "1747:     $html_output .= '<td colspan=\"3\" class=\"center\">';",
          "1749:         . '&pos=0&amp;sql_query=' . urlencode(",
          "1750:             'OPTIMIZE TABLE ' . PMA_Util::backquote($GLOBALS['table'])",
          "1751:         )",
          "",
          "[Removed Lines]",
          "1748:     $html_output .= '<a href=\"sql.php?' . $url_query",
          "",
          "[Added Lines]",
          "1748:     $html_output .= '<a href=\"sql.php' . $url_query",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1945:                 ($action=='Unique' ? 'class=\"ajax add_unique_anchor\"' : ' ')",
          "1946:                )",
          "1947:               )",
          "1949:             . urlencode(",
          "1950:                 'ALTER TABLE ' . PMA_Util::backquote($GLOBALS['table'])",
          "1951:                 . ($isPrimary ? ($primary ? ' DROP PRIMARY KEY,' : '') : '')",
          "",
          "[Removed Lines]",
          "1948:             . ' href=\"sql.php?' . $url_query . '&amp;sql_query='",
          "",
          "[Added Lines]",
          "1948:             . ' href=\"sql.php' . $url_query . '&amp;sql_query='",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1991:         && ($pmaString->strpos($type, 'text') !== false",
          "1992:         || $pmaString->strpos($type, 'char') !== false)",
          "1993:     ) {",
          "1995:             . '&amp;sql_query='",
          "1996:             . urlencode(",
          "1997:                 'ALTER TABLE ' . PMA_Util::backquote($GLOBALS['table'])",
          "",
          "[Removed Lines]",
          "1994:         $html_output .= '<a rel=\"samepage\" href=\"sql.php?' . $url_query",
          "",
          "[Added Lines]",
          "1994:         $html_output .= '<a rel=\"samepage\" href=\"sql.php' . $url_query",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "2026: function PMA_getHtmlForDistinctValueAction($url_query, $row, $titles)",
          "2027: {",
          "2028:     $html_output = '<li class=\"browse nowrap\">';",
          "2030:         . urlencode(",
          "2031:             'SELECT COUNT(*) AS ' . PMA_Util::backquote(__('Rows'))",
          "2032:             . ', ' . PMA_Util::backquote($row['Field'])",
          "",
          "[Removed Lines]",
          "2029:     $html_output .= '<a href=\"sql.php?' . $url_query . '&amp;sql_query='",
          "",
          "[Added Lines]",
          "2029:     $html_output .= '<a href=\"sql.php' . $url_query . '&amp;sql_query='",
          "",
          "---------------"
        ],
        "libraries/tbl_common.inc.php||libraries/tbl_common.inc.php": [
          "File: libraries/tbl_common.inc.php -> libraries/tbl_common.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:     && PMA_Tracker::isTracked($GLOBALS[\"db\"], $GLOBALS[\"table\"])",
          "50:     && ! isset($_REQUEST['submit_deactivate_now'])",
          "51: ) {",
          "53:     $temp_msg .= sprintf(",
          "54:         __('Tracking of %s is activated.'),",
          "55:         htmlspecialchars($GLOBALS[\"db\"] . '.' . $GLOBALS[\"table\"])",
          "",
          "[Removed Lines]",
          "52:     $temp_msg = '<a href=\"tbl_tracking.php?' . $url_query . '\">';",
          "",
          "[Added Lines]",
          "52:     $temp_msg = '<a href=\"tbl_tracking.php' . $url_query . '\">';",
          "",
          "---------------"
        ],
        "libraries/tracking.lib.php||libraries/tracking.lib.php": [
          "File: libraries/tracking.lib.php -> libraries/tracking.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "55:     $pmaString = $GLOBALS['PMA_String'];",
          "57:     $html = '<div id=\"div_create_version\">';",
          "59:     $html .= PMA_URL_getHiddenInputs($GLOBALS['db'], $GLOBALS['table']);",
          "60:     $html .= '<fieldset>';",
          "61:     $html .= '<legend>';",
          "",
          "[Removed Lines]",
          "58:     $html .= '<form method=\"post\" action=\"tbl_tracking.php?' . $url_query . '\">';",
          "",
          "[Added Lines]",
          "58:     $html .= '<form method=\"post\" action=\"tbl_tracking.php' . $url_query . '\">';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "157:     $action, $url_query, $last_version",
          "158: ) {",
          "159:     $html = '<div>';",
          "161:     $html .= '<fieldset>';",
          "162:     $html .= '<legend>';",
          "",
          "[Removed Lines]",
          "160:     $html .= '<form method=\"post\" action=\"tbl_tracking.php?' . $url_query . '\">';",
          "",
          "[Added Lines]",
          "160:     $html .= '<form method=\"post\" action=\"tbl_tracking.php' . $url_query . '\">';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "341: function PMA_getHtmlForSelectableTables($selectable_tables_sql_result, $url_query)",
          "342: {",
          "344:     $html .= '<select name=\"table\">';",
          "345:     while ($entries = $GLOBALS['dbi']->fetchArray($selectable_tables_sql_result)) {",
          "346:         if (PMA_Tracker::isTracked($entries['db_name'], $entries['table_name'])) {",
          "",
          "[Removed Lines]",
          "343:     $html = '<form method=\"post\" action=\"tbl_tracking.php?' . $url_query . '\">';",
          "",
          "[Added Lines]",
          "343:     $html = '<form method=\"post\" action=\"tbl_tracking.php' . $url_query . '\">';",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "386:     $filter_ts_from, $filter_users",
          "387: ) {",
          "388:     $html = '<h3>' . __('Tracking report')",
          "390:         . '</a>]</h3>';",
          "392:     $html .= '<small>' . __('Tracking statements') . ' '",
          "",
          "[Removed Lines]",
          "389:         . '  [<a href=\"tbl_tracking.php?' . $url_query . '\">' . __('Close')",
          "",
          "[Added Lines]",
          "389:         . '  [<a href=\"tbl_tracking.php' . $url_query . '\">' . __('Close')",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "793: function PMA_getHtmlForSchemaSnapshot($url_query)",
          "794: {",
          "795:     $html = '<h3>' . __('Structure snapshot')",
          "797:         . '</a>]</h3>';",
          "798:     $data = PMA_Tracker::getTrackedData(",
          "799:         $_REQUEST['db'], $_REQUEST['table'], $_REQUEST['version']",
          "",
          "[Removed Lines]",
          "796:         . '  [<a href=\"tbl_tracking.php?' . $url_query . '\">' . __('Close')",
          "",
          "[Added Lines]",
          "796:         . '  [<a href=\"tbl_tracking.php' . $url_query . '\">' . __('Close')",
          "",
          "---------------"
        ],
        "prefs_forms.php||prefs_forms.php": [
          "File: prefs_forms.php -> prefs_forms.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "45:     $url_params = array('form' => $form_param);",
          "46:     PMA_sendHeaderLocation(",
          "47:         $cfg['PmaAbsoluteUri'] . 'prefs_forms.php'",
          "49:     );",
          "50:     exit;",
          "51: }",
          "",
          "[Removed Lines]",
          "48:         . PMA_URL_getCommon($url_params, 'text', '&')",
          "",
          "[Added Lines]",
          "48:         . PMA_URL_getCommon($url_params, 'text')",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1b5592435617fa1b9dd68e2dc263de64c69fdc8a",
      "candidate_info": {
        "commit_hash": "1b5592435617fa1b9dd68e2dc263de64c69fdc8a",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/1b5592435617fa1b9dd68e2dc263de64c69fdc8a",
        "files": [
          "ChangeLog",
          "libraries/rte/rte_list.lib.php"
        ],
        "message": "bug #4488 [security] XSS injection due to unescaped table name (triggers)\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
          ],
          "candidate": [
            "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php": [
          "File: libraries/rte/rte_list.lib.php -> libraries/rte/rte_list.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "248:     $retval .= \"            </td>\\n\";",
          "249:     if (empty($table)) {",
          "250:         $retval .= \"            <td>\\n\";",
          "254:         $retval .= \"            </td>\\n\";",
          "255:     }",
          "256:     $retval .= \"            <td>\\n\";",
          "",
          "[Removed Lines]",
          "251:         $retval .= \"                <a href='db_triggers.php?{$url_query}\"",
          "252:                                      . \"&amp;table={$trigger['table']}'>\"",
          "253:                                      . $trigger['table'] . \"</a>\\n\";",
          "",
          "[Added Lines]",
          "251:         $retval .= \"<a href='db_triggers.php?{$url_query}\"",
          "252:             . \"&amp;table=\" . urlencode($trigger['table']) . \"'>\"",
          "253:             . urlencode($trigger['table']) . \"</a>\";",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "511c596b175889b8e6b9c423e352ca64fa20af2b",
      "candidate_info": {
        "commit_hash": "511c596b175889b8e6b9c423e352ca64fa20af2b",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/511c596b175889b8e6b9c423e352ca64fa20af2b",
        "files": [
          "ChangeLog",
          "libraries/rte/rte_list.lib.php"
        ],
        "message": "bug #4488 [security] XSS injection due to unescaped table name (triggers)\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
          ],
          "candidate": [
            "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/rte/rte_list.lib.php||libraries/rte/rte_list.lib.php": [
          "File: libraries/rte/rte_list.lib.php -> libraries/rte/rte_list.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "259:     $retval .= \"            </td>\\n\";",
          "260:     if (empty($table)) {",
          "261:         $retval .= \"            <td>\\n\";",
          "265:         $retval .= \"            </td>\\n\";",
          "266:     }",
          "267:     $retval .= \"            <td>\\n\";",
          "",
          "[Removed Lines]",
          "262:         $retval .= \"                <a href='db_triggers.php?{$url_query}\"",
          "263:                                      . \"&amp;table={$trigger['table']}'>\"",
          "264:                                      . $trigger['table'] . \"</a>\\n\";",
          "",
          "[Added Lines]",
          "262:         $retval .= \"<a href='db_triggers.php?{$url_query}\"",
          "263:             . \"&amp;table=\" . urlencode($trigger['table']) . \"'>\"",
          "264:             . urlencode($trigger['table']) . \"</a>\";",
          "",
          "---------------"
        ]
      }
    }
  ]
}