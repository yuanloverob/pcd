{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5cfe0b86d5be266ef51bbba369c39e412ee51944",
      "candidate_info": {
        "commit_hash": "5cfe0b86d5be266ef51bbba369c39e412ee51944",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/5cfe0b86d5be266ef51bbba369c39e412ee51944",
        "files": [
          "src/eio-emul.h"
        ],
        "message": "eio-emul: Cast eio_custom method to void(*)(eio_req*)",
        "before_after_code_files": [
          "src/eio-emul.h||src/eio-emul.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/eio-emul.h||src/eio-emul.h": [
          "File: src/eio-emul.h -> src/eio-emul.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "66: #  define eio_link(a,b,c,d,e)                 eio_link(a,b,c,d,e,(&uv_default_loop()->uv_eio_channel))",
          "67: #  define eio_symlink(a,b,c,d,e)              eio_symlink(a,b,c,d,e,(&uv_default_loop()->uv_eio_channel))",
          "68: #  define eio_rename(a,b,c,d,e)               eio_rename(a,b,c,d,e,(&uv_default_loop()->uv_eio_channel))",
          "70: #  define eio_grp(a,b)                        eio_grp(a,b,(&uv_default_loop()->uv_eio_channel))",
          "",
          "[Removed Lines]",
          "69: #  define eio_custom(a,b,c,d)                 eio_custom(a,b,c,d,(&uv_default_loop()->uv_eio_channel))",
          "",
          "[Added Lines]",
          "69: #  define eio_custom(a,b,c,d)                 eio_custom((void (*)(eio_req*))a,b,c,d,(&uv_default_loop()->uv_eio_channel))",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7161ecd31ba7639667ef9683a52172ab977be578",
      "candidate_info": {
        "commit_hash": "7161ecd31ba7639667ef9683a52172ab977be578",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/7161ecd31ba7639667ef9683a52172ab977be578",
        "files": [
          "tools/msvs/msi/product.wxs"
        ],
        "message": "windows/msi: fix adding node to PATH\n\nCloses #3366",
        "before_after_code_files": [
          "tools/msvs/msi/product.wxs||tools/msvs/msi/product.wxs"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tools/msvs/msi/product.wxs||tools/msvs/msi/product.wxs": [
          "File: tools/msvs/msi/product.wxs -> tools/msvs/msi/product.wxs",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:                          Name=\"PATH\"",
          "52:                          Part=\"last\"",
          "53:                          System=\"yes\"",
          "55:           </Component>",
          "56:           <Component Id=\"npmcmd\" Guid=\"31e9986d-74cd-44e1-878c-194d3e997d32\">",
          "57:             <File Id=\"filenpmcmd\" KeyPath=\"yes\" Source=\"$(var.NPMSourceDir)\\bin\\npm.cmd\" />",
          "",
          "[Removed Lines]",
          "54:                          Value=\"[NodeRoot]\" />",
          "",
          "[Added Lines]",
          "54:                          Value=\"[APPLICATIONROOTDIRECTORY]\" />",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "327286dbcdd91b9a6c983cdf307e36ac36acf05d",
      "candidate_info": {
        "commit_hash": "327286dbcdd91b9a6c983cdf307e36ac36acf05d",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/327286dbcdd91b9a6c983cdf307e36ac36acf05d",
        "files": [
          "lib/repl.js"
        ],
        "message": "repl: update the `repl` for the new `readline` behavior\n\nThis fixes the failing REPL tests.",
        "before_after_code_files": [
          "lib/repl.js||lirepl.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/repl.js||lirepl.js": [
          "File: lib/repl.js -> lirepl.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "176:   rli.setPrompt(self.prompt);",
          "179:     self.emit('exit');",
          "180:   });",
          "",
          "[Removed Lines]",
          "178:   rli.on('end', function() {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "187:     if (!(self.bufferedCommand && self.bufferedCommand.length > 0) && empty) {",
          "188:       if (sawSIGINT) {",
          "191:         sawSIGINT = false;",
          "192:         return;",
          "193:       }",
          "",
          "[Removed Lines]",
          "189:         rli.pause();",
          "190:         self.emit('exit');",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "807:   repl.defineCommand('exit', {",
          "808:     help: 'Exit the repl',",
          "809:     action: function() {",
          "812:     }",
          "813:   });",
          "",
          "[Removed Lines]",
          "810:       this.rli.pause();",
          "811:       this.emit('exit');",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d3b83726157a2700c4e90e9983b9dc5a205550ac",
      "candidate_info": {
        "commit_hash": "d3b83726157a2700c4e90e9983b9dc5a205550ac",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/d3b83726157a2700c4e90e9983b9dc5a205550ac",
        "files": [
          "lib/querystring.js"
        ],
        "message": "lint, missed in QS speed merge",
        "before_after_code_files": [
          "lib/querystring.js||liquerystring.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/querystring.js||liquerystring.js": [
          "File: lib/querystring.js -> liquerystring.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "192:     try {",
          "193:       k = decodeURIComponent(kstr);",
          "194:       v = decodeURIComponent(vstr);",
          "196:       k = QueryString.unescape(kstr, true);",
          "197:       v = QueryString.unescape(vstr, true);",
          "198:     }",
          "",
          "[Removed Lines]",
          "195:     } catch(e) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4671e54495a29696ae8e5f9bd17ba4c63f5d1b23",
      "candidate_info": {
        "commit_hash": "4671e54495a29696ae8e5f9bd17ba4c63f5d1b23",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/4671e54495a29696ae8e5f9bd17ba4c63f5d1b23",
        "files": [
          "lib/net.js"
        ],
        "message": "net: destroy socket on DNS error\n\nThe socket was never destroyed on DNS errors. This broke some clients, including\nlib/https.js.",
        "before_after_code_files": [
          "lib/net.js||linet.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/net.js||linet.js": [
          "File: lib/net.js -> linet.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "571:         process.nextTick(function() {",
          "572:           self.emit('error', err);",
          "573:         });",
          "574:       } else {",
          "575:         timers.active(self);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}