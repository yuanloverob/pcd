{
  "cve_id": "CVE-2013-6420",
  "cve_desc": "The asn1_time_to_time_t function in ext/openssl/openssl.c in PHP before 5.3.28, 5.4.x before 5.4.23, and 5.5.x before 5.5.7 does not properly parse (1) notBefore and (2) notAfter timestamps in X.509 certificates, which allows remote attackers to execute arbitrary code or cause a denial of service (memory corruption) via a crafted certificate that is not properly handled by the openssl_x509_parse function.",
  "repo": "php/php-src",
  "patch_hash": "c1224573c773b6845e83505f717fbf820fc18415",
  "patch_info": {
    "commit_hash": "c1224573c773b6845e83505f717fbf820fc18415",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/c1224573c773b6845e83505f717fbf820fc18415",
    "files": [
      "NEWS",
      "ext/openssl/openssl.c",
      "ext/openssl/tests/cve-2013-6420.crt",
      "ext/openssl/tests/cve-2013-6420.phpt"
    ],
    "message": "Fix CVE-2013-6420 - memory corruption in openssl_x509_parse",
    "before_after_code_files": [
      "ext/openssl/openssl.c||ext/openssl/openssl.c",
      "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt",
      "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt"
    ]
  },
  "patch_diff": {
    "ext/openssl/openssl.c||ext/openssl/openssl.c": [
      "File: ext/openssl/openssl.c -> ext/openssl/openssl.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "644:  char * thestr;",
      "645:  long gmadjust = 0;",
      "649:   return (time_t)-1;",
      "650:  }",
      "654:  memset(&thetime, 0, sizeof(thetime));",
      "660:  thetime.tm_sec = atoi(thestr);",
      "",
      "[Removed Lines]",
      "647:  if (timestr->length < 13) {",
      "648:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"extension author too lazy to parse %s correctly\", timestr->data);",
      "652:  strbuf = estrdup((char *)timestr->data);",
      "658:  thestr = strbuf + timestr->length - 3;",
      "",
      "[Added Lines]",
      "647:  if (ASN1_STRING_type(timestr) != V_ASN1_UTCTIME) {",
      "648:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"illegal ASN1 data type for timestamp\");",
      "652:  if (ASN1_STRING_length(timestr) != strlen(ASN1_STRING_data(timestr))) {",
      "653:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"illegal length in timestamp\");",
      "654:   return (time_t)-1;",
      "655:  }",
      "657:  if (ASN1_STRING_length(timestr) < 13) {",
      "658:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"unable to parse time string %s correctly\", timestr->data);",
      "659:   return (time_t)-1;",
      "660:  }",
      "662:  strbuf = estrdup((char *)ASN1_STRING_data(timestr));",
      "668:  thestr = strbuf + ASN1_STRING_length(timestr) - 3;",
      "",
      "---------------"
    ],
    "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt": [
      "File: ext/openssl/tests/cve-2013-6420.crt -> ext/openssl/tests/cve-2013-6420.crt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: -----BEGIN CERTIFICATE-----",
      "2: MIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD",
      "3: VQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH",
      "4: S8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91",
      "5: cyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k",
      "6: ZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY",
      "7: ZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
      "8: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
      "9: AAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO",
      "10: b3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT",
      "11: ZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G",
      "12: A1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz",
      "13: dGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB",
      "14: DwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt/8PaDoqBu",
      "15: wEYT/Na+6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z+S4SHRZ7e2dDIjPjdhjh",
      "16: 0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8",
      "17: pkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9+KAokPrPcN5KLKebz7mLpk6",
      "18: SMeEXOKP4idEqxyQ7O7fBuHMedsQhu+prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX",
      "19: 1nfFIt9DbGvHTcyOuN+nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw",
      "20: EQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF",
      "21: BQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc+1SnoaPR+vI8C8CaD",
      "22: 8+0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl",
      "23: VArzG/KxQohGD2JeqkhIMlDomxHO7ka39+Oa8i2vWLVyjU8AZvWMAruHa4EENyG7",
      "24: lW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1+Mq03uR3ZXPBYdyV8319",
      "25: o0lVj1KFI2DCL/liWisJRoof+1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg",
      "26: Zsfmc2vC1/qOlNuNq/0TzzkVGv8ETT3CgaU+UXe4XOVvkccebJn2dg==",
      "27: -----END CERTIFICATE-----",
      "",
      "---------------"
    ],
    "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt": [
      "File: ext/openssl/tests/cve-2013-6420.phpt -> ext/openssl/tests/cve-2013-6420.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: CVE-2013-6420",
      "3: --SKIPIF--",
      "4: <?php",
      "5: if (!extension_loaded(\"openssl\")) die(\"skip\");",
      "6: ?>",
      "7: --FILE--",
      "8: <?php",
      "9: $crt = substr(__FILE__, 0, -4).'.crt';",
      "10: $info = openssl_x509_parse(\"file://$crt\");",
      "11: var_dump($info['issuer']['emailAddress'], $info[\"validFrom_time_t\"]);",
      "12: ?>",
      "13: Done",
      "14: --EXPECTF--",
      "15: %s openssl_x509_parse(): illegal ASN1 data type for timestamp in %s/cve-2013-6420.php on line 3",
      "16: string(27) \"stefan.esser@sektioneins.de\"",
      "17: int(-1)",
      "18: Done",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "b4a4db467b6a1e90131705832f1a3613a60c4259",
      "candidate_info": {
        "commit_hash": "b4a4db467b6a1e90131705832f1a3613a60c4259",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/b4a4db467b6a1e90131705832f1a3613a60c4259",
        "files": [
          "NEWS",
          "ext/com_dotnet/com_com.c",
          "ext/openssl/openssl.c",
          "ext/openssl/tests/026.phpt",
          "ext/session/session.c"
        ],
        "message": "Fix missing type checks in various functions",
        "before_after_code_files": [
          "ext/com_dotnet/com_com.c||ext/com_dotnet/com_com.c",
          "ext/openssl/openssl.c||ext/openssl/openssl.c",
          "ext/openssl/tests/026.phpt||ext/openssl/tests/026.phpt",
          "ext/session/session.c||ext/session/session.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/openssl/openssl.c||ext/openssl/openssl.c"
          ],
          "candidate": [
            "ext/openssl/openssl.c||ext/openssl/openssl.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/com_dotnet/com_com.c||ext/com_dotnet/com_com.c": [
          "File: ext/com_dotnet/com_com.c -> ext/com_dotnet/com_com.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "699:   zval **tmp;",
          "702:    typelibname = Z_STRVAL_PP(tmp);",
          "704:    dispname = Z_STRVAL_PP(tmp);",
          "705:  } else if (sink != NULL) {",
          "706:   convert_to_string(sink);",
          "",
          "[Removed Lines]",
          "701:   if (zend_hash_index_find(Z_ARRVAL_P(sink), 0, (void**)&tmp) == SUCCESS)",
          "703:   if (zend_hash_index_find(Z_ARRVAL_P(sink), 1, (void**)&tmp) == SUCCESS)",
          "",
          "[Added Lines]",
          "701:   if (zend_hash_index_find(Z_ARRVAL_P(sink), 0, (void**)&tmp) == SUCCESS && Z_TYPE_PP(tmp) == IS_STRING)",
          "703:   if (zend_hash_index_find(Z_ARRVAL_P(sink), 1, (void**)&tmp) == SUCCESS && Z_TYPE_PP(tmp) == IS_STRING)",
          "",
          "---------------"
        ],
        "ext/openssl/openssl.c||ext/openssl/openssl.c": [
          "File: ext/openssl/openssl.c -> ext/openssl/openssl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "654:   return (time_t)-1;",
          "655:  }",
          "658:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"illegal length in timestamp\");",
          "659:   return (time_t)-1;",
          "660:  }",
          "",
          "[Removed Lines]",
          "657:  if (ASN1_STRING_length(timestr) != strlen(ASN1_STRING_data(timestr))) {",
          "",
          "[Added Lines]",
          "657:  if (ASN1_STRING_length(timestr) != strlen((char *)ASN1_STRING_data(timestr))) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "782:    req->config_filename, req->var, req->req_config TSRMLS_CC) == FAILURE) return FAILURE",
          "784: #define SET_OPTIONAL_STRING_ARG(key, varname, defval) \\",
          "786:   varname = Z_STRVAL_PP(item); \\",
          "787:  else \\",
          "788:   varname = defval",
          "790: #define SET_OPTIONAL_LONG_ARG(key, varname, defval) \\",
          "792:   varname = Z_LVAL_PP(item); \\",
          "793:  else \\",
          "794:   varname = defval",
          "",
          "[Removed Lines]",
          "785:  if (optional_args && zend_hash_find(Z_ARRVAL_P(optional_args), key, sizeof(key), (void**)&item) == SUCCESS) \\",
          "791:  if (optional_args && zend_hash_find(Z_ARRVAL_P(optional_args), key, sizeof(key), (void**)&item) == SUCCESS) \\",
          "",
          "[Added Lines]",
          "785:  if (optional_args && zend_hash_find(Z_ARRVAL_P(optional_args), key, sizeof(key), (void**)&item) == SUCCESS && Z_TYPE_PP(item) == IS_STRING) \\",
          "791:  if (optional_args && zend_hash_find(Z_ARRVAL_P(optional_args), key, sizeof(key), (void**)&item) == SUCCESS && Z_TYPE_PP(item) == IS_LONG) \\",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "847:   }",
          "848:  }",
          "851:   long cipher_algo = Z_LVAL_PP(item);",
          "852:   const EVP_CIPHER* cipher = php_openssl_get_evp_cipher_from_algo(cipher_algo);",
          "853:   if (cipher == NULL) {",
          "",
          "[Removed Lines]",
          "850:  if (req->priv_key_encrypt && optional_args && zend_hash_find(Z_ARRVAL_P(optional_args), \"encrypt_key_cipher\", sizeof(\"encrypt_key_cipher\"), (void**)&item) == SUCCESS) {",
          "",
          "[Added Lines]",
          "850:  if (req->priv_key_encrypt && optional_args && zend_hash_find(Z_ARRVAL_P(optional_args), \"encrypt_key_cipher\", sizeof(\"encrypt_key_cipher\"), (void**)&item) == SUCCESS",
          "851:   && Z_TYPE_PP(item) == IS_LONG) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1962:  }",
          "1966:   friendly_name = Z_STRVAL_PP(item);",
          "1968:     keypbe (default 3DES)",
          "",
          "[Removed Lines]",
          "1965:  if (args && zend_hash_find(Z_ARRVAL_P(args), \"friendly_name\", sizeof(\"friendly_name\"), (void**)&item) == SUCCESS)",
          "",
          "[Added Lines]",
          "1966:  if (args && zend_hash_find(Z_ARRVAL_P(args), \"friendly_name\", sizeof(\"friendly_name\"), (void**)&item) == SUCCESS && Z_TYPE_PP(item) == IS_STRING)",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2040:  }",
          "2044:   friendly_name = Z_STRVAL_PP(item);",
          "2046:  if (args && zend_hash_find(Z_ARRVAL_P(args), \"extracerts\", sizeof(\"extracerts\"), (void**)&item) == SUCCESS)",
          "",
          "[Removed Lines]",
          "2043:  if (args && zend_hash_find(Z_ARRVAL_P(args), \"friendly_name\", sizeof(\"friendly_name\"), (void**)&item) == SUCCESS)",
          "",
          "[Added Lines]",
          "2044:  if (args && zend_hash_find(Z_ARRVAL_P(args), \"friendly_name\", sizeof(\"friendly_name\"), (void**)&item) == SUCCESS && Z_TYPE_PP(item) == IS_STRING)",
          "",
          "---------------"
        ],
        "ext/openssl/tests/026.phpt||ext/openssl/tests/026.phpt": [
          "File: ext/openssl/tests/026.phpt -> ext/openssl/tests/026.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Options type checks",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded(\"openssl\")) print \"skip\"; ?>",
          "5: --FILE--",
          "6: <?php",
          "7: $x = openssl_pkey_new();",
          "8: $csr = openssl_csr_new([\"countryName\" => \"DE\"], $x, [\"x509_extensions\" => 0xDEADBEEF]);",
          "9: ?>",
          "10: DONE",
          "11: --EXPECT--",
          "12: DONE",
          "",
          "---------------"
        ],
        "ext/session/session.c||ext/session/session.c": [
          "File: ext/session/session.c -> ext/session/session.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "297:  if (zend_hash_find(&EG(symbol_table), \"_SERVER\", sizeof(\"_SERVER\"), (void **) &array) == SUCCESS &&",
          "298:   Z_TYPE_PP(array) == IS_ARRAY &&",
          "300:  ) {",
          "301:   remote_addr = Z_STRVAL_PP(token);",
          "302:  }",
          "",
          "[Removed Lines]",
          "299:   zend_hash_find(Z_ARRVAL_PP(array), \"REMOTE_ADDR\", sizeof(\"REMOTE_ADDR\"), (void **) &token) == SUCCESS",
          "",
          "[Added Lines]",
          "299:   zend_hash_find(Z_ARRVAL_PP(array), \"REMOTE_ADDR\", sizeof(\"REMOTE_ADDR\"), (void **) &token) == SUCCESS &&",
          "300:   Z_TYPE_PP(token) == IS_STRING",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c7fb8f4f017dcac6bf478f900cb5fca3031616a3",
      "candidate_info": {
        "commit_hash": "c7fb8f4f017dcac6bf478f900cb5fca3031616a3",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/c7fb8f4f017dcac6bf478f900cb5fca3031616a3",
        "files": [
          "NEWS",
          "ext/openssl/openssl.c",
          "ext/openssl/tests/cve-2013-6420.crt",
          "ext/openssl/tests/cve-2013-6420.phpt"
        ],
        "message": "Fix CVE-2013-6420 - memory corruption in openssl_x509_parse",
        "before_after_code_files": [
          "ext/openssl/openssl.c||ext/openssl/openssl.c",
          "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt",
          "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/openssl/openssl.c||ext/openssl/openssl.c",
            "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt",
            "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt"
          ],
          "candidate": [
            "ext/openssl/openssl.c||ext/openssl/openssl.c",
            "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt",
            "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/openssl/openssl.c||ext/openssl/openssl.c": [
          "File: ext/openssl/openssl.c -> ext/openssl/openssl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "645:  char * thestr;",
          "646:  long gmadjust = 0;",
          "650:   return (time_t)-1;",
          "651:  }",
          "655:  memset(&thetime, 0, sizeof(thetime));",
          "661:  thetime.tm_sec = atoi(thestr);",
          "",
          "[Removed Lines]",
          "648:  if (timestr->length < 13) {",
          "649:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"extension author too lazy to parse %s correctly\", timestr->data);",
          "653:  strbuf = estrdup((char *)timestr->data);",
          "659:  thestr = strbuf + timestr->length - 3;",
          "",
          "[Added Lines]",
          "648:  if (ASN1_STRING_type(timestr) != V_ASN1_UTCTIME) {",
          "649:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"illegal ASN1 data type for timestamp\");",
          "653:  if (ASN1_STRING_length(timestr) != strlen(ASN1_STRING_data(timestr))) {",
          "654:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"illegal length in timestamp\");",
          "655:   return (time_t)-1;",
          "656:  }",
          "658:  if (ASN1_STRING_length(timestr) < 13) {",
          "659:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"unable to parse time string %s correctly\", timestr->data);",
          "660:   return (time_t)-1;",
          "661:  }",
          "663:  strbuf = estrdup((char *)ASN1_STRING_data(timestr));",
          "669:  thestr = strbuf + ASN1_STRING_length(timestr) - 3;",
          "",
          "---------------"
        ],
        "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt": [
          "File: ext/openssl/tests/cve-2013-6420.crt -> ext/openssl/tests/cve-2013-6420.crt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: -----BEGIN CERTIFICATE-----",
          "2: MIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD",
          "3: VQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH",
          "4: S8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91",
          "5: cyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k",
          "6: ZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY",
          "7: ZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
          "8: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
          "9: AAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO",
          "10: b3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT",
          "11: ZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G",
          "12: A1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz",
          "13: dGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB",
          "14: DwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt/8PaDoqBu",
          "15: wEYT/Na+6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z+S4SHRZ7e2dDIjPjdhjh",
          "16: 0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8",
          "17: pkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9+KAokPrPcN5KLKebz7mLpk6",
          "18: SMeEXOKP4idEqxyQ7O7fBuHMedsQhu+prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX",
          "19: 1nfFIt9DbGvHTcyOuN+nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw",
          "20: EQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF",
          "21: BQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc+1SnoaPR+vI8C8CaD",
          "22: 8+0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl",
          "23: VArzG/KxQohGD2JeqkhIMlDomxHO7ka39+Oa8i2vWLVyjU8AZvWMAruHa4EENyG7",
          "24: lW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1+Mq03uR3ZXPBYdyV8319",
          "25: o0lVj1KFI2DCL/liWisJRoof+1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg",
          "26: Zsfmc2vC1/qOlNuNq/0TzzkVGv8ETT3CgaU+UXe4XOVvkccebJn2dg==",
          "27: -----END CERTIFICATE-----",
          "",
          "---------------"
        ],
        "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt": [
          "File: ext/openssl/tests/cve-2013-6420.phpt -> ext/openssl/tests/cve-2013-6420.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: CVE-2013-6420",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded(\"openssl\")) die(\"skip\");",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "9: $crt = substr(__FILE__, 0, -4).'.crt';",
          "10: $info = openssl_x509_parse(\"file://$crt\");",
          "11: var_dump($info['issuer']['emailAddress'], $info[\"validFrom_time_t\"]);",
          "12: ?>",
          "13: Done",
          "14: --EXPECTF--",
          "15: %s openssl_x509_parse(): illegal ASN1 data type for timestamp in %s/cve-2013-6420.php on line 3",
          "16: string(27) \"stefan.esser@sektioneins.de\"",
          "17: int(-1)",
          "18: Done",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "073d24bb50eeab6b592d044c71e530afac0a474a",
      "candidate_info": {
        "commit_hash": "073d24bb50eeab6b592d044c71e530afac0a474a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/073d24bb50eeab6b592d044c71e530afac0a474a",
        "files": [
          "ext/openssl/openssl.c",
          "ext/openssl/tests/cve-2013-6420.crt",
          "ext/openssl/tests/cve-2013-6420.phpt"
        ],
        "message": "Merge branch 'PHP-5.4' into PHP-5.5\n\n* PHP-5.4:\n  5.3.29-dev\n  Fix CVE-2013-6420 - memory corruption in openssl_x509_parse",
        "before_after_code_files": [
          "ext/openssl/openssl.c||ext/openssl/openssl.c",
          "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt",
          "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "ext/openssl/openssl.c||ext/openssl/openssl.c",
            "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt",
            "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt"
          ],
          "candidate": [
            "ext/openssl/openssl.c||ext/openssl/openssl.c",
            "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt",
            "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/openssl/openssl.c||ext/openssl/openssl.c": [
          "File: ext/openssl/openssl.c -> ext/openssl/openssl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "657:  char * thestr;",
          "658:  long gmadjust = 0;",
          "662:   return (time_t)-1;",
          "663:  }",
          "667:  memset(&thetime, 0, sizeof(thetime));",
          "673:  thetime.tm_sec = atoi(thestr);",
          "",
          "[Removed Lines]",
          "660:  if (timestr->length < 13) {",
          "661:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"extension author too lazy to parse %s correctly\", timestr->data);",
          "665:  strbuf = estrdup((char *)timestr->data);",
          "671:  thestr = strbuf + timestr->length - 3;",
          "",
          "[Added Lines]",
          "660:  if (ASN1_STRING_type(timestr) != V_ASN1_UTCTIME) {",
          "661:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"illegal ASN1 data type for timestamp\");",
          "665:  if (ASN1_STRING_length(timestr) != strlen(ASN1_STRING_data(timestr))) {",
          "666:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"illegal length in timestamp\");",
          "667:   return (time_t)-1;",
          "668:  }",
          "670:  if (ASN1_STRING_length(timestr) < 13) {",
          "671:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"unable to parse time string %s correctly\", timestr->data);",
          "672:   return (time_t)-1;",
          "673:  }",
          "675:  strbuf = estrdup((char *)ASN1_STRING_data(timestr));",
          "681:  thestr = strbuf + ASN1_STRING_length(timestr) - 3;",
          "",
          "---------------"
        ],
        "ext/openssl/tests/cve-2013-6420.crt||ext/openssl/tests/cve-2013-6420.crt": [
          "File: ext/openssl/tests/cve-2013-6420.crt -> ext/openssl/tests/cve-2013-6420.crt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: -----BEGIN CERTIFICATE-----",
          "2: MIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD",
          "3: VQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH",
          "4: S8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91",
          "5: cyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k",
          "6: ZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY",
          "7: ZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
          "8: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
          "9: AAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO",
          "10: b3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT",
          "11: ZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G",
          "12: A1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz",
          "13: dGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB",
          "14: DwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt/8PaDoqBu",
          "15: wEYT/Na+6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z+S4SHRZ7e2dDIjPjdhjh",
          "16: 0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8",
          "17: pkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9+KAokPrPcN5KLKebz7mLpk6",
          "18: SMeEXOKP4idEqxyQ7O7fBuHMedsQhu+prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX",
          "19: 1nfFIt9DbGvHTcyOuN+nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw",
          "20: EQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF",
          "21: BQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc+1SnoaPR+vI8C8CaD",
          "22: 8+0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl",
          "23: VArzG/KxQohGD2JeqkhIMlDomxHO7ka39+Oa8i2vWLVyjU8AZvWMAruHa4EENyG7",
          "24: lW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1+Mq03uR3ZXPBYdyV8319",
          "25: o0lVj1KFI2DCL/liWisJRoof+1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg",
          "26: Zsfmc2vC1/qOlNuNq/0TzzkVGv8ETT3CgaU+UXe4XOVvkccebJn2dg==",
          "27: -----END CERTIFICATE-----",
          "",
          "---------------"
        ],
        "ext/openssl/tests/cve-2013-6420.phpt||ext/openssl/tests/cve-2013-6420.phpt": [
          "File: ext/openssl/tests/cve-2013-6420.phpt -> ext/openssl/tests/cve-2013-6420.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: CVE-2013-6420",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded(\"openssl\")) die(\"skip\");",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "9: $crt = substr(__FILE__, 0, -4).'.crt';",
          "10: $info = openssl_x509_parse(\"file://$crt\");",
          "11: var_dump($info['issuer']['emailAddress'], $info[\"validFrom_time_t\"]);",
          "12: ?>",
          "13: Done",
          "14: --EXPECTF--",
          "15: %s openssl_x509_parse(): illegal ASN1 data type for timestamp in %s/cve-2013-6420.php on line 3",
          "16: string(27) \"stefan.esser@sektioneins.de\"",
          "17: int(-1)",
          "18: Done",
          "",
          "---------------"
        ]
      }
    }
  ]
}