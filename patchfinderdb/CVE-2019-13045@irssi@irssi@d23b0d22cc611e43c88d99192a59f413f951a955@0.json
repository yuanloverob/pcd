{
  "cve_id": "CVE-2019-13045",
  "cve_desc": "Irssi before 1.0.8, 1.1.x before 1.1.3, and 1.2.x before 1.2.1, when SASL is enabled, has a use after free when sending SASL login to the server.",
  "repo": "irssi/irssi",
  "patch_hash": "d23b0d22cc611e43c88d99192a59f413f951a955",
  "patch_info": {
    "commit_hash": "d23b0d22cc611e43c88d99192a59f413f951a955",
    "repo": "irssi/irssi",
    "commit_url": "https://github.com/irssi/irssi/commit/d23b0d22cc611e43c88d99192a59f413f951a955",
    "files": [
      "src/irc/core/irc-core.c",
      "src/irc/core/irc-servers-reconnect.c",
      "src/irc/core/irc-servers-setup.c",
      "src/fe-text/gui-printtext.c"
    ],
    "message": "Merge pull request #1058 from ailin-nemui/sasl-reconnect\n\ncopy sasl username and password values",
    "before_after_code_files": [
      "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
      "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
      "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
    ]
  },
  "patch_diff": {
    "src/irc/core/irc-core.c||src/irc/core/irc-core.c": [
      "File: src/irc/core/irc-core.c -> src/irc/core/irc-core.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "76:  g_free_not_null(ircconn->usermode);",
      "77:  g_free_not_null(ircconn->alternate_nick);",
      "78: }",
      "80: void irc_core_init(void)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "78:  g_free_not_null(ircconn->sasl_username);",
      "79:  g_free_not_null(ircconn->sasl_password);",
      "",
      "---------------"
    ],
    "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c": [
      "File: src/irc/core/irc-servers-reconnect.c -> src/irc/core/irc-servers-reconnect.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "49:  rec->usermode = g_strdup(src->usermode);",
      "50:  rec->alternate_nick = g_strdup(src->alternate_nick);",
      "51:  rec->sasl_mechanism = src->sasl_mechanism;",
      "55: }",
      "",
      "[Removed Lines]",
      "52:  rec->sasl_username = src->sasl_username;",
      "53:  rec->sasl_password = src->sasl_password;",
      "",
      "[Added Lines]",
      "52:  rec->sasl_username = g_strdup(src->sasl_username);",
      "53:  rec->sasl_password = g_strdup(src->sasl_password);",
      "",
      "---------------"
    ],
    "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c": [
      "File: src/irc/core/irc-servers-setup.c -> src/irc/core/irc-servers-setup.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "101:    conn->sasl_mechanism = SASL_MECHANISM_PLAIN;",
      "102:    if (ircnet->sasl_username != NULL && *ircnet->sasl_username &&",
      "103:        ircnet->sasl_password != NULL && *ircnet->sasl_password) {",
      "106:    } else",
      "107:     g_warning(\"The fields sasl_username and sasl_password are either missing or empty\");",
      "108:   }",
      "",
      "[Removed Lines]",
      "104:     conn->sasl_username = ircnet->sasl_username;",
      "105:     conn->sasl_password = ircnet->sasl_password;",
      "",
      "[Added Lines]",
      "104:     conn->sasl_username = g_strdup(ircnet->sasl_username);",
      "105:     conn->sasl_password = g_strdup(ircnet->sasl_password);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c9f1b25a7f5b02bf83612f58eb0928a35c89bbfc",
      "candidate_info": {
        "commit_hash": "c9f1b25a7f5b02bf83612f58eb0928a35c89bbfc",
        "repo": "irssi/irssi",
        "commit_url": "https://github.com/irssi/irssi/commit/c9f1b25a7f5b02bf83612f58eb0928a35c89bbfc",
        "files": [
          "src/irc/core/irc-core.c",
          "src/irc/core/irc-servers-reconnect.c",
          "src/irc/core/irc-servers-setup.c"
        ],
        "message": "Merge pull request #1058 from ailin-nemui/sasl-reconnect\n\ncopy sasl username and password values\n\n(cherry picked from commit d23b0d22cc611e43c88d99192a59f413f951a955)",
        "before_after_code_files": [
          "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
          "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
          "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
            "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
            "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
          ],
          "candidate": [
            "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
            "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
            "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
          ]
        }
      },
      "candidate_diff": {
        "src/irc/core/irc-core.c||src/irc/core/irc-core.c": [
          "File: src/irc/core/irc-core.c -> src/irc/core/irc-core.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:  g_free_not_null(ircconn->usermode);",
          "77:  g_free_not_null(ircconn->alternate_nick);",
          "78: }",
          "80: void irc_core_init(void)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "78:  g_free_not_null(ircconn->sasl_username);",
          "79:  g_free_not_null(ircconn->sasl_password);",
          "",
          "---------------"
        ],
        "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c": [
          "File: src/irc/core/irc-servers-reconnect.c -> src/irc/core/irc-servers-reconnect.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:  rec->usermode = g_strdup(src->usermode);",
          "50:  rec->alternate_nick = g_strdup(src->alternate_nick);",
          "51:  rec->sasl_mechanism = src->sasl_mechanism;",
          "55: }",
          "",
          "[Removed Lines]",
          "52:  rec->sasl_username = src->sasl_username;",
          "53:  rec->sasl_password = src->sasl_password;",
          "",
          "[Added Lines]",
          "52:  rec->sasl_username = g_strdup(src->sasl_username);",
          "53:  rec->sasl_password = g_strdup(src->sasl_password);",
          "",
          "---------------"
        ],
        "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c": [
          "File: src/irc/core/irc-servers-setup.c -> src/irc/core/irc-servers-setup.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "98:    if (ircnet->sasl_username != NULL && *ircnet->sasl_username &&",
          "99:        ircnet->sasl_password != NULL && *ircnet->sasl_password) {",
          "100:     conn->sasl_mechanism = SASL_MECHANISM_PLAIN;",
          "103:    } else",
          "104:     g_warning(\"The fields sasl_username and sasl_password are either missing or empty\");",
          "105:   }",
          "",
          "[Removed Lines]",
          "101:     conn->sasl_username = ircnet->sasl_username;",
          "102:     conn->sasl_password = ircnet->sasl_password;",
          "",
          "[Added Lines]",
          "101:     conn->sasl_username = g_strdup(ircnet->sasl_username);",
          "102:     conn->sasl_password = g_strdup(ircnet->sasl_password);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d0aa8af0d75cc181a3e1d15eb70c3de16c525e38",
      "candidate_info": {
        "commit_hash": "d0aa8af0d75cc181a3e1d15eb70c3de16c525e38",
        "repo": "irssi/irssi",
        "commit_url": "https://github.com/irssi/irssi/commit/d0aa8af0d75cc181a3e1d15eb70c3de16c525e38",
        "files": [
          "src/irc/core/irc-core.c",
          "src/irc/core/irc-servers-reconnect.c",
          "src/irc/core/irc-servers-setup.c"
        ],
        "message": "Merge pull request #1058 from ailin-nemui/sasl-reconnect\n\ncopy sasl username and password values\n\n(cherry picked from commit d23b0d22cc611e43c88d99192a59f413f951a955)",
        "before_after_code_files": [
          "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
          "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
          "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
            "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
            "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
          ],
          "candidate": [
            "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
            "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
            "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
          ]
        }
      },
      "candidate_diff": {
        "src/irc/core/irc-core.c||src/irc/core/irc-core.c": [
          "File: src/irc/core/irc-core.c -> src/irc/core/irc-core.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:  g_free_not_null(ircconn->usermode);",
          "77:  g_free_not_null(ircconn->alternate_nick);",
          "78: }",
          "80: void irc_core_init(void)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "78:  g_free_not_null(ircconn->sasl_username);",
          "79:  g_free_not_null(ircconn->sasl_password);",
          "",
          "---------------"
        ],
        "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c": [
          "File: src/irc/core/irc-servers-reconnect.c -> src/irc/core/irc-servers-reconnect.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:  rec->usermode = g_strdup(src->usermode);",
          "50:  rec->alternate_nick = g_strdup(src->alternate_nick);",
          "51:  rec->sasl_mechanism = src->sasl_mechanism;",
          "55: }",
          "",
          "[Removed Lines]",
          "52:  rec->sasl_username = src->sasl_username;",
          "53:  rec->sasl_password = src->sasl_password;",
          "",
          "[Added Lines]",
          "52:  rec->sasl_username = g_strdup(src->sasl_username);",
          "53:  rec->sasl_password = g_strdup(src->sasl_password);",
          "",
          "---------------"
        ],
        "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c": [
          "File: src/irc/core/irc-servers-setup.c -> src/irc/core/irc-servers-setup.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "101:    if (ircnet->sasl_username != NULL && *ircnet->sasl_username &&",
          "102:        ircnet->sasl_password != NULL && *ircnet->sasl_password) {",
          "103:     conn->sasl_mechanism = SASL_MECHANISM_PLAIN;",
          "106:    } else",
          "107:     g_warning(\"The fields sasl_username and sasl_password are either missing or empty\");",
          "108:   }",
          "",
          "[Removed Lines]",
          "104:     conn->sasl_username = ircnet->sasl_username;",
          "105:     conn->sasl_password = ircnet->sasl_password;",
          "",
          "[Added Lines]",
          "104:     conn->sasl_username = g_strdup(ircnet->sasl_username);",
          "105:     conn->sasl_password = g_strdup(ircnet->sasl_password);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "27c02a2d961e83e5c509bbcaca3e01825bfbc9df",
      "candidate_info": {
        "commit_hash": "27c02a2d961e83e5c509bbcaca3e01825bfbc9df",
        "repo": "irssi/irssi",
        "commit_url": "https://github.com/irssi/irssi/commit/27c02a2d961e83e5c509bbcaca3e01825bfbc9df",
        "files": [
          "src/irc/core/irc-core.c",
          "src/irc/core/irc-servers-reconnect.c",
          "src/irc/core/irc-servers-setup.c"
        ],
        "message": "Merge pull request #1058 from ailin-nemui/sasl-reconnect\n\ncopy sasl username and password values\n\n(cherry picked from commit d23b0d22cc611e43c88d99192a59f413f951a955)",
        "before_after_code_files": [
          "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
          "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
          "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
            "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
            "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
          ],
          "candidate": [
            "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
            "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
            "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
          ]
        }
      },
      "candidate_diff": {
        "src/irc/core/irc-core.c||src/irc/core/irc-core.c": [
          "File: src/irc/core/irc-core.c -> src/irc/core/irc-core.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:  g_free_not_null(ircconn->usermode);",
          "77:  g_free_not_null(ircconn->alternate_nick);",
          "78: }",
          "80: void irc_core_init(void)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "78:  g_free_not_null(ircconn->sasl_username);",
          "79:  g_free_not_null(ircconn->sasl_password);",
          "",
          "---------------"
        ],
        "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c": [
          "File: src/irc/core/irc-servers-reconnect.c -> src/irc/core/irc-servers-reconnect.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:  rec->usermode = g_strdup(src->usermode);",
          "50:  rec->alternate_nick = g_strdup(src->alternate_nick);",
          "51:  rec->sasl_mechanism = src->sasl_mechanism;",
          "55: }",
          "",
          "[Removed Lines]",
          "52:  rec->sasl_username = src->sasl_username;",
          "53:  rec->sasl_password = src->sasl_password;",
          "",
          "[Added Lines]",
          "52:  rec->sasl_username = g_strdup(src->sasl_username);",
          "53:  rec->sasl_password = g_strdup(src->sasl_password);",
          "",
          "---------------"
        ],
        "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c": [
          "File: src/irc/core/irc-servers-setup.c -> src/irc/core/irc-servers-setup.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "101:    conn->sasl_mechanism = SASL_MECHANISM_PLAIN;",
          "102:    if (ircnet->sasl_username != NULL && *ircnet->sasl_username &&",
          "103:        ircnet->sasl_password != NULL && *ircnet->sasl_password) {",
          "106:    } else",
          "107:     g_warning(\"The fields sasl_username and sasl_password are either missing or empty\");",
          "108:   }",
          "",
          "[Removed Lines]",
          "104:     conn->sasl_username = ircnet->sasl_username;",
          "105:     conn->sasl_password = ircnet->sasl_password;",
          "",
          "[Added Lines]",
          "104:     conn->sasl_username = g_strdup(ircnet->sasl_username);",
          "105:     conn->sasl_password = g_strdup(ircnet->sasl_password);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5a67b983dc97caeb5df1139aabd0bc4f260a47d8",
      "candidate_info": {
        "commit_hash": "5a67b983dc97caeb5df1139aabd0bc4f260a47d8",
        "repo": "irssi/irssi",
        "commit_url": "https://github.com/irssi/irssi/commit/5a67b983dc97caeb5df1139aabd0bc4f260a47d8",
        "files": [
          "src/irc/core/irc-core.c",
          "src/irc/core/irc-servers-reconnect.c",
          "src/irc/core/irc-servers-setup.c"
        ],
        "message": "copy sasl username and password values",
        "before_after_code_files": [
          "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
          "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
          "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/irssi/irssi/pull/1058"
        ],
        "olp_code_files": {
          "patch": [
            "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
            "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
            "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
          ],
          "candidate": [
            "src/irc/core/irc-core.c||src/irc/core/irc-core.c",
            "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c",
            "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c"
          ]
        }
      },
      "candidate_diff": {
        "src/irc/core/irc-core.c||src/irc/core/irc-core.c": [
          "File: src/irc/core/irc-core.c -> src/irc/core/irc-core.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:  g_free_not_null(ircconn->usermode);",
          "77:  g_free_not_null(ircconn->alternate_nick);",
          "78: }",
          "80: void irc_core_init(void)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "78:  g_free_not_null(ircconn->sasl_username);",
          "79:  g_free_not_null(ircconn->sasl_password);",
          "",
          "---------------"
        ],
        "src/irc/core/irc-servers-reconnect.c||src/irc/core/irc-servers-reconnect.c": [
          "File: src/irc/core/irc-servers-reconnect.c -> src/irc/core/irc-servers-reconnect.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:  rec->usermode = g_strdup(src->usermode);",
          "50:  rec->alternate_nick = g_strdup(src->alternate_nick);",
          "51:  rec->sasl_mechanism = src->sasl_mechanism;",
          "55: }",
          "",
          "[Removed Lines]",
          "52:  rec->sasl_username = src->sasl_username;",
          "53:  rec->sasl_password = src->sasl_password;",
          "",
          "[Added Lines]",
          "52:  rec->sasl_username = g_strdup(src->sasl_username);",
          "53:  rec->sasl_password = g_strdup(src->sasl_password);",
          "",
          "---------------"
        ],
        "src/irc/core/irc-servers-setup.c||src/irc/core/irc-servers-setup.c": [
          "File: src/irc/core/irc-servers-setup.c -> src/irc/core/irc-servers-setup.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "101:    conn->sasl_mechanism = SASL_MECHANISM_PLAIN;",
          "102:    if (ircnet->sasl_username != NULL && *ircnet->sasl_username &&",
          "103:        ircnet->sasl_password != NULL && *ircnet->sasl_password) {",
          "106:    } else",
          "107:     g_warning(\"The fields sasl_username and sasl_password are either missing or empty\");",
          "108:   }",
          "",
          "[Removed Lines]",
          "104:     conn->sasl_username = ircnet->sasl_username;",
          "105:     conn->sasl_password = ircnet->sasl_password;",
          "",
          "[Added Lines]",
          "104:     conn->sasl_username = g_strdup(ircnet->sasl_username);",
          "105:     conn->sasl_password = g_strdup(ircnet->sasl_password);",
          "",
          "---------------"
        ]
      }
    }
  ]
}