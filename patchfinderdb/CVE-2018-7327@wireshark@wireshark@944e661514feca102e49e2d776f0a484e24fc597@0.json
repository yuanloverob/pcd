{
  "cve_id": "CVE-2018-7327",
  "cve_desc": "In Wireshark 2.4.0 to 2.4.4 and 2.2.0 to 2.2.12, epan/dissectors/packet-openflow_v6.c had an infinite loop that was addressed by validating property lengths.",
  "repo": "wireshark/wireshark",
  "patch_hash": "944e661514feca102e49e2d776f0a484e24fc597",
  "patch_info": {
    "commit_hash": "944e661514feca102e49e2d776f0a484e24fc597",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/944e661514feca102e49e2d776f0a484e24fc597",
    "files": [
      "epan/dissectors/packet-openflow_v6.c"
    ],
    "message": "OpenFlow 1.5: add extra property length checks\n\nBug: 14420\nChange-Id: I1813bc6285f950d86dc569f4286bf34c120b5e3c\nReviewed-on: https://code.wireshark.org/review/25780\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot\nReviewed-by: Anders Broman <a.broman58@gmail.com>",
    "before_after_code_files": [
      "epan/dissectors/packet-openflow_v6.c||epan/dissectors/packet-openflow_v6.c"
    ]
  },
  "patch_diff": {
    "epan/dissectors/packet-openflow_v6.c||epan/dissectors/packet-openflow_v6.c": [
      "File: epan/dissectors/packet-openflow_v6.c -> epan/dissectors/packet-openflow_v6.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2638: dissect_openflow_port_desc_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
      "2639: {",
      "2640:     proto_tree *prop_tree;",
      "2641:     guint16 prop_type;",
      "2642:     guint16 prop_length;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2641:     proto_item *prop_item;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2651:     offset+=2;",
      "2655:     offset+=2;",
      "2657:     switch (prop_type) {",
      "",
      "[Removed Lines]",
      "2654:     proto_tree_add_item(prop_tree, hf_openflow_v6_port_desc_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "[Added Lines]",
      "2655:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_port_desc_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "2664:         break;",
      "2666:     case OFPPDPT_EXPERIMENTER:",
      "2668:         proto_tree_add_item(tree, hf_openflow_v6_port_desc_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
      "2669:         offset+=4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2668:         if (prop_length <= 12) {",
      "2669:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "2670:             offset = length;",
      "2671:             break;",
      "2672:         }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "2678:         break;",
      "2680:     default:",
      "2681:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_port_desc_prop_undecoded,",
      "2682:                                      tvb, offset, prop_length - 4, \"Unknown port desc. property.\");",
      "2683:         offset += prop_length - 4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2687:         if (prop_length <= 4) {",
      "2688:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "2689:             offset = length;",
      "2690:             break;",
      "2691:         }",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "3257: dissect_openflow_portmod_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
      "3258: {",
      "3259:     proto_tree *prop_tree;",
      "3260:     guint16 prop_type;",
      "3261:     guint16 prop_length;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3271:     proto_item *prop_item;",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "3270:     offset+=2;",
      "3274:     offset+=2;",
      "3276:     switch (prop_type) {",
      "",
      "[Removed Lines]",
      "3273:     proto_tree_add_item(prop_tree, hf_openflow_v6_portmod_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "[Added Lines]",
      "3285:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_portmod_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "3283:         break;",
      "3285:     case OFPPMPT_EXPERIMENTER:",
      "3287:         proto_tree_add_item(tree, hf_openflow_v6_portmod_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
      "3288:         offset+=4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3298:         if (prop_length <= 12) {",
      "3299:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "3300:             offset = length;",
      "3301:             break;",
      "3302:         }",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "3297:         break;",
      "3299:     default:",
      "3300:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_portmod_prop_undecoded,",
      "3301:                                      tvb, offset, prop_length - 4, \"Unknown port desc. property.\");",
      "3302:         offset += prop_length - 4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3317:         if (prop_length <= 4) {",
      "3318:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "3319:             offset = length;",
      "3320:             break;",
      "3321:         }",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "3373: static int",
      "3374: dissect_openflow_tablemod_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
      "3375: {",
      "3377:     proto_tree *prop_tree, *flags_tree;",
      "3379:     guint16 prop_type;",
      "",
      "[Removed Lines]",
      "3376:     proto_item *ti;",
      "",
      "[Added Lines]",
      "3398:     proto_item *ti, *prop_item;",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "3389:     offset+=2;",
      "3393:     offset+=2;",
      "3395:     switch (prop_type) {",
      "",
      "[Removed Lines]",
      "3392:     proto_tree_add_item(prop_tree, hf_openflow_v6_tablemod_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "[Added Lines]",
      "3414:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_tablemod_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "3423:         break;",
      "3425:     case OFPTMPT_EXPERIMENTER:",
      "3427:         proto_tree_add_item(tree, hf_openflow_v6_tablemod_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
      "3428:         offset+=4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3448:         if (prop_length <= 12) {",
      "3449:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "3450:             offset = length;",
      "3451:             break;",
      "3452:         }",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "3437:         break;",
      "3439:     default:",
      "3440:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_tablemod_prop_undecoded,",
      "3441:                                      tvb, offset, prop_length - 4, \"Unknown table mod. property.\");",
      "3442:         offset += prop_length - 4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3467:         if (prop_length <= 4) {",
      "3468:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "3469:             offset = length;",
      "3470:             break;",
      "3471:         }",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "4341: dissect_openflow_port_stats_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
      "4342: {",
      "4343:     proto_tree *prop_tree;",
      "4344:     guint16 prop_type;",
      "4345:     guint16 prop_length;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4376:     proto_item *prop_item;",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "4354:     offset+=2;",
      "4358:     offset+=2;",
      "4360:     switch (prop_type) {",
      "",
      "[Removed Lines]",
      "4357:     proto_tree_add_item(prop_tree, hf_openflow_v6_port_stats_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "[Added Lines]",
      "4390:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_port_stats_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "4367:         break;",
      "4369:     case OFPPSPT_EXPERIMENTER:",
      "4371:         proto_tree_add_item(tree, hf_openflow_v6_port_stats_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
      "4372:         offset+=4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4403:         if (prop_length <= 12) {",
      "4404:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "4405:             offset = length;",
      "4406:             break;",
      "4407:         }",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "4381:         break;",
      "4383:     default:",
      "4384:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_port_stats_prop_undecoded,",
      "4385:                                      tvb, offset, prop_length - 4, \"Unknown port stats. property.\");",
      "4386:         offset += prop_length - 4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4422:         if (prop_length <= 4) {",
      "4423:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "4424:             offset = length;",
      "4425:             break;",
      "4426:         }",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "4515: dissect_openflow_queue_stats_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
      "4516: {",
      "4517:     proto_tree *prop_tree;",
      "4518:     guint16 prop_type;",
      "4519:     guint16 prop_length;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4561:     proto_item *prop_item;",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "4528:     offset+=2;",
      "4532:     offset+=2;",
      "4534:     switch (prop_type) {",
      "4535:     case OFPMP_EXPERIMENTER:",
      "4537:         proto_tree_add_item(tree, hf_openflow_v6_queue_stats_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
      "4538:         offset+=4;",
      "",
      "[Removed Lines]",
      "4531:     proto_tree_add_item(prop_tree, hf_openflow_v6_queue_stats_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "[Added Lines]",
      "4575:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_queue_stats_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "4580:         if (prop_length <= 12) {",
      "4581:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "4582:             offset = length;",
      "4583:             break;",
      "4584:         }",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "4548:         break;",
      "4550:     default:",
      "4551:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_queue_stats_prop_undecoded,",
      "4552:                                      tvb, offset, length - 4, \"Unknown queue stats prop body.\");",
      "4553:         offset += prop_length - 4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4600:         if (prop_length <= 4) {",
      "4601:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "4602:             offset = length;",
      "4603:             break;",
      "4604:         }",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "5510: static int",
      "5511: dissect_openflow_async_config_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
      "5512: {",
      "5514:     proto_tree *prop_tree, *pi_tree, *ps_tree, *fr_tree, *rs_tree, *ts_tree, *rf_tree;",
      "5515:     guint16 prop_type;",
      "5516:     guint16 prop_len;",
      "",
      "[Removed Lines]",
      "5513:     proto_item *ti;",
      "",
      "[Added Lines]",
      "5567:     proto_item *ti, *prop_item;",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "5525:     offset += 2;",
      "5529:     offset += 2;",
      "5531:     switch (prop_type) {",
      "",
      "[Removed Lines]",
      "5528:     proto_tree_add_item(prop_tree, hf_openflow_v6_async_config_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "[Added Lines]",
      "5582:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_async_config_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "5608:     case OFPACPT_EXPERIMENTER_SLAVE:",
      "5609:     case OFPACPT_EXPERIMENTER_MASTER:",
      "5611:         proto_tree_add_item(prop_tree, hf_openflow_v6_async_config_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
      "5612:         offset+=4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "5664:         if (prop_len <= 12) {",
      "5665:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "5666:             offset = length;",
      "5667:             break;",
      "5668:         }",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "5622:         break;",
      "5624:     default:",
      "5625:         proto_tree_add_expert_format(prop_tree, pinfo, &ei_openflow_v6_async_config_prop_undecoded,",
      "5626:                                      tvb, offset, prop_len - 4, \"Unknown async config prop body.\");",
      "5627:         offset += prop_len - 4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "5684:         if (prop_len <= 4) {",
      "5685:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "5686:             offset = length;",
      "5687:             break;",
      "5688:         }",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "5759: };",
      "5761: static int",
      "5763: {",
      "5764:     proto_tree *prop_tree;",
      "5765:     guint16 prop_type;",
      "5766:     guint16 prop_len;",
      "",
      "[Removed Lines]",
      "5762: dissect_openflow_bundle_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
      "",
      "[Added Lines]",
      "5826: dissect_openflow_bundle_prop_v6(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, guint16 length)",
      "5829:     proto_item *prop_item;",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "5774:     proto_tree_add_item(prop_tree, hf_openflow_v6_bundle_prop_type, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "5779:     switch (prop_type) {",
      "5780:     case OFPBPT_EXPERIMENTER:",
      "5782:         proto_tree_add_item(tree, hf_openflow_v6_bundle_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
      "5783:         offset+=4;",
      "",
      "[Removed Lines]",
      "5777:     proto_tree_add_item(prop_tree, hf_openflow_v6_bundle_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "",
      "[Added Lines]",
      "5842:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_bundle_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
      "5846:         if (prop_len <= 12) {",
      "5847:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "5848:             offset = length;",
      "5849:             break;",
      "5850:         }",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "5793:         break;",
      "5795:     default:",
      "5796:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_bundle_prop_undecoded,",
      "5797:                                      tvb, offset, prop_len - 4, \"Unknown bundle prop body.\");",
      "5798:         offset += prop_len - 4;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "5866:         if (prop_len <= 4) {",
      "5867:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
      "5868:             offset = length;",
      "5869:             break;",
      "5870:         }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "563989f888e51258edb9a27db56124bdc33c9afe",
      "candidate_info": {
        "commit_hash": "563989f888e51258edb9a27db56124bdc33c9afe",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/563989f888e51258edb9a27db56124bdc33c9afe",
        "files": [
          "epan/dissectors/packet-openflow_v6.c"
        ],
        "message": "OpenFlow 1.5: add extra property length checks\n\nBug: 14420\nChange-Id: I1813bc6285f950d86dc569f4286bf34c120b5e3c\nReviewed-on: https://code.wireshark.org/review/25780\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot\nReviewed-by: Anders Broman <a.broman58@gmail.com>\n(cherry picked from commit 944e661514feca102e49e2d776f0a484e24fc597)\nConflicts:\n\tepan/dissectors/packet-openflow_v6.c\nReviewed-on: https://code.wireshark.org/review/25787",
        "before_after_code_files": [
          "epan/dissectors/packet-openflow_v6.c||epan/dissectors/packet-openflow_v6.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-openflow_v6.c||epan/dissectors/packet-openflow_v6.c"
          ],
          "candidate": [
            "epan/dissectors/packet-openflow_v6.c||epan/dissectors/packet-openflow_v6.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-openflow_v6.c||epan/dissectors/packet-openflow_v6.c": [
          "File: epan/dissectors/packet-openflow_v6.c -> epan/dissectors/packet-openflow_v6.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2623: dissect_openflow_port_desc_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
          "2624: {",
          "2625:     proto_tree *prop_tree;",
          "2626:     guint16 prop_type;",
          "2627:     guint16 prop_length;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2626:     proto_item *prop_item;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2636:     offset+=2;",
          "2640:     offset+=2;",
          "2642:     switch (prop_type) {",
          "",
          "[Removed Lines]",
          "2639:     proto_tree_add_item(prop_tree, hf_openflow_v6_port_desc_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "[Added Lines]",
          "2640:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_port_desc_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2649:         break;",
          "2651:     case OFPPDPT_EXPERIMENTER:",
          "2653:         proto_tree_add_item(tree, hf_openflow_v6_port_desc_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
          "2654:         offset+=4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2653:         if (prop_length <= 12) {",
          "2654:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "2655:             offset = length;",
          "2656:             break;",
          "2657:         }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2663:         break;",
          "2665:     default:",
          "2666:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_port_desc_prop_undecoded,",
          "2667:                                      tvb, offset, prop_length - 4, \"Unknown port desc. property.\");",
          "2668:         offset += prop_length - 4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2672:         if (prop_length <= 4) {",
          "2673:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "2674:             offset = length;",
          "2675:             break;",
          "2676:         }",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "3242: dissect_openflow_portmod_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
          "3243: {",
          "3244:     proto_tree *prop_tree;",
          "3245:     guint16 prop_type;",
          "3246:     guint16 prop_length;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3256:     proto_item *prop_item;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3255:     offset+=2;",
          "3259:     offset+=2;",
          "3261:     switch (prop_type) {",
          "",
          "[Removed Lines]",
          "3258:     proto_tree_add_item(prop_tree, hf_openflow_v6_portmod_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "[Added Lines]",
          "3270:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_portmod_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "3268:         break;",
          "3270:     case OFPPMPT_EXPERIMENTER:",
          "3272:         proto_tree_add_item(tree, hf_openflow_v6_portmod_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
          "3273:         offset+=4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3283:         if (prop_length <= 12) {",
          "3284:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "3285:             offset = length;",
          "3286:             break;",
          "3287:         }",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "3282:         break;",
          "3284:     default:",
          "3285:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_portmod_prop_undecoded,",
          "3286:                                      tvb, offset, prop_length - 4, \"Unknown port desc. property.\");",
          "3287:         offset += prop_length - 4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3302:         if (prop_length <= 4) {",
          "3303:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "3304:             offset = length;",
          "3305:             break;",
          "3306:         }",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "3358: static int",
          "3359: dissect_openflow_tablemod_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
          "3360: {",
          "3362:     proto_tree *prop_tree, *flags_tree;",
          "3364:     guint16 prop_type;",
          "",
          "[Removed Lines]",
          "3361:     proto_item *ti;",
          "",
          "[Added Lines]",
          "3383:     proto_item *ti, *prop_item;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3374:     offset+=2;",
          "3378:     offset+=2;",
          "3380:     switch (prop_type) {",
          "",
          "[Removed Lines]",
          "3377:     proto_tree_add_item(prop_tree, hf_openflow_v6_tablemod_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "[Added Lines]",
          "3399:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_tablemod_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "3408:         break;",
          "3410:     case OFPTMPT_EXPERIMENTER:",
          "3412:         proto_tree_add_item(tree, hf_openflow_v6_tablemod_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
          "3413:         offset+=4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3433:         if (prop_length <= 12) {",
          "3434:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "3435:             offset = length;",
          "3436:             break;",
          "3437:         }",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "3422:         break;",
          "3424:     default:",
          "3425:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_tablemod_prop_undecoded,",
          "3426:                                      tvb, offset, prop_length - 4, \"Unknown table mod. property.\");",
          "3427:         offset += prop_length - 4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3452:         if (prop_length <= 4) {",
          "3453:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "3454:             offset = length;",
          "3455:             break;",
          "3456:         }",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "4341: dissect_openflow_queue_stats_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
          "4342: {",
          "4343:     proto_tree *prop_tree;",
          "4344:     guint16 prop_type;",
          "4345:     guint16 prop_length;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4376:     proto_item *prop_item;",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "4354:     offset+=2;",
          "4358:     offset+=2;",
          "4360:     switch (prop_type) {",
          "4361:     case OFPMP_EXPERIMENTER:",
          "4363:         proto_tree_add_item(tree, hf_openflow_v6_queue_stats_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
          "4364:         offset+=4;",
          "",
          "[Removed Lines]",
          "4357:     proto_tree_add_item(prop_tree, hf_openflow_v6_queue_stats_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "[Added Lines]",
          "4390:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_queue_stats_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "4395:         if (prop_length <= 12) {",
          "4396:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "4397:             offset = length;",
          "4398:             break;",
          "4399:         }",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "4374:         break;",
          "4376:     default:",
          "4377:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_queue_stats_prop_undecoded,",
          "4378:                                      tvb, offset, length - 4, \"Unknown queue stats prop body.\");",
          "4379:         offset += prop_length - 4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4415:         if (prop_length <= 4) {",
          "4416:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "4417:             offset = length;",
          "4418:             break;",
          "4419:         }",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "5336: static int",
          "5337: dissect_openflow_async_config_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
          "5338: {",
          "5340:     proto_tree *prop_tree, *pi_tree, *ps_tree, *fr_tree, *rs_tree, *ts_tree, *rf_tree;",
          "5341:     guint16 prop_type;",
          "5342:     guint16 prop_len;",
          "",
          "[Removed Lines]",
          "5339:     proto_item *ti;",
          "",
          "[Added Lines]",
          "5382:     proto_item *ti, *prop_item;",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "5351:     offset += 2;",
          "5355:     offset += 2;",
          "5357:     switch (prop_type) {",
          "",
          "[Removed Lines]",
          "5354:     proto_tree_add_item(prop_tree, hf_openflow_v6_async_config_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "[Added Lines]",
          "5397:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_async_config_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "5434:     case OFPACPT_EXPERIMENTER_SLAVE:",
          "5435:     case OFPACPT_EXPERIMENTER_MASTER:",
          "5437:         proto_tree_add_item(prop_tree, hf_openflow_v6_async_config_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
          "5438:         offset+=4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5479:         if (prop_len <= 12) {",
          "5480:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "5481:             offset = length;",
          "5482:             break;",
          "5483:         }",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "5448:         break;",
          "5450:     default:",
          "5451:         proto_tree_add_expert_format(prop_tree, pinfo, &ei_openflow_v6_async_config_prop_undecoded,",
          "5452:                                      tvb, offset, prop_len - 4, \"Unknown async config prop body.\");",
          "5453:         offset += prop_len - 4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5499:         if (prop_len <= 4) {",
          "5500:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "5501:             offset = length;",
          "5502:             break;",
          "5503:         }",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "5585: };",
          "5587: static int",
          "5589: {",
          "5590:     proto_tree *prop_tree;",
          "5591:     guint16 prop_type;",
          "5592:     guint16 prop_len;",
          "",
          "[Removed Lines]",
          "5588: dissect_openflow_bundle_prop_v6(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, guint16 length _U_)",
          "",
          "[Added Lines]",
          "5641: dissect_openflow_bundle_prop_v6(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, guint16 length)",
          "5644:     proto_item *prop_item;",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "5600:     proto_tree_add_item(prop_tree, hf_openflow_v6_bundle_prop_type, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "5605:     switch (prop_type) {",
          "5606:     case OFPBPT_EXPERIMENTER:",
          "5608:         proto_tree_add_item(tree, hf_openflow_v6_bundle_prop_experimenter_experimenter, tvb, offset, 4, ENC_BIG_ENDIAN);",
          "5609:         offset+=4;",
          "",
          "[Removed Lines]",
          "5603:     proto_tree_add_item(prop_tree, hf_openflow_v6_bundle_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "",
          "[Added Lines]",
          "5657:     prop_item = proto_tree_add_item(prop_tree, hf_openflow_v6_bundle_prop_length, tvb, offset, 2, ENC_BIG_ENDIAN);",
          "5661:         if (prop_len <= 12) {",
          "5662:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "5663:             offset = length;",
          "5664:             break;",
          "5665:         }",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "5619:         break;",
          "5621:     default:",
          "5622:         proto_tree_add_expert_format(tree, pinfo, &ei_openflow_v6_bundle_prop_undecoded,",
          "5623:                                      tvb, offset, prop_len - 4, \"Unknown bundle prop body.\");",
          "5624:         offset += prop_len - 4;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5681:         if (prop_len <= 4) {",
          "5682:             expert_add_info(pinfo, prop_item, &ei_openflow_v6_length_too_short);",
          "5683:             offset = length;",
          "5684:             break;",
          "5685:         }",
          "",
          "---------------"
        ]
      }
    }
  ]
}