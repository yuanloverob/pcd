{
  "cve_id": "CVE-2014-5272",
  "cve_desc": "libavcodec/iff.c in FFMpeg before 1.1.14, 1.2.x before 1.2.8, 2.2.x before 2.2.7, and 2.3.x before 2.3.2 allows remote attackers to have unspecified impact via a crafted iff image, which triggers an out-of-bounds array access, related to the rgb8 and rgbn formats.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "3539d6c63a16e1b2874bb037a86f317449c58770",
  "patch_info": {
    "commit_hash": "3539d6c63a16e1b2874bb037a86f317449c58770",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/3539d6c63a16e1b2874bb037a86f317449c58770",
    "files": [
      "libavcodec/iff.c"
    ],
    "message": "avcodec/iff: check pixfmt for rgb8 / rgbn\n\nFixes out of array access\n\nFound-by: Piotr Bandurski <ami_stuff@o2.pl>\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "before_after_code_files": [
      "libavcodec/iff.c||libavcodec/iff.c"
    ]
  },
  "patch_diff": {
    "libavcodec/iff.c||libavcodec/iff.c": [
      "File: libavcodec/iff.c -> libavcodec/iff.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "849:         break;",
      "850:     case 4:",
      "851:         bytestream2_init(&gb, buf, buf_size);",
      "853:             decode_rgb8(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
      "855:             decode_rgbn(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
      "856:         else",
      "857:             return unsupported(avctx);",
      "",
      "[Removed Lines]",
      "852:         if (avctx->codec_tag == MKTAG('R', 'G', 'B', '8'))",
      "854:         else if (avctx->codec_tag == MKTAG('R', 'G', 'B', 'N'))",
      "",
      "[Added Lines]",
      "852:         if (avctx->codec_tag == MKTAG('R', 'G', 'B', '8') && avctx->pix_fmt == AV_PIX_FMT_RGB32)",
      "854:         else if (avctx->codec_tag == MKTAG('R', 'G', 'B', 'N') && avctx->pix_fmt == AV_PIX_FMT_RGB444)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "83956309cc16b47fbf8548e8c5bcf67b8cd4b65f",
      "candidate_info": {
        "commit_hash": "83956309cc16b47fbf8548e8c5bcf67b8cd4b65f",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/83956309cc16b47fbf8548e8c5bcf67b8cd4b65f",
        "files": [
          "libavcodec/iff.c"
        ],
        "message": "avcodec/iff: check pixfmt for rgb8 / rgbn\n\nFixes out of array access\n\nFound-by: Piotr Bandurski <ami_stuff@o2.pl>\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3539d6c63a16e1b2874bb037a86f317449c58770)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/iff.c||libavcodec/iff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ],
          "candidate": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/iff.c||libavcodec/iff.c": [
          "File: libavcodec/iff.c -> libavcodec/iff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "847:         break;",
          "848:     case 4:",
          "849:         bytestream2_init(&gb, buf, buf_size);",
          "851:             decode_rgb8(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
          "853:             decode_rgbn(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
          "854:         else",
          "855:             return unsupported(avctx);",
          "",
          "[Removed Lines]",
          "850:         if (avctx->codec_tag == MKTAG('R', 'G', 'B', '8'))",
          "852:         else if (avctx->codec_tag == MKTAG('R', 'G', 'B', 'N'))",
          "",
          "[Added Lines]",
          "850:         if (avctx->codec_tag == MKTAG('R', 'G', 'B', '8') && avctx->pix_fmt == AV_PIX_FMT_RGB32)",
          "852:         else if (avctx->codec_tag == MKTAG('R', 'G', 'B', 'N') && avctx->pix_fmt == AV_PIX_FMT_RGB444)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0397d434054ab9a80fbf8e2357538ca29d4fe427",
      "candidate_info": {
        "commit_hash": "0397d434054ab9a80fbf8e2357538ca29d4fe427",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/0397d434054ab9a80fbf8e2357538ca29d4fe427",
        "files": [
          "libavcodec/iff.c"
        ],
        "message": "avcodec/iff: check pixfmt for rgb8 / rgbn\n\nFixes out of array access\n\nFound-by: Piotr Bandurski <ami_stuff@o2.pl>\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3539d6c63a16e1b2874bb037a86f317449c58770)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/iff.c||libavcodec/iff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ],
          "candidate": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/iff.c||libavcodec/iff.c": [
          "File: libavcodec/iff.c -> libavcodec/iff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "847:         break;",
          "848:     case 4:",
          "849:         bytestream2_init(&gb, buf, buf_size);",
          "851:             decode_rgb8(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
          "853:             decode_rgbn(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
          "854:         else",
          "855:             return unsupported(avctx);",
          "",
          "[Removed Lines]",
          "850:         if (avctx->codec_tag == MKTAG('R', 'G', 'B', '8'))",
          "852:         else if (avctx->codec_tag == MKTAG('R', 'G', 'B', 'N'))",
          "",
          "[Added Lines]",
          "850:         if (avctx->codec_tag == MKTAG('R', 'G', 'B', '8') && avctx->pix_fmt == AV_PIX_FMT_RGB32)",
          "852:         else if (avctx->codec_tag == MKTAG('R', 'G', 'B', 'N') && avctx->pix_fmt == AV_PIX_FMT_RGB444)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5865d599c38850b2a1fd33fe197eb8fcc6c970a4",
      "candidate_info": {
        "commit_hash": "5865d599c38850b2a1fd33fe197eb8fcc6c970a4",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/5865d599c38850b2a1fd33fe197eb8fcc6c970a4",
        "files": [
          "libavcodec/iff.c"
        ],
        "message": "avcodec/iff: check pixfmt for rgb8 / rgbn\n\nFixes out of array access\n\nFound-by: Piotr Bandurski <ami_stuff@o2.pl>\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3539d6c63a16e1b2874bb037a86f317449c58770)\n\nConflicts:\n\n\tlibavcodec/iff.c\n(cherry picked from commit 656f930160db48e0b7b25069c62abc340e7f0628)\n\nConflicts:\n\n\tlibavcodec/iff.c\n(cherry picked from commit abc1fa7c5a1dca1345b9471b81cfcda00c56220d)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/iff.c||libavcodec/iff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ],
          "candidate": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/iff.c||libavcodec/iff.c": [
          "File: libavcodec/iff.c -> libavcodec/iff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "832:         break;",
          "833:     case 4:",
          "834:         bytestream2_init(&gb, buf, buf_size);",
          "836:             decode_rgb8(&gb, s->frame.data[0], avctx->width, avctx->height, s->frame.linesize[0]);",
          "838:             decode_rgbn(&gb, s->frame.data[0], avctx->width, avctx->height, s->frame.linesize[0]);",
          "839:         else",
          "840:             return unsupported(avctx);",
          "",
          "[Removed Lines]",
          "835:         if (avctx->codec_tag == MKTAG('R','G','B','8'))",
          "837:         else if (avctx->codec_tag == MKTAG('R','G','B','N'))",
          "",
          "[Added Lines]",
          "835:         if (avctx->codec_tag == MKTAG('R','G','B','8') && avctx->pix_fmt == AV_PIX_FMT_RGB32)",
          "837:         else if (avctx->codec_tag == MKTAG('R','G','B','N') && avctx->pix_fmt == AV_PIX_FMT_RGB444)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "656f930160db48e0b7b25069c62abc340e7f0628",
      "candidate_info": {
        "commit_hash": "656f930160db48e0b7b25069c62abc340e7f0628",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/656f930160db48e0b7b25069c62abc340e7f0628",
        "files": [
          "libavcodec/iff.c"
        ],
        "message": "avcodec/iff: check pixfmt for rgb8 / rgbn\n\nFixes out of array access\n\nFound-by: Piotr Bandurski <ami_stuff@o2.pl>\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3539d6c63a16e1b2874bb037a86f317449c58770)\n\nConflicts:\n\n\tlibavcodec/iff.c",
        "before_after_code_files": [
          "libavcodec/iff.c||libavcodec/iff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ],
          "candidate": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/iff.c||libavcodec/iff.c": [
          "File: libavcodec/iff.c -> libavcodec/iff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "829:         break;",
          "830:     case 4:",
          "831:         bytestream2_init(&gb, buf, buf_size);",
          "833:             decode_rgb8(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
          "835:             decode_rgbn(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
          "836:         else",
          "837:             return unsupported(avctx);",
          "",
          "[Removed Lines]",
          "832:         if (avctx->codec_tag == MKTAG('R','G','B','8'))",
          "834:         else if (avctx->codec_tag == MKTAG('R','G','B','N'))",
          "",
          "[Added Lines]",
          "832:         if (avctx->codec_tag == MKTAG('R','G','B','8') && avctx->pix_fmt == AV_PIX_FMT_RGB32)",
          "834:         else if (avctx->codec_tag == MKTAG('R','G','B','N') && avctx->pix_fmt == AV_PIX_FMT_RGB444)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f405267493c8baf900195bf7989f371b861041f6",
      "candidate_info": {
        "commit_hash": "f405267493c8baf900195bf7989f371b861041f6",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/f405267493c8baf900195bf7989f371b861041f6",
        "files": [
          "libavcodec/iff.c"
        ],
        "message": "avcodec/iff: check pixfmt for rgb8 / rgbn\n\nFixes out of array access\n\nFound-by: Piotr Bandurski <ami_stuff@o2.pl>\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 3539d6c63a16e1b2874bb037a86f317449c58770)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/iff.c||libavcodec/iff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ],
          "candidate": [
            "libavcodec/iff.c||libavcodec/iff.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/iff.c||libavcodec/iff.c": [
          "File: libavcodec/iff.c -> libavcodec/iff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "841:         break;",
          "842:     case 4:",
          "843:         bytestream2_init(&gb, buf, buf_size);",
          "845:             decode_rgb8(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
          "847:             decode_rgbn(&gb, s->frame->data[0], avctx->width, avctx->height, s->frame->linesize[0]);",
          "848:         else",
          "849:             return unsupported(avctx);",
          "",
          "[Removed Lines]",
          "844:         if (avctx->codec_tag == MKTAG('R', 'G', 'B', '8'))",
          "846:         else if (avctx->codec_tag == MKTAG('R', 'G', 'B', 'N'))",
          "",
          "[Added Lines]",
          "844:         if (avctx->codec_tag == MKTAG('R', 'G', 'B', '8') && avctx->pix_fmt == AV_PIX_FMT_RGB32)",
          "846:         else if (avctx->codec_tag == MKTAG('R', 'G', 'B', 'N') && avctx->pix_fmt == AV_PIX_FMT_RGB444)",
          "",
          "---------------"
        ]
      }
    }
  ]
}