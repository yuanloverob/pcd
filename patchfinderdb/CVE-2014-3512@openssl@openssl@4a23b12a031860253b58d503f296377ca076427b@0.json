{
  "cve_id": "CVE-2014-3512",
  "cve_desc": "Multiple buffer overflows in crypto/srp/srp_lib.c in the SRP implementation in OpenSSL 1.0.1 before 1.0.1i allow remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via an invalid SRP (1) g, (2) A, or (3) B parameter.",
  "repo": "openssl/openssl",
  "patch_hash": "4a23b12a031860253b58d503f296377ca076427b",
  "patch_info": {
    "commit_hash": "4a23b12a031860253b58d503f296377ca076427b",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/4a23b12a031860253b58d503f296377ca076427b",
    "files": [
      "crypto/srp/srp_lib.c"
    ],
    "message": "Fix SRP buffer overrun vulnerability.\n\nInvalid parameters passed to the SRP code can be overrun an internal\nbuffer. Add sanity check that g, A, B < N to SRP code.\n\nThanks to Sean Devlin and Watson Ladd of Cryptography Services, NCC\nGroup for reporting this issue.",
    "before_after_code_files": [
      "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c"
    ]
  },
  "patch_diff": {
    "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c": [
      "File: crypto/srp/srp_lib.c -> crypto/srp/srp_lib.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "89:  int longg ;",
      "90:  int longN = BN_num_bytes(N);",
      "92:  if ((tmp = OPENSSL_malloc(longN)) == NULL)",
      "93:   return NULL;",
      "94:  BN_bn2bin(N,tmp) ;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "92:  if (BN_ucmp(g, N) >= 0)",
      "93:   return NULL;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "121:  if ((A == NULL) ||(B == NULL) || (N == NULL))",
      "122:   return NULL;",
      "124:  longN= BN_num_bytes(N);",
      "126:  if ((cAB = OPENSSL_malloc(2*longN)) == NULL)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "127:  if (BN_ucmp(A, N) >= 0 || BN_ucmp(B, N) >= 0)",
      "128:   return NULL;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "966fe81f9befbff62522a158006fb03050a868df",
      "candidate_info": {
        "commit_hash": "966fe81f9befbff62522a158006fb03050a868df",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/966fe81f9befbff62522a158006fb03050a868df",
        "files": [
          "crypto/srp/srp_lib.c"
        ],
        "message": "Fix SRP buffer overrun vulnerability.\n\nInvalid parameters passed to the SRP code can be overrun an internal\nbuffer. Add sanity check that g, A, B < N to SRP code.\n\nThanks to Sean Devlin and Watson Ladd of Cryptography Services, NCC\nGroup for reporting this issue.\nReviewed-by: Kurt Roeckx <kurt@openssl.org>",
        "before_after_code_files": [
          "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c"
          ],
          "candidate": [
            "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c": [
          "File: crypto/srp/srp_lib.c -> crypto/srp/srp_lib.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "89:  int longg ;",
          "90:  int longN = BN_num_bytes(N);",
          "92:  if ((tmp = OPENSSL_malloc(longN)) == NULL)",
          "93:   return NULL;",
          "94:  BN_bn2bin(N,tmp) ;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "92:  if (BN_ucmp(g, N) >= 0)",
          "93:   return NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "121:  if ((A == NULL) ||(B == NULL) || (N == NULL))",
          "122:   return NULL;",
          "124:  longN= BN_num_bytes(N);",
          "126:  if ((cAB = OPENSSL_malloc(2*longN)) == NULL)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "127:  if (BN_ucmp(A, N) >= 0 || BN_ucmp(B, N) >= 0)",
          "128:   return NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "53348780e9936f49b4ced7459e32d0bebbf9e8fa",
      "candidate_info": {
        "commit_hash": "53348780e9936f49b4ced7459e32d0bebbf9e8fa",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/53348780e9936f49b4ced7459e32d0bebbf9e8fa",
        "files": [
          "crypto/srp/srp_lib.c"
        ],
        "message": "Fix SRP buffer overrun vulnerability.\n\nInvalid parameters passed to the SRP code can be overrun an internal\nbuffer. Add sanity check that g, A, B < N to SRP code.\n\nThanks to Sean Devlin and Watson Ladd of Cryptography Services, NCC\nGroup for reporting this issue.",
        "before_after_code_files": [
          "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c"
          ],
          "candidate": [
            "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/srp/srp_lib.c||crypto/srp/srp_lib.c": [
          "File: crypto/srp/srp_lib.c -> crypto/srp/srp_lib.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "89:  int longg ;",
          "90:  int longN = BN_num_bytes(N);",
          "92:  if ((tmp = OPENSSL_malloc(longN)) == NULL)",
          "93:   return NULL;",
          "94:  BN_bn2bin(N,tmp) ;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "92:  if (BN_ucmp(g, N) >= 0)",
          "93:   return NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "121:  if ((A == NULL) ||(B == NULL) || (N == NULL))",
          "122:   return NULL;",
          "124:  longN= BN_num_bytes(N);",
          "126:  if ((cAB = OPENSSL_malloc(2*longN)) == NULL)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "127:  if (BN_ucmp(A, N) >= 0 || BN_ucmp(B, N) >= 0)",
          "128:   return NULL;",
          "",
          "---------------"
        ]
      }
    }
  ]
}