{
  "cve_id": "CVE-2017-7191",
  "cve_desc": "The netjoin processing in Irssi 1.x before 1.0.2 allows attackers to cause a denial of service (use-after-free) and possibly execute arbitrary code via unspecified vectors.",
  "repo": "irssi/irssi",
  "patch_hash": "77b2631c78461965bc9a7414aae206b5c514e1b3",
  "patch_info": {
    "commit_hash": "77b2631c78461965bc9a7414aae206b5c514e1b3",
    "repo": "irssi/irssi",
    "commit_url": "https://github.com/irssi/irssi/commit/77b2631c78461965bc9a7414aae206b5c514e1b3",
    "files": [
      "src/fe-common/irc/fe-netjoin.c",
      "src/core/chat-commands.c",
      "src/core/commands.c",
      "src/core/misc.c",
      "src/fe-common/core/fe-channels.c",
      "src/fe-common/core/window-commands.c",
      "src/fe-common/irc/fe-netsplit.c",
      "src/fe-text/mainwindows-layout.c",
      "src/irc/dcc/dcc-autoget.c",
      "src/perl/perl-core.c"
    ],
    "message": "Merge branch 'netjoin-timeout' into 'master'\n\nfe-netjoin: remove irc servers on \"server disconnected\" signal\n\nCloses #7\n\nSee merge request !10",
    "before_after_code_files": [
      "src/fe-common/irc/fe-netjoin.c||src/fe-common/irc/fe-netjoin.c"
    ]
  },
  "patch_diff": {
    "src/fe-common/irc/fe-netjoin.c||src/fe-common/irc/fe-netjoin.c": [
      "File: src/fe-common/irc/fe-netjoin.c -> src/fe-common/irc/fe-netjoin.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "470:  }",
      "471: }",
      "473: void fe_netjoin_init(void)",
      "474: {",
      "475:  settings_add_bool(\"misc\", \"hide_netsplit_quits\", TRUE);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "473: static void sig_server_disconnected(IRC_SERVER_REC *server)",
      "474: {",
      "475:  NETJOIN_SERVER_REC *netjoin_server;",
      "477:  g_return_if_fail(server != NULL);",
      "479:  if (!IS_IRC_SERVER(server))",
      "480:   return;",
      "482:  if ((netjoin_server = netjoin_find_server(server))) {",
      "483:   netjoin_server_remove(netjoin_server);",
      "484:  }",
      "485: }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "481:  read_settings();",
      "482:  signal_add(\"setup changed\", (SIGNAL_FUNC) read_settings);",
      "483: }",
      "485: void fe_netjoin_deinit(void)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "497:  signal_add(\"server disconnected\", (SIGNAL_FUNC) sig_server_disconnected);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "492:  }",
      "494:  signal_remove(\"setup changed\", (SIGNAL_FUNC) read_settings);",
      "496:  signal_remove(\"message quit\", (SIGNAL_FUNC) msg_quit);",
      "497:  signal_remove(\"message join\", (SIGNAL_FUNC) msg_join);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "510:  signal_remove(\"server disconnected\", (SIGNAL_FUNC) sig_server_disconnected);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "39e591468dec8c1acc49603c65d827b44f8d9497",
      "candidate_info": {
        "commit_hash": "39e591468dec8c1acc49603c65d827b44f8d9497",
        "repo": "irssi/irssi",
        "commit_url": "https://github.com/irssi/irssi/commit/39e591468dec8c1acc49603c65d827b44f8d9497",
        "files": [
          "src/fe-common/irc/fe-netjoin.c"
        ],
        "message": "Merge branch 'netjoin-timeout' into 'master'\n\nfe-netjoin: remove irc servers on \"server disconnected\" signal\n\nCloses #7\n\nSee merge request !10\n\n(cherry picked from commit 77b2631c78461965bc9a7414aae206b5c514e1b3)",
        "before_after_code_files": [
          "src/fe-common/irc/fe-netjoin.c||src/fe-common/irc/fe-netjoin.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/fe-common/irc/fe-netjoin.c||src/fe-common/irc/fe-netjoin.c"
          ],
          "candidate": [
            "src/fe-common/irc/fe-netjoin.c||src/fe-common/irc/fe-netjoin.c"
          ]
        }
      },
      "candidate_diff": {
        "src/fe-common/irc/fe-netjoin.c||src/fe-common/irc/fe-netjoin.c": [
          "File: src/fe-common/irc/fe-netjoin.c -> src/fe-common/irc/fe-netjoin.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "470:  }",
          "471: }",
          "473: void fe_netjoin_init(void)",
          "474: {",
          "475:  settings_add_bool(\"misc\", \"hide_netsplit_quits\", TRUE);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "473: static void sig_server_disconnected(IRC_SERVER_REC *server)",
          "474: {",
          "475:  NETJOIN_SERVER_REC *netjoin_server;",
          "477:  g_return_if_fail(server != NULL);",
          "479:  if (!IS_IRC_SERVER(server))",
          "480:   return;",
          "482:  if ((netjoin_server = netjoin_find_server(server))) {",
          "483:   netjoin_server_remove(netjoin_server);",
          "484:  }",
          "485: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "481:  read_settings();",
          "482:  signal_add(\"setup changed\", (SIGNAL_FUNC) read_settings);",
          "483: }",
          "485: void fe_netjoin_deinit(void)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "497:  signal_add(\"server disconnected\", (SIGNAL_FUNC) sig_server_disconnected);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "492:  }",
          "494:  signal_remove(\"setup changed\", (SIGNAL_FUNC) read_settings);",
          "496:  signal_remove(\"message quit\", (SIGNAL_FUNC) msg_quit);",
          "497:  signal_remove(\"message join\", (SIGNAL_FUNC) msg_join);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "510:  signal_remove(\"server disconnected\", (SIGNAL_FUNC) sig_server_disconnected);",
          "",
          "---------------"
        ]
      }
    }
  ]
}