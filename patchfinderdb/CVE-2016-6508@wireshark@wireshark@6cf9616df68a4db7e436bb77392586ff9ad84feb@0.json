{
  "cve_id": "CVE-2016-6508",
  "cve_desc": "epan/dissectors/packet-rlc.c in the RLC dissector in Wireshark 1.12.x before 1.12.13 and 2.x before 2.0.5 uses an incorrect integer data type, which allows remote attackers to cause a denial of service (large loop) via a crafted packet.",
  "repo": "wireshark/wireshark",
  "patch_hash": "6cf9616df68a4db7e436bb77392586ff9ad84feb",
  "patch_info": {
    "commit_hash": "6cf9616df68a4db7e436bb77392586ff9ad84feb",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/6cf9616df68a4db7e436bb77392586ff9ad84feb",
    "files": [
      "epan/dissectors/packet-rlc.c"
    ],
    "message": "RLC: fix a variable overflow in rlc_decode_li function\n\nBug: 12660\nChange-Id: I20a423eb9aa72383ac28d176bc60751ed36be9bd\nReviewed-on: https://code.wireshark.org/review/16639\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>",
    "before_after_code_files": [
      "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
    ]
  },
  "patch_diff": {
    "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c": [
      "File: epan/dissectors/packet-rlc.c -> epan/dissectors/packet-rlc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "662: static proto_tree *",
      "664:         gboolean li_is_on_2_bytes, tvbuff_t *tvb, proto_tree *tree)",
      "665: {",
      "666:     proto_item *root_ti, *ti;",
      "667:     proto_tree *li_tree;",
      "669:     guint64     length;",
      "671:     if (!tree) return NULL;",
      "",
      "[Removed Lines]",
      "663: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint8 hdr_offs,",
      "668:     guint8      li_offs;",
      "",
      "[Added Lines]",
      "663: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint32 hdr_offs,",
      "668:     guint32     li_offs;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1697: rlc_decode_li(enum rlc_mode mode, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
      "1698:           struct rlc_li *li, guint8 max_li, gboolean li_on_2_bytes)",
      "1699: {",
      "1701:     guint16     next_bytes, prev_li = 0;",
      "1702:     proto_item *malformed;",
      "1703:     guint16     total_len;",
      "",
      "[Removed Lines]",
      "1700:     guint8      ext, hdr_len, offs  = 0, num_li = 0, li_offs;",
      "",
      "[Added Lines]",
      "1700:     guint32     hdr_len, offs = 0, li_offs;",
      "1701:     guint8      ext, num_li = 0;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6394b23ce4018f53def26a3428e284e7d6c0c771",
      "candidate_info": {
        "commit_hash": "6394b23ce4018f53def26a3428e284e7d6c0c771",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/6394b23ce4018f53def26a3428e284e7d6c0c771",
        "files": [
          "epan/dissectors/packet-rlc.c"
        ],
        "message": "RLC: fix a variable overflow in rlc_decode_li function\n\nBug: 12660\nChange-Id: I20a423eb9aa72383ac28d176bc60751ed36be9bd\nReviewed-on: https://code.wireshark.org/review/16639\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\n(cherry picked from commit 6cf9616df68a4db7e436bb77392586ff9ad84feb)\nReviewed-on: https://code.wireshark.org/review/16646",
        "before_after_code_files": [
          "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
          ],
          "candidate": [
            "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c": [
          "File: epan/dissectors/packet-rlc.c -> epan/dissectors/packet-rlc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "661: static proto_tree *",
          "663:         gboolean li_is_on_2_bytes, tvbuff_t *tvb, proto_tree *tree)",
          "664: {",
          "665:     proto_item *root_ti, *ti;",
          "666:     proto_tree *li_tree;",
          "668:     guint64     length;",
          "670:     if (!tree) return NULL;",
          "",
          "[Removed Lines]",
          "662: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint8 hdr_offs,",
          "667:     guint8      li_offs;",
          "",
          "[Added Lines]",
          "662: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint32 hdr_offs,",
          "667:     guint32     li_offs;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1693: rlc_decode_li(enum rlc_mode mode, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1694:           struct rlc_li *li, guint8 max_li, gboolean li_on_2_bytes)",
          "1695: {",
          "1697:     guint16     next_bytes, prev_li = 0;",
          "1698:     proto_item *malformed;",
          "1699:     guint16     total_len;",
          "",
          "[Removed Lines]",
          "1696:     guint8      ext, hdr_len, offs  = 0, num_li = 0, li_offs;",
          "",
          "[Added Lines]",
          "1696:     guint32     hdr_len, offs = 0, li_offs;",
          "1697:     guint8      ext, num_li = 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "93492124154b4ce8cc5f5bf0b43d967a5bed16fe",
      "candidate_info": {
        "commit_hash": "93492124154b4ce8cc5f5bf0b43d967a5bed16fe",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/93492124154b4ce8cc5f5bf0b43d967a5bed16fe",
        "files": [
          "epan/dissectors/packet-rlc.c"
        ],
        "message": "RLC: fix a variable overflow in rlc_decode_li function\n\nBug: 12660\nChange-Id: I20a423eb9aa72383ac28d176bc60751ed36be9bd\nReviewed-on: https://code.wireshark.org/review/16639\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\n(cherry picked from commit 6cf9616df68a4db7e436bb77392586ff9ad84feb)\nReviewed-on: https://code.wireshark.org/review/16645",
        "before_after_code_files": [
          "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
          ],
          "candidate": [
            "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c": [
          "File: epan/dissectors/packet-rlc.c -> epan/dissectors/packet-rlc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "662: static proto_tree *",
          "664:         gboolean li_is_on_2_bytes, tvbuff_t *tvb, proto_tree *tree)",
          "665: {",
          "666:     proto_item *root_ti, *ti;",
          "667:     proto_tree *li_tree;",
          "669:     guint64     length;",
          "671:     if (!tree) return NULL;",
          "",
          "[Removed Lines]",
          "663: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint8 hdr_offs,",
          "668:     guint8      li_offs;",
          "",
          "[Added Lines]",
          "663: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint32 hdr_offs,",
          "668:     guint32     li_offs;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1697: rlc_decode_li(enum rlc_mode mode, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1698:           struct rlc_li *li, guint8 max_li, gboolean li_on_2_bytes)",
          "1699: {",
          "1701:     guint16     next_bytes, prev_li = 0;",
          "1702:     proto_item *malformed;",
          "1703:     guint16     total_len;",
          "",
          "[Removed Lines]",
          "1700:     guint8      ext, hdr_len, offs  = 0, num_li = 0, li_offs;",
          "",
          "[Added Lines]",
          "1700:     guint32     hdr_len, offs = 0, li_offs;",
          "1701:     guint8      ext, num_li = 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8f1600761647583dc24a72fde6d614283ec779ab",
      "candidate_info": {
        "commit_hash": "8f1600761647583dc24a72fde6d614283ec779ab",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/8f1600761647583dc24a72fde6d614283ec779ab",
        "files": [
          "epan/dissectors/packet-rlc.c"
        ],
        "message": "RLC: fix a variable overflow in rlc_decode_li function\n\nBug: 12660\nChange-Id: I20a423eb9aa72383ac28d176bc60751ed36be9bd\nReviewed-on: https://code.wireshark.org/review/16639\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\n(cherry picked from commit 6cf9616df68a4db7e436bb77392586ff9ad84feb)\nReviewed-on: https://code.wireshark.org/review/16647",
        "before_after_code_files": [
          "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
          ],
          "candidate": [
            "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c": [
          "File: epan/dissectors/packet-rlc.c -> epan/dissectors/packet-rlc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "676: static proto_tree *",
          "678:         gboolean li_is_on_2_bytes, tvbuff_t *tvb, proto_tree *tree)",
          "679: {",
          "680:     proto_item *root_ti, *ti;",
          "681:     proto_tree *li_tree;",
          "683:     guint64     length;",
          "685:     if (!tree) return NULL;",
          "",
          "[Removed Lines]",
          "677: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint8 hdr_offs,",
          "682:     guint8      li_offs;",
          "",
          "[Added Lines]",
          "677: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint32 hdr_offs,",
          "682:     guint32     li_offs;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1712: rlc_decode_li(enum rlc_mode mode, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1713:           struct rlc_li *li, guint8 max_li, gboolean li_on_2_bytes)",
          "1714: {",
          "1716:     guint16     next_bytes, prev_li = 0;",
          "1717:     proto_item *malformed;",
          "1718:     guint16     total_len;",
          "",
          "[Removed Lines]",
          "1715:     guint8      ext, hdr_len, offs  = 0, num_li = 0, li_offs;",
          "",
          "[Added Lines]",
          "1715:     guint32     hdr_len, offs = 0, li_offs;",
          "1716:     guint8      ext, num_li = 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "810a141bafdf81fc817617d092da77ebbf8ca6d1",
      "candidate_info": {
        "commit_hash": "810a141bafdf81fc817617d092da77ebbf8ca6d1",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/810a141bafdf81fc817617d092da77ebbf8ca6d1",
        "files": [
          "epan/dissectors/packet-rlc.c"
        ],
        "message": "RLC: fix a variable overflow in rlc_decode_li function\n\nBug: 12660\nChange-Id: I20a423eb9aa72383ac28d176bc60751ed36be9bd\nReviewed-on: https://code.wireshark.org/review/16639\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\n(cherry picked from commit 6cf9616df68a4db7e436bb77392586ff9ad84feb)\nReviewed-on: https://code.wireshark.org/review/16647\n(cherry picked from commit 8f1600761647583dc24a72fde6d614283ec779ab)\nReviewed-on: https://code.wireshark.org/review/17020\nReviewed-by: Balint Reczey <balint@balintreczey.hu>",
        "before_after_code_files": [
          "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
          ],
          "candidate": [
            "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-rlc.c||epan/dissectors/packet-rlc.c": [
          "File: epan/dissectors/packet-rlc.c -> epan/dissectors/packet-rlc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "676: static proto_tree *",
          "678:         gboolean li_is_on_2_bytes, tvbuff_t *tvb, proto_tree *tree)",
          "679: {",
          "680:     proto_item *root_ti, *ti;",
          "681:     proto_tree *li_tree;",
          "683:     guint64     length;",
          "685:     if (!tree) return NULL;",
          "",
          "[Removed Lines]",
          "677: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint8 hdr_offs,",
          "682:     guint8      li_offs;",
          "",
          "[Added Lines]",
          "677: tree_add_li(enum rlc_mode mode, struct rlc_li *li, guint8 li_idx, guint32 hdr_offs,",
          "682:     guint32     li_offs;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1712: rlc_decode_li(enum rlc_mode mode, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1713:           struct rlc_li *li, guint8 max_li, gboolean li_on_2_bytes)",
          "1714: {",
          "1716:     guint16     next_bytes, prev_li = 0;",
          "1717:     proto_item *malformed;",
          "1718:     guint16     total_len;",
          "",
          "[Removed Lines]",
          "1715:     guint8      ext, hdr_len, offs  = 0, num_li = 0, li_offs;",
          "",
          "[Added Lines]",
          "1715:     guint32     hdr_len, offs = 0, li_offs;",
          "1716:     guint8      ext, num_li = 0;",
          "",
          "---------------"
        ]
      }
    }
  ]
}