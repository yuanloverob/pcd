{
  "cve_id": "CVE-2015-0278",
  "cve_desc": "libuv before 0.10.34 does not properly drop group privileges, which allows context-dependent attackers to gain privileges via unspecified vectors.",
  "repo": "libuv/libuv",
  "patch_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
  "patch_info": {
    "commit_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
    "repo": "libuv/libuv",
    "commit_url": "https://github.com/libuv/libuv/commit/66ab38918c911bcff025562cf06237d7fedaba0c",
    "files": [
      "src/unix/process.c"
    ],
    "message": "unix: call setgoups before calling setuid/setgid\n\nPartial fix for #1093",
    "before_after_code_files": [
      "src/unix/process.c||src/unix/process.c"
    ]
  },
  "patch_diff": {
    "src/unix/process.c||src/unix/process.c": [
      "File: src/unix/process.c -> src/unix/process.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "330:     _exit(127);",
      "331:   }",
      "333:   if ((options->flags & UV_PROCESS_SETGID) && setgid(options->gid)) {",
      "334:     uv__write_int(error_fd, -errno);",
      "335:     perror(\"setgid()\");",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "333:   if (options->flags & (UV_PROCESS_SETUID | UV_PROCESS_SETGID)) {",
      "341:     SAVE_ERRNO(setgroups(0, NULL));",
      "342:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "624be53e02832dbdf486d478c2c22b465af675f1",
      "candidate_info": {
        "commit_hash": "624be53e02832dbdf486d478c2c22b465af675f1",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/624be53e02832dbdf486d478c2c22b465af675f1",
        "files": [
          "build.mk"
        ],
        "message": "build: add install target to the makefile\n\nBefore this commit, there was no way to install libuv other than\nmanually copying required files to the path. This commit introduces\nan install target which installs the libuv.a, libuv.so and header files\nto the install prefix.\n\n    ``\n    make\n    make install\n    ``\n\nThe above will use the default prefix `/usr/local`\n\n    ``\n    make\n    make install PREFIX=/usr\n    ``\n\nThe above will install to `/usr`",
        "before_after_code_files": [
          "build.mk||build.mk"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "build.mk||build.mk": [
          "File: build.mk -> build.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "32: SOEXT = so",
          "33: endif",
          "35: ifneq (,$(findstring mingw,$(PLATFORM)))",
          "36: include $(SRCDIR)/config-mingw.mk",
          "37: else",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: ifndef PREFIX",
          "36: PREFIX=/usr/local",
          "37: endif",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "164:   test/run-tests.o test/run-benchmarks.o \\",
          "165:   test/runner.o run-tests$(E) test/run-benchmarks$(E) \\",
          "166:   $(BENCHMARKS) $(TESTS) $(RUNNER_LIBS)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "172: install: all",
          "173:  install -m 644 libuv.a $(PREFIX)/lib",
          "174:  install -m 755 libuv.$(SOEXT) $(PREFIX)/lib",
          "175:  install -m 644 $(SRCDIR)/include/uv.h $(PREFIX)/include",
          "176:  install -m 755 -d $(PREFIX)/include/uv-private",
          "177:  install -m 644 $(SRCDIR)/include/uv-private/pthread-fixes.h $(PREFIX)/include/uv-private",
          "178:  install -m 644 $(SRCDIR)/include/uv-private/stdint-msvc2008.h $(PREFIX)/include/uv-private",
          "179:  install -m 644 $(SRCDIR)/include/uv-private/tree.h $(PREFIX)/include/uv-private",
          "180:  install -m 644 $(SRCDIR)/include/uv-private/uv-bsd.h $(PREFIX)/include/uv-private",
          "181:  install -m 644 $(SRCDIR)/include/uv-private/uv-darwin.h $(PREFIX)/include/uv-private",
          "182:  install -m 644 $(SRCDIR)/include/uv-private/uv-linux.h $(PREFIX)/include/uv-private",
          "183:  install -m 644 $(SRCDIR)/include/uv-private/uv-sunos.h $(PREFIX)/include/uv-private",
          "184:  install -m 644 $(SRCDIR)/include/uv-private/uv-unix.h $(PREFIX)/include/uv-private",
          "185:  install -m 644 $(SRCDIR)/include/uv-private/uv-win.h $(PREFIX)/include/uv-private",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b45e3cca6b4db4e2ac15c5c0ba29babd0f59dbb2",
      "candidate_info": {
        "commit_hash": "b45e3cca6b4db4e2ac15c5c0ba29babd0f59dbb2",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/b45e3cca6b4db4e2ac15c5c0ba29babd0f59dbb2",
        "files": [
          "ChangeLog",
          "configure.ac",
          "src/version.c"
        ],
        "message": "Now working on v0.11.15",
        "before_after_code_files": [
          "configure.ac||configure.ac",
          "src/version.c||src/version.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "configure.ac||configure.ac": [
          "File: configure.ac -> configure.ac",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: # OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.",
          "15: AC_PREREQ(2.57)",
          "17: AC_CONFIG_MACRO_DIR([m4])",
          "18: m4_include([m4/libuv-extra-automake-flags.m4])",
          "19: AM_INIT_AUTOMAKE([-Wall -Werror foreign subdir-objects] UV_EXTRA_AUTOMAKE_FLAGS)",
          "",
          "[Removed Lines]",
          "16: AC_INIT([libuv], [0.11.14], [https://github.com/joyent/libuv/issues])",
          "",
          "[Added Lines]",
          "16: AC_INIT([libuv], [0.11.15], [https://github.com/joyent/libuv/issues])",
          "",
          "---------------"
        ],
        "src/version.c||src/version.c": [
          "File: src/version.c -> src/version.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "32: #define UV_VERSION_MAJOR 0",
          "33: #define UV_VERSION_MINOR 11",
          "38: #define UV_VERSION  ((UV_VERSION_MAJOR << 16) | \\",
          "",
          "[Removed Lines]",
          "34: #define UV_VERSION_PATCH 14",
          "35: #define UV_VERSION_IS_RELEASE 1",
          "",
          "[Added Lines]",
          "34: #define UV_VERSION_PATCH 15",
          "35: #define UV_VERSION_IS_RELEASE 0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "01293ac03a785db122582a0fefd32d89efb13b9a",
      "candidate_info": {
        "commit_hash": "01293ac03a785db122582a0fefd32d89efb13b9a",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/01293ac03a785db122582a0fefd32d89efb13b9a",
        "files": [
          "ChangeLog",
          "include/uv-version.h"
        ],
        "message": "version: now working on 1.0.0-rc2",
        "before_after_code_files": [
          "include/uv-version.h||include/uv-version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/uv-version.h||include/uv-version.h": [
          "File: include/uv-version.h -> include/uv-version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: #define UV_VERSION_MAJOR 1",
          "34: #define UV_VERSION_MINOR 0",
          "35: #define UV_VERSION_PATCH 0",
          "",
          "[Removed Lines]",
          "36: #define UV_VERSION_IS_RELEASE 1",
          "37: #define UV_VERSION_SUFFIX \"rc1\"",
          "",
          "[Added Lines]",
          "36: #define UV_VERSION_IS_RELEASE 0",
          "37: #define UV_VERSION_SUFFIX \"rc2\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fdbc8567afc7642205d9118948fb412ab49447e1",
      "candidate_info": {
        "commit_hash": "fdbc8567afc7642205d9118948fb412ab49447e1",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/fdbc8567afc7642205d9118948fb412ab49447e1",
        "files": [
          "src/unix/internal.h"
        ],
        "message": "unix: fix colliding flag value\n\nFixes #1425",
        "before_after_code_files": [
          "src/unix/internal.h||src/unix/internal.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/unix/internal.h||src/unix/internal.h": [
          "File: src/unix/internal.h -> src/unix/internal.h"
        ]
      }
    },
    {
      "candidate_hash": "d5ab1c1a3b4fae9fd85a07edc231ad4c15dc8bcd",
      "candidate_info": {
        "commit_hash": "d5ab1c1a3b4fae9fd85a07edc231ad4c15dc8bcd",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/d5ab1c1a3b4fae9fd85a07edc231ad4c15dc8bcd",
        "files": [
          "Makefile.mingw"
        ],
        "message": "Revert \"build: remove mingw makefile\"\n\nAs requested by the Rust people.\n\nThis reverts commit 8f3621e4dd2d55befd0f0b8635cf8de17f849aff.",
        "before_after_code_files": [
          "Makefile.mingw||Makefile.mingw"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Makefile.mingw||Makefile.mingw": [
          "File: Makefile.mingw -> Makefile.mingw",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: # Copyright (c) 2013, Ben Noordhuis <info@bnoordhuis.nl>",
          "2: #",
          "3: # Permission to use, copy, modify, and/or distribute this software for any",
          "4: # purpose with or without fee is hereby granted, provided that the above",
          "5: # copyright notice and this permission notice appear in all copies.",
          "6: #",
          "7: # THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES",
          "8: # WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF",
          "9: # MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR",
          "10: # ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES",
          "11: # WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN",
          "12: # ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF",
          "13: # OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.",
          "15: CFLAGS = -Wall \\",
          "16:          -Wextra \\",
          "17:          -Wno-unused-parameter \\",
          "18:          -Iinclude \\",
          "19:          -Isrc \\",
          "20:          -Isrc/win \\",
          "21:          -DWIN32_LEAN_AND_MEAN \\",
          "22:          -D_WIN32_WINNT=0x0600",
          "24: INCLUDES = include/stdint-msvc2008.h \\",
          "25:            include/tree.h \\",
          "26:            include/uv-errno.h \\",
          "27:            include/uv-win.h \\",
          "28:            include/uv.h \\",
          "29:            src/queue.h \\",
          "30:            src/uv-common.h \\",
          "31:            src/win/atomicops-inl.h \\",
          "32:            src/win/handle-inl.h \\",
          "33:            src/win/internal.h \\",
          "34:            src/win/req-inl.h \\",
          "35:            src/win/stream-inl.h \\",
          "36:            src/win/winapi.h \\",
          "37:            src/win/winsock.h",
          "39: OBJS = src/fs-poll.o \\",
          "40:        src/inet.o \\",
          "41:        src/uv-common.o \\",
          "42:        src/version.o \\",
          "43:        src/win/async.o \\",
          "44:        src/win/core.o \\",
          "45:        src/win/dl.o \\",
          "46:        src/win/error.o \\",
          "47:        src/win/fs-event.o \\",
          "48:        src/win/fs.o \\",
          "49:        src/win/getaddrinfo.o \\",
          "50:        src/win/handle.o \\",
          "51:        src/win/loop-watcher.o \\",
          "52:        src/win/pipe.o \\",
          "53:        src/win/poll.o \\",
          "54:        src/win/process-stdio.o \\",
          "55:        src/win/process.o \\",
          "56:        src/win/req.o \\",
          "57:        src/win/signal.o \\",
          "58:        src/win/stream.o \\",
          "59:        src/win/tcp.o \\",
          "60:        src/win/thread.o \\",
          "61:        src/win/threadpool.o \\",
          "62:        src/win/timer.o \\",
          "63:        src/win/tty.o \\",
          "64:        src/win/udp.o \\",
          "65:        src/win/util.o \\",
          "66:        src/win/winapi.o \\",
          "67:        src/win/winsock.o",
          "69: all: libuv.a",
          "71: libuv.a: $(OBJS)",
          "72:  $(AR) crs $@ $^",
          "74: # FIXME(bnoordhuis) Don't rebuild everything when a source file changes.",
          "75: $(OBJS): $(OBJS:.o=.c) $(INCLUDES)",
          "",
          "---------------"
        ]
      }
    }
  ]
}