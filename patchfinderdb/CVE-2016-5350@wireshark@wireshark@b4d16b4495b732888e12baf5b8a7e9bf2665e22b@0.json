{
  "cve_id": "CVE-2016-5350",
  "cve_desc": "epan/dissectors/packet-dcerpc-spoolss.c in the SPOOLS component in Wireshark 1.12.x before 1.12.12 and 2.x before 2.0.4 mishandles unexpected offsets, which allows remote attackers to cause a denial of service (infinite loop) via a crafted packet.",
  "repo": "wireshark/wireshark",
  "patch_hash": "b4d16b4495b732888e12baf5b8a7e9bf2665e22b",
  "patch_info": {
    "commit_hash": "b4d16b4495b732888e12baf5b8a7e9bf2665e22b",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/b4d16b4495b732888e12baf5b8a7e9bf2665e22b",
    "files": [
      "epan/dissectors/packet-dcerpc-spoolss.c"
    ],
    "message": "SPOOLSS: Try to avoid an infinite loop.\n\nUse tvb_reported_length_remaining in dissect_spoolss_uint16uni. Make\nsure our offset always increments in dissect_spoolss_keybuffer.\n\nChange-Id: I7017c9685bb2fa27161d80a03b8fca4ef630e793\nReviewed-on: https://code.wireshark.org/review/14687\nReviewed-by: Gerald Combs <gerald@wireshark.org>\nPetri-Dish: Gerald Combs <gerald@wireshark.org>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
    "before_after_code_files": [
      "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
    ]
  },
  "patch_diff": {
    "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c": [
      "File: epan/dissectors/packet-dcerpc-spoolss.c -> epan/dissectors/packet-dcerpc-spoolss.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1094:  if (remaining <= 0) {",
      "1095:   if (data)",
      "",
      "[Removed Lines]",
      "1093:  remaining = tvb_captured_length_remaining(tvb, offset);",
      "",
      "[Added Lines]",
      "1093:  remaining = tvb_reported_length_remaining(tvb, offset);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "6198:   end_offset = tvb_reported_length_remaining(tvb, offset) + 1;",
      "6199:  }",
      "6202:   offset = dissect_spoolss_uint16uni(",
      "6203:    tvb, offset, pinfo, tree, drep, NULL, hf_keybuffer);",
      "6205:  return offset;",
      "6206: }",
      "",
      "[Removed Lines]",
      "6201:  while (offset < end_offset)",
      "",
      "[Added Lines]",
      "6201:  while (offset > 0 && offset < end_offset) {",
      "6204:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9753ea8db4ea2caeb3365e842e904cbe5681b79e",
      "candidate_info": {
        "commit_hash": "9753ea8db4ea2caeb3365e842e904cbe5681b79e",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/9753ea8db4ea2caeb3365e842e904cbe5681b79e",
        "files": [
          "epan/dissectors/packet-dcerpc-spoolss.c"
        ],
        "message": "SPOOLSS: Try to avoid an infinite loop.\n\nUse tvb_reported_length_remaining in dissect_spoolss_uint16uni. Make\nsure our offset always increments in dissect_spoolss_keybuffer.\n\nChange-Id: I7017c9685bb2fa27161d80a03b8fca4ef630e793\nReviewed-on: https://code.wireshark.org/review/14687\nReviewed-by: Gerald Combs <gerald@wireshark.org>\nPetri-Dish: Gerald Combs <gerald@wireshark.org>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit b4d16b4495b732888e12baf5b8a7e9bf2665e22b)\nReviewed-on: https://code.wireshark.org/review/15248",
        "before_after_code_files": [
          "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
          ],
          "candidate": [
            "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c": [
          "File: epan/dissectors/packet-dcerpc-spoolss.c -> epan/dissectors/packet-dcerpc-spoolss.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1094:  if (remaining <= 0) {",
          "1095:   if (data)",
          "",
          "[Removed Lines]",
          "1093:  remaining = tvb_captured_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "1093:  remaining = tvb_reported_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "6198:   end_offset = tvb_reported_length_remaining(tvb, offset) + 1;",
          "6199:  }",
          "6202:   offset = dissect_spoolss_uint16uni(",
          "6203:    tvb, offset, pinfo, tree, drep, NULL, hf_keybuffer);",
          "6205:  return offset;",
          "6206: }",
          "",
          "[Removed Lines]",
          "6201:  while (offset < end_offset)",
          "",
          "[Added Lines]",
          "6201:  while (offset > 0 && offset < end_offset) {",
          "6204:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "80006b0eb062a45479d109796df14c13ca7c5785",
      "candidate_info": {
        "commit_hash": "80006b0eb062a45479d109796df14c13ca7c5785",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/80006b0eb062a45479d109796df14c13ca7c5785",
        "files": [
          "epan/dissectors/packet-dcerpc-spoolss.c"
        ],
        "message": "SPOOLSS: Try to avoid an infinite loop.\n\nUse tvb_reported_length_remaining in dissect_spoolss_uint16uni. Make\nsure our offset always increments in dissect_spoolss_keybuffer.\n\nConflicts:\n\tepan/dissectors/packet-dcerpc-spoolss.c\n\nChange-Id: I7017c9685bb2fa27161d80a03b8fca4ef630e793\nReviewed-on: https://code.wireshark.org/review/14687\nReviewed-by: Gerald Combs <gerald@wireshark.org>\nPetri-Dish: Gerald Combs <gerald@wireshark.org>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit b4d16b4495b732888e12baf5b8a7e9bf2665e22b)\nReviewed-on: https://code.wireshark.org/review/15248\n(cherry picked from commit 9753ea8db4ea2caeb3365e842e904cbe5681b79e)\nReviewed-on: https://code.wireshark.org/review/15249",
        "before_after_code_files": [
          "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
          ],
          "candidate": [
            "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c": [
          "File: epan/dissectors/packet-dcerpc-spoolss.c -> epan/dissectors/packet-dcerpc-spoolss.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1081:  if (remaining <= 0) {",
          "1082:   if (data)",
          "",
          "[Removed Lines]",
          "1080:  remaining = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "1080:  remaining = tvb_reported_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "6556:   end_offset = tvb_reported_length_remaining(tvb, offset) + 1;",
          "6557:  }",
          "6560:   offset = dissect_spoolss_uint16uni(",
          "6561:    tvb, offset, pinfo, tree, drep, NULL, \"Key\");",
          "6563:  return offset;",
          "6564: }",
          "",
          "[Removed Lines]",
          "6559:  while (offset < end_offset)",
          "",
          "[Added Lines]",
          "6559:  while (offset > 0 && offset < end_offset) {",
          "6562:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dd47a5217abcaf6d9085a44e9c1dd8821baf565f",
      "candidate_info": {
        "commit_hash": "dd47a5217abcaf6d9085a44e9c1dd8821baf565f",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/dd47a5217abcaf6d9085a44e9c1dd8821baf565f",
        "files": [
          "epan/dissectors/packet-dcerpc-spoolss.c"
        ],
        "message": "SPOOLSS: Try to avoid an infinite loop.\n\nUse tvb_reported_length_remaining in dissect_spoolss_uint16uni. Make\nsure our offset always increments in dissect_spoolss_keybuffer.\n\nConflicts:\n\tepan/dissectors/packet-dcerpc-spoolss.c\n\nChange-Id: I7017c9685bb2fa27161d80a03b8fca4ef630e793\nReviewed-on: https://code.wireshark.org/review/14687\nReviewed-by: Gerald Combs <gerald@wireshark.org>\nPetri-Dish: Gerald Combs <gerald@wireshark.org>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit b4d16b4495b732888e12baf5b8a7e9bf2665e22b)\nReviewed-on: https://code.wireshark.org/review/15248\n(cherry picked from commit 9753ea8db4ea2caeb3365e842e904cbe5681b79e)\nReviewed-on: https://code.wireshark.org/review/15249\n(cherry picked from commit 80006b0eb062a45479d109796df14c13ca7c5785)\nReviewed-on: https://code.wireshark.org/review/16119\nReviewed-by: Balint Reczey <balint@balintreczey.hu>",
        "before_after_code_files": [
          "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
          ],
          "candidate": [
            "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c": [
          "File: epan/dissectors/packet-dcerpc-spoolss.c -> epan/dissectors/packet-dcerpc-spoolss.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1081:  if (remaining <= 0) {",
          "1082:   if (data)",
          "",
          "[Removed Lines]",
          "1080:  remaining = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "1080:  remaining = tvb_reported_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "6556:   end_offset = tvb_reported_length_remaining(tvb, offset) + 1;",
          "6557:  }",
          "6560:   offset = dissect_spoolss_uint16uni(",
          "6561:    tvb, offset, pinfo, tree, drep, NULL, \"Key\");",
          "6563:  return offset;",
          "6564: }",
          "",
          "[Removed Lines]",
          "6559:  while (offset < end_offset)",
          "",
          "[Added Lines]",
          "6559:  while (offset > 0 && offset < end_offset) {",
          "6562:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "958cef5d68f4e18fc648a0bbb30408eb206fb0ef",
      "candidate_info": {
        "commit_hash": "958cef5d68f4e18fc648a0bbb30408eb206fb0ef",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/958cef5d68f4e18fc648a0bbb30408eb206fb0ef",
        "files": [
          "epan/dissectors/file-png.c",
          "epan/dissectors/packet-dcerpc-krb5rpc.c",
          "epan/dissectors/packet-dcerpc-netlogon.c",
          "epan/dissectors/packet-dcerpc-nt.c",
          "epan/dissectors/packet-dcerpc-rs_pgo.c",
          "epan/dissectors/packet-dcerpc-spoolss.c",
          "epan/dissectors/packet-dcp-etsi.c",
          "epan/dissectors/packet-dlm3.c",
          "epan/dissectors/packet-dlsw.c",
          "epan/dissectors/packet-dmp.c",
          "epan/dissectors/packet-dmx-sip.c",
          "epan/dissectors/packet-dmx.c",
          "epan/dissectors/packet-dnp.c",
          "epan/dissectors/packet-dplay.c",
          "epan/dissectors/packet-drda.c",
          "epan/dissectors/packet-dsi.c",
          "epan/dissectors/packet-dtn.c",
          "epan/dissectors/packet-dtpt.c",
          "epan/dissectors/packet-dua.c",
          "epan/dissectors/packet-dvb-s2-bb.c",
          "epan/dissectors/packet-dvmrp.c",
          "epan/dissectors/packet-e100.c",
          "epan/dissectors/packet-eap.c",
          "epan/dissectors/packet-egd.c"
        ],
        "message": "Remove more deprecated tvb_length\n\nChange-Id: Iac23a6c804ad3720d37186559477909b2ff33eb2\nReviewed-on: https://code.wireshark.org/review/9042\nReviewed-by: Evan Huus <eapache@gmail.com>",
        "before_after_code_files": [
          "epan/dissectors/file-png.c||epan/dissectors/file-png.c",
          "epan/dissectors/packet-dcerpc-krb5rpc.c||epan/dissectors/packet-dcerpc-krb5rpc.c",
          "epan/dissectors/packet-dcerpc-netlogon.c||epan/dissectors/packet-dcerpc-netlogon.c",
          "epan/dissectors/packet-dcerpc-nt.c||epan/dissectors/packet-dcerpc-nt.c",
          "epan/dissectors/packet-dcerpc-rs_pgo.c||epan/dissectors/packet-dcerpc-rs_pgo.c",
          "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c",
          "epan/dissectors/packet-dcp-etsi.c||epan/dissectors/packet-dcp-etsi.c",
          "epan/dissectors/packet-dlm3.c||epan/dissectors/packet-dlm3.c",
          "epan/dissectors/packet-dlsw.c||epan/dissectors/packet-dlsw.c",
          "epan/dissectors/packet-dmp.c||epan/dissectors/packet-dmp.c",
          "epan/dissectors/packet-dmx-sip.c||epan/dissectors/packet-dmx-sip.c",
          "epan/dissectors/packet-dmx.c||epan/dissectors/packet-dmx.c",
          "epan/dissectors/packet-dnp.c||epan/dissectors/packet-dnp.c",
          "epan/dissectors/packet-dplay.c||epan/dissectors/packet-dplay.c",
          "epan/dissectors/packet-drda.c||epan/dissectors/packet-drda.c",
          "epan/dissectors/packet-dsi.c||epan/dissectors/packet-dsi.c",
          "epan/dissectors/packet-dtn.c||epan/dissectors/packet-dtn.c",
          "epan/dissectors/packet-dtpt.c||epan/dissectors/packet-dtpt.c",
          "epan/dissectors/packet-dua.c||epan/dissectors/packet-dua.c",
          "epan/dissectors/packet-dvb-s2-bb.c||epan/dissectors/packet-dvb-s2-bb.c",
          "epan/dissectors/packet-dvmrp.c||epan/dissectors/packet-dvmrp.c",
          "epan/dissectors/packet-e100.c||epan/dissectors/packet-e100.c",
          "epan/dissectors/packet-eap.c||epan/dissectors/packet-eap.c",
          "epan/dissectors/packet-egd.c||epan/dissectors/packet-egd.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
          ],
          "candidate": [
            "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/file-png.c||epan/dissectors/file-png.c": [
          "File: epan/dissectors/file-png.c -> epan/dissectors/file-png.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "441:     static const guint8 magic[8] = { 137, 80, 78, 71, 13, 10, 26, 10 };",
          "444:         return 0;",
          "445:     if (tvb_memeql(tvb, 0, magic, sizeof(magic)) != 0)",
          "446:         return 0;",
          "",
          "[Removed Lines]",
          "443:     if (tvb_length(tvb) < 20)",
          "",
          "[Added Lines]",
          "443:     if (tvb_captured_length(tvb) < 20)",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dcerpc-krb5rpc.c||epan/dissectors/packet-dcerpc-krb5rpc.c": [
          "File: epan/dissectors/packet-dcerpc-krb5rpc.c -> epan/dissectors/packet-dcerpc-krb5rpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "84:   item = proto_tree_add_item (tree, hf_krb5rpc_krb5, tvb, offset, -1, ENC_NA);",
          "85:   subtree = proto_item_add_subtree (item, ett_krb5rpc_krb5);",
          "88:   krb5_tvb = tvb_new_subset (tvb, offset, remain, remain);",
          "89:   offset = dissect_kerberos_main (krb5_tvb, pinfo, subtree, TRUE, NULL);",
          "",
          "[Removed Lines]",
          "87:   remain = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "87:   remain = tvb_captured_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "130:   item = proto_tree_add_item (tree, hf_krb5rpc_krb5, tvb, offset, -1, ENC_NA);",
          "131:   subtree = proto_item_add_subtree (item, ett_krb5rpc_krb5);",
          "133:   krb5_tvb = tvb_new_subset (tvb, offset, remain, remain);",
          "135:   offset = dissect_kerberos_main (krb5_tvb, pinfo, subtree, TRUE, NULL);",
          "",
          "[Removed Lines]",
          "132:   remain = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "132:   remain = tvb_captured_length_remaining(tvb, offset);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dcerpc-netlogon.c||epan/dissectors/packet-dcerpc-netlogon.c": [
          "File: epan/dissectors/packet-dcerpc-netlogon.c -> epan/dissectors/packet-dcerpc-netlogon.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "7704:                 int data_len;",
          "7705:                 guint64 copyconfounder = vars->confounder;",
          "7708:                 if (data_len < 0) {",
          "7709:                     return NULL;",
          "7710:                 }",
          "",
          "[Removed Lines]",
          "7707:                 data_len = tvb_length_remaining(tvb,offset);",
          "",
          "[Added Lines]",
          "7707:                 data_len = tvb_captured_length_remaining(tvb,offset);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dcerpc-nt.c||epan/dissectors/packet-dcerpc-nt.c": [
          "File: epan/dissectors/packet-dcerpc-nt.c -> epan/dissectors/packet-dcerpc-nt.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "91:    proto_registrar_get_name(hf_index));",
          "93:  if (use_remaining_space) {",
          "95:  } else {",
          "96:   offset = dissect_ndr_uint3264(tvb, offset, pinfo, subtree, di, drep,",
          "97:         hf_nt_data_blob_len, &len);",
          "",
          "[Removed Lines]",
          "94:   len = tvb_length_remaining (tvb, offset);",
          "",
          "[Added Lines]",
          "94:   len = tvb_captured_length_remaining (tvb, offset);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dcerpc-rs_pgo.c||epan/dissectors/packet-dcerpc-rs_pgo.c": [
          "File: epan/dissectors/packet-dcerpc-rs_pgo.c -> epan/dissectors/packet-dcerpc-rs_pgo.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "967:         [out]       error_status_t      *status",
          "973: if (buff_remain > 8) {",
          "",
          "[Removed Lines]",
          "970:  buff_remain = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "970:  buff_remain = tvb_captured_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1019:         [out]       rs_cache_data_t     *cache_info,",
          "1020:         [out]       error_status_t      *status",
          "",
          "[Removed Lines]",
          "1022:  buff_remain = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "1022:  buff_remain = tvb_captured_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1185:         [out]       error_status_t      *status",
          "1191: if (buff_remain > 8) {",
          "",
          "[Removed Lines]",
          "1188:  buff_remain = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "1188:  buff_remain = tvb_captured_length_remaining(tvb, offset);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dcerpc-spoolss.c||epan/dissectors/packet-dcerpc-spoolss.c": [
          "File: epan/dissectors/packet-dcerpc-spoolss.c -> epan/dissectors/packet-dcerpc-spoolss.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1075:  if (remaining <= 0) {",
          "1076:   if (data)",
          "",
          "[Removed Lines]",
          "1074:  remaining = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "1074:  remaining = tvb_captured_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3853:   goto done;",
          "3855:  offset = dissect_ndr_uint32(",
          "",
          "[Removed Lines]",
          "3852:  if (tvb_length_remaining(tvb, offset) <= 0)",
          "",
          "[Added Lines]",
          "3852:  if (tvb_reported_length_remaining(tvb, offset) <= 0)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4189: SpoolssGeneric_r(tvbuff_t *tvb, int offset, packet_info *pinfo,",
          "4190:        proto_tree *tree, dcerpc_info *di, guint8 *drep _U_)",
          "4191: {",
          "4194:  proto_tree_add_text(tree, tvb, offset, 0,",
          "4195:        \"[Unimplemented dissector: SPOOLSS]\");",
          "",
          "[Removed Lines]",
          "4192:  int len = tvb_length(tvb);",
          "",
          "[Added Lines]",
          "4192:  int len = tvb_reported_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dcp-etsi.c||epan/dissectors/packet-dcp-etsi.c": [
          "File: epan/dissectors/packet-dcp-etsi.c -> epan/dissectors/packet-dcp-etsi.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "182:     return FALSE;",
          "184:   word = tvb_get_ntohs(tvb,0);",
          "",
          "[Removed Lines]",
          "181:   if(tvb_length(tvb) < 11)",
          "",
          "[Added Lines]",
          "181:   if(tvb_captured_length(tvb) < 11)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "337:                                             NULL, tree);",
          "338:     }",
          "339:   }",
          "341:     gboolean decoded;",
          "342:     tvbuff_t *dtvb = NULL;",
          "343:     const guint8 *input = tvb_get_ptr(new_tvb, 0, -1);",
          "345:     guint8 *deinterleaved = (guint8*) g_malloc (reassembled_size);",
          "346:     guint8 *output = (guint8*) g_malloc (decoded_size);",
          "347:     rs_deinterleave(input, deinterleaved, plen, fcount);",
          "",
          "[Removed Lines]",
          "340:   if(new_tvb && tvb_length(new_tvb) > 0) {",
          "344:     guint32 reassembled_size = tvb_length(new_tvb);",
          "",
          "[Added Lines]",
          "340:   if(new_tvb && tvb_captured_length(new_tvb) > 0) {",
          "344:     guint32 reassembled_size = tvb_captured_length(new_tvb);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "501:   offset += 2;",
          "503:     gboolean save_fragmented = pinfo->fragmented;",
          "505:     proto_tree_add_item (pft_tree, hf_edcp_pft_payload, tvb, offset, real_len, ENC_NA);",
          "506:     if(real_len != payload_len || real_len == 0) {",
          "507:       proto_item_append_text(li, \" (length error (%d))\", real_len);",
          "",
          "[Removed Lines]",
          "504:     guint16 real_len = tvb_length(tvb)-offset;",
          "",
          "[Added Lines]",
          "504:     guint16 real_len = tvb_captured_length(tvb)-offset;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "549:   offset += 2;",
          "550:   payload_len = tvb_get_ntohl(tvb, offset);",
          "551:   if (tree) {",
          "553:     li = proto_tree_add_item (af_tree, hf_edcp_len, tvb, offset, 4, ENC_BIG_ENDIAN);",
          "554:     if(real_payload_len < payload_len) {",
          "555:       proto_item_append_text (li, \" (wrong len claims %d is %d)\",",
          "",
          "[Removed Lines]",
          "552:     guint32 real_payload_len = tvb_length(tvb)-12;",
          "",
          "[Added Lines]",
          "552:     guint32 real_payload_len = tvb_captured_length(tvb)-12;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "612:   ti = proto_tree_add_item (tree, proto_tpl, tvb, 0, -1, ENC_NA);",
          "613:   tpl_tree = proto_item_add_subtree (ti, ett_tpl);",
          "616:     guint32 bits;",
          "617:     guint32 bytes;",
          "618:     char *tag = (char*)tvb_get_string_enc(wmem_packet_scope(), tvb, offset, 4, ENC_ASCII); offset += 4;",
          "",
          "[Removed Lines]",
          "615:   while(offset<tvb_length(tvb)) {",
          "",
          "[Added Lines]",
          "615:   while(offset<tvb_reported_length(tvb)) {",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dlm3.c||epan/dissectors/packet-dlm3.c": [
          "File: epan/dissectors/packet-dlm3.c -> epan/dissectors/packet-dlm3.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "762:   if (length < 4 + 4 + 4 + 2 + 1 + 1)",
          "763:     return 0;",
          "",
          "[Removed Lines]",
          "761:   length = tvb_length(tvb);",
          "",
          "[Added Lines]",
          "761:   length = tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "837:       dissect_dlm3_rcom(tvb, pinfo, sub_tree, length, offset);",
          "838:     }",
          "839:   }",
          "841: }",
          "",
          "[Removed Lines]",
          "840:   return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "840:   return tvb_captured_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dlsw.c||epan/dissectors/packet-dlsw.c": [
          "File: epan/dissectors/packet-dlsw.c -> epan/dissectors/packet-dlsw.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "423:   }",
          "426: }",
          "428: static void",
          "",
          "[Removed Lines]",
          "425:   return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "425:   return tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "570:   }",
          "572:   tcp_dissect_pdus(tvb, pinfo, tree, TRUE, 4, get_dlsw_pdu_len, dissect_dlsw_pdu, data);",
          "574: }",
          "576: void",
          "",
          "[Removed Lines]",
          "573:   return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "573:   return tvb_captured_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dmp.c||epan/dissectors/packet-dmp.c": [
          "File: epan/dissectors/packet-dmp.c -> epan/dissectors/packet-dmp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2654:   if (dmp.ack_rec_present) {",
          "2657:     if (dmp.checksum) {",
          "2658:       rec_len -= 2;",
          "2659:     }",
          "",
          "[Removed Lines]",
          "2656:     rec_len = tvb_length (tvb);",
          "",
          "[Added Lines]",
          "2656:     rec_len = tvb_reported_length (tvb);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3157:     offset += 1;",
          "3158:   }",
          "3161:   if (dmp.checksum) {",
          "3162:     len -= 2;",
          "3163:   }",
          "",
          "[Removed Lines]",
          "3160:   len = tvb_length_remaining (tvb, offset);",
          "",
          "[Added Lines]",
          "3160:   len = tvb_reported_length_remaining (tvb, offset);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3181:                          dmp.body_format == FREE_TEXT_SUBJECT)) {",
          "3182:     if (compr_alg == ALGORITHM_ZLIB) {",
          "3183:       if ((body_tvb = tvb_child_uncompress (tvb, tvb, offset, len)) != NULL) {",
          "3185:         add_new_data_source (pinfo, body_tvb, \"Uncompressed User data\");",
          "3186:         tf = proto_tree_add_item (message_tree, hf_message_body_data,",
          "3187:                                   body_tvb, 0, body_len, ENC_NA);",
          "",
          "[Removed Lines]",
          "3184:         body_len = tvb_length (body_tvb);",
          "",
          "[Added Lines]",
          "3184:         body_len = tvb_captured_length (body_tvb);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "3889:     offset = dissect_dmp_message (tvb, pinfo, dmp_tree, offset);",
          "3890:   } else if (dmp.msg_type == REPORT) {",
          "3893:     if (dmp.checksum) {",
          "3894:       rep_len -= 2;",
          "3895:     }",
          "",
          "[Removed Lines]",
          "3892:     rep_len = tvb_length (tvb);",
          "",
          "[Added Lines]",
          "3892:     rep_len = tvb_reported_length (tvb);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "3984:   }",
          "3986:   if (dmp.checksum) {",
          "3988:     checksum1 = crc16_x25_ccitt_tvb (tvb, length - 2);",
          "3989:     checksum2 = tvb_get_ntohs (tvb, offset);",
          "",
          "[Removed Lines]",
          "3987:     length = tvb_length (tvb);",
          "",
          "[Added Lines]",
          "3987:     length = tvb_captured_length (tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dmx-sip.c||epan/dissectors/packet-dmx-sip.c": [
          "File: epan/dissectors/packet-dmx-sip.c -> epan/dissectors/packet-dmx-sip.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "188:   offset += 1;",
          "191:    proto_tree_add_item(dmx_sip_tree, hf_dmx_sip_trailer, tvb,",
          "192:      offset, -1, ENC_NA);",
          "193:  }",
          "",
          "[Removed Lines]",
          "190:   if (offset < tvb_length(tvb))",
          "",
          "[Added Lines]",
          "190:   if (offset < tvb_reported_length(tvb))",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dmx.c||epan/dissectors/packet-dmx.c": [
          "File: epan/dissectors/packet-dmx.c -> epan/dissectors/packet-dmx.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "103:   call_dissector(dmx_sip_handle, next_tvb, pinfo, tree);",
          "104:   break;",
          "105:  default:",
          "107:    call_dissector(data_handle, next_tvb, pinfo, tree);",
          "108:   break;",
          "109:  }",
          "",
          "[Removed Lines]",
          "106:   if (offset < tvb_length(tvb))",
          "",
          "[Added Lines]",
          "106:   if (offset < tvb_reported_length(tvb))",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dnp.c||epan/dissectors/packet-dnp.c": [
          "File: epan/dissectors/packet-dnp.c -> epan/dissectors/packet-dnp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1802:   if (num_items < 0) {",
          "1803:     proto_item_append_text(range_item, \" (bogus)\");",
          "1804:     expert_add_info(pinfo, range_item, &ei_dnp_num_items_neg);",
          "1806:   }",
          "",
          "[Removed Lines]",
          "1805:     return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "1805:     return tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2882:   nstime_set_zero (&al_cto);",
          "2887:   al_ctl = tvb_get_guint8(tvb, offset);",
          "",
          "[Removed Lines]",
          "2884:   data_len = tvb_length(tvb);",
          "",
          "[Added Lines]",
          "2884:   data_len = tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3433:     }",
          "3434:   }",
          "3437: }",
          "3439: static gboolean",
          "",
          "[Removed Lines]",
          "3436:   return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "3436:   return tvb_captured_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dplay.c||epan/dissectors/packet-dplay.c": [
          "File: epan/dissectors/packet-dplay.c -> epan/dissectors/packet-dplay.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1124: {",
          "1125:     guint32 dplay_id, token;",
          "1128:         return FALSE;",
          "",
          "[Removed Lines]",
          "1127:     if(tvb_length(tvb) < 25)",
          "",
          "[Added Lines]",
          "1127:     if(tvb_captured_length(tvb) < 25)",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-drda.c||epan/dissectors/packet-drda.c": [
          "File: epan/dissectors/packet-drda.c -> epan/dissectors/packet-drda.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "698:     iPreviousFrameNumber = pinfo->fd->num;",
          "701:     {",
          "702:         iCommand = tvb_get_ntohs(tvb, offset + 8);",
          "703:         iLength = tvb_get_ntohs(tvb, offset + 0);",
          "",
          "[Removed Lines]",
          "700:     while ((guint) (offset + 10) <= tvb_length(tvb))",
          "",
          "[Added Lines]",
          "700:     while ((guint) (offset + 10) <= tvb_reported_length(tvb))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "738:             for (offset += 10; offset < iCommandEnd; )",
          "739:             {",
          "741:                 {",
          "742:                     iLengthParam = tvb_get_ntohs(tvb, offset + 0);",
          "743:                     if (iLengthParam == 0 || iLengthParam == 1) iLengthParam = iLength - 10;",
          "745:                     {",
          "746:                         iParameterCP = tvb_get_ntohs(tvb, offset + 2);",
          "747:                         drda_tree_sub = proto_tree_add_subtree(drdaroot_tree, tvb, offset, iLengthParam,",
          "",
          "[Removed Lines]",
          "740:                 if (tvb_length_remaining(tvb, offset) >= 2)",
          "744:                     if (tvb_length_remaining(tvb, offset) >= iLengthParam)",
          "",
          "[Added Lines]",
          "740:                 if (tvb_reported_length_remaining(tvb, offset) >= 2)",
          "744:                     if (tvb_reported_length_remaining(tvb, offset) >= iLengthParam)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "776:         }",
          "777:     }",
          "780: }",
          "782: static guint",
          "783: get_drda_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)",
          "784: {",
          "790: }",
          "792: static int",
          "793: dissect_drda_tcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)",
          "794: {",
          "795:     tcp_dissect_pdus(tvb, pinfo, tree, drda_desegment, 10, get_drda_pdu_len, dissect_drda, data);",
          "797: }",
          "",
          "[Removed Lines]",
          "779:     return tvb_length(tvb);",
          "785:     if (tvb_length_remaining(tvb, offset) >= 10)",
          "786:     {",
          "787:         return (tvb_get_ntohs(tvb, offset));",
          "788:     }",
          "789:     return 0;",
          "796:     return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "779:     return tvb_captured_length(tvb);",
          "785:     return (tvb_get_ntohs(tvb, offset));",
          "792:     return tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "801: dissect_drda_heur(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)",
          "802: {",
          "803:     conversation_t * conversation;",
          "805:     {",
          "807:         guint16 cOuterLength, cInnerLength;",
          "",
          "[Removed Lines]",
          "804:     if (tvb_length(tvb) >= 10)",
          "",
          "[Added Lines]",
          "800:     if (tvb_captured_length(tvb) >= 10)",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dsi.c||epan/dissectors/packet-dsi.c": [
          "File: epan/dissectors/packet-dsi.c -> epan/dissectors/packet-dsi.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "321:   break;",
          "322:  }",
          "325: }",
          "327: static guint",
          "",
          "[Removed Lines]",
          "324:  return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "324:  return tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "335:  if ( dsi_flags > DSIFL_MAX || !dsi_command || dsi_command > DSIFUNC_MAX)",
          "336:  {",
          "339:  }",
          "",
          "[Removed Lines]",
          "338:      return tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "338:      return tvb_captured_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "356:  tcp_dissect_pdus(tvb, pinfo, tree, dsi_desegment, 12,",
          "357:      get_dsi_pdu_len, dissect_dsi_packet, data);",
          "360: }",
          "362: void",
          "",
          "[Removed Lines]",
          "359:  return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "359:  return tvb_captured_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dtn.c||epan/dissectors/packet-dtn.c": [
          "File: epan/dissectors/packet-dtn.c -> epan/dissectors/packet-dtn.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1760:     }",
          "1762:     proto_tree_add_item(conv_tree, hf_contact_hdr_local_eid, tvb, sdnv_length + offset, eid_length, ENC_NA|ENC_ASCII);",
          "1764: }",
          "1766: static guint",
          "",
          "[Removed Lines]",
          "1763:     return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "1763:     return tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1889:             if (bundle_size == 0) {",
          "1891:                 call_dissector(data_handle, new_tvb, pinfo, sub_tree);",
          "1893:             }",
          "1894:         }",
          "1895:         else {",
          "",
          "[Removed Lines]",
          "1892:                 return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "1892:                 return tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1946:         break;",
          "1947:     }",
          "1950: }",
          "1952: static int",
          "",
          "[Removed Lines]",
          "1949:     return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "1949:     return tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2003:             }",
          "2005:             tcp_dissect_pdus(tvb, pinfo, tree, TRUE, 8, get_dtn_contact_header_len, dissect_dtn_contact_header, data);",
          "2007:         }",
          "",
          "[Removed Lines]",
          "2006:             return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "2006:             return tvb_captured_length(tvb);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2011:     };",
          "2013:     tcp_dissect_pdus(tvb, pinfo, tree, TRUE, 1, get_tcpcl_pdu_len, dissect_tcpcl_pdu, data);",
          "2015: }",
          "2017: static int",
          "",
          "[Removed Lines]",
          "2014:     return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "2014:     return tvb_captured_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dtpt.c||epan/dissectors/packet-dtpt.c": [
          "File: epan/dissectors/packet-dtpt.c -> epan/dissectors/packet-dtpt.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "774:   }",
          "775:  }",
          "778: }",
          "780: void proto_reg_handoff_dtpt(void);",
          "",
          "[Removed Lines]",
          "777:  return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "777:  return tvb_captured_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dua.c||epan/dissectors/packet-dua.c": [
          "File: epan/dissectors/packet-dua.c -> epan/dissectors/packet-dua.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "467:   tag            = tvb_get_ntohs(parameter_tvb, PARAMETER_TAG_OFFSET);",
          "468:   length         = tvb_get_ntohs(parameter_tvb, PARAMETER_LENGTH_OFFSET);",
          "472:   parameter_tree   = proto_tree_add_subtree(dua_tree, parameter_tvb, PARAMETER_HEADER_OFFSET,",
          "",
          "[Removed Lines]",
          "469:   padding_length = tvb_length(parameter_tvb) - length;",
          "",
          "[Added Lines]",
          "469:   padding_length = tvb_reported_length(parameter_tvb) - length;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "542:   tvbuff_t *parameter_tvb;",
          "544:   offset = 0;",
          "546:     length       = tvb_get_ntohs(parameters_tvb, offset + PARAMETER_LENGTH_OFFSET);",
          "547:     total_length = ADD_PADDING(length);",
          "548:     if (remaining_length >= length)",
          "",
          "[Removed Lines]",
          "545:   while((remaining_length = tvb_length_remaining(parameters_tvb, offset))) {",
          "",
          "[Added Lines]",
          "545:   while((remaining_length = tvb_reported_length_remaining(parameters_tvb, offset))) {",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dvb-s2-bb.c||epan/dissectors/packet-dvb-s2-bb.c": [
          "File: epan/dissectors/packet-dvb-s2-bb.c -> epan/dissectors/packet-dvb-s2-bb.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "700:     guint8 input8;",
          "704:         return FALSE;",
          "706:     input8 = tvb_get_guint8(tvb, offset + DVB_S2_BB_OFFS_CRC);",
          "",
          "[Removed Lines]",
          "703:     if (tvb_length(tvb) < (offset + DVB_S2_BB_HEADER_LEN))",
          "",
          "[Added Lines]",
          "703:     if (tvb_captured_length(tvb) < (offset + DVB_S2_BB_HEADER_LEN))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "820:     guint8      byte;",
          "824:         return 0;",
          "",
          "[Removed Lines]",
          "823:     if (tvb_length(tvb) < 1)",
          "",
          "[Added Lines]",
          "823:     if (tvb_captured_length(tvb) < 1)",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dvmrp.c||epan/dissectors/packet-dvmrp.c": [
          "File: epan/dissectors/packet-dvmrp.c -> epan/dissectors/packet-dvmrp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "687:  item = proto_tree_add_item(parent_tree, proto_dvmrp, tvb, offset, -1, ENC_NA);",
          "688:  tree = proto_item_add_subtree(item, ett_dvmrp);",
          "691:   && (((tvb_get_guint8(tvb, 6)==0xff)",
          "692:   && (tvb_get_guint8(tvb, 7)==0x03))",
          "693:       || !strict_v3)) {",
          "",
          "[Removed Lines]",
          "690:  if ((tvb_length_remaining(tvb, offset)>=8)",
          "",
          "[Added Lines]",
          "690:  if ((tvb_captured_length_remaining(tvb, offset)>=8)",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-e100.c||epan/dissectors/packet-e100.c": [
          "File: epan/dissectors/packet-e100.c -> epan/dissectors/packet-e100.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "78:             tvb_get_guint8(tvb, e100_header_ver.offset) == 1 &&",
          "80:         {",
          "81:             guint32 bytes_captured=0;",
          "82:             col_set_str(pinfo->cinfo, COL_PROTOCOL, \"e100\");",
          "",
          "[Removed Lines]",
          "77:         if (tvb_length(tvb) >= e100_encap_len &&",
          "79:             tvb_get_ntohl(tvb, e100_bytes_cap.offset) == tvb_length(tvb)-e100_encap_len)",
          "",
          "[Added Lines]",
          "77:         if (tvb_captured_length(tvb) >= e100_encap_len &&",
          "79:             tvb_get_ntohl(tvb, e100_bytes_cap.offset) == tvb_reported_length(tvb)-e100_encap_len)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "117:             next_tvb = tvb_new_subset(tvb, e100_encap_len, -1, bytes_captured);",
          "118:             call_dissector(eth_handle, next_tvb, pinfo, tree);",
          "123:     return ret_val;",
          "",
          "[Removed Lines]",
          "120:             ret_val = tvb_length(tvb);",
          "",
          "[Added Lines]",
          "120:             ret_val = tvb_captured_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-eap.c||epan/dissectors/packet-eap.c": [
          "File: epan/dissectors/packet-eap.c -> epan/dissectors/packet-eap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "858:           gint      tvb_len;",
          "859:           gboolean  save_fragmented;",
          "862:           if (size < tvb_len)",
          "863:             tvb_len = size;",
          "",
          "[Removed Lines]",
          "861:           tvb_len = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "861:           tvb_len = tvb_captured_length_remaining(tvb, offset);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1193: }",
          "1195: void",
          "",
          "[Removed Lines]",
          "1192:   return tvb_length(tvb);",
          "",
          "[Added Lines]",
          "1192:   return tvb_captured_length(tvb);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-egd.c||epan/dissectors/packet-egd.c": [
          "File: epan/dissectors/packet-egd.c -> epan/dissectors/packet-egd.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "146:     proto_tree_add_item(egd_tree, hf_egd_resv, tvb, offset, 4, ENC_LITTLE_ENDIAN);",
          "147:     offset += 4;",
          "150:     if (data_length > 0)",
          "151:     {",
          "152:       next_tvb = tvb_new_subset_remaining(tvb, offset);",
          "",
          "[Removed Lines]",
          "149:     data_length = tvb_length_remaining(tvb, offset);",
          "",
          "[Added Lines]",
          "149:     data_length = tvb_reported_length_remaining(tvb, offset);",
          "",
          "---------------"
        ]
      }
    }
  ]
}