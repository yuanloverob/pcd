{
  "cve_id": "CVE-2022-2652",
  "cve_desc": "Depending on the way the format strings in the card label are crafted it's possible to leak kernel stack memory. There is also the possibility for DoS due to the v4l2loopback kernel module crashing when providing the card label on request (reproduce e.g. with many %s modifiers in a row).",
  "repo": "umlaeute/v4l2loopback",
  "patch_hash": "e4cd225557486c420f6a34411f98c575effd43dd",
  "patch_info": {
    "commit_hash": "e4cd225557486c420f6a34411f98c575effd43dd",
    "repo": "umlaeute/v4l2loopback",
    "commit_url": "https://github.com/umlaeute/v4l2loopback/commit/e4cd225557486c420f6a34411f98c575effd43dd",
    "files": [
      "v4l2loopback.c"
    ],
    "message": "add explicit format specifier to printf() invocations\n\nCWE-134",
    "before_after_code_files": [
      "v4l2loopback.c||v4l2loopback.c"
    ]
  },
  "patch_diff": {
    "v4l2loopback.c||v4l2loopback.c": [
      "File: v4l2loopback.c -> v4l2loopback.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "756:  __u32 capabilities = V4L2_CAP_STREAMING | V4L2_CAP_READWRITE;",
      "758:  strlcpy(cap->driver, \"v4l2 loopback\", sizeof(cap->driver));",
      "760:  snprintf(cap->bus_info, sizeof(cap->bus_info),",
      "761:    \"platform:v4l2loopback-%03d\", device_nr);",
      "",
      "[Removed Lines]",
      "759:  snprintf(cap->card, labellen, dev->card_label);",
      "",
      "[Added Lines]",
      "759:  snprintf(cap->card, labellen, \"%s\", dev->card_label);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2494:  }",
      "2496:  MARK();",
      "2499:  vdev_priv->device_nr = nr;",
      "",
      "[Removed Lines]",
      "2497:  snprintf(dev->vdev->name, sizeof(dev->vdev->name), dev->card_label);",
      "",
      "[Added Lines]",
      "2497:  snprintf(dev->vdev->name, sizeof(dev->vdev->name), \"%s\", dev->card_label);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "64a216af4c09c9ba9326057d7e78994271827eff",
      "candidate_info": {
        "commit_hash": "64a216af4c09c9ba9326057d7e78994271827eff",
        "repo": "umlaeute/v4l2loopback",
        "commit_url": "https://github.com/umlaeute/v4l2loopback/commit/64a216af4c09c9ba9326057d7e78994271827eff",
        "files": [
          "v4l2loopback.c"
        ],
        "message": "add explicit format specifier to printf() invocations\n\nCWE-134",
        "before_after_code_files": [
          "v4l2loopback.c||v4l2loopback.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "v4l2loopback.c||v4l2loopback.c"
          ],
          "candidate": [
            "v4l2loopback.c||v4l2loopback.c"
          ]
        }
      },
      "candidate_diff": {
        "v4l2loopback.c||v4l2loopback.c": [
          "File: v4l2loopback.c -> v4l2loopback.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "657: static void vidioc_fill_name(char *buf, int len, int nr)",
          "658: {",
          "659:  if (card_label[nr] != NULL) {",
          "661:  } else {",
          "662:   snprintf(buf, len, \"Dummy video device (0x%04X)\", nr);",
          "663:  }",
          "",
          "[Removed Lines]",
          "660:   snprintf(buf, len, card_label[nr]);",
          "",
          "[Added Lines]",
          "660:   snprintf(buf, len, \"%s\", card_label[nr]);",
          "",
          "---------------"
        ]
      }
    }
  ]
}