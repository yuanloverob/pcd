{
  "cve_id": "CVE-2015-1788",
  "cve_desc": "The BN_GF2m_mod_inv function in crypto/bn/bn_gf2m.c in OpenSSL before 0.9.8s, 1.0.0 before 1.0.0e, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b does not properly handle ECParameters structures in which the curve is over a malformed binary polynomial field, which allows remote attackers to cause a denial of service (infinite loop) via a session that uses an Elliptic Curve algorithm, as demonstrated by an attack against a server that supports client authentication.",
  "repo": "openssl/openssl",
  "patch_hash": "4924b37ee01f71ae19c94a8934b80eeb2f677932",
  "patch_info": {
    "commit_hash": "4924b37ee01f71ae19c94a8934b80eeb2f677932",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/4924b37ee01f71ae19c94a8934b80eeb2f677932",
    "files": [
      "crypto/bn/bn_gf2m.c"
    ],
    "message": "bn/bn_gf2m.c: avoid infinite loop wich malformed ECParamters.\n\nCVE-2015-1788\n\nReviewed-by: Matt Caswell <matt@openssl.org>",
    "before_after_code_files": [
      "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c"
    ]
  },
  "patch_diff": {
    "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c": [
      "File: crypto/bn/bn_gf2m.c -> crypto/bn/bn_gf2m.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "691:     }",
      "692: # else",
      "693:     {",
      "697:         BN_ULONG *udp, *bdp, *vdp, *cdp;",
      "699:         bn_wexpand(u, top);",
      "",
      "[Removed Lines]",
      "694:         int i, ubits = BN_num_bits(u), vbits = BN_num_bits(v), /* v is copy",
      "696:             top = p->top;",
      "",
      "[Added Lines]",
      "694:         int i;",
      "695:         int ubits = BN_num_bits(u);",
      "697:         int top = p->top;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "737:                 ubits--;",
      "738:             }",
      "743:             if (ubits < vbits) {",
      "744:                 i = ubits;",
      "",
      "[Removed Lines]",
      "740:             if (ubits <= BN_BITS2 && udp[0] == 1)",
      "741:                 break;",
      "",
      "[Added Lines]",
      "741:             if (ubits <= BN_BITS2) {",
      "743:                     goto err;",
      "744:                 if (udp[0] == 1)",
      "745:                     break;",
      "746:             }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "40b8eb792d591d19751afc4d056c8e84260bdeb8",
      "candidate_info": {
        "commit_hash": "40b8eb792d591d19751afc4d056c8e84260bdeb8",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/40b8eb792d591d19751afc4d056c8e84260bdeb8",
        "files": [
          "crypto/bn/bn_gf2m.c"
        ],
        "message": "bn/bn_gf2m.c: avoid infinite loop wich malformed ECParamters.\n\nCVE-2015-1788\n\nReviewed-by: Matt Caswell <matt@openssl.org>\n(cherry picked from commit 4924b37ee01f71ae19c94a8934b80eeb2f677932)",
        "before_after_code_files": [
          "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c"
          ],
          "candidate": [
            "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c": [
          "File: crypto/bn/bn_gf2m.c -> crypto/bn/bn_gf2m.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "693:     }",
          "694: # else",
          "695:     {",
          "699:         BN_ULONG *udp, *bdp, *vdp, *cdp;",
          "701:         bn_wexpand(u, top);",
          "",
          "[Removed Lines]",
          "696:         int i, ubits = BN_num_bits(u), vbits = BN_num_bits(v), /* v is copy",
          "698:             top = p->top;",
          "",
          "[Added Lines]",
          "696:         int i;",
          "697:         int ubits = BN_num_bits(u);",
          "699:         int top = p->top;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "739:                 ubits--;",
          "740:             }",
          "745:             if (ubits < vbits) {",
          "746:                 i = ubits;",
          "",
          "[Removed Lines]",
          "742:             if (ubits <= BN_BITS2 && udp[0] == 1)",
          "743:                 break;",
          "",
          "[Added Lines]",
          "743:             if (ubits <= BN_BITS2) {",
          "745:                     goto err;",
          "746:                 if (udp[0] == 1)",
          "747:                     break;",
          "748:             }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f61bbf8da532038ed0eae16a9a11771f3da22d30",
      "candidate_info": {
        "commit_hash": "f61bbf8da532038ed0eae16a9a11771f3da22d30",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/f61bbf8da532038ed0eae16a9a11771f3da22d30",
        "files": [
          "crypto/bn/bn_gf2m.c"
        ],
        "message": "bn/bn_gf2m.c: avoid infinite loop wich malformed ECParamters.\n\nCVE-2015-1788\n\nReviewed-by: Matt Caswell <matt@openssl.org>\n(cherry picked from commit 4924b37ee01f71ae19c94a8934b80eeb2f677932)",
        "before_after_code_files": [
          "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c"
          ],
          "candidate": [
            "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/bn/bn_gf2m.c||crypto/bn/bn_gf2m.c": [
          "File: crypto/bn/bn_gf2m.c -> crypto/bn/bn_gf2m.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "694:     }",
          "695: # else",
          "696:     {",
          "700:         BN_ULONG *udp, *bdp, *vdp, *cdp;",
          "702:         bn_wexpand(u, top);",
          "",
          "[Removed Lines]",
          "697:         int i, ubits = BN_num_bits(u), vbits = BN_num_bits(v), /* v is copy",
          "699:             top = p->top;",
          "",
          "[Added Lines]",
          "697:         int i;",
          "698:         int ubits = BN_num_bits(u);",
          "700:         int top = p->top;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "740:                 ubits--;",
          "741:             }",
          "746:             if (ubits < vbits) {",
          "747:                 i = ubits;",
          "",
          "[Removed Lines]",
          "743:             if (ubits <= BN_BITS2 && udp[0] == 1)",
          "744:                 break;",
          "",
          "[Added Lines]",
          "744:             if (ubits <= BN_BITS2) {",
          "746:                     goto err;",
          "747:                 if (udp[0] == 1)",
          "748:                     break;",
          "749:             }",
          "",
          "---------------"
        ]
      }
    }
  ]
}