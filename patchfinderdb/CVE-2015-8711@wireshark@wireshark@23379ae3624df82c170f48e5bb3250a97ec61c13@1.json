{
  "cve_id": "CVE-2015-8711",
  "cve_desc": "epan/dissectors/packet-nbap.c in the NBAP dissector in Wireshark 1.12.x before 1.12.9 and 2.0.x before 2.0.1 does not validate conversation data, which allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted packet.",
  "repo": "wireshark/wireshark",
  "patch_hash": "23379ae3624df82c170f48e5bb3250a97ec61c13",
  "patch_info": {
    "commit_hash": "23379ae3624df82c170f48e5bb3250a97ec61c13",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/23379ae3624df82c170f48e5bb3250a97ec61c13",
    "files": [
      "asn1/nbap/nbap.cnf",
      "epan/dissectors/packet-nbap.c"
    ],
    "message": "NBAP : Verify conversation proto data exists before trying to access it\n\nBug 11841\nChange-Id: Ic0dea6491a68a042ddc0f2dbee19739e4568b18c\nReviewed-on: https://code.wireshark.org/review/12576\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nTested-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
    "before_after_code_files": [
      "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
      "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
    ]
  },
  "patch_diff": {
    "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
      "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
      "--- Hunk 1 ---",
      "[Context before]",
      "1410: address     dst_addr, null_addr;",
      "1411: conversation_t *conversation,*old_conversation = NULL;",
      "1412: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
      "1414: transportLayerAddress_ipv4 = 0;",
      "1415: BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1413: void *conv_proto_data = NULL;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1454:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
      "1455:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
      "1461:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
      "1462:                 umts_fp_conversation_info->division          = Division_FDD;",
      "",
      "[Removed Lines]",
      "1457:                 if (old_conversation)",
      "1458:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
      "",
      "[Added Lines]",
      "1458:                 if (old_conversation) {",
      "1459:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
      "1460:                     if (conv_proto_data)",
      "1461:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
      "1462:                 }",
      "",
      "---------------"
    ],
    "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
      "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "10028: static int",
      "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "10032:                                                             0U, 255U, &cfn, FALSE);",
      "",
      "[Removed Lines]",
      "10030: #line 2148 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "10030: #line 2151 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "10281: static int",
      "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
      "10285: address     null_addr;",
      "10286: conversation_t   *conversation = NULL;",
      "",
      "[Removed Lines]",
      "10283: #line 2113 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "10283: #line 2116 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "11503: static int",
      "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
      "",
      "[Removed Lines]",
      "11505: #line 1972 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "11505: #line 1975 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "11637: static int",
      "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
      "",
      "[Removed Lines]",
      "11639: #line 1626 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "11639: #line 1629 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "11655: static int",
      "11656: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11658:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11659:                                                             1U, 1504U, NULL, TRUE);",
      "",
      "[Removed Lines]",
      "11657: #line 1728 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "11657: #line 1731 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "12078: static int",
      "12079: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "12081:     address     dst_addr;",
      "12082:     transportLayerAddress_ipv4 = 0;",
      "12083:     BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "12080: #line 1979 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "12080: #line 1982 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "12123: static int",
      "12124: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "12126:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "12127:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
      "",
      "[Removed Lines]",
      "12125: #line 1616 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "12125: #line 1619 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "13344: static int",
      "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
      "",
      "[Removed Lines]",
      "13346: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "13346: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "18028: static int",
      "18029: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18032:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "18033:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
      "",
      "[Removed Lines]",
      "18030: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18030: #line 1608 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "18163: static int",
      "18164: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18166:     num_items++;",
      "",
      "[Removed Lines]",
      "18165: #line 1602 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18165: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "18180: static int",
      "18181: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18183:     num_items = 0;",
      "18185:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
      "",
      "[Removed Lines]",
      "18182: #line 1595 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18182: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "18396: static int",
      "18397: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18400:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
      "18401:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
      "",
      "[Removed Lines]",
      "18398: #line 1590 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18398: #line 1593 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "18471: static int",
      "18472: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18474: guint32 no_ddi_entries, i;",
      "18475: address     null_addr;",
      "18476: nbap_edch_port_info_t *old_info;",
      "",
      "[Removed Lines]",
      "18473: #line 1498 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18473: #line 1501 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "18617: address     dst_addr, null_addr;",
      "18618: conversation_t *conversation,*old_conversation = NULL;",
      "18619: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
      "18621: transportLayerAddress_ipv4 = 0;",
      "18622: BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "18620: void *conv_proto_data = NULL;",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "18663:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
      "18664:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
      "18670:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
      "18671:                 umts_fp_conversation_info->division          = Division_FDD;",
      "",
      "[Removed Lines]",
      "18666:                 if (old_conversation)",
      "18667:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
      "",
      "[Added Lines]",
      "18667:                 if (old_conversation) {",
      "18668:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
      "18669:                     if (conv_proto_data)",
      "18670:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
      "18671:                 }",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "23306: static int",
      "23307: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "23308: #line 1999 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23311: #line 2002 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "23467: static int",
      "23468: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23472:     address     dst_addr;",
      "",
      "[Removed Lines]",
      "23469: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23472: #line 1709 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "23570: static int",
      "23571: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23573:     guint32 rlc_mode;",
      "23575:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
      "",
      "[Removed Lines]",
      "23572: #line 1633 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23575: #line 1636 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "23611: static int",
      "23612: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23614:     num_items++;",
      "",
      "[Removed Lines]",
      "23613: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23616: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "23645: static int",
      "23646: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23649:     int protocol_ie_id;",
      "23650:     guint32 i;",
      "",
      "[Removed Lines]",
      "23647: #line 1657 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23650: #line 1660 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "23689: static int",
      "23690: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23692:     guint32 hsdsch_physical_layer_category;",
      "23694:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "",
      "[Removed Lines]",
      "23691: #line 1650 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23694: #line 1653 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "23757: static int",
      "23758: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "23759: #line 1758 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23762: #line 1761 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "23894: static int",
      "23895: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23897:     address     dst_addr;",
      "23898:     transportLayerAddress_ipv4 = 0;",
      "23899:     BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "23896: #line 1847 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23899: #line 1850 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "23952: static int",
      "23953: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23955:     num_items = 1;",
      "",
      "[Removed Lines]",
      "23954: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23957: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "24087: static int",
      "24088: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "24089: #line 1867 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24092: #line 1870 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "24209: static int",
      "24210: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "24211: #line 1735 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24214: #line 1738 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 27 ---",
      "[Context before]",
      "24320: static int",
      "24321: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24323:     num_items++;",
      "",
      "[Removed Lines]",
      "24322: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24325: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 28 ---",
      "[Context before]",
      "24736: static int",
      "24737: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24740:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
      "",
      "[Removed Lines]",
      "24738: #line 2077 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24741: #line 2080 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 29 ---",
      "[Context before]",
      "24930: static int",
      "24931: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24933:     num_items++;",
      "",
      "[Removed Lines]",
      "24932: #line 1694 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24935: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 30 ---",
      "[Context before]",
      "24947: static int",
      "24948: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24950:     num_items = 0;",
      "",
      "[Removed Lines]",
      "24949: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24952: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 31 ---",
      "[Context before]",
      "28049: static int",
      "28050: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "28053: nbap_com_context_id_t *cur_val;",
      "",
      "[Removed Lines]",
      "28051: #line 2091 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "28054: #line 2094 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 32 ---",
      "[Context before]",
      "41065: actx->pinfo->link_dir=P2P_DIR_DL;",
      "",
      "[Removed Lines]",
      "41068: #line 2140 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "41071: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ada1eec702ff44dc89670a1aa25c1e34d370bebb",
      "candidate_info": {
        "commit_hash": "ada1eec702ff44dc89670a1aa25c1e34d370bebb",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/ada1eec702ff44dc89670a1aa25c1e34d370bebb",
        "files": [
          "asn1/nbap/nbap.cnf",
          "asn1/nbap/packet-nbap-template.c",
          "epan/address.h",
          "epan/conversation.c",
          "epan/dissectors/packet-ceph.c",
          "epan/dissectors/packet-dmp.c",
          "epan/dissectors/packet-http.c",
          "epan/dissectors/packet-isakmp.c",
          "epan/dissectors/packet-jxta.c",
          "epan/dissectors/packet-l2tp.c",
          "epan/dissectors/packet-lbmc.c",
          "epan/dissectors/packet-lbmpdmtcp.c",
          "epan/dissectors/packet-lbmr.c",
          "epan/dissectors/packet-lbtrm.c",
          "epan/dissectors/packet-lbtru.c",
          "epan/dissectors/packet-lbttcp.c",
          "epan/dissectors/packet-nbap.c",
          "epan/dissectors/packet-netflow.c",
          "epan/dissectors/packet-p_mul.c",
          "epan/dissectors/packet-rsvp.c",
          "epan/dissectors/packet-sip.c",
          "epan/dissectors/packet-socks.c",
          "epan/dissectors/packet-ssl-utils.c",
          "epan/dissectors/packet-tn5250.c",
          "epan/dissectors/packet-umts_fp.c",
          "ui/gtk/wlan_stat_dlg.c"
        ],
        "message": "SE_COPY_ADDRESS -> WMEM_COPY_ADDRESS\n\nCopy addresses with wmem-scope instead of (forced) seasonal scope.  All existing instances were converted to wmem_file_scope, but the flexibility is there for other scopes.\n\nChange-Id: I8e58837b9ef574ec7dd87e278470d7063ae8c1c2\nReviewed-on: https://code.wireshark.org/review/6564\nReviewed-by: Michael Mann <mmann78@netscape.net>",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "asn1/nbap/packet-nbap-template.c||asn1/nbap/packet-nbap-template.c",
          "epan/address.h||epan/address.h",
          "epan/conversation.c||epan/conversation.c",
          "epan/dissectors/packet-ceph.c||epan/dissectors/packet-ceph.c",
          "epan/dissectors/packet-dmp.c||epan/dissectors/packet-dmp.c",
          "epan/dissectors/packet-http.c||epan/dissectors/packet-http.c",
          "epan/dissectors/packet-isakmp.c||epan/dissectors/packet-isakmp.c",
          "epan/dissectors/packet-jxta.c||epan/dissectors/packet-jxta.c",
          "epan/dissectors/packet-l2tp.c||epan/dissectors/packet-l2tp.c",
          "epan/dissectors/packet-lbmc.c||epan/dissectors/packet-lbmc.c",
          "epan/dissectors/packet-lbmpdmtcp.c||epan/dissectors/packet-lbmpdmtcp.c",
          "epan/dissectors/packet-lbmr.c||epan/dissectors/packet-lbmr.c",
          "epan/dissectors/packet-lbtrm.c||epan/dissectors/packet-lbtrm.c",
          "epan/dissectors/packet-lbtru.c||epan/dissectors/packet-lbtru.c",
          "epan/dissectors/packet-lbttcp.c||epan/dissectors/packet-lbttcp.c",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c",
          "epan/dissectors/packet-netflow.c||epan/dissectors/packet-netflow.c",
          "epan/dissectors/packet-p_mul.c||epan/dissectors/packet-p_mul.c",
          "epan/dissectors/packet-rsvp.c||epan/dissectors/packet-rsvp.c",
          "epan/dissectors/packet-sip.c||epan/dissectors/packet-sip.c",
          "epan/dissectors/packet-socks.c||epan/dissectors/packet-socks.c",
          "epan/dissectors/packet-ssl-utils.c||epan/dissectors/packet-ssl-utils.c",
          "epan/dissectors/packet-tn5250.c||epan/dissectors/packet-tn5250.c",
          "epan/dissectors/packet-umts_fp.c||epan/dissectors/packet-umts_fp.c",
          "ui/gtk/wlan_stat_dlg.c||ui/gtk/wlan_stat_dlg.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "764:                 umts_fp_conversation_info->channel           = CHANNEL_RACH_FDD;",
          "765:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "766:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "768:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "769:                 umts_fp_conversation_info->rlc_mode          = FP_RLC_MODE_UNKNOWN;",
          "",
          "[Removed Lines]",
          "767:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "767:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "857:                 umts_fp_conversation_info->channel            = CHANNEL_PCH;",
          "858:                 umts_fp_conversation_info->dl_frame_number    = 0;",
          "859:                 umts_fp_conversation_info->ul_frame_number    = actx->pinfo->fd->num;",
          "861:                 umts_fp_conversation_info->crnc_port          = BindingID_port;",
          "862:                 umts_fp_conversation_info->paging_indications = paging_indications;",
          "863:                 umts_fp_conversation_info->rlc_mode           = FP_RLC_MODE_UNKNOWN;",
          "",
          "[Removed Lines]",
          "860:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "860:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "966:                 umts_fp_conversation_info->channel           = CHANNEL_FACH_FDD;",
          "967:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "968:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "970:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "971:                 umts_fp_conversation_info->rlc_mode          = FP_RLC_MODE_UNKNOWN;",
          "",
          "[Removed Lines]",
          "969:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "969:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1173:                 umts_fp_conversation_info->channel           = CHANNEL_DCH;",
          "1174:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "1175:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "1177:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "1178:                 umts_fp_conversation_info->rlc_mode          = FP_RLC_MODE_UNKNOWN;",
          "",
          "[Removed Lines]",
          "1176:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "1176:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1286:                 umts_fp_conversation_info->channel           = CHANNEL_EDCH;",
          "1287:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "1288:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "1290:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "",
          "[Removed Lines]",
          "1289:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "1289:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1459:                 umts_fp_conversation_info->channel           = CHANNEL_EDCH;",
          "1460:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "1461:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "1463:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "",
          "[Removed Lines]",
          "1462:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "1462:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1807:                     umts_fp_conversation_info->channel           = CHANNEL_HSDSCH;",
          "1808:                     umts_fp_conversation_info->dl_frame_number   = 0;",
          "1809:                     umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "1811:                     umts_fp_conversation_info->crnc_port         = nbap_hsdsch_channel_info[i].crnc_port;",
          "",
          "[Removed Lines]",
          "1810:                     SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "[Added Lines]",
          "1810:                     WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1924:                     umts_fp_conversation_info->channel           = CHANNEL_HSDSCH;",
          "1925:                     umts_fp_conversation_info->dl_frame_number   = 0;",
          "1926:                     umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "1928:                     umts_fp_conversation_info->crnc_port         = nbap_hsdsch_channel_info[i].crnc_port;",
          "",
          "[Removed Lines]",
          "1927:                     SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "[Added Lines]",
          "1927:                     WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2048:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "2049:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "2051:                 umts_fp_conversation_info->crnc_port         = nbap_common_channel_info[i].crnc_port;",
          "",
          "[Removed Lines]",
          "2050:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &nbap_common_channel_info[i].crnc_address);",
          "",
          "[Added Lines]",
          "2050:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &nbap_common_channel_info[i].crnc_address);",
          "",
          "---------------"
        ],
        "asn1/nbap/packet-nbap-template.c||asn1/nbap/packet-nbap-template.c": [
          "File: asn1/nbap/packet-nbap-template.c -> asn1/nbap/packet-nbap-template.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "382:      umts_fp_conversation_info->channel           = CHANNEL_HSDSCH;",
          "383:      umts_fp_conversation_info->dl_frame_number   = 0;",
          "384:      umts_fp_conversation_info->ul_frame_number   = pinfo->fd->num;",
          "386:      umts_fp_conversation_info->crnc_port         = nbap_hsdsch_channel_info[i].crnc_port;",
          "",
          "[Removed Lines]",
          "385:      SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "[Added Lines]",
          "385:      WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "---------------"
        ],
        "epan/address.h||epan/address.h": [
          "File: epan/address.h -> epan/address.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "228: #define COPY_ADDRESS_SHALLOW(to, from) copy_address_shallow((to), (from))",
          "237:     do {                              \\",
          "239:         copy_address_shallow((to), (from)); \\",
          "243:     } while (0)",
          "",
          "[Removed Lines]",
          "236: #define SE_COPY_ADDRESS(to, from)     \\",
          "238:         void *SE_COPY_ADDRESS_data; \\",
          "240:         SE_COPY_ADDRESS_data = se_alloc((from)->len); \\",
          "241:         memcpy(SE_COPY_ADDRESS_data, (from)->data, (from)->len); \\",
          "242:         (to)->data = SE_COPY_ADDRESS_data; \\",
          "",
          "[Added Lines]",
          "236: #define WMEM_COPY_ADDRESS(scope, to, from)     \\",
          "238:         void *WMEM_COPY_ADDRESS_data; \\",
          "240:         WMEM_COPY_ADDRESS_data = wmem_alloc(scope, (from)->len); \\",
          "241:         memcpy(WMEM_COPY_ADDRESS_data, (from)->data, (from)->len); \\",
          "242:         (to)->data = WMEM_COPY_ADDRESS_data; \\",
          "",
          "---------------"
        ],
        "epan/conversation.c||epan/conversation.c": [
          "File: epan/conversation.c -> epan/conversation.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "698:  new_key = wmem_new(wmem_file_scope(), struct conversation_key);",
          "699:  new_key->next = conversation_keys;",
          "700:  conversation_keys = new_key;",
          "703:  new_key->ptype = ptype;",
          "704:  new_key->port1 = port1;",
          "705:  new_key->port2 = port2;",
          "",
          "[Removed Lines]",
          "701:  SE_COPY_ADDRESS(&new_key->addr1, addr1);",
          "702:  SE_COPY_ADDRESS(&new_key->addr2, addr2);",
          "",
          "[Added Lines]",
          "701:  WMEM_COPY_ADDRESS(wmem_file_scope(), &new_key->addr1, addr1);",
          "702:  WMEM_COPY_ADDRESS(wmem_file_scope(), &new_key->addr2, addr2);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "789:   conversation_remove_from_hashtable(conversation_hashtable_no_port2, conv);",
          "790:  }",
          "791:  conv->options &= ~NO_ADDR2;",
          "793:  if (conv->options & NO_PORT2) {",
          "794:   conversation_insert_into_hashtable(conversation_hashtable_no_port2, conv);",
          "795:  } else {",
          "",
          "[Removed Lines]",
          "792:  SE_COPY_ADDRESS(&conv->key_ptr->addr2, addr);",
          "",
          "[Added Lines]",
          "792:  WMEM_COPY_ADDRESS(wmem_file_scope(), &conv->key_ptr->addr2, addr);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-ceph.c||epan/dissectors/packet-ceph.c": [
          "File: epan/dissectors/packet-ceph.c -> epan/dissectors/packet-ceph.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1556:   d->convd->server.port = pinfo->srcport;",
          "1558:   d->convd->client.port = pinfo->destport;",
          "1559:   conversation_add_proto_data(d->conv, proto_ceph, d->convd);",
          "1560:  }",
          "",
          "[Removed Lines]",
          "1555:   SE_COPY_ADDRESS(&d->convd->server.addr, &pinfo->src);",
          "1557:   SE_COPY_ADDRESS(&d->convd->client.addr, &pinfo->dst);",
          "",
          "[Added Lines]",
          "1555:   WMEM_COPY_ADDRESS(wmem_file_scope(), &d->convd->server.addr, &pinfo->src);",
          "1557:   WMEM_COPY_ADDRESS(wmem_file_scope(), &d->convd->client.addr, &pinfo->dst);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-dmp.c||epan/dissectors/packet-dmp.c": [
          "File: epan/dissectors/packet-dmp.c -> epan/dissectors/packet-dmp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1400:   {",
          "1402:     dmp_key->id = (guint) dmp.subj_id;",
          "1406:     dmp_data = (dmp_id_val *) g_hash_table_lookup (dmp_id_hash_table, dmp_key);",
          "",
          "[Removed Lines]",
          "1403:     SE_COPY_ADDRESS(&dmp_key->src, &(pinfo->dst));",
          "1404:     SE_COPY_ADDRESS(&dmp_key->dst, &(pinfo->src));",
          "",
          "[Added Lines]",
          "1403:     WMEM_COPY_ADDRESS(wmem_file_scope(), &dmp_key->src, &(pinfo->dst));",
          "1404:     WMEM_COPY_ADDRESS(wmem_file_scope(), &dmp_key->dst, &(pinfo->src));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1419:   if (dmp.msg_type == ACK) {",
          "1420:     dmp_key->id = (guint) dmp.subj_id;",
          "1423:   } else {",
          "1424:     dmp_key->id = (guint) dmp.msg_id;",
          "1427:   }",
          "1429:   dmp_data = (dmp_id_val *) g_hash_table_lookup (dmp_id_hash_table, dmp_key);",
          "",
          "[Removed Lines]",
          "1421:     SE_COPY_ADDRESS(&dmp_key->src, &(pinfo->dst));",
          "1422:     SE_COPY_ADDRESS(&dmp_key->dst, &(pinfo->src));",
          "1425:     SE_COPY_ADDRESS(&dmp_key->src, &(pinfo->src));",
          "1426:     SE_COPY_ADDRESS(&dmp_key->dst, &(pinfo->dst));",
          "",
          "[Added Lines]",
          "1421:     WMEM_COPY_ADDRESS(wmem_file_scope(), &dmp_key->src, &(pinfo->dst));",
          "1422:     WMEM_COPY_ADDRESS(wmem_file_scope(), &dmp_key->dst, &(pinfo->src));",
          "1425:     WMEM_COPY_ADDRESS(wmem_file_scope(), &dmp_key->src, &(pinfo->src));",
          "1426:     WMEM_COPY_ADDRESS(wmem_file_scope(), &dmp_key->dst, &(pinfo->dst));",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-http.c||epan/dissectors/packet-http.c": [
          "File: epan/dissectors/packet-http.c -> epan/dissectors/packet-http.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1520:  if (http_type == HTTP_RESPONSE && pinfo->desegment_offset<=0 && pinfo->desegment_len<=0) {",
          "1521:   conv_data->upgrade = headers.upgrade;",
          "1522:   conv_data->startframe = pinfo->fd->num + 1;",
          "1524:   conv_data->server_port = pinfo->srcport;",
          "1525:  }",
          "",
          "[Removed Lines]",
          "1523:   SE_COPY_ADDRESS(&conv_data->server_addr, &pinfo->src);",
          "",
          "[Added Lines]",
          "1523:   WMEM_COPY_ADDRESS(wmem_file_scope(), &conv_data->server_addr, &pinfo->src);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-isakmp.c||epan/dissectors/packet-isakmp.c": [
          "File: epan/dissectors/packet-isakmp.c -> epan/dissectors/packet-isakmp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2816:     if (ADDRESSES_EQUAL(&decr->initiator, &null_addr)) {",
          "2820:     }",
          "2822:     decr_data = decr;",
          "",
          "[Removed Lines]",
          "2819:       SE_COPY_ADDRESS(&decr->initiator, &pinfo->src);",
          "",
          "[Added Lines]",
          "2819:       WMEM_COPY_ADDRESS(wmem_file_scope(), &decr->initiator, &pinfo->src);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-jxta.c||epan/dissectors/packet-jxta.c": [
          "File: epan/dissectors/packet-jxta.c -> epan/dissectors/packet-jxta.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "582:             tpt_conv_data->tpt_ptype = pinfo->ptype;",
          "583:             tpt_conv_data->initiator_welcome_frame = pinfo->fd->num;",
          "585:             tpt_conv_data->initiator_tpt_port = pinfo->srcport;",
          "587:             welcome_addr = &tpt_conv_data->initiator_address;",
          "",
          "[Removed Lines]",
          "584:             SE_COPY_ADDRESS(&tpt_conv_data->initiator_tpt_address, &pinfo->src);",
          "",
          "[Added Lines]",
          "584:             WMEM_COPY_ADDRESS(wmem_file_scope(), &tpt_conv_data->initiator_tpt_address, &pinfo->src);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "594:                 tpt_conv_data->receiver_tpt_port = tpt_conv_data->initiator_tpt_port;",
          "595:                 tpt_conv_data->receiver_address = tpt_conv_data->initiator_address;",
          "596:                 tpt_conv_data->initiator_welcome_frame = pinfo->fd->num;",
          "598:                 tpt_conv_data->initiator_tpt_port = pinfo->srcport;",
          "600:                 welcome_addr = &tpt_conv_data->initiator_address;",
          "",
          "[Removed Lines]",
          "597:                 SE_COPY_ADDRESS(&tpt_conv_data->initiator_tpt_address, &pinfo->src);",
          "",
          "[Added Lines]",
          "597:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &tpt_conv_data->initiator_tpt_address, &pinfo->src);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "604:                 tpt_conv_data->tpt_ptype = pinfo->ptype;",
          "605:                 tpt_conv_data->receiver_welcome_frame = pinfo->fd->num;",
          "607:                 tpt_conv_data->receiver_tpt_port = pinfo->srcport;",
          "609:                 welcome_addr = &tpt_conv_data->receiver_address;",
          "",
          "[Removed Lines]",
          "606:                 SE_COPY_ADDRESS(&tpt_conv_data->receiver_tpt_address, &pinfo->src);",
          "",
          "[Added Lines]",
          "606:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &tpt_conv_data->receiver_tpt_address, &pinfo->src);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "744:         tpt_conv_data = wmem_new(wmem_file_scope(), jxta_stream_conversation_data);",
          "745:         tpt_conv_data->tpt_ptype = pinfo->ptype;",
          "748:         tpt_conv_data->initiator_tpt_port = pinfo->srcport;",
          "749:         tpt_conv_data->initiator_welcome_frame = 0;",
          "750:         tpt_conv_data->initiator_address.type = AT_NONE;",
          "751:         tpt_conv_data->initiator_address.len = 0;",
          "752:         tpt_conv_data->initiator_address.data = NULL;",
          "755:         tpt_conv_data->receiver_tpt_port = pinfo->destport;",
          "756:         tpt_conv_data->receiver_welcome_frame = 0;",
          "757:         tpt_conv_data->receiver_address.type = AT_NONE;",
          "",
          "[Removed Lines]",
          "747:         SE_COPY_ADDRESS(&tpt_conv_data->initiator_tpt_address, &pinfo->src);",
          "754:         SE_COPY_ADDRESS(&tpt_conv_data->receiver_tpt_address, &pinfo->dst);",
          "",
          "[Added Lines]",
          "747:         WMEM_COPY_ADDRESS(wmem_file_scope(), &tpt_conv_data->initiator_tpt_address, &pinfo->src);",
          "754:         WMEM_COPY_ADDRESS(wmem_file_scope(), &tpt_conv_data->receiver_tpt_address, &pinfo->dst);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-l2tp.c||epan/dissectors/packet-l2tp.c": [
          "File: epan/dissectors/packet-l2tp.c -> epan/dissectors/packet-l2tp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2415:                 tunnel = &tmp_tunnel;",
          "2416:                 memset(tunnel, 0, sizeof(l2tpv3_tunnel_t));",
          "2417:                 tunnel->conv = l2tp_conv;",
          "2420:             }",
          "2421:         }",
          "2422:     }",
          "",
          "[Removed Lines]",
          "2418:                 SE_COPY_ADDRESS(&tunnel->lcce1, &pinfo->src);",
          "2419:                 SE_COPY_ADDRESS(&tunnel->lcce2, &pinfo->dst);",
          "",
          "[Added Lines]",
          "2418:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &tunnel->lcce1, &pinfo->src);",
          "2419:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &tunnel->lcce2, &pinfo->dst);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-lbmc.c||epan/dissectors/packet-lbmc.c": [
          "File: epan/dissectors/packet-lbmc.c -> epan/dissectors/packet-lbmc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "279:         return (entry);",
          "280:     }",
          "281:     entry = wmem_new(wmem_file_scope(), lbm_istream_substream_entry_t);",
          "283:     entry->src_port = src_port;",
          "285:     entry->dst_port = dst_port;",
          "286:     entry->lbm_stream_id = stream_id;",
          "287:     entry->parent = stream;",
          "",
          "[Removed Lines]",
          "282:     SE_COPY_ADDRESS(&(entry->src_addr), src_addr);",
          "284:     SE_COPY_ADDRESS(&(entry->dst_addr), dst_addr);",
          "",
          "[Added Lines]",
          "282:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->src_addr), src_addr);",
          "284:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->dst_addr), dst_addr);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "418:     }",
          "419:     entry = wmem_new(wmem_file_scope(), lbm_dstream_entry_t);",
          "420:     entry->domain_1 = endpoint_a->domain;",
          "422:     entry->port_1 = endpoint_a->port;",
          "423:     entry->domain_2 = endpoint_b->domain;",
          "425:     entry->port_2 = endpoint_b->port;",
          "426:     lbm_stream_order_dstream_key(entry);",
          "427:     entry->channel = lbm_channel_assign(LBM_CHANNEL_STREAM_TCP);",
          "",
          "[Removed Lines]",
          "421:     SE_COPY_ADDRESS(&(entry->addr_1), &(endpoint_a->addr));",
          "424:     SE_COPY_ADDRESS(&(entry->addr_2), &(endpoint_b->addr));",
          "",
          "[Added Lines]",
          "421:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->addr_1), &(endpoint_a->addr));",
          "424:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->addr_2), &(endpoint_b->addr));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "488:         return (entry);",
          "489:     }",
          "490:     entry = wmem_new(wmem_file_scope(), lbm_dstream_substream_entry_t);",
          "492:     entry->src_port = src_port;",
          "494:     entry->dst_port = dst_port;",
          "495:     entry->lbm_stream_id = stream_id;",
          "496:     entry->parent = stream;",
          "",
          "[Removed Lines]",
          "491:     SE_COPY_ADDRESS(&(entry->src_addr), src_addr);",
          "493:     SE_COPY_ADDRESS(&(entry->dst_addr), dst_addr);",
          "",
          "[Added Lines]",
          "491:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->src_addr), src_addr);",
          "493:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->dst_addr), dst_addr);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "6156:     }",
          "6157:     entry = wmem_new(wmem_file_scope(), lbmc_message_entry_t);",
          "6158:     entry->channel = channel;",
          "6160:     entry->port = port;",
          "6161:     entry->first_sqn = info->first_sqn;",
          "6162:     entry->fragment_count = 0;",
          "",
          "[Removed Lines]",
          "6159:     SE_COPY_ADDRESS(&(entry->addr), dest_address);",
          "",
          "[Added Lines]",
          "6159:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->addr), dest_address);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-lbmpdmtcp.c||epan/dissectors/packet-lbmpdmtcp.c": [
          "File: epan/dissectors/packet-lbmpdmtcp.c -> epan/dissectors/packet-lbmpdmtcp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:         return (entry);",
          "101:     }",
          "102:     entry = wmem_new(wmem_file_scope(), lbmtcp_transport_t);",
          "104:     entry->port1 = port1;",
          "106:     entry->port2 = port2;",
          "107:     lbmtcp_order_key(entry);",
          "108:     entry->channel = lbm_channel_assign(LBM_CHANNEL_TCP);",
          "",
          "[Removed Lines]",
          "103:     SE_COPY_ADDRESS(&(entry->addr1), address1);",
          "105:     SE_COPY_ADDRESS(&(entry->addr2), address2);",
          "",
          "[Added Lines]",
          "103:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->addr1), address1);",
          "105:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->addr2), address2);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-lbmr.c||epan/dissectors/packet-lbmr.c": [
          "File: epan/dissectors/packet-lbmr.c -> epan/dissectors/packet-lbmr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "264:         return (entry);",
          "265:     }",
          "266:     entry = wmem_new(wmem_file_scope(), lbtrdma_transport_t);",
          "268:     entry->session_id = session_id;",
          "269:     entry->port = port;",
          "270:     entry->channel = lbm_channel_assign(LBM_CHANNEL_TRANSPORT_LBTRDMA);",
          "",
          "[Removed Lines]",
          "267:     SE_COPY_ADDRESS(&(entry->source_address), source_address);",
          "",
          "[Added Lines]",
          "267:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->source_address), source_address);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-lbtrm.c||epan/dissectors/packet-lbtrm.c": [
          "File: epan/dissectors/packet-lbtrm.c -> epan/dissectors/packet-lbtrm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "156:         return (entry);",
          "157:     }",
          "158:     entry = wmem_new(wmem_file_scope(), lbtrm_transport_t);",
          "160:     entry->source_port = source_port;",
          "161:     entry->session_id = session_id;",
          "163:     entry->dest_port = dest_port;",
          "164:     entry->channel = lbm_channel_assign(LBM_CHANNEL_TRANSPORT_LBTRM);",
          "165:     entry->frame = wmem_tree_new(wmem_file_scope());",
          "",
          "[Removed Lines]",
          "159:     SE_COPY_ADDRESS(&(entry->source_address), source_address);",
          "162:     SE_COPY_ADDRESS(&(entry->multicast_group), multicast_group);",
          "",
          "[Added Lines]",
          "159:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->source_address), source_address);",
          "162:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->multicast_group), multicast_group);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-lbtru.c||epan/dissectors/packet-lbtru.c": [
          "File: epan/dissectors/packet-lbtru.c -> epan/dissectors/packet-lbtru.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "114:         return (entry);",
          "115:     }",
          "116:     entry = wmem_new(wmem_file_scope(), lbtru_transport_t);",
          "118:     entry->source_port = source_port;",
          "119:     entry->session_id = session_id;",
          "120:     entry->channel = lbm_channel_assign(LBM_CHANNEL_TRANSPORT_LBTRU);",
          "",
          "[Removed Lines]",
          "117:     SE_COPY_ADDRESS(&(entry->source_address), source_address);",
          "",
          "[Added Lines]",
          "117:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->source_address), source_address);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "163:         return (entry);",
          "164:     }",
          "165:     entry = wmem_new0(wmem_file_scope(), lbtru_client_transport_t);",
          "167:     entry->receiver_port = receiver_port;",
          "168:     entry->transport = transport;",
          "169:     entry->id = transport->next_client_id++;",
          "",
          "[Removed Lines]",
          "166:     SE_COPY_ADDRESS(&(entry->receiver_address), receiver_address);",
          "",
          "[Added Lines]",
          "166:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->receiver_address), receiver_address);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-lbttcp.c||epan/dissectors/packet-lbttcp.c": [
          "File: epan/dissectors/packet-lbttcp.c -> epan/dissectors/packet-lbttcp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:     lbttcp_transport_t * transport = NULL;",
          "78:     transport = wmem_new(wmem_file_scope(), lbttcp_transport_t);",
          "80:     transport->source_port = source_port;",
          "81:     transport->session_id = session_id;",
          "82:     transport->channel = lbm_channel_assign(LBM_CHANNEL_TRANSPORT_LBTTCP);",
          "",
          "[Removed Lines]",
          "79:     SE_COPY_ADDRESS(&(transport->source_address), source_address);",
          "",
          "[Added Lines]",
          "79:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(transport->source_address), source_address);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "154:         return (entry);",
          "155:     }",
          "156:     entry = wmem_new(wmem_file_scope(), lbttcp_client_transport_t);",
          "158:     entry->receiver_port = receiver_port;",
          "159:     entry->id = transport->next_client_id++;",
          "",
          "[Removed Lines]",
          "157:     SE_COPY_ADDRESS(&(entry->receiver_address), receiver_address);",
          "",
          "[Added Lines]",
          "157:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(entry->receiver_address), receiver_address);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10036: static int",
          "10037: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10039:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10040:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10038: #line 2144 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10038: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10289: static int",
          "10290: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10292: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10293: address     null_addr;",
          "10294: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10291: #line 2109 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10291: #line 2108 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11511: static int",
          "11512: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11515:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11516:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11513: #line 1968 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11513: #line 1967 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11645: static int",
          "11646: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11649:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11650:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11647: #line 1621 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11647: #line 1620 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11664: static int",
          "11665: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11667:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11668:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11666: #line 1724 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11666: #line 1723 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12087: static int",
          "12088: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12090:     address     dst_addr;",
          "12091:     transportLayerAddress_ipv4 = 0;",
          "12092:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12089: #line 1975 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12089: #line 1974 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12132: static int",
          "12133: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12135:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12136:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12134: #line 1612 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12134: #line 1611 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "13352: static int",
          "13353: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13355:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13356:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13354: #line 2083 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13354: #line 2082 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "18036: static int",
          "18037: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18040:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18041:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18038: #line 1602 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18038: #line 1601 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18170: static int",
          "18171: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18173:     num_items++;",
          "",
          "[Removed Lines]",
          "18172: #line 1599 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18172: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18187: static int",
          "18188: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18190:     num_items = 0;",
          "18192:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18189: #line 1592 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18189: #line 1591 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18220: static int",
          "18221: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18223: umts_fp_conversation_info_t *p_conv_data = NULL;",
          "18224: address     null_addr;",
          "18225: conversation_t   *p_conv;",
          "",
          "[Removed Lines]",
          "18222: #line 1354 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18222: #line 1353 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18403: static int",
          "18404: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18407:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18408:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18405: #line 1587 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18405: #line 1586 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18478: static int",
          "18479: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18481: guint32 no_ddi_entries, i;",
          "18482: address     null_addr;",
          "18483: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18480: #line 1495 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18480: #line 1494 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18620: static int",
          "18621: dissect_nbap_E_DCH_FDD_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18624: address     dst_addr, null_addr;",
          "18625: conversation_t *conversation,*old_conversation = NULL;",
          "",
          "[Removed Lines]",
          "18622: #line 1407 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18622: #line 1406 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "18678:                 umts_fp_conversation_info->channel           = CHANNEL_EDCH;",
          "18679:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "18680:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "18682:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "",
          "[Removed Lines]",
          "18681:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "18681:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23312: static int",
          "23313: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23314: #line 1995 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23314: #line 1994 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23371:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "23372:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "23374:                 umts_fp_conversation_info->crnc_port         = nbap_common_channel_info[i].crnc_port;",
          "",
          "[Removed Lines]",
          "23373:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &nbap_common_channel_info[i].crnc_address);",
          "",
          "[Added Lines]",
          "23373:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &nbap_common_channel_info[i].crnc_address);",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23473: static int",
          "23474: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23478:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23475: #line 1702 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23475: #line 1701 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23576: static int",
          "23577: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23579:     guint32 rlc_mode;",
          "23581:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23578: #line 1629 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23578: #line 1628 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23617: static int",
          "23618: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23620:     num_items++;",
          "",
          "[Removed Lines]",
          "23619: #line 1693 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23619: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23651: static int",
          "23652: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23655:     int protocol_ie_id;",
          "23656:     guint32 i;",
          "",
          "[Removed Lines]",
          "23653: #line 1653 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23653: #line 1652 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23695: static int",
          "23696: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23698:     guint32 hsdsch_physical_layer_category;",
          "23700:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23697: #line 1646 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23697: #line 1645 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23763: static int",
          "23764: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23765: #line 1754 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23765: #line 1753 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "23822:                     umts_fp_conversation_info->channel           = CHANNEL_HSDSCH;",
          "23823:                     umts_fp_conversation_info->dl_frame_number   = 0;",
          "23824:                     umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "23826:                     umts_fp_conversation_info->crnc_port         = nbap_hsdsch_channel_info[i].crnc_port;",
          "",
          "[Removed Lines]",
          "23825:                     SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "[Added Lines]",
          "23825:                     WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "23900: static int",
          "23901: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23903:     address     dst_addr;",
          "23904:     transportLayerAddress_ipv4 = 0;",
          "23905:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23902: #line 1843 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23902: #line 1842 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "23958: static int",
          "23959: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23961:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23960: #line 1696 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23960: #line 1695 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24093: static int",
          "24094: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24095: #line 1863 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24095: #line 1862 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24160:                     umts_fp_conversation_info->channel           = CHANNEL_HSDSCH;",
          "24161:                     umts_fp_conversation_info->dl_frame_number   = 0;",
          "24162:                     umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "24164:                     umts_fp_conversation_info->crnc_port         = nbap_hsdsch_channel_info[i].crnc_port;",
          "",
          "[Removed Lines]",
          "24163:                     SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "[Added Lines]",
          "24163:                     WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24215: static int",
          "24216: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24217: #line 1731 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24217: #line 1730 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "24326: static int",
          "24327: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24329:     num_items++;",
          "",
          "[Removed Lines]",
          "24328: #line 1699 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24328: #line 1698 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "24742: static int",
          "24743: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24746:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24744: #line 2073 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24744: #line 2072 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "24936: static int",
          "24937: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24939:     num_items++;",
          "",
          "[Removed Lines]",
          "24938: #line 1690 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24938: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "24953: static int",
          "24954: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24956:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24955: #line 1685 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24955: #line 1684 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "28055: static int",
          "28056: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28059: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28057: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28057: #line 2086 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "28690:                 umts_fp_conversation_info->channel           = CHANNEL_DCH;",
          "28691:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "28692:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "28694:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "28695:                 umts_fp_conversation_info->rlc_mode          = FP_RLC_MODE_UNKNOWN;",
          "",
          "[Removed Lines]",
          "28693:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "28693:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "28833:                 umts_fp_conversation_info->channel           = CHANNEL_EDCH;",
          "28834:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "28835:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "28837:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "",
          "[Removed Lines]",
          "28836:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "28836:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "32393:                 umts_fp_conversation_info->channel           = CHANNEL_FACH_FDD;",
          "32394:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "32395:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "32397:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "32398:                 umts_fp_conversation_info->rlc_mode          = FP_RLC_MODE_UNKNOWN;",
          "",
          "[Removed Lines]",
          "32396:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "32396:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "32558:                 umts_fp_conversation_info->channel            = CHANNEL_PCH;",
          "32559:                 umts_fp_conversation_info->dl_frame_number    = 0;",
          "32560:                 umts_fp_conversation_info->ul_frame_number    = actx->pinfo->fd->num;",
          "32562:                 umts_fp_conversation_info->crnc_port          = BindingID_port;",
          "32563:                 umts_fp_conversation_info->paging_indications = paging_indications;",
          "32564:                 umts_fp_conversation_info->rlc_mode           = FP_RLC_MODE_UNKNOWN;",
          "",
          "[Removed Lines]",
          "32561:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "32561:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "32701:                 umts_fp_conversation_info->channel           = CHANNEL_RACH_FDD;",
          "32702:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "32703:                 umts_fp_conversation_info->ul_frame_number   = actx->pinfo->fd->num;",
          "32705:                 umts_fp_conversation_info->crnc_port         = BindingID_port;",
          "32706:                 umts_fp_conversation_info->rlc_mode          = FP_RLC_MODE_UNKNOWN;",
          "",
          "[Removed Lines]",
          "32704:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "[Added Lines]",
          "32704:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &dst_addr);",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "41068: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41071: #line 2136 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41071: #line 2135 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "55233:      umts_fp_conversation_info->channel           = CHANNEL_HSDSCH;",
          "55234:      umts_fp_conversation_info->dl_frame_number   = 0;",
          "55235:      umts_fp_conversation_info->ul_frame_number   = pinfo->fd->num;",
          "55237:      umts_fp_conversation_info->crnc_port         = nbap_hsdsch_channel_info[i].crnc_port;",
          "",
          "[Removed Lines]",
          "55236:      SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "[Added Lines]",
          "55236:      WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &nbap_hsdsch_channel_info[i].crnc_address);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-netflow.c||epan/dissectors/packet-netflow.c": [
          "File: epan/dissectors/packet-netflow.c -> epan/dissectors/packet-netflow.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6350:         if ((tmplt_p == NULL) && (tmplt.fields_p[TF_SCOPES] || tmplt.fields_p[TF_ENTRIES])) {",
          "6352:             tmplt_p = (v9_v10_tmplt_t *)wmem_memdup(wmem_file_scope(), &tmplt, sizeof(tmplt));",
          "6356:             tmplt_p->template_frame_number = pinfo->fd->num;",
          "",
          "[Removed Lines]",
          "6353:             SE_COPY_ADDRESS(&tmplt_p->src_addr, &pinfo->net_src);",
          "6354:             SE_COPY_ADDRESS(&tmplt_p->dst_addr, &pinfo->net_dst);",
          "",
          "[Added Lines]",
          "6353:             WMEM_COPY_ADDRESS(wmem_file_scope(), &tmplt_p->src_addr, &pinfo->net_src);",
          "6354:             WMEM_COPY_ADDRESS(wmem_file_scope(), &tmplt_p->dst_addr, &pinfo->net_dst);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "6452:             tmplt_p = (v9_v10_tmplt_t *)wmem_memdup(wmem_file_scope(), &tmplt, sizeof(tmplt));",
          "6456:             tmplt_p->template_frame_number = pinfo->fd->num;",
          "6457:             g_hash_table_insert(v9_v10_tmplt_table, tmplt_p, tmplt_p);",
          "",
          "[Removed Lines]",
          "6453:             SE_COPY_ADDRESS(&tmplt_p->src_addr, &pinfo->net_src);",
          "6454:             SE_COPY_ADDRESS(&tmplt_p->dst_addr, &pinfo->net_dst);",
          "",
          "[Added Lines]",
          "6453:             WMEM_COPY_ADDRESS(wmem_file_scope(), &tmplt_p->src_addr, &pinfo->net_src);",
          "6454:             WMEM_COPY_ADDRESS(wmem_file_scope(), &tmplt_p->dst_addr, &pinfo->net_dst);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-p_mul.c||epan/dissectors/packet-p_mul.c": [
          "File: epan/dissectors/packet-p_mul.c -> epan/dissectors/packet-p_mul.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "332:   p_mul_key->id = message_id;",
          "333:   p_mul_key->seq = seq_no;",
          "336:   pkg_data = (p_mul_seq_val *) g_hash_table_lookup (p_mul_id_hash_table, p_mul_key);",
          "",
          "[Removed Lines]",
          "334:   SE_COPY_ADDRESS(&p_mul_key->addr, addr);",
          "",
          "[Added Lines]",
          "334:   WMEM_COPY_ADDRESS(wmem_file_scope(), &p_mul_key->addr, addr);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "392:     p_mul_key->id = message_id;",
          "393:     p_mul_key->seq = 0;",
          "395:     need_set_address = TRUE;",
          "397:     p_mul_data = (p_mul_seq_val *) g_hash_table_lookup (p_mul_id_hash_table, p_mul_key);",
          "",
          "[Removed Lines]",
          "394:     SE_COPY_ADDRESS(&p_mul_key->addr, addr);",
          "",
          "[Added Lines]",
          "394:     WMEM_COPY_ADDRESS(wmem_file_scope(), &p_mul_key->addr, addr);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "445:     p_mul_key->id = message_id;",
          "446:     p_mul_key->seq = seq_no;",
          "447:     if (!need_set_address) {",
          "449:     }",
          "450:     p_mul_data = (p_mul_seq_val *) g_hash_table_lookup (p_mul_id_hash_table, p_mul_key);",
          "",
          "[Removed Lines]",
          "448:       SE_COPY_ADDRESS(&p_mul_key->addr, addr);",
          "",
          "[Added Lines]",
          "448:       WMEM_COPY_ADDRESS(wmem_file_scope(), &p_mul_key->addr, addr);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-rsvp.c||epan/dissectors/packet-rsvp.c": [
          "File: epan/dissectors/packet-rsvp.c -> epan/dissectors/packet-rsvp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "7593:         break;",
          "7594:     }",
          "7597:     request_key.source_info.udp_source_port = rsvph->udp_source_port;",
          "",
          "[Removed Lines]",
          "7596:     SE_COPY_ADDRESS(&request_key.source_info.source, &rsvph->source);",
          "",
          "[Added Lines]",
          "7596:     WMEM_COPY_ADDRESS(wmem_file_scope(), &request_key.source_info.source, &rsvph->source);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-sip.c||epan/dissectors/packet-sip.c": [
          "File: epan/dissectors/packet-sip.c -> epan/dissectors/packet-sip.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4281:         g_snprintf(p_key->call_id, MAX_CALL_ID_SIZE, \"%s\", call_id);",
          "4284:         p_key->dest_port = pinfo->destport;",
          "4285:         if (sip_retrans_the_same_sport) {",
          "4286:             p_key->source_port = pinfo->srcport;",
          "",
          "[Removed Lines]",
          "4282:         SE_COPY_ADDRESS(&(p_key->dest_address), &pinfo->net_dst);",
          "4283:         SE_COPY_ADDRESS(&(p_key->source_address), &pinfo->net_src);",
          "",
          "[Added Lines]",
          "4282:         WMEM_COPY_ADDRESS(wmem_file_scope(), &(p_key->dest_address), &pinfo->net_dst);",
          "4283:         WMEM_COPY_ADDRESS(wmem_file_scope(), &(p_key->source_address), &pinfo->net_src);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-socks.c||epan/dissectors/packet-socks.c": [
          "File: epan/dissectors/packet-socks.c -> epan/dissectors/packet-socks.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "297:         if ( hash_info) {",
          "298:             TVB_SET_ADDRESS(&addr, AT_IPv4, tvb, offset, 4);",
          "300:         }",
          "301:         offset += 4;",
          "302:         break;",
          "",
          "[Removed Lines]",
          "299:             SE_COPY_ADDRESS(&hash_info->dst_addr, &addr);",
          "",
          "[Added Lines]",
          "299:             WMEM_COPY_ADDRESS(wmem_file_scope(), &hash_info->dst_addr, &addr);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "305:         if ( hash_info) {",
          "306:             TVB_SET_ADDRESS(&addr, AT_IPv6, tvb, offset, 16);",
          "308:         }",
          "309:         offset += 16;",
          "310:         break;",
          "",
          "[Removed Lines]",
          "307:             SE_COPY_ADDRESS(&hash_info->dst_addr, &addr);",
          "",
          "[Added Lines]",
          "307:             WMEM_COPY_ADDRESS(wmem_file_scope(), &hash_info->dst_addr, &addr);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "701:         TVB_SET_ADDRESS(&addr, AT_IPv4, tvb, offset, 4);",
          "704:         hash_info->clientState = clientDone;",
          "705:     }",
          "",
          "[Removed Lines]",
          "702:         SE_COPY_ADDRESS(&hash_info->dst_addr, &addr);",
          "",
          "[Added Lines]",
          "702:         WMEM_COPY_ADDRESS(wmem_file_scope(), &hash_info->dst_addr, &addr);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-ssl-utils.c||epan/dissectors/packet-ssl-utils.c": [
          "File: epan/dissectors/packet-ssl-utils.c -> epan/dissectors/packet-ssl-utils.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3989: void",
          "3990: ssl_set_server(SslDecryptSession* ssl, address *addr, port_type ptype, guint32 port)",
          "3991: {",
          "3993:     ssl->srv_ptype = ptype;",
          "3994:     ssl->srv_port = port;",
          "3995: }",
          "",
          "[Removed Lines]",
          "3992:     SE_COPY_ADDRESS(&ssl->srv_addr, addr);",
          "",
          "[Added Lines]",
          "3992:     WMEM_COPY_ADDRESS(wmem_file_scope(), &ssl->srv_addr, addr);",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-tn5250.c||epan/dissectors/packet-tn5250.c": [
          "File: epan/dissectors/packet-tn5250.c -> epan/dissectors/packet-tn5250.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5182:     tn5250_info = wmem_new(wmem_file_scope(), tn5250_conv_info_t);",
          "5184:     tn5250_info->outbound_port = pinfo->destport;",
          "5186:     tn5250_info->inbound_port = pinfo->srcport;",
          "5187:     conversation_add_proto_data(conversation, proto_tn5250, tn5250_info);",
          "5188:     tn5250_info->next = tn5250_info_items;",
          "",
          "[Removed Lines]",
          "5183:     SE_COPY_ADDRESS(&(tn5250_info->outbound_addr),&(pinfo->dst));",
          "5185:     SE_COPY_ADDRESS(&(tn5250_info->inbound_addr),&(pinfo->src));",
          "",
          "[Added Lines]",
          "5183:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(tn5250_info->outbound_addr),&(pinfo->dst));",
          "5185:     WMEM_COPY_ADDRESS(wmem_file_scope(), &(tn5250_info->inbound_addr),&(pinfo->src));",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-umts_fp.c||epan/dissectors/packet-umts_fp.c": [
          "File: epan/dissectors/packet-umts_fp.c -> epan/dissectors/packet-umts_fp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4531:                 umts_fp_conversation_info->channel           = uat_umts_fp_ep_and_ch_records[i].channel_type;",
          "4532:                 umts_fp_conversation_info->dl_frame_number   = 0;",
          "4533:                 umts_fp_conversation_info->ul_frame_number   = 1;",
          "4535:                 umts_fp_conversation_info->crnc_port         = uat_umts_fp_ep_and_ch_records[i].src_port;",
          "4536:                 umts_fp_conversation_info->rlc_mode          = (enum fp_rlc_mode) uat_umts_fp_ep_and_ch_records[i].rlc_mode;",
          "",
          "[Removed Lines]",
          "4534:                 SE_COPY_ADDRESS(&(umts_fp_conversation_info->crnc_address), &src_addr);",
          "",
          "[Added Lines]",
          "4534:                 WMEM_COPY_ADDRESS(wmem_file_scope(), &(umts_fp_conversation_info->crnc_address), &src_addr);",
          "",
          "---------------"
        ],
        "ui/gtk/wlan_stat_dlg.c||ui/gtk/wlan_stat_dlg.c": [
          "File: ui/gtk/wlan_stat_dlg.c -> ui/gtk/wlan_stat_dlg.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "147:     while (details) {",
          "148:         tmp = details;",
          "149:         details = details->next;",
          "150:         g_free (tmp);",
          "151:     }",
          "152: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "150:         g_free ((void*)tmp->addr.data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "206:         tmp  = list;",
          "207:         dealloc_wlan_details_ep(tmp->details);",
          "208:         list = tmp->next;",
          "209:         g_free(tmp);",
          "210:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "210:         g_free((void*)tmp->bssid.data);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "240:     ep = (wlan_ep_t *)g_malloc (sizeof(wlan_ep_t));",
          "243:     ep->stats.channel      = si->stats.channel;",
          "244:     memcpy (ep->stats.ssid, si->stats.ssid, MAX_SSID_LEN);",
          "245:     ep->stats.ssid_len     = si->stats.ssid_len;",
          "",
          "[Removed Lines]",
          "242:     SE_COPY_ADDRESS (&ep->bssid, &si->bssid);",
          "",
          "[Added Lines]",
          "244:     COPY_ADDRESS (&ep->bssid, &si->bssid);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "266:     if (!(d_ep = (wlan_details_ep_t *)g_malloc (sizeof(wlan_details_ep_t))))",
          "267:         return NULL;",
          "270:     d_ep->probe_req         = 0;",
          "271:     d_ep->probe_rsp         = 0;",
          "272:     d_ep->auth              = 0;",
          "",
          "[Removed Lines]",
          "269:     SE_COPY_ADDRESS (&d_ep->addr, addr);",
          "",
          "[Added Lines]",
          "271:     COPY_ADDRESS (&d_ep->addr, addr);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "454:                     if (tmp->iter_valid) {",
          "455:                         gtk_list_store_remove(store, &tmp->iter);",
          "456:                     }",
          "458:                     break;",
          "459:                 }",
          "460:                 prev = tmp;",
          "",
          "[Removed Lines]",
          "457:                     g_free (tmp);",
          "",
          "[Added Lines]",
          "459:                     g_free((void*)tmp->bssid.data);",
          "460:                     g_free(tmp);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d2644aef369af0667220b5bd69996915b29d753d",
      "candidate_info": {
        "commit_hash": "d2644aef369af0667220b5bd69996915b29d753d",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/d2644aef369af0667220b5bd69996915b29d753d",
        "files": [
          "asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "[NBAP] Fix SIGSEGV in dissect_nbap_MACdPDU_Size\n\nBug: 11815\nChange-Id: I107cf90df87bdafa23bd4b81acbc25d98773b223\nReviewed-on: https://code.wireshark.org/review/12347\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nReviewed-by: Anders Broman <a.broman58@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1609:     {",
          "1610:         return offset;",
          "1611:     }",
          "1614: #.FN_BODY MACdPDU-Size VAL_PTR = &MACdPDU_Size",
          "1615: %(DEFAULT_BODY)s",
          "",
          "[Removed Lines]",
          "1612:     nbap_edch_channel_info[e_dch_macdflow_id].edch_ddi[num_items-1] = e_dch_ddi_value;",
          "",
          "[Added Lines]",
          "1612:     if(num_items>0)",
          "1613:         nbap_edch_channel_info[e_dch_macdflow_id].edch_ddi[num_items-1] = e_dch_ddi_value;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1618:     {",
          "1619:         return offset;",
          "1620:     }",
          "1623: #.FN_BODY LogicalChannelID VAL_PTR = &logical_channel_id",
          "1625: %(DEFAULT_BODY)s",
          "1631: #.FN_BODY RLC-Mode VAL_PTR = &rlc_mode",
          "1632:     guint32 rlc_mode;",
          "",
          "[Removed Lines]",
          "1621:     nbap_edch_channel_info[e_dch_macdflow_id].edch_macd_pdu_size[num_items-1] = MACdPDU_Size;",
          "1628:     nbap_edch_channel_info[e_dch_macdflow_id].lchId[num_items-1] = logical_channel_id;",
          "",
          "[Added Lines]",
          "1622:     if(num_items>0)",
          "1623:         nbap_edch_channel_info[e_dch_macdflow_id].edch_macd_pdu_size[num_items-1] = MACdPDU_Size;",
          "1629:     if(num_items>0)",
          "1630:         nbap_edch_channel_info[e_dch_macdflow_id].lchId[num_items-1] = logical_channel_id;",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10028: static int",
          "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10032:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10030: #line 2147 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10030: #line 2148 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10281: static int",
          "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10285: address     null_addr;",
          "10286: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10283: #line 2112 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10283: #line 2113 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11503: static int",
          "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11505: #line 1971 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11505: #line 1972 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11637: static int",
          "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11639: #line 1624 \"../../asn1/nbap/nbap.cnf\"",
          "11646:     nbap_edch_channel_info[e_dch_macdflow_id].lchId[num_items-1] = logical_channel_id;",
          "",
          "[Added Lines]",
          "11639: #line 1626 \"../../asn1/nbap/nbap.cnf\"",
          "11645:     if(num_items>0)",
          "11646:         nbap_edch_channel_info[e_dch_macdflow_id].lchId[num_items-1] = logical_channel_id;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11656: static int",
          "11657: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11659:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11660:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11658: #line 1727 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11657: #line 1728 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12079: static int",
          "12080: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12082:     address     dst_addr;",
          "12083:     transportLayerAddress_ipv4 = 0;",
          "12084:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12081: #line 1978 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12080: #line 1979 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12124: static int",
          "12125: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12127:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12128:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12126: #line 1615 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12125: #line 1616 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "12132:     {",
          "12133:         return offset;",
          "12134:     }",
          "",
          "[Removed Lines]",
          "12135:     nbap_edch_channel_info[e_dch_macdflow_id].edch_macd_pdu_size[num_items-1] = MACdPDU_Size;",
          "",
          "[Added Lines]",
          "12134:     if(num_items>0)",
          "12135:         nbap_edch_channel_info[e_dch_macdflow_id].edch_macd_pdu_size[num_items-1] = MACdPDU_Size;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "13344: static int",
          "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13346: #line 2086 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13346: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18037:     {",
          "18038:         return offset;",
          "18039:     }",
          "",
          "[Removed Lines]",
          "18040:     nbap_edch_channel_info[e_dch_macdflow_id].edch_ddi[num_items-1] = e_dch_ddi_value;",
          "",
          "[Added Lines]",
          "18040:     if(num_items>0)",
          "18041:         nbap_edch_channel_info[e_dch_macdflow_id].edch_ddi[num_items-1] = e_dch_ddi_value;",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "23305: static int",
          "23306: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23307: #line 1998 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23308: #line 1999 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "23466: static int",
          "23467: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23471:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23468: #line 1705 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23469: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "23569: static int",
          "23570: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23572:     guint32 rlc_mode;",
          "23574:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23571: #line 1632 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23572: #line 1633 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "23610: static int",
          "23611: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23613:     num_items++;",
          "",
          "[Removed Lines]",
          "23612: #line 1696 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23613: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "23644: static int",
          "23645: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23648:     int protocol_ie_id;",
          "23649:     guint32 i;",
          "",
          "[Removed Lines]",
          "23646: #line 1656 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23647: #line 1657 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "23688: static int",
          "23689: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23691:     guint32 hsdsch_physical_layer_category;",
          "23693:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23690: #line 1649 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23691: #line 1650 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23756: static int",
          "23757: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23758: #line 1757 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23759: #line 1758 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23893: static int",
          "23894: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23896:     address     dst_addr;",
          "23897:     transportLayerAddress_ipv4 = 0;",
          "23898:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23895: #line 1846 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23896: #line 1847 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23951: static int",
          "23952: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23954:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23953: #line 1699 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23954: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "24086: static int",
          "24087: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24088: #line 1866 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24089: #line 1867 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "24208: static int",
          "24209: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24210: #line 1734 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24211: #line 1735 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "24319: static int",
          "24320: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24322:     num_items++;",
          "",
          "[Removed Lines]",
          "24321: #line 1702 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24322: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "24735: static int",
          "24736: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24739:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24737: #line 2076 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24738: #line 2077 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "24929: static int",
          "24930: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24932:     num_items++;",
          "",
          "[Removed Lines]",
          "24931: #line 1693 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24932: #line 1694 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "24946: static int",
          "24947: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24949:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24948: #line 1688 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24949: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "28048: static int",
          "28049: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28052: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28050: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28051: #line 2091 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "41064: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41067: #line 2139 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41068: #line 2140 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9c9fd67d8b8476176046838c3f36e7defcbaff33",
      "candidate_info": {
        "commit_hash": "9c9fd67d8b8476176046838c3f36e7defcbaff33",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/9c9fd67d8b8476176046838c3f36e7defcbaff33",
        "files": [
          "epan/dissectors/asn1/nbap/nbap.cnf",
          "epan/dissectors/asn1/nbap/packet-nbap-template.c",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "packet-nbap.c: Convert some g_ APIs to wmem.\n\nChange-Id: I480dd5c533b53cc90e483f42e974c5f3e660e305\nReviewed-on: https://code.wireshark.org/review/16548\nReviewed-by: Anders Broman <a.broman58@gmail.com>",
        "before_after_code_files": [
          "epan/dissectors/asn1/nbap/nbap.cnf||epan/dissectors/asn1/nbap/nbap.cnf",
          "epan/dissectors/asn1/nbap/packet-nbap-template.c||epan/dissectors/asn1/nbap/packet-nbap-template.c",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/asn1/nbap/nbap.cnf||epan/dissectors/asn1/nbap/nbap.cnf": [
          "File: epan/dissectors/asn1/nbap/nbap.cnf -> epan/dissectors/asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1300:                     umts_fp_conversation_info->com_context_id = com_context_id;",
          "1301:                 }else{",
          "1302:                     nbap_com_context_id_t *cur_val;",
          "1304:                         umts_fp_conversation_info->com_context_id = cur_val->crnc_context;",
          "1305:                     }else{",
          "1306:                         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_set_comm_context_id);",
          "",
          "[Removed Lines]",
          "1303:                     if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "1303:                     if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1313:                     nbap_edch_port_info_t * nbap_edch_port_info;",
          "1318:                     nbap_edch_port_info->crnc_port[e_dch_macdflow_id] = BindingID_port;",
          "",
          "[Removed Lines]",
          "1312:                 if( (old_info = (nbap_edch_port_info_t *)g_tree_lookup(edch_flow_port_map, GINT_TO_POINTER((gint)com_context_id))) == NULL ){",
          "1315:                     nbap_edch_port_info = (nbap_edch_port_info_t *)g_malloc0(sizeof(nbap_edch_port_info_t));",
          "",
          "[Added Lines]",
          "1312:                 if( (old_info = (nbap_edch_port_info_t *)wmem_tree_lookup32(edch_flow_port_map, com_context_id)) == NULL ){",
          "1315:                     nbap_edch_port_info = wmem_new0(wmem_file_scope(), nbap_edch_port_info_t);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1322:                     nbap_debug(\"Frame %%u RL-Specific-E-DCH-Information-Item Start\",",
          "1323:                         actx->pinfo->num);",
          "1326:                         umts_fp_conversation_info->com_context_id,",
          "1327:                         e_dch_macdflow_id,",
          "1328:                         address_to_str(wmem_packet_scope(), &dst_addr),",
          "1329:                         BindingID_port);",
          "1332:                 }else{",
          "1334:                     nbap_debug(\"    Insert in existing edch_flow_port_map com_context_id %%u e_dch_macdflow_id %%u IP %%s Port %%u\",",
          "",
          "[Removed Lines]",
          "1325:                     nbap_debug(\"    g_tree_insert(edch_flow_port_map) com_context_id %%u e_dch_macdflow_id %%u IP %%s Port %%u\",",
          "1331:                     g_tree_insert(edch_flow_port_map, GINT_TO_POINTER((gint)umts_fp_conversation_info->com_context_id), nbap_edch_port_info);",
          "",
          "[Added Lines]",
          "1325:                     nbap_debug(\"    wmem_tree_insert32(edch_flow_port_map) com_context_id %%u e_dch_macdflow_id %%u IP %%s Port %%u\",",
          "1331:                     wmem_tree_insert32(edch_flow_port_map, umts_fp_conversation_info->com_context_id, nbap_edch_port_info);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1477:                     umts_fp_conversation_info->com_context_id = com_context_id;",
          "1478:                 }else{",
          "1479:                     nbap_com_context_id_t * cur_val;",
          "1481:                         umts_fp_conversation_info->com_context_id = cur_val->crnc_context;",
          "1482:                     }else{",
          "1483:                         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_set_comm_context_id);",
          "",
          "[Removed Lines]",
          "1480:                     if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "1481:                     if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1522:     }else{",
          "1523:         nbap_com_context_id_t * cur_val;",
          "1525:             com_context_id= cur_val->crnc_context;",
          "1526:         }else{",
          "1527:             expert_add_info(actx->pinfo, NULL, &ei_nbap_no_find_comm_context_id);",
          "",
          "[Removed Lines]",
          "1524:         if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "1525:         if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1529:     }",
          "1533:         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_find_port_info);",
          "1534:         return offset;",
          "1535:     }",
          "",
          "[Removed Lines]",
          "1532:     if(( old_info = (nbap_edch_port_info_t *)g_tree_lookup(edch_flow_port_map, GINT_TO_POINTER((gint)com_context_id))) == NULL ){",
          "",
          "[Added Lines]",
          "1533:     if(( old_info = (nbap_edch_port_info_t *)wmem_tree_lookup32(edch_flow_port_map, com_context_id)) == NULL ){",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2104: if(crcn_context_present){",
          "2108:             cur_val->crnc_context = com_context_id;",
          "2109:             cur_val->frame_num = actx->pinfo->num;",
          "2111:             com_context_id = -1;",
          "2112:         }",
          "2113:     }",
          "",
          "[Removed Lines]",
          "2105:         if( (nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id)) == NULL ){",
          "2107:             cur_val = g_new(nbap_com_context_id_t,1);",
          "2110:             g_tree_insert(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id), cur_val);",
          "",
          "[Added Lines]",
          "2106:         if( wmem_tree_lookup32(com_context_map, node_b_com_context_id) == NULL ){",
          "2108:             cur_val = wmem_new(wmem_file_scope(), nbap_com_context_id_t);",
          "2111:             wmem_tree_insert32(com_context_map, node_b_com_context_id, cur_val);",
          "",
          "---------------"
        ],
        "epan/dissectors/asn1/nbap/packet-nbap-template.c||epan/dissectors/asn1/nbap/packet-nbap-template.c": [
          "File: epan/dissectors/asn1/nbap/packet-nbap-template.c -> epan/dissectors/asn1/nbap/packet-nbap-template.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "184: guint node_b_com_context_id;",
          "189: typedef struct com_ctxt_{",
          "",
          "[Removed Lines]",
          "186: static GTree * edch_flow_port_map = NULL;",
          "",
          "[Added Lines]",
          "186: static wmem_tree_t* edch_flow_port_map = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "193: }nbap_com_context_id_t;",
          "195: gboolean crcn_context_present = FALSE;",
          "198: struct _nbap_msg_info_for_fp g_nbap_msg_info_for_fp;",
          "",
          "[Removed Lines]",
          "196: static GTree * com_context_map;",
          "",
          "[Added Lines]",
          "196: static wmem_tree_t* com_context_map;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "421:  }",
          "423: }",
          "435: static void nbap_init(void){",
          "436:     guint8 i;",
          "450:     for (i = 0; i < 15; i++) {",
          "451:         lchId_type_table[i+1] = lch_contents[i];",
          "452:     }",
          "453: }",
          "461: static int",
          "462: dissect_nbap(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)",
          "463: {",
          "",
          "[Removed Lines]",
          "424: static gint nbap_key_cmp(gconstpointer a_ptr, gconstpointer b_ptr, gpointer ignore _U_){",
          "425:  if( GPOINTER_TO_INT(a_ptr) > GPOINTER_TO_INT(b_ptr) ){",
          "426:   return  -1;",
          "427:  }",
          "428:  return GPOINTER_TO_INT(a_ptr) < GPOINTER_TO_INT(b_ptr);",
          "429: }",
          "431:    g_free(key);",
          "438:     com_context_map = g_tree_new_full(nbap_key_cmp,",
          "441:                        g_free);",
          "445:     edch_flow_port_map = g_tree_new_full(nbap_key_cmp,",
          "448:                        g_free);",
          "455: static void nbap_cleanup(void){",
          "457:     g_tree_destroy(com_context_map);",
          "458:     g_tree_destroy(edch_flow_port_map);",
          "459: }",
          "",
          "[Added Lines]",
          "428:     com_context_map = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());",
          "431:     edch_flow_port_map = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "546:  nbap_proc_uout_dissector_table = register_dissector_table(\"nbap.proc.uout\", \"NBAP-ELEMENTARY-PROCEDURE UnsuccessfulOutcome\", proto_nbap, FT_STRING, BASE_NONE, DISSECTOR_TABLE_ALLOW_DUPLICATE);",
          "548:  register_init_routine(nbap_init);",
          "550: }",
          "",
          "[Removed Lines]",
          "549:  register_cleanup_routine(nbap_cleanup);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6577: guint node_b_com_context_id;",
          "6582: typedef struct com_ctxt_{",
          "",
          "[Removed Lines]",
          "6579: static GTree * edch_flow_port_map = NULL;",
          "",
          "[Added Lines]",
          "6579: static wmem_tree_t* edch_flow_port_map = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "6586: }nbap_com_context_id_t;",
          "6588: gboolean crcn_context_present = FALSE;",
          "6591: struct _nbap_msg_info_for_fp g_nbap_msg_info_for_fp;",
          "",
          "[Removed Lines]",
          "6589: static GTree * com_context_map;",
          "",
          "[Added Lines]",
          "6589: static wmem_tree_t* com_context_map;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "10050: static int",
          "10051: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10053:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10054:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10052: #line 2151 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10052: #line 2152 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "10303: static int",
          "10304: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10306: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10307: address     null_addr;",
          "10308: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10305: #line 2116 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10305: #line 2117 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11525: static int",
          "11526: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11529:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11530:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11527: #line 1975 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11527: #line 1976 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "11659: static int",
          "11660: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11663:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11664:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11661: #line 1629 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11661: #line 1630 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "11677: static int",
          "11678: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11680:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11681:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11679: #line 1731 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11679: #line 1732 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "12100: static int",
          "12101: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12103:     address     dst_addr;",
          "12104:     transportLayerAddress_ipv4 = 0;",
          "12105:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12102: #line 1982 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12102: #line 1983 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "12145: static int",
          "12146: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12148:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12149:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12147: #line 1619 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12147: #line 1620 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "13366: static int",
          "13367: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13369:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13370:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13368: #line 2090 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13368: #line 2091 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18050: static int",
          "18051: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18054:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18055:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18052: #line 1608 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18052: #line 1609 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18185: static int",
          "18186: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18188:     num_items++;",
          "",
          "[Removed Lines]",
          "18187: #line 1605 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18187: #line 1606 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18202: static int",
          "18203: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18205:     num_items = 0;",
          "18207:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18204: #line 1598 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18204: #line 1599 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18418: static int",
          "18419: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18422:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18423:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18420: #line 1593 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18420: #line 1594 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18493: static int",
          "18494: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18496: guint32 no_ddi_entries, i;",
          "18497: address     null_addr;",
          "18498: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18495: #line 1501 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18495: #line 1502 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "18519:     }else{",
          "18520:         nbap_com_context_id_t * cur_val;",
          "18522:             com_context_id= cur_val->crnc_context;",
          "18523:         }else{",
          "18524:             expert_add_info(actx->pinfo, NULL, &ei_nbap_no_find_comm_context_id);",
          "",
          "[Removed Lines]",
          "18521:         if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "18521:         if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "18526:     }",
          "18530:         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_find_port_info);",
          "18531:         return offset;",
          "18532:     }",
          "",
          "[Removed Lines]",
          "18529:     if(( old_info = (nbap_edch_port_info_t *)g_tree_lookup(edch_flow_port_map, GINT_TO_POINTER((gint)com_context_id))) == NULL ){",
          "",
          "[Added Lines]",
          "18529:     if(( old_info = (nbap_edch_port_info_t *)wmem_tree_lookup32(edch_flow_port_map, com_context_id)) == NULL ){",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "18708:                     umts_fp_conversation_info->com_context_id = com_context_id;",
          "18709:                 }else{",
          "18710:                     nbap_com_context_id_t * cur_val;",
          "18712:                         umts_fp_conversation_info->com_context_id = cur_val->crnc_context;",
          "18713:                     }else{",
          "18714:                         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_set_comm_context_id);",
          "",
          "[Removed Lines]",
          "18711:                     if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "18712:                     if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23331: static int",
          "23332: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23333: #line 2002 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23334: #line 2003 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23492: static int",
          "23493: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23497:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23494: #line 1709 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23495: #line 1710 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23595: static int",
          "23596: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23598:     guint32 rlc_mode;",
          "23600:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23597: #line 1636 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23598: #line 1637 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23636: static int",
          "23637: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23639:     num_items++;",
          "",
          "[Removed Lines]",
          "23638: #line 1700 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23639: #line 1701 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23670: static int",
          "23671: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23674:     int protocol_ie_id;",
          "23675:     guint32 i;",
          "",
          "[Removed Lines]",
          "23672: #line 1660 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23673: #line 1661 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23714: static int",
          "23715: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23717:     guint32 hsdsch_physical_layer_category;",
          "23719:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23716: #line 1653 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23717: #line 1654 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "23782: static int",
          "23783: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23784: #line 1761 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23785: #line 1762 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "23919: static int",
          "23920: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23922:     address     dst_addr;",
          "23923:     transportLayerAddress_ipv4 = 0;",
          "23924:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23921: #line 1850 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23922: #line 1851 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "23977: static int",
          "23978: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23980:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23979: #line 1703 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23980: #line 1704 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24112: static int",
          "24113: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24114: #line 1870 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24115: #line 1871 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24234: static int",
          "24235: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24236: #line 1738 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24237: #line 1739 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24345: static int",
          "24346: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24348:     num_items++;",
          "",
          "[Removed Lines]",
          "24347: #line 1706 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24348: #line 1707 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "24761: static int",
          "24762: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24765:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24763: #line 2080 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24764: #line 2081 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "24955: static int",
          "24956: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24958:     num_items++;",
          "",
          "[Removed Lines]",
          "24957: #line 1697 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24958: #line 1698 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "24972: static int",
          "24973: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24975:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24974: #line 1692 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24975: #line 1693 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "28074: static int",
          "28075: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28078: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28076: #line 2094 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28077: #line 2095 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "28089: if(crcn_context_present){",
          "28093:             cur_val->crnc_context = com_context_id;",
          "28094:             cur_val->frame_num = actx->pinfo->num;",
          "28096:             com_context_id = -1;",
          "28097:         }",
          "28098:     }",
          "",
          "[Removed Lines]",
          "28090:         if( (nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id)) == NULL ){",
          "28092:             cur_val = g_new(nbap_com_context_id_t,1);",
          "28095:             g_tree_insert(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id), cur_val);",
          "",
          "[Added Lines]",
          "28091:         if( wmem_tree_lookup32(com_context_map, node_b_com_context_id) == NULL ){",
          "28093:             cur_val = wmem_new(wmem_file_scope(), nbap_com_context_id_t);",
          "28096:             wmem_tree_insert32(com_context_map, node_b_com_context_id, cur_val);",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "28866:                     umts_fp_conversation_info->com_context_id = com_context_id;",
          "28867:                 }else{",
          "28868:                     nbap_com_context_id_t *cur_val;",
          "28870:                         umts_fp_conversation_info->com_context_id = cur_val->crnc_context;",
          "28871:                     }else{",
          "28872:                         expert_add_info(actx->pinfo, NULL, &ei_nbap_no_set_comm_context_id);",
          "",
          "[Removed Lines]",
          "28869:                     if((cur_val=(nbap_com_context_id_t *)g_tree_lookup(com_context_map, GINT_TO_POINTER((gint)node_b_com_context_id))) != NULL){",
          "",
          "[Added Lines]",
          "28870:                     if((cur_val=(nbap_com_context_id_t *)wmem_tree_lookup32(com_context_map, node_b_com_context_id)) != NULL){",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "28879:                     nbap_edch_port_info_t * nbap_edch_port_info;",
          "28884:                     nbap_edch_port_info->crnc_port[e_dch_macdflow_id] = BindingID_port;",
          "",
          "[Removed Lines]",
          "28878:                 if( (old_info = (nbap_edch_port_info_t *)g_tree_lookup(edch_flow_port_map, GINT_TO_POINTER((gint)com_context_id))) == NULL ){",
          "28881:                     nbap_edch_port_info = (nbap_edch_port_info_t *)g_malloc0(sizeof(nbap_edch_port_info_t));",
          "",
          "[Added Lines]",
          "28879:                 if( (old_info = (nbap_edch_port_info_t *)wmem_tree_lookup32(edch_flow_port_map, com_context_id)) == NULL ){",
          "28882:                     nbap_edch_port_info = wmem_new0(wmem_file_scope(), nbap_edch_port_info_t);",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "28888:                     nbap_debug(\"Frame %u RL-Specific-E-DCH-Information-Item Start\",",
          "28889:                         actx->pinfo->num);",
          "28892:                         umts_fp_conversation_info->com_context_id,",
          "28893:                         e_dch_macdflow_id,",
          "28894:                         address_to_str(wmem_packet_scope(), &dst_addr),",
          "28895:                         BindingID_port);",
          "28898:                 }else{",
          "28900:                     nbap_debug(\"    Insert in existing edch_flow_port_map com_context_id %u e_dch_macdflow_id %u IP %s Port %u\",",
          "",
          "[Removed Lines]",
          "28891:                     nbap_debug(\"    g_tree_insert(edch_flow_port_map) com_context_id %u e_dch_macdflow_id %u IP %s Port %u\",",
          "28897:                     g_tree_insert(edch_flow_port_map, GINT_TO_POINTER((gint)umts_fp_conversation_info->com_context_id), nbap_edch_port_info);",
          "",
          "[Added Lines]",
          "28892:                     nbap_debug(\"    wmem_tree_insert32(edch_flow_port_map) com_context_id %u e_dch_macdflow_id %u IP %s Port %u\",",
          "28898:                     wmem_tree_insert32(edch_flow_port_map, umts_fp_conversation_info->com_context_id, nbap_edch_port_info);",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "41090: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41093: #line 2143 \"./asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41094: #line 2144 \"./asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "55280:  }",
          "55282: }",
          "55294: static void nbap_init(void){",
          "55295:     guint8 i;",
          "55309:     for (i = 0; i < 15; i++) {",
          "55310:         lchId_type_table[i+1] = lch_contents[i];",
          "55311:     }",
          "55312: }",
          "55320: static int",
          "55321: dissect_nbap(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)",
          "55322: {",
          "",
          "[Removed Lines]",
          "55283: static gint nbap_key_cmp(gconstpointer a_ptr, gconstpointer b_ptr, gpointer ignore _U_){",
          "55284:  if( GPOINTER_TO_INT(a_ptr) > GPOINTER_TO_INT(b_ptr) ){",
          "55285:   return  -1;",
          "55286:  }",
          "55287:  return GPOINTER_TO_INT(a_ptr) < GPOINTER_TO_INT(b_ptr);",
          "55288: }",
          "55290:    g_free(key);",
          "55297:     com_context_map = g_tree_new_full(nbap_key_cmp,",
          "55300:                        g_free);",
          "55304:     edch_flow_port_map = g_tree_new_full(nbap_key_cmp,",
          "55307:                        g_free);",
          "55314: static void nbap_cleanup(void){",
          "55316:     g_tree_destroy(com_context_map);",
          "55317:     g_tree_destroy(edch_flow_port_map);",
          "55318: }",
          "",
          "[Added Lines]",
          "55288:     com_context_map = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());",
          "55291:     edch_flow_port_map = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "68523:         NULL, HFILL }},",
          "68527:  };",
          "",
          "[Removed Lines]",
          "68526: #line 503 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "[Added Lines]",
          "68504: #line 480 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "70163:     &ett_nbap_Outcome,",
          "70167:  };",
          "70169:  static ei_register_info ei[] = {",
          "",
          "[Removed Lines]",
          "70166: #line 512 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "[Added Lines]",
          "70144: #line 489 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "---------------",
          "--- Hunk 43 ---",
          "[Context before]",
          "70201:  nbap_proc_uout_dissector_table = register_dissector_table(\"nbap.proc.uout\", \"NBAP-ELEMENTARY-PROCEDURE UnsuccessfulOutcome\", proto_nbap, FT_STRING, BASE_NONE, DISSECTOR_TABLE_ALLOW_DUPLICATE);",
          "70203:  register_init_routine(nbap_init);",
          "70205: }",
          "",
          "[Removed Lines]",
          "70204:  register_cleanup_routine(nbap_cleanup);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 44 ---",
          "[Context before]",
          "71319: }",
          "",
          "[Removed Lines]",
          "71318: #line 567 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "[Added Lines]",
          "71295: #line 543 \"./asn1/nbap/packet-nbap-template.c\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}