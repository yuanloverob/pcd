{
  "cve_id": "CVE-2014-5273",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.2, 4.1.x before 4.1.14.3, and 4.2.x before 4.2.7.1 allow remote authenticated users to inject arbitrary web script or HTML via the (1) browse table page, related to js/sql.js; (2) ENUM editor page, related to js/functions.js; (3) monitor page, related to js/server_status_monitor.js; (4) query charts page, related to js/tbl_chart.js; or (5) table relations page, related to libraries/tbl_relation.lib.php.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "2c45d7caa614afd71dbe3d0f7270f51ce5569614",
  "patch_info": {
    "commit_hash": "2c45d7caa614afd71dbe3d0f7270f51ce5569614",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/2c45d7caa614afd71dbe3d0f7270f51ce5569614",
    "files": [
      "ChangeLog",
      "js/functions.js"
    ],
    "message": "bug #4502 [security] Self-XSS in enum value editor\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
    "before_after_code_files": [
      "js/functions.js||js/functions.js"
    ]
  },
  "patch_diff": {
    "js/functions.js||js/functions.js": [
      "File: js/functions.js -> js/functions.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "2692:         } else {",
      "2693:             title = PMA_messages.enum_columnVals.replace(",
      "2694:                 /%s/,",
      "2696:             );",
      "2697:         }",
      "",
      "[Removed Lines]",
      "2695:                 '\"' + decodeURIComponent(colname) + '\"'",
      "",
      "[Added Lines]",
      "2695:                 '\"' + escapeHtml(decodeURIComponent(colname)) + '\"'",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "1956420ddab0595016ba2b3af89f7f82d39f5afa",
      "candidate_info": {
        "commit_hash": "1956420ddab0595016ba2b3af89f7f82d39f5afa",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/1956420ddab0595016ba2b3af89f7f82d39f5afa",
        "files": [
          "ChangeLog",
          "js/functions.js"
        ],
        "message": "bug #4502 [security] Self-XSS in enum value editor\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "js/functions.js||js/functions.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "2684:         } else {",
          "2685:             title = PMA_messages.enum_columnVals.replace(",
          "2686:                 /%s/,",
          "2688:             );",
          "2689:         }",
          "",
          "[Removed Lines]",
          "2687:                 '\"' + decodeURIComponent(colname) + '\"'",
          "",
          "[Added Lines]",
          "2687:                 '\"' + escapeHtml(decodeURIComponent(colname)) + '\"'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0433d463b6c05ea7b1080995414268fe0a449b00",
      "candidate_info": {
        "commit_hash": "0433d463b6c05ea7b1080995414268fe0a449b00",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/0433d463b6c05ea7b1080995414268fe0a449b00",
        "files": [
          "ChangeLog",
          "js/functions.js"
        ],
        "message": "bug #4502 [security] Self-XSS in enum value editor\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "js/functions.js||js/functions.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "2550:         } else {",
          "2551:             var title = PMA_messages['enum_columnVals'].replace(",
          "2552:                 /%s/,",
          "2554:             );",
          "2555:         }",
          "",
          "[Removed Lines]",
          "2553:                 '\"' + decodeURIComponent(colname) + '\"'",
          "",
          "[Added Lines]",
          "2553:                 '\"' + escapeHtml(decodeURIComponent(colname)) + '\"'",
          "",
          "---------------"
        ]
      }
    }
  ]
}