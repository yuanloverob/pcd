{
  "cve_id": "CVE-2018-18227",
  "cve_desc": "In Wireshark 2.6.0 to 2.6.3 and 2.4.0 to 2.4.9, the MS-WSP protocol dissector could crash. This was addressed in epan/dissectors/packet-mswsp.c by properly handling NULL return values.",
  "repo": "wireshark/wireshark",
  "patch_hash": "f4d2dffd8be1df30a832647a2f188507076f0fed",
  "patch_info": {
    "commit_hash": "f4d2dffd8be1df30a832647a2f188507076f0fed",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/f4d2dffd8be1df30a832647a2f188507076f0fed",
    "files": [
      "epan/dissectors/packet-mswsp.c"
    ],
    "message": "Fix handling of invalid type values.\n\nIf vType_get_type() returns NULL, that means that the packet is bad, not\nthat the dissector is bad.  Report it as such.\n\nBug: 15119\nChange-Id: I8e66fcece2b526ef9edbf948862f8fc5bea25d74\nReviewed-on: https://code.wireshark.org/review/29511\nReviewed-by: Guy Harris <guy@alum.mit.edu>",
    "before_after_code_files": [
      "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
    ]
  },
  "patch_diff": {
    "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c": [
      "File: epan/dissectors/packet-mswsp.c -> epan/dissectors/packet-mswsp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "360: void proto_reg_handoff_mswsp(void);",
      "362: static expert_field ei_missing_msg_context = EI_INIT;",
      "363: static expert_field ei_mswsp_msg_cpmsetbinding_ccolumns = EI_INIT;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "362: static expert_field ei_mswsp_invalid_variant_type = EI_INIT;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "3074: static int parse_CFullPropSpec(tvbuff_t *tvb, int offset, proto_tree *tree, proto_tree *pad_tree, struct CFullPropSpec *v, const char *fmt, ...);",
      "",
      "[Removed Lines]",
      "3071: static int parse_CBaseStorageVariant(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CBaseStorageVariant *value, const char *text);",
      "",
      "[Added Lines]",
      "3072: static int parse_CBaseStorageVariant(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CBaseStorageVariant *value, const char *text);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "3080: static int parse_CNatLanguageRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNatLanguageRestriction *v, const char *fmt, ...);",
      "3089: static int parse_CReuseWhere(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CReuseWhere *v, const char *fmt, ...);",
      "",
      "[Removed Lines]",
      "3083: static int parse_CNodeRestriction(tvbuff_t *tvb, int offset, proto_tree *tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char* fmt, ...);",
      "3086: static int parse_CPropertyRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...);",
      "",
      "[Added Lines]",
      "3084: static int parse_CNodeRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char* fmt, ...);",
      "3087: static int parse_CPropertyRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "3092: static int parse_CSort(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, const char *fmt, ...);",
      "3103: static int parse_CColumnSet(tvbuff_t *tvb, int offset, proto_tree *tree, const char *fmt, ...);",
      "3118: static int parse_CAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "",
      "[Removed Lines]",
      "3095: static int parse_CCoercionRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...);",
      "3097: static int parse_CRestrictionArray(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3100: static int parse_CRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...);",
      "3106: static int parse_CCategorizationSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3109: static int parse_CCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3112: static int parse_CRangeCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3115: static int parse_RANGEBOUNDARY(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "",
      "[Added Lines]",
      "3096: static int parse_CCoercionRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...);",
      "3098: static int parse_CRestrictionArray(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3101: static int parse_CRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...);",
      "3107: static int parse_CCategorizationSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3110: static int parse_CCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3113: static int parse_CRangeCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3116: static int parse_RANGEBOUNDARY(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "3127: static int parse_CAggregSortKey(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3136: static int parse_CDbColId(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *text);",
      "3145: static int parse_CPidMapper(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "",
      "[Removed Lines]",
      "3130: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3133: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3139: static int parse_CDbProp(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...);",
      "3142: static int parse_CDbPropSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "",
      "[Added Lines]",
      "3131: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3134: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "3140: static int parse_CDbProp(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...);",
      "3143: static int parse_CDbPropSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "3157: static int parse_CSortSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
      "",
      "[Removed Lines]",
      "3160: static int parse_CTableColumn(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...);",
      "",
      "[Added Lines]",
      "3161: static int parse_CTableColumn(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "3231:  return offset;",
      "3232: }",
      "3235: {",
      "3239:  proto_tree *tree;",
      "3240:  va_list ap;",
      "3241:  struct vtype_data *type;",
      "",
      "[Removed Lines]",
      "3234: static int parse_CTableColumn(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...)",
      "3238:  proto_item *item;",
      "",
      "[Added Lines]",
      "3235: static int parse_CTableColumn(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...)",
      "3239:  proto_item *item, *ti_type;",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "3266:   }",
      "3267:  }",
      "3268:  type = vType_get_type(vtype_val);",
      "3271:  offset += 4;",
      "3273:  used = tvb_get_guint8(tvb, offset);",
      "",
      "[Removed Lines]",
      "3269:  DISSECTOR_ASSERT(type != NULL);",
      "3270:  proto_tree_add_string_format_value(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, type->str, \"%s%s\", type->str, modifier);",
      "",
      "[Added Lines]",
      "3270:  if (type == NULL) {",
      "3274:   ti_type = proto_tree_add_string(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, \"Unknown CTableColumn type\");",
      "3275:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
      "3276:  } else",
      "3277:   proto_tree_add_string_format_value(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, type->str, \"%s%s\", type->str, modifier);",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "3487:  }",
      "3488:  return offset + 4;",
      "3489: }",
      "3491: {",
      "3492:  proto_tree *tree;",
      "3493:  proto_item *item;",
      "",
      "[Removed Lines]",
      "3490: static int parse_CPropertyRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "3497: static int parse_CPropertyRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "3506:  offset = parse_CFullPropSpec(tvb, offset, tree, pad_tree, &v->property, \"Property\");",
      "3510:  offset = parse_padding(tvb, offset, 4, pad_tree, \"padding_lcid\");",
      "",
      "[Removed Lines]",
      "3508:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &v->prval, \"prval\");",
      "",
      "[Added Lines]",
      "3515:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &v->prval, \"prval\");",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "3517:  return offset;",
      "3518: }",
      "3521: {",
      "3522:  proto_tree *tree;",
      "3523:  proto_item *item;",
      "",
      "[Removed Lines]",
      "3520: static int parse_CCoercionRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "3527: static int parse_CCoercionRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "3536:  offset += 4;",
      "3540:  proto_item_set_end(item, tvb, offset);",
      "3541:  return offset;",
      "",
      "[Removed Lines]",
      "3538:  offset = parse_CRestriction(tvb, offset, tree, pad_tree, &v->child, \"child\");",
      "",
      "[Added Lines]",
      "3545:  offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &v->child, \"child\");",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "3732:  return offset + 4;",
      "3733: }",
      "3736: {",
      "3737:  proto_tree *tree;",
      "3738:  proto_item *item;",
      "",
      "[Removed Lines]",
      "3735: static int parse_CRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "3742: static int parse_CRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "3761:  case RTProximity:",
      "3762:  case RTPhrase: {",
      "3763:   v->u.RTAnd = EP_ALLOC(struct CNodeRestriction);",
      "3765:   break;",
      "3766:  }",
      "3767:  case RTNot: {",
      "3768:   v->u.RTNot = EP_ALLOC(struct CRestriction);",
      "3770:          v->u.RTNot, \"CRestriction\");",
      "3771:   break;",
      "3772:  }",
      "3773:  case RTProperty: {",
      "3774:   v->u.RTProperty = EP_ALLOC(struct CPropertyRestriction);",
      "3776:            v->u.RTProperty, \"CPropertyRestriction\");",
      "3777:   break;",
      "3778:  }",
      "",
      "[Removed Lines]",
      "3764:   offset = parse_CNodeRestriction(tvb, offset, tree, pad_tree, v->u.RTAnd, \"CNodeRestriction\");",
      "3769:   offset = parse_CRestriction(tvb, offset, tree, pad_tree,",
      "3775:   offset = parse_CPropertyRestriction(tvb, offset, tree, pad_tree,",
      "",
      "[Added Lines]",
      "3771:   offset = parse_CNodeRestriction(tvb, pinfo, offset, tree, pad_tree, v->u.RTAnd, \"CNodeRestriction\");",
      "3776:   offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree,",
      "3782:   offset = parse_CPropertyRestriction(tvb, pinfo, offset, tree, pad_tree,",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "3780:  case RTCoerce_Multiply:",
      "3781:  case RTCoerce_Absolute: {",
      "3782:   v->u.RTCoerce_Add = EP_ALLOC(struct CCoercionRestriction);",
      "3784:            v->u.RTCoerce_Add, \"CCoercionRestriction\");",
      "3785:   break;",
      "3786:  }",
      "",
      "[Removed Lines]",
      "3783:   offset = parse_CCoercionRestriction(tvb, offset, tree, pad_tree,",
      "",
      "[Added Lines]",
      "3790:   offset = parse_CCoercionRestriction(tvb, pinfo, offset, tree, pad_tree,",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "3810:  return offset;",
      "3811: }",
      "3814: {",
      "3815:  guint8 present, count;",
      "",
      "[Removed Lines]",
      "3813: static int parse_CRestrictionArray(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "3820: static int parse_CRestrictionArray(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "3841:   for (i=0; i<count; i++) {",
      "3842:    struct CRestriction r;",
      "3844:   }",
      "3845:  }",
      "3846:  proto_item_set_end(item, tvb, offset);",
      "3847:  return offset;",
      "3848: }",
      "3851: {",
      "3852:  proto_tree *tree;",
      "3853:  proto_item *item;",
      "",
      "[Removed Lines]",
      "3843:    offset = parse_CRestriction(tvb, offset, tree, pad_tree, &r, \"Restriction[%d]\", i);",
      "3850: static int parse_CNodeRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "3850:    offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &r, \"Restriction[%d]\", i);",
      "3857: static int parse_CNodeRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "3867:  for (i=0; i<v->cNode; i++) {",
      "3868:   struct CRestriction r;",
      "3869:   ZERO_STRUCT(r);",
      "3873:  }",
      "",
      "[Removed Lines]",
      "3870:   offset = parse_CRestriction(tvb, offset, tree, pad_tree, &r, \"paNode[%u]\", i);",
      "",
      "[Added Lines]",
      "3877:   offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &r, \"paNode[%u]\", i);",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "4208:  return wmem_strbuf_get_str(strbuf);",
      "4209: }",
      "4322: {",
      "4323:  int i, len;",
      "4324:  proto_item *ti, *ti_type, *ti_val;",
      "",
      "[Removed Lines]",
      "4211: static int parse_vType(tvbuff_t *tvb, int offset, guint16 *vtype)",
      "4212: {",
      "4213:  guint16 tmp_vtype = tvb_get_letohs(tvb, offset);",
      "4214:  guint16 modifier =  tmp_vtype & 0xFF00;",
      "4216:  switch (tmp_vtype & 0xFF) {",
      "4217:   case VT_EMPTY:",
      "4219:    break;",
      "4220:   case VT_NULL:",
      "4222:    break;",
      "4223:   case VT_I2:",
      "4225:    break;",
      "4226:   case VT_I4:",
      "4228:    break;",
      "4229:   case VT_R4:",
      "4231:    break;",
      "4232:   case VT_R8:",
      "4234:    break;",
      "4235:   case VT_CY:",
      "4237:    break;",
      "4238:   case VT_DATE:",
      "4240:    break;",
      "4241:   case VT_BSTR:",
      "4243:    break;",
      "4244:   case VT_ERROR:",
      "4246:    break;",
      "4247:   case VT_BOOL:",
      "4249:    break;",
      "4250:   case VT_VARIANT:",
      "4252:    break;",
      "4253:   case VT_DECIMAL:",
      "4255:    break;",
      "4256:   case VT_I1:",
      "4258:    break;",
      "4259:   case VT_UI1:",
      "4261:    break;",
      "4262:   case VT_UI2:",
      "4264:    break;",
      "4265:   case VT_UI4:",
      "4267:    break;",
      "4268:   case VT_I8:",
      "4270:    break;",
      "4271:   case VT_UI8:",
      "4273:    break;",
      "4274:   case VT_INT:",
      "4276:    break;",
      "4277:   case VT_UINT:",
      "4279:    break;",
      "4280:   case VT_LPSTR:",
      "4282:    break;",
      "4283:   case VT_LPWSTR:",
      "4285:    break;",
      "4286:   case VT_COMPRESSED_LPWSTR:",
      "4288:    break;",
      "4289:   case VT_FILETIME:",
      "4291:    break;",
      "4292:   case VT_BLOB:",
      "4294:    break;",
      "4295:   case VT_BLOB_OBJECT:",
      "4297:    break;",
      "4298:   case VT_CLSID:",
      "4300:    break;",
      "4301:   default:",
      "4302:    DISSECTOR_ASSERT(FALSE);",
      "4303:    break;",
      "4304:  }",
      "4305:  if (modifier) {",
      "4306:   switch (modifier) {",
      "4307:    case VT_VECTOR:",
      "4309:     break;",
      "4310:    case VT_ARRAY:",
      "4312:     break;",
      "4313:    default:",
      "4314:     DISSECTOR_ASSERT(FALSE);",
      "4315:     break;",
      "4316:   }",
      "4317:  }",
      "4318:  return offset + 2;",
      "4319: }",
      "4321: static int parse_CBaseStorageVariant(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CBaseStorageVariant *value, const char *text)",
      "",
      "[Added Lines]",
      "4218: static int parse_CBaseStorageVariant(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CBaseStorageVariant *value, const char *text)",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "4330:  tree = proto_tree_add_subtree(parent_tree, tvb, offset, 0, ett_CBaseStorageVariant, &ti, text);",
      "4336:  ti_type = proto_tree_add_string(tree, hf_mswsp_cbasestorvariant_vtype, tvb, offset, 2, value->type->str);",
      "4337:  offset += 2;",
      "",
      "[Removed Lines]",
      "4332:  parse_vType(tvb, offset, &value->vType);",
      "4333:  value->type = vType_get_type(value->vType);",
      "4334:  DISSECTOR_ASSERT(value->type != NULL);",
      "",
      "[Added Lines]",
      "4229:  value->vType = tvb_get_letohs(tvb, offset);",
      "4230:  value->type = vType_get_type(value->vType & 0xFF);",
      "4231:  if (value->type == NULL) {",
      "4235:   ti_type = proto_tree_add_string(tree, hf_mswsp_cbasestorvariant_vtype, tvb, offset, 2, \"Unknown CBaseStorageVariant type\");",
      "4236:   offset += 2;",
      "4237:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
      "4239:   THROW_MESSAGE(ReportedBoundsError, \"Unknown CBaseStorageVariant type\");",
      "4240:   return offset;",
      "4241:  }",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "4452:  return offset;",
      "4453: }",
      "4456: {",
      "4457:  static const value_string EMPTY_VS[] = {{0, NULL}};",
      "4458:  const value_string *vs = (propset && propset->id_map) ? propset->id_map : EMPTY_VS;",
      "",
      "[Removed Lines]",
      "4455: static int parse_CDbProp(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4362: static int parse_CDbProp(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "4486:  offset = parse_CDbColId(tvb, offset, tree, pad_tree, \"colid\");",
      "4490:  str = str_CBaseStorageVariant(&value, TRUE);",
      "4491:  proto_item_append_text(item, \" %s\", str);",
      "",
      "[Removed Lines]",
      "4488:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &value, \"vValue\");",
      "",
      "[Added Lines]",
      "4395:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &value, \"vValue\");",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "4494:  return offset;",
      "4495: }",
      "4498: {",
      "4499:  int i, num;",
      "4500:  e_guid_t guid;",
      "",
      "[Removed Lines]",
      "4497: static int parse_CDbPropSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4404: static int parse_CDbPropSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "4531:  for (i = 0; i<num; i++) {",
      "4532:   offset = parse_padding(tvb, offset, 4, pad_tree, \"aProp[%d]\", i);",
      "4534:  }",
      "4536:  proto_item_set_end(item, tvb, offset);",
      "4537:  return offset;",
      "4538: }",
      "4541: {",
      "4542:  const int offset_in = offset;",
      "4543:  guint32 size, num;",
      "",
      "[Removed Lines]",
      "4533:   offset = parse_CDbProp(tvb, offset, tree, pad_tree, pset, \"aProp[%d]\", i);",
      "4540: static int parse_PropertySetArray(tvbuff_t *tvb, int offset, int size_offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4440:   offset = parse_CDbProp(tvb, pinfo, offset, tree, pad_tree, pset, \"aProp[%d]\", i);",
      "4447: static int parse_PropertySetArray(tvbuff_t *tvb, packet_info *pinfo, int offset, int size_offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "4563:  offset += 4;",
      "4565:  for (i = 0; i < (int)num; i++) {",
      "4567:  }",
      "4569:  proto_item_set_end(item, tvb, offset);",
      "",
      "[Removed Lines]",
      "4566:   offset = parse_CDbPropSet(tvb, offset, tree, pad_tree, \"PropertySet[%d]\", i);",
      "",
      "[Added Lines]",
      "4473:   offset = parse_CDbPropSet(tvb, pinfo, offset, tree, pad_tree, \"PropertySet[%d]\", i);",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "4601: }",
      "4605: {",
      "4606:  guint32 ulType;",
      "4607:  guint8 labelPresent;",
      "",
      "[Removed Lines]",
      "4604: int parse_RANGEBOUNDARY(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4511: int parse_RANGEBOUNDARY(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 27 ---",
      "[Context before]",
      "4622:  offset += 4;",
      "4624:  ZERO_STRUCT(prval);",
      "4627:  labelPresent = tvb_get_guint8(tvb, offset);",
      "4628:  proto_tree_add_item(tree, hf_mswsp_rangeboundry_labelpresent, tvb, offset, 1, ENC_LITTLE_ENDIAN);",
      "",
      "[Removed Lines]",
      "4625:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &prval, \"prVal\");",
      "",
      "[Added Lines]",
      "4532:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &prval, \"prVal\");",
      "",
      "---------------",
      "--- Hunk 28 ---",
      "[Context before]",
      "4654: {",
      "4655:  proto_item *item;",
      "4656:  proto_tree *tree;",
      "",
      "[Removed Lines]",
      "4653: int parse_CRangeCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4560: int parse_CRangeCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 29 ---",
      "[Context before]",
      "4671:  offset += 4;",
      "4673:  for (i=0; i<cRange; i++) {",
      "4676:  }",
      "",
      "[Removed Lines]",
      "4674:   offset = parse_RANGEBOUNDARY(tvb, offset, tree, pad_tree, \"aRangeBegin[%u]\", i);",
      "",
      "[Added Lines]",
      "4581:   offset = parse_RANGEBOUNDARY(tvb, pinfo, offset, tree, pad_tree, \"aRangeBegin[%u]\", i);",
      "",
      "---------------",
      "--- Hunk 30 ---",
      "[Context before]",
      "4680: }",
      "4684: {",
      "4685:  proto_item *item;",
      "4686:  proto_tree *tree;",
      "",
      "[Removed Lines]",
      "4683: int parse_CCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4590: int parse_CCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 31 ---",
      "[Context before]",
      "4701:  offset = parse_CSort(tvb, offset, tree, pad_tree, \"CSort\");",
      "4705:  proto_item_set_end(item, tvb, offset);",
      "4706:  return offset;",
      "",
      "[Removed Lines]",
      "4703:  offset = parse_CRangeCategSpec(tvb, offset, tree, pad_tree, \"CRangeCategSpec\");",
      "",
      "[Added Lines]",
      "4610:  offset = parse_CRangeCategSpec(tvb, pinfo, offset, tree, pad_tree, \"CRangeCategSpec\");",
      "",
      "---------------",
      "--- Hunk 32 ---",
      "[Context before]",
      "4867: }",
      "4871: {",
      "4872:  proto_item *item;",
      "4873:  proto_tree *tree;",
      "",
      "[Removed Lines]",
      "4870: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4777: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 33 ---",
      "[Context before]",
      "4886:  if (type == GroupIdValue) {",
      "4887:   struct CBaseStorageVariant id;",
      "4889:  }",
      "4891:  offset = parse_CSortSet(tvb, offset, tree, pad_tree, \"SortSet\");",
      "",
      "[Removed Lines]",
      "4888:   offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &id, \"inGroupId\");",
      "",
      "[Added Lines]",
      "4795:   offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &id, \"inGroupId\");",
      "",
      "---------------",
      "--- Hunk 34 ---",
      "[Context before]",
      "4900: {",
      "4901:  guint32 cCount, i;",
      "4902:  proto_item *item;",
      "",
      "[Removed Lines]",
      "4899: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4806: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 35 ---",
      "[Context before]",
      "4917:  for (i=0; i<cCount; i++) {",
      "4920:  }",
      "4922:  proto_item_set_end(item, tvb, offset);",
      "",
      "[Removed Lines]",
      "4919:   offset = parse_CInGroupSortAggregSet(tvb, offset, tree, pad_tree, \"SortSets[%u]\", i);",
      "",
      "[Added Lines]",
      "4826:   offset = parse_CInGroupSortAggregSet(tvb, pinfo, offset, tree, pad_tree, \"SortSets[%u]\", i);",
      "",
      "---------------",
      "--- Hunk 36 ---",
      "[Context before]",
      "4924: }",
      "4928: {",
      "4929:  proto_item *item;",
      "4930:  proto_tree *tree;",
      "",
      "[Removed Lines]",
      "4927: int parse_CCategorizationSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "4834: int parse_CCategorizationSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 37 ---",
      "[Context before]",
      "4941:  offset = parse_CColumnSet(tvb, offset, tree, \"csColumns\");",
      "4947:  offset = parse_CAggregSet(tvb, offset, tree, pad_tree, \"AggregSet\");",
      "",
      "[Removed Lines]",
      "4944:  offset = parse_CCategSpec(tvb, offset, tree, pad_tree, \"Spec\");",
      "",
      "[Added Lines]",
      "4851:  offset = parse_CCategSpec(tvb, pinfo, offset, tree, pad_tree, \"Spec\");",
      "",
      "---------------",
      "--- Hunk 38 ---",
      "[Context before]",
      "4950:  offset = parse_CSortAggregSet(tvb, offset, tree, pad_tree, \"SortAggregSet\");",
      "4955:  proto_tree_add_item(tree, hf_mswsp_categorizationspec_cmaxres, tvb, offset, 4, ENC_LITTLE_ENDIAN);",
      "4956:  offset += 4;",
      "",
      "[Removed Lines]",
      "4953:  offset = parse_CInGroupSortAggregSets(tvb, offset, tree, pad_tree, \"InGroupSortAggregSets\");",
      "",
      "[Added Lines]",
      "4860:  offset = parse_CInGroupSortAggregSets(tvb, pinfo, offset, tree, pad_tree, \"InGroupSortAggregSets\");",
      "",
      "---------------",
      "--- Hunk 39 ---",
      "[Context before]",
      "5273:  return offset;",
      "5274: }",
      "5277: {",
      "5278:  guint32 i = 0;",
      "5279:  guint64 count = 0;",
      "5280:  int buf_offset = 0;",
      "5281:  proto_tree *sub_tree;",
      "5284:  wmem_strbuf_t *strbuf;",
      "5287:  offset = parse_CRowVariantArrayInfo(tvb, offset, tree, is_64bit, variant);",
      "5288:  if (is_64bit) {",
      "5289:   buf_offset =",
      "",
      "[Removed Lines]",
      "5276: static int parse_VariantColVector(tvbuff_t *tvb, int offset, proto_tree *tree, guint64 base_address, gboolean is_64bit, struct CRowVariant *variant)",
      "5282:  struct vtype_data *vt_list_type =",
      "5283:   vType_get_type((enum vType)(variant->vtype & 0x00FF));",
      "5286:  DISSECTOR_ASSERT(vt_list_type != NULL);",
      "",
      "[Added Lines]",
      "5183: static int parse_VariantColVector(tvbuff_t *tvb, int offset, proto_tree *tree, guint64 base_address, gboolean is_64bit, struct CRowVariant *variant, struct vtype_data *vt_list_type)",
      "",
      "---------------",
      "--- Hunk 40 ---",
      "[Context before]",
      "5335:  return offset;",
      "5336: }",
      "5339: {",
      "5340:  proto_tree *tree;",
      "5343:  va_list ap;",
      "5344:  struct vtype_data *vt_type;",
      "",
      "[Removed Lines]",
      "5338: static int parse_VariantCol(tvbuff_t *tvb, int offset, proto_tree *parent_tree, guint64 base_address, guint32 length _U_, gboolean is_64bit, struct CRowVariant *variant, const char *fmt, ...)",
      "5341:  proto_item *item;",
      "",
      "[Added Lines]",
      "5242: static int parse_VariantCol(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, guint64 base_address, guint32 length _U_, gboolean is_64bit, struct CRowVariant *variant, const char *fmt, ...)",
      "5245:  proto_item *item, *ti_type;",
      "",
      "---------------",
      "--- Hunk 41 ---",
      "[Context before]",
      "5355:  variant->vtype = tvb_get_letohs(tvb, offset);",
      "5356:  vt_type = vType_get_type((enum vType)variant->vtype);",
      "5359:  vtype_high = (variant->vtype & 0xFF00);",
      "5360:  if (vtype_high) {",
      "5361:   if (vtype_high == VT_VECTOR) {",
      "",
      "[Removed Lines]",
      "5357:  DISSECTOR_ASSERT(vt_type != NULL);",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 42 ---",
      "[Context before]",
      "5367:   }",
      "5368:  }",
      "5370:  proto_tree_add_string_format_value(tree, hf_mswsp_rowvariant_vtype, tvb, offset, 2, vt_type->str, \"%s%s\", vt_type->str, modifier);",
      "5371:  offset += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "5272:  if (vt_type == NULL) {",
      "5276:   ti_type = proto_tree_add_string(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, \"Unknown variant column type\");",
      "5277:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
      "5278:   offset += 2;",
      "5280:   THROW_FORMATTED(ReportedBoundsError, \"Unknown variant column type%s\", modifier);",
      "5281:   return offset;",
      "5282:  }",
      "",
      "---------------",
      "--- Hunk 43 ---",
      "[Context before]",
      "5383:  if (vtype_high == VT_VECTOR || vtype_high == VT_ARRAY) {",
      "5384:   offset = parse_VariantColVector(tvb, offset, tree, base_address,",
      "5386:  } else {",
      "5387:   wmem_strbuf_t *strbuf = wmem_strbuf_new(wmem_packet_scope(), \"\");",
      "5388:   if (size != -1) {",
      "",
      "[Removed Lines]",
      "5385:           is_64bit, variant);",
      "",
      "[Added Lines]",
      "5298:           is_64bit, variant, vt_type);",
      "",
      "---------------",
      "--- Hunk 44 ---",
      "[Context before]",
      "5421:  return offset;",
      "5422: }",
      "5425: {",
      "5426:  proto_tree *tree;",
      "5427:  proto_item *item;",
      "",
      "[Removed Lines]",
      "5424: static int parse_RowsBufferCol(tvbuff_t *tvb, int offset, guint32 row, guint32 col, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean b_is_64bit, proto_tree *parent_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "5337: static int parse_RowsBufferCol(tvbuff_t *tvb, packet_info *pinfo, int offset, guint32 row, guint32 col, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean b_is_64bit, proto_tree *parent_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 45 ---",
      "[Context before]",
      "5463:    len = tvb_get_letohs(tvb, buf_offset + pcol->lengthoffset) - pcol->valuesize;",
      "5464:   }",
      "5465:   if (pcol->vtype == VT_VARIANT) {",
      "5467:   }",
      "5468:  }",
      "5469:  return offset;",
      "5470: }",
      "5473: {",
      "5474:  proto_tree *tree;",
      "5475:  proto_item *item;",
      "",
      "[Removed Lines]",
      "5466:    parse_VariantCol(tvb, tmp_offset, tree, base_address, len, b_is_64bit, &variant, \"CRowVariant\");",
      "5472: static int parse_RowsBuffer(tvbuff_t *tvb, int offset, guint32 num_rows, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean is64bit, proto_tree *parent_tree, const char *fmt, ...)",
      "",
      "[Added Lines]",
      "5379:    parse_VariantCol(tvb, pinfo, tmp_offset, tree, base_address, len, b_is_64bit, &variant, \"CRowVariant\");",
      "5385: static int parse_RowsBuffer(tvbuff_t *tvb, packet_info *pinfo, int offset, guint32 num_rows, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean is64bit, proto_tree *parent_tree, const char *fmt, ...)",
      "",
      "---------------",
      "--- Hunk 46 ---",
      "[Context before]",
      "5488:   proto_tree *row_tree;",
      "5489:   row_tree = proto_tree_add_subtree_format(tree, tvb, offset, 0, ett_GetRowsRow, NULL, \"Row[%d]\", num);",
      "5490:   for (col = 0; col < bindingsin->ccolumns; col++) {",
      "5492:   }",
      "5493:  }",
      "5494:  return offset;",
      "",
      "[Removed Lines]",
      "5491:    parse_RowsBufferCol(tvb, offset, num, col, bindingsin, rowsin, is64bit, row_tree, \"Col[%d]\", col);",
      "",
      "[Added Lines]",
      "5404:    parse_RowsBufferCol(tvb, pinfo, offset, num, col, bindingsin, rowsin, is64bit, row_tree, \"Col[%d]\", col);",
      "",
      "---------------",
      "--- Hunk 47 ---",
      "[Context before]",
      "5558:   offset = parse_padding(tvb, offset, 8, pad_tree, \"_paddingcPropSets\");",
      "5562:   offset = parse_padding(tvb, offset, 8, pad_tree, \"paddingExtPropset\");",
      "5566:   offset = parse_padding(tvb, offset, 8, pad_tree, \"???\");",
      "",
      "[Removed Lines]",
      "5560:   offset = parse_PropertySetArray(tvb, offset, blob_size1_off, tree, pad_tree, \"PropSets\");",
      "5564:   offset = parse_PropertySetArray(tvb, offset, blob_size2_off, tree, pad_tree, \"ExtPropset\");",
      "",
      "[Added Lines]",
      "5473:   offset = parse_PropertySetArray(tvb, pinfo, offset, blob_size1_off, tree, pad_tree, \"PropSets\");",
      "5477:   offset = parse_PropertySetArray(tvb, pinfo, offset, blob_size2_off, tree, pad_tree, \"ExtPropset\");",
      "",
      "---------------",
      "--- Hunk 48 ---",
      "[Context before]",
      "5616:   offset += 1;",
      "5618:   if (CRestrictionPresent) {",
      "5620:   }",
      "5622:   CSortSetPresent = tvb_get_guint8(tvb, offset);",
      "",
      "[Removed Lines]",
      "5619:    offset = parse_CRestrictionArray(tvb, offset, tree, pad_tree, \"RestrictionArray\");",
      "",
      "[Added Lines]",
      "5532:    offset = parse_CRestrictionArray(tvb, pinfo, offset, tree, pad_tree, \"RestrictionArray\");",
      "",
      "---------------",
      "--- Hunk 49 ---",
      "[Context before]",
      "5626:   if (CSortSetPresent) {",
      "5627:    offset = parse_padding(tvb, offset, 4, tree, \"paddingCSortSetPresent\");",
      "5630:   }",
      "",
      "[Removed Lines]",
      "5628:    offset = parse_CInGroupSortAggregSets(tvb, offset, tree, pad_tree, \"GroupSortAggregSets\");",
      "",
      "[Added Lines]",
      "5541:    offset = parse_CInGroupSortAggregSets(tvb, pinfo, offset, tree, pad_tree, \"GroupSortAggregSets\");",
      "",
      "---------------",
      "--- Hunk 50 ---",
      "[Context before]",
      "5641:    proto_tree_add_uint(tree, hf_mswsp_msg_cpmcreatequery_ccateg_count, tvb, offset, 4, count);",
      "5642:    offset += 4;",
      "5643:    for (i=0; i<count; i++) {",
      "5645:    }",
      "5646:   }",
      "",
      "[Removed Lines]",
      "5644:     offset = parse_CCategorizationSpec(tvb, offset, tree, pad_tree, \"categories[%u]\", i);",
      "",
      "[Added Lines]",
      "5557:     offset = parse_CCategorizationSpec(tvb, pinfo, offset, tree, pad_tree, \"categories[%u]\", i);",
      "",
      "---------------",
      "--- Hunk 51 ---",
      "[Context before]",
      "5803:   if (b_has_arch && bindingsin && rowsin) {",
      "5804:    offset = parse_padding(tvb, offset, rowsin->cbreserved, pad_tree,",
      "5805:            \"paddingRows\");",
      "5807:   } else {",
      "5808:    gint nbytes = tvb_reported_length_remaining(tvb, offset);",
      "5809:    proto_tree_add_expert_format(tree, pinfo, &ei_missing_msg_context, tvb, offset, nbytes, \"Undissected %d bytes (due to missing preceding msg(s))\", nbytes);",
      "",
      "[Removed Lines]",
      "5806:    parse_RowsBuffer(tvb, offset, num_rows, bindingsin, rowsin, b_64bit_mode, tree, \"Rows\");",
      "",
      "[Added Lines]",
      "5719:    parse_RowsBuffer(tvb, pinfo, offset, num_rows, bindingsin, rowsin, b_64bit_mode, tree, \"Rows\");",
      "",
      "---------------",
      "--- Hunk 52 ---",
      "[Context before]",
      "5950:          sizeof(struct CTableColumn) * num);",
      "5951:   for (n=0; n<num; n++) {",
      "5952:    offset = parse_padding(tvb, offset, 4, pad_tree, \"padding_aColumns[%u]\", n);",
      "5954:   }",
      "5955:   data = find_or_create_message_data(ct, pinfo,0xD0,in, private_data);",
      "5956:   if (data) {",
      "",
      "[Removed Lines]",
      "5953:    offset = parse_CTableColumn(tvb, offset, tree, pad_tree, &request.acolumns[n],\"aColumns[%u]\", n);",
      "",
      "[Added Lines]",
      "5866:    offset = parse_CTableColumn(tvb, pinfo, offset, tree, pad_tree, &request.acolumns[n],\"aColumns[%u]\", n);",
      "",
      "---------------",
      "--- Hunk 53 ---",
      "[Context before]",
      "8051:  };",
      "8053:  static ei_register_info ei[] = {",
      "8054:   { &ei_missing_msg_context, { \"mswsp.msg.cpmgetrows.missing_msg_context\", PI_SEQUENCE, PI_WARN, \"previous messages needed for context not captured\", EXPFILL }},",
      "8055:   { &ei_mswsp_msg_cpmsetbinding_ccolumns, { \"mswsp.msg.cpmsetbinding.ccolumns.invalude\", PI_PROTOCOL, PI_WARN, \"Invalid number of cColumns for packet\", EXPFILL }}",
      "8056:  };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "7967:   { &ei_mswsp_invalid_variant_type, { \"mswsp.invalid_variant_type\", PI_PROTOCOL, PI_ERROR, \"Invalid variant type\", EXPFILL }},",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e2bc6abff0e3b8e3a5ad70e13f089c26f409ad8f",
      "candidate_info": {
        "commit_hash": "e2bc6abff0e3b8e3a5ad70e13f089c26f409ad8f",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/e2bc6abff0e3b8e3a5ad70e13f089c26f409ad8f",
        "files": [
          "epan/dissectors/packet-mswsp.c"
        ],
        "message": "Fix handling of invalid type values.\n\nIf vType_get_type() returns NULL, that means that the packet is bad, not\nthat the dissector is bad.  Report it as such.\n\nBug: 15119\nChange-Id: I8e66fcece2b526ef9edbf948862f8fc5bea25d74\nReviewed-on: https://code.wireshark.org/review/29511\nReviewed-by: Guy Harris <guy@alum.mit.edu>\n(cherry picked from commit f4d2dffd8be1df30a832647a2f188507076f0fed)\nReviewed-on: https://code.wireshark.org/review/29514",
        "before_after_code_files": [
          "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
          ],
          "candidate": [
            "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c": [
          "File: epan/dissectors/packet-mswsp.c -> epan/dissectors/packet-mswsp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "372: void proto_reg_handoff_mswsp(void);",
          "374: static expert_field ei_missing_msg_context = EI_INIT;",
          "375: static expert_field ei_mswsp_msg_cpmsetbinding_ccolumns = EI_INIT;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "374: static expert_field ei_mswsp_invalid_variant_type = EI_INIT;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3086: static int parse_CFullPropSpec(tvbuff_t *tvb, int offset, proto_tree *tree, proto_tree *pad_tree, struct CFullPropSpec *v, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3083: static int parse_CBaseStorageVariant(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CBaseStorageVariant *value, const char *text);",
          "",
          "[Added Lines]",
          "3084: static int parse_CBaseStorageVariant(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CBaseStorageVariant *value, const char *text);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3092: static int parse_CNatLanguageRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNatLanguageRestriction *v, const char *fmt, ...);",
          "3101: static int parse_CReuseWhere(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CReuseWhere *v, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3095: static int parse_CNodeRestriction(tvbuff_t *tvb, int offset, proto_tree *tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char* fmt, ...);",
          "3098: static int parse_CPropertyRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3096: static int parse_CNodeRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char* fmt, ...);",
          "3099: static int parse_CPropertyRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "3104: static int parse_CSort(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, const char *fmt, ...);",
          "3115: static int parse_CColumnSet(tvbuff_t *tvb, int offset, proto_tree *tree, const char *fmt, ...);",
          "3130: static int parse_CAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3107: static int parse_CCoercionRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...);",
          "3109: static int parse_CRestrictionArray(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3112: static int parse_CRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...);",
          "3118: static int parse_CCategorizationSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3121: static int parse_CCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3124: static int parse_CRangeCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3127: static int parse_RANGEBOUNDARY(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3108: static int parse_CCoercionRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...);",
          "3110: static int parse_CRestrictionArray(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3113: static int parse_CRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...);",
          "3119: static int parse_CCategorizationSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3122: static int parse_CCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3125: static int parse_CRangeCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3128: static int parse_RANGEBOUNDARY(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "3139: static int parse_CAggregSortKey(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3148: static int parse_CDbColId(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *text);",
          "3157: static int parse_CPidMapper(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3142: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3145: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3151: static int parse_CDbProp(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...);",
          "3154: static int parse_CDbPropSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3143: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3146: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3152: static int parse_CDbProp(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...);",
          "3155: static int parse_CDbPropSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3169: static int parse_CSortSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3172: static int parse_CTableColumn(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3173: static int parse_CTableColumn(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "3243:  return offset;",
          "3244: }",
          "3247: {",
          "3251:  proto_tree *tree;",
          "3252:  va_list ap;",
          "3253:  struct vtype_data *type;",
          "",
          "[Removed Lines]",
          "3246: static int parse_CTableColumn(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...)",
          "3250:  proto_item *item;",
          "",
          "[Added Lines]",
          "3247: static int parse_CTableColumn(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...)",
          "3251:  proto_item *item, *ti_type;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "3278:   }",
          "3279:  }",
          "3280:  type = vType_get_type(vtype_val);",
          "3283:  offset += 4;",
          "3285:  used = tvb_get_guint8(tvb, offset);",
          "",
          "[Removed Lines]",
          "3281:  DISSECTOR_ASSERT(type != NULL);",
          "3282:  proto_tree_add_string_format_value(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, type->str, \"%s%s\", type->str, modifier);",
          "",
          "[Added Lines]",
          "3282:  if (type == NULL) {",
          "3286:   ti_type = proto_tree_add_string(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, \"Unknown CTableColumn type\");",
          "3287:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "3288:  } else",
          "3289:   proto_tree_add_string_format_value(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, type->str, \"%s%s\", type->str, modifier);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "3499:  }",
          "3500:  return offset + 4;",
          "3501: }",
          "3503: {",
          "3504:  proto_tree *tree;",
          "3505:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3502: static int parse_CPropertyRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3509: static int parse_CPropertyRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3518:  offset = parse_CFullPropSpec(tvb, offset, tree, pad_tree, &v->property, \"Property\");",
          "3522:  offset = parse_padding(tvb, offset, 4, pad_tree, \"padding_lcid\");",
          "",
          "[Removed Lines]",
          "3520:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &v->prval, \"prval\");",
          "",
          "[Added Lines]",
          "3527:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &v->prval, \"prval\");",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "3529:  return offset;",
          "3530: }",
          "3533: {",
          "3534:  proto_tree *tree;",
          "3535:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3532: static int parse_CCoercionRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3539: static int parse_CCoercionRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "3548:  offset += 4;",
          "3552:  proto_item_set_end(item, tvb, offset);",
          "3553:  return offset;",
          "",
          "[Removed Lines]",
          "3550:  offset = parse_CRestriction(tvb, offset, tree, pad_tree, &v->child, \"child\");",
          "",
          "[Added Lines]",
          "3557:  offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &v->child, \"child\");",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "3744:  return offset + 4;",
          "3745: }",
          "3748: {",
          "3749:  proto_tree *tree;",
          "3750:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3747: static int parse_CRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3754: static int parse_CRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "3773:  case RTProximity:",
          "3774:  case RTPhrase: {",
          "3775:   v->u.RTAnd = EP_ALLOC(struct CNodeRestriction);",
          "3777:   break;",
          "3778:  }",
          "3779:  case RTNot: {",
          "3780:   v->u.RTNot = EP_ALLOC(struct CRestriction);",
          "3782:          v->u.RTNot, \"CRestriction\");",
          "3783:   break;",
          "3784:  }",
          "3785:  case RTProperty: {",
          "3786:   v->u.RTProperty = EP_ALLOC(struct CPropertyRestriction);",
          "3788:            v->u.RTProperty, \"CPropertyRestriction\");",
          "3789:   break;",
          "3790:  }",
          "",
          "[Removed Lines]",
          "3776:   offset = parse_CNodeRestriction(tvb, offset, tree, pad_tree, v->u.RTAnd, \"CNodeRestriction\");",
          "3781:   offset = parse_CRestriction(tvb, offset, tree, pad_tree,",
          "3787:   offset = parse_CPropertyRestriction(tvb, offset, tree, pad_tree,",
          "",
          "[Added Lines]",
          "3783:   offset = parse_CNodeRestriction(tvb, pinfo, offset, tree, pad_tree, v->u.RTAnd, \"CNodeRestriction\");",
          "3788:   offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "3794:   offset = parse_CPropertyRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "3792:  case RTCoerce_Multiply:",
          "3793:  case RTCoerce_Absolute: {",
          "3794:   v->u.RTCoerce_Add = EP_ALLOC(struct CCoercionRestriction);",
          "3796:            v->u.RTCoerce_Add, \"CCoercionRestriction\");",
          "3797:   break;",
          "3798:  }",
          "",
          "[Removed Lines]",
          "3795:   offset = parse_CCoercionRestriction(tvb, offset, tree, pad_tree,",
          "",
          "[Added Lines]",
          "3802:   offset = parse_CCoercionRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "3822:  return offset;",
          "3823: }",
          "3826: {",
          "3827:  guint8 present, count;",
          "",
          "[Removed Lines]",
          "3825: static int parse_CRestrictionArray(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3832: static int parse_CRestrictionArray(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "3853:   for (i=0; i<count; i++) {",
          "3854:    struct CRestriction r;",
          "3856:   }",
          "3857:  }",
          "3858:  proto_item_set_end(item, tvb, offset);",
          "3859:  return offset;",
          "3860: }",
          "3863: {",
          "3864:  proto_tree *tree;",
          "3865:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3855:    offset = parse_CRestriction(tvb, offset, tree, pad_tree, &r, \"Restriction[%d]\", i);",
          "3862: static int parse_CNodeRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3862:    offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &r, \"Restriction[%d]\", i);",
          "3869: static int parse_CNodeRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "3879:  for (i=0; i<v->cNode; i++) {",
          "3880:   struct CRestriction r;",
          "3881:   ZERO_STRUCT(r);",
          "3885:  }",
          "",
          "[Removed Lines]",
          "3882:   offset = parse_CRestriction(tvb, offset, tree, pad_tree, &r, \"paNode[%u]\", i);",
          "",
          "[Added Lines]",
          "3889:   offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &r, \"paNode[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "4220:  return wmem_strbuf_get_str(strbuf);",
          "4221: }",
          "4334: {",
          "4335:  int i, len;",
          "4336:  proto_item *ti, *ti_type, *ti_val;",
          "",
          "[Removed Lines]",
          "4223: static int parse_vType(tvbuff_t *tvb, int offset, guint16 *vtype)",
          "4224: {",
          "4225:  guint16 tmp_vtype = tvb_get_letohs(tvb, offset);",
          "4226:  guint16 modifier =  tmp_vtype & 0xFF00;",
          "4228:  switch (tmp_vtype & 0xFF) {",
          "4229:   case VT_EMPTY:",
          "4231:    break;",
          "4232:   case VT_NULL:",
          "4234:    break;",
          "4235:   case VT_I2:",
          "4237:    break;",
          "4238:   case VT_I4:",
          "4240:    break;",
          "4241:   case VT_R4:",
          "4243:    break;",
          "4244:   case VT_R8:",
          "4246:    break;",
          "4247:   case VT_CY:",
          "4249:    break;",
          "4250:   case VT_DATE:",
          "4252:    break;",
          "4253:   case VT_BSTR:",
          "4255:    break;",
          "4256:   case VT_ERROR:",
          "4258:    break;",
          "4259:   case VT_BOOL:",
          "4261:    break;",
          "4262:   case VT_VARIANT:",
          "4264:    break;",
          "4265:   case VT_DECIMAL:",
          "4267:    break;",
          "4268:   case VT_I1:",
          "4270:    break;",
          "4271:   case VT_UI1:",
          "4273:    break;",
          "4274:   case VT_UI2:",
          "4276:    break;",
          "4277:   case VT_UI4:",
          "4279:    break;",
          "4280:   case VT_I8:",
          "4282:    break;",
          "4283:   case VT_UI8:",
          "4285:    break;",
          "4286:   case VT_INT:",
          "4288:    break;",
          "4289:   case VT_UINT:",
          "4291:    break;",
          "4292:   case VT_LPSTR:",
          "4294:    break;",
          "4295:   case VT_LPWSTR:",
          "4297:    break;",
          "4298:   case VT_COMPRESSED_LPWSTR:",
          "4300:    break;",
          "4301:   case VT_FILETIME:",
          "4303:    break;",
          "4304:   case VT_BLOB:",
          "4306:    break;",
          "4307:   case VT_BLOB_OBJECT:",
          "4309:    break;",
          "4310:   case VT_CLSID:",
          "4312:    break;",
          "4313:   default:",
          "4314:    DISSECTOR_ASSERT(FALSE);",
          "4315:    break;",
          "4316:  }",
          "4317:  if (modifier) {",
          "4318:   switch (modifier) {",
          "4319:    case VT_VECTOR:",
          "4321:     break;",
          "4322:    case VT_ARRAY:",
          "4324:     break;",
          "4325:    default:",
          "4326:     DISSECTOR_ASSERT(FALSE);",
          "4327:     break;",
          "4328:   }",
          "4329:  }",
          "4330:  return offset + 2;",
          "4331: }",
          "4333: static int parse_CBaseStorageVariant(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CBaseStorageVariant *value, const char *text)",
          "",
          "[Added Lines]",
          "4230: static int parse_CBaseStorageVariant(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CBaseStorageVariant *value, const char *text)",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "4342:  tree = proto_tree_add_subtree(parent_tree, tvb, offset, 0, ett_CBaseStorageVariant, &ti, text);",
          "4348:  ti_type = proto_tree_add_string(tree, hf_mswsp_cbasestorvariant_vtype, tvb, offset, 2, value->type->str);",
          "4349:  offset += 2;",
          "",
          "[Removed Lines]",
          "4344:  parse_vType(tvb, offset, &value->vType);",
          "4345:  value->type = vType_get_type(value->vType);",
          "4346:  DISSECTOR_ASSERT(value->type != NULL);",
          "",
          "[Added Lines]",
          "4241:  value->vType = tvb_get_letohs(tvb, offset);",
          "4242:  value->type = vType_get_type(value->vType & 0xFF);",
          "4243:  if (value->type == NULL) {",
          "4247:   ti_type = proto_tree_add_string(tree, hf_mswsp_cbasestorvariant_vtype, tvb, offset, 2, \"Unknown CBaseStorageVariant type\");",
          "4248:   offset += 2;",
          "4249:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "4251:   THROW_MESSAGE(ReportedBoundsError, \"Unknown CBaseStorageVariant type\");",
          "4252:   return offset;",
          "4253:  }",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "4464:  return offset;",
          "4465: }",
          "4468: {",
          "4469:  static const value_string EMPTY_VS[] = {{0, NULL}};",
          "4470:  const value_string *vs = (propset && propset->id_map) ? propset->id_map : EMPTY_VS;",
          "",
          "[Removed Lines]",
          "4467: static int parse_CDbProp(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4374: static int parse_CDbProp(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "4498:  offset = parse_CDbColId(tvb, offset, tree, pad_tree, \"colid\");",
          "4502:  str = str_CBaseStorageVariant(&value, TRUE);",
          "4503:  proto_item_append_text(item, \" %s\", str);",
          "",
          "[Removed Lines]",
          "4500:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &value, \"vValue\");",
          "",
          "[Added Lines]",
          "4407:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &value, \"vValue\");",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "4506:  return offset;",
          "4507: }",
          "4510: {",
          "4511:  int i, num;",
          "4512:  e_guid_t guid;",
          "",
          "[Removed Lines]",
          "4509: static int parse_CDbPropSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4416: static int parse_CDbPropSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "4543:  for (i = 0; i<num; i++) {",
          "4544:   offset = parse_padding(tvb, offset, 4, pad_tree, \"aProp[%d]\", i);",
          "4546:  }",
          "4548:  proto_item_set_end(item, tvb, offset);",
          "4549:  return offset;",
          "4550: }",
          "4553: {",
          "4554:  const int offset_in = offset;",
          "4555:  guint32 size, num;",
          "",
          "[Removed Lines]",
          "4545:   offset = parse_CDbProp(tvb, offset, tree, pad_tree, pset, \"aProp[%d]\", i);",
          "4552: static int parse_PropertySetArray(tvbuff_t *tvb, int offset, int size_offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4452:   offset = parse_CDbProp(tvb, pinfo, offset, tree, pad_tree, pset, \"aProp[%d]\", i);",
          "4459: static int parse_PropertySetArray(tvbuff_t *tvb, packet_info *pinfo, int offset, int size_offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "4575:  offset += 4;",
          "4577:  for (i = 0; i < (int)num; i++) {",
          "4579:  }",
          "4581:  proto_item_set_end(item, tvb, offset);",
          "",
          "[Removed Lines]",
          "4578:   offset = parse_CDbPropSet(tvb, offset, tree, pad_tree, \"PropertySet[%d]\", i);",
          "",
          "[Added Lines]",
          "4485:   offset = parse_CDbPropSet(tvb, pinfo, offset, tree, pad_tree, \"PropertySet[%d]\", i);",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "4613: }",
          "4617: {",
          "4618:  guint32 ulType;",
          "4619:  guint8 labelPresent;",
          "",
          "[Removed Lines]",
          "4616: int parse_RANGEBOUNDARY(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4523: int parse_RANGEBOUNDARY(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "4634:  offset += 4;",
          "4636:  ZERO_STRUCT(prval);",
          "4639:  labelPresent = tvb_get_guint8(tvb, offset);",
          "4640:  proto_tree_add_item(tree, hf_mswsp_rangeboundry_labelpresent, tvb, offset, 1, ENC_LITTLE_ENDIAN);",
          "",
          "[Removed Lines]",
          "4637:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &prval, \"prVal\");",
          "",
          "[Added Lines]",
          "4544:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &prval, \"prVal\");",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "4666: {",
          "4667:  proto_item *item;",
          "4668:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4665: int parse_CRangeCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4572: int parse_CRangeCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "4683:  offset += 4;",
          "4685:  for (i=0; i<cRange; i++) {",
          "4688:  }",
          "",
          "[Removed Lines]",
          "4686:   offset = parse_RANGEBOUNDARY(tvb, offset, tree, pad_tree, \"aRangeBegin[%u]\", i);",
          "",
          "[Added Lines]",
          "4593:   offset = parse_RANGEBOUNDARY(tvb, pinfo, offset, tree, pad_tree, \"aRangeBegin[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "4692: }",
          "4696: {",
          "4697:  proto_item *item;",
          "4698:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4695: int parse_CCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4602: int parse_CCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "4713:  offset = parse_CSort(tvb, offset, tree, pad_tree, \"CSort\");",
          "4717:  proto_item_set_end(item, tvb, offset);",
          "4718:  return offset;",
          "",
          "[Removed Lines]",
          "4715:  offset = parse_CRangeCategSpec(tvb, offset, tree, pad_tree, \"CRangeCategSpec\");",
          "",
          "[Added Lines]",
          "4622:  offset = parse_CRangeCategSpec(tvb, pinfo, offset, tree, pad_tree, \"CRangeCategSpec\");",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "4879: }",
          "4883: {",
          "4884:  proto_item *item;",
          "4885:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4882: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4789: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "4898:  if (type == GroupIdValue) {",
          "4899:   struct CBaseStorageVariant id;",
          "4901:  }",
          "4903:  offset = parse_CSortSet(tvb, offset, tree, pad_tree, \"SortSet\");",
          "",
          "[Removed Lines]",
          "4900:   offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &id, \"inGroupId\");",
          "",
          "[Added Lines]",
          "4807:   offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &id, \"inGroupId\");",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "4912: {",
          "4913:  guint32 cCount, i;",
          "4914:  proto_item *item;",
          "",
          "[Removed Lines]",
          "4911: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4818: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "4929:  for (i=0; i<cCount; i++) {",
          "4932:  }",
          "4934:  proto_item_set_end(item, tvb, offset);",
          "",
          "[Removed Lines]",
          "4931:   offset = parse_CInGroupSortAggregSet(tvb, offset, tree, pad_tree, \"SortSets[%u]\", i);",
          "",
          "[Added Lines]",
          "4838:   offset = parse_CInGroupSortAggregSet(tvb, pinfo, offset, tree, pad_tree, \"SortSets[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "4936: }",
          "4940: {",
          "4941:  proto_item *item;",
          "4942:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4939: int parse_CCategorizationSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4846: int parse_CCategorizationSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "4953:  offset = parse_CColumnSet(tvb, offset, tree, \"csColumns\");",
          "4959:  offset = parse_CAggregSet(tvb, offset, tree, pad_tree, \"AggregSet\");",
          "",
          "[Removed Lines]",
          "4956:  offset = parse_CCategSpec(tvb, offset, tree, pad_tree, \"Spec\");",
          "",
          "[Added Lines]",
          "4863:  offset = parse_CCategSpec(tvb, pinfo, offset, tree, pad_tree, \"Spec\");",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "4962:  offset = parse_CSortAggregSet(tvb, offset, tree, pad_tree, \"SortAggregSet\");",
          "4967:  proto_tree_add_item(tree, hf_mswsp_categorizationspec_cmaxres, tvb, offset, 4, ENC_LITTLE_ENDIAN);",
          "4968:  offset += 4;",
          "",
          "[Removed Lines]",
          "4965:  offset = parse_CInGroupSortAggregSets(tvb, offset, tree, pad_tree, \"InGroupSortAggregSets\");",
          "",
          "[Added Lines]",
          "4872:  offset = parse_CInGroupSortAggregSets(tvb, pinfo, offset, tree, pad_tree, \"InGroupSortAggregSets\");",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "5285:  return offset;",
          "5286: }",
          "5289: {",
          "5290:  guint32 i = 0;",
          "5291:  guint64 count = 0;",
          "5292:  int buf_offset = 0;",
          "5293:  proto_tree *sub_tree;",
          "5296:  wmem_strbuf_t *strbuf;",
          "5299:  offset = parse_CRowVariantArrayInfo(tvb, offset, tree, is_64bit, variant);",
          "5300:  if (is_64bit) {",
          "5301:   buf_offset =",
          "",
          "[Removed Lines]",
          "5288: static int parse_VariantColVector(tvbuff_t *tvb, int offset, proto_tree *tree, guint64 base_address, gboolean is_64bit, struct CRowVariant *variant)",
          "5294:  struct vtype_data *vt_list_type =",
          "5295:   vType_get_type((enum vType)(variant->vtype & 0x00FF));",
          "5298:  DISSECTOR_ASSERT(vt_list_type != NULL);",
          "",
          "[Added Lines]",
          "5195: static int parse_VariantColVector(tvbuff_t *tvb, int offset, proto_tree *tree, guint64 base_address, gboolean is_64bit, struct CRowVariant *variant, struct vtype_data *vt_list_type)",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "5347:  return offset;",
          "5348: }",
          "5351: {",
          "5352:  proto_tree *tree;",
          "5355:  va_list ap;",
          "5356:  struct vtype_data *vt_type;",
          "",
          "[Removed Lines]",
          "5350: static int parse_VariantCol(tvbuff_t *tvb, int offset, proto_tree *parent_tree, guint64 base_address, guint32 length _U_, gboolean is_64bit, struct CRowVariant *variant, const char *fmt, ...)",
          "5353:  proto_item *item;",
          "",
          "[Added Lines]",
          "5254: static int parse_VariantCol(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, guint64 base_address, guint32 length _U_, gboolean is_64bit, struct CRowVariant *variant, const char *fmt, ...)",
          "5257:  proto_item *item, *ti_type;",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "5367:  variant->vtype = tvb_get_letohs(tvb, offset);",
          "5368:  vt_type = vType_get_type((enum vType)variant->vtype);",
          "5371:  vtype_high = (variant->vtype & 0xFF00);",
          "5372:  if (vtype_high) {",
          "5373:   if (vtype_high == VT_VECTOR) {",
          "",
          "[Removed Lines]",
          "5369:  DISSECTOR_ASSERT(vt_type != NULL);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "5379:   }",
          "5380:  }",
          "5382:  proto_tree_add_string_format_value(tree, hf_mswsp_rowvariant_vtype, tvb, offset, 2, vt_type->str, \"%s%s\", vt_type->str, modifier);",
          "5383:  offset += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5284:  if (vt_type == NULL) {",
          "5288:   ti_type = proto_tree_add_string(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, \"Unknown variant column type\");",
          "5289:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "5290:   offset += 2;",
          "5292:   THROW_FORMATTED(ReportedBoundsError, \"Unknown variant column type%s\", modifier);",
          "5293:   return offset;",
          "5294:  }",
          "",
          "---------------",
          "--- Hunk 43 ---",
          "[Context before]",
          "5395:  if (vtype_high == VT_VECTOR || vtype_high == VT_ARRAY) {",
          "5396:   offset = parse_VariantColVector(tvb, offset, tree, base_address,",
          "5398:  } else {",
          "5399:   wmem_strbuf_t *strbuf = wmem_strbuf_new(wmem_packet_scope(), \"\");",
          "5400:   if (size != -1) {",
          "",
          "[Removed Lines]",
          "5397:           is_64bit, variant);",
          "",
          "[Added Lines]",
          "5310:           is_64bit, variant, vt_type);",
          "",
          "---------------",
          "--- Hunk 44 ---",
          "[Context before]",
          "5433:  return offset;",
          "5434: }",
          "5437: {",
          "5438:  proto_tree *tree;",
          "5439:  proto_item *item;",
          "",
          "[Removed Lines]",
          "5436: static int parse_RowsBufferCol(tvbuff_t *tvb, int offset, guint32 row, guint32 col, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean b_is_64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "5349: static int parse_RowsBufferCol(tvbuff_t *tvb, packet_info *pinfo, int offset, guint32 row, guint32 col, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean b_is_64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 45 ---",
          "[Context before]",
          "5475:    len = tvb_get_letohs(tvb, buf_offset + pcol->lengthoffset) - pcol->valuesize;",
          "5476:   }",
          "5477:   if (pcol->vtype == VT_VARIANT) {",
          "5479:   }",
          "5480:  }",
          "5481:  return offset;",
          "5482: }",
          "5485: {",
          "5486:  proto_tree *tree;",
          "5487:  proto_item *item;",
          "",
          "[Removed Lines]",
          "5478:    parse_VariantCol(tvb, tmp_offset, tree, base_address, len, b_is_64bit, &variant, \"CRowVariant\");",
          "5484: static int parse_RowsBuffer(tvbuff_t *tvb, int offset, guint32 num_rows, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean is64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "5391:    parse_VariantCol(tvb, pinfo, tmp_offset, tree, base_address, len, b_is_64bit, &variant, \"CRowVariant\");",
          "5397: static int parse_RowsBuffer(tvbuff_t *tvb, packet_info *pinfo, int offset, guint32 num_rows, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean is64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 46 ---",
          "[Context before]",
          "5500:   proto_tree *row_tree;",
          "5501:   row_tree = proto_tree_add_subtree_format(tree, tvb, offset, 0, ett_GetRowsRow, NULL, \"Row[%d]\", num);",
          "5502:   for (col = 0; col < bindingsin->ccolumns; col++) {",
          "5504:   }",
          "5505:  }",
          "5506:  return offset;",
          "",
          "[Removed Lines]",
          "5503:    parse_RowsBufferCol(tvb, offset, num, col, bindingsin, rowsin, is64bit, row_tree, \"Col[%d]\", col);",
          "",
          "[Added Lines]",
          "5416:    parse_RowsBufferCol(tvb, pinfo, offset, num, col, bindingsin, rowsin, is64bit, row_tree, \"Col[%d]\", col);",
          "",
          "---------------",
          "--- Hunk 47 ---",
          "[Context before]",
          "5570:   offset = parse_padding(tvb, offset, 8, pad_tree, \"_paddingcPropSets\");",
          "5574:   offset = parse_padding(tvb, offset, 8, pad_tree, \"paddingExtPropset\");",
          "5578:   offset = parse_padding(tvb, offset, 8, pad_tree, \"???\");",
          "",
          "[Removed Lines]",
          "5572:   offset = parse_PropertySetArray(tvb, offset, blob_size1_off, tree, pad_tree, \"PropSets\");",
          "5576:   offset = parse_PropertySetArray(tvb, offset, blob_size2_off, tree, pad_tree, \"ExtPropset\");",
          "",
          "[Added Lines]",
          "5485:   offset = parse_PropertySetArray(tvb, pinfo, offset, blob_size1_off, tree, pad_tree, \"PropSets\");",
          "5489:   offset = parse_PropertySetArray(tvb, pinfo, offset, blob_size2_off, tree, pad_tree, \"ExtPropset\");",
          "",
          "---------------",
          "--- Hunk 48 ---",
          "[Context before]",
          "5628:   offset += 1;",
          "5630:   if (CRestrictionPresent) {",
          "5632:   }",
          "5634:   CSortSetPresent = tvb_get_guint8(tvb, offset);",
          "",
          "[Removed Lines]",
          "5631:    offset = parse_CRestrictionArray(tvb, offset, tree, pad_tree, \"RestrictionArray\");",
          "",
          "[Added Lines]",
          "5544:    offset = parse_CRestrictionArray(tvb, pinfo, offset, tree, pad_tree, \"RestrictionArray\");",
          "",
          "---------------",
          "--- Hunk 49 ---",
          "[Context before]",
          "5638:   if (CSortSetPresent) {",
          "5639:    offset = parse_padding(tvb, offset, 4, tree, \"paddingCSortSetPresent\");",
          "5642:   }",
          "",
          "[Removed Lines]",
          "5640:    offset = parse_CInGroupSortAggregSets(tvb, offset, tree, pad_tree, \"GroupSortAggregSets\");",
          "",
          "[Added Lines]",
          "5553:    offset = parse_CInGroupSortAggregSets(tvb, pinfo, offset, tree, pad_tree, \"GroupSortAggregSets\");",
          "",
          "---------------",
          "--- Hunk 50 ---",
          "[Context before]",
          "5653:    proto_tree_add_uint(tree, hf_mswsp_msg_cpmcreatequery_ccateg_count, tvb, offset, 4, count);",
          "5654:    offset += 4;",
          "5655:    for (i=0; i<count; i++) {",
          "5657:    }",
          "5658:   }",
          "",
          "[Removed Lines]",
          "5656:     offset = parse_CCategorizationSpec(tvb, offset, tree, pad_tree, \"categories[%u]\", i);",
          "",
          "[Added Lines]",
          "5569:     offset = parse_CCategorizationSpec(tvb, pinfo, offset, tree, pad_tree, \"categories[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 51 ---",
          "[Context before]",
          "5815:   if (b_has_arch && bindingsin && rowsin) {",
          "5816:    offset = parse_padding(tvb, offset, rowsin->cbreserved, pad_tree,",
          "5817:            \"paddingRows\");",
          "5819:   } else {",
          "5820:    gint nbytes = tvb_reported_length_remaining(tvb, offset);",
          "5821:    proto_tree_add_expert_format(tree, pinfo, &ei_missing_msg_context, tvb, offset, nbytes, \"Undissected %d bytes (due to missing preceding msg(s))\", nbytes);",
          "",
          "[Removed Lines]",
          "5818:    parse_RowsBuffer(tvb, offset, num_rows, bindingsin, rowsin, b_64bit_mode, tree, \"Rows\");",
          "",
          "[Added Lines]",
          "5731:    parse_RowsBuffer(tvb, pinfo, offset, num_rows, bindingsin, rowsin, b_64bit_mode, tree, \"Rows\");",
          "",
          "---------------",
          "--- Hunk 52 ---",
          "[Context before]",
          "5962:          sizeof(struct CTableColumn) * num);",
          "5963:   for (n=0; n<num; n++) {",
          "5964:    offset = parse_padding(tvb, offset, 4, pad_tree, \"padding_aColumns[%u]\", n);",
          "5966:   }",
          "5967:   data = find_or_create_message_data(ct, pinfo,0xD0,in, private_data);",
          "5968:   if (data) {",
          "",
          "[Removed Lines]",
          "5965:    offset = parse_CTableColumn(tvb, offset, tree, pad_tree, &request.acolumns[n],\"aColumns[%u]\", n);",
          "",
          "[Added Lines]",
          "5878:    offset = parse_CTableColumn(tvb, pinfo, offset, tree, pad_tree, &request.acolumns[n],\"aColumns[%u]\", n);",
          "",
          "---------------",
          "--- Hunk 53 ---",
          "[Context before]",
          "8063:  };",
          "8065:  static ei_register_info ei[] = {",
          "8066:   { &ei_missing_msg_context, { \"mswsp.msg.cpmgetrows.missing_msg_context\", PI_SEQUENCE, PI_WARN, \"previous messages needed for context not captured\", EXPFILL }},",
          "8067:   { &ei_mswsp_msg_cpmsetbinding_ccolumns, { \"mswsp.msg.cpmsetbinding.ccolumns.invalude\", PI_PROTOCOL, PI_WARN, \"Invalid number of cColumns for packet\", EXPFILL }}",
          "8068:  };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7979:   { &ei_mswsp_invalid_variant_type, { \"mswsp.invalid_variant_type\", PI_PROTOCOL, PI_ERROR, \"Invalid variant type\", EXPFILL }},",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d443be449a52f95df5754adc39e1f3472fec2f03",
      "candidate_info": {
        "commit_hash": "d443be449a52f95df5754adc39e1f3472fec2f03",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/d443be449a52f95df5754adc39e1f3472fec2f03",
        "files": [
          "epan/dissectors/packet-mswsp.c"
        ],
        "message": "Fix handling of invalid type values.\n\nIf vType_get_type() returns NULL, that means that the packet is bad, not\nthat the dissector is bad.  Report it as such.\n\nBug: 15119\nChange-Id: I8e66fcece2b526ef9edbf948862f8fc5bea25d74\nReviewed-on: https://code.wireshark.org/review/29511\nReviewed-by: Guy Harris <guy@alum.mit.edu>\n(cherry picked from commit f4d2dffd8be1df30a832647a2f188507076f0fed)\nReviewed-on: https://code.wireshark.org/review/29515",
        "before_after_code_files": [
          "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
          ],
          "candidate": [
            "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c": [
          "File: epan/dissectors/packet-mswsp.c -> epan/dissectors/packet-mswsp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "341: void proto_reg_handoff_mswsp(void);",
          "343: static expert_field ei_missing_msg_context = EI_INIT;",
          "344: static expert_field ei_mswsp_msg_cpmsetbinding_ccolumns = EI_INIT;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "343: static expert_field ei_mswsp_invalid_variant_type = EI_INIT;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3053: static int parse_CFullPropSpec(tvbuff_t *tvb, int offset, proto_tree *tree, proto_tree *pad_tree, struct CFullPropSpec *v, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3050: static int parse_CBaseStorageVariant(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CBaseStorageVariant *value, const char *text);",
          "",
          "[Added Lines]",
          "3051: static int parse_CBaseStorageVariant(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CBaseStorageVariant *value, const char *text);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3059: static int parse_CNatLanguageRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNatLanguageRestriction *v, const char *fmt, ...);",
          "3068: static int parse_CReuseWhere(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CReuseWhere *v, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3062: static int parse_CNodeRestriction(tvbuff_t *tvb, int offset, proto_tree *tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char* fmt, ...);",
          "3065: static int parse_CPropertyRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3063: static int parse_CNodeRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char* fmt, ...);",
          "3066: static int parse_CPropertyRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "3071: static int parse_CSort(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, const char *fmt, ...);",
          "3082: static int parse_CColumnSet(tvbuff_t *tvb, int offset, proto_tree *tree, const char *fmt, ...);",
          "3097: static int parse_CAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3074: static int parse_CCoercionRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...);",
          "3076: static int parse_CRestrictionArray(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3079: static int parse_CRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...);",
          "3085: static int parse_CCategorizationSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3088: static int parse_CCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3091: static int parse_CRangeCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3094: static int parse_RANGEBOUNDARY(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3075: static int parse_CCoercionRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...);",
          "3077: static int parse_CRestrictionArray(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3080: static int parse_CRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...);",
          "3086: static int parse_CCategorizationSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3089: static int parse_CCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3092: static int parse_CRangeCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3095: static int parse_RANGEBOUNDARY(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "3106: static int parse_CAggregSortKey(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3115: static int parse_CDbColId(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *text);",
          "3124: static int parse_CPidMapper(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3109: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3112: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3118: static int parse_CDbProp(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...);",
          "3121: static int parse_CDbPropSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3110: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3113: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3119: static int parse_CDbProp(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...);",
          "3122: static int parse_CDbPropSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3136: static int parse_CSortSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3139: static int parse_CTableColumn(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3140: static int parse_CTableColumn(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "3210:  return offset;",
          "3211: }",
          "3214: {",
          "3215:  static const value_string DBAGGTTYPE[] = {",
          "3216:   {0x0, \"DBAGGTTYPE_BYNONE\"},",
          "",
          "[Removed Lines]",
          "3213: static int parse_CTableColumn(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3214: static int parse_CTableColumn(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "3228:   {0, NULL}",
          "3229:  };",
          "3232:  proto_tree *tree;",
          "3233:  va_list ap;",
          "3234:  struct vtype_data *type;",
          "",
          "[Removed Lines]",
          "3231:  proto_item *item;",
          "",
          "[Added Lines]",
          "3232:  proto_item *item, *ti_type;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "3259:   }",
          "3260:  }",
          "3261:  type = vType_get_type(vtype_val);",
          "3264:  offset += 4;",
          "3266:  used = tvb_get_guint8(tvb, offset);",
          "",
          "[Removed Lines]",
          "3262:  DISSECTOR_ASSERT(type != NULL);",
          "3263:  proto_tree_add_string_format_value(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, type->str, \"%s%s\", type->str, modifier);",
          "",
          "[Added Lines]",
          "3263:  if (type == NULL) {",
          "3267:   ti_type = proto_tree_add_string(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, \"Unknown CTableColumn type\");",
          "3268:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "3269:  } else",
          "3270:   proto_tree_add_string_format_value(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, type->str, \"%s%s\", type->str, modifier);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3480:  }",
          "3481:  return offset + 4;",
          "3482: }",
          "3484: {",
          "3485:  proto_tree *tree;",
          "3486:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3483: static int parse_CPropertyRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3490: static int parse_CPropertyRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "3499:  offset = parse_CFullPropSpec(tvb, offset, tree, pad_tree, &v->property, \"Property\");",
          "3503:  offset = parse_padding(tvb, offset, 4, pad_tree, \"padding_lcid\");",
          "",
          "[Removed Lines]",
          "3501:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &v->prval, \"prval\");",
          "",
          "[Added Lines]",
          "3508:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &v->prval, \"prval\");",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "3510:  return offset;",
          "3511: }",
          "3514: {",
          "3515:  proto_tree *tree;",
          "3516:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3513: static int parse_CCoercionRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3520: static int parse_CCoercionRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "3529:  offset += 4;",
          "3533:  proto_item_set_end(item, tvb, offset);",
          "3534:  return offset;",
          "",
          "[Removed Lines]",
          "3531:  offset = parse_CRestriction(tvb, offset, tree, pad_tree, &v->child, \"child\");",
          "",
          "[Added Lines]",
          "3538:  offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &v->child, \"child\");",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "3725:  return offset + 4;",
          "3726: }",
          "3729: {",
          "3730:  proto_tree *tree;",
          "3731:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3728: static int parse_CRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3735: static int parse_CRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "3754:  case RTProximity:",
          "3755:  case RTPhrase: {",
          "3756:   v->u.RTAnd = EP_ALLOC(struct CNodeRestriction);",
          "3758:   break;",
          "3759:  }",
          "3760:  case RTNot: {",
          "3761:   v->u.RTNot = EP_ALLOC(struct CRestriction);",
          "3763:          v->u.RTNot, \"CRestriction\");",
          "3764:   break;",
          "3765:  }",
          "3766:  case RTProperty: {",
          "3767:   v->u.RTProperty = EP_ALLOC(struct CPropertyRestriction);",
          "3769:            v->u.RTProperty, \"CPropertyRestriction\");",
          "3770:   break;",
          "3771:  }",
          "",
          "[Removed Lines]",
          "3757:   offset = parse_CNodeRestriction(tvb, offset, tree, pad_tree, v->u.RTAnd, \"CNodeRestriction\");",
          "3762:   offset = parse_CRestriction(tvb, offset, tree, pad_tree,",
          "3768:   offset = parse_CPropertyRestriction(tvb, offset, tree, pad_tree,",
          "",
          "[Added Lines]",
          "3764:   offset = parse_CNodeRestriction(tvb, pinfo, offset, tree, pad_tree, v->u.RTAnd, \"CNodeRestriction\");",
          "3769:   offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "3775:   offset = parse_CPropertyRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "3773:  case RTCoerce_Multiply:",
          "3774:  case RTCoerce_Absolute: {",
          "3775:   v->u.RTCoerce_Add = EP_ALLOC(struct CCoercionRestriction);",
          "3777:            v->u.RTCoerce_Add, \"CCoercionRestriction\");",
          "3778:   break;",
          "3779:  }",
          "",
          "[Removed Lines]",
          "3776:   offset = parse_CCoercionRestriction(tvb, offset, tree, pad_tree,",
          "",
          "[Added Lines]",
          "3783:   offset = parse_CCoercionRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "3803:  return offset;",
          "3804: }",
          "3807: {",
          "3808:  guint8 present, count;",
          "",
          "[Removed Lines]",
          "3806: static int parse_CRestrictionArray(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3813: static int parse_CRestrictionArray(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "3834:   for (i=0; i<count; i++) {",
          "3835:    struct CRestriction r;",
          "3837:   }",
          "3838:  }",
          "3839:  proto_item_set_end(item, tvb, offset);",
          "3840:  return offset;",
          "3841: }",
          "3844: {",
          "3845:  proto_tree *tree;",
          "3846:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3836:    offset = parse_CRestriction(tvb, offset, tree, pad_tree, &r, \"Restriction[%d]\", i);",
          "3843: static int parse_CNodeRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3843:    offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &r, \"Restriction[%d]\", i);",
          "3850: static int parse_CNodeRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "3860:  for (i=0; i<v->cNode; i++) {",
          "3861:   struct CRestriction r;",
          "3862:   ZERO_STRUCT(r);",
          "3866:  }",
          "",
          "[Removed Lines]",
          "3863:   offset = parse_CRestriction(tvb, offset, tree, pad_tree, &r, \"paNode[%u]\", i);",
          "",
          "[Added Lines]",
          "3870:   offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &r, \"paNode[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "4201:  return wmem_strbuf_get_str(strbuf);",
          "4202: }",
          "4315: {",
          "4316:  int i, len;",
          "4317:  proto_item *ti, *ti_type, *ti_val;",
          "",
          "[Removed Lines]",
          "4204: static int parse_vType(tvbuff_t *tvb, int offset, guint16 *vtype)",
          "4205: {",
          "4206:  guint16 tmp_vtype = tvb_get_letohs(tvb, offset);",
          "4207:  guint16 modifier =  tmp_vtype & 0xFF00;",
          "4209:  switch (tmp_vtype & 0xFF) {",
          "4210:   case VT_EMPTY:",
          "4212:    break;",
          "4213:   case VT_NULL:",
          "4215:    break;",
          "4216:   case VT_I2:",
          "4218:    break;",
          "4219:   case VT_I4:",
          "4221:    break;",
          "4222:   case VT_R4:",
          "4224:    break;",
          "4225:   case VT_R8:",
          "4227:    break;",
          "4228:   case VT_CY:",
          "4230:    break;",
          "4231:   case VT_DATE:",
          "4233:    break;",
          "4234:   case VT_BSTR:",
          "4236:    break;",
          "4237:   case VT_ERROR:",
          "4239:    break;",
          "4240:   case VT_BOOL:",
          "4242:    break;",
          "4243:   case VT_VARIANT:",
          "4245:    break;",
          "4246:   case VT_DECIMAL:",
          "4248:    break;",
          "4249:   case VT_I1:",
          "4251:    break;",
          "4252:   case VT_UI1:",
          "4254:    break;",
          "4255:   case VT_UI2:",
          "4257:    break;",
          "4258:   case VT_UI4:",
          "4260:    break;",
          "4261:   case VT_I8:",
          "4263:    break;",
          "4264:   case VT_UI8:",
          "4266:    break;",
          "4267:   case VT_INT:",
          "4269:    break;",
          "4270:   case VT_UINT:",
          "4272:    break;",
          "4273:   case VT_LPSTR:",
          "4275:    break;",
          "4276:   case VT_LPWSTR:",
          "4278:    break;",
          "4279:   case VT_COMPRESSED_LPWSTR:",
          "4281:    break;",
          "4282:   case VT_FILETIME:",
          "4284:    break;",
          "4285:   case VT_BLOB:",
          "4287:    break;",
          "4288:   case VT_BLOB_OBJECT:",
          "4290:    break;",
          "4291:   case VT_CLSID:",
          "4293:    break;",
          "4294:   default:",
          "4295:    DISSECTOR_ASSERT(FALSE);",
          "4296:    break;",
          "4297:  }",
          "4298:  if (modifier) {",
          "4299:   switch (modifier) {",
          "4300:    case VT_VECTOR:",
          "4302:     break;",
          "4303:    case VT_ARRAY:",
          "4305:     break;",
          "4306:    default:",
          "4307:     DISSECTOR_ASSERT(FALSE);",
          "4308:     break;",
          "4309:   }",
          "4310:  }",
          "4311:  return offset + 2;",
          "4312: }",
          "4314: static int parse_CBaseStorageVariant(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CBaseStorageVariant *value, const char *text)",
          "",
          "[Added Lines]",
          "4211: static int parse_CBaseStorageVariant(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CBaseStorageVariant *value, const char *text)",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "4323:  tree = proto_tree_add_subtree(parent_tree, tvb, offset, 0, ett_CBaseStorageVariant, &ti, text);",
          "4329:  ti_type = proto_tree_add_string(tree, hf_mswsp_cbasestorvariant_vtype, tvb, offset, 2, value->type->str);",
          "4330:  offset += 2;",
          "",
          "[Removed Lines]",
          "4325:  parse_vType(tvb, offset, &value->vType);",
          "4326:  value->type = vType_get_type(value->vType);",
          "4327:  DISSECTOR_ASSERT(value->type != NULL);",
          "",
          "[Added Lines]",
          "4222:  value->vType = tvb_get_letohs(tvb, offset);",
          "4223:  value->type = vType_get_type(value->vType & 0xFF);",
          "4224:  if (value->type == NULL) {",
          "4228:   ti_type = proto_tree_add_string(tree, hf_mswsp_cbasestorvariant_vtype, tvb, offset, 2, \"Unknown CBaseStorageVariant type\");",
          "4229:   offset += 2;",
          "4230:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "4232:   THROW_MESSAGE(ReportedBoundsError, \"Unknown CBaseStorageVariant type\");",
          "4233:   return offset;",
          "4234:  }",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "4445:  return offset;",
          "4446: }",
          "4449: {",
          "4450:  static const value_string EMPTY_VS[] = {{0, NULL}};",
          "4451:  const value_string *vs = (propset && propset->id_map) ? propset->id_map : EMPTY_VS;",
          "",
          "[Removed Lines]",
          "4448: static int parse_CDbProp(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4355: static int parse_CDbProp(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "4479:  offset = parse_CDbColId(tvb, offset, tree, pad_tree, \"colid\");",
          "4483:  str = str_CBaseStorageVariant(&value, TRUE);",
          "4484:  proto_item_append_text(item, \" %s\", str);",
          "",
          "[Removed Lines]",
          "4481:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &value, \"vValue\");",
          "",
          "[Added Lines]",
          "4388:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &value, \"vValue\");",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "4487:  return offset;",
          "4488: }",
          "4491: {",
          "4492:  int i, num;",
          "4493:  e_guid_t guid;",
          "",
          "[Removed Lines]",
          "4490: static int parse_CDbPropSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4397: static int parse_CDbPropSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "4524:  for (i = 0; i<num; i++) {",
          "4525:   offset = parse_padding(tvb, offset, 4, pad_tree, \"aProp[%d]\", i);",
          "4527:  }",
          "4529:  proto_item_set_end(item, tvb, offset);",
          "4530:  return offset;",
          "4531: }",
          "4534: {",
          "4535:  const int offset_in = offset;",
          "4536:  guint32 size, num;",
          "",
          "[Removed Lines]",
          "4526:   offset = parse_CDbProp(tvb, offset, tree, pad_tree, pset, \"aProp[%d]\", i);",
          "4533: static int parse_PropertySetArray(tvbuff_t *tvb, int offset, int size_offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4433:   offset = parse_CDbProp(tvb, pinfo, offset, tree, pad_tree, pset, \"aProp[%d]\", i);",
          "4440: static int parse_PropertySetArray(tvbuff_t *tvb, packet_info *pinfo, int offset, int size_offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "4556:  offset += 4;",
          "4558:  for (i = 0; i < (int)num; i++) {",
          "4560:  }",
          "4562:  proto_item_set_end(item, tvb, offset);",
          "",
          "[Removed Lines]",
          "4559:   offset = parse_CDbPropSet(tvb, offset, tree, pad_tree, \"PropertySet[%d]\", i);",
          "",
          "[Added Lines]",
          "4466:   offset = parse_CDbPropSet(tvb, pinfo, offset, tree, pad_tree, \"PropertySet[%d]\", i);",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "4594: }",
          "4598: {",
          "4599:  guint32 ulType;",
          "4600:  guint8 labelPresent;",
          "",
          "[Removed Lines]",
          "4597: int parse_RANGEBOUNDARY(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4504: int parse_RANGEBOUNDARY(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "4615:  offset += 4;",
          "4617:  ZERO_STRUCT(prval);",
          "4620:  labelPresent = tvb_get_guint8(tvb, offset);",
          "4621:  proto_tree_add_item(tree, hf_mswsp_rangeboundry_labelpresent, tvb, offset, 1, ENC_LITTLE_ENDIAN);",
          "",
          "[Removed Lines]",
          "4618:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &prval, \"prVal\");",
          "",
          "[Added Lines]",
          "4525:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &prval, \"prVal\");",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "4647: {",
          "4648:  proto_item *item;",
          "4649:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4646: int parse_CRangeCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4553: int parse_CRangeCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "4664:  offset += 4;",
          "4666:  for (i=0; i<cRange; i++) {",
          "4669:  }",
          "",
          "[Removed Lines]",
          "4667:   offset = parse_RANGEBOUNDARY(tvb, offset, tree, pad_tree, \"aRangeBegin[%u]\", i);",
          "",
          "[Added Lines]",
          "4574:   offset = parse_RANGEBOUNDARY(tvb, pinfo, offset, tree, pad_tree, \"aRangeBegin[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "4673: }",
          "4677: {",
          "4678:  proto_item *item;",
          "4679:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4676: int parse_CCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4583: int parse_CCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "4694:  offset = parse_CSort(tvb, offset, tree, pad_tree, \"CSort\");",
          "4698:  proto_item_set_end(item, tvb, offset);",
          "4699:  return offset;",
          "",
          "[Removed Lines]",
          "4696:  offset = parse_CRangeCategSpec(tvb, offset, tree, pad_tree, \"CRangeCategSpec\");",
          "",
          "[Added Lines]",
          "4603:  offset = parse_CRangeCategSpec(tvb, pinfo, offset, tree, pad_tree, \"CRangeCategSpec\");",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "4852: }",
          "4856: {",
          "4857:  proto_item *item;",
          "4858:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4855: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4762: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "4871:  if (type == GroupIdValue) {",
          "4872:   struct CBaseStorageVariant id;",
          "4874:  }",
          "4876:  offset = parse_CSortSet(tvb, offset, tree, pad_tree, \"SortSet\");",
          "",
          "[Removed Lines]",
          "4873:   offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &id, \"inGroupId\");",
          "",
          "[Added Lines]",
          "4780:   offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &id, \"inGroupId\");",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "4885: {",
          "4886:  guint32 cCount, i;",
          "4887:  proto_item *item;",
          "",
          "[Removed Lines]",
          "4884: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4791: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "4902:  for (i=0; i<cCount; i++) {",
          "4905:  }",
          "4907:  proto_item_set_end(item, tvb, offset);",
          "",
          "[Removed Lines]",
          "4904:   offset = parse_CInGroupSortAggregSet(tvb, offset, tree, pad_tree, \"SortSets[%u]\", i);",
          "",
          "[Added Lines]",
          "4811:   offset = parse_CInGroupSortAggregSet(tvb, pinfo, offset, tree, pad_tree, \"SortSets[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "4909: }",
          "4913: {",
          "4914:  proto_item *item;",
          "4915:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4912: int parse_CCategorizationSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4819: int parse_CCategorizationSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "4926:  offset = parse_CColumnSet(tvb, offset, tree, \"csColumns\");",
          "4932:  offset = parse_CAggregSet(tvb, offset, tree, pad_tree, \"AggregSet\");",
          "",
          "[Removed Lines]",
          "4929:  offset = parse_CCategSpec(tvb, offset, tree, pad_tree, \"Spec\");",
          "",
          "[Added Lines]",
          "4836:  offset = parse_CCategSpec(tvb, pinfo, offset, tree, pad_tree, \"Spec\");",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "4935:  offset = parse_CSortAggregSet(tvb, offset, tree, pad_tree, \"SortAggregSet\");",
          "4940:  proto_tree_add_item(tree, hf_mswsp_categorizationspec_cmaxres, tvb, offset, 4, ENC_LITTLE_ENDIAN);",
          "4941:  offset += 4;",
          "",
          "[Removed Lines]",
          "4938:  offset = parse_CInGroupSortAggregSets(tvb, offset, tree, pad_tree, \"InGroupSortAggregSets\");",
          "",
          "[Added Lines]",
          "4845:  offset = parse_CInGroupSortAggregSets(tvb, pinfo, offset, tree, pad_tree, \"InGroupSortAggregSets\");",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "5258:  return offset;",
          "5259: }",
          "5262: {",
          "5263:  guint32 i = 0;",
          "5264:  guint64 count = 0;",
          "5265:  int buf_offset = 0;",
          "5266:  proto_tree *sub_tree;",
          "5269:  wmem_strbuf_t *strbuf;",
          "5272:  offset = parse_CRowVariantArrayInfo(tvb, offset, tree, is_64bit, variant);",
          "5273:  if (is_64bit) {",
          "5274:   buf_offset =",
          "",
          "[Removed Lines]",
          "5261: static int parse_VariantColVector(tvbuff_t *tvb, int offset, proto_tree *tree, guint64 base_address, gboolean is_64bit, struct CRowVariant *variant)",
          "5267:  struct vtype_data *vt_list_type =",
          "5268:   vType_get_type((enum vType)(variant->vtype & 0x00FF));",
          "5271:  DISSECTOR_ASSERT(vt_list_type != NULL);",
          "",
          "[Added Lines]",
          "5168: static int parse_VariantColVector(tvbuff_t *tvb, int offset, proto_tree *tree, guint64 base_address, gboolean is_64bit, struct CRowVariant *variant, struct vtype_data *vt_list_type)",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "5320:  return offset;",
          "5321: }",
          "5324: {",
          "5325:  proto_tree *tree;",
          "5328:  va_list ap;",
          "5329:  struct vtype_data *vt_type;",
          "",
          "[Removed Lines]",
          "5323: static int parse_VariantCol(tvbuff_t *tvb, int offset, proto_tree *parent_tree, guint64 base_address, guint32 length _U_, gboolean is_64bit, struct CRowVariant *variant, const char *fmt, ...)",
          "5326:  proto_item *item;",
          "",
          "[Added Lines]",
          "5227: static int parse_VariantCol(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, guint64 base_address, guint32 length _U_, gboolean is_64bit, struct CRowVariant *variant, const char *fmt, ...)",
          "5230:  proto_item *item, *ti_type;",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "5340:  variant->vtype = tvb_get_letohs(tvb, offset);",
          "5341:  vt_type = vType_get_type((enum vType)variant->vtype);",
          "5344:  vtype_high = (variant->vtype & 0xFF00);",
          "5345:  if (vtype_high) {",
          "5346:   if (vtype_high == VT_VECTOR) {",
          "",
          "[Removed Lines]",
          "5342:  DISSECTOR_ASSERT(vt_type != NULL);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 43 ---",
          "[Context before]",
          "5352:   }",
          "5353:  }",
          "5355:  proto_tree_add_string_format_value(tree, hf_mswsp_rowvariant_vtype, tvb, offset, 2, vt_type->str, \"%s%s\", vt_type->str, modifier);",
          "5356:  offset += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5257:  if (vt_type == NULL) {",
          "5261:   ti_type = proto_tree_add_string(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, \"Unknown variant column type\");",
          "5262:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "5263:   offset += 2;",
          "5265:   THROW_FORMATTED(ReportedBoundsError, \"Unknown variant column type%s\", modifier);",
          "5266:   return offset;",
          "5267:  }",
          "",
          "---------------",
          "--- Hunk 44 ---",
          "[Context before]",
          "5368:  if (vtype_high == VT_VECTOR || vtype_high == VT_ARRAY) {",
          "5369:   offset = parse_VariantColVector(tvb, offset, tree, base_address,",
          "5371:  } else {",
          "5372:   wmem_strbuf_t *strbuf = wmem_strbuf_new(wmem_packet_scope(), \"\");",
          "5373:   if (size != -1) {",
          "",
          "[Removed Lines]",
          "5370:           is_64bit, variant);",
          "",
          "[Added Lines]",
          "5283:           is_64bit, variant, vt_type);",
          "",
          "---------------",
          "--- Hunk 45 ---",
          "[Context before]",
          "5406:  return offset;",
          "5407: }",
          "5410: {",
          "5411:  proto_tree *tree;",
          "5412:  proto_item *item;",
          "",
          "[Removed Lines]",
          "5409: static int parse_RowsBufferCol(tvbuff_t *tvb, int offset, guint32 row, guint32 col, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean b_is_64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "5322: static int parse_RowsBufferCol(tvbuff_t *tvb, packet_info *pinfo, int offset, guint32 row, guint32 col, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean b_is_64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 46 ---",
          "[Context before]",
          "5448:    len = tvb_get_letohs(tvb, buf_offset + pcol->lengthoffset) - pcol->valuesize;",
          "5449:   }",
          "5450:   if (pcol->vtype == VT_VARIANT) {",
          "5452:   }",
          "5453:  }",
          "5454:  return offset;",
          "5455: }",
          "5458: {",
          "5459:  proto_tree *tree;",
          "5460:  proto_item *item;",
          "",
          "[Removed Lines]",
          "5451:    parse_VariantCol(tvb, tmp_offset, tree, base_address, len, b_is_64bit, &variant, \"CRowVariant\");",
          "5457: static int parse_RowsBuffer(tvbuff_t *tvb, int offset, guint32 num_rows, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean is64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "5364:    parse_VariantCol(tvb, pinfo, tmp_offset, tree, base_address, len, b_is_64bit, &variant, \"CRowVariant\");",
          "5370: static int parse_RowsBuffer(tvbuff_t *tvb, packet_info *pinfo, int offset, guint32 num_rows, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean is64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 47 ---",
          "[Context before]",
          "5473:   proto_tree *row_tree;",
          "5474:   row_tree = proto_tree_add_subtree_format(tree, tvb, offset, 0, ett_GetRowsRow, NULL, \"Row[%d]\", num);",
          "5475:   for (col = 0; col < bindingsin->ccolumns; col++) {",
          "5477:   }",
          "5478:  }",
          "5479:  return offset;",
          "",
          "[Removed Lines]",
          "5476:    parse_RowsBufferCol(tvb, offset, num, col, bindingsin, rowsin, is64bit, row_tree, \"Col[%d]\", col);",
          "",
          "[Added Lines]",
          "5389:    parse_RowsBufferCol(tvb, pinfo, offset, num, col, bindingsin, rowsin, is64bit, row_tree, \"Col[%d]\", col);",
          "",
          "---------------",
          "--- Hunk 48 ---",
          "[Context before]",
          "5543:   offset = parse_padding(tvb, offset, 8, pad_tree, \"_paddingcPropSets\");",
          "5547:   offset = parse_padding(tvb, offset, 8, pad_tree, \"paddingExtPropset\");",
          "5551:   offset = parse_padding(tvb, offset, 8, pad_tree, \"???\");",
          "",
          "[Removed Lines]",
          "5545:   offset = parse_PropertySetArray(tvb, offset, blob_size1_off, tree, pad_tree, \"PropSets\");",
          "5549:   offset = parse_PropertySetArray(tvb, offset, blob_size2_off, tree, pad_tree, \"ExtPropset\");",
          "",
          "[Added Lines]",
          "5458:   offset = parse_PropertySetArray(tvb, pinfo, offset, blob_size1_off, tree, pad_tree, \"PropSets\");",
          "5462:   offset = parse_PropertySetArray(tvb, pinfo, offset, blob_size2_off, tree, pad_tree, \"ExtPropset\");",
          "",
          "---------------",
          "--- Hunk 49 ---",
          "[Context before]",
          "5601:   offset += 1;",
          "5603:   if (CRestrictionPresent) {",
          "5605:   }",
          "5607:   CSortSetPresent = tvb_get_guint8(tvb, offset);",
          "",
          "[Removed Lines]",
          "5604:    offset = parse_CRestrictionArray(tvb, offset, tree, pad_tree, \"RestrictionArray\");",
          "",
          "[Added Lines]",
          "5517:    offset = parse_CRestrictionArray(tvb, pinfo, offset, tree, pad_tree, \"RestrictionArray\");",
          "",
          "---------------",
          "--- Hunk 50 ---",
          "[Context before]",
          "5611:   if (CSortSetPresent) {",
          "5612:    offset = parse_padding(tvb, offset, 4, tree, \"paddingCSortSetPresent\");",
          "5615:   }",
          "",
          "[Removed Lines]",
          "5613:    offset = parse_CInGroupSortAggregSets(tvb, offset, tree, pad_tree, \"GroupSortAggregSets\");",
          "",
          "[Added Lines]",
          "5526:    offset = parse_CInGroupSortAggregSets(tvb, pinfo, offset, tree, pad_tree, \"GroupSortAggregSets\");",
          "",
          "---------------",
          "--- Hunk 51 ---",
          "[Context before]",
          "5626:    proto_tree_add_uint(tree, hf_mswsp_msg_cpmcreatequery_ccateg_count, tvb, offset, 4, count);",
          "5627:    offset += 4;",
          "5628:    for (i=0; i<count; i++) {",
          "5630:    }",
          "5631:   }",
          "",
          "[Removed Lines]",
          "5629:     offset = parse_CCategorizationSpec(tvb, offset, tree, pad_tree, \"categories[%u]\", i);",
          "",
          "[Added Lines]",
          "5542:     offset = parse_CCategorizationSpec(tvb, pinfo, offset, tree, pad_tree, \"categories[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 52 ---",
          "[Context before]",
          "5788:   if (b_has_arch && bindingsin && rowsin) {",
          "5789:    offset = parse_padding(tvb, offset, rowsin->cbreserved, pad_tree,",
          "5790:            \"paddingRows\");",
          "5792:   } else {",
          "5793:    gint nbytes = tvb_reported_length_remaining(tvb, offset);",
          "5794:    proto_tree_add_expert_format(tree, pinfo, &ei_missing_msg_context, tvb, offset, nbytes, \"Undissected %d bytes (due to missing preceding msg(s))\", nbytes);",
          "",
          "[Removed Lines]",
          "5791:    parse_RowsBuffer(tvb, offset, num_rows, bindingsin, rowsin, b_64bit_mode, tree, \"Rows\");",
          "",
          "[Added Lines]",
          "5704:    parse_RowsBuffer(tvb, pinfo, offset, num_rows, bindingsin, rowsin, b_64bit_mode, tree, \"Rows\");",
          "",
          "---------------",
          "--- Hunk 53 ---",
          "[Context before]",
          "5935:          sizeof(struct CTableColumn) * num);",
          "5936:   for (n=0; n<num; n++) {",
          "5937:    offset = parse_padding(tvb, offset, 4, pad_tree, \"padding_aColumns[%u]\", n);",
          "5939:   }",
          "5940:   data = find_or_create_message_data(ct, pinfo,0xD0,in, private_data);",
          "5941:   if (data) {",
          "",
          "[Removed Lines]",
          "5938:    offset = parse_CTableColumn(tvb, offset, tree, pad_tree, &request.acolumns[n],\"aColumns[%u]\", n);",
          "",
          "[Added Lines]",
          "5851:    offset = parse_CTableColumn(tvb, pinfo, offset, tree, pad_tree, &request.acolumns[n],\"aColumns[%u]\", n);",
          "",
          "---------------",
          "--- Hunk 54 ---",
          "[Context before]",
          "8020:  };",
          "8022:  static ei_register_info ei[] = {",
          "8023:   { &ei_missing_msg_context, { \"mswsp.msg.cpmgetrows.missing_msg_context\", PI_SEQUENCE, PI_WARN, \"previous messages needed for context not captured\", EXPFILL }},",
          "8024:   { &ei_mswsp_msg_cpmsetbinding_ccolumns, { \"mswsp.msg.cpmsetbinding.ccolumns.invalude\", PI_PROTOCOL, PI_WARN, \"Invalid number of cColumns for packet\", EXPFILL }}",
          "8025:  };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7936:   { &ei_mswsp_invalid_variant_type, { \"mswsp.invalid_variant_type\", PI_PROTOCOL, PI_ERROR, \"Invalid variant type\", EXPFILL }},",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "536fb9403a5f6bcc060aaa2a1f35d8d0225bb1fd",
      "candidate_info": {
        "commit_hash": "536fb9403a5f6bcc060aaa2a1f35d8d0225bb1fd",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/536fb9403a5f6bcc060aaa2a1f35d8d0225bb1fd",
        "files": [
          "epan/dissectors/packet-mswsp.c"
        ],
        "message": "Fix handling of invalid type values.\n\nIf vType_get_type() returns NULL, that means that the packet is bad, not\nthat the dissector is bad.  Report it as such.\n\nBug: 15119\nChange-Id: I8e66fcece2b526ef9edbf948862f8fc5bea25d74\nReviewed-on: https://code.wireshark.org/review/29511\nReviewed-by: Guy Harris <guy@alum.mit.edu>\n(cherry picked from commit 69e49ed9926153e2061951f7026f373a0e21b978)\nReviewed-on: https://code.wireshark.org/review/29513",
        "before_after_code_files": [
          "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
          ],
          "candidate": [
            "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-mswsp.c||epan/dissectors/packet-mswsp.c": [
          "File: epan/dissectors/packet-mswsp.c -> epan/dissectors/packet-mswsp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "360: void proto_reg_handoff_mswsp(void);",
          "362: static expert_field ei_missing_msg_context = EI_INIT;",
          "363: static expert_field ei_mswsp_msg_cpmsetbinding_ccolumns = EI_INIT;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "362: static expert_field ei_mswsp_invalid_variant_type = EI_INIT;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3074: static int parse_CFullPropSpec(tvbuff_t *tvb, int offset, proto_tree *tree, proto_tree *pad_tree, struct CFullPropSpec *v, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3071: static int parse_CBaseStorageVariant(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CBaseStorageVariant *value, const char *text);",
          "",
          "[Added Lines]",
          "3072: static int parse_CBaseStorageVariant(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CBaseStorageVariant *value, const char *text);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3080: static int parse_CNatLanguageRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNatLanguageRestriction *v, const char *fmt, ...);",
          "3089: static int parse_CReuseWhere(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CReuseWhere *v, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3083: static int parse_CNodeRestriction(tvbuff_t *tvb, int offset, proto_tree *tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char* fmt, ...);",
          "3086: static int parse_CPropertyRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3084: static int parse_CNodeRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char* fmt, ...);",
          "3087: static int parse_CPropertyRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "3092: static int parse_CSort(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, const char *fmt, ...);",
          "3103: static int parse_CColumnSet(tvbuff_t *tvb, int offset, proto_tree *tree, const char *fmt, ...);",
          "3118: static int parse_CAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3095: static int parse_CCoercionRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...);",
          "3097: static int parse_CRestrictionArray(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3100: static int parse_CRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...);",
          "3106: static int parse_CCategorizationSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3109: static int parse_CCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3112: static int parse_CRangeCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3115: static int parse_RANGEBOUNDARY(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3096: static int parse_CCoercionRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...);",
          "3098: static int parse_CRestrictionArray(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3101: static int parse_CRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...);",
          "3107: static int parse_CCategorizationSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3110: static int parse_CCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3113: static int parse_CRangeCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3116: static int parse_RANGEBOUNDARY(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "3127: static int parse_CAggregSortKey(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3136: static int parse_CDbColId(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *text);",
          "3145: static int parse_CPidMapper(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3130: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3133: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3139: static int parse_CDbProp(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...);",
          "3142: static int parse_CDbPropSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3131: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3134: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "3140: static int parse_CDbProp(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...);",
          "3143: static int parse_CDbPropSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3157: static int parse_CSortSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...);",
          "",
          "[Removed Lines]",
          "3160: static int parse_CTableColumn(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...);",
          "",
          "[Added Lines]",
          "3161: static int parse_CTableColumn(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "3231:  return offset;",
          "3232: }",
          "3235: {",
          "3239:  proto_tree *tree;",
          "3240:  va_list ap;",
          "3241:  struct vtype_data *type;",
          "",
          "[Removed Lines]",
          "3234: static int parse_CTableColumn(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...)",
          "3238:  proto_item *item;",
          "",
          "[Added Lines]",
          "3235: static int parse_CTableColumn(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CTableColumn *col, const char *fmt, ...)",
          "3239:  proto_item *item, *ti_type;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "3266:   }",
          "3267:  }",
          "3268:  type = vType_get_type(vtype_val);",
          "3271:  offset += 4;",
          "3273:  used = tvb_get_guint8(tvb, offset);",
          "",
          "[Removed Lines]",
          "3269:  DISSECTOR_ASSERT(type != NULL);",
          "3270:  proto_tree_add_string_format_value(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, type->str, \"%s%s\", type->str, modifier);",
          "",
          "[Added Lines]",
          "3270:  if (type == NULL) {",
          "3274:   ti_type = proto_tree_add_string(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, \"Unknown CTableColumn type\");",
          "3275:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "3276:  } else",
          "3277:   proto_tree_add_string_format_value(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, type->str, \"%s%s\", type->str, modifier);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "3487:  }",
          "3488:  return offset + 4;",
          "3489: }",
          "3491: {",
          "3492:  proto_tree *tree;",
          "3493:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3490: static int parse_CPropertyRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3497: static int parse_CPropertyRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CPropertyRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3506:  offset = parse_CFullPropSpec(tvb, offset, tree, pad_tree, &v->property, \"Property\");",
          "3510:  offset = parse_padding(tvb, offset, 4, pad_tree, \"padding_lcid\");",
          "",
          "[Removed Lines]",
          "3508:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &v->prval, \"prval\");",
          "",
          "[Added Lines]",
          "3515:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &v->prval, \"prval\");",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "3517:  return offset;",
          "3518: }",
          "3521: {",
          "3522:  proto_tree *tree;",
          "3523:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3520: static int parse_CCoercionRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3527: static int parse_CCoercionRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CCoercionRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "3536:  offset += 4;",
          "3540:  proto_item_set_end(item, tvb, offset);",
          "3541:  return offset;",
          "",
          "[Removed Lines]",
          "3538:  offset = parse_CRestriction(tvb, offset, tree, pad_tree, &v->child, \"child\");",
          "",
          "[Added Lines]",
          "3545:  offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &v->child, \"child\");",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "3732:  return offset + 4;",
          "3733: }",
          "3736: {",
          "3737:  proto_tree *tree;",
          "3738:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3735: static int parse_CRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3742: static int parse_CRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "3761:  case RTProximity:",
          "3762:  case RTPhrase: {",
          "3763:   v->u.RTAnd = EP_ALLOC(struct CNodeRestriction);",
          "3765:   break;",
          "3766:  }",
          "3767:  case RTNot: {",
          "3768:   v->u.RTNot = EP_ALLOC(struct CRestriction);",
          "3770:          v->u.RTNot, \"CRestriction\");",
          "3771:   break;",
          "3772:  }",
          "3773:  case RTProperty: {",
          "3774:   v->u.RTProperty = EP_ALLOC(struct CPropertyRestriction);",
          "3776:            v->u.RTProperty, \"CPropertyRestriction\");",
          "3777:   break;",
          "3778:  }",
          "",
          "[Removed Lines]",
          "3764:   offset = parse_CNodeRestriction(tvb, offset, tree, pad_tree, v->u.RTAnd, \"CNodeRestriction\");",
          "3769:   offset = parse_CRestriction(tvb, offset, tree, pad_tree,",
          "3775:   offset = parse_CPropertyRestriction(tvb, offset, tree, pad_tree,",
          "",
          "[Added Lines]",
          "3771:   offset = parse_CNodeRestriction(tvb, pinfo, offset, tree, pad_tree, v->u.RTAnd, \"CNodeRestriction\");",
          "3776:   offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "3782:   offset = parse_CPropertyRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "3780:  case RTCoerce_Multiply:",
          "3781:  case RTCoerce_Absolute: {",
          "3782:   v->u.RTCoerce_Add = EP_ALLOC(struct CCoercionRestriction);",
          "3784:            v->u.RTCoerce_Add, \"CCoercionRestriction\");",
          "3785:   break;",
          "3786:  }",
          "",
          "[Removed Lines]",
          "3783:   offset = parse_CCoercionRestriction(tvb, offset, tree, pad_tree,",
          "",
          "[Added Lines]",
          "3790:   offset = parse_CCoercionRestriction(tvb, pinfo, offset, tree, pad_tree,",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "3810:  return offset;",
          "3811: }",
          "3814: {",
          "3815:  guint8 present, count;",
          "",
          "[Removed Lines]",
          "3813: static int parse_CRestrictionArray(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3820: static int parse_CRestrictionArray(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "3841:   for (i=0; i<count; i++) {",
          "3842:    struct CRestriction r;",
          "3844:   }",
          "3845:  }",
          "3846:  proto_item_set_end(item, tvb, offset);",
          "3847:  return offset;",
          "3848: }",
          "3851: {",
          "3852:  proto_tree *tree;",
          "3853:  proto_item *item;",
          "",
          "[Removed Lines]",
          "3843:    offset = parse_CRestriction(tvb, offset, tree, pad_tree, &r, \"Restriction[%d]\", i);",
          "3850: static int parse_CNodeRestriction(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "3850:    offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &r, \"Restriction[%d]\", i);",
          "3857: static int parse_CNodeRestriction(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct CNodeRestriction *v, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "3867:  for (i=0; i<v->cNode; i++) {",
          "3868:   struct CRestriction r;",
          "3869:   ZERO_STRUCT(r);",
          "3873:  }",
          "",
          "[Removed Lines]",
          "3870:   offset = parse_CRestriction(tvb, offset, tree, pad_tree, &r, \"paNode[%u]\", i);",
          "",
          "[Added Lines]",
          "3877:   offset = parse_CRestriction(tvb, pinfo, offset, tree, pad_tree, &r, \"paNode[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "4208:  return wmem_strbuf_get_str(strbuf);",
          "4209: }",
          "4322: {",
          "4323:  int i, len;",
          "4324:  proto_item *ti, *ti_type, *ti_val;",
          "",
          "[Removed Lines]",
          "4211: static int parse_vType(tvbuff_t *tvb, int offset, guint16 *vtype)",
          "4212: {",
          "4213:  guint16 tmp_vtype = tvb_get_letohs(tvb, offset);",
          "4214:  guint16 modifier =  tmp_vtype & 0xFF00;",
          "4216:  switch (tmp_vtype & 0xFF) {",
          "4217:   case VT_EMPTY:",
          "4219:    break;",
          "4220:   case VT_NULL:",
          "4222:    break;",
          "4223:   case VT_I2:",
          "4225:    break;",
          "4226:   case VT_I4:",
          "4228:    break;",
          "4229:   case VT_R4:",
          "4231:    break;",
          "4232:   case VT_R8:",
          "4234:    break;",
          "4235:   case VT_CY:",
          "4237:    break;",
          "4238:   case VT_DATE:",
          "4240:    break;",
          "4241:   case VT_BSTR:",
          "4243:    break;",
          "4244:   case VT_ERROR:",
          "4246:    break;",
          "4247:   case VT_BOOL:",
          "4249:    break;",
          "4250:   case VT_VARIANT:",
          "4252:    break;",
          "4253:   case VT_DECIMAL:",
          "4255:    break;",
          "4256:   case VT_I1:",
          "4258:    break;",
          "4259:   case VT_UI1:",
          "4261:    break;",
          "4262:   case VT_UI2:",
          "4264:    break;",
          "4265:   case VT_UI4:",
          "4267:    break;",
          "4268:   case VT_I8:",
          "4270:    break;",
          "4271:   case VT_UI8:",
          "4273:    break;",
          "4274:   case VT_INT:",
          "4276:    break;",
          "4277:   case VT_UINT:",
          "4279:    break;",
          "4280:   case VT_LPSTR:",
          "4282:    break;",
          "4283:   case VT_LPWSTR:",
          "4285:    break;",
          "4286:   case VT_COMPRESSED_LPWSTR:",
          "4288:    break;",
          "4289:   case VT_FILETIME:",
          "4291:    break;",
          "4292:   case VT_BLOB:",
          "4294:    break;",
          "4295:   case VT_BLOB_OBJECT:",
          "4297:    break;",
          "4298:   case VT_CLSID:",
          "4300:    break;",
          "4301:   default:",
          "4302:    DISSECTOR_ASSERT(FALSE);",
          "4303:    break;",
          "4304:  }",
          "4305:  if (modifier) {",
          "4306:   switch (modifier) {",
          "4307:    case VT_VECTOR:",
          "4309:     break;",
          "4310:    case VT_ARRAY:",
          "4312:     break;",
          "4313:    default:",
          "4314:     DISSECTOR_ASSERT(FALSE);",
          "4315:     break;",
          "4316:   }",
          "4317:  }",
          "4318:  return offset + 2;",
          "4319: }",
          "4321: static int parse_CBaseStorageVariant(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CBaseStorageVariant *value, const char *text)",
          "",
          "[Added Lines]",
          "4218: static int parse_CBaseStorageVariant(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree _U_, struct CBaseStorageVariant *value, const char *text)",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "4330:  tree = proto_tree_add_subtree(parent_tree, tvb, offset, 0, ett_CBaseStorageVariant, &ti, text);",
          "4336:  ti_type = proto_tree_add_string(tree, hf_mswsp_cbasestorvariant_vtype, tvb, offset, 2, value->type->str);",
          "4337:  offset += 2;",
          "",
          "[Removed Lines]",
          "4332:  parse_vType(tvb, offset, &value->vType);",
          "4333:  value->type = vType_get_type(value->vType);",
          "4334:  DISSECTOR_ASSERT(value->type != NULL);",
          "",
          "[Added Lines]",
          "4229:  value->vType = tvb_get_letohs(tvb, offset);",
          "4230:  value->type = vType_get_type(value->vType & 0xFF);",
          "4231:  if (value->type == NULL) {",
          "4235:   ti_type = proto_tree_add_string(tree, hf_mswsp_cbasestorvariant_vtype, tvb, offset, 2, \"Unknown CBaseStorageVariant type\");",
          "4236:   offset += 2;",
          "4237:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "4239:   THROW_MESSAGE(ReportedBoundsError, \"Unknown CBaseStorageVariant type\");",
          "4240:   return offset;",
          "4241:  }",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "4452:  return offset;",
          "4453: }",
          "4456: {",
          "4457:  static const value_string EMPTY_VS[] = {{0, NULL}};",
          "4458:  const value_string *vs = (propset && propset->id_map) ? propset->id_map : EMPTY_VS;",
          "",
          "[Removed Lines]",
          "4455: static int parse_CDbProp(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4362: static int parse_CDbProp(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, struct GuidPropertySet *propset, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "4486:  offset = parse_CDbColId(tvb, offset, tree, pad_tree, \"colid\");",
          "4490:  str = str_CBaseStorageVariant(&value, TRUE);",
          "4491:  proto_item_append_text(item, \" %s\", str);",
          "",
          "[Removed Lines]",
          "4488:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &value, \"vValue\");",
          "",
          "[Added Lines]",
          "4395:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &value, \"vValue\");",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "4494:  return offset;",
          "4495: }",
          "4498: {",
          "4499:  int i, num;",
          "4500:  e_guid_t guid;",
          "",
          "[Removed Lines]",
          "4497: static int parse_CDbPropSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4404: static int parse_CDbPropSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "4531:  for (i = 0; i<num; i++) {",
          "4532:   offset = parse_padding(tvb, offset, 4, pad_tree, \"aProp[%d]\", i);",
          "4534:  }",
          "4536:  proto_item_set_end(item, tvb, offset);",
          "4537:  return offset;",
          "4538: }",
          "4541: {",
          "4542:  const int offset_in = offset;",
          "4543:  guint32 size, num;",
          "",
          "[Removed Lines]",
          "4533:   offset = parse_CDbProp(tvb, offset, tree, pad_tree, pset, \"aProp[%d]\", i);",
          "4540: static int parse_PropertySetArray(tvbuff_t *tvb, int offset, int size_offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4440:   offset = parse_CDbProp(tvb, pinfo, offset, tree, pad_tree, pset, \"aProp[%d]\", i);",
          "4447: static int parse_PropertySetArray(tvbuff_t *tvb, packet_info *pinfo, int offset, int size_offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "4563:  offset += 4;",
          "4565:  for (i = 0; i < (int)num; i++) {",
          "4567:  }",
          "4569:  proto_item_set_end(item, tvb, offset);",
          "",
          "[Removed Lines]",
          "4566:   offset = parse_CDbPropSet(tvb, offset, tree, pad_tree, \"PropertySet[%d]\", i);",
          "",
          "[Added Lines]",
          "4473:   offset = parse_CDbPropSet(tvb, pinfo, offset, tree, pad_tree, \"PropertySet[%d]\", i);",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "4601: }",
          "4605: {",
          "4606:  guint32 ulType;",
          "4607:  guint8 labelPresent;",
          "",
          "[Removed Lines]",
          "4604: int parse_RANGEBOUNDARY(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4511: int parse_RANGEBOUNDARY(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "4622:  offset += 4;",
          "4624:  ZERO_STRUCT(prval);",
          "4627:  labelPresent = tvb_get_guint8(tvb, offset);",
          "4628:  proto_tree_add_item(tree, hf_mswsp_rangeboundry_labelpresent, tvb, offset, 1, ENC_LITTLE_ENDIAN);",
          "",
          "[Removed Lines]",
          "4625:  offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &prval, \"prVal\");",
          "",
          "[Added Lines]",
          "4532:  offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &prval, \"prVal\");",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "4654: {",
          "4655:  proto_item *item;",
          "4656:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4653: int parse_CRangeCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4560: int parse_CRangeCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "4671:  offset += 4;",
          "4673:  for (i=0; i<cRange; i++) {",
          "4676:  }",
          "",
          "[Removed Lines]",
          "4674:   offset = parse_RANGEBOUNDARY(tvb, offset, tree, pad_tree, \"aRangeBegin[%u]\", i);",
          "",
          "[Added Lines]",
          "4581:   offset = parse_RANGEBOUNDARY(tvb, pinfo, offset, tree, pad_tree, \"aRangeBegin[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "4680: }",
          "4684: {",
          "4685:  proto_item *item;",
          "4686:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4683: int parse_CCategSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4590: int parse_CCategSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "4701:  offset = parse_CSort(tvb, offset, tree, pad_tree, \"CSort\");",
          "4705:  proto_item_set_end(item, tvb, offset);",
          "4706:  return offset;",
          "",
          "[Removed Lines]",
          "4703:  offset = parse_CRangeCategSpec(tvb, offset, tree, pad_tree, \"CRangeCategSpec\");",
          "",
          "[Added Lines]",
          "4610:  offset = parse_CRangeCategSpec(tvb, pinfo, offset, tree, pad_tree, \"CRangeCategSpec\");",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "4867: }",
          "4871: {",
          "4872:  proto_item *item;",
          "4873:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4870: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4777: static int parse_CInGroupSortAggregSet(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "4886:  if (type == GroupIdValue) {",
          "4887:   struct CBaseStorageVariant id;",
          "4889:  }",
          "4891:  offset = parse_CSortSet(tvb, offset, tree, pad_tree, \"SortSet\");",
          "",
          "[Removed Lines]",
          "4888:   offset = parse_CBaseStorageVariant(tvb, offset, tree, pad_tree, &id, \"inGroupId\");",
          "",
          "[Added Lines]",
          "4795:   offset = parse_CBaseStorageVariant(tvb, pinfo, offset, tree, pad_tree, &id, \"inGroupId\");",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "4900: {",
          "4901:  guint32 cCount, i;",
          "4902:  proto_item *item;",
          "",
          "[Removed Lines]",
          "4899: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4806: static int parse_CInGroupSortAggregSets(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "4917:  for (i=0; i<cCount; i++) {",
          "4920:  }",
          "4922:  proto_item_set_end(item, tvb, offset);",
          "",
          "[Removed Lines]",
          "4919:   offset = parse_CInGroupSortAggregSet(tvb, offset, tree, pad_tree, \"SortSets[%u]\", i);",
          "",
          "[Added Lines]",
          "4826:   offset = parse_CInGroupSortAggregSet(tvb, pinfo, offset, tree, pad_tree, \"SortSets[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "4924: }",
          "4928: {",
          "4929:  proto_item *item;",
          "4930:  proto_tree *tree;",
          "",
          "[Removed Lines]",
          "4927: int parse_CCategorizationSpec(tvbuff_t *tvb, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "4834: int parse_CCategorizationSpec(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, proto_tree *pad_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "4941:  offset = parse_CColumnSet(tvb, offset, tree, \"csColumns\");",
          "4947:  offset = parse_CAggregSet(tvb, offset, tree, pad_tree, \"AggregSet\");",
          "",
          "[Removed Lines]",
          "4944:  offset = parse_CCategSpec(tvb, offset, tree, pad_tree, \"Spec\");",
          "",
          "[Added Lines]",
          "4851:  offset = parse_CCategSpec(tvb, pinfo, offset, tree, pad_tree, \"Spec\");",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "4950:  offset = parse_CSortAggregSet(tvb, offset, tree, pad_tree, \"SortAggregSet\");",
          "4955:  proto_tree_add_item(tree, hf_mswsp_categorizationspec_cmaxres, tvb, offset, 4, ENC_LITTLE_ENDIAN);",
          "4956:  offset += 4;",
          "",
          "[Removed Lines]",
          "4953:  offset = parse_CInGroupSortAggregSets(tvb, offset, tree, pad_tree, \"InGroupSortAggregSets\");",
          "",
          "[Added Lines]",
          "4860:  offset = parse_CInGroupSortAggregSets(tvb, pinfo, offset, tree, pad_tree, \"InGroupSortAggregSets\");",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "5273:  return offset;",
          "5274: }",
          "5277: {",
          "5278:  guint32 i = 0;",
          "5279:  guint64 count = 0;",
          "5280:  int buf_offset = 0;",
          "5281:  proto_tree *sub_tree;",
          "5284:  wmem_strbuf_t *strbuf;",
          "5287:  offset = parse_CRowVariantArrayInfo(tvb, offset, tree, is_64bit, variant);",
          "5288:  if (is_64bit) {",
          "5289:   buf_offset =",
          "",
          "[Removed Lines]",
          "5276: static int parse_VariantColVector(tvbuff_t *tvb, int offset, proto_tree *tree, guint64 base_address, gboolean is_64bit, struct CRowVariant *variant)",
          "5282:  struct vtype_data *vt_list_type =",
          "5283:   vType_get_type((enum vType)(variant->vtype & 0x00FF));",
          "5286:  DISSECTOR_ASSERT(vt_list_type != NULL);",
          "",
          "[Added Lines]",
          "5183: static int parse_VariantColVector(tvbuff_t *tvb, int offset, proto_tree *tree, guint64 base_address, gboolean is_64bit, struct CRowVariant *variant, struct vtype_data *vt_list_type)",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "5335:  return offset;",
          "5336: }",
          "5339: {",
          "5340:  proto_tree *tree;",
          "5343:  va_list ap;",
          "5344:  struct vtype_data *vt_type;",
          "",
          "[Removed Lines]",
          "5338: static int parse_VariantCol(tvbuff_t *tvb, int offset, proto_tree *parent_tree, guint64 base_address, guint32 length _U_, gboolean is_64bit, struct CRowVariant *variant, const char *fmt, ...)",
          "5341:  proto_item *item;",
          "",
          "[Added Lines]",
          "5242: static int parse_VariantCol(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *parent_tree, guint64 base_address, guint32 length _U_, gboolean is_64bit, struct CRowVariant *variant, const char *fmt, ...)",
          "5245:  proto_item *item, *ti_type;",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "5355:  variant->vtype = tvb_get_letohs(tvb, offset);",
          "5356:  vt_type = vType_get_type((enum vType)variant->vtype);",
          "5359:  vtype_high = (variant->vtype & 0xFF00);",
          "5360:  if (vtype_high) {",
          "5361:   if (vtype_high == VT_VECTOR) {",
          "",
          "[Removed Lines]",
          "5357:  DISSECTOR_ASSERT(vt_type != NULL);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "5367:   }",
          "5368:  }",
          "5370:  proto_tree_add_string_format_value(tree, hf_mswsp_rowvariant_vtype, tvb, offset, 2, vt_type->str, \"%s%s\", vt_type->str, modifier);",
          "5371:  offset += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5272:  if (vt_type == NULL) {",
          "5276:   ti_type = proto_tree_add_string(tree, hf_mswsp_ctablecolumn_vtype, tvb, offset, 4, \"Unknown variant column type\");",
          "5277:   expert_add_info(pinfo, ti_type, &ei_mswsp_invalid_variant_type);",
          "5278:   offset += 2;",
          "5280:   THROW_FORMATTED(ReportedBoundsError, \"Unknown variant column type%s\", modifier);",
          "5281:   return offset;",
          "5282:  }",
          "",
          "---------------",
          "--- Hunk 43 ---",
          "[Context before]",
          "5383:  if (vtype_high == VT_VECTOR || vtype_high == VT_ARRAY) {",
          "5384:   offset = parse_VariantColVector(tvb, offset, tree, base_address,",
          "5386:  } else {",
          "5387:   wmem_strbuf_t *strbuf = wmem_strbuf_new(wmem_packet_scope(), \"\");",
          "5388:   if (size != -1) {",
          "",
          "[Removed Lines]",
          "5385:           is_64bit, variant);",
          "",
          "[Added Lines]",
          "5298:           is_64bit, variant, vt_type);",
          "",
          "---------------",
          "--- Hunk 44 ---",
          "[Context before]",
          "5421:  return offset;",
          "5422: }",
          "5425: {",
          "5426:  proto_tree *tree;",
          "5427:  proto_item *item;",
          "",
          "[Removed Lines]",
          "5424: static int parse_RowsBufferCol(tvbuff_t *tvb, int offset, guint32 row, guint32 col, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean b_is_64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "5337: static int parse_RowsBufferCol(tvbuff_t *tvb, packet_info *pinfo, int offset, guint32 row, guint32 col, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean b_is_64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 45 ---",
          "[Context before]",
          "5463:    len = tvb_get_letohs(tvb, buf_offset + pcol->lengthoffset) - pcol->valuesize;",
          "5464:   }",
          "5465:   if (pcol->vtype == VT_VARIANT) {",
          "5467:   }",
          "5468:  }",
          "5469:  return offset;",
          "5470: }",
          "5473: {",
          "5474:  proto_tree *tree;",
          "5475:  proto_item *item;",
          "",
          "[Removed Lines]",
          "5466:    parse_VariantCol(tvb, tmp_offset, tree, base_address, len, b_is_64bit, &variant, \"CRowVariant\");",
          "5472: static int parse_RowsBuffer(tvbuff_t *tvb, int offset, guint32 num_rows, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean is64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "[Added Lines]",
          "5379:    parse_VariantCol(tvb, pinfo, tmp_offset, tree, base_address, len, b_is_64bit, &variant, \"CRowVariant\");",
          "5385: static int parse_RowsBuffer(tvbuff_t *tvb, packet_info *pinfo, int offset, guint32 num_rows, struct CPMSetBindingsIn *bindingsin, struct rows_data *rowsin, gboolean is64bit, proto_tree *parent_tree, const char *fmt, ...)",
          "",
          "---------------",
          "--- Hunk 46 ---",
          "[Context before]",
          "5488:   proto_tree *row_tree;",
          "5489:   row_tree = proto_tree_add_subtree_format(tree, tvb, offset, 0, ett_GetRowsRow, NULL, \"Row[%d]\", num);",
          "5490:   for (col = 0; col < bindingsin->ccolumns; col++) {",
          "5492:   }",
          "5493:  }",
          "5494:  return offset;",
          "",
          "[Removed Lines]",
          "5491:    parse_RowsBufferCol(tvb, offset, num, col, bindingsin, rowsin, is64bit, row_tree, \"Col[%d]\", col);",
          "",
          "[Added Lines]",
          "5404:    parse_RowsBufferCol(tvb, pinfo, offset, num, col, bindingsin, rowsin, is64bit, row_tree, \"Col[%d]\", col);",
          "",
          "---------------",
          "--- Hunk 47 ---",
          "[Context before]",
          "5558:   offset = parse_padding(tvb, offset, 8, pad_tree, \"_paddingcPropSets\");",
          "5562:   offset = parse_padding(tvb, offset, 8, pad_tree, \"paddingExtPropset\");",
          "5566:   offset = parse_padding(tvb, offset, 8, pad_tree, \"???\");",
          "",
          "[Removed Lines]",
          "5560:   offset = parse_PropertySetArray(tvb, offset, blob_size1_off, tree, pad_tree, \"PropSets\");",
          "5564:   offset = parse_PropertySetArray(tvb, offset, blob_size2_off, tree, pad_tree, \"ExtPropset\");",
          "",
          "[Added Lines]",
          "5473:   offset = parse_PropertySetArray(tvb, pinfo, offset, blob_size1_off, tree, pad_tree, \"PropSets\");",
          "5477:   offset = parse_PropertySetArray(tvb, pinfo, offset, blob_size2_off, tree, pad_tree, \"ExtPropset\");",
          "",
          "---------------",
          "--- Hunk 48 ---",
          "[Context before]",
          "5616:   offset += 1;",
          "5618:   if (CRestrictionPresent) {",
          "5620:   }",
          "5622:   CSortSetPresent = tvb_get_guint8(tvb, offset);",
          "",
          "[Removed Lines]",
          "5619:    offset = parse_CRestrictionArray(tvb, offset, tree, pad_tree, \"RestrictionArray\");",
          "",
          "[Added Lines]",
          "5532:    offset = parse_CRestrictionArray(tvb, pinfo, offset, tree, pad_tree, \"RestrictionArray\");",
          "",
          "---------------",
          "--- Hunk 49 ---",
          "[Context before]",
          "5626:   if (CSortSetPresent) {",
          "5627:    offset = parse_padding(tvb, offset, 4, tree, \"paddingCSortSetPresent\");",
          "5630:   }",
          "",
          "[Removed Lines]",
          "5628:    offset = parse_CInGroupSortAggregSets(tvb, offset, tree, pad_tree, \"GroupSortAggregSets\");",
          "",
          "[Added Lines]",
          "5541:    offset = parse_CInGroupSortAggregSets(tvb, pinfo, offset, tree, pad_tree, \"GroupSortAggregSets\");",
          "",
          "---------------",
          "--- Hunk 50 ---",
          "[Context before]",
          "5641:    proto_tree_add_uint(tree, hf_mswsp_msg_cpmcreatequery_ccateg_count, tvb, offset, 4, count);",
          "5642:    offset += 4;",
          "5643:    for (i=0; i<count; i++) {",
          "5645:    }",
          "5646:   }",
          "",
          "[Removed Lines]",
          "5644:     offset = parse_CCategorizationSpec(tvb, offset, tree, pad_tree, \"categories[%u]\", i);",
          "",
          "[Added Lines]",
          "5557:     offset = parse_CCategorizationSpec(tvb, pinfo, offset, tree, pad_tree, \"categories[%u]\", i);",
          "",
          "---------------",
          "--- Hunk 51 ---",
          "[Context before]",
          "5803:   if (b_has_arch && bindingsin && rowsin) {",
          "5804:    offset = parse_padding(tvb, offset, rowsin->cbreserved, pad_tree,",
          "5805:            \"paddingRows\");",
          "5807:   } else {",
          "5808:    gint nbytes = tvb_reported_length_remaining(tvb, offset);",
          "5809:    proto_tree_add_expert_format(tree, pinfo, &ei_missing_msg_context, tvb, offset, nbytes, \"Undissected %d bytes (due to missing preceding msg(s))\", nbytes);",
          "",
          "[Removed Lines]",
          "5806:    parse_RowsBuffer(tvb, offset, num_rows, bindingsin, rowsin, b_64bit_mode, tree, \"Rows\");",
          "",
          "[Added Lines]",
          "5719:    parse_RowsBuffer(tvb, pinfo, offset, num_rows, bindingsin, rowsin, b_64bit_mode, tree, \"Rows\");",
          "",
          "---------------",
          "--- Hunk 52 ---",
          "[Context before]",
          "5950:          sizeof(struct CTableColumn) * num);",
          "5951:   for (n=0; n<num; n++) {",
          "5952:    offset = parse_padding(tvb, offset, 4, pad_tree, \"padding_aColumns[%u]\", n);",
          "5954:   }",
          "5955:   data = find_or_create_message_data(ct, pinfo,0xD0,in, private_data);",
          "5956:   if (data) {",
          "",
          "[Removed Lines]",
          "5953:    offset = parse_CTableColumn(tvb, offset, tree, pad_tree, &request.acolumns[n],\"aColumns[%u]\", n);",
          "",
          "[Added Lines]",
          "5866:    offset = parse_CTableColumn(tvb, pinfo, offset, tree, pad_tree, &request.acolumns[n],\"aColumns[%u]\", n);",
          "",
          "---------------",
          "--- Hunk 53 ---",
          "[Context before]",
          "8051:  };",
          "8053:  static ei_register_info ei[] = {",
          "8054:   { &ei_missing_msg_context, { \"mswsp.msg.cpmgetrows.missing_msg_context\", PI_SEQUENCE, PI_WARN, \"previous messages needed for context not captured\", EXPFILL }},",
          "8055:   { &ei_mswsp_msg_cpmsetbinding_ccolumns, { \"mswsp.msg.cpmsetbinding.ccolumns.invalude\", PI_PROTOCOL, PI_WARN, \"Invalid number of cColumns for packet\", EXPFILL }}",
          "8056:  };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7967:   { &ei_mswsp_invalid_variant_type, { \"mswsp.invalid_variant_type\", PI_PROTOCOL, PI_ERROR, \"Invalid variant type\", EXPFILL }},",
          "",
          "---------------"
        ]
      }
    }
  ]
}