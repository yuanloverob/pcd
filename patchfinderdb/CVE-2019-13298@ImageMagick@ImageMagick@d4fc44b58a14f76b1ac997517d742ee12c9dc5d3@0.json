{
  "cve_id": "CVE-2019-13298",
  "cve_desc": "ImageMagick 7.0.8-50 Q16 has a heap-based buffer overflow at MagickCore/pixel-accessor.h in SetPixelViaPixelInfo because of a MagickCore/enhance.c error.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "d4fc44b58a14f76b1ac997517d742ee12c9dc5d3",
  "patch_info": {
    "commit_hash": "d4fc44b58a14f76b1ac997517d742ee12c9dc5d3",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/d4fc44b58a14f76b1ac997517d742ee12c9dc5d3",
    "files": [
      "MagickCore/enhance.c",
      "MagickCore/pixel-accessor.h"
    ],
    "message": "https://github.com/ImageMagick/ImageMagick/issues/1611",
    "before_after_code_files": [
      "MagickCore/enhance.c||MagickCore/enhance.c",
      "MagickCore/pixel-accessor.h||MagickCore/pixel-accessor.h"
    ]
  },
  "patch_diff": {
    "MagickCore/enhance.c||MagickCore/enhance.c": [
      "File: MagickCore/enhance.c -> MagickCore/enhance.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1973:       EnhancePixel(8.0); EnhancePixel(20.0); EnhancePixel(40.0);",
      "1974:         EnhancePixel(20.0); EnhancePixel(8.0);",
      "1975:       r=p+4*GetPixelChannels(image)*(image->columns+4);",
      "1977:         EnhancePixel(8.0); EnhancePixel(5.0);",
      "1978:       if (total_weight > MagickEpsilon)",
      "1979:         {",
      "",
      "[Removed Lines]",
      "1976:       EnhancePixel(5.0); EnhancePixel(8.0); EnhancePixel(10.0);",
      "",
      "[Added Lines]",
      "1976:       EnhancePixel(5.0); EnhancePixel(8.0); EnhancePixel(10.0);",
      "",
      "---------------"
    ],
    "MagickCore/pixel-accessor.h||MagickCore/pixel-accessor.h": [
      "File: MagickCore/pixel-accessor.h -> MagickCore/pixel-accessor.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "111: static inline Quantum GetPixelChannel(const Image *magick_restrict image,",
      "112:   const PixelChannel channel,const Quantum *magick_restrict pixel)",
      "113: {",
      "115:     return((Quantum) 0);",
      "116:   return(pixel[image->channel_map[channel].offset]);",
      "117: }",
      "",
      "[Removed Lines]",
      "114:   if (image->channel_map[image->channel_map[channel].offset].traits == UndefinedPixelTrait)",
      "",
      "[Added Lines]",
      "114:   if (image->channel_map[channel].traits == UndefinedPixelTrait)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8187d2d8fd010d2d6b1a3a8edd935beec404dddc",
      "candidate_info": {
        "commit_hash": "8187d2d8fd010d2d6b1a3a8edd935beec404dddc",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/8187d2d8fd010d2d6b1a3a8edd935beec404dddc",
        "files": [
          "MagickCore/pixel-accessor.h"
        ],
        "message": "https://github.com/ImageMagick/ImageMagick/issues/1610",
        "before_after_code_files": [
          "MagickCore/pixel-accessor.h||MagickCore/pixel-accessor.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/pixel-accessor.h||MagickCore/pixel-accessor.h"
          ],
          "candidate": [
            "MagickCore/pixel-accessor.h||MagickCore/pixel-accessor.h"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/pixel-accessor.h||MagickCore/pixel-accessor.h": [
          "File: MagickCore/pixel-accessor.h -> MagickCore/pixel-accessor.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "111: static inline Quantum GetPixelChannel(const Image *magick_restrict image,",
          "112:   const PixelChannel channel,const Quantum *magick_restrict pixel)",
          "113: {",
          "115:     return((Quantum) 0);",
          "116:   return(pixel[image->channel_map[channel].offset]);",
          "117: }",
          "",
          "[Removed Lines]",
          "114:   if (image->channel_map[channel].traits == UndefinedPixelTrait)",
          "",
          "[Added Lines]",
          "114:   if (image->channel_map[image->channel_map[channel].offset].traits == UndefinedPixelTrait)",
          "",
          "---------------"
        ]
      }
    }
  ]
}