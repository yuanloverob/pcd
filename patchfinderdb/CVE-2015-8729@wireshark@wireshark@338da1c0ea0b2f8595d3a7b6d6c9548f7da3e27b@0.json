{
  "cve_id": "CVE-2015-8729",
  "cve_desc": "The ascend_seek function in wiretap/ascendtext.c in the Ascend file parser in Wireshark 1.12.x before 1.12.9 and 2.0.x before 2.0.1 does not ensure the presence of a '\\0' character at the end of a date string, which allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted file.",
  "repo": "wireshark/wireshark",
  "patch_hash": "338da1c0ea0b2f8595d3a7b6d6c9548f7da3e27b",
  "patch_info": {
    "commit_hash": "338da1c0ea0b2f8595d3a7b6d6c9548f7da3e27b",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/338da1c0ea0b2f8595d3a7b6d6c9548f7da3e27b",
    "files": [
      "wiretap/ascendtext.c"
    ],
    "message": "Fix out-of-bounds read in ascend_seek.\n\nBug: 11794\nChange-Id: I74517806b119729ae6d9780bbd4bb094701ff05e\nReviewed-on: https://code.wireshark.org/review/12266\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nReviewed-by: Peter Wu <peter@lekensteyn.nl>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
    "before_after_code_files": [
      "wiretap/ascendtext.c||wiretap/ascendtext.c"
    ]
  },
  "patch_diff": {
    "wiretap/ascendtext.c||wiretap/ascendtext.c": [
      "File: wiretap/ascendtext.c -> wiretap/ascendtext.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "117:           if (strcmp(strptr, ASCEND_DATE) == 0) {",
      "118:             date_off = cur_off - len;",
      "119:           } else {",
      "120:             if (date_off == -1) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "119:             string_level[string_i] = 0;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f1ca44a1f9bcb7692ea1088a4c4ed408dc3b20ed",
      "candidate_info": {
        "commit_hash": "f1ca44a1f9bcb7692ea1088a4c4ed408dc3b20ed",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/f1ca44a1f9bcb7692ea1088a4c4ed408dc3b20ed",
        "files": [
          "wiretap/ascendtext.c"
        ],
        "message": "Fix out-of-bounds read in ascend_seek.\n\nBug: 11794\nChange-Id: I74517806b119729ae6d9780bbd4bb094701ff05e\nReviewed-on: https://code.wireshark.org/review/12266\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nReviewed-by: Peter Wu <peter@lekensteyn.nl>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 338da1c0ea0b2f8595d3a7b6d6c9548f7da3e27b)\nReviewed-on: https://code.wireshark.org/review/12296\n(cherry picked from commit 7abfa36686850a0d81ef1ef280a181d09e5e639c)\nReviewed-on: https://code.wireshark.org/review/12297\n(cherry picked from commit 9cf09cf777cb5478d470436278db45ab42d84e06)\nReviewed-on: https://code.wireshark.org/review/13768\nReviewed-by: Balint Reczey <balint@balintreczey.hu>\n(cherry picked from commit 38ede4e33b373ff5ff0aed2237ec0695d7c731b9)\nReviewed-on: https://code.wireshark.org/review/14245",
        "before_after_code_files": [
          "wiretap/ascendtext.c||wiretap/ascendtext.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ],
          "candidate": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ]
        }
      },
      "candidate_diff": {
        "wiretap/ascendtext.c||wiretap/ascendtext.c": [
          "File: wiretap/ascendtext.c -> wiretap/ascendtext.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:    if (strcmp(strptr, ASCEND_DATE) == 0) {",
          "131:             date_off = cur_off - len;",
          "132:           } else {",
          "133:             if (date_off == -1) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "132:             string_level[string_i] = 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7abfa36686850a0d81ef1ef280a181d09e5e639c",
      "candidate_info": {
        "commit_hash": "7abfa36686850a0d81ef1ef280a181d09e5e639c",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/7abfa36686850a0d81ef1ef280a181d09e5e639c",
        "files": [
          "wiretap/ascendtext.c"
        ],
        "message": "Fix out-of-bounds read in ascend_seek.\n\nBug: 11794\nChange-Id: I74517806b119729ae6d9780bbd4bb094701ff05e\nReviewed-on: https://code.wireshark.org/review/12266\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nReviewed-by: Peter Wu <peter@lekensteyn.nl>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 338da1c0ea0b2f8595d3a7b6d6c9548f7da3e27b)\nReviewed-on: https://code.wireshark.org/review/12296",
        "before_after_code_files": [
          "wiretap/ascendtext.c||wiretap/ascendtext.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ],
          "candidate": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ]
        }
      },
      "candidate_diff": {
        "wiretap/ascendtext.c||wiretap/ascendtext.c": [
          "File: wiretap/ascendtext.c -> wiretap/ascendtext.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "117:           if (strcmp(strptr, ASCEND_DATE) == 0) {",
          "118:             date_off = cur_off - len;",
          "119:           } else {",
          "120:             if (date_off == -1) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "119:             string_level[string_i] = 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "38ede4e33b373ff5ff0aed2237ec0695d7c731b9",
      "candidate_info": {
        "commit_hash": "38ede4e33b373ff5ff0aed2237ec0695d7c731b9",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/38ede4e33b373ff5ff0aed2237ec0695d7c731b9",
        "files": [
          "wiretap/ascendtext.c"
        ],
        "message": "Fix out-of-bounds read in ascend_seek.\n\nBug: 11794\nChange-Id: I74517806b119729ae6d9780bbd4bb094701ff05e\nReviewed-on: https://code.wireshark.org/review/12266\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nReviewed-by: Peter Wu <peter@lekensteyn.nl>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 338da1c0ea0b2f8595d3a7b6d6c9548f7da3e27b)\nReviewed-on: https://code.wireshark.org/review/12296\n(cherry picked from commit 7abfa36686850a0d81ef1ef280a181d09e5e639c)\nReviewed-on: https://code.wireshark.org/review/12297\n(cherry picked from commit 9cf09cf777cb5478d470436278db45ab42d84e06)\nReviewed-on: https://code.wireshark.org/review/13768\nReviewed-by: Balint Reczey <balint@balintreczey.hu>",
        "before_after_code_files": [
          "wiretap/ascendtext.c||wiretap/ascendtext.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ],
          "candidate": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ]
        }
      },
      "candidate_diff": {
        "wiretap/ascendtext.c||wiretap/ascendtext.c": [
          "File: wiretap/ascendtext.c -> wiretap/ascendtext.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "120:    if (strcmp(strptr, ASCEND_DATE) == 0) {",
          "121:             date_off = cur_off - len;",
          "122:           } else {",
          "123:             if (date_off == -1) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "122:             string_level[string_i] = 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9cf09cf777cb5478d470436278db45ab42d84e06",
      "candidate_info": {
        "commit_hash": "9cf09cf777cb5478d470436278db45ab42d84e06",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/9cf09cf777cb5478d470436278db45ab42d84e06",
        "files": [
          "wiretap/ascendtext.c"
        ],
        "message": "Fix out-of-bounds read in ascend_seek.\n\nBug: 11794\nChange-Id: I74517806b119729ae6d9780bbd4bb094701ff05e\nReviewed-on: https://code.wireshark.org/review/12266\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nReviewed-by: Peter Wu <peter@lekensteyn.nl>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 338da1c0ea0b2f8595d3a7b6d6c9548f7da3e27b)\nReviewed-on: https://code.wireshark.org/review/12296\n(cherry picked from commit 7abfa36686850a0d81ef1ef280a181d09e5e639c)\nReviewed-on: https://code.wireshark.org/review/12297",
        "before_after_code_files": [
          "wiretap/ascendtext.c||wiretap/ascendtext.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ],
          "candidate": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ]
        }
      },
      "candidate_diff": {
        "wiretap/ascendtext.c||wiretap/ascendtext.c": [
          "File: wiretap/ascendtext.c -> wiretap/ascendtext.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "120:    if (strcmp(strptr, ASCEND_DATE) == 0) {",
          "121:             date_off = cur_off - len;",
          "122:           } else {",
          "123:             if (date_off == -1) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "122:             string_level[string_i] = 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "51ed8f4e52b9b360b9dd1998bd421f9661753bf8",
      "candidate_info": {
        "commit_hash": "51ed8f4e52b9b360b9dd1998bd421f9661753bf8",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/51ed8f4e52b9b360b9dd1998bd421f9661753bf8",
        "files": [
          "wiretap/ascendtext.c"
        ],
        "message": "Add some comments explaining what some code is doing.\n\nChange-Id: Ib229fcf4d14fd3c01755f868789f430496c23ded\nReviewed-on: https://code.wireshark.org/review/12300\nReviewed-by: Guy Harris <guy@alum.mit.edu>",
        "before_after_code_files": [
          "wiretap/ascendtext.c||wiretap/ascendtext.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ],
          "candidate": [
            "wiretap/ascendtext.c||wiretap/ascendtext.c"
          ]
        }
      },
      "candidate_diff": {
        "wiretap/ascendtext.c||wiretap/ascendtext.c": [
          "File: wiretap/ascendtext.c -> wiretap/ascendtext.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "117:           if (strcmp(strptr, ASCEND_DATE) == 0) {",
          "118:             date_off = cur_off - len;",
          "119:             string_level[string_i] = 0;",
          "120:           } else {",
          "121:             if (date_off == -1) {",
          "124:               packet_off = cur_off - len;",
          "125:             } else {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "134:                Reset the amount of Date: header that we've matched,",
          "135:                so that we start the process of matching a Date:",
          "136:                header all over again.",
          "138:                XXX - what if we match multiple Date: headers before",
          "146:                  doesn't have one.",
          "147:                  Back up over the header we just read; that's where a read",
          "",
          "---------------"
        ]
      }
    }
  ]
}