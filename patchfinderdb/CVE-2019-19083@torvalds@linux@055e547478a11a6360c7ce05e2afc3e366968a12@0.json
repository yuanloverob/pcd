{
  "cve_id": "CVE-2019-19083",
  "cve_desc": "Memory leaks in *clock_source_create() functions under drivers/gpu/drm/amd/display/dc in the Linux kernel before 5.3.8 allow attackers to cause a denial of service (memory consumption). This affects the dce112_clock_source_create() function in drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c, the dce100_clock_source_create() function in drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c, the dcn10_clock_source_create() function in drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c, the dcn20_clock_source_create() function in drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c, the dce120_clock_source_create() function in drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c, the dce110_clock_source_create() function in drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c, and the dce80_clock_source_create() function in drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c, aka CID-055e547478a1.",
  "repo": "torvalds/linux",
  "patch_hash": "055e547478a11a6360c7ce05e2afc3e366968a12",
  "patch_info": {
    "commit_hash": "055e547478a11a6360c7ce05e2afc3e366968a12",
    "repo": "torvalds/linux",
    "commit_url": "https://github.com/torvalds/linux/commit/055e547478a11a6360c7ce05e2afc3e366968a12",
    "files": [
      "drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c",
      "drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c",
      "drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c",
      "drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c",
      "drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c",
      "drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c",
      "drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c"
    ],
    "message": "drm/amd/display: memory leak\n\nIn dcn*_clock_source_create when dcn20_clk_src_construct fails allocated\nclk_src needs release.\n\nSigned-off-by: Navid Emamdoost <navid.emamdoost@gmail.com>\nSigned-off-by: Alex Deucher <alexander.deucher@amd.com>",
    "before_after_code_files": [
      "drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c||drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c",
      "drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c||drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c",
      "drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c||drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c",
      "drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c||drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c",
      "drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c||drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c",
      "drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c||drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c",
      "drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c||drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c"
    ]
  },
  "patch_diff": {
    "drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c||drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c": [
      "File: drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c -> drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "668:   return &clk_src->base;",
      "669:  }",
      "671:  BREAK_TO_DEBUGGER();",
      "672:  return NULL;",
      "673: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "671:  kfree(clk_src);",
      "",
      "---------------"
    ],
    "drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c||drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c": [
      "File: drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c -> drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "714:   return &clk_src->base;",
      "715:  }",
      "717:  BREAK_TO_DEBUGGER();",
      "718:  return NULL;",
      "719: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "717:  kfree(clk_src);",
      "",
      "---------------"
    ],
    "drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c||drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c": [
      "File: drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c -> drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "687:   return &clk_src->base;",
      "688:  }",
      "690:  BREAK_TO_DEBUGGER();",
      "691:  return NULL;",
      "692: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "690:  kfree(clk_src);",
      "",
      "---------------"
    ],
    "drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c||drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c": [
      "File: drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c -> drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "500:   return &clk_src->base;",
      "501:  }",
      "503:  BREAK_TO_DEBUGGER();",
      "504:  return NULL;",
      "505: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "503:  kfree(clk_src);",
      "",
      "---------------"
    ],
    "drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c||drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c": [
      "File: drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c -> drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "701:   return &clk_src->base;",
      "702:  }",
      "704:  BREAK_TO_DEBUGGER();",
      "705:  return NULL;",
      "706: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "704:  kfree(clk_src);",
      "",
      "---------------"
    ],
    "drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c||drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c": [
      "File: drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c -> drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "786:   return &clk_src->base;",
      "787:  }",
      "789:  BREAK_TO_DEBUGGER();",
      "790:  return NULL;",
      "791: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "789:  kfree(clk_src);",
      "",
      "---------------"
    ],
    "drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c||drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c": [
      "File: drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c -> drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1077:   return &clk_src->base;",
      "1078:  }",
      "1080:  BREAK_TO_DEBUGGER();",
      "1081:  return NULL;",
      "1082: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1080:  kfree(clk_src);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "cabe144bfd0c106c2e55d900320c2464c42ab94c",
      "candidate_info": {
        "commit_hash": "cabe144bfd0c106c2e55d900320c2464c42ab94c",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/cabe144bfd0c106c2e55d900320c2464c42ab94c",
        "files": [
          "drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c",
          "drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c",
          "drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c",
          "drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c",
          "drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c",
          "drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c",
          "drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c"
        ],
        "message": "drm/amd/display: memory leak\n\nIn dcn*_clock_source_create when dcn20_clk_src_construct fails allocated\nclk_src needs release.\n\nSigned-off-by: Navid Emamdoost <navid.emamdoost@gmail.com>\nSigned-off-by: Alex Deucher <alexander.deucher@amd.com>",
        "before_after_code_files": [
          "drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c||drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c",
          "drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c||drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c",
          "drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c||drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c",
          "drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c||drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c",
          "drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c||drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c",
          "drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c||drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c",
          "drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c||drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c||drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c",
            "drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c||drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c",
            "drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c||drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c",
            "drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c||drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c",
            "drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c||drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c",
            "drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c||drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c",
            "drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c||drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c"
          ],
          "candidate": [
            "drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c||drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c",
            "drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c||drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c",
            "drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c||drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c",
            "drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c||drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c",
            "drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c||drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c",
            "drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c||drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c",
            "drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c||drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c"
          ]
        }
      },
      "candidate_diff": {
        "drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c||drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c": [
          "File: drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c -> drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "668:   return &clk_src->base;",
          "669:  }",
          "671:  BREAK_TO_DEBUGGER();",
          "672:  return NULL;",
          "673: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "671:  kfree(clk_src);",
          "",
          "---------------"
        ],
        "drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c||drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c": [
          "File: drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c -> drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "714:   return &clk_src->base;",
          "715:  }",
          "717:  BREAK_TO_DEBUGGER();",
          "718:  return NULL;",
          "719: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "717:  kfree(clk_src);",
          "",
          "---------------"
        ],
        "drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c||drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c": [
          "File: drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c -> drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "687:   return &clk_src->base;",
          "688:  }",
          "690:  BREAK_TO_DEBUGGER();",
          "691:  return NULL;",
          "692: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "690:  kfree(clk_src);",
          "",
          "---------------"
        ],
        "drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c||drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c": [
          "File: drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c -> drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "500:   return &clk_src->base;",
          "501:  }",
          "503:  BREAK_TO_DEBUGGER();",
          "504:  return NULL;",
          "505: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "503:  kfree(clk_src);",
          "",
          "---------------"
        ],
        "drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c||drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c": [
          "File: drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c -> drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "701:   return &clk_src->base;",
          "702:  }",
          "704:  BREAK_TO_DEBUGGER();",
          "705:  return NULL;",
          "706: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "704:  kfree(clk_src);",
          "",
          "---------------"
        ],
        "drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c||drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c": [
          "File: drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c -> drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "786:   return &clk_src->base;",
          "787:  }",
          "789:  BREAK_TO_DEBUGGER();",
          "790:  return NULL;",
          "791: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "789:  kfree(clk_src);",
          "",
          "---------------"
        ],
        "drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c||drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c": [
          "File: drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c -> drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1077:   return &clk_src->base;",
          "1078:  }",
          "1080:  BREAK_TO_DEBUGGER();",
          "1081:  return NULL;",
          "1082: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1080:  kfree(clk_src);",
          "",
          "---------------"
        ]
      }
    }
  ]
}