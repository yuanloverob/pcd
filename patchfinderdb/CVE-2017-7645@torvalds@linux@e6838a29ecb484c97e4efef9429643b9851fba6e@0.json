{
  "cve_id": "CVE-2017-7645",
  "cve_desc": "The NFSv2/NFSv3 server in the nfsd subsystem in the Linux kernel through 4.10.11 allows remote attackers to cause a denial of service (system crash) via a long RPC reply, related to net/sunrpc/svc.c, fs/nfsd/nfs3xdr.c, and fs/nfsd/nfsxdr.c.",
  "repo": "torvalds/linux",
  "patch_hash": "e6838a29ecb484c97e4efef9429643b9851fba6e",
  "patch_info": {
    "commit_hash": "e6838a29ecb484c97e4efef9429643b9851fba6e",
    "repo": "torvalds/linux",
    "commit_url": "https://github.com/torvalds/linux/commit/e6838a29ecb484c97e4efef9429643b9851fba6e",
    "files": [
      "fs/nfsd/nfssvc.c"
    ],
    "message": "nfsd: check for oversized NFSv2/v3 arguments\n\nA client can append random data to the end of an NFSv2 or NFSv3 RPC call\nwithout our complaining; we'll just stop parsing at the end of the\nexpected data and ignore the rest.\n\nEncoded arguments and replies are stored together in an array of pages,\nand if a call is too large it could leave inadequate space for the\nreply.  This is normally OK because NFS RPC's typically have either\nshort arguments and long replies (like READ) or long arguments and short\nreplies (like WRITE).  But a client that sends an incorrectly long reply\ncan violate those assumptions.  This was observed to cause crashes.\n\nAlso, several operations increment rq_next_page in the decode routine\nbefore checking the argument size, which can leave rq_next_page pointing\nwell past the end of the page array, causing trouble later in\nsvc_free_pages.\n\nSo, following a suggestion from Neil Brown, add a central check to\nenforce our expectation that no NFSv2/v3 call has both a large call and\na large reply.\n\nAs followup we may also want to rewrite the encoding routines to check\nmore carefully that they aren't running off the end of the page array.\n\nWe may also consider rejecting calls that have any extra garbage\nappended.  That would be safer, and within our rights by spec, but given\nthe age of our server and the NFS protocol, and the fact that we've\nnever enforced this before, we may need to balance that against the\npossibility of breaking some oddball client.\n\nReported-by: Tuomas Haanp\u00e4\u00e4 <thaan@synopsys.com>\nReported-by: Ari Kauppi <ari@synopsys.com>\nCc: stable@vger.kernel.org\nReviewed-by: NeilBrown <neilb@suse.com>\nSigned-off-by: J. Bruce Fields <bfields@redhat.com>",
    "before_after_code_files": [
      "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c"
    ]
  },
  "patch_diff": {
    "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c": [
      "File: fs/nfsd/nfssvc.c -> fs/nfsd/nfssvc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "747:  return nfserr;",
      "748: }",
      "750: int",
      "751: nfsd_dispatch(struct svc_rqst *rqstp, __be32 *statp)",
      "752: {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "758: static bool nfs_request_too_big(struct svc_rqst *rqstp,",
      "759:     struct svc_procedure *proc)",
      "760: {",
      "765:  if (rqstp->rq_prog != NFS_PROGRAM)",
      "766:   return false;",
      "771:  if (rqstp->rq_vers >= 4)",
      "772:   return false;",
      "774:  if (proc->pc_xdrressize > 0 &&",
      "775:      proc->pc_xdrressize < XDR_QUADLEN(PAGE_SIZE))",
      "776:   return false;",
      "778:  return rqstp->rq_arg.len > PAGE_SIZE;",
      "779: }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "759:     rqstp->rq_vers, rqstp->rq_proc);",
      "760:  proc = rqstp->rq_procinfo;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "793:  if (nfs_request_too_big(rqstp, proc)) {",
      "794:   dprintk(\"nfsd: NFSv%d argument too large\\n\", rqstp->rq_vers);",
      "796:   return 1;",
      "797:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "860bda29b99afdc072a7a796fe81185f7ae85deb",
      "candidate_info": {
        "commit_hash": "860bda29b99afdc072a7a796fe81185f7ae85deb",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/860bda29b99afdc072a7a796fe81185f7ae85deb",
        "files": [
          "fs/lockd/svc4proc.c",
          "fs/lockd/svcproc.c",
          "fs/nfs/callback_xdr.c",
          "fs/nfsd/nfs2acl.c",
          "fs/nfsd/nfs3acl.c",
          "fs/nfsd/nfs3proc.c",
          "fs/nfsd/nfs4proc.c",
          "fs/nfsd/nfsproc.c",
          "fs/nfsd/nfssvc.c",
          "include/linux/lockd/lockd.h",
          "include/linux/sunrpc/svc.h",
          "net/sunrpc/svc.c"
        ],
        "message": "sunrpc: mark all struct svc_procinfo instances as const\n\nstruct svc_procinfo contains function pointers, and marking it as\nconstant avoids it being able to be used as an attach vector for\ncode injections.\n\nSigned-off-by: Christoph Hellwig <hch@lst.de>",
        "before_after_code_files": [
          "fs/lockd/svc4proc.c||fs/lockd/svc4proc.c",
          "fs/lockd/svcproc.c||fs/lockd/svcproc.c",
          "fs/nfs/callback_xdr.c||fs/nfs/callback_xdr.c",
          "fs/nfsd/nfs2acl.c||fs/nfsd/nfs2acl.c",
          "fs/nfsd/nfs3acl.c||fs/nfsd/nfs3acl.c",
          "fs/nfsd/nfs3proc.c||fs/nfsd/nfs3proc.c",
          "fs/nfsd/nfs4proc.c||fs/nfsd/nfs4proc.c",
          "fs/nfsd/nfsproc.c||fs/nfsd/nfsproc.c",
          "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c",
          "include/linux/lockd/lockd.h||include/linux/lockd/lockd.h",
          "include/linux/sunrpc/svc.h||include/linux/sunrpc/svc.h",
          "net/sunrpc/svc.c||net/sunrpc/svc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c"
          ],
          "candidate": [
            "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c"
          ]
        }
      },
      "candidate_diff": {
        "fs/lockd/svc4proc.c||fs/lockd/svc4proc.c": [
          "File: fs/lockd/svc4proc.c -> fs/lockd/svc4proc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "511:   PROC(null,  void,  void,  void, void, 1),",
          "512:   PROC(test,  testargs, testres, args, res, Ck+St+2+No+Rg),",
          "513:   PROC(lock,  lockargs, res,  args, res, Ck+St),",
          "",
          "[Removed Lines]",
          "510: struct svc_procedure  nlmsvc_procedures4[] = {",
          "",
          "[Added Lines]",
          "510: const struct svc_procedure nlmsvc_procedures4[] = {",
          "",
          "---------------"
        ],
        "fs/lockd/svcproc.c||fs/lockd/svcproc.c": [
          "File: fs/lockd/svcproc.c -> fs/lockd/svcproc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "555:   PROC(null,  void,  void,  void, void, 1),",
          "556:   PROC(test,  testargs, testres, args, res, Ck+St+2+No+Rg),",
          "557:   PROC(lock,  lockargs, res,  args, res, Ck+St),",
          "",
          "[Removed Lines]",
          "554: struct svc_procedure  nlmsvc_procedures[] = {",
          "",
          "[Added Lines]",
          "554: const struct svc_procedure nlmsvc_procedures[] = {",
          "",
          "---------------"
        ],
        "fs/nfs/callback_xdr.c||fs/nfs/callback_xdr.c": [
          "File: fs/nfs/callback_xdr.c -> fs/nfs/callback_xdr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "999:  [CB_NULL] = {",
          "1000:   .pc_func = nfs4_callback_null,",
          "1001:   .pc_decode = nfs4_decode_void,",
          "",
          "[Removed Lines]",
          "998: static struct svc_procedure nfs4_callback_procedures1[] = {",
          "",
          "[Added Lines]",
          "998: static const struct svc_procedure nfs4_callback_procedures1[] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfs2acl.c||fs/nfsd/nfs2acl.c": [
          "File: fs/nfsd/nfs2acl.c -> fs/nfsd/nfs2acl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "374:   PROC(null, void,  void,  void,   RC_NOCACHE, ST),",
          "375:   PROC(getacl, getacl,  getacl,  getacl,   RC_NOCACHE, ST+1+2*(1+ACL)),",
          "376:   PROC(setacl, setacl,  attrstat, attrstat, RC_NOCACHE, ST+AT),",
          "",
          "[Removed Lines]",
          "373: static struct svc_procedure  nfsd_acl_procedures2[] = {",
          "",
          "[Added Lines]",
          "373: static const struct svc_procedure nfsd_acl_procedures2[] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfs3acl.c||fs/nfsd/nfs3acl.c": [
          "File: fs/nfsd/nfs3acl.c -> fs/nfsd/nfs3acl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "261:   PROC(null, void,  void,  void,   RC_NOCACHE, ST),",
          "262:   PROC(getacl, getacl,  getacl,  getacl,   RC_NOCACHE, ST+1+2*(1+ACL)),",
          "263:   PROC(setacl, setacl,  setacl,  fhandle,  RC_NOCACHE, ST+pAT),",
          "",
          "[Removed Lines]",
          "260: static struct svc_procedure  nfsd_acl_procedures3[] = {",
          "",
          "[Added Lines]",
          "260: static const struct svc_procedure nfsd_acl_procedures3[] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfs3proc.c||fs/nfsd/nfs3proc.c": [
          "File: fs/nfsd/nfs3proc.c -> fs/nfsd/nfs3proc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "678:  [NFS3PROC_NULL] = {",
          "679:   .pc_func = nfsd3_proc_null,",
          "680:   .pc_encode = nfs3svc_encode_voidres,",
          "",
          "[Removed Lines]",
          "677: static struct svc_procedure  nfsd_procedures3[22] = {",
          "",
          "[Added Lines]",
          "677: static const struct svc_procedure nfsd_procedures3[22] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfs4proc.c||fs/nfsd/nfs4proc.c": [
          "File: fs/nfsd/nfs4proc.c -> fs/nfsd/nfs4proc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2533: #define nfsd4_voidres   nfsd4_voidargs",
          "2534: struct nfsd4_voidargs { int dummy; };",
          "2537:  [NFSPROC4_NULL] = {",
          "2538:   .pc_func = nfsd4_proc_null,",
          "2539:   .pc_encode = nfs4svc_encode_voidres,",
          "",
          "[Removed Lines]",
          "2536: static struct svc_procedure  nfsd_procedures4[2] = {",
          "",
          "[Added Lines]",
          "2536: static const struct svc_procedure nfsd_procedures4[2] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfsproc.c||fs/nfsd/nfsproc.c": [
          "File: fs/nfsd/nfsproc.c -> fs/nfsd/nfsproc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "577:  [NFSPROC_NULL] = {",
          "578:   .pc_func = nfsd_proc_null,",
          "579:   .pc_decode = nfssvc_decode_void,",
          "",
          "[Removed Lines]",
          "576: static struct svc_procedure  nfsd_procedures2[18] = {",
          "",
          "[Added Lines]",
          "576: static const struct svc_procedure nfsd_procedures2[18] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c": [
          "File: fs/nfsd/nfssvc.c -> fs/nfsd/nfssvc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "758: static bool nfs_request_too_big(struct svc_rqst *rqstp,",
          "760: {",
          "",
          "[Removed Lines]",
          "759:     struct svc_procedure *proc)",
          "",
          "[Added Lines]",
          "759:     const struct svc_procedure *proc)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "781: int",
          "782: nfsd_dispatch(struct svc_rqst *rqstp, __be32 *statp)",
          "783: {",
          "785:  __be32   nfserr;",
          "786:  __be32   *nfserrp;",
          "",
          "[Removed Lines]",
          "784:  struct svc_procedure *proc;",
          "",
          "[Added Lines]",
          "784:  const struct svc_procedure *proc;",
          "",
          "---------------"
        ],
        "include/linux/lockd/lockd.h||include/linux/lockd/lockd.h": [
          "File: include/linux/lockd/lockd.h -> include/linux/lockd/lockd.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "194: extern const struct rpc_program nlm_program;",
          "196: #ifdef CONFIG_LOCKD_V4",
          "198: #endif",
          "199: extern int   nlmsvc_grace_period;",
          "200: extern unsigned long  nlmsvc_timeout;",
          "",
          "[Removed Lines]",
          "195: extern struct svc_procedure nlmsvc_procedures[];",
          "197: extern struct svc_procedure nlmsvc_procedures4[];",
          "",
          "[Added Lines]",
          "195: extern const struct svc_procedure nlmsvc_procedures[];",
          "197: extern const struct svc_procedure nlmsvc_procedures4[];",
          "",
          "---------------"
        ],
        "include/linux/sunrpc/svc.h||include/linux/sunrpc/svc.h": [
          "File: include/linux/sunrpc/svc.h -> include/linux/sunrpc/svc.h"
        ],
        "net/sunrpc/svc.c||net/sunrpc/svc.c": [
          "File: net/sunrpc/svc.c -> net/sunrpc/svc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1152: {",
          "1153:  struct svc_program *progp;",
          "1156:  struct svc_serv  *serv = rqstp->rq_server;",
          "1157:  __be32   *statp;",
          "1158:  u32   prog, vers, proc;",
          "",
          "[Removed Lines]",
          "1155:  struct svc_procedure *procp = NULL;",
          "",
          "[Added Lines]",
          "1155:  const struct svc_procedure *procp = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b9c744c19c441f306239ac3e60a2a95b40d698f8",
      "candidate_info": {
        "commit_hash": "b9c744c19c441f306239ac3e60a2a95b40d698f8",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/b9c744c19c441f306239ac3e60a2a95b40d698f8",
        "files": [
          "fs/lockd/svc4proc.c",
          "fs/lockd/svcproc.c",
          "fs/nfs/callback_xdr.c",
          "fs/nfsd/nfs2acl.c",
          "fs/nfsd/nfs3acl.c",
          "fs/nfsd/nfs3proc.c",
          "fs/nfsd/nfs4proc.c",
          "fs/nfsd/nfsproc.c",
          "fs/nfsd/nfssvc.c",
          "include/linux/lockd/lockd.h",
          "include/linux/sunrpc/svc.h",
          "net/sunrpc/svc.c"
        ],
        "message": "sunrpc: mark all struct svc_procinfo instances as const\n\nstruct svc_procinfo contains function pointers, and marking it as\nconstant avoids it being able to be used as an attach vector for\ncode injections.\n\nSigned-off-by: Christoph Hellwig <hch@lst.de>",
        "before_after_code_files": [
          "fs/lockd/svc4proc.c||fs/lockd/svc4proc.c",
          "fs/lockd/svcproc.c||fs/lockd/svcproc.c",
          "fs/nfs/callback_xdr.c||fs/nfs/callback_xdr.c",
          "fs/nfsd/nfs2acl.c||fs/nfsd/nfs2acl.c",
          "fs/nfsd/nfs3acl.c||fs/nfsd/nfs3acl.c",
          "fs/nfsd/nfs3proc.c||fs/nfsd/nfs3proc.c",
          "fs/nfsd/nfs4proc.c||fs/nfsd/nfs4proc.c",
          "fs/nfsd/nfsproc.c||fs/nfsd/nfsproc.c",
          "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c",
          "include/linux/lockd/lockd.h||include/linux/lockd/lockd.h",
          "include/linux/sunrpc/svc.h||include/linux/sunrpc/svc.h",
          "net/sunrpc/svc.c||net/sunrpc/svc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c"
          ],
          "candidate": [
            "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c"
          ]
        }
      },
      "candidate_diff": {
        "fs/lockd/svc4proc.c||fs/lockd/svc4proc.c": [
          "File: fs/lockd/svc4proc.c -> fs/lockd/svc4proc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "511:   PROC(null,  void,  void,  void, void, 1),",
          "512:   PROC(test,  testargs, testres, args, res, Ck+St+2+No+Rg),",
          "513:   PROC(lock,  lockargs, res,  args, res, Ck+St),",
          "",
          "[Removed Lines]",
          "510: struct svc_procedure  nlmsvc_procedures4[] = {",
          "",
          "[Added Lines]",
          "510: const struct svc_procedure nlmsvc_procedures4[] = {",
          "",
          "---------------"
        ],
        "fs/lockd/svcproc.c||fs/lockd/svcproc.c": [
          "File: fs/lockd/svcproc.c -> fs/lockd/svcproc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "555:   PROC(null,  void,  void,  void, void, 1),",
          "556:   PROC(test,  testargs, testres, args, res, Ck+St+2+No+Rg),",
          "557:   PROC(lock,  lockargs, res,  args, res, Ck+St),",
          "",
          "[Removed Lines]",
          "554: struct svc_procedure  nlmsvc_procedures[] = {",
          "",
          "[Added Lines]",
          "554: const struct svc_procedure nlmsvc_procedures[] = {",
          "",
          "---------------"
        ],
        "fs/nfs/callback_xdr.c||fs/nfs/callback_xdr.c": [
          "File: fs/nfs/callback_xdr.c -> fs/nfs/callback_xdr.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "999:  [CB_NULL] = {",
          "1000:   .pc_func = nfs4_callback_null,",
          "1001:   .pc_decode = nfs4_decode_void,",
          "",
          "[Removed Lines]",
          "998: static struct svc_procedure nfs4_callback_procedures1[] = {",
          "",
          "[Added Lines]",
          "998: static const struct svc_procedure nfs4_callback_procedures1[] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfs2acl.c||fs/nfsd/nfs2acl.c": [
          "File: fs/nfsd/nfs2acl.c -> fs/nfsd/nfs2acl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "374:   PROC(null, void,  void,  void,   RC_NOCACHE, ST),",
          "375:   PROC(getacl, getacl,  getacl,  getacl,   RC_NOCACHE, ST+1+2*(1+ACL)),",
          "376:   PROC(setacl, setacl,  attrstat, attrstat, RC_NOCACHE, ST+AT),",
          "",
          "[Removed Lines]",
          "373: static struct svc_procedure  nfsd_acl_procedures2[] = {",
          "",
          "[Added Lines]",
          "373: static const struct svc_procedure nfsd_acl_procedures2[] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfs3acl.c||fs/nfsd/nfs3acl.c": [
          "File: fs/nfsd/nfs3acl.c -> fs/nfsd/nfs3acl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "261:   PROC(null, void,  void,  void,   RC_NOCACHE, ST),",
          "262:   PROC(getacl, getacl,  getacl,  getacl,   RC_NOCACHE, ST+1+2*(1+ACL)),",
          "263:   PROC(setacl, setacl,  setacl,  fhandle,  RC_NOCACHE, ST+pAT),",
          "",
          "[Removed Lines]",
          "260: static struct svc_procedure  nfsd_acl_procedures3[] = {",
          "",
          "[Added Lines]",
          "260: static const struct svc_procedure nfsd_acl_procedures3[] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfs3proc.c||fs/nfsd/nfs3proc.c": [
          "File: fs/nfsd/nfs3proc.c -> fs/nfsd/nfs3proc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "678:  [NFS3PROC_NULL] = {",
          "679:   .pc_func = nfsd3_proc_null,",
          "680:   .pc_encode = nfs3svc_encode_voidres,",
          "",
          "[Removed Lines]",
          "677: static struct svc_procedure  nfsd_procedures3[22] = {",
          "",
          "[Added Lines]",
          "677: static const struct svc_procedure nfsd_procedures3[22] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfs4proc.c||fs/nfsd/nfs4proc.c": [
          "File: fs/nfsd/nfs4proc.c -> fs/nfsd/nfs4proc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2532: #define nfsd4_voidres   nfsd4_voidargs",
          "2533: struct nfsd4_voidargs { int dummy; };",
          "2536:  [NFSPROC4_NULL] = {",
          "2537:   .pc_func = nfsd4_proc_null,",
          "2538:   .pc_encode = nfs4svc_encode_voidres,",
          "",
          "[Removed Lines]",
          "2535: static struct svc_procedure  nfsd_procedures4[2] = {",
          "",
          "[Added Lines]",
          "2535: static const struct svc_procedure nfsd_procedures4[2] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfsproc.c||fs/nfsd/nfsproc.c": [
          "File: fs/nfsd/nfsproc.c -> fs/nfsd/nfsproc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "577:  [NFSPROC_NULL] = {",
          "578:   .pc_func = nfsd_proc_null,",
          "579:   .pc_decode = nfssvc_decode_void,",
          "",
          "[Removed Lines]",
          "576: static struct svc_procedure  nfsd_procedures2[18] = {",
          "",
          "[Added Lines]",
          "576: static const struct svc_procedure nfsd_procedures2[18] = {",
          "",
          "---------------"
        ],
        "fs/nfsd/nfssvc.c||fs/nfsd/nfssvc.c": [
          "File: fs/nfsd/nfssvc.c -> fs/nfsd/nfssvc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "758: static bool nfs_request_too_big(struct svc_rqst *rqstp,",
          "760: {",
          "",
          "[Removed Lines]",
          "759:     struct svc_procedure *proc)",
          "",
          "[Added Lines]",
          "759:     const struct svc_procedure *proc)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "781: int",
          "782: nfsd_dispatch(struct svc_rqst *rqstp, __be32 *statp)",
          "783: {",
          "785:  __be32   nfserr;",
          "786:  __be32   *nfserrp;",
          "",
          "[Removed Lines]",
          "784:  struct svc_procedure *proc;",
          "",
          "[Added Lines]",
          "784:  const struct svc_procedure *proc;",
          "",
          "---------------"
        ],
        "include/linux/lockd/lockd.h||include/linux/lockd/lockd.h": [
          "File: include/linux/lockd/lockd.h -> include/linux/lockd/lockd.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "194: extern const struct rpc_program nlm_program;",
          "196: #ifdef CONFIG_LOCKD_V4",
          "198: #endif",
          "199: extern int   nlmsvc_grace_period;",
          "200: extern unsigned long  nlmsvc_timeout;",
          "",
          "[Removed Lines]",
          "195: extern struct svc_procedure nlmsvc_procedures[];",
          "197: extern struct svc_procedure nlmsvc_procedures4[];",
          "",
          "[Added Lines]",
          "195: extern const struct svc_procedure nlmsvc_procedures[];",
          "197: extern const struct svc_procedure nlmsvc_procedures4[];",
          "",
          "---------------"
        ],
        "include/linux/sunrpc/svc.h||include/linux/sunrpc/svc.h": [
          "File: include/linux/sunrpc/svc.h -> include/linux/sunrpc/svc.h"
        ],
        "net/sunrpc/svc.c||net/sunrpc/svc.c": [
          "File: net/sunrpc/svc.c -> net/sunrpc/svc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1152: {",
          "1153:  struct svc_program *progp;",
          "1156:  struct svc_serv  *serv = rqstp->rq_server;",
          "1157:  __be32   *statp;",
          "1158:  u32   prog, vers, proc;",
          "",
          "[Removed Lines]",
          "1155:  struct svc_procedure *procp = NULL;",
          "",
          "[Added Lines]",
          "1155:  const struct svc_procedure *procp = NULL;",
          "",
          "---------------"
        ]
      }
    }
  ]
}