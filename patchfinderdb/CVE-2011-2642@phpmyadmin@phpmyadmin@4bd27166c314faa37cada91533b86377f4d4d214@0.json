{
  "cve_id": "CVE-2011-2642",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in the table Print view implementation in tbl_printview.php in phpMyAdmin before 3.3.10.3 and 3.4.x before 3.4.3.2 allow remote authenticated users to inject arbitrary web script or HTML via a crafted table name.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "4bd27166c314faa37cada91533b86377f4d4d214",
  "patch_info": {
    "commit_hash": "4bd27166c314faa37cada91533b86377f4d4d214",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/4bd27166c314faa37cada91533b86377f4d4d214",
    "files": [
      "tbl_printview.php"
    ],
    "message": "Another case of XSS",
    "before_after_code_files": [
      "tbl_printview.php||tbl_printview.php"
    ]
  },
  "patch_diff": {
    "tbl_printview.php||tbl_printview.php": [
      "File: tbl_printview.php -> tbl_printview.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "69:         $tbl_list .= (empty($tbl_list) ? '' : ', ')",
      "70:                   . PMA_backquote($table);",
      "71:     }",
      "73:     echo '<hr />' . \"\\n\";",
      "74: } // end if",
      "",
      "[Removed Lines]",
      "72:     echo '<strong>'.  __('Show tables') . ': ' . $tbl_list . '</strong>' . \"\\n\";",
      "",
      "[Added Lines]",
      "72:     echo '<strong>'.  __('Show tables') . ': ' . htmlspecialchars($tbl_list) . '</strong>' . \"\\n\";",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "33bfd831ce1386212ff741f76f79be5ca63640a6",
      "candidate_info": {
        "commit_hash": "33bfd831ce1386212ff741f76f79be5ca63640a6",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/33bfd831ce1386212ff741f76f79be5ca63640a6",
        "files": [
          "tbl_printview.php"
        ],
        "message": "Wrap some long lines",
        "before_after_code_files": [
          "tbl_printview.php||tbl_printview.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tbl_printview.php||tbl_printview.php"
          ],
          "candidate": [
            "tbl_printview.php||tbl_printview.php"
          ]
        }
      },
      "candidate_diff": {
        "tbl_printview.php||tbl_printview.php": [
          "File: tbl_printview.php -> tbl_printview.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "69:         $tbl_list .= (empty($tbl_list) ? '' : ', ')",
          "70:                   . PMA_backquote($table);",
          "71:     }",
          "73:     echo '<hr />' . \"\\n\";",
          "74: } // end if",
          "",
          "[Removed Lines]",
          "72:     echo '<strong>'.  __('Showing tables') . ': ' . htmlspecialchars($tbl_list) . '</strong>' . \"\\n\";",
          "",
          "[Added Lines]",
          "72:     echo '<strong>'.  __('Showing tables') . ': '",
          "73:         . htmlspecialchars($tbl_list) . '</strong>' . \"\\n\";",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "124:     if (!empty($show_comment)) {",
          "126:     }",
          "",
          "[Removed Lines]",
          "125:         echo __('Table comments') . ': ' . htmlspecialchars($show_comment) . '<br /><br />';",
          "",
          "[Added Lines]",
          "126:         echo __('Table comments') . ': '",
          "127:             . htmlspecialchars($show_comment) . '<br /><br />';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "178:             $row['Null'] = '';",
          "179:         }",
          "",
          "[Removed Lines]",
          "177:         if (!empty($analyzed_sql[0]['create_table_fields'][$field_name]['type']) && $analyzed_sql[0]['create_table_fields'][$field_name]['type'] == 'TIMESTAMP' && $analyzed_sql[0]['create_table_fields'][$field_name]['timestamp_not_null']) {",
          "",
          "[Added Lines]",
          "179:         if (!empty($analyzed_sql[0]['create_table_fields'][$field_name]['type'])",
          "180:             && $analyzed_sql[0]['create_table_fields'][$field_name]['type'] == 'TIMESTAMP'",
          "181:             && $analyzed_sql[0]['create_table_fields'][$field_name]['timestamp_not_null']",
          "182:         ) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "192:     echo (($row['Null'] == '' || $row['Null'] == 'NO')",
          "193:         ? __('No')",
          "194:         : __('Yes')); ?>&nbsp;</td>",
          "196:     if (isset($row['Default'])) {",
          "197:         echo $row['Default'];",
          "199:     <?php",
          "200:         if ($have_rel) {",
          "201:             echo '    <td>';",
          "",
          "[Removed Lines]",
          "195:     <td><?php",
          "198:     } ?>&nbsp;</td>",
          "",
          "[Added Lines]",
          "200:     <td>",
          "201:     <?php",
          "204:     }",
          "205:     ?>&nbsp;</td>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "97b52b0fd35ce76fd814ddcf2a458334628fe305",
      "candidate_info": {
        "commit_hash": "97b52b0fd35ce76fd814ddcf2a458334628fe305",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/97b52b0fd35ce76fd814ddcf2a458334628fe305",
        "files": [
          "tbl_printview.php"
        ],
        "message": "Fix message",
        "before_after_code_files": [
          "tbl_printview.php||tbl_printview.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tbl_printview.php||tbl_printview.php"
          ],
          "candidate": [
            "tbl_printview.php||tbl_printview.php"
          ]
        }
      },
      "candidate_diff": {
        "tbl_printview.php||tbl_printview.php": [
          "File: tbl_printview.php -> tbl_printview.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "69:         $tbl_list .= (empty($tbl_list) ? '' : ', ')",
          "70:                   . PMA_backquote($table);",
          "71:     }",
          "73:     echo '<hr />' . \"\\n\";",
          "74: } // end if",
          "",
          "[Removed Lines]",
          "72:     echo '<strong>'.  __('Show tables') . ': ' . htmlspecialchars($tbl_list) . '</strong>' . \"\\n\";",
          "",
          "[Added Lines]",
          "72:     echo '<strong>'.  __('Showing tables') . ': ' . htmlspecialchars($tbl_list) . '</strong>' . \"\\n\";",
          "",
          "---------------"
        ]
      }
    }
  ]
}