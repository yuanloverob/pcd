{
  "cve_id": "CVE-2016-0789",
  "cve_desc": "CRLF injection vulnerability in the CLI command documentation in Jenkins before 1.650 and LTS before 1.642.2 allows remote attackers to inject arbitrary HTTP headers and conduct HTTP response splitting attacks via unspecified vectors.",
  "repo": "jenkinsci/jenkins",
  "patch_hash": "f5c51fbad2b62b81dc1e0402aeee058a4a478046",
  "patch_info": {
    "commit_hash": "f5c51fbad2b62b81dc1e0402aeee058a4a478046",
    "repo": "jenkinsci/jenkins",
    "commit_url": "https://github.com/jenkinsci/jenkins/commit/f5c51fbad2b62b81dc1e0402aeee058a4a478046",
    "files": [
      "core/src/main/java/hudson/cli/CLIAction.java"
    ],
    "message": "[FIX SECURITY-238] Don't echo command name",
    "before_after_code_files": [
      "core/src/main/java/hudson/cli/CLIAction.java||core/src/main/java/hudson/cli/CLIAction.java"
    ]
  },
  "patch_diff": {
    "core/src/main/java/hudson/cli/CLIAction.java||core/src/main/java/hudson/cli/CLIAction.java": [
      "File: core/src/main/java/hudson/cli/CLIAction.java -> core/src/main/java/hudson/cli/CLIAction.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "78:         final String commandName = req.getRestOfPath().substring(1);",
      "79:         CLICommand command = CLICommand.clone(commandName);",
      "80:         if (command == null) {",
      "82:             return;",
      "83:         }",
      "",
      "[Removed Lines]",
      "81:             rsp.sendError(HttpServletResponse.SC_NOT_FOUND, \"No such command \" + commandName);",
      "",
      "[Added Lines]",
      "81:             rsp.sendError(HttpServletResponse.SC_NOT_FOUND, \"No such command\");",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "79e0b64322a6b15e0b80ac6511c9aa74383642be",
      "candidate_info": {
        "commit_hash": "79e0b64322a6b15e0b80ac6511c9aa74383642be",
        "repo": "jenkinsci/jenkins",
        "commit_url": "https://github.com/jenkinsci/jenkins/commit/79e0b64322a6b15e0b80ac6511c9aa74383642be",
        "files": [
          "core/src/main/java/jenkins/security/ApiTokenProperty.java"
        ],
        "message": "[FIX SECURITY-241] Compare API tokens in constant time",
        "before_after_code_files": [
          "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/jenkinsci/jenkins/pull/2063"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java": [
          "File: core/src/main/java/jenkins/security/ApiTokenProperty.java -> core/src/main/java/jenkins/security/ApiTokenProperty.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "41: import org.kohsuke.stapler.StaplerResponse;",
          "43: import java.io.IOException;",
          "44: import java.security.SecureRandom;",
          "45: import javax.annotation.Nonnull;",
          "46: import org.apache.commons.lang.StringUtils;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44: import java.security.MessageDigest;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "109:     }",
          "111:     public boolean matchesPassword(String password) {",
          "113:     }",
          "115:     private boolean hasPermissionToSeeToken() {",
          "",
          "[Removed Lines]",
          "112:         return  getApiTokenInsecure().equals(password);",
          "",
          "[Added Lines]",
          "113:         String token = getApiTokenInsecure();",
          "114:         return MessageDigest.isEqual(password.getBytes(), token.getBytes());",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "76d1958ebe17bc89a5e8b249ecc965de728bd669",
      "candidate_info": {
        "commit_hash": "76d1958ebe17bc89a5e8b249ecc965de728bd669",
        "repo": "jenkinsci/jenkins",
        "commit_url": "https://github.com/jenkinsci/jenkins/commit/76d1958ebe17bc89a5e8b249ecc965de728bd669",
        "files": [
          "core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java"
        ],
        "message": "[SECURITY-245] Use US-ASCII to prevent charset issues",
        "before_after_code_files": [
          "core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java||core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/jenkinsci/jenkins/pull/2063"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java||core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java": [
          "File: core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java -> core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: package hudson.security.csrf;",
          "8: import java.security.MessageDigest;",
          "9: import java.security.NoSuchAlgorithmException;",
          "10: import java.util.logging.Level;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: import java.nio.charset.Charset;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "96:             String newCrumb = issueCrumb(request, salt);",
          "97:             if ((newCrumb != null) && (crumb != null)) {",
          "100:             }",
          "101:         }",
          "102:         return false;",
          "",
          "[Removed Lines]",
          "99:                 return MessageDigest.isEqual(newCrumb.getBytes(), crumb.getBytes());",
          "",
          "[Added Lines]",
          "100:                 return MessageDigest.isEqual(newCrumb.getBytes(Charset.forName(\"US-ASCII\")),",
          "101:                         crumb.getBytes(Charset.forName(\"US-ASCII\")));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "679da79f5492249c713e3f887ccfa37d56043cba",
      "candidate_info": {
        "commit_hash": "679da79f5492249c713e3f887ccfa37d56043cba",
        "repo": "jenkinsci/jenkins",
        "commit_url": "https://github.com/jenkinsci/jenkins/commit/679da79f5492249c713e3f887ccfa37d56043cba",
        "files": [
          "core/src/main/resources/hudson/ProxyConfiguration/help-name_de.html"
        ],
        "message": "Update German localization\n\nRemoves mention of http.proxyHost property",
        "before_after_code_files": [
          "core/src/main/resources/hudson/ProxyConfiguration/help-name_de.html||core/src/main/resources/hudson/ProxyConfiguration/help-name_de.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/jenkinsci/jenkins/pull/2063"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "core/src/main/resources/hudson/ProxyConfiguration/help-name_de.html||core/src/main/resources/hudson/ProxyConfiguration/help-name_de.html": [
          "File: core/src/main/resources/hudson/ProxyConfiguration/help-name_de.html -> core/src/main/resources/hudson/ProxyConfiguration/help-name_de.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "9:   und Plugins herunterzuladen.",
          "11:   <p>",
          "16:   <p>",
          "17:   Wenn Sie sich nicht sicher sind, was Sie hier eintragen sollen, schauen Sie",
          "18:   in der Proxy-Konfiguration Ihres Browsers nach.",
          "",
          "[Removed Lines]",
          "12:   Der Wert, den Sie hier angeben, wird als Systemeigenschaft <tt>http.proxyHost</tt>",
          "13:   gesetzt. Wenn Sie dieses Feld freilassen, wird die Systemeigenschaft gel\u00f6scht.",
          "14:   Jenkins versucht dann, das Update-Center direkt zu kontaktieren.",
          "19: </div>",
          "",
          "[Added Lines]",
          "12:   Wenn Sie dieses Feld freilassen, versucht Jenkins, das Update-Center direkt zu kontaktieren.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "39642a49c32b3da42aa7d34b2bb81607c6aa98e5",
      "candidate_info": {
        "commit_hash": "39642a49c32b3da42aa7d34b2bb81607c6aa98e5",
        "repo": "jenkinsci/jenkins",
        "commit_url": "https://github.com/jenkinsci/jenkins/commit/39642a49c32b3da42aa7d34b2bb81607c6aa98e5",
        "files": [
          "changelog.html"
        ],
        "message": "[FIXED JENKINS-33068] Recording merge",
        "before_after_code_files": [
          "changelog.html||changelog.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/jenkinsci/jenkins/pull/2063"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "changelog.html||changelog.html": [
          "File: changelog.html -> changelog.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "55: <!-- Record your changes in the trunk here. -->",
          "56: <div id=\"trunk\" style=\"display:none\"><!--=TRUNK-BEGIN=-->",
          "57: <ul class=image>",
          "59: </ul>",
          "60: </div><!--=TRUNK-END=-->",
          "61: <h3><a name=v1.650>What's new in 1.650</a> (2016/02/24)</h3>",
          "",
          "[Removed Lines]",
          "58:   <li class=>",
          "",
          "[Added Lines]",
          "58:   <li class=\"rfe\">",
          "59:     Move periodic task logfiles from <code>JENKINS_HOME/*.log</code> to <code>JENKINS_HOME/logs/tasks/*.log</code> and rotate them periodically rather than overwrite every execution",
          "60:     (<a href-\"https://issues.jenkins-ci.org/browse/JENKINS-33068\">issue 33068</a>)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "def5bdb1984705be3c41be8bca4fd387db084eda",
      "candidate_info": {
        "commit_hash": "def5bdb1984705be3c41be8bca4fd387db084eda",
        "repo": "jenkinsci/jenkins",
        "commit_url": "https://github.com/jenkinsci/jenkins/commit/def5bdb1984705be3c41be8bca4fd387db084eda",
        "files": [
          "core/src/main/java/jenkins/security/ApiTokenProperty.java"
        ],
        "message": "[SECURITY-241] Use US-ASCII to prevent charset issues",
        "before_after_code_files": [
          "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/jenkinsci/jenkins/pull/2063"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "core/src/main/java/jenkins/security/ApiTokenProperty.java||core/src/main/java/jenkins/security/ApiTokenProperty.java": [
          "File: core/src/main/java/jenkins/security/ApiTokenProperty.java -> core/src/main/java/jenkins/security/ApiTokenProperty.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "41: import org.kohsuke.stapler.StaplerResponse;",
          "43: import java.io.IOException;",
          "44: import java.security.MessageDigest;",
          "45: import java.security.SecureRandom;",
          "46: import javax.annotation.Nonnull;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44: import java.nio.charset.Charset;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "112:     public boolean matchesPassword(String password) {",
          "113:         String token = getApiTokenInsecure();",
          "115:     }",
          "117:     private boolean hasPermissionToSeeToken() {",
          "",
          "[Removed Lines]",
          "114:         return MessageDigest.isEqual(password.getBytes(), token.getBytes());",
          "",
          "[Added Lines]",
          "115:         return MessageDigest.isEqual(password.getBytes(Charset.forName(\"US-ASCII\")),",
          "116:                 token.getBytes(Charset.forName(\"US-ASCII\")));",
          "",
          "---------------"
        ]
      }
    }
  ]
}