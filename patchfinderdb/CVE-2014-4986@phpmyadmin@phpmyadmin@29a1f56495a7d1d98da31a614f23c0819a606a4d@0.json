{
  "cve_id": "CVE-2014-4986",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in js/functions.js in phpMyAdmin 4.0.x before 4.0.10.1, 4.1.x before 4.1.14.2, and 4.2.x before 4.2.6 allow remote authenticated users to inject arbitrary web script or HTML via a crafted (1) table name or (2) column name that is improperly handled during construction of an AJAX confirmation message.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "29a1f56495a7d1d98da31a614f23c0819a606a4d",
  "patch_info": {
    "commit_hash": "29a1f56495a7d1d98da31a614f23c0819a606a4d",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/29a1f56495a7d1d98da31a614f23c0819a606a4d",
    "files": [
      "ChangeLog",
      "js/functions.js",
      "js/tbl_structure.js"
    ],
    "message": "bug #4492 [security] XSS in AJAX confirmation messages\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
    "before_after_code_files": [
      "js/functions.js||js/functions.js",
      "js/tbl_structure.js||js/tbl_structure.js"
    ]
  },
  "patch_diff": {
    "js/functions.js||js/functions.js": [
      "File: js/functions.js -> js/functions.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "3548:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
      "3549:         question += $.sprintf(",
      "3550:             PMA_messages.strDoYouReally,",
      "3552:         );",
      "3554:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
      "",
      "[Removed Lines]",
      "3551:             'DROP TABLE ' + PMA_commonParams.get('table')",
      "",
      "[Added Lines]",
      "3551:             'DROP TABLE ' + escapeHtml(PMA_commonParams.get('table'))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "3614:         var question = PMA_messages.strTruncateTableStrongWarning + ' ';",
      "3615:         question += $.sprintf(",
      "3616:             PMA_messages.strDoYouReally,",
      "3618:         );",
      "3619:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
      "3620:             PMA_ajaxShowMessage(PMA_messages.strProcessingRequest);",
      "",
      "[Removed Lines]",
      "3617:             'TRUNCATE ' + PMA_commonParams.get('table')",
      "",
      "[Added Lines]",
      "3617:             'TRUNCATE ' + escapeHtml(PMA_commonParams.get('table'))",
      "",
      "---------------"
    ],
    "js/tbl_structure.js||js/tbl_structure.js": [
      "File: js/tbl_structure.js -> js/tbl_structure.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "200:         var curr_column_name = $curr_row.children('th').children('label').text();",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "201:         curr_column_name = escapeHtml(curr_column_name);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a92753bd65e1f8b72c46ed3dda6c362628e0daf7",
      "candidate_info": {
        "commit_hash": "a92753bd65e1f8b72c46ed3dda6c362628e0daf7",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/a92753bd65e1f8b72c46ed3dda6c362628e0daf7",
        "files": [
          "ChangeLog",
          "js/functions.js",
          "js/tbl_structure.js"
        ],
        "message": "bug #4492 [security] XSS in AJAX confirmation messages\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "js/functions.js||js/functions.js",
          "js/tbl_structure.js||js/tbl_structure.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js",
            "js/tbl_structure.js||js/tbl_structure.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js",
            "js/tbl_structure.js||js/tbl_structure.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3368:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
          "3369:         question += $.sprintf(",
          "3370:             PMA_messages.strDoYouReally,",
          "3372:         );",
          "3374:         $(this).PMA_confirm(question, $(this).attr('href'), function(url) {",
          "",
          "[Removed Lines]",
          "3371:             'DROP TABLE ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3371:             'DROP TABLE ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3401:         var question = PMA_messages.strTruncateTableStrongWarning + ' ';",
          "3402:         question += $.sprintf(",
          "3403:             PMA_messages.strDoYouReally,",
          "3405:         );",
          "3406:         $(this).PMA_confirm(question, $(this).attr('href'), function(url) {",
          "3407:             PMA_ajaxShowMessage(PMA_messages['strProcessingRequest']);",
          "",
          "[Removed Lines]",
          "3404:             'TRUNCATE ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3404:             'TRUNCATE ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------"
        ],
        "js/tbl_structure.js||js/tbl_structure.js": [
          "File: js/tbl_structure.js -> js/tbl_structure.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "146:         var curr_column_name = $curr_row.children('th').children('label').text();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "147:         curr_column_name = escapeHtml(curr_column_name);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "cd5697027a2ee7e1f7d7000b23be6051cdb0516c",
      "candidate_info": {
        "commit_hash": "cd5697027a2ee7e1f7d7000b23be6051cdb0516c",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/cd5697027a2ee7e1f7d7000b23be6051cdb0516c",
        "files": [
          "ChangeLog",
          "js/functions.js",
          "js/tbl_structure.js"
        ],
        "message": "bug #4492 [security] XSS in AJAX confirmation messages\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
        "before_after_code_files": [
          "js/functions.js||js/functions.js",
          "js/tbl_structure.js||js/tbl_structure.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js",
            "js/tbl_structure.js||js/tbl_structure.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js",
            "js/tbl_structure.js||js/tbl_structure.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3519:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
          "3520:         question += $.sprintf(",
          "3521:             PMA_messages.strDoYouReally,",
          "3523:         );",
          "3525:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
          "",
          "[Removed Lines]",
          "3522:             'DROP TABLE ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3522:             'DROP TABLE ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3585:         var question = PMA_messages.strTruncateTableStrongWarning + ' ';",
          "3586:         question += $.sprintf(",
          "3587:             PMA_messages.strDoYouReally,",
          "3589:         );",
          "3590:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
          "3591:             PMA_ajaxShowMessage(PMA_messages.strProcessingRequest);",
          "",
          "[Removed Lines]",
          "3588:             'TRUNCATE ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3588:             'TRUNCATE ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------"
        ],
        "js/tbl_structure.js||js/tbl_structure.js": [
          "File: js/tbl_structure.js -> js/tbl_structure.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "199:         var curr_column_name = $curr_row.children('th').children('label').text();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "200:         curr_column_name = escapeHtml(curr_column_name);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "65eef3d65411b985250487e14f1121754a91c6d5",
      "candidate_info": {
        "commit_hash": "65eef3d65411b985250487e14f1121754a91c6d5",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/65eef3d65411b985250487e14f1121754a91c6d5",
        "files": [
          "ChangeLog",
          "js/functions.js"
        ],
        "message": "bug #4505 [security] XSS in view operations page\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "js/functions.js||js/functions.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "js/functions.js||js/functions.js"
          ],
          "candidate": [
            "js/functions.js||js/functions.js"
          ]
        }
      },
      "candidate_diff": {
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3552:         var question = PMA_messages.strDropTableStrongWarning + ' ';",
          "3553:         question += $.sprintf(",
          "3554:             PMA_messages.strDoYouReally,",
          "3556:         );",
          "3558:         $(this).PMA_confirm(question, $(this).attr('href'), function (url) {",
          "",
          "[Removed Lines]",
          "3555:             'DROP VIEW ' + PMA_commonParams.get('table')",
          "",
          "[Added Lines]",
          "3555:             'DROP VIEW ' + escapeHtml(PMA_commonParams.get('table'))",
          "",
          "---------------"
        ]
      }
    }
  ]
}