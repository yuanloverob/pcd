{
  "cve_id": "CVE-2015-8896",
  "cve_desc": "Integer truncation issue in coders/pict.c in ImageMagick before 7.0.5-0 allows remote attackers to cause a denial of service (application crash) via a crafted .pict file.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734",
  "patch_info": {
    "commit_hash": "0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/0f6fc2d5bf8f500820c3dbcf0d23ee14f2d9f734",
    "files": [
      "MagickCore/memory.c",
      "MagickCore/studio.h",
      "MagickCore/version.c",
      "MagickCore/version.h",
      "MagickWand/studio.h",
      "coders/icon.c",
      "coders/pict.c",
      "configure",
      "configure.ac"
    ],
    "message": "",
    "before_after_code_files": [
      "MagickCore/memory.c||MagickCore/memory.c",
      "MagickCore/studio.h||MagickCore/studio.h",
      "MagickCore/version.c||MagickCore/version.c",
      "MagickCore/version.h||MagickCore/version.h",
      "MagickWand/studio.h||MagickWand/studio.h",
      "coders/icon.c||coders/icon.c",
      "coders/pict.c||coders/pict.c",
      "configure.ac||configure.ac"
    ]
  },
  "patch_diff": {
    "MagickCore/memory.c||MagickCore/memory.c": [
      "File: MagickCore/memory.c -> MagickCore/memory.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "606:     }",
      "607:   if ((memory_info->blob == NULL) &&",
      "608:       (AcquireMagickResource(MapResource,length) != MagickFalse))",
      "611:         Heap memory failed, try anonymous memory mapping.",
      "",
      "[Removed Lines]",
      "609:     {",
      "",
      "[Added Lines]",
      "609:     {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "615:         memory_info->type=MapVirtualMemory;",
      "616:       else",
      "617:         RelinquishMagickResource(MapResource,length);",
      "619:   if (memory_info->blob == NULL)",
      "621:       int",
      "627:       file=AcquireUniqueFileResource(memory_info->filename);",
      "628:       if (file != -1)",
      "629:         {",
      "",
      "[Removed Lines]",
      "618:     }",
      "620:     {",
      "622:         file;",
      "625:         Anonymous memory mapping failed, try file-backed memory mapping.",
      "",
      "[Added Lines]",
      "619:   if ((memory_info->blob == NULL) &&",
      "620:       (AcquireMagickResource(DiskResource,length) != MagickFalse))",
      "621:     {",
      "623:         file;",
      "628:       file=AcquireUniqueFileResource(memory_info->filename);",
      "629:       if (file == -1)",
      "631:       else",
      "632:         {",
      "633:           if ((lseek(file,length-1,SEEK_SET) < 0) || (write(file,\"\",1) != 1))",
      "634:             RelinquishMagickResource(DiskResource,length);",
      "635:           else",
      "636:             {",
      "637:               if (AcquireMagickResource(MapResource,length) == MagickFalse)",
      "638:                 RelinquishMagickResource(DiskResource,length);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1033: %",
      "1035: MagickExport MemoryInfo *RelinquishVirtualMemory(MemoryInfo *memory_info)",
      "1037:   assert(memory_info != (MemoryInfo *) NULL);",
      "1038:   assert(memory_info->signature == MagickSignature);",
      "1039:   if (memory_info->blob != (void *) NULL)",
      "",
      "[Removed Lines]",
      "1036: {",
      "",
      "[Added Lines]",
      "1048: {",
      "1049:   assert(memory_info != (MemoryInfo *) NULL);",
      "1050:   assert(memory_info->signature == MagickSignature);",
      "1051:   if (memory_info->blob != (void *) NULL)",
      "",
      "---------------"
    ],
    "MagickCore/studio.h||MagickCore/studio.h": [
      "File: MagickCore/studio.h -> MagickCore/studio.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "46: #if defined(_magickcore_inline) && !defined(inline)",
      "47: # define inline  _magickcore_inline",
      "48: #endif",
      "52: # if defined(__cplusplus) || defined(c_plusplus)",
      "53: #  undef inline",
      "54: # endif",
      "",
      "[Removed Lines]",
      "49: #if defined(_magickcore_restrict) && !defined(restrict)",
      "50: # define restrict  _magickcore_restrict",
      "51: #endif",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "75: #  include <stdlib.h>",
      "76: # endif",
      "77: #endif",
      "78: #if defined(MAGICKCORE_HAVE_STRING_H)",
      "79: # if !defined(STDC_HEADERS) && defined(MAGICKCORE_HAVE_MEMORY_H)",
      "80: #  include <memory.h>",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "75: #if defined(_magickcore_restrict) && !defined(restrict)",
      "76: # define restrict  _magickcore_restrict",
      "77: #endif",
      "",
      "---------------"
    ],
    "MagickCore/version.c||MagickCore/version.c": [
      "File: MagickCore/version.c -> MagickCore/version.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "219: %      const char *GetMagickFeatures(void)",
      "220: %",
      "221: %  No parameters are required.",
      "224: MagickExport const char *GetMagickFeatures(void)",
      "225: {",
      "226:   return \"DPC\"",
      "227: #if defined(MAGICKCORE_BUILD_MODULES) || defined(_DLL)",
      "228:   \" Modules\"",
      "229: #endif",
      "230: #if defined(MAGICKCORE_HDRI_SUPPORT)",
      "231:   \" HDRI\"",
      "232: #endif",
      "233: #if defined(MAGICKCORE_OPENCL_SUPPORT)",
      "234:   \" OpenCL\"",
      "235: #endif",
      "",
      "[Removed Lines]",
      "222: %",
      "",
      "[Added Lines]",
      "222: %",
      "224: MagickExport const char *GetMagickFeatures(void)",
      "225: {",
      "226:   return \"DPC\"",
      "231:   \" Cipher\"",
      "232: #endif",
      "233: #if defined(MAGICKCORE_HDRI_SUPPORT)",
      "239: #if defined(MAGICKCORE_OPENCL_SUPPORT)",
      "240:   \" OpenCL\"",
      "241: #endif",
      "",
      "---------------"
    ],
    "MagickCore/version.h||MagickCore/version.h": [
      "File: MagickCore/version.h -> MagickCore/version.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "28: #define MagickPackageName \"ImageMagick\"",
      "29: #define MagickCopyright  \"Copyright (C) 1999-2015 ImageMagick Studio LLC\"",
      "31: #define MagickLibVersion  0x700",
      "32: #define MagickLibVersionText  \"7.0.0\"",
      "33: #define MagickLibVersionNumber  0,0,0",
      "",
      "[Removed Lines]",
      "30: #define MagickSVNRevision  \"18658:18662M\"",
      "",
      "[Added Lines]",
      "30: #define MagickSVNRevision  \"18670M\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "48: #define MagickppLibAddendum  \"-0\"",
      "49: #define MagickppLibInterface  0",
      "50: #define MagickppLibMinInterface  0",
      "52: #define MagickChangeDate   \"20120427\"",
      "53: #define MagickAuthoritativeLicense  \\",
      "54:   \"http://www.imagemagick.org/script/license.php\"",
      "55: #define MagickAuthoritativeURL  \"http://www.imagemagick.org\"",
      "57: #define MagickDelegates \"bzlib djvu mpeg fftw fpx fontconfig freetype jbig jng jpeg lcms lzma openexr pango png ps tiff webp x xml zlib\"",
      "58: #define MagickHomeURL  \"file:///usr/local/share/doc/ImageMagick-7/index.html\"",
      "59: #if (MAGICKCORE_QUANTUM_DEPTH == 8)",
      "",
      "[Removed Lines]",
      "51: #define MagickReleaseDate  \"2015-05-26\"",
      "56: #define MagickFeatures \"DPC HDRI OpenMP\"",
      "",
      "[Added Lines]",
      "51: #define MagickReleaseDate  \"2015-05-29\"",
      "56: #define MagickFeatures \"DPC HDRI Cipher OpenMP\"",
      "",
      "---------------"
    ],
    "MagickWand/studio.h||MagickWand/studio.h": [
      "File: MagickWand/studio.h -> MagickWand/studio.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "46: #if defined(_magickcore_inline) && !defined(inline)",
      "47: # define inline _magickcore_inline",
      "48: #endif",
      "52: # if defined(__cplusplus) || defined(c_plusplus)",
      "53: #  undef inline",
      "54: # endif",
      "",
      "[Removed Lines]",
      "49: #if defined(_magickcore_restrict) && !defined(restrict)",
      "50: # define restrict  _magickcore_restrict",
      "51: #endif",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "77: #  include <stdlib.h>",
      "78: # endif",
      "79: #endif",
      "80: #if defined(MAGICKCORE_HAVE_STRING_H)",
      "81: # if !defined(STDC_HEADERS) && defined(MAGICKCORE_HAVE_MEMORY_H)",
      "82: #  include <memory.h>",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "77: #if defined(_magickcore_restrict) && !defined(restrict)",
      "78: # define restrict  _magickcore_restrict",
      "79: #endif",
      "",
      "---------------"
    ],
    "coders/icon.c||coders/icon.c": [
      "File: coders/icon.c -> coders/icon.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "183:     size_t",
      "184:       size;",
      "189:     size=(size_t)strtol(p,&q,10);",
      "190:     if (p == q || size < 16 || size > 256)",
      "",
      "[Removed Lines]",
      "186:     while ((isspace((int) ((unsigned char) *p)) != 0))",
      "187:       p++;",
      "",
      "[Added Lines]",
      "186:     while ((isspace((int) ((unsigned char) *p)) != 0))",
      "187:       p++;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "355:         unsigned char",
      "359:           Icon image encoded as a compressed PNG image.",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "coders/pict.c||coders/pict.c": [
      "File: coders/pict.c -> coders/pict.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1637:     source_rectangle;",
      "1639:   register const Quantum",
      "1642:   register ssize_t",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1649:     storage_class;",
      "1651:   ssize_t",
      "1654:   unsigned char",
      "",
      "[Removed Lines]",
      "1652:     y;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1682:     Initialize image info.",
      "1685:   size_rectangle.left=0;",
      "1686:   size_rectangle.bottom=(short) image->rows;",
      "1687:   size_rectangle.right=(short) image->columns;",
      "",
      "[Removed Lines]",
      "1684:   size_rectangle.top=0;",
      "",
      "[Added Lines]",
      "1684:   size_rectangle.top=0;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "1711:   y_resolution=image->resolution.y != 0.0 ? image->resolution.y :",
      "1712:     DefaultResolution;",
      "1713:   storage_class=image->storage_class;",
      "1715:     storage_class=DirectClass;",
      "1716:   if (storage_class == DirectClass)",
      "1717:     {",
      "",
      "[Removed Lines]",
      "1714:   if (image_info->compression == JPEGCompression)",
      "",
      "[Added Lines]",
      "1714:   if (image_info->compression == JPEGCompression)",
      "",
      "---------------"
    ],
    "configure.ac||configure.ac": [
      "File: configure.ac -> configure.ac",
      "--- Hunk 1 ---",
      "[Context before]",
      "643: if test \"$enable_cipher\" = 'yes'; then",
      "644:     AC_DEFINE(CIPHER_SUPPORT,1,[permit enciphering and deciphering image pixels])",
      "645: fi",
      "647: # Build a zero-configuration version of ImageMagick.",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "645:     MAGICK_FEATURES=\"Cipher $MAGICK_FEATURES\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "654: if test \"$enable_zero_configuration\" = 'yes'; then",
      "655:     AC_DEFINE(ZERO_CONFIGURATION_SUPPORT,1,[Build self-contained, embeddable, zero-configuration ImageMagick])",
      "657: fi",
      "659: # Build a high dynamic range version of ImageMagick.",
      "",
      "[Removed Lines]",
      "656:     MAGICK_FEATURES=\"Zero-Configuration $MAGICK_FEATURES\"",
      "",
      "[Added Lines]",
      "657:     MAGICK_FEATURES=\"Zero-configuration $MAGICK_FEATURES\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "3996: if test \"$build_modules\" != 'no'; then",
      "3997:     MAGICK_DEP_LIBS=\"$USER_LIBS $LCMS_LIBS $FREETYPE_LIBS $LQR_LIBS $FFTW_LIBS $FONTCONFIG_LIBS $XEXT_LIBS $IPC_LIBS $X11_LIBS $XT_LIBS $LZMA_LIBS $BZLIB_LIBS $ZLIB_LIBS $LTDL_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
      "3998: else",
      "4000: fi",
      "4001: AC_SUBST(MAGICK_DEP_LIBS)",
      "",
      "[Removed Lines]",
      "3999:     MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $OPENJPEG_LIBS $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
      "",
      "[Added Lines]",
      "4000:     MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $LIBOPENJP2_LIB $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7087027b6210992e1e853daa3df6bc7aa09482e8",
      "candidate_info": {
        "commit_hash": "7087027b6210992e1e853daa3df6bc7aa09482e8",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/7087027b6210992e1e853daa3df6bc7aa09482e8",
        "files": [
          "configure",
          "configure.ac"
        ],
        "message": "",
        "before_after_code_files": [
          "configure.ac||configure.ac"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "configure.ac||configure.ac"
          ],
          "candidate": [
            "configure.ac||configure.ac"
          ]
        }
      },
      "candidate_diff": {
        "configure.ac||configure.ac": [
          "File: configure.ac -> configure.ac",
          "--- Hunk 1 ---",
          "[Context before]",
          "1941: if test \"$have_djvu\" = 'yes'; then",
          "1942:   AC_DEFINE(DJVU_DELEGATE,1,Define if you have DJVU library)",
          "1943:   CFLAGS=\"$DDJVUAPI_CFLAGS $CFLAGS\"",
          "1944: fi",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1943:   DJVU_CFLAGS=\"$DDJVUAPI_CFLAGS\"",
          "1944:   DJVU_LIBS=\"$DDJVUAPI_LIBS\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3699: if test \"$build_modules\" != 'no'; then",
          "3700:     MAGICK_DEP_LIBS=\"$USER_LIBS $LCMS_LIBS $FREETYPE_LIBS $LQR_LIBS $FFTW_LIBS $FONTCONFIG_LIBS $XEXT_LIBS $IPC_LIBS $X11_LIBS $XT_LIBS $LZMA_LIBS $BZLIB_LIBS $ZLIB_LIBS $LTDL_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
          "3701: else",
          "3703: fi",
          "3704: AC_SUBST(MAGICK_DEP_LIBS)",
          "",
          "[Removed Lines]",
          "3702:     MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DDJVUAP_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $LIBOPENJP2_LIBS $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
          "",
          "[Added Lines]",
          "3704:     MAGICK_DEP_LIBS=\"$USER_LIBS $JBIG_LIBS $LCMS_LIBS $TIFF_LIBS $FREETYPE_LIBS $JPEG_LIBS $GS_LIBS $LQR_LIBS $PNG_LIBS $AUTOTRACE_LIBS $DJVU_LIBS $FFTW_LIBS $FPX_LIBS $FONTCONFIG_LIBS $WEBP_LIBS $WMF_LIBS $DPS_LIBS $XEXT_LIBS $XT_LIBS $IPC_LIBS $X11_LIBS $LZMA_LIBS $BZLIB_LIBS $OPENEXR_LIBS $LIBOPENJP2_LIBS $PANGO_LIBS $RSVG_LIBS $XML_LIBS $GVC_LIBS $ZLIB_LIBS $GDI32_LIBS $MATH_LIBS $GOMP_LIBS $CL_LIBS $UMEM_LIBS $JEMALLOC_LIBS $THREAD_LIBS\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "187791c26c39dbedc5d21bf0ab2939a032106d74",
      "candidate_info": {
        "commit_hash": "187791c26c39dbedc5d21bf0ab2939a032106d74",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/187791c26c39dbedc5d21bf0ab2939a032106d74",
        "files": [
          "MagickCore/version.h",
          "configure",
          "configure.ac",
          "version.sh"
        ],
        "message": "",
        "before_after_code_files": [
          "MagickCore/version.h||MagickCore/version.h",
          "configure.ac||configure.ac",
          "version.sh||version.sh"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/version.h||MagickCore/version.h",
            "configure.ac||configure.ac"
          ],
          "candidate": [
            "MagickCore/version.h||MagickCore/version.h",
            "configure.ac||configure.ac"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/version.h||MagickCore/version.h": [
          "File: MagickCore/version.h -> MagickCore/version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: #define MagickPackageName \"ImageMagick\"",
          "29: #define MagickCopyright  \"Copyright (C) 1999-2015 ImageMagick Studio LLC\"",
          "31: #define MagickLibVersion  0x700",
          "32: #define MagickLibVersionText  \"7.0.0\"",
          "37: #if defined(_WINDOWS)",
          "38: #  if defined(_WIN64)",
          "39: #    define MagickPlatform \"x64\"",
          "",
          "[Removed Lines]",
          "30: #define MagickSVNRevision  \"18476:18477\"",
          "33: #define MagickLibVersionNumber  1,0,0",
          "34: #define MagickLibAddendum  \"-0\"",
          "35: #define MagickLibInterface  1",
          "36: #define MagickLibMinInterface  1",
          "",
          "[Added Lines]",
          "30: #define MagickSVNRevision  \"18476:18479M\"",
          "33: #define MagickLibVersionNumber  0,0,0",
          "34: #define MagickLibAddendum  \"-1\"",
          "35: #define MagickLibInterface  0",
          "36: #define MagickLibMinInterface  0",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "44: #define MagickPlatform  \"x86_64\"",
          "45: #endif",
          "46: #define MagickppLibVersionText  \"7.0.0\"",
          "51: #define MagickReleaseDate  \"2015-05-03\"",
          "52: #define MagickChangeDate   \"20120427\"",
          "53: #define MagickAuthoritativeLicense  \\",
          "",
          "[Removed Lines]",
          "47: #define MagickppLibVersionNumber  1:0:0",
          "48: #define MagickppLibAddendum  \"-0\"",
          "49: #define MagickppLibInterface  1",
          "50: #define MagickppLibMinInterface  1",
          "",
          "[Added Lines]",
          "47: #define MagickppLibVersionNumber  0:0:0",
          "48: #define MagickppLibAddendum  \"-1\"",
          "49: #define MagickppLibInterface  0",
          "50: #define MagickppLibMinInterface  0",
          "",
          "---------------"
        ],
        "configure.ac||configure.ac": [
          "File: configure.ac -> configure.ac",
          "--- Hunk 1 ---",
          "[Context before]",
          "63: CONFIGURE_ARGS=\"$0 ${ac_configure_args}\"",
          "64: AC_SUBST(CONFIGURE_ARGS)",
          "66: # Source file containing package/library versioning information.",
          "67: . ${srcdir}/version.sh",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "66: AC_ARG_ENABLE([reproducible-build],",
          "67:     [AC_HELP_STRING([--enable-reproducible-build],",
          "68:                     [enable reproducible build])],",
          "69:     [enable_reproducible_build=$enableval],",
          "70:     [enable_reproducible_build='no'])",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "113: AC_SUBST(PACKAGE_CHANGE_DATE)dnl",
          "114: AC_SUBST(PACKAGE_LIB_VERSION)dnl",
          "115: AC_SUBST(PACKAGE_LIB_VERSION_NUMBER)dnl",
          "116: AC_SUBST(PACKAGE_RELEASE_DATE)dnl",
          "117: AC_SUBST(PACKAGE_VERSION_ADDENDUM)dnl",
          "119: # Ensure that make can run correctly",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "122: AS_IF([test X$enable_reproducible_build = Xyes],",
          "123:  [PACKAGE_RELEASE_DATE=$PACKAGE_RELEASE_DATE_REPRODUCIBLE],",
          "124:  [PACKAGE_RELEASE_DATE=$PACKAGE_RELEASE_DATE_RAW],",
          "125: )",
          "",
          "---------------"
        ],
        "version.sh||version.sh": [
          "File: version.sh -> version.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: # Package base name",
          "8: PACKAGE_NAME='ImageMagick'",
          "10: #",
          "11: # Package version.  This is is the numeric version suffix applied to",
          "12: # PACKAGE_NAME (e.g. \"1.0.0\").",
          "13: PACKAGE_VERSION='7.0.0'",
          "14: PACKAGE_PERL_VERSION='7.00'",
          "15: PACKAGE_LIB_VERSION=\"0x700\"",
          "17: PACKAGE_LIB_VERSION_NUMBER=\"7,0,0,${PACKAGE_RELEASE}\"",
          "19: PACKAGE_STRING=\"$PACKAGE_NAME $PACKAGE_VERSION\"",
          "26: #",
          "27: # Package version addendum.  This is an arbitrary suffix (if any) appended",
          "",
          "[Removed Lines]",
          "16: PACKAGE_RELEASE=\"0\"",
          "18: PACKAGE_RELEASE_DATE=`date +%F`",
          "21: #",
          "22: # Date of last ChangeLog update",
          "23: #",
          "24: PACKAGE_CHANGE_DATE=`awk '/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9]/ { print substr($1,1,4) substr($1,6,2) substr($1,9,2); exit; }' ${srcdir}/ChangeLog`",
          "",
          "[Added Lines]",
          "10: #",
          "11: # Date of last ChangeLog update",
          "12: #",
          "13: PACKAGE_CHANGE_DATE=`awk '/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9]/ { print substr($1,1,4) substr($1,6,2) substr($1,9,2); exit; }' ${srcdir}/ChangeLog`",
          "21: PACKAGE_RELEASE=\"1\"",
          "23: PACKAGE_RELEASE_DATE_RAW=`date +%F`",
          "24: PACKAGE_RELEASE_DATE_REPRODUCIBLE=`date +%F -d \"${PACKAGE_CHANGE_DATE}\"`",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "39: # PLEASE NOTE that doing a SO BUMP aka raising the CURRENT REVISION",
          "40: # could be avoided using libversioning aka map files.  You MUST change .map",
          "41: # files if you raise these versions.",
          "43: MAGICK_LIBRARY_REVISION=0",
          "44: MAGICK_LIBRARY_AGE=0",
          "46: # magick++",
          "48: MAGICKPP_LIBRARY_REVISION=0",
          "49: MAGICKPP_LIBRARY_AGE=0",
          "",
          "[Removed Lines]",
          "42: MAGICK_LIBRARY_CURRENT=1",
          "47: MAGICKPP_LIBRARY_CURRENT=1",
          "",
          "[Added Lines]",
          "45: MAGICK_LIBRARY_CURRENT=0",
          "50: MAGICKPP_LIBRARY_CURRENT=0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d2bb8c55e96c209e1f43ace100cfb2f73f7ab4cc",
      "candidate_info": {
        "commit_hash": "d2bb8c55e96c209e1f43ace100cfb2f73f7ab4cc",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/d2bb8c55e96c209e1f43ace100cfb2f73f7ab4cc",
        "files": [
          "MagickCore/version.c",
          "MagickCore/version.h",
          "MagickCore/version.h.in"
        ],
        "message": "",
        "before_after_code_files": [
          "MagickCore/version.c||MagickCore/version.c",
          "MagickCore/version.h||MagickCore/version.h",
          "MagickCore/version.h.in||MagickCore/version.h.in"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/version.c||MagickCore/version.c",
            "MagickCore/version.h||MagickCore/version.h"
          ],
          "candidate": [
            "MagickCore/version.c||MagickCore/version.c",
            "MagickCore/version.h||MagickCore/version.h"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/version.c||MagickCore/version.c": [
          "File: MagickCore/version.c -> MagickCore/version.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "288:   }",
          "289:   return(ConstantString(MagickHomeURL));",
          "290: }",
          "294: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "294: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%",
          "295: %                                                                             %",
          "296: %                                                                             %",
          "297: %                                                                             %",
          "298: %   G e t M a g i c k L i c e n s e                                           %",
          "299: %                                                                             %",
          "300: %                                                                             %",
          "301: %                                                                             %",
          "302: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%",
          "303: %",
          "304: %  GetMagickLicense() returns the ImageMagick API license as a string.",
          "305: %",
          "306: %  The format of the GetMagickLicense method is:",
          "307: %",
          "308: %      const char *GetMagickLicense(void)",
          "309: %",
          "311: MagickExport const char *GetMagickLicense(void)",
          "312: {",
          "313:   return(MagickAuthoritativeLicense);",
          "314: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "551: %  delegates.",
          "552: %",
          "553: %  The format of the ListMagickVersion method is:",
          "554: %",
          "555: %      void ListMagickVersion(FILE *file)",
          "556: %",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "577: %  The format of the ListMagickVersion method is:",
          "",
          "---------------"
        ],
        "MagickCore/version.h||MagickCore/version.h": [
          "File: MagickCore/version.h -> MagickCore/version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: #define MagickppLibAddendum  \"-0\"",
          "49: #define MagickppLibInterface  1",
          "50: #define MagickppLibMinInterface  1",
          "52: #define MagickChangeDate   \"20120427\"",
          "53: #define MagickAuthoritativeURL  \"http://www.imagemagick.org\"",
          "54: #define MagickFeatures \"DPC HDRI OpenMP\"",
          "55: #define MagickDelegates \"bzlib djvu mpeg fftw fpx fontconfig freetype jbig jng jpeg lcms lzma openexr pango png ps tiff webp x xml zlib\"",
          "",
          "[Removed Lines]",
          "51: #define MagickReleaseDate  \"2015-02-07\"",
          "",
          "[Added Lines]",
          "51: #define MagickReleaseDate  \"2015-02-17\"",
          "53: #define MagickAuthoritativeLicense  \\",
          "54:   \"http://www.imagemagick.org/script/license.php\"",
          "",
          "---------------"
        ],
        "MagickCore/version.h.in||MagickCore/version.h.in": [
          "File: MagickCore/version.h.in -> MagickCore/version.h.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "50: #define MagickppLibMinInterface  @MAGICKPP_LIBRARY_CURRENT_MIN@",
          "51: #define MagickReleaseDate  \"@PACKAGE_RELEASE_DATE@\"",
          "52: #define MagickChangeDate   \"@PACKAGE_CHANGE_DATE@\"",
          "53: #define MagickAuthoritativeURL  \"http://www.imagemagick.org\"",
          "54: #define MagickFeatures \"@MAGICK_FEATURES@\"",
          "55: #define MagickDelegates \"@MAGICK_DELEGATES@\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "53: #define MagickAuthoritativeLicense  \\",
          "54:   \"http://www.imagemagick.org/script/license.php\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6984ab14f6d335565b4fa858637cabfbdfabe3eb",
      "candidate_info": {
        "commit_hash": "6984ab14f6d335565b4fa858637cabfbdfabe3eb",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/6984ab14f6d335565b4fa858637cabfbdfabe3eb",
        "files": [
          "MagickCore/memory.c"
        ],
        "message": "...",
        "before_after_code_files": [
          "MagickCore/memory.c||MagickCore/memory.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/memory.c||MagickCore/memory.c"
          ],
          "candidate": [
            "MagickCore/memory.c||MagickCore/memory.c"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/memory.c||MagickCore/memory.c": [
          "File: MagickCore/memory.c -> MagickCore/memory.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "620:       if (AcquireMagickResource(DiskResource,length) != MagickFalse)",
          "621:         {",
          "622:           int",
          "626:             Anonymous memory mapping failed, try file-backed memory mapping.",
          "",
          "[Removed Lines]",
          "623:             file;",
          "",
          "[Added Lines]",
          "623:             file;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "125d2495f7a52a9c9c77ceed0558fc42315bb2e1",
      "candidate_info": {
        "commit_hash": "125d2495f7a52a9c9c77ceed0558fc42315bb2e1",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/125d2495f7a52a9c9c77ceed0558fc42315bb2e1",
        "files": [
          "MagickCore/memory.c",
          "configure"
        ],
        "message": "...",
        "before_after_code_files": [
          "MagickCore/memory.c||MagickCore/memory.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickCore/memory.c||MagickCore/memory.c"
          ],
          "candidate": [
            "MagickCore/memory.c||MagickCore/memory.c"
          ]
        }
      },
      "candidate_diff": {
        "MagickCore/memory.c||MagickCore/memory.c": [
          "File: MagickCore/memory.c -> MagickCore/memory.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "627:       if (AcquireMagickResource(DiskResource,extent) != MagickFalse)",
          "628:         {",
          "629:           int",
          "633:             Anonymous memory mapping failed, try file-backed memory mapping.",
          "",
          "[Removed Lines]",
          "630:             file;",
          "",
          "[Added Lines]",
          "630:             file;",
          "633:             Anonymous memory mapping failed, try file-backed memory mapping.",
          "634:             If the MapResource request failed, there is no point in trying",
          "",
          "---------------"
        ]
      }
    }
  ]
}