{
  "cve_id": "CVE-2017-6952",
  "cve_desc": "Integer overflow in the cs_winkernel_malloc function in winkernel_mm.c in Capstone 3.0.4 and earlier allows attackers to cause a denial of service (heap-based buffer overflow in a kernel driver) or possibly have unspecified other impact via a large value.",
  "repo": "aquynh/capstone",
  "patch_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
  "patch_info": {
    "commit_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
    "repo": "aquynh/capstone",
    "commit_url": "https://github.com/aquynh/capstone/commit/6fe86eef621b9849f51a5e1e5d73258a93440403",
    "files": [
      "windows/winkernel_mm.c"
    ],
    "message": "provide a validity check to prevent against Integer overflow conditions (#870)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.",
    "before_after_code_files": [
      "windows/winkernel_mm.c||windows/winkernel_mm.c"
    ]
  },
  "patch_diff": {
    "windows/winkernel_mm.c||windows/winkernel_mm.c": [
      "File: windows/winkernel_mm.c -> windows/winkernel_mm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: #include \"winkernel_mm.h\"",
      "5: #include <ntddk.h>",
      "8: static const ULONG CS_WINKERNEL_POOL_TAG = 'kwsC';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "6: #include <Ntintsafe.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "35: #pragma prefast(suppress : 30030)  // Allocating executable POOL_TYPE memory",
      "38:  if (!block) {",
      "39:   return NULL;",
      "40:  }",
      "",
      "[Removed Lines]",
      "36:  CS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "37:    NonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);",
      "",
      "[Added Lines]",
      "37:  size_t number_of_bytes = 0;",
      "38:  CS_WINKERNEL_MEMBLOCK *block = NULL;",
      "42:  if (!NT_SUCCESS(RtlSizeTAdd(size, sizeof(CS_WINKERNEL_MEMBLOCK), &number_of_bytes))) {",
      "43:   return NULL;",
      "44:  }",
      "45:  block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "46:    NonPagedPool, number_of_bytes, CS_WINKERNEL_POOL_TAG);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "69f37989c71f81dbc74cdc540d8facaad7cb2041",
      "candidate_info": {
        "commit_hash": "69f37989c71f81dbc74cdc540d8facaad7cb2041",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/69f37989c71f81dbc74cdc540d8facaad7cb2041",
        "files": [
          "xcode/Capstone.xcodeproj/project.pbxproj",
          "xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Dynamic Library.xcscheme",
          "xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Framework.xcscheme",
          "xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Static Library.xcscheme",
          "xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Tests.xcscheme"
        ],
        "message": "Updated Xcode project for Xcode 9.1 (#1055)",
        "before_after_code_files": [
          "xcode/Capstone.xcodeproj/project.pbxproj||xcode/Capstone.xcodeproj/project.pbxproj",
          "xcode/Capstone.xcodeproj/xcshareddatxcschemes/Framework.xcscheme||xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Framework.xcscheme",
          "xcode/Capstone.xcodeproj/xcshareddatxcschemes/Tests.xcscheme||xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Tests.xcscheme"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "xcode/Capstone.xcodeproj/project.pbxproj||xcode/Capstone.xcodeproj/project.pbxproj": [
          "File: xcode/Capstone.xcodeproj/project.pbxproj -> xcode/Capstone.xcodeproj/project.pbxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "7:  objects = {",
          "10:   DC07A86E19F6061D00254FCF /* libcapstone.a in Frameworks */ = {isa = PBXBuildFile; fileRef = DCFE23BD19DDCC2D00EF8EA9 /* libcapstone.a */; };",
          "11:   DC3A28E31AF29C0100FC9913 /* test_customized_mnem.c in Sources */ = {isa = PBXBuildFile; fileRef = DC3A28E21AF29C0100FC9913 /* test_customized_mnem.c */; };",
          "12:   DC3A28E41AF29C4600FC9913 /* libcapstone.a in Frameworks */ = {isa = PBXBuildFile; fileRef = DCFE23BD19DDCC2D00EF8EA9 /* libcapstone.a */; };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "10:   0537EAAA1FC6284F00F06BF9 /* tms320c64x.h in Headers */ = {isa = PBXBuildFile; fileRef = 0537EAA91FC6284E00F06BF9 /* tms320c64x.h */; settings = {ATTRIBUTES = (Public, ); }; };",
          "11:   0537EAAC1FC6286300F06BF9 /* m680x.h in Headers */ = {isa = PBXBuildFile; fileRef = 0537EAAB1FC6286300F06BF9 /* m680x.h */; };",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "322:   DC3A28DB1AF29BEB00FC9913 /* test_customized_mnem */ = {isa = PBXFileReference; explicitFileType = \"compiled.mach-o.executable\"; includeInIndex = 0; path = test_customized_mnem; sourceTree = BUILT_PRODUCTS_DIR; };",
          "323:   DC3A28E21AF29C0100FC9913 /* test_customized_mnem.c */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.c; name = test_customized_mnem.c; path = ../tests/test_customized_mnem.c; sourceTree = \"<group>\"; };",
          "324:   DC474E6419DDEA5F00BCA449 /* test */ = {isa = PBXFileReference; explicitFileType = \"compiled.mach-o.executable\"; includeInIndex = 0; path = test; sourceTree = BUILT_PRODUCTS_DIR; };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "324:   0537EAA91FC6284E00F06BF9 /* tms320c64x.h */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.h; path = tms320c64x.h; sourceTree = \"<group>\"; };",
          "325:   0537EAAB1FC6286300F06BF9 /* m680x.h */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.h; path = m680x.h; sourceTree = \"<group>\"; };",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "932:     DCFE24BD19DDCE2F00EF8EA9 /* arm64.h */,",
          "933:     DCFE24BE19DDCE2F00EF8EA9 /* capstone.h */,",
          "934:     DCA3579F1BC2C14E0094BB3F /* m68k.h */,",
          "935:     DCFE24BF19DDCE2F00EF8EA9 /* mips.h */,",
          "936:     DCFE24C019DDCE2F00EF8EA9 /* platform.h */,",
          "937:     DCFE24C119DDCE2F00EF8EA9 /* ppc.h */,",
          "938:     DCFE24C219DDCE2F00EF8EA9 /* sparc.h */,",
          "939:     DCFE24C319DDCE2F00EF8EA9 /* systemz.h */,",
          "940:     DCFE24C419DDCE2F00EF8EA9 /* x86.h */,",
          "941:     DCFE24C519DDCE2F00EF8EA9 /* xcore.h */,",
          "942:    );",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "939:     0537EAAB1FC6286300F06BF9 /* m680x.h */,",
          "945:     0537EAA91FC6284E00F06BF9 /* tms320c64x.h */,",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "960:     DC474F8719DE6F6B00BCA449 /* sparc.h in Headers */,",
          "961:     DC474F8819DE6F6B00BCA449 /* systemz.h in Headers */,",
          "962:     DC474F8919DE6F6B00BCA449 /* x86.h in Headers */,",
          "963:     DCA3578E1BC2C0290094BB3F /* M68KInstPrinter.h in Headers */,",
          "964:     DC474F8A19DE6F6B00BCA449 /* xcore.h in Headers */,",
          "965:    );",
          "966:    runOnlyForDeploymentPostprocessing = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "969:     0537EAAC1FC6286300F06BF9 /* m680x.h in Headers */,",
          "971:     0537EAAA1FC6284F00F06BF9 /* tms320c64x.h in Headers */,",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1282:   DCFE239A19DDCB4900EF8EA9 /* Project object */ = {",
          "1283:    isa = PBXProject;",
          "1284:    attributes = {",
          "1286:     TargetAttributes = {",
          "1287:      DC3A28DA1AF29BEB00FC9913 = {",
          "1288:       CreatedOnToolsVersion = 6.3.1;",
          "",
          "[Removed Lines]",
          "1285:     LastUpgradeCheck = 0710;",
          "",
          "[Added Lines]",
          "1293:     LastUpgradeCheck = 0910;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2986:   DCFE239E19DDCB4900EF8EA9 /* Debug */ = {",
          "2987:    isa = XCBuildConfiguration;",
          "2988:    buildSettings = {",
          "2989:     ENABLE_TESTABILITY = YES;",
          "2990:     ONLY_ACTIVE_ARCH = YES;",
          "2991:    };",
          "2992:    name = Debug;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2997:     CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING = YES;",
          "2998:     CLANG_WARN_BOOL_CONVERSION = YES;",
          "2999:     CLANG_WARN_COMMA = YES;",
          "3000:     CLANG_WARN_CONSTANT_CONVERSION = YES;",
          "3001:     CLANG_WARN_EMPTY_BODY = YES;",
          "3002:     CLANG_WARN_ENUM_CONVERSION = YES;",
          "3003:     CLANG_WARN_INFINITE_RECURSION = YES;",
          "3004:     CLANG_WARN_INT_CONVERSION = YES;",
          "3005:     CLANG_WARN_NON_LITERAL_NULL_CONVERSION = YES;",
          "3006:     CLANG_WARN_OBJC_LITERAL_CONVERSION = YES;",
          "3007:     CLANG_WARN_RANGE_LOOP_ANALYSIS = YES;",
          "3008:     CLANG_WARN_STRICT_PROTOTYPES = YES;",
          "3009:     CLANG_WARN_SUSPICIOUS_MOVE = YES;",
          "3010:     CLANG_WARN_UNREACHABLE_CODE = YES;",
          "3011:     CLANG_WARN__DUPLICATE_METHOD_MATCH = YES;",
          "3012:     ENABLE_STRICT_OBJC_MSGSEND = YES;",
          "3014:     GCC_NO_COMMON_BLOCKS = YES;",
          "3015:     GCC_WARN_64_TO_32_BIT_CONVERSION = YES;",
          "3016:     GCC_WARN_ABOUT_RETURN_TYPE = YES;",
          "3017:     GCC_WARN_UNDECLARED_SELECTOR = YES;",
          "3018:     GCC_WARN_UNINITIALIZED_AUTOS = YES;",
          "3019:     GCC_WARN_UNUSED_FUNCTION = YES;",
          "3020:     GCC_WARN_UNUSED_VARIABLE = YES;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2994:   DCFE239F19DDCB4900EF8EA9 /* Release */ = {",
          "2995:    isa = XCBuildConfiguration;",
          "2996:    buildSettings = {",
          "2997:    };",
          "2998:    name = Release;",
          "2999:   };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3028:     CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING = YES;",
          "3029:     CLANG_WARN_BOOL_CONVERSION = YES;",
          "3030:     CLANG_WARN_COMMA = YES;",
          "3031:     CLANG_WARN_CONSTANT_CONVERSION = YES;",
          "3032:     CLANG_WARN_EMPTY_BODY = YES;",
          "3033:     CLANG_WARN_ENUM_CONVERSION = YES;",
          "3034:     CLANG_WARN_INFINITE_RECURSION = YES;",
          "3035:     CLANG_WARN_INT_CONVERSION = YES;",
          "3036:     CLANG_WARN_NON_LITERAL_NULL_CONVERSION = YES;",
          "3037:     CLANG_WARN_OBJC_LITERAL_CONVERSION = YES;",
          "3038:     CLANG_WARN_RANGE_LOOP_ANALYSIS = YES;",
          "3039:     CLANG_WARN_STRICT_PROTOTYPES = YES;",
          "3040:     CLANG_WARN_SUSPICIOUS_MOVE = YES;",
          "3041:     CLANG_WARN_UNREACHABLE_CODE = YES;",
          "3042:     CLANG_WARN__DUPLICATE_METHOD_MATCH = YES;",
          "3043:     ENABLE_STRICT_OBJC_MSGSEND = YES;",
          "3044:     GCC_NO_COMMON_BLOCKS = YES;",
          "3045:     GCC_WARN_64_TO_32_BIT_CONVERSION = YES;",
          "3046:     GCC_WARN_ABOUT_RETURN_TYPE = YES;",
          "3047:     GCC_WARN_UNDECLARED_SELECTOR = YES;",
          "3048:     GCC_WARN_UNINITIALIZED_AUTOS = YES;",
          "3049:     GCC_WARN_UNUSED_FUNCTION = YES;",
          "3050:     GCC_WARN_UNUSED_VARIABLE = YES;",
          "",
          "---------------"
        ],
        "xcode/Capstone.xcodeproj/xcshareddatxcschemes/Framework.xcscheme||xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Framework.xcscheme": [
          "File: xcode/Capstone.xcodeproj/xcshareddatxcschemes/Framework.xcscheme -> xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Framework.xcscheme",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3:    LastUpgradeVersion = \"0910\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29:       language = \"\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "40:       language = \"\"",
          "",
          "---------------"
        ],
        "xcode/Capstone.xcodeproj/xcshareddatxcschemes/Tests.xcscheme||xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Tests.xcscheme": [
          "File: xcode/Capstone.xcodeproj/xcshareddatxcschemes/Tests.xcscheme -> xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Tests.xcscheme",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3:    LastUpgradeVersion = \"0910\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "197:       language = \"\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "217:       language = \"\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2a668317b5d9475770b9586fff3aef2b36a97df1",
      "candidate_info": {
        "commit_hash": "2a668317b5d9475770b9586fff3aef2b36a97df1",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/2a668317b5d9475770b9586fff3aef2b36a97df1",
        "files": [
          "bindings/Makefile",
          "bindings/const_generator.py",
          "bindings/powershell/Capstone/Capstone.psm1",
          "bindings/powershell/Capstone/Const/capstone_h.cs"
        ],
        "message": "Revert constant generation + Quality of service change",
        "before_after_code_files": [
          "bindings/const_generator.py||bindings/const_generator.py",
          "bindings/powershell/Capstone/Capstone.psm1||bindings/powershell/Capstone/Capstone.psm1",
          "bindings/powershell/Capstone/Const/capstone_h.cs||bindings/powershell/Capstone/Const/capstone_h.cs"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "bindings/const_generator.py||bindings/const_generator.py": [
          "File: bindings/const_generator.py -> bindings/const_generator.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: include = [ 'arm.h', 'arm64.h', 'mips.h', 'x86.h', 'ppc.h', 'sparc.h', 'systemz.h', 'xcore.h' ]",
          "10: template = {",
          "21:     'java': {",
          "22:             'header': \"// For Capstone Engine. AUTO-GENERATED FILE, DO NOT EDIT\\npackage capstone;\\n\\npublic class %s_const {\\n\",",
          "23:             'footer': \"}\",",
          "",
          "[Removed Lines]",
          "11:     'powershell': {",
          "12:             'header': \"# For Capstone Engine. AUTO-GENERATED FILE, DO NOT EDIT [%s_h.cs]\\n\",",
          "13:             'footer': \"\",",
          "14:             'line_format': '%s = %s\\n',",
          "15:             'out_file': './powershell/Capstone/Const/%s_h.cs',",
          "16:             # only capstone.h required, but it is not included above on line 8?",
          "17:             'capstone.h': 'capstone',",
          "18:             'comment_open': '///',",
          "19:             'comment_close': '',",
          "20:         },",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "bindings/powershell/Capstone/Capstone.psm1||bindings/powershell/Capstone/Capstone.psm1": [
          "File: bindings/powershell/Capstone/Capstone.psm1 -> bindings/powershell/Capstone/Capstone.psm1",
          "--- Hunk 1 ---",
          "[Context before]",
          "149:   Return",
          "150:  }",
          "157:  # Inline C# to parse the unmanaged capstone DLL",
          "158:  Add-Type -TypeDefinition @\"",
          "159:  using System;",
          "",
          "[Removed Lines]",
          "152:  # Load C# constants",
          "153:  $cs_err = Select-String \"CS_ERR_\" $($PSScriptRoot + '\\Const\\capstone_h.cs') |select -exp line",
          "154:  $cs_arch = Select-String \"CS_ARCH_\" $($PSScriptRoot + '\\Const\\capstone_h.cs') |select -exp line",
          "155:  $cs_mode = Select-String \"CS_MODE_\" $($PSScriptRoot + '\\Const\\capstone_h.cs') |select -exp line",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "194:  public enum cs_err : int",
          "195:  {",
          "197:  }",
          "199:  public enum cs_arch : int",
          "200:  {",
          "202:  }",
          "204:  public enum cs_mode : int",
          "205:  {",
          "207:  }",
          "209:  public static class Capstone",
          "",
          "[Removed Lines]",
          "196:   $cs_err",
          "201:   $cs_arch",
          "206:   $cs_mode",
          "",
          "[Added Lines]",
          "191:   CS_ERR_OK = 0,    /// No error: everything was fine",
          "192:   CS_ERR_MEM,       /// Out-Of-Memory error: cs_open(), cs_disasm(), cs_disasm_iter()",
          "193:   CS_ERR_ARCH,      /// Unsupported architecture: cs_open()",
          "194:   CS_ERR_HANDLE,    /// Invalid handle: cs_op_count(), cs_op_index()",
          "195:   CS_ERR_CSH,       /// Invalid csh argument: cs_close(), cs_errno(), cs_option()",
          "196:   CS_ERR_MODE,      /// Invalid/unsupported mode: cs_open()",
          "197:   CS_ERR_OPTION,    /// Invalid/unsupported option: cs_option()",
          "198:   CS_ERR_DETAIL,    /// Information is unavailable because detail option is OFF",
          "199:   CS_ERR_MEMSETUP,  /// Dynamic memory management uninitialized (see CS_OPT_MEM)",
          "200:   CS_ERR_VERSION,   /// Unsupported version (bindings)",
          "201:   CS_ERR_DIET,      /// Access irrelevant data in \"diet\" engine",
          "202:   CS_ERR_SKIPDATA,  /// Access irrelevant data for \"data\" instruction in SKIPDATA mode",
          "203:   CS_ERR_X86_ATT,   /// X86 AT&T syntax is unsupported (opt-out at compile time)",
          "204:   CS_ERR_X86_INTEL, /// X86 Intel syntax is unsupported (opt-out at compile time)",
          "208:   CS_ARCH_ARM = 0,      /// ARM architecture (including Thumb, Thumb-2)",
          "209:   CS_ARCH_ARM64,        /// ARM-64, also called AArch64",
          "210:   CS_ARCH_MIPS,         /// Mips architecture",
          "211:   CS_ARCH_X86,          /// X86 architecture (including x86 & x86-64)",
          "212:   CS_ARCH_PPC,          /// PowerPC architecture",
          "213:   CS_ARCH_SPARC,        /// Sparc architecture",
          "214:   CS_ARCH_SYSZ,         /// SystemZ architecture",
          "215:   CS_ARCH_XCORE,        /// XCore architecture",
          "216:   CS_ARCH_MAX,",
          "217:   CS_ARCH_ALL = 0xFFFF, /// All architectures - for cs_support()",
          "221:   CS_MODE_LITTLE_ENDIAN = 0,    /// little-endian mode (default mode)",
          "222:   CS_MODE_ARM = 0,              /// 32-bit ARM",
          "223:   CS_MODE_16 = 1 << 1,          /// 16-bit mode (X86)",
          "224:   CS_MODE_32 = 1 << 2,          /// 32-bit mode (X86)",
          "225:   CS_MODE_64 = 1 << 3,          /// 64-bit mode (X86, PPC)",
          "226:   CS_MODE_THUMB = 1 << 4,       /// ARM's Thumb mode, including Thumb-2",
          "227:   CS_MODE_MCLASS = 1 << 5,      /// ARM's Cortex-M series",
          "228:   CS_MODE_V8 = 1 << 6,          /// ARMv8 A32 encodings for ARM",
          "229:   CS_MODE_MICRO = 1 << 4,       /// MicroMips mode (MIPS)",
          "230:   CS_MODE_MIPS3 = 1 << 5,       /// Mips III ISA",
          "231:   CS_MODE_MIPS32R6 = 1 << 6,    /// Mips32r6 ISA",
          "232:   CS_MODE_MIPSGP64 = 1 << 7,    /// General Purpose Registers are 64-bit wide (MIPS)",
          "233:   CS_MODE_V9 = 1 << 4,          /// SparcV9 mode (Sparc)",
          "234:   CS_MODE_BIG_ENDIAN = 1 << 31, /// big-endian mode",
          "235:   CS_MODE_MIPS32 = CS_MODE_32,  /// Mips32 ISA (Mips)",
          "236:   CS_MODE_MIPS64 = CS_MODE_64,  /// Mips64 ISA (Mips)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "361:    $Cast = [system.runtime.interopservices.marshal]::PtrToStructure($InsnPointer,[type]$cs_insn)",
          "363:    if ($CS_OPT -eq 0) {",
          "371:     }",
          "372:    } else {",
          "373:     $DetailCast = [system.runtime.interopservices.marshal]::PtrToStructure($Cast.detail,[type]$cs_detail)",
          "374:     if($DetailCast.regs_read_count -gt 0) {",
          "",
          "[Removed Lines]",
          "364:     # Some dirty tricks for spacing, sorry mmkay!",
          "365:     if ($i -eq 0) {",
          "366:      $Disasm += echo \"`n\"",
          "367:     }",
          "368:     $Disasm += echo \"$($Cast.mnemonic) $($Cast.operands)\"",
          "369:     if ($i -eq $($count-1)){",
          "370:      $Disasm += echo \"`n\"",
          "",
          "[Added Lines]",
          "394:     $HashTable = @{",
          "395:      Address = echo \"0x$(\"{0:X}\" -f $Cast.address)\"",
          "396:      Instruction = echo \"$($Cast.mnemonic) $($Cast.operands)\"",
          "398:     $Object = New-Object PSObject -Property $HashTable",
          "399:     $Disasm += $Object |Select-Object Address,Instruction",
          "",
          "---------------"
        ],
        "bindings/powershell/Capstone/Const/capstone_h.cs||bindings/powershell/Capstone/Const/capstone_h.cs": [
          "File: bindings/powershell/Capstone/Const/capstone_h.cs -> bindings/powershell/Capstone/Const/capstone_h.cs",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "10730fa971544a02a8061d25650c5fe2c61db639",
      "candidate_info": {
        "commit_hash": "10730fa971544a02a8061d25650c5fe2c61db639",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/10730fa971544a02a8061d25650c5fe2c61db639",
        "files": [
          "arch/X86/X86IntelInstPrinter.c"
        ],
        "message": "x86: do not print 'ptr' for fxsave & fxrstor instructions. this fixes issue #492",
        "before_after_code_files": [
          "arch/X86/X86IntelInstPrinter.c||arch/X86/X86IntelInstPrinter.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/X86/X86IntelInstPrinter.c||arch/X86/X86IntelInstPrinter.c": [
          "File: arch/X86/X86IntelInstPrinter.c -> arch/X86/X86IntelInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "72:   case X86_INS_SIDT:",
          "73:   case X86_INS_LGDT:",
          "74:   case X86_INS_LIDT:",
          "76:    break;",
          "77:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "76:   case X86_INS_FXRSTOR:",
          "77:   case X86_INS_FXSAVE:",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dcfd572710e05eacdead26f6402dda83e09cc3ef",
      "candidate_info": {
        "commit_hash": "dcfd572710e05eacdead26f6402dda83e09cc3ef",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/dcfd572710e05eacdead26f6402dda83e09cc3ef",
        "files": [
          "arch/X86/X86GenAsmWriter.inc"
        ],
        "message": "x86: fix (AT&T) instruction lgs for issue #805",
        "before_after_code_files": [
          "arch/X86/X86GenAsmWriter.inc||arch/X86/X86GenAsmWriter.inc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/X86/X86GenAsmWriter.inc||arch/X86/X86GenAsmWriter.inc": [
          "File: arch/X86/X86GenAsmWriter.inc -> arch/X86/X86GenAsmWriter.inc",
          "--- Hunk 1 ---",
          "[Context before]",
          "19252:       case X86_ROL32r1:",
          "19253:         SStream_concat0(O, \"rol\\t$1, \");",
          "19254:         break;",
          "19255:     }",
          "19256: #endif",
          "19257:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "19255:       case X86_LGS64rm:",
          "19256:         SStream_concat0(O, \"lgs\\t\");",
          "19257:         break;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "97ae4c3f706a54f1a844e61442b7f112dfd52f68",
      "candidate_info": {
        "commit_hash": "97ae4c3f706a54f1a844e61442b7f112dfd52f68",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/97ae4c3f706a54f1a844e61442b7f112dfd52f68",
        "files": [
          "arch/M68K/M68KDisassembler.c"
        ],
        "message": "bugfix: use proper order for operands in M68K movem",
        "before_after_code_files": [
          "arch/M68K/M68KDisassembler.c||arch/M68K/M68KDisassembler.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/M68K/M68KDisassembler.c||arch/M68K/M68KDisassembler.c": [
          "File: arch/M68K/M68KDisassembler.c -> arch/M68K/M68KDisassembler.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "901:  op1 = &ext->operands[1];",
          "903:  op0->type = M68K_OP_REG_BITS;",
          "906:  get_ea_mode_op(info, op1, info->ir, size);",
          "907: }",
          "909: static void build_movem_er(m68k_info *info, int opcode, int size)",
          "",
          "[Removed Lines]",
          "904:  op0->register_bits = reverse_bits(read_imm_16(info));",
          "",
          "[Added Lines]",
          "904:  op0->register_bits = read_imm_16(info);",
          "908:         if (op1->address_mode == M68K_AM_REGI_ADDR_PRE_DEC)",
          "909:                 op0->register_bits = reverse_bits(op0->register_bits);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "915:  op0 = &ext->operands[0];",
          "916:  op1 = &ext->operands[1];",
          "920:  op1->type = M68K_OP_REG_BITS;",
          "921:  op1->register_bits = read_imm_16(info);",
          "922: }",
          "924: static void build_imm(m68k_info *info, int opcode, int data)",
          "",
          "[Removed Lines]",
          "918:  get_ea_mode_op(info, op0, info->ir, size);",
          "",
          "[Added Lines]",
          "924:  get_ea_mode_op(info, op0, info->ir, size);",
          "",
          "---------------"
        ]
      }
    }
  ]
}