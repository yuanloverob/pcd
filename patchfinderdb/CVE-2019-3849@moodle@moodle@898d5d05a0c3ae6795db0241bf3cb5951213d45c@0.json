{
  "cve_id": "CVE-2019-3849",
  "cve_desc": "A vulnerability was found in moodle before versions 3.6.3, 3.5.5 and 3.4.8. Users could assign themselves an escalated role within courses or content accessed via LTI, by modifying the request to the LTI publisher site.",
  "repo": "moodle/moodle",
  "patch_hash": "898d5d05a0c3ae6795db0241bf3cb5951213d45c",
  "patch_info": {
    "commit_hash": "898d5d05a0c3ae6795db0241bf3cb5951213d45c",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/898d5d05a0c3ae6795db0241bf3cb5951213d45c",
    "files": [
      "lib/ltiprovider/src/OAuth/OAuthRequest.php"
    ],
    "message": "MDL-62702 core_lib: fix broken verification signature",
    "before_after_code_files": [
      "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
    ]
  },
  "patch_diff": {
    "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php": [
      "File: lib/ltiprovider/src/OAuth/OAuthRequest.php -> lib/ltiprovider/src/OAuth/OAuthRequest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "18:     public $base_string;",
      "19:     public static $version = '1.0';",
      "22:     function __construct($http_method, $http_url, $parameters = null) {",
      "",
      "[Removed Lines]",
      "20:     public static $POST_INPUT = 'php://input';",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "75:       }",
      "77:       return new OAuthRequest($http_method, $http_url, $parameters);",
      "",
      "[Removed Lines]",
      "72:           foreach ($_POST as $key => $value) {",
      "73:               $parameters[$key] = OAuthUtil::urldecode_rfc3986($value);",
      "74:           }",
      "",
      "[Added Lines]",
      "70:           $parameters = array_merge($parameters, $_POST);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "b77dcd23d8e39265b5c096f0d947764c02d832c8",
      "candidate_info": {
        "commit_hash": "b77dcd23d8e39265b5c096f0d947764c02d832c8",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/b77dcd23d8e39265b5c096f0d947764c02d832c8",
        "files": [
          "lib/ltiprovider/src/OAuth/OAuthRequest.php"
        ],
        "message": "MDL-62702 core_lib: fix broken verification signature",
        "before_after_code_files": [
          "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
          ],
          "candidate": [
            "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php": [
          "File: lib/ltiprovider/src/OAuth/OAuthRequest.php -> lib/ltiprovider/src/OAuth/OAuthRequest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:     public $base_string;",
          "19:     public static $version = '1.0';",
          "22:     function __construct($http_method, $http_url, $parameters = null) {",
          "",
          "[Removed Lines]",
          "20:     public static $POST_INPUT = 'php://input';",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "75:       }",
          "77:       return new OAuthRequest($http_method, $http_url, $parameters);",
          "",
          "[Removed Lines]",
          "72:           foreach ($_POST as $key => $value) {",
          "73:               $parameters[$key] = OAuthUtil::urldecode_rfc3986($value);",
          "74:           }",
          "",
          "[Added Lines]",
          "70:           $parameters = array_merge($parameters, $_POST);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "cd3060d941a051931eb2613b25bafb0108665895",
      "candidate_info": {
        "commit_hash": "cd3060d941a051931eb2613b25bafb0108665895",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/cd3060d941a051931eb2613b25bafb0108665895",
        "files": [
          "lib/ltiprovider/src/OAuth/OAuthRequest.php"
        ],
        "message": "MDL-62702 core_lib: fix broken verification signature",
        "before_after_code_files": [
          "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
          ],
          "candidate": [
            "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php": [
          "File: lib/ltiprovider/src/OAuth/OAuthRequest.php -> lib/ltiprovider/src/OAuth/OAuthRequest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:     public $base_string;",
          "19:     public static $version = '1.0';",
          "22:     function __construct($http_method, $http_url, $parameters = null) {",
          "",
          "[Removed Lines]",
          "20:     public static $POST_INPUT = 'php://input';",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "75:       }",
          "77:       return new OAuthRequest($http_method, $http_url, $parameters);",
          "",
          "[Removed Lines]",
          "72:           foreach ($_POST as $key => $value) {",
          "73:               $parameters[$key] = OAuthUtil::urldecode_rfc3986($value);",
          "74:           }",
          "",
          "[Added Lines]",
          "70:           $parameters = array_merge($parameters, $_POST);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "427463a52574e4b3bcbe1c65c49066438770641e",
      "candidate_info": {
        "commit_hash": "427463a52574e4b3bcbe1c65c49066438770641e",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/427463a52574e4b3bcbe1c65c49066438770641e",
        "files": [
          "lib/ltiprovider/src/OAuth/OAuthRequest.php"
        ],
        "message": "MDL-62702 core_lib: fix broken verification signature",
        "before_after_code_files": [
          "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
          ],
          "candidate": [
            "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/ltiprovider/src/OAuth/OAuthRequest.php||lib/ltiprovider/src/OAuth/OAuthRequest.php": [
          "File: lib/ltiprovider/src/OAuth/OAuthRequest.php -> lib/ltiprovider/src/OAuth/OAuthRequest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:     public $base_string;",
          "19:     public static $version = '1.0';",
          "22:     function __construct($http_method, $http_url, $parameters = null) {",
          "",
          "[Removed Lines]",
          "20:     public static $POST_INPUT = 'php://input';",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "75:       }",
          "77:       return new OAuthRequest($http_method, $http_url, $parameters);",
          "",
          "[Removed Lines]",
          "72:           foreach ($_POST as $key => $value) {",
          "73:               $parameters[$key] = OAuthUtil::urldecode_rfc3986($value);",
          "74:           }",
          "",
          "[Added Lines]",
          "70:           $parameters = array_merge($parameters, $_POST);",
          "",
          "---------------"
        ]
      }
    }
  ]
}