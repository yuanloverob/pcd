{
  "cve_id": "CVE-2019-15923",
  "cve_desc": "An issue was discovered in the Linux kernel before 5.0.9. There is a NULL pointer dereference for a cd data structure if alloc_disk fails in drivers/block/paride/pf.c.",
  "repo": "torvalds/linux",
  "patch_hash": "f0d1762554014ce0ae347b9f0d088f2c157c8c72",
  "patch_info": {
    "commit_hash": "f0d1762554014ce0ae347b9f0d088f2c157c8c72",
    "repo": "torvalds/linux",
    "commit_url": "https://github.com/torvalds/linux/commit/f0d1762554014ce0ae347b9f0d088f2c157c8c72",
    "files": [
      "drivers/block/paride/pcd.c"
    ],
    "message": "paride/pcd: Fix potential NULL pointer dereference and mem leak\n\nSyzkaller report this:\n\npcd: pcd version 1.07, major 46, nice 0\npcd0: Autoprobe failed\npcd: No CD-ROM drive found\nkasan: CONFIG_KASAN_INLINE enabled\nkasan: GPF could be caused by NULL-ptr deref or user memory access\ngeneral protection fault: 0000 [#1] SMP KASAN PTI\nCPU: 1 PID: 4525 Comm: syz-executor.0 Not tainted 5.1.0-rc3+ #8\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014\nRIP: 0010:pcd_init+0x95c/0x1000 [pcd]\nCode: c4 ab f7 48 89 d8 48 c1 e8 03 80 3c 28 00 74 08 48 89 df e8 56 a3 da f7 4c 8b 23 49 8d bc 24 80 05 00 00 48 89 f8 48 c1 e8 03 <80> 3c 28 00 74 05 e8 39 a3 da f7 49 8b bc 24 80 05 00 00 e8 cc b2\nRSP: 0018:ffff8881e84df880 EFLAGS: 00010202\nRAX: 00000000000000b0 RBX: ffffffffc155a088 RCX: ffffffffc1508935\nRDX: 0000000000040000 RSI: ffffc900014f0000 RDI: 0000000000000580\nRBP: dffffc0000000000 R08: ffffed103ee658b8 R09: ffffed103ee658b8\nR10: 0000000000000001 R11: ffffed103ee658b7 R12: 0000000000000000\nR13: ffffffffc155a778 R14: ffffffffc155a4a8 R15: 0000000000000003\nFS:  00007fe71bee3700(0000) GS:ffff8881f7300000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 000055a7334441a8 CR3: 00000001e9674003 CR4: 00000000007606e0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nPKRU: 55555554\nCall Trace:\n ? 0xffffffffc1508000\n ? 0xffffffffc1508000\n do_one_initcall+0xbc/0x47d init/main.c:901\n do_init_module+0x1b5/0x547 kernel/module.c:3456\n load_module+0x6405/0x8c10 kernel/module.c:3804\n __do_sys_finit_module+0x162/0x190 kernel/module.c:3898\n do_syscall_64+0x9f/0x450 arch/x86/entry/common.c:290\n entry_SYSCALL_64_after_hwframe+0x49/0xbe\nRIP: 0033:0x462e99\nCode: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48\nRSP: 002b:00007fe71bee2c58 EFLAGS: 00000246 ORIG_RAX: 0000000000000139\nRAX: ffffffffffffffda RBX: 000000000073bf00 RCX: 0000000000462e99\nRDX: 0000000000000000 RSI: 0000000020000180 RDI: 0000000000000003\nRBP: 00007fe71bee2c70 R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000246 R12: 00007fe71bee36bc\nR13: 00000000004bcefa R14: 00000000006f6fb0 R15: 0000000000000004\nModules linked in: pcd(+) paride solos_pci atm ts_fsm rtc_mt6397 mac80211 nhc_mobility nhc_udp nhc_ipv6 nhc_hop nhc_dest nhc_fragment nhc_routing 6lowpan rtc_cros_ec memconsole intel_xhci_usb_role_switch roles rtc_wm8350 usbcore industrialio_triggered_buffer kfifo_buf industrialio asc7621 dm_era dm_persistent_data dm_bufio dm_mod tpm gnss_ubx gnss_serial serdev gnss max2165 cpufreq_dt hid_penmount hid menf21bmc_wdt rc_core n_tracesink ide_gd_mod cdns_csi2tx v4l2_fwnode videodev media pinctrl_lewisburg pinctrl_intel iptable_security iptable_raw iptable_mangle iptable_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 iptable_filter bpfilter ip6_vti ip_vti ip_gre ipip sit tunnel4 ip_tunnel hsr veth netdevsim vxcan batman_adv cfg80211 rfkill chnl_net caif nlmon dummy team bonding vcan bridge stp llc ip6_gre gre ip6_tunnel tunnel6 tun joydev mousedev ppdev kvm_intel kvm irqbypass crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel aesni_intel aes_x86_64 crypto_simd\n ide_pci_generic piix input_leds cryptd glue_helper psmouse ide_core intel_agp serio_raw intel_gtt ata_generic i2c_piix4 agpgart pata_acpi parport_pc parport floppy rtc_cmos sch_fq_codel ip_tables x_tables sha1_ssse3 sha1_generic ipv6 [last unloaded: bmc150_magn]\nDumping ftrace buffer:\n   (ftrace buffer empty)\n---[ end trace d873691c3cd69f56 ]---\n\nIf alloc_disk fails in pcd_init_units, cd->disk will be\nNULL, however in pcd_detect and pcd_exit, it's not check\nthis before free.It may result a NULL pointer dereference.\n\nAlso when register_blkdev failed, blk_cleanup_queue() and\nblk_mq_free_tag_set() should be called to free resources.\n\nReported-by: Hulk Robot <hulkci@huawei.com>\nFixes: 81b74ac68c28 (\"paride/pcd: cleanup queues when detection fails\")\nSigned-off-by: YueHaibing <yuehaibing@huawei.com>\n\nSigned-off-by: Jens Axboe <axboe@kernel.dk>",
    "before_after_code_files": [
      "drivers/block/paride/pcd.c||drivers/block/paride/pcd.c"
    ]
  },
  "patch_diff": {
    "drivers/block/paride/pcd.c||drivers/block/paride/pcd.c": [
      "File: drivers/block/paride/pcd.c -> drivers/block/paride/pcd.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "314:   disk->queue = blk_mq_init_sq_queue(&cd->tag_set, &pcd_mq_ops,",
      "315:          1, BLK_MQ_F_SHOULD_MERGE);",
      "316:   if (IS_ERR(disk->queue)) {",
      "317:    disk->queue = NULL;",
      "318:    continue;",
      "319:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "317:    put_disk(disk);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "751:  printk(\"%s: No CD-ROM drive found\\n\", name);",
      "752:  for (unit = 0, cd = pcd; unit < PCD_UNITS; unit++, cd++) {",
      "753:   blk_cleanup_queue(cd->disk->queue);",
      "754:   cd->disk->queue = NULL;",
      "755:   blk_mq_free_tag_set(&cd->tag_set);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "754:   if (!cd->disk)",
      "755:    continue;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1010:  pcd_probe_capabilities();",
      "1012:  if (register_blkdev(major, name)) {",
      "1014:    put_disk(cd->disk);",
      "1015:   return -EBUSY;",
      "1016:  }",
      "",
      "[Removed Lines]",
      "1013:   for (unit = 0, cd = pcd; unit < PCD_UNITS; unit++, cd++)",
      "",
      "[Added Lines]",
      "1016:   for (unit = 0, cd = pcd; unit < PCD_UNITS; unit++, cd++) {",
      "1017:    if (!cd->disk)",
      "1018:     continue;",
      "1020:    blk_cleanup_queue(cd->disk->queue);",
      "1021:    blk_mq_free_tag_set(&cd->tag_set);",
      "1023:   }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "1032:  int unit;",
      "1034:  for (unit = 0, cd = pcd; unit < PCD_UNITS; unit++, cd++) {",
      "1035:   if (cd->present) {",
      "1036:    del_gendisk(cd->disk);",
      "1037:    pi_release(cd->pi);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1044:   if (!cd->disk)",
      "1045:    continue;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c0b0984426814f3a9251873b689e67d34d8ccd84",
      "candidate_info": {
        "commit_hash": "c0b0984426814f3a9251873b689e67d34d8ccd84",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/c0b0984426814f3a9251873b689e67d34d8ccd84",
        "files": [
          "drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c"
        ],
        "message": "net: hns: Fix probabilistic memory overwrite when HNS driver initialized\n\nWhen reboot the system again and again, may cause a memory\noverwrite.\n\n[   15.638922] systemd[1]: Reached target Swap.\n[   15.667561] tun: Universal TUN/TAP device driver, 1.6\n[   15.676756] Bridge firewalling registered\n[   17.344135] Unable to handle kernel paging request at virtual address 0000000200000040\n[   17.352179] Mem abort info:\n[   17.355007]   ESR = 0x96000004\n[   17.358105]   Exception class = DABT (current EL), IL = 32 bits\n[   17.364112]   SET = 0, FnV = 0\n[   17.367209]   EA = 0, S1PTW = 0\n[   17.370393] Data abort info:\n[   17.373315]   ISV = 0, ISS = 0x00000004\n[   17.377206]   CM = 0, WnR = 0\n[   17.380214] user pgtable: 4k pages, 48-bit VAs, pgdp = (____ptrval____)\n[   17.386926] [0000000200000040] pgd=0000000000000000\n[   17.391878] Internal error: Oops: 96000004 [#1] SMP\n[   17.396824] CPU: 23 PID: 95 Comm: kworker/u130:0 Tainted: G            E     4.19.25-1.2.78.aarch64 #1\n[   17.414175] Hardware name: Huawei TaiShan 2280 /BC11SPCD, BIOS 1.54 08/16/2018\n[   17.425615] Workqueue: events_unbound async_run_entry_fn\n[   17.435151] pstate: 00000005 (nzcv daif -PAN -UAO)\n[   17.444139] pc : __mutex_lock.isra.1+0x74/0x540\n[   17.453002] lr : __mutex_lock.isra.1+0x3c/0x540\n[   17.461701] sp : ffff000100d9bb60\n[   17.469146] x29: ffff000100d9bb60 x28: 0000000000000000\n[   17.478547] x27: 0000000000000000 x26: ffff802fb8945000\n[   17.488063] x25: 0000000000000000 x24: ffff802fa32081a8\n[   17.497381] x23: 0000000000000002 x22: ffff801fa2b15220\n[   17.506701] x21: ffff000009809000 x20: ffff802fa23a0888\n[   17.515980] x19: ffff801fa2b15220 x18: 0000000000000000\n[   17.525272] x17: 0000000200000000 x16: 0000000200000000\n[   17.534511] x15: 0000000000000000 x14: 0000000000000000\n[   17.543652] x13: ffff000008d95db8 x12: 000000000000000d\n[   17.552780] x11: ffff000008d95d90 x10: 0000000000000b00\n[   17.561819] x9 : ffff000100d9bb90 x8 : ffff802fb89d6560\n[   17.570829] x7 : 0000000000000004 x6 : 00000004a1801d05\n[   17.579839] x5 : 0000000000000000 x4 : 0000000000000000\n[   17.588852] x3 : ffff802fb89d5a00 x2 : 0000000000000000\n[   17.597734] x1 : 0000000200000000 x0 : 0000000200000000\n[   17.606631] Process kworker/u130:0 (pid: 95, stack limit = 0x(____ptrval____))\n[   17.617438] Call trace:\n[   17.623349]  __mutex_lock.isra.1+0x74/0x540\n[   17.630927]  __mutex_lock_slowpath+0x24/0x30\n[   17.638602]  mutex_lock+0x50/0x60\n[   17.645295]  drain_workqueue+0x34/0x198\n[   17.652623]  __sas_drain_work+0x7c/0x168\n[   17.659903]  sas_drain_work+0x60/0x68\n[   17.666947]  hisi_sas_scan_finished+0x30/0x40 [hisi_sas_main]\n[   17.676129]  do_scsi_scan_host+0x70/0xb0\n[   17.683534]  do_scan_async+0x20/0x228\n[   17.690586]  async_run_entry_fn+0x4c/0x1d0\n[   17.697997]  process_one_work+0x1b4/0x3f8\n[   17.705296]  worker_thread+0x54/0x470\n\nEvery time the call trace is not the same, but the overwrite address\nis always the same:\nUnable to handle kernel paging request at virtual address 0000000200000040\n\nThe root cause is, when write the reg XGMAC_MAC_TX_LF_RF_CONTROL_REG,\ndidn't use the io_base offset.\n\nSigned-off-by: Yonglong Liu <liuyonglong@huawei.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
        "before_after_code_files": [
          "drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c||drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c||drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c": [
          "File: drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c -> drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "129:  dsaf_set_bit(val, XGMAC_UNIDIR_EN_B, 0);",
          "130:  dsaf_set_bit(val, XGMAC_RF_TX_EN_B, 1);",
          "131:  dsaf_set_field(val, XGMAC_LF_RF_INSERT_M, XGMAC_LF_RF_INSERT_S, 0);",
          "133: }",
          "",
          "[Removed Lines]",
          "132:  dsaf_write_reg(mac_drv, XGMAC_MAC_TX_LF_RF_CONTROL_REG, val);",
          "",
          "[Added Lines]",
          "132:  dsaf_write_dev(mac_drv, XGMAC_MAC_TX_LF_RF_CONTROL_REG, val);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "bbd669a868bba591ffd38b7bc75a7b361bb54b04",
      "candidate_info": {
        "commit_hash": "bbd669a868bba591ffd38b7bc75a7b361bb54b04",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/bbd669a868bba591ffd38b7bc75a7b361bb54b04",
        "files": [
          "drivers/net/ethernet/ibm/ibmvnic.c"
        ],
        "message": "ibmvnic: Fix completion structure initialization\n\nFix device initialization completion handling for vNIC adapters.\nInitialize the completion structure on probe and reinitialize when needed.\nThis also fixes a race condition during kdump where the driver can attempt\nto access the completion struct before it is initialized:\n\nUnable to handle kernel paging request for data at address 0x00000000\nFaulting instruction address: 0xc0000000081acbe0\nOops: Kernel access of bad area, sig: 11 [#1]\nLE SMP NR_CPUS=2048 NUMA pSeries\nModules linked in: ibmvnic(+) ibmveth sunrpc overlay squashfs loop\nCPU: 19 PID: 301 Comm: systemd-udevd Not tainted 4.18.0-64.el8.ppc64le #1\nNIP:  c0000000081acbe0 LR: c0000000081ad964 CTR: c0000000081ad900\nREGS: c000000027f3f990 TRAP: 0300   Not tainted  (4.18.0-64.el8.ppc64le)\nMSR:  800000010280b033 <SF,VEC,VSX,EE,FP,ME,IR,DR,RI,LE,TM[E]> CR: 28228288  XER: 00000006\nCFAR: c000000008008934 DAR: 0000000000000000 DSISR: 40000000 IRQMASK: 1\nGPR00: c0000000081ad964 c000000027f3fc10 c0000000095b5800 c0000000221b4e58\nGPR04: 0000000000000003 0000000000000001 000049a086918581 00000000000000d4\nGPR08: 0000000000000007 0000000000000000 ffffffffffffffe8 d0000000014dde28\nGPR12: c0000000081ad900 c000000009a00c00 0000000000000001 0000000000000100\nGPR16: 0000000000000038 0000000000000007 c0000000095e2230 0000000000000006\nGPR20: 0000000000400140 0000000000000001 c00000000910c880 0000000000000000\nGPR24: 0000000000000000 0000000000000006 0000000000000000 0000000000000003\nGPR28: 0000000000000001 0000000000000001 c0000000221b4e60 c0000000221b4e58\nNIP [c0000000081acbe0] __wake_up_locked+0x50/0x100\nLR [c0000000081ad964] complete+0x64/0xa0\nCall Trace:\n[c000000027f3fc10] [c000000027f3fc60] 0xc000000027f3fc60 (unreliable)\n[c000000027f3fc60] [c0000000081ad964] complete+0x64/0xa0\n[c000000027f3fca0] [d0000000014dad58] ibmvnic_handle_crq+0xce0/0x1160 [ibmvnic]\n[c000000027f3fd50] [d0000000014db270] ibmvnic_tasklet+0x98/0x130 [ibmvnic]\n[c000000027f3fda0] [c00000000813f334] tasklet_action_common.isra.3+0xc4/0x1a0\n[c000000027f3fe00] [c000000008cd13f4] __do_softirq+0x164/0x400\n[c000000027f3fef0] [c00000000813ed64] irq_exit+0x184/0x1c0\n[c000000027f3ff20] [c0000000080188e8] __do_irq+0xb8/0x210\n[c000000027f3ff90] [c00000000802d0a4] call_do_irq+0x14/0x24\n[c000000026a5b010] [c000000008018adc] do_IRQ+0x9c/0x130\n[c000000026a5b060] [c000000008008ce4] hardware_interrupt_common+0x114/0x120\n\nSigned-off-by: Thomas Falcon <tlfalcon@linux.ibm.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
        "before_after_code_files": [
          "drivers/net/ethernet/ibm/ibmvnic.c||drivers/net/ethernet/ibm/ibmvnic.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "drivers/net/ethernet/ibm/ibmvnic.c||drivers/net/ethernet/ibm/ibmvnic.c": [
          "File: drivers/net/ethernet/ibm/ibmvnic.c -> drivers/net/ethernet/ibm/ibmvnic.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1886:  adapter->state = VNIC_PROBED;",
          "1888:  rc = init_crq_queue(adapter);",
          "1889:  if (rc) {",
          "1890:   netdev_err(adapter->netdev,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1888:  reinit_completion(&adapter->init_done);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4625:  old_num_rx_queues = adapter->req_rx_queues;",
          "4626:  old_num_tx_queues = adapter->req_tx_queues;",
          "4629:  adapter->init_done_rc = 0;",
          "4630:  ibmvnic_send_crq_init(adapter);",
          "4631:  if (!wait_for_completion_timeout(&adapter->init_done, timeout)) {",
          "",
          "[Removed Lines]",
          "4628:  init_completion(&adapter->init_done);",
          "",
          "[Added Lines]",
          "4629:  reinit_completion(&adapter->init_done);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4681:  adapter->from_passive_init = false;",
          "4684:  adapter->init_done_rc = 0;",
          "4685:  ibmvnic_send_crq_init(adapter);",
          "4686:  if (!wait_for_completion_timeout(&adapter->init_done, timeout)) {",
          "",
          "[Removed Lines]",
          "4683:  init_completion(&adapter->init_done);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "4759:  INIT_WORK(&adapter->ibmvnic_reset, __ibmvnic_reset);",
          "4760:  INIT_LIST_HEAD(&adapter->rwi_list);",
          "4761:  spin_lock_init(&adapter->rwi_lock);",
          "4762:  adapter->resetting = false;",
          "4764:  adapter->mac_change_pending = false;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4762:  init_completion(&adapter->init_done);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5cdb0ef6144f47440850553579aa923c20a63f23",
      "candidate_info": {
        "commit_hash": "5cdb0ef6144f47440850553579aa923c20a63f23",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/5cdb0ef6144f47440850553579aa923c20a63f23",
        "files": [
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.c",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.h",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/core.c",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.c",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.h",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.c",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.h"
        ],
        "message": "brcmfmac: fix NULL pointer derefence during USB disconnect\n\nIn case USB disconnect happens at the moment transmitting workqueue is in\nprogress the underlying interface may be gone causing a NULL pointer\ndereference. Add synchronization of the workqueue destruction with the\ndetach implementation in core so that the transmitting workqueue is stopped\nduring detach before the interfaces are removed.\n\nFix following Oops:\n\nUnable to handle kernel NULL pointer dereference at virtual address 00000008\npgd = 9e6a802d\n[00000008] *pgd=00000000\nInternal error: Oops: 5 [#1] PREEMPT SMP ARM\nModules linked in: nf_log_ipv4 nf_log_common xt_LOG xt_limit iptable_mangle\nxt_connmark xt_tcpudp xt_conntrack nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4\niptable_filter ip_tables x_tables usb_f_mass_storage usb_f_rndis u_ether\nusb_serial_simple usbserial cdc_acm brcmfmac brcmutil smsc95xx usbnet\nci_hdrc_imx ci_hdrc ulpi usbmisc_imx 8250_exar 8250_pci 8250 8250_base\nlibcomposite configfs udc_core\nCPU: 0 PID: 7 Comm: kworker/u8:0 Not tainted 4.19.23-00076-g03740aa-dirty #102\nHardware name: Freescale i.MX6 Quad/DualLite (Device Tree)\nWorkqueue: brcmf_fws_wq brcmf_fws_dequeue_worker [brcmfmac]\nPC is at brcmf_txfinalize+0x34/0x90 [brcmfmac]\nLR is at brcmf_fws_dequeue_worker+0x218/0x33c [brcmfmac]\npc : [<7f0dee64>]    lr : [<7f0e4140>]    psr: 60010093\nsp : ee8abef0  ip : 00000000  fp : edf38000\nr10: ffffffed  r9 : edf38970  r8 : edf38004\nr7 : edf3e970  r6 : 00000000  r5 : ede69000  r4 : 00000000\nr3 : 00000a97  r2 : 00000000  r1 : 0000888e  r0 : ede69000\nFlags: nZCv  IRQs off  FIQs on  Mode SVC_32  ISA ARM  Segment none\nControl: 10c5387d  Table: 7d03c04a  DAC: 00000051\nProcess kworker/u8:0 (pid: 7, stack limit = 0x24ec3e04)\nStack: (0xee8abef0 to 0xee8ac000)\nbee0:                                     ede69000 00000000 ed56c3e0 7f0e4140\nbf00: 00000001 00000000 edf38004 edf3e99c ed56c3e0 80d03d00 edfea43a edf3e970\nbf20: ee809880 ee804200 ee971100 00000000 edf3e974 00000000 ee804200 80135a70\nbf40: 80d03d00 ee804218 ee809880 ee809894 ee804200 80d03d00 ee804218 ee8aa000\nbf60: 00000088 80135d5c 00000000 ee829f00 ee829dc0 00000000 ee809880 80135d30\nbf80: ee829f1c ee873eac 00000000 8013b1a0 ee829dc0 8013b07c 00000000 00000000\nbfa0: 00000000 00000000 00000000 801010e8 00000000 00000000 00000000 00000000\nbfc0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\nbfe0: 00000000 00000000 00000000 00000000 00000013 00000000 00000000 00000000\n[<7f0dee64>] (brcmf_txfinalize [brcmfmac]) from [<7f0e4140>] (brcmf_fws_dequeue_worker+0x218/0x33c [brcmfmac])\n[<7f0e4140>] (brcmf_fws_dequeue_worker [brcmfmac]) from [<80135a70>] (process_one_work+0x138/0x3f8)\n[<80135a70>] (process_one_work) from [<80135d5c>] (worker_thread+0x2c/0x554)\n[<80135d5c>] (worker_thread) from [<8013b1a0>] (kthread+0x124/0x154)\n[<8013b1a0>] (kthread) from [<801010e8>] (ret_from_fork+0x14/0x2c)\nException stack(0xee8abfb0 to 0xee8abff8)\nbfa0:                                     00000000 00000000 00000000 00000000\nbfc0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000\nbfe0: 00000000 00000000 00000000 00000000 00000013 00000000\nCode: e1530001 0a000007 e3560000 e1a00005 (05942008)\n---[ end trace 079239dd31c86e90 ]---\n\nSigned-off-by: Piotr Figiel <p.figiel@camlintechnologies.com>\nSigned-off-by: Kalle Valo <kvalo@codeaurora.org>",
        "before_after_code_files": [
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.c||drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.c",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.h||drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.h",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/core.c||drivers/net/wireless/broadcom/brcm80211/brcmfmac/core.c",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.c||drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.c",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.h||drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.h",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.c||drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.c",
          "drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.h||drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.c||drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.c": [
          "File: drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.c -> drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "490:  return -ENOMEM;",
          "491: }",
          "494: {",
          "495:  struct brcmf_bcdc *bcdc = drvr->proto->pd;",
          "497:  drvr->proto->pd = NULL;",
          "499:  kfree(bcdc);",
          "500: }",
          "",
          "[Removed Lines]",
          "493: void brcmf_proto_bcdc_detach(struct brcmf_pub *drvr)",
          "498:  brcmf_fws_detach(bcdc->fws);",
          "",
          "[Added Lines]",
          "493: void brcmf_proto_bcdc_detach_pre_delif(struct brcmf_pub *drvr)",
          "494: {",
          "495:  struct brcmf_bcdc *bcdc = drvr->proto->pd;",
          "497:  brcmf_fws_detach_pre_delif(bcdc->fws);",
          "498: }",
          "500: void brcmf_proto_bcdc_detach_post_delif(struct brcmf_pub *drvr)",
          "505:  brcmf_fws_detach_post_delif(bcdc->fws);",
          "",
          "---------------"
        ],
        "drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.h||drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.h": [
          "File: drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.h -> drivers/net/wireless/broadcom/brcm80211/brcmfmac/bcdc.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: #ifdef CONFIG_BRCMFMAC_PROTO_BCDC",
          "20: int brcmf_proto_bcdc_attach(struct brcmf_pub *drvr);",
          "22: void brcmf_proto_bcdc_txflowblock(struct device *dev, bool state);",
          "23: void brcmf_proto_bcdc_txcomplete(struct device *dev, struct sk_buff *txp,",
          "24:      bool success);",
          "25: struct brcmf_fws_info *drvr_to_fws(struct brcmf_pub *drvr);",
          "26: #else",
          "27: static inline int brcmf_proto_bcdc_attach(struct brcmf_pub *drvr) { return 0; }",
          "29: #endif",
          "",
          "[Removed Lines]",
          "21: void brcmf_proto_bcdc_detach(struct brcmf_pub *drvr);",
          "28: static inline void brcmf_proto_bcdc_detach(struct brcmf_pub *drvr) {}",
          "",
          "[Added Lines]",
          "21: void brcmf_proto_bcdc_detach_pre_delif(struct brcmf_pub *drvr);",
          "22: void brcmf_proto_bcdc_detach_post_delif(struct brcmf_pub *drvr);",
          "29: static void brcmf_proto_bcdc_detach_pre_delif(struct brcmf_pub *drvr) {};",
          "30: static inline void brcmf_proto_bcdc_detach_post_delif(struct brcmf_pub *drvr) {}",
          "",
          "---------------"
        ],
        "drivers/net/wireless/broadcom/brcm80211/brcmfmac/core.c||drivers/net/wireless/broadcom/brcm80211/brcmfmac/core.c": [
          "File: drivers/net/wireless/broadcom/brcm80211/brcmfmac/core.c -> drivers/net/wireless/broadcom/brcm80211/brcmfmac/core.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1322:  brcmf_bus_change_state(bus_if, BRCMF_BUS_DOWN);",
          "1325:  for (i = BRCMF_MAX_IFS-1; i > -1; i--)",
          "1326:   brcmf_remove_interface(drvr->iflist[i], false);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1324:  brcmf_proto_detach_pre_delif(drvr);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1331:  brcmf_bus_stop(drvr->bus_if);",
          "1335:  bus_if->drvr = NULL;",
          "1336:  wiphy_free(drvr->wiphy);",
          "",
          "[Removed Lines]",
          "1333:  brcmf_proto_detach(drvr);",
          "",
          "[Added Lines]",
          "1335:  brcmf_proto_detach_post_delif(drvr);",
          "",
          "---------------"
        ],
        "drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.c||drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.c": [
          "File: drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.c -> drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2443:  return fws;",
          "2445: fail:",
          "2447:  return ERR_PTR(rc);",
          "2448: }",
          "2451: {",
          "2452:  if (!fws)",
          "2453:   return;",
          "2456:   destroy_workqueue(fws->fws_wq);",
          "2459:  brcmf_fws_lock(fws);",
          "",
          "[Removed Lines]",
          "2446:  brcmf_fws_detach(fws);",
          "2450: void brcmf_fws_detach(struct brcmf_fws_info *fws)",
          "2455:  if (fws->fws_wq)",
          "",
          "[Added Lines]",
          "2446:  brcmf_fws_detach_pre_delif(fws);",
          "2447:  brcmf_fws_detach_post_delif(fws);",
          "2451: void brcmf_fws_detach_pre_delif(struct brcmf_fws_info *fws)",
          "2455:  if (fws->fws_wq) {",
          "2457:   fws->fws_wq = NULL;",
          "2458:  }",
          "2459: }",
          "2461: void brcmf_fws_detach_post_delif(struct brcmf_fws_info *fws)",
          "2462: {",
          "2463:  if (!fws)",
          "2464:   return;",
          "",
          "---------------"
        ],
        "drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.h||drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.h": [
          "File: drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.h -> drivers/net/wireless/broadcom/brcm80211/brcmfmac/fwsignal.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: #define FWSIGNAL_H_",
          "21: struct brcmf_fws_info *brcmf_fws_attach(struct brcmf_pub *drvr);",
          "23: void brcmf_fws_debugfs_create(struct brcmf_pub *drvr);",
          "24: bool brcmf_fws_queue_skbs(struct brcmf_fws_info *fws);",
          "25: bool brcmf_fws_fc_active(struct brcmf_fws_info *fws);",
          "",
          "[Removed Lines]",
          "22: void brcmf_fws_detach(struct brcmf_fws_info *fws);",
          "",
          "[Added Lines]",
          "22: void brcmf_fws_detach_pre_delif(struct brcmf_fws_info *fws);",
          "23: void brcmf_fws_detach_post_delif(struct brcmf_fws_info *fws);",
          "",
          "---------------"
        ],
        "drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.c||drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.c": [
          "File: drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.c -> drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "67:  return -ENOMEM;",
          "68: }",
          "71: {",
          "72:  brcmf_dbg(TRACE, \"Enter\\n\");",
          "74:  if (drvr->proto) {",
          "75:   if (drvr->bus_if->proto_type == BRCMF_PROTO_BCDC)",
          "77:   else if (drvr->bus_if->proto_type == BRCMF_PROTO_MSGBUF)",
          "78:    brcmf_proto_msgbuf_detach(drvr);",
          "79:   kfree(drvr->proto);",
          "80:   drvr->proto = NULL;",
          "81:  }",
          "82: }",
          "",
          "[Removed Lines]",
          "70: void brcmf_proto_detach(struct brcmf_pub *drvr)",
          "76:    brcmf_proto_bcdc_detach(drvr);",
          "",
          "[Added Lines]",
          "70: void brcmf_proto_detach_post_delif(struct brcmf_pub *drvr)",
          "76:    brcmf_proto_bcdc_detach_post_delif(drvr);",
          "84: void brcmf_proto_detach_pre_delif(struct brcmf_pub *drvr)",
          "85: {",
          "86:  if (drvr->proto && drvr->bus_if->proto_type == BRCMF_PROTO_BCDC)",
          "87:   brcmf_proto_bcdc_detach_pre_delif(drvr);",
          "88: }",
          "",
          "---------------"
        ],
        "drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.h||drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.h": [
          "File: drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.h -> drivers/net/wireless/broadcom/brcm80211/brcmfmac/proto.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "56: int brcmf_proto_attach(struct brcmf_pub *drvr);",
          "59: static inline int brcmf_proto_hdrpull(struct brcmf_pub *drvr, bool do_fws,",
          "60:           struct sk_buff *skb,",
          "",
          "[Removed Lines]",
          "57: void brcmf_proto_detach(struct brcmf_pub *drvr);",
          "",
          "[Added Lines]",
          "57: void brcmf_proto_detach_pre_delif(struct brcmf_pub *drvr);",
          "58: void brcmf_proto_detach_post_delif(struct brcmf_pub *drvr);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "73f28f714a8fd0ecb692a225bb7a5979d902ecb5",
      "candidate_info": {
        "commit_hash": "73f28f714a8fd0ecb692a225bb7a5979d902ecb5",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/73f28f714a8fd0ecb692a225bb7a5979d902ecb5",
        "files": [
          "drivers/rtc/lib.c"
        ],
        "message": "rtc: lib: check whether tm->tm_year in int32 range\n\nWhen setting rtc alarm (RTC_WKALM_SET), the tm_year is not checked if it\nis in suiteable range. Use INT_MAX - 1900 to check it.\n\nUBSAN: Undefined behaviour in drivers/rtc/rtc-lib.c:119:30\nsigned integer overflow:\n2147483647 + 1900 cannot be represented in type 'int'\nCPU: 1 PID: 20994 Comm: syz-executor0 Not tainted 4.19.18-514.55.6.9.x86_64\n+ #1\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1\n04/01/2014\nCall Trace:\n __dump_stack lib/dump_stack.c:77 [inline]\n dump_stack+0xca/0x13e lib/dump_stack.c:113\n ubsan_epilogue+0xe/0x81 lib/ubsan.c:159\n handle_overflow+0x193/0x1e2 lib/ubsan.c:190\n rtc_tm_to_time64+0x267/0x280 drivers/rtc/rtc-lib.c:119\n rtc_tm_to_ktime+0x16/0x70 drivers/rtc/rtc-lib.c:129\n rtc_set_alarm+0x1a9/0x2d0 drivers/rtc/interface.c:466\n rtc_dev_ioctl+0x6db/0x810 drivers/rtc/rtc-dev.c:380\n vfs_ioctl fs/ioctl.c:46 [inline]\n do_vfs_ioctl+0x1a5/0x10b0 fs/ioctl.c:690\n ksys_ioctl+0x89/0xa0 fs/ioctl.c:705\n __do_sys_ioctl fs/ioctl.c:712 [inline]\n __se_sys_ioctl fs/ioctl.c:710 [inline]\n __x64_sys_ioctl+0x74/0xb0 fs/ioctl.c:710\n do_syscall_64+0xc8/0x580 arch/x86/entry/common.c:290\n entry_SYSCALL_64_after_hwframe+0x49/0xbe\nRIP: 0033:0x462589\nCode: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89\nf8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08\n0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8\n64 89 01 48\nRSP: 002b:00007f5348896c58 EFLAGS: 00000246 ORIG_RAX: 0000000000000010\nRAX: ffffffffffffffda RBX: 000000000072bf00 RCX: 0000000000462589\nRDX: 0000000020000000 RSI: 000000004028700f RDI: 0000000000000003\nRBP: 0000000000000003 R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000246 R12: 00007f53488976bc\nR13: 00000000004bf67e R14: 00000000006f96e0 R15: 00000000ffffffff\n\n==========================================================================\n\nSigned-off-by: Xuefeng Wang <wxf.wang@hisilicon.com>\nSigned-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>",
        "before_after_code_files": [
          "drivers/rtc/lib.c||drivers/rtc/lib.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "drivers/rtc/lib.c||drivers/rtc/lib.c": [
          "File: drivers/rtc/lib.c -> drivers/rtc/lib.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "94: int rtc_valid_tm(struct rtc_time *tm)",
          "95: {",
          "96:  if (tm->tm_year < 70 ||",
          "97:      ((unsigned int)tm->tm_mon) >= 12 ||",
          "98:      tm->tm_mday < 1 ||",
          "99:      tm->tm_mday > rtc_month_days(tm->tm_mon,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "97:      tm->tm_year > (INT_MAX - 1900) ||",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6b0868c820ff7370d15d6ddfe71b1ce6bbe8a25d",
      "candidate_info": {
        "commit_hash": "6b0868c820ff7370d15d6ddfe71b1ce6bbe8a25d",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/6b0868c820ff7370d15d6ddfe71b1ce6bbe8a25d",
        "files": [
          "mm/compaction.c"
        ],
        "message": "mm/compaction.c: correct zone boundary handling when resetting pageblock skip hints\n\nMikhail Gavrilo reported the following bug being triggered in a Fedora\nkernel based on 5.1-rc1 but it is relevant to a vanilla kernel.\n\n kernel: page dumped because: VM_BUG_ON_PAGE(PagePoisoned(p))\n kernel: ------------[ cut here ]------------\n kernel: kernel BUG at include/linux/mm.h:1021!\n kernel: invalid opcode: 0000 [#1] SMP NOPTI\n kernel: CPU: 6 PID: 116 Comm: kswapd0 Tainted: G         C        5.1.0-0.rc1.git1.3.fc31.x86_64 #1\n kernel: Hardware name: System manufacturer System Product Name/ROG STRIX X470-I GAMING, BIOS 1201 12/07/2018\n kernel: RIP: 0010:__reset_isolation_pfn+0x244/0x2b0\n kernel: Code: fe 06 e8 0f 8e fc ff 44 0f b6 4c 24 04 48 85 c0 0f 85 dc fe ff ff e9 68 fe ff ff 48 c7 c6 58 b7 2e 8c 4c 89 ff e8 0c 75 00 00 <0f> 0b 48 c7 c6 58 b7 2e 8c e8 fe 74 00 00 0f 0b 48 89 fa 41 b8 01\n kernel: RSP: 0018:ffff9e2d03f0fde8 EFLAGS: 00010246\n kernel: RAX: 0000000000000034 RBX: 000000000081f380 RCX: ffff8cffbddd6c20\n kernel: RDX: 0000000000000000 RSI: 0000000000000006 RDI: ffff8cffbddd6c20\n kernel: RBP: 0000000000000001 R08: 0000009898b94613 R09: 0000000000000000\n kernel: R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000100000\n kernel: R13: 0000000000100000 R14: 0000000000000001 R15: ffffca7de07ce000\n kernel: FS:  0000000000000000(0000) GS:ffff8cffbdc00000(0000) knlGS:0000000000000000\n kernel: CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n kernel: CR2: 00007fc1670e9000 CR3: 00000007f5276000 CR4: 00000000003406e0\n kernel: Call Trace:\n kernel:  __reset_isolation_suitable+0x62/0x120\n kernel:  reset_isolation_suitable+0x3b/0x40\n kernel:  kswapd+0x147/0x540\n kernel:  ? finish_wait+0x90/0x90\n kernel:  kthread+0x108/0x140\n kernel:  ? balance_pgdat+0x560/0x560\n kernel:  ? kthread_park+0x90/0x90\n kernel:  ret_from_fork+0x27/0x50\n\nHe bisected it down to e332f741a8dd (\"mm, compaction: be selective about\nwhat pageblocks to clear skip hints\").  The problem is that the patch in\nquestion was sloppy with respect to the handling of zone boundaries.  In\nsome instances, it was possible for PFNs outside of a zone to be examined\nand if those were not properly initialised or poisoned then it would\ntrigger the VM_BUG_ON.  This patch corrects the zone boundary issues when\nresetting pageblock skip hints and Mikhail reported that the bug did not\ntrigger after 30 hours of testing.\n\nLink: http://lkml.kernel.org/r/20190327085424.GL3189@techsingularity.net\nFixes: e332f741a8dd (\"mm, compaction: be selective about what pageblocks to clear skip hints\")\nReported-by: Mikhail Gavrilov <mikhail.v.gavrilov@gmail.com>\nTested-by: Mikhail Gavrilov <mikhail.v.gavrilov@gmail.com>\nCc: Daniel Jordan <daniel.m.jordan@oracle.com>\nCc: Qian Cai <cai@lca.pw>\nCc: Vlastimil Babka <vbabka@suse.cz>\nSigned-off-by: Mel Gorman <mgorman@techsingularity.net>",
        "before_after_code_files": [
          "mm/compaction.c||mm/compaction.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "mm/compaction.c||mm/compaction.c": [
          "File: mm/compaction.c -> mm/compaction.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "242:        bool check_target)",
          "243: {",
          "244:  struct page *page = pfn_to_online_page(pfn);",
          "245:  struct page *end_page;",
          "246:  unsigned long block_pfn;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "245:  struct page *block_page;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "267:      get_pageblock_migratetype(page) != MIGRATE_MOVABLE)",
          "268:   return false;",
          "284:  do {",
          "285:   if (pfn_valid_within(pfn)) {",
          "286:    if (check_source && PageLRU(page)) {",
          "",
          "[Removed Lines]",
          "275:  block_pfn = pageblock_start_pfn(pfn);",
          "276:  pfn = max(block_pfn, zone->zone_start_pfn);",
          "277:  page = pfn_to_page(pfn);",
          "278:  if (zone != page_zone(page))",
          "279:   return false;",
          "280:  pfn = block_pfn + pageblock_nr_pages;",
          "281:  pfn = min(pfn, zone_end_pfn(zone));",
          "282:  end_page = pfn_to_page(pfn);",
          "",
          "[Added Lines]",
          "272:  block_pfn = pageblock_start_pfn(pfn);",
          "273:  block_page = pfn_to_online_page(max(block_pfn, zone->zone_start_pfn));",
          "274:  if (block_page) {",
          "275:   page = block_page;",
          "276:   pfn = block_pfn;",
          "277:  }",
          "280:  block_pfn += pageblock_nr_pages;",
          "281:  block_pfn = min(block_pfn, zone_end_pfn(zone) - 1);",
          "282:  end_page = pfn_to_online_page(block_pfn);",
          "283:  if (!end_page)",
          "284:   return false;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "309: static void __reset_isolation_suitable(struct zone *zone)",
          "310: {",
          "311:  unsigned long migrate_pfn = zone->zone_start_pfn;",
          "313:  unsigned long reset_migrate = free_pfn;",
          "314:  unsigned long reset_free = migrate_pfn;",
          "315:  bool source_set = false;",
          "",
          "[Removed Lines]",
          "312:  unsigned long free_pfn = zone_end_pfn(zone);",
          "",
          "[Added Lines]",
          "319:  unsigned long free_pfn = zone_end_pfn(zone) - 1;",
          "",
          "---------------"
        ]
      }
    }
  ]
}