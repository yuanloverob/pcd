{
  "cve_id": "CVE-2014-0221",
  "cve_desc": "The dtls1_get_message_fragment function in d1_both.c in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h allows remote attackers to cause a denial of service (recursion and client crash) via a DTLS hello message in an invalid DTLS handshake.",
  "repo": "openssl/openssl",
  "patch_hash": "b4322e1de8be66ff230e26999b766ca1a42f9476",
  "patch_info": {
    "commit_hash": "b4322e1de8be66ff230e26999b766ca1a42f9476",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/b4322e1de8be66ff230e26999b766ca1a42f9476",
    "files": [
      "ssl/d1_both.c"
    ],
    "message": "Fix CVE-2014-0221\n\nUnnecessary recursion when receiving a DTLS hello request can be used to\ncrash a DTLS client. Fixed by handling DTLS hello request without recursion.\n\nThanks to Imre Rad (Search-Lab Ltd.) for discovering this issue.\n(cherry picked from commit d3152655d5319ce883c8e3ac4b99f8de4c59d846)",
    "before_after_code_files": [
      "ssl/d1_both.c||ssl/d1_both.c"
    ]
  },
  "patch_diff": {
    "ssl/d1_both.c||ssl/d1_both.c": [
      "File: ssl/d1_both.c -> ssl/d1_both.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "789:  int i,al;",
      "790:  struct hm_header_st msg_hdr;",
      "793:  if ((frag_len = dtls1_retrieve_buffered_fragment(s,max,ok)) || *ok)",
      "794:   {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "792:  redo:",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "847:      s->msg_callback_arg);",
      "849:    s->init_num = 0;",
      "852:    }",
      "854:    {",
      "",
      "[Removed Lines]",
      "850:    return dtls1_get_message_fragment(s, st1, stn,",
      "851:     max, ok);",
      "",
      "[Added Lines]",
      "851:    goto redo;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8942b92c7cb5fa144bd79b7607b459d0b777164c",
      "candidate_info": {
        "commit_hash": "8942b92c7cb5fa144bd79b7607b459d0b777164c",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/8942b92c7cb5fa144bd79b7607b459d0b777164c",
        "files": [
          "ssl/d1_both.c"
        ],
        "message": "Fix CVE-2014-0221\n\nUnnecessary recursion when receiving a DTLS hello request can be used to\ncrash a DTLS client. Fixed by handling DTLS hello request without recursion.\n\nThanks to Imre Rad (Search-Lab Ltd.) for discovering this issue.\n(cherry picked from commit d3152655d5319ce883c8e3ac4b99f8de4c59d846)",
        "before_after_code_files": [
          "ssl/d1_both.c||ssl/d1_both.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ssl/d1_both.c||ssl/d1_both.c"
          ],
          "candidate": [
            "ssl/d1_both.c||ssl/d1_both.c"
          ]
        }
      },
      "candidate_diff": {
        "ssl/d1_both.c||ssl/d1_both.c": [
          "File: ssl/d1_both.c -> ssl/d1_both.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "789:  int i,al;",
          "790:  struct hm_header_st msg_hdr;",
          "793:  if ((frag_len = dtls1_retrieve_buffered_fragment(s,max,ok)) || *ok)",
          "794:   {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "792:  redo:",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "847:      s->msg_callback_arg);",
          "849:    s->init_num = 0;",
          "852:    }",
          "854:    {",
          "",
          "[Removed Lines]",
          "850:    return dtls1_get_message_fragment(s, st1, stn,",
          "851:     max, ok);",
          "",
          "[Added Lines]",
          "851:    goto redo;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d3152655d5319ce883c8e3ac4b99f8de4c59d846",
      "candidate_info": {
        "commit_hash": "d3152655d5319ce883c8e3ac4b99f8de4c59d846",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/d3152655d5319ce883c8e3ac4b99f8de4c59d846",
        "files": [
          "ssl/d1_both.c"
        ],
        "message": "Fix CVE-2014-0221\n\nUnnecessary recursion when receiving a DTLS hello request can be used to\ncrash a DTLS client. Fixed by handling DTLS hello request without recursion.\n\nThanks to Imre Rad (Search-Lab Ltd.) for discovering this issue.",
        "before_after_code_files": [
          "ssl/d1_both.c||ssl/d1_both.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ssl/d1_both.c||ssl/d1_both.c"
          ],
          "candidate": [
            "ssl/d1_both.c||ssl/d1_both.c"
          ]
        }
      },
      "candidate_diff": {
        "ssl/d1_both.c||ssl/d1_both.c": [
          "File: ssl/d1_both.c -> ssl/d1_both.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "793:  int i,al;",
          "794:  struct hm_header_st msg_hdr;",
          "797:  if ((frag_len = dtls1_retrieve_buffered_fragment(s,max,ok)) || *ok)",
          "798:   {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "796:  redo:",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "851:      s->msg_callback_arg);",
          "853:    s->init_num = 0;",
          "856:    }",
          "858:    {",
          "",
          "[Removed Lines]",
          "854:    return dtls1_get_message_fragment(s, st1, stn,",
          "855:     max, ok);",
          "",
          "[Added Lines]",
          "855:    goto redo;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "519c977c47b30d5ca24000b146c0e0bbb360279e",
      "candidate_info": {
        "commit_hash": "519c977c47b30d5ca24000b146c0e0bbb360279e",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/519c977c47b30d5ca24000b146c0e0bbb360279e",
        "files": [
          "ssl/d1_both.c"
        ],
        "message": "Fix CVE-2014-0221\n\nUnnecessary recursion when receiving a DTLS hello request can be used to\ncrash a DTLS client. Fixed by handling DTLS hello request without recursion.\n\nThanks to Imre Rad (Search-Lab Ltd.) for discovering this issue.",
        "before_after_code_files": [
          "ssl/d1_both.c||ssl/d1_both.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ssl/d1_both.c||ssl/d1_both.c"
          ],
          "candidate": [
            "ssl/d1_both.c||ssl/d1_both.c"
          ]
        }
      },
      "candidate_diff": {
        "ssl/d1_both.c||ssl/d1_both.c": [
          "File: ssl/d1_both.c -> ssl/d1_both.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "793:  int i,al;",
          "794:  struct hm_header_st msg_hdr;",
          "797:  if ((frag_len = dtls1_retrieve_buffered_fragment(s,max,ok)) || *ok)",
          "798:   {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "796:  redo:",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "851:      s->msg_callback_arg);",
          "853:    s->init_num = 0;",
          "856:    }",
          "858:    {",
          "",
          "[Removed Lines]",
          "854:    return dtls1_get_message_fragment(s, st1, stn,",
          "855:     max, ok);",
          "",
          "[Added Lines]",
          "855:    goto redo;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "de2422affbe24262496f477edeb1c04017907eb4",
      "candidate_info": {
        "commit_hash": "de2422affbe24262496f477edeb1c04017907eb4",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/de2422affbe24262496f477edeb1c04017907eb4",
        "files": [
          "ssl/d1_both.c"
        ],
        "message": "Fix CVE-2014-0221\n\nUnnecessary recursion when receiving a DTLS hello request can be used to\ncrash a DTLS client. Fixed by handling DTLS hello request without recursion.\n\nThanks to Imre Rad (Search-Lab Ltd.) for discovering this issue.",
        "before_after_code_files": [
          "ssl/d1_both.c||ssl/d1_both.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ssl/d1_both.c||ssl/d1_both.c"
          ],
          "candidate": [
            "ssl/d1_both.c||ssl/d1_both.c"
          ]
        }
      },
      "candidate_diff": {
        "ssl/d1_both.c||ssl/d1_both.c": [
          "File: ssl/d1_both.c -> ssl/d1_both.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "787:  int i,al;",
          "788:  struct hm_header_st msg_hdr;",
          "791:  if ((frag_len = dtls1_retrieve_buffered_fragment(s,max,ok)) || *ok)",
          "792:   {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "790:  redo:",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "845:      s->msg_callback_arg);",
          "847:    s->init_num = 0;",
          "850:    }",
          "852:    {",
          "",
          "[Removed Lines]",
          "848:    return dtls1_get_message_fragment(s, st1, stn,",
          "849:     max, ok);",
          "",
          "[Added Lines]",
          "849:    goto redo;",
          "",
          "---------------"
        ]
      }
    }
  ]
}