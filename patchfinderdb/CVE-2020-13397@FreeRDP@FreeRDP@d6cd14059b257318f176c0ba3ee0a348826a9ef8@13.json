{
  "cve_id": "CVE-2020-13397",
  "cve_desc": "An issue was discovered in FreeRDP before 2.1.1. An out-of-bounds (OOB) read vulnerability has been detected in security_fips_decrypt in libfreerdp/core/security.c due to an uninitialized value.",
  "repo": "FreeRDP/FreeRDP",
  "patch_hash": "d6cd14059b257318f176c0ba3ee0a348826a9ef8",
  "patch_info": {
    "commit_hash": "d6cd14059b257318f176c0ba3ee0a348826a9ef8",
    "repo": "FreeRDP/FreeRDP",
    "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/d6cd14059b257318f176c0ba3ee0a348826a9ef8",
    "files": [
      "libfreerdp/core/security.c"
    ],
    "message": "Fixed GHSL-2020-101 missing NULL check\n\n(cherry picked from commit b207dbba35c505bbc3ad5aadc10b34980c6b7e8e)",
    "before_after_code_files": [
      "libfreerdp/core/security.c||libfreerdp/core/security.c"
    ]
  },
  "patch_diff": {
    "libfreerdp/core/security.c||libfreerdp/core/security.c": [
      "File: libfreerdp/core/security.c -> libfreerdp/core/security.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "816: {",
      "817:  size_t olen;",
      "819:  if (!winpr_Cipher_Update(rdp->fips_decrypt, data, length, data, &olen))",
      "820:   return FALSE;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "819:  if (!rdp || !rdp->fips_decrypt)",
      "820:   return FALSE;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "df63cfb55f4ee96a69199ef285dc37ef8ea0b12c",
      "candidate_info": {
        "commit_hash": "df63cfb55f4ee96a69199ef285dc37ef8ea0b12c",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/df63cfb55f4ee96a69199ef285dc37ef8ea0b12c",
        "files": [
          "libfreerdp/core/info.c"
        ],
        "message": "Reformatted to satisfy clang-format\n\n(cherry picked from commit a4e95f8e65dfbfd2625034ad6740645366a6c0c0)",
        "before_after_code_files": [
          "libfreerdp/core/info.c||libfreerdp/core/info.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/FreeRDP/FreeRDP/pull/6212"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "libfreerdp/core/info.c||libfreerdp/core/info.c": [
          "File: libfreerdp/core/info.c -> libfreerdp/core/info.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "466: static BOOL rdp_read_info_string(UINT32 flags, wStream* s, size_t cbLenNonNull, CHAR** dst,",
          "467:                                  size_t max)",
          "468: {",
          "471:   char c;",
          "472:   WCHAR w;",
          "473:   BYTE b[2];",
          "",
          "[Removed Lines]",
          "469:  union",
          "470:  {",
          "",
          "[Added Lines]",
          "469:  union {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b222b10c7bde3df2ae2803c6bd1a7ce8a6352f37",
      "candidate_info": {
        "commit_hash": "b222b10c7bde3df2ae2803c6bd1a7ce8a6352f37",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/b222b10c7bde3df2ae2803c6bd1a7ce8a6352f37",
        "files": [
          "server/shadow/freerdp-shadow-cli.1.in",
          "winpr/tools/makecert-cli/winpr-makecert.1.in"
        ],
        "message": "Fixed typos (Otherweise)\n\nOtherweise ->\nOtherw ise\n      ^\n\n(cherry picked from commit 148f3c675d02da2c7f19b3099ba8792f5594416b)",
        "before_after_code_files": [
          "server/shadow/freerdp-shadow-cli.1.in||server/shadow/freerdp-shadow-cli.1.in",
          "winpr/tools/makecert-cli/winpr-makecert.1.in||winpr/tools/makecert-cli/winpr-makecert.1.in"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/FreeRDP/FreeRDP/pull/6212"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "server/shadow/freerdp-shadow-cli.1.in||server/shadow/freerdp-shadow-cli.1.in": [
          "File: server/shadow/freerdp-shadow-cli.1.in -> server/shadow/freerdp-shadow-cli.1.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "76: Successful program execution.",
          "77: .TP",
          "78: .B 1",
          "81: .SH SEE ALSO",
          "82: wlog(7)",
          "",
          "[Removed Lines]",
          "79: Otherweise.",
          "",
          "[Added Lines]",
          "79: Otherwise.",
          "",
          "---------------"
        ],
        "winpr/tools/makecert-cli/winpr-makecert.1.in||winpr/tools/makecert-cli/winpr-makecert.1.in": [
          "File: winpr/tools/makecert-cli/winpr-makecert.1.in -> winpr/tools/makecert-cli/winpr-makecert.1.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "106: Successful program execution.",
          "107: .TP",
          "108: .B 1",
          "111: .SH SEE ALSO",
          "",
          "[Removed Lines]",
          "109: Otherweise.",
          "",
          "[Added Lines]",
          "109: Otherwise.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fe3e7eaa34f6b117e1d0be0328f7832f34f8d207",
      "candidate_info": {
        "commit_hash": "fe3e7eaa34f6b117e1d0be0328f7832f34f8d207",
        "repo": "FreeRDP/FreeRDP",
        "commit_url": "https://github.com/FreeRDP/FreeRDP/commit/fe3e7eaa34f6b117e1d0be0328f7832f34f8d207",
        "files": [
          "libfreerdp/core/security.c"
        ],
        "message": "Fixed GHSL-2020-101 missing NULL check",
        "before_after_code_files": [
          "libfreerdp/core/security.c||libfreerdp/core/security.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libfreerdp/core/security.c||libfreerdp/core/security.c"
          ],
          "candidate": [
            "libfreerdp/core/security.c||libfreerdp/core/security.c"
          ]
        }
      },
      "candidate_diff": {
        "libfreerdp/core/security.c||libfreerdp/core/security.c": [
          "File: libfreerdp/core/security.c -> libfreerdp/core/security.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "816: {",
          "817:  size_t olen;",
          "819:  if (!winpr_Cipher_Update(rdp->fips_decrypt, data, length, data, &olen))",
          "820:   return FALSE;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "819:  if (!rdp || !rdp->fips_decrypt)",
          "820:   return FALSE;",
          "",
          "---------------"
        ]
      }
    }
  ]
}