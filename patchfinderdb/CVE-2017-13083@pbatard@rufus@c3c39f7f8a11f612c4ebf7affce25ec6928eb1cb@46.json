{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9f1f164aff0e6891530f435bca77577cdd755622",
      "candidate_info": {
        "commit_hash": "9f1f164aff0e6891530f435bca77577cdd755622",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/9f1f164aff0e6891530f435bca77577cdd755622",
        "files": [
          "src/dev.c",
          "src/hdd_vs_ufd.h",
          "src/rufus.rc"
        ],
        "message": "[dev] adjust score for Alcor based UFDs\n\n* Closes #888",
        "before_after_code_files": [
          "src/dev.c||src/dev.c",
          "src/hdd_vs_ufd.h||src/hdd_vs_ufd.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/dev.c||src/dev.c": [
          "File: src/dev.c -> src/dev.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "255: #ifdef FORCED_DEVICE",
          "259: #endif",
          "",
          "[Removed Lines]",
          "256: #define FORCED_VID 0x1F75",
          "257: #define FORCED_PID 0x0917",
          "258: #define FORCED_NAME \"Intenso Speed Line USB Device\"",
          "",
          "[Added Lines]",
          "256: #define FORCED_VID 0x058F",
          "257: #define FORCED_PID 0x6387",
          "258: #define FORCED_NAME \"Intenso Rainbow Line USB Device\"",
          "",
          "---------------"
        ],
        "src/hdd_vs_ufd.h||src/hdd_vs_ufd.h": [
          "File: src/hdd_vs_ufd.h -> src/hdd_vs_ufd.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "116:  { 0x04e8, 5 },  // Samsung",
          "117:  { 0x04f3, -5 },  // Elan",
          "118:  { 0x04fc, 5 },  // Sunplus",
          "120:  { 0x059b, 7 },  // Iomega",
          "121:  { 0x059f, 5 },  // LaCie",
          "122:  { 0x05ab, 10 },  // In-System Design",
          "",
          "[Removed Lines]",
          "119:  { 0x058f, -2 },  // Alcor",
          "",
          "[Added Lines]",
          "119:  { 0x058f, -5 },  // Alcor",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1022\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1023\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1022,0",
          "338:  PRODUCTVERSION 2,12,1022,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1023,0",
          "338:  PRODUCTVERSION 2,12,1023,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1022\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1022\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1023\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1023\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dd1bf3b998fb46f7a1034a5f93a3523b488a85ca",
      "candidate_info": {
        "commit_hash": "dd1bf3b998fb46f7a1034a5f93a3523b488a85ca",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/dd1bf3b998fb46f7a1034a5f93a3523b488a85ca",
        "files": [
          "res/appstore/AppxManifest.xml",
          "src/format.c",
          "src/rufus.rc"
        ],
        "message": "[core] fix unable to format as FAT32 for RTL languages\n\n* This is a \"stealth\" update for the 3.0 release\n* The issue was that we are picking the UTF16 file system name from\n  the dropdown, and where we use the \"(Default)\" suffixed version,\n  it now has an RLE at the beginning which we must skip.\n* This prevented RTL languages from being able to format a drive as FAT32...",
        "before_after_code_files": [
          "src/format.c||src/format.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/format.c||src/format.c": [
          "File: src/format.c -> src/format.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "676:  BOOL r = FALSE;",
          "677:  PF_DECL(FormatEx);",
          "678:  PF_DECL(EnableVolumeCompression);",
          "680:  char *locale, *VolumeName = NULL;",
          "681:  WCHAR* wVolumeName = NULL;",
          "682:  WCHAR wFSType[64];",
          "683:  WCHAR wLabel[64];",
          "684:  ULONG ulClusterSize;",
          "687:  GetWindowTextU(hFileSystem, FSType, ARRAYSIZE(FSType));",
          "689:  for (i=strlen(FSType); i>2; i--) {",
          "690:   if (FSType[i] == '(') {",
          "",
          "[Removed Lines]",
          "679:  char FSType[32], path[MAX_PATH];",
          "685:  size_t i;",
          "",
          "[Added Lines]",
          "679:  char FSType[64], path[MAX_PATH];",
          "685:  size_t i, index;",
          "689:  index = (strncmp(FSType, RIGHT_TO_LEFT_EMBEDDING, sizeof(RIGHT_TO_LEFT_EMBEDDING) - 1) == 0) ? (sizeof(RIGHT_TO_LEFT_EMBEDDING) - 1) : 0;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "693:   }",
          "694:  }",
          "695:  if ((fs == FS_UDF) && !((dur_mins == 0) && (dur_secs == 0))) {",
          "697:  } else {",
          "699:  }",
          "700:  VolumeName = GetLogicalName(DriveIndex, TRUE, TRUE);",
          "701:  wVolumeName = utf8_to_wchar(VolumeName);",
          "",
          "[Removed Lines]",
          "696:   PrintInfoDebug(0, MSG_220, FSType, dur_mins, dur_secs);",
          "698:   PrintInfoDebug(0, MSG_222, FSType);",
          "",
          "[Added Lines]",
          "698:   PrintInfoDebug(0, MSG_220, &FSType[index], dur_mins, dur_secs);",
          "700:   PrintInfoDebug(0, MSG_222, &FSType[index]);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "727:  setlocale(LC_ALL, locale);",
          "729:  GetWindowTextW(hFileSystem, wFSType, ARRAYSIZE(wFSType));",
          "731:  for (i=0; i<wcslen(wFSType); i++) {",
          "732:   if (wFSType[i] == ' ') {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "733:  index = (wFSType[0] == 0x202b) ? 1 : 0;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "750:  fs_index = (int)ComboBox_GetItemData(hFileSystem, ComboBox_GetCurSel(hFileSystem));",
          "752:  uprintf(\"%s format was selected\\n\", IsChecked(IDC_QUICK_FORMAT)?\"Quick\":\"Slow\");",
          "754:   IsChecked(IDC_QUICK_FORMAT), ulClusterSize, FormatExCallback);",
          "756:  if ((fs == FS_NTFS) && (enable_ntfs_compression) && (pfEnableVolumeCompression != NULL)) {",
          "",
          "[Removed Lines]",
          "753:  pfFormatEx(wVolumeName, SelectedDrive.MediaType, wFSType, wLabel,",
          "",
          "[Added Lines]",
          "757:  pfFormatEx(wVolumeName, SelectedDrive.MediaType, &wFSType[index], wLabel,",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1303\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1304\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,0,1303,0",
          "393:  PRODUCTVERSION 3,0,1303,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,0,1304,0",
          "393:  PRODUCTVERSION 3,0,1304,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.0.1303\"",
          "416:             VALUE \"ProductVersion\", \"3.0.1303\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.0.1304\"",
          "416:             VALUE \"ProductVersion\", \"3.0.1304\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8238de67e10f4d12fb8375f30fb1e31cd8ff2a60",
      "candidate_info": {
        "commit_hash": "8238de67e10f4d12fb8375f30fb1e31cd8ff2a60",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/8238de67e10f4d12fb8375f30fb1e31cd8ff2a60",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc",
          "src/stdfn.c",
          "src/stdlg.c"
        ],
        "message": "[ui] fix more potential notification message truncation\n\n* Some Thai UTF-8 notification messages went over the buffer size limit we used for vsnprintf()\n* Also, revert part of 645184f11e45d2ac76f0e608598bed6f106164c0 and use LRE+PDF marks instead:\n  Don't handle in the code what is better handled in the loc file.",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc",
          "src/stdfn.c||src/stdfn.c",
          "src/stdlg.c||src/stdlg.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc",
            "src/stdlg.c||src/stdlg.c"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc",
            "src/stdlg.c||src/stdlg.c"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "910: t MSG_213 \"\u0625\u0637\u0644\u0627\u0642 \u062a\u0637\u0628\u064a\u0642 \u062c\u062f\u064a\u062f...\"",
          "911: t MSG_214 \"\u0641\u0634\u0644 \u0625\u0637\u0644\u0627\u0642 \u062a\u0637\u0628\u064a\u0642 \u062c\u062f\u064a\u062f\"",
          "912: # Open/Save file",
          "915: # Formatting status (make sure you use a double % to print the percent sign)",
          "916: t MSG_217 \"\u0641\u0631\u0645\u062a\u0629: \u062a\u0645 %0.1f%%\"",
          "917: t MSG_218 \"\u0625\u0646\u0634\u0627\u0621 \u0646\u0638\u0627\u0645 \u0627\u0644\u0645\u0644\u0641\u0627\u062a: \u062a\u0645\u062a %d/%d \u0639\u0645\u0644\u064a\u0629\"",
          "",
          "[Removed Lines]",
          "913: t MSG_215 \"\u0641\u062a\u062d %s\"",
          "914: t MSG_216 \"\u062d\u0641\u0638 %s\"",
          "",
          "[Added Lines]",
          "913: t MSG_215 \"\u0641\u062a\u062d \u202a%s\u202c\"",
          "914: t MSG_216 \"\u062d\u0641\u0638 \u202a%s\u202c\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "6649: t MSG_213 \"\u05e4\u05d5\u05ea\u05d7 \u05d0\u05ea \u05d4\u05d9\u05d9\u05e9\u05d5\u05dd \u05d4\u05d7\u05d3\u05e9...\"",
          "6650: t MSG_214 \"\u05e0\u05db\u05e9\u05dc \u05d1\u05e4\u05ea\u05d9\u05d7\u05ea \u05d4\u05d9\u05d9\u05e9\u05d5\u05dd \u05d4\u05d7\u05d3\u05e9\"",
          "6651: # Open/Save file",
          "6654: # Formatting status (make sure you use a double % to print the percent sign)",
          "6655: t MSG_217 \"\u05de\u05d0\u05ea\u05d7\u05dc: %0.1f%% \u05d4\u05d5\u05e9\u05dc\u05de\u05d5\"",
          "6656: t MSG_218 \"\u05d9\u05d5\u05e6\u05e8 \u05de\u05e2\u05e8\u05db\u05ea \u05e7\u05d1\u05e6\u05d9\u05dd: \u05de\u05e9\u05d9\u05de\u05d4 %d/%d \u05d4\u05d5\u05e9\u05dc\u05de\u05d4\"",
          "",
          "[Removed Lines]",
          "6652: t MSG_215 \"\u05d4\u05e7\u05d5\u05d1\u05e5 %s \u05e0\u05e4\u05ea\u05d7\"",
          "6653: t MSG_216 \"\u05d4\u05e7\u05d5\u05d1\u05e5 %s \u05e0\u05e9\u05de\u05e8\"",
          "",
          "[Added Lines]",
          "6652: t MSG_215 \"\u05d4\u05e7\u05d5\u05d1\u05e5 \u202a%s\u202c \u05e0\u05e4\u05ea\u05d7\"",
          "6653: t MSG_216 \"\u05d4\u05e7\u05d5\u05d1\u05e5 \u202a%s\u202c \u05e0\u05e9\u05de\u05e8\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11194: t MSG_213 \"\u062f\u0631 \u062d\u0627\u0644 \u0631\u0627\u0647\u200c\u0627\u0646\u062f\u0627\u0632\u06cc \u0646\u0633\u062e\u0647 \u062c\u062f\u06cc\u062f \u0646\u0631\u0645\u200c\u0627\u0641\u0632\u0627\u0631...\"",
          "11195: t MSG_214 \"\u0631\u0627\u0647\u200c\u0627\u0646\u062f\u0627\u0632\u06cc \u0646\u0633\u062e\u0647 \u062c\u062f\u06cc\u062f \u0646\u0631\u0645\u200c\u0627\u0641\u0632\u0627\u0631 \u0646\u0627\u0645\u0648\u0641\u0642 \u0628\u0648\u062f\"",
          "11196: # Open/Save file",
          "11199: # Formatting status (make sure you use a double % to print the percent sign)",
          "11200: t MSG_217 \"\u062f\u0631 \u062d\u0627\u0644 \u0641\u0631\u0645\u062a \u06a9\u0631\u062f\u0646\u061b \u062f\u0631\u0635\u062f \u067e\u06cc\u0634\u0631\u0641\u062a: %0.1f%%\"",
          "11201: t MSG_218 \"\u062f\u0631 \u062d\u0627\u0644 \u0633\u0627\u062e\u062a\u0646 \u0633\u06cc\u0633\u062a\u0645 \u0641\u0627\u06cc\u0644\u061b \u062a\u0639\u062f\u0627\u062f \u0648\u0638\u0627\u06cc\u0641 \u0627\u0646\u062c\u0627\u0645 \u0634\u062f\u0647: %d/%d\"",
          "",
          "[Removed Lines]",
          "11197: t MSG_215 \"%s \u0628\u0627\u0632 \u0634\u062f\"",
          "11198: t MSG_216 \"%s \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f\"",
          "",
          "[Added Lines]",
          "11197: t MSG_215 \"\u202a%s\u202c \u0628\u0627\u0632 \u0634\u062f\"",
          "11198: t MSG_216 \"\u202a%s\u202c \u0630\u062e\u06cc\u0631\u0647 \u0634\u062f\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.1.1313\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.1.1314\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,1,1313,0",
          "393:  PRODUCTVERSION 3,1,1313,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,1,1314,0",
          "393:  PRODUCTVERSION 3,1,1314,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1313\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1313\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1314\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1314\"",
          "",
          "---------------"
        ],
        "src/stdfn.c||src/stdfn.c": [
          "File: src/stdfn.c -> src/stdfn.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "463:  HANDLE handle;",
          "464:  BOOL r;",
          "465:  BOOL ret = FALSE;",
          "469:  sid = GetSID();",
          "",
          "[Removed Lines]",
          "466:  char* ltr_path;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "506:   goto out;",
          "507:  }",
          "519:  ret = TRUE;",
          "521: out:",
          "",
          "[Removed Lines]",
          "511:  ltr_path = malloc(safe_strlen(path) + sizeof(LEFT_TO_RIGHT_EMBEDDING) + sizeof(POP_DIRECTIONAL_FORMATTING));",
          "512:  if (ltr_path == NULL) {",
          "513:   PrintInfoDebug(0, save ? MSG_216 : MSG_215, path);",
          "514:  } else {",
          "515:   sprintf(ltr_path, \"%s%s%s\", LEFT_TO_RIGHT_EMBEDDING, path, POP_DIRECTIONAL_FORMATTING);",
          "516:   PrintInfoDebug(0, save ? MSG_216 : MSG_215, ltr_path);",
          "517:   free(ltr_path);",
          "518:  }",
          "",
          "[Added Lines]",
          "508:  PrintInfoDebug(0, save?MSG_216:MSG_215, path);",
          "",
          "---------------"
        ],
        "src/stdlg.c||src/stdlg.c": [
          "File: src/stdlg.c -> src/stdlg.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "774: {",
          "775:  BOOL ret;",
          "776:  va_list args;",
          "778:  dialog_showing++;",
          "781:  szMessageTitle = safe_strdup(title);",
          "783:  va_start(args, format);",
          "785:  va_end(args);",
          "787:  notification_more_info = more_info;",
          "788:  notification_is_question = FALSE;",
          "",
          "[Removed Lines]",
          "779:  szMessageText = (char*)malloc(MAX_PATH);",
          "780:  if (szMessageText == NULL) return FALSE;",
          "782:  if (szMessageTitle == NULL) return FALSE;",
          "784:  safe_vsnprintf(szMessageText, MAX_PATH-1, format, args);",
          "786:  szMessageText[MAX_PATH-1] = 0;",
          "",
          "[Added Lines]",
          "777:  const int max_msg_size = 1024;",
          "780:  szMessageText = (char*)malloc(max_msg_size);",
          "781:  if (szMessageText == NULL)",
          "782:   return FALSE;",
          "784:  if (szMessageTitle == NULL)",
          "785:   return FALSE;",
          "787:  safe_vsnprintf(szMessageText, max_msg_size -1, format, args);",
          "789:  szMessageText[max_msg_size -1] = 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0a3c04379b51363c5623b3c5da85e0b83100c59f",
      "candidate_info": {
        "commit_hash": "0a3c04379b51363c5623b3c5da85e0b83100c59f",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/0a3c04379b51363c5623b3c5da85e0b83100c59f",
        "files": [
          "_coverity.cmd",
          "src/badblocks.c",
          "src/rufus.c",
          "src/rufus.rc"
        ],
        "message": "[misc] fix Coverity warnings",
        "before_after_code_files": [
          "_coverity.cmd||_coverity.cmd",
          "src/badblocks.c||src/badblocks.c",
          "src/rufus.c||src/rufus.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "_coverity.cmd||_coverity.cmd": [
          "File: _coverity.cmd -> _coverity.cmd",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: @rem *** Internal developer script to run Coverity ***",
          "2: @echo off",
          "3: call \"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\Common7\\Tools\\VsDevCmd.bat\"",
          "5: set PATH=%PATH%;%COV_DIR%\\bin",
          "6: set PWD=%~dp0",
          "7: set TARGET=x86_32",
          "",
          "[Removed Lines]",
          "4: set COV_DIR=D:\\cov-analysis-win64-8.7.0",
          "",
          "[Added Lines]",
          "4: set COV_DIR=D:\\cov-analysis-win64-2017.07",
          "",
          "---------------"
        ],
        "src/badblocks.c||src/badblocks.c": [
          "File: src/badblocks.c -> src/badblocks.c"
        ],
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2152: static BOOL CheckDriveAccess(DWORD dwTimeOut)",
          "2153: {",
          "2154:  uint32_t i, j;",
          "2156:  BYTE access_mask;",
          "2158:  char drive_letter[27], drive_name[] = \"?:\";",
          "2159:  char *message, title[128];",
          "2160:  DWORD cur_time, end_time = GetTickCount() + dwTimeOut;",
          "",
          "[Removed Lines]",
          "2155:  BOOL bProceed = TRUE;",
          "2157:  char *PhysicalPath, DevPath[MAX_PATH];",
          "",
          "[Added Lines]",
          "2155:  BOOL ret = FALSE, proceed = TRUE;",
          "2157:  char *PhysicalPath = NULL, DevPath[MAX_PATH];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2172:  PhysicalPath = GetPhysicalName(DeviceNum);",
          "2181:  }",
          "2185:  GetDriveLetters(DeviceNum, drive_letter);",
          "",
          "[Removed Lines]",
          "2173:  QueryDosDeviceA(&PhysicalPath[4], DevPath, sizeof(DevPath));",
          "2174:  access_mask = SearchProcess(DevPath, dwTimeOut, TRUE, TRUE, TRUE);",
          "2175:  CHECK_FOR_USER_CANCEL;",
          "2176:  if (access_mask != 0) {",
          "2177:   bProceed = FALSE;",
          "2178:   uprintf(\"Found potentially blocking process(es) against %s:\", &PhysicalPath[4]);",
          "2179:   for (j = 0; j < BlockingProcess.Index; j++)",
          "2180:    uprintf(BlockingProcess.String[j]);",
          "2182:  free(PhysicalPath);",
          "",
          "[Added Lines]",
          "2173:  if (QueryDosDeviceA(&PhysicalPath[4], DevPath, sizeof(DevPath)) != 0) {",
          "2174:   access_mask = SearchProcess(DevPath, dwTimeOut, TRUE, TRUE, TRUE);",
          "2175:   CHECK_FOR_USER_CANCEL;",
          "2176:   if (access_mask != 0) {",
          "2177:    proceed = FALSE;",
          "2178:    uprintf(\"Found potentially blocking process(es) against %s:\", &PhysicalPath[4]);",
          "2179:    for (j = 0; j < BlockingProcess.Index; j++)",
          "2180:     uprintf(BlockingProcess.String[j]);",
          "2181:   }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2194:    CHECK_FOR_USER_CANCEL;",
          "2196:    if ((access_mask & 0x06) || (access_mask == 0x80)) {",
          "2198:     uprintf(\"Found potentially blocking process(es) against %s\", drive_name);",
          "2199:     for (j = 0; j < BlockingProcess.Index; j++)",
          "2200:      uprintf(BlockingProcess.String[j]);",
          "",
          "[Removed Lines]",
          "2197:     bProceed = FALSE;",
          "",
          "[Added Lines]",
          "2197:     proceed = FALSE;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2203:  }",
          "2208:   message = GetMuiString(\"shell32.dll\", 28701); // \"This drive is in use (...) Do you want to format it anyway?\"",
          "2209:   if (message != NULL) {",
          "2210:    ComboBox_GetTextU(hDeviceList, title, sizeof(title));",
          "2212:    free(message);",
          "2213:   }",
          "2214:  }",
          "2218: out:",
          "2219:  PrintInfo(0, MSG_210);",
          "2221: }",
          "2223: #ifdef RUFUS_TEST",
          "",
          "[Removed Lines]",
          "2206:  if (!bProceed) {",
          "2211:    bProceed = Notification(MSG_WARNING_QUESTION, NULL, title, message);",
          "2216:  PrintInfo(0, MSG_210);",
          "2217:  return bProceed;",
          "2220:  return FALSE;",
          "",
          "[Added Lines]",
          "2206:  if (!proceed) {",
          "2211:    proceed = Notification(MSG_WARNING_QUESTION, NULL, title, message);",
          "2215:  ret = proceed;",
          "2219:  free(PhysicalPath);",
          "2220:  return ret;",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.16.1159\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.16.1160\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,16,1159,0",
          "370:  PRODUCTVERSION 2,16,1159,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,16,1160,0",
          "370:  PRODUCTVERSION 2,16,1160,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1159\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1159\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1160\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1160\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "77e40d1373c39c6eb3a851f8be57a843c64a8f47",
      "candidate_info": {
        "commit_hash": "77e40d1373c39c6eb3a851f8be57a843c64a8f47",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/77e40d1373c39c6eb3a851f8be57a843c64a8f47",
        "files": [
          "res/localization/rufus.loc",
          "src/iso.c",
          "src/rufus.c",
          "src/rufus.h",
          "src/rufus.rc"
        ],
        "message": "[syslinux] remove unwanted 'isolinux.tmp' on error\n\n* Also use a global 'temp_dir' variable and fix a small issue with Swedish translation",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/iso.c||src/iso.c",
          "src/rufus.c||src/rufus.c",
          "src/rufus.h||src/rufus.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "16412: t MSG_293 \"Denna version st\u00f6ds inte\"",
          "16413: t MSG_294 \"Denna version av Windows st\u00f6ds inte l\u00e4ngre av Rufus.\"",
          "16414: t MSG_295 \"Varning: Inofficiell version\"",
          "16416: t MSG_297 \"Ej komplett ISO-fil\"",
          "16417: t MSG_298 \"ISO-filen du har valt matchar inte den angivna storleken: %s av data saknas!\\n\\nOm du har h\u00e4mtat den h\u00e4r filen fr\u00e5n internet, \"",
          "16418:  \"prova d\u00e5 med att ladda ned filen igen och verifiera att checksumman MD5 eller SHA st\u00e4mmer \u00f6verens med den officiella filen.\\n\\n\"",
          "",
          "[Removed Lines]",
          "16415: t MSG_296 \"Denna version av Rufus producerades inte av original utvecklaren.\\n\\n\u00c4r du s\u00e4ker p\u00e5 att du vill anv\u00e4nda den?\"",
          "",
          "[Added Lines]",
          "16415: t MSG_296 \"Denna version av Rufus producerades inte av originalutvecklaren.\\n\\n\u00c4r du s\u00e4ker p\u00e5 att du vill anv\u00e4nda den?\"",
          "",
          "---------------"
        ],
        "src/iso.c||src/iso.c": [
          "File: src/iso.c -> src/iso.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "82: static const char* grub_cfg = \"grub.cfg\";",
          "83: static const char* syslinux_cfg[] = { \"isolinux.cfg\", \"syslinux.cfg\", \"extlinux.conf\" };",
          "84: static const char* arch_cfg[] = { \"archiso_sys32.cfg\", \"archiso_sys64.cfg\" };",
          "86: static const char* isolinux_bin[] = { \"isolinux.bin\", \"boot.bin\" };",
          "87: static const char* pe_dirname[] = { \"/i386\", \"/minint\" };",
          "88: static const char* pe_file[] = { \"ntdetect.com\", \"setupldr.bin\", \"txtsetup.sif\" };",
          "",
          "[Removed Lines]",
          "85: static const char* isolinux_tmp = \".\\\\isolinux.tmp\";",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "789:    uprintf(\"  Will use '%s' for Syslinux\", img_report.cfg_path);",
          "791:    for (i=0; i<isolinux_path.Index; i++) {",
          "792:     size = (size_t)ExtractISOFile(src_iso, isolinux_path.String[i], isolinux_tmp, FILE_ATTRIBUTE_NORMAL);",
          "793:     if (size == 0) {",
          "794:      uprintf(\"  Could not access %s\", isolinux_path.String[i]);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "791:     char isolinux_tmp[MAX_PATH];",
          "792:     static_sprintf(isolinux_tmp, \"%s\\\\isolinux.tmp\", temp_dir);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "821:       }",
          "822:      }",
          "823:      free(buf);",
          "825:     }",
          "826:    }",
          "827:    if (img_report.sl_version != 0) {",
          "828:     static_sprintf(img_report.sl_version_str, \"%d.%02d\",",
          "",
          "[Removed Lines]",
          "824:      _unlink(isolinux_tmp);",
          "",
          "[Added Lines]",
          "826:     _unlink(isolinux_tmp);",
          "",
          "---------------"
        ],
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "94: HWND hMainDialog, hLangToolbar = NULL, hUpdatesDlg = NULL;",
          "95: MY_BUTTON_IMAGELIST bi_iso = { 0 }, bi_up = { 0 }, bi_down = { 0 };",
          "96: GetTickCount64_t pfGetTickCount64 = NULL;",
          "98: char* image_path = NULL;",
          "99: float fScale = 1.0f;",
          "100: int default_fs;",
          "",
          "[Removed Lines]",
          "97: char szFolderPath[MAX_PATH], app_dir[MAX_PATH], system_dir[MAX_PATH], sysnative_dir[MAX_PATH];",
          "",
          "[Added Lines]",
          "97: char szFolderPath[MAX_PATH], app_dir[MAX_PATH], system_dir[MAX_PATH], temp_dir[MAX_PATH], sysnative_dir[MAX_PATH];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3112:   uprintf(\"Could not get system directory: %s\", WindowsErrorString());",
          "3113:   safe_strcpy(system_dir, sizeof(system_dir), \"C:\\\\Windows\\\\System32\");",
          "3114:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3115:  if (GetTempPathU(sizeof(temp_dir), temp_dir) == 0) {",
          "3116:   uprintf(\"Could not get temp directory: %s\", WindowsErrorString());",
          "3117:   safe_strcpy(temp_dir, sizeof(temp_dir), \".\\\\\");",
          "3118:  }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3169:   uprintf(\"loc file not found in current directory - embedded one will be used\");",
          "3171:   loc_data = (BYTE*)GetResource(hMainInstance, MAKEINTRESOURCEA(IDR_LC_RUFUS_LOC), _RT_RCDATA, \"embedded.loc\", &loc_size, FALSE);",
          "3176:    safe_strcpy(loc_file, sizeof(loc_file), rufus_loc);",
          "3177:   }",
          "",
          "[Removed Lines]",
          "3172:   if ( (GetTempPathU(sizeof(tmp_path), tmp_path) == 0)",
          "3173:     || (GetTempFileNameU(tmp_path, APPLICATION_NAME, 0, loc_file) == 0)",
          "3174:     || (loc_file[0] == 0) ) {",
          "",
          "[Added Lines]",
          "3176:   if ( (GetTempFileNameU(temp_dir, APPLICATION_NAME, 0, loc_file) == 0) || (loc_file[0] == 0) ) {",
          "",
          "---------------"
        ],
        "src/rufus.h||src/rufus.h": [
          "File: src/rufus.h -> src/rufus.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "382: extern HWND hPartitionScheme, hFileSystem, hClusterSize, hLabel, hBootType, hNBPasses, hLog;",
          "383: extern HWND hInfo, hProgress, hDiskID, hStatusToolbar;",
          "384: extern float fScale;",
          "386: extern char* image_path;",
          "387: extern DWORD FormatStatus, DownloadStatus, MainThreadId;",
          "388: extern BOOL PromptOnError;",
          "",
          "[Removed Lines]",
          "385: extern char szFolderPath[MAX_PATH], app_dir[MAX_PATH], system_dir[MAX_PATH], sysnative_dir[MAX_PATH];",
          "",
          "[Added Lines]",
          "385: extern char szFolderPath[MAX_PATH], app_dir[MAX_PATH], temp_dir[MAX_PATH], system_dir[MAX_PATH], sysnative_dir[MAX_PATH];",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.16.1138\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.16.1139\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,16,1138,0",
          "370:  PRODUCTVERSION 2,16,1138,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,16,1139,0",
          "370:  PRODUCTVERSION 2,16,1139,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1138\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1138\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1139\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1139\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}