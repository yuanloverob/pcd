{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8dfb760cf28f63ed89f2b32dcea4c9d25304f24d",
      "candidate_info": {
        "commit_hash": "8dfb760cf28f63ed89f2b32dcea4c9d25304f24d",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/8dfb760cf28f63ed89f2b32dcea4c9d25304f24d",
        "files": [
          ".vs/bled.vcxproj",
          ".vs/getopt.vcxproj",
          ".vs/libcdio-driver.vcxproj",
          ".vs/libcdio-iso9660.vcxproj",
          ".vs/libcdio-udf.vcxproj",
          ".vs/ms-sys.vcxproj",
          ".vs/rufus.vcxproj",
          ".vs/syslinux-libfat.vcxproj",
          ".vs/syslinux-libinstaller.vcxproj",
          ".vs/syslinux-win.vcxproj",
          "README.md",
          "src/process.c",
          "src/process.h",
          "src/rufus.h",
          "src/rufus.rc"
        ],
        "message": "[misc] set Windows SDK to 10.0.16299",
        "before_after_code_files": [
          ".vs/bled.vcxproj||.vs/bled.vcxproj",
          ".vs/getopt.vcxproj||.vs/getopt.vcxproj",
          ".vs/libcdio-driver.vcxproj||.vs/libcdio-driver.vcxproj",
          ".vs/libcdio-iso9660.vcxproj||.vs/libcdio-iso9660.vcxproj",
          ".vs/libcdio-udf.vcxproj||.vs/libcdio-udf.vcxproj",
          ".vs/ms-sys.vcxproj||.vs/ms-sys.vcxproj",
          ".vs/rufus.vcxproj||.vs/rufus.vcxproj",
          ".vs/syslinux-libfat.vcxproj||.vs/syslinux-libfat.vcxproj",
          ".vs/syslinux-libinstaller.vcxproj||.vs/syslinux-libinstaller.vcxproj",
          ".vs/syslinux-win.vcxproj||.vs/syslinux-win.vcxproj",
          "src/process.c||src/process.c",
          "src/process.h||src/process.h",
          "src/rufus.h||src/rufus.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        ".vs/bled.vcxproj||.vs/bled.vcxproj": [
          "File: .vs/bled.vcxproj -> .vs/bled.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:     <ProjectName>bled</ProjectName>",
          "77:     <ProjectGuid>{FB6D52D4-A2F8-C358-DB85-BBCAECFDDD7D}</ProjectGuid>",
          "78:     <RootNamespace>bled</RootNamespace>",
          "80:   </PropertyGroup>",
          "81:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "82:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "79:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "79:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/getopt.vcxproj||.vs/getopt.vcxproj": [
          "File: .vs/getopt.vcxproj -> .vs/getopt.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "37:   <PropertyGroup Label=\"Globals\">",
          "38:     <ProjectGuid>{AE83E1B4-CE06-47EE-B7A3-C3A1D7C2D71E}</ProjectGuid>",
          "39:     <RootNamespace>getopt</RootNamespace>",
          "41:   </PropertyGroup>",
          "42:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "43:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "40:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "40:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/libcdio-driver.vcxproj||.vs/libcdio-driver.vcxproj": [
          "File: .vs/libcdio-driver.vcxproj -> .vs/libcdio-driver.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "69:     <Keyword>Win32Proj</Keyword>",
          "70:     <RootNamespace>driver</RootNamespace>",
          "71:     <ProjectName>libcdio-driver</ProjectName>",
          "73:   </PropertyGroup>",
          "74:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "75:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "72:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "72:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/libcdio-iso9660.vcxproj||.vs/libcdio-iso9660.vcxproj": [
          "File: .vs/libcdio-iso9660.vcxproj -> .vs/libcdio-iso9660.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "61:     <Keyword>Win32Proj</Keyword>",
          "62:     <RootNamespace>iso9660</RootNamespace>",
          "63:     <ProjectName>libcdio-iso9660</ProjectName>",
          "65:   </PropertyGroup>",
          "66:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "67:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "64:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "64:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/libcdio-udf.vcxproj||.vs/libcdio-udf.vcxproj": [
          "File: .vs/libcdio-udf.vcxproj -> .vs/libcdio-udf.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "55:     <Keyword>Win32Proj</Keyword>",
          "56:     <RootNamespace>udf</RootNamespace>",
          "57:     <ProjectName>libcdio-udf</ProjectName>",
          "59:   </PropertyGroup>",
          "60:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "61:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "58:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "58:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/ms-sys.vcxproj||.vs/ms-sys.vcxproj": [
          "File: .vs/ms-sys.vcxproj -> .vs/ms-sys.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "96:     <ProjectGuid>{2B1D078D-8EB4-4398-9CA4-23457265A7F6}</ProjectGuid>",
          "97:     <Keyword>Win32Proj</Keyword>",
          "98:     <RootNamespace>mssys</RootNamespace>",
          "100:   </PropertyGroup>",
          "101:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "102:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "99:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "99:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/rufus.vcxproj||.vs/rufus.vcxproj": [
          "File: .vs/rufus.vcxproj -> .vs/rufus.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "39:     <ProjectGuid>{731858A7-0303-4988-877B-9C0DD6471864}</ProjectGuid>",
          "40:     <RootNamespace>rufus</RootNamespace>",
          "41:     <Keyword>Win32Proj</Keyword>",
          "43:   </PropertyGroup>",
          "44:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "45:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "42:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "42:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/syslinux-libfat.vcxproj||.vs/syslinux-libfat.vcxproj": [
          "File: .vs/syslinux-libfat.vcxproj -> .vs/syslinux-libfat.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:     <Keyword>Win32Proj</Keyword>",
          "52:     <RootNamespace>libfat</RootNamespace>",
          "53:     <ProjectName>syslinux-libfat</ProjectName>",
          "55:   </PropertyGroup>",
          "56:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "57:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "54:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "54:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/syslinux-libinstaller.vcxproj||.vs/syslinux-libinstaller.vcxproj": [
          "File: .vs/syslinux-libinstaller.vcxproj -> .vs/syslinux-libinstaller.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:     <Keyword>Win32Proj</Keyword>",
          "52:     <RootNamespace>libinstaller</RootNamespace>",
          "53:     <ProjectName>syslinux-libinstaller</ProjectName>",
          "55:   </PropertyGroup>",
          "56:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "57:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "54:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "54:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        ".vs/syslinux-win.vcxproj||.vs/syslinux-win.vcxproj": [
          "File: .vs/syslinux-win.vcxproj -> .vs/syslinux-win.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "45:     <Keyword>Win32Proj</Keyword>",
          "46:     <RootNamespace>win</RootNamespace>",
          "47:     <ProjectName>syslinux-win</ProjectName>",
          "49:   </PropertyGroup>",
          "50:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "51:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "",
          "[Removed Lines]",
          "48:     <WindowsTargetPlatformVersion>10.0.15063.0</WindowsTargetPlatformVersion>",
          "",
          "[Added Lines]",
          "48:     <WindowsTargetPlatformVersion>10.0.16299.0</WindowsTargetPlatformVersion>",
          "",
          "---------------"
        ],
        "src/process.c||src/process.c": [
          "File: src/process.c -> src/process.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "43: PF_TYPE_DECL(NTAPI, NTSTATUS, NtQueryInformationFile, (HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG, FILE_INFORMATION_CLASS));",
          "44: PF_TYPE_DECL(NTAPI, NTSTATUS, NtQueryObject, (HANDLE, OBJECT_INFORMATION_CLASS, PVOID, ULONG, PULONG));",
          "45: PF_TYPE_DECL(NTAPI, NTSTATUS, NtDuplicateObject, (HANDLE, HANDLE, HANDLE, PHANDLE, ACCESS_MASK, ULONG, ULONG));",
          "47: PF_TYPE_DECL(NTAPI, NTSTATUS, NtOpenProcessToken, (HANDLE, ACCESS_MASK, PHANDLE));",
          "48: PF_TYPE_DECL(NTAPI, NTSTATUS, NtAdjustPrivilegesToken, (HANDLE, BOOLEAN, PTOKEN_PRIVILEGES, ULONG, PTOKEN_PRIVILEGES, PULONG));",
          "49: PF_TYPE_DECL(NTAPI, NTSTATUS, NtClose, (HANDLE));",
          "",
          "[Removed Lines]",
          "46: PF_TYPE_DECL(NTAPI, NTSTATUS, NtOpenProcess, (PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PCLIENT_ID));",
          "",
          "[Added Lines]",
          "46: PF_TYPE_DECL(NTAPI, NTSTATUS, NtOpenProcess, (PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, CLIENT_ID*));",
          "",
          "---------------"
        ],
        "src/process.h||src/process.h": [
          "File: src/process.h -> src/process.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "77:  UNICODE_STRING Name;",
          "78: } OBJECT_NAME_INFORMATION, *POBJECT_NAME_INFORMATION;",
          "86: typedef struct _OBJECT_TYPE_INFORMATION",
          "87: {",
          "88:  UNICODE_STRING TypeName;",
          "",
          "[Removed Lines]",
          "80: typedef struct _CLIENT_ID",
          "81: {",
          "82:  HANDLE UniqueProcess;",
          "83:  HANDLE UniqueThread;",
          "84: } CLIENT_ID, *PCLIENT_ID;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/rufus.h||src/rufus.h": [
          "File: src/rufus.h -> src/rufus.h"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.18.1216\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.18.1217\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,18,1216,0",
          "370:  PRODUCTVERSION 2,18,1216,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,18,1217,0",
          "370:  PRODUCTVERSION 2,18,1217,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.18.1216\"",
          "393:             VALUE \"ProductVersion\", \"2.18.1216\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.18.1217\"",
          "393:             VALUE \"ProductVersion\", \"2.18.1217\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0eb41e4efb74d38095df8ef5ef53b7cb0cede177",
      "candidate_info": {
        "commit_hash": "0eb41e4efb74d38095df8ef5ef53b7cb0cede177",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/0eb41e4efb74d38095df8ef5ef53b7cb0cede177",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Polish translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "11251: ################################################################################",
          "11252: l \"pl-PL\" \"Polish (Polski)\" 0x0415",
          "11254: b \"en-US\"",
          "11257: # Main dialog",
          "11258: g IDD_DIALOG",
          "11259: t IDS_DEVICE_TXT \"Urz\u0105dzenie\"",
          "11262: t IDS_FILE_SYSTEM_TXT \"System plik\u00f3w\"",
          "11263: t IDS_CLUSTER_SIZE_TXT \"Rozmiar jednostki alokacji\"",
          "11265: t IDS_FORMAT_OPTIONS_TXT \"Opcje Formatowania\"",
          "11267: t IDC_QUICK_FORMAT \"Szybkie formatowanie\"",
          "11268: t IDC_EXTENDED_LABEL \"Utw\u00f3rz rozszerzon\u0105 nazw\u0119 i pliki ikon\"",
          "11269: t IDCANCEL \"Zamknij\"",
          "11270: t IDC_START \"Start\"",
          "11275: # About dialog",
          "11276: g IDD_ABOUTBOX",
          "",
          "[Removed Lines]",
          "11253: v 1.0.22",
          "11255: # my info: 6.9.2015,22:39",
          "11260: t IDS_BOOT_SELECTION_TXT \"Typ bootowania\"",
          "11261: t IDS_PARTITION_TYPE_TXT \"Schemat partycjonowania i typ systemu docelowego\"",
          "11264: t IDS_LABEL_TXT \"Nowa nazwa woluminu\"",
          "11266: t IDC_BAD_BLOCKS \"Szukaj b\u0142\u0119dnych sektor\u00f3w na urz\u0105dzeniu\"",
          "11271: t IDC_LIST_USB_HDD \"Poka\u017c Dyski Twarde USB\"",
          "11272: t IDC_OLD_BIOS_FIXES \"Dodaj \u0142atk\u0119 dla starych BIOS\u00f3w (dodatkowa partycja, itp.)\"",
          "11273: t IDC_RUFUS_MBR \"U\u017cyj MBR Rufusa z ID BIOSu\"",
          "",
          "[Added Lines]",
          "11253: v 1.0.23",
          "11255: # my info: 2018-04-22T12:16",
          "11259: t IDS_DRIVE_PROPERTIES_TXT \"W\u0142a\u015bciwo\u015bci dysku\"",
          "11261: t IDS_BOOT_SELECTION_TXT \"Wyb\u00f3r bootowania\"",
          "11262: t IDC_SELECT \"Wybierz\"",
          "11263: t IDS_IMAGE_OPTION_TXT \"Opcje obrazu\"",
          "11264: t IDS_PARTITION_TYPE_TXT \"Schemat partycjonowania\"",
          "11265: t IDS_TARGET_SYSTEM_TXT \"Docelowy system\"",
          "11266: t IDC_LIST_USB_HDD \"Poka\u017c Dyski Twarde USB\"",
          "11267: t IDC_OLD_BIOS_FIXES \"Dodaj \u0142atk\u0119 dla starych BIOS\u00f3w (dodatkowa partycja, itp.)\"",
          "11268: t IDC_RUFUS_MBR \"U\u017cyj MBR Rufusa z ID BIOSu\"",
          "11269: t IDS_FORMAT_OPTIONS_TXT \"Opcje Formatowania\"",
          "11272: t IDS_LABEL_TXT \"Nazwa woluminu\"",
          "11275: t IDC_BAD_BLOCKS \"Szukaj b\u0142\u0119dnych sektor\u00f3w na urz\u0105dzeniu\"",
          "11277: t IDS_STATUS_TXT \"Stan\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "11353: t MSG_029 \"Domy\u015blne\"",
          "11354: # The following gets appended to the file system, cluster size, etc.",
          "11355: t MSG_030 \"%s (Domy\u015blne)\"",
          "11359: # Number of bad block check passes (singular for 1 pass, plural for 2 or more passes)",
          "11360: t MSG_034 \"%d Przebieg\"",
          "11361: t MSG_035 \"%d Przebiegi\"",
          "",
          "[Removed Lines]",
          "11356: #t MSG_031 \"Schemat partycjonowania %s dla BIOS lub %s\"",
          "11357: #t MSG_032 \"Schemat partycjonowania %s dla BIOS\"",
          "11358: #t MSG_033 \"Schemat partycjonowania %s dla UEFI\"",
          "",
          "[Added Lines]",
          "11362: t MSG_031 \"BIOS (lub UEFI-CSM)\"",
          "11363: t MSG_032 \"UEFI (bez CSM)\"",
          "11364: t MSG_033 \"BIOS lub UEFI\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11384:  \"Prosz\u0119 zamkn\u0105\u0107 inne procesy kt\u00f3re mog\u0105 mie\u0107 dost\u0119p do tego urz\u0105dzenia.\"",
          "11385: t MSG_056 \"Szybkie formatowanie jest niedost\u0119pne dla tego urz\u0105dzenia.\"",
          "11386: t MSG_057 \"Nazwa woluminu jest nieprawid\u0142owa.\"",
          "11388: t MSG_059 \"Wybrany rozmiar jednostki alokacji jest nieprawidowy dla tego urz\u0105dzenia.\"",
          "11389: t MSG_060 \"Rozmiar woluminu jest nieprawid\u0142owy.\"",
          "11390: t MSG_061 \"Prosz\u0119 w\u0142o\u017cy\u0107 dysk wymienny do nap\u0119du.\"",
          "",
          "[Removed Lines]",
          "11387: t MSG_058 \"The device handle is invalid.\"",
          "",
          "[Added Lines]",
          "11393: t MSG_058 \"Uchwyt urz\u0105dzenia jest nieprawid\u0142owy.\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11403: t MSG_072 \"Nie uko\u0144czono sprawdzania b\u0142\u0119dnych sektor\u00f3w.\"",
          "11404: t MSG_073 \"Niepowodzenie skanowania pliku ISO.\"",
          "11405: t MSG_074 \"Niepowodzenie wypakowywania pliku ISO.\"",
          "11408: t MSG_077 \"Nie mo\u017cna przypisa\u0107 litery dysku.\"",
          "11409: t MSG_078 \"Nie mo\u017cna zamontowa\u0107 woluminu GUID.\"",
          "11410: t MSG_079 \"Urz\u0105dzenie nie jest gotowe.\"",
          "",
          "[Removed Lines]",
          "11406: t MSG_075 \"\"Nie mo\u017cna ponownie zamontowa\u0107 woluminu.\"",
          "11407: t MSG_076 \"\"Nie mo\u017cna za\u0142ata\u0107/skonfigurowa\u0107 plik\u00f3w do bootowania.\"",
          "",
          "[Added Lines]",
          "11412: t MSG_075 \"Nie mo\u017cna ponownie zamontowa\u0107 woluminu.\"",
          "11413: t MSG_076 \"Nie mo\u017cna za\u0142ata\u0107/skonfigurowa\u0107 plik\u00f3w do bootowania.\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11465:  \"Je\u015bli jeste\u015b pewny \u017ce chcesz anulowa\u0107, naci\u015bnij TAK. W innym razie naci\u015bnij NIE.\"",
          "11466: t MSG_106 \"Prosz\u0119 wybra\u0107 folder\"",
          "11467: t MSG_107 \"Wszystkie pliki\"",
          "11469: t MSG_109 \"0x%02X (Dysk %d)\"",
          "11470: # \"Cluster size\" below should be the same as the label for IDS_CLUSTER_SIZE_TXT",
          "11471: # \"kilobytes\" should be the same as in MSG_027",
          "",
          "[Removed Lines]",
          "11468: t MSG_108 \"Rufus log\"",
          "",
          "[Added Lines]",
          "11474: t MSG_108 \"Dziennik Rufusa\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "11494:  \"- Wybierz 'Anuluj' aby przerwa\u0107 operacj\u0119\\n\\n\"",
          "11495:  \"Informacja: Pliki zostan\u0105 pobrane do aktualnego folderu aplikacji i zostan\u0105 u\u017cyte ponownie\"",
          "11496:  \"automatycznie je\u015bli istnej\u0105. Je\u015bli nie mo\u017cna znale\u017c\u0107 odpowiednich plik\u00f3w online, zostanie u\u017cyta domy\u015blna wersja plik\u00f3w.\"",
          "11498: # Tooltips",
          "11499: # Partition Scheme and Target Type",
          "11506: t MSG_153 \"Wzorzec testowy: 0x%02X\"",
          "11507: t MSG_154 \"Wzorzec testowy: 0x%02X, 0x%02X\"",
          "11508: t MSG_155 \"Wzorzec testowy: 0x%02X, 0x%02X, 0x%02X\"",
          "",
          "[Removed Lines]",
          "11500: t MSG_150 \"Zazwyczaj najbezpieczniejszy wyb\u00f3r. Je\u015bli jednak masz komputer UEFI i chcesz zainstalowa\u0107 \"",
          "11501:  \"OS w trybie EFI , powiniene\u015b wybra\u0107 jedn\u0105 z innych opcji\"",
          "11502: t MSG_151 \"U\u017cyj tego je\u015bli chcesz zainstalowa\u0107 OS w trybie EFI, ale chcesz mie\u0107 dost\u0119p\"",
          "11503:  \"do zawaro\u015bci USB z Windows XP\"",
          "11504: t MSG_152 \"Preferowana opcja aby zainstalowa\u0107 OS w trybie EFI i kiedy \"",
          "11505:  \"dost\u0119p do USB nie jest wymagany dla Windows XP\"",
          "",
          "[Added Lines]",
          "11503: t MSG_117 \"Standardowa instalacja Windowsa\"",
          "11504: t MSG_119 \"zaawansowane w\u0142a\u015bciwo\u015bci dysku\"",
          "11505: t MSG_120 \"zaawansowane opcje formatowania\"",
          "11506: t MSG_121 \"Poka\u017c %s\"",
          "11507: t MSG_122 \"Ukryj %s\"",
          "11511: t MSG_150 \"Typ komputera na kt\u00f3rym chcesz uzy\u0107 bootowalnego dysku. Przed storzeniem dysku musisz sam okre\u015bli\u0107 \"",
          "11512:  \"czy docelowy komputer posiada BIOS czy UEFI, poniewa\u017c w przeciwnym przypadku mo\u017ce si\u0119 nie uruchomi\u0107.\"",
          "11513: t MSG_151 \"'UEFI-CSM' oznacza, \u017ce urz\u0105dzenie uruchomi si\u0119 jedynie w trybie emulacji BIOSu (znanej jako 'Legacy Mode') w UEFI, ale nie w natywnym trybie UEFI.\"",
          "11514: t MSG_152 \"'bez CSM' oznacza, \u017ce urz\u0105dzenie uruchomi si\u0119 jedynie w natywnym trybie UEFI, ale nie w trybie emulacji BIOSu (znanej jako 'Legacy Mode').\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "11513: t MSG_160 \"Prze\u0142\u0105cz opcje zaawansowane\"",
          "11514: t MSG_161 \"Sprawd\u017a urz\u0105dzenie pod k\u0105tem b\u0142\u0119dnych sektor\u00f3w u\u017cywaj\u0105c wzoru testoego\"",
          "11515: t MSG_162 \"Odznacz to pole aby u\u017cy\u0107 \\\"wolnej\\\" metody formatowania\"",
          "11516: t MSG_164 \"Metoda kt\u00f3ra zostanie u\u017cyta aby uczyni\u0107 dysk bootowalnym\"",
          "11517: t MSG_165 \"Kliknij aby wybra\u0107 obraz...\"",
          "11518: t MSG_166 \"Zaznacz to pole aby zezwoli\u0107 na wy\u015bwietlanie etykiet mi\u0119dzynarodowych \"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11525: t MSG_163 \"Metoda kt\u00f3ra zostanie u\u017cyta do stworzenia partycji\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "11527: t MSG_172 \"Informacje o licencji i creditsy\"",
          "11528: t MSG_173 \"Kliknij aby wybra\u0107...\"",
          "11529: # The following will appear in the about dialog",
          "11531: t MSG_175 \"Wersja %d.%d (Build %d)\"",
          "11532: t MSG_176 \"Polskie t\u0142umaczenie: Piotr Halama <http://halamix2.pl> \\\\line \"",
          "11534: t MSG_177 \"Zg\u0142aszaj b\u0142\u0119dy lub ulepszenia na:\"",
          "11535: t MSG_178 \"Dodatkowe prawa autorskie:\"",
          "11536: t MSG_179 \"Polityka aktualizacji:\"",
          "",
          "[Removed Lines]",
          "11530: t MSG_174 \"Rufus - The Reliable USB Formatting Utility\"",
          "11533:  \"Poprawki: Krzysztof J. Szklarski <http://www.napisy.info>\"",
          "",
          "[Added Lines]",
          "11540: t MSG_174 \"Rufus - Solidne narz\u0119dzie do formatowania USB\"",
          "11543:  \"Poprawki: Krzysztof J. Szklarski\"",
          "11544: # Removed URL temporarily since it doesn't work, original was <http://www.napisy.info>\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "11563: t MSG_198 \"'Windows To Go' mo\u017ce zosta\u0107 zainstalowany jedynie na dysku ze struktur\u0105 GPT je\u017celi ma on \"",
          "11564:  \"ustawiony atrybut LOKALNY. Obecny dysk nie zosta\u0142 wybryty jako LOKALNY.\"",
          "11565: t MSG_199 \"Wybierz to, je\u017celi planujesz zainstalowa\u0107 Windows na innym dysku, u\u017cywaj\u0105c wybranego dysku jako dysku instalacyjnego.\"",
          "11568: # Status messages - these messages will appear on the status bar",
          "11569: t MSG_201 \"Anulowanie - Prosz\u0119 czeka\u0107...\"",
          "",
          "[Removed Lines]",
          "11566: t MSG_200 Wybierz to, je\u017celi chcesz uruchomi\u0107 Windows bezpo\u015brednio z wybranego urz\u0105dzenia.\"",
          "",
          "[Added Lines]",
          "11577: t MSG_200 \"Wybierz to, je\u017celi chcesz uruchomi\u0107 Windows bezpo\u015brednio z wybranego urz\u0105dzenia.\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "11621: # eg. \"Partitioning (MBR)...\"",
          "11622: t MSG_238 \"Partycjonowanie (%s)...\"",
          "11623: t MSG_239 \"Usuwanie partycji...\"",
          "11624: t MSG_241 \"Pobieranie: %0.1f%%\"",
          "11625: t MSG_242 \"Niepowodzenie pobierania pliku.\"",
          "11626: t MSG_243 \"Sprawdzanie aktualizacji Rufusa...\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "11635: t MSG_240 \"Sygnatura pobranej aktualizacji nie mog\u0142a zosta\u0107 sprawdzona. To mo\u017ce oznacza\u0107, \u017ce tw\u00f3j \"",
          "11636:  \"system jest nieprawid\u0142owo skonfigurowany dl sprawdzania sygnatur lub wskazywa\u0107 na z\u0142o\u015bliwy pobrany plik.\\n\\n\"",
          "11637:  \"Pobrany plik zostanie usuni\u0119ty. Prosz\u0119 sprawdzi\u0107 dziennik dla wi\u0119kszej ilo\u015bci szczeg\u0142\u00f3w.\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "11663:  \"Prosz\u0119 wybra\u0107 tryb kt\u00f3rego chcesz u\u017cy\u0107 do zapisania tego obrazu:\"",
          "11664: t MSG_276 \"Zapisz w trybie %s (zalecane)\"",
          "11665: t MSG_277 \"Zapisz w trybie %s\"",
          "11666: t MSG_279 \"Niebootowalne\"",
          "11669: t MSG_282 \"Blokowanie dysku USB na wy\u0142\u0105czno\u015b\u0107\"",
          "11670: t MSG_283 \"Nieprawid\u0142owa sygnatura\"",
          "11671: t MSG_284 \"Pobrany plik wykonywalny nie posiada cyfrowej sygnatury.\"",
          "",
          "[Removed Lines]",
          "11667: t MSG_280 \"Wyb\u00f3r obrazu\"",
          "11668: t MSG_281 \"(Prosz\u0119 wybra\u0107 obraz)\"",
          "",
          "[Added Lines]",
          "11680: t MSG_278 \"Sprawdzanie proces\u00f3w w konflikcie...\"",
          "11682: t MSG_280 \"Dysk lub obraz ISO\"",
          "11683: t MSG_281 \"%s (Prosz\u0119 wybra\u0107)\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "11686: t MSG_298 \"Rozmiar pliku ISO kt\u00f3ry wybra\u0142e\u015b nie zgadza si\u0119 z jego deklarowanym rozmiarem: brakuje %s danych!\\n\\nJe\u017celi uzyska\u0142e\u015b ten plik \"",
          "11687:  \"z internetu, powiniene\u015b spr\u00f3bowa\u0107 pobra\u0107 now\u0105 kopi\u0119 oraz zweryfikowa\u0107, \u017ce sumy kontrolne MD5 lub SHA zgadzaj\u0105 si\u0119 \"",
          "11688:  \"z oficjalnymi.\\n\\nZauwa\u017c, \u017ce mo\u017cesz obliczy\u0107 sumy MD5 lub SHA w Rufusie klikaj\u0105c przycisk '#'.\"",
          "11691: ################################################################################",
          "11692: l \"pt-BR\" \"Portuguese Brazilian (Portugu\u00eas do Brasil)\" 0x0416",
          "",
          "[Removed Lines]",
          "11689: t MSG_117 \"Standardowa instalacja Windowsa\"",
          "",
          "[Added Lines]",
          "11704: t MSG_299 \"B\u0142\u0105d sprawdzania poprawno\u015bci znacznika czasu\"",
          "11705: t MSG_300 \"Rufus nie by\u0142 w stanie potwierdzi\u0107, \u017ce znacznik czasu pobranej aktualizacji jest nowszy ni\u017c ten, kt\u00f3ry jest \"",
          "11706:  \"dla obecnego pliku wykonywalnego.\\n\\nAby zapobiec potencjalnym atakom proces aktualizacji zosta\u0142 przerwany, a \"",
          "11707:  \"pobrana aktualizacja zostanie usuni\u0119ta. Prosz\u0119 sprawdzi\u0107 dziennik dla wi\u0119kszej ilo\u015bci szczeg\u0142\u00f3w.\"",
          "11708: t MSG_301 \"Poka\u017c ustawienia aplikacji\"",
          "11709: t MSG_302 \"Poka\u017c informacje o tej aplikacji\"",
          "11710: t MSG_303 \"Poka\u017c dziennik\"",
          "11711: t MSG_304 \"Ut\u00f3rz obraz dysku wybranego urz\u0105dzenia\"",
          "11712: t MSG_305 \"U\u017cyj tej opcji aby wskaza\u0107, czy chcesz u\u017cy\u0107 tego dysku do instalacji Windowsa na innym dysku, \"",
          "11713:  \"czy chcesz uruchomi\u0107 Windowsa bezpo\u015brednio z tego dysku (Windows To Go).\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1256\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1257\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "373: VS_VERSION_INFO VERSIONINFO",
          "376:  FILEFLAGSMASK 0x3fL",
          "377: #ifdef _DEBUG",
          "378:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "374:  FILEVERSION 3,0,1256,0",
          "375:  PRODUCTVERSION 3,0,1256,0",
          "",
          "[Added Lines]",
          "374:  FILEVERSION 3,0,1257,0",
          "375:  PRODUCTVERSION 3,0,1257,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "389:         BEGIN",
          "390:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "391:             VALUE \"FileDescription\", \"Rufus\"",
          "393:             VALUE \"InternalName\", \"Rufus\"",
          "394:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "395:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "396:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "397:             VALUE \"ProductName\", \"Rufus\"",
          "399:         END",
          "400:     END",
          "401:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "392:             VALUE \"FileVersion\", \"3.0.1256\"",
          "398:             VALUE \"ProductVersion\", \"3.0.1256\"",
          "",
          "[Added Lines]",
          "392:             VALUE \"FileVersion\", \"3.0.1257\"",
          "398:             VALUE \"ProductVersion\", \"3.0.1257\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3d1b3bac40beceeedd3d8928c4e230b083a2ce0b",
      "candidate_info": {
        "commit_hash": "3d1b3bac40beceeedd3d8928c4e230b083a2ce0b",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/3d1b3bac40beceeedd3d8928c4e230b083a2ce0b",
        "files": [
          "README.md",
          "appveyor.yml",
          "src/.msvc/rufus.vcxproj",
          "src/bled/.msvc/bled.vcxproj",
          "src/getopt/.msvc/getopt.vcxproj",
          "src/libcdio/driver/.msvc/driver.vcxproj",
          "src/libcdio/iso9660/.msvc/iso9660.vcxproj",
          "src/libcdio/udf/.msvc/udf.vcxproj",
          "src/ms-sys/.msvc/ms-sys.vcxproj",
          "src/rufus.rc",
          "src/syslinux/libfat/.msvc/libfat.vcxproj",
          "src/syslinux/libinstaller/.msvc/libinstaller.vcxproj",
          "src/syslinux/win/.msvc/win.vcxproj"
        ],
        "message": "[misc] update project files to VS2017",
        "before_after_code_files": [
          "src/.msvc/rufus.vcxproj||src/.msvc/rufus.vcxproj",
          "src/bled/.msvc/bled.vcxproj||src/bled/.msvc/bled.vcxproj",
          "src/getopt/.msvc/getopt.vcxproj||src/getopt/.msvc/getopt.vcxproj",
          "src/libcdio/driver/.msvc/driver.vcxproj||src/libcdio/driver/.msvc/driver.vcxproj",
          "src/libcdio/iso9660/.msvc/iso9660.vcxproj||src/libcdio/iso9660/.msvc/iso9660.vcxproj",
          "src/libcdio/udf/.msvc/udf.vcxproj||src/libcdio/udf/.msvc/udf.vcxproj",
          "src/ms-sys/.msvc/ms-sys.vcxproj||src/ms-sys/.msvc/ms-sys.vcxproj",
          "src/rufus.rc||src/rufus.rc",
          "src/syslinux/libfat/.msvc/libfat.vcxproj||src/syslinux/libfat/.msvc/libfat.vcxproj",
          "src/syslinux/libinstaller/.msvc/libinstaller.vcxproj||src/syslinux/libinstaller/.msvc/libinstaller.vcxproj",
          "src/syslinux/win/.msvc/win.vcxproj||src/syslinux/win/.msvc/win.vcxproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/.msvc/rufus.vcxproj||src/.msvc/rufus.vcxproj": [
          "File: src/.msvc/rufus.vcxproj -> src/.msvc/rufus.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "29:     <ConfigurationType>Application</ConfigurationType>",
          "30:     <CharacterSet>Unicode</CharacterSet>",
          "31:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "33:   </PropertyGroup>",
          "34:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "35:     <ConfigurationType>Application</ConfigurationType>",
          "36:     <CharacterSet>Unicode</CharacterSet>",
          "38:   </PropertyGroup>",
          "39:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "40:     <ConfigurationType>Application</ConfigurationType>",
          "41:     <CharacterSet>Unicode</CharacterSet>",
          "42:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "44:   </PropertyGroup>",
          "45:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "46:     <ConfigurationType>Application</ConfigurationType>",
          "47:     <CharacterSet>Unicode</CharacterSet>",
          "49:   </PropertyGroup>",
          "50:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "51:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "32:     <PlatformToolset>v140_xp</PlatformToolset>",
          "37:     <PlatformToolset>v140_xp</PlatformToolset>",
          "43:     <PlatformToolset>v140</PlatformToolset>",
          "48:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "32:     <PlatformToolset>v141_xp</PlatformToolset>",
          "37:     <PlatformToolset>v141_xp</PlatformToolset>",
          "43:     <PlatformToolset>v141</PlatformToolset>",
          "48:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/bled/.msvc/bled.vcxproj||src/bled/.msvc/bled.vcxproj": [
          "File: src/bled/.msvc/bled.vcxproj -> src/bled/.msvc/bled.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "65:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "66:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "67:     <CharacterSet>Unicode</CharacterSet>",
          "69:   </PropertyGroup>",
          "70:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "71:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "72:     <CharacterSet>Unicode</CharacterSet>",
          "74:   </PropertyGroup>",
          "75:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "76:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "77:     <CharacterSet>Unicode</CharacterSet>",
          "79:   </PropertyGroup>",
          "80:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "81:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "82:     <CharacterSet>Unicode</CharacterSet>",
          "84:   </PropertyGroup>",
          "85:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "86:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "68:     <PlatformToolset>v140</PlatformToolset>",
          "73:     <PlatformToolset>v140</PlatformToolset>",
          "78:     <PlatformToolset>v140</PlatformToolset>",
          "83:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "68:     <PlatformToolset>v141</PlatformToolset>",
          "73:     <PlatformToolset>v141</PlatformToolset>",
          "78:     <PlatformToolset>v141</PlatformToolset>",
          "83:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/getopt/.msvc/getopt.vcxproj||src/getopt/.msvc/getopt.vcxproj": [
          "File: src/getopt/.msvc/getopt.vcxproj -> src/getopt/.msvc/getopt.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "27:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "28:     <CharacterSet>Unicode</CharacterSet>",
          "29:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "31:   </PropertyGroup>",
          "32:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "33:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "34:     <CharacterSet>Unicode</CharacterSet>",
          "36:   </PropertyGroup>",
          "37:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "38:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "39:     <CharacterSet>Unicode</CharacterSet>",
          "40:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "42:   </PropertyGroup>",
          "43:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "44:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "45:     <CharacterSet>Unicode</CharacterSet>",
          "47:   </PropertyGroup>",
          "48:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "49:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "30:     <PlatformToolset>v140</PlatformToolset>",
          "35:     <PlatformToolset>v140</PlatformToolset>",
          "41:     <PlatformToolset>v140</PlatformToolset>",
          "46:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "30:     <PlatformToolset>v141</PlatformToolset>",
          "35:     <PlatformToolset>v141</PlatformToolset>",
          "41:     <PlatformToolset>v141</PlatformToolset>",
          "46:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/libcdio/driver/.msvc/driver.vcxproj||src/libcdio/driver/.msvc/driver.vcxproj": [
          "File: src/libcdio/driver/.msvc/driver.vcxproj -> src/libcdio/driver/.msvc/driver.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "59:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "60:     <UseDebugLibraries>true</UseDebugLibraries>",
          "61:     <CharacterSet>Unicode</CharacterSet>",
          "63:   </PropertyGroup>",
          "64:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "65:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "66:     <UseDebugLibraries>false</UseDebugLibraries>",
          "67:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "68:     <CharacterSet>Unicode</CharacterSet>",
          "70:   </PropertyGroup>",
          "71:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "72:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "73:     <UseDebugLibraries>true</UseDebugLibraries>",
          "74:     <CharacterSet>Unicode</CharacterSet>",
          "76:   </PropertyGroup>",
          "77:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "78:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "79:     <UseDebugLibraries>false</UseDebugLibraries>",
          "80:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "81:     <CharacterSet>Unicode</CharacterSet>",
          "83:   </PropertyGroup>",
          "84:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "85:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "62:     <PlatformToolset>v140</PlatformToolset>",
          "69:     <PlatformToolset>v140</PlatformToolset>",
          "75:     <PlatformToolset>v140</PlatformToolset>",
          "82:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "62:     <PlatformToolset>v141</PlatformToolset>",
          "69:     <PlatformToolset>v141</PlatformToolset>",
          "75:     <PlatformToolset>v141</PlatformToolset>",
          "82:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/libcdio/iso9660/.msvc/iso9660.vcxproj||src/libcdio/iso9660/.msvc/iso9660.vcxproj": [
          "File: src/libcdio/iso9660/.msvc/iso9660.vcxproj -> src/libcdio/iso9660/.msvc/iso9660.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "51:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "52:     <UseDebugLibraries>true</UseDebugLibraries>",
          "53:     <CharacterSet>Unicode</CharacterSet>",
          "55:   </PropertyGroup>",
          "56:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "57:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "58:     <UseDebugLibraries>false</UseDebugLibraries>",
          "59:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "60:     <CharacterSet>Unicode</CharacterSet>",
          "62:   </PropertyGroup>",
          "63:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "64:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "65:     <UseDebugLibraries>true</UseDebugLibraries>",
          "66:     <CharacterSet>Unicode</CharacterSet>",
          "68:   </PropertyGroup>",
          "69:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "70:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "71:     <UseDebugLibraries>false</UseDebugLibraries>",
          "72:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "73:     <CharacterSet>Unicode</CharacterSet>",
          "75:   </PropertyGroup>",
          "76:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "77:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "54:     <PlatformToolset>v140</PlatformToolset>",
          "61:     <PlatformToolset>v140</PlatformToolset>",
          "67:     <PlatformToolset>v140</PlatformToolset>",
          "74:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "54:     <PlatformToolset>v141</PlatformToolset>",
          "61:     <PlatformToolset>v141</PlatformToolset>",
          "67:     <PlatformToolset>v141</PlatformToolset>",
          "74:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/libcdio/udf/.msvc/udf.vcxproj||src/libcdio/udf/.msvc/udf.vcxproj": [
          "File: src/libcdio/udf/.msvc/udf.vcxproj -> src/libcdio/udf/.msvc/udf.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "45:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "46:     <UseDebugLibraries>true</UseDebugLibraries>",
          "47:     <CharacterSet>Unicode</CharacterSet>",
          "49:   </PropertyGroup>",
          "50:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "51:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "52:     <UseDebugLibraries>false</UseDebugLibraries>",
          "53:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "54:     <CharacterSet>Unicode</CharacterSet>",
          "56:   </PropertyGroup>",
          "57:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "58:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "59:     <UseDebugLibraries>true</UseDebugLibraries>",
          "60:     <CharacterSet>Unicode</CharacterSet>",
          "62:   </PropertyGroup>",
          "63:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "64:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "65:     <UseDebugLibraries>false</UseDebugLibraries>",
          "66:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "67:     <CharacterSet>Unicode</CharacterSet>",
          "69:   </PropertyGroup>",
          "70:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "71:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "48:     <PlatformToolset>v140</PlatformToolset>",
          "55:     <PlatformToolset>v140</PlatformToolset>",
          "61:     <PlatformToolset>v140</PlatformToolset>",
          "68:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "48:     <PlatformToolset>v141</PlatformToolset>",
          "55:     <PlatformToolset>v141</PlatformToolset>",
          "61:     <PlatformToolset>v141</PlatformToolset>",
          "68:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/ms-sys/.msvc/ms-sys.vcxproj||src/ms-sys/.msvc/ms-sys.vcxproj": [
          "File: src/ms-sys/.msvc/ms-sys.vcxproj -> src/ms-sys/.msvc/ms-sys.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "86:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "87:     <UseDebugLibraries>true</UseDebugLibraries>",
          "88:     <CharacterSet>Unicode</CharacterSet>",
          "90:   </PropertyGroup>",
          "91:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "92:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "93:     <UseDebugLibraries>false</UseDebugLibraries>",
          "94:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "95:     <CharacterSet>Unicode</CharacterSet>",
          "97:   </PropertyGroup>",
          "98:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "99:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "100:     <UseDebugLibraries>true</UseDebugLibraries>",
          "101:     <CharacterSet>Unicode</CharacterSet>",
          "103:   </PropertyGroup>",
          "104:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "105:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "106:     <UseDebugLibraries>false</UseDebugLibraries>",
          "107:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "108:     <CharacterSet>Unicode</CharacterSet>",
          "110:   </PropertyGroup>",
          "111:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "112:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "89:     <PlatformToolset>v140</PlatformToolset>",
          "96:     <PlatformToolset>v140</PlatformToolset>",
          "102:     <PlatformToolset>v140</PlatformToolset>",
          "109:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "89:     <PlatformToolset>v141</PlatformToolset>",
          "96:     <PlatformToolset>v141</PlatformToolset>",
          "102:     <PlatformToolset>v141</PlatformToolset>",
          "109:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.15.1111\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.15.1112\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,15,1111,0",
          "338:  PRODUCTVERSION 2,15,1111,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,15,1112,0",
          "338:  PRODUCTVERSION 2,15,1112,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.15.1111\"",
          "361:             VALUE \"ProductVersion\", \"2.15.1111\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.15.1112\"",
          "361:             VALUE \"ProductVersion\", \"2.15.1112\"",
          "",
          "---------------"
        ],
        "src/syslinux/libfat/.msvc/libfat.vcxproj||src/syslinux/libfat/.msvc/libfat.vcxproj": [
          "File: src/syslinux/libfat/.msvc/libfat.vcxproj -> src/syslinux/libfat/.msvc/libfat.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "41:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "42:     <UseDebugLibraries>true</UseDebugLibraries>",
          "43:     <CharacterSet>Unicode</CharacterSet>",
          "45:   </PropertyGroup>",
          "46:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "47:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "48:     <UseDebugLibraries>false</UseDebugLibraries>",
          "49:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "50:     <CharacterSet>Unicode</CharacterSet>",
          "52:   </PropertyGroup>",
          "53:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "54:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "55:     <UseDebugLibraries>true</UseDebugLibraries>",
          "56:     <CharacterSet>Unicode</CharacterSet>",
          "58:   </PropertyGroup>",
          "59:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "60:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "61:     <UseDebugLibraries>false</UseDebugLibraries>",
          "62:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "63:     <CharacterSet>Unicode</CharacterSet>",
          "65:   </PropertyGroup>",
          "66:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "67:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "44:     <PlatformToolset>v140</PlatformToolset>",
          "51:     <PlatformToolset>v140</PlatformToolset>",
          "57:     <PlatformToolset>v140</PlatformToolset>",
          "64:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "44:     <PlatformToolset>v141</PlatformToolset>",
          "51:     <PlatformToolset>v141</PlatformToolset>",
          "57:     <PlatformToolset>v141</PlatformToolset>",
          "64:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/syslinux/libinstaller/.msvc/libinstaller.vcxproj||src/syslinux/libinstaller/.msvc/libinstaller.vcxproj": [
          "File: src/syslinux/libinstaller/.msvc/libinstaller.vcxproj -> src/syslinux/libinstaller/.msvc/libinstaller.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "41:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "42:     <UseDebugLibraries>true</UseDebugLibraries>",
          "43:     <CharacterSet>Unicode</CharacterSet>",
          "45:   </PropertyGroup>",
          "46:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "47:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "48:     <UseDebugLibraries>false</UseDebugLibraries>",
          "49:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "50:     <CharacterSet>Unicode</CharacterSet>",
          "52:   </PropertyGroup>",
          "53:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "54:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "55:     <UseDebugLibraries>true</UseDebugLibraries>",
          "56:     <CharacterSet>Unicode</CharacterSet>",
          "58:   </PropertyGroup>",
          "59:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "60:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "61:     <UseDebugLibraries>false</UseDebugLibraries>",
          "62:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "63:     <CharacterSet>Unicode</CharacterSet>",
          "65:   </PropertyGroup>",
          "66:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "67:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "44:     <PlatformToolset>v140</PlatformToolset>",
          "51:     <PlatformToolset>v140</PlatformToolset>",
          "57:     <PlatformToolset>v140</PlatformToolset>",
          "64:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "44:     <PlatformToolset>v141</PlatformToolset>",
          "51:     <PlatformToolset>v141</PlatformToolset>",
          "57:     <PlatformToolset>v141</PlatformToolset>",
          "64:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ],
        "src/syslinux/win/.msvc/win.vcxproj||src/syslinux/win/.msvc/win.vcxproj": [
          "File: src/syslinux/win/.msvc/win.vcxproj -> src/syslinux/win/.msvc/win.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"15.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "35:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "36:     <UseDebugLibraries>true</UseDebugLibraries>",
          "37:     <CharacterSet>Unicode</CharacterSet>",
          "39:   </PropertyGroup>",
          "40:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "41:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "42:     <UseDebugLibraries>false</UseDebugLibraries>",
          "43:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "44:     <CharacterSet>Unicode</CharacterSet>",
          "46:   </PropertyGroup>",
          "47:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "48:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "49:     <UseDebugLibraries>true</UseDebugLibraries>",
          "50:     <CharacterSet>Unicode</CharacterSet>",
          "52:   </PropertyGroup>",
          "53:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "54:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "55:     <UseDebugLibraries>false</UseDebugLibraries>",
          "56:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "57:     <CharacterSet>Unicode</CharacterSet>",
          "59:   </PropertyGroup>",
          "60:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "61:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "38:     <PlatformToolset>v140</PlatformToolset>",
          "45:     <PlatformToolset>v140</PlatformToolset>",
          "51:     <PlatformToolset>v140</PlatformToolset>",
          "58:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "38:     <PlatformToolset>v141</PlatformToolset>",
          "45:     <PlatformToolset>v141</PlatformToolset>",
          "51:     <PlatformToolset>v141</PlatformToolset>",
          "58:     <PlatformToolset>v141</PlatformToolset>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "854620d0ba8eeac91c9869e2504bbff9e7a43387",
      "candidate_info": {
        "commit_hash": "854620d0ba8eeac91c9869e2504bbff9e7a43387",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/854620d0ba8eeac91c9869e2504bbff9e7a43387",
        "files": [
          "src/drive.c",
          "src/rufus.rc"
        ],
        "message": "[core] relax the rule for exclusive write access\n\n* If we can't get a write handle for more than 5 seconds, retry with FILE_SHARE_WRITE\n* This is a partial revert of 2f81e4f177a3603f6a29b11e3f8b7721728e232c, in order to address #924.",
        "before_after_code_files": [
          "src/drive.c||src/drive.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/drive.c||src/drive.c": [
          "File: src/drive.c -> src/drive.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "59: RUFUS_DRIVE_INFO SelectedDrive;",
          "",
          "[Removed Lines]",
          "60: extern BOOL lock_drive;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "148:    break;",
          "149:   if (i == 0) {",
          "150:    uprintf(\"Waiting for access...\");",
          "155:    bWriteShare = TRUE;",
          "156:   }",
          "157:   Sleep(DRIVE_ACCESS_TIMEOUT / DRIVE_ACCESS_RETRIES);",
          "",
          "[Removed Lines]",
          "151:   } else if (!lock_drive && bWriteAccess && !bWriteShare && (i > (2*DRIVE_ACCESS_RETRIES)/3)) {",
          "154:    uprintf(\"Can't access %s - Retrying with write sharing enabled...\");",
          "",
          "[Added Lines]",
          "150:   } else if (bWriteAccess && !bWriteShare && (i > DRIVE_ACCESS_RETRIES/3)) {",
          "153:    uprintf(\"Warning: Could not obtain exclusive rights. Retrying with write sharing enabled...\");",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.14.1084\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.14.1085\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,14,1084,0",
          "338:  PRODUCTVERSION 2,14,1084,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,14,1085,0",
          "338:  PRODUCTVERSION 2,14,1085,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.14.1084\"",
          "361:             VALUE \"ProductVersion\", \"2.14.1084\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.14.1085\"",
          "361:             VALUE \"ProductVersion\", \"2.14.1085\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "23390bf9118c72a1789b3d6a6185105c0d554b70",
      "candidate_info": {
        "commit_hash": "23390bf9118c72a1789b3d6a6185105c0d554b70",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/23390bf9118c72a1789b3d6a6185105c0d554b70",
        "files": [
          "src/dev.c",
          "src/drive.c",
          "src/drive.h",
          "src/format.c",
          "src/rufus.rc"
        ],
        "message": "[core] relax the FILE_SHARE_WRITE rules during enumeration\n\n* Should allow enumeration of drives, that other process have open\n  with RW access, back again (looking at you, Paragon!!!)",
        "before_after_code_files": [
          "src/dev.c||src/dev.c",
          "src/drive.c||src/drive.c",
          "src/drive.h||src/drive.h",
          "src/format.c||src/format.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/dev.c||src/dev.c": [
          "File: src/dev.c -> src/dev.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "654:     continue;",
          "655:    }",
          "659:    if(hDrive == INVALID_HANDLE_VALUE) {",
          "660:     uprintf(\"Could not open '%s': %s\\n\", devint_detail_data->DevicePath, WindowsErrorString());",
          "661:     continue;",
          "",
          "[Removed Lines]",
          "657:    hDrive = CreateFileA(devint_detail_data->DevicePath, GENERIC_READ|GENERIC_WRITE, FILE_SHARE_READ,",
          "658:     NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);",
          "",
          "[Added Lines]",
          "657:    hDrive = CreateFileA(devint_detail_data->DevicePath, GENERIC_READ|GENERIC_WRITE,",
          "658:     FILE_SHARE_READ|FILE_SHARE_WRITE, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);",
          "",
          "---------------"
        ],
        "src/drive.c||src/drive.c": [
          "File: src/drive.c -> src/drive.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "140:   hDrive = CreateFileA(Path, GENERIC_READ|(bWriteAccess?GENERIC_WRITE:0),",
          "142:    NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);",
          "143:   if (hDrive != INVALID_HANDLE_VALUE)",
          "144:    break;",
          "",
          "[Removed Lines]",
          "141:    FILE_SHARE_READ|((bWriteAccess && bWriteShare)?FILE_SHARE_WRITE:0),",
          "",
          "[Added Lines]",
          "141:    FILE_SHARE_READ|(bWriteShare?FILE_SHARE_WRITE:0),",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "146:    break;",
          "147:   if (i == 0) {",
          "148:    uprintf(\"Waiting for access...\");",
          "152:    uprintf(\"Warning: Could not obtain exclusive rights. Retrying with write sharing enabled...\");",
          "154:    bWriteShare = TRUE;",
          "155:   }",
          "156:   Sleep(DRIVE_ACCESS_TIMEOUT / DRIVE_ACCESS_RETRIES);",
          "",
          "[Removed Lines]",
          "149:   } else if (bWriteAccess && !bWriteShare && (i > DRIVE_ACCESS_RETRIES/3)) {",
          "153:    SearchProcess(DevPath, TRUE, TRUE);",
          "",
          "[Added Lines]",
          "149:   } else if (!bWriteShare && (i > DRIVE_ACCESS_RETRIES/3)) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "211: {",
          "212:  HANDLE hPhysical = INVALID_HANDLE_VALUE;",
          "213:  char* PhysicalPath = GetPhysicalName(DriveIndex);",
          "215:  safe_free(PhysicalPath);",
          "216:  return hPhysical;",
          "217: }",
          "",
          "[Removed Lines]",
          "210: HANDLE GetPhysicalHandle(DWORD DriveIndex, BOOL bLockDrive, BOOL bWriteAccess)",
          "214:  hPhysical = GetHandle(PhysicalPath, bLockDrive, bWriteAccess, FALSE);",
          "",
          "[Added Lines]",
          "209: HANDLE GetPhysicalHandle(DWORD DriveIndex, BOOL bLockDrive, BOOL bWriteAccess, BOOL bWriteShare)",
          "213:  hPhysical = GetHandle(PhysicalPath, bLockDrive, bWriteAccess, bWriteShare);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "541:  if (DeviceIoControl(hPhysical, IOCTL_STORAGE_CHECK_VERIFY, NULL, 0, NULL, 0, &size, NULL))",
          "542:   AutorunLabel = get_token_data_file(\"label\", AutorunPath);",
          "543:  else if (GetLastError() == ERROR_NOT_READY)",
          "",
          "[Removed Lines]",
          "540:  hPhysical = GetPhysicalHandle(DriveIndex, FALSE, FALSE);",
          "",
          "[Added Lines]",
          "539:  hPhysical = GetPhysicalHandle(DriveIndex, FALSE, FALSE, TRUE);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "570:  BYTE geometry[256];",
          "571:  PDISK_GEOMETRY_EX DiskGeometry = (PDISK_GEOMETRY_EX)(void*)geometry;",
          "574:  if (hPhysical == INVALID_HANDLE_VALUE)",
          "575:   return FALSE;",
          "",
          "[Removed Lines]",
          "573:  hPhysical = GetPhysicalHandle(DriveIndex, FALSE, FALSE);",
          "",
          "[Added Lines]",
          "572:  hPhysical = GetPhysicalHandle(DriveIndex, FALSE, FALSE, TRUE);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "592:  DWORD size;",
          "593:  BYTE geometry[128];",
          "596:  r = DeviceIoControl(hPhysical, IOCTL_DISK_GET_DRIVE_GEOMETRY_EX,",
          "597:    NULL, 0, geometry, sizeof(geometry), &size, NULL) && (size > 0);",
          "598:  safe_closehandle(hPhysical);",
          "",
          "[Removed Lines]",
          "595:  hPhysical = GetPhysicalHandle(DriveIndex, FALSE, FALSE);",
          "",
          "[Added Lines]",
          "594:  hPhysical = GetPhysicalHandle(DriveIndex, FALSE, FALSE, TRUE);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "711:  }",
          "712:  safe_free(volume_name);",
          "715:  if (hPhysical == INVALID_HANDLE_VALUE)",
          "716:   return 0;",
          "",
          "[Removed Lines]",
          "714:  hPhysical = GetPhysicalHandle(DriveIndex, FALSE, FALSE);",
          "",
          "[Added Lines]",
          "713:  hPhysical = GetPhysicalHandle(DriveIndex, FALSE, FALSE, TRUE);",
          "",
          "---------------"
        ],
        "src/drive.h||src/drive.h": [
          "File: src/drive.h -> src/drive.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "79: BOOL SetAutoMount(BOOL enable);",
          "80: BOOL GetAutoMount(BOOL* enabled);",
          "81: char* GetPhysicalName(DWORD DriveIndex);",
          "83: char* GetLogicalName(DWORD DriveIndex, BOOL bKeepTrailingBackslash, BOOL bSilent);",
          "84: BOOL WaitForLogical(DWORD DriveIndex);",
          "85: HANDLE GetLogicalHandle(DWORD DriveIndex, BOOL bLockDrive, BOOL bWriteAccess, BOOL bWriteShare);",
          "",
          "[Removed Lines]",
          "82: HANDLE GetPhysicalHandle(DWORD DriveIndex, BOOL bLockDrive, BOOL bWriteAccess);",
          "",
          "[Added Lines]",
          "82: HANDLE GetPhysicalHandle(DWORD DriveIndex, BOOL bLockDrive, BOOL bWriteAccess, BOOL bWriteShare);",
          "",
          "---------------"
        ],
        "src/format.c||src/format.c": [
          "File: src/format.c -> src/format.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1663:   extra_partitions = XP_COMPAT;",
          "1665:  PrintInfoDebug(0, MSG_225);",
          "1667:  if (hPhysicalDrive == INVALID_HANDLE_VALUE) {",
          "1668:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_OPEN_FAILED;",
          "1669:   goto out;",
          "",
          "[Removed Lines]",
          "1666:  hPhysicalDrive = GetPhysicalHandle(DriveIndex, lock_drive, TRUE);",
          "",
          "[Added Lines]",
          "1666:  hPhysicalDrive = GetPhysicalHandle(DriveIndex, lock_drive, TRUE, FALSE);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2096:  LastRefresh = 0;",
          "2097:  switch (img_save->Type) {",
          "2098:  case IMG_SAVE_TYPE_VHD:",
          "2100:   break;",
          "2101:  case IMG_SAVE_TYPE_ISO:",
          "2102:   hPhysicalDrive = CreateFileA(img_save->DevicePath, GENERIC_READ, FILE_SHARE_READ,",
          "",
          "[Removed Lines]",
          "2099:   hPhysicalDrive = GetPhysicalHandle(img_save->DeviceNum, TRUE, FALSE);",
          "",
          "[Added Lines]",
          "2099:   hPhysicalDrive = GetPhysicalHandle(img_save->DeviceNum, TRUE, FALSE, FALSE);",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.15.1103\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.15.1104\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,15,1103,0",
          "338:  PRODUCTVERSION 2,15,1103,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,15,1104,0",
          "338:  PRODUCTVERSION 2,15,1104,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.15.1103\"",
          "361:             VALUE \"ProductVersion\", \"2.15.1103\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.15.1104\"",
          "361:             VALUE \"ProductVersion\", \"2.15.1104\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}