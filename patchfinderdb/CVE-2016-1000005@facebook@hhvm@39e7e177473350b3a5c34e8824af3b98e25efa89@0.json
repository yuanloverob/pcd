{
  "cve_id": "CVE-2016-1000005",
  "cve_desc": "mcrypt_get_block_size did not enforce that the provided \"module\" parameter was a string, leading to type confusion if other types of data were passed in. This issue affects HHVM versions prior to 3.9.5, all versions between 3.10.0 and 3.12.3 (inclusive), and all versions between 3.13.0 and 3.14.1 (inclusive).",
  "repo": "facebook/hhvm",
  "patch_hash": "39e7e177473350b3a5c34e8824af3b98e25efa89",
  "patch_info": {
    "commit_hash": "39e7e177473350b3a5c34e8824af3b98e25efa89",
    "repo": "facebook/hhvm",
    "commit_url": "https://github.com/facebook/hhvm/commit/39e7e177473350b3a5c34e8824af3b98e25efa89",
    "files": [
      "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
      "hphp/runtime/ext/mcrypt/ext_mcrypt.php",
      "hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
      "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
    ],
    "message": "Fix param types for mcrypt_get_block_size() to match PHP\n\nReviewed By: edwinsmith\n\nDifferential Revision: D3447281\n\nfbshipit-source-id: a88549307faad886f5a0f78d421aa28e08d21b1c",
    "before_after_code_files": [
      "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
      "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
      "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
      "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
    ]
  },
  "patch_diff": {
    "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp": [
      "File: hphp/runtime/ext/mcrypt/ext_mcrypt.cpp -> hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "457: }",
      "459: Variant HHVM_FUNCTION(mcrypt_get_block_size, const String& cipher,",
      "461:   MCRYPT td = mcrypt_module_open((char*)cipher.data(),",
      "462:                                  (char*)MCG(algorithms_dir).data(),",
      "464:                                  (char*)MCG(modes_dir).data());",
      "465:   if (td == MCRYPT_FAILED) {",
      "466:     MCRYPT_OPEN_MODULE_FAILED(\"mcrypt_get_block_size\");",
      "",
      "[Removed Lines]",
      "460:                                     const Variant& module /* = null_string */) {",
      "463:                                  (char*)module.asCStrRef().data(),",
      "",
      "[Added Lines]",
      "460:                                              const String& mode) {",
      "463:                                  (char*)mode.data(),",
      "",
      "---------------"
    ],
    "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php": [
      "File: hphp/runtime/ext/mcrypt/ext_mcrypt.php -> hphp/runtime/ext/mcrypt/ext_mcrypt.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "298: <<__Native>>",
      "299: function mcrypt_get_block_size(string $cipher,",
      "",
      "[Removed Lines]",
      "300:                                ?string $mode = null): mixed;",
      "",
      "[Added Lines]",
      "300:                                string $mode): mixed;",
      "",
      "---------------"
    ],
    "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php": [
      "File: hphp/test/slow/ext_mcrypt/ext_mcrypt.php -> hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "108: VS(mcrypt_get_block_size(\"tripledes\", \"ecb\"), 8);",
      "109: VS(mcrypt_get_cipher_name(MCRYPT_TRIPLEDES), \"3DES\");",
      "110: VS(mcrypt_get_iv_size(MCRYPT_CAST_256, MCRYPT_MODE_CFB), 16);",
      "111: VS(mcrypt_get_iv_size(\"des\", \"ecb\"), 8);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "109: mcrypt_get_block_size(\"tripledes\");",
      "",
      "---------------"
    ],
    "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf": [
      "File: hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf -> hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf",
      "--- Hunk 1 ---",
      "[Context before]",
      "38: bool(true)",
      "39: bool(true)",
      "40: bool(true)",
      "41: bool(true)",
      "42: bool(true)",
      "43: bool(true)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "42: Warning: mcrypt_get_block_size() expects exactly 2 parameters, 1 given in %s/test/slow/ext_mcrypt/ext_mcrypt.php on line 109",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "718801824690a00827c1349c3a9fdc86683e0567",
      "candidate_info": {
        "commit_hash": "718801824690a00827c1349c3a9fdc86683e0567",
        "repo": "facebook/hhvm",
        "commit_url": "https://github.com/facebook/hhvm/commit/718801824690a00827c1349c3a9fdc86683e0567",
        "files": [
          "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
        ],
        "message": "Fix param types for mcrypt_get_block_size() to match PHP\n\nReviewed By: edwinsmith\n\nDifferential Revision: D3447281\n\nfbshipit-source-id: a88549307faad886f5a0f78d421aa28e08d21b1c",
        "before_after_code_files": [
          "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
            "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
          ],
          "candidate": [
            "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
            "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
          ]
        }
      },
      "candidate_diff": {
        "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp": [
          "File: hphp/runtime/ext/mcrypt/ext_mcrypt.cpp -> hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "459: }",
          "461: Variant HHVM_FUNCTION(mcrypt_get_block_size, const String& cipher,",
          "463:   MCRYPT td = mcrypt_module_open((char*)cipher.data(),",
          "464:                                  (char*)MCG(algorithms_dir).data(),",
          "466:                                  (char*)MCG(modes_dir).data());",
          "467:   if (td == MCRYPT_FAILED) {",
          "468:     MCRYPT_OPEN_MODULE_FAILED(\"mcrypt_get_block_size\");",
          "",
          "[Removed Lines]",
          "462:                                     const Variant& module /* = null_string */) {",
          "465:                                  (char*)module.asCStrRef().data(),",
          "",
          "[Added Lines]",
          "462:                                              const String& mode) {",
          "465:                                  (char*)mode.data(),",
          "",
          "---------------"
        ],
        "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php": [
          "File: hphp/runtime/ext/mcrypt/ext_mcrypt.php -> hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "298: <<__Native>>",
          "299: function mcrypt_get_block_size(string $cipher,",
          "",
          "[Removed Lines]",
          "300:                                ?string $mode = null): mixed;",
          "",
          "[Added Lines]",
          "300:                                string $mode): mixed;",
          "",
          "---------------"
        ],
        "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php": [
          "File: hphp/test/slow/ext_mcrypt/ext_mcrypt.php -> hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "108: VS(mcrypt_get_block_size(\"tripledes\", \"ecb\"), 8);",
          "109: VS(mcrypt_get_cipher_name(MCRYPT_TRIPLEDES), \"3DES\");",
          "110: VS(mcrypt_get_iv_size(MCRYPT_CAST_256, MCRYPT_MODE_CFB), 16);",
          "111: VS(mcrypt_get_iv_size(\"des\", \"ecb\"), 8);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "109: mcrypt_get_block_size(\"tripledes\");",
          "",
          "---------------"
        ],
        "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf": [
          "File: hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf -> hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf",
          "--- Hunk 1 ---",
          "[Context before]",
          "38: bool(true)",
          "39: bool(true)",
          "40: bool(true)",
          "41: bool(true)",
          "42: bool(true)",
          "43: bool(true)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "42: Warning: mcrypt_get_block_size() expects exactly 2 parameters, 1 given in %s/test/slow/ext_mcrypt/ext_mcrypt.php on line 109",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "86522425e1b2a5637d43e187b15d590e9f201820",
      "candidate_info": {
        "commit_hash": "86522425e1b2a5637d43e187b15d590e9f201820",
        "repo": "facebook/hhvm",
        "commit_url": "https://github.com/facebook/hhvm/commit/86522425e1b2a5637d43e187b15d590e9f201820",
        "files": [
          "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
        ],
        "message": "Fix param types for mcrypt_get_block_size() to match PHP\n\nReviewed By: edwinsmith\n\nDifferential Revision: D3447281\n\nfbshipit-source-id: a88549307faad886f5a0f78d421aa28e08d21b1c",
        "before_after_code_files": [
          "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
            "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
          ],
          "candidate": [
            "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
            "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
          ]
        }
      },
      "candidate_diff": {
        "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp": [
          "File: hphp/runtime/ext/mcrypt/ext_mcrypt.cpp -> hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "437: }",
          "439: Variant HHVM_FUNCTION(mcrypt_get_block_size, const String& cipher,",
          "441:   MCRYPT td = mcrypt_module_open((char*)cipher.data(),",
          "442:                                  (char*)MCG(algorithms_dir).data(),",
          "444:                                  (char*)MCG(modes_dir).data());",
          "445:   if (td == MCRYPT_FAILED) {",
          "446:     MCRYPT_OPEN_MODULE_FAILED(\"mcrypt_get_block_size\");",
          "",
          "[Removed Lines]",
          "440:                                     const Variant& module /* = null_string */) {",
          "443:                                  (char*)module.asCStrRef().data(),",
          "",
          "[Added Lines]",
          "440:                                              const String& mode) {",
          "443:                                  (char*)mode.data(),",
          "",
          "---------------"
        ],
        "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php": [
          "File: hphp/runtime/ext/mcrypt/ext_mcrypt.php -> hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "299: <<__Native>>",
          "300: function mcrypt_get_block_size(string $cipher,",
          "",
          "[Removed Lines]",
          "301:                                ?string $mode = null): mixed;",
          "",
          "[Added Lines]",
          "301:                                string $mode): mixed;",
          "",
          "---------------"
        ],
        "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php": [
          "File: hphp/test/slow/ext_mcrypt/ext_mcrypt.php -> hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "108: VS(mcrypt_get_block_size(\"tripledes\", \"ecb\"), 8);",
          "109: VS(mcrypt_get_cipher_name(MCRYPT_TRIPLEDES), \"3DES\");",
          "110: VS(mcrypt_get_iv_size(MCRYPT_CAST_256, MCRYPT_MODE_CFB), 16);",
          "111: VS(mcrypt_get_iv_size(\"des\", \"ecb\"), 8);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "109: mcrypt_get_block_size(\"tripledes\");",
          "",
          "---------------"
        ],
        "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf": [
          "File: hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf -> hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf",
          "--- Hunk 1 ---",
          "[Context before]",
          "38: bool(true)",
          "39: bool(true)",
          "40: bool(true)",
          "41: bool(true)",
          "42: bool(true)",
          "43: bool(true)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "42: Warning: mcrypt_get_block_size() expects exactly 2 parameters, 1 given in %s/test/slow/ext_mcrypt/ext_mcrypt.php on line 109",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6c3238a1a34711ce4526ddc3e9fb2b6f13ba16fc",
      "candidate_info": {
        "commit_hash": "6c3238a1a34711ce4526ddc3e9fb2b6f13ba16fc",
        "repo": "facebook/hhvm",
        "commit_url": "https://github.com/facebook/hhvm/commit/6c3238a1a34711ce4526ddc3e9fb2b6f13ba16fc",
        "files": [
          "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
        ],
        "message": "Fix param types for mcrypt_get_block_size() to match PHP\n\nReviewed By: edwinsmith\n\nDifferential Revision: D3447281\n\nfbshipit-source-id: a88549307faad886f5a0f78d421aa28e08d21b1c",
        "before_after_code_files": [
          "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
            "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
          ],
          "candidate": [
            "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
            "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
            "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf"
          ]
        }
      },
      "candidate_diff": {
        "hphp/runtime/ext/mcrypt/ext_mcrypt.cpp||hphp/runtime/ext/mcrypt/ext_mcrypt.cpp": [
          "File: hphp/runtime/ext/mcrypt/ext_mcrypt.cpp -> hphp/runtime/ext/mcrypt/ext_mcrypt.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "457: }",
          "459: Variant HHVM_FUNCTION(mcrypt_get_block_size, const String& cipher,",
          "461:   MCRYPT td = mcrypt_module_open((char*)cipher.data(),",
          "462:                                  (char*)MCG(algorithms_dir).data(),",
          "464:                                  (char*)MCG(modes_dir).data());",
          "465:   if (td == MCRYPT_FAILED) {",
          "466:     MCRYPT_OPEN_MODULE_FAILED(\"mcrypt_get_block_size\");",
          "",
          "[Removed Lines]",
          "460:                                     const Variant& module /* = null_string */) {",
          "463:                                  (char*)module.asCStrRef().data(),",
          "",
          "[Added Lines]",
          "460:                                              const String& mode) {",
          "463:                                  (char*)mode.data(),",
          "",
          "---------------"
        ],
        "hphp/runtime/ext/mcrypt/ext_mcrypt.php||hphp/runtime/ext/mcrypt/ext_mcrypt.php": [
          "File: hphp/runtime/ext/mcrypt/ext_mcrypt.php -> hphp/runtime/ext/mcrypt/ext_mcrypt.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "298: <<__Native>>",
          "299: function mcrypt_get_block_size(string $cipher,",
          "",
          "[Removed Lines]",
          "300:                                ?string $mode = null): mixed;",
          "",
          "[Added Lines]",
          "300:                                string $mode): mixed;",
          "",
          "---------------"
        ],
        "hphp/test/slow/ext_mcrypt/ext_mcrypt.php||hphp/test/slow/ext_mcrypt/ext_mcrypt.php": [
          "File: hphp/test/slow/ext_mcrypt/ext_mcrypt.php -> hphp/test/slow/ext_mcrypt/ext_mcrypt.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "108: VS(mcrypt_get_block_size(\"tripledes\", \"ecb\"), 8);",
          "109: VS(mcrypt_get_cipher_name(MCRYPT_TRIPLEDES), \"3DES\");",
          "110: VS(mcrypt_get_iv_size(MCRYPT_CAST_256, MCRYPT_MODE_CFB), 16);",
          "111: VS(mcrypt_get_iv_size(\"des\", \"ecb\"), 8);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "109: mcrypt_get_block_size(\"tripledes\");",
          "",
          "---------------"
        ],
        "hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf||hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf": [
          "File: hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf -> hphp/test/slow/ext_mcrypt/ext_mcrypt.php.expectf",
          "--- Hunk 1 ---",
          "[Context before]",
          "38: bool(true)",
          "39: bool(true)",
          "40: bool(true)",
          "41: bool(true)",
          "42: bool(true)",
          "43: bool(true)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "42: Warning: mcrypt_get_block_size() expects exactly 2 parameters, 1 given in %s/test/slow/ext_mcrypt/ext_mcrypt.php on line 109",
          "",
          "---------------"
        ]
      }
    }
  ]
}