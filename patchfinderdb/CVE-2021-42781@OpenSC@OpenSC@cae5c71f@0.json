{
  "cve_id": "CVE-2021-42781",
  "cve_desc": "Heap buffer overflow issues were found in Opensc before version 0.22.0 in pkcs15-oberthur.c that could potentially crash programs using the library.",
  "repo": "OpenSC/OpenSC",
  "patch_hash": "cae5c71f90cc5b364efe14040923fd5aa3b5dd90",
  "patch_info": {
    "commit_hash": "cae5c71f90cc5b364efe14040923fd5aa3b5dd90",
    "repo": "OpenSC/OpenSC",
    "commit_url": "https://github.com/OpenSC/OpenSC/commit/cae5c71f90cc5b364efe14040923fd5aa3b5dd90",
    "files": [
      "src/libopensc/pkcs15-oberthur.c"
    ],
    "message": "oberthur: Handle 1B OIDs\n\nThanks oss-fuzz\n\nhttps://bugs.chromium.org/p/oss-fuzz/issues/detail?id=32807",
    "before_after_code_files": [
      "src/libopensc/pkcs15-oberthur.c||src/libopensc/pkcs15-oberthur.c"
    ]
  },
  "patch_diff": {
    "src/libopensc/pkcs15-oberthur.c||src/libopensc/pkcs15-oberthur.c": [
      "File: src/libopensc/pkcs15-oberthur.c -> src/libopensc/pkcs15-oberthur.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "973:   free(info_blob);",
      "974:   LOG_TEST_RET(ctx, SC_ERROR_UNKNOWN_DATA_RECEIVED, \"Invalid length of 'oid' received\");",
      "975:  }",
      "977:   oid = info_blob + offs + 2;",
      "978:   if (*oid != 0x06 || (*(oid + 1) != oid_len - 2)) {",
      "979:    free(info_blob);",
      "",
      "[Removed Lines]",
      "976:  if (oid_len)   {",
      "",
      "[Added Lines]",
      "976:  if (oid_len > 2) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ef17b3fb89c433de049953cc967f8ac62292bb41",
      "candidate_info": {
        "commit_hash": "ef17b3fb89c433de049953cc967f8ac62292bb41",
        "repo": "OpenSC/OpenSC",
        "commit_url": "https://github.com/OpenSC/OpenSC/commit/ef17b3fb89c433de049953cc967f8ac62292bb41",
        "files": [
          "tests/test-duplicate-symbols.sh"
        ],
        "message": "tests: Fix comparison for osx",
        "before_after_code_files": [
          "tests/test-duplicate-symbols.sh||tests/test-duplicate-symbols.sh"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/OpenSC/OpenSC/pull/2289"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tests/test-duplicate-symbols.sh||tests/test-duplicate-symbols.sh": [
          "File: tests/test-duplicate-symbols.sh -> tests/test-duplicate-symbols.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: for E in $EXPORTS; do",
          "8:  DUPES=`sort $E | uniq -d`",
          "9:  NUM_DUPES=`echo -n \"$DUPES\" | wc -l`",
          "11:   echo \"There are $NUM_DUPES duplicate symbols in '$E': $DUPES\"",
          "12:   ERRORS=1",
          "13:  fi",
          "",
          "[Removed Lines]",
          "10:  if [[ \"$NUM_DUPES\" != 0 ]]; then",
          "",
          "[Added Lines]",
          "10:  if [ $NUM_DUPES -gt 0 ]; then",
          "",
          "---------------"
        ]
      }
    }
  ]
}