{
  "cve_id": "CVE-2015-6817",
  "cve_desc": "PgBouncer 1.6.x before 1.6.1, when configured with auth_user, allows remote attackers to gain login access as auth_user via an unknown username.",
  "repo": "pgbouncer/pgbouncer",
  "patch_hash": "7ca3e5279d05fceb1e8a043c6f5b6f58dea3ed38",
  "patch_info": {
    "commit_hash": "7ca3e5279d05fceb1e8a043c6f5b6f58dea3ed38",
    "repo": "pgbouncer/pgbouncer",
    "commit_url": "https://github.com/pgbouncer/pgbouncer/commit/7ca3e5279d05fceb1e8a043c6f5b6f58dea3ed38",
    "files": [
      "src/client.c"
    ],
    "message": "Remove too early set of auth_user\n\nWhen query returns 0 rows (user not found),\nthis user stays as login user...\n\nShould fix #69.",
    "before_after_code_files": [
      "src/client.c||src/client.c"
    ]
  },
  "patch_diff": {
    "src/client.c||src/client.c": [
      "File: src/client.c -> src/client.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "83:  int res;",
      "84:  PktBuf *buf;",
      "88:  client->pool = get_pool(client->db, client->db->auth_user);",
      "89:  if (!find_server(client)) {",
      "",
      "[Removed Lines]",
      "86:  client->auth_user = client->db->auth_user;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "45f555fb037ab0579f484c9def93f6f0c01dfb48",
      "candidate_info": {
        "commit_hash": "45f555fb037ab0579f484c9def93f6f0c01dfb48",
        "repo": "pgbouncer/pgbouncer",
        "commit_url": "https://github.com/pgbouncer/pgbouncer/commit/45f555fb037ab0579f484c9def93f6f0c01dfb48",
        "files": [
          "src/client.c"
        ],
        "message": "Remove too early set of auth_user\n\nWhen query returns 0 rows (user not found),\nthis user stays as login user...\n\nShould fix #69.",
        "before_after_code_files": [
          "src/client.c||src/client.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "src/client.c||src/client.c"
          ],
          "candidate": [
            "src/client.c||src/client.c"
          ]
        }
      },
      "candidate_diff": {
        "src/client.c||src/client.c": [
          "File: src/client.c -> src/client.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "95:  int res;",
          "96:  PktBuf *buf;",
          "100:  client->pool = get_pool(client->db, client->db->auth_user);",
          "101:  if (!find_server(client)) {",
          "",
          "[Removed Lines]",
          "98:  client->auth_user = client->db->auth_user;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}