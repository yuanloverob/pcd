{
  "cve_id": "CVE-2021-3610",
  "cve_desc": "A heap-based buffer overflow vulnerability was found in ImageMagick in versions prior to 7.0.11-14 in ReadTIFFImage() in coders/tiff.c. This issue is due to an incorrect setting of the pixel array size, which can lead to a crash and segmentation fault.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "930ff0d1a9bc42925a7856e9ea53f5fc9f318bf3",
  "patch_info": {
    "commit_hash": "930ff0d1a9bc42925a7856e9ea53f5fc9f318bf3",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/930ff0d1a9bc42925a7856e9ea53f5fc9f318bf3",
    "files": [
      "coders/tiff.c"
    ],
    "message": "eliminate heap buffer overflow vulnerability, thanks to ZhangJiaxing (@r0fm1a) from Codesafe Team of Legendsec at Qi'anxin Group",
    "before_after_code_files": [
      "coders/tiff.c||coders/tiff.c"
    ]
  },
  "patch_diff": {
    "coders/tiff.c||coders/tiff.c": [
      "File: coders/tiff.c -> coders/tiff.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1894:         tsize_t",
      "1895:           strip_size;",
      "",
      "[Removed Lines]",
      "1897:         unsigned char",
      "",
      "[Added Lines]",
      "1897:         unsigned char",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a5b64ccc422615264287028fe6bea8a131043b59",
      "candidate_info": {
        "commit_hash": "a5b64ccc422615264287028fe6bea8a131043b59",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/a5b64ccc422615264287028fe6bea8a131043b59",
        "files": [
          "coders/tiff.c"
        ],
        "message": "...",
        "before_after_code_files": [
          "coders/tiff.c||coders/tiff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "coders/tiff.c||coders/tiff.c"
          ],
          "candidate": [
            "coders/tiff.c||coders/tiff.c"
          ]
        }
      },
      "candidate_diff": {
        "coders/tiff.c||coders/tiff.c": [
          "File: coders/tiff.c -> coders/tiff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1975:         tsize_t",
          "1976:           strip_size;",
          "",
          "[Removed Lines]",
          "1978:         unsigned char",
          "",
          "[Added Lines]",
          "1978:         unsigned char",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "354f421e4e66309702d94d3fe41ea65d9f7618a6",
      "candidate_info": {
        "commit_hash": "354f421e4e66309702d94d3fe41ea65d9f7618a6",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/354f421e4e66309702d94d3fe41ea65d9f7618a6",
        "files": [
          "coders/tiff.c"
        ],
        "message": "...",
        "before_after_code_files": [
          "coders/tiff.c||coders/tiff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "coders/tiff.c||coders/tiff.c"
          ],
          "candidate": [
            "coders/tiff.c||coders/tiff.c"
          ]
        }
      },
      "candidate_diff": {
        "coders/tiff.c||coders/tiff.c": [
          "File: coders/tiff.c -> coders/tiff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1894:         tsize_t",
          "1895:           strip_size;",
          "",
          "[Removed Lines]",
          "1897:         unsigned char",
          "",
          "[Added Lines]",
          "1897:         unsigned char",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e247d2155fec6591988ffd0fbcd84acea4114181",
      "candidate_info": {
        "commit_hash": "e247d2155fec6591988ffd0fbcd84acea4114181",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/e247d2155fec6591988ffd0fbcd84acea4114181",
        "files": [
          "coders/tiff.c"
        ],
        "message": "...",
        "before_after_code_files": [
          "coders/tiff.c||coders/tiff.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "coders/tiff.c||coders/tiff.c"
          ],
          "candidate": [
            "coders/tiff.c||coders/tiff.c"
          ]
        }
      },
      "candidate_diff": {
        "coders/tiff.c||coders/tiff.c": [
          "File: coders/tiff.c -> coders/tiff.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1894:         tsize_t",
          "1895:           strip_size;",
          "",
          "[Removed Lines]",
          "1897:         unsigned char",
          "",
          "[Added Lines]",
          "1897:         unsigned char",
          "",
          "---------------"
        ]
      }
    }
  ]
}