{
  "cve_id": "CVE-2017-6952",
  "cve_desc": "Integer overflow in the cs_winkernel_malloc function in winkernel_mm.c in Capstone 3.0.4 and earlier allows attackers to cause a denial of service (heap-based buffer overflow in a kernel driver) or possibly have unspecified other impact via a large value.",
  "repo": "aquynh/capstone",
  "patch_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
  "patch_info": {
    "commit_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
    "repo": "aquynh/capstone",
    "commit_url": "https://github.com/aquynh/capstone/commit/6fe86eef621b9849f51a5e1e5d73258a93440403",
    "files": [
      "windows/winkernel_mm.c"
    ],
    "message": "provide a validity check to prevent against Integer overflow conditions (#870)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.",
    "before_after_code_files": [
      "windows/winkernel_mm.c||windows/winkernel_mm.c"
    ]
  },
  "patch_diff": {
    "windows/winkernel_mm.c||windows/winkernel_mm.c": [
      "File: windows/winkernel_mm.c -> windows/winkernel_mm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: #include \"winkernel_mm.h\"",
      "5: #include <ntddk.h>",
      "8: static const ULONG CS_WINKERNEL_POOL_TAG = 'kwsC';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "6: #include <Ntintsafe.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "35: #pragma prefast(suppress : 30030)  // Allocating executable POOL_TYPE memory",
      "38:  if (!block) {",
      "39:   return NULL;",
      "40:  }",
      "",
      "[Removed Lines]",
      "36:  CS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "37:    NonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);",
      "",
      "[Added Lines]",
      "37:  size_t number_of_bytes = 0;",
      "38:  CS_WINKERNEL_MEMBLOCK *block = NULL;",
      "42:  if (!NT_SUCCESS(RtlSizeTAdd(size, sizeof(CS_WINKERNEL_MEMBLOCK), &number_of_bytes))) {",
      "43:   return NULL;",
      "44:  }",
      "45:  block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "46:    NonPagedPool, number_of_bytes, CS_WINKERNEL_POOL_TAG);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "bdbc57de63725a98732ddc34b48de96f8ada66f2",
      "candidate_info": {
        "commit_hash": "bdbc57de63725a98732ddc34b48de96f8ada66f2",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/bdbc57de63725a98732ddc34b48de96f8ada66f2",
        "files": [
          "arch/M68K/M68KInstPrinter.c",
          "bindings/java/capstone/M68k_const.java",
          "bindings/ocaml/m68k_const.ml",
          "include/capstone/m68k.h"
        ],
        "message": "m68k: update bindings after #1068",
        "before_after_code_files": [
          "arch/M68K/M68KInstPrinter.c||arch/M68K/M68KInstPrinter.c",
          "bindings/javcapstone/M68k_const.java||bindings/java/capstone/M68k_const.java",
          "bindings/ocaml/m68k_const.ml||bindings/ocaml/m68k_const.ml",
          "include/capstone/m68k.h||include/capstone/m68k.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/M68K/M68KInstPrinter.c||arch/M68K/M68KInstPrinter.c": [
          "File: arch/M68K/M68KInstPrinter.c -> arch/M68K/M68KInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "179:    if (op->address_mode == M68K_AM_PCI_INDEX_BASE_DISP) {",
          "180:     SStream_concat(O, \"$%x\", pc + 2 + op->mem.in_disp);",
          "183:     if (op->mem.in_disp > 0)",
          "184:      SStream_concat(O, \"$%x\", op->mem.in_disp);",
          "185:    }",
          "",
          "[Removed Lines]",
          "181:    }",
          "182:    else {",
          "",
          "[Added Lines]",
          "181:    } else {",
          "",
          "---------------"
        ],
        "bindings/javcapstone/M68k_const.java||bindings/java/capstone/M68k_const.java": [
          "File: bindings/javcapstone/M68k_const.java -> bindings/java/capstone/M68k_const.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "79:  public static final int M68K_AM_BRANCH_DISPLACEMENT = 19;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91:  public static final int M68K_OP_BR_DISP = 8;",
          "95:  public static final int M68K_OP_BR_DISP_SIZE_INVALID = 0;",
          "96:  public static final int M68K_OP_BR_DISP_SIZE_BYTE = 1;",
          "97:  public static final int M68K_OP_BR_DISP_SIZE_WORD = 2;",
          "98:  public static final int M68K_OP_BR_DISP_SIZE_LONG = 4;",
          "",
          "---------------"
        ],
        "bindings/ocaml/m68k_const.ml||bindings/ocaml/m68k_const.ml": [
          "File: bindings/ocaml/m68k_const.ml -> bindings/ocaml/m68k_const.ml",
          "--- Hunk 1 ---",
          "[Context before]",
          "73: let _M68K_AM_ABSOLUTE_DATA_SHORT = 16;;",
          "74: let _M68K_AM_ABSOLUTE_DATA_LONG = 17;;",
          "75: let _M68K_AM_IMMEDIATE = 18;;",
          "77: (* Operand type for instruction's operands *)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "76: let _M68K_AM_BRANCH_DISPLACEMENT = 19;;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "84: let _M68K_OP_FP_DOUBLE = 5;;",
          "85: let _M68K_OP_REG_BITS = 6;;",
          "86: let _M68K_OP_REG_PAIR = 7;;",
          "88: let _M68K_CPU_SIZE_NONE = 0;;",
          "89: let _M68K_CPU_SIZE_BYTE = 1;;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "88: let _M68K_OP_BR_DISP = 8;;",
          "90: (* Operand type for instruction's operands *)",
          "92: let _M68K_OP_BR_DISP_SIZE_INVALID = 0;;",
          "93: let _M68K_OP_BR_DISP_SIZE_BYTE = 1;;",
          "94: let _M68K_OP_BR_DISP_SIZE_WORD = 2;;",
          "95: let _M68K_OP_BR_DISP_SIZE_LONG = 4;;",
          "",
          "---------------"
        ],
        "include/capstone/m68k.h||include/capstone/m68k.h": [
          "File: include/capstone/m68k.h -> include/capstone/m68k.h"
        ]
      }
    },
    {
      "candidate_hash": "958ba656e9e461df247de47f5289717e104844b3",
      "candidate_info": {
        "commit_hash": "958ba656e9e461df247de47f5289717e104844b3",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/958ba656e9e461df247de47f5289717e104844b3",
        "files": [
          "arch/ARM/ARMInstPrinter.c",
          "bindings/python/test_arm.py",
          "tests/test_arm.c"
        ],
        "message": "arm: treat ARM address as unsigned\n\nIt should be unsigned because:\n* It does arithmetic operations\n* Format strings have \"%u\" instead of \"%d\"\n\n# Conflicts:\n#\tarch/ARM/ARMInstPrinter.c\n#\tbindings/python/test_arm.py\n#\ttests/test_arm.c",
        "before_after_code_files": [
          "arch/ARM/ARMInstPrinter.c||arch/ARM/ARMInstPrinter.c",
          "bindings/python/test_arm.py||bindings/python/test_arm.py",
          "tests/test_arm.c||tests/test_arm.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/ARM/ARMInstPrinter.c||arch/ARM/ARMInstPrinter.c": [
          "File: arch/ARM/ARMInstPrinter.c -> arch/ARM/ARMInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "852:   if (ARM_rel_branch(MI->csh, opc)) {",
          "854:    if (MI->csh->mode & CS_MODE_THUMB) {",
          "856:     if (ARM_blx_to_arm_mode(MI->csh, opc)) {",
          "859:     }",
          "860:    } else {",
          "862:    }",
          "865:   } else {",
          "866:    switch(MI->flat_insn->id) {",
          "867:     default:",
          "",
          "[Removed Lines]",
          "855:     imm += (int32_t)MI->address + 4;",
          "858:      imm &= ~3;",
          "861:     imm += (int32_t)MI->address + 8;",
          "864:    printUInt32Bang(O, imm);",
          "",
          "[Added Lines]",
          "853:    uint32_t address;",
          "857:     address = (uint32_t)MI->address + 4;",
          "860:      address &= ~3;",
          "863:     address = (uint32_t)MI->address + 8;",
          "866:    printUInt32Bang(O, address + imm);",
          "",
          "---------------"
        ],
        "bindings/python/test_arm.py||bindings/python/test_arm.py": [
          "File: bindings/python/test_arm.py -> bindings/python/test_arm.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: ARM_CODE = b\"\\x86\\x48\\x60\\xf4\\xED\\xFF\\xFF\\xEB\\x04\\xe0\\x2d\\xe5\\x00\\x00\\x00\\x00\\xe0\\x83\\x22\\xe5\\xf1\\x02\\x03\\x0e\\x00\\x00\\xa0\\xe3\\x02\\x30\\xc1\\xe7\\x00\\x00\\x53\\xe3\\x00\\x02\\x01\\xf1\\x05\\x40\\xd0\\xe8\\xf4\\x80\\x00\\x00\"",
          "12: ARM_CODE2 = b\"\\xd1\\xe8\\x00\\xf0\\xf0\\x24\\x04\\x07\\x1f\\x3c\\xf2\\xc0\\x00\\x00\\x4f\\xf0\\x00\\x01\\x46\\x6c\"",
          "14: THUMB_CODE2 = b\"\\x4f\\xf0\\x00\\x01\\xbd\\xe8\\x00\\x88\\xd1\\xe8\\x00\\xf0\\x18\\xbf\\xad\\xbf\\xf3\\xff\\x0b\\x0c\\x86\\xf3\\x00\\x89\\x80\\xf3\\x00\\x8c\\x4f\\xfa\\x99\\xf6\\xd0\\xff\\xa2\\x01\"",
          "15: THUMB_MCLASS = b\"\\xef\\xf3\\x02\\x80\"",
          "16: ARMV8 = b\"\\xe0\\x3b\\xb2\\xee\\x42\\x00\\x01\\xe1\\x51\\xf0\\x7f\\xf5\"",
          "",
          "[Removed Lines]",
          "13: THUMB_CODE = b\"\\x70\\x47\\xeb\\x46\\x83\\xb0\\xc9\\x68\\x1f\\xb1\\x30\\xbf\\xaf\\xf3\\x20\\x84\\x52\\xf8\\x23\\xf0\"",
          "",
          "[Added Lines]",
          "13: THUMB_CODE = b\"\\x70\\x47\\x00\\xf0\\x10\\xe8\\xeb\\x46\\x83\\xb0\\xc9\\x68\\x1f\\xb1\\x30\\xbf\\xaf\\xf3\\x20\\x84\\x52\\xf8\\x23\\xf0\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "140:             if syntax is not None:",
          "141:                 md.syntax = syntax",
          "142:             md.detail = True",
          "144:                 print_insn_detail(insn)",
          "145:                 print ()",
          "146:         except CsError as e:",
          "",
          "[Removed Lines]",
          "143:             for insn in md.disasm(code, 0x1000):",
          "",
          "[Added Lines]",
          "143:             for insn in md.disasm(code, 0x80001000):",
          "",
          "---------------"
        ],
        "tests/test_arm.c||tests/test_arm.c": [
          "File: tests/test_arm.c -> tests/test_arm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "251: #define THUMB_CODE2 \"\\x4f\\xf0\\x00\\x01\\xbd\\xe8\\x00\\x88\\xd1\\xe8\\x00\\xf0\\x18\\xbf\\xad\\xbf\\xf3\\xff\\x0b\\x0c\\x86\\xf3\\x00\\x89\\x80\\xf3\\x00\\x8c\\x4f\\xfa\\x99\\xf6\\xd0\\xff\\xa2\\x01\"",
          "",
          "[Removed Lines]",
          "248: #define THUMB_CODE \"\\x60\\xf9\\x1f\\x04\\xe0\\xf9\\x4f\\x07\\x70\\x47\\xeb\\x46\\x83\\xb0\\xc9\\x68\\x1f\\xb1\\x30\\xbf\\xaf\\xf3\\x20\\x84\\x52\\xf8\\x23\\xf0\"",
          "",
          "[Added Lines]",
          "248: #define THUMB_CODE \"\\x60\\xf9\\x1f\\x04\\xe0\\xf9\\x4f\\x07\\x70\\x47\\x00\\xf0\\x10\\xe8\\xeb\\x46\\x83\\xb0\\xc9\\x68\\x1f\\xb1\\x30\\xbf\\xaf\\xf3\\x20\\x84\\x52\\xf8\\x23\\xf0\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "298:   },",
          "299:  };",
          "302:  cs_insn *insn;",
          "303:  int i;",
          "304:  size_t count;",
          "",
          "[Removed Lines]",
          "301:  uint64_t address = 0x1000;",
          "",
          "[Added Lines]",
          "301:  uint64_t address = 0x80001000;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c1dbc8a42ec7fe66407d5c1b7d260519fa999be7",
      "candidate_info": {
        "commit_hash": "c1dbc8a42ec7fe66407d5c1b7d260519fa999be7",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/c1dbc8a42ec7fe66407d5c1b7d260519fa999be7",
        "files": [
          "arch/Mips/MipsModule.c"
        ],
        "message": "Mips: Fix selection of disasm handler (#1022)",
        "before_after_code_files": [
          "arch/Mips/MipsModule.c||arch/Mips/MipsModule.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/Mips/MipsModule.c||arch/Mips/MipsModule.c": [
          "File: arch/Mips/MipsModule.c -> arch/Mips/MipsModule.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: #include \"MipsInstPrinter.h\"",
          "10: #include \"MipsMapping.h\"",
          "12: static cs_err init(cs_struct *ud)",
          "13: {",
          "14:  MCRegisterInfo *mri;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "13: static inline cs_mode updated_mode(cs_mode mode)",
          "14: {",
          "15:  if (mode & CS_MODE_MIPS32R6) {",
          "16:   mode |= CS_MODE_32;",
          "17:  }",
          "19:  return mode;",
          "20: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "29:  ud->insn_id = Mips_get_insn_id;",
          "30:  ud->insn_name = Mips_insn_name;",
          "31:  ud->group_name = Mips_group_name;",
          "34:  return CS_ERR_OK;",
          "35: }",
          "",
          "[Removed Lines]",
          "32:  ud->disasm = Mips_getInstruction;",
          "",
          "[Added Lines]",
          "43:  ud->mode = updated_mode(ud->mode);",
          "44:  if (ud->mode & CS_MODE_32)",
          "45:   ud->disasm = Mips_getInstruction;",
          "46:  else",
          "47:   ud->disasm = Mips64_getInstruction;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "37: static cs_err option(cs_struct *handle, cs_opt_type type, size_t value)",
          "38: {",
          "39:  if (type == CS_OPT_MODE) {",
          "40:   handle->mode = (cs_mode)value;",
          "41:   handle->big_endian = ((handle->mode & CS_MODE_BIG_ENDIAN) != 0);",
          "42:   return CS_ERR_OK;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "55:   value = updated_mode(value);",
          "56:   if (value & CS_MODE_32)",
          "57:    handle->disasm = Mips_getInstruction;",
          "58:   else",
          "59:    handle->disasm = Mips64_getInstruction;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6abcc704fd4583fc9aa4a04ceca0b3e33b104b20",
      "candidate_info": {
        "commit_hash": "6abcc704fd4583fc9aa4a04ceca0b3e33b104b20",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/6abcc704fd4583fc9aa4a04ceca0b3e33b104b20",
        "files": [
          "arch/X86/X86ATTInstPrinter.c"
        ],
        "message": "x86: fix att syntax when imm operand is 0 (#1046)",
        "before_after_code_files": [
          "arch/X86/X86ATTInstPrinter.c||arch/X86/X86ATTInstPrinter.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/X86/X86ATTInstPrinter.c||arch/X86/X86ATTInstPrinter.c": [
          "File: arch/X86/X86ATTInstPrinter.c -> arch/X86/X86ATTInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "808:     }",
          "809:    }",
          "810:   } else {",
          "813:   }",
          "814:  }",
          "",
          "[Removed Lines]",
          "811:    if (segreg)",
          "812:     SStream_concat0(O, \"0\");",
          "",
          "[Added Lines]",
          "811:             SStream_concat0(O, \"0\");",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3c49d92b9cda0881e3fb00af364b2556174bcc04",
      "candidate_info": {
        "commit_hash": "3c49d92b9cda0881e3fb00af364b2556174bcc04",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/3c49d92b9cda0881e3fb00af364b2556174bcc04",
        "files": [
          "include/platform.h",
          "myinttypes.h"
        ],
        "message": "move contents of myinttype.h to platform.h",
        "before_after_code_files": [
          "include/platform.h||include/platform.h",
          "myinttypes.h||myinttypes.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/platform.h||include/platform.h": [
          "File: include/platform.h -> include/platform.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: #include <stdbool.h>",
          "22: #endif",
          "25: #include <stdbool.h>",
          "26: #endif",
          "28: #endif",
          "",
          "[Removed Lines]",
          "24: #else // not MSVC -> C99 is supported",
          "",
          "[Added Lines]",
          "25: #else",
          "32: #if defined(CAPSTONE_HAS_OSXKERNEL) || (defined(_MSC_VER) && (_MSC_VER <= 1700 || defined(_KERNEL_MODE)))",
          "35: #if defined(_MSC_VER) && (_MSC_VER <= 1700 || defined(_KERNEL_MODE))",
          "36: typedef signed char  int8_t;",
          "37: typedef signed short int16_t;",
          "38: typedef signed int   int32_t;",
          "39: typedef unsigned char  uint8_t;",
          "40: typedef unsigned short uint16_t;",
          "41: typedef unsigned int   uint32_t;",
          "42: typedef signed long long   int64_t;",
          "43: typedef unsigned long long uint64_t;",
          "44: #endif",
          "46: #define __PRI_8_LENGTH_MODIFIER__ \"hh\"",
          "47: #define __PRI_64_LENGTH_MODIFIER__ \"ll\"",
          "49: #define PRId8         __PRI_8_LENGTH_MODIFIER__ \"d\"",
          "50: #define PRIi8         __PRI_8_LENGTH_MODIFIER__ \"i\"",
          "51: #define PRIo8         __PRI_8_LENGTH_MODIFIER__ \"o\"",
          "52: #define PRIu8         __PRI_8_LENGTH_MODIFIER__ \"u\"",
          "53: #define PRIx8         __PRI_8_LENGTH_MODIFIER__ \"x\"",
          "54: #define PRIX8         __PRI_8_LENGTH_MODIFIER__ \"X\"",
          "56: #define PRId16        \"hd\"",
          "57: #define PRIi16        \"hi\"",
          "58: #define PRIo16        \"ho\"",
          "59: #define PRIu16        \"hu\"",
          "60: #define PRIx16        \"hx\"",
          "61: #define PRIX16        \"hX\"",
          "63: #if defined(_MSC_VER) && _MSC_VER <= 1700",
          "64: #define PRId32        \"ld\"",
          "65: #define PRIi32        \"li\"",
          "66: #define PRIo32        \"lo\"",
          "67: #define PRIu32        \"lu\"",
          "68: #define PRIx32        \"lx\"",
          "69: #define PRIX32        \"lX\"",
          "70: #else // OSX",
          "71: #define PRId32        \"d\"",
          "72: #define PRIi32        \"i\"",
          "73: #define PRIo32        \"o\"",
          "74: #define PRIu32        \"u\"",
          "75: #define PRIx32        \"x\"",
          "76: #define PRIX32        \"X\"",
          "77: #endif",
          "79: #define PRId64        __PRI_64_LENGTH_MODIFIER__ \"d\"",
          "80: #define PRIi64        __PRI_64_LENGTH_MODIFIER__ \"i\"",
          "81: #define PRIo64        __PRI_64_LENGTH_MODIFIER__ \"o\"",
          "82: #define PRIu64        __PRI_64_LENGTH_MODIFIER__ \"u\"",
          "83: #define PRIx64        __PRI_64_LENGTH_MODIFIER__ \"x\"",
          "84: #define PRIX64        __PRI_64_LENGTH_MODIFIER__ \"X\"",
          "86: #else",
          "88: #include <inttypes.h>",
          "89: #endif",
          "",
          "---------------"
        ],
        "myinttypes.h||myinttypes.h": [
          "File: myinttypes.h -> myinttypes.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: #ifndef CS_MYINTTYPES_H",
          "5: #define CS_MYINTTYPES_H",
          "65: #endif",
          "",
          "[Removed Lines]",
          "7: #if defined(CAPSTONE_HAS_OSXKERNEL) || (defined(_MSC_VER) && (_MSC_VER <= 1700 || defined(_KERNEL_MODE)))",
          "10: #if defined(_MSC_VER) && (_MSC_VER <= 1700 || defined(_KERNEL_MODE))",
          "11: typedef signed char  int8_t;",
          "12: typedef signed short int16_t;",
          "13: typedef signed int   int32_t;",
          "14: typedef unsigned char  uint8_t;",
          "15: typedef unsigned short uint16_t;",
          "16: typedef unsigned int   uint32_t;",
          "17: typedef signed long long   int64_t;",
          "18: typedef unsigned long long uint64_t;",
          "19: #endif",
          "21: #define __PRI_8_LENGTH_MODIFIER__ \"hh\"",
          "22: #define __PRI_64_LENGTH_MODIFIER__ \"ll\"",
          "24: #define PRId8         __PRI_8_LENGTH_MODIFIER__ \"d\"",
          "25: #define PRIi8         __PRI_8_LENGTH_MODIFIER__ \"i\"",
          "26: #define PRIo8         __PRI_8_LENGTH_MODIFIER__ \"o\"",
          "27: #define PRIu8         __PRI_8_LENGTH_MODIFIER__ \"u\"",
          "28: #define PRIx8         __PRI_8_LENGTH_MODIFIER__ \"x\"",
          "29: #define PRIX8         __PRI_8_LENGTH_MODIFIER__ \"X\"",
          "31: #define PRId16        \"hd\"",
          "32: #define PRIi16        \"hi\"",
          "33: #define PRIo16        \"ho\"",
          "34: #define PRIu16        \"hu\"",
          "35: #define PRIx16        \"hx\"",
          "36: #define PRIX16        \"hX\"",
          "38: #if defined(_MSC_VER) && _MSC_VER <= 1700",
          "39: #define PRId32        \"ld\"",
          "40: #define PRIi32        \"li\"",
          "41: #define PRIo32        \"lo\"",
          "42: #define PRIu32        \"lu\"",
          "43: #define PRIx32        \"lx\"",
          "44: #define PRIX32        \"lX\"",
          "45: #else // OSX",
          "46: #define PRId32        \"d\"",
          "47: #define PRIi32        \"i\"",
          "48: #define PRIo32        \"o\"",
          "49: #define PRIu32        \"u\"",
          "50: #define PRIx32        \"x\"",
          "51: #define PRIX32        \"X\"",
          "52: #endif",
          "54: #define PRId64        __PRI_64_LENGTH_MODIFIER__ \"d\"",
          "55: #define PRIi64        __PRI_64_LENGTH_MODIFIER__ \"i\"",
          "56: #define PRIo64        __PRI_64_LENGTH_MODIFIER__ \"o\"",
          "57: #define PRIu64        __PRI_64_LENGTH_MODIFIER__ \"u\"",
          "58: #define PRIx64        __PRI_64_LENGTH_MODIFIER__ \"x\"",
          "59: #define PRIX64        __PRI_64_LENGTH_MODIFIER__ \"X\"",
          "61: #else // this system has inttypes.h by default",
          "62: #include <inttypes.h>",
          "63: #endif",
          "",
          "[Added Lines]",
          "8: #include <platform.h>",
          "",
          "---------------"
        ]
      }
    }
  ]
}