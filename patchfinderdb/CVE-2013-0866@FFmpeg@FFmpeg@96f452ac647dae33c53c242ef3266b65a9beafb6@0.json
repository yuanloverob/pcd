{
  "cve_id": "CVE-2013-0866",
  "cve_desc": "The aac_decode_init function in libavcodec/aacdec.c in FFmpeg before 1.0.4 and 1.1.x before 1.1.2 allows remote attackers to have an unspecified impact via a large number of channels in an AAC file, which triggers an out-of-bounds array access.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "96f452ac647dae33c53c242ef3266b65a9beafb6",
  "patch_info": {
    "commit_hash": "96f452ac647dae33c53c242ef3266b65a9beafb6",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/96f452ac647dae33c53c242ef3266b65a9beafb6",
    "files": [
      "libavcodec/aacdec.c"
    ],
    "message": "aacdec: check channel count\n\nPrevent out of array accesses\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "before_after_code_files": [
      "libavcodec/aacdec.c||libavcodec/aacdec.c"
    ]
  },
  "patch_diff": {
    "libavcodec/aacdec.c||libavcodec/aacdec.c": [
      "File: libavcodec/aacdec.c -> libavcodec/aacdec.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "914:         }",
      "915:     }",
      "917:     AAC_INIT_VLC_STATIC( 0, 304);",
      "918:     AAC_INIT_VLC_STATIC( 1, 270);",
      "919:     AAC_INIT_VLC_STATIC( 2, 550);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "917:     if (avctx->channels > MAX_CHANNELS) {",
      "918:         av_log(avctx, AV_LOG_ERROR, \"Too many channels\\n\");",
      "919:         return AVERROR_INVALIDDATA;",
      "920:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e6ac11e41734cbb24ec5e6c73264d030e5f07a64",
      "candidate_info": {
        "commit_hash": "e6ac11e41734cbb24ec5e6c73264d030e5f07a64",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/e6ac11e41734cbb24ec5e6c73264d030e5f07a64",
        "files": [
          "libavcodec/aacdec.c"
        ],
        "message": "aacdec: check channel count\n\nPrevent out of array accesses\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 96f452ac647dae33c53c242ef3266b65a9beafb6)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/aacdec.c||libavcodec/aacdec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/aacdec.c||libavcodec/aacdec.c"
          ],
          "candidate": [
            "libavcodec/aacdec.c||libavcodec/aacdec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/aacdec.c||libavcodec/aacdec.c": [
          "File: libavcodec/aacdec.c -> libavcodec/aacdec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "568:         output_scale_factor = 1.0;",
          "569:     }",
          "571:     AAC_INIT_VLC_STATIC( 0, 304);",
          "572:     AAC_INIT_VLC_STATIC( 1, 270);",
          "573:     AAC_INIT_VLC_STATIC( 2, 550);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "571:     if (avctx->channels > MAX_CHANNELS) {",
          "572:         av_log(avctx, AV_LOG_ERROR, \"Too many channels\\n\");",
          "573:         return AVERROR_INVALIDDATA;",
          "574:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "47e462eecc0a47ad40f59376199f93f227e21d13",
      "candidate_info": {
        "commit_hash": "47e462eecc0a47ad40f59376199f93f227e21d13",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/47e462eecc0a47ad40f59376199f93f227e21d13",
        "files": [
          "libavcodec/aacdec.c"
        ],
        "message": "aacdec: check channel count\n\nPrevent out of array accesses\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 96f452ac647dae33c53c242ef3266b65a9beafb6)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/aacdec.c||libavcodec/aacdec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/aacdec.c||libavcodec/aacdec.c"
          ],
          "candidate": [
            "libavcodec/aacdec.c||libavcodec/aacdec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/aacdec.c||libavcodec/aacdec.c": [
          "File: libavcodec/aacdec.c -> libavcodec/aacdec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "914:         }",
          "915:     }",
          "917:     AAC_INIT_VLC_STATIC( 0, 304);",
          "918:     AAC_INIT_VLC_STATIC( 1, 270);",
          "919:     AAC_INIT_VLC_STATIC( 2, 550);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "917:     if (avctx->channels > MAX_CHANNELS) {",
          "918:         av_log(avctx, AV_LOG_ERROR, \"Too many channels\\n\");",
          "919:         return AVERROR_INVALIDDATA;",
          "920:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c459c7b23efffab762560e41ad6a2c0dbbfd4915",
      "candidate_info": {
        "commit_hash": "c459c7b23efffab762560e41ad6a2c0dbbfd4915",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/c459c7b23efffab762560e41ad6a2c0dbbfd4915",
        "files": [
          "libavcodec/aacdec.c"
        ],
        "message": "aacdec: check channel count\n\nPrevent out of array accesses\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 96f452ac647dae33c53c242ef3266b65a9beafb6)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
        "before_after_code_files": [
          "libavcodec/aacdec.c||libavcodec/aacdec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/aacdec.c||libavcodec/aacdec.c"
          ],
          "candidate": [
            "libavcodec/aacdec.c||libavcodec/aacdec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/aacdec.c||libavcodec/aacdec.c": [
          "File: libavcodec/aacdec.c -> libavcodec/aacdec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "883:         }",
          "884:     }",
          "886:     AAC_INIT_VLC_STATIC( 0, 304);",
          "887:     AAC_INIT_VLC_STATIC( 1, 270);",
          "888:     AAC_INIT_VLC_STATIC( 2, 550);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "886:     if (avctx->channels > MAX_CHANNELS) {",
          "887:         av_log(avctx, AV_LOG_ERROR, \"Too many channels\\n\");",
          "888:         return AVERROR_INVALIDDATA;",
          "889:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}