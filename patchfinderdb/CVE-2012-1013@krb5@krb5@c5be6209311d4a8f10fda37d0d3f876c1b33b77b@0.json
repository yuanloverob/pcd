{
  "cve_id": "CVE-2012-1013",
  "cve_desc": "The check_1_6_dummy function in lib/kadm5/srv/svr_principal.c in kadmind in MIT Kerberos 5 (aka krb5) 1.8.x, 1.9.x, and 1.10.x before 1.10.2 allows remote authenticated administrators to cause a denial of service (NULL pointer dereference and daemon crash) via a KRB5_KDB_DISALLOW_ALL_TIX create request that lacks a password.",
  "repo": "krb5/krb5",
  "patch_hash": "c5be6209311d4a8f10fda37d0d3f876c1b33b77b",
  "patch_info": {
    "commit_hash": "c5be6209311d4a8f10fda37d0d3f876c1b33b77b",
    "repo": "krb5/krb5",
    "commit_url": "https://github.com/krb5/krb5/commit/c5be6209311d4a8f10fda37d0d3f876c1b33b77b",
    "files": [
      "src/lib/kadm5/srv/svr_principal.c"
    ],
    "message": "Null pointer deref in kadmind [CVE-2012-1013]\n\nThe fix for #6626 could cause kadmind to dereference a null pointer if\na create-principal request contains no password but does contain the\nKRB5_KDB_DISALLOW_ALL_TIX flag (e.g. \"addprinc -randkey -allow_tix\nname\").  Only clients authorized to create principals can trigger the\nbug.  Fix the bug by testing for a null password in check_1_6_dummy.\n\nCVSSv2 vector: AV:N/AC:M/Au:S/C:N/I:N/A:P/E:H/RL:O/RC:C\n\n[ghudson@mit.edu: Minor style change and commit message]\n\nticket: 7152\ntarget_version: 1.10.2\ntags: pullup",
    "before_after_code_files": [
      "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
    ]
  },
  "patch_diff": {
    "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c": [
      "File: src/lib/kadm5/srv/svr_principal.c -> src/lib/kadm5/srv/svr_principal.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "186:     char *password = *passptr;",
      "190:         !(entry->attributes & KRB5_KDB_DISALLOW_ALL_TIX))",
      "191:         return;",
      "",
      "[Removed Lines]",
      "189:     if (!(mask & KADM5_ATTRIBUTES) ||",
      "",
      "[Added Lines]",
      "189:     if (password == NULL || !(mask & KADM5_ATTRIBUTES) ||",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ca2909440015d33be42e77d1955194963d8c0955",
      "candidate_info": {
        "commit_hash": "ca2909440015d33be42e77d1955194963d8c0955",
        "repo": "krb5/krb5",
        "commit_url": "https://github.com/krb5/krb5/commit/ca2909440015d33be42e77d1955194963d8c0955",
        "files": [
          "src/lib/kadm5/srv/svr_principal.c"
        ],
        "message": "Null pointer deref in kadmind [CVE-2012-1013]\n\nThe fix for #6626 could cause kadmind to dereference a null pointer if\na create-principal request contains no password but does contain the\nKRB5_KDB_DISALLOW_ALL_TIX flag (e.g. \"addprinc -randkey -allow_tix\nname\").  Only clients authorized to create principals can trigger the\nbug.  Fix the bug by testing for a null password in check_1_6_dummy.\n\nCVSSv2 vector: AV:N/AC:M/Au:S/C:N/I:N/A:P/E:H/RL:O/RC:C\n\n[ghudson@mit.edu: Minor style change and commit message]\n\n(cherry picked from commit c5be6209311d4a8f10fda37d0d3f876c1b33b77b)\n\nticket: 7152\nversion_fixed: 1.10.2\nstatus: resolved",
        "before_after_code_files": [
          "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
          ],
          "candidate": [
            "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
          ]
        }
      },
      "candidate_diff": {
        "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c": [
          "File: src/lib/kadm5/srv/svr_principal.c -> src/lib/kadm5/srv/svr_principal.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "187:     char *password = *passptr;",
          "191:         !(entry->attributes & KRB5_KDB_DISALLOW_ALL_TIX))",
          "192:         return;",
          "",
          "[Removed Lines]",
          "190:     if (!(mask & KADM5_ATTRIBUTES) ||",
          "",
          "[Added Lines]",
          "190:     if (password == NULL || !(mask & KADM5_ATTRIBUTES) ||",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f7d42a08d9a4e4559e3efa3ed199927407be658e",
      "candidate_info": {
        "commit_hash": "f7d42a08d9a4e4559e3efa3ed199927407be658e",
        "repo": "krb5/krb5",
        "commit_url": "https://github.com/krb5/krb5/commit/f7d42a08d9a4e4559e3efa3ed199927407be658e",
        "files": [
          "src/lib/kadm5/srv/svr_principal.c"
        ],
        "message": "Null pointer deref in kadmind [CVE-2012-1013]\n\nThe fix for #6626 could cause kadmind to dereference a null pointer if\na create-principal request contains no password but does contain the\nKRB5_KDB_DISALLOW_ALL_TIX flag (e.g. \"addprinc -randkey -allow_tix\nname\").  Only clients authorized to create principals can trigger the\nbug.  Fix the bug by testing for a null password in check_1_6_dummy.\n\nCVSSv2 vector: AV:N/AC:M/Au:S/C:N/I:N/A:P/E:H/RL:O/RC:C\n\n[ghudson@mit.edu: Minor style change and commit message]\n\n(cherry picked from commit c5be6209311d4a8f10fda37d0d3f876c1b33b77b)\n\nticket: 7168 (new)\nversion_fixed: 1.9.4\nstatus: resolved",
        "before_after_code_files": [
          "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
          ],
          "candidate": [
            "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
          ]
        }
      },
      "candidate_diff": {
        "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c": [
          "File: src/lib/kadm5/srv/svr_principal.c -> src/lib/kadm5/srv/svr_principal.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "194:     char *password = *passptr;",
          "198:         !(entry->attributes & KRB5_KDB_DISALLOW_ALL_TIX))",
          "199:         return;",
          "",
          "[Removed Lines]",
          "197:     if (!(mask & KADM5_ATTRIBUTES) ||",
          "",
          "[Added Lines]",
          "197:     if (password == NULL || !(mask & KADM5_ATTRIBUTES) ||",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0b11a472cf0e83972228ad9ca6ee645e4ffd4c24",
      "candidate_info": {
        "commit_hash": "0b11a472cf0e83972228ad9ca6ee645e4ffd4c24",
        "repo": "krb5/krb5",
        "commit_url": "https://github.com/krb5/krb5/commit/0b11a472cf0e83972228ad9ca6ee645e4ffd4c24",
        "files": [
          "src/lib/kadm5/srv/svr_principal.c"
        ],
        "message": "Null pointer deref in kadmind [CVE-2012-1013]\n\nThe fix for #6626 could cause kadmind to dereference a null pointer if\na create-principal request contains no password but does contain the\nKRB5_KDB_DISALLOW_ALL_TIX flag (e.g. \"addprinc -randkey -allow_tix\nname\").  Only clients authorized to create principals can trigger the\nbug.  Fix the bug by testing for a null password in check_1_6_dummy.\n\nCVSSv2 vector: AV:N/AC:M/Au:S/C:N/I:N/A:P/E:H/RL:O/RC:C\n\n[ghudson@mit.edu: Minor style change and commit message]\n\n(cherry picked from commit c5be6209311d4a8f10fda37d0d3f876c1b33b77b)\n\nticket: 7178 (new)\nversion_fixed: 1.8.7\nstatus: resolved",
        "before_after_code_files": [
          "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "olp_code_files": {
          "patch": [
            "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
          ],
          "candidate": [
            "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c"
          ]
        }
      },
      "candidate_diff": {
        "src/lib/kadm5/srv/svr_principal.c||src/lib/kadm5/srv/svr_principal.c": [
          "File: src/lib/kadm5/srv/svr_principal.c -> src/lib/kadm5/srv/svr_principal.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "196:     char *password = *passptr;",
          "200:         !(entry->attributes & KRB5_KDB_DISALLOW_ALL_TIX))",
          "201:         return;",
          "",
          "[Removed Lines]",
          "199:     if (!(mask & KADM5_ATTRIBUTES) ||",
          "",
          "[Added Lines]",
          "199:     if (password == NULL || !(mask & KADM5_ATTRIBUTES) ||",
          "",
          "---------------"
        ]
      }
    }
  ]
}