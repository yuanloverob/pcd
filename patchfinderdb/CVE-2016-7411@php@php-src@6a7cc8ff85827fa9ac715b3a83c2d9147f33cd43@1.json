{
  "cve_id": "CVE-2016-7411",
  "cve_desc": "ext/standard/var_unserializer.re in PHP before 5.6.26 mishandles object-deserialization failures, which allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via an unserialize call that references a partially constructed object.",
  "repo": "php/php-src",
  "patch_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
  "patch_info": {
    "commit_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
    "files": [
      "Zend/zend_objects_API.c",
      "ext/standard/tests/serialize/bug73052.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #73052 - Memory Corruption in During Deserialized-object Destruction",
    "before_after_code_files": [
      "Zend/zend_objects_API.c||Zend/zend_objects_API.c",
      "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "Zend/zend_objects_API.c||Zend/zend_objects_API.c": [
      "File: Zend/zend_objects_API.c -> Zend/zend_objects_API.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "306: {",
      "307:  zend_object_handle handle = Z_OBJ_HANDLE_P(zobject);",
      "308:  zend_object_store_bucket *obj_bucket = &EG(objects_store).object_buckets[handle];",
      "311:  obj_bucket->destructor_called = 1;",
      "312: }",
      "",
      "[Removed Lines]",
      "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);;",
      "",
      "[Added Lines]",
      "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);",
      "",
      "---------------"
    ],
    "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt": [
      "File: ext/standard/tests/serialize/bug73052.phpt -> ext/standard/tests/serialize/bug73052.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73052: Memory Corruption in During Deserialized-object Destruction",
      "3: --FILE--",
      "4: <?php",
      "6: class obj {",
      "7:     var $ryat;",
      "8:     public function __destruct() {",
      "9:         $this->ryat = null;",
      "10:     }",
      "11: }",
      "13: $poc = 'O:3:\"obj\":1:{';",
      "14: var_dump(unserialize($poc));",
      "15: ?>",
      "16: --EXPECTF--",
      "17: Notice: unserialize(): Error at offset 13 of 13 bytes in %sbug73052.php on line %d",
      "18: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "438:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
      "439:         zend_hash_clean(Z_OBJPROP_PP(rval));",
      "440:      }",
      "441:      ZVAL_NULL(*rval);",
      "442:   return 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "440:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "495: {",
      "496:  YYCTYPE yych;",
      "497:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "494: #line 495 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "495: #line 496 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "551:  yych = *(YYMARKER = ++YYCURSOR);",
      "552:  if (yych == ':') goto yy95;",
      "553: yy3:",
      "555:  { return 0; }",
      "557: yy4:",
      "558:  yych = *(YYMARKER = ++YYCURSOR);",
      "559:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "554: #line 860 \"ext/standard/var_unserializer.re\"",
      "556: #line 557 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "555: #line 861 \"ext/standard/var_unserializer.re\"",
      "557: #line 558 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "596:  goto yy3;",
      "597: yy14:",
      "598:  ++YYCURSOR;",
      "600:  {",
      "602:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "604: }",
      "606: yy16:",
      "607:  yych = *++YYCURSOR;",
      "608:  goto yy3;",
      "",
      "[Removed Lines]",
      "599: #line 854 \"ext/standard/var_unserializer.re\"",
      "605: #line 606 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "600: #line 855 \"ext/standard/var_unserializer.re\"",
      "606: #line 607 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "633:  yych = *++YYCURSOR;",
      "634:  if (yych != '\"') goto yy18;",
      "635:  ++YYCURSOR;",
      "637:  {",
      "638:  size_t len, len2, len3, maxlen;",
      "639:  long elements;",
      "",
      "[Removed Lines]",
      "636: #line 707 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "637: #line 708 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "781:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "782: }",
      "784: yy25:",
      "785:  yych = *++YYCURSOR;",
      "786:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "783: #line 784 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "784: #line 785 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "805:  yych = *++YYCURSOR;",
      "806:  if (yych != '\"') goto yy18;",
      "807:  ++YYCURSOR;",
      "809:  {",
      "810:     if (!var_hash) return 0;",
      "",
      "[Removed Lines]",
      "808: #line 698 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "809: #line 699 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "814:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "815:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "816: }",
      "818: yy32:",
      "819:  yych = *++YYCURSOR;",
      "820:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "817: #line 818 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "818: #line 819 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "835:  yych = *++YYCURSOR;",
      "836:  if (yych != '{') goto yy18;",
      "837:  ++YYCURSOR;",
      "839:  {",
      "840:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "838: #line 677 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "839: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "857:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "858: }",
      "860: yy39:",
      "861:  yych = *++YYCURSOR;",
      "862:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "859: #line 860 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "860: #line 861 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "877:  yych = *++YYCURSOR;",
      "878:  if (yych != '\"') goto yy18;",
      "879:  ++YYCURSOR;",
      "881:  {",
      "882:  size_t len, maxlen;",
      "883:  char *str;",
      "",
      "[Removed Lines]",
      "880: #line 642 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "881: #line 643 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "912:  ZVAL_STRINGL(*rval, str, len, 0);",
      "913:  return 1;",
      "914: }",
      "916: yy46:",
      "917:  yych = *++YYCURSOR;",
      "918:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "915: #line 916 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "916: #line 917 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "933:  yych = *++YYCURSOR;",
      "934:  if (yych != '\"') goto yy18;",
      "935:  ++YYCURSOR;",
      "937:  {",
      "938:  size_t len, maxlen;",
      "939:  char *str;",
      "",
      "[Removed Lines]",
      "936: #line 609 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "937: #line 610 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "966:  ZVAL_STRINGL(*rval, str, len, 1);",
      "967:  return 1;",
      "968: }",
      "970: yy53:",
      "971:  yych = *++YYCURSOR;",
      "972:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "969: #line 970 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "970: #line 971 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1054:  }",
      "1055: yy63:",
      "1056:  ++YYCURSOR;",
      "1058:  {",
      "1059: #if SIZEOF_LONG == 4",
      "1060: use_double:",
      "",
      "[Removed Lines]",
      "1057: #line 599 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1058: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1064:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1065:  return 1;",
      "1066: }",
      "1068: yy65:",
      "1069:  yych = *++YYCURSOR;",
      "1070:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1067: #line 1068 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1123:  yych = *++YYCURSOR;",
      "1124:  if (yych != ';') goto yy18;",
      "1125:  ++YYCURSOR;",
      "1127:  {",
      "1129:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1126: #line 584 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1127: #line 585 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1139:  return 1;",
      "1140: }",
      "1142: yy76:",
      "1143:  yych = *++YYCURSOR;",
      "1144:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1141: #line 1142 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1165:  if (yych <= '9') goto yy79;",
      "1166:  if (yych != ';') goto yy18;",
      "1167:  ++YYCURSOR;",
      "1169:  {",
      "1170: #if SIZEOF_LONG == 4",
      "1171:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1168: #line 557 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1169: #line 558 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1192:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1193:  return 1;",
      "1194: }",
      "1196: yy83:",
      "1197:  yych = *++YYCURSOR;",
      "1198:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1195: #line 1196 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1200:  yych = *++YYCURSOR;",
      "1201:  if (yych != ';') goto yy18;",
      "1202:  ++YYCURSOR;",
      "1204:  {",
      "1206:  INIT_PZVAL(*rval);",
      "1207:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1208:  return 1;",
      "1209: }",
      "1211: yy87:",
      "1212:  ++YYCURSOR;",
      "1214:  {",
      "1216:  INIT_PZVAL(*rval);",
      "1217:  ZVAL_NULL(*rval);",
      "1218:  return 1;",
      "1219: }",
      "1221: yy89:",
      "1222:  yych = *++YYCURSOR;",
      "1223:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1203: #line 550 \"ext/standard/var_unserializer.re\"",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "1213: #line 543 \"ext/standard/var_unserializer.re\"",
      "1220: #line 1221 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1204: #line 551 \"ext/standard/var_unserializer.re\"",
      "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
      "1214: #line 544 \"ext/standard/var_unserializer.re\"",
      "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1240:  if (yych <= '9') goto yy91;",
      "1241:  if (yych != ';') goto yy18;",
      "1242:  ++YYCURSOR;",
      "1244:  {",
      "1245:  long id;",
      "",
      "[Removed Lines]",
      "1243: #line 520 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1244: #line 521 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1264:  return 1;",
      "1265: }",
      "1267: yy95:",
      "1268:  yych = *++YYCURSOR;",
      "1269:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1266: #line 1267 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1286:  if (yych <= '9') goto yy97;",
      "1287:  if (yych != ';') goto yy18;",
      "1288:  ++YYCURSOR;",
      "1290:  {",
      "1291:  long id;",
      "",
      "[Removed Lines]",
      "1289: #line 499 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1290: #line 500 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1308:  return 1;",
      "1309: }",
      "1311: }",
      "1315:  return 0;",
      "",
      "[Removed Lines]",
      "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
      "1312: #line 862 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
      "1313: #line 863 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "442:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
      "443:         zend_hash_clean(Z_OBJPROP_PP(rval));",
      "444:      }",
      "445:      ZVAL_NULL(*rval);",
      "446:   return 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "444:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "d76b293ac71aa5bd4e9a433192afef6e0dd5a4ee",
      "candidate_info": {
        "commit_hash": "d76b293ac71aa5bd4e9a433192afef6e0dd5a4ee",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/d76b293ac71aa5bd4e9a433192afef6e0dd5a4ee",
        "files": [
          "ext/standard/var_unserializer.c"
        ],
        "message": "forgot to commit this one",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "392:    return 0;",
          "393:   }",
          "395:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "396:    (*p)--;",
          "397:    return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "395:   var_push_dtor(var_hash, data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "522:  start = cursor;",
          "526: {",
          "527:  YYCTYPE yych;",
          "528:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "525: #line 526 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "527: #line 528 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "582:  yych = *(YYMARKER = ++YYCURSOR);",
          "583:  if (yych == ':') goto yy95;",
          "584: yy3:",
          "586:  { return 0; }",
          "588: yy4:",
          "589:  yych = *(YYMARKER = ++YYCURSOR);",
          "590:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "585: #line 873 \"ext/standard/var_unserializer.re\"",
          "587: #line 588 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "587: #line 875 \"ext/standard/var_unserializer.re\"",
          "589: #line 590 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "627:  goto yy3;",
          "628: yy14:",
          "629:  ++YYCURSOR;",
          "631:  {",
          "633:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "635: }",
          "637: yy16:",
          "638:  yych = *++YYCURSOR;",
          "639:  goto yy3;",
          "",
          "[Removed Lines]",
          "630: #line 867 \"ext/standard/var_unserializer.re\"",
          "636: #line 637 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "632: #line 869 \"ext/standard/var_unserializer.re\"",
          "638: #line 639 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "659:  if (yybm[0+yych] & 128) {",
          "660:   goto yy20;",
          "661:  }",
          "663:  yych = *++YYCURSOR;",
          "664:  if (yych != '\"') goto yy18;",
          "665:  ++YYCURSOR;",
          "667:  {",
          "668:  size_t len, len2, len3, maxlen;",
          "669:  zend_long elements;",
          "",
          "[Removed Lines]",
          "662:  if (yych != ':') goto yy18;",
          "666: #line 722 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "664:  if (yych <= '/') goto yy18;",
          "665:  if (yych >= ';') goto yy18;",
          "669: #line 724 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "809:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "810: }",
          "812: yy25:",
          "813:  yych = *++YYCURSOR;",
          "814:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "811: #line 812 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "814: #line 815 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "833:  yych = *++YYCURSOR;",
          "834:  if (yych != '\"') goto yy18;",
          "835:  ++YYCURSOR;",
          "837:  {",
          "",
          "[Removed Lines]",
          "836: #line 714 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "839: #line 716 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "841:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "842:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "843: }",
          "845: yy32:",
          "846:  yych = *++YYCURSOR;",
          "847:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "844: #line 845 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "847: #line 848 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "862:  yych = *++YYCURSOR;",
          "863:  if (yych != '{') goto yy18;",
          "864:  ++YYCURSOR;",
          "866:  {",
          "867:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "865: #line 693 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "868: #line 695 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "884:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "885: }",
          "887: yy39:",
          "888:  yych = *++YYCURSOR;",
          "889:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "886: #line 887 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "889: #line 890 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "904:  yych = *++YYCURSOR;",
          "905:  if (yych != '\"') goto yy18;",
          "906:  ++YYCURSOR;",
          "908:  {",
          "909:  size_t len, maxlen;",
          "910:  zend_string *str;",
          "",
          "[Removed Lines]",
          "907: #line 665 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "910: #line 667 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "932:  ZVAL_STR(rval, str);",
          "933:  return 1;",
          "934: }",
          "936: yy46:",
          "937:  yych = *++YYCURSOR;",
          "938:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "935: #line 936 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "938: #line 939 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "953:  yych = *++YYCURSOR;",
          "954:  if (yych != '\"') goto yy18;",
          "955:  ++YYCURSOR;",
          "957:  {",
          "958:  size_t len, maxlen;",
          "959:  char *str;",
          "",
          "[Removed Lines]",
          "956: #line 638 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "959: #line 640 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "980:  ZVAL_STRINGL(rval, str, len);",
          "981:  return 1;",
          "982: }",
          "984: yy53:",
          "985:  yych = *++YYCURSOR;",
          "986:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "983: #line 984 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "986: #line 987 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1068:  }",
          "1069: yy63:",
          "1070:  ++YYCURSOR;",
          "1072:  {",
          "1073: #if SIZEOF_ZEND_LONG == 4",
          "1074: use_double:",
          "",
          "[Removed Lines]",
          "1071: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1074: #line 631 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1077:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1078:  return 1;",
          "1079: }",
          "1081: yy65:",
          "1082:  yych = *++YYCURSOR;",
          "1083:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1080: #line 1081 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1083: #line 1084 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1136:  yych = *++YYCURSOR;",
          "1137:  if (yych != ';') goto yy18;",
          "1138:  ++YYCURSOR;",
          "1140:  {",
          "",
          "[Removed Lines]",
          "1139: #line 613 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1142: #line 615 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1153:  return 1;",
          "1154: }",
          "1156: yy76:",
          "1157:  yych = *++YYCURSOR;",
          "1158:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1155: #line 1156 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1158: #line 1159 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1179:  if (yych <= '9') goto yy79;",
          "1180:  if (yych != ';') goto yy18;",
          "1181:  ++YYCURSOR;",
          "1183:  {",
          "1184: #if SIZEOF_ZEND_LONG == 4",
          "1185:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1182: #line 587 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1185: #line 589 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1205:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1206:  return 1;",
          "1207: }",
          "1209: yy83:",
          "1210:  yych = *++YYCURSOR;",
          "1211:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1208: #line 1209 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1213:  yych = *++YYCURSOR;",
          "1214:  if (yych != ';') goto yy18;",
          "1215:  ++YYCURSOR;",
          "1217:  {",
          "1219:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1220:  return 1;",
          "1221: }",
          "1223: yy87:",
          "1224:  ++YYCURSOR;",
          "1226:  {",
          "1228:  ZVAL_NULL(rval);",
          "1229:  return 1;",
          "1230: }",
          "1232: yy89:",
          "1233:  yych = *++YYCURSOR;",
          "1234:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1216: #line 581 \"ext/standard/var_unserializer.re\"",
          "1222: #line 1223 \"ext/standard/var_unserializer.c\"",
          "1225: #line 575 \"ext/standard/var_unserializer.re\"",
          "1231: #line 1232 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1219: #line 583 \"ext/standard/var_unserializer.re\"",
          "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
          "1228: #line 577 \"ext/standard/var_unserializer.re\"",
          "1234: #line 1235 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1251:  if (yych <= '9') goto yy91;",
          "1252:  if (yych != ';') goto yy18;",
          "1253:  ++YYCURSOR;",
          "1255:  {",
          "1256:  zend_long id;",
          "",
          "[Removed Lines]",
          "1254: #line 552 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1257: #line 554 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1275:  return 1;",
          "1276: }",
          "1278: yy95:",
          "1279:  yych = *++YYCURSOR;",
          "1280:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1280: #line 1281 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1297:  if (yych <= '9') goto yy97;",
          "1298:  if (yych != ';') goto yy18;",
          "1299:  ++YYCURSOR;",
          "1301:  {",
          "1302:  zend_long id;",
          "",
          "[Removed Lines]",
          "1300: #line 530 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1303: #line 532 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1320:  return 1;",
          "1321: }",
          "1323: }",
          "1327:  return 0;",
          "",
          "[Removed Lines]",
          "1322: #line 1323 \"ext/standard/var_unserializer.c\"",
          "1324: #line 875 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1325: #line 1326 \"ext/standard/var_unserializer.c\"",
          "1327: #line 877 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
      "candidate_info": {
        "commit_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/16b3003ffc6393e250f069aa28a78dc5a2c064b2",
        "files": [
          "ext/standard/tests/serialize/bug73825.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fix bug #73825 - Heap out of bounds read on unserialize in finish_nested_data()",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt": [
          "File: ext/standard/tests/serialize/bug73825.phpt -> ext/standard/tests/serialize/bug73825.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73825 Heap out of bounds read on unserialize in finish_nested_data()",
          "3: --FILE--",
          "4: <?php",
          "5: $obj = unserialize('O:8:\"00000000\":');",
          "6: var_dump($obj);",
          "7: ?>",
          "8: --EXPECTF--",
          "9: Warning: Bad unserialize data in %sbug73825.php on line %d",
          "11: Notice: unserialize(): Error at offset 13 of 15 bytes in %sbug73825.php on line %d",
          "12: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "405: {",
          "406:  long elements;",
          "408:  elements = parse_iv2((*p) + 2, p);",
          "410:  (*p) += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "408:  if( *p >= max - 2) {",
          "409:   zend_error(E_WARNING, \"Bad unserialize data\");",
          "410:   return -1;",
          "411:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "417:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
          "419:  }",
          "421:  return elements;",
          "",
          "[Removed Lines]",
          "418:   return 0;",
          "",
          "[Added Lines]",
          "423:   return -1;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "496: {",
          "497:  YYCTYPE yych;",
          "498:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "495: #line 496 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "500: #line 501 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "552:  yych = *(YYMARKER = ++YYCURSOR);",
          "553:  if (yych == ':') goto yy95;",
          "554: yy3:",
          "556:  { return 0; }",
          "558: yy4:",
          "559:  yych = *(YYMARKER = ++YYCURSOR);",
          "560:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "555: #line 861 \"ext/standard/var_unserializer.re\"",
          "557: #line 558 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "560: #line 875 \"ext/standard/var_unserializer.re\"",
          "562: #line 563 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "597:  goto yy3;",
          "598: yy14:",
          "599:  ++YYCURSOR;",
          "601:  {",
          "603:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "605: }",
          "607: yy16:",
          "608:  yych = *++YYCURSOR;",
          "609:  goto yy3;",
          "",
          "[Removed Lines]",
          "600: #line 855 \"ext/standard/var_unserializer.re\"",
          "606: #line 607 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "605: #line 869 \"ext/standard/var_unserializer.re\"",
          "611: #line 612 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "634:  yych = *++YYCURSOR;",
          "635:  if (yych != '\"') goto yy18;",
          "636:  ++YYCURSOR;",
          "638:  {",
          "639:  size_t len, len2, len3, maxlen;",
          "640:  long elements;",
          "",
          "[Removed Lines]",
          "637: #line 708 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "642: #line 717 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "775:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "777:  if (incomplete_class) {",
          "778:   php_store_class_name(*rval, class_name, len2);",
          "779:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "782:  if (elements < 0) {",
          "783:     efree(class_name);",
          "784:     return 0;",
          "785:  }",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "782:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "783: }",
          "785: yy25:",
          "786:  yych = *++YYCURSOR;",
          "787:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "784: #line 785 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "794: #line 795 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "806:  yych = *++YYCURSOR;",
          "807:  if (yych != '\"') goto yy18;",
          "808:  ++YYCURSOR;",
          "810:  {",
          "811:     if (!var_hash) return 0;",
          "813:  INIT_PZVAL(*rval);",
          "817: }",
          "819: yy32:",
          "820:  yych = *++YYCURSOR;",
          "821:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "809: #line 699 \"ext/standard/var_unserializer.re\"",
          "815:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "816:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "818: #line 819 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "819: #line 704 \"ext/standard/var_unserializer.re\"",
          "821:  long elements;",
          "826:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "827:  if (elements < 0) {",
          "828:   return 0;",
          "829:  }",
          "830:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "832: #line 833 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "836:  yych = *++YYCURSOR;",
          "837:  if (yych != '{') goto yy18;",
          "838:  ++YYCURSOR;",
          "840:  {",
          "841:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "839: #line 678 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "853: #line 683 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "858:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "859: }",
          "861: yy39:",
          "862:  yych = *++YYCURSOR;",
          "863:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "860: #line 861 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "874: #line 875 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "878:  yych = *++YYCURSOR;",
          "879:  if (yych != '\"') goto yy18;",
          "880:  ++YYCURSOR;",
          "882:  {",
          "883:  size_t len, maxlen;",
          "884:  char *str;",
          "",
          "[Removed Lines]",
          "881: #line 643 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "895: #line 648 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "913:  ZVAL_STRINGL(*rval, str, len, 0);",
          "914:  return 1;",
          "915: }",
          "917: yy46:",
          "918:  yych = *++YYCURSOR;",
          "919:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "916: #line 917 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "930: #line 931 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "934:  yych = *++YYCURSOR;",
          "935:  if (yych != '\"') goto yy18;",
          "936:  ++YYCURSOR;",
          "938:  {",
          "939:  size_t len, maxlen;",
          "940:  char *str;",
          "",
          "[Removed Lines]",
          "937: #line 610 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "951: #line 615 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "967:  ZVAL_STRINGL(*rval, str, len, 1);",
          "968:  return 1;",
          "969: }",
          "971: yy53:",
          "972:  yych = *++YYCURSOR;",
          "973:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "970: #line 971 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "984: #line 985 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1055:  }",
          "1056: yy63:",
          "1057:  ++YYCURSOR;",
          "1059:  {",
          "1060: #if SIZEOF_LONG == 4",
          "1061: use_double:",
          "",
          "[Removed Lines]",
          "1058: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1072: #line 605 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1065:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1066:  return 1;",
          "1067: }",
          "1069: yy65:",
          "1070:  yych = *++YYCURSOR;",
          "1071:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1082: #line 1083 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1124:  yych = *++YYCURSOR;",
          "1125:  if (yych != ';') goto yy18;",
          "1126:  ++YYCURSOR;",
          "1128:  {",
          "1130:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1127: #line 585 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1141: #line 590 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1140:  return 1;",
          "1141: }",
          "1143: yy76:",
          "1144:  yych = *++YYCURSOR;",
          "1145:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1156: #line 1157 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1166:  if (yych <= '9') goto yy79;",
          "1167:  if (yych != ';') goto yy18;",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1171: #if SIZEOF_LONG == 4",
          "1172:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1169: #line 558 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1183: #line 563 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1193:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1194:  return 1;",
          "1195: }",
          "1197: yy83:",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1201:  yych = *++YYCURSOR;",
          "1202:  if (yych != ';') goto yy18;",
          "1203:  ++YYCURSOR;",
          "1205:  {",
          "1207:  INIT_PZVAL(*rval);",
          "1208:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1209:  return 1;",
          "1210: }",
          "1212: yy87:",
          "1213:  ++YYCURSOR;",
          "1215:  {",
          "1217:  INIT_PZVAL(*rval);",
          "1218:  ZVAL_NULL(*rval);",
          "1219:  return 1;",
          "1220: }",
          "1222: yy89:",
          "1223:  yych = *++YYCURSOR;",
          "1224:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1204: #line 551 \"ext/standard/var_unserializer.re\"",
          "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
          "1214: #line 544 \"ext/standard/var_unserializer.re\"",
          "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1218: #line 556 \"ext/standard/var_unserializer.re\"",
          "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
          "1228: #line 549 \"ext/standard/var_unserializer.re\"",
          "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1241:  if (yych <= '9') goto yy91;",
          "1242:  if (yych != ';') goto yy18;",
          "1243:  ++YYCURSOR;",
          "1245:  {",
          "1246:  long id;",
          "",
          "[Removed Lines]",
          "1244: #line 521 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1258: #line 526 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1265:  return 1;",
          "1266: }",
          "1268: yy95:",
          "1269:  yych = *++YYCURSOR;",
          "1270:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1281: #line 1282 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1287:  if (yych <= '9') goto yy97;",
          "1288:  if (yych != ';') goto yy18;",
          "1289:  ++YYCURSOR;",
          "1291:  {",
          "1292:  long id;",
          "",
          "[Removed Lines]",
          "1290: #line 500 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1304: #line 505 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1309:  return 1;",
          "1310: }",
          "1312: }",
          "1316:  return 0;",
          "",
          "[Removed Lines]",
          "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
          "1313: #line 863 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1325: #line 1326 \"ext/standard/var_unserializer.c\"",
          "1327: #line 877 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "409: {",
          "410:  long elements;",
          "412:  elements = parse_iv2((*p) + 2, p);",
          "414:  (*p) += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "412:  if( *p >= max - 2) {",
          "413:   zend_error(E_WARNING, \"Bad unserialize data\");",
          "414:   return -1;",
          "415:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "421:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
          "423:  }",
          "425:  return elements;",
          "",
          "[Removed Lines]",
          "422:   return 0;",
          "",
          "[Added Lines]",
          "427:   return -1;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "697: }",
          "699: \"o:\" iv \":\" [\"] {",
          "700:     if (!var_hash) return 0;",
          "702:  INIT_PZVAL(*rval);",
          "706: }",
          "708: object \":\" uiv \":\" [\"] {",
          "",
          "[Removed Lines]",
          "704:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "705:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "",
          "[Added Lines]",
          "705:  long elements;",
          "710:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "711:  if (elements < 0) {",
          "712:   return 0;",
          "713:  }",
          "714:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "845:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "847:  if (incomplete_class) {",
          "848:   php_store_class_name(*rval, class_name, len2);",
          "849:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "856:  if (elements < 0) {",
          "857:     efree(class_name);",
          "858:     return 0;",
          "859:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "61ba5f84774938617f78d65c06e5933cff2d8af3",
      "candidate_info": {
        "commit_hash": "61ba5f84774938617f78d65c06e5933cff2d8af3",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/61ba5f84774938617f78d65c06e5933cff2d8af3",
        "files": [
          "ext/standard/tests/serialize/bug25378.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #74111",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug25378.phpt||ext/standard/tests/serialize/bug25378.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug25378.phpt||ext/standard/tests/serialize/bug25378.phpt": [
          "File: ext/standard/tests/serialize/bug25378.phpt -> ext/standard/tests/serialize/bug25378.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: Notice: unserialize(): Error at offset 17 of 33 bytes in %sbug25378.php on line %d",
          "43: bool(false)",
          "46: bool(false)",
          "48: Notice: unserialize(): Error at offset 2 of 13 bytes in %sbug25378.php on line %d",
          "",
          "[Removed Lines]",
          "45: Notice: unserialize(): Error at offset 33 of 32 bytes in %sbug25378.php on line %d",
          "",
          "[Added Lines]",
          "45: Notice: unserialize(): Error at offset 32 of 32 bytes in %sbug25378.php on line %d",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "474: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "475: {",
          "483: }",
          "485: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "",
          "[Removed Lines]",
          "476:  if (*((*p)++) == '}')",
          "477:   return 1;",
          "479: #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE",
          "480:  zval_ptr_dtor(rval);",
          "481: #endif",
          "482:  return 0;",
          "",
          "[Added Lines]",
          "476:  if (*p >= max || **p != '}') {",
          "477:   return 0;",
          "478:  }",
          "480:  (*p)++;",
          "481:  return 1;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "621:  start = cursor;",
          "625: {",
          "626:  YYCTYPE yych;",
          "627:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "624: #line 625 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "623: #line 624 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "679: yy2:",
          "680:  ++YYCURSOR;",
          "681: yy3:",
          "683:  { return 0; }",
          "685: yy4:",
          "686:  yych = *(YYMARKER = ++YYCURSOR);",
          "687:  if (yych == ':') goto yy17;",
          "",
          "[Removed Lines]",
          "682: #line 1002 \"ext/standard/var_unserializer.re\"",
          "684: #line 685 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "681: #line 1001 \"ext/standard/var_unserializer.re\"",
          "683: #line 684 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "728:  goto yy3;",
          "729: yy15:",
          "730:  ++YYCURSOR;",
          "732:  {",
          "734:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "736: }",
          "738: yy17:",
          "739:  yych = *++YYCURSOR;",
          "740:  if (yybm[0+yych] & 128) {",
          "",
          "[Removed Lines]",
          "731: #line 996 \"ext/standard/var_unserializer.re\"",
          "737: #line 738 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "730: #line 995 \"ext/standard/var_unserializer.re\"",
          "736: #line 737 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "746:  goto yy3;",
          "747: yy19:",
          "748:  ++YYCURSOR;",
          "750:  {",
          "752:  ZVAL_NULL(rval);",
          "753:  return 1;",
          "754: }",
          "756: yy21:",
          "757:  yych = *++YYCURSOR;",
          "758:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "749: #line 680 \"ext/standard/var_unserializer.re\"",
          "755: #line 756 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "748: #line 679 \"ext/standard/var_unserializer.re\"",
          "754: #line 755 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1002:  goto yy18;",
          "1003: yy63:",
          "1004:  ++YYCURSOR;",
          "1006:  {",
          "1007:  zend_long id;",
          "",
          "[Removed Lines]",
          "1005: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1004: #line 628 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1029:  return 1;",
          "1030: }",
          "1032: yy65:",
          "1033:  yych = *++YYCURSOR;",
          "1034:  if (yych == '\"') goto yy84;",
          "",
          "[Removed Lines]",
          "1031: #line 1032 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1030: #line 1031 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1039:  goto yy18;",
          "1040: yy67:",
          "1041:  ++YYCURSOR;",
          "1043:  {",
          "1045:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1046:  return 1;",
          "1047: }",
          "1049: yy69:",
          "1050:  ++YYCURSOR;",
          "1051:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "",
          "[Removed Lines]",
          "1042: #line 686 \"ext/standard/var_unserializer.re\"",
          "1048: #line 1049 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1041: #line 685 \"ext/standard/var_unserializer.re\"",
          "1047: #line 1048 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1065:  }",
          "1066: yy71:",
          "1067:  ++YYCURSOR;",
          "1069:  {",
          "1070: #if SIZEOF_ZEND_LONG == 4",
          "1071: use_double:",
          "",
          "[Removed Lines]",
          "1068: #line 734 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1067: #line 733 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1074:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1075:  return 1;",
          "1076: }",
          "1078: yy73:",
          "1079:  yych = *++YYCURSOR;",
          "1080:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1077: #line 1078 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1076: #line 1077 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1096:  goto yy18;",
          "1097: yy76:",
          "1098:  ++YYCURSOR;",
          "1100:  {",
          "1101: #if SIZEOF_ZEND_LONG == 4",
          "1102:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1099: #line 692 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1098: #line 691 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1122:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1123:  return 1;",
          "1124: }",
          "1126: yy78:",
          "1127:  yych = *++YYCURSOR;",
          "1128:  if (yych == '\"') goto yy92;",
          "1129:  goto yy18;",
          "1130: yy79:",
          "1131:  ++YYCURSOR;",
          "1133:  {",
          "1134:  zend_long id;",
          "",
          "[Removed Lines]",
          "1125: #line 1126 \"ext/standard/var_unserializer.c\"",
          "1132: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1124: #line 1125 \"ext/standard/var_unserializer.c\"",
          "1131: #line 654 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1155:  return 1;",
          "1156: }",
          "1158: yy81:",
          "1159:  yych = *++YYCURSOR;",
          "1160:  if (yych == '\"') goto yy94;",
          "1161:  goto yy18;",
          "1162: yy82:",
          "1163:  ++YYCURSOR;",
          "1165:  {",
          "1166:  size_t len, len2, len3, maxlen;",
          "1167:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1157: #line 1158 \"ext/standard/var_unserializer.c\"",
          "1164: #line 844 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1156: #line 1157 \"ext/standard/var_unserializer.c\"",
          "1163: #line 843 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1314:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1315: }",
          "1317: yy84:",
          "1318:  ++YYCURSOR;",
          "1320:  {",
          "1321:  size_t len, maxlen;",
          "1322:  zend_string *str;",
          "",
          "[Removed Lines]",
          "1316: #line 1317 \"ext/standard/var_unserializer.c\"",
          "1319: #line 775 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1315: #line 1316 \"ext/standard/var_unserializer.c\"",
          "1318: #line 774 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1350:  ZVAL_STR(rval, str);",
          "1351:  return 1;",
          "1352: }",
          "1354: yy86:",
          "1355:  ++YYCURSOR;",
          "1357:  {",
          "1358:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "1353: #line 1354 \"ext/standard/var_unserializer.c\"",
          "1356: #line 809 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1352: #line 1353 \"ext/standard/var_unserializer.c\"",
          "1355: #line 808 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1378:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1379: }",
          "1381: yy88:",
          "1382:  yych = *++YYCURSOR;",
          "1383:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1380: #line 1381 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1379: #line 1380 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1402:  goto yy18;",
          "1403: yy92:",
          "1404:  ++YYCURSOR;",
          "1406:  {",
          "1407:  zend_long elements;",
          "1408:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1405: #line 833 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1404: #line 832 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1413:  }",
          "1414:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1415: }",
          "1417: yy94:",
          "1418:  ++YYCURSOR;",
          "1420:  {",
          "1421:  size_t len, maxlen;",
          "1422:  char *str;",
          "",
          "[Removed Lines]",
          "1416: #line 1417 \"ext/standard/var_unserializer.c\"",
          "1419: #line 743 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1415: #line 1416 \"ext/standard/var_unserializer.c\"",
          "1418: #line 742 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1448:  ZVAL_STRINGL(rval, str, len);",
          "1449:  return 1;",
          "1450: }",
          "1452: yy96:",
          "1453:  yych = *++YYCURSOR;",
          "1454:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1451: #line 1452 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1450: #line 1451 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1456:  goto yy18;",
          "1457: yy97:",
          "1458:  ++YYCURSOR;",
          "1460:  {",
          "",
          "[Removed Lines]",
          "1459: #line 718 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1458: #line 717 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1473:  return 1;",
          "1474: }",
          "1476: }",
          "1480:  return 0;",
          "",
          "[Removed Lines]",
          "1475: #line 1476 \"ext/standard/var_unserializer.c\"",
          "1477: #line 1004 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1474: #line 1475 \"ext/standard/var_unserializer.c\"",
          "1476: #line 1003 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "478: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "479: {",
          "487: }",
          "489: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "",
          "[Removed Lines]",
          "480:  if (*((*p)++) == '}')",
          "481:   return 1;",
          "483: #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE",
          "484:  zval_ptr_dtor(rval);",
          "485: #endif",
          "486:  return 0;",
          "",
          "[Added Lines]",
          "480:  if (*p >= max || **p != '}') {",
          "481:   return 0;",
          "482:  }",
          "484:  (*p)++;",
          "485:  return 1;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0ae14f3a1d946feb7e3c6662377e5521475297f5",
      "candidate_info": {
        "commit_hash": "0ae14f3a1d946feb7e3c6662377e5521475297f5",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/0ae14f3a1d946feb7e3c6662377e5521475297f5",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed access to uninitialized data",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "278:  while (elements-- > 0) {",
          "279:   zval key, *data, d, *old_data;",
          "281:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "282:    zval_dtor(&key);",
          "283:    return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "281:   ZVAL_UNDEF(&key);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "442:  start = cursor;",
          "446: {",
          "447:  YYCTYPE yych;",
          "448:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "445: #line 446 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "446: #line 447 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "502:  yych = *(YYMARKER = ++YYCURSOR);",
          "503:  if (yych == ':') goto yy95;",
          "504: yy3:",
          "506:  { return 0; }",
          "508: yy4:",
          "509:  yych = *(YYMARKER = ++YYCURSOR);",
          "510:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "505: #line 792 \"ext/standard/var_unserializer.re\"",
          "507: #line 508 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "506: #line 793 \"ext/standard/var_unserializer.re\"",
          "508: #line 509 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "547:  goto yy3;",
          "548: yy14:",
          "549:  ++YYCURSOR;",
          "551:  {",
          "553:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "555: }",
          "557: yy16:",
          "558:  yych = *++YYCURSOR;",
          "559:  goto yy3;",
          "",
          "[Removed Lines]",
          "550: #line 786 \"ext/standard/var_unserializer.re\"",
          "556: #line 557 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "551: #line 787 \"ext/standard/var_unserializer.re\"",
          "557: #line 558 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "583:  yych = *++YYCURSOR;",
          "584:  if (yych != '\"') goto yy18;",
          "585:  ++YYCURSOR;",
          "587:  {",
          "588:  size_t len, len2, len3, maxlen;",
          "589:  long elements;",
          "",
          "[Removed Lines]",
          "586: #line 647 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "587: #line 648 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "723:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "724: }",
          "726: yy25:",
          "727:  yych = *++YYCURSOR;",
          "728:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "725: #line 726 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "726: #line 727 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "747:  yych = *++YYCURSOR;",
          "748:  if (yych != '\"') goto yy18;",
          "749:  ++YYCURSOR;",
          "751:  {",
          "",
          "[Removed Lines]",
          "750: #line 639 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "751: #line 640 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "755:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "756:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "757: }",
          "759: yy32:",
          "760:  yych = *++YYCURSOR;",
          "761:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "758: #line 759 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "759: #line 760 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "776:  yych = *++YYCURSOR;",
          "777:  if (yych != '{') goto yy18;",
          "778:  ++YYCURSOR;",
          "780:  {",
          "781:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "779: #line 618 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "780: #line 619 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "798:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "799: }",
          "801: yy39:",
          "802:  yych = *++YYCURSOR;",
          "803:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "800: #line 801 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "801: #line 802 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "818:  yych = *++YYCURSOR;",
          "819:  if (yych != '\"') goto yy18;",
          "820:  ++YYCURSOR;",
          "822:  {",
          "823:  size_t len, maxlen;",
          "",
          "[Removed Lines]",
          "821: #line 588 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "822: #line 589 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "848:  efree(str);",
          "849:  return 1;",
          "850: }",
          "852: yy46:",
          "853:  yych = *++YYCURSOR;",
          "854:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "851: #line 852 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "852: #line 853 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "869:  yych = *++YYCURSOR;",
          "870:  if (yych != '\"') goto yy18;",
          "871:  ++YYCURSOR;",
          "873:  {",
          "874:  size_t len, maxlen;",
          "875:  char *str;",
          "",
          "[Removed Lines]",
          "872: #line 561 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "873: #line 562 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "896:  ZVAL_STRINGL(rval, str, len);",
          "897:  return 1;",
          "898: }",
          "900: yy53:",
          "901:  yych = *++YYCURSOR;",
          "902:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "899: #line 900 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "900: #line 901 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "984:  }",
          "985: yy63:",
          "986:  ++YYCURSOR;",
          "988:  {",
          "989: #if SIZEOF_LONG == 4",
          "990: use_double:",
          "",
          "[Removed Lines]",
          "987: #line 552 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "988: #line 553 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "993:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "994:  return 1;",
          "995: }",
          "997: yy65:",
          "998:  yych = *++YYCURSOR;",
          "999:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "996: #line 997 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "997: #line 998 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1052:  yych = *++YYCURSOR;",
          "1053:  if (yych != ';') goto yy18;",
          "1054:  ++YYCURSOR;",
          "1056:  {",
          "",
          "[Removed Lines]",
          "1055: #line 536 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1056: #line 537 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1069:  return 1;",
          "1070: }",
          "1072: yy76:",
          "1073:  yych = *++YYCURSOR;",
          "1074:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1071: #line 1072 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1072: #line 1073 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1095:  if (yych <= '9') goto yy79;",
          "1096:  if (yych != ';') goto yy18;",
          "1097:  ++YYCURSOR;",
          "1099:  {",
          "1100: #if SIZEOF_LONG == 4",
          "1101:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1098: #line 510 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1099: #line 511 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1121:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1122:  return 1;",
          "1123: }",
          "1125: yy83:",
          "1126:  yych = *++YYCURSOR;",
          "1127:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1124: #line 1125 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1125: #line 1126 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1129:  yych = *++YYCURSOR;",
          "1130:  if (yych != ';') goto yy18;",
          "1131:  ++YYCURSOR;",
          "1133:  {",
          "1135:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1136:  return 1;",
          "1137: }",
          "1139: yy87:",
          "1140:  ++YYCURSOR;",
          "1142:  {",
          "1144:  ZVAL_NULL(rval);",
          "1145:  return 1;",
          "1146: }",
          "1148: yy89:",
          "1149:  yych = *++YYCURSOR;",
          "1150:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1132: #line 504 \"ext/standard/var_unserializer.re\"",
          "1138: #line 1139 \"ext/standard/var_unserializer.c\"",
          "1141: #line 498 \"ext/standard/var_unserializer.re\"",
          "1147: #line 1148 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1133: #line 505 \"ext/standard/var_unserializer.re\"",
          "1139: #line 1140 \"ext/standard/var_unserializer.c\"",
          "1142: #line 499 \"ext/standard/var_unserializer.re\"",
          "1148: #line 1149 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1167:  if (yych <= '9') goto yy91;",
          "1168:  if (yych != ';') goto yy18;",
          "1169:  ++YYCURSOR;",
          "1171:  {",
          "1172:  long id;",
          "",
          "[Removed Lines]",
          "1170: #line 475 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1171: #line 476 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1191:  return 1;",
          "1192: }",
          "1194: yy95:",
          "1195:  yych = *++YYCURSOR;",
          "1196:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1213:  if (yych <= '9') goto yy97;",
          "1214:  if (yych != ';') goto yy18;",
          "1215:  ++YYCURSOR;",
          "1217:  {",
          "1218:  long id;",
          "",
          "[Removed Lines]",
          "1216: #line 450 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1217: #line 451 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1239:  return 1;",
          "1240: }",
          "1242: }",
          "1246:  return 0;",
          "",
          "[Removed Lines]",
          "1241: #line 1242 \"ext/standard/var_unserializer.c\"",
          "1243: #line 794 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1242: #line 1243 \"ext/standard/var_unserializer.c\"",
          "1244: #line 795 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "282:  while (elements-- > 0) {",
          "283:   zval key, *data, d, *old_data;",
          "285:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "286:    zval_dtor(&key);",
          "287:    return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "285:   ZVAL_UNDEF(&key);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8d8e94936959eb2466ec77d1e537427f92650363",
      "candidate_info": {
        "commit_hash": "8d8e94936959eb2466ec77d1e537427f92650363",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/8d8e94936959eb2466ec77d1e537427f92650363",
        "files": [
          "ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-7.0' into PHP-7.1",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt": [
          "File: ext/standard/tests/serialize/bug70963.phpt -> ext/standard/tests/serialize/bug70963.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;r:3;}'));",
          "7: ?>",
          "8: --EXPECTF--",
          "10:   [0]=>",
          "11:   object(Exception)#%d (6) {",
          "12:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "9: array(1) {",
          "",
          "[Added Lines]",
          "9: array(2) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "22:     [\"previous\":\"Exception\":private]=>",
          "23:     NULL",
          "24:   }",
          "25: }",
          "27:   [0]=>",
          "28:   object(Exception)#%d (6) {",
          "29:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "26: array(1) {",
          "",
          "[Added Lines]",
          "25:   [1]=>",
          "26:   string(4) \"test\"",
          "28: array(2) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "39:     [\"previous\":\"Exception\":private]=>",
          "40:     NULL",
          "41:   }",
          "42: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44:   [1]=>",
          "45:   string(4) \"test\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "71: #define VAR_ENTRIES_MAX 1024",
          "72: #define VAR_ENTRIES_DBG 0",
          "74: typedef struct {",
          "75:  zval *data[VAR_ENTRIES_MAX];",
          "76:  zend_long used_slots;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "75: #define VAR_WAKEUP_FLAG 1",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "139:         (*var_hashx)->last_dtor = var_hash;",
          "140:     }",
          "141:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "142:     return &var_hash->data[var_hash->used_slots++];",
          "143: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "145:  Z_ACCESS_FLAGS(var_hash->data[var_hash->used_slots]) = 0;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "186:  zend_long i;",
          "187:  var_entries *var_hash = (*var_hashx)->first;",
          "188:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "189: #if VAR_ENTRIES_DBG",
          "190:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "191: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "193:  zend_bool wakeup_failed = 0;",
          "194:  zval wakeup_name;",
          "195:  ZVAL_UNDEF(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "199:  while (var_dtor_hash) {",
          "200:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "201: #if VAR_ENTRIES_DBG",
          "202:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "203: #endif",
          "205:   }",
          "206:   next = var_dtor_hash->next;",
          "207:   efree_size(var_dtor_hash, sizeof(var_dtor_entries));",
          "208:   var_dtor_hash = next;",
          "209:  }",
          "210: }",
          "",
          "[Removed Lines]",
          "204:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "",
          "[Added Lines]",
          "209:    zval *zv = &var_dtor_hash->data[i];",
          "215:    if (Z_ACCESS_FLAGS_P(zv) == VAR_WAKEUP_FLAG) {",
          "216:     if (!wakeup_failed) {",
          "217:      zval retval;",
          "218:      if (Z_ISUNDEF(wakeup_name)) {",
          "219:       ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "220:      }",
          "222:      BG(serialize_lock)++;",
          "223:      if (call_user_function_ex(CG(function_table), zv, &wakeup_name, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "224:       wakeup_failed = 1;",
          "225:       GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "226:      }",
          "227:      BG(serialize_lock)--;",
          "229:      zval_ptr_dtor(&retval);",
          "230:     } else {",
          "231:      GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "232:     }",
          "233:    }",
          "235:    zval_ptr_dtor(zv);",
          "242:  zval_ptr_dtor(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "283: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "286: #line 291 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "319: #line 324 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "504: #endif",
          "505: static inline int object_common2(UNSERIALIZE_PARAMETER, zend_long elements)",
          "506: {",
          "509:  HashTable *ht;",
          "510:  zend_bool has_wakeup;",
          "",
          "[Removed Lines]",
          "507:  zval retval;",
          "508:  zval fname;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "529:  ZVAL_DEREF(rval);",
          "530:  if (has_wakeup) {",
          "543:  }",
          "545:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "",
          "[Removed Lines]",
          "531:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "532:   BG(serialize_lock)++;",
          "533:   if (call_user_function_ex(CG(function_table), rval, &fname, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "534:    GC_FLAGS(Z_OBJ_P(rval)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "535:   }",
          "536:   BG(serialize_lock)--;",
          "537:   zval_dtor(&fname);",
          "538:   zval_dtor(&retval);",
          "539:  }",
          "541:  if (EG(exception)) {",
          "542:   return 0;",
          "",
          "[Added Lines]",
          "563:   zval *wakeup_var = var_tmp_var(var_hash);",
          "564:   ZVAL_COPY(wakeup_var, rval);",
          "565:   Z_ACCESS_FLAGS_P(wakeup_var) = VAR_WAKEUP_FLAG;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "594:  start = cursor;",
          "598: {",
          "599:  YYCTYPE yych;",
          "600:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "597: #line 598 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "620: #line 621 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "631:     0,   0,   0,   0,   0,   0,   0,   0,",
          "632:     0,   0,   0,   0,   0,   0,   0,   0,",
          "633:  };",
          "635:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "636:  yych = *YYCURSOR;",
          "637:  switch (yych) {",
          "638:  case 'C':",
          "640:  case 'N': goto yy5;",
          "647:  case 'o': goto yy12;",
          "652:  }",
          "653: yy2:",
          "656: yy3:",
          "658:  { return 0; }",
          "660: yy4:",
          "661:  yych = *(YYMARKER = ++YYCURSOR);",
          "663:  goto yy3;",
          "664: yy5:",
          "665:  yych = *++YYCURSOR;",
          "667:  goto yy3;",
          "668: yy6:",
          "669:  yych = *(YYMARKER = ++YYCURSOR);",
          "671:  goto yy3;",
          "672: yy7:",
          "673:  yych = *(YYMARKER = ++YYCURSOR);",
          "675:  goto yy3;",
          "676: yy8:",
          "677:  yych = *(YYMARKER = ++YYCURSOR);",
          "679:  goto yy3;",
          "680: yy9:",
          "681:  yych = *(YYMARKER = ++YYCURSOR);",
          "683:  goto yy3;",
          "684: yy10:",
          "685:  yych = *(YYMARKER = ++YYCURSOR);",
          "687:  goto yy3;",
          "688: yy11:",
          "689:  yych = *(YYMARKER = ++YYCURSOR);",
          "691:  goto yy3;",
          "692: yy12:",
          "693:  yych = *(YYMARKER = ++YYCURSOR);",
          "695:  goto yy3;",
          "696: yy13:",
          "697:  yych = *(YYMARKER = ++YYCURSOR);",
          "699:  goto yy3;",
          "700: yy14:",
          "701:  ++YYCURSOR;",
          "703:  {",
          "705:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "707: }",
          "712: yy17:",
          "713:  yych = *++YYCURSOR;",
          "714:  if (yybm[0+yych] & 128) {",
          "716:  }",
          "718: yy18:",
          "719:  YYCURSOR = YYMARKER;",
          "720:  goto yy3;",
          "721: yy19:",
          "722:  yych = *++YYCURSOR;",
          "725:  }",
          "726:  goto yy18;",
          "734:  if (yych <= '/') goto yy18;",
          "736:  yych = *++YYCURSOR;",
          "855:   }",
          "872:   }",
          "875:  }",
          "882:  }",
          "886:  }",
          "893:  yych = *++YYCURSOR;",
          "894:  if (yych <= ',') {",
          "896:  } else {",
          "898:   if (yych <= '/') goto yy18;",
          "900:   goto yy18;",
          "901:  }",
          "903:  yych = *++YYCURSOR;",
          "904:  if (yych <= '/') goto yy18;",
          "907:  ++YYCURSOR;",
          "908:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "909:  yych = *YYCURSOR;",
          "924:  }",
          "931:  if (yych <= '/') goto yy18;",
          "933:  goto yy18;",
          "934: yy33:",
          "935:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "639:  case 'O': goto yy13;",
          "641:  case 'R': goto yy2;",
          "642:  case 'S': goto yy10;",
          "643:  case 'a': goto yy11;",
          "644:  case 'b': goto yy6;",
          "645:  case 'd': goto yy8;",
          "646:  case 'i': goto yy7;",
          "648:  case 'r': goto yy4;",
          "649:  case 's': goto yy9;",
          "650:  case '}': goto yy14;",
          "651:  default: goto yy16;",
          "654:  yych = *(YYMARKER = ++YYCURSOR);",
          "655:  if (yych == ':') goto yy95;",
          "657: #line 975 \"ext/standard/var_unserializer.re\"",
          "659: #line 660 \"ext/standard/var_unserializer.c\"",
          "662:  if (yych == ':') goto yy89;",
          "666:  if (yych == ';') goto yy87;",
          "670:  if (yych == ':') goto yy83;",
          "674:  if (yych == ':') goto yy77;",
          "678:  if (yych == ':') goto yy53;",
          "682:  if (yych == ':') goto yy46;",
          "686:  if (yych == ':') goto yy39;",
          "690:  if (yych == ':') goto yy32;",
          "694:  if (yych == ':') goto yy25;",
          "698:  if (yych == ':') goto yy17;",
          "702: #line 969 \"ext/standard/var_unserializer.re\"",
          "708: #line 709 \"ext/standard/var_unserializer.c\"",
          "709: yy16:",
          "710:  yych = *++YYCURSOR;",
          "711:  goto yy3;",
          "715:   goto yy20;",
          "717:  if (yych == '+') goto yy19;",
          "723:  if (yybm[0+yych] & 128) {",
          "724:   goto yy20;",
          "727: yy20:",
          "728:  ++YYCURSOR;",
          "729:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "730:  yych = *YYCURSOR;",
          "731:  if (yybm[0+yych] & 128) {",
          "732:   goto yy20;",
          "733:  }",
          "735:  if (yych >= ';') goto yy18;",
          "737:  if (yych != '\"') goto yy18;",
          "738:  ++YYCURSOR;",
          "739: #line 817 \"ext/standard/var_unserializer.re\"",
          "740:  {",
          "741:  size_t len, len2, len3, maxlen;",
          "742:  zend_long elements;",
          "743:  char *str;",
          "744:  zend_string *class_name;",
          "745:  zend_class_entry *ce;",
          "746:  int incomplete_class = 0;",
          "748:  int custom_object = 0;",
          "750:  zval user_func;",
          "751:  zval retval;",
          "752:  zval args[1];",
          "754:     if (!var_hash) return 0;",
          "755:  if (*start == 'C') {",
          "756:   custom_object = 1;",
          "757:  }",
          "759:  len2 = len = parse_uiv(start + 2);",
          "760:  maxlen = max - YYCURSOR;",
          "761:  if (maxlen < len || len == 0) {",
          "763:   return 0;",
          "764:  }",
          "766:  str = (char*)YYCURSOR;",
          "768:  YYCURSOR += len;",
          "770:  if (*(YYCURSOR) != '\"') {",
          "772:   return 0;",
          "773:  }",
          "774:  if (*(YYCURSOR+1) != ':') {",
          "776:   return 0;",
          "777:  }",
          "779:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "780:  if (len3 != len)",
          "781:  {",
          "783:   return 0;",
          "784:  }",
          "786:  class_name = zend_string_init(str, len, 0);",
          "788:  do {",
          "789:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "790:    incomplete_class = 1;",
          "791:    ce = PHP_IC_ENTRY;",
          "792:    break;",
          "793:   }",
          "796:   BG(serialize_lock)++;",
          "797:   ce = zend_lookup_class(class_name);",
          "798:   if (ce) {",
          "799:    BG(serialize_lock)--;",
          "800:    if (EG(exception)) {",
          "801:     zend_string_release(class_name);",
          "802:     return 0;",
          "803:    }",
          "804:    break;",
          "805:   }",
          "806:   BG(serialize_lock)--;",
          "808:   if (EG(exception)) {",
          "809:    zend_string_release(class_name);",
          "810:    return 0;",
          "811:   }",
          "814:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "815:    incomplete_class = 1;",
          "816:    ce = PHP_IC_ENTRY;",
          "817:    break;",
          "818:   }",
          "821:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "823:   ZVAL_STR_COPY(&args[0], class_name);",
          "824:   BG(serialize_lock)++;",
          "825:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "826:    BG(serialize_lock)--;",
          "827:    if (EG(exception)) {",
          "828:     zend_string_release(class_name);",
          "829:     zval_ptr_dtor(&user_func);",
          "830:     zval_ptr_dtor(&args[0]);",
          "831:     return 0;",
          "832:    }",
          "833:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "834:    incomplete_class = 1;",
          "835:    ce = PHP_IC_ENTRY;",
          "836:    zval_ptr_dtor(&user_func);",
          "837:    zval_ptr_dtor(&args[0]);",
          "838:    break;",
          "839:   }",
          "840:   BG(serialize_lock)--;",
          "841:   zval_ptr_dtor(&retval);",
          "842:   if (EG(exception)) {",
          "843:    zend_string_release(class_name);",
          "844:    zval_ptr_dtor(&user_func);",
          "845:    zval_ptr_dtor(&args[0]);",
          "846:    return 0;",
          "847:   }",
          "850:   BG(serialize_lock)++;",
          "851:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "852:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "853:    incomplete_class = 1;",
          "854:    ce = PHP_IC_ENTRY;",
          "856:   BG(serialize_lock)--;",
          "858:   zval_ptr_dtor(&user_func);",
          "859:   zval_ptr_dtor(&args[0]);",
          "860:   break;",
          "861:  } while (1);",
          "865:  if (custom_object) {",
          "866:   int ret;",
          "868:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "870:   if (ret && incomplete_class) {",
          "871:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "873:   zend_string_release(class_name);",
          "874:   return ret;",
          "877:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "879:  if (elements < 0) {",
          "880:     zend_string_release(class_name);",
          "881:     return 0;",
          "884:  if (incomplete_class) {",
          "885:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "887:  zend_string_release(class_name);",
          "889:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "890: }",
          "891: #line 892 \"ext/standard/var_unserializer.c\"",
          "892: yy25:",
          "895:   if (yych != '+') goto yy18;",
          "897:   if (yych <= '-') goto yy26;",
          "899:   if (yych <= '9') goto yy27;",
          "902: yy26:",
          "905:  if (yych >= ':') goto yy18;",
          "906: yy27:",
          "910:  if (yych <= '/') goto yy18;",
          "911:  if (yych <= '9') goto yy27;",
          "912:  if (yych >= ';') goto yy18;",
          "913:  yych = *++YYCURSOR;",
          "914:  if (yych != '\"') goto yy18;",
          "915:  ++YYCURSOR;",
          "916: #line 806 \"ext/standard/var_unserializer.re\"",
          "917:  {",
          "918:  long elements;",
          "919:     if (!var_hash) return 0;",
          "921:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "922:  if (elements < 0) {",
          "923:   return 0;",
          "925:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "926: }",
          "927: #line 928 \"ext/standard/var_unserializer.c\"",
          "928: yy32:",
          "929:  yych = *++YYCURSOR;",
          "930:  if (yych == '+') goto yy33;",
          "932:  if (yych <= '9') goto yy34;",
          "",
          "[Added Lines]",
          "661:  case 'O': goto yy4;",
          "663:  case 'R': goto yy6;",
          "664:  case 'S': goto yy7;",
          "665:  case 'a': goto yy8;",
          "666:  case 'b': goto yy9;",
          "667:  case 'd': goto yy10;",
          "668:  case 'i': goto yy11;",
          "670:  case 'r': goto yy13;",
          "671:  case 's': goto yy14;",
          "672:  case '}': goto yy15;",
          "673:  default: goto yy2;",
          "676:  ++YYCURSOR;",
          "678: #line 998 \"ext/standard/var_unserializer.re\"",
          "680: #line 681 \"ext/standard/var_unserializer.c\"",
          "683:  if (yych == ':') goto yy17;",
          "687:  if (yych == ';') goto yy19;",
          "691:  if (yych == ':') goto yy21;",
          "695:  if (yych == ':') goto yy22;",
          "699:  if (yych == ':') goto yy23;",
          "703:  if (yych == ':') goto yy24;",
          "707:  if (yych == ':') goto yy25;",
          "711:  if (yych == ':') goto yy26;",
          "715:  if (yych == ':') goto yy27;",
          "719:  if (yych == ':') goto yy28;",
          "722:  yych = *(YYMARKER = ++YYCURSOR);",
          "723:  if (yych == ':') goto yy29;",
          "724:  goto yy3;",
          "725: yy15:",
          "727: #line 992 \"ext/standard/var_unserializer.re\"",
          "733: #line 734 \"ext/standard/var_unserializer.c\"",
          "737:   goto yy31;",
          "739:  if (yych == '+') goto yy30;",
          "744:  ++YYCURSOR;",
          "745: #line 676 \"ext/standard/var_unserializer.re\"",
          "746:  {",
          "748:  ZVAL_NULL(rval);",
          "749:  return 1;",
          "750: }",
          "751: #line 752 \"ext/standard/var_unserializer.c\"",
          "752: yy21:",
          "754:  if (yych <= ',') {",
          "755:   if (yych == '+') goto yy33;",
          "756:   goto yy18;",
          "757:  } else {",
          "758:   if (yych <= '-') goto yy33;",
          "759:   if (yych <= '/') goto yy18;",
          "760:   if (yych <= '9') goto yy34;",
          "761:   goto yy18;",
          "763: yy22:",
          "764:  yych = *++YYCURSOR;",
          "765:  if (yych == '+') goto yy36;",
          "766:  if (yych <= '/') goto yy18;",
          "767:  if (yych <= '9') goto yy37;",
          "769: yy23:",
          "770:  yych = *++YYCURSOR;",
          "771:  if (yych == '+') goto yy39;",
          "773:  if (yych <= '9') goto yy40;",
          "774:  goto yy18;",
          "775: yy24:",
          "777:  if (yych <= '/') goto yy18;",
          "778:  if (yych <= '1') goto yy42;",
          "779:  goto yy18;",
          "780: yy25:",
          "781:  yych = *++YYCURSOR;",
          "782:  if (yych <= '/') {",
          "783:   if (yych <= ',') {",
          "784:    if (yych == '+') goto yy43;",
          "785:    goto yy18;",
          "786:   } else {",
          "787:    if (yych <= '-') goto yy44;",
          "788:    if (yych <= '.') goto yy45;",
          "789:    goto yy18;",
          "791:  } else {",
          "792:   if (yych <= 'I') {",
          "793:    if (yych <= '9') goto yy46;",
          "794:    if (yych <= 'H') goto yy18;",
          "795:    goto yy48;",
          "796:   } else {",
          "797:    if (yych == 'N') goto yy49;",
          "798:    goto yy18;",
          "801: yy26:",
          "802:  yych = *++YYCURSOR;",
          "803:  if (yych <= ',') {",
          "804:   if (yych == '+') goto yy50;",
          "805:   goto yy18;",
          "806:  } else {",
          "807:   if (yych <= '-') goto yy50;",
          "808:   if (yych <= '/') goto yy18;",
          "809:   if (yych <= '9') goto yy51;",
          "810:   goto yy18;",
          "812: yy27:",
          "813:  yych = *++YYCURSOR;",
          "814:  if (yych <= ',') {",
          "815:   if (yych == '+') goto yy53;",
          "816:   goto yy18;",
          "817:  } else {",
          "818:   if (yych <= '-') goto yy53;",
          "819:   if (yych <= '/') goto yy18;",
          "820:   if (yych <= '9') goto yy54;",
          "821:   goto yy18;",
          "823: yy28:",
          "826:   if (yych == '+') goto yy56;",
          "827:   goto yy18;",
          "829:   if (yych <= '-') goto yy56;",
          "831:   if (yych <= '9') goto yy57;",
          "834: yy29:",
          "836:  if (yych == '+') goto yy59;",
          "838:  if (yych <= '9') goto yy60;",
          "839:  goto yy18;",
          "840: yy30:",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yybm[0+yych] & 128) {",
          "843:   goto yy31;",
          "844:  }",
          "845:  goto yy18;",
          "846: yy31:",
          "850:  if (yybm[0+yych] & 128) {",
          "851:   goto yy31;",
          "854:  if (yych <= ':') goto yy62;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "937:  if (yych >= ':') goto yy18;",
          "938: yy34:",
          "939:  ++YYCURSOR;",
          "941:  yych = *YYCURSOR;",
          "942:  if (yych <= '/') goto yy18;",
          "943:  if (yych <= '9') goto yy34;",
          "980:  yych = *++YYCURSOR;",
          "981:  if (yych <= '/') goto yy18;",
          "982:  if (yych >= ':') goto yy18;",
          "984:  ++YYCURSOR;",
          "985:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "986:  yych = *YYCURSOR;",
          "987:  if (yych <= '/') goto yy18;",
          "1033:  goto yy18;",
          "1035:  yych = *++YYCURSOR;",
          "1036:  if (yych <= '/') goto yy18;",
          "1037:  if (yych >= ':') goto yy18;",
          "1039:  ++YYCURSOR;",
          "1040:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "1041:  yych = *YYCURSOR;",
          "1042:  if (yych <= '/') goto yy18;",
          "1082:  yych = *++YYCURSOR;",
          "1101:  yych = *++YYCURSOR;",
          "1103:  goto yy18;",
          "1105:  yych = *++YYCURSOR;",
          "1106:  if (yych <= '/') {",
          "1109:  } else {",
          "1112:  }",
          "1114:  yych = *++YYCURSOR;",
          "1120:  if (yych <= '/') goto yy18;",
          "1123:  ++YYCURSOR;",
          "1124:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1125:  yych = *YYCURSOR;",
          "1126:  if (yych <= ':') {",
          "1127:   if (yych <= '.') {",
          "1128:    if (yych <= '-') goto yy18;",
          "1130:   } else {",
          "1131:    if (yych <= '/') goto yy18;",
          "1133:    goto yy18;",
          "1134:   }",
          "1135:  } else {",
          "1136:   if (yych <= 'E') {",
          "1138:    if (yych <= 'D') goto yy18;",
          "1140:   } else {",
          "1142:    goto yy18;",
          "1143:   }",
          "1144:  }",
          "1146:  yych = *++YYCURSOR;",
          "1147:  if (yych <= '/') goto yy18;",
          "1148:  if (yych >= ':') goto yy18;",
          "1150:  ++YYCURSOR;",
          "1151:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1152:  yych = *YYCURSOR;",
          "1153:  if (yych <= ';') {",
          "1154:   if (yych <= '/') goto yy18;",
          "1156:   if (yych <= ':') goto yy18;",
          "1157:  } else {",
          "1158:   if (yych <= 'E') {",
          "1159:    if (yych <= 'D') goto yy18;",
          "1161:   } else {",
          "1163:    goto yy18;",
          "1164:   }",
          "1165:  }",
          "1167:  ++YYCURSOR;",
          "1169:  {",
          "1170: #if SIZEOF_ZEND_LONG == 4",
          "1171: use_double:",
          "",
          "[Removed Lines]",
          "940:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "944:  if (yych >= ';') goto yy18;",
          "945:  yych = *++YYCURSOR;",
          "946:  if (yych != '{') goto yy18;",
          "947:  ++YYCURSOR;",
          "948: #line 782 \"ext/standard/var_unserializer.re\"",
          "949:  {",
          "950:  zend_long elements = parse_iv(start + 2);",
          "953:     if (!var_hash) return 0;",
          "955:  if (elements < 0) {",
          "956:   return 0;",
          "957:  }",
          "959:  array_init_size(rval, elements);",
          "960:  if (elements) {",
          "963:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "964:  }",
          "966:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "967:   return 0;",
          "968:  }",
          "970:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "971: }",
          "972: #line 973 \"ext/standard/var_unserializer.c\"",
          "973: yy39:",
          "974:  yych = *++YYCURSOR;",
          "975:  if (yych == '+') goto yy40;",
          "976:  if (yych <= '/') goto yy18;",
          "977:  if (yych <= '9') goto yy41;",
          "978:  goto yy18;",
          "979: yy40:",
          "983: yy41:",
          "988:  if (yych <= '9') goto yy41;",
          "989:  if (yych >= ';') goto yy18;",
          "990:  yych = *++YYCURSOR;",
          "991:  if (yych != '\"') goto yy18;",
          "992:  ++YYCURSOR;",
          "993: #line 748 \"ext/standard/var_unserializer.re\"",
          "994:  {",
          "995:  size_t len, maxlen;",
          "996:  zend_string *str;",
          "998:  len = parse_uiv(start + 2);",
          "999:  maxlen = max - YYCURSOR;",
          "1000:  if (maxlen < len) {",
          "1002:   return 0;",
          "1003:  }",
          "1005:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1006:   return 0;",
          "1007:  }",
          "1009:  if (*(YYCURSOR) != '\"') {",
          "1010:   zend_string_free(str);",
          "1012:   return 0;",
          "1013:  }",
          "1015:  if (*(YYCURSOR + 1) != ';') {",
          "1016:   efree(str);",
          "1018:   return 0;",
          "1019:  }",
          "1021:  YYCURSOR += 2;",
          "1024:  ZVAL_STR(rval, str);",
          "1025:  return 1;",
          "1026: }",
          "1027: #line 1028 \"ext/standard/var_unserializer.c\"",
          "1028: yy46:",
          "1029:  yych = *++YYCURSOR;",
          "1030:  if (yych == '+') goto yy47;",
          "1031:  if (yych <= '/') goto yy18;",
          "1032:  if (yych <= '9') goto yy48;",
          "1034: yy47:",
          "1038: yy48:",
          "1043:  if (yych <= '9') goto yy48;",
          "1044:  if (yych >= ';') goto yy18;",
          "1045:  yych = *++YYCURSOR;",
          "1046:  if (yych != '\"') goto yy18;",
          "1047:  ++YYCURSOR;",
          "1048: #line 716 \"ext/standard/var_unserializer.re\"",
          "1049:  {",
          "1050:  size_t len, maxlen;",
          "1051:  char *str;",
          "1053:  len = parse_uiv(start + 2);",
          "1054:  maxlen = max - YYCURSOR;",
          "1055:  if (maxlen < len) {",
          "1057:   return 0;",
          "1058:  }",
          "1060:  str = (char*)YYCURSOR;",
          "1062:  YYCURSOR += len;",
          "1064:  if (*(YYCURSOR) != '\"') {",
          "1066:   return 0;",
          "1067:  }",
          "1069:  if (*(YYCURSOR + 1) != ';') {",
          "1071:   return 0;",
          "1072:  }",
          "1074:  YYCURSOR += 2;",
          "1077:  ZVAL_STRINGL(rval, str, len);",
          "1078:  return 1;",
          "1079: }",
          "1080: #line 1081 \"ext/standard/var_unserializer.c\"",
          "1081: yy53:",
          "1083:  if (yych <= '/') {",
          "1084:   if (yych <= ',') {",
          "1085:    if (yych == '+') goto yy57;",
          "1086:    goto yy18;",
          "1087:   } else {",
          "1088:    if (yych <= '-') goto yy55;",
          "1089:    if (yych <= '.') goto yy60;",
          "1090:    goto yy18;",
          "1091:   }",
          "1092:  } else {",
          "1093:   if (yych <= 'I') {",
          "1094:    if (yych <= '9') goto yy58;",
          "1095:    if (yych <= 'H') goto yy18;",
          "1096:    goto yy56;",
          "1097:   } else {",
          "1098:    if (yych != 'N') goto yy18;",
          "1099:   }",
          "1100:  }",
          "1102:  if (yych == 'A') goto yy76;",
          "1104: yy55:",
          "1107:   if (yych == '.') goto yy60;",
          "1108:   goto yy18;",
          "1110:   if (yych <= '9') goto yy58;",
          "1111:   if (yych != 'I') goto yy18;",
          "1113: yy56:",
          "1115:  if (yych == 'N') goto yy72;",
          "1116:  goto yy18;",
          "1117: yy57:",
          "1118:  yych = *++YYCURSOR;",
          "1119:  if (yych == '.') goto yy60;",
          "1121:  if (yych >= ':') goto yy18;",
          "1122: yy58:",
          "1129:    goto yy70;",
          "1132:    if (yych <= '9') goto yy58;",
          "1137:    if (yych <= ';') goto yy63;",
          "1139:    goto yy65;",
          "1141:    if (yych == 'e') goto yy65;",
          "1145: yy60:",
          "1149: yy61:",
          "1155:   if (yych <= '9') goto yy61;",
          "1160:    goto yy65;",
          "1162:    if (yych == 'e') goto yy65;",
          "1166: yy63:",
          "1168: #line 707 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "862:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "866:  if (yych == ';') goto yy63;",
          "867:  goto yy18;",
          "868: yy36:",
          "872: yy37:",
          "877:  if (yych <= '9') goto yy37;",
          "878:  if (yych <= ':') goto yy65;",
          "880: yy39:",
          "884: yy40:",
          "889:  if (yych <= '9') goto yy40;",
          "890:  if (yych <= ':') goto yy66;",
          "891:  goto yy18;",
          "892: yy42:",
          "894:  if (yych == ';') goto yy67;",
          "895:  goto yy18;",
          "896: yy43:",
          "898:  if (yych == '.') goto yy45;",
          "899:  if (yych <= '/') goto yy18;",
          "900:  if (yych <= '9') goto yy46;",
          "902: yy44:",
          "905:   if (yych != '.') goto yy18;",
          "907:   if (yych <= '9') goto yy46;",
          "908:   if (yych == 'I') goto yy48;",
          "909:   goto yy18;",
          "911: yy45:",
          "914:  if (yych <= '9') goto yy69;",
          "915:  goto yy18;",
          "916: yy46:",
          "923:    goto yy69;",
          "926:    if (yych <= '9') goto yy46;",
          "931:    if (yych <= ';') goto yy71;",
          "933:    goto yy73;",
          "935:    if (yych == 'e') goto yy73;",
          "939: yy48:",
          "940:  yych = *++YYCURSOR;",
          "941:  if (yych == 'N') goto yy74;",
          "942:  goto yy18;",
          "943: yy49:",
          "944:  yych = *++YYCURSOR;",
          "945:  if (yych == 'A') goto yy75;",
          "946:  goto yy18;",
          "947: yy50:",
          "948:  yych = *++YYCURSOR;",
          "949:  if (yych <= '/') goto yy18;",
          "950:  if (yych >= ':') goto yy18;",
          "951: yy51:",
          "952:  ++YYCURSOR;",
          "953:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "954:  yych = *YYCURSOR;",
          "955:  if (yych <= '/') goto yy18;",
          "956:  if (yych <= '9') goto yy51;",
          "957:  if (yych == ';') goto yy76;",
          "958:  goto yy18;",
          "959: yy53:",
          "960:  yych = *++YYCURSOR;",
          "961:  if (yych <= '/') goto yy18;",
          "962:  if (yych >= ':') goto yy18;",
          "963: yy54:",
          "964:  ++YYCURSOR;",
          "965:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "966:  yych = *YYCURSOR;",
          "967:  if (yych <= '/') goto yy18;",
          "968:  if (yych <= '9') goto yy54;",
          "969:  if (yych <= ':') goto yy78;",
          "970:  goto yy18;",
          "971: yy56:",
          "972:  yych = *++YYCURSOR;",
          "973:  if (yych <= '/') goto yy18;",
          "974:  if (yych >= ':') goto yy18;",
          "975: yy57:",
          "976:  ++YYCURSOR;",
          "977:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "978:  yych = *YYCURSOR;",
          "979:  if (yych <= '/') goto yy18;",
          "980:  if (yych <= '9') goto yy57;",
          "981:  if (yych == ';') goto yy79;",
          "982:  goto yy18;",
          "983: yy59:",
          "987: yy60:",
          "988:  ++YYCURSOR;",
          "989:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "990:  yych = *YYCURSOR;",
          "991:  if (yych <= '/') goto yy18;",
          "992:  if (yych <= '9') goto yy60;",
          "993:  if (yych <= ':') goto yy81;",
          "994:  goto yy18;",
          "995: yy62:",
          "996:  yych = *++YYCURSOR;",
          "997:  if (yych == '\"') goto yy82;",
          "998:  goto yy18;",
          "999: yy63:",
          "1000:  ++YYCURSOR;",
          "1001: #line 625 \"ext/standard/var_unserializer.re\"",
          "1002:  {",
          "1003:  zend_long id;",
          "1006:  if (!var_hash) return 0;",
          "1008:  id = parse_iv(start + 2) - 1;",
          "1009:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1010:   return 0;",
          "1011:  }",
          "1013:  zval_ptr_dtor(rval);",
          "1014:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1015:   ZVAL_UNDEF(rval);",
          "1016:   return 1;",
          "1017:  }",
          "1018:  if (Z_ISREF_P(rval_ref)) {",
          "1019:   ZVAL_COPY(rval, rval_ref);",
          "1020:  } else {",
          "1021:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1022:   ZVAL_COPY(rval, rval_ref);",
          "1023:  }",
          "1025:  return 1;",
          "1026: }",
          "1027: #line 1028 \"ext/standard/var_unserializer.c\"",
          "1028: yy65:",
          "1029:  yych = *++YYCURSOR;",
          "1030:  if (yych == '\"') goto yy84;",
          "1031:  goto yy18;",
          "1032: yy66:",
          "1033:  yych = *++YYCURSOR;",
          "1034:  if (yych == '{') goto yy86;",
          "1035:  goto yy18;",
          "1036: yy67:",
          "1037:  ++YYCURSOR;",
          "1038: #line 682 \"ext/standard/var_unserializer.re\"",
          "1039:  {",
          "1041:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1042:  return 1;",
          "1043: }",
          "1044: #line 1045 \"ext/standard/var_unserializer.c\"",
          "1045: yy69:",
          "1051:   if (yych <= '9') goto yy69;",
          "1056:    goto yy73;",
          "1058:    if (yych == 'e') goto yy73;",
          "1062: yy71:",
          "1064: #line 730 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1174:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1175:  return 1;",
          "1176: }",
          "1179:  yych = *++YYCURSOR;",
          "1180:  if (yych <= ',') {",
          "1182:  } else {",
          "1184:   if (yych <= '/') goto yy18;",
          "1186:   goto yy18;",
          "1187:  }",
          "1189:  yych = *++YYCURSOR;",
          "1205:  goto yy18;",
          "1207:  yych = *++YYCURSOR;",
          "1210:  goto yy18;",
          "1235:  ++YYCURSOR;",
          "1237:  {",
          "1284:  if (start[2] == '-' || start[2] == '+') {",
          "1285:   digits--;",
          "",
          "[Removed Lines]",
          "1177: #line 1178 \"ext/standard/var_unserializer.c\"",
          "1178: yy65:",
          "1181:   if (yych != '+') goto yy18;",
          "1183:   if (yych <= '-') goto yy66;",
          "1185:   if (yych <= '9') goto yy67;",
          "1188: yy66:",
          "1190:  if (yych <= ',') {",
          "1191:   if (yych == '+') goto yy69;",
          "1192:   goto yy18;",
          "1193:  } else {",
          "1194:   if (yych <= '-') goto yy69;",
          "1195:   if (yych <= '/') goto yy18;",
          "1196:   if (yych >= ':') goto yy18;",
          "1197:  }",
          "1198: yy67:",
          "1199:  ++YYCURSOR;",
          "1200:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1201:  yych = *YYCURSOR;",
          "1202:  if (yych <= '/') goto yy18;",
          "1203:  if (yych <= '9') goto yy67;",
          "1204:  if (yych == ';') goto yy63;",
          "1206: yy69:",
          "1208:  if (yych <= '/') goto yy18;",
          "1209:  if (yych <= '9') goto yy67;",
          "1211: yy70:",
          "1212:  ++YYCURSOR;",
          "1213:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1214:  yych = *YYCURSOR;",
          "1215:  if (yych <= ';') {",
          "1216:   if (yych <= '/') goto yy18;",
          "1217:   if (yych <= '9') goto yy70;",
          "1218:   if (yych <= ':') goto yy18;",
          "1219:   goto yy63;",
          "1220:  } else {",
          "1221:   if (yych <= 'E') {",
          "1222:    if (yych <= 'D') goto yy18;",
          "1223:    goto yy65;",
          "1224:   } else {",
          "1225:    if (yych == 'e') goto yy65;",
          "1226:    goto yy18;",
          "1227:   }",
          "1228:  }",
          "1229: yy72:",
          "1230:  yych = *++YYCURSOR;",
          "1231:  if (yych != 'F') goto yy18;",
          "1232: yy73:",
          "1233:  yych = *++YYCURSOR;",
          "1234:  if (yych != ';') goto yy18;",
          "1236: #line 691 \"ext/standard/var_unserializer.re\"",
          "1240:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1241:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1242:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1243:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1244:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1245:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1246:  } else {",
          "1247:   ZVAL_NULL(rval);",
          "1248:  }",
          "1250:  return 1;",
          "1251: }",
          "1252: #line 1253 \"ext/standard/var_unserializer.c\"",
          "1253: yy76:",
          "1254:  yych = *++YYCURSOR;",
          "1255:  if (yych == 'N') goto yy73;",
          "1256:  goto yy18;",
          "1257: yy77:",
          "1258:  yych = *++YYCURSOR;",
          "1259:  if (yych <= ',') {",
          "1260:   if (yych != '+') goto yy18;",
          "1261:  } else {",
          "1262:   if (yych <= '-') goto yy78;",
          "1263:   if (yych <= '/') goto yy18;",
          "1264:   if (yych <= '9') goto yy79;",
          "1265:   goto yy18;",
          "1266:  }",
          "1267: yy78:",
          "1268:  yych = *++YYCURSOR;",
          "1269:  if (yych <= '/') goto yy18;",
          "1270:  if (yych >= ':') goto yy18;",
          "1271: yy79:",
          "1272:  ++YYCURSOR;",
          "1273:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1274:  yych = *YYCURSOR;",
          "1275:  if (yych <= '/') goto yy18;",
          "1276:  if (yych <= '9') goto yy79;",
          "1277:  if (yych != ';') goto yy18;",
          "1278:  ++YYCURSOR;",
          "1279: #line 665 \"ext/standard/var_unserializer.re\"",
          "1280:  {",
          "1281: #if SIZEOF_ZEND_LONG == 4",
          "1282:  int digits = YYCURSOR - start - 3;",
          "",
          "[Added Lines]",
          "1073: #line 1074 \"ext/standard/var_unserializer.c\"",
          "1074: yy73:",
          "1077:   if (yych == '+') goto yy88;",
          "1078:   goto yy18;",
          "1080:   if (yych <= '-') goto yy88;",
          "1082:   if (yych <= '9') goto yy89;",
          "1085: yy74:",
          "1087:  if (yych == 'F') goto yy91;",
          "1089: yy75:",
          "1091:  if (yych == 'N') goto yy91;",
          "1093: yy76:",
          "1095: #line 688 \"ext/standard/var_unserializer.re\"",
          "1097: #if SIZEOF_ZEND_LONG == 4",
          "1098:  int digits = YYCURSOR - start - 3;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1302:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1303:  return 1;",
          "1304: }",
          "1340:  yych = *++YYCURSOR;",
          "1350:  ++YYCURSOR;",
          "1352:  {",
          "1353:  zend_long id;",
          "",
          "[Removed Lines]",
          "1305: #line 1306 \"ext/standard/var_unserializer.c\"",
          "1306: yy83:",
          "1307:  yych = *++YYCURSOR;",
          "1308:  if (yych <= '/') goto yy18;",
          "1309:  if (yych >= '2') goto yy18;",
          "1310:  yych = *++YYCURSOR;",
          "1311:  if (yych != ';') goto yy18;",
          "1312:  ++YYCURSOR;",
          "1313: #line 659 \"ext/standard/var_unserializer.re\"",
          "1314:  {",
          "1316:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1317:  return 1;",
          "1318: }",
          "1319: #line 1320 \"ext/standard/var_unserializer.c\"",
          "1320: yy87:",
          "1321:  ++YYCURSOR;",
          "1322: #line 653 \"ext/standard/var_unserializer.re\"",
          "1323:  {",
          "1325:  ZVAL_NULL(rval);",
          "1326:  return 1;",
          "1327: }",
          "1328: #line 1329 \"ext/standard/var_unserializer.c\"",
          "1329: yy89:",
          "1330:  yych = *++YYCURSOR;",
          "1331:  if (yych <= ',') {",
          "1332:   if (yych != '+') goto yy18;",
          "1333:  } else {",
          "1334:   if (yych <= '-') goto yy90;",
          "1335:   if (yych <= '/') goto yy18;",
          "1336:   if (yych <= '9') goto yy91;",
          "1337:   goto yy18;",
          "1338:  }",
          "1339: yy90:",
          "1341:  if (yych <= '/') goto yy18;",
          "1342:  if (yych >= ':') goto yy18;",
          "1343: yy91:",
          "1344:  ++YYCURSOR;",
          "1345:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1346:  yych = *YYCURSOR;",
          "1347:  if (yych <= '/') goto yy18;",
          "1348:  if (yych <= '9') goto yy91;",
          "1349:  if (yych != ';') goto yy18;",
          "1351: #line 628 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1121: #line 1122 \"ext/standard/var_unserializer.c\"",
          "1122: yy78:",
          "1124:  if (yych == '\"') goto yy92;",
          "1125:  goto yy18;",
          "1126: yy79:",
          "1128: #line 651 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1374:  return 1;",
          "1375: }",
          "1376: #line 1377 \"ext/standard/var_unserializer.c\"",
          "1378:  yych = *++YYCURSOR;",
          "1379:  if (yych <= ',') {",
          "1381:  } else {",
          "1382:   if (yych <= '-') goto yy96;",
          "1383:   if (yych <= '/') goto yy18;",
          "1386:  }",
          "1392:  ++YYCURSOR;",
          "1393:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1394:  yych = *YYCURSOR;",
          "1395:  if (yych <= '/') goto yy18;",
          "1398:  ++YYCURSOR;",
          "1400:  {",
          "1408:   return 0;",
          "1409:  }",
          "1415:  }",
          "1418:  } else {",
          "1421:  }",
          "1423:  return 1;",
          "1424: }",
          "1426: }",
          "1430:  return 0;",
          "",
          "[Removed Lines]",
          "1377: yy95:",
          "1380:   if (yych != '+') goto yy18;",
          "1384:   if (yych <= '9') goto yy97;",
          "1385:   goto yy18;",
          "1387: yy96:",
          "1388:  yych = *++YYCURSOR;",
          "1389:  if (yych <= '/') goto yy18;",
          "1390:  if (yych >= ':') goto yy18;",
          "1391: yy97:",
          "1396:  if (yych <= '9') goto yy97;",
          "1397:  if (yych != ';') goto yy18;",
          "1399: #line 602 \"ext/standard/var_unserializer.re\"",
          "1401:  zend_long id;",
          "1404:  if (!var_hash) return 0;",
          "1406:  id = parse_iv(start + 2) - 1;",
          "1407:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1411:  zval_ptr_dtor(rval);",
          "1412:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1413:   ZVAL_UNDEF(rval);",
          "1414:   return 1;",
          "1416:  if (Z_ISREF_P(rval_ref)) {",
          "1417:   ZVAL_COPY(rval, rval_ref);",
          "1419:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1420:   ZVAL_COPY(rval, rval_ref);",
          "1425: #line 1426 \"ext/standard/var_unserializer.c\"",
          "1427: #line 977 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1153: #line 1154 \"ext/standard/var_unserializer.c\"",
          "1154: yy81:",
          "1155:  yych = *++YYCURSOR;",
          "1156:  if (yych == '\"') goto yy94;",
          "1157:  goto yy18;",
          "1158: yy82:",
          "1159:  ++YYCURSOR;",
          "1160: #line 840 \"ext/standard/var_unserializer.re\"",
          "1161:  {",
          "1162:  size_t len, len2, len3, maxlen;",
          "1163:  zend_long elements;",
          "1164:  char *str;",
          "1165:  zend_string *class_name;",
          "1166:  zend_class_entry *ce;",
          "1167:  int incomplete_class = 0;",
          "1169:  int custom_object = 0;",
          "1171:  zval user_func;",
          "1172:  zval retval;",
          "1173:  zval args[1];",
          "1175:     if (!var_hash) return 0;",
          "1176:  if (*start == 'C') {",
          "1177:   custom_object = 1;",
          "1178:  }",
          "1180:  len2 = len = parse_uiv(start + 2);",
          "1181:  maxlen = max - YYCURSOR;",
          "1182:  if (maxlen < len || len == 0) {",
          "1184:   return 0;",
          "1185:  }",
          "1187:  str = (char*)YYCURSOR;",
          "1189:  YYCURSOR += len;",
          "1191:  if (*(YYCURSOR) != '\"') {",
          "1193:   return 0;",
          "1194:  }",
          "1195:  if (*(YYCURSOR+1) != ':') {",
          "1197:   return 0;",
          "1198:  }",
          "1200:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1201:  if (len3 != len)",
          "1202:  {",
          "1204:   return 0;",
          "1205:  }",
          "1207:  class_name = zend_string_init(str, len, 0);",
          "1209:  do {",
          "1210:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "1211:    incomplete_class = 1;",
          "1212:    ce = PHP_IC_ENTRY;",
          "1213:    break;",
          "1214:   }",
          "1217:   BG(serialize_lock)++;",
          "1218:   ce = zend_lookup_class(class_name);",
          "1219:   if (ce) {",
          "1220:    BG(serialize_lock)--;",
          "1221:    if (EG(exception)) {",
          "1222:     zend_string_release(class_name);",
          "1223:     return 0;",
          "1224:    }",
          "1225:    break;",
          "1226:   }",
          "1227:   BG(serialize_lock)--;",
          "1229:   if (EG(exception)) {",
          "1230:    zend_string_release(class_name);",
          "1231:    return 0;",
          "1232:   }",
          "1235:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1236:    incomplete_class = 1;",
          "1237:    ce = PHP_IC_ENTRY;",
          "1238:    break;",
          "1239:   }",
          "1242:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1244:   ZVAL_STR_COPY(&args[0], class_name);",
          "1245:   BG(serialize_lock)++;",
          "1246:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1247:    BG(serialize_lock)--;",
          "1248:    if (EG(exception)) {",
          "1249:     zend_string_release(class_name);",
          "1250:     zval_ptr_dtor(&user_func);",
          "1251:     zval_ptr_dtor(&args[0]);",
          "1252:     return 0;",
          "1253:    }",
          "1254:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1255:    incomplete_class = 1;",
          "1256:    ce = PHP_IC_ENTRY;",
          "1257:    zval_ptr_dtor(&user_func);",
          "1258:    zval_ptr_dtor(&args[0]);",
          "1259:    break;",
          "1260:   }",
          "1261:   BG(serialize_lock)--;",
          "1262:   zval_ptr_dtor(&retval);",
          "1263:   if (EG(exception)) {",
          "1264:    zend_string_release(class_name);",
          "1265:    zval_ptr_dtor(&user_func);",
          "1266:    zval_ptr_dtor(&args[0]);",
          "1267:    return 0;",
          "1268:   }",
          "1271:   BG(serialize_lock)++;",
          "1272:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1273:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1274:    incomplete_class = 1;",
          "1275:    ce = PHP_IC_ENTRY;",
          "1276:   }",
          "1277:   BG(serialize_lock)--;",
          "1279:   zval_ptr_dtor(&user_func);",
          "1280:   zval_ptr_dtor(&args[0]);",
          "1281:   break;",
          "1282:  } while (1);",
          "1286:  if (custom_object) {",
          "1287:   int ret;",
          "1289:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1291:   if (ret && incomplete_class) {",
          "1292:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1293:   }",
          "1294:   zend_string_release(class_name);",
          "1295:   return ret;",
          "1296:  }",
          "1298:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1300:  if (elements < 0) {",
          "1301:     zend_string_release(class_name);",
          "1302:     return 0;",
          "1303:  }",
          "1305:  if (incomplete_class) {",
          "1306:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1307:  }",
          "1308:  zend_string_release(class_name);",
          "1310:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1311: }",
          "1312: #line 1313 \"ext/standard/var_unserializer.c\"",
          "1313: yy84:",
          "1314:  ++YYCURSOR;",
          "1315: #line 771 \"ext/standard/var_unserializer.re\"",
          "1316:  {",
          "1317:  size_t len, maxlen;",
          "1318:  zend_string *str;",
          "1320:  len = parse_uiv(start + 2);",
          "1321:  maxlen = max - YYCURSOR;",
          "1322:  if (maxlen < len) {",
          "1324:   return 0;",
          "1325:  }",
          "1327:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1328:   return 0;",
          "1329:  }",
          "1331:  if (*(YYCURSOR) != '\"') {",
          "1332:   zend_string_free(str);",
          "1334:   return 0;",
          "1335:  }",
          "1337:  if (*(YYCURSOR + 1) != ';') {",
          "1338:   efree(str);",
          "1340:   return 0;",
          "1341:  }",
          "1343:  YYCURSOR += 2;",
          "1346:  ZVAL_STR(rval, str);",
          "1347:  return 1;",
          "1348: }",
          "1349: #line 1350 \"ext/standard/var_unserializer.c\"",
          "1350: yy86:",
          "1351:  ++YYCURSOR;",
          "1352: #line 805 \"ext/standard/var_unserializer.re\"",
          "1353:  {",
          "1354:  zend_long elements = parse_iv(start + 2);",
          "1357:     if (!var_hash) return 0;",
          "1359:  if (elements < 0) {",
          "1360:   return 0;",
          "1361:  }",
          "1363:  array_init_size(rval, elements);",
          "1364:  if (elements) {",
          "1367:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1368:  }",
          "1370:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1371:   return 0;",
          "1372:  }",
          "1374:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1375: }",
          "1377: yy88:",
          "1380:   if (yych == '+') goto yy96;",
          "1381:   goto yy18;",
          "1385:   if (yych >= ':') goto yy18;",
          "1387: yy89:",
          "1392:  if (yych <= '9') goto yy89;",
          "1393:  if (yych == ';') goto yy71;",
          "1394:  goto yy18;",
          "1395: yy91:",
          "1396:  yych = *++YYCURSOR;",
          "1397:  if (yych == ';') goto yy97;",
          "1398:  goto yy18;",
          "1399: yy92:",
          "1401: #line 829 \"ext/standard/var_unserializer.re\"",
          "1403:  long elements;",
          "1404:     if (!var_hash) return 0;",
          "1406:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1407:  if (elements < 0) {",
          "1408:   return 0;",
          "1409:  }",
          "1410:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1411: }",
          "1412: #line 1413 \"ext/standard/var_unserializer.c\"",
          "1413: yy94:",
          "1414:  ++YYCURSOR;",
          "1415: #line 739 \"ext/standard/var_unserializer.re\"",
          "1416:  {",
          "1417:  size_t len, maxlen;",
          "1418:  char *str;",
          "1420:  len = parse_uiv(start + 2);",
          "1421:  maxlen = max - YYCURSOR;",
          "1422:  if (maxlen < len) {",
          "1427:  str = (char*)YYCURSOR;",
          "1429:  YYCURSOR += len;",
          "1431:  if (*(YYCURSOR) != '\"') {",
          "1433:   return 0;",
          "1436:  if (*(YYCURSOR + 1) != ';') {",
          "1438:   return 0;",
          "1439:  }",
          "1441:  YYCURSOR += 2;",
          "1444:  ZVAL_STRINGL(rval, str, len);",
          "1445:  return 1;",
          "1446: }",
          "1447: #line 1448 \"ext/standard/var_unserializer.c\"",
          "1448: yy96:",
          "1449:  yych = *++YYCURSOR;",
          "1450:  if (yych <= '/') goto yy18;",
          "1451:  if (yych <= '9') goto yy89;",
          "1452:  goto yy18;",
          "1453: yy97:",
          "1454:  ++YYCURSOR;",
          "1455: #line 714 \"ext/standard/var_unserializer.re\"",
          "1456:  {",
          "1459:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1460:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1461:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1462:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1463:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1464:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1466:   ZVAL_NULL(rval);",
          "1471: #line 1472 \"ext/standard/var_unserializer.c\"",
          "1473: #line 1000 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "69: #define VAR_ENTRIES_MAX 1024",
          "70: #define VAR_ENTRIES_DBG 0",
          "72: typedef struct {",
          "73:  zval *data[VAR_ENTRIES_MAX];",
          "74:  zend_long used_slots;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "73: #define VAR_WAKEUP_FLAG 1",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "137:         (*var_hashx)->last_dtor = var_hash;",
          "138:     }",
          "139:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "140:     return &var_hash->data[var_hash->used_slots++];",
          "141: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "143:  Z_ACCESS_FLAGS(var_hash->data[var_hash->used_slots]) = 0;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "184:  zend_long i;",
          "185:  var_entries *var_hash = (*var_hashx)->first;",
          "186:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "187: #if VAR_ENTRIES_DBG",
          "188:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "189: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "191:  zend_bool wakeup_failed = 0;",
          "192:  zval wakeup_name;",
          "193:  ZVAL_UNDEF(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "197:  while (var_dtor_hash) {",
          "198:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "199: #if VAR_ENTRIES_DBG",
          "200:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "201: #endif",
          "203:   }",
          "204:   next = var_dtor_hash->next;",
          "205:   efree_size(var_dtor_hash, sizeof(var_dtor_entries));",
          "206:   var_dtor_hash = next;",
          "207:  }",
          "208: }",
          "",
          "[Removed Lines]",
          "202:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "",
          "[Added Lines]",
          "207:    zval *zv = &var_dtor_hash->data[i];",
          "213:    if (Z_ACCESS_FLAGS_P(zv) == VAR_WAKEUP_FLAG) {",
          "214:     if (!wakeup_failed) {",
          "215:      zval retval;",
          "216:      if (Z_ISUNDEF(wakeup_name)) {",
          "217:       ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "218:      }",
          "220:      BG(serialize_lock)++;",
          "221:      if (call_user_function_ex(CG(function_table), zv, &wakeup_name, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "222:       wakeup_failed = 1;",
          "223:       GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "224:      }",
          "225:      BG(serialize_lock)--;",
          "227:      zval_ptr_dtor(&retval);",
          "228:     } else {",
          "229:      GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "230:     }",
          "231:    }",
          "233:    zval_ptr_dtor(zv);",
          "240:  zval_ptr_dtor(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "508: #endif",
          "509: static inline int object_common2(UNSERIALIZE_PARAMETER, zend_long elements)",
          "510: {",
          "513:  HashTable *ht;",
          "514:  zend_bool has_wakeup;",
          "",
          "[Removed Lines]",
          "511:  zval retval;",
          "512:  zval fname;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "533:  ZVAL_DEREF(rval);",
          "534:  if (has_wakeup) {",
          "547:  }",
          "549:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "",
          "[Removed Lines]",
          "535:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "536:   BG(serialize_lock)++;",
          "537:   if (call_user_function_ex(CG(function_table), rval, &fname, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "538:    GC_FLAGS(Z_OBJ_P(rval)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "539:   }",
          "540:   BG(serialize_lock)--;",
          "541:   zval_dtor(&fname);",
          "542:   zval_dtor(&retval);",
          "543:  }",
          "545:  if (EG(exception)) {",
          "546:   return 0;",
          "",
          "[Added Lines]",
          "567:   zval *wakeup_var = var_tmp_var(var_hash);",
          "568:   ZVAL_COPY(wakeup_var, rval);",
          "569:   Z_ACCESS_FLAGS_P(wakeup_var) = VAR_WAKEUP_FLAG;",
          "",
          "---------------"
        ]
      }
    }
  ]
}