{
  "cve_id": "CVE-2016-7144",
  "cve_desc": "The m_authenticate function in modules/m_sasl.c in UnrealIRCd before 3.2.10.7 and 4.x before 4.0.6 allows remote attackers to spoof certificate fingerprints and consequently log in as another user via a crafted AUTHENTICATE parameter.",
  "repo": "unrealircd/unrealircd",
  "patch_hash": "f473e355e1dc422c4f019dbf86bc50ba1a34a766",
  "patch_info": {
    "commit_hash": "f473e355e1dc422c4f019dbf86bc50ba1a34a766",
    "repo": "unrealircd/unrealircd",
    "commit_url": "https://github.com/unrealircd/unrealircd/commit/f473e355e1dc422c4f019dbf86bc50ba1a34a766",
    "files": [
      "src/modules/m_sasl.c"
    ],
    "message": "Fix AUTHENTICATE bug",
    "before_after_code_files": [
      "src/modules/m_sasl.c||src/modules/m_sasl.c"
    ]
  },
  "patch_diff": {
    "src/modules/m_sasl.c||src/modules/m_sasl.c": [
      "File: src/modules/m_sasl.c -> src/modules/m_sasl.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "230:   return 0;",
      "231:  }",
      "233:  if (strlen(parv[1]) > 400)",
      "234:  {",
      "235:   sendto_one(sptr, err_str(ERR_SASLTOOLONG), me.name, BadPtr(sptr->name) ? \"*\" : sptr->name);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "233:  if ((parv[1][0] == ':') || strchr(parv[1], ' '))",
      "234:  {",
      "235:   sendto_one(sptr, err_str(ERR_CANNOTDOCOMMAND), me.name, \"*\", \"AUTHENTICATE\", \"Invalid parameter\");",
      "236:   return 0;",
      "237:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "fb629bd489a351a01f5e13a5305b7e441cbdc5cb",
      "candidate_info": {
        "commit_hash": "fb629bd489a351a01f5e13a5305b7e441cbdc5cb",
        "repo": "unrealircd/unrealircd",
        "commit_url": "https://github.com/unrealircd/unrealircd/commit/fb629bd489a351a01f5e13a5305b7e441cbdc5cb",
        "files": [
          "src/modules/m_sasl.c"
        ],
        "message": "Fix AUTHENTICATE bug (SASL)",
        "before_after_code_files": [
          "src/modules/m_sasl.c||src/modules/m_sasl.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "src/modules/m_sasl.c||src/modules/m_sasl.c"
          ],
          "candidate": [
            "src/modules/m_sasl.c||src/modules/m_sasl.c"
          ]
        }
      },
      "candidate_diff": {
        "src/modules/m_sasl.c||src/modules/m_sasl.c": [
          "File: src/modules/m_sasl.c -> src/modules/m_sasl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "264:   return 0;",
          "265:  }",
          "267:  if (strlen(parv[1]) > 400)",
          "268:  {",
          "269:   sendto_one(sptr, err_str(ERR_SASLTOOLONG), me.name, BadPtr(sptr->name) ? \"*\" : sptr->name);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "267:  if ((parv[1][0] == ':') || strchr(parv[1], ' '))",
          "268:  {",
          "269:   sendto_one(sptr, err_str(ERR_CANNOTDOCOMMAND), me.name, \"*\", \"AUTHENTICATE\", \"Invalid parameter\");",
          "270:   return 0;",
          "271:  }",
          "",
          "---------------"
        ]
      }
    }
  ]
}