{
  "cve_id": "CVE-2015-8711",
  "cve_desc": "epan/dissectors/packet-nbap.c in the NBAP dissector in Wireshark 1.12.x before 1.12.9 and 2.0.x before 2.0.1 does not validate conversation data, which allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted packet.",
  "repo": "wireshark/wireshark",
  "patch_hash": "23379ae3624df82c170f48e5bb3250a97ec61c13",
  "patch_info": {
    "commit_hash": "23379ae3624df82c170f48e5bb3250a97ec61c13",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/23379ae3624df82c170f48e5bb3250a97ec61c13",
    "files": [
      "asn1/nbap/nbap.cnf",
      "epan/dissectors/packet-nbap.c"
    ],
    "message": "NBAP : Verify conversation proto data exists before trying to access it\n\nBug 11841\nChange-Id: Ic0dea6491a68a042ddc0f2dbee19739e4568b18c\nReviewed-on: https://code.wireshark.org/review/12576\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nTested-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nReviewed-by: Michael Mann <mmann78@netscape.net>",
    "before_after_code_files": [
      "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
      "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
    ]
  },
  "patch_diff": {
    "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
      "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
      "--- Hunk 1 ---",
      "[Context before]",
      "1410: address     dst_addr, null_addr;",
      "1411: conversation_t *conversation,*old_conversation = NULL;",
      "1412: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
      "1414: transportLayerAddress_ipv4 = 0;",
      "1415: BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1413: void *conv_proto_data = NULL;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1454:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
      "1455:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
      "1461:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
      "1462:                 umts_fp_conversation_info->division          = Division_FDD;",
      "",
      "[Removed Lines]",
      "1457:                 if (old_conversation)",
      "1458:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
      "",
      "[Added Lines]",
      "1458:                 if (old_conversation) {",
      "1459:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
      "1460:                     if (conv_proto_data)",
      "1461:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
      "1462:                 }",
      "",
      "---------------"
    ],
    "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
      "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "10028: static int",
      "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "10032:                                                             0U, 255U, &cfn, FALSE);",
      "",
      "[Removed Lines]",
      "10030: #line 2148 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "10030: #line 2151 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "10281: static int",
      "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
      "10285: address     null_addr;",
      "10286: conversation_t   *conversation = NULL;",
      "",
      "[Removed Lines]",
      "10283: #line 2113 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "10283: #line 2116 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "11503: static int",
      "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
      "",
      "[Removed Lines]",
      "11505: #line 1972 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "11505: #line 1975 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "11637: static int",
      "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
      "",
      "[Removed Lines]",
      "11639: #line 1626 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "11639: #line 1629 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "11655: static int",
      "11656: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "11658:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "11659:                                                             1U, 1504U, NULL, TRUE);",
      "",
      "[Removed Lines]",
      "11657: #line 1728 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "11657: #line 1731 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "12078: static int",
      "12079: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "12081:     address     dst_addr;",
      "12082:     transportLayerAddress_ipv4 = 0;",
      "12083:     BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "12080: #line 1979 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "12080: #line 1982 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "12123: static int",
      "12124: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "12126:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "12127:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
      "",
      "[Removed Lines]",
      "12125: #line 1616 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "12125: #line 1619 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "13344: static int",
      "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
      "",
      "[Removed Lines]",
      "13346: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "13346: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "18028: static int",
      "18029: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18032:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "18033:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
      "",
      "[Removed Lines]",
      "18030: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18030: #line 1608 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "18163: static int",
      "18164: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18166:     num_items++;",
      "",
      "[Removed Lines]",
      "18165: #line 1602 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18165: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "18180: static int",
      "18181: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18183:     num_items = 0;",
      "18185:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
      "",
      "[Removed Lines]",
      "18182: #line 1595 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18182: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "18396: static int",
      "18397: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18400:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
      "18401:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
      "",
      "[Removed Lines]",
      "18398: #line 1590 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18398: #line 1593 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "18471: static int",
      "18472: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "18474: guint32 no_ddi_entries, i;",
      "18475: address     null_addr;",
      "18476: nbap_edch_port_info_t *old_info;",
      "",
      "[Removed Lines]",
      "18473: #line 1498 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "18473: #line 1501 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "18617: address     dst_addr, null_addr;",
      "18618: conversation_t *conversation,*old_conversation = NULL;",
      "18619: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
      "18621: transportLayerAddress_ipv4 = 0;",
      "18622: BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "18620: void *conv_proto_data = NULL;",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "18663:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
      "18664:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
      "18670:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
      "18671:                 umts_fp_conversation_info->division          = Division_FDD;",
      "",
      "[Removed Lines]",
      "18666:                 if (old_conversation)",
      "18667:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
      "",
      "[Added Lines]",
      "18667:                 if (old_conversation) {",
      "18668:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
      "18669:                     if (conv_proto_data)",
      "18670:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
      "18671:                 }",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "23306: static int",
      "23307: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "23308: #line 1999 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23311: #line 2002 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "23467: static int",
      "23468: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23472:     address     dst_addr;",
      "",
      "[Removed Lines]",
      "23469: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23472: #line 1709 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "23570: static int",
      "23571: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23573:     guint32 rlc_mode;",
      "23575:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
      "",
      "[Removed Lines]",
      "23572: #line 1633 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23575: #line 1636 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "23611: static int",
      "23612: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23614:     num_items++;",
      "",
      "[Removed Lines]",
      "23613: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23616: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "23645: static int",
      "23646: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23649:     int protocol_ie_id;",
      "23650:     guint32 i;",
      "",
      "[Removed Lines]",
      "23647: #line 1657 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23650: #line 1660 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "23689: static int",
      "23690: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23692:     guint32 hsdsch_physical_layer_category;",
      "23694:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
      "",
      "[Removed Lines]",
      "23691: #line 1650 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23694: #line 1653 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "23757: static int",
      "23758: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "23759: #line 1758 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23762: #line 1761 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "23894: static int",
      "23895: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23897:     address     dst_addr;",
      "23898:     transportLayerAddress_ipv4 = 0;",
      "23899:     BindingID_port = 0;",
      "",
      "[Removed Lines]",
      "23896: #line 1847 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23899: #line 1850 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "23952: static int",
      "23953: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "23955:     num_items = 1;",
      "",
      "[Removed Lines]",
      "23954: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "23957: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "24087: static int",
      "24088: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "24089: #line 1867 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24092: #line 1870 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "24209: static int",
      "24210: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "",
      "[Removed Lines]",
      "24211: #line 1735 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24214: #line 1738 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 27 ---",
      "[Context before]",
      "24320: static int",
      "24321: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24323:     num_items++;",
      "",
      "[Removed Lines]",
      "24322: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24325: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 28 ---",
      "[Context before]",
      "24736: static int",
      "24737: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24740:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
      "",
      "[Removed Lines]",
      "24738: #line 2077 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24741: #line 2080 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 29 ---",
      "[Context before]",
      "24930: static int",
      "24931: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24933:     num_items++;",
      "",
      "[Removed Lines]",
      "24932: #line 1694 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24935: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 30 ---",
      "[Context before]",
      "24947: static int",
      "24948: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "24950:     num_items = 0;",
      "",
      "[Removed Lines]",
      "24949: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "24952: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 31 ---",
      "[Context before]",
      "28049: static int",
      "28050: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
      "28053: nbap_com_context_id_t *cur_val;",
      "",
      "[Removed Lines]",
      "28051: #line 2091 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "28054: #line 2094 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------",
      "--- Hunk 32 ---",
      "[Context before]",
      "41065: actx->pinfo->link_dir=P2P_DIR_DL;",
      "",
      "[Removed Lines]",
      "41068: #line 2140 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "[Added Lines]",
      "41071: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "254731ee05ab663fb79f3431ac0aa141b7065de0",
      "candidate_info": {
        "commit_hash": "254731ee05ab663fb79f3431ac0aa141b7065de0",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/254731ee05ab663fb79f3431ac0aa141b7065de0",
        "files": [
          "asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "NBAP : Verify conversation proto data exists before trying to access it\n\nBug 11841\nChange-Id: Ic0dea6491a68a042ddc0f2dbee19739e4568b18c\nReviewed-on: https://code.wireshark.org/review/12576\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nTested-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 23379ae3624df82c170f48e5bb3250a97ec61c13)\nReviewed-on: https://code.wireshark.org/review/12585",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1410: address     dst_addr, null_addr;",
          "1411: conversation_t *conversation,*old_conversation = NULL;",
          "1412: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
          "1414: transportLayerAddress_ipv4 = 0;",
          "1415: BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1413: void *conv_proto_data = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1454:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "1455:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "1461:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "1462:                 umts_fp_conversation_info->division          = Division_FDD;",
          "",
          "[Removed Lines]",
          "1457:                 if (old_conversation)",
          "1458:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "1458:                 if (old_conversation) {",
          "1459:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
          "1460:                     if (conv_proto_data)",
          "1461:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
          "1462:                 }",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10028: static int",
          "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10032:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10030: #line 2148 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10030: #line 2151 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10281: static int",
          "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10285: address     null_addr;",
          "10286: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10283: #line 2113 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10283: #line 2116 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11503: static int",
          "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11505: #line 1972 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11505: #line 1975 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11637: static int",
          "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11639: #line 1626 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11639: #line 1629 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11655: static int",
          "11656: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11658:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11659:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11657: #line 1728 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11657: #line 1731 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12078: static int",
          "12079: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12081:     address     dst_addr;",
          "12082:     transportLayerAddress_ipv4 = 0;",
          "12083:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12080: #line 1979 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12080: #line 1982 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12123: static int",
          "12124: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12126:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12127:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12125: #line 1616 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12125: #line 1619 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "13344: static int",
          "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13346: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13346: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "18028: static int",
          "18029: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18032:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18033:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18030: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18030: #line 1608 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18163: static int",
          "18164: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18166:     num_items++;",
          "",
          "[Removed Lines]",
          "18165: #line 1602 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18165: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18180: static int",
          "18181: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18183:     num_items = 0;",
          "18185:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18182: #line 1595 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18182: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18396: static int",
          "18397: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18400:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18401:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18398: #line 1590 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18398: #line 1593 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18471: static int",
          "18472: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18474: guint32 no_ddi_entries, i;",
          "18475: address     null_addr;",
          "18476: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18473: #line 1498 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18473: #line 1501 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18617: address     dst_addr, null_addr;",
          "18618: conversation_t *conversation,*old_conversation = NULL;",
          "18619: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
          "18621: transportLayerAddress_ipv4 = 0;",
          "18622: BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "18620: void *conv_proto_data = NULL;",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18663:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "18664:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "18670:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "18671:                 umts_fp_conversation_info->division          = Division_FDD;",
          "",
          "[Removed Lines]",
          "18666:                 if (old_conversation)",
          "18667:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "18667:                 if (old_conversation) {",
          "18668:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
          "18669:                     if (conv_proto_data)",
          "18670:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
          "18671:                 }",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "23306: static int",
          "23307: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23308: #line 1999 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23311: #line 2002 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23467: static int",
          "23468: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23472:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23469: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23472: #line 1709 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23570: static int",
          "23571: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23573:     guint32 rlc_mode;",
          "23575:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23572: #line 1633 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23575: #line 1636 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23611: static int",
          "23612: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23614:     num_items++;",
          "",
          "[Removed Lines]",
          "23613: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23616: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23645: static int",
          "23646: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23649:     int protocol_ie_id;",
          "23650:     guint32 i;",
          "",
          "[Removed Lines]",
          "23647: #line 1657 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23650: #line 1660 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23689: static int",
          "23690: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23692:     guint32 hsdsch_physical_layer_category;",
          "23694:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23691: #line 1650 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23694: #line 1653 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23757: static int",
          "23758: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23759: #line 1758 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23762: #line 1761 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23894: static int",
          "23895: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23897:     address     dst_addr;",
          "23898:     transportLayerAddress_ipv4 = 0;",
          "23899:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23896: #line 1847 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23899: #line 1850 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23952: static int",
          "23953: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23955:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23954: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23957: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "24087: static int",
          "24088: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24089: #line 1867 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24092: #line 1870 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "24209: static int",
          "24210: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24211: #line 1735 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24214: #line 1738 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "24320: static int",
          "24321: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24323:     num_items++;",
          "",
          "[Removed Lines]",
          "24322: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24325: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24736: static int",
          "24737: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24740:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24738: #line 2077 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24741: #line 2080 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24930: static int",
          "24931: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24933:     num_items++;",
          "",
          "[Removed Lines]",
          "24932: #line 1694 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24935: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24947: static int",
          "24948: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24950:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24949: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24952: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "28049: static int",
          "28050: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28053: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28051: #line 2091 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28054: #line 2094 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "41065: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41068: #line 2140 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41071: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "332526590729331dcb71c4ea84f0dfa9617b9912",
      "candidate_info": {
        "commit_hash": "332526590729331dcb71c4ea84f0dfa9617b9912",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/332526590729331dcb71c4ea84f0dfa9617b9912",
        "files": [
          "asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "NBAP : Verify conversation proto data exists before trying to access it\n\nBug 11841\nChange-Id: Ic0dea6491a68a042ddc0f2dbee19739e4568b18c\nReviewed-on: https://code.wireshark.org/review/12576\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nTested-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 23379ae3624df82c170f48e5bb3250a97ec61c13)\nReviewed-on: https://code.wireshark.org/review/12585\n(cherry picked from commit 254731ee05ab663fb79f3431ac0aa141b7065de0)\nReviewed-on: https://code.wireshark.org/review/12586\n(cherry picked from commit 884d49c04ed79723586e9a031003487529a60f4d)\nReviewed-on: https://code.wireshark.org/review/13773\nReviewed-by: Balint Reczey <balint@balintreczey.hu>",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1411: address     dst_addr, null_addr;",
          "1412: conversation_t *conversation,*old_conversation = NULL;",
          "1413: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
          "1415: transportLayerAddress_ipv4 = 0;",
          "1416: BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1414: void *conv_proto_data = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1455:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "1456:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "1462:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "1463:                 umts_fp_conversation_info->division          = Division_FDD;",
          "",
          "[Removed Lines]",
          "1458:                 if (old_conversation)",
          "1459:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "1459:                 if (old_conversation) {",
          "1460:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
          "1461:                     if (conv_proto_data)",
          "1462:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
          "1463:                 }",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10039: static int",
          "10040: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10042:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10043:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10041: #line 2148 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10041: #line 2151 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10292: static int",
          "10293: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10295: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10296: address     null_addr;",
          "10297: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10294: #line 2113 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10294: #line 2116 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11514: static int",
          "11515: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11518:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11519:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11516: #line 1972 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11516: #line 1975 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11648: static int",
          "11649: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11652:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11653:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11650: #line 1626 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11650: #line 1629 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11666: static int",
          "11667: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11669:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11670:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11668: #line 1728 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11668: #line 1731 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12089: static int",
          "12090: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12092:     address     dst_addr;",
          "12093:     transportLayerAddress_ipv4 = 0;",
          "12094:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12091: #line 1979 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12091: #line 1982 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12134: static int",
          "12135: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12137:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12138:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12136: #line 1616 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12136: #line 1619 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "13355: static int",
          "13356: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13358:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13359:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13357: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13357: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "18039: static int",
          "18040: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18043:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18044:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18041: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18041: #line 1608 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18174: static int",
          "18175: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18177:     num_items++;",
          "",
          "[Removed Lines]",
          "18176: #line 1602 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18176: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18191: static int",
          "18192: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18194:     num_items = 0;",
          "18196:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18193: #line 1595 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18193: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18407: static int",
          "18408: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18411:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18412:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18409: #line 1590 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18409: #line 1593 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18482: static int",
          "18483: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18485: guint32 no_ddi_entries, i;",
          "18486: address     null_addr;",
          "18487: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18484: #line 1498 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18484: #line 1501 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18628: address     dst_addr, null_addr;",
          "18629: conversation_t *conversation,*old_conversation = NULL;",
          "18630: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
          "18632: transportLayerAddress_ipv4 = 0;",
          "18633: BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "18631: void *conv_proto_data = NULL;",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18674:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "18675:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "18681:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "18682:                 umts_fp_conversation_info->division          = Division_FDD;",
          "",
          "[Removed Lines]",
          "18677:                 if (old_conversation)",
          "18678:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "18678:                 if (old_conversation) {",
          "18679:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
          "18680:                     if (conv_proto_data)",
          "18681:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
          "18682:                 }",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "23317: static int",
          "23318: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23319: #line 1999 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23322: #line 2002 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23478: static int",
          "23479: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23483:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23480: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23483: #line 1709 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23581: static int",
          "23582: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23584:     guint32 rlc_mode;",
          "23586:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23583: #line 1633 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23586: #line 1636 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23622: static int",
          "23623: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23625:     num_items++;",
          "",
          "[Removed Lines]",
          "23624: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23627: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23656: static int",
          "23657: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23660:     int protocol_ie_id;",
          "23661:     guint32 i;",
          "",
          "[Removed Lines]",
          "23658: #line 1657 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23661: #line 1660 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23700: static int",
          "23701: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23703:     guint32 hsdsch_physical_layer_category;",
          "23705:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23702: #line 1650 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23705: #line 1653 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23768: static int",
          "23769: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23770: #line 1758 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23773: #line 1761 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23905: static int",
          "23906: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23908:     address     dst_addr;",
          "23909:     transportLayerAddress_ipv4 = 0;",
          "23910:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23907: #line 1847 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23910: #line 1850 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23963: static int",
          "23964: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23966:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23965: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23968: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "24098: static int",
          "24099: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24100: #line 1867 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24103: #line 1870 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "24220: static int",
          "24221: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24222: #line 1735 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24225: #line 1738 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "24331: static int",
          "24332: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24334:     num_items++;",
          "",
          "[Removed Lines]",
          "24333: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24336: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24747: static int",
          "24748: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24751:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24749: #line 2077 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24752: #line 2080 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24941: static int",
          "24942: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24944:     num_items++;",
          "",
          "[Removed Lines]",
          "24943: #line 1694 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24946: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24958: static int",
          "24959: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24961:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24960: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24963: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "28060: static int",
          "28061: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28064: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28062: #line 2091 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28065: #line 2094 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "41077: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41080: #line 2140 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41083: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "884d49c04ed79723586e9a031003487529a60f4d",
      "candidate_info": {
        "commit_hash": "884d49c04ed79723586e9a031003487529a60f4d",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/884d49c04ed79723586e9a031003487529a60f4d",
        "files": [
          "asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "NBAP : Verify conversation proto data exists before trying to access it\n\nBug 11841\nChange-Id: Ic0dea6491a68a042ddc0f2dbee19739e4568b18c\nReviewed-on: https://code.wireshark.org/review/12576\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nTested-by: Alexis La Goutte <alexis.lagoutte@gmail.com>\nReviewed-by: Michael Mann <mmann78@netscape.net>\n(cherry picked from commit 23379ae3624df82c170f48e5bb3250a97ec61c13)\nReviewed-on: https://code.wireshark.org/review/12585\n(cherry picked from commit 254731ee05ab663fb79f3431ac0aa141b7065de0)\nReviewed-on: https://code.wireshark.org/review/12586",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1411: address     dst_addr, null_addr;",
          "1412: conversation_t *conversation,*old_conversation = NULL;",
          "1413: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
          "1415: transportLayerAddress_ipv4 = 0;",
          "1416: BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1414: void *conv_proto_data = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1455:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "1456:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "1462:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "1463:                 umts_fp_conversation_info->division          = Division_FDD;",
          "",
          "[Removed Lines]",
          "1458:                 if (old_conversation)",
          "1459:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "1459:                 if (old_conversation) {",
          "1460:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
          "1461:                     if (conv_proto_data)",
          "1462:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
          "1463:                 }",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10039: static int",
          "10040: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10042:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10043:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10041: #line 2148 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10041: #line 2151 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10292: static int",
          "10293: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10295: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10296: address     null_addr;",
          "10297: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10294: #line 2113 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10294: #line 2116 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11514: static int",
          "11515: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11518:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11519:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11516: #line 1972 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11516: #line 1975 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11648: static int",
          "11649: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11652:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11653:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11650: #line 1626 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11650: #line 1629 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11666: static int",
          "11667: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11669:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11670:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11668: #line 1728 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11668: #line 1731 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12089: static int",
          "12090: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12092:     address     dst_addr;",
          "12093:     transportLayerAddress_ipv4 = 0;",
          "12094:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12091: #line 1979 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12091: #line 1982 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12134: static int",
          "12135: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12137:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12138:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12136: #line 1616 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12136: #line 1619 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "13355: static int",
          "13356: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13358:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13359:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13357: #line 2087 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13357: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "18039: static int",
          "18040: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18043:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18044:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18041: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18041: #line 1608 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18174: static int",
          "18175: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18177:     num_items++;",
          "",
          "[Removed Lines]",
          "18176: #line 1602 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18176: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18191: static int",
          "18192: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18194:     num_items = 0;",
          "18196:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18193: #line 1595 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18193: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18407: static int",
          "18408: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18411:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18412:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18409: #line 1590 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18409: #line 1593 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18482: static int",
          "18483: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18485: guint32 no_ddi_entries, i;",
          "18486: address     null_addr;",
          "18487: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18484: #line 1498 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18484: #line 1501 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18628: address     dst_addr, null_addr;",
          "18629: conversation_t *conversation,*old_conversation = NULL;",
          "18630: umts_fp_conversation_info_t *umts_fp_conversation_info _U_;",
          "18632: transportLayerAddress_ipv4 = 0;",
          "18633: BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "18631: void *conv_proto_data = NULL;",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18674:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "18675:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "18681:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "18682:                 umts_fp_conversation_info->division          = Division_FDD;",
          "",
          "[Removed Lines]",
          "18677:                 if (old_conversation)",
          "18678:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "18678:                 if (old_conversation) {",
          "18679:                     conv_proto_data = conversation_get_proto_data(old_conversation, proto_fp);",
          "18680:                     if (conv_proto_data)",
          "18681:                         memcpy(umts_fp_conversation_info,conv_proto_data,sizeof(umts_fp_conversation_info_t));",
          "18682:                 }",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "23317: static int",
          "23318: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23319: #line 1999 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23322: #line 2002 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23478: static int",
          "23479: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23483:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23480: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23483: #line 1709 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23581: static int",
          "23582: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23584:     guint32 rlc_mode;",
          "23586:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23583: #line 1633 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23586: #line 1636 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23622: static int",
          "23623: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23625:     num_items++;",
          "",
          "[Removed Lines]",
          "23624: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23627: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23656: static int",
          "23657: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23660:     int protocol_ie_id;",
          "23661:     guint32 i;",
          "",
          "[Removed Lines]",
          "23658: #line 1657 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23661: #line 1660 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23700: static int",
          "23701: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23703:     guint32 hsdsch_physical_layer_category;",
          "23705:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23702: #line 1650 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23705: #line 1653 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23768: static int",
          "23769: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23770: #line 1758 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23773: #line 1761 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23905: static int",
          "23906: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23908:     address     dst_addr;",
          "23909:     transportLayerAddress_ipv4 = 0;",
          "23910:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23907: #line 1847 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23910: #line 1850 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23963: static int",
          "23964: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23966:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23965: #line 1700 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23968: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "24098: static int",
          "24099: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24100: #line 1867 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24103: #line 1870 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "24220: static int",
          "24221: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24222: #line 1735 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24225: #line 1738 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "24331: static int",
          "24332: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24334:     num_items++;",
          "",
          "[Removed Lines]",
          "24333: #line 1703 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24336: #line 1706 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24747: static int",
          "24748: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24751:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24749: #line 2077 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24752: #line 2080 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24941: static int",
          "24942: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24944:     num_items++;",
          "",
          "[Removed Lines]",
          "24943: #line 1694 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24946: #line 1697 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24958: static int",
          "24959: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24961:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24960: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24963: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "28060: static int",
          "28061: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28064: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28062: #line 2091 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28065: #line 2094 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "41077: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41080: #line 2140 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41083: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5b4ada17723ed8af7e85cb48d537437ed614e417",
      "candidate_info": {
        "commit_hash": "5b4ada17723ed8af7e85cb48d537437ed614e417",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/5b4ada17723ed8af7e85cb48d537437ed614e417",
        "files": [
          "asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "[NBAP] Prevent crash.\n\nIf no previous conversation exists, a memcpy will try to copy from NULL destination.\n\nBug: 11835\nChange-Id: I445480bb425834c5a918f1ffa148cb83d6c9750c\nReviewed-on: https://code.wireshark.org/review/12326\nReviewed-by: Michael Mann <mmann78@netscape.net>\nPetri-Dish: Michael Mann <mmann78@netscape.net>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Anders Broman <a.broman58@gmail.com>",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1453:             conversation_set_dissector(conversation, fp_handle);",
          "1454:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "1455:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "1460:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "",
          "[Removed Lines]",
          "1457:                 memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "1457:                 if (old_conversation)",
          "1458:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10028: static int",
          "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10032:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10030: #line 2146 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10030: #line 2147 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10281: static int",
          "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10285: address     null_addr;",
          "10286: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10283: #line 2111 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10283: #line 2112 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11503: static int",
          "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11505: #line 1970 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11505: #line 1971 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11637: static int",
          "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11639: #line 1623 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11639: #line 1624 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11656: static int",
          "11657: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11659:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11660:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11658: #line 1726 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11658: #line 1727 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12079: static int",
          "12080: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12082:     address     dst_addr;",
          "12083:     transportLayerAddress_ipv4 = 0;",
          "12084:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12081: #line 1977 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12081: #line 1978 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12124: static int",
          "12125: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12127:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12128:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12126: #line 1614 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12126: #line 1615 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "13344: static int",
          "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13346: #line 2085 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13346: #line 2086 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "18028: static int",
          "18029: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18032:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18033:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18030: #line 1604 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18030: #line 1605 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18162: static int",
          "18163: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18165:     num_items++;",
          "",
          "[Removed Lines]",
          "18164: #line 1601 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18164: #line 1602 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18179: static int",
          "18180: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18182:     num_items = 0;",
          "18184:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18181: #line 1594 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18181: #line 1595 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18395: static int",
          "18396: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18399:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18400:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18397: #line 1589 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18397: #line 1590 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18470: static int",
          "18471: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18473: guint32 no_ddi_entries, i;",
          "18474: address     null_addr;",
          "18475: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18472: #line 1497 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18472: #line 1498 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18661:             conversation_set_dissector(conversation, fp_handle);",
          "18662:             if(actx->pinfo->link_dir==P2P_DIR_DL){",
          "18663:                 umts_fp_conversation_info = wmem_new0(wmem_file_scope(), umts_fp_conversation_info_t);",
          "18668:                 umts_fp_conversation_info->iface_type        = IuB_Interface;",
          "",
          "[Removed Lines]",
          "18665:                 memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "[Added Lines]",
          "18665:                 if (old_conversation)",
          "18666:                     memcpy(umts_fp_conversation_info,conversation_get_proto_data(old_conversation, proto_fp),sizeof(umts_fp_conversation_info_t));",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "23304: static int",
          "23305: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23306: #line 1997 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23307: #line 1998 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "23465: static int",
          "23466: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23470:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23467: #line 1704 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23468: #line 1705 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23568: static int",
          "23569: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23571:     guint32 rlc_mode;",
          "23573:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23570: #line 1631 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23571: #line 1632 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23609: static int",
          "23610: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23612:     num_items++;",
          "",
          "[Removed Lines]",
          "23611: #line 1695 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23612: #line 1696 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23643: static int",
          "23644: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23647:     int protocol_ie_id;",
          "23648:     guint32 i;",
          "",
          "[Removed Lines]",
          "23645: #line 1655 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23646: #line 1656 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23687: static int",
          "23688: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23690:     guint32 hsdsch_physical_layer_category;",
          "23692:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23689: #line 1648 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23690: #line 1649 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23755: static int",
          "23756: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23757: #line 1756 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23758: #line 1757 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23892: static int",
          "23893: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23895:     address     dst_addr;",
          "23896:     transportLayerAddress_ipv4 = 0;",
          "23897:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23894: #line 1845 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23895: #line 1846 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23950: static int",
          "23951: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23953:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23952: #line 1698 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23953: #line 1699 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "24085: static int",
          "24086: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24087: #line 1865 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24088: #line 1866 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "24207: static int",
          "24208: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24209: #line 1733 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24210: #line 1734 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "24318: static int",
          "24319: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24321:     num_items++;",
          "",
          "[Removed Lines]",
          "24320: #line 1701 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24321: #line 1702 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "24734: static int",
          "24735: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24738:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24736: #line 2075 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24737: #line 2076 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24928: static int",
          "24929: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24931:     num_items++;",
          "",
          "[Removed Lines]",
          "24930: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24931: #line 1693 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24945: static int",
          "24946: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24948:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24947: #line 1687 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24948: #line 1688 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "28047: static int",
          "28048: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28051: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28049: #line 2089 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28050: #line 2090 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "41063: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41066: #line 2138 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41067: #line 2139 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5bf565690ad9f0771196d8fa237aa37fae3bb7cc",
      "candidate_info": {
        "commit_hash": "5bf565690ad9f0771196d8fa237aa37fae3bb7cc",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/5bf565690ad9f0771196d8fa237aa37fae3bb7cc",
        "files": [
          "asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c"
        ],
        "message": "NBAP: avoid dereferencing a NULL pointer\n\nBug: 11602\nChange-Id: I56b9db19eca416c288f36c1f3a4faa7e22b38c8f\nReviewed-on: https://code.wireshark.org/review/11109\nReviewed-by: Pascal Quantin <pascal.quantin@gmail.com>\nPetri-Dish: Pascal Quantin <pascal.quantin@gmail.com>\nTested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>\nReviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>",
        "before_after_code_files": [
          "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
          "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ],
          "candidate": [
            "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf",
            "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c"
          ]
        }
      },
      "candidate_diff": {
        "asn1/nbap/nbap.cnf||asn1/nbap/nbap.cnf": [
          "File: asn1/nbap/nbap.cnf -> asn1/nbap/nbap.cnf",
          "--- Hunk 1 ---",
          "[Context before]",
          "1243: #.FN_BODY RL-Specific-E-DCH-Information-Item",
          "1244: address     dst_addr, null_addr;",
          "1245: conversation_t *conversation;",
          "1247: nbap_edch_port_info_t *old_info = NULL;",
          "1249: transportLayerAddress_ipv4 = 0;",
          "",
          "[Removed Lines]",
          "1246: umts_fp_conversation_info_t *umts_fp_conversation_info;",
          "",
          "[Added Lines]",
          "1246: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1263:         conversation = find_conversation(actx->pinfo->fd->num,&dst_addr,",
          "1264:             &null_addr, PT_UDP, BindingID_port,",
          "1265:             0, NO_ADDR_B|NO_PORT_B);",
          "",
          "[Removed Lines]",
          "1270:         if (conversation == NULL || ((umts_fp_conversation_info_t*)conversation_get_proto_data(conversation, proto_fp))->channel == CHANNEL_DCH) {",
          "",
          "[Added Lines]",
          "1266:         if (conversation) {",
          "1267:             umts_fp_conversation_info = (umts_fp_conversation_info_t*)conversation_get_proto_data(conversation, proto_fp);",
          "1268:         }",
          "1273:         if ((conversation == NULL) || (umts_fp_conversation_info && umts_fp_conversation_info->channel == CHANNEL_DCH)) {",
          "",
          "---------------"
        ],
        "epan/dissectors/packet-nbap.c||epan/dissectors/packet-nbap.c": [
          "File: epan/dissectors/packet-nbap.c -> epan/dissectors/packet-nbap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "10028: static int",
          "10029: dissect_nbap_CFN(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10031:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "10032:                                                             0U, 255U, &cfn, FALSE);",
          "",
          "[Removed Lines]",
          "10030: #line 2143 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10030: #line 2146 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10281: static int",
          "10282: dissect_nbap_HSDSCH_RNTI(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "10284: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "10285: address     null_addr;",
          "10286: conversation_t   *conversation = NULL;",
          "",
          "[Removed Lines]",
          "10283: #line 2108 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "10283: #line 2111 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "11503: static int",
          "11504: dissect_nbap_Common_MACFlow_ID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11507:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11508:                                                             0U, maxNrOfCommonMACFlows_1, &common_macdflow_id, FALSE);",
          "",
          "[Removed Lines]",
          "11505: #line 1967 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11505: #line 1970 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "11637: static int",
          "11638: dissect_nbap_LogicalChannelID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11641:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11642:                                                             1U, 15U, &logical_channel_id, FALSE);",
          "",
          "[Removed Lines]",
          "11639: #line 1620 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11639: #line 1623 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "11656: static int",
          "11657: dissect_nbap_MAC_PDU_SizeExtended(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "11659:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "11660:                                                             1U, 1504U, NULL, TRUE);",
          "",
          "[Removed Lines]",
          "11658: #line 1723 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "11658: #line 1726 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "12079: static int",
          "12080: dissect_nbap_CommonMACFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12082:     address     dst_addr;",
          "12083:     transportLayerAddress_ipv4 = 0;",
          "12084:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "12081: #line 1974 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12081: #line 1977 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "12124: static int",
          "12125: dissect_nbap_MACdPDU_Size(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "12127:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "12128:                                                             1U, 5000U, &MACdPDU_Size, TRUE);",
          "",
          "[Removed Lines]",
          "12126: #line 1611 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "12126: #line 1614 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "13344: static int",
          "13345: dissect_nbap_CRNC_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "13347:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "13348:                                                             0U, 1048575U, &com_context_id, FALSE);",
          "",
          "[Removed Lines]",
          "13346: #line 2082 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "13346: #line 2085 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "18028: static int",
          "18029: dissect_nbap_E_DCH_DDI_Value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18032:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "18033:                                                             0U, 62U, &e_dch_ddi_value, FALSE);",
          "",
          "[Removed Lines]",
          "18030: #line 1601 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18030: #line 1604 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "18162: static int",
          "18163: dissect_nbap_E_DCH_LogicalChannelInformationItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18165:     num_items++;",
          "",
          "[Removed Lines]",
          "18164: #line 1598 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18164: #line 1601 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "18179: static int",
          "18180: dissect_nbap_E_DCH_LogicalChannelInformation(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18182:     num_items = 0;",
          "18184:   offset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "18181: #line 1591 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18181: #line 1594 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "18212: static int",
          "18213: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18215: umts_fp_conversation_info_t *p_conv_data = NULL;",
          "18216: address     null_addr;",
          "18217: conversation_t   *p_conv;",
          "",
          "[Removed Lines]",
          "18214: #line 1353 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18214: #line 1356 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "18395: static int",
          "18396: dissect_nbap_E_DCH_LogicalChannelToModifyItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18399:   offset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,",
          "18400:                                    ett_nbap_E_DCH_LogicalChannelToModifyItem, E_DCH_LogicalChannelToModifyItem_sequence);",
          "",
          "[Removed Lines]",
          "18397: #line 1586 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18397: #line 1589 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "18470: static int",
          "18471: dissect_nbap_E_DCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18473: guint32 no_ddi_entries, i;",
          "18474: address     null_addr;",
          "18475: nbap_edch_port_info_t *old_info;",
          "",
          "[Removed Lines]",
          "18472: #line 1494 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18472: #line 1497 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "18612: static int",
          "18613: dissect_nbap_E_DCH_FDD_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "18616: address     dst_addr, null_addr;",
          "18617: conversation_t *conversation,*old_conversation = NULL;",
          "",
          "[Removed Lines]",
          "18614: #line 1406 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "18614: #line 1409 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "23304: static int",
          "23305: dissect_nbap_HSDSCH_Common_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23306: #line 1994 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23306: #line 1997 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "23465: static int",
          "23466: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23470:     address     dst_addr;",
          "",
          "[Removed Lines]",
          "23467: #line 1701 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23467: #line 1704 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "23568: static int",
          "23569: dissect_nbap_RLC_Mode(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23571:     guint32 rlc_mode;",
          "23573:   offset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23570: #line 1628 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23570: #line 1631 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "23609: static int",
          "23610: dissect_nbap_PriorityQueue_InfoItem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23612:     num_items++;",
          "",
          "[Removed Lines]",
          "23611: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23611: #line 1695 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "23643: static int",
          "23644: dissect_nbap_HSDSCH_MACdFlows_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23647:     int protocol_ie_id;",
          "23648:     guint32 i;",
          "",
          "[Removed Lines]",
          "23645: #line 1652 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23645: #line 1655 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "23687: static int",
          "23688: dissect_nbap_T_hSDSCH_Physical_Layer_Category(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23690:     guint32 hsdsch_physical_layer_category;",
          "23692:   offset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,",
          "",
          "[Removed Lines]",
          "23689: #line 1645 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23689: #line 1648 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "23755: static int",
          "23756: dissect_nbap_HSDSCH_FDD_Information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "23757: #line 1753 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23757: #line 1756 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "23892: static int",
          "23893: dissect_nbap_HSDSCH_MACdFlow_Specific_InfoItem_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23895:     address     dst_addr;",
          "23896:     transportLayerAddress_ipv4 = 0;",
          "23897:     BindingID_port = 0;",
          "",
          "[Removed Lines]",
          "23894: #line 1842 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23894: #line 1845 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "23950: static int",
          "23951: dissect_nbap_PriorityQueue_InfoItem_to_Add(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "23953:     num_items = 1;",
          "",
          "[Removed Lines]",
          "23952: #line 1695 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "23952: #line 1698 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "24085: static int",
          "24086: dissect_nbap_HSDSCH_Information_to_Modify(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24087: #line 1862 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24087: #line 1865 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "24207: static int",
          "24208: dissect_nbap_HSDSCH_MACdPDUSizeFormat(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "",
          "[Removed Lines]",
          "24209: #line 1730 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24209: #line 1733 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "24318: static int",
          "24319: dissect_nbap_HSDSCH_MACdFlow_Specific_InformationResp_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24321:     num_items++;",
          "",
          "[Removed Lines]",
          "24320: #line 1698 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24320: #line 1701 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "24734: static int",
          "24735: dissect_nbap_HSDSCH_Paging_System_InformationFDD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24738:   g_warning(\"HS-DSCH Type 3 NOT Implemented!\");",
          "",
          "[Removed Lines]",
          "24736: #line 2072 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24736: #line 2075 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "24928: static int",
          "24929: dissect_nbap_HSDSCH_MACdFlows_to_Delete_Item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24931:     num_items++;",
          "",
          "[Removed Lines]",
          "24930: #line 1689 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24930: #line 1692 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "24945: static int",
          "24946: dissect_nbap_HSDSCH_MACdFlows_to_Delete(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "24948:     num_items = 0;",
          "",
          "[Removed Lines]",
          "24947: #line 1684 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "24947: #line 1687 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "28047: static int",
          "28048: dissect_nbap_NodeB_CommunicationContextID(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {",
          "28051: nbap_com_context_id_t *cur_val;",
          "",
          "[Removed Lines]",
          "28049: #line 2086 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "28049: #line 2089 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "28780: #line 1244 \"../../asn1/nbap/nbap.cnf\"",
          "28781: address     dst_addr, null_addr;",
          "28782: conversation_t *conversation;",
          "28784: nbap_edch_port_info_t *old_info = NULL;",
          "28786: transportLayerAddress_ipv4 = 0;",
          "",
          "[Removed Lines]",
          "28783: umts_fp_conversation_info_t *umts_fp_conversation_info;",
          "",
          "[Added Lines]",
          "28783: umts_fp_conversation_info_t *umts_fp_conversation_info = NULL;",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "28802:         conversation = find_conversation(actx->pinfo->fd->num,&dst_addr,",
          "28803:             &null_addr, PT_UDP, BindingID_port,",
          "28804:             0, NO_ADDR_B|NO_PORT_B);",
          "",
          "[Removed Lines]",
          "28809:         if (conversation == NULL || ((umts_fp_conversation_info_t*)conversation_get_proto_data(conversation, proto_fp))->channel == CHANNEL_DCH) {",
          "",
          "[Added Lines]",
          "28805:         if (conversation) {",
          "28806:             umts_fp_conversation_info = (umts_fp_conversation_info_t*)conversation_get_proto_data(conversation, proto_fp);",
          "28807:         }",
          "28812:         if ((conversation == NULL) || (umts_fp_conversation_info && umts_fp_conversation_info->channel == CHANNEL_DCH)) {",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "41060: actx->pinfo->link_dir=P2P_DIR_DL;",
          "",
          "[Removed Lines]",
          "41063: #line 2135 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "[Added Lines]",
          "41066: #line 2138 \"../../asn1/nbap/nbap.cnf\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}