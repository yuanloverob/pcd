{
  "cve_id": "CVE-2015-4600",
  "cve_desc": "The SoapClient implementation in PHP before 5.4.40, 5.5.x before 5.5.24, and 5.6.x before 5.6.8 allows remote attackers to cause a denial of service (application crash) or possibly execute arbitrary code via an unexpected data type, related to \"type confusion\" issues in the (1) SoapClient::__getLastRequest, (2) SoapClient::__getLastResponse, (3) SoapClient::__getLastRequestHeaders, (4) SoapClient::__getLastResponseHeaders, (5) SoapClient::__getCookies, and (6) SoapClient::__setCookie methods.",
  "repo": "php/php-src",
  "patch_hash": "0c136a2abd49298b66acb0cad504f0f972f5bfe8",
  "patch_info": {
    "commit_hash": "0c136a2abd49298b66acb0cad504f0f972f5bfe8",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/0c136a2abd49298b66acb0cad504f0f972f5bfe8",
    "files": [
      "ext/soap/php_encoding.c",
      "ext/soap/php_http.c",
      "ext/soap/soap.c"
    ],
    "message": "Added type checks",
    "before_after_code_files": [
      "ext/soap/php_encoding.c||ext/soap/php_encoding.c",
      "ext/soap/php_http.c||ext/soap/php_http.c",
      "ext/soap/soap.c||ext/soap/soap.c"
    ]
  },
  "patch_diff": {
    "ext/soap/php_encoding.c||ext/soap/php_encoding.c": [
      "File: ext/soap/php_encoding.c -> ext/soap/php_encoding.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "3649:       Z_OBJCE_PP(tmp) == soap_var_class_entry) {",
      "3650:    zval **ztype;",
      "3653:     soap_error0(E_ERROR,  \"Encoding: SoapVar has no 'enc_type' property\");",
      "3654:    }",
      "3655:    cur_type = Z_LVAL_PP(ztype);",
      "3658:     cur_stype = Z_STRVAL_PP(ztype);",
      "3659:    } else {",
      "3660:     cur_stype = NULL;",
      "3661:    }",
      "3664:     cur_ns = Z_STRVAL_PP(ztype);",
      "3665:    } else {",
      "3666:     cur_ns = NULL;",
      "",
      "[Removed Lines]",
      "3652:    if (zend_hash_find(Z_OBJPROP_PP(tmp), \"enc_type\", sizeof(\"enc_type\"), (void **)&ztype) == FAILURE) {",
      "3657:    if (zend_hash_find(Z_OBJPROP_PP(tmp), \"enc_stype\", sizeof(\"enc_stype\"), (void **)&ztype) == SUCCESS) {",
      "3663:    if (zend_hash_find(Z_OBJPROP_PP(tmp), \"enc_ns\", sizeof(\"enc_ns\"), (void **)&ztype) == SUCCESS) {",
      "",
      "[Added Lines]",
      "3652:    if (zend_hash_find(Z_OBJPROP_PP(tmp), \"enc_type\", sizeof(\"enc_type\"), (void **)&ztype) == FAILURE ||",
      "3653:        Z_TYPE_PP(ztype) != IS_LONG) {",
      "3658:    if (zend_hash_find(Z_OBJPROP_PP(tmp), \"enc_stype\", sizeof(\"enc_stype\"), (void **)&ztype) == SUCCESS &&",
      "3659:        Z_TYPE_PP(ztype) == IS_STRING) {",
      "3665:    if (zend_hash_find(Z_OBJPROP_PP(tmp), \"enc_ns\", sizeof(\"enc_ns\"), (void **)&ztype) == SUCCESS &&",
      "3666:        Z_TYPE_PP(ztype) == IS_STRING) {",
      "",
      "---------------"
    ],
    "ext/soap/php_http.c||ext/soap/php_http.c": [
      "File: ext/soap/php_http.c -> ext/soap/php_http.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "36: {",
      "37:  zval **login, **password;",
      "40:   unsigned char* buf;",
      "41:   int len;",
      "42:   smart_str auth = {0};",
      "44:   smart_str_appendl(&auth, Z_STRVAL_PP(login), Z_STRLEN_PP(login));",
      "45:   smart_str_appendc(&auth, ':');",
      "47:    smart_str_appendl(&auth, Z_STRVAL_PP(password), Z_STRLEN_PP(password));",
      "48:   }",
      "49:   smart_str_0(&auth);",
      "",
      "[Removed Lines]",
      "39:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_proxy_login\", sizeof(\"_proxy_login\"), (void **)&login) == SUCCESS) {",
      "46:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_proxy_password\", sizeof(\"_proxy_password\"), (void **)&password) == SUCCESS) {",
      "",
      "[Added Lines]",
      "39:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_proxy_login\", sizeof(\"_proxy_login\"), (void **)&login) == SUCCESS &&",
      "40:      Z_TYPE_PP(login) == IS_STRING) {",
      "47:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_proxy_password\", sizeof(\"_proxy_password\"), (void **)&password) == SUCCESS &&",
      "48:       Z_TYPE_PP(password) == IS_STRING) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "64:  zval **login, **password;",
      "66:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_login\", sizeof(\"_login\"), (void **)&login) == SUCCESS &&",
      "68:   unsigned char* buf;",
      "69:   int len;",
      "70:   smart_str auth = {0};",
      "72:   smart_str_appendl(&auth, Z_STRVAL_PP(login), Z_STRLEN_PP(login));",
      "73:   smart_str_appendc(&auth, ':');",
      "75:    smart_str_appendl(&auth, Z_STRVAL_PP(password), Z_STRLEN_PP(password));",
      "76:   }",
      "77:   smart_str_0(&auth);",
      "",
      "[Removed Lines]",
      "67:    !zend_hash_exists(Z_OBJPROP_P(this_ptr), \"_digest\", sizeof(\"_digest\"))) {",
      "74:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_password\", sizeof(\"_password\"), (void **)&password) == SUCCESS) {",
      "",
      "[Added Lines]",
      "69:      Z_TYPE_PP(login) == IS_STRING &&",
      "70:      !zend_hash_exists(Z_OBJPROP_P(this_ptr), \"_digest\", sizeof(\"_digest\"))) {",
      "77:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_password\", sizeof(\"_password\"), (void **)&password) == SUCCESS &&",
      "78:       Z_TYPE_PP(password) == IS_STRING) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "509:   }",
      "510:   if (!http_1_1 ||",
      "511:    (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_keep_alive\", sizeof(\"_keep_alive\"), (void **)&tmp) == SUCCESS &&",
      "512:     Z_LVAL_PP(tmp) == 0)) {",
      "513:    smart_str_append_const(&soap_headers, \"\\r\\n\"",
      "514:     \"Connection: close\\r\\n\");",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "516:     (Z_TYPE_PP(tmp) == IS_BOOL || Z_TYPE_PP(tmp) == IS_LONG) &&",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "742:   }",
      "746:    zval **data;",
      "747:    char *key;",
      "748:    int i, n;",
      "",
      "[Removed Lines]",
      "745:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) == SUCCESS) {",
      "",
      "[Added Lines]",
      "750:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) == SUCCESS &&",
      "751:       Z_TYPE_PP(cookies) == IS_ARRAY) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "785:   smart_str_append_const(&soap_headers, \"\\r\\n\");",
      "786:   smart_str_0(&soap_headers);",
      "787:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
      "789:    add_property_stringl(this_ptr, \"__last_request_headers\", soap_headers.c, soap_headers.len, 1);",
      "790:   }",
      "791:   smart_str_appendl(&soap_headers, request, request_size);",
      "",
      "[Removed Lines]",
      "788:       Z_LVAL_PP(trace) > 0) {",
      "",
      "[Added Lines]",
      "794:       (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "830:   }",
      "832:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
      "834:    add_property_stringl(this_ptr, \"__last_response_headers\", http_headers, http_header_size, 1);",
      "835:   }",
      "",
      "[Removed Lines]",
      "833:       Z_LVAL_PP(trace) > 0) {",
      "",
      "[Added Lines]",
      "839:       (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "879:   char *eqpos, *sempos;",
      "880:   zval **cookies;",
      "883:    zval *tmp_cookies;",
      "884:    MAKE_STD_ZVAL(tmp_cookies);",
      "885:    array_init(tmp_cookies);",
      "",
      "[Removed Lines]",
      "882:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) == FAILURE) {",
      "",
      "[Added Lines]",
      "888:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) == FAILURE ||",
      "889:       Z_TYPE_PP(cookies) != IS_ARRAY) {",
      "",
      "---------------"
    ],
    "ext/soap/soap.c||ext/soap/soap.c": [
      "File: ext/soap/soap.c -> ext/soap/soap.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2554:  }",
      "2556:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
      "2558:   add_property_stringl(this_ptr, \"__last_request\", buf, buf_size, 1);",
      "2559:  }",
      "",
      "[Removed Lines]",
      "2557:      Z_LVAL_PP(trace) > 0) {",
      "",
      "[Added Lines]",
      "2557:      (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "2594:   }",
      "2595:   ret = FALSE;",
      "2596:  } else if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
      "2598:   add_property_stringl(this_ptr, \"__last_response\", Z_STRVAL_P(response), Z_STRLEN_P(response), 1);",
      "2599:  }",
      "2600:  xmlFree(buf);",
      "",
      "[Removed Lines]",
      "2597:      Z_LVAL_PP(trace) > 0) {",
      "",
      "[Added Lines]",
      "2597:             (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "2634:  SOAP_CLIENT_BEGIN_CODE();",
      "2638:   zend_hash_del(Z_OBJPROP_P(this_ptr), \"__last_request\", sizeof(\"__last_request\"));",
      "2639:   zend_hash_del(Z_OBJPROP_P(this_ptr), \"__last_response\", sizeof(\"__last_response\"));",
      "2640:  }",
      "2643:   soap_version = SOAP_1_2;",
      "2644:  } else {",
      "2645:   soap_version = SOAP_1_1;",
      "",
      "[Removed Lines]",
      "2636:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS",
      "2637:   && Z_LVAL_PP(trace) > 0) {",
      "2641:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_soap_version\", sizeof(\"_soap_version\"), (void **) &tmp) == SUCCESS",
      "2642:   && Z_LVAL_PP(tmp) == SOAP_1_2) {",
      "",
      "[Added Lines]",
      "2636:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
      "2637:      (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
      "2641:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_soap_version\", sizeof(\"_soap_version\"), (void **) &tmp) == SUCCESS &&",
      "2642:   Z_TYPE_PP(tmp) == IS_LONG && Z_LVAL_PP(tmp) == SOAP_1_2) {",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "2735:   zval **uri;",
      "2736:   smart_str action = {0};",
      "2739:    add_soap_fault(this_ptr, \"Client\", \"Error finding \\\"uri\\\" property\", NULL, NULL TSRMLS_CC);",
      "2740:   } else if (location == NULL) {",
      "2741:    add_soap_fault(this_ptr, \"Client\", \"Error could not find \\\"location\\\" property\", NULL, NULL TSRMLS_CC);",
      "",
      "[Removed Lines]",
      "2738:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"uri\", sizeof(\"uri\"), (void *)&uri) == FAILURE) {",
      "",
      "[Added Lines]",
      "2738:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"uri\", sizeof(\"uri\"), (void *)&uri) == FAILURE || Z_TYPE_PP(uri) != IS_STRING) {",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "3006:   return;",
      "3007:  }",
      "3010:   RETURN_STRINGL(Z_STRVAL_PP(tmp), Z_STRLEN_PP(tmp), 1);",
      "3011:  }",
      "3012:  RETURN_NULL();",
      "",
      "[Removed Lines]",
      "3009:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__last_request\", sizeof(\"__last_request\"), (void **)&tmp) == SUCCESS) {",
      "",
      "[Added Lines]",
      "3009:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__last_request\", sizeof(\"__last_request\"), (void **)&tmp) == SUCCESS &&",
      "3010:      Z_TYPE_PP(tmp) == IS_STRING) {",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "3024:   return;",
      "3025:  }",
      "3028:   RETURN_STRINGL(Z_STRVAL_PP(tmp), Z_STRLEN_PP(tmp), 1);",
      "3029:  }",
      "3030:  RETURN_NULL();",
      "",
      "[Removed Lines]",
      "3027:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__last_response\", sizeof(\"__last_response\"), (void **)&tmp) == SUCCESS) {",
      "",
      "[Added Lines]",
      "3028:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__last_response\", sizeof(\"__last_response\"), (void **)&tmp) == SUCCESS &&",
      "3029:      Z_TYPE_PP(tmp) == IS_STRING) {",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "3042:   return;",
      "3043:  }",
      "3046:   RETURN_STRINGL(Z_STRVAL_PP(tmp), Z_STRLEN_PP(tmp), 1);",
      "3047:  }",
      "3048:  RETURN_NULL();",
      "",
      "[Removed Lines]",
      "3045:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__last_request_headers\", sizeof(\"__last_request_headers\"), (void **)&tmp) == SUCCESS) {",
      "",
      "[Added Lines]",
      "3047:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__last_request_headers\", sizeof(\"__last_request_headers\"), (void **)&tmp) == SUCCESS &&",
      "3048:      Z_TYPE_PP(tmp) == IS_STRING) {",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "3060:   return;",
      "3061:  }",
      "3064:   RETURN_STRINGL(Z_STRVAL_PP(tmp), Z_STRLEN_PP(tmp), 1);",
      "3065:  }",
      "3066:  RETURN_NULL();",
      "",
      "[Removed Lines]",
      "3063:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__last_response_headers\", sizeof(\"__last_response_headers\"), (void **)&tmp) == SUCCESS) {",
      "",
      "[Added Lines]",
      "3066:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"__last_response_headers\", sizeof(\"__last_response_headers\"), (void **)&tmp) == SUCCESS &&",
      "3067:      Z_TYPE_PP(tmp) == IS_STRING) {",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "3116:  }",
      "3118:  if (val == NULL) {",
      "3120:    zend_hash_del(Z_ARRVAL_PP(cookies), name, name_len+1);",
      "3121:   }",
      "3122:  } else {",
      "3123:   zval *zcookie;",
      "3126:    zval *tmp_cookies;",
      "3128:    MAKE_STD_ZVAL(tmp_cookies);",
      "",
      "[Removed Lines]",
      "3119:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) == SUCCESS) {",
      "3125:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) == FAILURE) {",
      "",
      "[Added Lines]",
      "3123:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) == SUCCESS &&",
      "3124:       Z_TYPE_PP(cookies) == IS_ARRAY) {",
      "3130:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) == FAILURE ||",
      "3131:       Z_TYPE_PP(cookies) != IS_ARRAY) {",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "3151:  array_init(return_value);",
      "3154:   zend_hash_copy(Z_ARRVAL_P(return_value), Z_ARRVAL_P(*cookies), (copy_ctor_func_t) zval_add_ref, (void *)&tmp, sizeof(zval*));",
      "3155:  }",
      "3156: }",
      "",
      "[Removed Lines]",
      "3153:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) != FAILURE) {",
      "",
      "[Added Lines]",
      "3159:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\"), (void **)&cookies) != FAILURE &&",
      "3160:      Z_TYPE_PP(cookies) == IS_ARRAY) {",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "4237:    }",
      "4238:   }",
      "4239:  } else {",
      "4241:    style = Z_LVAL_PP(zstyle);",
      "4242:   } else {",
      "4243:    style = SOAP_RPC;",
      "",
      "[Removed Lines]",
      "4240:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"style\", sizeof(\"style\"), (void **)&zstyle) == SUCCESS) {",
      "",
      "[Added Lines]",
      "4247:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"style\", sizeof(\"style\"), (void **)&zstyle) == SUCCESS &&",
      "4248:       Z_TYPE_PP(zstyle) == IS_LONG) {",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "4260:   }",
      "4262:   if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"use\", sizeof(\"use\"), (void **)&zuse) == SUCCESS &&",
      "4264:    use = SOAP_LITERAL;",
      "4265:   } else {",
      "4266:    use = SOAP_ENCODED;",
      "",
      "[Removed Lines]",
      "4263:      Z_LVAL_PP(zuse) == SOAP_LITERAL) {",
      "",
      "[Added Lines]",
      "4271:       Z_TYPE_PP(zuse) == IS_LONG && Z_LVAL_PP(zuse) == SOAP_LITERAL) {",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "4390:   zval **param_data;",
      "4392:   if (zend_hash_find(Z_OBJPROP_P(param_val), \"param_name\", sizeof(\"param_name\"), (void **)&param_name) == SUCCESS &&",
      "4393:       zend_hash_find(Z_OBJPROP_P(param_val), \"param_data\", sizeof(\"param_data\"), (void **)&param_data) == SUCCESS) {",
      "4394:    param_val = *param_data;",
      "4395:    name = Z_STRVAL_PP(param_name);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4401:       Z_TYPE_PP(param_name) == IS_STRING &&",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "c8eaca013a3922e8383def6158ece2b63f6ec483",
      "candidate_info": {
        "commit_hash": "c8eaca013a3922e8383def6158ece2b63f6ec483",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/c8eaca013a3922e8383def6158ece2b63f6ec483",
        "files": [
          "ext/soap/php_encoding.c",
          "ext/soap/soap.c"
        ],
        "message": "Added type checks",
        "before_after_code_files": [
          "ext/soap/php_encoding.c||ext/soap/php_encoding.c",
          "ext/soap/soap.c||ext/soap/soap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/soap/php_encoding.c||ext/soap/php_encoding.c",
            "ext/soap/soap.c||ext/soap/soap.c"
          ],
          "candidate": [
            "ext/soap/php_encoding.c||ext/soap/php_encoding.c",
            "ext/soap/soap.c||ext/soap/soap.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/soap/php_encoding.c||ext/soap/php_encoding.c": [
          "File: ext/soap/php_encoding.c -> ext/soap/php_encoding.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "404:   encodePtr enc = NULL;",
          "405:   HashTable *ht = Z_OBJPROP_P(data);",
          "408:    soap_error0(E_ERROR, \"Encoding: SoapVar has no 'enc_type' property\");",
          "409:   }",
          "413:     enc = get_encoder(SOAP_GLOBAL(sdl), Z_STRVAL_PP(zns), Z_STRVAL_PP(zstype));",
          "414:    } else {",
          "415:     zns = NULL;",
          "",
          "[Removed Lines]",
          "407:   if (zend_hash_find(ht, \"enc_type\", sizeof(\"enc_type\"), (void **)&ztype) == FAILURE) {",
          "411:   if (zend_hash_find(ht, \"enc_stype\", sizeof(\"enc_stype\"), (void **)&zstype) == SUCCESS) {",
          "412:    if (zend_hash_find(ht, \"enc_ns\", sizeof(\"enc_ns\"), (void **)&zns) == SUCCESS) {",
          "",
          "[Added Lines]",
          "407:   if (zend_hash_find(ht, \"enc_type\", sizeof(\"enc_type\"), (void **)&ztype) == FAILURE ||",
          "408:       Z_TYPE_PP(ztype) != IS_LONG) {",
          "412:   if (zend_hash_find(ht, \"enc_stype\", sizeof(\"enc_stype\"), (void **)&zstype) == SUCCESS &&",
          "413:       Z_TYPE_PP(zstype) == IS_STRING) {",
          "414:    if (zend_hash_find(ht, \"enc_ns\", sizeof(\"enc_ns\"), (void **)&zns) == SUCCESS &&",
          "415:        Z_TYPE_PP(zns) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "445:   }",
          "447:   if (style == SOAP_ENCODED || (SOAP_GLOBAL(sdl) && encode != enc)) {",
          "450:      set_ns_and_type_ex(node, Z_STRVAL_PP(zns), Z_STRVAL_PP(zstype));",
          "451:     } else {",
          "452:      set_ns_and_type_ex(node, NULL, Z_STRVAL_PP(zstype));",
          "",
          "[Removed Lines]",
          "448:    if (zend_hash_find(ht, \"enc_stype\", sizeof(\"enc_stype\"), (void **)&zstype) == SUCCESS) {",
          "449:     if (zend_hash_find(ht, \"enc_ns\", sizeof(\"enc_ns\"), (void **)&zns) == SUCCESS) {",
          "",
          "[Added Lines]",
          "451:    if (zend_hash_find(ht, \"enc_stype\", sizeof(\"enc_stype\"), (void **)&zstype) == SUCCESS &&",
          "452:        Z_TYPE_PP(zstype) == IS_STRING) {",
          "453:     if (zend_hash_find(ht, \"enc_ns\", sizeof(\"enc_ns\"), (void **)&zns) == SUCCESS &&",
          "454:         Z_TYPE_PP(zns) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "454:    }",
          "455:   }",
          "458:    xmlNodeSetName(node, BAD_CAST(Z_STRVAL_PP(zname)));",
          "459:   }",
          "461:    xmlNsPtr nsp = encode_add_ns(node, Z_STRVAL_PP(znamens));",
          "462:    xmlSetNs(node, nsp);",
          "463:   }",
          "",
          "[Removed Lines]",
          "457:   if (zend_hash_find(ht, \"enc_name\", sizeof(\"enc_name\"), (void **)&zname) == SUCCESS) {",
          "460:   if (zend_hash_find(ht, \"enc_namens\", sizeof(\"enc_namens\"), (void **)&znamens) == SUCCESS) {",
          "",
          "[Added Lines]",
          "462:   if (zend_hash_find(ht, \"enc_name\", sizeof(\"enc_name\"), (void **)&zname) == SUCCESS &&",
          "463:       Z_TYPE_PP(zname) == IS_STRING) {",
          "466:   if (zend_hash_find(ht, \"enc_namens\", sizeof(\"enc_namens\"), (void **)&znamens) == SUCCESS &&",
          "467:       Z_TYPE_PP(zname) == IS_STRING) {",
          "",
          "---------------"
        ],
        "ext/soap/soap.c||ext/soap/soap.c": [
          "File: ext/soap/soap.c -> ext/soap/soap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3979:   }",
          "3981:   if (version == SOAP_1_1) {",
          "3983:     size_t new_len;",
          "3984:     xmlNodePtr node = xmlNewNode(NULL, BAD_CAST(\"faultcode\"));",
          "3985:     char *str = php_escape_html_entities((unsigned char*)Z_STRVAL_PP(tmp), Z_STRLEN_PP(tmp), &new_len, 0, 0, NULL TSRMLS_CC);",
          "",
          "[Removed Lines]",
          "3982:    if (zend_hash_find(prop, \"faultcode\", sizeof(\"faultcode\"), (void**)&tmp) == SUCCESS) {",
          "",
          "[Added Lines]",
          "3982:    if (zend_hash_find(prop, \"faultcode\", sizeof(\"faultcode\"), (void**)&tmp) == SUCCESS &&",
          "3983:        Z_TYPE_PP(tmp) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4004:    }",
          "4005:    detail_name = \"detail\";",
          "4006:   } else {",
          "4008:     size_t new_len;",
          "4009:     xmlNodePtr node = xmlNewChild(param, ns, BAD_CAST(\"Code\"), NULL);",
          "4010:     char *str = php_escape_html_entities((unsigned char*)Z_STRVAL_PP(tmp), Z_STRLEN_PP(tmp), &new_len, 0, 0, NULL TSRMLS_CC);",
          "",
          "[Removed Lines]",
          "4007:    if (zend_hash_find(prop, \"faultcode\", sizeof(\"faultcode\"), (void**)&tmp) == SUCCESS) {",
          "",
          "[Added Lines]",
          "4008:    if (zend_hash_find(prop, \"faultcode\", sizeof(\"faultcode\"), (void**)&tmp) == SUCCESS &&",
          "4009:        Z_TYPE_PP(tmp) == IS_STRING) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dd50ed8a34d9d04c7f3b532e112be0453920c3a5",
      "candidate_info": {
        "commit_hash": "dd50ed8a34d9d04c7f3b532e112be0453920c3a5",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/dd50ed8a34d9d04c7f3b532e112be0453920c3a5",
        "files": [
          "ext/soap/php_encoding.c",
          "ext/soap/php_http.c",
          "ext/soap/soap.c"
        ],
        "message": "Merge branch 'PHP-5.6'\n\n* PHP-5.6:\n  Added type checks\n  Fixed bug #67741 (auto_prepend_file messes up __LINE__)\n  Check variable type before its usage as IS_ARRAY.\n  Fixed a bug that header value is not terminated by '\\0' when accessed through getenv().\n\nConflicts:\n\text/soap/php_encoding.c\n\text/soap/php_http.c\n\text/soap/soap.c",
        "before_after_code_files": [
          "ext/soap/php_encoding.c||ext/soap/php_encoding.c",
          "ext/soap/php_http.c||ext/soap/php_http.c",
          "ext/soap/soap.c||ext/soap/soap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/soap/php_encoding.c||ext/soap/php_encoding.c",
            "ext/soap/php_http.c||ext/soap/php_http.c",
            "ext/soap/soap.c||ext/soap/soap.c"
          ],
          "candidate": [
            "ext/soap/php_encoding.c||ext/soap/php_encoding.c",
            "ext/soap/php_http.c||ext/soap/php_http.c",
            "ext/soap/soap.c||ext/soap/soap.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/soap/php_encoding.c||ext/soap/php_encoding.c": [
          "File: ext/soap/php_encoding.c -> ext/soap/php_encoding.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3514:       Z_OBJCE_P(tmp) == soap_var_class_entry) {",
          "3515:    zval *ztype;",
          "3518:     soap_error0(E_ERROR,  \"Encoding: SoapVar has no 'enc_type' property\");",
          "3519:    }",
          "3520:    cur_type = Z_LVAL_P(ztype);",
          "3523:     cur_stype = Z_STRVAL_P(ztype);",
          "3524:    } else {",
          "3525:     cur_stype = NULL;",
          "3526:    }",
          "3529:     cur_ns = Z_STRVAL_P(ztype);",
          "3530:    } else {",
          "3531:     cur_ns = NULL;",
          "",
          "[Removed Lines]",
          "3517:    if ((ztype = zend_hash_str_find(Z_OBJPROP_P(tmp), \"enc_type\", sizeof(\"enc_type\")-1)) == NULL) {",
          "3522:    if ((ztype = zend_hash_str_find(Z_OBJPROP_P(tmp), \"enc_stype\", sizeof(\"enc_stype\")-1)) != NULL) {",
          "3528:    if ((ztype = zend_hash_str_find(Z_OBJPROP_P(tmp), \"enc_ns\", sizeof(\"enc_ns\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "3517:    if ((ztype = zend_hash_str_find(Z_OBJPROP_P(tmp), \"enc_type\", sizeof(\"enc_type\")-1)) == NULL ||",
          "3518:        Z_TYPE_P(ztype) != IS_LONG) {",
          "3523:    if ((ztype = zend_hash_str_find(Z_OBJPROP_P(tmp), \"enc_stype\", sizeof(\"enc_stype\")-1)) != NULL &&",
          "3524:        Z_TYPE_P(ztype) == IS_STRING) {",
          "3530:    if ((ztype = zend_hash_str_find(Z_OBJPROP_P(tmp), \"enc_ns\", sizeof(\"enc_ns\")-1)) != NULL &&",
          "3531:        Z_TYPE_P(ztype) == IS_STRING) {",
          "",
          "---------------"
        ],
        "ext/soap/php_http.c||ext/soap/php_http.c": [
          "File: ext/soap/php_http.c -> ext/soap/php_http.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "36: {",
          "37:  zval *login, *password;",
          "40:   zend_string *buf;",
          "41:   smart_str auth = {0};",
          "43:   smart_str_appendl(&auth, Z_STRVAL_P(login), Z_STRLEN_P(login));",
          "44:   smart_str_appendc(&auth, ':');",
          "46:    smart_str_appendl(&auth, Z_STRVAL_P(password), Z_STRLEN_P(password));",
          "47:   }",
          "48:   smart_str_0(&auth);",
          "",
          "[Removed Lines]",
          "39:  if ((login = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_proxy_login\", sizeof(\"_proxy_login\")-1)) != NULL) {",
          "45:   if ((password = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_proxy_password\", sizeof(\"_proxy_password\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "39:  if ((login = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_proxy_login\", sizeof(\"_proxy_login\")-1)) != NULL &&",
          "40:      Z_TYPE_P(login) == IS_STRING) {",
          "46:   if ((password = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_proxy_password\", sizeof(\"_proxy_password\")-1)) != NULL &&",
          "47:       Z_TYPE_P(password) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "63:  zval *login, *password;",
          "65:  if ((login = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_login\", sizeof(\"_login\")-1)) != NULL &&",
          "67:   zend_string* buf;",
          "68:   smart_str auth = {0};",
          "70:   smart_str_appendl(&auth, Z_STRVAL_P(login), Z_STRLEN_P(login));",
          "71:   smart_str_appendc(&auth, ':');",
          "73:    smart_str_appendl(&auth, Z_STRVAL_P(password), Z_STRLEN_P(password));",
          "74:   }",
          "75:   smart_str_0(&auth);",
          "",
          "[Removed Lines]",
          "66:    !zend_hash_str_exists(Z_OBJPROP_P(this_ptr), \"_digest\", sizeof(\"_digest\")-1)) {",
          "72:   if ((password = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_password\", sizeof(\"_password\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "68:      Z_TYPE_P(login) == IS_STRING &&",
          "69:      !zend_hash_str_exists(Z_OBJPROP_P(this_ptr), \"_digest\", sizeof(\"_digest\")-1)) {",
          "75:   if ((password = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_password\", sizeof(\"_password\")-1)) != NULL &&",
          "76:       Z_TYPE_P(password) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "565:   }",
          "566:   if (!http_1_1 ||",
          "567:    ((tmp = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_keep_alive\", sizeof(\"_keep_alive\")-1)) != NULL &&",
          "569:    smart_str_append_const(&soap_headers, \"\\r\\n\"",
          "570:     \"Connection: close\\r\\n\");",
          "571:   } else {",
          "",
          "[Removed Lines]",
          "568:     Z_LVAL_P(tmp) == 0)) {",
          "",
          "[Added Lines]",
          "572:     (Z_TYPE_P(tmp) == IS_FALSE || (Z_TYPE_P(tmp) == IS_LONG && Z_LVAL_P(tmp) == 0)))) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "797:   }",
          "801:    zval *data;",
          "802:    zend_string *key;",
          "803:    int i, n;",
          "",
          "[Removed Lines]",
          "800:   if ((cookies = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "804:   if ((cookies = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1)) != NULL &&",
          "805:       Z_TYPE_P(cookies) == IS_ARRAY) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "840:   smart_str_append_const(&soap_headers, \"\\r\\n\");",
          "841:   smart_str_0(&soap_headers);",
          "842:   if ((trace = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\")-1)) != NULL &&",
          "844:    add_property_stringl(this_ptr, \"__last_request_headers\", soap_headers.s->val, soap_headers.s->len);",
          "845:   }",
          "846:   smart_str_appendl(&soap_headers, request, request_size);",
          "",
          "[Removed Lines]",
          "843:       Z_LVAL_P(trace) > 0) {",
          "",
          "[Added Lines]",
          "848:       (Z_TYPE_P(trace) == IS_TRUE || (Z_TYPE_P(trace) == IS_LONG && Z_LVAL_P(trace) != 0))) {",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "885:   }",
          "887:   if ((trace = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\")-1)) != NULL &&",
          "889:    add_property_str(this_ptr, \"__last_response_headers\", zend_string_copy(http_headers));",
          "890:   }",
          "",
          "[Removed Lines]",
          "888:       Z_LVAL_P(trace) > 0) {",
          "",
          "[Added Lines]",
          "893:       (Z_TYPE_P(trace) == IS_TRUE || (Z_TYPE_P(trace) == IS_LONG && Z_LVAL_P(trace) != 0))) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "934:   char *eqpos, *sempos;",
          "935:   zval *cookies;",
          "938:    zval tmp_cookies;",
          "939:    array_init(&tmp_cookies);",
          "940:    cookies = zend_hash_str_update(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1, &tmp_cookies);",
          "",
          "[Removed Lines]",
          "937:   if ((cookies = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1)) == NULL) {",
          "",
          "[Added Lines]",
          "942:   if ((cookies = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1)) == NULL ||",
          "943:       Z_TYPE_P(cookies) != IS_ARRAY) {",
          "",
          "---------------"
        ],
        "ext/soap/soap.c||ext/soap/soap.c": [
          "File: ext/soap/soap.c -> ext/soap/soap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2581:  }",
          "2583:  if ((trace = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\")-1)) != NULL &&",
          "2585:   add_property_stringl(this_ptr, \"__last_request\", buf, buf_size);",
          "2586:  }",
          "",
          "[Removed Lines]",
          "2584:      Z_TYPE_P(trace) == IS_LONG && Z_LVAL_P(trace) > 0) {",
          "",
          "[Added Lines]",
          "2584:      (Z_TYPE_P(trace) == IS_TRUE || (Z_TYPE_P(trace) == IS_LONG && Z_LVAL_P(trace) != 0))) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2609:   }",
          "2610:   ret = FALSE;",
          "2611:  } else if ((trace = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\")-1)) != NULL &&",
          "2613:   add_property_str(this_ptr, \"__last_response\", zend_string_copy(Z_STR_P(response)));",
          "2614:  }",
          "2615:  zval_ptr_dtor(&func);",
          "",
          "[Removed Lines]",
          "2612:      Z_TYPE_P(trace) == IS_LONG && Z_LVAL_P(trace) > 0) {",
          "",
          "[Added Lines]",
          "2612:      (Z_TYPE_P(trace) == IS_TRUE || (Z_TYPE_P(trace) == IS_LONG && Z_LVAL_P(trace) != 0))) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2656:  SOAP_CLIENT_BEGIN_CODE();",
          "2660:   zend_hash_str_del(Z_OBJPROP_P(this_ptr), \"__last_request\", sizeof(\"__last_request\")-1);",
          "2661:   zend_hash_str_del(Z_OBJPROP_P(this_ptr), \"__last_response\", sizeof(\"__last_response\")-1);",
          "2662:  }",
          "2665:   soap_version = SOAP_1_2;",
          "2666:  } else {",
          "2667:   soap_version = SOAP_1_1;",
          "",
          "[Removed Lines]",
          "2658:  if ((trace = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\")-1)) != NULL",
          "2659:   && Z_LVAL_P(trace) > 0) {",
          "2663:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_soap_version\", sizeof(\"_soap_version\")-1)) != NULL",
          "2664:   && Z_LVAL_P(tmp) == SOAP_1_2) {",
          "",
          "[Added Lines]",
          "2658:  if ((trace = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\")-1)) != NULL &&",
          "2659:   (Z_TYPE_P(trace) == IS_TRUE || (Z_TYPE_P(trace) == IS_LONG && Z_LVAL_P(trace) != 0))) {",
          "2663:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_soap_version\", sizeof(\"_soap_version\")-1)) != NULL &&",
          "2664:   Z_TYPE_P(tmp) == IS_LONG && Z_LVAL_P(tmp) == SOAP_1_2) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2758:    zval *uri;",
          "2759:    smart_str action = {0};",
          "2762:     add_soap_fault(this_ptr, \"Client\", \"Error finding \\\"uri\\\" property\", NULL, NULL);",
          "2763:    } else if (location == NULL) {",
          "2764:     add_soap_fault(this_ptr, \"Client\", \"Error could not find \\\"location\\\" property\", NULL, NULL);",
          "",
          "[Removed Lines]",
          "2761:    if ((uri = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"uri\", sizeof(\"uri\")-1)) == NULL) {",
          "",
          "[Added Lines]",
          "2761:    if ((uri = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"uri\", sizeof(\"uri\")-1)) == NULL || Z_TYPE_P(uri) != IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "3018:   return;",
          "3019:  }",
          "3022:   RETURN_STR(zend_string_copy(Z_STR_P(tmp)));",
          "3023:  }",
          "3024:  RETURN_NULL();",
          "",
          "[Removed Lines]",
          "3021:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"__last_request\", sizeof(\"__last_request\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "3021:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"__last_request\", sizeof(\"__last_request\")-1)) != NULL &&",
          "3022:      Z_TYPE_P(tmp) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3036:   return;",
          "3037:  }",
          "3040:   RETURN_STR(zend_string_copy(Z_STR_P(tmp)));",
          "3041:  }",
          "3042:  RETURN_NULL();",
          "",
          "[Removed Lines]",
          "3039:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"__last_response\", sizeof(\"__last_response\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "3040:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"__last_response\", sizeof(\"__last_response\")-1)) != NULL &&",
          "3041:      Z_TYPE_P(tmp) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "3054:   return;",
          "3055:  }",
          "3058:   RETURN_STR(zend_string_copy(Z_STR_P(tmp)));",
          "3059:  }",
          "3060:  RETURN_NULL();",
          "",
          "[Removed Lines]",
          "3057:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"__last_request_headers\", sizeof(\"__last_request_headers\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "3059:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"__last_request_headers\", sizeof(\"__last_request_headers\")-1)) != NULL &&",
          "3060:      Z_TYPE_P(tmp) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "3072:   return;",
          "3073:  }",
          "3076:   RETURN_STR(zend_string_copy(Z_STR_P(tmp)));",
          "3077:  }",
          "3078:  RETURN_NULL();",
          "",
          "[Removed Lines]",
          "3075:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"__last_response_headers\", sizeof(\"__last_response_headers\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "3078:  if ((tmp = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"__last_response_headers\", sizeof(\"__last_response_headers\")-1)) != NULL &&",
          "3079:      Z_TYPE_P(tmp) == IS_STRING) {",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "3129:  }",
          "3131:  if (val == NULL) {",
          "3133:    zend_hash_str_del(Z_ARRVAL_P(cookies), name, name_len);",
          "3134:   }",
          "3135:  } else {",
          "3136:   zval zcookie;",
          "3139:    zval tmp_cookies;",
          "3141:    array_init(&tmp_cookies);",
          "",
          "[Removed Lines]",
          "3132:   if ((cookies = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1)) != NULL) {",
          "3138:   if ((cookies = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1)) == NULL) {",
          "",
          "[Added Lines]",
          "3136:   if ((cookies = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1)) != NULL &&",
          "3137:       Z_TYPE_P(cookies) == IS_ARRAY) {",
          "3143:   if ((cookies = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"_cookies\", sizeof(\"_cookies\")-1)) == NULL ||",
          "3144:       Z_TYPE_P(cookies) != IS_ARRAY) {",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3160:  }",
          "3164:   ZVAL_ARR(return_value, zend_array_dup(Z_ARRVAL_P(cookies)));",
          "3165:  } else {",
          "3166:   array_init(return_value);",
          "",
          "[Removed Lines]",
          "3163:  if ((cookies = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"_cookies\", sizeof(\"_cookies\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "3169:  if ((cookies = zend_hash_str_find(Z_OBJPROP_P(getThis()), \"_cookies\", sizeof(\"_cookies\")-1)) != NULL &&",
          "3170:      Z_TYPE_P(cookies) == IS_ARRAY) {",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "4240:    }",
          "4241:   }",
          "4242:  } else {",
          "4244:    style = Z_LVAL_P(zstyle);",
          "4245:   } else {",
          "4246:    style = SOAP_RPC;",
          "",
          "[Removed Lines]",
          "4243:   if ((zstyle = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"style\", sizeof(\"style\")-1)) != NULL) {",
          "",
          "[Added Lines]",
          "4250:   if ((zstyle = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"style\", sizeof(\"style\")-1)) != NULL &&",
          "4251:       Z_TYPE_P(zstyle) == IS_LONG) {",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "4263:   }",
          "4265:   if ((zuse = zend_hash_str_find(Z_OBJPROP_P(this_ptr), \"use\", sizeof(\"use\")-1)) != NULL &&",
          "4267:    use = SOAP_LITERAL;",
          "4268:   } else {",
          "4269:    use = SOAP_ENCODED;",
          "",
          "[Removed Lines]",
          "4266:      Z_LVAL_P(zuse) == SOAP_LITERAL) {",
          "",
          "[Added Lines]",
          "4274:        Z_TYPE_P(zuse) == IS_LONG && Z_LVAL_P(zuse) == SOAP_LITERAL) {",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "4391:   zval *param_data;",
          "4393:   if ((param_name = zend_hash_str_find(Z_OBJPROP_P(param_val), \"param_name\", sizeof(\"param_name\")-1)) != NULL &&",
          "4394:       (param_data = zend_hash_str_find(Z_OBJPROP_P(param_val), \"param_data\", sizeof(\"param_data\")-1)) != NULL) {",
          "4395:    param_val = param_data;",
          "4396:    name = Z_STRVAL_P(param_name);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4402:       Z_TYPE_P(param_name) == IS_STRING &&",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7dce9533e779c4f22779af6e35a664537bfdcb9a",
      "candidate_info": {
        "commit_hash": "7dce9533e779c4f22779af6e35a664537bfdcb9a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/7dce9533e779c4f22779af6e35a664537bfdcb9a",
        "files": [
          "ext/soap/soap.c"
        ],
        "message": "fix type in fix for #69085\n\n(cherry picked from commit 085e9ddc26f37ce556b8fd787044746e726264b2)",
        "before_after_code_files": [
          "ext/soap/soap.c||ext/soap/soap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/soap/soap.c||ext/soap/soap.c"
          ],
          "candidate": [
            "ext/soap/soap.c||ext/soap/soap.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/soap/soap.c||ext/soap/soap.c": [
          "File: ext/soap/soap.c -> ext/soap/soap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2569:  }",
          "2571:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2573:   add_property_stringl(this_ptr, \"__last_request\", buf, buf_size, 1);",
          "2574:  }",
          "",
          "[Removed Lines]",
          "2572:      (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2572:      (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2604:   }",
          "2605:   ret = FALSE;",
          "2606:  } else if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2608:   add_property_stringl(this_ptr, \"__last_response\", Z_STRVAL_P(response), Z_STRLEN_P(response), 1);",
          "2609:  }",
          "2610:  zval_ptr_dtor(&params[4]);",
          "",
          "[Removed Lines]",
          "2607:             (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2607:             (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2649:  SOAP_CLIENT_BEGIN_CODE();",
          "2651:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2653:   zend_hash_del(Z_OBJPROP_P(this_ptr), \"__last_request\", sizeof(\"__last_request\"));",
          "2654:   zend_hash_del(Z_OBJPROP_P(this_ptr), \"__last_response\", sizeof(\"__last_response\"));",
          "2655:  }",
          "",
          "[Removed Lines]",
          "2652:      (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2652:      (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0c87c34845e81fd5eaf32dc1abfe74f80a8507a1",
      "candidate_info": {
        "commit_hash": "0c87c34845e81fd5eaf32dc1abfe74f80a8507a1",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/0c87c34845e81fd5eaf32dc1abfe74f80a8507a1",
        "files": [
          "ext/soap/soap.c"
        ],
        "message": "fix type in fix for #69085\n\n(cherry picked from commit 085e9ddc26f37ce556b8fd787044746e726264b2)",
        "before_after_code_files": [
          "ext/soap/soap.c||ext/soap/soap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/soap/soap.c||ext/soap/soap.c"
          ],
          "candidate": [
            "ext/soap/soap.c||ext/soap/soap.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/soap/soap.c||ext/soap/soap.c": [
          "File: ext/soap/soap.c -> ext/soap/soap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2570:  }",
          "2572:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2574:   add_property_stringl(this_ptr, \"__last_request\", buf, buf_size, 1);",
          "2575:  }",
          "",
          "[Removed Lines]",
          "2573:      (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2573:      (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2605:   }",
          "2606:   ret = FALSE;",
          "2607:  } else if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2609:   add_property_stringl(this_ptr, \"__last_response\", Z_STRVAL_P(response), Z_STRLEN_P(response), 1);",
          "2610:  }",
          "2611:  zval_ptr_dtor(&params[4]);",
          "",
          "[Removed Lines]",
          "2608:             (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2608:             (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2650:  SOAP_CLIENT_BEGIN_CODE();",
          "2652:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2654:   zend_hash_del(Z_OBJPROP_P(this_ptr), \"__last_request\", sizeof(\"__last_request\"));",
          "2655:   zend_hash_del(Z_OBJPROP_P(this_ptr), \"__last_response\", sizeof(\"__last_response\"));",
          "2656:  }",
          "",
          "[Removed Lines]",
          "2653:      (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2653:      (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c61ceef7796b3967dd5e270245d33ba72ba055ee",
      "candidate_info": {
        "commit_hash": "c61ceef7796b3967dd5e270245d33ba72ba055ee",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/c61ceef7796b3967dd5e270245d33ba72ba055ee",
        "files": [
          "ext/soap/soap.c"
        ],
        "message": "fix type in fix for #69085\n\n(cherry picked from commit 085e9ddc26f37ce556b8fd787044746e726264b2)",
        "before_after_code_files": [
          "ext/soap/soap.c||ext/soap/soap.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/soap/soap.c||ext/soap/soap.c"
          ],
          "candidate": [
            "ext/soap/soap.c||ext/soap/soap.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/soap/soap.c||ext/soap/soap.c": [
          "File: ext/soap/soap.c -> ext/soap/soap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2570:  }",
          "2572:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2574:   add_property_stringl(this_ptr, \"__last_request\", buf, buf_size, 1);",
          "2575:  }",
          "",
          "[Removed Lines]",
          "2573:      (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2573:      (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2605:   }",
          "2606:   ret = FALSE;",
          "2607:  } else if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2609:   add_property_stringl(this_ptr, \"__last_response\", Z_STRVAL_P(response), Z_STRLEN_P(response), 1);",
          "2610:  }",
          "2611:  zval_ptr_dtor(&params[4]);",
          "",
          "[Removed Lines]",
          "2608:             (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2608:             (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2650:  SOAP_CLIENT_BEGIN_CODE();",
          "2652:  if (zend_hash_find(Z_OBJPROP_P(this_ptr), \"trace\", sizeof(\"trace\"), (void **) &trace) == SUCCESS &&",
          "2654:   zend_hash_del(Z_OBJPROP_P(this_ptr), \"__last_request\", sizeof(\"__last_request\"));",
          "2655:   zend_hash_del(Z_OBJPROP_P(this_ptr), \"__last_response\", sizeof(\"__last_response\"));",
          "2656:  }",
          "",
          "[Removed Lines]",
          "2653:      (Z_LVAL_PP(trace) == IS_BOOL || Z_LVAL_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "[Added Lines]",
          "2653:      (Z_TYPE_PP(trace) == IS_BOOL || Z_TYPE_PP(trace) == IS_LONG) && Z_LVAL_PP(trace) != 0) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}