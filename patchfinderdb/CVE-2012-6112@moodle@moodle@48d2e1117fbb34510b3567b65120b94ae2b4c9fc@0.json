{
  "cve_id": "CVE-2012-6112",
  "cve_desc": "classes/GoogleSpell.php in the PHP Spellchecker (aka Google Spellchecker) addon before 2.0.6.1 for TinyMCE, as used in Moodle 2.1.x before 2.1.10, 2.2.x before 2.2.7, 2.3.x before 2.3.4, and 2.4.x before 2.4.1 and other products, does not properly handle control characters, which allows remote attackers to trigger arbitrary outbound HTTP requests via a crafted string.",
  "repo": "moodle/moodle",
  "patch_hash": "48d2e1117fbb34510b3567b65120b94ae2b4c9fc",
  "patch_info": {
    "commit_hash": "48d2e1117fbb34510b3567b65120b94ae2b4c9fc",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/48d2e1117fbb34510b3567b65120b94ae2b4c9fc",
    "files": [
      "lib/editor/tinymce/plugins/spellchecker/changelog.txt",
      "lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php"
    ],
    "message": "MDL-37283 import tinymce spellchecker 2.0.6.1",
    "before_after_code_files": [
      "lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php"
    ]
  },
  "patch_diff": {
    "lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php": [
      "File: lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php -> lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "51:  }",
      "53:  function &_getMatches($lang, $str) {",
      "54:   $server = \"www.google.com\";",
      "55:   $port = 443;",
      "56:   $path = \"/tbproxy/spell?lang=\" . $lang . \"&hl=en\";",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "54:   $lang = preg_replace('/[^a-z\\-]/i', '', $lang); // Sanitize, remove everything but a-z or -",
      "55:   $str = preg_replace('/[\\x00-\\x1F\\x7F]/', '', $str); // Sanitize, remove all control characters",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f938b1a89b8f381129120a37915d1b345333b3fb",
      "candidate_info": {
        "commit_hash": "f938b1a89b8f381129120a37915d1b345333b3fb",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/f938b1a89b8f381129120a37915d1b345333b3fb",
        "files": [
          "lib/editor/tinymce/plugins/spellchecker/changelog.txt",
          "lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php"
        ],
        "message": "MDL-37283 import tinymce spellchecker 2.0.6.1",
        "before_after_code_files": [
          "lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php"
          ],
          "candidate": [
            "lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php": [
          "File: lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php -> lib/editor/tinymce/plugins/spellchecker/classes/GoogleSpell.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:  }",
          "53:  function &_getMatches($lang, $str) {",
          "54:   $server = \"www.google.com\";",
          "55:   $port = 443;",
          "56:   $path = \"/tbproxy/spell?lang=\" . $lang . \"&hl=en\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "54:   $lang = preg_replace('/[^a-z\\-]/i', '', $lang); // Sanitize, remove everything but a-z or -",
          "55:   $str = preg_replace('/[\\x00-\\x1F\\x7F]/', '', $str); // Sanitize, remove all control characters",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6fac8f7f04c9fe7f8bbb54a9c00ec5f9ea4f09e0",
      "candidate_info": {
        "commit_hash": "6fac8f7f04c9fe7f8bbb54a9c00ec5f9ea4f09e0",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/6fac8f7f04c9fe7f8bbb54a9c00ec5f9ea4f09e0",
        "files": [
          "lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/changelog.txt",
          "lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php"
        ],
        "message": "MDL-37283 import tinymce spellchecker 2.0.6.1",
        "before_after_code_files": [
          "lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php": [
          "File: lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php -> lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:  }",
          "53:  function &_getMatches($lang, $str) {",
          "54:   $server = \"www.google.com\";",
          "55:   $port = 443;",
          "56:   $path = \"/tbproxy/spell?lang=\" . $lang . \"&hl=en\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "54:   $lang = preg_replace('/[^a-z\\-]/i', '', $lang); // Sanitize, remove everything but a-z or -",
          "55:   $str = preg_replace('/[\\x00-\\x1F\\x7F]/', '', $str); // Sanitize, remove all control characters",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a3243760c243ddad76e91840134009c3681cb16a",
      "candidate_info": {
        "commit_hash": "a3243760c243ddad76e91840134009c3681cb16a",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/a3243760c243ddad76e91840134009c3681cb16a",
        "files": [
          "lib/editor/tinymce/tiny_mce/3.5.1.1/plugins/spellchecker/changelog.txt",
          "lib/editor/tinymce/tiny_mce/3.5.1.1/plugins/spellchecker/classes/GoogleSpell.php"
        ],
        "message": "MDL-37283 import tinymce spellchecker 2.0.6.1",
        "before_after_code_files": [
          "lib/editor/tinymce/tiny_mce/3.5.1.1/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/tiny_mce/3.5.1.1/plugins/spellchecker/classes/GoogleSpell.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/editor/tinymce/tiny_mce/3.5.1.1/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/tiny_mce/3.5.1.1/plugins/spellchecker/classes/GoogleSpell.php": [
          "File: lib/editor/tinymce/tiny_mce/3.5.1.1/plugins/spellchecker/classes/GoogleSpell.php -> lib/editor/tinymce/tiny_mce/3.5.1.1/plugins/spellchecker/classes/GoogleSpell.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:  }",
          "53:  function &_getMatches($lang, $str) {",
          "54:   $server = \"www.google.com\";",
          "55:   $port = 443;",
          "56:   $path = \"/tbproxy/spell?lang=\" . $lang . \"&hl=en\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "54:   $lang = preg_replace('/[^a-z\\-]/i', '', $lang); // Sanitize, remove everything but a-z or -",
          "55:   $str = preg_replace('/[\\x00-\\x1F\\x7F]/', '', $str); // Sanitize, remove all control characters",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9803d8fc3ce08c8f8b88ad3a95d9a7c97678a3e3",
      "candidate_info": {
        "commit_hash": "9803d8fc3ce08c8f8b88ad3a95d9a7c97678a3e3",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/9803d8fc3ce08c8f8b88ad3a95d9a7c97678a3e3",
        "files": [
          "lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/changelog.txt",
          "lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php"
        ],
        "message": "MDL-37283 import tinymce spellchecker 2.0.6.1",
        "before_after_code_files": [
          "lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php||lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php": [
          "File: lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php -> lib/editor/tinymce/tiny_mce/3.4.9/plugins/spellchecker/classes/GoogleSpell.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "51:  }",
          "53:  function &_getMatches($lang, $str) {",
          "54:   $server = \"www.google.com\";",
          "55:   $port = 443;",
          "56:   $path = \"/tbproxy/spell?lang=\" . $lang . \"&hl=en\";",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "54:   $lang = preg_replace('/[^a-z\\-]/i', '', $lang); // Sanitize, remove everything but a-z or -",
          "55:   $str = preg_replace('/[\\x00-\\x1F\\x7F]/', '', $str); // Sanitize, remove all control characters",
          "",
          "---------------"
        ]
      }
    }
  ]
}