{
  "cve_id": "CVE-2019-1010283",
  "cve_desc": "Univention Corporate Server univention-directory-notifier 12.0.1-3 and earlier is affected by: CWE-213: Intentional Information Exposure. The impact is: Loss of Confidentiality. The component is: function data_on_connection() in src/callback.c. The attack vector is: network connectivity. The fixed version is: 12.0.1-4 and later.",
  "repo": "univention/univention-corporate-server",
  "patch_hash": "a28053045bd2e778c50ed1acaf4e52e1e34f6e34",
  "patch_info": {
    "commit_hash": "a28053045bd2e778c50ed1acaf4e52e1e34f6e34",
    "repo": "univention/univention-corporate-server",
    "commit_url": "https://github.com/univention/univention-corporate-server/commit/a28053045bd2e778c50ed1acaf4e52e1e34f6e34",
    "files": [
      "management/univention-directory-notifier/debian/changelog",
      "management/univention-directory-notifier/src/callback.c"
    ],
    "message": "Bug #48427 UDN: Forbid vulnerable GET_DN for VERSION >= 3\n\nUDL using PROTOCOL_3 must no longer use GET_DN but WAIT_DN - if it is\nstill used this is a protocol violation. UDL simply will not get an\nanswer.\n\nWhen UCRV 'notifier/protocol/version is set to 3, any old client still\nusing PROTOCOL_2 will get rejected while negotiating the protocol\nversion, so it is asserted that \"version >= network_procotol_version\".",
    "before_after_code_files": [
      "management/univention-directory-notifier/src/callback.c||management/univention-directory-notifier/src/callback.c"
    ]
  },
  "patch_diff": {
    "management/univention-directory-notifier/src/callback.c||management/univention-directory-notifier/src/callback.c": [
      "File: management/univention-directory-notifier/src/callback.c -> management/univention-directory-notifier/src/callback.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "199:    p+=strlen(network_line);",
      "204:    univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: GET_DN\");",
      "",
      "[Removed Lines]",
      "202:   } else if ( !strncmp(network_line, \"GET_DN \", strlen(\"GET_DN \")) && msg_id != UINT32_MAX && network_client_get_version(fd) > 0) {",
      "",
      "[Added Lines]",
      "202:   } else if ( !strncmp(network_line, \"GET_DN \", strlen(\"GET_DN \")) && msg_id != UINT32_MAX && version > PROTOCOL_UNKNOWN && version < PROTOCOL_3) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6514040034255161541f7171a0658e7de5e9be5b",
      "candidate_info": {
        "commit_hash": "6514040034255161541f7171a0658e7de5e9be5b",
        "repo": "univention/univention-corporate-server",
        "commit_url": "https://github.com/univention/univention-corporate-server/commit/6514040034255161541f7171a0658e7de5e9be5b",
        "files": [
          "test/branch-tests/base/bug48427-master-after-backup.cfg",
          "test/branch-tests/base/bug48427-master-and-backup.cfg",
          "test/branch-tests/base/bug48427-setup.cfg",
          "test/branch-tests/base/bug48427-single-master.cfg"
        ],
        "message": "Bug #48427 test: Add branch tests WIP\n\nkvm_user defaults to $USER\n[$vm_NETWORK_DHCP_IP] required GET_NETWORK_DHCP_IP to be called.\nUse distict log files per test case to allow parallel execution.\nUse sane kvm_extra_label\nDo not install univention-self-service* - fail to join.\n\nUse\n+ . utils.sh && run_setup_join_on_non_master\ninstead of\n- . utils.sh && run_setup_join\non backups as only the first correctly passes the credentials to join.\n\nCreate missing file for branch repository.\nFix result fetching.\nEnable parallel mode.",
        "before_after_code_files": [
          "test/branch-tests/base/bug48427-master-after-backup.cfg||test/branch-tests/base/bug48427-master-after-backup.cfg",
          "test/branch-tests/base/bug48427-master-and-backup.cfg||test/branch-tests/base/bug48427-master-and-backup.cfg",
          "test/branch-tests/base/bug48427-setup.cfg||test/branch-tests/base/bug48427-setup.cfg",
          "test/branch-tests/base/bug48427-single-master.cfg||test/branch-tests/base/bug48427-single-master.cfg"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/branch-tests/base/bug48427-master-after-backup.cfg||test/branch-tests/base/bug48427-master-after-backup.cfg": [
          "File: test/branch-tests/base/bug48427-master-after-backup.cfg -> test/branch-tests/base/bug48427-master-after-backup.cfg",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: [Global]",
          "2: # These settings can be overwritten by the instance",
          "3: logfile: bug48427-master-after-backup.log",
          "4: parallel: true",
          "5: kvm_server: lattjo",
          "7: # network configuration",
          "8: kvm_network: appliance-net",
          "9: kvm_interface: eth0",
          "10: kvm_extra_label: bug48427",
          "12: # template configuration",
          "13: kvm_template: branchtest",
          "14: kvm_operating_system: Others",
          "15: kvm_architecture: amd64",
          "16: kvm_ucsversion: 4.3-3",
          "18: jenkins_description: checks, base, ucr, univention-lib, apache, saml, self_service and crypto tests",
          "20: [master]",
          "21: environment:",
          "22:  UCS_BRANCH=phahn/48427-udn",
          "23:  UCSSCHOOL_BRANCH=4.3",
          "24:  TEST_SECTIONS=",
          "25:  TEST_TAGS=",
          "26:  UCS_VERSION=4.3-3",
          "27:  APT_REPO=deb [trusted=yes] http://10.200.18.180/debian/ phahn48427-udn main",
          "28:  REBOOT_AFTER_UPDATE=1",
          "29:  TARGET_VERSION=4.3-3",
          "30:  RELEASE_UPDATE=public",
          "31:  ERRATA_UPDATE=public",
          "32: profile:",
          "33:  hostname=\"master\"",
          "34:  domainname=\"test.local\"",
          "35:  windows/domain=\"TEST\"",
          "36:  ldap/base=\"dc=test,dc=local\"",
          "37:  root_password=\"univention\"",
          "38:  locale/default=\"de_DE.UTF-8:UTF-8\"",
          "39:  packages_install=\"\"",
          "40:  server/role=\"domaincontroller_master\"",
          "41:  interfaces/eth0/type=\"dhcp\"",
          "42:  interfaces/eth1/type=\"manual\"",
          "43:  interfaces/eth1/start=\"true\"",
          "44: command1:",
          "45:  . utils.sh && basic_setup",
          "46:  . utils.sh && add_tech_key_authorized_keys",
          "47:  . utils.sh && rotate_logfiles",
          "48:  . utils.sh && jenkins_updates",
          "49:  . utils.sh && run_setup_join",
          "50:  . utils.sh && assert_join",
          "51:  . utils.sh && import_license",
          "52:  GET_NETWORK_DHCP_IP",
          "53:  . utils.sh && do_reboot",
          "54:  LOCAL sleep 120",
          "55:  . utils.sh && wait_for_reboot",
          "56: command2:",
          "57: command3:",
          "58: files:",
          "59:  ~/ec2/license/license.secret /etc/",
          "60:  ~/ec2/scripts/activate-errata-test-scope.sh /root/",
          "62: [backup]",
          "63: environment:",
          "64:  UCS_BRANCH=phahn/48427-udn",
          "65:  UCSSCHOOL_BRANCH=4.3",
          "66:  TEST_SECTIONS=",
          "67:  TEST_TAGS=",
          "68:  UCS_VERSION=4.3-3",
          "69:  APT_REPO=deb [trusted=yes] http://10.200.18.180/debian/ phahn48427-udn main",
          "70:  REBOOT_AFTER_UPDATE=1",
          "71:  TARGET_VERSION=4.3-3",
          "72:  RELEASE_UPDATE=public",
          "73:  ERRATA_UPDATE=public",
          "74: profile:",
          "75:  hostname=\"backup\"",
          "76:  domainname=\"test.local\"",
          "77:  windows/domain=\"TEST\"",
          "78:  ldap/base=\"dc=test,dc=local\"",
          "79:  root_password=\"univention\"",
          "80:  locale/default=\"de_DE.UTF-8:UTF-8\"",
          "81:  packages_install=\"\"",
          "82:  server/role=\"domaincontroller_backup\"",
          "83:  interfaces/eth0/type=\"dhcp\"",
          "84:  interfaces/eth1/type=\"manual\"",
          "85:  interfaces/eth1/start=\"true\"",
          "86: command1:",
          "87:  . utils.sh && basic_setup",
          "88:  . utils.sh && add_tech_key_authorized_keys",
          "89:  . utils.sh && rotate_logfiles",
          "90:  [ -s apt-get-branch-repo.list ] || echo \"$APT_REPO\" >apt-get-branch-repo.list",
          "91:  . utils.sh && add_branch_repository",
          "92:  . utils.sh && jenkins_updates",
          "93: command2:",
          "94:  ucr set nameserver1=\"[master_NETWORK_DHCP_IP]\"",
          "95:  . utils.sh && run_setup_join_on_non_master",
          "96:  . utils.sh && assert_join",
          "97:  . utils.sh && install_ucs_test",
          "98:  . utils.sh && do_reboot",
          "99:  LOCAL sleep 120",
          "100:  . utils.sh && wait_for_reboot",
          "101:  . utils.sh && run_workarounds_before_starting_the_tests",
          "102:  . utils.sh && run_tests -s checks -s base -s ucr -s univention-lib -s apache -s saml -s self_service -s crypto",
          "103: command3:",
          "104:  . utils.sh && prepare_results",
          "105:  LOCAL utils/utils-local.sh fetch-results \"[backup_IP]\" bug48427-master-after-backup",
          "106: files:",
          "107:  ~/ec2/scripts/activate-errata-test-scope.sh /root/",
          "",
          "---------------"
        ],
        "test/branch-tests/base/bug48427-master-and-backup.cfg||test/branch-tests/base/bug48427-master-and-backup.cfg": [
          "File: test/branch-tests/base/bug48427-master-and-backup.cfg -> test/branch-tests/base/bug48427-master-and-backup.cfg",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: [Global]",
          "2: # These settings can be overwritten by the instance",
          "3: logfile: bug48427-master-and-backup.log",
          "4: parallel: true",
          "5: kvm_server: sparka",
          "7: # network configuration",
          "8: kvm_network: appliance-net",
          "9: kvm_interface: eth0",
          "10: kvm_extra_label: bug48427",
          "12: # template configuration",
          "13: kvm_template: branchtest",
          "14: kvm_operating_system: Others",
          "15: kvm_architecture: amd64",
          "16: kvm_ucsversion: 4.3-3",
          "18: jenkins_description: checks, base, ucr, univention-lib, apache, saml, self_service and crypto tests",
          "20: [master]",
          "21: environment:",
          "22:  UCS_BRANCH=phahn/48427-udn",
          "23:  UCSSCHOOL_BRANCH=4.3",
          "24:  TEST_SECTIONS=",
          "25:  TEST_TAGS=",
          "26:  UCS_VERSION=4.3-3",
          "27:  APT_REPO=deb [trusted=yes] http://10.200.18.180/debian/ phahn48427-udn main",
          "28:  REBOOT_AFTER_UPDATE=1",
          "29:  TARGET_VERSION=4.3-3",
          "30:  RELEASE_UPDATE=public",
          "31:  ERRATA_UPDATE=public",
          "32: profile:",
          "33:  hostname=\"master\"",
          "34:  domainname=\"test.local\"",
          "35:  windows/domain=\"TEST\"",
          "36:  ldap/base=\"dc=test,dc=local\"",
          "37:  root_password=\"univention\"",
          "38:  locale/default=\"de_DE.UTF-8:UTF-8\"",
          "39:  packages_install=\"\"",
          "40:  server/role=\"domaincontroller_master\"",
          "41:  interfaces/eth0/type=\"dhcp\"",
          "42:  interfaces/eth1/type=\"manual\"",
          "43:  interfaces/eth1/start=\"true\"",
          "44: command1:",
          "45:  . utils.sh && basic_setup",
          "46:  . utils.sh && add_tech_key_authorized_keys",
          "47:  . utils.sh && rotate_logfiles",
          "48:  [ -s apt-get-branch-repo.list ] || echo \"$APT_REPO\" >apt-get-branch-repo.list",
          "49:  . utils.sh && add_branch_repository",
          "50:  . utils.sh && jenkins_updates",
          "51:  . utils.sh && run_setup_join",
          "52:  . utils.sh && assert_join",
          "53:  . utils.sh && import_license",
          "54:  GET_NETWORK_DHCP_IP",
          "55:  . utils.sh && do_reboot",
          "56:  LOCAL sleep 120",
          "57:  . utils.sh && wait_for_reboot",
          "58: command2:",
          "59: command3:",
          "60: files:",
          "61:  ~/ec2/license/license.secret /etc/",
          "62:  ~/ec2/scripts/activate-errata-test-scope.sh /root/",
          "64: [backup]",
          "65: environment:",
          "66:  UCS_BRANCH=phahn/48427-udn",
          "67:  UCSSCHOOL_BRANCH=4.3",
          "68:  TEST_SECTIONS=",
          "69:  TEST_TAGS=",
          "70:  UCS_VERSION=4.3-3",
          "71:  APT_REPO=deb [trusted=yes] http://10.200.18.180/debian/ phahn48427-udn main",
          "72:  REBOOT_AFTER_UPDATE=1",
          "73:  TARGET_VERSION=4.3-3",
          "74:  RELEASE_UPDATE=public",
          "75:  ERRATA_UPDATE=public",
          "76: profile:",
          "77:  hostname=\"backup\"",
          "78:  domainname=\"test.local\"",
          "79:  windows/domain=\"TEST\"",
          "80:  ldap/base=\"dc=test,dc=local\"",
          "81:  root_password=\"univention\"",
          "82:  locale/default=\"de_DE.UTF-8:UTF-8\"",
          "83:  packages_install=\"\"",
          "84:  server/role=\"domaincontroller_backup\"",
          "85:  interfaces/eth0/type=\"dhcp\"",
          "86:  interfaces/eth1/type=\"manual\"",
          "87:  interfaces/eth1/start=\"true\"",
          "88: command1:",
          "89:  . utils.sh && basic_setup",
          "90:  . utils.sh && add_tech_key_authorized_keys",
          "91:  . utils.sh && rotate_logfiles",
          "92:  [ -s apt-get-branch-repo.list ] || echo \"$APT_REPO\" >apt-get-branch-repo.list",
          "93:  . utils.sh && add_branch_repository",
          "94:  . utils.sh && jenkins_updates",
          "95: command2:",
          "96:  ucr set nameserver1=\"[master_NETWORK_DHCP_IP]\"",
          "97:  . utils.sh && run_setup_join_on_non_master",
          "98:  . utils.sh && assert_join",
          "99:  . utils.sh && install_ucs_test",
          "100:  . utils.sh && do_reboot",
          "101:  LOCAL sleep 120",
          "102:  . utils.sh && wait_for_reboot",
          "103:  . utils.sh && run_workarounds_before_starting_the_tests",
          "104:  . utils.sh && run_tests -s checks -s base -s ucr -s univention-lib -s apache -s saml -s self_service -s crypto",
          "105: command3:",
          "106:  . utils.sh && prepare_results",
          "107:  LOCAL utils/utils-local.sh fetch-results \"[backup_IP]\" bug48427-master-and-backup",
          "108: files:",
          "109:  ~/ec2/scripts/activate-errata-test-scope.sh /root/",
          "",
          "---------------"
        ],
        "test/branch-tests/base/bug48427-setup.cfg||test/branch-tests/base/bug48427-setup.cfg": [
          "File: test/branch-tests/base/bug48427-setup.cfg -> test/branch-tests/base/bug48427-setup.cfg",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: [Global]",
          "2: # These settings can be overwritten by the instance",
          "3: logfile: bug48427-setup.log",
          "4: parallel: true",
          "5: kvm_server: kiwik",
          "7: # network configuration",
          "8: kvm_network: appliance-net",
          "9: kvm_interface: eth0",
          "10: kvm_extra_label: bug48427",
          "12: # template configuration",
          "13: kvm_template: branchtest",
          "14: kvm_operating_system: Others",
          "15: kvm_architecture: amd64",
          "16: kvm_ucsversion: 4.3-3",
          "18: jenkins_description: checks, base, ucr, univention-lib, apache, saml, self_service and crypto tests",
          "20: [master]",
          "21: environment:",
          "22:  UCS_BRANCH=phahn/48427-udn",
          "23:  UCSSCHOOL_BRANCH=4.3",
          "24:  TEST_SECTIONS=",
          "25:  TEST_TAGS=",
          "26:  UCS_VERSION=4.3-3",
          "27:  APT_REPO=deb [trusted=yes] http://10.200.18.180/debian/ phahn48427-udn main",
          "28:  REBOOT_AFTER_UPDATE=1",
          "29:  TARGET_VERSION=4.3-3",
          "30:  RELEASE_UPDATE=public",
          "31:  ERRATA_UPDATE=public",
          "32: profile:",
          "33:  hostname=\"master\"",
          "34:  domainname=\"test.local\"",
          "35:  windows/domain=\"TEST\"",
          "36:  ldap/base=\"dc=test,dc=local\"",
          "37:  root_password=\"univention\"",
          "38:  locale/default=\"de_DE.UTF-8:UTF-8\"",
          "39:  packages_install=\"\"",
          "40:  server/role=\"domaincontroller_master\"",
          "41:  interfaces/eth0/type=\"dhcp\"",
          "42:  interfaces/eth1/type=\"manual\"",
          "43:  interfaces/eth1/start=\"true\"",
          "44: command1:",
          "45:  . utils.sh && basic_setup",
          "46:  . utils.sh && add_tech_key_authorized_keys",
          "47:  . utils.sh && rotate_logfiles",
          "48:  [ -s apt-get-branch-repo.list ] || echo \"$APT_REPO\" >apt-get-branch-repo.list",
          "49:  . utils.sh && add_branch_repository",
          "50:  . utils.sh && jenkins_updates",
          "51:  . utils.sh && run_setup_join",
          "52:  . utils.sh && assert_join",
          "53:  . utils.sh && import_license",
          "54: files:",
          "55:  ~/ec2/license/license.secret /etc/",
          "56:  ~/ec2/scripts/activate-errata-test-scope.sh /root/",
          "",
          "---------------"
        ],
        "test/branch-tests/base/bug48427-single-master.cfg||test/branch-tests/base/bug48427-single-master.cfg": [
          "File: test/branch-tests/base/bug48427-single-master.cfg -> test/branch-tests/base/bug48427-single-master.cfg",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: [Global]",
          "2: # These settings can be overwritten by the instance",
          "3: logfile: bug48427-single-master.log",
          "4: parallel: true",
          "5: kvm_server: hejne",
          "7: # network configuration",
          "8: kvm_network: appliance-net",
          "9: kvm_interface: eth0",
          "10: kvm_extra_label: bug48427",
          "12: # template configuration",
          "13: kvm_template: branchtest",
          "14: kvm_operating_system: Others",
          "15: kvm_architecture: amd64",
          "16: kvm_ucsversion: 4.3-3",
          "18: jenkins_description: checks, base, ucr, univention-lib, apache, saml, self_service and crypto tests",
          "20: [master]",
          "21: environment:",
          "22:  UCS_BRANCH=phahn/48427-udn",
          "23:  UCSSCHOOL_BRANCH=4.3",
          "24:  TEST_SECTIONS=",
          "25:  TEST_TAGS=",
          "26:  UCS_VERSION=4.3-3",
          "27:  APT_REPO=deb [trusted=yes] http://10.200.18.180/debian/ phahn48427-udn main",
          "28:  REBOOT_AFTER_UPDATE=1",
          "29:  TARGET_VERSION=4.3-3",
          "30:  RELEASE_UPDATE=public",
          "31:  ERRATA_UPDATE=public",
          "32: profile:",
          "33:  hostname=\"master\"",
          "34:  domainname=\"test.local\"",
          "35:  windows/domain=\"TEST\"",
          "36:  ldap/base=\"dc=test,dc=local\"",
          "37:  root_password=\"univention\"",
          "38:  locale/default=\"de_DE.UTF-8:UTF-8\"",
          "39:  packages_install=\"\"",
          "40:  server/role=\"domaincontroller_master\"",
          "41:  interfaces/eth0/type=\"dhcp\"",
          "42:  interfaces/eth1/type=\"manual\"",
          "43:  interfaces/eth1/start=\"true\"",
          "44: command1:",
          "45:  . utils.sh && basic_setup",
          "46:  . utils.sh && add_tech_key_authorized_keys",
          "47:  . utils.sh && rotate_logfiles",
          "48:  [ -s apt-get-branch-repo.list ] || echo \"$APT_REPO\" >apt-get-branch-repo.list",
          "49:  . utils.sh && add_branch_repository",
          "50:  . utils.sh && jenkins_updates",
          "51:  . utils.sh && run_setup_join",
          "52:  . utils.sh && assert_join",
          "53:  . utils.sh && import_license",
          "54:  . utils.sh && install_ucs_test",
          "55:  . utils.sh && do_reboot",
          "56:  LOCAL sleep 120",
          "57:  . utils.sh && wait_for_reboot",
          "58:  . utils.sh && run_workarounds_before_starting_the_tests",
          "59:  . utils.sh && run_tests -s checks -s base -s ucr -s univention-lib -s apache -s saml -s self_service -s crypto",
          "60: command2:",
          "61:  . utils.sh && prepare_results",
          "62:  LOCAL utils/utils-local.sh fetch-results \"[master_IP]\" bug48427-single-master",
          "63: files:",
          "64:  ~/ec2/license/license.secret /etc/",
          "65:  ~/ec2/scripts/activate-errata-test-scope.sh /root/",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e4c3f7d720a242f70f6962d181e48e27c9cd6bc6",
      "candidate_info": {
        "commit_hash": "e4c3f7d720a242f70f6962d181e48e27c9cd6bc6",
        "repo": "univention/univention-corporate-server",
        "commit_url": "https://github.com/univention/univention-corporate-server/commit/e4c3f7d720a242f70f6962d181e48e27c9cd6bc6",
        "files": [
          "management/univention-directory-listener/debian/changelog",
          "management/univention-directory-listener/python/get_notifier_id.py",
          "management/univention-directory-listener/src/network.c",
          "management/univention-directory-listener/src/notifier.c"
        ],
        "message": "Bug #48427 udl: Implement UDN protocol version 3\n\nfetch transaction details from LDAP.",
        "before_after_code_files": [
          "management/univention-directory-listener/python/get_notifier_id.py||management/univention-directory-listener/python/get_notifier_id.py",
          "management/univention-directory-listener/src/network.c||management/univention-directory-listener/src/network.c",
          "management/univention-directory-listener/src/notifier.c||management/univention-directory-listener/src/notifier.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "management/univention-directory-listener/python/get_notifier_id.py||management/univention-directory-listener/python/get_notifier_id.py": [
          "File: management/univention-directory-listener/python/get_notifier_id.py -> management/univention-directory-listener/python/get_notifier_id.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "75:  \"\"\"Retrive current Univention Directory Notifier transaction ID.\"\"\"",
          "76:  options = parse_args()",
          "77:  try:",
          "81:   sock.recv(100)",
          "83:   sock.send('MSGID: 1\\n%s\\n\\n' % (options.cmd,))",
          "",
          "[Removed Lines]",
          "78:   sock = socket.create_connection((options.master, 6669))",
          "80:   sock.send('Version: 2\\nCapabilities: \\n\\n')",
          "",
          "[Added Lines]",
          "78:   sock = socket.create_connection((options.master, 6669), 60.0)",
          "80:   sock.send('Version: 3\\nCapabilities: \\n\\n')",
          "",
          "---------------"
        ],
        "management/univention-directory-listener/src/network.c||management/univention-directory-listener/src/network.c": [
          "File: management/univention-directory-listener/src/network.c -> management/univention-directory-listener/src/network.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "107: }",
          "111: static int send_block(NotifierClient *client, const char *buf, size_t len) {",
          "112:  univention_debug(UV_DEBUG_LISTENER, UV_DEBUG_ALL, \">>>%s\", buf);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "111: static int parse_wait_id(const char *line, NotifierEntry *entry) {",
          "112:  char *endptr;",
          "114:  entry->id = strtoul(line, &endptr, 10);",
          "115:  entry->dn = NULL;",
          "116:  entry->command = '\\0';",
          "117:  switch (*endptr) {",
          "118:  case '\\0':",
          "119:  case '\\n':",
          "120:   return 0;",
          "121:  default:",
          "122:   return 1;",
          "123:  }",
          "124: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "444:  univention_debug(UV_DEBUG_LISTENER, UV_DEBUG_INFO, \"established connection to %s port %d\", addrstr, NOTIFIER_PORT_PROTOCOL2);",
          "447:  const size_t len = strlen(header);",
          "448:  char *result, *tok;",
          "",
          "[Removed Lines]",
          "446:  const char *header = \"Version: 2\\nCapabilities: \\n\\n\";",
          "",
          "[Added Lines]",
          "463:  const char *header = \"Version: 3\\nCapabilities: \\n\\n\";",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "479:  free(result);",
          "482:   univention_debug(UV_DEBUG_LISTENER, UV_DEBUG_ERROR, \"Protocol version %d is not supported\", client->protocol);",
          "483:   free(client->server);",
          "484:   client->server = NULL;",
          "",
          "[Removed Lines]",
          "481:  if (client->protocol != 2) {",
          "",
          "[Added Lines]",
          "498:  if (client->protocol < 2) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "537:  if (client == NULL)",
          "538:   client = &global_client;",
          "541:  return notifier_send_command(client, request);",
          "542: }",
          "",
          "[Removed Lines]",
          "540:  snprintf(request, BUFSIZ, \"GET_DN %ld\\n\", id);",
          "",
          "[Added Lines]",
          "557:  switch (client->protocol) {",
          "558:  case 2:",
          "559:   snprintf(request, BUFSIZ, \"GET_DN %ld\\n\", id);",
          "560:   break;",
          "561:  case 3:",
          "562:   snprintf(request, BUFSIZ, \"WAIT_ID %ld\\n\", id);",
          "563:   break;",
          "564:  default:",
          "565:   abort();",
          "566:  }",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "551:   client = &global_client;",
          "553:  assert(client->fd > -1);",
          "555:  assert(len < BUFSIZ - 1);",
          "556:  send_block(client, buf, len);",
          "",
          "[Removed Lines]",
          "554:  len = snprintf(buf, BUFSIZ, \"MSGID: %d\\nGET_DN %ld\\n\\n\", msgid, id);",
          "",
          "[Added Lines]",
          "580:  switch (client->protocol) {",
          "581:  case 2:",
          "582:   len = snprintf(buf, BUFSIZ, \"MSGID: %d\\nGET_DN %ld\\n\\n\", msgid, id);",
          "583:   break;",
          "584:  case 3:",
          "585:   len = snprintf(buf, BUFSIZ, \"MSGID: %d\\nWAIT_ID %ld\\n\\n\", msgid, id);",
          "586:   break;",
          "587:  default:",
          "588:   abort();",
          "589:  }",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "563: int notifier_get_dn_result(NotifierClient *client, int msgid, NotifierEntry *entry) {",
          "564:  NotifierMessage *msg;",
          "566:  if (client == NULL)",
          "567:   client = &global_client;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "600:  int rc = 0;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "569:  if ((msg = notifier_wait_msg(client, msgid, NOTIFIER_TIMEOUT)) == NULL)",
          "570:   return 1;",
          "572:  parse_entry(msg->result, entry);",
          "573:  notifier_msg_free(msg);",
          "575: }",
          "",
          "[Removed Lines]",
          "574:  return 0;",
          "",
          "[Added Lines]",
          "608:  switch (client->protocol) {",
          "609:  case 2:",
          "611:   break;",
          "612:  case 3:",
          "613:   rc = parse_wait_id(msg->result, entry);",
          "614:   break;",
          "615:  default:",
          "616:   abort();",
          "617:  }",
          "619:  return rc;",
          "",
          "---------------"
        ],
        "management/univention-directory-listener/src/notifier.c||management/univention-directory-listener/src/notifier.c": [
          "File: management/univention-directory-listener/src/notifier.c -> management/univention-directory-listener/src/notifier.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "90:  }",
          "91: }",
          "94: int notifier_listen(univention_ldap_parameters_t *lp, bool write_transaction_file, univention_ldap_parameters_t *lp_local) {",
          "95:  int rv = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "94: int notifier_wait_id_result(struct transaction *trans) {",
          "95:  LDAPMessage *res;",
          "96:  char base[44];  // strlen(\"reqSession=%ld,cn=translog\") + strlen(ULONG_MAX)",
          "97:  int scope = LDAP_SCOPE_BASE;",
          "98:  char *filter = NULL;",
          "99:  char *attrs[] = {\"reqType\", \"reqDN\", NULL};",
          "100:  int attrsonly0 = 0;",
          "101:  LDAPControl **serverctrls = NULL;",
          "102:  LDAPControl **clientctrls = NULL;",
          "103:  struct timeval timeout = {",
          "104:   .tv_sec = 5 * 60, .tv_usec = 0,",
          "105:  };",
          "106:  int sizelimit0 = 1;",
          "107:  int rv;",
          "109:  snprintf(base, sizeof(base), \"reqSession=%ld,cn=translog\", trans->cur.notify.id);",
          "110:  if ((rv = LDAP_RETRY(trans->lp, ldap_search_ext_s(trans->lp->ld, base, scope, filter, attrs, attrsonly0, serverctrls, clientctrls, &timeout, sizelimit0, &res))) == LDAP_SUCCESS) {",
          "111:   LDAPMessage *entry = ldap_first_entry(trans->lp->ld, res);",
          "112:   struct berval **vals;",
          "114:   vals = ldap_get_values_len(trans->lp->ld, entry, \"reqDN\");",
          "115:   if (vals && vals[0]->bv_len > 0)",
          "116:    trans->cur.notify.dn = strndup(vals[0]->bv_val, vals[0]->bv_len + 1);",
          "117:   else",
          "118:    rv = LDAP_NO_SUCH_ATTRIBUTE;",
          "119:   ldap_value_free_len(vals);",
          "121:   vals = ldap_get_values_len(trans->lp->ld, entry, \"reqType\");",
          "122:   if (vals && vals[0]->bv_len == 1)",
          "123:    trans->cur.notify.command = vals[0]->bv_val[0];",
          "124:   else",
          "125:    rv = LDAP_NO_SUCH_ATTRIBUTE;",
          "126:   ldap_value_free_len(vals);",
          "127:   LOG(INFO, \"LDAP returned: id:%ld\\tdn:%s\\tcmd:%c\", trans->cur.notify.id, trans->cur.notify.dn, trans->cur.notify.command);",
          "128:  } else {",
          "129:   LOG(ERROR, \"LDAP failed %s (%d): id:%ld\", ldap_err2string(rv), rv, trans->cur.notify.id);",
          "130:  }",
          "131:  ldap_msgfree(res);",
          "133:  return rv;",
          "134: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "147:    univention_debug(UV_DEBUG_LISTENER, UV_DEBUG_ERROR, \"failed to get dn result\");",
          "148:    return 1;",
          "149:   }",
          "153:    univention_debug(UV_DEBUG_LISTENER, UV_DEBUG_ERROR, \"notifier returned transaction id %ld (%ld expected)\", trans.cur.notify.id, id + 1);",
          "154:    rv = 1;",
          "155:    goto out;",
          "156:   }",
          "160:   if (trans.lp->ld == NULL) {",
          "",
          "[Removed Lines]",
          "150:   univention_debug(UV_DEBUG_LISTENER, UV_DEBUG_INFO, \"notifier returned = id: %ld\\tdn: %s\\tcmd: %c\", trans.cur.notify.id, trans.cur.notify.dn, trans.cur.notify.command);",
          "152:   if (trans.cur.notify.id != id + 1) {",
          "157:   id = trans.cur.notify.id;",
          "",
          "[Added Lines]",
          "194:   univention_debug(UV_DEBUG_LISTENER, UV_DEBUG_INFO, \"notifier returned = id:%ld\\tdn:%s\\tcmd:%c\", trans.cur.notify.id, trans.cur.notify.dn ? trans.cur.notify.dn : \"<LDAP>\", trans.cur.notify.command ? trans.cur.notify.command : '*');",
          "196:   if ((trans.cur.notify.id != id + 1 && trans.cur.notify.command != '\\0') || trans.cur.notify.id <= id) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "162:     goto out;",
          "163:   }",
          "165:   if ((rv = change_update_dn(&trans)) != LDAP_SUCCESS) {",
          "166:    univention_debug(UV_DEBUG_LISTENER, UV_DEBUG_ERROR, \"change_update_dn failed: %d\", rv);",
          "167:    goto out;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "209:   if (trans.cur.notify.command == '\\0') {",
          "211:    trans.cur.notify.id = id + 1;",
          "212:    rv = notifier_wait_id_result(&trans);",
          "213:    if (rv != LDAP_SUCCESS)",
          "214:     goto out;",
          "215:   }",
          "216:   id = trans.cur.notify.id;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "02c139ec5103016ec72af455a1b8ea5ab2ecc9e3",
      "candidate_info": {
        "commit_hash": "02c139ec5103016ec72af455a1b8ea5ab2ecc9e3",
        "repo": "univention/univention-corporate-server",
        "commit_url": "https://github.com/univention/univention-corporate-server/commit/02c139ec5103016ec72af455a1b8ea5ab2ecc9e3",
        "files": [
          "management/univention-management-console-module-diagnostic/35univention-management-console-module-diagnostic.inst",
          "management/univention-management-console-module-diagnostic/debian/copyright",
          "management/univention-management-console-module-diagnostic/debian/rules",
          "management/univention-management-console-module-diagnostic/umc/js/diagnostic.js",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/__init__.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/00_check_server_password.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/02_certificate_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/03_check_notifier_replication.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/04_saml_certificate_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/20_check_nameservers.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/21_check_join_status.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/22_kdc_service.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/23_check_update_sites.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/30_disk_usage.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/31_file_permissions.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/40_samba_tool_dbcheck.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/41_samba_tool_showrepl.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/42_samba_tool_sysvolcheck.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/43_connectors4_rejects.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/44_well_known_sid_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/45_heimdal_on_samba4_dc.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/46_kerberos_ddns_update.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/50_check_ucr_templates.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/51_hostname_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/52_mail_acl_sync.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/54_sources_list_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/util.py"
        ],
        "message": "Bug #48427 umc-diag: Copyright 2019",
        "before_after_code_files": [
          "management/univention-management-console-module-diagnostic/35univention-management-console-module-diagnostic.inst||management/univention-management-console-module-diagnostic/35univention-management-console-module-diagnostic.inst",
          "management/univention-management-console-module-diagnostic/umc/js/diagnostic.js||management/univention-management-console-module-diagnostic/umc/js/diagnostic.js",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/__init__.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/__init__.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/00_check_server_password.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/00_check_server_password.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/02_certificate_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/02_certificate_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/03_check_notifier_replication.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/03_check_notifier_replication.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/04_saml_certificate_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/04_saml_certificate_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/20_check_nameservers.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/20_check_nameservers.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/21_check_join_status.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/21_check_join_status.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/22_kdc_service.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/22_kdc_service.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/23_check_update_sites.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/23_check_update_sites.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/30_disk_usage.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/30_disk_usage.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/31_file_permissions.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/31_file_permissions.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/40_samba_tool_dbcheck.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/40_samba_tool_dbcheck.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/41_samba_tool_showrepl.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/41_samba_tool_showrepl.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/42_samba_tool_sysvolcheck.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/42_samba_tool_sysvolcheck.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/43_connectors4_rejects.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/43_connectors4_rejects.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/44_well_known_sid_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/44_well_known_sid_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/45_heimdal_on_samba4_dc.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/45_heimdal_on_samba4_dc.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/46_kerberos_ddns_update.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/46_kerberos_ddns_update.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/50_check_ucr_templates.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/50_check_ucr_templates.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/51_hostname_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/51_hostname_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/52_mail_acl_sync.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/52_mail_acl_sync.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/54_sources_list_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/54_sources_list_check.py",
          "management/univention-management-console-module-diagnostic/umc/python/diagnostic/util.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/util.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "management/univention-management-console-module-diagnostic/35univention-management-console-module-diagnostic.inst||management/univention-management-console-module-diagnostic/35univention-management-console-module-diagnostic.inst": [
          "File: management/univention-management-console-module-diagnostic/35univention-management-console-module-diagnostic.inst -> management/univention-management-console-module-diagnostic/35univention-management-console-module-diagnostic.inst",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console Module diagnostic",
          "5: #  join script",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2014-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2014-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/js/diagnostic.js||management/univention-management-console-module-diagnostic/umc/js/diagnostic.js": [
          "File: management/univention-management-console-module-diagnostic/umc/js/diagnostic.js -> management/univention-management-console-module-diagnostic/umc/js/diagnostic.js"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/__init__.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/__init__.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/__init__.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/__init__.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2014-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2014-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/00_check_server_password.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/00_check_server_password.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/00_check_server_password.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/00_check_server_password.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2016-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2016-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/02_certificate_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/02_certificate_check.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/02_certificate_check.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/02_certificate_check.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/03_check_notifier_replication.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/03_check_notifier_replication.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/03_check_notifier_replication.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/03_check_notifier_replication.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2016-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2016-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/04_saml_certificate_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/04_saml_certificate_check.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/04_saml_certificate_check.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/04_saml_certificate_check.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/20_check_nameservers.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/20_check_nameservers.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/20_check_nameservers.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/20_check_nameservers.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/21_check_join_status.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/21_check_join_status.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/21_check_join_status.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/21_check_join_status.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2016-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2016-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/22_kdc_service.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/22_kdc_service.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/22_kdc_service.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/22_kdc_service.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2016-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2016-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/23_check_update_sites.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/23_check_update_sites.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/23_check_update_sites.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/23_check_update_sites.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2016-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2016-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/30_disk_usage.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/30_disk_usage.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/30_disk_usage.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/30_disk_usage.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/31_file_permissions.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/31_file_permissions.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/31_file_permissions.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/31_file_permissions.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/40_samba_tool_dbcheck.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/40_samba_tool_dbcheck.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/40_samba_tool_dbcheck.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/40_samba_tool_dbcheck.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2016-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2016-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/41_samba_tool_showrepl.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/41_samba_tool_showrepl.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/41_samba_tool_showrepl.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/41_samba_tool_showrepl.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/42_samba_tool_sysvolcheck.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/42_samba_tool_sysvolcheck.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/42_samba_tool_sysvolcheck.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/42_samba_tool_sysvolcheck.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/43_connectors4_rejects.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/43_connectors4_rejects.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/43_connectors4_rejects.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/43_connectors4_rejects.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2016-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2016-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/44_well_known_sid_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/44_well_known_sid_check.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/44_well_known_sid_check.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/44_well_known_sid_check.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/45_heimdal_on_samba4_dc.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/45_heimdal_on_samba4_dc.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/45_heimdal_on_samba4_dc.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/45_heimdal_on_samba4_dc.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/46_kerberos_ddns_update.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/46_kerberos_ddns_update.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/46_kerberos_ddns_update.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/46_kerberos_ddns_update.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/50_check_ucr_templates.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/50_check_ucr_templates.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/50_check_ucr_templates.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/50_check_ucr_templates.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2016-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2016-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/51_hostname_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/51_hostname_check.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/51_hostname_check.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/51_hostname_check.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/52_mail_acl_sync.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/52_mail_acl_sync.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/52_mail_acl_sync.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/52_mail_acl_sync.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/54_sources_list_check.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/54_sources_list_check.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/54_sources_list_check.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/plugins/54_sources_list_check.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ],
        "management/univention-management-console-module-diagnostic/umc/python/diagnostic/util.py||management/univention-management-console-module-diagnostic/umc/python/diagnostic/util.py": [
          "File: management/univention-management-console-module-diagnostic/umc/python/diagnostic/util.py -> management/univention-management-console-module-diagnostic/umc/python/diagnostic/util.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: # Univention Management Console module:",
          "5: #  System Diagnosis UMC module",
          "6: #",
          "8: #",
          "9: # http://www.univention.de/",
          "10: #",
          "",
          "[Removed Lines]",
          "7: # Copyright 2017-2018 Univention GmbH",
          "",
          "[Added Lines]",
          "7: # Copyright 2017-2019 Univention GmbH",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6747cfbeab3a19b8667288e758119145320756e7",
      "candidate_info": {
        "commit_hash": "6747cfbeab3a19b8667288e758119145320756e7",
        "repo": "univention/univention-corporate-server",
        "commit_url": "https://github.com/univention/univention-corporate-server/commit/6747cfbeab3a19b8667288e758119145320756e7",
        "files": [
          "management/univention-ldap/01univention-ldap-server-init.inst",
          "management/univention-ldap/conffiles/etc/ldap/slapd.conf.d/31modules",
          "management/univention-ldap/conffiles/etc/ldap/slapd.conf.d/40univention-ldap-server_database",
          "management/univention-ldap/conffiles/etc/ldap/slapd.conf.d/99translog",
          "management/univention-ldap/conffiles/var/lib/univention-ldap/ldap/DB_CONFIG",
          "management/univention-ldap/conffiles/var/lib/univention-ldap/translog/DB_CONFIG",
          "management/univention-ldap/debian/changelog",
          "management/univention-ldap/debian/univention-ldap-config.install",
          "management/univention-ldap/debian/univention-ldap-server.dirs",
          "management/univention-ldap/debian/univention-ldap-server.install",
          "management/univention-ldap/debian/univention-ldap-server.postinst",
          "management/univention-ldap/debian/univention-ldap-server.univention-config-registry",
          "management/univention-ldap/scripts/setup-translog",
          "management/univention-ldap/translog.ldif"
        ],
        "message": "Bug #48427 ldap: Add transaction log database\n\nSplit the slapd module loading chunk into a separate file to allow\nloading other modules.\n\nPut the code to setup the cn=translog database into a separate file to\nbe able to call it on\n1) upgrades of joined master and backup\n2) new installation of master\n3) joining backups\nwithout running the join-script \"01\" again.",
        "before_after_code_files": [
          "management/univention-ldap/01univention-ldap-server-init.inst||management/univention-ldap/01univention-ldap-server-init.inst",
          "management/univention-ldap/debian/univention-ldap-config.install||management/univention-ldap/debian/univention-ldap-config.install",
          "management/univention-ldap/debian/univention-ldap-server.dirs||management/univention-ldap/debian/univention-ldap-server.dirs",
          "management/univention-ldap/debian/univention-ldap-server.install||management/univention-ldap/debian/univention-ldap-server.install",
          "management/univention-ldap/debian/univention-ldap-server.postinst||management/univention-ldap/debian/univention-ldap-server.postinst",
          "management/univention-ldap/debian/univention-ldap-server.univention-config-registry||management/univention-ldap/debian/univention-ldap-server.univention-config-registry",
          "management/univention-ldap/translog.ldif||management/univention-ldap/translog.ldif"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "management/univention-ldap/01univention-ldap-server-init.inst||management/univention-ldap/01univention-ldap-server-init.inst": [
          "File: management/univention-ldap/01univention-ldap-server-init.inst -> management/univention-ldap/01univention-ldap-server-init.inst",
          "--- Hunk 1 ---",
          "[Context before]",
          "111:  test -x /usr/sbin/nscd && /usr/sbin/nscd -i passwd",
          "112:  test -x /usr/sbin/nscd && /usr/sbin/nscd -i group",
          "113: fi",
          "115: service slapd start",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "114: /usr/share/univention-ldap/setup-translog db \"$@\"",
          "",
          "---------------"
        ],
        "management/univention-ldap/debian/univention-ldap-config.install||management/univention-ldap/debian/univention-ldap-config.install": [
          "File: management/univention-ldap/debian/univention-ldap-config.install -> management/univention-ldap/debian/univention-ldap-config.install",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: schema/*.schema usr/share/univention-ldap/schema/",
          "2: schema/oid.registry usr/share/univention-ldap/schema/",
          "6: scripts/convert_to_sharesSambaWriteable.py usr/share/univention-ldap/",
          "",
          "[Removed Lines]",
          "3: base.ldif usr/share/univention-ldap/",
          "4: ffpu.ldif usr/share/univention-ldap/",
          "5: core-edition.ldif usr/share/univention-ldap/",
          "",
          "[Added Lines]",
          "3: ./*.ldif usr/share/univention-ldap/",
          "",
          "---------------"
        ],
        "management/univention-ldap/debian/univention-ldap-server.dirs||management/univention-ldap/debian/univention-ldap-server.dirs": [
          "File: management/univention-ldap/debian/univention-ldap-server.dirs -> management/univention-ldap/debian/univention-ldap-server.dirs",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: var/lib/univention-ldap/ldap",
          "2: var/lib/univention-ldap/replog",
          "3: var/lib/univention-ldap/fake",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2: var/lib/univention-ldap/translog",
          "",
          "---------------"
        ],
        "management/univention-ldap/debian/univention-ldap-server.install||management/univention-ldap/debian/univention-ldap-server.install": [
          "File: management/univention-ldap/debian/univention-ldap-server.install -> management/univention-ldap/debian/univention-ldap-server.install",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: scripts/create-dh-parameter-files usr/share/univention-ldap/",
          "10: dh_2048.pem usr/share/univention-ldap/",
          "11: scripts/ldap_setup_index usr/share/univention-ldap/",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "12: scripts/setup-translog usr/share/univention-ldap/",
          "",
          "---------------"
        ],
        "management/univention-ldap/debian/univention-ldap-server.postinst||management/univention-ldap/debian/univention-ldap-server.postinst": [
          "File: management/univention-ldap/debian/univention-ldap-server.postinst -> management/univention-ldap/debian/univention-ldap-server.postinst",
          "--- Hunk 1 ---",
          "[Context before]",
          "188: }",
          "190: if [ \"$server_role\" = \"domaincontroller_master\" ] || [ \"$server_role\" = \"domaincontroller_backup\" ]; then",
          "191:  /usr/lib/univention-install/01univention-ldap-server-init.inst || true",
          "192:  /usr/lib/univention-install/10univention-ldap-server.inst || true",
          "193:  [ \"$1\" = configure ] && dpkg --compare-versions \"$2\" lt-nl 11.0.12-5 && upgrade_license || :",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "191:  JOIN_FORCE=\"$([ \"$1\" = configure ] && dpkg --compare-versions \"$2\" lt-nl 14.0.2-35 && echo 1)\" \\",
          "",
          "---------------"
        ],
        "management/univention-ldap/debian/univention-ldap-server.univention-config-registry||management/univention-ldap/debian/univention-ldap-server.univention-config-registry": [
          "File: management/univention-ldap/debian/univention-ldap-server.univention-config-registry -> management/univention-ldap/debian/univention-ldap-server.univention-config-registry",
          "--- Hunk 1 ---",
          "[Context before]",
          "60: Variables: ldap/idletimeout",
          "61: Variables: ldap/attributeoptions",
          "63: Type: subfile",
          "64: Multifile: etc/ldap/slapd.conf",
          "65: Subfile: etc/ldap/slapd.conf.d/40univention-ldap-server_database",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "63: Type: subfile",
          "64: Multifile: etc/ldap/slapd.conf",
          "65: Subfile: etc/ldap/slapd.conf.d/31modules",
          "66: Variables: ldap/database/type",
          "67: Variables: ldap/translogfile",
          "68: Variables: ldap/k5pwd",
          "69: Variables: ldap/pwd_scheme_kinit",
          "70: Variables: ldap/ppolicy",
          "71: Variables: ldap/shadowbind",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "90: Variables: ldap/shadowbind",
          "91: Variables: ldap/shadowbind/ignorefilter",
          "93: Type: file",
          "94: File: etc/cron.d/univention-ldap",
          "95: Variables: ldap/tls/dh/cron",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "103: Type: subfile",
          "104: Multifile: etc/ldap/slapd.conf",
          "105: Subfile: etc/ldap/slapd.conf.d/99translog",
          "",
          "---------------"
        ],
        "management/univention-ldap/translog.ldif||management/univention-ldap/translog.ldif": [
          "File: management/univention-ldap/translog.ldif -> management/univention-ldap/translog.ldif",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: dn: cn=translog",
          "2: objectClass: organizationalRole",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b079abc51505db9324a7a43f057c79aacb1e993d",
      "candidate_info": {
        "commit_hash": "b079abc51505db9324a7a43f057c79aacb1e993d",
        "repo": "univention/univention-corporate-server",
        "commit_url": "https://github.com/univention/univention-corporate-server/commit/b079abc51505db9324a7a43f057c79aacb1e993d",
        "files": [
          "management/univention-directory-notifier/conffiles/etc/runit/univention-directory-notifier/run",
          "management/univention-directory-notifier/debian/changelog",
          "management/univention-directory-notifier/debian/univention-directory-notifier.postinst",
          "management/univention-directory-notifier/debian/univention-directory-notifier.univention-config-registry-variables",
          "management/univention-directory-notifier/src/callback.c",
          "management/univention-directory-notifier/src/network.c",
          "management/univention-directory-notifier/src/network.h",
          "management/univention-directory-notifier/src/univention-directory-notifier.c"
        ],
        "message": "Bug #48427 udn: Add protocol version 3\n\nFor now always allow minimum version 2 as a newly installed Backup will\nonly support version 3, which will not work with old UDLs.\nWe will change it to version 3 only with UCS-4.4.",
        "before_after_code_files": [
          "management/univention-directory-notifier/debian/univention-directory-notifier.postinst||management/univention-directory-notifier/debian/univention-directory-notifier.postinst",
          "management/univention-directory-notifier/debian/univention-directory-notifier.univention-config-registry-variables||management/univention-directory-notifier/debian/univention-directory-notifier.univention-config-registry-variables",
          "management/univention-directory-notifier/src/callback.c||management/univention-directory-notifier/src/callback.c",
          "management/univention-directory-notifier/src/network.c||management/univention-directory-notifier/src/network.c",
          "management/univention-directory-notifier/src/network.h||management/univention-directory-notifier/src/network.h",
          "management/univention-directory-notifier/src/univention-directory-notifier.c||management/univention-directory-notifier/src/univention-directory-notifier.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "management/univention-directory-notifier/src/callback.c||management/univention-directory-notifier/src/callback.c"
          ],
          "candidate": [
            "management/univention-directory-notifier/src/callback.c||management/univention-directory-notifier/src/callback.c"
          ]
        }
      },
      "candidate_diff": {
        "management/univention-directory-notifier/debian/univention-directory-notifier.postinst||management/univention-directory-notifier/debian/univention-directory-notifier.postinst": [
          "File: management/univention-directory-notifier/debian/univention-directory-notifier.postinst -> management/univention-directory-notifier/debian/univention-directory-notifier.postinst",
          "--- Hunk 1 ---",
          "[Context before]",
          "106:     rm /etc/runit/univention/univention-ldap-notifier",
          "107: fi",
          "114:  fi",
          "117: fi",
          "119: exit 0",
          "",
          "[Removed Lines]",
          "109: if [ \"$1\" = \"configure\" -a -n \"$2\" ]; then",
          "110:  if dpkg --compare-versions \"$2\" lt 6.0.8-1; then",
          "111:   /etc/init.d/univention-directory-notifier restart || true",
          "112:  else",
          "113:   /etc/init.d/univention-directory-notifier crestart || true",
          "115: elif [ \"$1\" = \"configure\" ]; then",
          "116:  /etc/init.d/univention-directory-notifier restart || true",
          "",
          "[Added Lines]",
          "109: if [ \"$1\" = \"configure\" ]",
          "110: then",
          "111:  if [ -z \"${2:-}\" ]",
          "112:  then  # new installation",
          "113:   ucr set notifier/protocol/version?2",
          "114:   /etc/init.d/univention-directory-notifier restart || :",
          "115:  else  # upgrade",
          "116:   ucr set notifier/protocol/version?2",
          "117:   /etc/init.d/univention-directory-notifier crestart || :",
          "",
          "---------------"
        ],
        "management/univention-directory-notifier/debian/univention-directory-notifier.univention-config-registry-variables||management/univention-directory-notifier/debian/univention-directory-notifier.univention-config-registry-variables": [
          "File: management/univention-directory-notifier/debian/univention-directory-notifier.univention-config-registry-variables -> management/univention-directory-notifier/debian/univention-directory-notifier.univention-config-registry-variables",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: Description[en]=This variable configures the start mode of the Univention Directory Notifier service. If set to 'no' or 'disabled', the service cannot be started. If the variable is set to 'manually', the service isn't started during system boot, but can be enabled manually at a later point.",
          "10: Type=str",
          "11: Categories=service-ln",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "13: [notifier/protocol/version]",
          "14: Description[de]=Legt die minimal unterst\u00fctzte Version der Univention Directory Notifier Protokolls fest. M\u00f6gliche Werte: 1-3",
          "15: Description[en]=Configures the minimum supported version of the Univention Directory Notifier protocols: Possible values: 1-3",
          "16: Type=int",
          "17: Categories=service-ln",
          "",
          "---------------"
        ],
        "management/univention-directory-notifier/src/callback.c||management/univention-directory-notifier/src/callback.c": [
          "File: management/univention-directory-notifier/src/callback.c -> management/univention-directory-notifier/src/callback.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "56: extern int sem_id;",
          "60: extern fd_set readfds;",
          "62: extern NotifyId_t notify_last_id;",
          "",
          "[Removed Lines]",
          "58: static int VERSION=2;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "102:  char string[1024];",
          "103:  unsigned long msg_id = UINT32_MAX;",
          "108:  ioctl(fd, FIONREAD, &nread);",
          "110:  univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"new connection data = %d\\n\",nread);",
          "",
          "[Removed Lines]",
          "105:  int version;",
          "",
          "[Added Lines]",
          "102:  enum network_protocol version = network_client_get_version(fd);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "157:   } else if ( !strncmp(network_line, \"Version: \", strlen(\"Version: \")) ) {",
          "159:    univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: VERSION\");",
          "169:    }",
          "172:    msg_id = UINT32_MAX;",
          "",
          "[Removed Lines]",
          "161:    id=strtoul(&(network_line[strlen(\"Version: \")]), NULL, 10);",
          "163:    univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"VERSION=%ld\", id);",
          "165:    if ( id < VERSION ) {",
          "166:     network_client_set_version(fd, id);",
          "167:    } else {",
          "168:     network_client_set_version(fd, VERSION);",
          "",
          "[Added Lines]",
          "154:    char *head = network_line, *end;",
          "158:    version = strtoul(head + 9, &end, 10);",
          "159:    if (!head[9] || *end)",
          "160:     goto failed;",
          "162:    univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"VERSION=%d\", version);",
          "164:    if (version < network_procotol_version) {",
          "165:     univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Forbidden VERSION=%d < %d, close connection to listener\", version, network_procotol_version);",
          "166:     goto close;",
          "167:    } else if (version >= PROTOCOL_LAST) {",
          "168:     univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Future VERSION=%d\", version);",
          "169:     version = PROTOCOL_LAST - 1;",
          "171:    network_client_set_version(fd, version);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "179:    univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: Capabilities\");",
          "185:     memset(string, 0, sizeof(string));",
          "",
          "[Removed Lines]",
          "181:    version=network_client_get_version(fd);",
          "183:    if ( version > -1 ) {",
          "",
          "[Added Lines]",
          "183:    if ( version > PROTOCOL_UNKNOWN ) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "321:  network_client_dump ();",
          "323:  return 0;",
          "324: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "325: failed:",
          "326:  univention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Failed parsing [%s]\", p);",
          "327: close:",
          "328:  close(fd);",
          "329:  FD_CLR(fd, &readfds);",
          "330:  remove(fd);",
          "331:  return 0;",
          "",
          "---------------"
        ],
        "management/univention-directory-notifier/src/network.c||management/univention-directory-notifier/src/network.c": [
          "File: management/univention-directory-notifier/src/network.c -> management/univention-directory-notifier/src/network.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "67: extern void unset_schema_callback ();",
          "68: extern void unset_listener_callback ();",
          "70: int network_create_socket( int port )",
          "71: {",
          "72:  int server_socketfd;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "70: enum network_protocol network_procotol_version = PROTOCOL_2;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "149:   tmp->next = NULL;",
          "151:  }",
          "153:  return 0;",
          "154: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "154:  tmp->version = PROTOCOL_UNKNOWN;",
          "",
          "---------------"
        ],
        "management/univention-directory-notifier/src/network.h||management/univention-directory-notifier/src/network.h": [
          "File: management/univention-directory-notifier/src/network.h -> management/univention-directory-notifier/src/network.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "35: typedef int (*callback_remove_handler)(int fd);",
          "36: typedef int (*callback_handler)(int fd, callback_remove_handler);",
          "40:  int fd;",
          "42:  callback_handler handler;",
          "44:  int notify;",
          "48:  int server;",
          "",
          "[Removed Lines]",
          "38: typedef struct network_client {",
          "46:  int version;",
          "",
          "[Added Lines]",
          "38: enum network_protocol {",
          "39:  PROTOCOL_UNKNOWN = 0,",
          "40:  PROTOCOL_1,",
          "41:  PROTOCOL_2,",
          "42:  PROTOCOL_3,",
          "43:  PROTOCOL_LAST  // must always be last entry",
          "44: };",
          "46: typedef struct network_client {",
          "53:  enum network_protocol version;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "80: int network_client_waiting( int fd );",
          "81: int network_client_check_clients ( unsigned long last_known_id ) ;",
          "83: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "90: extern enum network_protocol network_procotol_version;",
          "",
          "---------------"
        ],
        "management/univention-directory-notifier/src/univention-directory-notifier.c||management/univention-directory-notifier/src/univention-directory-notifier.c": [
          "File: management/univention-directory-notifier/src/univention-directory-notifier.c -> management/univention-directory-notifier/src/univention-directory-notifier.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "32: #define _GNU_SOURCE",
          "34: #include <stdlib.h>",
          "35: #include <stdio.h>",
          "36: #include <string.h>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "34: #include <errno.h>",
          "35: #include <error.h>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "77:  fprintf(stderr, \"   -s   write replog-save file\\n\");",
          "78:  fprintf(stderr, \"   -d   added debug output\\n\");",
          "79:  fprintf(stderr, \"   -S   sleep before reading replog\\n\");",
          "80: }",
          "82: static int REPLOG_CALLBACK = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "82:  fprintf(stderr, \"   -v <version> Minimum supported protocol\\n\");",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "196:  for (;;) {",
          "197:   int c;",
          "200:   if (c < 0)",
          "201:    break;",
          "",
          "[Removed Lines]",
          "199:   c = getopt(argc, argv, \"Fosrd:S:C:L:T:\");",
          "",
          "[Added Lines]",
          "201:   char *end;",
          "203:   c = getopt(argc, argv, \"Fosrd:S:C:L:T:v:\");",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "228:    case 'T':",
          "229:     notifier_lock_time=atoll(optarg);",
          "230:     break;",
          "231:    default:",
          "232:     usage();",
          "233:     exit(1);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "235:    case 'v':",
          "236:     network_procotol_version = strtoll(optarg, &end, 10);",
          "237:     if (!*optarg || *end || network_procotol_version < PROTOCOL_1 || network_procotol_version >= PROTOCOL_LAST)",
          "238:      error(EXIT_FAILURE, errno, \"Invalid argument '-%c %s'\", c, optarg);",
          "239:     break;",
          "",
          "---------------"
        ]
      }
    }
  ]
}