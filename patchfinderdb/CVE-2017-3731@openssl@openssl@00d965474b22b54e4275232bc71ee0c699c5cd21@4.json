{
  "cve_id": "CVE-2017-3731",
  "cve_desc": "If an SSL/TLS server or client is running on a 32-bit host, and a specific cipher is being used, then a truncated packet can cause that server or client to perform an out-of-bounds read, usually resulting in a crash. For OpenSSL 1.1.0, the crash can be triggered when using CHACHA20/POLY1305; users should upgrade to 1.1.0d. For Openssl 1.0.2, the crash can be triggered when using RC4-MD5; users who have not disabled that algorithm should update to 1.0.2k.",
  "repo": "openssl/openssl",
  "patch_hash": "00d965474b22b54e4275232bc71ee0c699c5cd21",
  "patch_info": {
    "commit_hash": "00d965474b22b54e4275232bc71ee0c699c5cd21",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/00d965474b22b54e4275232bc71ee0c699c5cd21",
    "files": [
      "crypto/evp/e_aes.c",
      "crypto/evp/e_chacha20_poly1305.c"
    ],
    "message": "crypto/evp: harden AEAD ciphers.\n\nOriginally a crash in 32-bit build was reported CHACHA20-POLY1305\ncipher. The crash is triggered by truncated packet and is result\nof excessive hashing to the edge of accessible memory. Since hash\noperation is read-only it is not considered to be exploitable\nbeyond a DoS condition. Other ciphers were hardened.\n\nThanks to Robert \u015awi\u0119cki for report.\n\nCVE-2017-3731\n\nReviewed-by: Rich Salz <rsalz@openssl.org>",
    "before_after_code_files": [
      "crypto/evp/e_aes.c||crypto/evp/e_aes.c",
      "crypto/evp/e_chacha20_poly1305.c||crypto/evp/e_chacha20_poly1305.c"
    ]
  },
  "patch_diff": {
    "crypto/evp/e_aes.c||crypto/evp/e_aes.c": [
      "File: crypto/evp/e_aes.c -> crypto/evp/e_aes.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1388:                 EVP_CIPHER_CTX_buf_noconst(c)[arg - 2] << 8",
      "1389:                 | EVP_CIPHER_CTX_buf_noconst(c)[arg - 1];",
      "1391:             len -= EVP_GCM_TLS_EXPLICIT_IV_LEN;",
      "1394:                 len -= EVP_GCM_TLS_TAG_LEN;",
      "1395:             EVP_CIPHER_CTX_buf_noconst(c)[arg - 2] = len >> 8;",
      "1396:             EVP_CIPHER_CTX_buf_noconst(c)[arg - 1] = len & 0xff;",
      "1397:         }",
      "",
      "[Removed Lines]",
      "1393:             if (!EVP_CIPHER_CTX_encrypting(c))",
      "",
      "[Added Lines]",
      "1391:             if (len < EVP_GCM_TLS_EXPLICIT_IV_LEN)",
      "1392:                 return 0;",
      "1395:             if (!EVP_CIPHER_CTX_encrypting(c)) {",
      "1396:                 if (len < EVP_GCM_TLS_TAG_LEN)",
      "1397:                     return 0;",
      "1399:             }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1946:                 EVP_CIPHER_CTX_buf_noconst(c)[arg - 2] << 8",
      "1947:                 | EVP_CIPHER_CTX_buf_noconst(c)[arg - 1];",
      "1949:             len -= EVP_CCM_TLS_EXPLICIT_IV_LEN;",
      "1952:                 len -= cctx->M;",
      "1953:             EVP_CIPHER_CTX_buf_noconst(c)[arg - 2] = len >> 8;",
      "1954:             EVP_CIPHER_CTX_buf_noconst(c)[arg - 1] = len & 0xff;",
      "1955:         }",
      "",
      "[Removed Lines]",
      "1951:             if (!EVP_CIPHER_CTX_encrypting(c))",
      "",
      "[Added Lines]",
      "1954:             if (len < EVP_CCM_TLS_EXPLICIT_IV_LEN)",
      "1955:                 return 0;",
      "1958:             if (!EVP_CIPHER_CTX_encrypting(c)) {",
      "1959:                 if (len < cctx->M)",
      "1960:                     return 0;",
      "1962:             }",
      "",
      "---------------"
    ],
    "crypto/evp/e_chacha20_poly1305.c||crypto/evp/e_chacha20_poly1305.c": [
      "File: crypto/evp/e_chacha20_poly1305.c -> crypto/evp/e_chacha20_poly1305.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "398:             len = aad[EVP_AEAD_TLS1_AAD_LEN - 2] << 8 |",
      "399:                   aad[EVP_AEAD_TLS1_AAD_LEN - 1];",
      "400:             if (!ctx->encrypt) {",
      "402:                 memcpy(temp, aad, EVP_AEAD_TLS1_AAD_LEN - 2);",
      "403:                 aad = temp;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "401:                 if (len < POLY1305_BLOCK_SIZE)",
      "402:                     return 0;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "91eaf079b7430cb4ebb7f3ccabe74aa383b27c4e",
      "candidate_info": {
        "commit_hash": "91eaf079b7430cb4ebb7f3ccabe74aa383b27c4e",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/91eaf079b7430cb4ebb7f3ccabe74aa383b27c4e",
        "files": [
          "CHANGES",
          "NEWS",
          "README",
          "include/openssl/opensslv.h"
        ],
        "message": "Prepare for 1.1.0c release\n\nReviewed-by: Richard Levitte <levitte@openssl.org>",
        "before_after_code_files": [
          "include/openssl/opensslv.h||include/openssl/opensslv.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/openssl/opensslv.h||include/openssl/opensslv.h": [
          "File: include/openssl/opensslv.h -> include/openssl/opensslv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "43: # ifdef OPENSSL_FIPS",
          "45: # else",
          "47: # endif",
          "",
          "[Removed Lines]",
          "42: # define OPENSSL_VERSION_NUMBER  0x10100030L",
          "44: #  define OPENSSL_VERSION_TEXT    \"OpenSSL 1.1.0c-fips-dev  xx XXX xxxx\"",
          "46: #  define OPENSSL_VERSION_TEXT    \"OpenSSL 1.1.0c-dev  xx XXX xxxx\"",
          "",
          "[Added Lines]",
          "42: # define OPENSSL_VERSION_NUMBER  0x1010003fL",
          "44: #  define OPENSSL_VERSION_TEXT    \"OpenSSL 1.1.0c-fips  10 Nov 2016\"",
          "46: #  define OPENSSL_VERSION_TEXT    \"OpenSSL 1.1.0c  10 Nov 2016\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9ebcbbba81eba52282df9ad8902f047e2d501f51",
      "candidate_info": {
        "commit_hash": "9ebcbbba81eba52282df9ad8902f047e2d501f51",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/9ebcbbba81eba52282df9ad8902f047e2d501f51",
        "files": [
          "test/bntest.c"
        ],
        "message": "test/bntest.c: regression test for CVE-2016-7055.\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(cherry picked from commit dca2e0ee1745ed2d9cba8c29f334f881a58f85dc)",
        "before_after_code_files": [
          "test/bntest.c||test/bntest.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/bntest.c||test/bntest.c": [
          "File: test/bntest.c -> test/bntest.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "836:             return 0;",
          "837:         }",
          "838:     }",
          "839:     BN_MONT_CTX_free(mont);",
          "840:     BN_free(a);",
          "841:     BN_free(b);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "841:     BN_hex2bn(&a,",
          "842:         \"7878787878787878787878787878787878787878787878787878787878787878\"",
          "843:         \"7878787878787878787878787878787878787878787878787878787878787878\"",
          "844:         \"7878787878787878787878787878787878787878787878787878787878787878\"",
          "845:         \"7878787878787878787878787878787878787878787878787878787878787878\");",
          "846:     BN_hex2bn(&b,",
          "847:         \"095D72C08C097BA488C5E439C655A192EAFB6380073D8C2664668EDDB4060744\"",
          "848:         \"E16E57FB4EDB9AE10A0CEFCDC28A894F689A128379DB279D48A2E20849D68593\"",
          "849:         \"9B7803BCF46CEBF5C533FB0DD35B080593DE5472E3FE5DB951B8BFF9B4CB8F03\"",
          "850:         \"9CC638A5EE8CDD703719F8000E6A9F63BEED5F2FCD52FF293EA05A251BB4AB81\");",
          "851:     BN_hex2bn(&n,",
          "852:         \"D78AF684E71DB0C39CFF4E64FB9DB567132CB9C50CC98009FEB820B26F2DED9B\"",
          "853:         \"91B9B5E2B83AE0AE4EB4E0523CA726BFBE969B89FD754F674CE99118C3F2D1C5\"",
          "854:         \"D81FDC7C54E02B60262B241D53C040E99E45826ECA37A804668E690E1AFC1CA4\"",
          "855:         \"2C9A15D84D4954425F0B7642FC0BD9D7B24E2618D2DCC9B729D944BADACFDDAF\");",
          "856:     BN_MONT_CTX_set(mont, n, ctx);",
          "857:     BN_mod_mul_montgomery(c, a, b, mont, ctx);",
          "858:     BN_mod_mul_montgomery(d, b, a, mont, ctx);",
          "859:     if (BN_cmp(c, d)) {",
          "860:         fprintf(stderr, \"Montgomery multiplication test failed:\"",
          "861:                         \" a*b != b*a.\\n\");",
          "862:         return 0;",
          "863:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "22e9f9211de80d7edcb1bd3b86eef7611718ab5c",
      "candidate_info": {
        "commit_hash": "22e9f9211de80d7edcb1bd3b86eef7611718ab5c",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/22e9f9211de80d7edcb1bd3b86eef7611718ab5c",
        "files": [
          "crypto/evp/evp_err.c",
          "crypto/evp/pmeth_fn.c",
          "include/openssl/evp.h"
        ],
        "message": "M_check_autoarg: sanity check the key\n\nFor now, checking that the size is non-zero will suffice.\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/2120)\n(cherry picked from commit d7c8f142ea5953bf260b70a58739c1c9b0f038eb)",
        "before_after_code_files": [
          "crypto/evp/evp_err.c||crypto/evp/evp_err.c",
          "crypto/evp/pmeth_fn.c||crypto/evp/pmeth_fn.c",
          "include/openssl/evp.h||include/openssl/evp.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/evp/evp_err.c||crypto/evp/evp_err.c": [
          "File: crypto/evp/evp_err.c -> crypto/evp/evp_err.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "120:     {ERR_REASON(EVP_R_INPUT_NOT_INITIALIZED), \"input not initialized\"},",
          "121:     {ERR_REASON(EVP_R_INVALID_DIGEST), \"invalid digest\"},",
          "122:     {ERR_REASON(EVP_R_INVALID_FIPS_MODE), \"invalid fips mode\"},",
          "123:     {ERR_REASON(EVP_R_INVALID_KEY_LENGTH), \"invalid key length\"},",
          "124:     {ERR_REASON(EVP_R_INVALID_OPERATION), \"invalid operation\"},",
          "125:     {ERR_REASON(EVP_R_KEYGEN_FAILURE), \"keygen failure\"},",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "123:     {ERR_REASON(EVP_R_INVALID_KEY), \"invalid key\"},",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "135:     {ERR_REASON(EVP_R_OPERATION_NOT_SUPPORTED_FOR_THIS_KEYTYPE),",
          "136:      \"operation not supported for this keytype\"},",
          "137:     {ERR_REASON(EVP_R_OPERATON_NOT_INITIALIZED), \"operaton not initialized\"},",
          "139:     {ERR_REASON(EVP_R_PRIVATE_KEY_DECODE_ERROR), \"private key decode error\"},",
          "140:     {ERR_REASON(EVP_R_PRIVATE_KEY_ENCODE_ERROR), \"private key encode error\"},",
          "141:     {ERR_REASON(EVP_R_PUBLIC_KEY_NOT_RSA), \"public key not rsa\"},",
          "",
          "[Removed Lines]",
          "138:     {ERR_REASON(EVP_R_PARTIALLY_OVERLAPPING), \"partially overlapping buffers\"},",
          "",
          "[Added Lines]",
          "139:     {ERR_REASON(EVP_R_PARTIALLY_OVERLAPPING),",
          "140:      \"partially overlapping buffers\"},",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "143:     {ERR_REASON(EVP_R_UNKNOWN_DIGEST), \"unknown digest\"},",
          "144:     {ERR_REASON(EVP_R_UNKNOWN_OPTION), \"unknown option\"},",
          "145:     {ERR_REASON(EVP_R_UNKNOWN_PBE_ALGORITHM), \"unknown pbe algorithm\"},",
          "148:     {ERR_REASON(EVP_R_UNSUPPORTED_ALGORITHM), \"unsupported algorithm\"},",
          "149:     {ERR_REASON(EVP_R_UNSUPPORTED_CIPHER), \"unsupported cipher\"},",
          "150:     {ERR_REASON(EVP_R_UNSUPPORTED_KEYLENGTH), \"unsupported keylength\"},",
          "151:     {ERR_REASON(EVP_R_UNSUPPORTED_KEY_DERIVATION_FUNCTION),",
          "152:      \"unsupported key derivation function\"},",
          "153:     {ERR_REASON(EVP_R_UNSUPPORTED_KEY_SIZE), \"unsupported key size\"},",
          "154:     {ERR_REASON(EVP_R_UNSUPPORTED_PRF), \"unsupported prf\"},",
          "155:     {ERR_REASON(EVP_R_UNSUPPORTED_PRIVATE_KEY_ALGORITHM),",
          "156:      \"unsupported private key algorithm\"},",
          "",
          "[Removed Lines]",
          "146:     {ERR_REASON(EVP_R_UNSUPPORTED_NUMBER_OF_ROUNDS),",
          "147:      \"unsupported number of rounds\"},",
          "",
          "[Added Lines]",
          "154:     {ERR_REASON(EVP_R_UNSUPPORTED_NUMBER_OF_ROUNDS),",
          "155:      \"unsupported number of rounds\"},",
          "",
          "---------------"
        ],
        "crypto/evp/pmeth_fn.c||crypto/evp/pmeth_fn.c": [
          "File: crypto/evp/pmeth_fn.c -> crypto/evp/pmeth_fn.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "18:         if (ctx->pmeth->flags & EVP_PKEY_FLAG_AUTOARGLEN) \\",
          "19:                 { \\",
          "20:                 size_t pksize = (size_t)EVP_PKEY_size(ctx->pkey); \\",
          "22:                         { \\",
          "24:                         return 1; \\",
          "",
          "[Removed Lines]",
          "21:                 if (!arg) \\",
          "",
          "[Added Lines]",
          "21:                 if (pksize == 0) \\",
          "22:                         { \\",
          "23:                         EVPerr(err, EVP_R_INVALID_KEY); /*ckerr_ignore*/\\",
          "24:                         return 0; \\",
          "25:                         } \\",
          "26:                 else if (!arg)                 \\",
          "",
          "---------------"
        ],
        "include/openssl/evp.h||include/openssl/evp.h": [
          "File: include/openssl/evp.h -> include/openssl/evp.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1546: # define EVP_R_INPUT_NOT_INITIALIZED                      111",
          "1547: # define EVP_R_INVALID_DIGEST                             152",
          "1548: # define EVP_R_INVALID_FIPS_MODE                          168",
          "1549: # define EVP_R_INVALID_KEY_LENGTH                         130",
          "1550: # define EVP_R_INVALID_OPERATION                          148",
          "1551: # define EVP_R_KEYGEN_FAILURE                             120",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1549: # define EVP_R_INVALID_KEY                                163",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1568: # define EVP_R_UNKNOWN_DIGEST                             161",
          "1569: # define EVP_R_UNKNOWN_OPTION                             169",
          "1570: # define EVP_R_UNKNOWN_PBE_ALGORITHM                      121",
          "1572: # define EVP_R_UNSUPPORTED_ALGORITHM                      156",
          "1573: # define EVP_R_UNSUPPORTED_CIPHER                         107",
          "1574: # define EVP_R_UNSUPPORTED_KEYLENGTH                      123",
          "1575: # define EVP_R_UNSUPPORTED_KEY_DERIVATION_FUNCTION        124",
          "1576: # define EVP_R_UNSUPPORTED_KEY_SIZE                       108",
          "1577: # define EVP_R_UNSUPPORTED_PRF                            125",
          "1578: # define EVP_R_UNSUPPORTED_PRIVATE_KEY_ALGORITHM          118",
          "1579: # define EVP_R_UNSUPPORTED_SALT_TYPE                      126",
          "",
          "[Removed Lines]",
          "1571: # define EVP_R_UNSUPPORTED_NUMBER_OF_ROUNDS               135",
          "",
          "[Added Lines]",
          "1577: # define EVP_R_UNSUPPORTED_NUMBER_OF_ROUNDS               135",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3dca6ca0df0facedabcc5d9733b304e507f796db",
      "candidate_info": {
        "commit_hash": "3dca6ca0df0facedabcc5d9733b304e507f796db",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/3dca6ca0df0facedabcc5d9733b304e507f796db",
        "files": [
          "doc/ssl/SSL_CTX_set_verify.pod",
          "include/openssl/ssl.h"
        ],
        "message": "Rename \"verify_cb\" to SSL_verify_cb\n\nReviewed-by: Richard Levitte <levitte@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/2151)\n(cherry picked from commit 3adc41dd22080c4161d8a2af98d7b29fdbb11915)",
        "before_after_code_files": [
          "include/openssl/ssl.h||include/openssl/ssl.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/openssl/ssl.h||include/openssl/ssl.h": [
          "File: include/openssl/ssl.h -> include/openssl/ssl.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "263:                                     size_t inlen, int *al, void *parse_arg);",
          "269: # define SSL_OP_LEGACY_SERVER_CONNECT                    0x00000004U",
          "",
          "[Removed Lines]",
          "266: typedef int (*verify_cb)(int preverify_ok, X509_STORE_CTX *x509_ctx);",
          "",
          "[Added Lines]",
          "266: typedef int (*SSL_verify_cb)(int preverify_ok, X509_STORE_CTX *x509_ctx);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1345: void SSL_set_read_ahead(SSL *s, int yes);",
          "1346: __owur int SSL_get_verify_mode(const SSL *s);",
          "1347: __owur int SSL_get_verify_depth(const SSL *s);",
          "1350: void SSL_set_verify_depth(SSL *s, int depth);",
          "1351: void SSL_set_cert_cb(SSL *s, int (*cb) (SSL *ssl, void *arg), void *arg);",
          "1352: # ifndef OPENSSL_NO_RSA",
          "",
          "[Removed Lines]",
          "1348: __owur verify_cb SSL_get_verify_callback(const SSL *s);",
          "1349: void SSL_set_verify(SSL *s, int mode, verify_cb callback);",
          "",
          "[Added Lines]",
          "1348: __owur SSL_verify_cb SSL_get_verify_callback(const SSL *s);",
          "1349: void SSL_set_verify(SSL *s, int mode, SSL_verify_cb callback);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1446: __owur int SSL_CTX_get_verify_mode(const SSL_CTX *ctx);",
          "1447: __owur int SSL_CTX_get_verify_depth(const SSL_CTX *ctx);",
          "1450: void SSL_CTX_set_verify_depth(SSL_CTX *ctx, int depth);",
          "1451: void SSL_CTX_set_cert_verify_callback(SSL_CTX *ctx,",
          "1452:                                       int (*cb) (X509_STORE_CTX *, void *),",
          "",
          "[Removed Lines]",
          "1448: __owur verify_cb SSL_CTX_get_verify_callback(const SSL_CTX *ctx);",
          "1449: void SSL_CTX_set_verify(SSL_CTX *ctx, int mode, verify_cb callback);",
          "",
          "[Added Lines]",
          "1448: __owur SSL_verify_cb SSL_CTX_get_verify_callback(const SSL_CTX *ctx);",
          "1449: void SSL_CTX_set_verify(SSL_CTX *ctx, int mode, SSL_verify_cb callback);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "bf9ee8a810971b6bd7eb5fe84ac97a61514607d8",
      "candidate_info": {
        "commit_hash": "bf9ee8a810971b6bd7eb5fe84ac97a61514607d8",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/bf9ee8a810971b6bd7eb5fe84ac97a61514607d8",
        "files": [
          "crypto/cmac/cmac.c"
        ],
        "message": "Don't use deprecated EVP_CIPHER_CTX_cleanup() internally\n\nUse EVP_CIPHER_CTX_reset() instead\n\nReviewed-by: Matt Caswell <matt@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/2812)\n(cherry picked from commit 15d95dd7ea77e68bf9d8450e52230a6017735ec0)",
        "before_after_code_files": [
          "crypto/cmac/cmac.c||crypto/cmac/cmac.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/cmac/cmac.c||crypto/cmac/cmac.c": [
          "File: crypto/cmac/cmac.c -> crypto/cmac/cmac.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "61: void CMAC_CTX_cleanup(CMAC_CTX *ctx)",
          "62: {",
          "64:     OPENSSL_cleanse(ctx->tbl, EVP_MAX_BLOCK_LENGTH);",
          "65:     OPENSSL_cleanse(ctx->k1, EVP_MAX_BLOCK_LENGTH);",
          "66:     OPENSSL_cleanse(ctx->k2, EVP_MAX_BLOCK_LENGTH);",
          "",
          "[Removed Lines]",
          "63:     EVP_CIPHER_CTX_cleanup(ctx->cctx);",
          "",
          "[Added Lines]",
          "63:     EVP_CIPHER_CTX_reset(ctx->cctx);",
          "",
          "---------------"
        ]
      }
    }
  ]
}