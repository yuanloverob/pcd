{
  "cve_id": "CVE-2016-7411",
  "cve_desc": "ext/standard/var_unserializer.re in PHP before 5.6.26 mishandles object-deserialization failures, which allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via an unserialize call that references a partially constructed object.",
  "repo": "php/php-src",
  "patch_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
  "patch_info": {
    "commit_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
    "files": [
      "Zend/zend_objects_API.c",
      "ext/standard/tests/serialize/bug73052.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #73052 - Memory Corruption in During Deserialized-object Destruction",
    "before_after_code_files": [
      "Zend/zend_objects_API.c||Zend/zend_objects_API.c",
      "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "Zend/zend_objects_API.c||Zend/zend_objects_API.c": [
      "File: Zend/zend_objects_API.c -> Zend/zend_objects_API.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "306: {",
      "307:  zend_object_handle handle = Z_OBJ_HANDLE_P(zobject);",
      "308:  zend_object_store_bucket *obj_bucket = &EG(objects_store).object_buckets[handle];",
      "311:  obj_bucket->destructor_called = 1;",
      "312: }",
      "",
      "[Removed Lines]",
      "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);;",
      "",
      "[Added Lines]",
      "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);",
      "",
      "---------------"
    ],
    "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt": [
      "File: ext/standard/tests/serialize/bug73052.phpt -> ext/standard/tests/serialize/bug73052.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73052: Memory Corruption in During Deserialized-object Destruction",
      "3: --FILE--",
      "4: <?php",
      "6: class obj {",
      "7:     var $ryat;",
      "8:     public function __destruct() {",
      "9:         $this->ryat = null;",
      "10:     }",
      "11: }",
      "13: $poc = 'O:3:\"obj\":1:{';",
      "14: var_dump(unserialize($poc));",
      "15: ?>",
      "16: --EXPECTF--",
      "17: Notice: unserialize(): Error at offset 13 of 13 bytes in %sbug73052.php on line %d",
      "18: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "438:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
      "439:         zend_hash_clean(Z_OBJPROP_PP(rval));",
      "440:      }",
      "441:      ZVAL_NULL(*rval);",
      "442:   return 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "440:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "495: {",
      "496:  YYCTYPE yych;",
      "497:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "494: #line 495 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "495: #line 496 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "551:  yych = *(YYMARKER = ++YYCURSOR);",
      "552:  if (yych == ':') goto yy95;",
      "553: yy3:",
      "555:  { return 0; }",
      "557: yy4:",
      "558:  yych = *(YYMARKER = ++YYCURSOR);",
      "559:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "554: #line 860 \"ext/standard/var_unserializer.re\"",
      "556: #line 557 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "555: #line 861 \"ext/standard/var_unserializer.re\"",
      "557: #line 558 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "596:  goto yy3;",
      "597: yy14:",
      "598:  ++YYCURSOR;",
      "600:  {",
      "602:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "604: }",
      "606: yy16:",
      "607:  yych = *++YYCURSOR;",
      "608:  goto yy3;",
      "",
      "[Removed Lines]",
      "599: #line 854 \"ext/standard/var_unserializer.re\"",
      "605: #line 606 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "600: #line 855 \"ext/standard/var_unserializer.re\"",
      "606: #line 607 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "633:  yych = *++YYCURSOR;",
      "634:  if (yych != '\"') goto yy18;",
      "635:  ++YYCURSOR;",
      "637:  {",
      "638:  size_t len, len2, len3, maxlen;",
      "639:  long elements;",
      "",
      "[Removed Lines]",
      "636: #line 707 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "637: #line 708 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "781:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "782: }",
      "784: yy25:",
      "785:  yych = *++YYCURSOR;",
      "786:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "783: #line 784 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "784: #line 785 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "805:  yych = *++YYCURSOR;",
      "806:  if (yych != '\"') goto yy18;",
      "807:  ++YYCURSOR;",
      "809:  {",
      "810:     if (!var_hash) return 0;",
      "",
      "[Removed Lines]",
      "808: #line 698 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "809: #line 699 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "814:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "815:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "816: }",
      "818: yy32:",
      "819:  yych = *++YYCURSOR;",
      "820:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "817: #line 818 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "818: #line 819 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "835:  yych = *++YYCURSOR;",
      "836:  if (yych != '{') goto yy18;",
      "837:  ++YYCURSOR;",
      "839:  {",
      "840:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "838: #line 677 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "839: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "857:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "858: }",
      "860: yy39:",
      "861:  yych = *++YYCURSOR;",
      "862:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "859: #line 860 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "860: #line 861 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "877:  yych = *++YYCURSOR;",
      "878:  if (yych != '\"') goto yy18;",
      "879:  ++YYCURSOR;",
      "881:  {",
      "882:  size_t len, maxlen;",
      "883:  char *str;",
      "",
      "[Removed Lines]",
      "880: #line 642 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "881: #line 643 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "912:  ZVAL_STRINGL(*rval, str, len, 0);",
      "913:  return 1;",
      "914: }",
      "916: yy46:",
      "917:  yych = *++YYCURSOR;",
      "918:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "915: #line 916 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "916: #line 917 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "933:  yych = *++YYCURSOR;",
      "934:  if (yych != '\"') goto yy18;",
      "935:  ++YYCURSOR;",
      "937:  {",
      "938:  size_t len, maxlen;",
      "939:  char *str;",
      "",
      "[Removed Lines]",
      "936: #line 609 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "937: #line 610 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "966:  ZVAL_STRINGL(*rval, str, len, 1);",
      "967:  return 1;",
      "968: }",
      "970: yy53:",
      "971:  yych = *++YYCURSOR;",
      "972:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "969: #line 970 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "970: #line 971 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1054:  }",
      "1055: yy63:",
      "1056:  ++YYCURSOR;",
      "1058:  {",
      "1059: #if SIZEOF_LONG == 4",
      "1060: use_double:",
      "",
      "[Removed Lines]",
      "1057: #line 599 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1058: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1064:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1065:  return 1;",
      "1066: }",
      "1068: yy65:",
      "1069:  yych = *++YYCURSOR;",
      "1070:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1067: #line 1068 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1123:  yych = *++YYCURSOR;",
      "1124:  if (yych != ';') goto yy18;",
      "1125:  ++YYCURSOR;",
      "1127:  {",
      "1129:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1126: #line 584 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1127: #line 585 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1139:  return 1;",
      "1140: }",
      "1142: yy76:",
      "1143:  yych = *++YYCURSOR;",
      "1144:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1141: #line 1142 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1165:  if (yych <= '9') goto yy79;",
      "1166:  if (yych != ';') goto yy18;",
      "1167:  ++YYCURSOR;",
      "1169:  {",
      "1170: #if SIZEOF_LONG == 4",
      "1171:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1168: #line 557 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1169: #line 558 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1192:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1193:  return 1;",
      "1194: }",
      "1196: yy83:",
      "1197:  yych = *++YYCURSOR;",
      "1198:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1195: #line 1196 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1200:  yych = *++YYCURSOR;",
      "1201:  if (yych != ';') goto yy18;",
      "1202:  ++YYCURSOR;",
      "1204:  {",
      "1206:  INIT_PZVAL(*rval);",
      "1207:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1208:  return 1;",
      "1209: }",
      "1211: yy87:",
      "1212:  ++YYCURSOR;",
      "1214:  {",
      "1216:  INIT_PZVAL(*rval);",
      "1217:  ZVAL_NULL(*rval);",
      "1218:  return 1;",
      "1219: }",
      "1221: yy89:",
      "1222:  yych = *++YYCURSOR;",
      "1223:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1203: #line 550 \"ext/standard/var_unserializer.re\"",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "1213: #line 543 \"ext/standard/var_unserializer.re\"",
      "1220: #line 1221 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1204: #line 551 \"ext/standard/var_unserializer.re\"",
      "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
      "1214: #line 544 \"ext/standard/var_unserializer.re\"",
      "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1240:  if (yych <= '9') goto yy91;",
      "1241:  if (yych != ';') goto yy18;",
      "1242:  ++YYCURSOR;",
      "1244:  {",
      "1245:  long id;",
      "",
      "[Removed Lines]",
      "1243: #line 520 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1244: #line 521 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1264:  return 1;",
      "1265: }",
      "1267: yy95:",
      "1268:  yych = *++YYCURSOR;",
      "1269:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1266: #line 1267 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1286:  if (yych <= '9') goto yy97;",
      "1287:  if (yych != ';') goto yy18;",
      "1288:  ++YYCURSOR;",
      "1290:  {",
      "1291:  long id;",
      "",
      "[Removed Lines]",
      "1289: #line 499 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1290: #line 500 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1308:  return 1;",
      "1309: }",
      "1311: }",
      "1315:  return 0;",
      "",
      "[Removed Lines]",
      "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
      "1312: #line 862 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
      "1313: #line 863 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "442:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
      "443:         zend_hash_clean(Z_OBJPROP_PP(rval));",
      "444:      }",
      "445:      ZVAL_NULL(*rval);",
      "446:   return 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "444:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f8c514ba6b7962a219296a837b2dbc22f749e736",
      "candidate_info": {
        "commit_hash": "f8c514ba6b7962a219296a837b2dbc22f749e736",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/f8c514ba6b7962a219296a837b2dbc22f749e736",
        "files": [
          "ext/standard/tests/serialize/bug25378.phpt",
          "ext/standard/tests/serialize/bug74111.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #74111",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug25378.phpt||ext/standard/tests/serialize/bug25378.phpt",
          "ext/standard/tests/serialize/bug74111.phpt||ext/standard/tests/serialize/bug74111.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug25378.phpt||ext/standard/tests/serialize/bug25378.phpt": [
          "File: ext/standard/tests/serialize/bug25378.phpt -> ext/standard/tests/serialize/bug25378.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: Notice: unserialize(): Error at offset 17 of 33 bytes in %sbug25378.php on line %d",
          "43: bool(false)",
          "46: bool(false)",
          "48: Notice: unserialize(): Error at offset 2 of 13 bytes in %sbug25378.php on line %d",
          "",
          "[Removed Lines]",
          "45: Notice: unserialize(): Error at offset 33 of 32 bytes in %sbug25378.php on line %d",
          "",
          "[Added Lines]",
          "45: Notice: unserialize(): Error at offset 32 of 32 bytes in %sbug25378.php on line %d",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug74111.phpt||ext/standard/tests/serialize/bug74111.phpt": [
          "File: ext/standard/tests/serialize/bug74111.phpt -> ext/standard/tests/serialize/bug74111.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74111: Heap buffer overread (READ: 1) finish_nested_data from unserialize",
          "3: --FILE--",
          "4: <?php",
          "5: $s = 'O:8:\"stdClass\":00000000';",
          "6: var_dump(unserialize($s));",
          "7: ?>",
          "8: --EXPECTF--",
          "9: Notice: unserialize(): Error at offset 25 of 23 bytes in %s on line %d",
          "10: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "407: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "408: {",
          "416: }",
          "418: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "",
          "[Removed Lines]",
          "409:  if (*((*p)++) == '}')",
          "410:   return 1;",
          "412: #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE",
          "413:  zval_ptr_dtor(rval);",
          "414: #endif",
          "415:  return 0;",
          "",
          "[Added Lines]",
          "409:  if (*p >= max || **p != '}') {",
          "410:   return 0;",
          "411:  }",
          "413:  (*p)++;",
          "414:  return 1;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "533: {",
          "534:  YYCTYPE yych;",
          "535:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "532: #line 533 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "531: #line 532 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "570:  yych = *YYCURSOR;",
          "571:  switch (yych) {",
          "572:  case 'C':",
          "574:  case 'N': goto yy5;",
          "581:  case 'o': goto yy12;",
          "586:  }",
          "587: yy2:",
          "589: yy3:",
          "591:  { return 0; }",
          "592: #line 593 \"ext/standard/var_unserializer.c\"",
          "593: yy4:",
          "594:  yych = *(YYMARKER = ++YYCURSOR);",
          "596:  goto yy3;",
          "597: yy5:",
          "598:  yych = *++YYCURSOR;",
          "600:  goto yy3;",
          "601: yy6:",
          "602:  yych = *(YYMARKER = ++YYCURSOR);",
          "604:  goto yy3;",
          "605: yy7:",
          "606:  yych = *(YYMARKER = ++YYCURSOR);",
          "608:  goto yy3;",
          "609: yy8:",
          "610:  yych = *(YYMARKER = ++YYCURSOR);",
          "612:  goto yy3;",
          "613: yy9:",
          "614:  yych = *(YYMARKER = ++YYCURSOR);",
          "616:  goto yy3;",
          "617: yy10:",
          "618:  yych = *(YYMARKER = ++YYCURSOR);",
          "620:  goto yy3;",
          "621: yy11:",
          "622:  yych = *(YYMARKER = ++YYCURSOR);",
          "624:  goto yy3;",
          "625: yy12:",
          "626:  yych = *(YYMARKER = ++YYCURSOR);",
          "628:  goto yy3;",
          "629: yy13:",
          "630:  yych = *(YYMARKER = ++YYCURSOR);",
          "632:  goto yy3;",
          "633: yy14:",
          "638:  ++YYCURSOR;",
          "640:  {",
          "642:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "644: }",
          "646: yy17:",
          "647:  yych = *++YYCURSOR;",
          "648:  if (yybm[0+yych] & 128) {",
          "650:  }",
          "652: yy18:",
          "653:  YYCURSOR = YYMARKER;",
          "654:  goto yy3;",
          "655: yy19:",
          "666:  yych = *++YYCURSOR;",
          "675:  }",
          "687:  goto yy18;",
          "690:  if (yych <= '/') goto yy18;",
          "694:  yych = *++YYCURSOR;",
          "703:   }",
          "709:   } else {",
          "712:   }",
          "713:  }",
          "724:  }",
          "735:  }",
          "737:  yych = *++YYCURSOR;",
          "738:  if (yych <= ',') {",
          "741:  } else {",
          "743:   if (yych <= '/') goto yy18;",
          "745:   goto yy18;",
          "746:  }",
          "748:  yych = *++YYCURSOR;",
          "750:  if (yych <= '/') goto yy18;",
          "760:  ++YYCURSOR;",
          "761:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "762:  yych = *YYCURSOR;",
          "766:  if (yych <= '/') goto yy18;",
          "770:  yych = *++YYCURSOR;",
          "774:  ++YYCURSOR;",
          "777:  if (yych <= '/') goto yy18;",
          "778:  if (yych <= '9') goto yy34;",
          "780:  goto yy18;",
          "782:  yych = *++YYCURSOR;",
          "783:  if (yych <= '/') goto yy18;",
          "784:  if (yych >= ':') goto yy18;",
          "786:  ++YYCURSOR;",
          "787:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "788:  yych = *YYCURSOR;",
          "789:  if (yych <= '/') goto yy18;",
          "794:  yych = *++YYCURSOR;",
          "798:  ++YYCURSOR;",
          "823:  }",
          "851:  }",
          "861:  yych = *++YYCURSOR;",
          "862:  if (yych <= '/') goto yy18;",
          "871:  goto yy18;",
          "873:  yych = *++YYCURSOR;",
          "874:  if (yych <= '/') goto yy18;",
          "875:  if (yych >= ':') goto yy18;",
          "877:  ++YYCURSOR;",
          "878:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "879:  yych = *YYCURSOR;",
          "880:  if (yych <= '/') goto yy18;",
          "885:  yych = *++YYCURSOR;",
          "889:  ++YYCURSOR;",
          "892:  if (yych <= '/') goto yy18;",
          "895:  goto yy18;",
          "897:  yych = *++YYCURSOR;",
          "898:  if (yych <= '/') goto yy18;",
          "899:  if (yych >= ':') goto yy18;",
          "901:  ++YYCURSOR;",
          "902:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "903:  yych = *YYCURSOR;",
          "904:  if (yych <= '/') goto yy18;",
          "909:  yych = *++YYCURSOR;",
          "913:  ++YYCURSOR;",
          "915:  {",
          "923:   return 0;",
          "924:  }",
          "928:  }",
          "933:  return 1;",
          "934: }",
          "937:  yych = *++YYCURSOR;",
          "939:  goto yy18;",
          "941:  yych = *++YYCURSOR;",
          "943:  goto yy18;",
          "945:  ++YYCURSOR;",
          "955:  ++YYCURSOR;",
          "956:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "957:  yych = *YYCURSOR;",
          "958:  if (yych <= ';') {",
          "959:   if (yych <= '/') goto yy18;",
          "961:   if (yych <= ':') goto yy18;",
          "962:  } else {",
          "963:   if (yych <= 'E') {",
          "964:    if (yych <= 'D') goto yy18;",
          "966:   } else {",
          "968:    goto yy18;",
          "969:   }",
          "970:  }",
          "972:  ++YYCURSOR;",
          "974:  {",
          "975: #if SIZEOF_LONG == 4",
          "976: use_double:",
          "",
          "[Removed Lines]",
          "573:  case 'O': goto yy4;",
          "575:  case 'R': goto yy6;",
          "576:  case 'S': goto yy7;",
          "577:  case 'a': goto yy8;",
          "578:  case 'b': goto yy9;",
          "579:  case 'd': goto yy10;",
          "580:  case 'i': goto yy11;",
          "582:  case 'r': goto yy13;",
          "583:  case 's': goto yy14;",
          "584:  case '}': goto yy15;",
          "585:  default: goto yy2;",
          "588:  ++YYCURSOR;",
          "590: #line 909 \"ext/standard/var_unserializer.re\"",
          "595:  if (yych == ':') goto yy17;",
          "599:  if (yych == ';') goto yy19;",
          "603:  if (yych == ':') goto yy21;",
          "607:  if (yych == ':') goto yy22;",
          "611:  if (yych == ':') goto yy23;",
          "615:  if (yych == ':') goto yy24;",
          "619:  if (yych == ':') goto yy25;",
          "623:  if (yych == ':') goto yy26;",
          "627:  if (yych == ':') goto yy27;",
          "631:  if (yych == ':') goto yy28;",
          "634:  yych = *(YYMARKER = ++YYCURSOR);",
          "635:  if (yych == ':') goto yy29;",
          "636:  goto yy3;",
          "637: yy15:",
          "639: #line 903 \"ext/standard/var_unserializer.re\"",
          "645: #line 646 \"ext/standard/var_unserializer.c\"",
          "649:   goto yy31;",
          "651:  if (yych == '+') goto yy30;",
          "656:  ++YYCURSOR;",
          "657: #line 581 \"ext/standard/var_unserializer.re\"",
          "658:  {",
          "660:  INIT_PZVAL(*rval);",
          "661:  ZVAL_NULL(*rval);",
          "662:  return 1;",
          "663: }",
          "664: #line 665 \"ext/standard/var_unserializer.c\"",
          "665: yy21:",
          "667:  if (yych <= ',') {",
          "668:   if (yych == '+') goto yy33;",
          "669:   goto yy18;",
          "670:  } else {",
          "671:   if (yych <= '-') goto yy33;",
          "672:   if (yych <= '/') goto yy18;",
          "673:   if (yych <= '9') goto yy34;",
          "674:   goto yy18;",
          "676: yy22:",
          "677:  yych = *++YYCURSOR;",
          "678:  if (yych == '+') goto yy36;",
          "679:  if (yych <= '/') goto yy18;",
          "680:  if (yych <= '9') goto yy37;",
          "681:  goto yy18;",
          "682: yy23:",
          "683:  yych = *++YYCURSOR;",
          "684:  if (yych == '+') goto yy39;",
          "685:  if (yych <= '/') goto yy18;",
          "686:  if (yych <= '9') goto yy40;",
          "688: yy24:",
          "689:  yych = *++YYCURSOR;",
          "691:  if (yych <= '1') goto yy42;",
          "692:  goto yy18;",
          "693: yy25:",
          "695:  if (yych <= '/') {",
          "696:   if (yych <= ',') {",
          "697:    if (yych == '+') goto yy43;",
          "698:    goto yy18;",
          "699:   } else {",
          "700:    if (yych <= '-') goto yy44;",
          "701:    if (yych <= '.') goto yy45;",
          "702:    goto yy18;",
          "704:  } else {",
          "705:   if (yych <= 'I') {",
          "706:    if (yych <= '9') goto yy46;",
          "707:    if (yych <= 'H') goto yy18;",
          "708:    goto yy48;",
          "710:    if (yych == 'N') goto yy49;",
          "711:    goto yy18;",
          "714: yy26:",
          "715:  yych = *++YYCURSOR;",
          "716:  if (yych <= ',') {",
          "717:   if (yych == '+') goto yy50;",
          "718:   goto yy18;",
          "719:  } else {",
          "720:   if (yych <= '-') goto yy50;",
          "721:   if (yych <= '/') goto yy18;",
          "722:   if (yych <= '9') goto yy51;",
          "723:   goto yy18;",
          "725: yy27:",
          "726:  yych = *++YYCURSOR;",
          "727:  if (yych <= ',') {",
          "728:   if (yych == '+') goto yy53;",
          "729:   goto yy18;",
          "730:  } else {",
          "731:   if (yych <= '-') goto yy53;",
          "732:   if (yych <= '/') goto yy18;",
          "733:   if (yych <= '9') goto yy54;",
          "734:   goto yy18;",
          "736: yy28:",
          "739:   if (yych == '+') goto yy56;",
          "740:   goto yy18;",
          "742:   if (yych <= '-') goto yy56;",
          "744:   if (yych <= '9') goto yy57;",
          "747: yy29:",
          "749:  if (yych == '+') goto yy59;",
          "751:  if (yych <= '9') goto yy60;",
          "752:  goto yy18;",
          "753: yy30:",
          "754:  yych = *++YYCURSOR;",
          "755:  if (yybm[0+yych] & 128) {",
          "756:   goto yy31;",
          "757:  }",
          "758:  goto yy18;",
          "759: yy31:",
          "763:  if (yybm[0+yych] & 128) {",
          "764:   goto yy31;",
          "765:  }",
          "767:  if (yych <= ':') goto yy62;",
          "768:  goto yy18;",
          "769: yy33:",
          "771:  if (yych <= '/') goto yy18;",
          "772:  if (yych >= ':') goto yy18;",
          "773: yy34:",
          "775:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "776:  yych = *YYCURSOR;",
          "779:  if (yych == ';') goto yy63;",
          "781: yy36:",
          "785: yy37:",
          "790:  if (yych <= '9') goto yy37;",
          "791:  if (yych <= ':') goto yy65;",
          "792:  goto yy18;",
          "793: yy39:",
          "795:  if (yych <= '/') goto yy18;",
          "796:  if (yych >= ':') goto yy18;",
          "797: yy40:",
          "799:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "800:  yych = *YYCURSOR;",
          "801:  if (yych <= '/') goto yy18;",
          "802:  if (yych <= '9') goto yy40;",
          "803:  if (yych <= ':') goto yy66;",
          "804:  goto yy18;",
          "805: yy42:",
          "806:  yych = *++YYCURSOR;",
          "807:  if (yych == ';') goto yy67;",
          "808:  goto yy18;",
          "809: yy43:",
          "810:  yych = *++YYCURSOR;",
          "811:  if (yych == '.') goto yy45;",
          "812:  if (yych <= '/') goto yy18;",
          "813:  if (yych <= '9') goto yy46;",
          "814:  goto yy18;",
          "815: yy44:",
          "816:  yych = *++YYCURSOR;",
          "817:  if (yych <= '/') {",
          "818:   if (yych != '.') goto yy18;",
          "819:  } else {",
          "820:   if (yych <= '9') goto yy46;",
          "821:   if (yych == 'I') goto yy48;",
          "822:   goto yy18;",
          "824: yy45:",
          "825:  yych = *++YYCURSOR;",
          "826:  if (yych <= '/') goto yy18;",
          "827:  if (yych <= '9') goto yy69;",
          "828:  goto yy18;",
          "829: yy46:",
          "830:  ++YYCURSOR;",
          "831:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "832:  yych = *YYCURSOR;",
          "833:  if (yych <= ':') {",
          "834:   if (yych <= '.') {",
          "835:    if (yych <= '-') goto yy18;",
          "836:    goto yy69;",
          "837:   } else {",
          "838:    if (yych <= '/') goto yy18;",
          "839:    if (yych <= '9') goto yy46;",
          "840:    goto yy18;",
          "841:   }",
          "842:  } else {",
          "843:   if (yych <= 'E') {",
          "844:    if (yych <= ';') goto yy71;",
          "845:    if (yych <= 'D') goto yy18;",
          "846:    goto yy73;",
          "847:   } else {",
          "848:    if (yych == 'e') goto yy73;",
          "849:    goto yy18;",
          "850:   }",
          "852: yy48:",
          "853:  yych = *++YYCURSOR;",
          "854:  if (yych == 'N') goto yy74;",
          "855:  goto yy18;",
          "856: yy49:",
          "857:  yych = *++YYCURSOR;",
          "858:  if (yych == 'A') goto yy75;",
          "859:  goto yy18;",
          "860: yy50:",
          "863:  if (yych >= ':') goto yy18;",
          "864: yy51:",
          "865:  ++YYCURSOR;",
          "866:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "867:  yych = *YYCURSOR;",
          "868:  if (yych <= '/') goto yy18;",
          "869:  if (yych <= '9') goto yy51;",
          "870:  if (yych == ';') goto yy76;",
          "872: yy53:",
          "876: yy54:",
          "881:  if (yych <= '9') goto yy54;",
          "882:  if (yych <= ':') goto yy78;",
          "883:  goto yy18;",
          "884: yy56:",
          "886:  if (yych <= '/') goto yy18;",
          "887:  if (yych >= ':') goto yy18;",
          "888: yy57:",
          "890:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "891:  yych = *YYCURSOR;",
          "893:  if (yych <= '9') goto yy57;",
          "894:  if (yych == ';') goto yy79;",
          "896: yy59:",
          "900: yy60:",
          "905:  if (yych <= '9') goto yy60;",
          "906:  if (yych <= ':') goto yy81;",
          "907:  goto yy18;",
          "908: yy62:",
          "910:  if (yych == '\"') goto yy82;",
          "911:  goto yy18;",
          "912: yy63:",
          "914: #line 537 \"ext/standard/var_unserializer.re\"",
          "916:  long id;",
          "919:  if (!var_hash) return 0;",
          "921:  id = parse_iv(start + 2) - 1;",
          "922:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "926:  if (*rval != NULL) {",
          "927:   var_push_dtor_no_addref(var_hash, rval);",
          "930:  Z_ADDREF_PP(rval);",
          "931:  Z_SET_ISREF_PP(rval);",
          "935: #line 936 \"ext/standard/var_unserializer.c\"",
          "936: yy65:",
          "938:  if (yych == '\"') goto yy84;",
          "940: yy66:",
          "942:  if (yych == '{') goto yy86;",
          "944: yy67:",
          "946: #line 588 \"ext/standard/var_unserializer.re\"",
          "947:  {",
          "949:  INIT_PZVAL(*rval);",
          "950:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "951:  return 1;",
          "952: }",
          "953: #line 954 \"ext/standard/var_unserializer.c\"",
          "954: yy69:",
          "960:   if (yych <= '9') goto yy69;",
          "965:    goto yy73;",
          "967:    if (yych == 'e') goto yy73;",
          "971: yy71:",
          "973: #line 637 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "572:  case 'O': goto yy13;",
          "574:  case 'R': goto yy2;",
          "575:  case 'S': goto yy10;",
          "576:  case 'a': goto yy11;",
          "577:  case 'b': goto yy6;",
          "578:  case 'd': goto yy8;",
          "579:  case 'i': goto yy7;",
          "581:  case 'r': goto yy4;",
          "582:  case 's': goto yy9;",
          "583:  case '}': goto yy14;",
          "584:  default: goto yy16;",
          "587:  yych = *(YYMARKER = ++YYCURSOR);",
          "588:  if (yych == ':') goto yy95;",
          "590: #line 908 \"ext/standard/var_unserializer.re\"",
          "595:  if (yych == ':') goto yy89;",
          "599:  if (yych == ';') goto yy87;",
          "603:  if (yych == ':') goto yy83;",
          "607:  if (yych == ':') goto yy77;",
          "611:  if (yych == ':') goto yy53;",
          "615:  if (yych == ':') goto yy46;",
          "619:  if (yych == ':') goto yy39;",
          "623:  if (yych == ':') goto yy32;",
          "627:  if (yych == ':') goto yy25;",
          "631:  if (yych == ':') goto yy17;",
          "635: #line 902 \"ext/standard/var_unserializer.re\"",
          "641: #line 642 \"ext/standard/var_unserializer.c\"",
          "642: yy16:",
          "643:  yych = *++YYCURSOR;",
          "644:  goto yy3;",
          "648:   goto yy20;",
          "650:  if (yych == '+') goto yy19;",
          "656:  if (yybm[0+yych] & 128) {",
          "657:   goto yy20;",
          "660: yy20:",
          "661:  ++YYCURSOR;",
          "662:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "663:  yych = *YYCURSOR;",
          "664:  if (yybm[0+yych] & 128) {",
          "665:   goto yy20;",
          "666:  }",
          "668:  if (yych >= ';') goto yy18;",
          "670:  if (yych != '\"') goto yy18;",
          "671:  ++YYCURSOR;",
          "672: #line 748 \"ext/standard/var_unserializer.re\"",
          "673:  {",
          "674:  size_t len, len2, len3, maxlen;",
          "675:  long elements;",
          "676:  char *class_name;",
          "677:  zend_class_entry *ce;",
          "678:  zend_class_entry **pce;",
          "679:  int incomplete_class = 0;",
          "681:  int custom_object = 0;",
          "683:  zval *user_func;",
          "684:  zval *retval_ptr;",
          "685:  zval **args[1];",
          "686:  zval *arg_func_name;",
          "688:     if (!var_hash) return 0;",
          "689:  if (*start == 'C') {",
          "690:   custom_object = 1;",
          "691:  }",
          "693:  INIT_PZVAL(*rval);",
          "694:  len2 = len = parse_uiv(start + 2);",
          "695:  maxlen = max - YYCURSOR;",
          "696:  if (maxlen < len || len == 0) {",
          "698:   return 0;",
          "699:  }",
          "701:  class_name = (char*)YYCURSOR;",
          "703:  YYCURSOR += len;",
          "705:  if (*(YYCURSOR) != '\"') {",
          "707:   return 0;",
          "708:  }",
          "709:  if (*(YYCURSOR+1) != ':') {",
          "711:   return 0;",
          "712:  }",
          "714:  len3 = strspn(class_name, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "715:  if (len3 != len)",
          "716:  {",
          "718:   return 0;",
          "719:  }",
          "721:  class_name = estrndup(class_name, len);",
          "723:  do {",
          "725:   BG(serialize_lock)++;",
          "726:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "727:    BG(serialize_lock)--;",
          "728:    if (EG(exception)) {",
          "729:     efree(class_name);",
          "730:     return 0;",
          "731:    }",
          "732:    ce = *pce;",
          "733:    break;",
          "735:   BG(serialize_lock)--;",
          "737:   if (EG(exception)) {",
          "738:    efree(class_name);",
          "739:    return 0;",
          "740:   }",
          "743:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "744:    incomplete_class = 1;",
          "745:    ce = PHP_IC_ENTRY;",
          "746:    break;",
          "747:   }",
          "750:   MAKE_STD_ZVAL(user_func);",
          "751:   ZVAL_STRING(user_func, PG(unserialize_callback_func), 1);",
          "752:   args[0] = &arg_func_name;",
          "753:   MAKE_STD_ZVAL(arg_func_name);",
          "754:   ZVAL_STRING(arg_func_name, class_name, 1);",
          "755:   BG(serialize_lock)++;",
          "756:   if (call_user_function_ex(CG(function_table), NULL, user_func, &retval_ptr, 1, args, 0, NULL TSRMLS_CC) != SUCCESS) {",
          "757:    BG(serialize_lock)--;",
          "758:    if (EG(exception)) {",
          "759:     efree(class_name);",
          "760:     zval_ptr_dtor(&user_func);",
          "761:     zval_ptr_dtor(&arg_func_name);",
          "762:     return 0;",
          "763:    }",
          "764:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"defined (%s) but not found\", user_func->value.str.val);",
          "765:    incomplete_class = 1;",
          "766:    ce = PHP_IC_ENTRY;",
          "767:    zval_ptr_dtor(&user_func);",
          "768:    zval_ptr_dtor(&arg_func_name);",
          "769:    break;",
          "770:   }",
          "771:   BG(serialize_lock)--;",
          "772:   if (retval_ptr) {",
          "773:    zval_ptr_dtor(&retval_ptr);",
          "774:   }",
          "775:   if (EG(exception)) {",
          "776:    efree(class_name);",
          "777:    zval_ptr_dtor(&user_func);",
          "778:    zval_ptr_dtor(&arg_func_name);",
          "779:    return 0;",
          "780:   }",
          "783:   BG(serialize_lock)++;",
          "784:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "785:    ce = *pce;",
          "787:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Function %s() hasn't defined the class it was called for\", user_func->value.str.val);",
          "788:    incomplete_class = 1;",
          "789:    ce = PHP_IC_ENTRY;",
          "790:   }",
          "791:   BG(serialize_lock)--;",
          "793:   zval_ptr_dtor(&user_func);",
          "794:   zval_ptr_dtor(&arg_func_name);",
          "795:   break;",
          "796:  } while (1);",
          "800:  if (custom_object) {",
          "801:   int ret;",
          "803:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "805:   if (ret && incomplete_class) {",
          "806:    php_store_class_name(*rval, class_name, len2);",
          "808:   efree(class_name);",
          "809:   return ret;",
          "812:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "814:  if (elements < 0) {",
          "815:     efree(class_name);",
          "816:     return 0;",
          "819:  if (incomplete_class) {",
          "820:   php_store_class_name(*rval, class_name, len2);",
          "822:  efree(class_name);",
          "824:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "825: }",
          "826: #line 827 \"ext/standard/var_unserializer.c\"",
          "827: yy25:",
          "830:   if (yych != '+') goto yy18;",
          "832:   if (yych <= '-') goto yy26;",
          "834:   if (yych <= '9') goto yy27;",
          "837: yy26:",
          "840:  if (yych >= ':') goto yy18;",
          "841: yy27:",
          "846:  if (yych <= '9') goto yy27;",
          "847:  if (yych >= ';') goto yy18;",
          "849:  if (yych != '\"') goto yy18;",
          "851: #line 735 \"ext/standard/var_unserializer.re\"",
          "852:  {",
          "853:  long elements;",
          "854:     if (!var_hash) return 0;",
          "856:  INIT_PZVAL(*rval);",
          "858:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "859:  if (elements < 0) {",
          "860:   return 0;",
          "861:  }",
          "862:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "863: }",
          "864: #line 865 \"ext/standard/var_unserializer.c\"",
          "865: yy32:",
          "866:  yych = *++YYCURSOR;",
          "867:  if (yych == '+') goto yy33;",
          "871: yy33:",
          "875: yy34:",
          "880:  if (yych <= '9') goto yy34;",
          "881:  if (yych >= ';') goto yy18;",
          "883:  if (yych != '{') goto yy18;",
          "885: #line 714 \"ext/standard/var_unserializer.re\"",
          "886:  {",
          "887:  long elements = parse_iv(start + 2);",
          "890:     if (!var_hash) return 0;",
          "892:  if (elements < 0) {",
          "893:   return 0;",
          "896:  INIT_PZVAL(*rval);",
          "898:  array_init_size(*rval, elements);",
          "900:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_PP(rval), elements, 0)) {",
          "901:   return 0;",
          "904:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "905: }",
          "906: #line 907 \"ext/standard/var_unserializer.c\"",
          "907: yy39:",
          "909:  if (yych == '+') goto yy40;",
          "911:  if (yych <= '9') goto yy41;",
          "913: yy40:",
          "917: yy41:",
          "922:  if (yych <= '9') goto yy41;",
          "923:  if (yych >= ';') goto yy18;",
          "925:  if (yych != '\"') goto yy18;",
          "927: #line 679 \"ext/standard/var_unserializer.re\"",
          "928:  {",
          "929:  size_t len, maxlen;",
          "930:  char *str;",
          "932:  len = parse_uiv(start + 2);",
          "933:  maxlen = max - YYCURSOR;",
          "934:  if (maxlen < len) {",
          "936:   return 0;",
          "937:  }",
          "939:  if ((str = unserialize_str(&YYCURSOR, &len, maxlen)) == NULL) {",
          "940:   return 0;",
          "941:  }",
          "943:  if (*(YYCURSOR) != '\"') {",
          "944:   efree(str);",
          "946:   return 0;",
          "947:  }",
          "949:  if (*(YYCURSOR + 1) != ';') {",
          "950:   efree(str);",
          "952:   return 0;",
          "953:  }",
          "955:  YYCURSOR += 2;",
          "958:  INIT_PZVAL(*rval);",
          "959:  ZVAL_STRINGL(*rval, str, len, 0);",
          "960:  return 1;",
          "961: }",
          "962: #line 963 \"ext/standard/var_unserializer.c\"",
          "963: yy46:",
          "964:  yych = *++YYCURSOR;",
          "965:  if (yych == '+') goto yy47;",
          "967:  if (yych <= '9') goto yy48;",
          "969: yy47:",
          "973: yy48:",
          "978:  if (yych <= '9') goto yy48;",
          "979:  if (yych >= ';') goto yy18;",
          "981:  if (yych != '\"') goto yy18;",
          "983: #line 646 \"ext/standard/var_unserializer.re\"",
          "985:  size_t len, maxlen;",
          "986:  char *str;",
          "988:  len = parse_uiv(start + 2);",
          "989:  maxlen = max - YYCURSOR;",
          "990:  if (maxlen < len) {",
          "992:   return 0;",
          "993:  }",
          "995:  str = (char*)YYCURSOR;",
          "997:  YYCURSOR += len;",
          "999:  if (*(YYCURSOR) != '\"') {",
          "1004:  if (*(YYCURSOR + 1) != ';') {",
          "1006:   return 0;",
          "1009:  YYCURSOR += 2;",
          "1012:  INIT_PZVAL(*rval);",
          "1013:  ZVAL_STRINGL(*rval, str, len, 1);",
          "1016: #line 1017 \"ext/standard/var_unserializer.c\"",
          "1017: yy53:",
          "1018:  yych = *++YYCURSOR;",
          "1019:  if (yych <= '/') {",
          "1020:   if (yych <= ',') {",
          "1021:    if (yych == '+') goto yy57;",
          "1022:    goto yy18;",
          "1023:   } else {",
          "1024:    if (yych <= '-') goto yy55;",
          "1025:    if (yych <= '.') goto yy60;",
          "1026:    goto yy18;",
          "1027:   }",
          "1028:  } else {",
          "1029:   if (yych <= 'I') {",
          "1030:    if (yych <= '9') goto yy58;",
          "1031:    if (yych <= 'H') goto yy18;",
          "1032:    goto yy56;",
          "1033:   } else {",
          "1034:    if (yych != 'N') goto yy18;",
          "1035:   }",
          "1036:  }",
          "1038:  if (yych == 'A') goto yy76;",
          "1040: yy55:",
          "1041:  yych = *++YYCURSOR;",
          "1042:  if (yych <= '/') {",
          "1043:   if (yych == '.') goto yy60;",
          "1044:   goto yy18;",
          "1045:  } else {",
          "1046:   if (yych <= '9') goto yy58;",
          "1047:   if (yych != 'I') goto yy18;",
          "1048:  }",
          "1049: yy56:",
          "1051:  if (yych == 'N') goto yy72;",
          "1053: yy57:",
          "1054:  yych = *++YYCURSOR;",
          "1055:  if (yych == '.') goto yy60;",
          "1056:  if (yych <= '/') goto yy18;",
          "1057:  if (yych >= ':') goto yy18;",
          "1058: yy58:",
          "1060:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1061:  yych = *YYCURSOR;",
          "1062:  if (yych <= ':') {",
          "1063:   if (yych <= '.') {",
          "1064:    if (yych <= '-') goto yy18;",
          "1065:    goto yy70;",
          "1066:   } else {",
          "1067:    if (yych <= '/') goto yy18;",
          "1068:    if (yych <= '9') goto yy58;",
          "1069:    goto yy18;",
          "1070:   }",
          "1071:  } else {",
          "1072:   if (yych <= 'E') {",
          "1073:    if (yych <= ';') goto yy63;",
          "1074:    if (yych <= 'D') goto yy18;",
          "1075:    goto yy65;",
          "1076:   } else {",
          "1077:    if (yych == 'e') goto yy65;",
          "1078:    goto yy18;",
          "1079:   }",
          "1080:  }",
          "1081: yy60:",
          "1082:  yych = *++YYCURSOR;",
          "1083:  if (yych <= '/') goto yy18;",
          "1084:  if (yych >= ':') goto yy18;",
          "1085: yy61:",
          "1091:   if (yych <= '9') goto yy61;",
          "1096:    goto yy65;",
          "1098:    if (yych == 'e') goto yy65;",
          "1102: yy63:",
          "1104: #line 636 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "980:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "981:  return 1;",
          "982: }",
          "985:  yych = *++YYCURSOR;",
          "986:  if (yych <= ',') {",
          "989:  } else {",
          "991:   if (yych <= '/') goto yy18;",
          "993:   goto yy18;",
          "994:  }",
          "996:  yych = *++YYCURSOR;",
          "998:  goto yy18;",
          "1000:  yych = *++YYCURSOR;",
          "1002:  goto yy18;",
          "1004:  ++YYCURSOR;",
          "1022:   } else {",
          "1024:   }",
          "1025:  }",
          "1034:  yych = *++YYCURSOR;",
          "1038:  ++YYCURSOR;",
          "1040:  {",
          "1055:  }",
          "1060:  return 1;",
          "1061: }",
          "1064:  yych = *++YYCURSOR;",
          "1066:  goto yy18;",
          "1068:  ++YYCURSOR;",
          "1070:  {",
          "1116:  }",
          "1160:    }",
          "1183:   } else {",
          "1204:   }",
          "1218:  }",
          "1222: }",
          "1225:  ++YYCURSOR;",
          "1227:  {",
          "1257:  INIT_PZVAL(*rval);",
          "1259:  return 1;",
          "1260: }",
          "1263:  ++YYCURSOR;",
          "1265:  {",
          "1275:  INIT_PZVAL(*rval);",
          "1284: }",
          "1287:  yych = *++YYCURSOR;",
          "1288:  if (yych <= ',') {",
          "1291:  } else {",
          "1293:   if (yych <= '/') goto yy18;",
          "1295:  }",
          "1297:  ++YYCURSOR;",
          "1298:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1299:  yych = *YYCURSOR;",
          "1300:  if (yych <= '/') goto yy18;",
          "1309:  ++YYCURSOR;",
          "1311:  {",
          "1335:   return 0;",
          "1336:  }",
          "1350:  }",
          "1357:  return 1;",
          "1358: }",
          "1360: yy96:",
          "1361:  yych = *++YYCURSOR;",
          "1362:  if (yych <= '/') goto yy18;",
          "1365: yy97:",
          "1366:  ++YYCURSOR;",
          "1368:  {",
          "1378:  }",
          "1380:  return 1;",
          "1381: }",
          "1383: }",
          "1387:  return 0;",
          "",
          "[Removed Lines]",
          "983: #line 984 \"ext/standard/var_unserializer.c\"",
          "984: yy73:",
          "987:   if (yych == '+') goto yy88;",
          "988:   goto yy18;",
          "990:   if (yych <= '-') goto yy88;",
          "992:   if (yych <= '9') goto yy89;",
          "995: yy74:",
          "997:  if (yych == 'F') goto yy91;",
          "999: yy75:",
          "1001:  if (yych == 'N') goto yy91;",
          "1003: yy76:",
          "1005: #line 595 \"ext/standard/var_unserializer.re\"",
          "1006:  {",
          "1007: #if SIZEOF_LONG == 4",
          "1008:  int digits = YYCURSOR - start - 3;",
          "1010:  if (start[2] == '-' || start[2] == '+') {",
          "1011:   digits--;",
          "1012:  }",
          "1015:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1016:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1017:    int cmp = strncmp(YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1019:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1020:     goto use_double;",
          "1021:    }",
          "1023:    goto use_double;",
          "1026: #endif",
          "1028:  INIT_PZVAL(*rval);",
          "1029:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1030:  return 1;",
          "1031: }",
          "1032: #line 1033 \"ext/standard/var_unserializer.c\"",
          "1033: yy78:",
          "1035:  if (yych == '\"') goto yy92;",
          "1036:  goto yy18;",
          "1037: yy79:",
          "1039: #line 558 \"ext/standard/var_unserializer.re\"",
          "1041:  long id;",
          "1044:  if (!var_hash) return 0;",
          "1046:  id = parse_iv(start + 2) - 1;",
          "1047:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "1048:   return 0;",
          "1049:  }",
          "1051:  if (*rval == *rval_ref) return 0;",
          "1053:  if (*rval != NULL) {",
          "1054:   var_push_dtor_no_addref(var_hash, rval);",
          "1057:  Z_ADDREF_PP(rval);",
          "1058:  Z_UNSET_ISREF_PP(rval);",
          "1062: #line 1063 \"ext/standard/var_unserializer.c\"",
          "1063: yy81:",
          "1065:  if (yych == '\"') goto yy94;",
          "1067: yy82:",
          "1069: #line 749 \"ext/standard/var_unserializer.re\"",
          "1071:  size_t len, len2, len3, maxlen;",
          "1072:  long elements;",
          "1073:  char *class_name;",
          "1074:  zend_class_entry *ce;",
          "1075:  zend_class_entry **pce;",
          "1076:  int incomplete_class = 0;",
          "1078:  int custom_object = 0;",
          "1080:  zval *user_func;",
          "1081:  zval *retval_ptr;",
          "1082:  zval **args[1];",
          "1083:  zval *arg_func_name;",
          "1085:     if (!var_hash) return 0;",
          "1086:  if (*start == 'C') {",
          "1087:   custom_object = 1;",
          "1088:  }",
          "1090:  INIT_PZVAL(*rval);",
          "1091:  len2 = len = parse_uiv(start + 2);",
          "1092:  maxlen = max - YYCURSOR;",
          "1093:  if (maxlen < len || len == 0) {",
          "1095:   return 0;",
          "1096:  }",
          "1098:  class_name = (char*)YYCURSOR;",
          "1100:  YYCURSOR += len;",
          "1102:  if (*(YYCURSOR) != '\"') {",
          "1104:   return 0;",
          "1105:  }",
          "1106:  if (*(YYCURSOR+1) != ':') {",
          "1108:   return 0;",
          "1109:  }",
          "1111:  len3 = strspn(class_name, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1112:  if (len3 != len)",
          "1113:  {",
          "1115:   return 0;",
          "1118:  class_name = estrndup(class_name, len);",
          "1120:  do {",
          "1122:   BG(serialize_lock)++;",
          "1123:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "1124:    BG(serialize_lock)--;",
          "1125:    if (EG(exception)) {",
          "1126:     efree(class_name);",
          "1127:     return 0;",
          "1128:    }",
          "1129:    ce = *pce;",
          "1130:    break;",
          "1131:   }",
          "1132:   BG(serialize_lock)--;",
          "1134:   if (EG(exception)) {",
          "1135:    efree(class_name);",
          "1136:    return 0;",
          "1137:   }",
          "1140:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1141:    incomplete_class = 1;",
          "1142:    ce = PHP_IC_ENTRY;",
          "1143:    break;",
          "1144:   }",
          "1147:   MAKE_STD_ZVAL(user_func);",
          "1148:   ZVAL_STRING(user_func, PG(unserialize_callback_func), 1);",
          "1149:   args[0] = &arg_func_name;",
          "1150:   MAKE_STD_ZVAL(arg_func_name);",
          "1151:   ZVAL_STRING(arg_func_name, class_name, 1);",
          "1152:   BG(serialize_lock)++;",
          "1153:   if (call_user_function_ex(CG(function_table), NULL, user_func, &retval_ptr, 1, args, 0, NULL TSRMLS_CC) != SUCCESS) {",
          "1154:    BG(serialize_lock)--;",
          "1155:    if (EG(exception)) {",
          "1156:     efree(class_name);",
          "1157:     zval_ptr_dtor(&user_func);",
          "1158:     zval_ptr_dtor(&arg_func_name);",
          "1159:     return 0;",
          "1161:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"defined (%s) but not found\", user_func->value.str.val);",
          "1162:    incomplete_class = 1;",
          "1163:    ce = PHP_IC_ENTRY;",
          "1164:    zval_ptr_dtor(&user_func);",
          "1165:    zval_ptr_dtor(&arg_func_name);",
          "1166:    break;",
          "1167:   }",
          "1168:   BG(serialize_lock)--;",
          "1169:   if (retval_ptr) {",
          "1170:    zval_ptr_dtor(&retval_ptr);",
          "1171:   }",
          "1172:   if (EG(exception)) {",
          "1173:    efree(class_name);",
          "1174:    zval_ptr_dtor(&user_func);",
          "1175:    zval_ptr_dtor(&arg_func_name);",
          "1176:    return 0;",
          "1177:   }",
          "1180:   BG(serialize_lock)++;",
          "1181:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "1182:    ce = *pce;",
          "1184:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Function %s() hasn't defined the class it was called for\", user_func->value.str.val);",
          "1185:    incomplete_class = 1;",
          "1186:    ce = PHP_IC_ENTRY;",
          "1187:   }",
          "1188:   BG(serialize_lock)--;",
          "1190:   zval_ptr_dtor(&user_func);",
          "1191:   zval_ptr_dtor(&arg_func_name);",
          "1192:   break;",
          "1193:  } while (1);",
          "1197:  if (custom_object) {",
          "1198:   int ret;",
          "1200:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1202:   if (ret && incomplete_class) {",
          "1203:    php_store_class_name(*rval, class_name, len2);",
          "1205:   efree(class_name);",
          "1206:   return ret;",
          "1207:  }",
          "1209:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1211:  if (elements < 0) {",
          "1212:     efree(class_name);",
          "1213:     return 0;",
          "1214:  }",
          "1216:  if (incomplete_class) {",
          "1217:   php_store_class_name(*rval, class_name, len2);",
          "1219:  efree(class_name);",
          "1221:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1223: #line 1224 \"ext/standard/var_unserializer.c\"",
          "1224: yy84:",
          "1226: #line 680 \"ext/standard/var_unserializer.re\"",
          "1228:  size_t len, maxlen;",
          "1229:  char *str;",
          "1231:  len = parse_uiv(start + 2);",
          "1232:  maxlen = max - YYCURSOR;",
          "1233:  if (maxlen < len) {",
          "1235:   return 0;",
          "1236:  }",
          "1238:  if ((str = unserialize_str(&YYCURSOR, &len, maxlen)) == NULL) {",
          "1239:   return 0;",
          "1240:  }",
          "1242:  if (*(YYCURSOR) != '\"') {",
          "1243:   efree(str);",
          "1245:   return 0;",
          "1246:  }",
          "1248:  if (*(YYCURSOR + 1) != ';') {",
          "1249:   efree(str);",
          "1251:   return 0;",
          "1252:  }",
          "1254:  YYCURSOR += 2;",
          "1258:  ZVAL_STRINGL(*rval, str, len, 0);",
          "1261: #line 1262 \"ext/standard/var_unserializer.c\"",
          "1262: yy86:",
          "1264: #line 715 \"ext/standard/var_unserializer.re\"",
          "1266:  long elements = parse_iv(start + 2);",
          "1269:     if (!var_hash) return 0;",
          "1271:  if (elements < 0) {",
          "1272:   return 0;",
          "1273:  }",
          "1277:  array_init_size(*rval, elements);",
          "1279:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_PP(rval), elements, 0)) {",
          "1280:   return 0;",
          "1281:  }",
          "1283:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1285: #line 1286 \"ext/standard/var_unserializer.c\"",
          "1286: yy88:",
          "1289:   if (yych == '+') goto yy96;",
          "1290:   goto yy18;",
          "1292:   if (yych <= '-') goto yy96;",
          "1294:   if (yych >= ':') goto yy18;",
          "1296: yy89:",
          "1301:  if (yych <= '9') goto yy89;",
          "1302:  if (yych == ';') goto yy71;",
          "1303:  goto yy18;",
          "1304: yy91:",
          "1305:  yych = *++YYCURSOR;",
          "1306:  if (yych == ';') goto yy97;",
          "1307:  goto yy18;",
          "1308: yy92:",
          "1310: #line 736 \"ext/standard/var_unserializer.re\"",
          "1312:  long elements;",
          "1313:     if (!var_hash) return 0;",
          "1315:  INIT_PZVAL(*rval);",
          "1317:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1318:  if (elements < 0) {",
          "1319:   return 0;",
          "1320:  }",
          "1321:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1322: }",
          "1323: #line 1324 \"ext/standard/var_unserializer.c\"",
          "1324: yy94:",
          "1325:  ++YYCURSOR;",
          "1326: #line 647 \"ext/standard/var_unserializer.re\"",
          "1327:  {",
          "1328:  size_t len, maxlen;",
          "1329:  char *str;",
          "1331:  len = parse_uiv(start + 2);",
          "1332:  maxlen = max - YYCURSOR;",
          "1333:  if (maxlen < len) {",
          "1338:  str = (char*)YYCURSOR;",
          "1340:  YYCURSOR += len;",
          "1342:  if (*(YYCURSOR) != '\"') {",
          "1344:   return 0;",
          "1345:  }",
          "1347:  if (*(YYCURSOR + 1) != ';') {",
          "1349:   return 0;",
          "1352:  YYCURSOR += 2;",
          "1355:  INIT_PZVAL(*rval);",
          "1356:  ZVAL_STRINGL(*rval, str, len, 1);",
          "1359: #line 1360 \"ext/standard/var_unserializer.c\"",
          "1363:  if (yych <= '9') goto yy89;",
          "1364:  goto yy18;",
          "1367: #line 622 \"ext/standard/var_unserializer.re\"",
          "1370:  INIT_PZVAL(*rval);",
          "1372:  if (!strncmp(start + 2, \"NAN\", 3)) {",
          "1373:   ZVAL_DOUBLE(*rval, php_get_nan());",
          "1374:  } else if (!strncmp(start + 2, \"INF\", 3)) {",
          "1375:   ZVAL_DOUBLE(*rval, php_get_inf());",
          "1376:  } else if (!strncmp(start + 2, \"-INF\", 4)) {",
          "1377:   ZVAL_DOUBLE(*rval, -php_get_inf());",
          "1382: #line 1383 \"ext/standard/var_unserializer.c\"",
          "1384: #line 911 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "1115: yy65:",
          "1118:   if (yych != '+') goto yy18;",
          "1120:   if (yych <= '-') goto yy66;",
          "1122:   if (yych <= '9') goto yy67;",
          "1125: yy66:",
          "1127:  if (yych <= ',') {",
          "1128:   if (yych == '+') goto yy69;",
          "1129:   goto yy18;",
          "1130:  } else {",
          "1131:   if (yych <= '-') goto yy69;",
          "1132:   if (yych <= '/') goto yy18;",
          "1133:   if (yych >= ':') goto yy18;",
          "1134:  }",
          "1135: yy67:",
          "1136:  ++YYCURSOR;",
          "1137:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1138:  yych = *YYCURSOR;",
          "1139:  if (yych <= '/') goto yy18;",
          "1140:  if (yych <= '9') goto yy67;",
          "1141:  if (yych == ';') goto yy63;",
          "1143: yy69:",
          "1145:  if (yych <= '/') goto yy18;",
          "1146:  if (yych <= '9') goto yy67;",
          "1148: yy70:",
          "1150:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1151:  yych = *YYCURSOR;",
          "1152:  if (yych <= ';') {",
          "1153:   if (yych <= '/') goto yy18;",
          "1154:   if (yych <= '9') goto yy70;",
          "1155:   if (yych <= ':') goto yy18;",
          "1156:   goto yy63;",
          "1157:  } else {",
          "1158:   if (yych <= 'E') {",
          "1159:    if (yych <= 'D') goto yy18;",
          "1160:    goto yy65;",
          "1162:    if (yych == 'e') goto yy65;",
          "1163:    goto yy18;",
          "1166: yy72:",
          "1168:  if (yych != 'F') goto yy18;",
          "1169: yy73:",
          "1170:  yych = *++YYCURSOR;",
          "1171:  if (yych != ';') goto yy18;",
          "1173: #line 621 \"ext/standard/var_unserializer.re\"",
          "1176:  INIT_PZVAL(*rval);",
          "1178:  if (!strncmp(start + 2, \"NAN\", 3)) {",
          "1179:   ZVAL_DOUBLE(*rval, php_get_nan());",
          "1180:  } else if (!strncmp(start + 2, \"INF\", 3)) {",
          "1181:   ZVAL_DOUBLE(*rval, php_get_inf());",
          "1182:  } else if (!strncmp(start + 2, \"-INF\", 4)) {",
          "1183:   ZVAL_DOUBLE(*rval, -php_get_inf());",
          "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
          "1189: yy76:",
          "1191:  if (yych == 'N') goto yy73;",
          "1193: yy77:",
          "1194:  yych = *++YYCURSOR;",
          "1195:  if (yych <= ',') {",
          "1196:   if (yych != '+') goto yy18;",
          "1197:  } else {",
          "1198:   if (yych <= '-') goto yy78;",
          "1199:   if (yych <= '/') goto yy18;",
          "1200:   if (yych <= '9') goto yy79;",
          "1201:   goto yy18;",
          "1202:  }",
          "1203: yy78:",
          "1204:  yych = *++YYCURSOR;",
          "1205:  if (yych <= '/') goto yy18;",
          "1206:  if (yych >= ':') goto yy18;",
          "1207: yy79:",
          "1209:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1210:  yych = *YYCURSOR;",
          "1211:  if (yych <= '/') goto yy18;",
          "1212:  if (yych <= '9') goto yy79;",
          "1213:  if (yych != ';') goto yy18;",
          "1214:  ++YYCURSOR;",
          "1215: #line 594 \"ext/standard/var_unserializer.re\"",
          "1217: #if SIZEOF_LONG == 4",
          "1218:  int digits = YYCURSOR - start - 3;",
          "1220:  if (start[2] == '-' || start[2] == '+') {",
          "1221:   digits--;",
          "1225:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1226:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1227:    int cmp = strncmp(YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1229:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1230:     goto use_double;",
          "1233:    goto use_double;",
          "1236: #endif",
          "1238:  INIT_PZVAL(*rval);",
          "1239:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1240:  return 1;",
          "1242: #line 1243 \"ext/standard/var_unserializer.c\"",
          "1243: yy83:",
          "1244:  yych = *++YYCURSOR;",
          "1245:  if (yych <= '/') goto yy18;",
          "1246:  if (yych >= '2') goto yy18;",
          "1247:  yych = *++YYCURSOR;",
          "1248:  if (yych != ';') goto yy18;",
          "1250: #line 587 \"ext/standard/var_unserializer.re\"",
          "1254:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1257: #line 1258 \"ext/standard/var_unserializer.c\"",
          "1258: yy87:",
          "1260: #line 580 \"ext/standard/var_unserializer.re\"",
          "1264:  ZVAL_NULL(*rval);",
          "1265:  return 1;",
          "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
          "1268: yy89:",
          "1271:   if (yych != '+') goto yy18;",
          "1273:   if (yych <= '-') goto yy90;",
          "1275:   if (yych <= '9') goto yy91;",
          "1276:   goto yy18;",
          "1278: yy90:",
          "1279:  yych = *++YYCURSOR;",
          "1280:  if (yych <= '/') goto yy18;",
          "1281:  if (yych >= ':') goto yy18;",
          "1282: yy91:",
          "1287:  if (yych <= '9') goto yy91;",
          "1288:  if (yych != ';') goto yy18;",
          "1290: #line 557 \"ext/standard/var_unserializer.re\"",
          "1292:  long id;",
          "1295:  if (!var_hash) return 0;",
          "1297:  id = parse_iv(start + 2) - 1;",
          "1298:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "1302:  if (*rval == *rval_ref) return 0;",
          "1304:  if (*rval != NULL) {",
          "1305:   var_push_dtor_no_addref(var_hash, rval);",
          "1308:  Z_ADDREF_PP(rval);",
          "1309:  Z_UNSET_ISREF_PP(rval);",
          "1313: #line 1314 \"ext/standard/var_unserializer.c\"",
          "1314: yy95:",
          "1315:  yych = *++YYCURSOR;",
          "1316:  if (yych <= ',') {",
          "1317:   if (yych != '+') goto yy18;",
          "1318:  } else {",
          "1319:   if (yych <= '-') goto yy96;",
          "1320:   if (yych <= '/') goto yy18;",
          "1321:   if (yych <= '9') goto yy97;",
          "1322:   goto yy18;",
          "1323:  }",
          "1327:  if (yych >= ':') goto yy18;",
          "1330:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1331:  yych = *YYCURSOR;",
          "1332:  if (yych <= '/') goto yy18;",
          "1333:  if (yych <= '9') goto yy97;",
          "1334:  if (yych != ';') goto yy18;",
          "1335:  ++YYCURSOR;",
          "1336: #line 536 \"ext/standard/var_unserializer.re\"",
          "1338:  long id;",
          "1341:  if (!var_hash) return 0;",
          "1343:  id = parse_iv(start + 2) - 1;",
          "1344:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "1345:   return 0;",
          "1346:  }",
          "1348:  if (*rval != NULL) {",
          "1349:   var_push_dtor_no_addref(var_hash, rval);",
          "1352:  Z_ADDREF_PP(rval);",
          "1353:  Z_SET_ISREF_PP(rval);",
          "1357: #line 1358 \"ext/standard/var_unserializer.c\"",
          "1359: #line 910 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "411: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "412: {",
          "420: }",
          "422: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "",
          "[Removed Lines]",
          "413:  if (*((*p)++) == '}')",
          "414:   return 1;",
          "416: #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE",
          "417:  zval_ptr_dtor(rval);",
          "418: #endif",
          "419:  return 0;",
          "",
          "[Added Lines]",
          "413:  if (*p >= max || **p != '}') {",
          "414:   return 0;",
          "415:  }",
          "417:  (*p)++;",
          "418:  return 1;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8fe171a3e046717ec0109297bcd765bdee3e939c",
      "candidate_info": {
        "commit_hash": "8fe171a3e046717ec0109297bcd765bdee3e939c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/8fe171a3e046717ec0109297bcd765bdee3e939c",
        "files": [
          "ext/standard/array.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Don't allocate memory for empty HashTables.",
        "before_after_code_files": [
          "ext/standard/array.c||ext/standard/array.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/array.c||ext/standard/array.c": [
          "File: ext/standard/array.c -> ext/standard/array.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3308:   }",
          "3309:  } else {",
          "3310:   array_init_size(return_value, zend_hash_num_elements(Z_ARRVAL_P(input)));",
          "3311:   zend_hash_real_init(Z_ARRVAL_P(return_value), 1);",
          "3312:   ZEND_HASH_FILL_PACKED(Z_ARRVAL_P(return_value)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3311:   if (!zend_hash_num_elements(Z_ARRVAL_P(input))) {",
          "3312:    return;",
          "3313:   }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3345:  array_init_size(return_value, zend_hash_num_elements(Z_ARRVAL_P(input)));",
          "3346:  zend_hash_real_init(Z_ARRVAL_P(return_value), 1);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3350:  if (!zend_hash_num_elements(Z_ARRVAL_P(input))) {",
          "3351:   return;",
          "3352:  }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "599:  yych = *(YYMARKER = ++YYCURSOR);",
          "600:  if (yych == ':') goto yy95;",
          "601: yy3:",
          "603:  { return 0; }",
          "604: #line 605 \"ext/standard/var_unserializer.c\"",
          "605: yy4:",
          "",
          "[Removed Lines]",
          "602: #line 893 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "602: #line 895 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "644:  goto yy3;",
          "645: yy14:",
          "646:  ++YYCURSOR;",
          "648:  {",
          "650:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "",
          "[Removed Lines]",
          "647: #line 887 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "647: #line 889 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "676:  if (yybm[0+yych] & 128) {",
          "677:   goto yy20;",
          "678:  }",
          "681:  yych = *++YYCURSOR;",
          "682:  if (yych != '\"') goto yy18;",
          "683:  ++YYCURSOR;",
          "685:  {",
          "686:  size_t len, len2, len3, maxlen;",
          "687:  zend_long elements;",
          "",
          "[Removed Lines]",
          "679:  if (yych <= '/') goto yy18;",
          "680:  if (yych >= ';') goto yy18;",
          "684: #line 741 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "679:  if (yych != ':') goto yy18;",
          "683: #line 743 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "828:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "829: }",
          "831: yy25:",
          "832:  yych = *++YYCURSOR;",
          "833:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "830: #line 831 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "829: #line 830 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "852:  yych = *++YYCURSOR;",
          "853:  if (yych != '\"') goto yy18;",
          "854:  ++YYCURSOR;",
          "856:  {",
          "857:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "855: #line 732 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "854: #line 734 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "861:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "862:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "863: }",
          "865: yy32:",
          "866:  yych = *++YYCURSOR;",
          "867:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "864: #line 865 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "863: #line 864 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "896:  array_init_size(rval, elements);",
          "901:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "902:   return 0;",
          "",
          "[Removed Lines]",
          "899:  zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "",
          "[Added Lines]",
          "898:  if (elements) {",
          "899:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "900:  }",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "905:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "906: }",
          "908: yy39:",
          "909:  yych = *++YYCURSOR;",
          "910:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "907: #line 908 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "908: #line 909 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "953:  ZVAL_STR(rval, str);",
          "954:  return 1;",
          "955: }",
          "957: yy46:",
          "958:  yych = *++YYCURSOR;",
          "959:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "956: #line 957 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "957: #line 958 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1001:  ZVAL_STRINGL(rval, str, len);",
          "1002:  return 1;",
          "1003: }",
          "1005: yy53:",
          "1006:  yych = *++YYCURSOR;",
          "1007:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "1004: #line 1005 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1005: #line 1006 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1098:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1099:  return 1;",
          "1100: }",
          "1102: yy65:",
          "1103:  yych = *++YYCURSOR;",
          "1104:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1101: #line 1102 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1102: #line 1103 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1174:  return 1;",
          "1175: }",
          "1177: yy76:",
          "1178:  yych = *++YYCURSOR;",
          "1179:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1176: #line 1177 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1177: #line 1178 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1226:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1227:  return 1;",
          "1228: }",
          "1230: yy83:",
          "1231:  yych = *++YYCURSOR;",
          "1232:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1229: #line 1230 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1240:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1241:  return 1;",
          "1242: }",
          "1244: yy87:",
          "1245:  ++YYCURSOR;",
          "1246: #line 592 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1243: #line 1244 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1249:  ZVAL_NULL(rval);",
          "1250:  return 1;",
          "1251: }",
          "1253: yy89:",
          "1254:  yych = *++YYCURSOR;",
          "1255:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1252: #line 1253 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1253: #line 1254 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1296:  return 1;",
          "1297: }",
          "1299: yy95:",
          "1300:  yych = *++YYCURSOR;",
          "1301:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1298: #line 1299 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1299: #line 1300 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1341:  return 1;",
          "1342: }",
          "1344: }",
          "1348:  return 0;",
          "",
          "[Removed Lines]",
          "1343: #line 1344 \"ext/standard/var_unserializer.c\"",
          "1345: #line 895 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1344: #line 1345 \"ext/standard/var_unserializer.c\"",
          "1346: #line 897 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "720:  array_init_size(rval, elements);",
          "725:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "726:   return 0;",
          "",
          "[Removed Lines]",
          "723:  zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "",
          "[Added Lines]",
          "723:  if (elements) {",
          "724:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "725:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d02f953faf4afdd1576acb1380e4cd3c050ac599",
      "candidate_info": {
        "commit_hash": "d02f953faf4afdd1576acb1380e4cd3c050ac599",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/d02f953faf4afdd1576acb1380e4cd3c050ac599",
        "files": [
          "ext/standard/tests/serialize/bug74101.phpt",
          "ext/standard/tests/serialize/bug74614.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #74101 and bug #74614",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug74101.phpt||ext/standard/tests/serialize/bug74101.phpt",
          "ext/standard/tests/serialize/bug74614.phpt||ext/standard/tests/serialize/bug74614.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug74101.phpt||ext/standard/tests/serialize/bug74101.phpt": [
          "File: ext/standard/tests/serialize/bug74101.phpt -> ext/standard/tests/serialize/bug74101.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74101: Unserialize Heap Use-After-Free (READ: 1) in zval_get_type",
          "3: --FILE--",
          "4: <?php",
          "5: $s = 'O:9:\"Exception\":799999999999999999999999999997:0i:0;a:0:{}i:2;i:0;i:0;R:2;';",
          "6: var_dump(unserialize($s));",
          "7: ?>",
          "8: --EXPECTF--",
          "9: Notice: unserialize(): Error at offset 48 of 74 bytes in %s on line %d",
          "10: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug74614.phpt||ext/standard/tests/serialize/bug74614.phpt": [
          "File: ext/standard/tests/serialize/bug74614.phpt -> ext/standard/tests/serialize/bug74614.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74614: Use-after-free in PHP7's unserialize()",
          "3: --FILE--",
          "4: <?php",
          "6: unserialize('a:3020000000000000000000000000000001:{i:0;a:0:{}i:1;i:2;i:2;i:3;i:3;i:4;i:4;i:5;i:5;i:6;i:6;i:7;i:7;i:8;i:8;R:2;}');",
          "8: ?>",
          "9: --EXPECTF--",
          "10: Notice: unserialize(): Error at offset 38 of 113 bytes in %s on line %d",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "503:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "505:  ht = Z_OBJPROP_P(rval);",
          "506:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "507:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "508:   if (has_wakeup) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "506:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "507:   return 0;",
          "508:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "578:  start = cursor;",
          "582: {",
          "583:  YYCTYPE yych;",
          "584:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "581: #line 582 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "585: #line 586 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "636: yy2:",
          "637:  ++YYCURSOR;",
          "638: yy3:",
          "640:  { return 0; }",
          "642: yy4:",
          "643:  yych = *(YYMARKER = ++YYCURSOR);",
          "644:  if (yych == ':') goto yy17;",
          "",
          "[Removed Lines]",
          "639: #line 959 \"ext/standard/var_unserializer.re\"",
          "641: #line 642 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "643: #line 963 \"ext/standard/var_unserializer.re\"",
          "645: #line 646 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "685:  goto yy3;",
          "686: yy15:",
          "687:  ++YYCURSOR;",
          "689:  {",
          "691:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "693: }",
          "695: yy17:",
          "696:  yych = *++YYCURSOR;",
          "697:  if (yybm[0+yych] & 128) {",
          "",
          "[Removed Lines]",
          "688: #line 953 \"ext/standard/var_unserializer.re\"",
          "694: #line 695 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "692: #line 957 \"ext/standard/var_unserializer.re\"",
          "698: #line 699 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "703:  goto yy3;",
          "704: yy19:",
          "705:  ++YYCURSOR;",
          "707:  {",
          "709:  ZVAL_NULL(rval);",
          "710:  return 1;",
          "711: }",
          "713: yy21:",
          "714:  yych = *++YYCURSOR;",
          "715:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "706: #line 637 \"ext/standard/var_unserializer.re\"",
          "712: #line 713 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "710: #line 641 \"ext/standard/var_unserializer.re\"",
          "716: #line 717 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "959:  goto yy18;",
          "960: yy63:",
          "961:  ++YYCURSOR;",
          "963:  {",
          "964:  zend_long id;",
          "",
          "[Removed Lines]",
          "962: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "966: #line 590 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "986:  return 1;",
          "987: }",
          "989: yy65:",
          "990:  yych = *++YYCURSOR;",
          "991:  if (yych == '\"') goto yy84;",
          "",
          "[Removed Lines]",
          "988: #line 989 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "992: #line 993 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "996:  goto yy18;",
          "997: yy67:",
          "998:  ++YYCURSOR;",
          "1000:  {",
          "1002:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1003:  return 1;",
          "1004: }",
          "1006: yy69:",
          "1007:  ++YYCURSOR;",
          "1008:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "",
          "[Removed Lines]",
          "999: #line 643 \"ext/standard/var_unserializer.re\"",
          "1005: #line 1006 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1003: #line 647 \"ext/standard/var_unserializer.re\"",
          "1009: #line 1010 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1022:  }",
          "1023: yy71:",
          "1024:  ++YYCURSOR;",
          "1026:  {",
          "1027: #if SIZEOF_ZEND_LONG == 4",
          "1028: use_double:",
          "",
          "[Removed Lines]",
          "1025: #line 691 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1029: #line 695 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1031:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1032:  return 1;",
          "1033: }",
          "1035: yy73:",
          "1036:  yych = *++YYCURSOR;",
          "1037:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1034: #line 1035 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1038: #line 1039 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1053:  goto yy18;",
          "1054: yy76:",
          "1055:  ++YYCURSOR;",
          "1057:  {",
          "1058: #if SIZEOF_ZEND_LONG == 4",
          "1059:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1056: #line 649 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1060: #line 653 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1079:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1080:  return 1;",
          "1081: }",
          "1083: yy78:",
          "1084:  yych = *++YYCURSOR;",
          "1085:  if (yych == '\"') goto yy92;",
          "1086:  goto yy18;",
          "1087: yy79:",
          "1088:  ++YYCURSOR;",
          "1090:  {",
          "1091:  zend_long id;",
          "",
          "[Removed Lines]",
          "1082: #line 1083 \"ext/standard/var_unserializer.c\"",
          "1089: #line 612 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1086: #line 1087 \"ext/standard/var_unserializer.c\"",
          "1093: #line 616 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1112:  return 1;",
          "1113: }",
          "1115: yy81:",
          "1116:  yych = *++YYCURSOR;",
          "1117:  if (yych == '\"') goto yy94;",
          "1118:  goto yy18;",
          "1119: yy82:",
          "1120:  ++YYCURSOR;",
          "1122:  {",
          "1123:  size_t len, len2, len3, maxlen;",
          "1124:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "1121: #line 801 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1118: #line 1119 \"ext/standard/var_unserializer.c\"",
          "1125: #line 805 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1271:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1272: }",
          "1274: yy84:",
          "1275:  ++YYCURSOR;",
          "1277:  {",
          "1278:  size_t len, maxlen;",
          "1279:  zend_string *str;",
          "",
          "[Removed Lines]",
          "1273: #line 1274 \"ext/standard/var_unserializer.c\"",
          "1276: #line 732 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "1280: #line 736 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1307:  ZVAL_STR(rval, str);",
          "1308:  return 1;",
          "1309: }",
          "1311: yy86:",
          "1312:  ++YYCURSOR;",
          "1314:  {",
          "1315:  zend_long elements = parse_iv(start + 2);",
          "1318:     if (!var_hash) return 0;",
          "1321:   return 0;",
          "1322:  }",
          "",
          "[Removed Lines]",
          "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
          "1313: #line 766 \"ext/standard/var_unserializer.re\"",
          "1320:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "1314: #line 1315 \"ext/standard/var_unserializer.c\"",
          "1317: #line 770 \"ext/standard/var_unserializer.re\"",
          "1324:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1335:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1336: }",
          "1338: yy88:",
          "1339:  yych = *++YYCURSOR;",
          "1340:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1337: #line 1338 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1341: #line 1342 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1359:  goto yy18;",
          "1360: yy92:",
          "1361:  ++YYCURSOR;",
          "1363:  {",
          "1364:  long elements;",
          "1365:     if (!var_hash) return 0;",
          "1367:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1369:   return 0;",
          "1370:  }",
          "1371:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1372: }",
          "1374: yy94:",
          "1375:  ++YYCURSOR;",
          "1377:  {",
          "1378:  size_t len, maxlen;",
          "1379:  char *str;",
          "",
          "[Removed Lines]",
          "1362: #line 790 \"ext/standard/var_unserializer.re\"",
          "1368:  if (elements < 0) {",
          "1373: #line 1374 \"ext/standard/var_unserializer.c\"",
          "1376: #line 700 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1366: #line 794 \"ext/standard/var_unserializer.re\"",
          "1372:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1377: #line 1378 \"ext/standard/var_unserializer.c\"",
          "1380: #line 704 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1405:  ZVAL_STRINGL(rval, str, len);",
          "1406:  return 1;",
          "1407: }",
          "1409: yy96:",
          "1410:  yych = *++YYCURSOR;",
          "1411:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1408: #line 1409 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1412: #line 1413 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1413:  goto yy18;",
          "1414: yy97:",
          "1415:  ++YYCURSOR;",
          "1417:  {",
          "",
          "[Removed Lines]",
          "1416: #line 675 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1420: #line 679 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1430:  return 1;",
          "1431: }",
          "1433: }",
          "1437:  return 0;",
          "",
          "[Removed Lines]",
          "1432: #line 1433 \"ext/standard/var_unserializer.c\"",
          "1434: #line 961 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1436: #line 1437 \"ext/standard/var_unserializer.c\"",
          "1438: #line 965 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "507:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "509:  ht = Z_OBJPROP_P(rval);",
          "510:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "511:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "512:   if (has_wakeup) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "510:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "511:   return 0;",
          "512:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "770:     if (!var_hash) return 0;",
          "773:   return 0;",
          "774:  }",
          "",
          "[Removed Lines]",
          "772:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "776:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "792:     if (!var_hash) return 0;",
          "794:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "796:   return 0;",
          "797:  }",
          "798:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "",
          "[Removed Lines]",
          "795:  if (elements < 0) {",
          "",
          "[Added Lines]",
          "799:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fd4025069d561b4196851c2e9a85b5bfdfe1465a",
      "candidate_info": {
        "commit_hash": "fd4025069d561b4196851c2e9a85b5bfdfe1465a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/fd4025069d561b4196851c2e9a85b5bfdfe1465a",
        "files": [
          "Zend/zend_gc.c",
          "Zend/zend_hash.c",
          "Zend/zend_hash.h",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "main/php_variables.c"
        ],
        "message": "Enable HT RC assertions with escape-hatch\n\nHT functions that modify the array now assert that rc=1. As we don't\nrespect this COW constraint everywhere, either for a good reason or\nbecause fixing it would take more work, we provide an escape hatch\nin the form of HT_ALLOW_COW_VIOLATION(ht). If this macro is called\nassertions on this ht are disabled. The macro is a no-op in release\nmode.",
        "before_after_code_files": [
          "Zend/zend_gc.c||Zend/zend_gc.c",
          "Zend/zend_hash.c||Zend/zend_hash.c",
          "Zend/zend_hash.h||Zend/zend_hash.h",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "main/php_variables.c||main/php_variables.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/zend_gc.c||Zend/zend_gc.c": [
          "File: Zend/zend_gc.c -> Zend/zend_gc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1162:     zend_array *arr = (zend_array*)p;",
          "1164:     GC_TYPE(arr) = IS_NULL;",
          "1165:     zend_hash_destroy(arr);",
          "1166:    }",
          "1167:    current = GC_G(next_to_free);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1167:     HT_ALLOW_COW_VIOLATION(arr);",
          "",
          "---------------"
        ],
        "Zend/zend_hash.c||Zend/zend_hash.c": [
          "File: Zend/zend_hash.c -> Zend/zend_hash.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "24: #include \"zend_globals.h\"",
          "25: #include \"zend_variables.h\"",
          "30: #else",
          "32: #endif",
          "34: #define HT_POISONED_PTR ((HashTable *) (intptr_t) -1)",
          "36: #if ZEND_DEBUG",
          "",
          "[Removed Lines]",
          "27: #define HT_DEBUG 0",
          "28: #if HT_DEBUG",
          "29: # define HT_ASSERT(c) ZEND_ASSERT(c)",
          "31: # define HT_ASSERT(c)",
          "",
          "[Added Lines]",
          "27: #if ZEND_DEBUG",
          "28: # define HT_ASSERT(ht, expr) \\",
          "29:  ZEND_ASSERT((expr) || ((ht)->u.flags & HASH_FLAG_ALLOW_COW_VIOLATION))",
          "31: # define HT_ASSERT(ht, expr)",
          "34: #define HT_ASSERT_RC1(ht) HT_ASSERT(ht, GC_REFCOUNT(ht) == 1)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "128: static zend_always_inline void zend_hash_real_init_ex(HashTable *ht, int packed)",
          "129: {",
          "131:  ZEND_ASSERT(!((ht)->u.flags & HASH_FLAG_INITIALIZED));",
          "132:  if (packed) {",
          "133:   HT_SET_DATA_ADDR(ht, pemalloc(HT_SIZE(ht), (ht)->u.flags & HASH_FLAG_PERSISTENT));",
          "",
          "[Removed Lines]",
          "130:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "132:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "157: static zend_always_inline void zend_hash_check_init(HashTable *ht, int packed)",
          "158: {",
          "160:  if (UNEXPECTED(!((ht)->u.flags & HASH_FLAG_INITIALIZED))) {",
          "161:   zend_hash_real_init_ex(ht, packed);",
          "162:  }",
          "",
          "[Removed Lines]",
          "159:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "161:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "186: static void ZEND_FASTCALL zend_hash_packed_grow(HashTable *ht)",
          "187: {",
          "189:  if (ht->nTableSize >= HT_MAX_SIZE) {",
          "190:   zend_error_noreturn(E_ERROR, \"Possible integer overflow in memory allocation (%u * %zu + %zu)\", ht->nTableSize * 2, sizeof(Bucket), sizeof(Bucket));",
          "191:  }",
          "",
          "[Removed Lines]",
          "188:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "190:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "197: {",
          "198:  IS_CONSISTENT(ht);",
          "201:  zend_hash_real_init_ex(ht, packed);",
          "202: }",
          "",
          "[Removed Lines]",
          "200:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "202:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "206:  void *new_data, *old_data = HT_GET_DATA_ADDR(ht);",
          "207:  Bucket *old_buckets = ht->arData;",
          "210:  ht->u.flags &= ~HASH_FLAG_PACKED;",
          "211:  new_data = pemalloc(HT_SIZE_EX(ht->nTableSize, -ht->nTableSize), (ht)->u.flags & HASH_FLAG_PERSISTENT);",
          "212:  ht->nTableMask = -ht->nTableSize;",
          "",
          "[Removed Lines]",
          "209:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "211:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "221:  void *new_data, *old_data = HT_GET_DATA_ADDR(ht);",
          "222:  Bucket *old_buckets = ht->arData;",
          "225:  new_data = pemalloc(HT_SIZE_EX(ht->nTableSize, HT_MIN_MASK), (ht)->u.flags & HASH_FLAG_PERSISTENT);",
          "226:  ht->u.flags |= HASH_FLAG_PACKED | HASH_FLAG_STATIC_KEYS;",
          "227:  ht->nTableMask = HT_MIN_MASK;",
          "",
          "[Removed Lines]",
          "224:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "226:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "242: ZEND_API void ZEND_FASTCALL zend_hash_extend(HashTable *ht, uint32_t nSize, zend_bool packed)",
          "243: {",
          "245:  if (nSize == 0) return;",
          "246:  if (UNEXPECTED(!((ht)->u.flags & HASH_FLAG_INITIALIZED))) {",
          "247:   if (nSize > ht->nTableSize) {",
          "",
          "[Removed Lines]",
          "244:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "246:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "545:  Bucket *p;",
          "547:  IS_CONSISTENT(ht);",
          "550:  if (UNEXPECTED(!(ht->u.flags & HASH_FLAG_INITIALIZED))) {",
          "551:   CHECK_INIT(ht, 0);",
          "",
          "[Removed Lines]",
          "548:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "550:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "708:  Bucket *p;",
          "710:  IS_CONSISTENT(ht);",
          "713:  if (UNEXPECTED(!(ht->u.flags & HASH_FLAG_INITIALIZED))) {",
          "714:   CHECK_INIT(ht, h < ht->nTableSize);",
          "",
          "[Removed Lines]",
          "711:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "713:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "847: {",
          "849:  IS_CONSISTENT(ht);",
          "853:   zend_hash_rehash(ht);",
          "",
          "[Removed Lines]",
          "850:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "852:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1021: ZEND_API void ZEND_FASTCALL zend_hash_del_bucket(HashTable *ht, Bucket *p)",
          "1022: {",
          "1023:  IS_CONSISTENT(ht);",
          "1025:  _zend_hash_del_el(ht, HT_IDX_TO_HASH(p - ht->arData), p);",
          "1026: }",
          "",
          "[Removed Lines]",
          "1024:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1026:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1034:  Bucket *prev = NULL;",
          "1036:  IS_CONSISTENT(ht);",
          "1039:  h = zend_string_hash_val(key);",
          "1040:  nIndex = h | ht->nTableMask;",
          "",
          "[Removed Lines]",
          "1037:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1039:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1065:  Bucket *prev = NULL;",
          "1067:  IS_CONSISTENT(ht);",
          "1070:  h = zend_string_hash_val(key);",
          "1071:  nIndex = h | ht->nTableMask;",
          "",
          "[Removed Lines]",
          "1068:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1070:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1114:  Bucket *prev = NULL;",
          "1116:  IS_CONSISTENT(ht);",
          "1119:  h = zend_inline_hash_func(str, len);",
          "1120:  nIndex = h | ht->nTableMask;",
          "",
          "[Removed Lines]",
          "1117:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1119:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1158:  Bucket *prev = NULL;",
          "1160:  IS_CONSISTENT(ht);",
          "1163:  h = zend_inline_hash_func(str, len);",
          "1164:  nIndex = h | ht->nTableMask;",
          "",
          "[Removed Lines]",
          "1161:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1163:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1187:  Bucket *prev = NULL;",
          "1189:  IS_CONSISTENT(ht);",
          "1192:  if (ht->u.flags & HASH_FLAG_PACKED) {",
          "1193:   if (h < ht->nNumUsed) {",
          "",
          "[Removed Lines]",
          "1190:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1192:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1219:  Bucket *p, *end;",
          "1221:  IS_CONSISTENT(ht);",
          "1224:  if (ht->nNumUsed) {",
          "1225:   p = ht->arData;",
          "",
          "[Removed Lines]",
          "1222:  HT_ASSERT(GC_REFCOUNT(ht) <= 1);",
          "",
          "[Added Lines]",
          "1224:  HT_ASSERT(ht, GC_REFCOUNT(ht) <= 1);",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1281:  Bucket *p, *end;",
          "1283:  IS_CONSISTENT(ht);",
          "1287:  GC_REMOVE_FROM_BUFFER(ht);",
          "",
          "[Removed Lines]",
          "1284:  HT_ASSERT(GC_REFCOUNT(ht) <= 1);",
          "",
          "[Added Lines]",
          "1286:  HT_ASSERT(ht, GC_REFCOUNT(ht) <= 1);",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1334:  Bucket *p, *end;",
          "1336:  IS_CONSISTENT(ht);",
          "1339:  if (ht->nNumUsed) {",
          "1340:   p = ht->arData;",
          "",
          "[Removed Lines]",
          "1337:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1339:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1403:  Bucket *p, *end;",
          "1405:  IS_CONSISTENT(ht);",
          "1408:  if (ht->nNumUsed) {",
          "1409:   p = ht->arData;",
          "",
          "[Removed Lines]",
          "1406:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1408:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1443:  Bucket *p;",
          "1445:  IS_CONSISTENT(ht);",
          "1448:  p = ht->arData;",
          "1449:  for (idx = 0; idx < ht->nNumUsed; idx++, p++) {",
          "",
          "[Removed Lines]",
          "1446:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1448:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1463:  Bucket *p;",
          "1465:  IS_CONSISTENT(ht);",
          "1468:  idx = ht->nNumUsed;",
          "1469:  p = ht->arData + ht->nNumUsed;",
          "",
          "[Removed Lines]",
          "1466:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1468:  HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1505:   result = apply_func(&p->val);",
          "1507:   if (result & ZEND_HASH_APPLY_REMOVE) {",
          "1509:    _zend_hash_del_el(ht, HT_IDX_TO_HASH(idx), p);",
          "1510:   }",
          "1511:   if (result & ZEND_HASH_APPLY_STOP) {",
          "",
          "[Removed Lines]",
          "1508:    HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1510:    HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1531:   result = apply_func(&p->val, argument);",
          "1533:   if (result & ZEND_HASH_APPLY_REMOVE) {",
          "1535:    _zend_hash_del_el(ht, HT_IDX_TO_HASH(idx), p);",
          "1536:   }",
          "1537:   if (result & ZEND_HASH_APPLY_STOP) {",
          "",
          "[Removed Lines]",
          "1534:    HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1536:    HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1564:   result = apply_func(&p->val, num_args, args, &hash_key);",
          "1566:   if (result & ZEND_HASH_APPLY_REMOVE) {",
          "1568:    _zend_hash_del_el(ht, HT_IDX_TO_HASH(idx), p);",
          "1569:   }",
          "1570:   if (result & ZEND_HASH_APPLY_STOP) {",
          "",
          "[Removed Lines]",
          "1567:    HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1569:    HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1596:   result = apply_func(&p->val);",
          "1598:   if (result & ZEND_HASH_APPLY_REMOVE) {",
          "1600:    _zend_hash_del_el(ht, HT_IDX_TO_HASH(idx), p);",
          "1601:   }",
          "1602:   if (result & ZEND_HASH_APPLY_STOP) {",
          "",
          "[Removed Lines]",
          "1599:    HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "1601:    HT_ASSERT_RC1(ht);",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1617:  IS_CONSISTENT(source);",
          "1618:  IS_CONSISTENT(target);",
          "1621:  setTargetPointer = (target->nInternalPointer == HT_INVALID_IDX);",
          "1622:  for (idx = 0; idx < source->nNumUsed; idx++) {",
          "",
          "[Removed Lines]",
          "1619:  HT_ASSERT(GC_REFCOUNT(target) == 1);",
          "",
          "[Added Lines]",
          "1621:  HT_ASSERT_RC1(target);",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1854:  IS_CONSISTENT(source);",
          "1855:  IS_CONSISTENT(target);",
          "1858:  if (overwrite) {",
          "1859:   for (idx = 0; idx < source->nNumUsed; idx++) {",
          "",
          "[Removed Lines]",
          "1856:  HT_ASSERT(GC_REFCOUNT(target) == 1);",
          "",
          "[Added Lines]",
          "1858:  HT_ASSERT_RC1(target);",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "1925:  IS_CONSISTENT(source);",
          "1926:  IS_CONSISTENT(target);",
          "1929:  for (idx = 0; idx < source->nNumUsed; idx++) {",
          "1930:   p = source->arData + idx;",
          "",
          "[Removed Lines]",
          "1927:  HT_ASSERT(GC_REFCOUNT(target) == 1);",
          "",
          "[Added Lines]",
          "1929:  HT_ASSERT_RC1(target);",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "2046:     uint32_t idx;",
          "2048:  IS_CONSISTENT(ht);",
          "2051:  for (idx = 0; idx < ht->nNumUsed; idx++) {",
          "2052:   if (Z_TYPE(ht->arData[idx].val) != IS_UNDEF) {",
          "",
          "[Removed Lines]",
          "2049:  HT_ASSERT(&ht->nInternalPointer != pos || GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "2051:  HT_ASSERT(ht, &ht->nInternalPointer != pos || GC_REFCOUNT(ht) == 1);",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "2066:  uint32_t idx;",
          "2068:  IS_CONSISTENT(ht);",
          "2071:  idx = ht->nNumUsed;",
          "2072:  while (idx > 0) {",
          "",
          "[Removed Lines]",
          "2069:  HT_ASSERT(&ht->nInternalPointer != pos || GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "2071:  HT_ASSERT(ht, &ht->nInternalPointer != pos || GC_REFCOUNT(ht) == 1);",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "2085:  uint32_t idx = *pos;",
          "2087:  IS_CONSISTENT(ht);",
          "2090:  if (idx != HT_INVALID_IDX) {",
          "2091:   while (1) {",
          "",
          "[Removed Lines]",
          "2088:  HT_ASSERT(&ht->nInternalPointer != pos || GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "2090:  HT_ASSERT(ht, &ht->nInternalPointer != pos || GC_REFCOUNT(ht) == 1);",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "2109:  uint32_t idx = *pos;",
          "2111:  IS_CONSISTENT(ht);",
          "2114:  if (idx != HT_INVALID_IDX) {",
          "2115:   while (idx > 0) {",
          "",
          "[Removed Lines]",
          "2112:  HT_ASSERT(&ht->nInternalPointer != pos || GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "2114:  HT_ASSERT(ht, &ht->nInternalPointer != pos || GC_REFCOUNT(ht) == 1);",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "2246:  uint32_t i, j;",
          "2248:  IS_CONSISTENT(ht);",
          "2252:   return SUCCESS;",
          "",
          "[Removed Lines]",
          "2249:  HT_ASSERT(GC_REFCOUNT(ht) == 1);",
          "",
          "[Added Lines]",
          "2251:  HT_ASSERT_RC1(ht);",
          "",
          "---------------"
        ],
        "Zend/zend_hash.h||Zend/zend_hash.h": [
          "File: Zend/zend_hash.h -> Zend/zend_hash.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "41: #define HASH_FLAG_INITIALIZED      (1<<3)",
          "43: #define HASH_FLAG_HAS_EMPTY_IND    (1<<5)",
          "45: #define HT_IS_PACKED(ht) \\",
          "46:  (((ht)->u.flags & HASH_FLAG_PACKED) != 0)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44: #define HASH_FLAG_ALLOW_COW_VIOLATION (1<<6)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "51: #define HT_HAS_STATIC_KEYS_ONLY(ht) \\",
          "52:  (((ht)->u.flags & (HASH_FLAG_PACKED|HASH_FLAG_STATIC_KEYS)) != 0)",
          "54: typedef struct _zend_hash_key {",
          "55:  zend_ulong h;",
          "56:  zend_string *key;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "55: #if ZEND_DEBUG",
          "56: # define HT_ALLOW_COW_VIOLATION(ht) (ht)->u.flags |= HASH_FLAG_ALLOW_COW_VIOLATION",
          "57: #else",
          "58: # define HT_ALLOW_COW_VIOLATION(ht)",
          "59: #endif",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "676: yy2:",
          "677:  ++YYCURSOR;",
          "678: yy3:",
          "680:  { return 0; }",
          "681: #line 682 \"ext/standard/var_unserializer.c\"",
          "682: yy4:",
          "",
          "[Removed Lines]",
          "679: #line 999 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "679: #line 1005 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "725:  goto yy3;",
          "726: yy15:",
          "727:  ++YYCURSOR;",
          "729:  {",
          "731:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "",
          "[Removed Lines]",
          "728: #line 993 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "728: #line 999 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1158:  goto yy18;",
          "1159: yy82:",
          "1160:  ++YYCURSOR;",
          "1162:  {",
          "1163:  size_t len, len2, len3, maxlen;",
          "1164:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1161: #line 841 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1161: #line 847 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1368:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1369:  }",
          "1371:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1372:   return 0;",
          "1373:  }",
          "1375:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1376: }",
          "1378: yy88:",
          "1379:  yych = *++YYCURSOR;",
          "1380:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1377: #line 1378 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1375:  HT_ALLOW_COW_VIOLATION(Z_ARRVAL_P(rval));",
          "1383: #line 1384 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1399:  goto yy18;",
          "1400: yy92:",
          "1401:  ++YYCURSOR;",
          "1403:  {",
          "1404:  long elements;",
          "1405:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1402: #line 830 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1408: #line 836 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1410:  }",
          "1411:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1412: }",
          "1414: yy94:",
          "1415:  ++YYCURSOR;",
          "1416: #line 740 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1413: #line 1414 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1419: #line 1420 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1445:  ZVAL_STRINGL(rval, str, len);",
          "1446:  return 1;",
          "1447: }",
          "1449: yy96:",
          "1450:  yych = *++YYCURSOR;",
          "1451:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1448: #line 1449 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1454: #line 1455 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1470:  return 1;",
          "1471: }",
          "1473: }",
          "1477:  return 0;",
          "",
          "[Removed Lines]",
          "1472: #line 1473 \"ext/standard/var_unserializer.c\"",
          "1474: #line 1001 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1478: #line 1479 \"ext/standard/var_unserializer.c\"",
          "1480: #line 1007 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "820:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "821:  }",
          "823:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "824:   return 0;",
          "825:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "827:  HT_ALLOW_COW_VIOLATION(Z_ARRVAL_P(rval));",
          "",
          "---------------"
        ],
        "main/php_variables.c||main/php_variables.c": [
          "File: main/php_variables.c -> main/php_variables.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "795:  zend_hash_update(&EG(symbol_table), name, &PG(http_globals)[TRACK_VARS_SERVER]);",
          "796:  Z_ADDREF(PG(http_globals)[TRACK_VARS_SERVER]);",
          "799: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "801:  HT_ALLOW_COW_VIOLATION(Z_ARRVAL(PG(http_globals)[TRACK_VARS_SERVER]));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8522e2894edd52322148945261433e79a3ec3f88",
      "candidate_info": {
        "commit_hash": "8522e2894edd52322148945261433e79a3ec3f88",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/8522e2894edd52322148945261433e79a3ec3f88",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Make sure lengths and refs are unsigned in unserialize()",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "361:  unsigned char cursor;",
          "362:  size_t result = 0;",
          "368:  while (1) {",
          "369:   cursor = *p;",
          "370:   if (cursor >= '0' && cursor <= '9') {",
          "",
          "[Removed Lines]",
          "364:  if (*p == '+') {",
          "365:   p++;",
          "366:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "618:  start = cursor;",
          "622: {",
          "623:  YYCTYPE yych;",
          "624:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "621: #line 622 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "617: #line 618 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "676: yy2:",
          "677:  ++YYCURSOR;",
          "678: yy3:",
          "680:  { return 0; }",
          "682: yy4:",
          "683:  yych = *(YYMARKER = ++YYCURSOR);",
          "684:  if (yych == ':') goto yy17;",
          "",
          "[Removed Lines]",
          "679: #line 1005 \"ext/standard/var_unserializer.re\"",
          "681: #line 682 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "675: #line 1001 \"ext/standard/var_unserializer.re\"",
          "677: #line 678 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "725:  goto yy3;",
          "726: yy15:",
          "727:  ++YYCURSOR;",
          "729:  {",
          "731:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "733: }",
          "735: yy17:",
          "736:  yych = *++YYCURSOR;",
          "737:  if (yybm[0+yych] & 128) {",
          "739:  }",
          "741: yy18:",
          "742:  YYCURSOR = YYMARKER;",
          "743:  goto yy3;",
          "744: yy19:",
          "745:  ++YYCURSOR;",
          "747:  {",
          "749:  ZVAL_NULL(rval);",
          "750:  return 1;",
          "751: }",
          "753: yy21:",
          "754:  yych = *++YYCURSOR;",
          "764: yy22:",
          "765:  yych = *++YYCURSOR;",
          "767:  if (yych <= '/') goto yy18;",
          "769:  goto yy18;",
          "770: yy23:",
          "771:  yych = *++YYCURSOR;",
          "773:  if (yych <= '/') goto yy18;",
          "775:  goto yy18;",
          "776: yy24:",
          "777:  yych = *++YYCURSOR;",
          "778:  if (yych <= '/') goto yy18;",
          "780:  goto yy18;",
          "781: yy25:",
          "782:  yych = *++YYCURSOR;",
          "783:  if (yych <= '/') {",
          "784:   if (yych <= ',') {",
          "786:    goto yy18;",
          "787:   } else {",
          "790:    goto yy18;",
          "791:   }",
          "792:  } else {",
          "793:   if (yych <= 'I') {",
          "795:    if (yych <= 'H') goto yy18;",
          "797:   } else {",
          "799:    goto yy18;",
          "800:   }",
          "801:  }",
          "802: yy26:",
          "803:  yych = *++YYCURSOR;",
          "804:  if (yych <= ',') {",
          "806:   goto yy18;",
          "807:  } else {",
          "809:   if (yych <= '/') goto yy18;",
          "811:   goto yy18;",
          "812:  }",
          "813: yy27:",
          "814:  yych = *++YYCURSOR;",
          "824: yy28:",
          "825:  yych = *++YYCURSOR;",
          "835: yy29:",
          "836:  yych = *++YYCURSOR;",
          "838:  if (yych <= '/') goto yy18;",
          "840:  goto yy18;",
          "841: yy30:",
          "848:  ++YYCURSOR;",
          "849:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "850:  yych = *YYCURSOR;",
          "851:  if (yybm[0+yych] & 128) {",
          "853:  }",
          "854:  if (yych <= '/') goto yy18;",
          "856:  goto yy18;",
          "862:  ++YYCURSOR;",
          "863:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "864:  yych = *YYCURSOR;",
          "865:  if (yych <= '/') goto yy18;",
          "868:  goto yy18;",
          "874:  ++YYCURSOR;",
          "875:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "876:  yych = *YYCURSOR;",
          "877:  if (yych <= '/') goto yy18;",
          "880:  goto yy18;",
          "886:  ++YYCURSOR;",
          "887:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "888:  yych = *YYCURSOR;",
          "889:  if (yych <= '/') goto yy18;",
          "892:  goto yy18;",
          "894:  yych = *++YYCURSOR;",
          "896:  goto yy18;",
          "898:  yych = *++YYCURSOR;",
          "900:  if (yych <= '/') goto yy18;",
          "902:  goto yy18;",
          "904:  yych = *++YYCURSOR;",
          "905:  if (yych <= '/') {",
          "906:   if (yych != '.') goto yy18;",
          "907:  } else {",
          "910:   goto yy18;",
          "911:  }",
          "913:  yych = *++YYCURSOR;",
          "914:  if (yych <= '/') goto yy18;",
          "916:  goto yy18;",
          "918:  ++YYCURSOR;",
          "919:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "920:  yych = *YYCURSOR;",
          "921:  if (yych <= ':') {",
          "922:   if (yych <= '.') {",
          "923:    if (yych <= '-') goto yy18;",
          "925:   } else {",
          "926:    if (yych <= '/') goto yy18;",
          "928:    goto yy18;",
          "929:   }",
          "930:  } else {",
          "931:   if (yych <= 'E') {",
          "933:    if (yych <= 'D') goto yy18;",
          "935:   } else {",
          "937:    goto yy18;",
          "938:   }",
          "939:  }",
          "941:  yych = *++YYCURSOR;",
          "943:  goto yy18;",
          "945:  yych = *++YYCURSOR;",
          "947:  goto yy18;",
          "949:  yych = *++YYCURSOR;",
          "950:  if (yych <= '/') goto yy18;",
          "951:  if (yych >= ':') goto yy18;",
          "953:  ++YYCURSOR;",
          "954:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "955:  yych = *YYCURSOR;",
          "956:  if (yych <= '/') goto yy18;",
          "959:  goto yy18;",
          "965:  ++YYCURSOR;",
          "966:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "967:  yych = *YYCURSOR;",
          "968:  if (yych <= '/') goto yy18;",
          "971:  goto yy18;",
          "977:  ++YYCURSOR;",
          "978:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "979:  yych = *YYCURSOR;",
          "980:  if (yych <= '/') goto yy18;",
          "983:  goto yy18;",
          "989:  ++YYCURSOR;",
          "990:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "991:  yych = *YYCURSOR;",
          "992:  if (yych <= '/') goto yy18;",
          "995:  goto yy18;",
          "997:  yych = *++YYCURSOR;",
          "999:  goto yy18;",
          "1001:  ++YYCURSOR;",
          "1003:  {",
          "1004:  zend_long id;",
          "1007:  if (!var_hash) return 0;",
          "1010:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1011:   return 0;",
          "1012:  }",
          "",
          "[Removed Lines]",
          "728: #line 999 \"ext/standard/var_unserializer.re\"",
          "734: #line 735 \"ext/standard/var_unserializer.c\"",
          "738:   goto yy31;",
          "740:  if (yych == '+') goto yy30;",
          "746: #line 677 \"ext/standard/var_unserializer.re\"",
          "752: #line 753 \"ext/standard/var_unserializer.c\"",
          "755:  if (yych <= ',') {",
          "756:   if (yych == '+') goto yy33;",
          "757:   goto yy18;",
          "758:  } else {",
          "759:   if (yych <= '-') goto yy33;",
          "760:   if (yych <= '/') goto yy18;",
          "761:   if (yych <= '9') goto yy34;",
          "762:   goto yy18;",
          "763:  }",
          "766:  if (yych == '+') goto yy36;",
          "768:  if (yych <= '9') goto yy37;",
          "772:  if (yych == '+') goto yy39;",
          "774:  if (yych <= '9') goto yy40;",
          "779:  if (yych <= '1') goto yy42;",
          "785:    if (yych == '+') goto yy43;",
          "788:    if (yych <= '-') goto yy44;",
          "789:    if (yych <= '.') goto yy45;",
          "794:    if (yych <= '9') goto yy46;",
          "796:    goto yy48;",
          "798:    if (yych == 'N') goto yy49;",
          "805:   if (yych == '+') goto yy50;",
          "808:   if (yych <= '-') goto yy50;",
          "810:   if (yych <= '9') goto yy51;",
          "815:  if (yych <= ',') {",
          "816:   if (yych == '+') goto yy53;",
          "817:   goto yy18;",
          "818:  } else {",
          "819:   if (yych <= '-') goto yy53;",
          "820:   if (yych <= '/') goto yy18;",
          "821:   if (yych <= '9') goto yy54;",
          "822:   goto yy18;",
          "823:  }",
          "826:  if (yych <= ',') {",
          "827:   if (yych == '+') goto yy56;",
          "828:   goto yy18;",
          "829:  } else {",
          "830:   if (yych <= '-') goto yy56;",
          "831:   if (yych <= '/') goto yy18;",
          "832:   if (yych <= '9') goto yy57;",
          "833:   goto yy18;",
          "834:  }",
          "837:  if (yych == '+') goto yy59;",
          "839:  if (yych <= '9') goto yy60;",
          "842:  yych = *++YYCURSOR;",
          "843:  if (yybm[0+yych] & 128) {",
          "844:   goto yy31;",
          "845:  }",
          "846:  goto yy18;",
          "847: yy31:",
          "852:   goto yy31;",
          "855:  if (yych <= ':') goto yy62;",
          "857: yy33:",
          "858:  yych = *++YYCURSOR;",
          "859:  if (yych <= '/') goto yy18;",
          "860:  if (yych >= ':') goto yy18;",
          "861: yy34:",
          "866:  if (yych <= '9') goto yy34;",
          "867:  if (yych == ';') goto yy63;",
          "869: yy36:",
          "870:  yych = *++YYCURSOR;",
          "871:  if (yych <= '/') goto yy18;",
          "872:  if (yych >= ':') goto yy18;",
          "873: yy37:",
          "878:  if (yych <= '9') goto yy37;",
          "879:  if (yych <= ':') goto yy65;",
          "881: yy39:",
          "882:  yych = *++YYCURSOR;",
          "883:  if (yych <= '/') goto yy18;",
          "884:  if (yych >= ':') goto yy18;",
          "885: yy40:",
          "890:  if (yych <= '9') goto yy40;",
          "891:  if (yych <= ':') goto yy66;",
          "893: yy42:",
          "895:  if (yych == ';') goto yy67;",
          "897: yy43:",
          "899:  if (yych == '.') goto yy45;",
          "901:  if (yych <= '9') goto yy46;",
          "903: yy44:",
          "908:   if (yych <= '9') goto yy46;",
          "909:   if (yych == 'I') goto yy48;",
          "912: yy45:",
          "915:  if (yych <= '9') goto yy69;",
          "917: yy46:",
          "924:    goto yy69;",
          "927:    if (yych <= '9') goto yy46;",
          "932:    if (yych <= ';') goto yy71;",
          "934:    goto yy73;",
          "936:    if (yych == 'e') goto yy73;",
          "940: yy48:",
          "942:  if (yych == 'N') goto yy74;",
          "944: yy49:",
          "946:  if (yych == 'A') goto yy75;",
          "948: yy50:",
          "952: yy51:",
          "957:  if (yych <= '9') goto yy51;",
          "958:  if (yych == ';') goto yy76;",
          "960: yy53:",
          "961:  yych = *++YYCURSOR;",
          "962:  if (yych <= '/') goto yy18;",
          "963:  if (yych >= ':') goto yy18;",
          "964: yy54:",
          "969:  if (yych <= '9') goto yy54;",
          "970:  if (yych <= ':') goto yy78;",
          "972: yy56:",
          "973:  yych = *++YYCURSOR;",
          "974:  if (yych <= '/') goto yy18;",
          "975:  if (yych >= ':') goto yy18;",
          "976: yy57:",
          "981:  if (yych <= '9') goto yy57;",
          "982:  if (yych == ';') goto yy79;",
          "984: yy59:",
          "985:  yych = *++YYCURSOR;",
          "986:  if (yych <= '/') goto yy18;",
          "987:  if (yych >= ':') goto yy18;",
          "988: yy60:",
          "993:  if (yych <= '9') goto yy60;",
          "994:  if (yych <= ':') goto yy81;",
          "996: yy62:",
          "998:  if (yych == '\"') goto yy82;",
          "1000: yy63:",
          "1002: #line 626 \"ext/standard/var_unserializer.re\"",
          "1009:  id = parse_iv(start + 2) - 1;",
          "",
          "[Added Lines]",
          "724: #line 995 \"ext/standard/var_unserializer.re\"",
          "730: #line 731 \"ext/standard/var_unserializer.c\"",
          "734:   goto yy30;",
          "741: #line 673 \"ext/standard/var_unserializer.re\"",
          "747: #line 748 \"ext/standard/var_unserializer.c\"",
          "750:  if (yych <= '/') goto yy18;",
          "751:  if (yych <= '9') goto yy32;",
          "752:  goto yy18;",
          "756:  if (yych <= '9') goto yy34;",
          "761:  if (yych <= '9') goto yy36;",
          "766:  if (yych <= '1') goto yy38;",
          "772:    if (yych == '+') goto yy39;",
          "775:    if (yych <= '-') goto yy40;",
          "776:    if (yych <= '.') goto yy41;",
          "781:    if (yych <= '9') goto yy42;",
          "783:    goto yy44;",
          "785:    if (yych == 'N') goto yy45;",
          "792:   if (yych == '+') goto yy46;",
          "795:   if (yych <= '-') goto yy46;",
          "797:   if (yych <= '9') goto yy47;",
          "802:  if (yych <= '/') goto yy18;",
          "803:  if (yych <= '9') goto yy49;",
          "804:  goto yy18;",
          "807:  if (yych <= '/') goto yy18;",
          "808:  if (yych <= '9') goto yy51;",
          "809:  goto yy18;",
          "813:  if (yych <= '9') goto yy53;",
          "820:   goto yy30;",
          "823:  if (yych <= ':') goto yy55;",
          "825: yy32:",
          "830:  if (yych <= '9') goto yy32;",
          "831:  if (yych == ';') goto yy56;",
          "833: yy34:",
          "838:  if (yych <= '9') goto yy34;",
          "839:  if (yych <= ':') goto yy58;",
          "841: yy36:",
          "846:  if (yych <= '9') goto yy36;",
          "847:  if (yych <= ':') goto yy59;",
          "849: yy38:",
          "851:  if (yych == ';') goto yy60;",
          "853: yy39:",
          "855:  if (yych == '.') goto yy41;",
          "857:  if (yych <= '9') goto yy42;",
          "859: yy40:",
          "864:   if (yych <= '9') goto yy42;",
          "865:   if (yych == 'I') goto yy44;",
          "868: yy41:",
          "871:  if (yych <= '9') goto yy62;",
          "873: yy42:",
          "880:    goto yy62;",
          "883:    if (yych <= '9') goto yy42;",
          "888:    if (yych <= ';') goto yy64;",
          "890:    goto yy66;",
          "892:    if (yych == 'e') goto yy66;",
          "896: yy44:",
          "898:  if (yych == 'N') goto yy67;",
          "900: yy45:",
          "902:  if (yych == 'A') goto yy68;",
          "904: yy46:",
          "908: yy47:",
          "913:  if (yych <= '9') goto yy47;",
          "914:  if (yych == ';') goto yy69;",
          "916: yy49:",
          "921:  if (yych <= '9') goto yy49;",
          "922:  if (yych <= ':') goto yy71;",
          "924: yy51:",
          "929:  if (yych <= '9') goto yy51;",
          "930:  if (yych == ';') goto yy72;",
          "932: yy53:",
          "937:  if (yych <= '9') goto yy53;",
          "938:  if (yych <= ':') goto yy74;",
          "940: yy55:",
          "942:  if (yych == '\"') goto yy75;",
          "944: yy56:",
          "946: #line 622 \"ext/standard/var_unserializer.re\"",
          "953:  id = parse_uiv(start + 2) - 1;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1026:  return 1;",
          "1027: }",
          "1030:  yych = *++YYCURSOR;",
          "1032:  goto yy18;",
          "1034:  yych = *++YYCURSOR;",
          "1036:  goto yy18;",
          "1038:  ++YYCURSOR;",
          "1040:  {",
          "1042:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1043:  return 1;",
          "1044: }",
          "1047:  ++YYCURSOR;",
          "1048:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "1049:  yych = *YYCURSOR;",
          "1050:  if (yych <= ';') {",
          "1051:   if (yych <= '/') goto yy18;",
          "1053:   if (yych <= ':') goto yy18;",
          "1054:  } else {",
          "1055:   if (yych <= 'E') {",
          "1056:    if (yych <= 'D') goto yy18;",
          "1058:   } else {",
          "1060:    goto yy18;",
          "1061:   }",
          "1062:  }",
          "1064:  ++YYCURSOR;",
          "1066:  {",
          "1067: #if SIZEOF_ZEND_LONG == 4",
          "1068: use_double:",
          "",
          "[Removed Lines]",
          "1028: #line 1029 \"ext/standard/var_unserializer.c\"",
          "1029: yy65:",
          "1031:  if (yych == '\"') goto yy84;",
          "1033: yy66:",
          "1035:  if (yych == '{') goto yy86;",
          "1037: yy67:",
          "1039: #line 683 \"ext/standard/var_unserializer.re\"",
          "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
          "1046: yy69:",
          "1052:   if (yych <= '9') goto yy69;",
          "1057:    goto yy73;",
          "1059:    if (yych == 'e') goto yy73;",
          "1063: yy71:",
          "1065: #line 731 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "972: #line 973 \"ext/standard/var_unserializer.c\"",
          "973: yy58:",
          "975:  if (yych == '\"') goto yy77;",
          "977: yy59:",
          "979:  if (yych == '{') goto yy79;",
          "981: yy60:",
          "983: #line 679 \"ext/standard/var_unserializer.re\"",
          "989: #line 990 \"ext/standard/var_unserializer.c\"",
          "990: yy62:",
          "996:   if (yych <= '9') goto yy62;",
          "1001:    goto yy66;",
          "1003:    if (yych == 'e') goto yy66;",
          "1007: yy64:",
          "1009: #line 727 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1071:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1072:  return 1;",
          "1073: }",
          "1076:  yych = *++YYCURSOR;",
          "1077:  if (yych <= ',') {",
          "1079:   goto yy18;",
          "1080:  } else {",
          "1082:   if (yych <= '/') goto yy18;",
          "1084:   goto yy18;",
          "1085:  }",
          "1087:  yych = *++YYCURSOR;",
          "1089:  goto yy18;",
          "1091:  yych = *++YYCURSOR;",
          "1093:  goto yy18;",
          "1095:  ++YYCURSOR;",
          "1097:  {",
          "1098: #if SIZEOF_ZEND_LONG == 4",
          "1099:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "1075: yy73:",
          "1078:   if (yych == '+') goto yy88;",
          "1081:   if (yych <= '-') goto yy88;",
          "1083:   if (yych <= '9') goto yy89;",
          "1086: yy74:",
          "1088:  if (yych == 'F') goto yy91;",
          "1090: yy75:",
          "1092:  if (yych == 'N') goto yy91;",
          "1094: yy76:",
          "1096: #line 689 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1018: #line 1019 \"ext/standard/var_unserializer.c\"",
          "1019: yy66:",
          "1022:   if (yych == '+') goto yy81;",
          "1025:   if (yych <= '-') goto yy81;",
          "1027:   if (yych <= '9') goto yy82;",
          "1030: yy67:",
          "1032:  if (yych == 'F') goto yy84;",
          "1034: yy68:",
          "1036:  if (yych == 'N') goto yy84;",
          "1038: yy69:",
          "1040: #line 685 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1119:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1120:  return 1;",
          "1121: }",
          "1124:  yych = *++YYCURSOR;",
          "1126:  goto yy18;",
          "1128:  ++YYCURSOR;",
          "1130:  {",
          "1131:  zend_long id;",
          "1134:  if (!var_hash) return 0;",
          "1137:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1138:   return 0;",
          "1139:  }",
          "",
          "[Removed Lines]",
          "1122: #line 1123 \"ext/standard/var_unserializer.c\"",
          "1123: yy78:",
          "1125:  if (yych == '\"') goto yy92;",
          "1127: yy79:",
          "1129: #line 652 \"ext/standard/var_unserializer.re\"",
          "1136:  id = parse_iv(start + 2) - 1;",
          "",
          "[Added Lines]",
          "1066: #line 1067 \"ext/standard/var_unserializer.c\"",
          "1067: yy71:",
          "1069:  if (yych == '\"') goto yy85;",
          "1071: yy72:",
          "1073: #line 648 \"ext/standard/var_unserializer.re\"",
          "1080:  id = parse_uiv(start + 2) - 1;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1152:  return 1;",
          "1153: }",
          "1156:  yych = *++YYCURSOR;",
          "1158:  goto yy18;",
          "1160:  ++YYCURSOR;",
          "1162:  {",
          "1163:  size_t len, len2, len3, maxlen;",
          "1164:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1154: #line 1155 \"ext/standard/var_unserializer.c\"",
          "1155: yy81:",
          "1157:  if (yych == '\"') goto yy94;",
          "1159: yy82:",
          "1161: #line 847 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1098: #line 1099 \"ext/standard/var_unserializer.c\"",
          "1099: yy74:",
          "1101:  if (yych == '\"') goto yy87;",
          "1103: yy75:",
          "1105: #line 843 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1311:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1312: }",
          "1315:  ++YYCURSOR;",
          "1317:  {",
          "1318:  size_t len, maxlen;",
          "1319:  zend_string *str;",
          "",
          "[Removed Lines]",
          "1313: #line 1314 \"ext/standard/var_unserializer.c\"",
          "1314: yy84:",
          "1316: #line 772 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1257: #line 1258 \"ext/standard/var_unserializer.c\"",
          "1258: yy77:",
          "1260: #line 768 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1347:  ZVAL_STR(rval, str);",
          "1348:  return 1;",
          "1349: }",
          "1352:  ++YYCURSOR;",
          "1354:  {",
          "1355:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "1350: #line 1351 \"ext/standard/var_unserializer.c\"",
          "1351: yy86:",
          "1353: #line 806 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1294: #line 1295 \"ext/standard/var_unserializer.c\"",
          "1295: yy79:",
          "1297: #line 802 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1381:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1382: }",
          "1385:  yych = *++YYCURSOR;",
          "1386:  if (yych <= '/') goto yy18;",
          "1387:  if (yych >= ':') goto yy18;",
          "1389:  ++YYCURSOR;",
          "1390:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1391:  yych = *YYCURSOR;",
          "1392:  if (yych <= '/') goto yy18;",
          "1395:  goto yy18;",
          "1397:  yych = *++YYCURSOR;",
          "1399:  goto yy18;",
          "1401:  ++YYCURSOR;",
          "1403:  {",
          "1404:  long elements;",
          "1405:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1383: #line 1384 \"ext/standard/var_unserializer.c\"",
          "1384: yy88:",
          "1388: yy89:",
          "1393:  if (yych <= '9') goto yy89;",
          "1394:  if (yych == ';') goto yy71;",
          "1396: yy91:",
          "1398:  if (yych == ';') goto yy96;",
          "1400: yy92:",
          "1402: #line 836 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1327: #line 1328 \"ext/standard/var_unserializer.c\"",
          "1328: yy81:",
          "1332: yy82:",
          "1337:  if (yych <= '9') goto yy82;",
          "1338:  if (yych == ';') goto yy64;",
          "1340: yy84:",
          "1342:  if (yych == ';') goto yy89;",
          "1344: yy85:",
          "1346: #line 832 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1410:  }",
          "1411:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1412: }",
          "1415:  ++YYCURSOR;",
          "1417:  {",
          "1418:  size_t len, maxlen;",
          "1419:  char *str;",
          "",
          "[Removed Lines]",
          "1413: #line 1414 \"ext/standard/var_unserializer.c\"",
          "1414: yy94:",
          "1416: #line 740 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1357: #line 1358 \"ext/standard/var_unserializer.c\"",
          "1358: yy87:",
          "1360: #line 736 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1445:  ZVAL_STRINGL(rval, str, len);",
          "1446:  return 1;",
          "1447: }",
          "1450:  ++YYCURSOR;",
          "1452:  {",
          "",
          "[Removed Lines]",
          "1448: #line 1449 \"ext/standard/var_unserializer.c\"",
          "1449: yy96:",
          "1451: #line 715 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1392: #line 1393 \"ext/standard/var_unserializer.c\"",
          "1393: yy89:",
          "1395: #line 711 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1465:  return 1;",
          "1466: }",
          "1468: }",
          "1472:  return 0;",
          "",
          "[Removed Lines]",
          "1467: #line 1468 \"ext/standard/var_unserializer.c\"",
          "1469: #line 1007 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1411: #line 1412 \"ext/standard/var_unserializer.c\"",
          "1413: #line 1003 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "320: iv = [+-]? [0-9]+;",
          "321: nv = [+-]? ([0-9]* \".\" [0-9]+|[0-9]+ \".\" [0-9]*);",
          "322: nvexp = (iv | nv) [eE] iv;",
          "",
          "[Removed Lines]",
          "319: uiv = [+]? [0-9]+;",
          "",
          "[Added Lines]",
          "319: uiv = [0-9]+;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "365:  unsigned char cursor;",
          "366:  size_t result = 0;",
          "372:  while (1) {",
          "373:   cursor = *p;",
          "374:   if (cursor >= '0' && cursor <= '9') {",
          "",
          "[Removed Lines]",
          "368:  if (*p == '+') {",
          "369:   p++;",
          "370:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "627:  zend_long id;",
          "630:  if (!var_hash) return 0;",
          "633:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "634:   return 0;",
          "635:  }",
          "",
          "[Removed Lines]",
          "626: \"R:\" iv \";\"  {",
          "632:  id = parse_iv(start + 2) - 1;",
          "",
          "[Added Lines]",
          "622: \"R:\" uiv \";\"  {",
          "628:  id = parse_uiv(start + 2) - 1;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "649:  return 1;",
          "650: }",
          "653:  zend_long id;",
          "656:  if (!var_hash) return 0;",
          "659:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "660:   return 0;",
          "661:  }",
          "",
          "[Removed Lines]",
          "652: \"r:\" iv \";\"  {",
          "658:  id = parse_iv(start + 2) - 1;",
          "",
          "[Added Lines]",
          "648: \"r:\" uiv \";\"  {",
          "654:  id = parse_uiv(start + 2) - 1;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "833:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "834: }",
          "837:  long elements;",
          "838:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "836: \"o:\" iv \":\" [\"] {",
          "",
          "[Added Lines]",
          "832: \"o:\" uiv \":\" [\"] {",
          "",
          "---------------"
        ]
      }
    }
  ]
}