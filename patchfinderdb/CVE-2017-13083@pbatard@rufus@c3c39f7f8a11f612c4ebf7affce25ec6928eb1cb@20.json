{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "91c950dba97aa971ac2c0f1a4be62467fa9923d1",
      "candidate_info": {
        "commit_hash": "91c950dba97aa971ac2c0f1a4be62467fa9923d1",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/91c950dba97aa971ac2c0f1a4be62467fa9923d1",
        "files": [
          "res/uefi/readme.txt",
          "res/uefi/uefi-ntfs.img",
          "src/rufus.rc"
        ],
        "message": "[uefi] add ARM64 support to UEFI:NTFS\n\n* Also update EfiFs NTFS drivers to latest, including compression support",
        "before_after_code_files": [
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1259\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1260\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "373: VS_VERSION_INFO VERSIONINFO",
          "376:  FILEFLAGSMASK 0x3fL",
          "377: #ifdef _DEBUG",
          "378:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "374:  FILEVERSION 3,0,1259,0",
          "375:  PRODUCTVERSION 3,0,1259,0",
          "",
          "[Added Lines]",
          "374:  FILEVERSION 3,0,1260,0",
          "375:  PRODUCTVERSION 3,0,1260,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "389:         BEGIN",
          "390:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "391:             VALUE \"FileDescription\", \"Rufus\"",
          "393:             VALUE \"InternalName\", \"Rufus\"",
          "394:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "395:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "396:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "397:             VALUE \"ProductName\", \"Rufus\"",
          "399:         END",
          "400:     END",
          "401:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "392:             VALUE \"FileVersion\", \"3.0.1259\"",
          "398:             VALUE \"ProductVersion\", \"3.0.1259\"",
          "",
          "[Added Lines]",
          "392:             VALUE \"FileVersion\", \"3.0.1260\"",
          "398:             VALUE \"ProductVersion\", \"3.0.1260\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9545123711096d28e0ac75281e4735370b18a485",
      "candidate_info": {
        "commit_hash": "9545123711096d28e0ac75281e4735370b18a485",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/9545123711096d28e0ac75281e4735370b18a485",
        "files": [
          "src/drive.c",
          "src/drive.h",
          "src/rufus.rc"
        ],
        "message": "[core] eliminate querying of floppy drives during enumeration",
        "before_after_code_files": [
          "src/drive.c||src/drive.c",
          "src/drive.h||src/drive.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/drive.c||src/drive.c": [
          "File: src/drive.c -> src/drive.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "53:  { 0xc12a7328L, 0xf81f, 0x11d2, {0xba, 0x4b, 0x00, 0xa0, 0xc9, 0x3e, 0xc9, 0x3b} };",
          "54: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "56: PF_TYPE_DECL(NTAPI, NTSTATUS, NtQueryVolumeInformationFile, (HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG, FS_INFORMATION_CLASS));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "401:  BOOL r = FALSE;",
          "402:  HANDLE hDrive = INVALID_HANDLE_VALUE;",
          "403:  UINT _drive_type;",
          "404:  int i = 0, drive_number;",
          "406:  char logical_drive[] = \"\\\\\\\\.\\\\#:\";",
          "408:  if (drive_letters != NULL)",
          "409:   drive_letters[0] = 0;",
          "410:  if (drive_type != NULL)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "406:  IO_STATUS_BLOCK io_status_block;",
          "407:  FILE_FS_DEVICE_INFORMATION file_fs_device_info;",
          "412:  PF_INIT(NtQueryVolumeInformationFile, Ntdll);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "451:    continue;",
          "452:   }",
          "454:   drive_number = GetDriveNumber(hDrive, logical_drive);",
          "455:   safe_closehandle(hDrive);",
          "456:   if (drive_number == DriveIndex) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "461:   if ((pfNtQueryVolumeInformationFile != NULL) &&",
          "462:    (pfNtQueryVolumeInformationFile(hDrive, &io_status_block, &file_fs_device_info,",
          "463:     sizeof(file_fs_device_info), FileFsDeviceInformation) == NO_ERROR) &&",
          "464:    (file_fs_device_info.Characteristics & FILE_FLOPPY_DISKETTE) ) {",
          "465:     continue;",
          "466:   }",
          "",
          "---------------"
        ],
        "src/drive.h||src/drive.h": [
          "File: src/drive.h -> src/drive.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: #include <windows.h>",
          "21: #include <stdint.h>",
          "24: #pragma once",
          "",
          "[Removed Lines]",
          "22: #include <winioctl.h>    // for DISK_GEOMETRY",
          "",
          "[Added Lines]",
          "22: #include <winioctl.h>   // for DISK_GEOMETRY",
          "23: #include <winternl.h>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "31: #define IOCTL_MOUNTMGR_SET_AUTO_MOUNT       \\",
          "32:  CTL_CODE(MOUNTMGRCONTROLTYPE, 16, METHOD_BUFFERED, FILE_READ_ACCESS | FILE_WRITE_ACCESS)",
          "40: typedef struct {",
          "",
          "[Removed Lines]",
          "34: #define XP_MSR       0x01",
          "35: #define XP_EFI       0x02",
          "36: #define XP_UEFI_NTFS 0x04",
          "37: #define XP_COMPAT    0x08",
          "",
          "[Added Lines]",
          "35: #define XP_MSR                              0x01",
          "36: #define XP_EFI                              0x02",
          "37: #define XP_UEFI_NTFS                        0x04",
          "38: #define XP_COMPAT                           0x08",
          "40: #define FILE_FLOPPY_DISKETTE                0x00000004",
          "42: #if !defined(__MINGW32__)",
          "43: typedef enum _FSINFOCLASS {",
          "44:  FileFsVolumeInformation = 1,",
          "45:  FileFsLabelInformation,",
          "46:  FileFsSizeInformation,",
          "47:  FileFsDeviceInformation,",
          "48:  FileFsAttributeInformation,",
          "49:  FileFsControlInformation,",
          "50:  FileFsFullSizeInformation,",
          "51:  FileFsObjectIdInformation,",
          "52:  FileFsDriverPathInformation,",
          "53:  FileFsVolumeFlagsInformation,",
          "54:  FileFsMaximumInformation",
          "55: } FS_INFORMATION_CLASS, *PFS_INFORMATION_CLASS;",
          "56: #endif",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "49:  DISK_EXTENT Extents[8];",
          "50: } VOLUME_DISK_EXTENTS_REDEF;",
          "52: static __inline BOOL UnlockDrive(HANDLE hDrive) {",
          "53:  DWORD size;",
          "54:  return DeviceIoControl(hDrive, FSCTL_UNLOCK_VOLUME, NULL, 0, NULL, 0, &size, NULL);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: #if !defined(__MINGW32__)",
          "72: typedef struct _FILE_FS_DEVICE_INFORMATION {",
          "73:  DEVICE_TYPE DeviceType;",
          "74:  ULONG Characteristics;",
          "75: } FILE_FS_DEVICE_INFORMATION, *PFILE_FS_DEVICE_INFORMATION;",
          "76: #endif",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1238\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1239\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "373: VS_VERSION_INFO VERSIONINFO",
          "376:  FILEFLAGSMASK 0x3fL",
          "377: #ifdef _DEBUG",
          "378:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "374:  FILEVERSION 2,18,1238,0",
          "375:  PRODUCTVERSION 2,18,1238,0",
          "",
          "[Added Lines]",
          "374:  FILEVERSION 2,18,1239,0",
          "375:  PRODUCTVERSION 2,18,1239,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "389:         BEGIN",
          "390:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "391:             VALUE \"FileDescription\", \"Rufus\"",
          "393:             VALUE \"InternalName\", \"Rufus\"",
          "394:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "395:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "396:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "397:             VALUE \"ProductName\", \"Rufus\"",
          "399:         END",
          "400:     END",
          "401:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1238\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1238\"",
          "",
          "[Added Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1239\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1239\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "16cddefff9bf433046106f989e3f74a0c5aa7e9e",
      "candidate_info": {
        "commit_hash": "16cddefff9bf433046106f989e3f74a0c5aa7e9e",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/16cddefff9bf433046106f989e3f74a0c5aa7e9e",
        "files": [
          "ChangeLog.txt",
          "appveyor.yml",
          "res/localization/translation_check.py",
          "src/rufus.rc"
        ],
        "message": "[internal] improve AppVeyor build handling\n\n* Also fix some typos",
        "before_after_code_files": [
          "res/localization/translation_check.py||res/localization/translation_check.py",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/translation_check.py||res/localization/translation_check.py": [
          "File: res/localization/translation_check.py -> res/localization/translation_check.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: # -*- coding=utf-8 -*-",
          "4: # LIMITATIONS",
          "6: # it assumes the first language in rufus.loc in English",
          "7: # written for 1.0.23, things may have changes since then",
          "8: # horrible code below",
          "",
          "[Removed Lines]",
          "5: # this script was written as fast as possbile so it is broken/minimalistic:",
          "",
          "[Added Lines]",
          "5: # this script was written as fast as possible so it is broken/minimalistic:",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.1.1320\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.1.1321\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,1,1320,0",
          "393:  PRODUCTVERSION 3,1,1320,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,1,1321,0",
          "393:  PRODUCTVERSION 3,1,1321,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1320\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1320\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1321\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1321\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f89f97d4abfb7033d771ae0c943d6b541c56862b",
      "candidate_info": {
        "commit_hash": "f89f97d4abfb7033d771ae0c943d6b541c56862b",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/f89f97d4abfb7033d771ae0c943d6b541c56862b",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Dutch translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "4248: ################################################################################",
          "4249: l \"nl-NL\" \"Dutch (Nederlands)\" 0x0413, 0x0813",
          "4251: b \"en-US\"",
          "4253: # Main dialog",
          "",
          "[Removed Lines]",
          "4250: v 1.0.21",
          "",
          "[Added Lines]",
          "4250: v 1.0.22",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4535: # Tooltips",
          "4536: # Partition Scheme and Target Type",
          "4537: t MSG_150 \"Normaal gesproken de veiligste keuze. Als u een UEFI computer hebt maar u wilt \"",
          "4539: t MSG_151 \"Gebruik deze optie als u een besturingssysteem in EFI mode wilt installeren, maar toegang nodig hebt tot\\n\"",
          "4541: t MSG_152 \"Aanbevolen optie om een besturingssysteem in EFI mode te installeren en wanneer USB toegang niet nodig is voor Windows XP\"",
          "4542: t MSG_153 \"Test patroon: 0x%02X\"",
          "4543: t MSG_154 \"Test patroon: 0x%02X, 0x%02X\"",
          "",
          "[Removed Lines]",
          "4538:          \"\\neen besturingssysteem in EFI mode installeren, selecteer dan \u00e9\u00e9n van de andere opties\"",
          "4540:          \"de USB inhoud van Windows XP\"",
          "",
          "[Added Lines]",
          "4538:  \"\\neen besturingssysteem in EFI mode installeren, selecteer dan \u00e9\u00e9n van de andere opties\"",
          "4540:  \"de USB inhoud van Windows XP\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4553: t MSG_164 \"Gebruikte methode om de drive opstartbaar te maken\"",
          "4554: t MSG_165 \"Klik om een image te selecteren...\"",
          "4555: t MSG_166 \"Vink aan om internationale labels te zien en een apparaat\\n\"",
          "4557: t MSG_167 \"Installeert een MBR die een opstartselectie toestaat en de BIOS USB drive ID kan verbergen\"",
          "4558: t MSG_168 \"Probeert de eerste opstartbare USB drive (gewoonlijk 0x80) voor te laten doen als een andere disk.\\n\"",
          "4559:  \"Dit is alleen nodig als u Windows XP installeert en meer dan \u00e9\u00e9n disk heeft\"",
          "",
          "[Removed Lines]",
          "4556:          \"pictogram in te stellen (cre\u00ebert een autorun.inf bestand)\"",
          "",
          "[Added Lines]",
          "4556:  \"pictogram in te stellen (cre\u00ebert een autorun.inf bestand)\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "4710: t MSG_292 \"Selecteer a.u.b. de windows versie die u wilt installeren:\"",
          "4711: t MSG_293 \"Niet ondersteunde Windows versie\"",
          "4712: t MSG_294 \"Deze Windows versie wordt niet langer ondersteund door Rufus.\"",
          "4714: ################################################################################",
          "4715: l \"fi-FI\" \"Finnish (Suomi)\" 0x040B",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4713: t MSG_295 \"Waarschuwing: Onoffici\u00eble versie\"",
          "4714: t MSG_296 \"Deze versie van Rufus is NIET gemaakt door de originele developer(s).\\n\\nWeet je zeker dat je dit programma wilt uitvoeren?\"",
          "4715: t MSG_297 \"Onvolledige ISO gedetecteerd\"",
          "4716: t MSG_298 \"Het ISO bestand dat u heeft geselecteerd komt niet overeen met de aangegeven waarde \"",
          "4717:  \"grootte: %s van de data ontbreekt!\\n\\nAls u dit bestand van het \"",
          "4718:  \"internet heeft gehaald, probeer een nieuwe kopie te downloaden en te verifi\u00ebren met de \"",
          "4719:  \"MD5 of SHA checksums die overeenkomen met de offici\u00eble versie.\\n\\nU kunt de \"",
          "4720:  \"MD5 of SHA in Rufus berekenen door op het '#' button te klikken.\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.17.1194\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.17.1195\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,17,1194,0",
          "370:  PRODUCTVERSION 2,17,1194,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,17,1195,0",
          "370:  PRODUCTVERSION 2,17,1195,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.17.1194\"",
          "393:             VALUE \"ProductVersion\", \"2.17.1194\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.17.1195\"",
          "393:             VALUE \"ProductVersion\", \"2.17.1195\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "bb828fda2bb38bd26ae4aff15b23699407904ed4",
      "candidate_info": {
        "commit_hash": "bb828fda2bb38bd26ae4aff15b23699407904ed4",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/bb828fda2bb38bd26ae4aff15b23699407904ed4",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Italian translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "7886: ################################################################################",
          "7887: l \"it-IT\" \"Italian (Italiano)\" 0x0410, 0x0810",
          "7889: b \"en-US\"",
          "7891: g IDD_DIALOG",
          "",
          "[Removed Lines]",
          "7888: v 1.0.21",
          "",
          "[Added Lines]",
          "7888: v 1.0.22",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "8322: t MSG_292 \"Seleziona la versione di Windows che vuoi installare:\"",
          "8323: t MSG_293 \"Versione Windows non supportata\"",
          "8324: t MSG_294 \"Questa versione di Windows non \u00e8 pi\u00f9 supportata da Rufus.\"",
          "8326: ######################################################################",
          "8327: l \"ja-JP\" \"Japanese (\u65e5\u672c\u8a9e)\" 0x0411",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8325: t MSG_295 \"Attenzione: versione non ufficiale\"",
          "8326: t MSG_296 \"Questa versione di Rufus non \u00e8 stata sviluppata dai suoi sviluppatori ufficiali.\\n\\nSei sicuro di volerla eseguire?\"",
          "8327: t MSG_297 \"Rilevato file ISO troncato\"",
          "8328: t MSG_298 \"Il file ISO selezionato non corrisponde alla dimensione dichiarata: %s dei dati mancanti!\\n\\nSe hai scaricato \"",
          "8329:  \"questo file da internet, prova a scaricarne una nuova copia e verifica che la checksum MD5 o SHA corrisponda alla checksum \"",
          "8330:  \"ufficiale.\\n\\nNota che puoi calcolare in Rufus la checksum facendo clic sul pulsante '#'.\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.16.1129\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.16.1130\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,16,1129,0",
          "370:  PRODUCTVERSION 2,16,1129,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,16,1130,0",
          "370:  PRODUCTVERSION 2,16,1130,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1129\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1129\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1130\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1130\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}