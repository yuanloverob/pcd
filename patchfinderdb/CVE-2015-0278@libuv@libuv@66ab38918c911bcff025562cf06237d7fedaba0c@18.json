{
  "cve_id": "CVE-2015-0278",
  "cve_desc": "libuv before 0.10.34 does not properly drop group privileges, which allows context-dependent attackers to gain privileges via unspecified vectors.",
  "repo": "libuv/libuv",
  "patch_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
  "patch_info": {
    "commit_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
    "repo": "libuv/libuv",
    "commit_url": "https://github.com/libuv/libuv/commit/66ab38918c911bcff025562cf06237d7fedaba0c",
    "files": [
      "src/unix/process.c"
    ],
    "message": "unix: call setgoups before calling setuid/setgid\n\nPartial fix for #1093",
    "before_after_code_files": [
      "src/unix/process.c||src/unix/process.c"
    ]
  },
  "patch_diff": {
    "src/unix/process.c||src/unix/process.c": [
      "File: src/unix/process.c -> src/unix/process.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "330:     _exit(127);",
      "331:   }",
      "333:   if ((options->flags & UV_PROCESS_SETGID) && setgid(options->gid)) {",
      "334:     uv__write_int(error_fd, -errno);",
      "335:     perror(\"setgid()\");",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "333:   if (options->flags & (UV_PROCESS_SETUID | UV_PROCESS_SETGID)) {",
      "341:     SAVE_ERRNO(setgroups(0, NULL));",
      "342:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7f65a74f8ef503cfca3dd874839b5c9b7a1169f4",
      "candidate_info": {
        "commit_hash": "7f65a74f8ef503cfca3dd874839b5c9b7a1169f4",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/7f65a74f8ef503cfca3dd874839b5c9b7a1169f4",
        "files": [
          "test/test-ip4-addr.c"
        ],
        "message": "test: remove C++ style comment",
        "before_after_code_files": [
          "test/test-ip4-addr.c||test/test-ip4-addr.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/test-ip4-addr.c||test/test-ip4-addr.c": [
          "File: test/test-ip4-addr.c -> test/test-ip4-addr.c"
        ]
      }
    },
    {
      "candidate_hash": "20d092edc8dc8f4a8a6198f9fa31d21fdec92d7b",
      "candidate_info": {
        "commit_hash": "20d092edc8dc8f4a8a6198f9fa31d21fdec92d7b",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/20d092edc8dc8f4a8a6198f9fa31d21fdec92d7b",
        "files": [
          "include/uv.h",
          "src/uv-common.c"
        ],
        "message": "common: pass const sockaddr ptr to uv_ip*_name\n\nuv_ip4_name and uv_ip6_name do not modify passed sockaddr pointer,\nso there is no need to keep this parameter non-const.",
        "before_after_code_files": [
          "include/uv.h||include/uv.h",
          "src/uv-common.c||src/uv-common.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/uv.h||include/uv.h": [
          "File: include/uv.h -> include/uv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "2057: UV_EXTERN int uv_ip6_addr(const char* ip, int port, struct sockaddr_in6* addr);",
          "",
          "[Removed Lines]",
          "2060: UV_EXTERN int uv_ip4_name(struct sockaddr_in* src, char* dst, size_t size);",
          "2061: UV_EXTERN int uv_ip6_name(struct sockaddr_in6* src, char* dst, size_t size);",
          "",
          "[Added Lines]",
          "2060: UV_EXTERN int uv_ip4_name(const struct sockaddr_in* src, char* dst, size_t size);",
          "2061: UV_EXTERN int uv_ip6_name(const struct sockaddr_in6* src, char* dst, size_t size);",
          "",
          "---------------"
        ],
        "src/uv-common.c||src/uv-common.c": [
          "File: src/uv-common.c -> src/uv-common.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "142: }",
          "146:   return uv_inet_ntop(AF_INET, &src->sin_addr, dst, size);",
          "147: }",
          "151:   return uv_inet_ntop(AF_INET6, &src->sin6_addr, dst, size);",
          "152: }",
          "",
          "[Removed Lines]",
          "145: int uv_ip4_name(struct sockaddr_in* src, char* dst, size_t size) {",
          "150: int uv_ip6_name(struct sockaddr_in6* src, char* dst, size_t size) {",
          "",
          "[Added Lines]",
          "145: int uv_ip4_name(const struct sockaddr_in* src, char* dst, size_t size) {",
          "150: int uv_ip6_name(const struct sockaddr_in6* src, char* dst, size_t size) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3310ff4a9eeb60b696410e2d7e6da7158ed55083",
      "candidate_info": {
        "commit_hash": "3310ff4a9eeb60b696410e2d7e6da7158ed55083",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/3310ff4a9eeb60b696410e2d7e6da7158ed55083",
        "files": [
          "m4/dtrace.m4"
        ],
        "message": "build: update dtrace m4 check for sunos\n\nThe check to see if -G is needed for dtrace requires a bit more effort,\nmake a header, c file, and object file.",
        "before_after_code_files": [
          "m4/dtrace.m4||m4/dtrace.m4"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "m4/dtrace.m4||m4/dtrace.m4": [
          "File: m4/dtrace.m4 -> m4/dtrace.m4",
          "--- Hunk 1 ---",
          "[Context before]",
          "39:   probe increment(int);",
          "40: };",
          "41: _ACEOF",
          "43:           AS_IF([test $? -eq 0],[ac_cv_dtrace_needs_objects=yes],",
          "44:             [ac_cv_dtrace_needs_objects=no])",
          "46:       ])",
          "47:       AC_SUBST(DTRACEFLAGS) dnl TODO: test for -G on OSX",
          "48:       ac_cv_have_dtrace=yes",
          "",
          "[Removed Lines]",
          "42:           $DTRACE -G -o conftest.d.o -s conftest.d 2>/dev/zero",
          "45:           rm -f conftest.d.o conftest.d",
          "",
          "[Added Lines]",
          "42:           cat > conftest.c <<_ACEOF",
          "43: #include \"conftest.h\"",
          "44: void foo() {",
          "45:   EXAMPLE_INCREMENT(1);",
          "46: }",
          "47: _ACEOF",
          "48:           $DTRACE -h -o conftest.h -s conftest.d 2>/dev/zero",
          "49:           $CC -c -o conftest.o conftest.c",
          "50:           $DTRACE -G -o conftest.d.o -s conftest.d conftest.o 2>/dev/zero",
          "53:           rm -f conftest.d.o conftest.d conftest.h conftest.o conftest.c",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e47e6b2afa93f7aa2b665968704e191c416d60c1",
      "candidate_info": {
        "commit_hash": "e47e6b2afa93f7aa2b665968704e191c416d60c1",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/e47e6b2afa93f7aa2b665968704e191c416d60c1",
        "files": [
          "ChangeLog",
          "src/version.c"
        ],
        "message": "Now working on v0.11.10",
        "before_after_code_files": [
          "src/version.c||src/version.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/version.c||src/version.c": [
          "File: src/version.c -> src/version.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "32: #define UV_VERSION_MAJOR 0",
          "33: #define UV_VERSION_MINOR 11",
          "38: #define UV_VERSION  ((UV_VERSION_MAJOR << 16) | \\",
          "",
          "[Removed Lines]",
          "34: #define UV_VERSION_PATCH 9",
          "35: #define UV_VERSION_IS_RELEASE 1",
          "",
          "[Added Lines]",
          "34: #define UV_VERSION_PATCH 10",
          "35: #define UV_VERSION_IS_RELEASE 0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3aeca36a1b29d64cf290459a64fa989d46322372",
      "candidate_info": {
        "commit_hash": "3aeca36a1b29d64cf290459a64fa989d46322372",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/3aeca36a1b29d64cf290459a64fa989d46322372",
        "files": [
          "src/unix/aix.c",
          "src/unix/core.c",
          "src/unix/stream.c",
          "src/win/core.c",
          "src/win/fs.c",
          "src/win/getaddrinfo.c",
          "src/win/poll.c",
          "src/win/process.c",
          "src/win/tcp.c",
          "src/win/thread.c",
          "src/win/udp.c",
          "src/win/util.c"
        ],
        "message": "unix, windows: fix typos in comments\n\nFix various typos and spelling mistakes in comments.\nDoes not affect any code, just changes comments.\n\nPR-URL: https://github.com/libuv/libuv/pull/17\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>",
        "before_after_code_files": [
          "src/unix/aix.c||src/unix/aix.c",
          "src/unix/core.c||src/unix/core.c",
          "src/unix/stream.c||src/unix/stream.c",
          "src/win/core.c||src/win/core.c",
          "src/win/fs.c||src/win/fs.c",
          "src/win/getaddrinfo.c||src/win/getaddrinfo.c",
          "src/win/poll.c||src/win/poll.c",
          "src/win/process.c||src/win/process.c",
          "src/win/tcp.c||src/win/tcp.c",
          "src/win/thread.c||src/win/thread.c",
          "src/win/udp.c||src/win/udp.c",
          "src/win/util.c||src/win/util.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/unix/aix.c||src/unix/aix.c": [
          "File: src/unix/aix.c -> src/unix/aix.c"
        ],
        "src/unix/core.c||src/unix/core.c": [
          "File: src/unix/core.c -> src/unix/core.c"
        ],
        "src/unix/stream.c||src/unix/stream.c": [
          "File: src/unix/stream.c -> src/unix/stream.c"
        ],
        "src/win/core.c||src/win/core.c": [
          "File: src/win/core.c -> src/win/core.c"
        ],
        "src/win/fs.c||src/win/fs.c": [
          "File: src/win/fs.c -> src/win/fs.c"
        ],
        "src/win/getaddrinfo.c||src/win/getaddrinfo.c": [
          "File: src/win/getaddrinfo.c -> src/win/getaddrinfo.c"
        ],
        "src/win/poll.c||src/win/poll.c": [
          "File: src/win/poll.c -> src/win/poll.c"
        ],
        "src/win/process.c||src/win/process.c": [
          "File: src/win/process.c -> src/win/process.c"
        ],
        "src/win/tcp.c||src/win/tcp.c": [
          "File: src/win/tcp.c -> src/win/tcp.c"
        ],
        "src/win/thread.c||src/win/thread.c": [
          "File: src/win/thread.c -> src/win/thread.c"
        ],
        "src/win/udp.c||src/win/udp.c": [
          "File: src/win/udp.c -> src/win/udp.c"
        ],
        "src/win/util.c||src/win/util.c": [
          "File: src/win/util.c -> src/win/util.c"
        ]
      }
    }
  ]
}