{
  "cve_id": "CVE-2014-6262",
  "cve_desc": "Multiple format string vulnerabilities in the python module in RRDtool, as used in Zenoss Core before 4.2.5 and other products, allow remote attackers to execute arbitrary code or cause a denial of service (application crash) via a crafted third argument to the rrdtool.graph function, aka ZEN-15415, a related issue to CVE-2013-2131.",
  "repo": "oetiker/rrdtool-1.x",
  "patch_hash": "85261a013112e278c90224033f5b0592ee387786",
  "patch_info": {
    "commit_hash": "85261a013112e278c90224033f5b0592ee387786",
    "repo": "oetiker/rrdtool-1.x",
    "commit_url": "https://github.com/oetiker/rrdtool-1.x/commit/85261a013112e278c90224033f5b0592ee387786",
    "files": [
      "src/rrd_graph.c",
      "src/rrd_graph.h"
    ],
    "message": "a proper fix to the bad_format checking misery",
    "before_after_code_files": [
      "src/rrd_graph.c||src/rrd_graph.c",
      "src/rrd_graph.h||src/rrd_graph.h"
    ]
  },
  "patch_diff": {
    "src/rrd_graph.c||src/rrd_graph.c": [
      "File: src/rrd_graph.c -> src/rrd_graph.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "8: #include <sys/stat.h>",
      "10: #ifdef WIN32",
      "11: #include \"strftime.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "9: #include <glib.h>   // will use regex",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1622:                     prline.u_str = (char*)malloc((FMT_LEG_LEN + 2) * sizeof(char));",
      "1623:                     strftime(prline.u_str,",
      "1624:                              FMT_LEG_LEN, im->gdes[i].format, &tmvdef);",
      "1628:                     return -1;",
      "1629:                 } else {",
      "1630:                     prline.u_str =",
      "",
      "[Removed Lines]",
      "1625:                 } else if (bad_format(im->gdes[i].format)) {",
      "1626:                     rrd_set_error",
      "1627:                         (\"bad format for PRINT in '%s'\", im->gdes[i].format);",
      "",
      "[Added Lines]",
      "1626:                 } else if (bad_format_print(im->gdes[i].format)) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1641:                     strftime(im->gdes[i].legend,",
      "1642:                              FMT_LEG_LEN, im->gdes[i].format, &tmvdef);",
      "1643:                 } else {",
      "1649:                     }",
      "1650: #ifdef HAVE_SNPRINTF",
      "1651:                     snprintf(im->gdes[i].legend,",
      "",
      "[Removed Lines]",
      "1644:                     if (bad_format(im->gdes[i].format)) {",
      "1645:                         rrd_set_error",
      "1646:                             (\"bad format for GPRINT in '%s'\",",
      "1647:                              im->gdes[i].format);",
      "1648:                         return -1;",
      "",
      "[Added Lines]",
      "1643:                     if (bad_format_print(im->gdes[i].format)) {",
      "1644:                        return -1;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "3959:     return 0;",
      "3960: }",
      "",
      "[Removed Lines]",
      "3963: static int bad_format_imginfo( char *fmt);",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "4036:         if (bad_format_imginfo(im.imginfo)) {",
      "4037:             rrd_info_free(im.grinfo);",
      "4038:             im_free(&im);",
      "4040:             return NULL;",
      "4041:         }",
      "4042:         path = strdup(im.graphfile);",
      "",
      "[Removed Lines]",
      "4039:             rrd_set_error(\"bad format for imginfo\");",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "4479:             im->second_axis_legend[150]='\\0';",
      "4480:             break;",
      "4481:         case 1004:",
      "4484:                 return;",
      "4485:             }",
      "4486:             strncpy(im->second_axis_format,optarg,150);",
      "4487:             im->second_axis_format[150]='\\0';",
      "4488:             break;",
      "4489:         case 1010:",
      "4492:                 return;",
      "4493:             }",
      "4494:             strncpy(im->primary_axis_format,optarg,150);",
      "",
      "[Removed Lines]",
      "4482:             if (bad_format(optarg)){",
      "4483:                 rrd_set_error(\"use either %le or %lf formats\");",
      "4490:             if (bad_format(optarg)){",
      "4491:                 rrd_set_error(\"use either %le or %lf formats\");",
      "",
      "[Added Lines]",
      "4474:             if (bad_format_axis(optarg)){",
      "4481:             if (bad_format_axis(optarg)){",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "4805: }",
      "4854: }",
      "4899: }",
      "4902: int vdef_parse(",
      "4903:     struct graph_desc_t",
      "",
      "[Removed Lines]",
      "4808: int bad_format(",
      "4809:     char *fmt)",
      "4810: {",
      "4811:     char     *ptr;",
      "4812:     int       n = 0;",
      "4814:     ptr = fmt;",
      "4815:     while (*ptr != '\\0')",
      "4816:         if (*ptr++ == '%') {",
      "4819:             if (*ptr == '\\0')",
      "4820:                 return 1;",
      "4822:             if (*ptr == 's' || *ptr == 'S' || *ptr == '%')",
      "4823:                 ptr++;",
      "4825:             else if (*ptr == 'c') {",
      "4826:                 ptr++;",
      "4827:                 n = 1;",
      "4828:             }",
      "4831:             else {",
      "4833:                 if (*ptr == ' ' || *ptr == '+' || *ptr == '-')",
      "4834:                     ptr++;",
      "4836:                 while (*ptr >= '0' && *ptr <= '9')",
      "4837:                     ptr++;",
      "4838:                 if (*ptr == '.')",
      "4839:                     ptr++;",
      "4840:                 while (*ptr >= '0' && *ptr <= '9')",
      "4841:                     ptr++;",
      "4843:                 if (*ptr++ != 'l')",
      "4844:                     return 1;",
      "4845:                 if (*ptr == 'e' || *ptr == 'f' || *ptr == 'g')",
      "4846:                     ptr++;",
      "4847:                 else",
      "4848:                     return 1;",
      "4849:                 n++;",
      "4850:             }",
      "4851:         }",
      "4853:     return (n != 1);",
      "4857: static int bad_format_imginfo(",
      "4858:     char *fmt)",
      "4859: {",
      "4860:     char     *ptr;",
      "4861:     int       n = 0;",
      "4863:     ptr = fmt;",
      "4864:     while (*ptr != '\\0')",
      "4865:         if (*ptr++ == '%') {",
      "4868:             if (*ptr == '\\0')",
      "4869:                 return 1;",
      "4871:             if (*ptr == '%')",
      "4872:                 ptr++;",
      "4874:             else if (*ptr == 's' || *ptr == 'S') {",
      "4875:                 n = 1;",
      "4876:                 ptr++;",
      "4877:             }",
      "4880:             else {",
      "4882:                 if (*ptr == ' ')",
      "4883:                     ptr++;",
      "4885:                 while (*ptr >= '0' && *ptr <= '9')",
      "4886:                     ptr++;",
      "4888:                 if (*ptr++ != 'l')",
      "4889:                     return 1;",
      "4890:                 if (*ptr == 'u')",
      "4891:                     ptr++;",
      "4892:                 else",
      "4893:                     return 1;",
      "4894:                 n++;",
      "4895:             }",
      "4896:         }",
      "4898:     return (n != 3);",
      "",
      "[Added Lines]",
      "4798: static int bad_format_check(const char *pattern, char *fmt) {",
      "4799:     GError *gerr = NULL;",
      "4800:     GRegex *re = g_regex_new(pattern, G_REGEX_EXTENDED, 0, &gerr);",
      "4801:     GMatchInfo *mi;",
      "4802:     if (gerr != NULL) {",
      "4803:         rrd_set_error(\"cannot compile regular expression: %s (%s)\", gerr->message,pattern);",
      "4804:         return 1;",
      "4805:     }",
      "4806:     int m = g_regex_match(re, fmt, 0, &mi);",
      "4807:     g_match_info_free (mi);",
      "4808:     g_regex_unref(re);",
      "4809:     if (!m) {",
      "4810:         rrd_set_error(\"invalid format string '%s' (should match '%s')\",fmt,pattern);",
      "4811:         return 1;",
      "4812:     }",
      "4813:     return 0;",
      "4816: #define SAFE_STRING \"(?:[^%]+|%%)*\"",
      "4818: int bad_format_imginfo(char *fmt){",
      "4819:     return bad_format_check(\"^\" SAFE_STRING \"%s\" SAFE_STRING \"%lu\" SAFE_STRING \"%lu\" SAFE_STRING \"$\",fmt);",
      "4820: }",
      "4821: #define FLOAT_STRING \"%[+- 0#]?[0-9]*([.][0-9]+)?l[eEfF]\"",
      "4823: int bad_format_axis(char *fmt){",
      "4824:     return bad_format_check(\"^\" SAFE_STRING FLOAT_STRING SAFE_STRING \"$\",fmt);",
      "4827: int bad_format_print(char *fmt){",
      "4828:     return bad_format_check(\"^\" SAFE_STRING FLOAT_STRING SAFE_STRING \"%s\" SAFE_STRING \"$\",fmt);",
      "4829: }",
      "",
      "---------------"
    ],
    "src/rrd_graph.h||src/rrd_graph.h": [
      "File: src/rrd_graph.h -> src/rrd_graph.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "396:     char *,",
      "397:     char *,",
      "398:     int);",
      "400:     char *);",
      "401: int       vdef_parse(",
      "402:     struct graph_desc_t *,",
      "",
      "[Removed Lines]",
      "399: int       bad_format(",
      "",
      "[Added Lines]",
      "399: int       bad_format_axis(",
      "400:     char *);",
      "401: int       bad_format_print(",
      "402:     char *);",
      "403: int       bad_format_imginfo(",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ac47eb3e0b46d052859ebab9286f4dc12558ab83",
      "candidate_info": {
        "commit_hash": "ac47eb3e0b46d052859ebab9286f4dc12558ab83",
        "repo": "oetiker/rrdtool-1.x",
        "commit_url": "https://github.com/oetiker/rrdtool-1.x/commit/ac47eb3e0b46d052859ebab9286f4dc12558ab83",
        "files": [
          "doc/rrdgraph.pod",
          "src/rrd_graph.c",
          "src/rrd_graph.h",
          "src/rrd_tool.c"
        ],
        "message": "Add --left-axis-format option to control labels on y-axis of graph.",
        "before_after_code_files": [
          "src/rrd_graph.c||src/rrd_graph.c",
          "src/rrd_graph.h||src/rrd_graph.h",
          "src/rrd_tool.c||src/rrd_tool.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rrd_graph.c||src/rrd_graph.c",
            "src/rrd_graph.h||src/rrd_graph.h"
          ],
          "candidate": [
            "src/rrd_graph.c||src/rrd_graph.c",
            "src/rrd_graph.h||src/rrd_graph.h"
          ]
        }
      },
      "candidate_diff": {
        "src/rrd_graph.c||src/rrd_graph.c": [
          "File: src/rrd_graph.c -> src/rrd_graph.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2057:                 || (nlabels == 1",
          "2058:                     && (YN < im->yorigin - im->ysize || YN > im->yorigin))) {",
          "2059:                 if (im->symbol == ' ') {",
          "2067:                                     scaledstep * (double) i);",
          "2068:                         } else {",
          "2071:                         }",
          "2072:                     }",
          "2073:                 } else {",
          "2074:                     char      sisym = (i == 0 ? ' ' : im->symbol);",
          "2083:                                     scaledstep * (double) i, sisym);",
          "2084:                         } else {",
          "2087:                         }",
          "2088:                     }",
          "2089:                 }",
          "2090:                 nlabels++;",
          "",
          "[Removed Lines]",
          "2060:                     if (im->extra_flags & ALTYGRID) {",
          "2061:                         sprintf(graph_label,",
          "2062:                                 im->ygrid_scale.labfmt,",
          "2063:                                 scaledstep * (double) i);",
          "2064:                     } else {",
          "2065:                         if (MaxY < 10) {",
          "2066:                             sprintf(graph_label, \"%4.1f\",",
          "2069:                             sprintf(graph_label, \"%4.0f\",",
          "2070:                                     scaledstep * (double) i);",
          "2076:                     if (im->extra_flags & ALTYGRID) {",
          "2077:                         sprintf(graph_label,",
          "2078:                                 im->ygrid_scale.labfmt,",
          "2079:                                 scaledstep * (double) i, sisym);",
          "2080:                     } else {",
          "2081:                         if (MaxY < 10) {",
          "2082:                             sprintf(graph_label, \"%4.1f %c\",",
          "2085:                             sprintf(graph_label, \"%4.0f %c\",",
          "2086:                                     scaledstep * (double) i, sisym);",
          "",
          "[Added Lines]",
          "2060:                     if (im->primary_axis_format[0] == '\\0'){",
          "2061:                         if (im->extra_flags & ALTYGRID) {",
          "2062:                             sprintf(graph_label,",
          "2063:                                     im->ygrid_scale.labfmt,",
          "2066:                             if (MaxY < 10) {",
          "2067:                                 sprintf(graph_label, \"%4.1f\",",
          "2068:                                         scaledstep * (double) i);",
          "2069:                             } else {",
          "2070:                                 sprintf(graph_label, \"%4.0f\",",
          "2071:                                         scaledstep * (double) i);",
          "2072:                             }",
          "2074:                     } else {",
          "2075:                         sprintf(graph_label, im->primary_axis_format,",
          "2076:                                 scaledstep * (double) i);",
          "2081:                     if (im->primary_axis_format[0] == '\\0'){",
          "2082:                         if (im->extra_flags & ALTYGRID) {",
          "2083:                             sprintf(graph_label,",
          "2084:                                     im->ygrid_scale.labfmt,",
          "2087:                             if (MaxY < 10) {",
          "2088:                                 sprintf(graph_label, \"%4.1f %c\",",
          "2089:                                         scaledstep * (double) i, sisym);",
          "2090:                             } else {",
          "2091:                                 sprintf(graph_label, \"%4.0f %c\",",
          "2092:                                         scaledstep * (double) i, sisym);",
          "2093:                             }",
          "2095:                     } else {",
          "2096:                         sprintf(graph_label, im->primary_axis_format,",
          "2097:                                 scaledstep * (double) i, sisym);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4263:         { \"border\",             required_argument, 0, 1007},",
          "4264:         { \"grid-dash\",          required_argument, 0, 1008},",
          "4265:         { \"dynamic-labels\",     no_argument,       0, 1009},",
          "4266:         {  0, 0, 0, 0}",
          "4267: };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4276:         { \"left-axis-format\",   required_argument, 0, 1010},",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4475:             strncpy(im->second_axis_format,optarg,150);",
          "4476:             im->second_axis_format[150]='\\0';",
          "4477:             break;",
          "4478:         case 'v':",
          "4479:             strncpy(im->ylegend, optarg, 150);",
          "4480:             im->ylegend[150] = '\\0';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4489:         case 1010:",
          "4490:             if (bad_format(optarg)){",
          "4491:                 rrd_set_error(\"use either %le or %lf formats\");",
          "4492:                 return;",
          "4493:             }",
          "4494:             strncpy(im->primary_axis_format,optarg,150);",
          "4495:             im->primary_axis_format[150]='\\0';",
          "4496:             break;",
          "",
          "---------------"
        ],
        "src/rrd_graph.h||src/rrd_graph.h": [
          "File: src/rrd_graph.h -> src/rrd_graph.h"
        ],
        "src/rrd_tool.c||src/rrd_tool.c": [
          "File: src/rrd_tool.c -> src/rrd_tool.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "137:     const char *help_graph1 =",
          "138:         N_(\"\\t\\t[-x|--x-grid x-axis grid and label]\\n\"",
          "139:            \"\\t\\t[-Y|--alt-y-grid] [--full-size-mode]\\n\"",
          "140:            \"\\t\\t[-y|--y-grid y-axis grid and label]\\n\"",
          "141:            \"\\t\\t[-v|--vertical-label string] [-w|--width pixels]\\n\"",
          "142:            \"\\t\\t[--right-axis scale:shift] [--right-axis-label label]\\n\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "140:            \"\\t\\t[--left-axis-format format]\\n\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e03784d07dc5c8f37f4431e1c6e20da58ae6a811",
      "candidate_info": {
        "commit_hash": "e03784d07dc5c8f37f4431e1c6e20da58ae6a811",
        "repo": "oetiker/rrdtool-1.x",
        "commit_url": "https://github.com/oetiker/rrdtool-1.x/commit/e03784d07dc5c8f37f4431e1c6e20da58ae6a811",
        "files": [
          "src/rrd_graph.c"
        ],
        "message": "do not capture",
        "before_after_code_files": [
          "src/rrd_graph.c||src/rrd_graph.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rrd_graph.c||src/rrd_graph.c"
          ],
          "candidate": [
            "src/rrd_graph.c||src/rrd_graph.c"
          ]
        }
      },
      "candidate_diff": {
        "src/rrd_graph.c||src/rrd_graph.c": [
          "File: src/rrd_graph.c -> src/rrd_graph.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4818: int bad_format_imginfo(char *fmt){",
          "4819:     return bad_format_check(\"^\" SAFE_STRING \"%s\" SAFE_STRING \"%lu\" SAFE_STRING \"%lu\" SAFE_STRING \"$\",fmt);",
          "4820: }",
          "4823: int bad_format_axis(char *fmt){",
          "4824:     return bad_format_check(\"^\" SAFE_STRING FLOAT_STRING SAFE_STRING \"$\",fmt);",
          "",
          "[Removed Lines]",
          "4821: #define FLOAT_STRING \"%[-+ 0#]?[0-9]*([.][0-9]+)?l[eEfF]\"",
          "",
          "[Added Lines]",
          "4821: #define FLOAT_STRING \"%[-+ 0#]?[0-9]*(?:[.][0-9]+)?l[eEfF]\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d63e4a22f169d0576090c46d66cc42922b730dff",
      "candidate_info": {
        "commit_hash": "d63e4a22f169d0576090c46d66cc42922b730dff",
        "repo": "oetiker/rrdtool-1.x",
        "commit_url": "https://github.com/oetiker/rrdtool-1.x/commit/d63e4a22f169d0576090c46d66cc42922b730dff",
        "files": [
          "src/rrd_graph.c"
        ],
        "message": "minus one warning",
        "before_after_code_files": [
          "src/rrd_graph.c||src/rrd_graph.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rrd_graph.c||src/rrd_graph.c"
          ],
          "candidate": [
            "src/rrd_graph.c||src/rrd_graph.c"
          ]
        }
      },
      "candidate_diff": {
        "src/rrd_graph.c||src/rrd_graph.c": [
          "File: src/rrd_graph.c -> src/rrd_graph.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3950: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3953: static int bad_format_imginfo( char *fmt);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "4833: }",
          "4837:     char *fmt)",
          "4838: {",
          "4839:     char     *ptr;",
          "",
          "[Removed Lines]",
          "4836: int bad_format_imginfo(",
          "",
          "[Added Lines]",
          "4838: static int bad_format_imginfo(",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3fc64f6b2df994d3926e04f809fe4b53b8a9acc1",
      "candidate_info": {
        "commit_hash": "3fc64f6b2df994d3926e04f809fe4b53b8a9acc1",
        "repo": "oetiker/rrdtool-1.x",
        "commit_url": "https://github.com/oetiker/rrdtool-1.x/commit/3fc64f6b2df994d3926e04f809fe4b53b8a9acc1",
        "files": [
          "src/rrd_graph.c"
        ],
        "message": "allow gG format",
        "before_after_code_files": [
          "src/rrd_graph.c||src/rrd_graph.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rrd_graph.c||src/rrd_graph.c"
          ],
          "candidate": [
            "src/rrd_graph.c||src/rrd_graph.c"
          ]
        }
      },
      "candidate_diff": {
        "src/rrd_graph.c||src/rrd_graph.c": [
          "File: src/rrd_graph.c -> src/rrd_graph.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4818: int bad_format_imginfo(char *fmt){",
          "4819:     return bad_format_check(\"^\" SAFE_STRING \"%s\" SAFE_STRING \"%lu\" SAFE_STRING \"%lu\" SAFE_STRING \"$\",fmt);",
          "4820: }",
          "4823: int bad_format_axis(char *fmt){",
          "4824:     return bad_format_check(\"^\" SAFE_STRING FLOAT_STRING SAFE_STRING \"$\",fmt);",
          "",
          "[Removed Lines]",
          "4821: #define FLOAT_STRING \"%[-+ 0#]?[0-9]*(?:[.][0-9]+)?l[eEfF]\"",
          "",
          "[Added Lines]",
          "4821: #define FLOAT_STRING \"%[-+ 0#]?[0-9]*(?:[.][0-9]+)?l[eEfFgG]\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e69800fb96b36e295872790911dc392eec4c54f2",
      "candidate_info": {
        "commit_hash": "e69800fb96b36e295872790911dc392eec4c54f2",
        "repo": "oetiker/rrdtool-1.x",
        "commit_url": "https://github.com/oetiker/rrdtool-1.x/commit/e69800fb96b36e295872790911dc392eec4c54f2",
        "files": [
          "src/rrd_graph.c"
        ],
        "message": "fix character class definition",
        "before_after_code_files": [
          "src/rrd_graph.c||src/rrd_graph.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rrd_graph.c||src/rrd_graph.c"
          ],
          "candidate": [
            "src/rrd_graph.c||src/rrd_graph.c"
          ]
        }
      },
      "candidate_diff": {
        "src/rrd_graph.c||src/rrd_graph.c": [
          "File: src/rrd_graph.c -> src/rrd_graph.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4818: int bad_format_imginfo(char *fmt){",
          "4819:     return bad_format_check(\"^\" SAFE_STRING \"%s\" SAFE_STRING \"%lu\" SAFE_STRING \"%lu\" SAFE_STRING \"$\",fmt);",
          "4820: }",
          "4823: int bad_format_axis(char *fmt){",
          "4824:     return bad_format_check(\"^\" SAFE_STRING FLOAT_STRING SAFE_STRING \"$\",fmt);",
          "",
          "[Removed Lines]",
          "4821: #define FLOAT_STRING \"%[+- 0#]?[0-9]*([.][0-9]+)?l[eEfF]\"",
          "",
          "[Added Lines]",
          "4821: #define FLOAT_STRING \"%[-+ 0#]?[0-9]*([.][0-9]+)?l[eEfF]\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}