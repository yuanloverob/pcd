{
  "cve_id": "CVE-2016-10161",
  "cve_desc": "The object_common1 function in ext/standard/var_unserializer.c in PHP before 5.6.30, 7.0.x before 7.0.15, and 7.1.x before 7.1.1 allows remote attackers to cause a denial of service (buffer over-read and application crash) via crafted serialized data that is mishandled in a finish_nested_data call.",
  "repo": "php/php-src",
  "patch_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
  "patch_info": {
    "commit_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/16b3003ffc6393e250f069aa28a78dc5a2c064b2",
    "files": [
      "ext/standard/tests/serialize/bug73825.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #73825 - Heap out of bounds read on unserialize in finish_nested_data()",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt": [
      "File: ext/standard/tests/serialize/bug73825.phpt -> ext/standard/tests/serialize/bug73825.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73825 Heap out of bounds read on unserialize in finish_nested_data()",
      "3: --FILE--",
      "4: <?php",
      "5: $obj = unserialize('O:8:\"00000000\":');",
      "6: var_dump($obj);",
      "7: ?>",
      "8: --EXPECTF--",
      "9: Warning: Bad unserialize data in %sbug73825.php on line %d",
      "11: Notice: unserialize(): Error at offset 13 of 15 bytes in %sbug73825.php on line %d",
      "12: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "405: {",
      "406:  long elements;",
      "408:  elements = parse_iv2((*p) + 2, p);",
      "410:  (*p) += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "408:  if( *p >= max - 2) {",
      "409:   zend_error(E_WARNING, \"Bad unserialize data\");",
      "410:   return -1;",
      "411:  }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "417:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
      "419:  }",
      "421:  return elements;",
      "",
      "[Removed Lines]",
      "418:   return 0;",
      "",
      "[Added Lines]",
      "423:   return -1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "496: {",
      "497:  YYCTYPE yych;",
      "498:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "495: #line 496 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "500: #line 501 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "552:  yych = *(YYMARKER = ++YYCURSOR);",
      "553:  if (yych == ':') goto yy95;",
      "554: yy3:",
      "556:  { return 0; }",
      "558: yy4:",
      "559:  yych = *(YYMARKER = ++YYCURSOR);",
      "560:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "555: #line 861 \"ext/standard/var_unserializer.re\"",
      "557: #line 558 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "560: #line 875 \"ext/standard/var_unserializer.re\"",
      "562: #line 563 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "597:  goto yy3;",
      "598: yy14:",
      "599:  ++YYCURSOR;",
      "601:  {",
      "603:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "605: }",
      "607: yy16:",
      "608:  yych = *++YYCURSOR;",
      "609:  goto yy3;",
      "",
      "[Removed Lines]",
      "600: #line 855 \"ext/standard/var_unserializer.re\"",
      "606: #line 607 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "605: #line 869 \"ext/standard/var_unserializer.re\"",
      "611: #line 612 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "634:  yych = *++YYCURSOR;",
      "635:  if (yych != '\"') goto yy18;",
      "636:  ++YYCURSOR;",
      "638:  {",
      "639:  size_t len, len2, len3, maxlen;",
      "640:  long elements;",
      "",
      "[Removed Lines]",
      "637: #line 708 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "642: #line 717 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "775:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
      "777:  if (incomplete_class) {",
      "778:   php_store_class_name(*rval, class_name, len2);",
      "779:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "782:  if (elements < 0) {",
      "783:     efree(class_name);",
      "784:     return 0;",
      "785:  }",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "782:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "783: }",
      "785: yy25:",
      "786:  yych = *++YYCURSOR;",
      "787:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "784: #line 785 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "794: #line 795 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "806:  yych = *++YYCURSOR;",
      "807:  if (yych != '\"') goto yy18;",
      "808:  ++YYCURSOR;",
      "810:  {",
      "811:     if (!var_hash) return 0;",
      "813:  INIT_PZVAL(*rval);",
      "817: }",
      "819: yy32:",
      "820:  yych = *++YYCURSOR;",
      "821:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "809: #line 699 \"ext/standard/var_unserializer.re\"",
      "815:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "816:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "818: #line 819 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "819: #line 704 \"ext/standard/var_unserializer.re\"",
      "821:  long elements;",
      "826:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
      "827:  if (elements < 0) {",
      "828:   return 0;",
      "829:  }",
      "830:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "832: #line 833 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "836:  yych = *++YYCURSOR;",
      "837:  if (yych != '{') goto yy18;",
      "838:  ++YYCURSOR;",
      "840:  {",
      "841:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "839: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "853: #line 683 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "858:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "859: }",
      "861: yy39:",
      "862:  yych = *++YYCURSOR;",
      "863:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "860: #line 861 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "874: #line 875 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "878:  yych = *++YYCURSOR;",
      "879:  if (yych != '\"') goto yy18;",
      "880:  ++YYCURSOR;",
      "882:  {",
      "883:  size_t len, maxlen;",
      "884:  char *str;",
      "",
      "[Removed Lines]",
      "881: #line 643 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "895: #line 648 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "913:  ZVAL_STRINGL(*rval, str, len, 0);",
      "914:  return 1;",
      "915: }",
      "917: yy46:",
      "918:  yych = *++YYCURSOR;",
      "919:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "916: #line 917 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "930: #line 931 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "934:  yych = *++YYCURSOR;",
      "935:  if (yych != '\"') goto yy18;",
      "936:  ++YYCURSOR;",
      "938:  {",
      "939:  size_t len, maxlen;",
      "940:  char *str;",
      "",
      "[Removed Lines]",
      "937: #line 610 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "951: #line 615 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "967:  ZVAL_STRINGL(*rval, str, len, 1);",
      "968:  return 1;",
      "969: }",
      "971: yy53:",
      "972:  yych = *++YYCURSOR;",
      "973:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "970: #line 971 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "984: #line 985 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1055:  }",
      "1056: yy63:",
      "1057:  ++YYCURSOR;",
      "1059:  {",
      "1060: #if SIZEOF_LONG == 4",
      "1061: use_double:",
      "",
      "[Removed Lines]",
      "1058: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1072: #line 605 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1065:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1066:  return 1;",
      "1067: }",
      "1069: yy65:",
      "1070:  yych = *++YYCURSOR;",
      "1071:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1082: #line 1083 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1124:  yych = *++YYCURSOR;",
      "1125:  if (yych != ';') goto yy18;",
      "1126:  ++YYCURSOR;",
      "1128:  {",
      "1130:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1127: #line 585 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1141: #line 590 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1140:  return 1;",
      "1141: }",
      "1143: yy76:",
      "1144:  yych = *++YYCURSOR;",
      "1145:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1156: #line 1157 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1166:  if (yych <= '9') goto yy79;",
      "1167:  if (yych != ';') goto yy18;",
      "1168:  ++YYCURSOR;",
      "1170:  {",
      "1171: #if SIZEOF_LONG == 4",
      "1172:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1169: #line 558 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1183: #line 563 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1193:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1194:  return 1;",
      "1195: }",
      "1197: yy83:",
      "1198:  yych = *++YYCURSOR;",
      "1199:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1201:  yych = *++YYCURSOR;",
      "1202:  if (yych != ';') goto yy18;",
      "1203:  ++YYCURSOR;",
      "1205:  {",
      "1207:  INIT_PZVAL(*rval);",
      "1208:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1209:  return 1;",
      "1210: }",
      "1212: yy87:",
      "1213:  ++YYCURSOR;",
      "1215:  {",
      "1217:  INIT_PZVAL(*rval);",
      "1218:  ZVAL_NULL(*rval);",
      "1219:  return 1;",
      "1220: }",
      "1222: yy89:",
      "1223:  yych = *++YYCURSOR;",
      "1224:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1204: #line 551 \"ext/standard/var_unserializer.re\"",
      "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
      "1214: #line 544 \"ext/standard/var_unserializer.re\"",
      "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1218: #line 556 \"ext/standard/var_unserializer.re\"",
      "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
      "1228: #line 549 \"ext/standard/var_unserializer.re\"",
      "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1241:  if (yych <= '9') goto yy91;",
      "1242:  if (yych != ';') goto yy18;",
      "1243:  ++YYCURSOR;",
      "1245:  {",
      "1246:  long id;",
      "",
      "[Removed Lines]",
      "1244: #line 521 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1258: #line 526 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1265:  return 1;",
      "1266: }",
      "1268: yy95:",
      "1269:  yych = *++YYCURSOR;",
      "1270:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1281: #line 1282 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1287:  if (yych <= '9') goto yy97;",
      "1288:  if (yych != ';') goto yy18;",
      "1289:  ++YYCURSOR;",
      "1291:  {",
      "1292:  long id;",
      "",
      "[Removed Lines]",
      "1290: #line 500 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1304: #line 505 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "1309:  return 1;",
      "1310: }",
      "1312: }",
      "1316:  return 0;",
      "",
      "[Removed Lines]",
      "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
      "1313: #line 863 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1325: #line 1326 \"ext/standard/var_unserializer.c\"",
      "1327: #line 877 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "409: {",
      "410:  long elements;",
      "412:  elements = parse_iv2((*p) + 2, p);",
      "414:  (*p) += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "412:  if( *p >= max - 2) {",
      "413:   zend_error(E_WARNING, \"Bad unserialize data\");",
      "414:   return -1;",
      "415:  }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
      "423:  }",
      "425:  return elements;",
      "",
      "[Removed Lines]",
      "422:   return 0;",
      "",
      "[Added Lines]",
      "427:   return -1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "697: }",
      "699: \"o:\" iv \":\" [\"] {",
      "700:     if (!var_hash) return 0;",
      "702:  INIT_PZVAL(*rval);",
      "706: }",
      "708: object \":\" uiv \":\" [\"] {",
      "",
      "[Removed Lines]",
      "704:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "705:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "",
      "[Added Lines]",
      "705:  long elements;",
      "710:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
      "711:  if (elements < 0) {",
      "712:   return 0;",
      "713:  }",
      "714:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "845:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
      "847:  if (incomplete_class) {",
      "848:   php_store_class_name(*rval, class_name, len2);",
      "849:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "856:  if (elements < 0) {",
      "857:     efree(class_name);",
      "858:     return 0;",
      "859:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5602f6421372848a6fbb23fbe6bbca47d94dd49a",
      "candidate_info": {
        "commit_hash": "5602f6421372848a6fbb23fbe6bbca47d94dd49a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/5602f6421372848a6fbb23fbe6bbca47d94dd49a",
        "files": [
          "ext/dba/php_dba.h",
          "ext/exif/exif.c",
          "ext/mysqlnd/mysqlnd_priv.h",
          "ext/readline/readline.c",
          "ext/soap/php_http.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "main/php_streams.h",
          "sapi/phpdbg/phpdbg_wait.c"
        ],
        "message": "Eliminate usages of _PP macros\n\nThese are either in debug code (fix them), commented out (drop\nthem) or in dead compatibility macros (drop them).\n\nOne usage was in php_stream_get_from_zval(), which we have not used\nsince at least PHP 5.2 and, judging from the fact that nobody\ncomplained about it causing compile errors in PHP 7, nobody else\nuses it either, so drop it.\n\nThere are still remaining uses in mysqli embedded and odbc birdstep.\nThese probably need to be dropped outright.",
        "before_after_code_files": [
          "ext/dbphp_dba.h||ext/dba/php_dba.h",
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/mysqlnd/mysqlnd_priv.h||ext/mysqlnd/mysqlnd_priv.h",
          "ext/readline/readline.c||ext/readline/readline.c",
          "ext/soap/php_http.c||ext/soap/php_http.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "main/php_streams.h||main/php_streams.h",
          "sapi/phpdbg/phpdbg_wait.c||sapi/phpdbg/phpdbg_wait.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/dbphp_dba.h||ext/dba/php_dba.h": [
          "File: ext/dbphp_dba.h -> ext/dba/php_dba.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4074:  exif_discard_imageinfo(&ImageInfo);",
          "4076: #ifdef EXIF_DEBUG",
          "4078: #endif",
          "4079: }",
          "",
          "[Removed Lines]",
          "4077:  php_error_docref1(NULL, Z_STRVAL_PP(p_name), E_NOTICE, \"done\");",
          "",
          "[Added Lines]",
          "4077:  php_error_docref1(NULL, p_name, E_NOTICE, \"done\");",
          "",
          "---------------"
        ],
        "ext/mysqlnd/mysqlnd_priv.h||ext/mysqlnd/mysqlnd_priv.h": [
          "File: ext/mysqlnd/mysqlnd_priv.h -> ext/mysqlnd/mysqlnd_priv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "23: #ifndef MYSQLND_PRIV_H",
          "24: #define MYSQLND_PRIV_H",
          "36: #ifdef ZTS",
          "37: #include \"TSRM.h\"",
          "38: #endif",
          "44: #define MYSQLND_STR_W_LEN(str)  str, (sizeof(str) - 1)",
          "46: #define MYSQLND_DEBUG_DUMP_TIME    1",
          "",
          "[Removed Lines]",
          "26: #ifndef Z_ADDREF_P",
          "28: #define Z_ADDREF_P(pz)    (++(pz)->refcount)",
          "29: #define Z_DELREF_P(pz)    (--(pz)->refcount)",
          "30: #define Z_REFCOUNT_P(pz)   ((pz)->refcount)",
          "31: #define Z_SET_REFCOUNT_P(pz, rc) ((pz)->refcount = rc)",
          "32: #define Z_REFCOUNT_PP(ppz)   Z_REFCOUNT_P(*(ppz))",
          "33: #define Z_DELREF_PP(ppz)   Z_DELREF_P(*(ppz))",
          "34: #endif",
          "40: #ifndef pestrndup",
          "41: #define pestrndup(s, length, persistent) ((persistent)?zend_strndup((s),(length)):estrndup((s),(length)))",
          "42: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/readline/readline.c||ext/readline/readline.c": [
          "File: ext/readline/readline.c -> ext/readline/readline.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "305:    oldval = rl_erase_empty_line;",
          "306:    if (value) {",
          "307:     convert_to_long_ex(value);",
          "309:    }",
          "310:    RETVAL_LONG(oldval);",
          "311: #endif",
          "",
          "[Removed Lines]",
          "308:     rl_erase_empty_line = Z_LVAL_PP(value);",
          "",
          "[Added Lines]",
          "308:     rl_erase_empty_line = Z_LVAL_P(value);",
          "",
          "---------------"
        ],
        "ext/soap/php_http.c||ext/soap/php_http.c": [
          "File: ext/soap/php_http.c -> ext/soap/php_http.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "700:       PHP_MD5Update(&md5ctx, (unsigned char*)phpurl->query, strlen(phpurl->query));",
          "701:      }",
          "713:      PHP_MD5Final(hash, &md5ctx);",
          "714:      make_digest(HA2, hash);",
          "",
          "[Removed Lines]",
          "705:      if (zend_hash_find(Z_ARRVAL_PP(digest), \"qop\", sizeof(\"qop\"), (void **)&tmp) == SUCCESS &&",
          "706:          Z_TYPE_PP(tmp) == IS_STRING &&",
          "707:          Z_STRLEN_PP(tmp) == sizeof(\"auth-int\")-1 &&",
          "708:          stricmp(Z_STRVAL_PP(tmp), \"auth-int\") == 0) {",
          "709:       PHP_MD5Update(&md5ctx, \":\", 1);",
          "710:       PHP_MD5Update(&md5ctx, HEntity, HASHHEXLEN);",
          "711:      }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "44: {",
          "45:  var_entries *var_hash = (*var_hashx)->last;",
          "46: #if VAR_ENTRIES_DBG",
          "48: #endif",
          "50:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "47:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "[Added Lines]",
          "47:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "104:  zend_long i;",
          "105:  var_entries *var_hash = (*var_hashx)->first;",
          "106: #if VAR_ENTRIES_DBG",
          "108: #endif",
          "110:  while (var_hash) {",
          "",
          "[Removed Lines]",
          "107:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "",
          "[Added Lines]",
          "107:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(nzval));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "651:  if (yybm[0+yych] & 128) {",
          "652:   goto yy20;",
          "653:  }",
          "656:  yych = *++YYCURSOR;",
          "657:  if (yych != '\"') goto yy18;",
          "658:  ++YYCURSOR;",
          "",
          "[Removed Lines]",
          "654:  if (yych <= '/') goto yy18;",
          "655:  if (yych >= ';') goto yy18;",
          "",
          "[Added Lines]",
          "654:  if (yych != ':') goto yy18;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "802:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "803: }",
          "805: yy25:",
          "806:  yych = *++YYCURSOR;",
          "807:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "804: #line 805 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "803: #line 804 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "833:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "834:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "835: }",
          "837: yy32:",
          "838:  yych = *++YYCURSOR;",
          "839:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "836: #line 837 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "835: #line 836 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "879:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "880: }",
          "882: yy39:",
          "883:  yych = *++YYCURSOR;",
          "884:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "881: #line 882 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "880: #line 881 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "927:  ZVAL_STR(rval, str);",
          "928:  return 1;",
          "929: }",
          "931: yy46:",
          "932:  yych = *++YYCURSOR;",
          "933:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "930: #line 931 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "929: #line 930 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "975:  ZVAL_STRINGL(rval, str, len);",
          "976:  return 1;",
          "977: }",
          "979: yy53:",
          "980:  yych = *++YYCURSOR;",
          "981:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "978: #line 979 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1072:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1073:  return 1;",
          "1074: }",
          "1076: yy65:",
          "1077:  yych = *++YYCURSOR;",
          "1078:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1075: #line 1076 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1148:  return 1;",
          "1149: }",
          "1151: yy76:",
          "1152:  yych = *++YYCURSOR;",
          "1153:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1150: #line 1151 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1149: #line 1150 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1200:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1201:  return 1;",
          "1202: }",
          "1204: yy83:",
          "1205:  yych = *++YYCURSOR;",
          "1206:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1203: #line 1204 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1202: #line 1203 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1214:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1215:  return 1;",
          "1216: }",
          "1218: yy87:",
          "1219:  ++YYCURSOR;",
          "1220: #line 573 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1217: #line 1218 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1223:  ZVAL_NULL(rval);",
          "1224:  return 1;",
          "1225: }",
          "1227: yy89:",
          "1228:  yych = *++YYCURSOR;",
          "1229:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1226: #line 1227 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1272:  return 1;",
          "1273: }",
          "1275: yy95:",
          "1276:  yych = *++YYCURSOR;",
          "1277:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1274: #line 1275 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1273: #line 1274 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1321:  return 1;",
          "1322: }",
          "1324: }",
          "1325: #line 875 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1323: #line 1324 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1322: #line 1323 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: {",
          "43:  var_entries *var_hash = (*var_hashx)->last;",
          "44: #if VAR_ENTRIES_DBG",
          "46: #endif",
          "48:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "45:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "[Added Lines]",
          "45:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "102:  zend_long i;",
          "103:  var_entries *var_hash = (*var_hashx)->first;",
          "104: #if VAR_ENTRIES_DBG",
          "106: #endif",
          "108:  while (var_hash) {",
          "",
          "[Removed Lines]",
          "105:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "",
          "[Added Lines]",
          "105:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(nzval));",
          "",
          "---------------"
        ],
        "main/php_streams.h||main/php_streams.h": [
          "File: main/php_streams.h -> main/php_streams.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "568: #define php_stream_open_wrapper(path, mode, options, opened) _php_stream_open_wrapper_ex((path), (mode), (options), (opened), NULL STREAMS_CC)",
          "569: #define php_stream_open_wrapper_ex(path, mode, options, opened, context) _php_stream_open_wrapper_ex((path), (mode), (options), (opened), (context) STREAMS_CC)",
          "578: PHPAPI void php_stream_wrapper_log_error(php_stream_wrapper *wrapper, int options, const char *fmt, ...) PHP_ATTRIBUTE_FORMAT(printf, 3, 4);",
          "",
          "[Removed Lines]",
          "571: #define php_stream_get_from_zval(stream, zstream, mode, options, opened, context) \\",
          "572:   if (Z_TYPE_PP((zstream)) == IS_RESOURCE) { \\",
          "573:    php_stream_from_zval((stream), (zstream)); \\",
          "574:   } else (stream) = Z_TYPE_PP((zstream)) == IS_STRING ?  \\",
          "575:    php_stream_open_wrapper_ex(Z_STRVAL_PP((zstream)), (mode), (options), (opened), (context)) : NULL",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "sapi/phpdbg/phpdbg_wait.c||sapi/phpdbg/phpdbg_wait.c": [
          "File: sapi/phpdbg/phpdbg_wait.c -> sapi/phpdbg/phpdbg_wait.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "281:     pefree(elm, zend_extensions.persistent);",
          "282:     zend_extensions.count--;",
          "283:    } else {",
          "289:     zend_hash_del(Z_ARRVAL_P(zvp), strkey);",
          "290:    }",
          "291:   }",
          "",
          "[Removed Lines]",
          "285:     if (Z_TYPE(key) == IS_LONG) {",
          "286:      zend_hash_index_del(Z_ARRVAL_PP(zvpp), Z_LVAL(key));",
          "287:     }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8b0deb8cd2d54fb9f786a87feb95ee2a00771f6f",
      "candidate_info": {
        "commit_hash": "8b0deb8cd2d54fb9f786a87feb95ee2a00771f6f",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/8b0deb8cd2d54fb9f786a87feb95ee2a00771f6f",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "fix unserializer patch",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "366:     if (Z_TYPE_P(old_data) == IS_INDIRECT) {",
          "367:      old_data = Z_INDIRECT_P(old_data);",
          "368:     }",
          "370:     var_push_dtor(var_hash, old_data);",
          "372:    }",
          "374:   }",
          "376:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "369:     zval_ptr_dtor(old_data);",
          "371:     ZVAL_UNDEF(old_data);",
          "373:    data = zend_hash_update(ht, Z_STR(key), &d);",
          "",
          "[Added Lines]",
          "371:    data = zend_hash_update_ind(ht, Z_STR(key), &d);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "509:  start = cursor;",
          "513: {",
          "514:  YYCTYPE yych;",
          "515:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "512: #line 513 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "510: #line 511 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "569:  yych = *(YYMARKER = ++YYCURSOR);",
          "570:  if (yych == ':') goto yy95;",
          "571: yy3:",
          "573:  { return 0; }",
          "575: yy4:",
          "576:  yych = *(YYMARKER = ++YYCURSOR);",
          "577:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "572: #line 860 \"ext/standard/var_unserializer.re\"",
          "574: #line 575 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "570: #line 858 \"ext/standard/var_unserializer.re\"",
          "572: #line 573 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "614:  goto yy3;",
          "615: yy14:",
          "616:  ++YYCURSOR;",
          "618:  {",
          "620:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "622: }",
          "624: yy16:",
          "625:  yych = *++YYCURSOR;",
          "626:  goto yy3;",
          "",
          "[Removed Lines]",
          "617: #line 854 \"ext/standard/var_unserializer.re\"",
          "623: #line 624 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "615: #line 852 \"ext/standard/var_unserializer.re\"",
          "621: #line 622 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "651:  yych = *++YYCURSOR;",
          "652:  if (yych != '\"') goto yy18;",
          "653:  ++YYCURSOR;",
          "655:  {",
          "656:  size_t len, len2, len3, maxlen;",
          "657:  zend_long elements;",
          "",
          "[Removed Lines]",
          "654: #line 709 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "652: #line 707 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "797:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "798: }",
          "800: yy25:",
          "801:  yych = *++YYCURSOR;",
          "802:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "799: #line 800 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "797: #line 798 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "821:  yych = *++YYCURSOR;",
          "822:  if (yych != '\"') goto yy18;",
          "823:  ++YYCURSOR;",
          "825:  {",
          "",
          "[Removed Lines]",
          "824: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "822: #line 699 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "829:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "830:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "831: }",
          "833: yy32:",
          "834:  yych = *++YYCURSOR;",
          "835:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "832: #line 833 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "830: #line 831 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "850:  yych = *++YYCURSOR;",
          "851:  if (yych != '{') goto yy18;",
          "852:  ++YYCURSOR;",
          "854:  {",
          "855:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "853: #line 680 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "851: #line 678 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "872:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "873: }",
          "875: yy39:",
          "876:  yych = *++YYCURSOR;",
          "877:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "874: #line 875 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "872: #line 873 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "892:  yych = *++YYCURSOR;",
          "893:  if (yych != '\"') goto yy18;",
          "894:  ++YYCURSOR;",
          "896:  {",
          "897:  size_t len, maxlen;",
          "898:  zend_string *str;",
          "",
          "[Removed Lines]",
          "895: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "893: #line 650 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "920:  ZVAL_STR(rval, str);",
          "921:  return 1;",
          "922: }",
          "924: yy46:",
          "925:  yych = *++YYCURSOR;",
          "926:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "923: #line 924 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "921: #line 922 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "941:  yych = *++YYCURSOR;",
          "942:  if (yych != '\"') goto yy18;",
          "943:  ++YYCURSOR;",
          "945:  {",
          "946:  size_t len, maxlen;",
          "947:  char *str;",
          "",
          "[Removed Lines]",
          "944: #line 625 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "942: #line 623 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "968:  ZVAL_STRINGL(rval, str, len);",
          "969:  return 1;",
          "970: }",
          "972: yy53:",
          "973:  yych = *++YYCURSOR;",
          "974:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "971: #line 972 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "969: #line 970 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1056:  }",
          "1057: yy63:",
          "1058:  ++YYCURSOR;",
          "1060:  {",
          "1061: #if SIZEOF_ZEND_LONG == 4",
          "1062: use_double:",
          "",
          "[Removed Lines]",
          "1059: #line 616 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1057: #line 614 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1065:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1066:  return 1;",
          "1067: }",
          "1069: yy65:",
          "1070:  yych = *++YYCURSOR;",
          "1071:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1066: #line 1067 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1124:  yych = *++YYCURSOR;",
          "1125:  if (yych != ';') goto yy18;",
          "1126:  ++YYCURSOR;",
          "1128:  {",
          "",
          "[Removed Lines]",
          "1127: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1125: #line 598 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1141:  return 1;",
          "1142: }",
          "1144: yy76:",
          "1145:  yych = *++YYCURSOR;",
          "1146:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1143: #line 1144 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1141: #line 1142 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1167:  if (yych <= '9') goto yy79;",
          "1168:  if (yych != ';') goto yy18;",
          "1169:  ++YYCURSOR;",
          "1171:  {",
          "1172: #if SIZEOF_ZEND_LONG == 4",
          "1173:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1170: #line 574 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1168: #line 572 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1193:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1194:  return 1;",
          "1195: }",
          "1197: yy83:",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1201:  yych = *++YYCURSOR;",
          "1202:  if (yych != ';') goto yy18;",
          "1203:  ++YYCURSOR;",
          "1205:  {",
          "1207:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1208:  return 1;",
          "1209: }",
          "1211: yy87:",
          "1212:  ++YYCURSOR;",
          "1214:  {",
          "1216:  ZVAL_NULL(rval);",
          "1217:  return 1;",
          "1218: }",
          "1220: yy89:",
          "1221:  yych = *++YYCURSOR;",
          "1222:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1204: #line 568 \"ext/standard/var_unserializer.re\"",
          "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
          "1213: #line 562 \"ext/standard/var_unserializer.re\"",
          "1219: #line 1220 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1202: #line 566 \"ext/standard/var_unserializer.re\"",
          "1208: #line 1209 \"ext/standard/var_unserializer.c\"",
          "1211: #line 560 \"ext/standard/var_unserializer.re\"",
          "1217: #line 1218 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1239:  if (yych <= '9') goto yy91;",
          "1240:  if (yych != ';') goto yy18;",
          "1241:  ++YYCURSOR;",
          "1243:  {",
          "1244:  zend_long id;",
          "",
          "[Removed Lines]",
          "1242: #line 539 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1240: #line 537 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1263:  return 1;",
          "1264: }",
          "1266: yy95:",
          "1267:  yych = *++YYCURSOR;",
          "1268:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1265: #line 1266 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1263: #line 1264 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1285:  if (yych <= '9') goto yy97;",
          "1286:  if (yych != ';') goto yy18;",
          "1287:  ++YYCURSOR;",
          "1289:  {",
          "1290:  zend_long id;",
          "",
          "[Removed Lines]",
          "1288: #line 517 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1286: #line 515 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1308:  return 1;",
          "1309: }",
          "1311: }",
          "1315:  return 0;",
          "",
          "[Removed Lines]",
          "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
          "1312: #line 862 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1308: #line 1309 \"ext/standard/var_unserializer.c\"",
          "1310: #line 860 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "370:     if (Z_TYPE_P(old_data) == IS_INDIRECT) {",
          "371:      old_data = Z_INDIRECT_P(old_data);",
          "372:     }",
          "374:     var_push_dtor(var_hash, old_data);",
          "376:    }",
          "378:   }",
          "380:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "373:     zval_ptr_dtor(old_data);",
          "375:     ZVAL_UNDEF(old_data);",
          "377:    data = zend_hash_update(ht, Z_STR(key), &d);",
          "",
          "[Added Lines]",
          "375:    data = zend_hash_update_ind(ht, Z_STR(key), &d);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
      "candidate_info": {
        "commit_hash": "fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/fd545f4f44ff44bba9f75ae3f044dc2ba9c61083",
        "files": [
          "ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Also fixed 'r'",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt": [
          "File: ext/standard/tests/serialize/bug70963.phpt -> ext/standard/tests/serialize/bug70963.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: --FILE--",
          "4: <?php",
          "5: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;R:3;}'));",
          "6: ?>",
          "7: --EXPECTF--",
          "9:   [0]=>",
          "10:   object(Exception)#%d (5) {",
          "11:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "8: array(2) {",
          "",
          "[Added Lines]",
          "6: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;r:3;}'));",
          "9: array(1) {",
          "10:   [0]=>",
          "11:   object(Exception)#%d (5) {",
          "12:     [\"message\":protected]=>",
          "13:     string(0) \"\"",
          "14:     [\"string\":\"Exception\":private]=>",
          "15:     string(0) \"\"",
          "16:     [\"code\":protected]=>",
          "17:     int(0)",
          "18:     [\"file\":protected]=>",
          "19:     string(%d) \"%s\"",
          "20:     [\"line\":protected]=>",
          "21:     int(%d)",
          "22:   }",
          "23: }",
          "24: array(1) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "365:    }",
          "366:   }",
          "370:   if (!php_var_unserialize_ex(data, p, max, var_hash, classes)) {",
          "371:    return 0;",
          "372:   }",
          "376:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "377:    (*p)--;",
          "",
          "[Removed Lines]",
          "368:   zval_dtor(&key);",
          "374:   var_push_dtor(var_hash, data);",
          "",
          "[Added Lines]",
          "369:    zval_dtor(&key);",
          "373:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "374:    if (Z_TYPE(key) == IS_LONG) {",
          "375:     zend_hash_index_del(ht, Z_LVAL(key));",
          "376:    } else {",
          "377:     zend_hash_del_ind(ht, Z_STR(key));",
          "378:    }",
          "379:   } else {",
          "380:    var_push_dtor(var_hash, data);",
          "381:   }",
          "383:   zval_dtor(&key);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "505:  start = cursor;",
          "509: {",
          "510:  YYCTYPE yych;",
          "511:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "508: #line 509 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "517: #line 518 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "565:  yych = *(YYMARKER = ++YYCURSOR);",
          "566:  if (yych == ':') goto yy95;",
          "567: yy3:",
          "569:  { return 0; }",
          "571: yy4:",
          "572:  yych = *(YYMARKER = ++YYCURSOR);",
          "573:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "568: #line 857 \"ext/standard/var_unserializer.re\"",
          "570: #line 571 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "577: #line 869 \"ext/standard/var_unserializer.re\"",
          "579: #line 580 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "610:  goto yy3;",
          "611: yy14:",
          "612:  ++YYCURSOR;",
          "614:  {",
          "616:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "618: }",
          "620: yy16:",
          "621:  yych = *++YYCURSOR;",
          "622:  goto yy3;",
          "",
          "[Removed Lines]",
          "613: #line 851 \"ext/standard/var_unserializer.re\"",
          "619: #line 620 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "622: #line 863 \"ext/standard/var_unserializer.re\"",
          "628: #line 629 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "646:  yych = *++YYCURSOR;",
          "647:  if (yych != '\"') goto yy18;",
          "648:  ++YYCURSOR;",
          "650:  {",
          "651:  size_t len, len2, len3, maxlen;",
          "652:  zend_long elements;",
          "",
          "[Removed Lines]",
          "649: #line 706 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "658: #line 718 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "792:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "793: }",
          "795: yy25:",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "794: #line 795 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "803: #line 804 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "816:  yych = *++YYCURSOR;",
          "817:  if (yych != '\"') goto yy18;",
          "818:  ++YYCURSOR;",
          "820:  {",
          "821:     if (!var_hash) return 0;",
          "823:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "824:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "825: }",
          "827: yy32:",
          "828:  yych = *++YYCURSOR;",
          "829:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "819: #line 699 \"ext/standard/var_unserializer.re\"",
          "826: #line 827 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "828: #line 711 \"ext/standard/var_unserializer.re\"",
          "835: #line 836 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "844:  yych = *++YYCURSOR;",
          "845:  if (yych != '{') goto yy18;",
          "846:  ++YYCURSOR;",
          "848:  {",
          "849:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "847: #line 675 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "856: #line 687 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "869:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "870: }",
          "872: yy39:",
          "873:  yych = *++YYCURSOR;",
          "874:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "871: #line 872 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "880: #line 881 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "889:  yych = *++YYCURSOR;",
          "890:  if (yych != '\"') goto yy18;",
          "891:  ++YYCURSOR;",
          "893:  {",
          "894:  size_t len, maxlen;",
          "895:  zend_string *str;",
          "",
          "[Removed Lines]",
          "892: #line 647 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "901: #line 659 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "917:  ZVAL_STR(rval, str);",
          "918:  return 1;",
          "919: }",
          "921: yy46:",
          "922:  yych = *++YYCURSOR;",
          "923:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "920: #line 921 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "929: #line 930 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych != '\"') goto yy18;",
          "940:  ++YYCURSOR;",
          "942:  {",
          "943:  size_t len, maxlen;",
          "944:  char *str;",
          "",
          "[Removed Lines]",
          "941: #line 620 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "950: #line 632 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "965:  ZVAL_STRINGL(rval, str, len);",
          "966:  return 1;",
          "967: }",
          "969: yy53:",
          "970:  yych = *++YYCURSOR;",
          "971:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "968: #line 969 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1053:  }",
          "1054: yy63:",
          "1055:  ++YYCURSOR;",
          "1057:  {",
          "1058: #if SIZEOF_ZEND_LONG == 4",
          "1059: use_double:",
          "",
          "[Removed Lines]",
          "1056: #line 611 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1065: #line 623 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1062:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1063:  return 1;",
          "1064: }",
          "1066: yy65:",
          "1067:  yych = *++YYCURSOR;",
          "1068:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1065: #line 1066 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1121:  yych = *++YYCURSOR;",
          "1122:  if (yych != ';') goto yy18;",
          "1123:  ++YYCURSOR;",
          "1125:  {",
          "",
          "[Removed Lines]",
          "1124: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1133: #line 607 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1138:  return 1;",
          "1139: }",
          "1141: yy76:",
          "1142:  yych = *++YYCURSOR;",
          "1143:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1140: #line 1141 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1149: #line 1150 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1164:  if (yych <= '9') goto yy79;",
          "1165:  if (yych != ';') goto yy18;",
          "1166:  ++YYCURSOR;",
          "1168:  {",
          "1169: #if SIZEOF_ZEND_LONG == 4",
          "1170:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1167: #line 569 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1176: #line 581 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1190:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1191:  return 1;",
          "1192: }",
          "1194: yy83:",
          "1195:  yych = *++YYCURSOR;",
          "1196:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1202: #line 1203 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych != ';') goto yy18;",
          "1200:  ++YYCURSOR;",
          "1202:  {",
          "1204:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1205:  return 1;",
          "1206: }",
          "1208: yy87:",
          "1209:  ++YYCURSOR;",
          "1211:  {",
          "1213:  ZVAL_NULL(rval);",
          "1214:  return 1;",
          "1215: }",
          "1217: yy89:",
          "1218:  yych = *++YYCURSOR;",
          "1219:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1201: #line 563 \"ext/standard/var_unserializer.re\"",
          "1207: #line 1208 \"ext/standard/var_unserializer.c\"",
          "1210: #line 557 \"ext/standard/var_unserializer.re\"",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1210: #line 575 \"ext/standard/var_unserializer.re\"",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "1219: #line 569 \"ext/standard/var_unserializer.re\"",
          "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1236:  if (yych <= '9') goto yy91;",
          "1237:  if (yych != ';') goto yy18;",
          "1238:  ++YYCURSOR;",
          "1240:  {",
          "1241:  zend_long id;",
          "",
          "[Removed Lines]",
          "1239: #line 541 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1248: #line 548 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1248:   return 0;",
          "1249:  }",
          "1251:  ZVAL_COPY(rval, rval_ref);",
          "1253:  return 1;",
          "1254: }",
          "1256: yy95:",
          "1257:  yych = *++YYCURSOR;",
          "1258:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1255: #line 1256 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1260:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1261:   ZVAL_UNDEF(rval);",
          "1262:   return 1;",
          "1263:  }",
          "1269: #line 1270 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1275:  if (yych <= '9') goto yy97;",
          "1276:  if (yych != ';') goto yy18;",
          "1277:  ++YYCURSOR;",
          "1279:  {",
          "1280:  zend_long id;",
          "",
          "[Removed Lines]",
          "1278: #line 513 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1292: #line 522 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1288:  }",
          "1290:  zval_ptr_dtor(rval);",
          "1298:   ZVAL_UNDEF(rval);",
          "1299:  } else {",
          "1300:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1301:   ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "1291:  if (Z_ISREF_P(rval_ref)) {",
          "1292:   if (!Z_ISUNDEF_P(Z_REFVAL_P(rval_ref))) {",
          "1293:    ZVAL_COPY(rval, rval_ref);",
          "1294:   } else {",
          "1295:    ZVAL_UNDEF(rval);",
          "1296:   }",
          "1297:  } else if (Z_ISUNDEF_P(rval_ref)) {",
          "",
          "[Added Lines]",
          "1305:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1307:   return 1;",
          "1308:  }",
          "1309:  if (Z_ISREF_P(rval_ref)) {",
          "1310:   ZVAL_COPY(rval, rval_ref);",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1304:  return 1;",
          "1305: }",
          "1307: }",
          "1311:  return 0;",
          "",
          "[Removed Lines]",
          "1306: #line 1307 \"ext/standard/var_unserializer.c\"",
          "1308: #line 859 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1318: #line 1319 \"ext/standard/var_unserializer.c\"",
          "1320: #line 871 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "369:    }",
          "370:   }",
          "374:   if (!php_var_unserialize_ex(data, p, max, var_hash, classes)) {",
          "375:    return 0;",
          "376:   }",
          "380:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "381:    (*p)--;",
          "",
          "[Removed Lines]",
          "372:   zval_dtor(&key);",
          "378:   var_push_dtor(var_hash, data);",
          "",
          "[Added Lines]",
          "373:    zval_dtor(&key);",
          "377:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "378:    if (Z_TYPE(key) == IS_LONG) {",
          "379:     zend_hash_index_del(ht, Z_LVAL(key));",
          "380:    } else {",
          "381:     zend_hash_del_ind(ht, Z_STR(key));",
          "382:    }",
          "383:   } else {",
          "384:    var_push_dtor(var_hash, data);",
          "385:   }",
          "387:   zval_dtor(&key);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "522:  }",
          "524:  zval_ptr_dtor(rval);",
          "532:   ZVAL_UNDEF(rval);",
          "533:  } else {",
          "534:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "535:   ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "525:  if (Z_ISREF_P(rval_ref)) {",
          "526:   if (!Z_ISUNDEF_P(Z_REFVAL_P(rval_ref))) {",
          "527:    ZVAL_COPY(rval, rval_ref);",
          "528:   } else {",
          "529:    ZVAL_UNDEF(rval);",
          "530:   }",
          "531:  } else if (Z_ISUNDEF_P(rval_ref)) {",
          "",
          "[Added Lines]",
          "534:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "536:   return 1;",
          "537:  }",
          "538:  if (Z_ISREF_P(rval_ref)) {",
          "539:   ZVAL_COPY(rval, rval_ref);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "549:   return 0;",
          "550:  }",
          "552:  ZVAL_COPY(rval, rval_ref);",
          "554:  return 1;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "559:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "560:   ZVAL_UNDEF(rval);",
          "561:   return 1;",
          "562:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e2e99f16e1cea47cc363483d26acfd41f5d2e814",
      "candidate_info": {
        "commit_hash": "e2e99f16e1cea47cc363483d26acfd41f5d2e814",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/e2e99f16e1cea47cc363483d26acfd41f5d2e814",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Cleanup: removed deprecated commented code",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "99:     return &var_hash->data[var_hash->used_slots++];",
          "100: }",
          "136: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "137: {",
          "138:  zend_long i;",
          "",
          "[Removed Lines]",
          "103: #if 0",
          "104: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "105: {",
          "106:  var_entries *var_hash;",
          "108:     if (!var_hashx || !*var_hashx) {",
          "109:         return;",
          "110:     }",
          "112:     var_hash = (*var_hashx)->last_dtor;",
          "113: #if VAR_ENTRIES_DBG",
          "114:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "115: #endif",
          "117:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "118:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "119:   var_hash->used_slots = 0;",
          "120:   var_hash->next = 0;",
          "122:   if (!(*var_hashx)->first_dtor) {",
          "123:    (*var_hashx)->first_dtor = var_hash;",
          "124:   } else {",
          "125:    ((var_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "126:   }",
          "128:   (*var_hashx)->last_dtor = var_hash;",
          "129:  }",
          "131:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "132:  var_hash->used_slots++;",
          "133: }",
          "134: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "272: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "275: #line 280 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "241: #line 246 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "539:  start = cursor;",
          "543: {",
          "544:  YYCTYPE yych;",
          "545:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "542: #line 543 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "508: #line 509 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "599:  yych = *(YYMARKER = ++YYCURSOR);",
          "600:  if (yych == ':') goto yy95;",
          "601: yy3:",
          "603:  { return 0; }",
          "605: yy4:",
          "606:  yych = *(YYMARKER = ++YYCURSOR);",
          "607:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "602: #line 895 \"ext/standard/var_unserializer.re\"",
          "604: #line 605 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "568: #line 851 \"ext/standard/var_unserializer.re\"",
          "570: #line 571 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "644:  goto yy3;",
          "645: yy14:",
          "646:  ++YYCURSOR;",
          "648:  {",
          "650:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "652: }",
          "654: yy16:",
          "655:  yych = *++YYCURSOR;",
          "656:  goto yy3;",
          "",
          "[Removed Lines]",
          "647: #line 889 \"ext/standard/var_unserializer.re\"",
          "653: #line 654 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "613: #line 845 \"ext/standard/var_unserializer.re\"",
          "619: #line 620 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "680:  yych = *++YYCURSOR;",
          "681:  if (yych != '\"') goto yy18;",
          "682:  ++YYCURSOR;",
          "684:  {",
          "685:  size_t len, len2, len3, maxlen;",
          "686:  zend_long elements;",
          "",
          "[Removed Lines]",
          "683: #line 743 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "649: #line 700 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "827:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "828: }",
          "830: yy25:",
          "831:  yych = *++YYCURSOR;",
          "832:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "829: #line 830 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "794: #line 795 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "851:  yych = *++YYCURSOR;",
          "852:  if (yych != '\"') goto yy18;",
          "853:  ++YYCURSOR;",
          "855:  {",
          "856:     if (!var_hash) return 0;",
          "860:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "861:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "862: }",
          "864: yy32:",
          "865:  yych = *++YYCURSOR;",
          "866:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "854: #line 734 \"ext/standard/var_unserializer.re\"",
          "863: #line 864 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "819: #line 693 \"ext/standard/var_unserializer.re\"",
          "826: #line 827 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "881:  yych = *++YYCURSOR;",
          "882:  if (yych != '{') goto yy18;",
          "883:  ++YYCURSOR;",
          "885:  {",
          "886:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "884: #line 710 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "847: #line 669 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "906:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "907: }",
          "909: yy39:",
          "910:  yych = *++YYCURSOR;",
          "911:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "908: #line 909 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "871: #line 872 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "926:  yych = *++YYCURSOR;",
          "927:  if (yych != '\"') goto yy18;",
          "928:  ++YYCURSOR;",
          "930:  {",
          "931:  size_t len, maxlen;",
          "932:  zend_string *str;",
          "",
          "[Removed Lines]",
          "929: #line 682 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "892: #line 641 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "954:  ZVAL_STR(rval, str);",
          "955:  return 1;",
          "956: }",
          "958: yy46:",
          "959:  yych = *++YYCURSOR;",
          "960:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "957: #line 958 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "920: #line 921 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "975:  yych = *++YYCURSOR;",
          "976:  if (yych != '\"') goto yy18;",
          "977:  ++YYCURSOR;",
          "979:  {",
          "980:  size_t len, maxlen;",
          "981:  char *str;",
          "",
          "[Removed Lines]",
          "978: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "941: #line 614 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1002:  ZVAL_STRINGL(rval, str, len);",
          "1003:  return 1;",
          "1004: }",
          "1006: yy53:",
          "1007:  yych = *++YYCURSOR;",
          "1008:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "1005: #line 1006 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "968: #line 969 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1090:  }",
          "1091: yy63:",
          "1092:  ++YYCURSOR;",
          "1094:  {",
          "1095: #if SIZEOF_ZEND_LONG == 4",
          "1096: use_double:",
          "",
          "[Removed Lines]",
          "1093: #line 646 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1056: #line 605 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1099:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1100:  return 1;",
          "1101: }",
          "1103: yy65:",
          "1104:  yych = *++YYCURSOR;",
          "1105:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1102: #line 1103 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1065: #line 1066 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1158:  yych = *++YYCURSOR;",
          "1159:  if (yych != ';') goto yy18;",
          "1160:  ++YYCURSOR;",
          "1162:  {",
          "",
          "[Removed Lines]",
          "1161: #line 630 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1124: #line 589 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1175:  return 1;",
          "1176: }",
          "1178: yy76:",
          "1179:  yych = *++YYCURSOR;",
          "1180:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1177: #line 1178 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1140: #line 1141 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1201:  if (yych <= '9') goto yy79;",
          "1202:  if (yych != ';') goto yy18;",
          "1203:  ++YYCURSOR;",
          "1205:  {",
          "1206: #if SIZEOF_ZEND_LONG == 4",
          "1207:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1204: #line 604 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1167: #line 563 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1227:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1228:  return 1;",
          "1229: }",
          "1231: yy83:",
          "1232:  yych = *++YYCURSOR;",
          "1233:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1235:  yych = *++YYCURSOR;",
          "1236:  if (yych != ';') goto yy18;",
          "1237:  ++YYCURSOR;",
          "1239:  {",
          "1241:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1242:  return 1;",
          "1243: }",
          "1245: yy87:",
          "1246:  ++YYCURSOR;",
          "1248:  {",
          "1250:  ZVAL_NULL(rval);",
          "1251:  return 1;",
          "1252: }",
          "1254: yy89:",
          "1255:  yych = *++YYCURSOR;",
          "1256:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1238: #line 598 \"ext/standard/var_unserializer.re\"",
          "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
          "1247: #line 592 \"ext/standard/var_unserializer.re\"",
          "1253: #line 1254 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1201: #line 557 \"ext/standard/var_unserializer.re\"",
          "1207: #line 1208 \"ext/standard/var_unserializer.c\"",
          "1210: #line 551 \"ext/standard/var_unserializer.re\"",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1273:  if (yych <= '9') goto yy91;",
          "1274:  if (yych != ';') goto yy18;",
          "1275:  ++YYCURSOR;",
          "1277:  {",
          "1278:  zend_long id;",
          "",
          "[Removed Lines]",
          "1276: #line 569 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1239: #line 535 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1285:   return 0;",
          "1286:  }",
          "1294:  ZVAL_COPY(rval, rval_ref);",
          "1297:  return 1;",
          "1298: }",
          "1300: yy95:",
          "1301:  yych = *++YYCURSOR;",
          "1302:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1299: #line 1300 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1255: #line 1256 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1319:  if (yych <= '9') goto yy97;",
          "1320:  if (yych != ';') goto yy18;",
          "1321:  ++YYCURSOR;",
          "1323:  {",
          "1324:  zend_long id;",
          "",
          "[Removed Lines]",
          "1322: #line 547 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1278: #line 513 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1342:  return 1;",
          "1343: }",
          "1345: }",
          "1349:  return 0;",
          "",
          "[Removed Lines]",
          "1344: #line 1345 \"ext/standard/var_unserializer.c\"",
          "1346: #line 897 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1300: #line 1301 \"ext/standard/var_unserializer.c\"",
          "1302: #line 853 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "97:     return &var_hash->data[var_hash->used_slots++];",
          "98: }",
          "134: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "135: {",
          "136:  zend_long i;",
          "",
          "[Removed Lines]",
          "101: #if 0",
          "102: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "103: {",
          "104:  var_entries *var_hash;",
          "106:     if (!var_hashx || !*var_hashx) {",
          "107:         return;",
          "108:     }",
          "110:     var_hash = (*var_hashx)->last_dtor;",
          "111: #if VAR_ENTRIES_DBG",
          "112:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "113: #endif",
          "115:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "116:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "117:   var_hash->used_slots = 0;",
          "118:   var_hash->next = 0;",
          "120:   if (!(*var_hashx)->first_dtor) {",
          "121:    (*var_hashx)->first_dtor = var_hash;",
          "122:   } else {",
          "123:    ((var_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "124:   }",
          "126:   (*var_hashx)->last_dtor = var_hash;",
          "127:  }",
          "129:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "130:  var_hash->used_slots++;",
          "131: }",
          "132: #endif",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8522e2894edd52322148945261433e79a3ec3f88",
      "candidate_info": {
        "commit_hash": "8522e2894edd52322148945261433e79a3ec3f88",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/8522e2894edd52322148945261433e79a3ec3f88",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Make sure lengths and refs are unsigned in unserialize()",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "361:  unsigned char cursor;",
          "362:  size_t result = 0;",
          "368:  while (1) {",
          "369:   cursor = *p;",
          "370:   if (cursor >= '0' && cursor <= '9') {",
          "",
          "[Removed Lines]",
          "364:  if (*p == '+') {",
          "365:   p++;",
          "366:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "618:  start = cursor;",
          "622: {",
          "623:  YYCTYPE yych;",
          "624:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "621: #line 622 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "617: #line 618 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "676: yy2:",
          "677:  ++YYCURSOR;",
          "678: yy3:",
          "680:  { return 0; }",
          "682: yy4:",
          "683:  yych = *(YYMARKER = ++YYCURSOR);",
          "684:  if (yych == ':') goto yy17;",
          "",
          "[Removed Lines]",
          "679: #line 1005 \"ext/standard/var_unserializer.re\"",
          "681: #line 682 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "675: #line 1001 \"ext/standard/var_unserializer.re\"",
          "677: #line 678 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "725:  goto yy3;",
          "726: yy15:",
          "727:  ++YYCURSOR;",
          "729:  {",
          "731:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "733: }",
          "735: yy17:",
          "736:  yych = *++YYCURSOR;",
          "737:  if (yybm[0+yych] & 128) {",
          "739:  }",
          "741: yy18:",
          "742:  YYCURSOR = YYMARKER;",
          "743:  goto yy3;",
          "744: yy19:",
          "745:  ++YYCURSOR;",
          "747:  {",
          "749:  ZVAL_NULL(rval);",
          "750:  return 1;",
          "751: }",
          "753: yy21:",
          "754:  yych = *++YYCURSOR;",
          "764: yy22:",
          "765:  yych = *++YYCURSOR;",
          "767:  if (yych <= '/') goto yy18;",
          "769:  goto yy18;",
          "770: yy23:",
          "771:  yych = *++YYCURSOR;",
          "773:  if (yych <= '/') goto yy18;",
          "775:  goto yy18;",
          "776: yy24:",
          "777:  yych = *++YYCURSOR;",
          "778:  if (yych <= '/') goto yy18;",
          "780:  goto yy18;",
          "781: yy25:",
          "782:  yych = *++YYCURSOR;",
          "783:  if (yych <= '/') {",
          "784:   if (yych <= ',') {",
          "786:    goto yy18;",
          "787:   } else {",
          "790:    goto yy18;",
          "791:   }",
          "792:  } else {",
          "793:   if (yych <= 'I') {",
          "795:    if (yych <= 'H') goto yy18;",
          "797:   } else {",
          "799:    goto yy18;",
          "800:   }",
          "801:  }",
          "802: yy26:",
          "803:  yych = *++YYCURSOR;",
          "804:  if (yych <= ',') {",
          "806:   goto yy18;",
          "807:  } else {",
          "809:   if (yych <= '/') goto yy18;",
          "811:   goto yy18;",
          "812:  }",
          "813: yy27:",
          "814:  yych = *++YYCURSOR;",
          "824: yy28:",
          "825:  yych = *++YYCURSOR;",
          "835: yy29:",
          "836:  yych = *++YYCURSOR;",
          "838:  if (yych <= '/') goto yy18;",
          "840:  goto yy18;",
          "841: yy30:",
          "848:  ++YYCURSOR;",
          "849:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "850:  yych = *YYCURSOR;",
          "851:  if (yybm[0+yych] & 128) {",
          "853:  }",
          "854:  if (yych <= '/') goto yy18;",
          "856:  goto yy18;",
          "862:  ++YYCURSOR;",
          "863:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "864:  yych = *YYCURSOR;",
          "865:  if (yych <= '/') goto yy18;",
          "868:  goto yy18;",
          "874:  ++YYCURSOR;",
          "875:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "876:  yych = *YYCURSOR;",
          "877:  if (yych <= '/') goto yy18;",
          "880:  goto yy18;",
          "886:  ++YYCURSOR;",
          "887:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "888:  yych = *YYCURSOR;",
          "889:  if (yych <= '/') goto yy18;",
          "892:  goto yy18;",
          "894:  yych = *++YYCURSOR;",
          "896:  goto yy18;",
          "898:  yych = *++YYCURSOR;",
          "900:  if (yych <= '/') goto yy18;",
          "902:  goto yy18;",
          "904:  yych = *++YYCURSOR;",
          "905:  if (yych <= '/') {",
          "906:   if (yych != '.') goto yy18;",
          "907:  } else {",
          "910:   goto yy18;",
          "911:  }",
          "913:  yych = *++YYCURSOR;",
          "914:  if (yych <= '/') goto yy18;",
          "916:  goto yy18;",
          "918:  ++YYCURSOR;",
          "919:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "920:  yych = *YYCURSOR;",
          "921:  if (yych <= ':') {",
          "922:   if (yych <= '.') {",
          "923:    if (yych <= '-') goto yy18;",
          "925:   } else {",
          "926:    if (yych <= '/') goto yy18;",
          "928:    goto yy18;",
          "929:   }",
          "930:  } else {",
          "931:   if (yych <= 'E') {",
          "933:    if (yych <= 'D') goto yy18;",
          "935:   } else {",
          "937:    goto yy18;",
          "938:   }",
          "939:  }",
          "941:  yych = *++YYCURSOR;",
          "943:  goto yy18;",
          "945:  yych = *++YYCURSOR;",
          "947:  goto yy18;",
          "949:  yych = *++YYCURSOR;",
          "950:  if (yych <= '/') goto yy18;",
          "951:  if (yych >= ':') goto yy18;",
          "953:  ++YYCURSOR;",
          "954:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "955:  yych = *YYCURSOR;",
          "956:  if (yych <= '/') goto yy18;",
          "959:  goto yy18;",
          "965:  ++YYCURSOR;",
          "966:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "967:  yych = *YYCURSOR;",
          "968:  if (yych <= '/') goto yy18;",
          "971:  goto yy18;",
          "977:  ++YYCURSOR;",
          "978:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "979:  yych = *YYCURSOR;",
          "980:  if (yych <= '/') goto yy18;",
          "983:  goto yy18;",
          "989:  ++YYCURSOR;",
          "990:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "991:  yych = *YYCURSOR;",
          "992:  if (yych <= '/') goto yy18;",
          "995:  goto yy18;",
          "997:  yych = *++YYCURSOR;",
          "999:  goto yy18;",
          "1001:  ++YYCURSOR;",
          "1003:  {",
          "1004:  zend_long id;",
          "1007:  if (!var_hash) return 0;",
          "1010:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1011:   return 0;",
          "1012:  }",
          "",
          "[Removed Lines]",
          "728: #line 999 \"ext/standard/var_unserializer.re\"",
          "734: #line 735 \"ext/standard/var_unserializer.c\"",
          "738:   goto yy31;",
          "740:  if (yych == '+') goto yy30;",
          "746: #line 677 \"ext/standard/var_unserializer.re\"",
          "752: #line 753 \"ext/standard/var_unserializer.c\"",
          "755:  if (yych <= ',') {",
          "756:   if (yych == '+') goto yy33;",
          "757:   goto yy18;",
          "758:  } else {",
          "759:   if (yych <= '-') goto yy33;",
          "760:   if (yych <= '/') goto yy18;",
          "761:   if (yych <= '9') goto yy34;",
          "762:   goto yy18;",
          "763:  }",
          "766:  if (yych == '+') goto yy36;",
          "768:  if (yych <= '9') goto yy37;",
          "772:  if (yych == '+') goto yy39;",
          "774:  if (yych <= '9') goto yy40;",
          "779:  if (yych <= '1') goto yy42;",
          "785:    if (yych == '+') goto yy43;",
          "788:    if (yych <= '-') goto yy44;",
          "789:    if (yych <= '.') goto yy45;",
          "794:    if (yych <= '9') goto yy46;",
          "796:    goto yy48;",
          "798:    if (yych == 'N') goto yy49;",
          "805:   if (yych == '+') goto yy50;",
          "808:   if (yych <= '-') goto yy50;",
          "810:   if (yych <= '9') goto yy51;",
          "815:  if (yych <= ',') {",
          "816:   if (yych == '+') goto yy53;",
          "817:   goto yy18;",
          "818:  } else {",
          "819:   if (yych <= '-') goto yy53;",
          "820:   if (yych <= '/') goto yy18;",
          "821:   if (yych <= '9') goto yy54;",
          "822:   goto yy18;",
          "823:  }",
          "826:  if (yych <= ',') {",
          "827:   if (yych == '+') goto yy56;",
          "828:   goto yy18;",
          "829:  } else {",
          "830:   if (yych <= '-') goto yy56;",
          "831:   if (yych <= '/') goto yy18;",
          "832:   if (yych <= '9') goto yy57;",
          "833:   goto yy18;",
          "834:  }",
          "837:  if (yych == '+') goto yy59;",
          "839:  if (yych <= '9') goto yy60;",
          "842:  yych = *++YYCURSOR;",
          "843:  if (yybm[0+yych] & 128) {",
          "844:   goto yy31;",
          "845:  }",
          "846:  goto yy18;",
          "847: yy31:",
          "852:   goto yy31;",
          "855:  if (yych <= ':') goto yy62;",
          "857: yy33:",
          "858:  yych = *++YYCURSOR;",
          "859:  if (yych <= '/') goto yy18;",
          "860:  if (yych >= ':') goto yy18;",
          "861: yy34:",
          "866:  if (yych <= '9') goto yy34;",
          "867:  if (yych == ';') goto yy63;",
          "869: yy36:",
          "870:  yych = *++YYCURSOR;",
          "871:  if (yych <= '/') goto yy18;",
          "872:  if (yych >= ':') goto yy18;",
          "873: yy37:",
          "878:  if (yych <= '9') goto yy37;",
          "879:  if (yych <= ':') goto yy65;",
          "881: yy39:",
          "882:  yych = *++YYCURSOR;",
          "883:  if (yych <= '/') goto yy18;",
          "884:  if (yych >= ':') goto yy18;",
          "885: yy40:",
          "890:  if (yych <= '9') goto yy40;",
          "891:  if (yych <= ':') goto yy66;",
          "893: yy42:",
          "895:  if (yych == ';') goto yy67;",
          "897: yy43:",
          "899:  if (yych == '.') goto yy45;",
          "901:  if (yych <= '9') goto yy46;",
          "903: yy44:",
          "908:   if (yych <= '9') goto yy46;",
          "909:   if (yych == 'I') goto yy48;",
          "912: yy45:",
          "915:  if (yych <= '9') goto yy69;",
          "917: yy46:",
          "924:    goto yy69;",
          "927:    if (yych <= '9') goto yy46;",
          "932:    if (yych <= ';') goto yy71;",
          "934:    goto yy73;",
          "936:    if (yych == 'e') goto yy73;",
          "940: yy48:",
          "942:  if (yych == 'N') goto yy74;",
          "944: yy49:",
          "946:  if (yych == 'A') goto yy75;",
          "948: yy50:",
          "952: yy51:",
          "957:  if (yych <= '9') goto yy51;",
          "958:  if (yych == ';') goto yy76;",
          "960: yy53:",
          "961:  yych = *++YYCURSOR;",
          "962:  if (yych <= '/') goto yy18;",
          "963:  if (yych >= ':') goto yy18;",
          "964: yy54:",
          "969:  if (yych <= '9') goto yy54;",
          "970:  if (yych <= ':') goto yy78;",
          "972: yy56:",
          "973:  yych = *++YYCURSOR;",
          "974:  if (yych <= '/') goto yy18;",
          "975:  if (yych >= ':') goto yy18;",
          "976: yy57:",
          "981:  if (yych <= '9') goto yy57;",
          "982:  if (yych == ';') goto yy79;",
          "984: yy59:",
          "985:  yych = *++YYCURSOR;",
          "986:  if (yych <= '/') goto yy18;",
          "987:  if (yych >= ':') goto yy18;",
          "988: yy60:",
          "993:  if (yych <= '9') goto yy60;",
          "994:  if (yych <= ':') goto yy81;",
          "996: yy62:",
          "998:  if (yych == '\"') goto yy82;",
          "1000: yy63:",
          "1002: #line 626 \"ext/standard/var_unserializer.re\"",
          "1009:  id = parse_iv(start + 2) - 1;",
          "",
          "[Added Lines]",
          "724: #line 995 \"ext/standard/var_unserializer.re\"",
          "730: #line 731 \"ext/standard/var_unserializer.c\"",
          "734:   goto yy30;",
          "741: #line 673 \"ext/standard/var_unserializer.re\"",
          "747: #line 748 \"ext/standard/var_unserializer.c\"",
          "750:  if (yych <= '/') goto yy18;",
          "751:  if (yych <= '9') goto yy32;",
          "752:  goto yy18;",
          "756:  if (yych <= '9') goto yy34;",
          "761:  if (yych <= '9') goto yy36;",
          "766:  if (yych <= '1') goto yy38;",
          "772:    if (yych == '+') goto yy39;",
          "775:    if (yych <= '-') goto yy40;",
          "776:    if (yych <= '.') goto yy41;",
          "781:    if (yych <= '9') goto yy42;",
          "783:    goto yy44;",
          "785:    if (yych == 'N') goto yy45;",
          "792:   if (yych == '+') goto yy46;",
          "795:   if (yych <= '-') goto yy46;",
          "797:   if (yych <= '9') goto yy47;",
          "802:  if (yych <= '/') goto yy18;",
          "803:  if (yych <= '9') goto yy49;",
          "804:  goto yy18;",
          "807:  if (yych <= '/') goto yy18;",
          "808:  if (yych <= '9') goto yy51;",
          "809:  goto yy18;",
          "813:  if (yych <= '9') goto yy53;",
          "820:   goto yy30;",
          "823:  if (yych <= ':') goto yy55;",
          "825: yy32:",
          "830:  if (yych <= '9') goto yy32;",
          "831:  if (yych == ';') goto yy56;",
          "833: yy34:",
          "838:  if (yych <= '9') goto yy34;",
          "839:  if (yych <= ':') goto yy58;",
          "841: yy36:",
          "846:  if (yych <= '9') goto yy36;",
          "847:  if (yych <= ':') goto yy59;",
          "849: yy38:",
          "851:  if (yych == ';') goto yy60;",
          "853: yy39:",
          "855:  if (yych == '.') goto yy41;",
          "857:  if (yych <= '9') goto yy42;",
          "859: yy40:",
          "864:   if (yych <= '9') goto yy42;",
          "865:   if (yych == 'I') goto yy44;",
          "868: yy41:",
          "871:  if (yych <= '9') goto yy62;",
          "873: yy42:",
          "880:    goto yy62;",
          "883:    if (yych <= '9') goto yy42;",
          "888:    if (yych <= ';') goto yy64;",
          "890:    goto yy66;",
          "892:    if (yych == 'e') goto yy66;",
          "896: yy44:",
          "898:  if (yych == 'N') goto yy67;",
          "900: yy45:",
          "902:  if (yych == 'A') goto yy68;",
          "904: yy46:",
          "908: yy47:",
          "913:  if (yych <= '9') goto yy47;",
          "914:  if (yych == ';') goto yy69;",
          "916: yy49:",
          "921:  if (yych <= '9') goto yy49;",
          "922:  if (yych <= ':') goto yy71;",
          "924: yy51:",
          "929:  if (yych <= '9') goto yy51;",
          "930:  if (yych == ';') goto yy72;",
          "932: yy53:",
          "937:  if (yych <= '9') goto yy53;",
          "938:  if (yych <= ':') goto yy74;",
          "940: yy55:",
          "942:  if (yych == '\"') goto yy75;",
          "944: yy56:",
          "946: #line 622 \"ext/standard/var_unserializer.re\"",
          "953:  id = parse_uiv(start + 2) - 1;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1026:  return 1;",
          "1027: }",
          "1030:  yych = *++YYCURSOR;",
          "1032:  goto yy18;",
          "1034:  yych = *++YYCURSOR;",
          "1036:  goto yy18;",
          "1038:  ++YYCURSOR;",
          "1040:  {",
          "1042:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1043:  return 1;",
          "1044: }",
          "1047:  ++YYCURSOR;",
          "1048:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "1049:  yych = *YYCURSOR;",
          "1050:  if (yych <= ';') {",
          "1051:   if (yych <= '/') goto yy18;",
          "1053:   if (yych <= ':') goto yy18;",
          "1054:  } else {",
          "1055:   if (yych <= 'E') {",
          "1056:    if (yych <= 'D') goto yy18;",
          "1058:   } else {",
          "1060:    goto yy18;",
          "1061:   }",
          "1062:  }",
          "1064:  ++YYCURSOR;",
          "1066:  {",
          "1067: #if SIZEOF_ZEND_LONG == 4",
          "1068: use_double:",
          "",
          "[Removed Lines]",
          "1028: #line 1029 \"ext/standard/var_unserializer.c\"",
          "1029: yy65:",
          "1031:  if (yych == '\"') goto yy84;",
          "1033: yy66:",
          "1035:  if (yych == '{') goto yy86;",
          "1037: yy67:",
          "1039: #line 683 \"ext/standard/var_unserializer.re\"",
          "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
          "1046: yy69:",
          "1052:   if (yych <= '9') goto yy69;",
          "1057:    goto yy73;",
          "1059:    if (yych == 'e') goto yy73;",
          "1063: yy71:",
          "1065: #line 731 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "972: #line 973 \"ext/standard/var_unserializer.c\"",
          "973: yy58:",
          "975:  if (yych == '\"') goto yy77;",
          "977: yy59:",
          "979:  if (yych == '{') goto yy79;",
          "981: yy60:",
          "983: #line 679 \"ext/standard/var_unserializer.re\"",
          "989: #line 990 \"ext/standard/var_unserializer.c\"",
          "990: yy62:",
          "996:   if (yych <= '9') goto yy62;",
          "1001:    goto yy66;",
          "1003:    if (yych == 'e') goto yy66;",
          "1007: yy64:",
          "1009: #line 727 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1071:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1072:  return 1;",
          "1073: }",
          "1076:  yych = *++YYCURSOR;",
          "1077:  if (yych <= ',') {",
          "1079:   goto yy18;",
          "1080:  } else {",
          "1082:   if (yych <= '/') goto yy18;",
          "1084:   goto yy18;",
          "1085:  }",
          "1087:  yych = *++YYCURSOR;",
          "1089:  goto yy18;",
          "1091:  yych = *++YYCURSOR;",
          "1093:  goto yy18;",
          "1095:  ++YYCURSOR;",
          "1097:  {",
          "1098: #if SIZEOF_ZEND_LONG == 4",
          "1099:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "1075: yy73:",
          "1078:   if (yych == '+') goto yy88;",
          "1081:   if (yych <= '-') goto yy88;",
          "1083:   if (yych <= '9') goto yy89;",
          "1086: yy74:",
          "1088:  if (yych == 'F') goto yy91;",
          "1090: yy75:",
          "1092:  if (yych == 'N') goto yy91;",
          "1094: yy76:",
          "1096: #line 689 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1018: #line 1019 \"ext/standard/var_unserializer.c\"",
          "1019: yy66:",
          "1022:   if (yych == '+') goto yy81;",
          "1025:   if (yych <= '-') goto yy81;",
          "1027:   if (yych <= '9') goto yy82;",
          "1030: yy67:",
          "1032:  if (yych == 'F') goto yy84;",
          "1034: yy68:",
          "1036:  if (yych == 'N') goto yy84;",
          "1038: yy69:",
          "1040: #line 685 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1119:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1120:  return 1;",
          "1121: }",
          "1124:  yych = *++YYCURSOR;",
          "1126:  goto yy18;",
          "1128:  ++YYCURSOR;",
          "1130:  {",
          "1131:  zend_long id;",
          "1134:  if (!var_hash) return 0;",
          "1137:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1138:   return 0;",
          "1139:  }",
          "",
          "[Removed Lines]",
          "1122: #line 1123 \"ext/standard/var_unserializer.c\"",
          "1123: yy78:",
          "1125:  if (yych == '\"') goto yy92;",
          "1127: yy79:",
          "1129: #line 652 \"ext/standard/var_unserializer.re\"",
          "1136:  id = parse_iv(start + 2) - 1;",
          "",
          "[Added Lines]",
          "1066: #line 1067 \"ext/standard/var_unserializer.c\"",
          "1067: yy71:",
          "1069:  if (yych == '\"') goto yy85;",
          "1071: yy72:",
          "1073: #line 648 \"ext/standard/var_unserializer.re\"",
          "1080:  id = parse_uiv(start + 2) - 1;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1152:  return 1;",
          "1153: }",
          "1156:  yych = *++YYCURSOR;",
          "1158:  goto yy18;",
          "1160:  ++YYCURSOR;",
          "1162:  {",
          "1163:  size_t len, len2, len3, maxlen;",
          "1164:  zend_long elements;",
          "",
          "[Removed Lines]",
          "1154: #line 1155 \"ext/standard/var_unserializer.c\"",
          "1155: yy81:",
          "1157:  if (yych == '\"') goto yy94;",
          "1159: yy82:",
          "1161: #line 847 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1098: #line 1099 \"ext/standard/var_unserializer.c\"",
          "1099: yy74:",
          "1101:  if (yych == '\"') goto yy87;",
          "1103: yy75:",
          "1105: #line 843 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1311:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1312: }",
          "1315:  ++YYCURSOR;",
          "1317:  {",
          "1318:  size_t len, maxlen;",
          "1319:  zend_string *str;",
          "",
          "[Removed Lines]",
          "1313: #line 1314 \"ext/standard/var_unserializer.c\"",
          "1314: yy84:",
          "1316: #line 772 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1257: #line 1258 \"ext/standard/var_unserializer.c\"",
          "1258: yy77:",
          "1260: #line 768 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1347:  ZVAL_STR(rval, str);",
          "1348:  return 1;",
          "1349: }",
          "1352:  ++YYCURSOR;",
          "1354:  {",
          "1355:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "1350: #line 1351 \"ext/standard/var_unserializer.c\"",
          "1351: yy86:",
          "1353: #line 806 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1294: #line 1295 \"ext/standard/var_unserializer.c\"",
          "1295: yy79:",
          "1297: #line 802 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1381:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1382: }",
          "1385:  yych = *++YYCURSOR;",
          "1386:  if (yych <= '/') goto yy18;",
          "1387:  if (yych >= ':') goto yy18;",
          "1389:  ++YYCURSOR;",
          "1390:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1391:  yych = *YYCURSOR;",
          "1392:  if (yych <= '/') goto yy18;",
          "1395:  goto yy18;",
          "1397:  yych = *++YYCURSOR;",
          "1399:  goto yy18;",
          "1401:  ++YYCURSOR;",
          "1403:  {",
          "1404:  long elements;",
          "1405:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1383: #line 1384 \"ext/standard/var_unserializer.c\"",
          "1384: yy88:",
          "1388: yy89:",
          "1393:  if (yych <= '9') goto yy89;",
          "1394:  if (yych == ';') goto yy71;",
          "1396: yy91:",
          "1398:  if (yych == ';') goto yy96;",
          "1400: yy92:",
          "1402: #line 836 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1327: #line 1328 \"ext/standard/var_unserializer.c\"",
          "1328: yy81:",
          "1332: yy82:",
          "1337:  if (yych <= '9') goto yy82;",
          "1338:  if (yych == ';') goto yy64;",
          "1340: yy84:",
          "1342:  if (yych == ';') goto yy89;",
          "1344: yy85:",
          "1346: #line 832 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1410:  }",
          "1411:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1412: }",
          "1415:  ++YYCURSOR;",
          "1417:  {",
          "1418:  size_t len, maxlen;",
          "1419:  char *str;",
          "",
          "[Removed Lines]",
          "1413: #line 1414 \"ext/standard/var_unserializer.c\"",
          "1414: yy94:",
          "1416: #line 740 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1357: #line 1358 \"ext/standard/var_unserializer.c\"",
          "1358: yy87:",
          "1360: #line 736 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1445:  ZVAL_STRINGL(rval, str, len);",
          "1446:  return 1;",
          "1447: }",
          "1450:  ++YYCURSOR;",
          "1452:  {",
          "",
          "[Removed Lines]",
          "1448: #line 1449 \"ext/standard/var_unserializer.c\"",
          "1449: yy96:",
          "1451: #line 715 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1392: #line 1393 \"ext/standard/var_unserializer.c\"",
          "1393: yy89:",
          "1395: #line 711 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1465:  return 1;",
          "1466: }",
          "1468: }",
          "1472:  return 0;",
          "",
          "[Removed Lines]",
          "1467: #line 1468 \"ext/standard/var_unserializer.c\"",
          "1469: #line 1007 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1411: #line 1412 \"ext/standard/var_unserializer.c\"",
          "1413: #line 1003 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "320: iv = [+-]? [0-9]+;",
          "321: nv = [+-]? ([0-9]* \".\" [0-9]+|[0-9]+ \".\" [0-9]*);",
          "322: nvexp = (iv | nv) [eE] iv;",
          "",
          "[Removed Lines]",
          "319: uiv = [+]? [0-9]+;",
          "",
          "[Added Lines]",
          "319: uiv = [0-9]+;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "365:  unsigned char cursor;",
          "366:  size_t result = 0;",
          "372:  while (1) {",
          "373:   cursor = *p;",
          "374:   if (cursor >= '0' && cursor <= '9') {",
          "",
          "[Removed Lines]",
          "368:  if (*p == '+') {",
          "369:   p++;",
          "370:  }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "627:  zend_long id;",
          "630:  if (!var_hash) return 0;",
          "633:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "634:   return 0;",
          "635:  }",
          "",
          "[Removed Lines]",
          "626: \"R:\" iv \";\"  {",
          "632:  id = parse_iv(start + 2) - 1;",
          "",
          "[Added Lines]",
          "622: \"R:\" uiv \";\"  {",
          "628:  id = parse_uiv(start + 2) - 1;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "649:  return 1;",
          "650: }",
          "653:  zend_long id;",
          "656:  if (!var_hash) return 0;",
          "659:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "660:   return 0;",
          "661:  }",
          "",
          "[Removed Lines]",
          "652: \"r:\" iv \";\"  {",
          "658:  id = parse_iv(start + 2) - 1;",
          "",
          "[Added Lines]",
          "648: \"r:\" uiv \";\"  {",
          "654:  id = parse_uiv(start + 2) - 1;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "833:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "834: }",
          "837:  long elements;",
          "838:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "836: \"o:\" iv \":\" [\"] {",
          "",
          "[Added Lines]",
          "832: \"o:\" uiv \":\" [\"] {",
          "",
          "---------------"
        ]
      }
    }
  ]
}