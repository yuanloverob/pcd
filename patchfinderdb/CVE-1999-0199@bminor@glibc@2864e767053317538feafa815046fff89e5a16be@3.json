{
  "cve_id": "CVE-1999-0199",
  "cve_desc": "manual/search.texi in the GNU C Library (aka glibc) before 2.2 lacks a statement about the unspecified tdelete return value upon deletion of a tree's root, which might allow attackers to access a dangling pointer in an application whose developer was unaware of a documentation update from 1999.",
  "repo": "bminor/glibc",
  "patch_hash": "2864e767053317538feafa815046fff89e5a16be",
  "patch_info": {
    "commit_hash": "2864e767053317538feafa815046fff89e5a16be",
    "repo": "bminor/glibc",
    "commit_url": "https://github.com/bminor/glibc/commit/2864e767053317538feafa815046fff89e5a16be",
    "files": [
      "ChangeLog",
      "elf/dl-load.c",
      "manual/search.texi",
      "misc/syslog.c",
      "posix/Makefile",
      "posix/regex.c",
      "posix/tst-getlogin.c",
      "sysdeps/unix/getlogin_r.c",
      "sysdeps/unix/sysv/linux/bits/resource.h",
      "timezone/africa",
      "timezone/asia",
      "timezone/australasia",
      "timezone/backward",
      "timezone/checktab.awk",
      "timezone/europe",
      "timezone/iso3166.tab",
      "timezone/northamerica",
      "timezone/southamerica",
      "timezone/zone.tab"
    ],
    "message": "Update.\n\n1999-11-09  Ulrich Drepper  <drepper@cygnus.com>\n\n\t* elf/dl-load.c (_dl_dst_count): Allow $ORIGIN to point to\n\tdirectory with the reference since this is as secure as using the\n\tobject with the dependency.\n\t(_dl_dst_substitute): Likewise.\n\n\t* elf/dl-load.c (_dl_dst_count): Change strings in first two\n\tstrncmp calls to allow reuse.\n\t(_dl_dst_substitute): Likewise.\n\n1999-11-01  Arnold D. Robbins  <arnold@skeeve.com>\n\n\t* posix/regex.c (init_syntax_once): move below definition of\n\tISALNUM etc., then use ISALNUM to init the table, so that\n\tthe word ops will work if i18n'ed.\n\t(SYNTAX): And subscript with 0xFF for 8bit character sets.\n\n1999-11-09  Andreas Jaeger  <aj@suse.de>\n\n\t* sysdeps/unix/getlogin_r.c (getlogin_r): Sync with getlogin\n\timplementation for ttyname_r call; fix inverted condition; return\n\tut_user.  Closes PR libc/1438.\n\n1999-11-09  Ulrich Drepper  <drepper@cygnus.com>\n\n\t* timezone/checktab.awk: Update from tzcode1999h.\n\t* timezone/africa: Update from tzdata1999i.\n\t* timezone/asia: Likewise.\n\t* timezone/australasia: Likewise.\n\t* timezone/backward: Likewise.\n\t* timezone/europe: Likewise.\n\t* timezone/northamerica: Likewise.\n\t* timezone/southamerica: Likewise.\n\t* timezone/iso3166.tab: Likewise.\n\t* timezone/zone.tab: Likewise.\n\n\t* sysdeps/unix/sysv/linux/bits/resource.h: Define values also as\n\tmacros.  Patch by brg@csua.berkeley.edu [PR libc/1439].\n\n1999-11-09  Andreas Jaeger  <aj@suse.de>\n\n\t* posix/Makefile (tests): Added tst-getlogin.\n\n\t* posix/tst-getlogin.c: New file, contains simple tests for\n\tgetlogin and getlogin_r.\n\n1999-11-09  Andreas Schwab  <schwab@suse.de>\n\n\t* misc/syslog.c: For LOG_PERROR only append a newline if\n\tnecessary.",
    "before_after_code_files": [
      "elf/dl-load.c||elf/dl-load.c",
      "manual/search.texi||manual/search.texi",
      "misc/syslog.c||misc/syslog.c",
      "posix/regex.c||posix/regex.c",
      "posix/tst-getlogin.c||posix/tst-getlogin.c",
      "sysdeps/unix/getlogin_r.c||sysdeps/unix/getlogin_r.c",
      "sysdeps/unix/sysv/linux/bits/resource.h||sysdeps/unix/sysv/linux/bits/resource.h",
      "timezone/checktab.awk||timezone/checktab.awk",
      "timezone/iso3166.tab||timezone/iso3166.tab",
      "timezone/zone.tab||timezone/zone.tab"
    ]
  },
  "patch_diff": {
    "elf/dl-load.c||elf/dl-load.c": [
      "File: elf/dl-load.c -> elf/dl-load.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "149: size_t",
      "150: _dl_dst_count (const char *name, int is_path)",
      "151: {",
      "152:   size_t cnt = 0;",
      "154:   do",
      "155:     {",
      "156:       size_t len = 1;",
      "162:     && (name[len] == '\\0' || name[len] == '/'",
      "163:         || (is_path && name[len] == ':')))",
      "164:    || (name[1] == '{'",
      "167:     || (strncmp (&name[2], \"PLATFORM}\", 9) == 0",
      "168:         && (len = 11) != 0))))",
      "169:  ++cnt;",
      "",
      "[Removed Lines]",
      "159:       if ((((!__libc_enable_secure",
      "160:       && strncmp (&name[1], \"ORIGIN\", 6) == 0 && (len = 7) != 0)",
      "161:      || (strncmp (&name[1], \"PLATFORM\", 8) == 0 && (len = 9) != 0))",
      "165:        && ((!__libc_enable_secure",
      "166:      && strncmp (&name[2], \"ORIGIN}\", 7) == 0 && (len = 9) != 0)",
      "",
      "[Added Lines]",
      "152:   const char *const start = name;",
      "161:   Note that it is no bug that the strings in the first two `strncmp'",
      "163:       if ((((strncmp (&name[1], \"ORIGIN}\", 6) == 0",
      "164:       && (!__libc_enable_secure",
      "165:    || ((name[7] == '\\0' || (is_path && name[7] == ':'))",
      "166:        && (name == start || (is_path && name[-1] == ':'))))",
      "167:       && (len = 7) != 0)",
      "168:      || (strncmp (&name[1], \"PLATFORM}\", 8) == 0 && (len = 9) != 0))",
      "172:        && ((strncmp (&name[2], \"ORIGIN}\", 7) == 0",
      "173:      && (!__libc_enable_secure",
      "174:          || ((name[9] == '\\0' || (is_path && name[9] == ':'))",
      "175:       && (name == start || (is_path && name[-1] == ':'))))",
      "176:      && (len = 9) != 0)",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "180: _dl_dst_substitute (struct link_map *l, const char *name, char *result,",
      "181:       int is_path)",
      "182: {",
      "183:   char *last_elem, *wp;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "193:   const char *const start = name;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "195:    const char *repl;",
      "196:    size_t len;",
      "200:         && (name[len] == '\\0' || name[len] == '/'",
      "201:      || (is_path && name[len] == ':')))",
      "202:        || (name[1] == '{'",
      "",
      "[Removed Lines]",
      "198:    if ((((strncmp (&name[1], \"ORIGIN\", 6) == 0 && (len = 7) != 0)",
      "199:   || (strncmp (&name[1], \"PLATFORM\", 8) == 0 && (len = 9) != 0))",
      "",
      "[Added Lines]",
      "211:    if ((((strncmp (&name[1], \"ORIGIN}\", 6) == 0 && (len = 7) != 0)",
      "212:   || (strncmp (&name[1], \"PLATFORM}\", 8) == 0 && (len = 9) != 0))",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "205:      && (len = 11) != 0))))",
      "206:      {",
      "207:        repl = ((len == 7 || name[2] == 'O')",
      "209:         : _dl_platform);",
      "211:        if (repl != NULL && repl != (const char *) -1)",
      "",
      "[Removed Lines]",
      "208:         ? (__libc_enable_secure ? NULL : l->l_origin)",
      "",
      "[Added Lines]",
      "221:         ? (__libc_enable_secure",
      "222:     && ((name[len] != '\\0'",
      "223:          && (!is_path || name[len] != ':'))",
      "224:         || (name != start",
      "225:      && (!is_path || name[-1] != ':')))",
      "226:     ? NULL : l->l_origin)",
      "",
      "---------------"
    ],
    "manual/search.texi||manual/search.texi": [
      "File: manual/search.texi -> manual/search.texi",
      "--- Hunk 1 ---",
      "[Context before]",
      "475: To remove a specific element matching @var{key} from the tree",
      "476: @code{tdelete} can be used.  It locates the matching element using the",
      "477: same method as @code{tfind}.  The corresponding element is then removed",
      "481: @end deftypefun",
      "483: @comment search.h",
      "",
      "[Removed Lines]",
      "478: and the data if this tree node is returned by the function.  If there is",
      "479: no matching entry in the tree nothing can be deleted and the function",
      "480: returns @code{NULL}.",
      "",
      "[Added Lines]",
      "478: and a pointer to the parent of the deleted node is returned by the",
      "479: function.  If there is no matching entry in the tree nothing can be",
      "480: deleted and the function returns @code{NULL}.  If the root of the tree",
      "481: is deleted @code{tdelete} returns some unspecified value not equal to",
      "482: @code{NULL}.",
      "",
      "---------------"
    ],
    "misc/syslog.c||misc/syslog.c": [
      "File: misc/syslog.c -> misc/syslog.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "178:   v->iov_base = buf + msgoff;",
      "179:   v->iov_len = bufsize - msgoff;",
      "184:  }",
      "",
      "[Removed Lines]",
      "180:   ++v;",
      "181:   v->iov_base = (char *) \"\\n\";",
      "182:   v->iov_len = 1;",
      "183:   (void)__writev(STDERR_FILENO, iov, 2);",
      "",
      "[Added Lines]",
      "181:   if (buf[bufsize - 1] != '\\n')",
      "182:     {",
      "183:       ++v;",
      "184:       v->iov_base = (char *) \"\\n\";",
      "185:       v->iov_len = 1;",
      "186:     }",
      "187:   (void)__writev(STDERR_FILENO, iov, v - iov + 1);",
      "",
      "---------------"
    ],
    "posix/regex.c||posix/regex.c": [
      "File: posix/regex.c -> posix/regex.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "164: #  define SWITCH_ENUM_CAST(x) (x)",
      "165: # endif",
      "",
      "[Removed Lines]",
      "168: # define CHAR_SET_SIZE 256",
      "170: # ifdef SYNTAX_TABLE",
      "172: extern char *re_syntax_table;",
      "176: static char re_syntax_table[CHAR_SET_SIZE];",
      "178: static void",
      "179: init_syntax_once ()",
      "180: {",
      "181:    register int c;",
      "182:    static int done;",
      "184:    if (done)",
      "185:      return;",
      "187:    bzero (re_syntax_table, sizeof re_syntax_table);",
      "189:    for (c = 'a'; c <= 'z'; c++)",
      "190:      re_syntax_table[c] = Sword;",
      "192:    for (c = 'A'; c <= 'Z'; c++)",
      "193:      re_syntax_table[c] = Sword;",
      "195:    for (c = '0'; c <= '9'; c++)",
      "196:      re_syntax_table[c] = Sword;",
      "198:    re_syntax_table['_'] = Sword;",
      "200:    done = 1;",
      "201: }",
      "205: # define SYNTAX(c) re_syntax_table[c]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "277: # define SIGN_EXTEND_CHAR(c) ((((unsigned char) (c)) ^ 128) - 128)",
      "278: #endif",
      "282:    use `alloca' instead of `malloc'.  This is because using malloc in",
      "283:    re_search* or re_match* could cause memory leaks when C-g is used in",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "241: #ifndef emacs",
      "243: # define CHAR_SET_SIZE 256",
      "245: # ifdef SYNTAX_TABLE",
      "247: extern char *re_syntax_table;",
      "251: static char re_syntax_table[CHAR_SET_SIZE];",
      "253: static void",
      "254: init_syntax_once ()",
      "255: {",
      "256:    register int c;",
      "257:    static int done = 0;",
      "259:    if (done)",
      "260:      return;",
      "261:    bzero (re_syntax_table, sizeof re_syntax_table);",
      "263:    for (c = 0; c < CHAR_SET_SIZE; ++c)",
      "264:      if (ISALNUM (c))",
      "265:  re_syntax_table[c] = Sword;",
      "267:    re_syntax_table['_'] = Sword;",
      "269:    done = 1;",
      "270: }",
      "274: # define SYNTAX(c) re_syntax_table[((c) & 0xFF)]",
      "",
      "---------------"
    ],
    "posix/tst-getlogin.c||posix/tst-getlogin.c": [
      "File: posix/tst-getlogin.c -> posix/tst-getlogin.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2:    This file is part of the GNU C Library.",
      "4:    The GNU C Library is free software; you can redistribute it and/or",
      "5:    modify it under the terms of the GNU Library General Public License as",
      "6:    published by the Free Software Foundation; either version 2 of the",
      "7:    License, or (at your option) any later version.",
      "9:    The GNU C Library is distributed in the hope that it will be useful,",
      "10:    but WITHOUT ANY WARRANTY; without even the implied warranty of",
      "11:    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU",
      "12:    Library General Public License for more details.",
      "14:    You should have received a copy of the GNU Library General Public",
      "15:    License along with the GNU C Library; see the file COPYING.LIB.  If not,",
      "16:    write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330,",
      "19: #include <unistd.h>",
      "20: #include <stdio.h>",
      "21: #include <string.h>",
      "23: int",
      "24: main (void)",
      "25: {",
      "26:   char *login;",
      "27:   int errors = 0;",
      "29:   login = getlogin ();",
      "30:   if (login == NULL)",
      "31:     puts (\"getlogin returned NULL, no further tests\");",
      "32:   else",
      "33:     {",
      "34:       char name[1024];",
      "35:       int ret;",
      "37:       printf (\"getlogin returned: `%s'\\n\", login);",
      "39:       ret = getlogin_r (name, sizeof (name));",
      "40:       if (ret == 0)",
      "41:  {",
      "42:    printf (\"getlogin_r returned: `%s'\\n\", name);",
      "43:    if (strcmp (name, login) != 0)",
      "44:      {",
      "45:        puts (\"Error: getlogin and getlogin_r returned different names\");",
      "46:        ++errors;",
      "47:      }",
      "48:  }",
      "49:       else",
      "50:  {",
      "51:    printf (\"Error: getlogin_r returned: %d (%s)\\n\",",
      "52:     ret, strerror (ret));",
      "53:    ++errors;",
      "54:  }",
      "55:     }",
      "57:   return errors != 0;",
      "58: }",
      "",
      "---------------"
    ],
    "sysdeps/unix/getlogin_r.c||sysdeps/unix/getlogin_r.c": [
      "File: sysdeps/unix/getlogin_r.c -> sysdeps/unix/getlogin_r.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "40:   int result = 0;",
      "41:   struct utmp *ut, line, buffer;",
      "",
      "[Removed Lines]",
      "43:   {",
      "44:     int d = __open (\"/dev/tty\", 0);",
      "45:     if (d < 0)",
      "46:       return errno;",
      "48:     result = __ttyname_r (d, real_tty_path, sizeof (tty_pathname));",
      "49:     (void) __close (d);",
      "51:     if (result != 0)",
      "52:       {",
      "53:  __set_errno (result);",
      "54:  return result;",
      "55:       }",
      "56:   }",
      "",
      "[Added Lines]",
      "44:      if fd 0 isn't open.  Note that a lot of documentation says that",
      "45:      getlogin() is based on the controlling terminal---what they",
      "46:      really mean is \"the terminal connected to standard input\".  The",
      "47:      getlogin() implementation of DEC Unix, SunOS, Solaris, HP-UX all",
      "48:      return NULL if fd 0 has been closed, so this is the compatible",
      "49:      thing to do.  Note that ttyname(open(\"/dev/tty\")) on those",
      "50:      systems returns /dev/tty, so that is not a possible solution for",
      "53:   result = __ttyname_r (0, real_tty_path, sizeof (tty_pathname));",
      "55:   if (result != 0)",
      "56:     return result;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "69:     }",
      "70:   else",
      "71:     {",
      "75:  {",
      "76:    __set_errno (ERANGE);",
      "77:    result = ERANGE;",
      "78:  }",
      "79:       else",
      "80:  {",
      "82:    result = 0;",
      "83:  }",
      "84:     }",
      "",
      "[Removed Lines]",
      "72:       size_t needed = strlen (ut->ut_line) + 1;",
      "74:       if (needed < name_len)",
      "81:    memcpy (name, ut->ut_line, needed);",
      "",
      "[Added Lines]",
      "72:       size_t needed = strlen (ut->ut_user) + 1;",
      "74:       if (needed > name_len)",
      "81:    memcpy (name, ut->ut_user, needed);",
      "",
      "---------------"
    ],
    "sysdeps/unix/sysv/linux/bits/resource.h||sysdeps/unix/sysv/linux/bits/resource.h": [
      "File: sysdeps/unix/sysv/linux/bits/resource.h -> sysdeps/unix/sysv/linux/bits/resource.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "219: enum __priority_which",
      "220: {",
      "224: };",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "222: #define PRIO_PROCESS PRIO_PROCESS",
      "224: #define PRIO_PGRP PRIO_PGRP",
      "226: #define PRIO_USER PRIO_USER",
      "",
      "---------------"
    ],
    "timezone/checktab.awk||timezone/checktab.awk": [
      "File: timezone/checktab.awk -> timezone/checktab.awk",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: # Check tz tables for consistency.",
      "5: # Contributed by Paul Eggert <eggert@twinsun.com>.",
      "",
      "[Removed Lines]",
      "3: # @(#)checktab.awk 1.5",
      "",
      "[Added Lines]",
      "3: # @(#)checktab.awk 1.6",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "148:  if (0 < want_warnings) {",
      "149:   for (cc in cc2name) {",
      "150:    if (!cc_used[cc]) {",
      "152:      \"no Zone entries for %s (%s)\\n\", \\",
      "153:      iso_table, cc2NR[cc], cc, cc2name[cc]",
      "154:    }",
      "",
      "[Removed Lines]",
      "151:     printf \"%s:%d: warning:\" \\",
      "",
      "[Added Lines]",
      "151:     printf \"%s:%d: warning: \" \\",
      "",
      "---------------"
    ],
    "timezone/iso3166.tab||timezone/iso3166.tab": [
      "File: timezone/iso3166.tab -> timezone/iso3166.tab",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: # ISO 3166 2-letter country codes",
      "2: #",
      "4: #",
      "6: #",
      "7: # This file contains a table with the following columns:",
      "9: # 2.  The usual English name for the country,",
      "10: # chosen so that alphabetic sorting of subsets produces helpful lists.",
      "11: # This is not the same as the English name in the ISO 3166 tables.",
      "12: #",
      "19: # Columns are separated by a single tab.",
      "20: # The table is sorted by country code.",
      "21: #",
      "",
      "[Removed Lines]",
      "3: # @(#)iso3166.tab 1.6",
      "5: # From Paul Eggert <eggert@twinsun.com> (1996-09-03):",
      "8: # 1.  ISO 3166-1:1997 2-character country code.  See:",
      "13: # The PS code below has been reserved for Palestine by the ISO;",
      "14: # however, the code is not yet officially assigned to Palestine.  Please see",
      "15: # <a href=\"ftp://ftp.informatik.uni-erlangen.de/pub/doc/ISO/ISO-3166-background\">",
      "16: # Cord Wischhoefer, Country Code Elements for Palestine (1996-07-24)",
      "17: # </a>.",
      "18: #",
      "",
      "[Added Lines]",
      "3: # @(#)iso3166.tab 1.7",
      "5: # From Paul Eggert <eggert@twinsun.com> (1999-10-13):",
      "8: # 1.  ISO 3166-1:1999 2-character country code.  See:",
      "9: # <a href=\"http://www.din.de/gremien/nas/nabd/iso3166ma/codlstp1.html\">",
      "10: # ISO 3166-1: The Code List",
      "11: # </a>.",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "95: FM Micronesia",
      "96: FO Faeroe Islands",
      "97: FR France",
      "99: GA Gabon",
      "100: GB Britain (UK)",
      "101: GD Grenada",
      "",
      "[Removed Lines]",
      "98: FX France, Metropolitan",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "114: GU Guam",
      "115: GW Guinea-Bissau",
      "116: GY Guyana",
      "117: HM Heard Island & McDonald Islands",
      "118: HN Honduras",
      "119: HR Croatia",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "113: HK Hong Kong",
      "",
      "---------------"
    ],
    "timezone/zone.tab||timezone/zone.tab": [
      "File: timezone/zone.tab -> timezone/zone.tab",
      "--- Hunk 1 ---",
      "[Context before]",
      "2: #",
      "3: # TZ zone descriptions",
      "4: #",
      "",
      "[Removed Lines]",
      "1: # @(#)zone.tab 1.15",
      "",
      "[Added Lines]",
      "1: # @(#)zone.tab 1.16",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "78: BR -0940-03543 America/Maceio Alagoas, Sergipe",
      "79: BR -2332-04637 America/Sao_Paulo S & SE Brazil (BA, GO, DF, MG, ES, RJ, SP, PR, SC, RS)",
      "80: BR -1535-05605 America/Cuiaba Mato Grosso, Mato Grosso do Sul",
      "82: BR -0308-06001 America/Manaus Amazonas",
      "83: BR -0934-06731 America/Porto_Acre Acre",
      "84: BS +2505-07721 America/Nassau",
      "",
      "[Removed Lines]",
      "81: BR -0846-06354 America/Porto_Velho W Para, Rondonia, Roraima",
      "",
      "[Added Lines]",
      "81: BR -0846-06354 America/Porto_Velho W Para, Rondonia",
      "82: BR +0249-06040 America/Boa_Vista Roraima",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "121: CM +0403+00942 Africa/Douala",
      "122: CN +4545+12641 Asia/Harbin north Manchuria",
      "123: CN +3114+12128 Asia/Shanghai China coast",
      "125: CN +2934+10635 Asia/Chungking China mountains",
      "126: CN +4348+08735 Asia/Urumqi Tibet & Xinjiang",
      "127: CN +3929+07559 Asia/Kashgar Eastern Turkestan",
      "",
      "[Removed Lines]",
      "124: CN +2217+11409 Asia/Hong_Kong Hong Kong",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "178: GU +1328+14445 Pacific/Guam",
      "179: GW +1151-01535 Africa/Bissau",
      "180: GY +0648-05810 America/Guyana",
      "181: HN +1406-08713 America/Tegucigalpa",
      "182: HR +4548+01558 Europe/Zagreb",
      "183: HT +1832-07220 America/Port-au-Prince",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "181: HK +2217+11409 Asia/Hong_Kong",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "242: MU -2010+05730 Indian/Mauritius",
      "243: MV +0410+07330 Indian/Maldives",
      "244: MW -1547+03500 Africa/Blantyre",
      "247: MX +2313-10625 America/Mazatlan Mountain Time - most locations",
      "248: MX +2838-10605 America/Chihuahua Mountain Time - Chihuahua",
      "251: MY +0310+10142 Asia/Kuala_Lumpur peninsular Malaysia",
      "252: MY +0133+11020 Asia/Kuching Sabah & Sarawak",
      "253: MZ -2558+03235 Africa/Maputo",
      "",
      "[Removed Lines]",
      "245: MX +2105-08646 America/Cancun Eastern Time",
      "246: MX +1924-09909 America/Mexico_City Central Time",
      "249: MX +3152-11637 America/Ensenada Pacific Time - most locations",
      "250: MX +3232-11701 America/Tijuana Pacific Time - north Baja California",
      "",
      "[Added Lines]",
      "246: MX +1924-09909 America/Mexico_City Central Time - most locations",
      "247: MX +2105-08646 America/Cancun Central Time - Quintana Roo",
      "250: MX +3232-11701 America/Tijuana Pacific Time",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "330: TM +3757+05823 Asia/Ashkhabad",
      "331: TN +3648+01011 Africa/Tunis",
      "332: TO -2110+17510 Pacific/Tongatapu",
      "333: TR +4101+02858 Europe/Istanbul",
      "334: TT +1039-06131 America/Port_of_Spain",
      "335: TV -0831+17913 Pacific/Funafuti",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "333: TP -0833+12535 Asia/Dili",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9ca4113b7bec284224c664a5e6a767b9bc797fa3",
      "candidate_info": {
        "commit_hash": "9ca4113b7bec284224c664a5e6a767b9bc797fa3",
        "repo": "bminor/glibc",
        "commit_url": "https://github.com/bminor/glibc/commit/9ca4113b7bec284224c664a5e6a767b9bc797fa3",
        "files": [
          "sysdeps/unix/getlogin_r.c"
        ],
        "message": "(getlogin_r): Sync with getlogin implementation for ttyname_r call; fix inverted condition; return ut_user.",
        "before_after_code_files": [
          "sysdeps/unix/getlogin_r.c||sysdeps/unix/getlogin_r.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "sysdeps/unix/getlogin_r.c||sysdeps/unix/getlogin_r.c"
          ],
          "candidate": [
            "sysdeps/unix/getlogin_r.c||sysdeps/unix/getlogin_r.c"
          ]
        }
      },
      "candidate_diff": {
        "sysdeps/unix/getlogin_r.c||sysdeps/unix/getlogin_r.c": [
          "File: sysdeps/unix/getlogin_r.c -> sysdeps/unix/getlogin_r.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "40:   int result = 0;",
          "41:   struct utmp *ut, line, buffer;",
          "",
          "[Removed Lines]",
          "43:   {",
          "44:     int d = __open (\"/dev/tty\", 0);",
          "45:     if (d < 0)",
          "46:       return errno;",
          "48:     result = __ttyname_r (d, real_tty_path, sizeof (tty_pathname));",
          "49:     (void) __close (d);",
          "51:     if (result != 0)",
          "52:       {",
          "53:  __set_errno (result);",
          "54:  return result;",
          "55:       }",
          "56:   }",
          "",
          "[Added Lines]",
          "44:      if fd 0 isn't open.  Note that a lot of documentation says that",
          "45:      getlogin() is based on the controlling terminal---what they",
          "46:      really mean is \"the terminal connected to standard input\".  The",
          "47:      getlogin() implementation of DEC Unix, SunOS, Solaris, HP-UX all",
          "48:      return NULL if fd 0 has been closed, so this is the compatible",
          "49:      thing to do.  Note that ttyname(open(\"/dev/tty\")) on those",
          "50:      systems returns /dev/tty, so that is not a possible solution for",
          "53:   result = __ttyname_r (0, real_tty_path, sizeof (tty_pathname));",
          "55:   if (result != 0)",
          "56:     return result;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "69:     }",
          "70:   else",
          "71:     {",
          "75:  {",
          "76:    __set_errno (ERANGE);",
          "77:    result = ERANGE;",
          "78:  }",
          "79:       else",
          "80:  {",
          "82:    result = 0;",
          "83:  }",
          "84:     }",
          "",
          "[Removed Lines]",
          "72:       size_t needed = strlen (ut->ut_line) + 1;",
          "74:       if (needed < name_len)",
          "81:    memcpy (name, ut->ut_line, needed);",
          "",
          "[Added Lines]",
          "72:       size_t needed = strlen (ut->ut_user) + 1;",
          "74:       if (needed > name_len)",
          "81:    memcpy (name, ut->ut_user, needed);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dc5f3e215c52b1245d1dae358653394cc2793f46",
      "candidate_info": {
        "commit_hash": "dc5f3e215c52b1245d1dae358653394cc2793f46",
        "repo": "bminor/glibc",
        "commit_url": "https://github.com/bminor/glibc/commit/dc5f3e215c52b1245d1dae358653394cc2793f46",
        "files": [
          "elf/dl-load.c"
        ],
        "message": "Complete last patch.",
        "before_after_code_files": [
          "elf/dl-load.c||elf/dl-load.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "elf/dl-load.c||elf/dl-load.c"
          ],
          "candidate": [
            "elf/dl-load.c||elf/dl-load.c"
          ]
        }
      },
      "candidate_diff": {
        "elf/dl-load.c||elf/dl-load.c": [
          "File: elf/dl-load.c -> elf/dl-load.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "149: size_t",
          "150: _dl_dst_count (const char *name, int is_path)",
          "151: {",
          "152:   size_t cnt = 0;",
          "154:   do",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "152:   const char* const start = name;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "186: _dl_dst_substitute (struct link_map *l, const char *name, char *result,",
          "187:       int is_path)",
          "188: {",
          "189:   char *last_elem, *wp;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "190:   const char* const start = name;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "75e663ce4475263360a00c3327d4b09e890fccda",
      "candidate_info": {
        "commit_hash": "75e663ce4475263360a00c3327d4b09e890fccda",
        "repo": "bminor/glibc",
        "commit_url": "https://github.com/bminor/glibc/commit/75e663ce4475263360a00c3327d4b09e890fccda",
        "files": [
          "timezone/README",
          "timezone/africa",
          "timezone/asia",
          "timezone/australasia",
          "timezone/backward",
          "timezone/europe",
          "timezone/iso3166.tab",
          "timezone/northamerica",
          "timezone/southamerica",
          "timezone/zone.tab"
        ],
        "message": "Update from tzdata1999i.",
        "before_after_code_files": [
          "timezone/iso3166.tab||timezone/iso3166.tab",
          "timezone/zone.tab||timezone/zone.tab"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "timezone/iso3166.tab||timezone/iso3166.tab",
            "timezone/zone.tab||timezone/zone.tab"
          ],
          "candidate": [
            "timezone/iso3166.tab||timezone/iso3166.tab",
            "timezone/zone.tab||timezone/zone.tab"
          ]
        }
      },
      "candidate_diff": {
        "timezone/iso3166.tab||timezone/iso3166.tab": [
          "File: timezone/iso3166.tab -> timezone/iso3166.tab",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # ISO 3166 2-letter country codes",
          "2: #",
          "4: #",
          "6: #",
          "7: # This file contains a table with the following columns:",
          "9: # 2.  The usual English name for the country,",
          "10: # chosen so that alphabetic sorting of subsets produces helpful lists.",
          "11: # This is not the same as the English name in the ISO 3166 tables.",
          "12: #",
          "19: # Columns are separated by a single tab.",
          "20: # The table is sorted by country code.",
          "21: #",
          "",
          "[Removed Lines]",
          "3: # @(#)iso3166.tab 1.6",
          "5: # From Paul Eggert <eggert@twinsun.com> (1996-09-03):",
          "8: # 1.  ISO 3166-1:1997 2-character country code.  See:",
          "13: # The PS code below has been reserved for Palestine by the ISO;",
          "14: # however, the code is not yet officially assigned to Palestine.  Please see",
          "15: # <a href=\"ftp://ftp.informatik.uni-erlangen.de/pub/doc/ISO/ISO-3166-background\">",
          "16: # Cord Wischhoefer, Country Code Elements for Palestine (1996-07-24)",
          "17: # </a>.",
          "18: #",
          "",
          "[Added Lines]",
          "3: # @(#)iso3166.tab 1.7",
          "5: # From Paul Eggert <eggert@twinsun.com> (1999-10-13):",
          "8: # 1.  ISO 3166-1:1999 2-character country code.  See:",
          "9: # <a href=\"http://www.din.de/gremien/nas/nabd/iso3166ma/codlstp1.html\">",
          "10: # ISO 3166-1: The Code List",
          "11: # </a>.",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "95: FM Micronesia",
          "96: FO Faeroe Islands",
          "97: FR France",
          "99: GA Gabon",
          "100: GB Britain (UK)",
          "101: GD Grenada",
          "",
          "[Removed Lines]",
          "98: FX France, Metropolitan",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "114: GU Guam",
          "115: GW Guinea-Bissau",
          "116: GY Guyana",
          "117: HM Heard Island & McDonald Islands",
          "118: HN Honduras",
          "119: HR Croatia",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "113: HK Hong Kong",
          "",
          "---------------"
        ],
        "timezone/zone.tab||timezone/zone.tab": [
          "File: timezone/zone.tab -> timezone/zone.tab",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: #",
          "3: # TZ zone descriptions",
          "4: #",
          "",
          "[Removed Lines]",
          "1: # @(#)zone.tab 1.15",
          "",
          "[Added Lines]",
          "1: # @(#)zone.tab 1.16",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "78: BR -0940-03543 America/Maceio Alagoas, Sergipe",
          "79: BR -2332-04637 America/Sao_Paulo S & SE Brazil (BA, GO, DF, MG, ES, RJ, SP, PR, SC, RS)",
          "80: BR -1535-05605 America/Cuiaba Mato Grosso, Mato Grosso do Sul",
          "82: BR -0308-06001 America/Manaus Amazonas",
          "83: BR -0934-06731 America/Porto_Acre Acre",
          "84: BS +2505-07721 America/Nassau",
          "",
          "[Removed Lines]",
          "81: BR -0846-06354 America/Porto_Velho W Para, Rondonia, Roraima",
          "",
          "[Added Lines]",
          "81: BR -0846-06354 America/Porto_Velho W Para, Rondonia",
          "82: BR +0249-06040 America/Boa_Vista Roraima",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "121: CM +0403+00942 Africa/Douala",
          "122: CN +4545+12641 Asia/Harbin north Manchuria",
          "123: CN +3114+12128 Asia/Shanghai China coast",
          "125: CN +2934+10635 Asia/Chungking China mountains",
          "126: CN +4348+08735 Asia/Urumqi Tibet & Xinjiang",
          "127: CN +3929+07559 Asia/Kashgar Eastern Turkestan",
          "",
          "[Removed Lines]",
          "124: CN +2217+11409 Asia/Hong_Kong Hong Kong",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "178: GU +1328+14445 Pacific/Guam",
          "179: GW +1151-01535 Africa/Bissau",
          "180: GY +0648-05810 America/Guyana",
          "181: HN +1406-08713 America/Tegucigalpa",
          "182: HR +4548+01558 Europe/Zagreb",
          "183: HT +1832-07220 America/Port-au-Prince",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "181: HK +2217+11409 Asia/Hong_Kong",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "242: MU -2010+05730 Indian/Mauritius",
          "243: MV +0410+07330 Indian/Maldives",
          "244: MW -1547+03500 Africa/Blantyre",
          "247: MX +2313-10625 America/Mazatlan Mountain Time - most locations",
          "248: MX +2838-10605 America/Chihuahua Mountain Time - Chihuahua",
          "251: MY +0310+10142 Asia/Kuala_Lumpur peninsular Malaysia",
          "252: MY +0133+11020 Asia/Kuching Sabah & Sarawak",
          "253: MZ -2558+03235 Africa/Maputo",
          "",
          "[Removed Lines]",
          "245: MX +2105-08646 America/Cancun Eastern Time",
          "246: MX +1924-09909 America/Mexico_City Central Time",
          "249: MX +3152-11637 America/Ensenada Pacific Time - most locations",
          "250: MX +3232-11701 America/Tijuana Pacific Time - north Baja California",
          "",
          "[Added Lines]",
          "246: MX +1924-09909 America/Mexico_City Central Time - most locations",
          "247: MX +2105-08646 America/Cancun Central Time - Quintana Roo",
          "250: MX +3232-11701 America/Tijuana Pacific Time",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "330: TM +3757+05823 Asia/Ashkhabad",
          "331: TN +3648+01011 Africa/Tunis",
          "332: TO -2110+17510 Pacific/Tongatapu",
          "333: TR +4101+02858 Europe/Istanbul",
          "334: TT +1039-06131 America/Port_of_Spain",
          "335: TV -0831+17913 Pacific/Funafuti",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "333: TP -0833+12535 Asia/Dili",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8a80163853ade494fa8310acd35270e55345db63",
      "candidate_info": {
        "commit_hash": "8a80163853ade494fa8310acd35270e55345db63",
        "repo": "bminor/glibc",
        "commit_url": "https://github.com/bminor/glibc/commit/8a80163853ade494fa8310acd35270e55345db63",
        "files": [
          "timezone/checktab.awk"
        ],
        "message": "Update from tzcode1999h.",
        "before_after_code_files": [
          "timezone/checktab.awk||timezone/checktab.awk"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "timezone/checktab.awk||timezone/checktab.awk"
          ],
          "candidate": [
            "timezone/checktab.awk||timezone/checktab.awk"
          ]
        }
      },
      "candidate_diff": {
        "timezone/checktab.awk||timezone/checktab.awk": [
          "File: timezone/checktab.awk -> timezone/checktab.awk",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: # Check tz tables for consistency.",
          "5: # Contributed by Paul Eggert <eggert@twinsun.com>.",
          "",
          "[Removed Lines]",
          "3: # @(#)checktab.awk 1.5",
          "",
          "[Added Lines]",
          "3: # @(#)checktab.awk 1.6",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "148:  if (0 < want_warnings) {",
          "149:   for (cc in cc2name) {",
          "150:    if (!cc_used[cc]) {",
          "152:      \"no Zone entries for %s (%s)\\n\", \\",
          "153:      iso_table, cc2NR[cc], cc, cc2name[cc]",
          "154:    }",
          "",
          "[Removed Lines]",
          "151:     printf \"%s:%d: warning:\" \\",
          "",
          "[Added Lines]",
          "151:     printf \"%s:%d: warning: \" \\",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "36c16314b8a980535f3b05380674a9f3c8653635",
      "candidate_info": {
        "commit_hash": "36c16314b8a980535f3b05380674a9f3c8653635",
        "repo": "bminor/glibc",
        "commit_url": "https://github.com/bminor/glibc/commit/36c16314b8a980535f3b05380674a9f3c8653635",
        "files": [
          "sysdeps/unix/sysv/linux/bits/resource.h"
        ],
        "message": "Define values also as macros.",
        "before_after_code_files": [
          "sysdeps/unix/sysv/linux/bits/resource.h||sysdeps/unix/sysv/linux/bits/resource.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "sysdeps/unix/sysv/linux/bits/resource.h||sysdeps/unix/sysv/linux/bits/resource.h"
          ],
          "candidate": [
            "sysdeps/unix/sysv/linux/bits/resource.h||sysdeps/unix/sysv/linux/bits/resource.h"
          ]
        }
      },
      "candidate_diff": {
        "sysdeps/unix/sysv/linux/bits/resource.h||sysdeps/unix/sysv/linux/bits/resource.h": [
          "File: sysdeps/unix/sysv/linux/bits/resource.h -> sysdeps/unix/sysv/linux/bits/resource.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "219: enum __priority_which",
          "220: {",
          "224: };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "222: #define PRIO_PROCESS PRIO_PROCESS",
          "224: #define PRIO_PGRP PRIO_PGRP",
          "226: #define PRIO_USER PRIO_USER",
          "",
          "---------------"
        ]
      }
    }
  ]
}