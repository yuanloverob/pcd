{
  "cve_id": "CVE-2022-24763",
  "cve_desc": "PJSIP is a free and open source multimedia communication library written in the C language. Versions 2.12 and prior contain a denial-of-service vulnerability that affects PJSIP users that consume PJSIP's XML parsing in their apps. Users are advised to update. There are no known workarounds.",
  "repo": "pjsip/pjproject",
  "patch_hash": "856f87c2e97a27b256482dbe0d748b1194355a21",
  "patch_info": {
    "commit_hash": "856f87c2e97a27b256482dbe0d748b1194355a21",
    "repo": "pjsip/pjproject",
    "commit_url": "https://github.com/pjsip/pjproject/commit/856f87c2e97a27b256482dbe0d748b1194355a21",
    "files": [
      "pjlib-util/src/pjlib-util/xml.c"
    ],
    "message": "Merge pull request from GHSA-5x45-qp78-g4p4\n\n* Prevent infinite loop in scanning xml content\n\n* Simplify scanning method\n\n* Optimization",
    "before_after_code_files": [
      "pjlib-util/src/pjlib-util/xml.c||pjlib-util/src/pjlib-util/xml.c"
    ]
  },
  "patch_diff": {
    "pjlib-util/src/pjlib-util/xml.c||pjlib-util/src/pjlib-util/xml.c": [
      "File: pjlib-util/src/pjlib-util/xml.c -> pjlib-util/src/pjlib-util/xml.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "150:  pj_scan_get_until_ch(scanner, ']', &node->content);",
      "151:  while (pj_scan_strcmp(scanner, \"]]>\", 3)) {",
      "152:      pj_str_t dummy;",
      "153:      pj_scan_get_until_ch(scanner, ']', &dummy);",
      "154:  }",
      "155:  node->content.slen = scanner->curptr - node->content.ptr;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "154:      pj_scan_advance_n(scanner, 1, PJ_FALSE);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "3fd62f41e4a7d9acbf9c0b1339950ab961ee2d79",
      "candidate_info": {
        "commit_hash": "3fd62f41e4a7d9acbf9c0b1339950ab961ee2d79",
        "repo": "pjsip/pjproject",
        "commit_url": "https://github.com/pjsip/pjproject/commit/3fd62f41e4a7d9acbf9c0b1339950ab961ee2d79",
        "files": [
          "pjlib-util/src/pjlib-util/xml.c"
        ],
        "message": "Merge pull request from GHSA-5x45-qp78-g4p4\n\n* Prevent infinite loop in scanning xml content\n\n* Simplify scanning method\n\n* Optimization",
        "before_after_code_files": [
          "pjlib-util/src/pjlib-util/xml.c||pjlib-util/src/pjlib-util/xml.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "pjlib-util/src/pjlib-util/xml.c||pjlib-util/src/pjlib-util/xml.c"
          ],
          "candidate": [
            "pjlib-util/src/pjlib-util/xml.c||pjlib-util/src/pjlib-util/xml.c"
          ]
        }
      },
      "candidate_diff": {
        "pjlib-util/src/pjlib-util/xml.c||pjlib-util/src/pjlib-util/xml.c": [
          "File: pjlib-util/src/pjlib-util/xml.c -> pjlib-util/src/pjlib-util/xml.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "150:  pj_scan_get_until_ch(scanner, ']', &node->content);",
          "151:  while (pj_scan_strcmp(scanner, \"]]>\", 3)) {",
          "152:      pj_str_t dummy;",
          "153:      pj_scan_get_until_ch(scanner, ']', &dummy);",
          "154:  }",
          "155:  node->content.slen = scanner->curptr - node->content.ptr;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "154:      pj_scan_advance_n(scanner, 1, PJ_FALSE);",
          "",
          "---------------"
        ]
      }
    }
  ]
}