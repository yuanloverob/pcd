{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f4ebe1b6c2b92b94808b198de37d2765bc4f88ed",
      "candidate_info": {
        "commit_hash": "f4ebe1b6c2b92b94808b198de37d2765bc4f88ed",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/f4ebe1b6c2b92b94808b198de37d2765bc4f88ed",
        "files": [
          "src/format.c",
          "src/rufus.c",
          "src/rufus.h",
          "src/rufus.rc"
        ],
        "message": "[togo] prompt user to select a version before formatting",
        "before_after_code_files": [
          "src/format.c||src/format.c",
          "src/rufus.c||src/rufus.c",
          "src/rufus.h||src/rufus.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/format.c||src/format.c": [
          "File: src/format.c -> src/format.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "60: static int task_number = 0;",
          "61: extern const int nb_steps[FS_MAX];",
          "62: extern uint32_t dur_mins, dur_secs;",
          "64: extern BOOL force_large_fat32, enable_ntfs_compression, lock_drive, zero_drive, disable_file_indexing;",
          "65: uint8_t *grub2_buf = NULL;",
          "66: long grub2_len;",
          "",
          "[Removed Lines]",
          "63: static int fs_index = 0;",
          "",
          "[Added Lines]",
          "63: static int fs_index = 0, wintogo_index = -1;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1264:  return r;",
          "1265: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1269: BOOL SetWinToGoIndex(void)",
          "1270: {",
          "1271:  char *mounted_iso, image[128];",
          "1272:  char tmp_path[MAX_PATH] = \"\", xml_file[MAX_PATH] = \"\";",
          "1273:  StrArray version_name, version_index;",
          "1274:  int i;",
          "1277:  if ((nWindowsVersion < WINDOWS_8) || ((WimExtractCheck() & 4) == 0) ||",
          "1278:   (ComboBox_GetItemData(hFileSystem, ComboBox_GetCurSel(hFileSystem)) != FS_NTFS)) {",
          "1279:   wintogo_index = -1;",
          "1280:   return FALSE;",
          "1281:  }",
          "1283:  mounted_iso = MountISO(image_path);",
          "1284:  if (mounted_iso == NULL) {",
          "1285:   uprintf(\"Could not mount ISO for Windows To Go selection\");",
          "1286:   wintogo_index = -1;",
          "1287:   return FALSE;",
          "1288:  }",
          "1289:  static_sprintf(image, \"%s%s\", mounted_iso, &img_report.install_wim_path[2]);",
          "1292:  if ((GetTempPathU(sizeof(tmp_path), tmp_path) == 0)",
          "1293:   || (GetTempFileNameU(tmp_path, APPLICATION_NAME, 0, xml_file) == 0)",
          "1294:   || (xml_file[0] == 0)) {",
          "1296:   safe_strcpy(xml_file, sizeof(xml_file), \".\\\\RufVXml.tmp\");",
          "1297:  }",
          "1299:  DeleteFileU(xml_file);",
          "1302:  if (!WimExtractFile_API(image, 0, \"[1].xml\", xml_file)) {",
          "1303:   uprintf(\"Failed to acquire WIM index\");",
          "1304:  }",
          "1305:  StrArrayCreate(&version_name, 16);",
          "1306:  StrArrayCreate(&version_index, 16);",
          "1307:  for (i = 0; (StrArrayAdd(&version_name, get_token_data_file_indexed(\"DISPLAYNAME\", xml_file, i + 1), FALSE) >= 0) &&",
          "1308:   (StrArrayAdd(&version_index, get_token_data_file_indexed(\"IMAGE INDEX\", xml_file, i + 1), FALSE) >= 0); i++);",
          "1309:  DeleteFileU(xml_file);",
          "1310:  UnMountISO();",
          "1312:  if (i > 1)",
          "1313:   i = Selection(lmprintf(MSG_291), lmprintf(MSG_292), version_name.String, i);",
          "1314:  if (i < 0) {",
          "1315:   wintogo_index = -1;",
          "1316:  } else if (i == 0) {",
          "1317:   wintogo_index = 1;",
          "1318:  } else {",
          "1319:   wintogo_index = atoi(version_index.String[i - 1]);",
          "1320:  }",
          "1321:  if (i >= 1)",
          "1322:   uprintf(\"Will use '%s' (index %s) for Windows To Go\", version_name.String[i - 1], version_index.String[i - 1]);",
          "1323:  StrArrayDestroy(&version_name);",
          "1324:  StrArrayDestroy(&version_index);",
          "1325:  return (wintogo_index >= 0);",
          "1326: }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1277:  static char san_policy_path[] = \"?:\\\\san_policy.xml\";",
          "1278: #endif",
          "1279:  static char unattend_path[] = \"?:\\\\Windows\\\\System32\\\\sysprep\\\\unattend.xml\";",
          "1281:  char *mounted_iso, *ms_efi = NULL, image[128], cmd[MAX_PATH];",
          "1283:  unsigned char *buffer;",
          "1285:  wchar_t wVolumeName[] = L\"?:\";",
          "1286:  DWORD bufsize;",
          "1287:  ULONG cluster_size;",
          "",
          "[Removed Lines]",
          "1280:  StrArray version_name, version_index;",
          "1282:  char tmp_path[MAX_PATH] = \"\", xml_file[MAX_PATH] = \"\";",
          "1284:  int i, index;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1292:  uprintf(\"Windows To Go mode selected\");",
          "1296:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_NOT_SUPPORTED;",
          "1297:   return FALSE;",
          "1298:  }",
          "1305:  mounted_iso = MountISO(image_path);",
          "",
          "[Removed Lines]",
          "1294:  if ( ((use_ms_efi) && (SelectedDrive.MediaType != FixedMedia)) ||",
          "1295:    ((nWindowsVersion < WINDOWS_8) || ((WimExtractCheck() & 4) == 0)) ) {",
          "1299:  if (ComboBox_GetItemData(hFileSystem, ComboBox_GetCurSel(hFileSystem)) != FS_NTFS) {",
          "1300:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|APPERR(ERROR_INCOMPATIBLE_FS);",
          "1301:   return FALSE;",
          "1302:  }",
          "",
          "[Added Lines]",
          "1351:  if ( (use_ms_efi) && (SelectedDrive.MediaType != FixedMedia) ) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1311:  static_sprintf(image, \"%s%s\", mounted_iso, &img_report.install_wim_path[2]);",
          "1312:  uprintf(\"Mounted ISO as '%s'\", mounted_iso);",
          "1355:   uprintf(\"Failed to apply Windows To Go image\");",
          "1356:   if (!IS_ERROR(FormatStatus))",
          "1357:    FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|APPERR(ERROR_ISO_EXTRACT);",
          "",
          "[Removed Lines]",
          "1316:  if ((GetTempPathU(sizeof(tmp_path), tmp_path) == 0)",
          "1317:   || (GetTempFileNameU(tmp_path, APPLICATION_NAME, 0, xml_file) == 0)",
          "1318:   || (xml_file[0] == 0)) {",
          "1320:   safe_strcpy(xml_file, sizeof(xml_file), \".\\\\RufVXml.tmp\");",
          "1321:  }",
          "1323:  DeleteFileU(xml_file);",
          "1326:  if (!WimExtractFile_API(image, 0, \"[1].xml\", xml_file)) {",
          "1327:   uprintf(\"Failed to acquire WIM index\");",
          "1328:  }",
          "1329:  StrArrayCreate(&version_name, 16);",
          "1330:  StrArrayCreate(&version_index, 16);",
          "1331:  for (i = 0; (StrArrayAdd(&version_name, get_token_data_file_indexed(\"DISPLAYNAME\", xml_file, i+1), FALSE) >= 0) &&",
          "1332:   (StrArrayAdd(&version_index, get_token_data_file_indexed(\"IMAGE INDEX\", xml_file, i+1), FALSE) >= 0); i++);",
          "1333:  DeleteFileU(xml_file);",
          "1335:  if (i > 1)",
          "1336:   i = Selection(lmprintf(MSG_291), lmprintf(MSG_292), version_name.String, i);",
          "1337:  if (i <= 0) {",
          "1338:   uprintf(\"Cancelled by user\");",
          "1339:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_CANCELLED;",
          "1340:   UnMountISO();",
          "1341:   StrArrayDestroy(&version_name);",
          "1342:   StrArrayDestroy(&version_index);",
          "1343:   return FALSE;",
          "1344:  } else if (i == 0) {",
          "1345:   index = 1;",
          "1346:  } else {",
          "1347:   index = atoi(version_index.String[i - 1]);",
          "1348:  }",
          "1349:  uprintf(\"Selected: '%s' (index %s)\", version_name.String[i - 1], version_index.String[i - 1]);",
          "1350:  StrArrayDestroy(&version_name);",
          "1351:  StrArrayDestroy(&version_index);",
          "1354:  if (!WimApplyImage(image, index, drive_name)) {",
          "",
          "[Added Lines]",
          "1367:  if (!WimApplyImage(image, wintogo_index, drive_name)) {",
          "",
          "---------------"
        ],
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1304:     if (MessageBoxExU(hMainDialog, lmprintf(MSG_098), lmprintf(MSG_190), MB_YESNO|MB_ICONWARNING|MB_IS_RTL, selected_langid) != IDYES)",
          "1305:      return FALSE;",
          "1306:    }",
          "1307:   } else if (tt == TT_UEFI) {",
          "1308:    if (!IS_EFI_BOOTABLE(img_report)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1308:    if (!SetWinToGoIndex())",
          "1309:     return FALSE;",
          "",
          "---------------"
        ],
        "src/rufus.h||src/rufus.h": [
          "File: src/rufus.h -> src/rufus.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "470: extern BOOL WimApplyImage(const char* image, int index, const char* dst);",
          "471: extern BOOL IsBootableImage(const char* path);",
          "472: extern BOOL AppendVHDFooter(const char* vhd_path);",
          "473: extern int IsHDD(DWORD DriveIndex, uint16_t vid, uint16_t pid, const char* strid);",
          "474: extern LONG ValidateSignature(HWND hDlg, const char* path);",
          "475: extern BOOL IsFontAvailable(const char* font_name);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "473: extern BOOL SetWinToGoIndex(void);",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1009\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1010\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1009,0",
          "338:  PRODUCTVERSION 2,12,1009,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1010,0",
          "338:  PRODUCTVERSION 2,12,1010,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2016 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1009\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1009\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1010\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1010\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "78a619036589dcadc2e4c89fa770ff345852cd8e",
      "candidate_info": {
        "commit_hash": "78a619036589dcadc2e4c89fa770ff345852cd8e",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/78a619036589dcadc2e4c89fa770ff345852cd8e",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update German translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "5395: b \"en-US\"",
          "5397: g IDD_DIALOG",
          "5398: t IDS_DEVICE_TXT \"Laufwerk\"",
          "5399: t IDS_BOOT_SELECTION_TXT \"Startart\"",
          "5400: t IDS_PARTITION_TYPE_TXT \"Partitionsschema\"",
          "5401: t IDS_TARGET_SYSTEM_TXT \"Zielsystem\"",
          "5402: t IDS_FILE_SYSTEM_TXT \"Dateisystem\"",
          "5403: t IDS_CLUSTER_SIZE_TXT \"Gr\u00f6\u00dfe der Zuordnungseinheit\"",
          "5405: t IDS_FORMAT_OPTIONS_TXT \"Formatierungseinstellungen\"",
          "5406: t IDC_BAD_BLOCKS \"Auf defekte Bl\u00f6cke pr\u00fcfen\"",
          "5407: t IDC_QUICK_FORMAT \"Schnellformatierung\"",
          "",
          "[Removed Lines]",
          "5404: t IDS_LABEL_TXT \"Neue Laufwerksbezeichnung\"",
          "",
          "[Added Lines]",
          "5398: t IDS_DRIVE_PROPERTIES_TXT \"Laufwerkseigenschaften\"",
          "5401: t IDC_SELECT \"Auswahl\"",
          "5402: t IDS_IMAGE_OPTION_TXT \"Abbildeigenschaft\"",
          "5407: t IDS_LABEL_TXT \"Laufwerksbezeichnung\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "5485: t MSG_029 \"Standard\"",
          "5486: # The following gets appended to the file system, cluster size, etc.",
          "5487: t MSG_030 \"%s (Standard)\"",
          "5491: # Number of bad block check passes (singular for 1 pass, plural for 2 or more passes)",
          "5492: t MSG_034 \"%d Durchgang\"",
          "5493: t MSG_035 \"%d Durchg\u00e4nge\"",
          "5494: t MSG_036 \"ISO-Abbild\"",
          "5496: t MSG_038 \"Abbruch\"",
          "5497: t MSG_039 \"Start\"",
          "5498: t MSG_040 \"Download\"",
          "",
          "[Removed Lines]",
          "5488: #t MSG_031 \"%s Partitionierungsschema f\u00fcr BIOS oder %s\"",
          "5489: #t MSG_032 \"%s Partitionierungsschema f\u00fcr BIOS\"",
          "5490: #t MSG_033 \"%s Partitionierungsschema f\u00fcr UEFI\"",
          "5495: t MSG_037 \"Anwendung\"",
          "",
          "[Added Lines]",
          "5491: t MSG_031 \"BIOS (bzw. UEFI-CSM)\"",
          "5492: t MSG_032 \"UEFI (ohne CSM)\"",
          "5493: t MSG_033 \"BIOS oder UEFI\"",
          "5498: t MSG_037 \"Programm\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "5557: t MSG_088 \"Abbild ist zu gro\u00df\"",
          "5558: t MSG_089 \"Dieses Abbild ist zu gro\u00df f\u00fcr das gew\u00e4hlte Ziel.\"",
          "5559: t MSG_090 \"ISO-Abbild nicht unterst\u00fctzt\"",
          "5561:  \"Bitte w\u00e4hlen Sie ein EFI-bootf\u00e4higes ISO-Abbild oder \u00e4ndern Sie den Typ des Zielsystems zu BIOS.\"",
          "5562: t MSG_092 \"Nicht unterst\u00fctztes Dateisystem\"",
          "5563: t MSG_093 \"ACHTUNG! DIESES LAUFWERK VERF\u00dcGT \u00dcBER MEHRERE PARTITIONEN ODER VOLUMES!!\\n\\n\"",
          "",
          "[Removed Lines]",
          "5560: t MSG_091 \"Wenn UEFI als Typ des Zielsystems gew\u00e4hlt ist, sind nur EFI-bootf\u00e4hige ISO-Abbilder unterst\u00fctzt.\"",
          "",
          "[Added Lines]",
          "5563: t MSG_091 \"Wenn UEFI als Typ des Zielsystems gew\u00e4hlt ist, werden nur EFI-bootf\u00e4hige ISO-Abbilder unterst\u00fctzt.\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "5615:  \"- W\u00e4hlen Sie 'Abbrechen', um den Vorgang abzubrechen\\n\\n\"",
          "5616:  \"Hinweis: Die Datei wird in das Programmverzeichnis heruntergeladen und ggf. automatisch wiederverwendet. \"",
          "5617:  \"Wenn online nichts gefunden wird, wird die Standardversion verwendet.\"",
          "5625: t MSG_153 \"Pr\u00fcfmuster: 0x%02X\"",
          "5626: t MSG_154 \"Pr\u00fcfmuster: 0x%02X, 0x%02X\"",
          "5627: t MSG_155 \"Pr\u00fcfmuster: 0x%02X, 0x%02X, 0x%02X\"",
          "",
          "[Removed Lines]",
          "5619: t MSG_150 \"Normalerweise die beste Wahl. Wenn Sie einen UEFI-Computer haben und das Betriebssystem \"",
          "5620:  \"im EFI-Modus installieren wollen, sollten sie eine der anderen Einstellungen w\u00e4hlen.\"",
          "5621: t MSG_151 \"Verwenden Sie diese Einstellung, um das Betriebssystem im EFI-Modus zu installieren und \"",
          "5622:  \"USB-Zugriff unter Windows XP zu haben\"",
          "5623: t MSG_152 \"Die bevorzugte Einstellung, um das Betriebssystem im EFI-Modus zu installieren und \"",
          "5624:  \"wenn kein USB-Zugriff unter Windows XP erforderlich ist\"",
          "",
          "[Added Lines]",
          "5621: t MSG_117 \"Standard Windows-Installation\"",
          "5622: t MSG_119 \"Erweiterte Laufwerkseigenschaften\"",
          "5623: t MSG_120 \"Erweiterte Formatierungsoptionen\"",
          "5624: t MSG_121 \"%s einblenden\"",
          "5625: t MSG_122 \"%s ausblenden\"",
          "5626: t MSG_150 \"Der Typ des Computers, an dem Sie das startf\u00e4hige Laufwerk verwenden wollen. Sie m\u00fcssen entscheiden, ob BIOS oder UEFI. Andernfalls schl\u00e4gt der Start fehl.\"",
          "5627: t MSG_151 \"'UEFI-CSM' bedeutet, der Computer startet im BIOS-Modus (auch bekannt als 'Legacy Mode') unter UEFI, und nicht im nativen UEFI-Modus.\"",
          "5628: t MSG_152 \"'ohne CSM' bedeutet, das Ger\u00e4t startet nur im nativen UEFI-Modus und nicht im 'Legacy Mode' bzw. 'CSM' Modus.\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "5632: t MSG_160 \"Erweiterte Optionen ein- bzw. ausblenden\"",
          "5633: t MSG_161 \"Das Laufwerk mittels eines Musters auf fehlerhafte Bl\u00f6cke pr\u00fcfen\"",
          "5634: t MSG_162 \"Wenn nicht aktiviert, wird die \\\"langsame\\\" Formatierung verwendet\"",
          "5635: t MSG_164 \"Methode, um das Laufwerk startf\u00e4hig zu machen\"",
          "5636: t MSG_165 \"W\u00e4hlen Sie eine Abbild-Datei...\"",
          "5637: t MSG_166 \"W\u00e4hlen Sie diese Option, um die Anzeige internationaler Bezeichnungen zu erm\u00f6glichen \"",
          "5638:  \"und ein Ger\u00e4tesymbol zu erzeugen (Datei autorun.inf)\"",
          "5639: t MSG_167 \"Erzeugt einen MBR, der eine Bootmen\u00fc erzeugt und die ID des BIOS USB-Laufwerks maskieren kann\"",
          "5641: t MSG_168 \"Das erste startf\u00e4hige USB-Laufwerk maskieren (normalerweise 0x80) als andere Festplatte.\\n\"",
          "5642:  \"Das sollte nur notwendig sein, wenn Sie Windows XP installieren und mehr als ein Festplatte haben.\"",
          "5643: t MSG_169 \"Eine extra Partition erzeugen und die Partitionsgrenzen ausrichten.\\n\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5639: t MSG_163 \"Methode, mit der das Laufwerk partitioniert wird\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "5757: t MSG_263 \"Verwenden Sie korrekten Gr\u00f6\u00dfeneinheiten\"",
          "5758: t MSG_264 \"L\u00f6sche Ordner '%s'\"",
          "5759: t MSG_265 \"VMWare-Laufwerks-Erkennung\"",
          "5761: t MSG_267 \"Spiele Windows-Abbild auf: %0.1f%% fertiggestellt\"",
          "5762: t MSG_268 \"Windows-Abbild aufspielen...\"",
          "5763: t MSG_269 \"Zeitstempel bewahren\"",
          "",
          "[Removed Lines]",
          "5760: t MSG_266 \"Dual UEFI/BIOS-Modus\"",
          "",
          "[Added Lines]",
          "5763: t MSG_266 \"Dualer UEFI/BIOS-Modus\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "5773:  \"Bitte w\u00e4hlen Sie den Modus, mit dem Sie das Abbild schreiben wollen:\"",
          "5774: t MSG_276 \"Im %s Modus schreiben (empfohlen)\"",
          "5775: t MSG_277 \"Im %s Modus schreiben\"",
          "5776: t MSG_279 \"Nicht startf\u00e4hig\"",
          "5778: t MSG_281 \"(Bitte w\u00e4hlen Sie ein Abbild)\"",
          "5779: t MSG_282 \"Exclusive Sperre f\u00fcr das USB-Laufwerk\"",
          "5780: t MSG_283 \"Ung\u00fcltige Signatur\"",
          "",
          "[Removed Lines]",
          "5777: t MSG_280 \"Abbildauswahl\"",
          "",
          "[Added Lines]",
          "5779: t MSG_278 \"Pr\u00fcfe auf konkurrierende Prozesse...\"",
          "5781: t MSG_280 \"Medium oder Abbilddatei\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "5796: t MSG_298 \"Das ISO-Abbild, dass Sie gew\u00e4hlt haben, hat nicht die erwartete Gr\u00f6\u00dfe. %s Daten fehlen!\\n\\nSollten Sie das Abbild vom \"",
          "5797:  \"Internet heruntergeladen haben, sollten Sie den Download wiederholen und pr\u00fcfen, ob die MD5- oder SHA-Pr\u00fcfsummen \u00fcbereinstimmen.\"",
          "5798:  \"\\n\\nHinweis: Mit der '#' Schaltfl\u00e4che in der Statuszeile k\u00f6nnen Sie die Pr\u00fcfsummen des gew\u00e4hlten Abbilds anzeigen.\"",
          "5801: ################################################################################",
          "5802: l \"el-GR\" \"Greek (\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac)\" 0x0408",
          "",
          "[Removed Lines]",
          "5799: t MSG_117 \"Standard Windows-Installation\"",
          "",
          "[Added Lines]",
          "5803: t MSG_299 \"Fehler bei der \u00dcberpr\u00fcfung des Zeitstempels\"",
          "5804: t MSG_300 \"Rufus konnten nicht pr\u00fcfen, ob der Zeitstempel des Update-Downloads aktueller ist, als der des aktuell ausgef\u00fchrten Programms.\\n\\n\"",
          "5805:  \"Aus Sicherheitsgr\u00fcnden wurde der Aktualisierungsprozess abgebrochen und der Download wurde gel\u00f6scht. Im Log finden Sie weitere Details.\"",
          "5806: t MSG_301 \"Applikationseinstellungen anzeigen\"",
          "5807: t MSG_302 \"Informationen \u00fcber dieses Programm anzeigen\"",
          "5808: t MSG_303 \"Log anzeigen\"",
          "5809: t MSG_304 \"Erstelle ein Abbild des gew\u00e4hlten Laufwerks\"",
          "5810: t MSG_305 \"Wollen Sie Windows auf einem anderen Laufwerk installieren oder Windows direkt nutzen (Windows To Go)\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1235\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1236\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "373: VS_VERSION_INFO VERSIONINFO",
          "376:  FILEFLAGSMASK 0x3fL",
          "377: #ifdef _DEBUG",
          "378:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "374:  FILEVERSION 2,18,1235,0",
          "375:  PRODUCTVERSION 2,18,1235,0",
          "",
          "[Added Lines]",
          "374:  FILEVERSION 2,18,1236,0",
          "375:  PRODUCTVERSION 2,18,1236,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "389:         BEGIN",
          "390:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "391:             VALUE \"FileDescription\", \"Rufus\"",
          "393:             VALUE \"InternalName\", \"Rufus\"",
          "394:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "395:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "396:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "397:             VALUE \"ProductName\", \"Rufus\"",
          "399:         END",
          "400:     END",
          "401:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1235\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1235\"",
          "",
          "[Added Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1236\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1236\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d1d6e0f8b473533998ec0c1eb92859e6dc1d4213",
      "candidate_info": {
        "commit_hash": "d1d6e0f8b473533998ec0c1eb92859e6dc1d4213",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/d1d6e0f8b473533998ec0c1eb92859e6dc1d4213",
        "files": [
          "src/rufus.c",
          "src/rufus.rc"
        ],
        "message": "[ui] improve centering of the toolbar icons\n\n* Microsoft, how I loathe thee!!!",
        "before_after_code_files": [
          "src/rufus.c||src/rufus.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2090:  tbToolbarButtons[6].fsState = TBSTATE_ENABLED;",
          "2091:  tbToolbarButtons[6].iBitmap = 3;",
          "2092:  SendMessage(hMultiToolbar, TB_ADDBUTTONS, (WPARAM)7, (LPARAM)&tbToolbarButtons);",
          "2094: }",
          "",
          "[Removed Lines]",
          "2093:  SendMessage(hMultiToolbar, TB_SETBUTTONSIZE, 0, MAKELPARAM(0, ddbh));",
          "",
          "[Added Lines]",
          "2093:  SendMessage(hMultiToolbar, TB_SETBUTTONSIZE, 0, MAKELPARAM(i16, ddbh));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2286:  RECT rc;",
          "2287:  HWND hCtrl, hPrevCtrl;",
          "2288:  SIZE sz;",
          "2289:  int i, x, button_fudge = 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2289:  DWORD padding;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2379:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "2380:  SendMessage(hSaveToolbar, TB_GETIDEALSIZE, (WPARAM)FALSE, (LPARAM)&sz);",
          "2381:  SendMessage(hSaveToolbar, TB_SETBUTTONSIZE, 0, MAKELPARAM(sz.cx, ddbh));",
          "2382:  SetWindowPos(hSaveToolbar, hDeviceList, mw + fw - sbw, rc.top, sbw, ddbh, 0);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2384:  padding = SendMessage(hSaveToolbar, TB_GETPADDING, 0, 0);",
          "2385:  sz.cx = padding & 0xFFFF;",
          "2386:  sz.cy = padding >> 16;",
          "2387:  SendMessage(hSaveToolbar, TB_SETPADDING, 0, MAKELPARAM(sz.cx + 3, sz.cy + 2));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2387:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "2388:  SendMessage(hHashToolbar, TB_GETIDEALSIZE, (WPARAM)FALSE, (LPARAM)&sz);",
          "2389:  SendMessage(hHashToolbar, TB_SETBUTTONSIZE, 0, MAKELPARAM(sz.cx, ddbh));",
          "2393:  hCtrl = GetDlgItem(hDlg, IDS_CSM_HELP_TXT);",
          "",
          "[Removed Lines]",
          "2390:  SetWindowPos(hHashToolbar, hBootType, mw + bsw + ssw, rc.top, sz.cx, ddbh, 0);",
          "",
          "[Added Lines]",
          "2396:  padding = SendMessage(hHashToolbar, TB_GETPADDING, 0, 0);",
          "2397:  sz.cx = padding & 0xFFFF;",
          "2398:  sz.cy = padding >> 16;",
          "2399:  SendMessage(hHashToolbar, TB_SETPADDING, 0, MAKELPARAM(sz.cx + 3, sz.cy + 2));",
          "2400:  SetWindowPos(hHashToolbar, hBootType, mw + bsw + ssw, rc.top, sbw, ddbh, 0);",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1292\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1293\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,0,1292,0",
          "393:  PRODUCTVERSION 3,0,1292,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,0,1293,0",
          "393:  PRODUCTVERSION 3,0,1293,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.0.1292\"",
          "416:             VALUE \"ProductVersion\", \"3.0.1292\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.0.1293\"",
          "416:             VALUE \"ProductVersion\", \"3.0.1293\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "db234442e32b28819a4c2c623d8e32d42d015728",
      "candidate_info": {
        "commit_hash": "db234442e32b28819a4c2c623d8e32d42d015728",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/db234442e32b28819a4c2c623d8e32d42d015728",
        "files": [
          "src/rufus.rc",
          "src/stdlg.c"
        ],
        "message": "[ui] improve selection dialog when there exist more than 6 options\n\n* Closes #891",
        "before_after_code_files": [
          "src/rufus.rc||src/rufus.rc",
          "src/stdlg.c||src/stdlg.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc",
            "src/stdlg.c||src/stdlg.c"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc",
            "src/stdlg.c||src/stdlg.c"
          ]
        }
      },
      "candidate_diff": {
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1035\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1036\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "161:     CONTROL         \"Choice 13\",IDC_SELECTION_CHOICE13,\"Button\",BS_AUTORADIOBUTTON | NOT WS_VISIBLE,35,174,269,10,WS_EX_TRANSPARENT",
          "162:     CONTROL         \"Choice 14\",IDC_SELECTION_CHOICE14,\"Button\",BS_AUTORADIOBUTTON | NOT WS_VISIBLE,35,187,269,10,WS_EX_TRANSPARENT",
          "163:     CONTROL         \"Choice 15\",IDC_SELECTION_CHOICE15,\"Button\",BS_AUTORADIOBUTTON | NOT WS_VISIBLE,35,200,269,10,WS_EX_TRANSPARENT",
          "165: END",
          "167: IDD_UPDATE_POLICY DIALOGEX 0, 0, 287, 198",
          "",
          "[Removed Lines]",
          "164:     CONTROL         \"Choice 16\",IDC_SELECTION_CHOICEMAX,\"Button\",BS_AUTORADIOBUTTON | NOT WS_VISIBLE,35,21,269,10,WS_EX_TRANSPARENT",
          "",
          "[Added Lines]",
          "164:     CONTROL         \"Choice 16\",IDC_SELECTION_CHOICEMAX,\"Button\",BS_AUTORADIOBUTTON | NOT WS_VISIBLE,35,213,269,10,WS_EX_TRANSPARENT",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1035,0",
          "338:  PRODUCTVERSION 2,12,1035,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1036,0",
          "338:  PRODUCTVERSION 2,12,1036,0",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1035\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1035\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1036\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1036\"",
          "",
          "---------------"
        ],
        "src/stdlg.c||src/stdlg.c": [
          "File: src/stdlg.c -> src/stdlg.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "849:  static HBRUSH background_brush, separator_brush;",
          "851:  NONCLIENTMETRICS ncm;",
          "853:  HFONT hDlgFont;",
          "854:  HWND hCtrl;",
          "855:  HDC hDC;",
          "",
          "[Removed Lines]",
          "852:  RECT rect;",
          "",
          "[Added Lines]",
          "852:  RECT rect, rect2;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "857:  switch (message) {",
          "858:  case WM_INITDIALOG:",
          "862:     nChoices, IDC_SELECTION_CHOICEMAX - IDC_SELECTION_CHOICE1);",
          "863:    nChoices = IDC_SELECTION_CHOICEMAX - IDC_SELECTION_CHOICE1;",
          "864:   }",
          "",
          "[Removed Lines]",
          "860:   if (nChoices > (IDC_SELECTION_CHOICEMAX - IDC_SELECTION_CHOICE1)) {",
          "861:    uprintf(\"WARNING: Too many options requested for Selection (%d vs %d)\",",
          "",
          "[Added Lines]",
          "860:   if (nChoices > (IDC_SELECTION_CHOICEMAX - IDC_SELECTION_CHOICE1 + 1)) {",
          "861:    uprintf(\"Warning: Too many options requested for Selection (%d vs %d)\",",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "913:    ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDC_SELECTION_CHOICE1 + i), 0, dh, 0, 0, 1.0f);",
          "914:   if (nChoices > 2) {",
          "915:    GetWindowRect(GetDlgItem(hDlg, IDC_SELECTION_CHOICE1), &rect);",
          "917:   }",
          "918:   ResizeMoveCtrl(hDlg, hDlg, 0, 0, 0, dh, 1.0f);",
          "919:   ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, -1), 0, 0, 0, dh, 1.0f); // IDC_STATIC = -1",
          "",
          "[Removed Lines]",
          "916:    dh += (nChoices - 1) * (rect.bottom - rect.top) - 5;",
          "",
          "[Added Lines]",
          "916:    GetWindowRect(GetDlgItem(hDlg, IDC_SELECTION_CHOICE2), &rect2);",
          "917:    dh += (nChoices - 2) * (rect2.top - rect.top) + 5;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7b8694326645bc31c40818e2d6cc2c2235a6fed6",
      "candidate_info": {
        "commit_hash": "7b8694326645bc31c40818e2d6cc2c2235a6fed6",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/7b8694326645bc31c40818e2d6cc2c2235a6fed6",
        "files": [
          "src/format.c",
          "src/rufus.rc"
        ],
        "message": "[ui] don't report an error on chkdsk failure",
        "before_after_code_files": [
          "src/format.c||src/format.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/format.c||src/format.c": [
          "File: src/format.c -> src/format.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "200:  if (IS_ERROR(FormatStatus))",
          "201:   return FALSE;",
          "204:  case FCC_PROGRESS:",
          "205:  case FCC_CHECKDISK_PROGRESS:",
          "206:   percent = (DWORD*)pData;",
          "207:   PrintInfo(0, MSG_219, *percent);",
          "208:   break;",
          "209:  case FCC_DONE:",
          "213:   }",
          "214:   break;",
          "215:  case FCC_UNKNOWN1A:",
          "",
          "[Removed Lines]",
          "203:  switch(Command) {",
          "210:   if(*(BOOLEAN*)pData == FALSE) {",
          "211:    uprintf(\"Error while checking disk.\\n\");",
          "212:    FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_GEN_FAILURE;",
          "",
          "[Added Lines]",
          "203:  switch (Command) {",
          "210:   if (*(BOOLEAN*)pData == FALSE) {",
          "211:    uprintf(\"Error while checking disk\");",
          "212:    return FALSE;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "218:   break;",
          "219:  case FCC_INCOMPATIBLE_FILE_SYSTEM:",
          "223:  case FCC_ACCESS_DENIED:",
          "227:  case FCC_MEDIA_WRITE_PROTECTED:",
          "231:  case FCC_VOLUME_IN_USE:",
          "235:  case FCC_OUTPUT:",
          "236:   OutputUTF8Message(((PTEXTOUTPUT)pData)->Output);",
          "237:   break;",
          "238:  case FCC_NO_MEDIA_IN_DRIVE:",
          "242:  case FCC_READ_ONLY_MODE:",
          "244:   break;",
          "245:  default:",
          "248:   break;",
          "249:  }",
          "251: }",
          "",
          "[Removed Lines]",
          "220:   uprintf(\"Incompatible File System\\n\");",
          "221:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|APPERR(ERROR_INCOMPATIBLE_FS);",
          "222:   break;",
          "224:   uprintf(\"Access denied\\n\");",
          "225:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_ACCESS_DENIED;",
          "226:   break;",
          "228:   uprintf(\"Media is write protected\\n\");",
          "229:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_WRITE_PROTECT;",
          "230:   break;",
          "232:   uprintf(\"Volume is in use\\n\");",
          "233:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_DEVICE_IN_USE;",
          "234:   break;",
          "239:   uprintf(\"No media in drive\\n\");",
          "240:   FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_NO_MEDIA_IN_DRIVE;",
          "241:   break;",
          "243:   uprintf(\"Media has been switched to read-only - Leaving checkdisk\\n\");",
          "246:   uprintf(\"ChkdskExCallback: received unhandled command %X\\n\", Command);",
          "250:  return (!IS_ERROR(FormatStatus));",
          "",
          "[Added Lines]",
          "220:   uprintf(\"Incompatible File System\");",
          "221:   return FALSE;",
          "223:   uprintf(\"Access denied\");",
          "224:   return FALSE;",
          "226:   uprintf(\"Media is write protected\");",
          "227:   return FALSE;",
          "229:   uprintf(\"Volume is in use\");",
          "230:   return FALSE;",
          "235:   uprintf(\"No media in drive\");",
          "236:   return FALSE;",
          "238:   uprintf(\"Media has been switched to read-only - Leaving checkdisk\");",
          "241:   uprintf(\"ChkdskExCallback: received unhandled command %X\", Command);",
          "245:  return TRUE;",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.15.1099\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.15.1100\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,15,1099,0",
          "338:  PRODUCTVERSION 2,15,1099,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,15,1100,0",
          "338:  PRODUCTVERSION 2,15,1100,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.15.1099\"",
          "361:             VALUE \"ProductVersion\", \"2.15.1099\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.15.1100\"",
          "361:             VALUE \"ProductVersion\", \"2.15.1100\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}