{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "28d30346f442f848b8ecdcf208bc0d6bb565f38d",
      "candidate_info": {
        "commit_hash": "28d30346f442f848b8ecdcf208bc0d6bb565f38d",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/28d30346f442f848b8ecdcf208bc0d6bb565f38d",
        "files": [
          "test/pummel/test-net-timeout2.js"
        ],
        "message": "test: use common.PORT in pummel/test-net-timeout2",
        "before_after_code_files": [
          "test/pummel/test-net-timeout2.js||test/pummel/test-net-timeout2.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/pummel/test-net-timeout2.js||test/pummel/test-net-timeout2.js": [
          "File: test/pummel/test-net-timeout2.js -> test/pummel/test-net-timeout2.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "54: });",
          "59:   s.pipe(process.stdout);",
          "60: });",
          "",
          "[Removed Lines]",
          "57: server.listen(8888, function() {",
          "58:   var s = net.connect(8888);",
          "",
          "[Added Lines]",
          "57: server.listen(common.PORT, function() {",
          "58:   var s = net.connect(common.PORT);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3694b6914a68e655c51a3d3ba8f538231bf07d1e",
      "candidate_info": {
        "commit_hash": "3694b6914a68e655c51a3d3ba8f538231bf07d1e",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/3694b6914a68e655c51a3d3ba8f538231bf07d1e",
        "files": [
          "deps/openssl/config/k8/openssl/opensslconf-posix.h",
          "deps/openssl/config/k8/openssl/opensslconf-win32.h",
          "deps/openssl/config/k8/openssl/opensslconf.h"
        ],
        "message": "deps: reapply 0a34755 to bundled openssl",
        "before_after_code_files": [
          "deps/openssl/config/k8/openssl/opensslconf-posix.h||deps/openssl/config/k8/openssl/opensslconf-posix.h",
          "deps/openssl/config/k8/openssl/opensslconf-win32.h||deps/openssl/config/k8/openssl/opensslconf-win32.h",
          "deps/openssl/config/k8/openssl/opensslconf.h||deps/openssl/config/k8/openssl/opensslconf.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/openssl/config/k8/openssl/opensslconf-posix.h||deps/openssl/config/k8/openssl/opensslconf-posix.h": [
          "File: deps/openssl/config/k8/openssl/opensslconf-posix.h -> deps/openssl/config/k8/openssl/opensslconf-posix.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: #ifndef OPENSSL_DOING_MAKEDEPEND",
          "8: #ifndef OPENSSL_NO_CAMELLIA",
          "9: # define OPENSSL_NO_CAMELLIA",
          "10: #endif",
          "11: #ifndef OPENSSL_NO_CAPIENG",
          "12: # define OPENSSL_NO_CAPIENG",
          "13: #endif",
          "14: #ifndef OPENSSL_NO_CMS",
          "15: # define OPENSSL_NO_CMS",
          "16: #endif",
          "17: #ifndef OPENSSL_NO_FIPS",
          "18: # define OPENSSL_NO_FIPS",
          "19: #endif",
          "20: #ifndef OPENSSL_NO_GMP",
          "21: # define OPENSSL_NO_GMP",
          "22: #endif",
          "23: #ifndef OPENSSL_NO_IDEA",
          "24: # define OPENSSL_NO_IDEA",
          "25: #endif",
          "26: #ifndef OPENSSL_NO_JPAKE",
          "27: # define OPENSSL_NO_JPAKE",
          "28: #endif",
          "29: #ifndef OPENSSL_NO_KRB5",
          "30: # define OPENSSL_NO_KRB5",
          "31: #endif",
          "32: #ifndef OPENSSL_NO_MDC2",
          "33: # define OPENSSL_NO_MDC2",
          "34: #endif",
          "35: #ifndef OPENSSL_NO_RC5",
          "36: # define OPENSSL_NO_RC5",
          "37: #endif",
          "38: #ifndef OPENSSL_NO_RFC3779",
          "39: # define OPENSSL_NO_RFC3779",
          "40: #endif",
          "41: #ifndef OPENSSL_NO_SEED",
          "42: # define OPENSSL_NO_SEED",
          "43: #endif",
          "44: #ifndef OPENSSL_NO_ASM",
          "45: # define OPENSSL_NO_ASM",
          "46: #endif",
          "50: #ifndef OPENSSL_THREADS",
          "51: # define OPENSSL_THREADS",
          "52: #endif",
          "53: #ifndef OPENSSL_NO_DYNAMIC_ENGINE",
          "54: # define OPENSSL_NO_DYNAMIC_ENGINE",
          "55: #endif",
          "58:    asks for it.  This is a transient feature that is provided for those",
          "59:    who haven't had the time to do the appropriate changes in their",
          "61: #ifdef OPENSSL_ALGORITHM_DEFINES",
          "62: # if defined(OPENSSL_NO_CAMELLIA) && !defined(NO_CAMELLIA)",
          "63: #  define NO_CAMELLIA",
          "64: # endif",
          "65: # if defined(OPENSSL_NO_CAPIENG) && !defined(NO_CAPIENG)",
          "66: #  define NO_CAPIENG",
          "67: # endif",
          "68: # if defined(OPENSSL_NO_CMS) && !defined(NO_CMS)",
          "69: #  define NO_CMS",
          "70: # endif",
          "71: # if defined(OPENSSL_NO_FIPS) && !defined(NO_FIPS)",
          "72: #  define NO_FIPS",
          "73: # endif",
          "74: # if defined(OPENSSL_NO_GMP) && !defined(NO_GMP)",
          "75: #  define NO_GMP",
          "76: # endif",
          "77: # if defined(OPENSSL_NO_IDEA) && !defined(NO_IDEA)",
          "78: #  define NO_IDEA",
          "79: # endif",
          "80: # if defined(OPENSSL_NO_JPAKE) && !defined(NO_JPAKE)",
          "81: #  define NO_JPAKE",
          "82: # endif",
          "83: # if defined(OPENSSL_NO_KRB5) && !defined(NO_KRB5)",
          "84: #  define NO_KRB5",
          "85: # endif",
          "86: # if defined(OPENSSL_NO_MDC2) && !defined(NO_MDC2)",
          "87: #  define NO_MDC2",
          "88: # endif",
          "89: # if defined(OPENSSL_NO_RC5) && !defined(NO_RC5)",
          "90: #  define NO_RC5",
          "91: # endif",
          "92: # if defined(OPENSSL_NO_RFC3779) && !defined(NO_RFC3779)",
          "93: #  define NO_RFC3779",
          "94: # endif",
          "95: # if defined(OPENSSL_NO_SEED) && !defined(NO_SEED)",
          "96: #  define NO_SEED",
          "97: # endif",
          "98: #endif",
          "100: #define OPENSSL_CPUID_OBJ",
          "104: #ifdef OPENSSL_DOING_MAKEDEPEND",
          "113: #ifndef OPENSSL_FIPS",
          "114: #define OPENSSL_FIPS",
          "115: #endif",
          "117: #endif",
          "120: #undef I386_ONLY",
          "123: #if defined(HEADER_CRYPTLIB_H) && !defined(OPENSSLDIR)",
          "124: #define ENGINESDIR \"/usr/local/ssl/lib/engines\"",
          "125: #define OPENSSLDIR \"/usr/local/ssl\"",
          "126: #endif",
          "127: #endif",
          "129: #undef OPENSSL_UNISTD",
          "130: #define OPENSSL_UNISTD <unistd.h>",
          "131: #if !defined(SWIG)",
          "132: #include <unistd.h>",
          "133: #endif",
          "135: #undef OPENSSL_EXPORT_VAR_AS_FUNCTION",
          "137: #if defined(HEADER_IDEA_H) && !defined(IDEA_INT)",
          "138: #define IDEA_INT unsigned int",
          "139: #endif",
          "141: #if defined(HEADER_MD2_H) && !defined(MD2_INT)",
          "142: #define MD2_INT unsigned int",
          "143: #endif",
          "145: #if defined(HEADER_RC2_H) && !defined(RC2_INT)",
          "147: #define RC2_INT unsigned int",
          "148: #endif",
          "150: #if defined(HEADER_RC4_H)",
          "151: #if !defined(RC4_INT)",
          "159: #define RC4_INT unsigned int",
          "160: #endif",
          "161: #if !defined(RC4_CHUNK)",
          "166: #define RC4_CHUNK unsigned long",
          "167: #endif",
          "168: #endif",
          "170: #if (defined(HEADER_NEW_DES_H) || defined(HEADER_DES_H)) && !defined(DES_LONG)",
          "173: #ifndef DES_LONG",
          "174: #define DES_LONG unsigned int",
          "175: #endif",
          "176: #endif",
          "178: #if defined(HEADER_BN_H) && !defined(CONFIG_HEADER_BN_H)",
          "179: #define CONFIG_HEADER_BN_H",
          "180: #undef BN_LLONG",
          "188: #define SIXTY_FOUR_BIT_LONG",
          "189: #undef SIXTY_FOUR_BIT",
          "190: #undef THIRTY_TWO_BIT",
          "191: #undef SIXTEEN_BIT",
          "192: #undef EIGHT_BIT",
          "193: #endif",
          "195: #if defined(HEADER_RC4_LOCL_H) && !defined(CONFIG_HEADER_RC4_LOCL_H)",
          "196: #define CONFIG_HEADER_RC4_LOCL_H",
          "199: #undef RC4_INDEX",
          "200: #endif",
          "202: #if defined(HEADER_BF_LOCL_H) && !defined(CONFIG_HEADER_BF_LOCL_H)",
          "203: #define CONFIG_HEADER_BF_LOCL_H",
          "204: #undef BF_PTR",
          "207: #if defined(HEADER_DES_LOCL_H) && !defined(CONFIG_HEADER_DES_LOCL_H)",
          "208: #define CONFIG_HEADER_DES_LOCL_H",
          "209: #ifndef DES_DEFAULT_OPTIONS",
          "212: #ifndef DES_PTR",
          "213: #undef DES_PTR",
          "214: #endif",
          "219: #ifndef DES_RISC1",
          "220: #undef DES_RISC1",
          "221: #endif",
          "223: #ifndef DES_RISC2",
          "224: #undef DES_RISC2",
          "225: #endif",
          "227: #if defined(DES_RISC1) && defined(DES_RISC2)",
          "228: YOU SHOULD NOT HAVE BOTH DES_RISC1 AND DES_RISC2 DEFINED!!!!!",
          "229: #endif",
          "233: #ifndef DES_UNROLL",
          "234: #define DES_UNROLL",
          "235: #endif",
          "240: #if !defined(DES_PTR) && !defined(DES_RISC1) && !defined(DES_RISC2) && !defined(DES_UNROLL)",
          "242:    CPU and OS.  For SGI machines you can use _MIPS_SZLONG (32 or 64) to find",
          "243:    even newer MIPS CPU's, but at the moment one size fits all for",
          "244:    optimization options.  Older Sparc's work better with only UNROLL, but",
          "248: #  define DES_PTR",
          "249: #  define DES_RISC1",
          "250: #  define DES_UNROLL",
          "252: #  define DES_PTR",
          "253: #  define DES_RISC2",
          "254: #  define DES_UNROLL",
          "256: #  define DES_PTR",
          "257: #  define DES_RISC2",
          "265: #  define DES_UNROLL",
          "267: #  define DES_PTR",
          "268: #  define DES_RISC2",
          "269: #  define DES_UNROLL",
          "271: #  define DES_PTR",
          "272: #  define DES_RISC1",
          "273: #  define DES_UNROLL",
          "275: #endif",
          "",
          "---------------"
        ],
        "deps/openssl/config/k8/openssl/opensslconf-win32.h||deps/openssl/config/k8/openssl/opensslconf-win32.h": [
          "File: deps/openssl/config/k8/openssl/opensslconf-win32.h -> deps/openssl/config/k8/openssl/opensslconf-win32.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: #ifndef OPENSSL_SYSNAME_WIN32",
          "6: # define OPENSSL_SYSNAME_WIN32",
          "7: #endif",
          "8: #ifndef OPENSSL_DOING_MAKEDEPEND",
          "11: #ifndef OPENSSL_NO_CAMELLIA",
          "12: # define OPENSSL_NO_CAMELLIA",
          "13: #endif",
          "14: #ifndef OPENSSL_NO_CAPIENG",
          "15: # define OPENSSL_NO_CAPIENG",
          "16: #endif",
          "17: #ifndef OPENSSL_NO_CMS",
          "18: # define OPENSSL_NO_CMS",
          "19: #endif",
          "20: #ifndef OPENSSL_NO_GMP",
          "21: # define OPENSSL_NO_GMP",
          "22: #endif",
          "23: #ifndef OPENSSL_NO_IDEA",
          "24: # define OPENSSL_NO_IDEA",
          "25: #endif",
          "26: #ifndef OPENSSL_NO_JPAKE",
          "27: # define OPENSSL_NO_JPAKE",
          "28: #endif",
          "29: #ifndef OPENSSL_NO_KRB5",
          "30: # define OPENSSL_NO_KRB5",
          "31: #endif",
          "32: #ifndef OPENSSL_NO_MDC2",
          "33: # define OPENSSL_NO_MDC2",
          "34: #endif",
          "35: #ifndef OPENSSL_NO_RC5",
          "36: # define OPENSSL_NO_RC5",
          "37: #endif",
          "38: #ifndef OPENSSL_NO_RFC3779",
          "39: # define OPENSSL_NO_RFC3779",
          "40: #endif",
          "41: #ifndef OPENSSL_NO_SEED",
          "42: # define OPENSSL_NO_SEED",
          "43: #endif",
          "47: #ifndef OPENSSL_THREADS",
          "48: # define OPENSSL_THREADS",
          "49: #endif",
          "52:    asks for it.  This is a transient feature that is provided for those",
          "53:    who haven't had the time to do the appropriate changes in their",
          "55: #ifdef OPENSSL_ALGORITHM_DEFINES",
          "56: # if defined(OPENSSL_NO_CAMELLIA) && !defined(NO_CAMELLIA)",
          "57: #  define NO_CAMELLIA",
          "58: # endif",
          "59: # if defined(OPENSSL_NO_CAPIENG) && !defined(NO_CAPIENG)",
          "60: #  define NO_CAPIENG",
          "61: # endif",
          "62: # if defined(OPENSSL_NO_CMS) && !defined(NO_CMS)",
          "63: #  define NO_CMS",
          "64: # endif",
          "65: # if defined(OPENSSL_NO_GMP) && !defined(NO_GMP)",
          "66: #  define NO_GMP",
          "67: # endif",
          "68: # if defined(OPENSSL_NO_JPAKE) && !defined(NO_JPAKE)",
          "69: #  define NO_JPAKE",
          "70: # endif",
          "71: # if defined(OPENSSL_NO_KRB5) && !defined(NO_KRB5)",
          "72: #  define NO_KRB5",
          "73: # endif",
          "74: # if defined(OPENSSL_NO_MDC2) && !defined(NO_MDC2)",
          "75: #  define NO_MDC2",
          "76: # endif",
          "77: # if defined(OPENSSL_NO_RC5) && !defined(NO_RC5)",
          "78: #  define NO_RC5",
          "79: # endif",
          "80: # if defined(OPENSSL_NO_RFC3779) && !defined(NO_RFC3779)",
          "81: #  define NO_RFC3779",
          "82: # endif",
          "83: # if defined(OPENSSL_NO_SEED) && !defined(NO_SEED)",
          "84: #  define NO_SEED",
          "85: # endif",
          "86: #endif",
          "90: #ifdef OPENSSL_DOING_MAKEDEPEND",
          "99: #ifndef OPENSSL_FIPS",
          "100: #define OPENSSL_FIPS",
          "101: #endif",
          "103: #endif",
          "106: #undef I386_ONLY",
          "109: #if defined(HEADER_CRYPTLIB_H) && !defined(OPENSSLDIR)",
          "110: #define ENGINESDIR \"ssl/lib/engines\"",
          "111: #define OPENSSLDIR \"ssl\"",
          "112: #endif",
          "113: #endif",
          "115: #undef OPENSSL_UNISTD",
          "116: #define OPENSSL_UNISTD <unistd.h>",
          "118: #undef OPENSSL_EXPORT_VAR_AS_FUNCTION",
          "119: #define OPENSSL_EXPORT_VAR_AS_FUNCTION",
          "121: #if defined(HEADER_IDEA_H) && !defined(IDEA_INT)",
          "122: #define IDEA_INT unsigned int",
          "123: #endif",
          "125: #if defined(HEADER_MD2_H) && !defined(MD2_INT)",
          "126: #define MD2_INT unsigned int",
          "127: #endif",
          "129: #if defined(HEADER_RC2_H) && !defined(RC2_INT)",
          "131: #define RC2_INT unsigned int",
          "132: #endif",
          "134: #if defined(HEADER_RC4_H)",
          "135: #if !defined(RC4_INT)",
          "143: #define RC4_INT unsigned int",
          "144: #endif",
          "145: #if !defined(RC4_CHUNK)",
          "150: #define RC4_CHUNK unsigned long long",
          "151: #endif",
          "152: #endif",
          "154: #if (defined(HEADER_NEW_DES_H) || defined(HEADER_DES_H)) && !defined(DES_LONG)",
          "157: #ifndef DES_LONG",
          "158: #define DES_LONG unsigned int",
          "159: #endif",
          "160: #endif",
          "162: #if defined(HEADER_BN_H) && !defined(CONFIG_HEADER_BN_H)",
          "163: #define CONFIG_HEADER_BN_H",
          "164: #undef BN_LLONG",
          "172: #undef SIXTY_FOUR_BIT_LONG",
          "173: #define SIXTY_FOUR_BIT",
          "174: #undef THIRTY_TWO_BIT",
          "175: #undef SIXTEEN_BIT",
          "176: #undef EIGHT_BIT",
          "177: #endif",
          "179: #if defined(HEADER_RC4_LOCL_H) && !defined(CONFIG_HEADER_RC4_LOCL_H)",
          "180: #define CONFIG_HEADER_RC4_LOCL_H",
          "183: #undef RC4_INDEX",
          "184: #endif",
          "186: #if defined(HEADER_BF_LOCL_H) && !defined(CONFIG_HEADER_BF_LOCL_H)",
          "187: #define CONFIG_HEADER_BF_LOCL_H",
          "188: #undef BF_PTR",
          "191: #if defined(HEADER_DES_LOCL_H) && !defined(CONFIG_HEADER_DES_LOCL_H)",
          "192: #define CONFIG_HEADER_DES_LOCL_H",
          "193: #ifndef DES_DEFAULT_OPTIONS",
          "196: #ifndef DES_PTR",
          "197: #undef DES_PTR",
          "198: #endif",
          "203: #ifndef DES_RISC1",
          "204: #undef DES_RISC1",
          "205: #endif",
          "207: #ifndef DES_RISC2",
          "208: #undef DES_RISC2",
          "209: #endif",
          "211: #if defined(DES_RISC1) && defined(DES_RISC2)",
          "212: YOU SHOULD NOT HAVE BOTH DES_RISC1 AND DES_RISC2 DEFINED!!!!!",
          "213: #endif",
          "217: #ifndef DES_UNROLL",
          "218: #undef DES_UNROLL",
          "219: #endif",
          "224: #if !defined(DES_PTR) && !defined(DES_RISC1) && !defined(DES_RISC2) && !defined(DES_UNROLL)",
          "226:    CPU and OS.  For SGI machines you can use _MIPS_SZLONG (32 or 64) to find",
          "227:    even newer MIPS CPU's, but at the moment one size fits all for",
          "228:    optimization options.  Older Sparc's work better with only UNROLL, but",
          "232: #  define DES_PTR",
          "233: #  define DES_RISC1",
          "234: #  define DES_UNROLL",
          "236: #  define DES_PTR",
          "237: #  define DES_RISC2",
          "238: #  define DES_UNROLL",
          "240: #  define DES_PTR",
          "241: #  define DES_RISC2",
          "249: #  define DES_UNROLL",
          "251: #  define DES_PTR",
          "252: #  define DES_RISC2",
          "253: #  define DES_UNROLL",
          "255: #  define DES_PTR",
          "256: #  define DES_RISC1",
          "257: #  define DES_UNROLL",
          "259: #endif",
          "",
          "---------------"
        ],
        "deps/openssl/config/k8/openssl/opensslconf.h||deps/openssl/config/k8/openssl/opensslconf.h": [
          "File: deps/openssl/config/k8/openssl/opensslconf.h -> deps/openssl/config/k8/openssl/opensslconf.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "10: #endif",
          "",
          "[Removed Lines]",
          "5: #ifndef OPENSSL_DOING_MAKEDEPEND",
          "8: #ifndef OPENSSL_NO_CAMELLIA",
          "9: # define OPENSSL_NO_CAMELLIA",
          "11: #ifndef OPENSSL_NO_CAPIENG",
          "12: # define OPENSSL_NO_CAPIENG",
          "13: #endif",
          "14: #ifndef OPENSSL_NO_CMS",
          "15: # define OPENSSL_NO_CMS",
          "16: #endif",
          "17: #ifndef OPENSSL_NO_FIPS",
          "18: # define OPENSSL_NO_FIPS",
          "19: #endif",
          "20: #ifndef OPENSSL_NO_GMP",
          "21: # define OPENSSL_NO_GMP",
          "22: #endif",
          "23: #ifndef OPENSSL_NO_IDEA",
          "24: # define OPENSSL_NO_IDEA",
          "25: #endif",
          "26: #ifndef OPENSSL_NO_JPAKE",
          "27: # define OPENSSL_NO_JPAKE",
          "28: #endif",
          "29: #ifndef OPENSSL_NO_KRB5",
          "30: # define OPENSSL_NO_KRB5",
          "31: #endif",
          "32: #ifndef OPENSSL_NO_MDC2",
          "33: # define OPENSSL_NO_MDC2",
          "34: #endif",
          "35: #ifndef OPENSSL_NO_RC5",
          "36: # define OPENSSL_NO_RC5",
          "37: #endif",
          "38: #ifndef OPENSSL_NO_RFC3779",
          "39: # define OPENSSL_NO_RFC3779",
          "40: #endif",
          "41: #ifndef OPENSSL_NO_SEED",
          "42: # define OPENSSL_NO_SEED",
          "43: #endif",
          "44: #ifndef OPENSSL_NO_ASM",
          "45: # define OPENSSL_NO_ASM",
          "46: #endif",
          "50: #ifndef OPENSSL_THREADS",
          "51: # define OPENSSL_THREADS",
          "52: #endif",
          "53: #ifndef OPENSSL_NO_DYNAMIC_ENGINE",
          "54: # define OPENSSL_NO_DYNAMIC_ENGINE",
          "55: #endif",
          "58:    asks for it.  This is a transient feature that is provided for those",
          "59:    who haven't had the time to do the appropriate changes in their",
          "61: #ifdef OPENSSL_ALGORITHM_DEFINES",
          "62: # if defined(OPENSSL_NO_CAMELLIA) && !defined(NO_CAMELLIA)",
          "63: #  define NO_CAMELLIA",
          "64: # endif",
          "65: # if defined(OPENSSL_NO_CAPIENG) && !defined(NO_CAPIENG)",
          "66: #  define NO_CAPIENG",
          "67: # endif",
          "68: # if defined(OPENSSL_NO_CMS) && !defined(NO_CMS)",
          "69: #  define NO_CMS",
          "70: # endif",
          "71: # if defined(OPENSSL_NO_FIPS) && !defined(NO_FIPS)",
          "72: #  define NO_FIPS",
          "73: # endif",
          "74: # if defined(OPENSSL_NO_GMP) && !defined(NO_GMP)",
          "75: #  define NO_GMP",
          "76: # endif",
          "77: # if defined(OPENSSL_NO_IDEA) && !defined(NO_IDEA)",
          "78: #  define NO_IDEA",
          "79: # endif",
          "80: # if defined(OPENSSL_NO_JPAKE) && !defined(NO_JPAKE)",
          "81: #  define NO_JPAKE",
          "82: # endif",
          "83: # if defined(OPENSSL_NO_KRB5) && !defined(NO_KRB5)",
          "84: #  define NO_KRB5",
          "85: # endif",
          "86: # if defined(OPENSSL_NO_MDC2) && !defined(NO_MDC2)",
          "87: #  define NO_MDC2",
          "88: # endif",
          "89: # if defined(OPENSSL_NO_RC5) && !defined(NO_RC5)",
          "90: #  define NO_RC5",
          "91: # endif",
          "92: # if defined(OPENSSL_NO_RFC3779) && !defined(NO_RFC3779)",
          "93: #  define NO_RFC3779",
          "94: # endif",
          "95: # if defined(OPENSSL_NO_SEED) && !defined(NO_SEED)",
          "96: #  define NO_SEED",
          "97: # endif",
          "98: #endif",
          "100: #define OPENSSL_CPUID_OBJ",
          "104: #ifdef OPENSSL_DOING_MAKEDEPEND",
          "113: #ifndef OPENSSL_FIPS",
          "114: #define OPENSSL_FIPS",
          "115: #endif",
          "117: #endif",
          "120: #undef I386_ONLY",
          "123: #if defined(HEADER_CRYPTLIB_H) && !defined(OPENSSLDIR)",
          "124: #define ENGINESDIR \"/usr/local/ssl/lib/engines\"",
          "125: #define OPENSSLDIR \"/usr/local/ssl\"",
          "126: #endif",
          "127: #endif",
          "129: #undef OPENSSL_UNISTD",
          "130: #define OPENSSL_UNISTD <unistd.h>",
          "131: #if !defined(SWIG)",
          "132: #include <unistd.h>",
          "133: #endif",
          "135: #undef OPENSSL_EXPORT_VAR_AS_FUNCTION",
          "137: #if defined(HEADER_IDEA_H) && !defined(IDEA_INT)",
          "138: #define IDEA_INT unsigned int",
          "139: #endif",
          "141: #if defined(HEADER_MD2_H) && !defined(MD2_INT)",
          "142: #define MD2_INT unsigned int",
          "143: #endif",
          "145: #if defined(HEADER_RC2_H) && !defined(RC2_INT)",
          "147: #define RC2_INT unsigned int",
          "148: #endif",
          "150: #if defined(HEADER_RC4_H)",
          "151: #if !defined(RC4_INT)",
          "159: #define RC4_INT unsigned int",
          "160: #endif",
          "161: #if !defined(RC4_CHUNK)",
          "166: #define RC4_CHUNK unsigned long",
          "167: #endif",
          "168: #endif",
          "170: #if (defined(HEADER_NEW_DES_H) || defined(HEADER_DES_H)) && !defined(DES_LONG)",
          "173: #ifndef DES_LONG",
          "174: #define DES_LONG unsigned int",
          "175: #endif",
          "176: #endif",
          "178: #if defined(HEADER_BN_H) && !defined(CONFIG_HEADER_BN_H)",
          "179: #define CONFIG_HEADER_BN_H",
          "180: #undef BN_LLONG",
          "188: #define SIXTY_FOUR_BIT_LONG",
          "189: #undef SIXTY_FOUR_BIT",
          "190: #undef THIRTY_TWO_BIT",
          "191: #undef SIXTEEN_BIT",
          "192: #undef EIGHT_BIT",
          "193: #endif",
          "195: #if defined(HEADER_RC4_LOCL_H) && !defined(CONFIG_HEADER_RC4_LOCL_H)",
          "196: #define CONFIG_HEADER_RC4_LOCL_H",
          "199: #undef RC4_INDEX",
          "200: #endif",
          "202: #if defined(HEADER_BF_LOCL_H) && !defined(CONFIG_HEADER_BF_LOCL_H)",
          "203: #define CONFIG_HEADER_BF_LOCL_H",
          "204: #undef BF_PTR",
          "207: #if defined(HEADER_DES_LOCL_H) && !defined(CONFIG_HEADER_DES_LOCL_H)",
          "208: #define CONFIG_HEADER_DES_LOCL_H",
          "209: #ifndef DES_DEFAULT_OPTIONS",
          "212: #ifndef DES_PTR",
          "213: #undef DES_PTR",
          "214: #endif",
          "219: #ifndef DES_RISC1",
          "220: #undef DES_RISC1",
          "221: #endif",
          "223: #ifndef DES_RISC2",
          "224: #undef DES_RISC2",
          "225: #endif",
          "227: #if defined(DES_RISC1) && defined(DES_RISC2)",
          "228: YOU SHOULD NOT HAVE BOTH DES_RISC1 AND DES_RISC2 DEFINED!!!!!",
          "229: #endif",
          "233: #ifndef DES_UNROLL",
          "234: #define DES_UNROLL",
          "235: #endif",
          "240: #if !defined(DES_PTR) && !defined(DES_RISC1) && !defined(DES_RISC2) && !defined(DES_UNROLL)",
          "242:    CPU and OS.  For SGI machines you can use _MIPS_SZLONG (32 or 64) to find",
          "243:    even newer MIPS CPU's, but at the moment one size fits all for",
          "244:    optimization options.  Older Sparc's work better with only UNROLL, but",
          "248: #  define DES_PTR",
          "249: #  define DES_RISC1",
          "250: #  define DES_UNROLL",
          "252: #  define DES_PTR",
          "253: #  define DES_RISC2",
          "254: #  define DES_UNROLL",
          "256: #  define DES_PTR",
          "257: #  define DES_RISC2",
          "265: #  define DES_UNROLL",
          "267: #  define DES_PTR",
          "268: #  define DES_RISC2",
          "269: #  define DES_UNROLL",
          "271: #  define DES_PTR",
          "272: #  define DES_RISC1",
          "273: #  define DES_UNROLL",
          "275: #endif",
          "",
          "[Added Lines]",
          "1: #ifdef WIN32",
          "2: #include \"opensslconf-win32.h\"",
          "3: #else",
          "4: #include \"opensslconf-posix.h\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8abb73ef58ccb6fd1b8cc4266c9981ce6574c78f",
      "candidate_info": {
        "commit_hash": "8abb73ef58ccb6fd1b8cc4266c9981ce6574c78f",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/8abb73ef58ccb6fd1b8cc4266c9981ce6574c78f",
        "files": [
          "lib/punycode.js"
        ],
        "message": "punycode: Update to v0.3.0",
        "before_after_code_files": [
          "lib/punycode.js||lipunycode.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/punycode.js||lipunycode.js": [
          "File: lib/punycode.js -> lipunycode.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "41:  errors = {",
          "42:   'overflow': 'Overflow: input needs wider integers to process.',",
          "45:   'not-basic': 'Illegal input >= 0x80 (not a basic code point)',",
          "46:   'invalid-input': 'Invalid input'",
          "47:  },",
          "",
          "[Removed Lines]",
          "43:   'utf16decode': 'UTF-16(decode): illegal UTF-16 sequence',",
          "44:   'utf16encode': 'UTF-16(encode): illegal UTF-16 value',",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "110:   var output = [],",
          "111:       counter = 0,",
          "112:       length = string.length,",
          "",
          "[Removed Lines]",
          "109:  function utf16decode(string) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "117:    if ((value & 0xF800) == 0xD800) {",
          "118:     extra = string.charCodeAt(counter++);",
          "119:     if ((value & 0xFC00) != 0xD800 || (extra & 0xFC00) != 0xDC00) {",
          "121:     }",
          "122:     value = ((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000;",
          "123:    }",
          "",
          "[Removed Lines]",
          "120:      error('utf16decode');",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "139:   return map(array, function(value) {",
          "140:    var output = '';",
          "141:    if ((value & 0xF800) == 0xD800) {",
          "143:    }",
          "144:    if (value > 0xFFFF) {",
          "145:     value -= 0x10000;",
          "",
          "[Removed Lines]",
          "138:  function utf16encode(array) {",
          "142:     error('utf16encode');",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "316:   }",
          "319:  }",
          "",
          "[Removed Lines]",
          "318:   return utf16encode(output);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "345:       baseMinusT,",
          "346:       qMinusT;",
          "352:   inputLength = input.length;",
          "",
          "[Removed Lines]",
          "349:   input = utf16decode(input);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "488:   },",
          "489:   'decode': decode,",
          "490:   'encode': encode,",
          "",
          "[Removed Lines]",
          "478:   'version': '0.2.1',",
          "485:   'utf16': {",
          "486:    'decode': utf16decode,",
          "487:    'encode': utf16encode",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8d3278b9620609c6c8970a456d9fc416989702d5",
      "candidate_info": {
        "commit_hash": "8d3278b9620609c6c8970a456d9fc416989702d5",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/8d3278b9620609c6c8970a456d9fc416989702d5",
        "files": [
          "src/node_version.h"
        ],
        "message": "Now working on 0.7.8",
        "before_after_code_files": [
          "src/node_version.h||src/node_version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_version.h||src/node_version.h": [
          "File: src/node_version.h -> src/node_version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #define NODE_MAJOR_VERSION 0",
          "30: #define NODE_MINOR_VERSION 7",
          "34: #ifndef NODE_STRINGIFY",
          "35: #define NODE_STRINGIFY(n) NODE_STRINGIFY_HELPER(n)",
          "",
          "[Removed Lines]",
          "31: #define NODE_PATCH_VERSION 7",
          "32: #define NODE_VERSION_IS_RELEASE 1",
          "",
          "[Added Lines]",
          "31: #define NODE_PATCH_VERSION 8",
          "32: #define NODE_VERSION_IS_RELEASE 0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a9b0bcfafe33c3871bf3c3b18c538025eff526d7",
      "candidate_info": {
        "commit_hash": "a9b0bcfafe33c3871bf3c3b18c538025eff526d7",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/a9b0bcfafe33c3871bf3c3b18c538025eff526d7",
        "files": [
          "src/node.js"
        ],
        "message": "Assign to property of global, instead of implicit global variable\n\nFixes crash in strict mode.",
        "before_after_code_files": [
          "src/node.js||src/node.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node.js||src/node.js": [
          "File: src/node.js -> src/node.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "27: (function(process) {",
          "30:   function startup() {",
          "31:     var EventEmitter = NativeModule.require('events').EventEmitter;",
          "",
          "[Removed Lines]",
          "28:   global = this;",
          "",
          "[Added Lines]",
          "28:   this.global = this;",
          "",
          "---------------"
        ]
      }
    }
  ]
}