{
  "cve_id": "CVE-2022-29193",
  "cve_desc": "TensorFlow is an open source platform for machine learning. Prior to versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4, the implementation of `tf.raw_ops.TensorSummaryV2` does not fully validate the input arguments. This results in a `CHECK`-failure which can be used to trigger a denial of service attack. Versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4 contain a patch for this issue.",
  "repo": "tensorflow/tensorflow",
  "patch_hash": "290bb05c80c327ed74fae1d089f1001b1e2a4ef7",
  "patch_info": {
    "commit_hash": "290bb05c80c327ed74fae1d089f1001b1e2a4ef7",
    "repo": "tensorflow/tensorflow",
    "commit_url": "https://github.com/tensorflow/tensorflow/commit/290bb05c80c327ed74fae1d089f1001b1e2a4ef7",
    "files": [
      "tensorflow/core/kernels/summary_tensor_op.cc"
    ],
    "message": "Fix tf.raw_ops.TensorSummaryV2 vulnerability with invalid serialized_summary_metadata.\n\nCheck that input is actually a scalar before treating it as such.\n\nPiperOrigin-RevId: 445197183",
    "before_after_code_files": [
      "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
    ]
  },
  "patch_diff": {
    "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc": [
      "File: tensorflow/core/kernels/summary_tensor_op.cc -> tensorflow/core/kernels/summary_tensor_op.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "36:                 errors::InvalidArgument(\"tag must be scalar\"));",
      "37:     const Tensor& tensor = c->input(1);",
      "38:     const Tensor& serialized_summary_metadata_tensor = c->input(2);",
      "40:     Summary s;",
      "41:     Summary::Value* v = s.add_value();",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "39:     OP_REQUIRES(",
      "40:         c,",
      "41:         TensorShapeUtils::IsScalar(serialized_summary_metadata_tensor.shape()),",
      "42:         errors::InvalidArgument(\"serialized_summary_metadata must be scalar\"));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "69925da81e6133800880f334aa8c3bb26ab8bfe6",
      "candidate_info": {
        "commit_hash": "69925da81e6133800880f334aa8c3bb26ab8bfe6",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/69925da81e6133800880f334aa8c3bb26ab8bfe6",
        "files": [
          "tensorflow/core/kernels/summary_tensor_op.cc"
        ],
        "message": "Fix tf.raw_ops.TensorSummaryV2 vulnerability with invalid serialized_summary_metadata.\n\nCheck that input is actually a scalar before treating it as such.\n\nPiperOrigin-RevId: 445197183",
        "before_after_code_files": [
          "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc": [
          "File: tensorflow/core/kernels/summary_tensor_op.cc -> tensorflow/core/kernels/summary_tensor_op.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:                 errors::InvalidArgument(\"tag must be scalar\"));",
          "37:     const Tensor& tensor = c->input(1);",
          "38:     const Tensor& serialized_summary_metadata_tensor = c->input(2);",
          "40:     Summary s;",
          "41:     Summary::Value* v = s.add_value();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "39:     OP_REQUIRES(",
          "40:         c,",
          "41:         TensorShapeUtils::IsScalar(serialized_summary_metadata_tensor.shape()),",
          "42:         errors::InvalidArgument(\"serialized_summary_metadata must be scalar\"));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "aebf9816e478b57714725a1111b57e9f7fade8f5",
      "candidate_info": {
        "commit_hash": "aebf9816e478b57714725a1111b57e9f7fade8f5",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/aebf9816e478b57714725a1111b57e9f7fade8f5",
        "files": [
          "tensorflow/core/kernels/summary_tensor_op.cc"
        ],
        "message": "Fix tf.raw_ops.TensorSummaryV2 vulnerability with invalid serialized_summary_metadata.\n\nCheck that input is actually a scalar before treating it as such.\n\nPiperOrigin-RevId: 445197183",
        "before_after_code_files": [
          "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc": [
          "File: tensorflow/core/kernels/summary_tensor_op.cc -> tensorflow/core/kernels/summary_tensor_op.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:                 errors::InvalidArgument(\"tag must be scalar\"));",
          "37:     const Tensor& tensor = c->input(1);",
          "38:     const Tensor& serialized_summary_metadata_tensor = c->input(2);",
          "40:     Summary s;",
          "41:     Summary::Value* v = s.add_value();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "39:     OP_REQUIRES(",
          "40:         c,",
          "41:         TensorShapeUtils::IsScalar(serialized_summary_metadata_tensor.shape()),",
          "42:         errors::InvalidArgument(\"serialized_summary_metadata must be scalar\"));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d26c16a5631ee5a0e8419659a6551c14e66f8497",
      "candidate_info": {
        "commit_hash": "d26c16a5631ee5a0e8419659a6551c14e66f8497",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/d26c16a5631ee5a0e8419659a6551c14e66f8497",
        "files": [
          "tensorflow/core/kernels/summary_tensor_op.cc"
        ],
        "message": "Fix tf.raw_ops.TensorSummaryV2 vulnerability with invalid serialized_summary_metadata.\n\nCheck that input is actually a scalar before treating it as such.\n\nPiperOrigin-RevId: 445197183",
        "before_after_code_files": [
          "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc": [
          "File: tensorflow/core/kernels/summary_tensor_op.cc -> tensorflow/core/kernels/summary_tensor_op.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:                 errors::InvalidArgument(\"tag must be scalar\"));",
          "37:     const Tensor& tensor = c->input(1);",
          "38:     const Tensor& serialized_summary_metadata_tensor = c->input(2);",
          "40:     Summary s;",
          "41:     Summary::Value* v = s.add_value();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "39:     OP_REQUIRES(",
          "40:         c,",
          "41:         TensorShapeUtils::IsScalar(serialized_summary_metadata_tensor.shape()),",
          "42:         errors::InvalidArgument(\"serialized_summary_metadata must be scalar\"));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "59f906078263fffde5dd753a01e98cf491b2af09",
      "candidate_info": {
        "commit_hash": "59f906078263fffde5dd753a01e98cf491b2af09",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/59f906078263fffde5dd753a01e98cf491b2af09",
        "files": [
          "tensorflow/core/kernels/summary_tensor_op.cc"
        ],
        "message": "Fix tf.raw_ops.TensorSummaryV2 vulnerability with invalid serialized_summary_metadata.\n\nCheck that input is actually a scalar before treating it as such.\n\nPiperOrigin-RevId: 445197183",
        "before_after_code_files": [
          "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/summary_tensor_op.cc||tensorflow/core/kernels/summary_tensor_op.cc": [
          "File: tensorflow/core/kernels/summary_tensor_op.cc -> tensorflow/core/kernels/summary_tensor_op.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:                 errors::InvalidArgument(\"tag must be scalar\"));",
          "37:     const Tensor& tensor = c->input(1);",
          "38:     const Tensor& serialized_summary_metadata_tensor = c->input(2);",
          "40:     Summary s;",
          "41:     Summary::Value* v = s.add_value();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "39:     OP_REQUIRES(",
          "40:         c,",
          "41:         TensorShapeUtils::IsScalar(serialized_summary_metadata_tensor.shape()),",
          "42:         errors::InvalidArgument(\"serialized_summary_metadata must be scalar\"));",
          "",
          "---------------"
        ]
      }
    }
  ]
}