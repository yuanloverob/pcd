{
  "cve_id": "CVE-2015-0288",
  "cve_desc": "The X509_to_X509_REQ function in crypto/x509/x509_req.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a might allow attackers to cause a denial of service (NULL pointer dereference and application crash) via an invalid certificate key.",
  "repo": "openssl/openssl",
  "patch_hash": "28a00bcd8e318da18031b2ac8778c64147cd54f9",
  "patch_info": {
    "commit_hash": "28a00bcd8e318da18031b2ac8778c64147cd54f9",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/28a00bcd8e318da18031b2ac8778c64147cd54f9",
    "files": [
      "crypto/x509/x509_req.c"
    ],
    "message": "Check public key is not NULL.\n\nCVE-2015-0288\nPR#3708\n\nReviewed-by: Matt Caswell <matt@openssl.org>",
    "before_after_code_files": [
      "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
    ]
  },
  "patch_diff": {
    "crypto/x509/x509_req.c||crypto/x509/x509_req.c": [
      "File: crypto/x509/x509_req.c -> crypto/x509/x509_req.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "92:         goto err;",
      "94:     pktmp = X509_get_pubkey(x);",
      "95:     i = X509_REQ_set_pubkey(ret, pktmp);",
      "96:     EVP_PKEY_free(pktmp);",
      "97:     if (!i)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "95:     if (pktmp == NULL)",
      "96:         goto err;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "241cff623e2b0f7c435a3a80ae783c29d994f061",
      "candidate_info": {
        "commit_hash": "241cff623e2b0f7c435a3a80ae783c29d994f061",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/241cff623e2b0f7c435a3a80ae783c29d994f061",
        "files": [
          "crypto/x509/x509_req.c"
        ],
        "message": "Check public key is not NULL.\n\nCVE-2015-0288\nPR#3708\n\nReviewed-by: Matt Caswell <matt@openssl.org>\n(cherry picked from commit 28a00bcd8e318da18031b2ac8778c64147cd54f9)",
        "before_after_code_files": [
          "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
          ],
          "candidate": [
            "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/x509/x509_req.c||crypto/x509/x509_req.c": [
          "File: crypto/x509/x509_req.c -> crypto/x509/x509_req.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "91:         goto err;",
          "93:     pktmp = X509_get_pubkey(x);",
          "94:     i = X509_REQ_set_pubkey(ret, pktmp);",
          "95:     EVP_PKEY_free(pktmp);",
          "96:     if (!i)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "94:     if (pktmp == NULL)",
          "95:         goto err;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "51527f1e3564f210e984fe5b654c45d34e4f03d7",
      "candidate_info": {
        "commit_hash": "51527f1e3564f210e984fe5b654c45d34e4f03d7",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/51527f1e3564f210e984fe5b654c45d34e4f03d7",
        "files": [
          "crypto/x509/x509_req.c"
        ],
        "message": "Check public key is not NULL.\n\nCVE-2015-0288\nPR#3708\n\nReviewed-by: Matt Caswell <matt@openssl.org>\n(cherry picked from commit 28a00bcd8e318da18031b2ac8778c64147cd54f9)",
        "before_after_code_files": [
          "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
          ],
          "candidate": [
            "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/x509/x509_req.c||crypto/x509/x509_req.c": [
          "File: crypto/x509/x509_req.c -> crypto/x509/x509_req.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "92:         goto err;",
          "94:     pktmp = X509_get_pubkey(x);",
          "95:     i = X509_REQ_set_pubkey(ret, pktmp);",
          "96:     EVP_PKEY_free(pktmp);",
          "97:     if (!i)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "95:     if (pktmp == NULL)",
          "96:         goto err;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4bf7b291692c59270ddca0e62de1f11611591cfc",
      "candidate_info": {
        "commit_hash": "4bf7b291692c59270ddca0e62de1f11611591cfc",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/4bf7b291692c59270ddca0e62de1f11611591cfc",
        "files": [
          "crypto/x509/x509_req.c"
        ],
        "message": "Check public key is not NULL.\n\nCVE-2015-0288\nPR#3708\n\nReviewed-by: Matt Caswell <matt@openssl.org>\n(cherry picked from commit 28a00bcd8e318da18031b2ac8778c64147cd54f9)",
        "before_after_code_files": [
          "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
          ],
          "candidate": [
            "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/x509/x509_req.c||crypto/x509/x509_req.c": [
          "File: crypto/x509/x509_req.c -> crypto/x509/x509_req.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "92:         goto err;",
          "94:     pktmp = X509_get_pubkey(x);",
          "95:     i = X509_REQ_set_pubkey(ret, pktmp);",
          "96:     EVP_PKEY_free(pktmp);",
          "97:     if (!i)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "95:     if (pktmp == NULL)",
          "96:         goto err;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9fdbaf3a322689a58381c724e4f3497320a69581",
      "candidate_info": {
        "commit_hash": "9fdbaf3a322689a58381c724e4f3497320a69581",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/9fdbaf3a322689a58381c724e4f3497320a69581",
        "files": [
          "crypto/x509/x509_req.c"
        ],
        "message": "Check public key is not NULL.\n\nCVE-2015-0288\nPR#3708\n\nReviewed-by: Matt Caswell <matt@openssl.org>\n(cherry picked from commit 28a00bcd8e318da18031b2ac8778c64147cd54f9)",
        "before_after_code_files": [
          "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
          ],
          "candidate": [
            "crypto/x509/x509_req.c||crypto/x509/x509_req.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/x509/x509_req.c||crypto/x509/x509_req.c": [
          "File: crypto/x509/x509_req.c -> crypto/x509/x509_req.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "92:         goto err;",
          "94:     pktmp = X509_get_pubkey(x);",
          "95:     i = X509_REQ_set_pubkey(ret, pktmp);",
          "96:     EVP_PKEY_free(pktmp);",
          "97:     if (!i)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "95:     if (pktmp == NULL)",
          "96:         goto err;",
          "",
          "---------------"
        ]
      }
    }
  ]
}