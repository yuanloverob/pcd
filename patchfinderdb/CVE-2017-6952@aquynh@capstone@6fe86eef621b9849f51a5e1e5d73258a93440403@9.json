{
  "cve_id": "CVE-2017-6952",
  "cve_desc": "Integer overflow in the cs_winkernel_malloc function in winkernel_mm.c in Capstone 3.0.4 and earlier allows attackers to cause a denial of service (heap-based buffer overflow in a kernel driver) or possibly have unspecified other impact via a large value.",
  "repo": "aquynh/capstone",
  "patch_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
  "patch_info": {
    "commit_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
    "repo": "aquynh/capstone",
    "commit_url": "https://github.com/aquynh/capstone/commit/6fe86eef621b9849f51a5e1e5d73258a93440403",
    "files": [
      "windows/winkernel_mm.c"
    ],
    "message": "provide a validity check to prevent against Integer overflow conditions (#870)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.",
    "before_after_code_files": [
      "windows/winkernel_mm.c||windows/winkernel_mm.c"
    ]
  },
  "patch_diff": {
    "windows/winkernel_mm.c||windows/winkernel_mm.c": [
      "File: windows/winkernel_mm.c -> windows/winkernel_mm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: #include \"winkernel_mm.h\"",
      "5: #include <ntddk.h>",
      "8: static const ULONG CS_WINKERNEL_POOL_TAG = 'kwsC';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "6: #include <Ntintsafe.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "35: #pragma prefast(suppress : 30030)  // Allocating executable POOL_TYPE memory",
      "38:  if (!block) {",
      "39:   return NULL;",
      "40:  }",
      "",
      "[Removed Lines]",
      "36:  CS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "37:    NonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);",
      "",
      "[Added Lines]",
      "37:  size_t number_of_bytes = 0;",
      "38:  CS_WINKERNEL_MEMBLOCK *block = NULL;",
      "42:  if (!NT_SUCCESS(RtlSizeTAdd(size, sizeof(CS_WINKERNEL_MEMBLOCK), &number_of_bytes))) {",
      "43:   return NULL;",
      "44:  }",
      "45:  block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "46:    NonPagedPool, number_of_bytes, CS_WINKERNEL_POOL_TAG);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7a8c7afd12ead437378c7158e2f87fdf7569afc0",
      "candidate_info": {
        "commit_hash": "7a8c7afd12ead437378c7158e2f87fdf7569afc0",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/7a8c7afd12ead437378c7158e2f87fdf7569afc0",
        "files": [
          "ChangeLog",
          "bindings/java/capstone/Capstone.java"
        ],
        "message": "Java: Support cs_strerror() and cs_regs_access()",
        "before_after_code_files": [
          "bindings/javcapstone/Capstone.java||bindings/java/capstone/Capstone.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "bindings/javcapstone/Capstone.java||bindings/java/capstone/Capstone.java": [
          "File: bindings/javcapstone/Capstone.java -> bindings/java/capstone/Capstone.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: import com.sun.jna.Memory;",
          "10: import com.sun.jna.ptr.ByteByReference;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "243:     public CsRegsAccess regsAccess() {",
          "244:       Memory regsReadMemory = new Memory(64*2);",
          "245:       ByteByReference regsReadCountRef = new ByteByReference();",
          "246:       Memory regsWriteMemory = new Memory(64*2);",
          "247:       ByteByReference regsWriteCountRef = new ByteByReference();",
          "249:       int c = cs.cs_regs_access(csh, raw.getPointer(), regsReadMemory, regsReadCountRef, regsWriteMemory, regsWriteCountRef);",
          "250:       if (c != CS_ERR_OK) {",
          "251:         return null;",
          "252:       }",
          "254:       byte regsReadCount = regsReadCountRef.getValue();",
          "255:       byte regsWriteCount = regsWriteCountRef.getValue();",
          "257:       short[] regsRead = new short[regsReadCount];",
          "258:       regsReadMemory.read(0, regsRead, 0, regsReadCount);",
          "260:       short[] regsWrite = new short[regsWriteCount];",
          "261:       regsWriteMemory.read(0, regsWrite, 0, regsWriteCount);",
          "263:       return new CsRegsAccess(regsRead, regsWrite);",
          "264:     }",
          "265:   }",
          "267:   public static class CsRegsAccess {",
          "268:     public short[] regsRead;",
          "269:     public short[] regsWrite;",
          "271:     public CsRegsAccess(short[] regsRead, short[] regsWrite) {",
          "272:       this.regsRead = regsRead;",
          "273:       this.regsWrite = regsWrite;",
          "274:     }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "307:     public String cs_strerror(int code);",
          "308:     public int cs_regs_access(NativeLong handle, Pointer insn, Pointer regs_read, ByteByReference regs_read_count, Pointer regs_write, ByteByReference regs_write_count);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "518:   public String strerror(int code) {",
          "519:     return cs.cs_strerror(code);",
          "520:   }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "34533f3132661859a3c2681b09a6e9f5280da720",
      "candidate_info": {
        "commit_hash": "34533f3132661859a3c2681b09a6e9f5280da720",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/34533f3132661859a3c2681b09a6e9f5280da720",
        "files": [
          "cstool/cstool.c",
          "cstool/cstool_arm.c",
          "cstool/cstool_arm64.c",
          "cstool/cstool_mips.c",
          "cstool/cstool_ppc.c",
          "cstool/cstool_sparc.c",
          "cstool/cstool_systemz.c",
          "cstool/cstool_x86.c",
          "cstool/cstool_xcore.c"
        ],
        "message": "cstool: cleanup",
        "before_after_code_files": [
          "cstool/cstool.c||cstool/cstool.c",
          "cstool/cstool_arm.c||cstool/cstool_arm.c",
          "cstool/cstool_arm64.c||cstool/cstool_arm64.c",
          "cstool/cstool_mips.c||cstool/cstool_mips.c",
          "cstool/cstool_ppc.c||cstool/cstool_ppc.c",
          "cstool/cstool_sparc.c||cstool/cstool_sparc.c",
          "cstool/cstool_systemz.c||cstool/cstool_systemz.c",
          "cstool/cstool_x86.c||cstool/cstool_x86.c",
          "cstool/cstool_xcore.c||cstool/cstool_xcore.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "cstool/cstool.c||cstool/cstool.c": [
          "File: cstool/cstool.c -> cstool/cstool.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: void print_insn_detail_sysz(csh handle, cs_insn *ins);",
          "19: void print_insn_detail_xcore(csh handle, cs_insn *ins);",
          "22: static uint8_t char_to_hexnum(char c)",
          "23: {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "22: {",
          "23:  unsigned char *c;",
          "25:  printf(\"%s\", comment);",
          "26:  for (c = str; c < str + len; c++) {",
          "27:   printf(\"0x%02x \", *c & 0xff);",
          "28:  }",
          "30:  printf(\"\\n\");",
          "31: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "62: static void usage(char *prog)",
          "63: {",
          "64:  printf(\"Cstool v%s for Capstone Disassembler Engine (www.capstone-engine.org)\\n\\n\", VERSION);",
          "66:  printf(\"\\nThe following <arch+mode> options are supported:\\n\");",
          "68:  if (cs_support(CS_ARCH_X86)) {",
          "",
          "[Removed Lines]",
          "65:  printf(\"Syntax: %s [-d:print all debug information] <arch+mode> <assembly-hexstring> [start-address-in-hex-format]\\n\", prog);",
          "",
          "[Added Lines]",
          "77:  printf(\"Syntax: %s [-d:print all detail information] <arch+mode> <assembly-hexstring> [start-address-in-hex-format]\\n\", prog);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124:  cs_insn *insn;",
          "125:  cs_err err;",
          "126:  cs_mode md;",
          "130:  if (argc != 3 && argc != 4 && argc != 5) {",
          "131:   usage(argv[0]);",
          "",
          "[Removed Lines]",
          "127:  char *arch;",
          "128:  bool debug_flag = false;",
          "",
          "[Added Lines]",
          "139:  cs_arch arch;",
          "140:  bool detail_flag = false;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "133:  }",
          "135:  if (!strcmp(argv[1], \"-d\")) {",
          "141:   mode = argv[2];",
          "142:   assembly = preprocess(argv[3], &size);",
          "143:   if (argc == 5) {",
          "",
          "[Removed Lines]",
          "136:    if (argc == 3) {",
          "137:     usage(argv[0]);",
          "138:     return -1;",
          "139:  }",
          "140:   debug_flag = true;",
          "",
          "[Added Lines]",
          "148:   if (argc == 3) {",
          "149:    usage(argv[0]);",
          "150:    return -1;",
          "151:   }",
          "152:   detail_flag = true;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "171:    }",
          "172:   }",
          "173:  }",
          "175:  if (!strcmp(mode, \"arm\")) {",
          "177:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM, &handle);",
          "178:  }",
          "180:  if (!strcmp(mode, \"armb\")) {",
          "182:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM + CS_MODE_BIG_ENDIAN, &handle);",
          "183:  }",
          "185:  if (!strcmp(mode, \"arml\")) {",
          "187:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM + CS_MODE_LITTLE_ENDIAN, &handle);",
          "188:  }",
          "190:  if (!strcmp(mode, \"thumb\")) {",
          "192:   err = cs_open(CS_ARCH_ARM, CS_MODE_THUMB + CS_MODE_LITTLE_ENDIAN, &handle);",
          "193:  }",
          "195:  if (!strcmp(mode, \"thumbbe\")) {",
          "197:   err = cs_open(CS_ARCH_ARM, CS_MODE_THUMB + CS_MODE_BIG_ENDIAN, &handle);",
          "198:  }",
          "200:  if (!strcmp(mode, \"thumble\")) {",
          "202:   err = cs_open(CS_ARCH_ARM, CS_MODE_ARM + CS_MODE_LITTLE_ENDIAN, &handle);",
          "203:  }",
          "205:  if (!strcmp(mode, \"arm64\")) {",
          "207:   err = cs_open(CS_ARCH_ARM64, CS_MODE_LITTLE_ENDIAN, &handle);",
          "208:  }",
          "210:  if (!strcmp(mode, \"mips\")) {",
          "212:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS32 + CS_MODE_LITTLE_ENDIAN, &handle);",
          "213:  }",
          "215:  if (!strcmp(mode, \"mipsbe\")) {",
          "217:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS32 + CS_MODE_BIG_ENDIAN, &handle);",
          "218:  }",
          "220:  if (!strcmp(mode, \"mips64\")) {",
          "222:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS64 + CS_MODE_BIG_ENDIAN, &handle);",
          "223:  }",
          "225:  if (!strcmp(mode, \"mips64be\")) {",
          "227:   err = cs_open(CS_ARCH_MIPS, CS_MODE_MIPS64 + CS_MODE_BIG_ENDIAN, &handle);",
          "228:  }",
          "230:  if (!strcmp(mode, \"x16\")) {",
          "231:   md = CS_MODE_16;",
          "233:   err = cs_open(CS_ARCH_X86, CS_MODE_16, &handle);",
          "234:  }",
          "236:  if (!strcmp(mode, \"x32\")) {",
          "237:   md = CS_MODE_32;",
          "239:   err = cs_open(CS_ARCH_X86, CS_MODE_32, &handle);",
          "240:  }",
          "242:  if (!strcmp(mode, \"x64\")) {",
          "243:   md = CS_MODE_64;",
          "245:   err = cs_open(CS_ARCH_X86, CS_MODE_64, &handle);",
          "246:  }",
          "248:  if (!strcmp(mode, \"x16att\")) {",
          "249:   md = CS_MODE_16;",
          "251:   err = cs_open(CS_ARCH_X86, CS_MODE_16, &handle);",
          "252:   if (!err) {",
          "253:    cs_option(handle, CS_OPT_SYNTAX, CS_OPT_SYNTAX_ATT);",
          "",
          "[Removed Lines]",
          "176:   arch = \"arm\";",
          "181:   arch = \"arm\";",
          "186:   arch = \"arm\";",
          "191:   arch = \"arm\";",
          "196:   arch = \"arm\";",
          "201:   arch = \"arm\";",
          "206:   arch = \"arm64\";",
          "211:   arch = \"mips\";",
          "216:   arch = \"mips\";",
          "221:   arch = \"mips\";",
          "226:   arch = \"mips\";",
          "232:   arch = \"x86\";",
          "238:   arch = \"x86\";",
          "244:   arch = \"x86\";",
          "250:   arch = \"x86\";",
          "",
          "[Added Lines]",
          "188:   arch = CS_ARCH_ARM;",
          "193:   arch = CS_ARCH_ARM;",
          "198:   arch = CS_ARCH_ARM;",
          "203:   arch = CS_ARCH_ARM;",
          "208:   arch = CS_ARCH_ARM;",
          "213:   arch = CS_ARCH_ARM;",
          "218:   arch = CS_ARCH_ARM64;",
          "223:   arch = CS_ARCH_MIPS;",
          "228:   arch = CS_ARCH_MIPS;",
          "233:   arch = CS_ARCH_MIPS;",
          "238:   arch = CS_ARCH_MIPS;",
          "244:   arch = CS_ARCH_X86;",
          "250:   arch = CS_ARCH_X86;",
          "256:   arch = CS_ARCH_X86;",
          "262:   arch = CS_ARCH_X86;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "257:  if (!strcmp(mode,\"x32att\")) {",
          "258:   md = CS_MODE_32;",
          "260:   err = cs_open(CS_ARCH_X86, CS_MODE_32, &handle);",
          "261:   if (!err) {",
          "262:    cs_option(handle, CS_OPT_SYNTAX, CS_OPT_SYNTAX_ATT);",
          "",
          "[Removed Lines]",
          "259:   arch = \"x86\";",
          "",
          "[Added Lines]",
          "271:   arch = CS_ARCH_X86;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "266:  if (!strcmp(mode,\"x64att\")) {",
          "267:   md = CS_MODE_64;",
          "269:   err = cs_open(CS_ARCH_X86, CS_MODE_64, &handle);",
          "270:   if (!err) {",
          "271:    cs_option(handle, CS_OPT_SYNTAX, CS_OPT_SYNTAX_ATT);",
          "",
          "[Removed Lines]",
          "268:   arch = \"x86\";",
          "",
          "[Added Lines]",
          "280:   arch = CS_ARCH_X86;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "273:  }",
          "275:  if (!strcmp(mode,\"ppc64\")) {",
          "277:   err = cs_open(CS_ARCH_PPC, CS_MODE_64+CS_MODE_LITTLE_ENDIAN, &handle);",
          "278:  }",
          "280:  if (!strcmp(mode,\"ppc64be\")) {",
          "282:   err = cs_open(CS_ARCH_PPC,CS_MODE_64+CS_MODE_BIG_ENDIAN, &handle);",
          "283:  }",
          "285:  if (!strcmp(mode,\"sparc\")) {",
          "287:   err = cs_open(CS_ARCH_SPARC, CS_MODE_BIG_ENDIAN, &handle);",
          "288:  }",
          "290:  if (!strcmp(mode, \"systemz\") || !strcmp(mode, \"sysz\") || !strcmp(mode, \"s390x\")) {",
          "292:   err = cs_open(CS_ARCH_SYSZ, CS_MODE_BIG_ENDIAN, &handle);",
          "293:  }",
          "295:  if (!strcmp(mode,\"xcore\")) {",
          "297:   err = cs_open(CS_ARCH_XCORE, CS_MODE_BIG_ENDIAN, &handle);",
          "298:  }",
          "",
          "[Removed Lines]",
          "276:   arch = \"ppc\";",
          "281:   arch = \"ppc\";",
          "286:   arch = \"sparc\";",
          "291:   arch = \"sysz\";",
          "296:   arch = \"xcore\";",
          "",
          "[Added Lines]",
          "288:   arch = CS_ARCH_PPC;",
          "293:   arch = CS_ARCH_PPC;",
          "298:   arch = CS_ARCH_SPARC;",
          "303:   arch = CS_ARCH_SYSZ;",
          "308:   arch = CS_ARCH_XCORE;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "303:   return -1;",
          "304:  }",
          "307:   cs_option(handle, CS_OPT_DETAIL, CS_OPT_ON);",
          "308:  }",
          "",
          "[Removed Lines]",
          "306:  if (debug_flag) {",
          "",
          "[Added Lines]",
          "318:  if (detail_flag) {",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "319:    }",
          "323:     for (; j < 16; j++) {",
          "324:      printf(\"  \");",
          "325:     }",
          "326:    }",
          "327:    printf(\"  %s\\t%s\\n\", insn[i].mnemonic, insn[i].op_str);",
          "330:      print_insn_detail_x86(handle, md, &insn[i]);",
          "331:     }",
          "334:      print_insn_detail_arm(handle, &insn[i]);",
          "335:     }",
          "338:      print_insn_detail_arm64(handle,&insn[i]);",
          "339:     }",
          "342:      print_insn_detail_mips(handle, &insn[i]);",
          "343:     }",
          "346:      print_insn_detail_ppc(handle, &insn[i]);",
          "347:     }",
          "350:      print_insn_detail_sparc(handle, &insn[i]);",
          "351:     }",
          "354:      print_insn_detail_sysz(handle, &insn[i]);",
          "355:     }",
          "358:      print_insn_detail_xcore(handle, &insn[i]);",
          "359:     }",
          "360:    }",
          "",
          "[Removed Lines]",
          "322:    if (!strcmp(arch, \"x86\")) {",
          "328:    if (debug_flag) {",
          "329:     if (!strcmp(arch, \"x86\")) {",
          "333:     if (!strcmp(arch, \"arm\")) {",
          "337:     if (!strcmp(arch,\"arm64\")) {",
          "341:     if (!strcmp(arch, \"mips\")) {",
          "345:     if (!strcmp(arch, \"ppc\")) {",
          "349:     if (!strcmp(arch, \"sparc\")) {",
          "353:     if (!strcmp(arch, \"sysz\")) {",
          "357:     if (!strcmp(arch, \"xcore\")) {",
          "",
          "[Added Lines]",
          "334:    if (arch == CS_ARCH_X86) {",
          "343:    if (detail_flag) {",
          "344:     if (arch == CS_ARCH_X86) {",
          "348:     if (arch == CS_ARCH_ARM) {",
          "352:     if (arch == CS_ARCH_ARM64) {",
          "356:     if (arch == CS_ARCH_MIPS) {",
          "360:     if (arch == CS_ARCH_PPC) {",
          "364:     if (arch == CS_ARCH_SPARC) {",
          "368:     if (arch == CS_ARCH_SYSZ) {",
          "372:     if (arch == CS_ARCH_XCORE) {",
          "",
          "---------------"
        ],
        "cstool/cstool_arm.c||cstool/cstool_arm.c": [
          "File: cstool/cstool_arm.c -> cstool/cstool_arm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: #include <capstone.h>",
          "18: void print_insn_detail_arm(csh handle, cs_insn *ins)",
          "19: {",
          "44: #if defined(_KERNEL_MODE)",
          "47: #else",
          "49: #endif",
          "125: }",
          "",
          "[Removed Lines]",
          "6: static void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "7: {",
          "8:     unsigned char *c;",
          "10:     printf(\"%s\", comment);",
          "11:     for (c = str; c < str + len; c++) {",
          "12:         printf(\"0x%02x \", *c & 0xff);",
          "13:     }",
          "15:     printf(\"\\n\");",
          "16: }",
          "20:     cs_arm *arm;",
          "21:     int i;",
          "24:     if (ins->detail == NULL)",
          "25:         return;",
          "27:     arm = &(ins->detail->arm);",
          "29:     if (arm->op_count)",
          "30:         printf(\"\\top_count: %u\\n\", arm->op_count);",
          "32:     for (i = 0; i < arm->op_count; i++) {",
          "33:         cs_arm_op *op = &(arm->operands[i]);",
          "34:         switch((int)op->type) {",
          "35:             default:",
          "36:                 break;",
          "37:             case ARM_OP_REG:",
          "38:                 printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "39:                 break;",
          "40:             case ARM_OP_IMM:",
          "41:                 printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, op->imm);",
          "42:                 break;",
          "43:             case ARM_OP_FP:",
          "46:                 printf(\"\\t\\toperands[%u].type: FP = <float_point_unsupported>\\n\", i);",
          "48:                 printf(\"\\t\\toperands[%u].type: FP = %f\\n\", i, op->fp);",
          "50:                 break;",
          "51:             case ARM_OP_MEM:",
          "52:                 printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "53:                 if (op->mem.base != X86_REG_INVALID)",
          "54:                     printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "55:                            i, cs_reg_name(handle, op->mem.base));",
          "56:                 if (op->mem.index != X86_REG_INVALID)",
          "57:                     printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "58:                            i, cs_reg_name(handle, op->mem.index));",
          "59:                 if (op->mem.scale != 1)",
          "60:                     printf(\"\\t\\t\\toperands[%u].mem.scale: %u\\n\", i, op->mem.scale);",
          "61:                 if (op->mem.disp != 0)",
          "62:                     printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "64:                 break;",
          "65:             case ARM_OP_PIMM:",
          "66:                 printf(\"\\t\\toperands[%u].type: P-IMM = %u\\n\", i, op->imm);",
          "67:                 break;",
          "68:             case ARM_OP_CIMM:",
          "69:                 printf(\"\\t\\toperands[%u].type: C-IMM = %u\\n\", i, op->imm);",
          "70:                 break;",
          "71:             case ARM_OP_SETEND:",
          "72:                 printf(\"\\t\\toperands[%u].type: SETEND = %s\\n\", i, op->setend == ARM_SETEND_BE? \"be\" : \"le\");",
          "73:                 break;",
          "74:             case ARM_OP_SYSREG:",
          "75:                 printf(\"\\t\\toperands[%u].type: SYSREG = %u\\n\", i, op->reg);",
          "76:                 break;",
          "77:         }",
          "79:         if (op->shift.type != ARM_SFT_INVALID && op->shift.value) {",
          "80:             if (op->shift.type < ARM_SFT_ASR_REG)",
          "82:                 printf(\"\\t\\t\\tShift: %u = %u\\n\", op->shift.type, op->shift.value);",
          "83:             else",
          "85:                 printf(\"\\t\\t\\tShift: %u = %s\\n\", op->shift.type,",
          "86:                        cs_reg_name(handle, op->shift.value));",
          "87:         }",
          "89:         if (op->vector_index != -1) {",
          "90:             printf(\"\\t\\toperands[%u].vector_index = %u\\n\", i, op->vector_index);",
          "91:         }",
          "93:         if (op->subtracted)",
          "94:             printf(\"\\t\\tSubtracted: True\\n\");",
          "95:     }",
          "97:     if (arm->cc != ARM_CC_AL && arm->cc != ARM_CC_INVALID)",
          "98:         printf(\"\\tCode condition: %u\\n\", arm->cc);",
          "100:     if (arm->update_flags)",
          "101:         printf(\"\\tUpdate-flags: True\\n\");",
          "103:     if (arm->writeback)",
          "104:         printf(\"\\tWrite-back: True\\n\");",
          "106:     if (arm->cps_mode)",
          "107:         printf(\"\\tCPSI-mode: %u\\n\", arm->cps_mode);",
          "109:     if (arm->cps_flag)",
          "110:         printf(\"\\tCPSI-flag: %u\\n\", arm->cps_flag);",
          "112:     if (arm->vector_data)",
          "113:         printf(\"\\tVector-data: %u\\n\", arm->vector_data);",
          "115:     if (arm->vector_size)",
          "116:         printf(\"\\tVector-size: %u\\n\", arm->vector_size);",
          "118:     if (arm->usermode)",
          "119:         printf(\"\\tUser-mode: True\\n\");",
          "121:     if (arm->mem_barrier)",
          "122:         printf(\"\\tMemory-barrier: %u\\n\", arm->mem_barrier);",
          "124:     printf(\"\\n\");",
          "",
          "[Added Lines]",
          "6: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "10:  cs_arm *arm;",
          "11:  int i;",
          "14:  if (ins->detail == NULL)",
          "15:   return;",
          "17:  arm = &(ins->detail->arm);",
          "19:  if (arm->op_count)",
          "20:   printf(\"\\top_count: %u\\n\", arm->op_count);",
          "22:  for (i = 0; i < arm->op_count; i++) {",
          "23:   cs_arm_op *op = &(arm->operands[i]);",
          "24:   switch((int)op->type) {",
          "25:    default:",
          "26:     break;",
          "27:    case ARM_OP_REG:",
          "28:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "29:     break;",
          "30:    case ARM_OP_IMM:",
          "31:     printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, op->imm);",
          "32:     break;",
          "33:    case ARM_OP_FP:",
          "36:     printf(\"\\t\\toperands[%u].type: FP = <float_point_unsupported>\\n\", i);",
          "38:     printf(\"\\t\\toperands[%u].type: FP = %f\\n\", i, op->fp);",
          "40:     break;",
          "41:    case ARM_OP_MEM:",
          "42:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "43:     if (op->mem.base != X86_REG_INVALID)",
          "44:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "45:        i, cs_reg_name(handle, op->mem.base));",
          "46:     if (op->mem.index != X86_REG_INVALID)",
          "47:      printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "48:        i, cs_reg_name(handle, op->mem.index));",
          "49:     if (op->mem.scale != 1)",
          "50:      printf(\"\\t\\t\\toperands[%u].mem.scale: %u\\n\", i, op->mem.scale);",
          "51:     if (op->mem.disp != 0)",
          "52:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "54:     break;",
          "55:    case ARM_OP_PIMM:",
          "56:     printf(\"\\t\\toperands[%u].type: P-IMM = %u\\n\", i, op->imm);",
          "57:     break;",
          "58:    case ARM_OP_CIMM:",
          "59:     printf(\"\\t\\toperands[%u].type: C-IMM = %u\\n\", i, op->imm);",
          "60:     break;",
          "61:    case ARM_OP_SETEND:",
          "62:     printf(\"\\t\\toperands[%u].type: SETEND = %s\\n\", i, op->setend == ARM_SETEND_BE? \"be\" : \"le\");",
          "63:     break;",
          "64:    case ARM_OP_SYSREG:",
          "65:     printf(\"\\t\\toperands[%u].type: SYSREG = %u\\n\", i, op->reg);",
          "66:     break;",
          "67:   }",
          "69:   if (op->shift.type != ARM_SFT_INVALID && op->shift.value) {",
          "70:    if (op->shift.type < ARM_SFT_ASR_REG)",
          "72:     printf(\"\\t\\t\\tShift: %u = %u\\n\", op->shift.type, op->shift.value);",
          "73:    else",
          "75:     printf(\"\\t\\t\\tShift: %u = %s\\n\", op->shift.type,",
          "76:       cs_reg_name(handle, op->shift.value));",
          "77:   }",
          "79:   if (op->vector_index != -1) {",
          "80:    printf(\"\\t\\toperands[%u].vector_index = %u\\n\", i, op->vector_index);",
          "81:   }",
          "83:   if (op->subtracted)",
          "84:    printf(\"\\t\\tSubtracted: True\\n\");",
          "85:  }",
          "87:  if (arm->cc != ARM_CC_AL && arm->cc != ARM_CC_INVALID)",
          "88:   printf(\"\\tCode condition: %u\\n\", arm->cc);",
          "90:  if (arm->update_flags)",
          "91:   printf(\"\\tUpdate-flags: True\\n\");",
          "93:  if (arm->writeback)",
          "94:   printf(\"\\tWrite-back: True\\n\");",
          "96:  if (arm->cps_mode)",
          "97:   printf(\"\\tCPSI-mode: %u\\n\", arm->cps_mode);",
          "99:  if (arm->cps_flag)",
          "100:   printf(\"\\tCPSI-flag: %u\\n\", arm->cps_flag);",
          "102:  if (arm->vector_data)",
          "103:   printf(\"\\tVector-data: %u\\n\", arm->vector_data);",
          "105:  if (arm->vector_size)",
          "106:   printf(\"\\tVector-size: %u\\n\", arm->vector_size);",
          "108:  if (arm->usermode)",
          "109:   printf(\"\\tUser-mode: True\\n\");",
          "111:  if (arm->mem_barrier)",
          "112:   printf(\"\\tMemory-barrier: %u\\n\", arm->mem_barrier);",
          "114:  printf(\"\\n\");",
          "",
          "---------------"
        ],
        "cstool/cstool_arm64.c||cstool/cstool_arm64.c": [
          "File: cstool/cstool_arm64.c -> cstool/cstool_arm64.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: #include <capstone.h>",
          "21: void print_insn_detail_arm64(csh handle, cs_insn *ins)",
          "22: {",
          "46: #if defined(_KERNEL_MODE)",
          "49: #else",
          "51: #endif",
          "114: }",
          "",
          "[Removed Lines]",
          "9: static void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "10: {",
          "11:     unsigned char *c;",
          "13:     printf(\"%s\", comment);",
          "14:     for (c = str; c < str + len; c++) {",
          "15:         printf(\"0x%02x \", *c & 0xff);",
          "16:     }",
          "18:     printf(\"\\n\");",
          "19: }",
          "23:     cs_arm64 *arm64;",
          "24:     int i;",
          "27:     if (ins->detail == NULL)",
          "28:         return;",
          "30:     arm64 = &(ins->detail->arm64);",
          "31:     if (arm64->op_count)",
          "32:         printf(\"\\top_count: %u\\n\", arm64->op_count);",
          "34:     for (i = 0; i < arm64->op_count; i++) {",
          "35:         cs_arm64_op *op = &(arm64->operands[i]);",
          "36:         switch(op->type) {",
          "37:             default:",
          "38:                 break;",
          "39:             case ARM64_OP_REG:",
          "40:                 printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "41:                 break;",
          "42:             case ARM64_OP_IMM:",
          "43:                 printf(\"\\t\\toperands[%u].type: IMM = 0x%\" PRIx64 \"\\n\", i, op->imm);",
          "44:                 break;",
          "45:             case ARM64_OP_FP:",
          "48:                 printf(\"\\t\\toperands[%u].type: FP = <float_point_unsupported>\\n\", i);",
          "50:                 printf(\"\\t\\toperands[%u].type: FP = %f\\n\", i, op->fp);",
          "52:                 break;",
          "53:             case ARM64_OP_MEM:",
          "54:                 printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "55:                 if (op->mem.base != ARM64_REG_INVALID)",
          "56:                     printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\", i, cs_reg_name(handle, op->mem.base));",
          "57:                 if (op->mem.index != ARM64_REG_INVALID)",
          "58:                     printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\", i, cs_reg_name(handle, op->mem.index));",
          "59:                 if (op->mem.disp != 0)",
          "60:                     printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "62:                 break;",
          "63:             case ARM64_OP_CIMM:",
          "64:                 printf(\"\\t\\toperands[%u].type: C-IMM = %u\\n\", i, (int)op->imm);",
          "65:                 break;",
          "66:             case ARM64_OP_REG_MRS:",
          "67:                 printf(\"\\t\\toperands[%u].type: REG_MRS = 0x%x\\n\", i, op->reg);",
          "68:                 break;",
          "69:             case ARM64_OP_REG_MSR:",
          "70:                 printf(\"\\t\\toperands[%u].type: REG_MSR = 0x%x\\n\", i, op->reg);",
          "71:                 break;",
          "72:             case ARM64_OP_PSTATE:",
          "73:                 printf(\"\\t\\toperands[%u].type: PSTATE = 0x%x\\n\", i, op->pstate);",
          "74:                 break;",
          "75:             case ARM64_OP_SYS:",
          "76:                 printf(\"\\t\\toperands[%u].type: SYS = 0x%x\\n\", i, op->sys);",
          "77:                 break;",
          "78:             case ARM64_OP_PREFETCH:",
          "79:                 printf(\"\\t\\toperands[%u].type: PREFETCH = 0x%x\\n\", i, op->prefetch);",
          "80:                 break;",
          "81:             case ARM64_OP_BARRIER:",
          "82:                 printf(\"\\t\\toperands[%u].type: BARRIER = 0x%x\\n\", i, op->barrier);",
          "83:                 break;",
          "84:         }",
          "86:         if (op->shift.type != ARM64_SFT_INVALID &&",
          "87:             op->shift.value)",
          "88:             printf(\"\\t\\t\\tShift: type = %u, value = %u\\n\",",
          "89:                    op->shift.type, op->shift.value);",
          "91:         if (op->ext != ARM64_EXT_INVALID)",
          "92:             printf(\"\\t\\t\\tExt: %u\\n\", op->ext);",
          "94:         if (op->vas != ARM64_VAS_INVALID)",
          "95:             printf(\"\\t\\t\\tVector Arrangement Specifier: 0x%x\\n\", op->vas);",
          "97:         if (op->vess != ARM64_VESS_INVALID)",
          "98:             printf(\"\\t\\t\\tVector Element Size Specifier: %u\\n\", op->vess);",
          "100:         if (op->vector_index != -1)",
          "101:             printf(\"\\t\\t\\tVector Index: %u\\n\", op->vector_index);",
          "102:     }",
          "104:     if (arm64->update_flags)",
          "105:         printf(\"\\tUpdate-flags: True\\n\");",
          "107:     if (arm64->writeback)",
          "108:         printf(\"\\tWrite-back: True\\n\");",
          "110:     if (arm64->cc)",
          "111:         printf(\"\\tCode-condition: %u\\n\", arm64->cc);",
          "113:     printf(\"\\n\");",
          "",
          "[Added Lines]",
          "9: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "13:  cs_arm64 *arm64;",
          "14:  int i;",
          "17:  if (ins->detail == NULL)",
          "18:   return;",
          "20:  arm64 = &(ins->detail->arm64);",
          "21:  if (arm64->op_count)",
          "22:   printf(\"\\top_count: %u\\n\", arm64->op_count);",
          "24:  for (i = 0; i < arm64->op_count; i++) {",
          "25:   cs_arm64_op *op = &(arm64->operands[i]);",
          "26:   switch(op->type) {",
          "27:    default:",
          "28:     break;",
          "29:    case ARM64_OP_REG:",
          "30:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "31:     break;",
          "32:    case ARM64_OP_IMM:",
          "33:     printf(\"\\t\\toperands[%u].type: IMM = 0x%\" PRIx64 \"\\n\", i, op->imm);",
          "34:     break;",
          "35:    case ARM64_OP_FP:",
          "38:     printf(\"\\t\\toperands[%u].type: FP = <float_point_unsupported>\\n\", i);",
          "40:     printf(\"\\t\\toperands[%u].type: FP = %f\\n\", i, op->fp);",
          "42:     break;",
          "43:    case ARM64_OP_MEM:",
          "44:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "45:     if (op->mem.base != ARM64_REG_INVALID)",
          "46:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\", i, cs_reg_name(handle, op->mem.base));",
          "47:     if (op->mem.index != ARM64_REG_INVALID)",
          "48:      printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\", i, cs_reg_name(handle, op->mem.index));",
          "49:     if (op->mem.disp != 0)",
          "50:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "52:     break;",
          "53:    case ARM64_OP_CIMM:",
          "54:     printf(\"\\t\\toperands[%u].type: C-IMM = %u\\n\", i, (int)op->imm);",
          "55:     break;",
          "56:    case ARM64_OP_REG_MRS:",
          "57:     printf(\"\\t\\toperands[%u].type: REG_MRS = 0x%x\\n\", i, op->reg);",
          "58:     break;",
          "59:    case ARM64_OP_REG_MSR:",
          "60:     printf(\"\\t\\toperands[%u].type: REG_MSR = 0x%x\\n\", i, op->reg);",
          "61:     break;",
          "62:    case ARM64_OP_PSTATE:",
          "63:     printf(\"\\t\\toperands[%u].type: PSTATE = 0x%x\\n\", i, op->pstate);",
          "64:     break;",
          "65:    case ARM64_OP_SYS:",
          "66:     printf(\"\\t\\toperands[%u].type: SYS = 0x%x\\n\", i, op->sys);",
          "67:     break;",
          "68:    case ARM64_OP_PREFETCH:",
          "69:     printf(\"\\t\\toperands[%u].type: PREFETCH = 0x%x\\n\", i, op->prefetch);",
          "70:     break;",
          "71:    case ARM64_OP_BARRIER:",
          "72:     printf(\"\\t\\toperands[%u].type: BARRIER = 0x%x\\n\", i, op->barrier);",
          "73:     break;",
          "74:   }",
          "76:   if (op->shift.type != ARM64_SFT_INVALID &&",
          "77:     op->shift.value)",
          "78:    printf(\"\\t\\t\\tShift: type = %u, value = %u\\n\",",
          "79:      op->shift.type, op->shift.value);",
          "81:   if (op->ext != ARM64_EXT_INVALID)",
          "82:    printf(\"\\t\\t\\tExt: %u\\n\", op->ext);",
          "84:   if (op->vas != ARM64_VAS_INVALID)",
          "85:    printf(\"\\t\\t\\tVector Arrangement Specifier: 0x%x\\n\", op->vas);",
          "87:   if (op->vess != ARM64_VESS_INVALID)",
          "88:    printf(\"\\t\\t\\tVector Element Size Specifier: %u\\n\", op->vess);",
          "90:   if (op->vector_index != -1)",
          "91:    printf(\"\\t\\t\\tVector Index: %u\\n\", op->vector_index);",
          "92:  }",
          "94:  if (arm64->update_flags)",
          "95:   printf(\"\\tUpdate-flags: True\\n\");",
          "97:  if (arm64->writeback)",
          "98:   printf(\"\\tWrite-back: True\\n\");",
          "100:  if (arm64->cc)",
          "101:   printf(\"\\tCode-condition: %u\\n\", arm64->cc);",
          "103:  printf(\"\\n\");",
          "",
          "---------------"
        ],
        "cstool/cstool_mips.c||cstool/cstool_mips.c": [
          "File: cstool/cstool_mips.c -> cstool/cstool_mips.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: #include <capstone.h>",
          "21: void print_insn_detail_mips(csh handle, cs_insn *ins)",
          "22: {",
          "59: }",
          "",
          "[Removed Lines]",
          "9: static void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "10: {",
          "11:     unsigned char *c;",
          "13:     printf(\"%s\", comment);",
          "14:     for (c = str; c < str + len; c++) {",
          "15:         printf(\"0x%02x \", *c & 0xff);",
          "16:     }",
          "18:     printf(\"\\n\");",
          "19: }",
          "23:     int i;",
          "24:     cs_mips *mips;",
          "27:     if (ins->detail == NULL)",
          "28:         return;",
          "30:     mips = &(ins->detail->mips);",
          "31:     if (mips->op_count)",
          "32:         printf(\"\\top_count: %u\\n\", mips->op_count);",
          "34:     for (i = 0; i < mips->op_count; i++) {",
          "35:         cs_mips_op *op = &(mips->operands[i]);",
          "36:         switch((int)op->type) {",
          "37:             default:",
          "38:                 break;",
          "39:             case MIPS_OP_REG:",
          "40:                 printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "41:                 break;",
          "42:             case MIPS_OP_IMM:",
          "43:                 printf(\"\\t\\toperands[%u].type: IMM = 0x%\" PRIx64 \"\\n\", i, op->imm);",
          "44:                 break;",
          "45:             case MIPS_OP_MEM:",
          "46:                 printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "47:                 if (op->mem.base != X86_REG_INVALID)",
          "48:                     printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "49:                            i, cs_reg_name(handle, op->mem.base));",
          "50:                 if (op->mem.disp != 0)",
          "51:                     printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%\" PRIx64 \"\\n\", i, op->mem.disp);",
          "53:                 break;",
          "54:         }",
          "56:     }",
          "58:     printf(\"\\n\");",
          "",
          "[Added Lines]",
          "9: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "13:  int i;",
          "14:  cs_mips *mips;",
          "17:  if (ins->detail == NULL)",
          "18:   return;",
          "20:  mips = &(ins->detail->mips);",
          "21:  if (mips->op_count)",
          "22:   printf(\"\\top_count: %u\\n\", mips->op_count);",
          "24:  for (i = 0; i < mips->op_count; i++) {",
          "25:   cs_mips_op *op = &(mips->operands[i]);",
          "26:   switch((int)op->type) {",
          "27:    default:",
          "28:     break;",
          "29:    case MIPS_OP_REG:",
          "30:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "31:     break;",
          "32:    case MIPS_OP_IMM:",
          "33:     printf(\"\\t\\toperands[%u].type: IMM = 0x%\" PRIx64 \"\\n\", i, op->imm);",
          "34:     break;",
          "35:    case MIPS_OP_MEM:",
          "36:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "37:     if (op->mem.base != X86_REG_INVALID)",
          "38:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "39:        i, cs_reg_name(handle, op->mem.base));",
          "40:     if (op->mem.disp != 0)",
          "41:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%\" PRIx64 \"\\n\", i, op->mem.disp);",
          "43:     break;",
          "44:   }",
          "46:  }",
          "48:  printf(\"\\n\");",
          "",
          "---------------"
        ],
        "cstool/cstool_ppc.c||cstool/cstool_ppc.c": [
          "File: cstool/cstool_ppc.c -> cstool/cstool_ppc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: #include <capstone.h>",
          "22: static const char* get_bc_name(int bc)",
          "23: {",
          "49: }",
          "51: void print_insn_detail_ppc(csh handle, cs_insn *ins)",
          "52: {",
          "103: }",
          "",
          "[Removed Lines]",
          "8: static csh handle;",
          "10: static void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "11: {",
          "12:     unsigned char *c;",
          "14:     printf(\"%s\", comment);",
          "15:     for (c = str; c < str + len; c++) {",
          "16:         printf(\"0x%02x \", *c & 0xff);",
          "17:     }",
          "19:     printf(\"\\n\");",
          "20: }",
          "24:     switch(bc) {",
          "25:         default:",
          "26:         case PPC_BC_INVALID:",
          "27:             return (\"invalid\");",
          "28:         case PPC_BC_LT:",
          "29:             return (\"lt\");",
          "30:         case PPC_BC_LE:",
          "31:             return (\"le\");",
          "32:         case PPC_BC_EQ:",
          "33:             return (\"eq\");",
          "34:         case PPC_BC_GE:",
          "35:             return (\"ge\");",
          "36:         case PPC_BC_GT:",
          "37:             return (\"gt\");",
          "38:         case PPC_BC_NE:",
          "39:             return (\"ne\");",
          "40:         case PPC_BC_UN:",
          "41:             return (\"un\");",
          "42:         case PPC_BC_NU:",
          "43:             return (\"nu\");",
          "44:         case PPC_BC_SO:",
          "45:             return (\"so\");",
          "46:         case PPC_BC_NS:",
          "47:             return (\"ns\");",
          "48:     }",
          "53:     cs_ppc *ppc;",
          "54:     int i;",
          "57:     if (ins->detail == NULL)",
          "58:         return;",
          "60:     ppc = &(ins->detail->ppc);",
          "61:     if (ppc->op_count)",
          "62:         printf(\"\\top_count: %u\\n\", ppc->op_count);",
          "64:     for (i = 0; i < ppc->op_count; i++) {",
          "65:         cs_ppc_op *op = &(ppc->operands[i]);",
          "66:         switch((int)op->type) {",
          "67:             default:",
          "68:                 break;",
          "69:             case PPC_OP_REG:",
          "70:                 printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "71:                 break;",
          "72:             case PPC_OP_IMM:",
          "73:                 printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, op->imm);",
          "74:                 break;",
          "75:             case PPC_OP_MEM:",
          "76:                 printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "77:                 if (op->mem.base != PPC_REG_INVALID)",
          "78:                     printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "79:                            i, cs_reg_name(handle, op->mem.base));",
          "80:                 if (op->mem.disp != 0)",
          "81:                     printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "83:                 break;",
          "84:             case PPC_OP_CRX:",
          "85:                 printf(\"\\t\\toperands[%u].type: CRX\\n\", i);",
          "86:                 printf(\"\\t\\t\\toperands[%u].crx.scale: %d\\n\", i, op->crx.scale);",
          "87:                 printf(\"\\t\\t\\toperands[%u].crx.reg: %s\\n\", i, cs_reg_name(handle, op->crx.reg));",
          "88:                 printf(\"\\t\\t\\toperands[%u].crx.cond: %s\\n\", i, get_bc_name(op->crx.cond));",
          "89:                 break;",
          "90:         }",
          "91:     }",
          "93:     if (ppc->bc != 0)",
          "94:         printf(\"\\tBranch code: %u\\n\", ppc->bc);",
          "96:     if (ppc->bh != 0)",
          "97:         printf(\"\\tBranch hint: %u\\n\", ppc->bh);",
          "99:     if (ppc->update_cr0)",
          "100:         printf(\"\\tUpdate-CR0: True\\n\");",
          "102:     printf(\"\\n\");",
          "",
          "[Added Lines]",
          "8: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "12:  switch(bc) {",
          "13:   default:",
          "14:   case PPC_BC_INVALID:",
          "15:    return (\"invalid\");",
          "16:   case PPC_BC_LT:",
          "17:    return (\"lt\");",
          "18:   case PPC_BC_LE:",
          "19:    return (\"le\");",
          "20:   case PPC_BC_EQ:",
          "21:    return (\"eq\");",
          "22:   case PPC_BC_GE:",
          "23:    return (\"ge\");",
          "24:   case PPC_BC_GT:",
          "25:    return (\"gt\");",
          "26:   case PPC_BC_NE:",
          "27:    return (\"ne\");",
          "28:   case PPC_BC_UN:",
          "29:    return (\"un\");",
          "30:   case PPC_BC_NU:",
          "31:    return (\"nu\");",
          "32:   case PPC_BC_SO:",
          "33:    return (\"so\");",
          "34:   case PPC_BC_NS:",
          "35:    return (\"ns\");",
          "36:  }",
          "41:  cs_ppc *ppc;",
          "42:  int i;",
          "45:  if (ins->detail == NULL)",
          "46:   return;",
          "48:  ppc = &(ins->detail->ppc);",
          "49:  if (ppc->op_count)",
          "50:   printf(\"\\top_count: %u\\n\", ppc->op_count);",
          "52:  for (i = 0; i < ppc->op_count; i++) {",
          "53:   cs_ppc_op *op = &(ppc->operands[i]);",
          "54:   switch((int)op->type) {",
          "55:    default:",
          "56:     break;",
          "57:    case PPC_OP_REG:",
          "58:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "59:     break;",
          "60:    case PPC_OP_IMM:",
          "61:     printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, op->imm);",
          "62:     break;",
          "63:    case PPC_OP_MEM:",
          "64:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "65:     if (op->mem.base != PPC_REG_INVALID)",
          "66:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "67:        i, cs_reg_name(handle, op->mem.base));",
          "68:     if (op->mem.disp != 0)",
          "69:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "71:     break;",
          "72:    case PPC_OP_CRX:",
          "73:     printf(\"\\t\\toperands[%u].type: CRX\\n\", i);",
          "74:     printf(\"\\t\\t\\toperands[%u].crx.scale: %d\\n\", i, op->crx.scale);",
          "75:     printf(\"\\t\\t\\toperands[%u].crx.reg: %s\\n\", i, cs_reg_name(handle, op->crx.reg));",
          "76:     printf(\"\\t\\t\\toperands[%u].crx.cond: %s\\n\", i, get_bc_name(op->crx.cond));",
          "77:     break;",
          "78:   }",
          "79:  }",
          "81:  if (ppc->bc != 0)",
          "82:   printf(\"\\tBranch code: %u\\n\", ppc->bc);",
          "84:  if (ppc->bh != 0)",
          "85:   printf(\"\\tBranch hint: %u\\n\", ppc->bh);",
          "87:  if (ppc->update_cr0)",
          "88:   printf(\"\\tUpdate-CR0: True\\n\");",
          "90:  printf(\"\\n\");",
          "",
          "---------------"
        ],
        "cstool/cstool_sparc.c||cstool/cstool_sparc.c": [
          "File: cstool/cstool_sparc.c -> cstool/cstool_sparc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: #include <capstone.h>",
          "20: void print_insn_detail_sparc(csh handle, cs_insn *ins)",
          "21: {",
          "66: }",
          "",
          "[Removed Lines]",
          "8: static void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "9: {",
          "10:     unsigned char *c;",
          "12:     printf(\"%s\", comment);",
          "13:     for (c = str; c < str + len; c++) {",
          "14:         printf(\"0x%02x \", *c & 0xff);",
          "15:     }",
          "17:     printf(\"\\n\");",
          "18: }",
          "22:     cs_sparc *sparc;",
          "23:     int i;",
          "26:     if (ins->detail == NULL)",
          "27:         return;",
          "29:     sparc = &(ins->detail->sparc);",
          "30:     if (sparc->op_count)",
          "31:         printf(\"\\top_count: %u\\n\", sparc->op_count);",
          "33:     for (i = 0; i < sparc->op_count; i++) {",
          "34:         cs_sparc_op *op = &(sparc->operands[i]);",
          "35:         switch((int)op->type) {",
          "36:             default:",
          "37:                 break;",
          "38:             case SPARC_OP_REG:",
          "39:                 printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "40:                 break;",
          "41:             case SPARC_OP_IMM:",
          "42:                 printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, op->imm);",
          "43:                 break;",
          "44:             case SPARC_OP_MEM:",
          "45:                 printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "46:                 if (op->mem.base != X86_REG_INVALID)",
          "47:                     printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "48:                            i, cs_reg_name(handle, op->mem.base));",
          "49:                 if (op->mem.index != X86_REG_INVALID)",
          "50:                     printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "51:                            i, cs_reg_name(handle, op->mem.index));",
          "52:                 if (op->mem.disp != 0)",
          "53:                     printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "55:                 break;",
          "56:         }",
          "57:     }",
          "59:     if (sparc->cc != 0)",
          "60:         printf(\"\\tCode condition: %u\\n\", sparc->cc);",
          "62:     if (sparc->hint != 0)",
          "63:         printf(\"\\tHint code: %u\\n\", sparc->hint);",
          "65:     printf(\"\\n\");",
          "",
          "[Added Lines]",
          "8: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "12:  cs_sparc *sparc;",
          "13:  int i;",
          "16:  if (ins->detail == NULL)",
          "17:   return;",
          "19:  sparc = &(ins->detail->sparc);",
          "20:  if (sparc->op_count)",
          "21:   printf(\"\\top_count: %u\\n\", sparc->op_count);",
          "23:  for (i = 0; i < sparc->op_count; i++) {",
          "24:   cs_sparc_op *op = &(sparc->operands[i]);",
          "25:   switch((int)op->type) {",
          "26:    default:",
          "27:     break;",
          "28:    case SPARC_OP_REG:",
          "29:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "30:     break;",
          "31:    case SPARC_OP_IMM:",
          "32:     printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, op->imm);",
          "33:     break;",
          "34:    case SPARC_OP_MEM:",
          "35:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "36:     if (op->mem.base != X86_REG_INVALID)",
          "37:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "38:        i, cs_reg_name(handle, op->mem.base));",
          "39:     if (op->mem.index != X86_REG_INVALID)",
          "40:      printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "41:        i, cs_reg_name(handle, op->mem.index));",
          "42:     if (op->mem.disp != 0)",
          "43:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "45:     break;",
          "46:   }",
          "47:  }",
          "49:  if (sparc->cc != 0)",
          "50:   printf(\"\\tCode condition: %u\\n\", sparc->cc);",
          "52:  if (sparc->hint != 0)",
          "53:   printf(\"\\tHint code: %u\\n\", sparc->hint);",
          "55:  printf(\"\\n\");",
          "",
          "---------------"
        ],
        "cstool/cstool_systemz.c||cstool/cstool_systemz.c": [
          "File: cstool/cstool_systemz.c -> cstool/cstool_systemz.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: #include <capstone.h>",
          "20: void print_insn_detail_sysz(csh handle, cs_insn *ins)",
          "21: {",
          "68: }",
          "",
          "[Removed Lines]",
          "8: static void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "9: {",
          "10:     unsigned char *c;",
          "12:     printf(\"%s\", comment);",
          "13:     for (c = str; c < str + len; c++) {",
          "14:         printf(\"0x%02x \", *c & 0xff);",
          "15:     }",
          "17:     printf(\"\\n\");",
          "18: }",
          "22:     cs_sysz *sysz;",
          "23:     int i;",
          "26:     if (ins->detail == NULL)",
          "27:         return;",
          "29:     sysz = &(ins->detail->sysz);",
          "30:     if (sysz->op_count)",
          "31:         printf(\"\\top_count: %u\\n\", sysz->op_count);",
          "33:     for (i = 0; i < sysz->op_count; i++) {",
          "34:         cs_sysz_op *op = &(sysz->operands[i]);",
          "35:         switch((int)op->type) {",
          "36:             default:",
          "37:                 break;",
          "38:             case SYSZ_OP_REG:",
          "39:                 printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "40:                 break;",
          "41:             case SYSZ_OP_ACREG:",
          "42:                 printf(\"\\t\\toperands[%u].type: ACREG = %u\\n\", i, op->reg);",
          "43:                 break;",
          "44:             case SYSZ_OP_IMM:",
          "45:                 printf(\"\\t\\toperands[%u].type: IMM = 0x%\" PRIx64 \"\\n\", i, op->imm);",
          "46:                 break;",
          "47:             case SYSZ_OP_MEM:",
          "48:                 printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "49:                 if (op->mem.base != SYSZ_REG_INVALID)",
          "50:                     printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "51:                            i, cs_reg_name(handle, op->mem.base));",
          "52:                 if (op->mem.index != SYSZ_REG_INVALID)",
          "53:                     printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "54:                            i, cs_reg_name(handle, op->mem.index));",
          "55:                 if (op->mem.length != 0)",
          "56:                     printf(\"\\t\\t\\toperands[%u].mem.length: 0x%\" PRIx64 \"\\n\", i, op->mem.length);",
          "57:                 if (op->mem.disp != 0)",
          "58:                     printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%\" PRIx64 \"\\n\", i, op->mem.disp);",
          "60:                 break;",
          "61:         }",
          "62:     }",
          "64:     if (sysz->cc != 0)",
          "65:         printf(\"\\tCode condition: %u\\n\", sysz->cc);",
          "67:     printf(\"\\n\");",
          "",
          "[Added Lines]",
          "8: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "12:  cs_sysz *sysz;",
          "13:  int i;",
          "16:  if (ins->detail == NULL)",
          "17:   return;",
          "19:  sysz = &(ins->detail->sysz);",
          "20:  if (sysz->op_count)",
          "21:   printf(\"\\top_count: %u\\n\", sysz->op_count);",
          "23:  for (i = 0; i < sysz->op_count; i++) {",
          "24:   cs_sysz_op *op = &(sysz->operands[i]);",
          "25:   switch((int)op->type) {",
          "26:    default:",
          "27:     break;",
          "28:    case SYSZ_OP_REG:",
          "29:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "30:     break;",
          "31:    case SYSZ_OP_ACREG:",
          "32:     printf(\"\\t\\toperands[%u].type: ACREG = %u\\n\", i, op->reg);",
          "33:     break;",
          "34:    case SYSZ_OP_IMM:",
          "35:     printf(\"\\t\\toperands[%u].type: IMM = 0x%\" PRIx64 \"\\n\", i, op->imm);",
          "36:     break;",
          "37:    case SYSZ_OP_MEM:",
          "38:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "39:     if (op->mem.base != SYSZ_REG_INVALID)",
          "40:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "41:        i, cs_reg_name(handle, op->mem.base));",
          "42:     if (op->mem.index != SYSZ_REG_INVALID)",
          "43:      printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "44:        i, cs_reg_name(handle, op->mem.index));",
          "45:     if (op->mem.length != 0)",
          "46:      printf(\"\\t\\t\\toperands[%u].mem.length: 0x%\" PRIx64 \"\\n\", i, op->mem.length);",
          "47:     if (op->mem.disp != 0)",
          "48:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%\" PRIx64 \"\\n\", i, op->mem.disp);",
          "50:     break;",
          "51:   }",
          "52:  }",
          "54:  if (sysz->cc != 0)",
          "55:   printf(\"\\tCode condition: %u\\n\", sysz->cc);",
          "57:  printf(\"\\n\");",
          "",
          "---------------"
        ],
        "cstool/cstool_x86.c||cstool/cstool_x86.c": [
          "File: cstool/cstool_x86.c -> cstool/cstool_x86.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: #include <capstone.h>",
          "21: void print_insn_detail_x86(csh ud, cs_mode mode, cs_insn *ins)",
          "22: {",
          "123: }",
          "",
          "[Removed Lines]",
          "9: static void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "10: {",
          "11:     unsigned char *c;",
          "13:     printf(\"%s\", comment);",
          "14:     for (c = str; c < str + len; c++) {",
          "15:         printf(\"0x%02x \", *c & 0xff);",
          "16:     }",
          "18:     printf(\"\\n\");",
          "19: }",
          "23:     int count, i;",
          "24:     cs_x86 *x86;",
          "27:     if (ins->detail == NULL)",
          "28:         return;",
          "30:     x86 = &(ins->detail->x86);",
          "32:     print_string_hex(\"\\tPrefix:\", x86->prefix, 4);",
          "34:     print_string_hex(\"\\tOpcode:\", x86->opcode, 4);",
          "36:     printf(\"\\trex: 0x%x\\n\", x86->rex);",
          "38:     printf(\"\\taddr_size: %u\\n\", x86->addr_size);",
          "39:     printf(\"\\tmodrm: 0x%x\\n\", x86->modrm);",
          "40:     printf(\"\\tdisp: 0x%x\\n\", x86->disp);",
          "43:     if ((mode & CS_MODE_16) == 0) {",
          "44:         printf(\"\\tsib: 0x%x\\n\", x86->sib);",
          "45:         if (x86->sib_base != X86_REG_INVALID)",
          "46:             printf(\"\\t\\tsib_base: %s\\n\", cs_reg_name(ud, x86->sib_base));",
          "47:         if (x86->sib_index != X86_REG_INVALID)",
          "48:             printf(\"\\t\\tsib_index: %s\\n\", cs_reg_name(ud, x86->sib_index));",
          "49:         if (x86->sib_scale != 0)",
          "50:             printf(\"\\t\\tsib_scale: %d\\n\", x86->sib_scale);",
          "51:     }",
          "54:     if (x86->sse_cc != X86_SSE_CC_INVALID) {",
          "55:         printf(\"\\tsse_cc: %u\\n\", x86->sse_cc);",
          "56:     }",
          "59:     if (x86->avx_cc != X86_AVX_CC_INVALID) {",
          "60:         printf(\"\\tavx_cc: %u\\n\", x86->avx_cc);",
          "61:     }",
          "64:     if (x86->avx_sae) {",
          "65:         printf(\"\\tavx_sae: %u\\n\", x86->avx_sae);",
          "66:     }",
          "69:     if (x86->avx_rm != X86_AVX_RM_INVALID) {",
          "70:         printf(\"\\tavx_rm: %u\\n\", x86->avx_rm);",
          "71:     }",
          "73:     count = cs_op_count(ud, ins, X86_OP_IMM);",
          "74:     if (count) {",
          "75:         printf(\"\\timm_count: %u\\n\", count);",
          "76:         for (i = 1; i < count + 1; i++) {",
          "77:             int index = cs_op_index(ud, ins, X86_OP_IMM, i);",
          "78:             printf(\"\\t\\timms[%u]: 0x%\" PRIx64 \"\\n\", i, x86->operands[index].imm);",
          "79:         }",
          "80:     }",
          "82:     if (x86->op_count)",
          "83:         printf(\"\\top_count: %u\\n\", x86->op_count);",
          "84:     for (i = 0; i < x86->op_count; i++) {",
          "85:         cs_x86_op *op = &(x86->operands[i]);",
          "87:         switch((int)op->type) {",
          "88:             case X86_OP_REG:",
          "89:                 printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(ud, op->reg));",
          "90:                 break;",
          "91:             case X86_OP_IMM:",
          "92:                 printf(\"\\t\\toperands[%u].type: IMM = 0x%\" PRIx64 \"\\n\", i, op->imm);",
          "93:                 break;",
          "94:             case X86_OP_MEM:",
          "95:                 printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "96:                 if (op->mem.segment != X86_REG_INVALID)",
          "97:                     printf(\"\\t\\t\\toperands[%u].mem.segment: REG = %s\\n\", i, cs_reg_name(ud, op->mem.segment));",
          "98:                 if (op->mem.base != X86_REG_INVALID)",
          "99:                     printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\", i, cs_reg_name(ud, op->mem.base));",
          "100:                 if (op->mem.index != X86_REG_INVALID)",
          "101:                     printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\", i, cs_reg_name(ud, op->mem.index));",
          "102:                 if (op->mem.scale != 1)",
          "103:                     printf(\"\\t\\t\\toperands[%u].mem.scale: %u\\n\", i, op->mem.scale);",
          "104:                 if (op->mem.disp != 0)",
          "105:                     printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%\" PRIx64 \"\\n\", i, op->mem.disp);",
          "106:                 break;",
          "107:             default:",
          "108:                 break;",
          "109:         }",
          "112:         if (op->avx_bcast != X86_AVX_BCAST_INVALID)",
          "113:             printf(\"\\t\\toperands[%u].avx_bcast: %u\\n\", i, op->avx_bcast);",
          "116:         if (op->avx_zero_opmask != false)",
          "117:             printf(\"\\t\\toperands[%u].avx_zero_opmask: TRUE\\n\", i);",
          "119:         printf(\"\\t\\toperands[%u].size: %u\\n\", i, op->size);",
          "120:     }",
          "122:     printf(\"\\n\");",
          "",
          "[Added Lines]",
          "9: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "13:  int count, i;",
          "14:  cs_x86 *x86;",
          "17:  if (ins->detail == NULL)",
          "18:   return;",
          "20:  x86 = &(ins->detail->x86);",
          "22:  print_string_hex(\"\\tPrefix:\", x86->prefix, 4);",
          "24:  print_string_hex(\"\\tOpcode:\", x86->opcode, 4);",
          "26:  printf(\"\\trex: 0x%x\\n\", x86->rex);",
          "28:  printf(\"\\taddr_size: %u\\n\", x86->addr_size);",
          "29:  printf(\"\\tmodrm: 0x%x\\n\", x86->modrm);",
          "30:  printf(\"\\tdisp: 0x%x\\n\", x86->disp);",
          "33:  if ((mode & CS_MODE_16) == 0) {",
          "34:   printf(\"\\tsib: 0x%x\\n\", x86->sib);",
          "35:   if (x86->sib_base != X86_REG_INVALID)",
          "36:    printf(\"\\t\\tsib_base: %s\\n\", cs_reg_name(ud, x86->sib_base));",
          "37:   if (x86->sib_index != X86_REG_INVALID)",
          "38:    printf(\"\\t\\tsib_index: %s\\n\", cs_reg_name(ud, x86->sib_index));",
          "39:   if (x86->sib_scale != 0)",
          "40:    printf(\"\\t\\tsib_scale: %d\\n\", x86->sib_scale);",
          "41:  }",
          "44:  if (x86->sse_cc != X86_SSE_CC_INVALID) {",
          "45:   printf(\"\\tsse_cc: %u\\n\", x86->sse_cc);",
          "46:  }",
          "49:  if (x86->avx_cc != X86_AVX_CC_INVALID) {",
          "50:   printf(\"\\tavx_cc: %u\\n\", x86->avx_cc);",
          "51:  }",
          "54:  if (x86->avx_sae) {",
          "55:   printf(\"\\tavx_sae: %u\\n\", x86->avx_sae);",
          "56:  }",
          "59:  if (x86->avx_rm != X86_AVX_RM_INVALID) {",
          "60:   printf(\"\\tavx_rm: %u\\n\", x86->avx_rm);",
          "61:  }",
          "63:  count = cs_op_count(ud, ins, X86_OP_IMM);",
          "64:  if (count) {",
          "65:   printf(\"\\timm_count: %u\\n\", count);",
          "66:   for (i = 1; i < count + 1; i++) {",
          "67:    int index = cs_op_index(ud, ins, X86_OP_IMM, i);",
          "68:    printf(\"\\t\\timms[%u]: 0x%\" PRIx64 \"\\n\", i, x86->operands[index].imm);",
          "69:   }",
          "70:  }",
          "72:  if (x86->op_count)",
          "73:   printf(\"\\top_count: %u\\n\", x86->op_count);",
          "74:  for (i = 0; i < x86->op_count; i++) {",
          "75:   cs_x86_op *op = &(x86->operands[i]);",
          "77:   switch((int)op->type) {",
          "78:    case X86_OP_REG:",
          "79:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(ud, op->reg));",
          "80:     break;",
          "81:    case X86_OP_IMM:",
          "82:     printf(\"\\t\\toperands[%u].type: IMM = 0x%\" PRIx64 \"\\n\", i, op->imm);",
          "83:     break;",
          "84:    case X86_OP_MEM:",
          "85:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "86:     if (op->mem.segment != X86_REG_INVALID)",
          "87:      printf(\"\\t\\t\\toperands[%u].mem.segment: REG = %s\\n\", i, cs_reg_name(ud, op->mem.segment));",
          "88:     if (op->mem.base != X86_REG_INVALID)",
          "89:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\", i, cs_reg_name(ud, op->mem.base));",
          "90:     if (op->mem.index != X86_REG_INVALID)",
          "91:      printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\", i, cs_reg_name(ud, op->mem.index));",
          "92:     if (op->mem.scale != 1)",
          "93:      printf(\"\\t\\t\\toperands[%u].mem.scale: %u\\n\", i, op->mem.scale);",
          "94:     if (op->mem.disp != 0)",
          "95:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%\" PRIx64 \"\\n\", i, op->mem.disp);",
          "96:     break;",
          "97:    default:",
          "98:     break;",
          "99:   }",
          "102:   if (op->avx_bcast != X86_AVX_BCAST_INVALID)",
          "103:    printf(\"\\t\\toperands[%u].avx_bcast: %u\\n\", i, op->avx_bcast);",
          "106:   if (op->avx_zero_opmask != false)",
          "107:    printf(\"\\t\\toperands[%u].avx_zero_opmask: TRUE\\n\", i);",
          "109:   printf(\"\\t\\toperands[%u].size: %u\\n\", i, op->size);",
          "110:  }",
          "112:  printf(\"\\n\");",
          "",
          "---------------"
        ],
        "cstool/cstool_xcore.c||cstool/cstool_xcore.c": [
          "File: cstool/cstool_xcore.c -> cstool/cstool_xcore.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: #include <stdio.h>",
          "5: #include <capstone.h>",
          "19: void print_insn_detail_xcore(csh handle, cs_insn *ins)",
          "20: {",
          "62: }",
          "",
          "[Removed Lines]",
          "7: static void print_string_hex(char *comment, unsigned char *str, size_t len)",
          "8: {",
          "9:     unsigned char *c;",
          "11:     printf(\"%s\", comment);",
          "12:     for (c = str; c < str + len; c++) {",
          "13:         printf(\"0x%02x \", *c & 0xff);",
          "14:     }",
          "16:     printf(\"\\n\");",
          "17: }",
          "21:     cs_xcore *xcore;",
          "22:     int i;",
          "25:     if (ins->detail == NULL)",
          "26:         return;",
          "28:     xcore = &(ins->detail->xcore);",
          "29:     if (xcore->op_count)",
          "30:         printf(\"\\top_count: %u\\n\", xcore->op_count);",
          "32:     for (i = 0; i < xcore->op_count; i++) {",
          "33:         cs_xcore_op *op = &(xcore->operands[i]);",
          "34:         switch((int)op->type) {",
          "35:             default:",
          "36:                 break;",
          "37:             case XCORE_OP_REG:",
          "38:                 printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "39:                 break;",
          "40:             case XCORE_OP_IMM:",
          "41:                 printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, op->imm);",
          "42:                 break;",
          "43:             case XCORE_OP_MEM:",
          "44:                 printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "45:                 if (op->mem.base != XCORE_REG_INVALID)",
          "46:                     printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "47:                            i, cs_reg_name(handle, op->mem.base));",
          "48:                 if (op->mem.index != XCORE_REG_INVALID)",
          "49:                     printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "50:                            i, cs_reg_name(handle, op->mem.index));",
          "51:                 if (op->mem.disp != 0)",
          "52:                     printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "53:                 if (op->mem.direct != 1)",
          "54:                     printf(\"\\t\\t\\toperands[%u].mem.direct: -1\\n\", i);",
          "57:                 break;",
          "58:         }",
          "59:     }",
          "61:     printf(\"\\n\");",
          "",
          "[Added Lines]",
          "7: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "11:  cs_xcore *xcore;",
          "12:  int i;",
          "15:  if (ins->detail == NULL)",
          "16:   return;",
          "18:  xcore = &(ins->detail->xcore);",
          "19:  if (xcore->op_count)",
          "20:   printf(\"\\top_count: %u\\n\", xcore->op_count);",
          "22:  for (i = 0; i < xcore->op_count; i++) {",
          "23:   cs_xcore_op *op = &(xcore->operands[i]);",
          "24:   switch((int)op->type) {",
          "25:    default:",
          "26:     break;",
          "27:    case XCORE_OP_REG:",
          "28:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "29:     break;",
          "30:    case XCORE_OP_IMM:",
          "31:     printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, op->imm);",
          "32:     break;",
          "33:    case XCORE_OP_MEM:",
          "34:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "35:     if (op->mem.base != XCORE_REG_INVALID)",
          "36:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "37:        i, cs_reg_name(handle, op->mem.base));",
          "38:     if (op->mem.index != XCORE_REG_INVALID)",
          "39:      printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "40:        i, cs_reg_name(handle, op->mem.index));",
          "41:     if (op->mem.disp != 0)",
          "42:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "43:     if (op->mem.direct != 1)",
          "44:      printf(\"\\t\\t\\toperands[%u].mem.direct: -1\\n\", i);",
          "47:     break;",
          "48:   }",
          "49:  }",
          "51:  printf(\"\\n\");",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "41a3980b6dea99bec60b280d4c3fefdb7d1b5d0a",
      "candidate_info": {
        "commit_hash": "41a3980b6dea99bec60b280d4c3fefdb7d1b5d0a",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/41a3980b6dea99bec60b280d4c3fefdb7d1b5d0a",
        "files": [
          "cstool/cstool.c",
          "cstool/cstool_arm.c",
          "cstool/cstool_arm64.c",
          "cstool/cstool_m68k.c",
          "cstool/cstool_mips.c",
          "cstool/cstool_ppc.c",
          "cstool/cstool_sparc.c",
          "cstool/cstool_systemz.c",
          "cstool/cstool_x86.c"
        ],
        "message": "cstool: print out insn groups",
        "before_after_code_files": [
          "cstool/cstool.c||cstool/cstool.c",
          "cstool/cstool_arm.c||cstool/cstool_arm.c",
          "cstool/cstool_arm64.c||cstool/cstool_arm64.c",
          "cstool/cstool_m68k.c||cstool/cstool_m68k.c",
          "cstool/cstool_mips.c||cstool/cstool_mips.c",
          "cstool/cstool_ppc.c||cstool/cstool_ppc.c",
          "cstool/cstool_sparc.c||cstool/cstool_sparc.c",
          "cstool/cstool_systemz.c||cstool/cstool_systemz.c",
          "cstool/cstool_x86.c||cstool/cstool_x86.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "cstool/cstool.c||cstool/cstool.c": [
          "File: cstool/cstool.c -> cstool/cstool.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "371:     if (arch == CS_ARCH_XCORE) {",
          "372:      print_insn_detail_xcore(handle, &insn[i]);",
          "373:     }",
          "374:    }",
          "375:   }",
          "376:   cs_free(insn, count);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "375:     if (insn[i].detail->groups_count) {",
          "376:      int j;",
          "378:      printf(\"\\tGroups: \");",
          "379:      for(j = 0; j < insn[i].detail->groups_count; j++) {",
          "380:       printf(\"%s \", cs_group_name(handle, insn[i].detail->groups[j]));",
          "381:      }",
          "382:      printf(\"\\n\");",
          "383:     }",
          "385:     printf(\"\\n\");",
          "",
          "---------------"
        ],
        "cstool/cstool_arm.c||cstool/cstool_arm.c": [
          "File: cstool/cstool_arm.c -> cstool/cstool_arm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "111:  if (arm->mem_barrier)",
          "112:   printf(\"\\tMemory-barrier: %u\\n\", arm->mem_barrier);",
          "115: }",
          "",
          "[Removed Lines]",
          "114:  printf(\"\\n\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "cstool/cstool_arm64.c||cstool/cstool_arm64.c": [
          "File: cstool/cstool_arm64.c -> cstool/cstool_arm64.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:  if (arm64->cc)",
          "101:   printf(\"\\tCode-condition: %u\\n\", arm64->cc);",
          "104: }",
          "",
          "[Removed Lines]",
          "103:  printf(\"\\n\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "cstool/cstool_m68k.c||cstool/cstool_m68k.c": [
          "File: cstool/cstool_m68k.c -> cstool/cstool_m68k.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9: #include <stdio.h>",
          "10: #include <capstone/capstone.h>",
          "12: void print_string_hex(char *comment, unsigned char *str, size_t len);",
          "14: static const char* s_addressing_modes[] = {",
          "15:  \"<invalid mode>\",",
          "17:  \"Register Direct - Data\",",
          "18:  \"Register Direct - Address\",",
          "20:  \"Register Indirect - Address\",",
          "21:  \"Register Indirect - Address with Postincrement\",",
          "22:  \"Register Indirect - Address with Predecrement\",",
          "23:  \"Register Indirect - Address with Displacement\",",
          "25:  \"Address Register Indirect With Index - 8-bit displacement\",",
          "26:  \"Address Register Indirect With Index - Base displacement\",",
          "28:  \"Memory indirect - Postindex\",",
          "29:  \"Memory indirect - Preindex\",",
          "31:  \"Program Counter Indirect - with Displacement\",",
          "33:  \"Program Counter Indirect with Index - with 8-Bit Displacement\",",
          "34:  \"Program Counter Indirect with Index - with Base Displacement\",",
          "36:  \"Program Counter Memory Indirect - Postindexed\",",
          "37:  \"Program Counter Memory Indirect - Preindexed\",",
          "39:  \"Absolute Data Addressing  - Short\",",
          "40:  \"Absolute Data Addressing  - Long\",",
          "41:  \"Immediate value\",",
          "42: };",
          "44: static void print_read_write_regs(cs_detail* detail, csh handle)",
          "45: {",
          "46:  int i;",
          "48:  for (i = 0; i < detail->regs_read_count; ++i) {",
          "49:   uint16_t reg_id = detail->regs_read[i];",
          "50:   const char* reg_name = cs_reg_name(handle, reg_id);",
          "51:   printf(\"\\treading from reg: %s\\n\", reg_name);",
          "52:  }",
          "54:  for (i = 0; i < detail->regs_write_count; ++i) {",
          "55:   uint16_t reg_id = detail->regs_write[i];",
          "56:   const char* reg_name = cs_reg_name(handle, reg_id);",
          "57:   printf(\"\\twriting to reg:   %s\\n\", reg_name);",
          "58:  }",
          "59: }",
          "61: void print_insn_detail_m68k(csh handle, cs_insn *ins)",
          "62: {",
          "63:  cs_m68k* m68k;",
          "64:  cs_detail* detail;",
          "65:  int i;",
          "68:  if (ins->detail == NULL)",
          "69:   return;",
          "71:  detail = ins->detail;",
          "72:  m68k = &detail->m68k;",
          "73:  if (m68k->op_count)",
          "74:   printf(\"\\top_count: %u\\n\", m68k->op_count);",
          "76:  print_read_write_regs(detail, handle);",
          "78:  printf(\"\\tgroups_count: %u\\n\", detail->groups_count);",
          "80:  for (i = 0; i < m68k->op_count; i++) {",
          "81:   cs_m68k_op* op = &(m68k->operands[i]);",
          "83:   switch((int)op->type) {",
          "84:    default:",
          "85:     break;",
          "86:    case M68K_OP_REG:",
          "87:     printf(\"\\t\\toperands[%u].type: REG = %s\\n\", i, cs_reg_name(handle, op->reg));",
          "88:     break;",
          "89:    case M68K_OP_IMM:",
          "90:     printf(\"\\t\\toperands[%u].type: IMM = 0x%x\\n\", i, (int)op->imm);",
          "91:     break;",
          "92:    case M68K_OP_MEM:",
          "93:     printf(\"\\t\\toperands[%u].type: MEM\\n\", i);",
          "94:     if (op->mem.base_reg != M68K_REG_INVALID)",
          "95:      printf(\"\\t\\t\\toperands[%u].mem.base: REG = %s\\n\",",
          "96:        i, cs_reg_name(handle, op->mem.base_reg));",
          "97:     if (op->mem.index_reg != M68K_REG_INVALID) {",
          "98:      printf(\"\\t\\t\\toperands[%u].mem.index: REG = %s\\n\",",
          "99:        i, cs_reg_name(handle, op->mem.index_reg));",
          "100:      printf(\"\\t\\t\\toperands[%u].mem.index: size = %c\\n\",",
          "101:        i, op->mem.index_size ? 'l' : 'w');",
          "102:     }",
          "103:     if (op->mem.disp != 0)",
          "104:      printf(\"\\t\\t\\toperands[%u].mem.disp: 0x%x\\n\", i, op->mem.disp);",
          "105:     if (op->mem.scale != 0)",
          "106:      printf(\"\\t\\t\\toperands[%u].mem.scale: %d\\n\", i, op->mem.scale);",
          "108:     printf(\"\\t\\taddress mode: %s\\n\", s_addressing_modes[op->address_mode]);",
          "109:     break;",
          "110:    case M68K_OP_FP_SINGLE:",
          "111:     printf(\"\\t\\toperands[%u].type: FP_SINGLE\\n\", i);",
          "112:     printf(\"\\t\\t\\toperands[%u].simm: %f\\n\", i, op->simm);",
          "113:     break;",
          "114:    case M68K_OP_FP_DOUBLE:",
          "115:     printf(\"\\t\\toperands[%u].type: FP_DOUBLE\\n\", i);",
          "116:     printf(\"\\t\\t\\toperands[%u].dimm: %lf\\n\", i, op->dimm);",
          "117:     break;",
          "118:   }",
          "119:  }",
          "120: }",
          "",
          "---------------"
        ],
        "cstool/cstool_mips.c||cstool/cstool_mips.c": [
          "File: cstool/cstool_mips.c -> cstool/cstool_mips.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "44:   }",
          "46:  }",
          "49: }",
          "",
          "[Removed Lines]",
          "48:  printf(\"\\n\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "cstool/cstool_ppc.c||cstool/cstool_ppc.c": [
          "File: cstool/cstool_ppc.c -> cstool/cstool_ppc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "87:  if (ppc->update_cr0)",
          "88:   printf(\"\\tUpdate-CR0: True\\n\");",
          "91: }",
          "",
          "[Removed Lines]",
          "90:  printf(\"\\n\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "cstool/cstool_sparc.c||cstool/cstool_sparc.c": [
          "File: cstool/cstool_sparc.c -> cstool/cstool_sparc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "52:  if (sparc->hint != 0)",
          "53:   printf(\"\\tHint code: %u\\n\", sparc->hint);",
          "56: }",
          "",
          "[Removed Lines]",
          "55:  printf(\"\\n\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "cstool/cstool_systemz.c||cstool/cstool_systemz.c": [
          "File: cstool/cstool_systemz.c -> cstool/cstool_systemz.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "54:  if (sysz->cc != 0)",
          "55:   printf(\"\\tCode condition: %u\\n\", sysz->cc);",
          "58: }",
          "",
          "[Removed Lines]",
          "57:  printf(\"\\n\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "cstool/cstool_x86.c||cstool/cstool_x86.c": [
          "File: cstool/cstool_x86.c -> cstool/cstool_x86.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "109:   printf(\"\\t\\toperands[%u].size: %u\\n\", i, op->size);",
          "110:  }",
          "113: }",
          "",
          "[Removed Lines]",
          "112:  printf(\"\\n\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "76283329d7aabd964a3fe1f9b97c3bee76c29a2c",
      "candidate_info": {
        "commit_hash": "76283329d7aabd964a3fe1f9b97c3bee76c29a2c",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/76283329d7aabd964a3fe1f9b97c3bee76c29a2c",
        "files": [
          "msvc/capstone_static/capstone_static.vcxproj"
        ],
        "message": "revert to 2fdd954 (delete WDK settings)",
        "before_after_code_files": [
          "msvc/capstone_static/capstone_static.vcxproj||msvc/capstone_static/capstone_static.vcxproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "msvc/capstone_static/capstone_static.vcxproj||msvc/capstone_static/capstone_static.vcxproj": [
          "File: msvc/capstone_static/capstone_static.vcxproj -> msvc/capstone_static/capstone_static.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "12:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "13:       <Configuration>Debug</Configuration>",
          "14:       <Platform>Win32</Platform>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "4:     <ProjectConfiguration Include=\"Debug_WDK|Win32\">",
          "5:       <Configuration>Debug_WDK</Configuration>",
          "6:       <Platform>Win32</Platform>",
          "7:     </ProjectConfiguration>",
          "8:     <ProjectConfiguration Include=\"Debug_WDK|x64\">",
          "9:       <Configuration>Debug_WDK</Configuration>",
          "10:       <Platform>x64</Platform>",
          "11:     </ProjectConfiguration>",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "17:       <Configuration>Debug</Configuration>",
          "18:       <Platform>x64</Platform>",
          "19:     </ProjectConfiguration>",
          "28:     <ProjectConfiguration Include=\"Release|Win32\">",
          "29:       <Configuration>Release</Configuration>",
          "30:       <Platform>Win32</Platform>",
          "",
          "[Removed Lines]",
          "20:     <ProjectConfiguration Include=\"Release_WDK|Win32\">",
          "21:       <Configuration>Release_WDK</Configuration>",
          "22:       <Platform>Win32</Platform>",
          "23:     </ProjectConfiguration>",
          "24:     <ProjectConfiguration Include=\"Release_WDK|x64\">",
          "25:       <Configuration>Release_WDK</Configuration>",
          "26:       <Platform>x64</Platform>",
          "27:     </ProjectConfiguration>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "83:     <Keyword>Win32Proj</Keyword>",
          "84:     <RootNamespace>capstonewin32</RootNamespace>",
          "85:     <ProjectName>capstone_static</ProjectName>",
          "87:   </PropertyGroup>",
          "88:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "89:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "90:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "91:     <UseDebugLibraries>true</UseDebugLibraries>",
          "92:     <CharacterSet>Unicode</CharacterSet>",
          "100:   </PropertyGroup>",
          "101:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "102:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "103:     <UseDebugLibraries>true</UseDebugLibraries>",
          "104:     <CharacterSet>Unicode</CharacterSet>",
          "112:   </PropertyGroup>",
          "113:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "114:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "115:     <UseDebugLibraries>false</UseDebugLibraries>",
          "116:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "117:     <CharacterSet>Unicode</CharacterSet>",
          "125:   </PropertyGroup>",
          "126:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "127:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "128:     <UseDebugLibraries>false</UseDebugLibraries>",
          "129:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "130:     <CharacterSet>Unicode</CharacterSet>",
          "138:   </PropertyGroup>",
          "139:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "140:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "86:     <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>",
          "93:     <PlatformToolset>v140</PlatformToolset>",
          "94:   </PropertyGroup>",
          "95:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\" Label=\"Configuration\">",
          "96:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "97:     <UseDebugLibraries>true</UseDebugLibraries>",
          "98:     <CharacterSet>Unicode</CharacterSet>",
          "99:     <PlatformToolset>v140</PlatformToolset>",
          "105:     <PlatformToolset>v140</PlatformToolset>",
          "106:   </PropertyGroup>",
          "107:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\" Label=\"Configuration\">",
          "108:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "109:     <UseDebugLibraries>true</UseDebugLibraries>",
          "110:     <CharacterSet>Unicode</CharacterSet>",
          "111:     <PlatformToolset>v140</PlatformToolset>",
          "118:     <PlatformToolset>v140</PlatformToolset>",
          "119:   </PropertyGroup>",
          "120:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\" Label=\"Configuration\">",
          "121:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "122:     <UseDebugLibraries>false</UseDebugLibraries>",
          "123:     <CharacterSet>Unicode</CharacterSet>",
          "124:     <PlatformToolset>v140</PlatformToolset>",
          "131:     <PlatformToolset>v140</PlatformToolset>",
          "132:   </PropertyGroup>",
          "133:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\" Label=\"Configuration\">",
          "134:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "135:     <UseDebugLibraries>false</UseDebugLibraries>",
          "136:     <CharacterSet>Unicode</CharacterSet>",
          "137:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "142:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "143:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "144:   </ImportGroup>",
          "148:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"PropertySheets\">",
          "149:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "150:   </ImportGroup>",
          "154:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "155:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "156:   </ImportGroup>",
          "160:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"PropertySheets\">",
          "161:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "162:   </ImportGroup>",
          "166:   <PropertyGroup Label=\"UserMacros\" />",
          "167:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "168:     <TargetName>capstone</TargetName>",
          "169:   </PropertyGroup>",
          "173:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "174:     <TargetName>capstone</TargetName>",
          "175:   </PropertyGroup>",
          "179:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "180:     <TargetName>capstone</TargetName>",
          "181:   </PropertyGroup>",
          "185:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "186:     <TargetName>capstone</TargetName>",
          "187:   </PropertyGroup>",
          "191:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "192:     <ClCompile>",
          "193:       <PrecompiledHeader>",
          "",
          "[Removed Lines]",
          "145:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\" Label=\"PropertySheets\">",
          "146:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "147:   </ImportGroup>",
          "151:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\" Label=\"PropertySheets\">",
          "152:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "153:   </ImportGroup>",
          "157:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\" Label=\"PropertySheets\">",
          "158:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "159:   </ImportGroup>",
          "163:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\" Label=\"PropertySheets\">",
          "164:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "165:   </ImportGroup>",
          "170:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\">",
          "171:     <TargetName>capstone</TargetName>",
          "172:   </PropertyGroup>",
          "176:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\">",
          "177:     <TargetName>capstone</TargetName>",
          "178:   </PropertyGroup>",
          "182:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\">",
          "183:     <TargetName>capstone</TargetName>",
          "184:   </PropertyGroup>",
          "188:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\">",
          "189:     <TargetName>capstone</TargetName>",
          "190:   </PropertyGroup>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "204:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "205:     </Link>",
          "206:   </ItemDefinitionGroup>",
          "226:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "227:     <ClCompile>",
          "228:       <PrecompiledHeader>",
          "",
          "[Removed Lines]",
          "207:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\">",
          "208:     <ClCompile>",
          "209:       <PrecompiledHeader>",
          "210:       </PrecompiledHeader>",
          "211:       <WarningLevel>Level3</WarningLevel>",
          "212:       <Optimization>Disabled</Optimization>",
          "213:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;_DEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "214:       <SDLCheck>true</SDLCheck>",
          "215:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "216:       <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>",
          "217:       <BasicRuntimeChecks>Default</BasicRuntimeChecks>",
          "218:       <RuntimeLibrary />",
          "219:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "220:     </ClCompile>",
          "221:     <Link>",
          "222:       <SubSystem>Windows</SubSystem>",
          "223:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "224:     </Link>",
          "225:   </ItemDefinitionGroup>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "239:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "240:     </Link>",
          "241:   </ItemDefinitionGroup>",
          "261:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "262:     <ClCompile>",
          "263:       <WarningLevel>Level3</WarningLevel>",
          "",
          "[Removed Lines]",
          "242:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\">",
          "243:     <ClCompile>",
          "244:       <PrecompiledHeader>",
          "245:       </PrecompiledHeader>",
          "246:       <WarningLevel>Level3</WarningLevel>",
          "247:       <Optimization>Disabled</Optimization>",
          "248:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;_DEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "249:       <SDLCheck>true</SDLCheck>",
          "250:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "251:       <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>",
          "252:       <BasicRuntimeChecks>Default</BasicRuntimeChecks>",
          "253:       <RuntimeLibrary />",
          "254:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "255:     </ClCompile>",
          "256:     <Link>",
          "257:       <SubSystem>Windows</SubSystem>",
          "258:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "259:     </Link>",
          "260:   </ItemDefinitionGroup>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "278:       <OptimizeReferences>true</OptimizeReferences>",
          "279:     </Link>",
          "280:   </ItemDefinitionGroup>",
          "303:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "304:     <ClCompile>",
          "305:       <WarningLevel>Level3</WarningLevel>",
          "",
          "[Removed Lines]",
          "281:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\">",
          "282:     <ClCompile>",
          "283:       <WarningLevel>Level3</WarningLevel>",
          "284:       <PrecompiledHeader>",
          "285:       </PrecompiledHeader>",
          "286:       <Optimization>MaxSpeed</Optimization>",
          "287:       <FunctionLevelLinking>true</FunctionLevelLinking>",
          "288:       <IntrinsicFunctions>true</IntrinsicFunctions>",
          "289:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;NDEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "290:       <SDLCheck>true</SDLCheck>",
          "291:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "292:       <RuntimeLibrary>",
          "293:       </RuntimeLibrary>",
          "294:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "295:     </ClCompile>",
          "296:     <Link>",
          "297:       <SubSystem>Windows</SubSystem>",
          "298:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "299:       <EnableCOMDATFolding>true</EnableCOMDATFolding>",
          "300:       <OptimizeReferences>true</OptimizeReferences>",
          "301:     </Link>",
          "302:   </ItemDefinitionGroup>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "320:       <OptimizeReferences>true</OptimizeReferences>",
          "321:     </Link>",
          "322:   </ItemDefinitionGroup>",
          "345:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.targets\" />",
          "346:   <ImportGroup Label=\"ExtensionTargets\">",
          "347:   </ImportGroup>",
          "",
          "[Removed Lines]",
          "323:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\">",
          "324:     <ClCompile>",
          "325:       <WarningLevel>Level3</WarningLevel>",
          "326:       <PrecompiledHeader>",
          "327:       </PrecompiledHeader>",
          "328:       <Optimization>MaxSpeed</Optimization>",
          "329:       <FunctionLevelLinking>true</FunctionLevelLinking>",
          "330:       <IntrinsicFunctions>true</IntrinsicFunctions>",
          "331:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;NDEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "332:       <SDLCheck>true</SDLCheck>",
          "333:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "334:       <RuntimeLibrary>",
          "335:       </RuntimeLibrary>",
          "336:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "337:     </ClCompile>",
          "338:     <Link>",
          "339:       <SubSystem>Windows</SubSystem>",
          "340:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "341:       <EnableCOMDATFolding>true</EnableCOMDATFolding>",
          "342:       <OptimizeReferences>true</OptimizeReferences>",
          "343:     </Link>",
          "344:   </ItemDefinitionGroup>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "58b82e42da56bade7ec1aa919ca4fff5d8939a6c",
      "candidate_info": {
        "commit_hash": "58b82e42da56bade7ec1aa919ca4fff5d8939a6c",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/58b82e42da56bade7ec1aa919ca4fff5d8939a6c",
        "files": [
          "tests/test_winkernel.cpp"
        ],
        "message": "add test code for winkernel",
        "before_after_code_files": [
          "tests/test_winkernel.cpp||tests/test_winkernel.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tests/test_winkernel.cpp||tests/test_winkernel.cpp": [
          "File: tests/test_winkernel.cpp -> tests/test_winkernel.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: #include <ntddk.h>",
          "4: #include <capstone.h>",
          "6: #ifdef __cplusplus",
          "7: extern \"C\" {",
          "8: #endif",
          "10: #include \"../utils.h\"   // for cs_snprintf",
          "12: #ifdef __cplusplus",
          "13: }",
          "14: #endif",
          "16: #pragma warning(push)",
          "17: #pragma warning(disable : 4005)  // 'identifier' : macro redefinition",
          "18: #pragma warning(disable : 4007)  // 'main': must be '__cdecl'",
          "25: namespace unnamed {",
          "26: #include \"test.c\"",
          "27: }  // namespace unnamed",
          "29: namespace arm {",
          "30: #include \"test_arm.c\"",
          "31: }  // namespace arm",
          "33: namespace arm64 {",
          "34: #include \"test_arm64.c\"",
          "35: }  // namespace arm64",
          "37: namespace detail {",
          "38: #include \"test_detail.c\"",
          "39: }  // namespace detail",
          "41: namespace iter {",
          "42: #include \"test_iter.c\"",
          "43: }  // namespace iter",
          "45: namespace mips {",
          "46: #include \"test_mips.c\"",
          "47: }  // namespace mips",
          "49: namespace ppc {",
          "50: #include \"test_ppc.c\"",
          "51: }  // namespace ppc",
          "53: namespace skipdata {",
          "54: #include \"test_skipdata.c\"",
          "55: }  // namespace skipdata",
          "57: namespace sparc {",
          "58: #include \"test_sparc.c\"",
          "59: }  // namespace sparc",
          "61: namespace systemz {",
          "62: #include \"test_systemz.c\"",
          "63: }  // namespace systemz",
          "65: namespace x86 {",
          "66: #include \"test_x86.c\"",
          "67: }  // namespace x86",
          "69: namespace xcore {",
          "70: #include \"test_xcore.c\"",
          "71: }  // namespace xcore",
          "73: #pragma warning(pop)",
          "76: static void test() {",
          "77:   KFLOATING_SAVE float_save;",
          "78:   NTSTATUS status;",
          "83:   NT_ASSERT(KeGetCurrentIrql() <= DISPATCH_LEVEL);",
          "90:   status = KeSaveFloatingPointState(&float_save);",
          "91:   if (!NT_SUCCESS(status)) {",
          "92:     printf(\"ERROR: Failed to save floating point state!\\n\");",
          "93:     return;",
          "94:   }",
          "96:   unnamed::test();",
          "97:   arm::test();",
          "98:   arm64::test();",
          "99:   detail::test();",
          "100:   iter::test();",
          "101:   mips::test();",
          "102:   ppc::test();",
          "103:   skipdata::test();",
          "104:   sparc::test();",
          "105:   systemz::test();",
          "106:   x86::test();",
          "107:   xcore::test();",
          "110:   KeRestoreFloatingPointState(&float_save);",
          "111: }",
          "114: static void cs_winkernel_vsnprintf_test()",
          "115: {",
          "116:   char buf[10];",
          "117:   bool ok = true;",
          "118:   ok = (ok && cs_snprintf(buf, sizeof(buf), \"%s\", \"\") == 0 && strcmp(buf, \"\") == 0);",
          "119:   ok = (ok && cs_snprintf(buf, sizeof(buf), \"%s\", \"0\") == 1 && strcmp(buf, \"0\") == 0);",
          "120:   ok = (ok && cs_snprintf(buf, sizeof(buf), \"%s\", \"012345678\") == 9 && strcmp(buf, \"012345678\") == 0);",
          "121:   ok = (ok && cs_snprintf(buf, sizeof(buf), \"%s\", \"0123456789\") == 10 && strcmp(buf, \"012345678\") == 0);",
          "122:   ok = (ok && cs_snprintf(buf, sizeof(buf), \"%s\", \"01234567890\") == 11 && strcmp(buf, \"012345678\") == 0);",
          "123:   ok = (ok && cs_snprintf(buf, sizeof(buf), \"%s\", \"0123456789001234567890\") == 22 && strcmp(buf, \"012345678\") == 0);",
          "124:   if (!ok) {",
          "125:     printf(\"ERROR: cs_winkernel_vsnprintf_test() did not produce expected results!\\n\");",
          "126:   }",
          "127: }",
          "130: EXTERN_C NTSTATUS DriverEntry(PDRIVER_OBJECT DriverObject,",
          "131:                               PUNICODE_STRING RegistryPath) {",
          "132:   UNREFERENCED_PARAMETER(DriverObject);",
          "133:   UNREFERENCED_PARAMETER(RegistryPath);",
          "134:   cs_winkernel_vsnprintf_test();",
          "135:   test();",
          "136:   return STATUS_CANCELLED;",
          "137: }",
          "141: int __cdecl printf(const char * format, ...) {",
          "142:   NTSTATUS status;",
          "143:   va_list args;",
          "145:   va_start(args, format);",
          "146:   status = vDbgPrintEx(DPFLTR_DEFAULT_ID, DPFLTR_ERROR_LEVEL, format, args);",
          "147:   va_end(args);",
          "148:   return NT_SUCCESS(status);",
          "149: }",
          "",
          "---------------"
        ]
      }
    }
  ]
}