{
  "cve_id": "CVE-2016-2045",
  "cve_desc": "Cross-site scripting (XSS) vulnerability in the SQL editor in phpMyAdmin 4.5.x before 4.5.4 allows remote authenticated users to inject arbitrary web script or HTML via a SQL query that triggers JSON data in a response.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "0a24f92d081033576bfdd9d4bdec1a54501734c1",
  "patch_info": {
    "commit_hash": "0a24f92d081033576bfdd9d4bdec1a54501734c1",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/0a24f92d081033576bfdd9d4bdec1a54501734c1",
    "files": [
      "import_status.php",
      "libraries/Response.class.php",
      "libraries/core.lib.php",
      "libraries/display_import_ajax.lib.php",
      "lint.php",
      "normalization.php",
      "setup/validate.php",
      "version_check.php"
    ],
    "message": "Set correct content type for JSON responses\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
    "before_after_code_files": [
      "import_status.php||import_status.php",
      "libraries/Response.class.php||libraries/Response.class.php",
      "libraries/core.lib.php||libraries/core.lib.php",
      "libraries/display_import_ajax.lib.php||libraries/display_import_ajax.lib.php",
      "lint.php||lint.php",
      "normalization.php||normalization.php",
      "setup/validate.php||setup/validate.php",
      "version_check.php||version_check.php"
    ]
  },
  "patch_diff": {
    "import_status.php||import_status.php": [
      "File: import_status.php -> import_status.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "75: }",
      "82: if (isset($_GET[\"message\"]) && $_GET[\"message\"]) {",
      "84:     header('Content-type: text/html');",
      "",
      "[Removed Lines]",
      "79: PMA_noCacheHeader();",
      "",
      "[Added Lines]",
      "82:     PMA_noCacheHeader();",
      "",
      "---------------"
    ],
    "libraries/Response.class.php||libraries/Response.class.php": [
      "File: libraries/Response.class.php -> libraries/Response.class.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "377:         echo json_encode($this->_JSON);",
      "378:     }",
      "",
      "[Removed Lines]",
      "372:         if (! defined('TESTSUITE')) {",
      "373:             header('Cache-Control: no-cache');",
      "374:             header('Content-Type: application/json');",
      "375:         }",
      "",
      "[Added Lines]",
      "372:         PMA_headerJSON();",
      "",
      "---------------"
    ],
    "libraries/core.lib.php||libraries/core.lib.php": [
      "File: libraries/core.lib.php -> libraries/core.lib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "630:     }",
      "631: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "638: function PMA_headerJSON()",
      "639: {",
      "640:     if (defined('TESTSUITE') && ! defined('PMA_TEST_HEADERS')) {",
      "641:         return;",
      "642:     }",
      "644:     PMA_noCacheHeader();",
      "646:     header('Content-Type: application/json; charset=UTF-8');",
      "650:     header('X-Content-Type-Options: nosniff');",
      "651: }",
      "",
      "---------------"
    ],
    "libraries/display_import_ajax.lib.php||libraries/display_import_ajax.lib.php": [
      "File: libraries/display_import_ajax.lib.php -> libraries/display_import_ajax.lib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "122: function PMA_importAjaxStatus($id)",
      "123: {",
      "125:     echo json_encode(",
      "126:         $_SESSION[$GLOBALS['SESSION_KEY']]['handler']::getUploadStatus($id)",
      "127:     );",
      "",
      "[Removed Lines]",
      "124:     header('Content-type: application/json');",
      "",
      "[Added Lines]",
      "124:     PMA_headerJSON();",
      "",
      "---------------"
    ],
    "lint.php||lint.php": [
      "File: lint.php -> lint.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "31: $sql_query = !empty($_POST['sql_query']) ? $_POST['sql_query'] : '';",
      "37: echo json_encode(PMA_Linter::lint($sql_query));",
      "",
      "[Removed Lines]",
      "34: $response = PMA_Response::getInstance();",
      "35: $response->disable();",
      "",
      "[Added Lines]",
      "34: PMA_Response::getInstance()->disable();",
      "36: PMA_headerJSON();",
      "",
      "---------------"
    ],
    "normalization.php||normalization.php": [
      "File: normalization.php -> normalization.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "60:     $dependencies = json_decode($_REQUEST['pd']);",
      "61:     $tables = json_decode($_REQUEST['tables']);",
      "62:     $newTables = PMA_getHtmlForNewTables3NF($dependencies, $tables, $db);",
      "63:     echo json_encode($newTables);",
      "64:     exit;",
      "65: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "63:     PMA_Response::getInstance()->disable();",
      "64:     PMA_headerJSON();",
      "",
      "---------------"
    ],
    "setup/validate.php||setup/validate.php": [
      "File: setup/validate.php -> setup/validate.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "14: $validators = array();",
      "15: require './libraries/config/Validator.class.php';",
      "19: $ids = isset($_POST['id']) ? $_POST['id'] : null;",
      "20: $vids = explode(',', $ids);",
      "",
      "[Removed Lines]",
      "17: header('Content-type: application/json');",
      "",
      "[Added Lines]",
      "17: PMA_headerJSON();",
      "",
      "---------------"
    ],
    "version_check.php||version_check.php": [
      "File: version_check.php -> version_check.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "13: require_once 'libraries/VersionInformation.php';",
      "18: $versionInformation = new VersionInformation();",
      "19: $versionDetails = $versionInformation->getLatestVersion();",
      "",
      "[Removed Lines]",
      "16: header('Content-type: application/json; charset=UTF-8');",
      "",
      "[Added Lines]",
      "16: PMA_headerJSON();",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "eef994f122121253e2bea856f7259b2a4578bc64",
      "candidate_info": {
        "commit_hash": "eef994f122121253e2bea856f7259b2a4578bc64",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/eef994f122121253e2bea856f7259b2a4578bc64",
        "files": [
          "js/codemirror/addon/lint/lint.css",
          "js/codemirror/addon/lint/lint.js",
          "js/codemirror/addon/lint/sql-lint.js",
          "js/functions.js",
          "libraries/Header.class.php",
          "libraries/config.default.php",
          "libraries/config/messages.inc.php",
          "libraries/config/setup.forms.php",
          "libraries/config/user_preferences.forms.php",
          "lint.php"
        ],
        "message": "Added lint.\n\nSigned-off-by: Dan Ungureanu <udan1107@gmail.com>",
        "before_after_code_files": [
          "js/codemirror/addon/lint/lint.css||js/codemirror/addon/lint/lint.css",
          "js/codemirror/addon/lint/lint.js||js/codemirror/addon/lint/lint.js",
          "js/codemirror/addon/lint/sql-lint.js||js/codemirror/addon/lint/sql-lint.js",
          "js/functions.js||js/functions.js",
          "libraries/Header.class.php||libraries/Header.class.php",
          "libraries/config.default.php||libraries/config.default.php",
          "libraries/config/messages.inc.php||libraries/config/messages.inc.php",
          "libraries/config/setup.forms.php||libraries/config/setup.forms.php",
          "libraries/config/user_preferences.forms.php||libraries/config/user_preferences.forms.php",
          "lint.php||lint.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lint.php||lint.php"
          ],
          "candidate": [
            "lint.php||lint.php"
          ]
        }
      },
      "candidate_diff": {
        "js/codemirror/addon/lint/lint.css||js/codemirror/addon/lint/lint.css": [
          "File: js/codemirror/addon/lint/lint.css -> js/codemirror/addon/lint/lint.css",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2: .CodeMirror-lint-markers {",
          "3:   width: 16px;",
          "4: }",
          "6: .CodeMirror-lint-tooltip {",
          "7:   background-color: infobackground;",
          "8:   border: 1px solid black;",
          "9:   border-radius: 4px 4px 4px 4px;",
          "10:   color: infotext;",
          "11:   font-family: monospace;",
          "12:   font-size: 10pt;",
          "13:   overflow: hidden;",
          "14:   padding: 2px 5px;",
          "15:   position: fixed;",
          "16:   white-space: pre;",
          "17:   white-space: pre-wrap;",
          "18:   z-index: 100;",
          "19:   max-width: 600px;",
          "20:   opacity: 0;",
          "21:   transition: opacity .4s;",
          "22:   -moz-transition: opacity .4s;",
          "23:   -webkit-transition: opacity .4s;",
          "24:   -o-transition: opacity .4s;",
          "25:   -ms-transition: opacity .4s;",
          "26: }",
          "28: .CodeMirror-lint-mark-error, .CodeMirror-lint-mark-warning {",
          "29:   background-position: left bottom;",
          "30:   background-repeat: repeat-x;",
          "31: }",
          "33: .CodeMirror-lint-mark-error {",
          "34:   background-image:",
          "35:   url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg==\")",
          "36:   ;",
          "37: }",
          "39: .CodeMirror-lint-mark-warning {",
          "40:   background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJFhQXEbhTg7YAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAMklEQVQI12NkgIIvJ3QXMjAwdDN+OaEbysDA4MPAwNDNwMCwiOHLCd1zX07o6kBVGQEAKBANtobskNMAAAAASUVORK5CYII=\");",
          "41: }",
          "43: .CodeMirror-lint-marker-error, .CodeMirror-lint-marker-warning {",
          "44:   background-position: center center;",
          "45:   background-repeat: no-repeat;",
          "46:   cursor: pointer;",
          "47:   display: inline-block;",
          "48:   height: 16px;",
          "49:   width: 16px;",
          "50:   vertical-align: middle;",
          "51:   position: relative;",
          "52: }",
          "54: .CodeMirror-lint-message-error, .CodeMirror-lint-message-warning {",
          "55:   padding-left: 18px;",
          "56:   background-position: top left;",
          "57:   background-repeat: no-repeat;",
          "58: }",
          "60: .CodeMirror-lint-marker-error, .CodeMirror-lint-message-error {",
          "61:   background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAHlBMVEW7AAC7AACxAAC7AAC7AAAAAAC4AAC5AAD///+7AAAUdclpAAAABnRSTlMXnORSiwCK0ZKSAAAATUlEQVR42mWPOQ7AQAgDuQLx/z8csYRmPRIFIwRGnosRrpamvkKi0FTIiMASR3hhKW+hAN6/tIWhu9PDWiTGNEkTtIOucA5Oyr9ckPgAWm0GPBog6v4AAAAASUVORK5CYII=\");",
          "62: }",
          "64: .CodeMirror-lint-marker-warning, .CodeMirror-lint-message-warning {",
          "65:   background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAANlBMVEX/uwDvrwD/uwD/uwD/uwD/uwD/uwD/uwD/uwD6twD/uwAAAADurwD2tQD7uAD+ugAAAAD/uwDhmeTRAAAADHRSTlMJ8mN1EYcbmiixgACm7WbuAAAAVklEQVR42n3PUQqAIBBFUU1LLc3u/jdbOJoW1P08DA9Gba8+YWJ6gNJoNYIBzAA2chBth5kLmG9YUoG0NHAUwFXwO9LuBQL1giCQb8gC9Oro2vp5rncCIY8L8uEx5ZkAAAAASUVORK5CYII=\");",
          "66: }",
          "68: .CodeMirror-lint-marker-multiple {",
          "69:   background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAMAAADzjKfhAAAACVBMVEUAAAAAAAC/v7914kyHAAAAAXRSTlMAQObYZgAAACNJREFUeNo1ioEJAAAIwmz/H90iFFSGJgFMe3gaLZ0od+9/AQZ0ADosbYraAAAAAElFTkSuQmCC\");",
          "70:   background-repeat: no-repeat;",
          "71:   background-position: right bottom;",
          "72:   width: 100%; height: 100%;",
          "73: }",
          "",
          "---------------"
        ],
        "js/codemirror/addon/lint/lint.js||js/codemirror/addon/lint/lint.js": [
          "File: js/codemirror/addon/lint/lint.js -> js/codemirror/addon/lint/lint.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: (function(mod) {",
          "4:   if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS",
          "5:     mod(require(\"../../lib/codemirror\"));",
          "6:   else if (typeof define == \"function\" && define.amd) // AMD",
          "7:     define([\"../../lib/codemirror\"], mod);",
          "8:   else // Plain browser env",
          "9:     mod(CodeMirror);",
          "10: })(function(CodeMirror) {",
          "11:   \"use strict\";",
          "12:   var GUTTER_ID = \"CodeMirror-lint-markers\";",
          "14:   function showTooltip(e, content) {",
          "15:     var tt = document.createElement(\"div\");",
          "16:     tt.className = \"CodeMirror-lint-tooltip\";",
          "17:     tt.appendChild(content.cloneNode(true));",
          "18:     document.body.appendChild(tt);",
          "20:     function position(e) {",
          "21:       if (!tt.parentNode) return CodeMirror.off(document, \"mousemove\", position);",
          "22:       tt.style.top = Math.max(0, e.clientY - tt.offsetHeight - 5) + \"px\";",
          "23:       tt.style.left = (e.clientX + 5) + \"px\";",
          "24:     }",
          "25:     CodeMirror.on(document, \"mousemove\", position);",
          "26:     position(e);",
          "27:     if (tt.style.opacity != null) tt.style.opacity = 1;",
          "28:     return tt;",
          "29:   }",
          "30:   function rm(elt) {",
          "31:     if (elt.parentNode) elt.parentNode.removeChild(elt);",
          "32:   }",
          "33:   function hideTooltip(tt) {",
          "34:     if (!tt.parentNode) return;",
          "35:     if (tt.style.opacity == null) rm(tt);",
          "36:     tt.style.opacity = 0;",
          "37:     setTimeout(function() { rm(tt); }, 600);",
          "38:   }",
          "40:   function showTooltipFor(e, content, node) {",
          "41:     var tooltip = showTooltip(e, content);",
          "42:     function hide() {",
          "43:       CodeMirror.off(node, \"mouseout\", hide);",
          "44:       if (tooltip) { hideTooltip(tooltip); tooltip = null; }",
          "45:     }",
          "46:     var poll = setInterval(function() {",
          "47:       if (tooltip) for (var n = node;; n = n.parentNode) {",
          "48:         if (n && n.nodeType == 11) n = n.host;",
          "49:         if (n == document.body) return;",
          "50:         if (!n) { hide(); break; }",
          "51:       }",
          "52:       if (!tooltip) return clearInterval(poll);",
          "53:     }, 400);",
          "54:     CodeMirror.on(node, \"mouseout\", hide);",
          "55:   }",
          "57:   function LintState(cm, options, hasGutter) {",
          "58:     this.marked = [];",
          "59:     this.options = options;",
          "60:     this.timeout = null;",
          "61:     this.hasGutter = hasGutter;",
          "62:     this.onMouseOver = function(e) { onMouseOver(cm, e); };",
          "63:   }",
          "65:   function parseOptions(_cm, options) {",
          "66:     if (options instanceof Function) return {getAnnotations: options};",
          "67:     if (!options || options === true) options = {};",
          "68:     return options;",
          "69:   }",
          "71:   function clearMarks(cm) {",
          "72:     var state = cm.state.lint;",
          "73:     if (state.hasGutter) cm.clearGutter(GUTTER_ID);",
          "74:     for (var i = 0; i < state.marked.length; ++i)",
          "75:       state.marked[i].clear();",
          "76:     state.marked.length = 0;",
          "77:   }",
          "79:   function makeMarker(labels, severity, multiple, tooltips) {",
          "80:     var marker = document.createElement(\"div\"), inner = marker;",
          "81:     marker.className = \"CodeMirror-lint-marker-\" + severity;",
          "82:     if (multiple) {",
          "83:       inner = marker.appendChild(document.createElement(\"div\"));",
          "84:       inner.className = \"CodeMirror-lint-marker-multiple\";",
          "85:     }",
          "87:     if (tooltips != false) CodeMirror.on(inner, \"mouseover\", function(e) {",
          "88:       showTooltipFor(e, labels, inner);",
          "89:     });",
          "91:     return marker;",
          "92:   }",
          "94:   function getMaxSeverity(a, b) {",
          "95:     if (a == \"error\") return a;",
          "96:     else return b;",
          "97:   }",
          "99:   function groupByLine(annotations) {",
          "100:     var lines = [];",
          "101:     for (var i = 0; i < annotations.length; ++i) {",
          "102:       var ann = annotations[i], line = ann.from.line;",
          "103:       (lines[line] || (lines[line] = [])).push(ann);",
          "104:     }",
          "105:     return lines;",
          "106:   }",
          "108:   function annotationTooltip(ann) {",
          "109:     var severity = ann.severity;",
          "110:     if (!severity) severity = \"error\";",
          "111:     var tip = document.createElement(\"div\");",
          "112:     tip.className = \"CodeMirror-lint-message-\" + severity;",
          "113:     tip.appendChild(document.createTextNode(ann.message));",
          "114:     return tip;",
          "115:   }",
          "117:   function startLinting(cm) {",
          "118:     var state = cm.state.lint, options = state.options;",
          "119:     var passOptions = options.options || options; // Support deprecated passing of `options` property in options",
          "120:     var getAnnotations = options.getAnnotations || cm.getHelper(CodeMirror.Pos(0, 0), \"lint\");",
          "121:     if (!getAnnotations) return;",
          "122:     if (options.async || getAnnotations.async)",
          "123:       getAnnotations(cm.getValue(), updateLinting, passOptions, cm);",
          "124:     else",
          "125:       updateLinting(cm, getAnnotations(cm.getValue(), passOptions, cm));",
          "126:   }",
          "128:   function updateLinting(cm, annotationsNotSorted) {",
          "129:     clearMarks(cm);",
          "130:     var state = cm.state.lint, options = state.options;",
          "132:     var annotations = groupByLine(annotationsNotSorted);",
          "134:     for (var line = 0; line < annotations.length; ++line) {",
          "135:       var anns = annotations[line];",
          "136:       if (!anns) continue;",
          "138:       var maxSeverity = null;",
          "139:       var tipLabel = state.hasGutter && document.createDocumentFragment();",
          "141:       for (var i = 0; i < anns.length; ++i) {",
          "142:         var ann = anns[i];",
          "143:         var severity = ann.severity;",
          "144:         if (!severity) severity = \"error\";",
          "145:         maxSeverity = getMaxSeverity(maxSeverity, severity);",
          "147:         if (options.formatAnnotation) ann = options.formatAnnotation(ann);",
          "148:         if (state.hasGutter) tipLabel.appendChild(annotationTooltip(ann));",
          "150:         if (ann.to) state.marked.push(cm.markText(ann.from, ann.to, {",
          "151:           className: \"CodeMirror-lint-mark-\" + severity,",
          "152:           __annotation: ann",
          "153:         }));",
          "154:       }",
          "156:       if (state.hasGutter)",
          "157:         cm.setGutterMarker(line, GUTTER_ID, makeMarker(tipLabel, maxSeverity, anns.length > 1,",
          "158:                                                        state.options.tooltips));",
          "159:     }",
          "160:     if (options.onUpdateLinting) options.onUpdateLinting(annotationsNotSorted, annotations, cm);",
          "161:   }",
          "163:   function onChange(cm) {",
          "164:     var state = cm.state.lint;",
          "165:     if (!state) return;",
          "166:     clearTimeout(state.timeout);",
          "167:     state.timeout = setTimeout(function(){startLinting(cm);}, state.options.delay || 500);",
          "168:   }",
          "170:   function popupSpanTooltip(ann, e) {",
          "171:     var target = e.target || e.srcElement;",
          "172:     showTooltipFor(e, annotationTooltip(ann), target);",
          "173:   }",
          "175:   function onMouseOver(cm, e) {",
          "176:     var target = e.target || e.srcElement;",
          "177:     if (!/\\bCodeMirror-lint-mark-/.test(target.className)) return;",
          "178:     var box = target.getBoundingClientRect(), x = (box.left + box.right) / 2, y = (box.top + box.bottom) / 2;",
          "179:     var spans = cm.findMarksAt(cm.coordsChar({left: x, top: y}, \"client\"));",
          "180:     for (var i = 0; i < spans.length; ++i) {",
          "181:       var ann = spans[i].__annotation;",
          "182:       if (ann) return popupSpanTooltip(ann, e);",
          "183:     }",
          "184:   }",
          "186:   CodeMirror.defineOption(\"lint\", false, function(cm, val, old) {",
          "187:     if (old && old != CodeMirror.Init) {",
          "188:       clearMarks(cm);",
          "189:       cm.off(\"change\", onChange);",
          "190:       CodeMirror.off(cm.getWrapperElement(), \"mouseover\", cm.state.lint.onMouseOver);",
          "191:       clearTimeout(cm.state.lint.timeout);",
          "192:       delete cm.state.lint;",
          "193:     }",
          "195:     if (val) {",
          "196:       var gutters = cm.getOption(\"gutters\"), hasLintGutter = false;",
          "197:       for (var i = 0; i < gutters.length; ++i) if (gutters[i] == GUTTER_ID) hasLintGutter = true;",
          "198:       var state = cm.state.lint = new LintState(cm, parseOptions(cm, val), hasLintGutter);",
          "199:       cm.on(\"change\", onChange);",
          "200:       if (state.options.tooltips != false)",
          "201:         CodeMirror.on(cm.getWrapperElement(), \"mouseover\", state.onMouseOver);",
          "203:       startLinting(cm);",
          "204:     }",
          "205:   });",
          "206: });",
          "",
          "---------------"
        ],
        "js/codemirror/addon/lint/sql-lint.js||js/codemirror/addon/lint/sql-lint.js": [
          "File: js/codemirror/addon/lint/sql-lint.js -> js/codemirror/addon/lint/sql-lint.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: CodeMirror.sqlLint = function(text, updateLinting, options, cm) {",
          "4:     if(text.trim() == \"\") {",
          "5:         updateLinting(cm, []);",
          "6:         return;",
          "7:     }",
          "9:     function handleResponse(json) {",
          "10:         response = JSON.parse(json);",
          "12:         var found = [];",
          "13:         for (var idx in response) {",
          "14:             found.push({",
          "15:                 from: CodeMirror.Pos(",
          "16:                     response[idx].fromLine, response[idx].fromColumn",
          "17:                 ),",
          "18:                 to: CodeMirror.Pos(",
          "19:                     response[idx].toLine, response[idx].toColumn",
          "20:                 ),",
          "21:                 message: response[idx].message,",
          "22:                 severity : response[idx].severity",
          "23:             });",
          "24:         }",
          "26:         updateLinting(cm, found);",
          "27:     }",
          "29:     $.ajax({",
          "30:         method: \"POST\",",
          "31:         url: \"lint.php\",",
          "32:         data: {",
          "33:             'sql_query': text",
          "34:         },",
          "35:         success: handleResponse",
          "36:     });",
          "37: }",
          "",
          "---------------"
        ],
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "112:             mode: \"text/x-mysql\",",
          "113:             lineWrapping: true",
          "114:         };",
          "115:         $.extend(true, defaults, options);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "116:         if (CodeMirror.sqlLint) {",
          "117:             $.extend(defaults, {",
          "118:                 gutters: [\"CodeMirror-lint-markers\"],",
          "119:                 lint: {",
          "120:                     \"getAnnotations\": CodeMirror.sqlLint,",
          "121:                     \"async\": true,",
          "122:                 }",
          "123:             });",
          "124:         }",
          "",
          "---------------"
        ],
        "libraries/Header.class.php||libraries/Header.class.php": [
          "File: libraries/Header.class.php -> libraries/Header.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "407:                     $this->_scripts->addFile('codemirror/addon/runmode/runmode.js');",
          "408:                     $this->_scripts->addFile('codemirror/addon/hint/show-hint.js');",
          "409:                     $this->_scripts->addFile('codemirror/addon/hint/sql-hint.js');",
          "410:                 }",
          "411:                 $this->_scripts->addCode(",
          "412:                     'ConsoleEnterExecutes='",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "410:                     if ($GLOBALS['cfg']['LintEnable']) {",
          "411:                         $this->_scripts->addFile('codemirror/addon/lint/lint.js');",
          "412:                         $this->_scripts->addFile('codemirror/addon/lint/sql-lint.js');",
          "413:                     }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "658:                 . $basedir . 'js/codemirror/lib/codemirror.css\" />';",
          "659:             $retval .= '<link rel=\"stylesheet\" type=\"text/css\" href=\"'",
          "660:                 . $basedir . 'js/codemirror/addon/hint/show-hint.css\" />';",
          "661:             $retval .= '<link rel=\"stylesheet\" type=\"text/css\" href=\"'",
          "662:                 . $basedir . 'phpmyadmin.css.php?'",
          "663:                 . 'nocache=' . $theme_id . $GLOBALS['text_dir'] . '\" />';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "665:             $retval .= '<link rel=\"stylesheet\" type=\"text/css\" href=\"'",
          "666:                 . $basedir . 'js/codemirror/addon/lint/lint.css\" />';",
          "",
          "---------------"
        ],
        "libraries/config.default.php||libraries/config.default.php": [
          "File: libraries/config.default.php -> libraries/config.default.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "758: $cfg['CodemirrorEnable'] = true;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "765: $cfg['LintEnable'] = true;",
          "",
          "---------------"
        ],
        "libraries/config/messages.inc.php||libraries/config/messages.inc.php": [
          "File: libraries/config/messages.inc.php -> libraries/config/messages.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "57:     . 'line numbers.'",
          "58: );",
          "59: $strConfigCodemirrorEnable_name = __('Enable CodeMirror');",
          "60: $strConfigMinSizeForInputField_desc = __(",
          "61:     'Defines the minimum size for input fields generated for CHAR and VARCHAR '",
          "62:     . 'columns.'",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "60: $strConfigLintEnable_desc = __('Find any erorors in the query before executing it.'",
          "61:     . 'Requires CodeMirror to be enabled.');",
          "62: $strConfigLintEnable_name = __('Enable linter');",
          "",
          "---------------"
        ],
        "libraries/config/setup.forms.php||libraries/config/setup.forms.php": [
          "File: libraries/config/setup.forms.php -> libraries/config/setup.forms.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "162:     'MaxCharactersInDisplayedSQL',",
          "163:     'RetainQueryBox',",
          "164:     'CodemirrorEnable',",
          "165:     'EnableAutocompleteForTablesAndColumns',",
          "166:     'DefaultForeignKeyChecks');",
          "167: $forms['Sql_queries']['Sql_box'] = array('SQLQuery' => array(",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "165:     'LintEnable',",
          "",
          "---------------"
        ],
        "libraries/config/user_preferences.forms.php||libraries/config/user_preferences.forms.php": [
          "File: libraries/config/user_preferences.forms.php -> libraries/config/user_preferences.forms.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "70:     'MaxCharactersInDisplayedSQL',",
          "71:     'RetainQueryBox',",
          "72:     'CodemirrorEnable',",
          "73:     'EnableAutocompleteForTablesAndColumns',",
          "74:     'DefaultForeignKeyChecks');",
          "75: $forms['Sql_queries']['Sql_box'] = array(",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "73:     'LintEnable',",
          "",
          "---------------"
        ],
        "lint.php||lint.php": [
          "File: lint.php -> lint.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "5: require_once 'libraries/sql-parser/autoload.php';",
          "14: function getLines($str)",
          "15: {",
          "16:     $lines = array(0);",
          "17:     for ($i = 0, $len = strlen($str); $i < $len; ++$i) {",
          "18:         if ($str[$i] === \"\\n\") {",
          "19:             $lines[] = $i;",
          "20:         }",
          "21:     }",
          "22:     return $lines;",
          "23: }",
          "33: function findLineNumberAndColumn($lines, $pos)",
          "34: {",
          "35:     $line = 0;",
          "36:     foreach ($lines as $lineNo => $lineStart) {",
          "37:         if ($lineStart >= $pos) {",
          "38:             break;",
          "39:         }",
          "40:         $line = $lineNo;",
          "41:     }",
          "42:     return array($line, $pos - $lines[$line]);",
          "43: }",
          "52: function linter($query)",
          "53: {",
          "55:     if (strlen($query) > 10000) {",
          "56:         echo json_encode(",
          "57:             array(",
          "58:                 array(",
          "59:                     'message' => 'The linting is disabled for this query because it exceededs the maxmimum length',",
          "60:                     'fromLine' => 0,",
          "61:                     'fromColumn' => 0,",
          "62:                     'toLine' => 0,",
          "63:                     'toColumn' => 0,",
          "64:                     'severity' => 'warning',",
          "65:                 )",
          "66:             )",
          "67:         );",
          "68:         return;",
          "69:     }",
          "76:     $lexer = new SqlParser\\Lexer($query);",
          "83:     $parser = new SqlParser\\Parser($lexer->list);",
          "90:     $errors = SqlParser\\Utils\\Error::get(array($lexer, $parser));",
          "97:     $response = array();",
          "107:     $lines = getLines($query);",
          "110:     foreach ($errors as $idx => $error) {",
          "113:         list($fromLine, $fromColumn) = findLineNumberAndColumn(",
          "114:             $lines, $error[3]",
          "115:         );",
          "118:         list($toLine, $toColumn) = findLineNumberAndColumn(",
          "119:             $lines, $error[3] + strlen($error[2])",
          "120:         );",
          "123:         $response[] = array(",
          "124:             'message' => $error[0] . ' (near ' . $error[2] . ')',",
          "125:             'fromLine' => $fromLine,",
          "126:             'fromColumn' => $fromColumn,",
          "127:             'toLine' => $toLine,",
          "128:             'toColumn' => $toColumn,",
          "129:             'severity' => 'error',",
          "130:         );",
          "131:     }",
          "134:     echo json_encode($response);",
          "135: }",
          "137: linter($_REQUEST['sql_query']);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ed96969ff991005899916f95590761addb38a31c",
      "candidate_info": {
        "commit_hash": "ed96969ff991005899916f95590761addb38a31c",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/ed96969ff991005899916f95590761addb38a31c",
        "files": [
          "import_status.php",
          "js/codemirror/addon/lint/sql-lint.js",
          "js/functions.js",
          "js/normalization.js",
          "libraries/DatabaseInterface.php",
          "libraries/DbSearch.php",
          "libraries/Response.php",
          "libraries/common.inc.php",
          "libraries/core.lib.php",
          "libraries/display_import_ajax.lib.php",
          "libraries/phpseclib/Crypt/AES.php",
          "libraries/phpseclib/Crypt/Base.php",
          "libraries/phpseclib/Crypt/Random.php",
          "libraries/phpseclib/Crypt/Rijndael.php",
          "libraries/session.inc.php",
          "libraries/session.lib.php",
          "libraries/sql-parser/autoload.php",
          "lint.php",
          "normalization.php",
          "setup/frames/form.inc.php",
          "setup/index.php",
          "setup/lib/common.inc.php",
          "setup/validate.php",
          "templates/header_location.phtml",
          "templates/table/search/rows_zoom.phtml",
          "test/libraries/core/PMA_headerLocation_test.php",
          "version_check.php"
        ],
        "message": "Merge branch 'QA_4_5'",
        "before_after_code_files": [
          "import_status.php||import_status.php",
          "js/codemirror/addon/lint/sql-lint.js||js/codemirror/addon/lint/sql-lint.js",
          "js/functions.js||js/functions.js",
          "js/normalization.js||js/normalization.js",
          "libraries/DatabaseInterface.php||libraries/DatabaseInterface.php",
          "libraries/DbSearch.php||libraries/DbSearch.php",
          "libraries/Response.php||libraries/Response.php",
          "libraries/common.inc.php||libraries/common.inc.php",
          "libraries/core.lib.php||libraries/core.lib.php",
          "libraries/display_import_ajax.lib.php||libraries/display_import_ajax.lib.php",
          "libraries/phpseclib/Crypt/AES.php||libraries/phpseclib/Crypt/AES.php",
          "libraries/phpseclib/Crypt/Base.php||libraries/phpseclib/Crypt/Base.php",
          "libraries/phpseclib/Crypt/Random.php||libraries/phpseclib/Crypt/Random.php",
          "libraries/phpseclib/Crypt/Rijndael.php||libraries/phpseclib/Crypt/Rijndael.php",
          "libraries/session.inc.php||libraries/session.inc.php",
          "libraries/session.lib.php||libraries/session.lib.php",
          "libraries/sql-parser/autoload.php||libraries/sql-parser/autoload.php",
          "lint.php||lint.php",
          "normalization.php||normalization.php",
          "setup/frames/form.inc.php||setup/frames/form.inc.php",
          "setup/index.php||setup/index.php",
          "setup/lib/common.inc.php||setup/lib/common.inc.php",
          "setup/validate.php||setup/validate.php",
          "templates/header_location.phtml||templates/header_location.phtml",
          "templates/table/search/rows_zoom.phtml||templates/table/search/rows_zoom.phtml",
          "test/libraries/core/PMA_headerLocation_test.php||test/libraries/core/PMA_headerLocation_test.php",
          "version_check.php||version_check.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "import_status.php||import_status.php",
            "libraries/core.lib.php||libraries/core.lib.php",
            "libraries/display_import_ajax.lib.php||libraries/display_import_ajax.lib.php",
            "lint.php||lint.php",
            "normalization.php||normalization.php",
            "setup/validate.php||setup/validate.php",
            "version_check.php||version_check.php"
          ],
          "candidate": [
            "import_status.php||import_status.php",
            "libraries/core.lib.php||libraries/core.lib.php",
            "libraries/display_import_ajax.lib.php||libraries/display_import_ajax.lib.php",
            "lint.php||lint.php",
            "normalization.php||normalization.php",
            "setup/validate.php||setup/validate.php",
            "version_check.php||version_check.php"
          ]
        }
      },
      "candidate_diff": {
        "import_status.php||import_status.php": [
          "File: import_status.php -> import_status.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "79: }",
          "86: if (isset($_GET[\"message\"]) && $_GET[\"message\"]) {",
          "88:     header('Content-type: text/html');",
          "",
          "[Removed Lines]",
          "83: PMA_noCacheHeader();",
          "",
          "[Added Lines]",
          "86:     PMA_noCacheHeader();",
          "",
          "---------------"
        ],
        "js/codemirror/addon/lint/sql-lint.js||js/codemirror/addon/lint/sql-lint.js": [
          "File: js/codemirror/addon/lint/sql-lint.js -> js/codemirror/addon/lint/sql-lint.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "6:         return;",
          "7:     }",
          "12:         var found = [];",
          "13:         for (var idx in response) {",
          "14:             found.push({",
          "",
          "[Removed Lines]",
          "9:     function handleResponse(json) {",
          "10:         response = JSON.parse(json);",
          "",
          "[Added Lines]",
          "9:     function handleResponse(response) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "29:     $.ajax({",
          "30:         method: \"POST\",",
          "31:         url: \"lint.php\",",
          "32:         data: {",
          "33:             sql_query: text,",
          "34:             token: PMA_commonParams.get('token'),",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "30:         dataType: 'json',",
          "",
          "---------------"
        ],
        "js/functions.js||js/functions.js": [
          "File: js/functions.js -> js/functions.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "425:     var passwordlength = 16;    // do we want that to be dynamic?  no, keep it simple :)",
          "426:     var passwd = passwd_form.generated_pw;",
          "427:     passwd.value = '';",
          "429:     for (var i = 0; i < passwordlength; i++) {",
          "431:     }",
          "432:     passwd_form.text_pma_pw.value = passwd.value;",
          "433:     passwd_form.text_pma_pw2.value = passwd.value;",
          "434:     return true;",
          "",
          "[Removed Lines]",
          "424:     var pwchars = \"abcdefhjmnpqrstuvwxyz23456789ABCDEFGHJKLMNPQRSTUVWYXZ\";",
          "430:         passwd.value += pwchars.charAt(Math.floor(Math.random() * pwchars.length));",
          "",
          "[Added Lines]",
          "424:     var pwchars = \"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWYXZ\";",
          "427:     var randomWords = new Int32Array(passwordlength);",
          "432:     if (window.crypto && window.crypto.getRandomValues) {",
          "433:         window.crypto.getRandomValues(randomWords);",
          "434:     }",
          "436:     else if (window.msCrypto && window.msCrypto.getRandomValues) {",
          "437:         window.msCrypto.getRandomValues(randomWords);",
          "438:     } else {",
          "440:         for (var i = 0; i < passwordlength; i++) {",
          "441:             randomWords[i] = Math.floor(Math.random() * pwchars.length);",
          "442:         }",
          "443:     }",
          "446:         passwd.value += pwchars.charAt(Math.abs(randomWords[i]) % pwchars.length);",
          "",
          "---------------"
        ],
        "js/normalization.js||js/normalization.js": [
          "File: js/normalization.js -> js/normalization.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "102:     }",
          "103:     $(\"#mainContent legend\").html(PMA_messages.strEndStep);",
          "104:     $(\"#mainContent h4\").html(",
          "106:     );",
          "107:     $(\"#mainContent p\").html('');",
          "108:     $(\"#mainContent #extra\").html('');",
          "",
          "[Removed Lines]",
          "105:         \"<h3>\" + PMA_sprintf(PMA_messages.strFinishMsg, PMA_commonParams.get('table')) + \"</h3>\"",
          "",
          "[Added Lines]",
          "105:         \"<h3>\" + PMA_sprintf(PMA_messages.strFinishMsg, escapeHtml(PMA_commonParams.get('table'))) + \"</h3>\"",
          "",
          "---------------"
        ],
        "libraries/DatabaseInterface.php||libraries/DatabaseInterface.php": [
          "File: libraries/DatabaseInterface.php -> libraries/DatabaseInterface.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1516:                     5",
          "1517:                 );",
          "1518:             }",
          "1520:                 \"SET collation_connection = '\"",
          "1522:                 . \"';\",",
          "1523:                 $link,",
          "1524:                 self::QUERY_STORE",
          "1525:             );",
          "1526:         } else {",
          "1527:             $this->query(",
          "1528:                 \"SET NAMES '$default_charset' COLLATE '$default_collation';\",",
          "",
          "[Removed Lines]",
          "1519:             $this->query(",
          "1521:                 . Util::sqlAddSlashes($GLOBALS['collation_connection'])",
          "",
          "[Added Lines]",
          "1519:             $result = $this->tryQuery(",
          "1521:                 . PMA_Util::sqlAddSlashes($GLOBALS['collation_connection'])",
          "1526:             if ($result === false) {",
          "1527:                 trigger_error(",
          "1528:                     __('Failed to set configured collation connection!'),",
          "1529:                     E_USER_WARNING",
          "1530:                 );",
          "1531:                 $this->query(",
          "1532:                     \"SET collation_connection = '\"",
          "1533:                     . PMA_Util::sqlAddSlashes($default_collation)",
          "1534:                     . \"';\",",
          "1535:                     $link,",
          "1536:                     self::QUERY_STORE",
          "1537:                 );",
          "1538:             }",
          "",
          "---------------"
        ],
        "libraries/DbSearch.php||libraries/DbSearch.php": [
          "File: libraries/DbSearch.php -> libraries/DbSearch.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "339:             $browse_result_path = 'sql.php' . PMA_URL_getCommon($this_url_params);",
          "340:             $html_output .= '<td><a name=\"browse_search\" class=\"ajax\" href=\"'",
          "341:                 . $browse_result_path . '\" onclick=\"loadResult(\\''",
          "343:                 . PMA_URL_getCommon(",
          "344:                     array(",
          "345:                         'db' => $GLOBALS['db'], 'table' => $each_table",
          "",
          "[Removed Lines]",
          "342:                 . $browse_result_path . '\\',\\'' . $each_table . '\\',\\''",
          "",
          "[Added Lines]",
          "342:                 . $browse_result_path . '\\',\\''",
          "343:                 . PMA_escapeJsString(htmlspecialchars($each_table)) . '\\',\\''",
          "",
          "---------------"
        ],
        "libraries/Response.php||libraries/Response.php": [
          "File: libraries/Response.php -> libraries/Response.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "370:         echo json_encode($this->_JSON);",
          "371:     }",
          "",
          "[Removed Lines]",
          "365:         if (! defined('TESTSUITE')) {",
          "366:             header('Cache-Control: no-cache');",
          "367:             header('Content-Type: application/json');",
          "368:         }",
          "",
          "[Added Lines]",
          "365:         PMA_headerJSON();",
          "",
          "---------------"
        ],
        "libraries/common.inc.php||libraries/common.inc.php": [
          "File: libraries/common.inc.php -> libraries/common.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "103: require './libraries/relation.lib.php';",
          "",
          "[Removed Lines]",
          "105: if (! defined('PMA_MINIMUM_COMMON')) {",
          "",
          "[Added Lines]",
          "105: if (! defined('PMA_MINIMUM_COMMON') || defined('PMA_SETUP')) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "174: $__redirect = null;",
          "178:     $subform_id = key($_POST['usesubform']);",
          "",
          "[Removed Lines]",
          "175: if (isset($_POST['usesubform'])) {",
          "",
          "[Added Lines]",
          "174: if (isset($_POST['usesubform']) && ! defined('PMA_MINIMUM_COMMON')) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "253: if ($GLOBALS['PMA_Config']->get('ForceSSL')",
          "254:     && ! $GLOBALS['PMA_Config']->detectHttps()",
          "255: ) {",
          "257:     $url = $GLOBALS['PMA_Config']->getSSLUri();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "255:     require './libraries/select_lang.lib.php';",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "386: $token_provided = false;",
          "387: if (PMA_isValid($_REQUEST['token'])) {",
          "388:     $token_provided = true;",
          "390: }",
          "392: if ($token_mismatch) {",
          "",
          "[Removed Lines]",
          "389:     $token_mismatch = ($_SESSION[' PMA_token '] != $_REQUEST['token']);",
          "",
          "[Added Lines]",
          "389:     $token_mismatch = ! hash_equals($_SESSION[' PMA_token '], $_REQUEST['token']);",
          "",
          "---------------"
        ],
        "libraries/core.lib.php||libraries/core.lib.php": [
          "File: libraries/core.lib.php -> libraries/core.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "530:     }",
          "531: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "538: function PMA_headerJSON()",
          "539: {",
          "540:     if (defined('TESTSUITE') && ! defined('PMA_TEST_HEADERS')) {",
          "541:         return;",
          "542:     }",
          "544:     PMA_noCacheHeader();",
          "546:     header('Content-Type: application/json; charset=UTF-8');",
          "550:     header('X-Content-Type-Options: nosniff');",
          "551: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "946:         PMA_warnMissingExtension('json', true);",
          "947:     }",
          "948: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "971: if(! function_exists('hash_equals')) {",
          "972:     function hash_equals($a, $b) {",
          "973:         $ret = strlen($a) ^ strlen($b);",
          "974:         $ret |= array_sum(unpack(\"C*\", $a ^ $b));",
          "975:         return ! $ret;",
          "976:     }",
          "977: }",
          "",
          "---------------"
        ],
        "libraries/display_import_ajax.lib.php||libraries/display_import_ajax.lib.php": [
          "File: libraries/display_import_ajax.lib.php -> libraries/display_import_ajax.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "131: function PMA_importAjaxStatus($id)",
          "132: {",
          "134:     echo json_encode(",
          "135:         $_SESSION[$GLOBALS['SESSION_KEY']]['handler']::getUploadStatus($id)",
          "136:     );",
          "",
          "[Removed Lines]",
          "133:     header('Content-type: application/json');",
          "",
          "[Added Lines]",
          "133:     PMA_headerJSON();",
          "",
          "---------------"
        ],
        "libraries/phpseclib/Crypt/AES.php||libraries/phpseclib/Crypt/AES.php": [
          "File: libraries/phpseclib/Crypt/AES.php -> libraries/phpseclib/Crypt/AES.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "50: namespace phpseclib\\Crypt;",
          "52: use phpseclib\\Crypt\\Rijndael;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "51: if (! defined('PHPMYADMIN')) {",
          "52:     exit;",
          "53: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "114:             $length = strlen($key);",
          "115:             switch (true) {",
          "116:                 case $length <= 16:",
          "118:                     break;",
          "119:                 case $length <= 24:",
          "121:                     break;",
          "122:                 default:",
          "124:             }",
          "125:             $this->_setEngine();",
          "126:         }",
          "",
          "[Removed Lines]",
          "117:                     $this->key_size = 16;",
          "120:                     $this->key_size = 24;",
          "123:                     $this->key_size = 32;",
          "",
          "[Added Lines]",
          "120:                     $this->key_length = 16;",
          "123:                     $this->key_length = 24;",
          "126:                     $this->key_length = 32;",
          "",
          "---------------"
        ],
        "libraries/phpseclib/Crypt/Base.php||libraries/phpseclib/Crypt/Base.php": [
          "File: libraries/phpseclib/Crypt/Base.php -> libraries/phpseclib/Crypt/Base.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "379:     var $cipher_name_openssl_ecb;",
          "397:     var $password_default_salt = 'phpseclib/salt';",
          "",
          "[Removed Lines]",
          "388:     var $password_key_size = 32;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "441:     var $openssl_options;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "441:     var $explicit_key_length = false;",
          "450:     var $skip_key_adjustment = false;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "512:         $this->changed = true;",
          "513:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "530:     function setKeyLength($length)",
          "531:     {",
          "532:         $this->explicit_key_length = true;",
          "533:         $this->changed = true;",
          "534:         $this->_setEngine();",
          "535:     }",
          "543:     function getKeyLength()",
          "544:     {",
          "545:         return $this->key_length << 3;",
          "546:     }",
          "554:     function getBlockLength()",
          "555:     {",
          "556:         return $this->block_size << 3;",
          "557:     }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "529:     function setKey($key)",
          "530:     {",
          "531:         $this->key = $key;",
          "532:         $this->changed = true;",
          "533:         $this->_setEngine();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "575:         if (!$this->explicit_key_length) {",
          "576:             $this->setKeyLength(strlen($key) << 3);",
          "577:             $this->explicit_key_length = false;",
          "578:         }",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "571:                 if (isset($func_args[5])) {",
          "572:                     $dkLen = $func_args[5];",
          "573:                 } else {",
          "575:                 }",
          "577:                 switch (true) {",
          "",
          "[Removed Lines]",
          "574:                     $dkLen = $method == 'pbkdf1' ? 2 * $this->password_key_size : $this->password_key_size;",
          "",
          "[Added Lines]",
          "623:                     $dkLen = $method == 'pbkdf1' ? 2 * $this->key_length : $this->key_length;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "914:                 if ($this->continuousBuffer) {",
          "915:                     $this->encryptIV = $xor;",
          "916:                     if ($start = strlen($plaintext) % $block_size) {",
          "918:                     }",
          "919:                 }",
          "920:                 break;",
          "",
          "[Removed Lines]",
          "917:                          $buffer['xor'] = substr($key, $start) . $buffer['xor'];",
          "",
          "[Added Lines]",
          "966:                         $buffer['xor'] = substr($key, $start) . $buffer['xor'];",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1204:                 if ($this->continuousBuffer) {",
          "1205:                     $this->decryptIV = $xor;",
          "1206:                     if ($start = strlen($ciphertext) % $block_size) {",
          "1208:                     }",
          "1209:                 }",
          "1210:                 break;",
          "",
          "[Removed Lines]",
          "1207:                          $buffer['xor'] = substr($key, $start) . $buffer['xor'];",
          "",
          "[Added Lines]",
          "1256:                         $buffer['xor'] = substr($key, $start) . $buffer['xor'];",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1834:         $this->encryptIV = $this->decryptIV = str_pad(substr($this->iv, 0, $this->block_size), $this->block_size, \"\\0\");",
          "1835:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1884:         if (!$this->skip_key_adjustment) {",
          "1885:             $this->key = str_pad(substr($this->key, 0, $this->key_length), $this->key_length, \"\\0\");",
          "1886:         }",
          "",
          "---------------"
        ],
        "libraries/phpseclib/Crypt/Random.php||libraries/phpseclib/Crypt/Random.php": [
          "File: libraries/phpseclib/Crypt/Random.php -> libraries/phpseclib/Crypt/Random.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "55:     {",
          "56:         if (strtoupper(substr(PHP_OS, 0, 3)) === 'WIN') {",
          "60:                 return mcrypt_create_iv($length);",
          "61:             }",
          "",
          "[Removed Lines]",
          "54:     public static function string($length)",
          "59:             if (function_exists('mcrypt_create_iv') && function_exists('class_alias')) {",
          "",
          "[Added Lines]",
          "54:     static function string($length)",
          "56:         if (version_compare(PHP_VERSION, '7.0.0', '>=')) {",
          "57:             try {",
          "58:                 return \\random_bytes($length);",
          "59:             } catch (\\Throwable $e) {",
          "66:             }",
          "67:         }",
          "72:             if (extension_loaded('mcrypt') && function_exists('class_alias')) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "76:                 return openssl_random_pseudo_bytes($length);",
          "77:             }",
          "78:         } else {",
          "81:                 return openssl_random_pseudo_bytes($length);",
          "82:             }",
          "",
          "[Removed Lines]",
          "75:             if (function_exists('openssl_random_pseudo_bytes') && version_compare(PHP_VERSION, '5.3.4', '>=')) {",
          "80:             if (function_exists('openssl_random_pseudo_bytes')) {",
          "",
          "[Added Lines]",
          "88:             if (extension_loaded('openssl') && version_compare(PHP_VERSION, '5.3.4', '>=')) {",
          "93:             if (extension_loaded('openssl')) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "99:                 return mcrypt_create_iv($length, MCRYPT_DEV_URANDOM);",
          "100:             }",
          "101:         }",
          "",
          "[Removed Lines]",
          "98:             if (function_exists('mcrypt_create_iv')) {",
          "",
          "[Added Lines]",
          "111:             if (extension_loaded('mcrypt')) {",
          "",
          "---------------"
        ],
        "libraries/phpseclib/Crypt/Rijndael.php||libraries/phpseclib/Crypt/Rijndael.php": [
          "File: libraries/phpseclib/Crypt/Rijndael.php -> libraries/phpseclib/Crypt/Rijndael.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "55: namespace phpseclib\\Crypt;",
          "57: use phpseclib\\Crypt\\Base;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "56: if (! defined('PHPMYADMIN')) {",
          "57:     exit;",
          "58: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "66: class Rijndael extends Base",
          "67: {",
          "92:     var $cipher_name_mcrypt = 'rijndael-128';",
          "",
          "[Removed Lines]",
          "76:     var $password_key_size = 16;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "102:     var $password_default_salt = 'phpseclib';",
          "120:     var $w;",
          "",
          "[Removed Lines]",
          "111:     var $explicit_key_length = false;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "142:     var $Nb = 4;",
          "",
          "[Removed Lines]",
          "155:     var $key_size = 16;",
          "",
          "[Added Lines]",
          "139:     var $key_length = 16;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "190:     var $kl;",
          "",
          "[Removed Lines]",
          "232:     function setKey($key)",
          "233:     {",
          "234:         if (!$this->explicit_key_length) {",
          "235:             $length = strlen($key);",
          "236:             switch (true) {",
          "237:                 case $length <= 16:",
          "238:                     $this->key_size = 16;",
          "239:                     break;",
          "240:                 case $length <= 20:",
          "241:                     $this->key_size = 20;",
          "242:                     break;",
          "243:                 case $length <= 24:",
          "244:                     $this->key_size = 24;",
          "245:                     break;",
          "246:                 case $length <= 28:",
          "247:                     $this->key_size = 28;",
          "248:                     break;",
          "249:                 default:",
          "250:                     $this->key_size = 32;",
          "251:             }",
          "252:         }",
          "253:         parent::setKey($key);",
          "254:     }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "276:     function setKeyLength($length)",
          "277:     {",
          "278:         switch (true) {",
          "285:             case $length <= 128:",
          "287:                 break;",
          "288:             case $length <= 192:",
          "290:                 break;",
          "291:             default:",
          "293:         }",
          "298:     }",
          "",
          "[Removed Lines]",
          "279:             case $length == 160:",
          "280:                 $this->key_size = 20;",
          "281:                 break;",
          "282:             case $length == 224:",
          "283:                 $this->key_size = 28;",
          "284:                 break;",
          "286:                 $this->key_size = 16;",
          "289:                 $this->key_size = 24;",
          "292:                 $this->key_size = 32;",
          "295:         $this->explicit_key_length = true;",
          "296:         $this->changed = true;",
          "297:         $this->_setEngine();",
          "",
          "[Added Lines]",
          "200:                 $this->key_length = 16;",
          "201:                 break;",
          "202:             case $length <= 160:",
          "203:                 $this->key_length = 20;",
          "206:                 $this->key_length = 24;",
          "207:                 break;",
          "208:             case $length <= 224:",
          "209:                 $this->key_length = 28;",
          "212:                 $this->key_length = 32;",
          "215:         parent::setKeyLength($length);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "337:                 if ($this->block_size != 16) {",
          "338:                     return false;",
          "339:                 }",
          "342:                 break;",
          "343:             case self::ENGINE_MCRYPT:",
          "344:                 $this->cipher_name_mcrypt = 'rijndael-' . ($this->block_size << 3);",
          "347:                     return false;",
          "348:                 }",
          "",
          "[Removed Lines]",
          "340:                 $this->cipher_name_openssl_ecb = 'aes-' . ($this->key_size << 3) . '-ecb';",
          "341:                 $this->cipher_name_openssl = 'aes-' . ($this->key_size << 3) . '-' . $this->_openssl_translate_mode();",
          "345:                 if ($this->key_size % 8) { // is it a 160/224-bit key?",
          "",
          "[Added Lines]",
          "258:                 $this->cipher_name_openssl_ecb = 'aes-' . ($this->key_length << 3) . '-ecb';",
          "259:                 $this->cipher_name_openssl = 'aes-' . ($this->key_length << 3) . '-' . $this->_openssl_translate_mode();",
          "263:                 if ($this->key_length % 8) { // is it a 160/224-bit key?",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "351:         return parent::isValidEngine($engine);",
          "352:     }",
          "373:     function _encryptBlock($in)",
          "374:     {",
          "",
          "[Removed Lines]",
          "360:     function _setupMcrypt()",
          "361:     {",
          "362:         $this->key = str_pad(substr($this->key, 0, $this->key_size), $this->key_size, \"\\0\");",
          "363:         parent::_setupMcrypt();",
          "364:     }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "573:             0x7D000000, 0xFA000000, 0xEF000000, 0xC5000000, 0x91000000",
          "574:         );",
          "580:             return;",
          "581:         }",
          "586:         $this->Nr = max($this->Nk, $this->Nb) + 6;",
          "",
          "[Removed Lines]",
          "576:         $this->key = str_pad(substr($this->key, 0, $this->key_size), $this->key_size, \"\\0\");",
          "578:         if (isset($this->kl['key']) && $this->key === $this->kl['key'] && $this->key_size === $this->kl['key_size'] && $this->block_size === $this->kl['block_size']) {",
          "582:         $this->kl = array('key' => $this->key, 'key_size' => $this->key_size, 'block_size' => $this->block_size);",
          "584:         $this->Nk = $this->key_size >> 2;",
          "",
          "[Added Lines]",
          "482:         if (isset($this->kl['key']) && $this->key === $this->kl['key'] && $this->key_length === $this->kl['key_length'] && $this->block_size === $this->kl['block_size']) {",
          "486:         $this->kl = array('key' => $this->key, 'key_length' => $this->key_length, 'block_size' => $this->block_size);",
          "488:         $this->Nk = $this->key_length >> 2;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "678:     function _subWord($word)",
          "679:     {",
          "680:         static $sbox;",
          "681:         if (empty($sbox)) {",
          "683:         }",
          "685:         return  $sbox[$word       & 0x000000FF]        |",
          "",
          "[Removed Lines]",
          "682:             list(,,,, $sbox) = $this->_getTables();",
          "",
          "[Added Lines]",
          "586:             list(, , , , $sbox) = $this->_getTables();",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "884:         $code_hash = \"Crypt_Rijndael, {$this->mode}, {$this->Nr}, {$this->Nb}\";",
          "",
          "[Removed Lines]",
          "881:         $gen_hi_opt_code = (bool)( count($lambda_functions) < 10 );",
          "",
          "[Added Lines]",
          "785:         $gen_hi_opt_code = (bool)(count($lambda_functions) < 10);",
          "",
          "---------------"
        ],
        "libraries/session.inc.php||libraries/session.inc.php": [
          "File: libraries/session.inc.php -> libraries/session.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "13:     exit;",
          "14: }",
          "18: if (!@function_exists('session_name')) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "16: require PHPSECLIB_INC_DIR . '/Crypt/Random.php';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "113: if (! isset($_SESSION[' PMA_token '])) {",
          "115: }",
          "",
          "[Removed Lines]",
          "114:     $_SESSION[' PMA_token '] = md5(uniqid(rand(), true));",
          "117: require_once 'libraries/session.lib.php';",
          "",
          "[Added Lines]",
          "116:     $_SESSION[' PMA_token '] = bin2hex(phpseclib\\Crypt\\Random::string(16));",
          "",
          "---------------"
        ],
        "libraries/session.lib.php||libraries/session.lib.php": [
          "File: libraries/session.lib.php -> libraries/session.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "22:     ) {",
          "23:         session_regenerate_id(true);",
          "24:     }",
          "26: }",
          "",
          "[Removed Lines]",
          "25:     $_SESSION[' PMA_token '] = md5(uniqid(rand(), true));",
          "",
          "[Added Lines]",
          "25:     $_SESSION[' PMA_token '] = bin2hex(phpseclib\\Crypt\\Random::string(16));",
          "",
          "---------------"
        ],
        "libraries/sql-parser/autoload.php||libraries/sql-parser/autoload.php": [
          "File: libraries/sql-parser/autoload.php -> libraries/sql-parser/autoload.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: namespace SqlParser\\Autoload;",
          "16: if (!class_exists('SqlParser\\\\Autoload\\\\ClassLoader')) {",
          "17:     include_once './libraries/sql-parser/ClassLoader.php';",
          "18: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "17:     if (! file_exists('./libraries/sql-parser/ClassLoader.php')) {",
          "18:         die('Invalid invocation');",
          "19:     }",
          "",
          "---------------"
        ],
        "lint.php||lint.php": [
          "File: lint.php -> lint.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "27: $sql_query = !empty($_POST['sql_query']) ? $_POST['sql_query'] : '';",
          "33: echo json_encode(Linter::lint($sql_query));",
          "",
          "[Removed Lines]",
          "30: $response = PMA\\libraries\\Response::getInstance();",
          "31: $response->disable();",
          "",
          "[Added Lines]",
          "30: PMA\\libraries\\Response::getInstance()->disable();",
          "32: PMA_headerJSON();",
          "",
          "---------------"
        ],
        "normalization.php||normalization.php": [
          "File: normalization.php -> normalization.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "59:     $dependencies = json_decode($_REQUEST['pd']);",
          "60:     $tables = json_decode($_REQUEST['tables']);",
          "61:     $newTables = PMA_getHtmlForNewTables3NF($dependencies, $tables, $db);",
          "62:     echo json_encode($newTables);",
          "63:     exit;",
          "64: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "62:     PMA_Response::getInstance()->disable();",
          "63:     PMA_headerJSON();",
          "",
          "---------------"
        ],
        "setup/frames/form.inc.php||setup/frames/form.inc.php": [
          "File: setup/frames/form.inc.php -> setup/frames/form.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: require './libraries/config/setup.forms.php';",
          "23: $mode = isset($_GET['mode']) ? $_GET['mode'] : null;",
          "25:     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php!'));",
          "26: }",
          "",
          "[Removed Lines]",
          "22: $formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;",
          "24: if (! isset($forms[$formset_id])) {",
          "",
          "[Added Lines]",
          "22: $formset_id = PMA_isValid($_GET['formset'], 'scalar') ? $_GET['formset'] : null;",
          "24: if (! isset($forms[$formset_id]) || substr($formset_id, 0, 1) === '_') {",
          "",
          "---------------"
        ],
        "setup/index.php||setup/index.php": [
          "File: setup/index.php -> setup/index.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: require './lib/common.inc.php';",
          "16: $page = preg_replace('/[^a-z]/', '', $page);",
          "17: if ($page === '') {",
          "18:     $page = 'index';",
          "",
          "[Removed Lines]",
          "15: $page = isset($_GET['page']) ? $_GET['page'] : null;",
          "",
          "[Added Lines]",
          "15: $page = PMA_isValid($_GET['page'], 'scalar') ? $_GET['page'] : null;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "23: }",
          "27: $action_done = preg_replace('/[^a-z_]/', '', $action_done);",
          "29: PMA_noCacheHeader();",
          "",
          "[Removed Lines]",
          "26: $action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;",
          "",
          "[Added Lines]",
          "26: $action_done = PMA_isValid($_GET['action_done'], 'scalar') ? $_GET['action_done'] : null;",
          "",
          "---------------"
        ],
        "setup/lib/common.inc.php||setup/lib/common.inc.php": [
          "File: setup/lib/common.inc.php -> setup/lib/common.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "16: chdir('..');",
          "18: if (!file_exists('./libraries/common.inc.php')) {",
          "20: }",
          "22: require_once './libraries/common.inc.php';",
          "",
          "[Removed Lines]",
          "19:     PMA_fatalError('Bad invocation!');",
          "",
          "[Added Lines]",
          "19:     die('Bad invocation!');",
          "",
          "---------------"
        ],
        "setup/validate.php||setup/validate.php": [
          "File: setup/validate.php -> setup/validate.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: $validators = array();",
          "15: require './libraries/config/Validator.php';",
          "20: $vids = explode(',', $ids);",
          "22: $values = json_decode($vals);",
          "23: if (!($values instanceof stdClass)) {",
          "24:     PMA_fatalError(__('Wrong data'));",
          "",
          "[Removed Lines]",
          "17: header('Content-type: application/json');",
          "19: $ids = isset($_POST['id']) ? $_POST['id'] : null;",
          "21: $vals = isset($_POST['values']) ? $_POST['values'] : null;",
          "",
          "[Added Lines]",
          "17: PMA_headerJSON();",
          "19: $ids = PMA_isValid($_POST['id'], 'scalar') ? $_POST['id'] : null;",
          "21: $vals = PMA_isValid($_POST['values'], 'scalar') ? $_POST['values'] : null;",
          "",
          "---------------"
        ],
        "templates/header_location.phtml||templates/header_location.phtml": [
          "File: templates/header_location.phtml -> templates/header_location.phtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: <body>",
          "26: <script type=\"text/javascript\">",
          "30: </script>",
          "31: </body>",
          "",
          "[Removed Lines]",
          "28:     document.write('<p><a href=\"<?= htmlspecialchars($uri) ?>\"><?= __('Go') ?></a></p>');",
          "32: </html>",
          "",
          "[Added Lines]",
          "28:     document.write('<p><a href=\"<?= PMA_escapeJsString(htmlspecialchars($uri)) ?>\"><?php echo __('Go') ?></a></p>');",
          "",
          "---------------"
        ],
        "templates/table/search/rows_zoom.phtml||templates/table/search/rows_zoom.phtml": [
          "File: templates/table/search/rows_zoom.phtml -> templates/table/search/rows_zoom.phtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "56:         } ?>",
          "57:         <!-- Column type -->",
          "58:         <td dir=\"ltr\">",
          "60:         </td>",
          "61:         <!-- Column Collation -->",
          "62:         <td>",
          "",
          "[Removed Lines]",
          "59:             <?= (isset($type[$i]) ? $type[$i] : ''); ?>",
          "",
          "[Added Lines]",
          "59:             <?= (isset($type[$i]) ? htmlspecialchars($type[$i]) : ''); ?>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "68:         </td>",
          "69:         <!-- Inputbox for search criteria value -->",
          "70:         <td>",
          "72:         </td>",
          "73:     </tr>",
          "74:     <!-- Displays hidden fields -->",
          "",
          "[Removed Lines]",
          "71:             <?= (isset($value[$i]) ? $value[$i] : ''); ?>",
          "",
          "[Added Lines]",
          "71:             <?= (isset($value[$i]) ? htmlspecialchars($value[$i]) : ''); ?>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "85:                    id=\"collations_<?= $i; ?>\" />",
          "86:         </td>",
          "87:     </tr>",
          "",
          "[Removed Lines]",
          "88: <?php endfor; ?>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/libraries/core/PMA_headerLocation_test.php||test/libraries/core/PMA_headerLocation_test.php": [
          "File: test/libraries/core/PMA_headerLocation_test.php -> test/libraries/core/PMA_headerLocation_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "267: <body><script type=\\\"text/javascript\\\">//<![CDATA[",
          "268:     document.write('<p><a href=\\\"\" . $testUri_html . \"\\\">\" . __('Go') . \"</a></p>');",
          "271:         $this->expectOutputString($header);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "270: \";",
          "",
          "---------------"
        ],
        "version_check.php||version_check.php": [
          "File: version_check.php -> version_check.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: require_once 'libraries/VersionInformation.php';",
          "19: $versionInformation = new VersionInformation();",
          "20: $versionDetails = $versionInformation->getLatestVersion();",
          "",
          "[Removed Lines]",
          "17: header('Content-type: application/json; charset=UTF-8');",
          "",
          "[Added Lines]",
          "17: PMA_headerJSON();",
          "",
          "---------------"
        ]
      }
    }
  ]
}