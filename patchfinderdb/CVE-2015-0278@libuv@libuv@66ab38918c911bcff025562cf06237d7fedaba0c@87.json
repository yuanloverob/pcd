{
  "cve_id": "CVE-2015-0278",
  "cve_desc": "libuv before 0.10.34 does not properly drop group privileges, which allows context-dependent attackers to gain privileges via unspecified vectors.",
  "repo": "libuv/libuv",
  "patch_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
  "patch_info": {
    "commit_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
    "repo": "libuv/libuv",
    "commit_url": "https://github.com/libuv/libuv/commit/66ab38918c911bcff025562cf06237d7fedaba0c",
    "files": [
      "src/unix/process.c"
    ],
    "message": "unix: call setgoups before calling setuid/setgid\n\nPartial fix for #1093",
    "before_after_code_files": [
      "src/unix/process.c||src/unix/process.c"
    ]
  },
  "patch_diff": {
    "src/unix/process.c||src/unix/process.c": [
      "File: src/unix/process.c -> src/unix/process.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "330:     _exit(127);",
      "331:   }",
      "333:   if ((options->flags & UV_PROCESS_SETGID) && setgid(options->gid)) {",
      "334:     uv__write_int(error_fd, -errno);",
      "335:     perror(\"setgid()\");",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "333:   if (options->flags & (UV_PROCESS_SETUID | UV_PROCESS_SETGID)) {",
      "341:     SAVE_ERRNO(setgroups(0, NULL));",
      "342:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "234b1e046bd398d12526776ad074d145eb0c0f8f",
      "candidate_info": {
        "commit_hash": "234b1e046bd398d12526776ad074d145eb0c0f8f",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/234b1e046bd398d12526776ad074d145eb0c0f8f",
        "files": [
          "uv.gyp"
        ],
        "message": "build, gyp: set xcode flags",
        "before_after_code_files": [
          "uv.gyp||uv.gyp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "uv.gyp||uv.gyp": [
          "File: uv.gyp -> uv.gyp",
          "--- Hunk 1 ---",
          "[Context before]",
          "26:         ],",
          "27:       }],",
          "28:     ],",
          "29:   },",
          "31:   'targets': [",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29:     'xcode_settings': {",
          "30:         'conditions': [",
          "31:           [ 'clang==1', {",
          "32:             'WARNING_CFLAGS': [",
          "33:               '-Wall',",
          "34:               '-Wextra',",
          "35:               '-Wno-unused-parameter',",
          "36:               '-Wno-dollar-in-identifier-extension'",
          "37:             ]}, {",
          "38:            'WARNING_CFLAGS': [",
          "39:              '-Wall',",
          "40:              '-Wextra',",
          "41:              '-Wno-unused-parameter'",
          "42:           ]}",
          "43:         ]",
          "44:       ],",
          "45:       'OTHER_LDFLAGS': [",
          "46:       ],",
          "47:       'OTHER_CFLAGS': [",
          "48:         '-g',",
          "49:         '--std=gnu89',",
          "50:         '-pedantic'",
          "51:       ],",
          "52:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "cf7b81230ba2d65c319db15a658eee984ca10ed4",
      "candidate_info": {
        "commit_hash": "cf7b81230ba2d65c319db15a658eee984ca10ed4",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/cf7b81230ba2d65c319db15a658eee984ca10ed4",
        "files": [
          "Makefile.am"
        ],
        "message": "build: add pthread-fixes.c to Makefile.am on Android",
        "before_after_code_files": [
          "Makefile.am||Makefile.am"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Makefile.am||Makefile.am": [
          "File: Makefile.am -> Makefile.am",
          "--- Hunk 1 ---",
          "[Context before]",
          "242: endif",
          "244: if ANDROID",
          "247: endif",
          "249: if DARWIN",
          "",
          "[Removed Lines]",
          "245: include_HEADERS += include/android-ifaddrs.h",
          "246: libuv_la_SOURCES += src/unix/android-ifaddrs.c",
          "",
          "[Added Lines]",
          "245: include_HEADERS += include/android-ifaddrs.h \\",
          "246:                    include/pthread-fixes.h",
          "247: libuv_la_SOURCES += src/unix/android-ifaddrs.c \\",
          "248:                     src/unix/pthread-fixes.c",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "32597100b81a03cc827c164ca8250fba91599593",
      "candidate_info": {
        "commit_hash": "32597100b81a03cc827c164ca8250fba91599593",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/32597100b81a03cc827c164ca8250fba91599593",
        "files": [
          "include/uv.h"
        ],
        "message": "thread: add uv_thread_cb typedef\n\nTo keep with convention, add a typedef for the function called that\ninitializes the new thread.\n\nSigned-off-by: Fedor Indutny <fedor@indutny.com>",
        "before_after_code_files": [
          "include/uv.h||include/uv.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/uv.h||include/uv.h": [
          "File: include/uv.h -> include/uv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "2204: UV_EXTERN void* uv_key_get(uv_key_t* key);",
          "2205: UV_EXTERN void uv_key_set(uv_key_t* key, void* value);",
          "2209: UV_EXTERN unsigned long uv_thread_self(void);",
          "2210: UV_EXTERN int uv_thread_join(uv_thread_t *tid);",
          "",
          "[Removed Lines]",
          "2207: UV_EXTERN int uv_thread_create(uv_thread_t *tid,",
          "2208:     void (*entry)(void *arg), void *arg);",
          "",
          "[Added Lines]",
          "2212: typedef void (*uv_thread_cb)(void* arg);",
          "2214: UV_EXTERN int uv_thread_create(uv_thread_t* tid, uv_thread_cb entry, void* arg);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "94e628faf12c83b4433f6f49bf10eda16a141b91",
      "candidate_info": {
        "commit_hash": "94e628faf12c83b4433f6f49bf10eda16a141b91",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/94e628faf12c83b4433f6f49bf10eda16a141b91",
        "files": [
          "src/unix/darwin-proctitle.c",
          "src/unix/fsevents.c"
        ],
        "message": "unix: fix warnings when loading functions with dlsym",
        "before_after_code_files": [
          "src/unix/darwin-proctitle.c||src/unix/darwin-proctitle.c",
          "src/unix/fsevents.c||src/unix/fsevents.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/unix/darwin-proctitle.c||src/unix/darwin-proctitle.c": [
          "File: src/unix/darwin-proctitle.c -> src/unix/darwin-proctitle.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:   int err;",
          "40:   if (dynamic_pthread_setname_np == NULL)",
          "41:     return -ENOSYS;",
          "",
          "[Removed Lines]",
          "39:   dynamic_pthread_setname_np = dlsym(RTLD_DEFAULT, \"pthread_setname_np\");",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "94:   if (application_services_handle == NULL || core_foundation_handle == NULL)",
          "95:     goto out;",
          "98:       dlsym(core_foundation_handle, \"CFStringCreateWithCString\");",
          "100:       dlsym(core_foundation_handle, \"CFBundleGetBundleWithIdentifier\");",
          "102:       dlsym(core_foundation_handle, \"CFBundleGetDataPointerForName\");",
          "104:       dlsym(core_foundation_handle, \"CFBundleGetFunctionPointerForName\");",
          "106:   if (pCFStringCreateWithCString == NULL ||",
          "",
          "[Removed Lines]",
          "97:   pCFStringCreateWithCString =",
          "99:   pCFBundleGetBundleWithIdentifier =",
          "101:   pCFBundleGetDataPointerForName =",
          "103:   pCFBundleGetFunctionPointerForName =",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "118:   if (launch_services_bundle == NULL)",
          "119:     goto out;",
          "122:       pCFBundleGetFunctionPointerForName(launch_services_bundle,",
          "123:                                          S(\"_LSGetCurrentApplicationASN\"));",
          "125:   if (pLSGetCurrentApplicationASN == NULL)",
          "126:     goto out;",
          "129:       pCFBundleGetFunctionPointerForName(launch_services_bundle,",
          "130:                                          S(\"_LSSetApplicationInformationItem\"));",
          "",
          "[Removed Lines]",
          "121:   pLSGetCurrentApplicationASN =",
          "128:   pLSSetApplicationInformationItem =",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "138:   if (display_name_key == NULL || *display_name_key == NULL)",
          "139:     goto out;",
          "142:                                      \"CFBundleGetInfoDictionary\");",
          "144:                                  \"CFBundleGetMainBundle\");",
          "145:   if (pCFBundleGetInfoDictionary == NULL || pCFBundleGetMainBundle == NULL)",
          "146:     goto out;",
          "",
          "[Removed Lines]",
          "141:   pCFBundleGetInfoDictionary = dlsym(core_foundation_handle,",
          "143:   pCFBundleGetMainBundle = dlsym(core_foundation_handle,",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "152:   if (hi_services_bundle == NULL)",
          "153:     goto out;",
          "156:       hi_services_bundle,",
          "157:       S(\"SetApplicationIsDaemon\"));",
          "159:       launch_services_bundle,",
          "160:       S(\"_LSApplicationCheckIn\"));",
          "162:       pCFBundleGetFunctionPointerForName(",
          "163:           launch_services_bundle,",
          "164:           S(\"_LSSetApplicationLaunchServicesServerConnectionStatus\"));",
          "",
          "[Removed Lines]",
          "155:   pSetApplicationIsDaemon = pCFBundleGetFunctionPointerForName(",
          "158:   pLSApplicationCheckIn = pCFBundleGetFunctionPointerForName(",
          "161:   pLSSetApplicationLaunchServicesServerConnectionStatus =",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/unix/fsevents.c||src/unix/fsevents.c": [
          "File: src/unix/fsevents.c -> src/unix/fsevents.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "525:   err = -ENOENT;",
          "526: #define V(handle, symbol)                                                     \\",
          "527:   do {                                                                        \\",
          "529:     if (p ## symbol == NULL)                                                  \\",
          "530:       goto out;                                                               \\",
          "531:   }                                                                           \\",
          "",
          "[Removed Lines]",
          "528:     p ## symbol = dlsym((handle), #symbol);                                   \\",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c363cd0dbadc78f74096478f9379abd7edf0e4f5",
      "candidate_info": {
        "commit_hash": "c363cd0dbadc78f74096478f9379abd7edf0e4f5",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/c363cd0dbadc78f74096478f9379abd7edf0e4f5",
        "files": [
          "Makefile.am"
        ],
        "message": "build: include internal headers in source list\n\nAllows 'make dist-*' targets to generate working tarballs.",
        "before_after_code_files": [
          "Makefile.am||Makefile.am"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Makefile.am||Makefile.am": [
          "File: Makefile.am -> Makefile.am",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: libuv_la_LDFLAGS = -no-undefined -version-info 11:0:0",
          "27: libuv_la_SOURCES = src/fs-poll.c \\",
          "28:                    src/inet.c \\",
          "29:                    src/uv-common.c \\",
          "30:                    src/uv-common.h \\",
          "31:                    src/version.c",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29:                    src/queue.h \\",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "38:                -D_WIN32_WINNT=0x0600",
          "39: LIBS += -lws2_32 -lpsapi -lphlpapi2",
          "40: libuv_la_SOURCES += src/win/async.c \\",
          "41:                     src/win/core.c \\",
          "42:                     src/win/dl.c \\",
          "43:                     src/win/error.c \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "42:                     src/win/atomicops-inl.h \\",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "45:                     src/win/fs.c \\",
          "46:                     src/win/getaddrinfo.c \\",
          "47:                     src/win/handle.c \\",
          "48:                     src/win/loop-watcher.c \\",
          "49:                     src/win/pipe.c \\",
          "50:                     src/win/poll.c \\",
          "51:                     src/win/process-stdio.c \\",
          "52:                     src/win/process.c \\",
          "53:                     src/win/req.c \\",
          "54:                     src/win/signal.c \\",
          "55:                     src/win/stream.c \\",
          "56:                     src/win/tcp.c \\",
          "57:                     src/win/thread.c \\",
          "58:                     src/win/threadpool.c \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "50:                     src/win/handle-inl.h \\",
          "51:                     src/win/internal.h \\",
          "58:                     src/win/req-inl.h \\",
          "61:                     src/win/stream-inl.h \\",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "61:                     src/win/udp.c \\",
          "62:                     src/win/util.c \\",
          "63:                     src/win/winapi.c \\",
          "66: else  # WINNT",
          "",
          "[Removed Lines]",
          "64:                     src/win/winsock.c",
          "",
          "[Added Lines]",
          "70:                     src/win/winapi.h \\",
          "71:                     src/win/winsock.c \\",
          "72:                     src/win/winsock.h",
          "",
          "---------------"
        ]
      }
    }
  ]
}