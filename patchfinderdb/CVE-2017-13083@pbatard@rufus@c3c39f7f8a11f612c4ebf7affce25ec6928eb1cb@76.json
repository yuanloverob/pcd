{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9afd1d05dda6555ab83331e1972f9a29b78e40bc",
      "candidate_info": {
        "commit_hash": "9afd1d05dda6555ab83331e1972f9a29b78e40bc",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/9afd1d05dda6555ab83331e1972f9a29b78e40bc",
        "files": [
          "ChangeLog.txt",
          "src/rufus.c",
          "src/rufus.rc"
        ],
        "message": "[misc] silence an unwarranted coverity warning",
        "before_after_code_files": [
          "src/rufus.c||src/rufus.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.1.1317\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.1.1318\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,1,1317,0",
          "393:  PRODUCTVERSION 3,1,1317,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,1,1318,0",
          "393:  PRODUCTVERSION 3,1,1318,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1317\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1317\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1318\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1318\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e33b4589b621be147a5494131c91ab21f8d6a759",
      "candidate_info": {
        "commit_hash": "e33b4589b621be147a5494131c91ab21f8d6a759",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/e33b4589b621be147a5494131c91ab21f8d6a759",
        "files": [
          "ChangeLog.txt",
          "src/iso.c",
          "src/rufus.h",
          "src/rufus.rc",
          "src/stdio.c"
        ],
        "message": "[misc] small improvements for 2.13 release",
        "before_after_code_files": [
          "src/iso.c||src/iso.c",
          "src/rufus.h||src/rufus.h",
          "src/rufus.rc||src/rufus.rc",
          "src/stdio.c||src/stdio.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/iso.c||src/iso.c": [
          "File: src/iso.c -> src/iso.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "104: {",
          "105:  size_t i, j;",
          "106:  char* ret = NULL;",
          "110:  ret = safe_strdup(filename);",
          "",
          "[Removed Lines]",
          "107:  char unauthorized[] = {'<', '>', ':', '|', '*', '?'};",
          "",
          "[Added Lines]",
          "107:  char unauthorized[] = { '*', '?', '<', '>', ':', '|', '\\\\', '/'};",
          "",
          "---------------"
        ],
        "src/rufus.h||src/rufus.h": [
          "File: src/rufus.h -> src/rufus.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "77: #define MAX_FAT32_SIZE              2.0f  // Threshold above which we disable FAT32 formatting (in TB)",
          "78: #define FAT32_CLUSTER_THRESHOLD     1.011f  // For FAT32, cluster size changes don't occur at power of 2 boundaries but sligthly above",
          "79: #define DD_BUFFER_SIZE              65536  // Minimum size of the buffer we use for DD operations",
          "81: #define DOWNLOAD_URL                RUFUS_URL \"/downloads\"",
          "82: #define FILES_URL                   RUFUS_URL \"/files\"",
          "84: #define FILES_DIR                   \"rufus_files\"",
          "85: #define IGNORE_RETVAL(expr)         do { (void)(expr); } while(0)",
          "86: #ifndef ARRAYSIZE",
          "",
          "[Removed Lines]",
          "80: #define RUFUS_URL                   \"http://rufus.akeo.ie\"",
          "83: #define SEVENZIP_URL                \"http://sourceforge.net/projects/sevenzip/files/7-Zip/\"",
          "",
          "[Added Lines]",
          "80: #define RUFUS_URL                   \"https://rufus.akeo.ie\"",
          "83: #define SEVENZIP_URL                \"http://www.7-zip.org\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.13.1076\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.13.1077\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,13,1076,0",
          "338:  PRODUCTVERSION 2,13,1076,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,13,1077,0",
          "338:  PRODUCTVERSION 2,13,1077,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1076\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1076\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1077\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1077\"",
          "",
          "---------------"
        ],
        "src/stdio.c||src/stdio.c": [
          "File: src/stdio.c -> src/stdio.c"
        ]
      }
    },
    {
      "candidate_hash": "c021b7bfd87fae0ec4f3ebc7d6fb83044a9a785c",
      "candidate_info": {
        "commit_hash": "c021b7bfd87fae0ec4f3ebc7d6fb83044a9a785c",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/c021b7bfd87fae0ec4f3ebc7d6fb83044a9a785c",
        "files": [
          "src/dev.c",
          "src/rufus.rc"
        ],
        "message": "[core] fix Microsoft's inconsistent casing for device IDs\n\n* Microsoft inconsistently lists similar Device IDs with either upper or\n  lower case values. e.g. USB\\VID_1908&PID_0226\\5&23CE17BD&0&3 vs.\n  USB\\VID_1908&PID_0226\\5&23ce17bd&0&3\n* Of course this creates issues when using a case sensitive hash table...\n* We now convert all Device IDs to uppercase before hashing them.",
        "before_after_code_files": [
          "src/dev.c||src/dev.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/dev.c||src/dev.c": [
          "File: src/dev.c -> src/dev.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "151:  }",
          "152: }",
          "154: BOOL GetOpticalMedia(IMG_SAVE* img_save)",
          "155: {",
          "156:  static char str[MAX_PATH];",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "154: static __inline void ToUpper(char* str)",
          "155: {",
          "156:  int i;",
          "157:  for (i = 0; i < safe_strlen(str); i++)",
          "158:   str[i] = toupper(str[i]);",
          "159: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "349:        s = StrArrayAdd(&dev_if_path, devint_detail_data->DevicePath, TRUE);",
          "350:        uuprintf(\"  Hub[%d] = '%s'\", s, devint_detail_data->DevicePath);",
          "351:        if ((s>= 0) && (CM_Get_Device_IDA(device_inst, device_id, MAX_PATH, 0) == CR_SUCCESS)) {",
          "352:         if ((k = htab_hash(device_id, &htab_devid)) != 0) {",
          "353:          htab_devid.table[k].data = (void*)(uintptr_t)s;",
          "354:         }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "359:         ToUpper(device_id);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "356:         while (CM_Get_Sibling(&device_inst, device_inst, 0) == CR_SUCCESS) {",
          "357:          device_id[0] = 0;",
          "358:          if (CM_Get_Device_IDA(device_inst, device_id, MAX_PATH, 0) == CR_SUCCESS) {",
          "359:           if ((k = htab_hash(device_id, &htab_devid)) != 0) {",
          "360:            htab_devid.table[k].data = (void*)(uintptr_t)s;",
          "361:           }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "367:           ToUpper(device_id);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "530:     props.is_UASP = ((((uintptr_t)device_id)+2) >= ((uintptr_t)devid_list)+list_start[uasp_start]);",
          "532:     j = htab_hash(device_id, &htab_devid);",
          "533:     uuprintf(\"  Matched with ID[%03d]: %s\", j, device_id);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "541:     ToUpper(device_id);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "558:      && (CM_Get_Device_IDA(grandparent_inst, str, MAX_PATH, 0) == CR_SUCCESS) ) {",
          "559:      device_id = str;",
          "560:      method_str = \"[GP]\";",
          "561:      j = htab_hash(device_id, &htab_devid);",
          "562:      uuprintf(\"  Matched with (GP) ID[%03d]: %s\", j, device_id);",
          "563:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "571:      ToUpper(device_id);",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.13.1065\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.13.1066\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,13,1065,0",
          "338:  PRODUCTVERSION 2,13,1065,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,13,1066,0",
          "338:  PRODUCTVERSION 2,13,1066,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1065\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1065\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1066\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1066\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "933193ded9e5f939a67db51739fe1dfb68331e22",
      "candidate_info": {
        "commit_hash": "933193ded9e5f939a67db51739fe1dfb68331e22",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/933193ded9e5f939a67db51739fe1dfb68331e22",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Spanish translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "15333: ################################################################################",
          "15334: l \"es-ES\" \"Spanish (Espa\u00f1ol)\" 0x040a, 0x080a, 0x0c0a, 0x100a, 0x140a, 0x180a, 0x1c0a, 0x200a, 0x240a, 0x280a, 0x2c0a, 0x300a, 0x340a, 0x380a, 0x3c0a, 0x400a, 0x440a, 0x480a, 0x4c0a, 0x500a, 0x540a, 0x580a",
          "15336: b \"en-US\"",
          "15338: # Main dialog",
          "",
          "[Removed Lines]",
          "15335: v 1.0.20",
          "",
          "[Added Lines]",
          "15335: v 1.0.21",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "15706: # Same message, once for singular and plural (\"1 device found\", \"2 devices found\")",
          "15707: t MSG_208 \"%d dispositivo encontrado\"",
          "15708: t MSG_209 \"%d dispositivos encontrados\"",
          "15710: t MSG_211 \"CANCELADO\"",
          "15711: t MSG_212 \"FALLO al realizar la operaci\u00f3n\"",
          "15712: # Used when a new update has been downloaded and launched",
          "",
          "[Removed Lines]",
          "15709: t MSG_210 \"LISTO\"",
          "",
          "[Added Lines]",
          "15709: t MSG_210 \"PREPARADO\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "15800:  \"indicar alguna forma de actividad maliciosa...\\n\u00bfEst\u00e1 seguro de que quieres ejecutar este fichero?\"",
          "15801: t MSG_286 \"Borrando a ceros la unidad: %0.1f%% completado\"",
          "15802: t MSG_287 \"Detecci\u00f3n de unidades extraibles no USB\"",
          "15804: ################################################################################",
          "15805: l \"sv-SE\" \"Swedish (Svenska)\" 0x041d, 0x081d",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "15803: t MSG_288 \"Faltan elevaci\u00f3n de permisos\"",
          "15804: t MSG_289 \"Esta aplicaci\u00f3n s\u00f3lo puede funcionar con elevaci\u00f3n de permisos \"",
          "15805: t MSG_290 \"Indexando fichero\"",
          "15806: t MSG_291 \"Selecci\u00f3n de versi\u00f3n\"",
          "15807: t MSG_292 \"Por favor seleccione la versi\u00f3n de Windows que desea instalar:\"",
          "15808: t MSG_293 \"Versi\u00f3n de Windows no soportada\"",
          "15809: t MSG_294 \"Esta versi\u00f3n de Windows ya no est\u00e1 soportada por Rufus.\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1046\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1047\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1046,0",
          "338:  PRODUCTVERSION 2,12,1046,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1047,0",
          "338:  PRODUCTVERSION 2,12,1047,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1046\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1046\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1047\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1047\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "977aabbf2c0bdc01482e901a6792097749695d07",
      "candidate_info": {
        "commit_hash": "977aabbf2c0bdc01482e901a6792097749695d07",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/977aabbf2c0bdc01482e901a6792097749695d07",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] apply minor fixes to the Italian translation\n\n* Closes #1101",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "7651: t MSG_001 \"Rilevata altra istanza Rufus\"",
          "7652: t MSG_002 \"\u00c8 in esecuzione un'altra applicazione Rufus.\\n\"",
          "7653:  \"Chiudi la prima applicazione prima di eseguirne una seconda.\"",
          "7656: t MSG_004 \"Policy aggiornamenti Rufus\"",
          "7657: t MSG_005 \"Vuoi permettere a Rufus di controllare gli aggiornamenti online?\"",
          "7658: t MSG_006 \"Chiudi\"",
          "",
          "[Removed Lines]",
          "7654: t MSG_003 \"ATTENZIONE: TUTTI I DATI SULL'UNITA' '%s' SARANNO CANCELLATI.\\n\"",
          "7655:  \"Per continuare seleziona 'OK'. Per anullare seleziona 'ANNULLA'.\"",
          "",
          "[Added Lines]",
          "7654: t MSG_003 \"ATTENZIONE: TUTTI I DATI SULL'UNIT\u00c0 '%s' SARANNO CANCELLATI.\\n\"",
          "7655:  \"Per continuare seleziona 'OK'. Per annullare seleziona 'ANNULLA'.\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "7739: t MSG_080 \"Rufus ha rilevato che Windows sta ancora svuotando i buffer interni relativi all'unit\u00e0 USB.\\n\\n\"",
          "7740:  \"A seconda della velocit\u00e0 dell'unit\u00e0 USB, questa operazione potrebbe richiedere un certo tempo per essere completata, \"",
          "7741:  \"specialmente per file molto grandi.\\n\\nTi suggeriamo di attendere che Windows completi le operazioni per evitare la corruzione dei dati. \"",
          "7743: t MSG_081 \"Formato immagine non supportato\"",
          "7744: t MSG_082 \"Questa immagine non \u00e8 bootabile, o usa un metodo di boot o di compressione non supportato da Rufus...\"",
          "7745: t MSG_083 \"Sostituire %s?\"",
          "",
          "[Removed Lines]",
          "7742:  \"Se sei stanco di aspettare, puoi semplicemente scollegare l'unit\u00e0...\"",
          "",
          "[Added Lines]",
          "7742:  \"Se non vuoi attendere oltre, puoi semplicemente scollegare l'unit\u00e0...\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "7759: t MSG_091 \"Quando usi una destinazione di tipo UEFI, sono supportate solo immagini ISO avviabili EFI. \"",
          "7760:  \"Scegli un'immagine avviabile EFI o imposta una destinazione di tipo BIOS.\"",
          "7761: t MSG_092 \"Filesystem non supportato\"",
          "7763:  \"Questo pu\u00f2 includere partizioni/volumi che non sono elencati anche se visibili da Windows.\"",
          "7764:  \"Se vuoi procedere, sei responsabile per qualsiasi perdita di dati in queste partizioni.\"",
          "7765: t MSG_094 \"Rilevate partizioni multiple\"",
          "",
          "[Removed Lines]",
          "7762: t MSG_093 \"IMPORTANTE: QUESTA UNITA' CONTIENE PARTIZIONI MULTIPLE!\\n\\n\"",
          "",
          "[Added Lines]",
          "7762: t MSG_093 \"IMPORTANTE: QUESTA UNIT\u00c0 CONTIENE PARTIZIONI MULTIPLE!\\n\\n\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "7769: t MSG_097 \"'%s' pu\u00f2 essere applicato solo se il file system \u00e8 NTFS.\"",
          "7770: t MSG_098 \"IMPORTANTE: stai tentando di installare 'Windows To Go', ma l'unit\u00e0 destinazione non ha \"",
          "7771:  \"l'attributo 'FISSO'. Windows molto probabilmente si bloccher\u00e0 durante il boot, \"",
          "7773:  \"Vuoi ancora procedere?\\n\\n\"",
          "7774:  \"Nota: l'attributo 'FISSO/RIMOVIBILE' \u00e8 una propriet\u00e0 hardware che pu\u00f2 essere modificata solo \"",
          "7775:  \"usando strumenti personalizzati del produttore dell'unit\u00e0. Comunque questi strumenti non sono QUASI MAI \"",
          "",
          "[Removed Lines]",
          "7772:  \"poich\u00e8 non \u00e8 stato disegnato per lavorare con unit\u00e0 che hanno invece l'attributo 'RIMUOVIBILE'.\\n\\n\"",
          "",
          "[Added Lines]",
          "7772:  \"poich\u00e8 non \u00e8 stato disegnato per lavorare con unit\u00e0 che hanno invece l'attributo 'RIMOVIBILE'.\\n\\n\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "7883: t MSG_194 \"Impossibile scaricare %s\"",
          "7884: # eg. \"Using embedded version of Grub2 file(s)\"",
          "7885: t MSG_195 \"Utilizzo versione integrata dei file %s\"",
          "7887:  \"Le unit\u00e0 convenzionali usano una dimensione settore di 512 byte ma questa unit\u00e0 usa una dimensione di %d byte. \"",
          "7888:  \"In molti casi, ci\u00f2 significa che NON potrai effettuare il boot da questa unit\u00e0.\\n\"",
          "7889:  \"Rufus pu\u00f2 provare a creare una unit\u00e0 avviabile, ma non c'\u00e8 NESSUNA GARANZIA che funzioner\u00e0.\"",
          "",
          "[Removed Lines]",
          "7886: t MSG_196 \"IMPORTANTE: QUESTA UNITA' USA UNA DIMENSIONE SETTORI NON STANDARD!\\n\\n\"",
          "",
          "[Added Lines]",
          "7886: t MSG_196 \"IMPORTANTE: QUESTA UNIT\u00c0 USA UNA DIMENSIONE SETTORI NON STANDARD!\\n\\n\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1244\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1245\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "373: VS_VERSION_INFO VERSIONINFO",
          "376:  FILEFLAGSMASK 0x3fL",
          "377: #ifdef _DEBUG",
          "378:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "374:  FILEVERSION 2,18,1244,0",
          "375:  PRODUCTVERSION 2,18,1244,0",
          "",
          "[Added Lines]",
          "374:  FILEVERSION 2,18,1245,0",
          "375:  PRODUCTVERSION 2,18,1245,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "389:         BEGIN",
          "390:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "391:             VALUE \"FileDescription\", \"Rufus\"",
          "393:             VALUE \"InternalName\", \"Rufus\"",
          "394:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "395:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "396:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "397:             VALUE \"ProductName\", \"Rufus\"",
          "399:         END",
          "400:     END",
          "401:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1244\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1244\"",
          "",
          "[Added Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1245\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1245\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}