{
  "cve_id": "CVE-2016-7142",
  "cve_desc": "The m_sasl module in InspIRCd before 2.0.23, when used with a service that supports SASL_EXTERNAL authentication, allows remote attackers to spoof certificate fingerprints and consequently log in as another user via a crafted SASL message.",
  "repo": "inspircd/inspircd",
  "patch_hash": "74fafb7f11b06747f69f182ad5e3769b665eea7a",
  "patch_info": {
    "commit_hash": "74fafb7f11b06747f69f182ad5e3769b665eea7a",
    "repo": "inspircd/inspircd",
    "commit_url": "https://github.com/inspircd/inspircd/commit/74fafb7f11b06747f69f182ad5e3769b665eea7a",
    "files": [
      "src/modules/m_sasl.cpp"
    ],
    "message": "m_sasl: don't allow AUTHENTICATE with mechanisms with a space",
    "before_after_code_files": [
      "src/modules/m_sasl.cpp||src/modules/m_sasl.cpp"
    ]
  },
  "patch_diff": {
    "src/modules/m_sasl.cpp||src/modules/m_sasl.cpp": [
      "File: src/modules/m_sasl.cpp -> src/modules/m_sasl.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "189:   : Command(Creator, \"AUTHENTICATE\", 1), authExt(ext), cap(Cap)",
      "190:  {",
      "191:   works_before_reg = true;",
      "192:  }",
      "194:  CmdResult Handle (const std::vector<std::string>& parameters, User *user)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "192:   allow_empty_last_param = false;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "199:    if (!cap.ext.get(user))",
      "200:     return CMD_FAILURE;",
      "202:    SaslAuthenticator *sasl = authExt.get(user);",
      "203:    if (!sasl)",
      "204:     authExt.set(user, new SaslAuthenticator(user, parameters[0]));",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "203:    if (parameters[0].find(' ') != std::string::npos || parameters[0][0] == ':')",
      "204:     return CMD_FAILURE;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "b7facc2474ff5fb229c66ed130ed67207620f55d",
      "candidate_info": {
        "commit_hash": "b7facc2474ff5fb229c66ed130ed67207620f55d",
        "repo": "inspircd/inspircd",
        "commit_url": "https://github.com/inspircd/inspircd/commit/b7facc2474ff5fb229c66ed130ed67207620f55d",
        "files": [
          "src/version.sh"
        ],
        "message": "Release v2.0.24",
        "before_after_code_files": [
          "src/version.sh||src/version.sh"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/inspircd/inspircd/pull/1337"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/version.sh||src/version.sh": [
          "File: src/version.sh -> src/version.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #!/bin/sh",
          "",
          "[Removed Lines]",
          "2: echo \"InspIRCd-2.0.23\"",
          "",
          "[Added Lines]",
          "2: echo \"InspIRCd-2.0.24\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}