{
  "cve_id": "CVE-2010-4329",
  "cve_desc": "Cross-site scripting (XSS) vulnerability in the PMA_linkOrButton function in libraries/common.lib.php in the database (db) search script in phpMyAdmin 2.11.x before 2.11.11.1 and 3.x before 3.3.8.1 allows remote attackers to inject arbitrary web script or HTML via a crafted request.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "4341818d73d454451f024950a4ce0141608ac7f8",
  "patch_info": {
    "commit_hash": "4341818d73d454451f024950a4ce0141608ac7f8",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/4341818d73d454451f024950a4ce0141608ac7f8",
    "files": [
      "libraries/common.lib.php"
    ],
    "message": "bug #3115519: fixed XSS on search",
    "before_after_code_files": [
      "libraries/common.lib.php||libraries/common.lib.php"
    ]
  },
  "patch_diff": {
    "libraries/common.lib.php||libraries/common.lib.php": [
      "File: libraries/common.lib.php -> libraries/common.lib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1634:         $tmp = $tag_params;",
      "1635:         $tag_params = array();",
      "1636:         if (!empty($tmp)) {",
      "1638:         }",
      "1639:         unset($tmp);",
      "1640:     }",
      "",
      "[Removed Lines]",
      "1637:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . $tmp . '\\')';",
      "",
      "[Added Lines]",
      "1637:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . PMA_escapeJsString($tmp) . '\\')';",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f805097b86fabd3d4c8dff1f2324efdae1ca0d70",
      "candidate_info": {
        "commit_hash": "f805097b86fabd3d4c8dff1f2324efdae1ca0d70",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/f805097b86fabd3d4c8dff1f2324efdae1ca0d70",
        "files": [
          "libraries/common.lib.php"
        ],
        "message": "bug #3115519: fixed XSS on search",
        "before_after_code_files": [
          "libraries/common.lib.php||libraries/common.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ],
          "candidate": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.lib.php||libraries/common.lib.php": [
          "File: libraries/common.lib.php -> libraries/common.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1634:         $tmp = $tag_params;",
          "1635:         $tag_params = array();",
          "1636:         if (!empty($tmp)) {",
          "1638:         }",
          "1639:         unset($tmp);",
          "1640:     }",
          "",
          "[Removed Lines]",
          "1637:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . $tmp . '\\')';",
          "",
          "[Added Lines]",
          "1637:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . PMA_escapeJsString($tmp) . '\\')';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3f95ef5c20691037ec7c6dac06df3a8ded53523e",
      "candidate_info": {
        "commit_hash": "3f95ef5c20691037ec7c6dac06df3a8ded53523e",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/3f95ef5c20691037ec7c6dac06df3a8ded53523e",
        "files": [
          "libraries/common.lib.php"
        ],
        "message": "bug #3115519: fixed XSS on search",
        "before_after_code_files": [
          "libraries/common.lib.php||libraries/common.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ],
          "candidate": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.lib.php||libraries/common.lib.php": [
          "File: libraries/common.lib.php -> libraries/common.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1769:         $tmp = $tag_params;",
          "1770:         $tag_params = array();",
          "1771:         if (!empty($tmp)) {",
          "1773:         }",
          "1774:         unset($tmp);",
          "1775:     }",
          "",
          "[Removed Lines]",
          "1772:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . $tmp . '\\')';",
          "",
          "[Added Lines]",
          "1772:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . PMA_escapeJsString($tmp) . '\\')';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3756112c7fbb243a954e96e762e1122b80b71dc4",
      "candidate_info": {
        "commit_hash": "3756112c7fbb243a954e96e762e1122b80b71dc4",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/3756112c7fbb243a954e96e762e1122b80b71dc4",
        "files": [
          "libraries/common.lib.php"
        ],
        "message": "bug #3115519: fixed XSS on search",
        "before_after_code_files": [
          "libraries/common.lib.php||libraries/common.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ],
          "candidate": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.lib.php||libraries/common.lib.php": [
          "File: libraries/common.lib.php -> libraries/common.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1644:         $tmp = $tag_params;",
          "1645:         $tag_params = array();",
          "1646:         if (!empty($tmp)) {",
          "1648:         }",
          "1649:         unset($tmp);",
          "1650:     }",
          "",
          "[Removed Lines]",
          "1647:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . $tmp . '\\')';",
          "",
          "[Added Lines]",
          "1647:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . PMA_escapeJsString($tmp) . '\\')';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e1f4901ffc400b6d2df15eac0ba5015fe48a27c4",
      "candidate_info": {
        "commit_hash": "e1f4901ffc400b6d2df15eac0ba5015fe48a27c4",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/e1f4901ffc400b6d2df15eac0ba5015fe48a27c4",
        "files": [
          "libraries/common.lib.php"
        ],
        "message": "bug #3115519: fixed XSS on search",
        "before_after_code_files": [
          "libraries/common.lib.php||libraries/common.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ],
          "candidate": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.lib.php||libraries/common.lib.php": [
          "File: libraries/common.lib.php -> libraries/common.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1644:         $tmp = $tag_params;",
          "1645:         $tag_params = array();",
          "1646:         if (!empty($tmp)) {",
          "1648:         }",
          "1649:         unset($tmp);",
          "1650:     }",
          "",
          "[Removed Lines]",
          "1647:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . $tmp . '\\')';",
          "",
          "[Added Lines]",
          "1647:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . PMA_escapeJsString($tmp) . '\\')';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e90aebf71be2fd26e464e6d33f753ce925eb6ff4",
      "candidate_info": {
        "commit_hash": "e90aebf71be2fd26e464e6d33f753ce925eb6ff4",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/e90aebf71be2fd26e464e6d33f753ce925eb6ff4",
        "files": [
          "libraries/common.lib.php"
        ],
        "message": "bug #3115519: fixed XSS on search",
        "before_after_code_files": [
          "libraries/common.lib.php||libraries/common.lib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ],
          "candidate": [
            "libraries/common.lib.php||libraries/common.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.lib.php||libraries/common.lib.php": [
          "File: libraries/common.lib.php -> libraries/common.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1769:         $tmp = $tag_params;",
          "1770:         $tag_params = array();",
          "1771:         if (!empty($tmp)) {",
          "1773:         }",
          "1774:         unset($tmp);",
          "1775:     }",
          "",
          "[Removed Lines]",
          "1772:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . $tmp . '\\')';",
          "",
          "[Added Lines]",
          "1772:             $tag_params['onclick'] = 'return confirmLink(this, \\'' . PMA_escapeJsString($tmp) . '\\')';",
          "",
          "---------------"
        ]
      }
    }
  ]
}