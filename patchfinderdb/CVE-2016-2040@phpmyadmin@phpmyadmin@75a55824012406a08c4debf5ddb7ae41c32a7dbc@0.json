{
  "cve_id": "CVE-2016-2040",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.13, 4.4.x before 4.4.15.3, and 4.5.x before 4.5.4 allow remote authenticated users to inject arbitrary web script or HTML via a (1) table name, (2) SET value, (3) search query, or (4) hostname in a Location header.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "75a55824012406a08c4debf5ddb7ae41c32a7dbc",
  "patch_info": {
    "commit_hash": "75a55824012406a08c4debf5ddb7ae41c32a7dbc",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/75a55824012406a08c4debf5ddb7ae41c32a7dbc",
    "files": [
      "libraries/DbSearch.class.php"
    ],
    "message": "Fix XSS in DB_search.php\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
    "before_after_code_files": [
      "libraries/DbSearch.class.php||libraries/DbSearch.class.php"
    ]
  },
  "patch_diff": {
    "libraries/DbSearch.class.php||libraries/DbSearch.class.php": [
      "File: libraries/DbSearch.class.php -> libraries/DbSearch.class.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "344:             $browse_result_path = 'sql.php' . PMA_URL_getCommon($this_url_params);",
      "345:             $html_output .= '<td><a name=\"browse_search\" class=\"ajax\" href=\"'",
      "346:                 . $browse_result_path . '\" onclick=\"loadResult(\\''",
      "348:                 . PMA_URL_getCommon(",
      "349:                     array(",
      "350:                         'db' => $GLOBALS['db'], 'table' => $each_table",
      "",
      "[Removed Lines]",
      "347:                 . $browse_result_path . '\\',\\'' . $each_table . '\\',\\''",
      "",
      "[Added Lines]",
      "347:                 . $browse_result_path . '\\',\\''",
      "348:                 . PMA_escapeJsString(htmlspecialchars($each_table)) . '\\',\\''",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "2b3f915f72bfe7eb9ae60a69582f041ddc55f663",
      "candidate_info": {
        "commit_hash": "2b3f915f72bfe7eb9ae60a69582f041ddc55f663",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/2b3f915f72bfe7eb9ae60a69582f041ddc55f663",
        "files": [
          "libraries/DbSearch.class.php"
        ],
        "message": "Fix XSS in DB_search.php\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/DbSearch.class.php||libraries/DbSearch.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libraries/DbSearch.class.php||libraries/DbSearch.class.php"
          ],
          "candidate": [
            "libraries/DbSearch.class.php||libraries/DbSearch.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/DbSearch.class.php||libraries/DbSearch.class.php": [
          "File: libraries/DbSearch.class.php -> libraries/DbSearch.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "344:             $browse_result_path = 'sql.php' . PMA_URL_getCommon($this_url_params);",
          "345:             $html_output .= '<td><a name=\"browse_search\" class=\"ajax\" href=\"'",
          "346:                 . $browse_result_path . '\" onclick=\"loadResult(\\''",
          "348:                 . PMA_URL_getCommon(",
          "349:                     array(",
          "350:                         'db' => $GLOBALS['db'], 'table' => $each_table",
          "",
          "[Removed Lines]",
          "347:                 . $browse_result_path . '\\',\\'' . $each_table . '\\',\\''",
          "",
          "[Added Lines]",
          "347:                 . $browse_result_path . '\\',\\''",
          "348:                 . PMA_escapeJsString(htmlspecialchars($each_table)) . '\\',\\''",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0ce4fd2750491a54d27f94cc1403f9da21738aa6",
      "candidate_info": {
        "commit_hash": "0ce4fd2750491a54d27f94cc1403f9da21738aa6",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/0ce4fd2750491a54d27f94cc1403f9da21738aa6",
        "files": [
          "libraries/DbSearch.class.php"
        ],
        "message": "Fix XSS in DB_search.php\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/DbSearch.class.php||libraries/DbSearch.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/DbSearch.class.php||libraries/DbSearch.class.php"
          ],
          "candidate": [
            "libraries/DbSearch.class.php||libraries/DbSearch.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/DbSearch.class.php||libraries/DbSearch.class.php": [
          "File: libraries/DbSearch.class.php -> libraries/DbSearch.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:             $browse_result_path = 'sql.php' . PMA_generate_common_url($this_url_params);",
          "341:             $html_output .= '<td><a name=\"browse_search\" href=\"'",
          "342:                 . $browse_result_path . '\" onclick=\"loadResult(\\''",
          "344:                 . PMA_generate_common_url($GLOBALS['db'], $each_table) . '\\''",
          "345:                 . ');return false;\" >'",
          "346:                 . __('Browse') . '</a></td>';",
          "",
          "[Removed Lines]",
          "343:                 . $browse_result_path . '\\',\\'' . $each_table . '\\',\\''",
          "",
          "[Added Lines]",
          "343:                 . $browse_result_path . '\\',\\''",
          "344:                 . PMA_escapeJsString(htmlspecialchars($each_table)) . '\\',\\''",
          "",
          "---------------"
        ]
      }
    }
  ]
}