{
  "cve_id": "CVE-2016-7568",
  "cve_desc": "Integer overflow in the gdImageWebpCtx function in gd_webp.c in the GD Graphics Library (aka libgd) through 2.2.3, as used in PHP through 7.0.11, allows remote attackers to cause a denial of service (heap-based buffer overflow) or possibly have unspecified other impact via crafted imagewebp and imagedestroy calls.",
  "repo": "libgd/libgd",
  "patch_hash": "40bec0f38f50e8510f5bb71a82f516d46facde03",
  "patch_info": {
    "commit_hash": "40bec0f38f50e8510f5bb71a82f516d46facde03",
    "repo": "libgd/libgd",
    "commit_url": "https://github.com/libgd/libgd/commit/40bec0f38f50e8510f5bb71a82f516d46facde03",
    "files": [
      "src/gd_webp.c",
      "src/gd.c",
      "src/gd.h",
      "src/gd_crop.c",
      "src/gd_rotate.c",
      "src/gd_topal.c",
      "tests/CMakeLists.txt",
      "tests/Makefile.am",
      "tests/gdimageclone/.gitignore",
      "tests/gdimageclone/CMakeLists.txt",
      "tests/gdimageclone/Makemodule.am",
      "tests/gdimageclone/bug00300.c",
      "tests/gdimagecrop/.gitignore",
      "tests/gdimagecrop/CMakeLists.txt",
      "tests/gdimagecrop/Makemodule.am",
      "tests/gdimagecrop/bug00297.c",
      "tests/gdimagerectangle/.gitignore",
      "tests/gdimagerectangle/CMakeLists.txt",
      "tests/gdimagerectangle/Makemodule.am",
      "tests/gdimagerectangle/bug00299.c",
      "tests/gdimagerectangle/bug00299_exp.png",
      "tests/gdimagerectangle/point_ordering.c",
      "windows/Makefile.vc"
    ],
    "message": "Merge branch 'pull-request/296'",
    "before_after_code_files": [
      "src/gd_webp.c||src/gd_webp.c"
    ]
  },
  "patch_diff": {
    "src/gd_webp.c||src/gd_webp.c": [
      "File: src/gd_webp.c -> src/gd_webp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "199:   quality = 80;",
      "200:  }",
      "202:  argb = (uint8_t *)gdMalloc(gdImageSX(im) * 4 * gdImageSY(im));",
      "203:  if (!argb) {",
      "204:   return;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "202:  if (overflow2(gdImageSX(im), 4)) {",
      "203:   return;",
      "204:  }",
      "206:  if (overflow2(gdImageSX(im) * 4, gdImageSY(im))) {",
      "207:   return;",
      "208:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "965ece564008411867606e8544b28df8f44754df",
      "candidate_info": {
        "commit_hash": "965ece564008411867606e8544b28df8f44754df",
        "repo": "libgd/libgd",
        "commit_url": "https://github.com/libgd/libgd/commit/965ece564008411867606e8544b28df8f44754df",
        "files": [
          "src/gd_webp.c"
        ],
        "message": "Merge branch 'pull-request/296'\n\n(cherry picked from commit 40bec0f38f50e8510f5bb71a82f516d46facde03)",
        "before_after_code_files": [
          "src/gd_webp.c||src/gd_webp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/gd_webp.c||src/gd_webp.c"
          ],
          "candidate": [
            "src/gd_webp.c||src/gd_webp.c"
          ]
        }
      },
      "candidate_diff": {
        "src/gd_webp.c||src/gd_webp.c": [
          "File: src/gd_webp.c -> src/gd_webp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "199:   quality = 80;",
          "200:  }",
          "202:  argb = (uint8_t *)gdMalloc(gdImageSX(im) * 4 * gdImageSY(im));",
          "203:  if (!argb) {",
          "204:   return;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "202:  if (overflow2(gdImageSX(im), 4)) {",
          "203:   return;",
          "204:  }",
          "206:  if (overflow2(gdImageSX(im) * 4, gdImageSY(im))) {",
          "207:   return;",
          "208:  }",
          "",
          "---------------"
        ]
      }
    }
  ]
}