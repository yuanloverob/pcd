{
  "cve_id": "CVE-2011-0986",
  "cve_desc": "phpMyAdmin 2.11.x before 2.11.11.2, and 3.3.x before 3.3.9.1, does not properly handle the absence of the (1) README, (2) ChangeLog, and (3) LICENSE files, which allows remote attackers to obtain the installation path via a direct request for a nonexistent file.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "035d002db1e1201e73e560d7d98591563b506a83",
  "patch_info": {
    "commit_hash": "035d002db1e1201e73e560d7d98591563b506a83",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/035d002db1e1201e73e560d7d98591563b506a83",
    "files": [
      "changelog.php",
      "license.php"
    ],
    "message": "PMASA-2011-1 fixes",
    "before_after_code_files": [
      "changelog.php||changelog.php",
      "license.php||license.php"
    ]
  },
  "patch_diff": {
    "changelog.php||changelog.php": [
      "File: changelog.php -> changelog.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "22: } else {",
      "24: }",
      "",
      "[Removed Lines]",
      "12: require('./libraries/vendor_config.php');",
      "17: if (substr(CHANGELOG_FILE, -3) == '.gz') {",
      "18:     ob_start();",
      "19:     readgzfile(CHANGELOG_FILE);",
      "20:     $changelog = ob_get_contents();",
      "21:     ob_end_clean();",
      "23:     $changelog = file_get_contents(CHANGELOG_FILE);",
      "",
      "[Added Lines]",
      "12: require_once './libraries/common.inc.php';",
      "14: $filename = CHANGELOG_FILE;",
      "20: if (is_readable($filename)) {",
      "23:     if (substr($filename, -3) == '.gz') {",
      "24:         ob_start();",
      "25:         readgzfile($filename);",
      "26:         $changelog = ob_get_contents();",
      "27:         ob_end_clean();",
      "28:     } else {",
      "29:         $changelog = file_get_contents($filename);",
      "30:     }",
      "32:     printf(__('The %s file is not available on this system, please visit www.phpmyadmin.net for more information.'), $filename);",
      "33:     exit;",
      "",
      "---------------"
    ],
    "license.php||license.php": [
      "File: license.php -> license.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "20: header('Content-type: text/plain; charset=iso-8859-1');",
      "22: ?>",
      "",
      "[Removed Lines]",
      "15: require('./libraries/vendor_config.php');",
      "21: readfile(LICENSE_FILE);",
      "",
      "[Added Lines]",
      "15: require_once './libraries/common.inc.php';",
      "22: $filename = LICENSE_FILE;",
      "25: if (is_readable($filename)) {",
      "26:     readfile($filename);",
      "27: } else {",
      "28:     printf(__('The %s file is not available on this system, please visit www.phpmyadmin.net for more information.'), $filename);",
      "29: }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "44ace60f77ede6081e32e516bfd52d597d3f72a6",
      "candidate_info": {
        "commit_hash": "44ace60f77ede6081e32e516bfd52d597d3f72a6",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/44ace60f77ede6081e32e516bfd52d597d3f72a6",
        "files": [
          "changelog.php",
          "license.php"
        ],
        "message": "PMASA-2011-1 fixes",
        "before_after_code_files": [
          "changelog.php||changelog.php",
          "license.php||license.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ],
          "candidate": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ]
        }
      },
      "candidate_diff": {
        "changelog.php||changelog.php": [
          "File: changelog.php -> changelog.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "23: } else {",
          "25: }",
          "",
          "[Removed Lines]",
          "18: if (substr(CHANGELOG_FILE, -3) == '.gz') {",
          "19:     ob_start();",
          "20:     readgzfile(CHANGELOG_FILE);",
          "21:     $changelog = ob_get_contents();",
          "22:     ob_end_clean();",
          "24:     $changelog = file_get_contents(CHANGELOG_FILE);",
          "",
          "[Added Lines]",
          "19: if (is_readable(CHANGELOG_FILE)) {",
          "20:     if (substr(CHANGELOG_FILE, -3) == '.gz') {",
          "21:         ob_start();",
          "22:         readgzfile(CHANGELOG_FILE);",
          "23:         $changelog = ob_get_contents();",
          "24:         ob_end_clean();",
          "25:     } else {",
          "26:         $changelog = file_get_contents(CHANGELOG_FILE);",
          "27:     }",
          "29:     echo \"The Changelog file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "30:     exit;",
          "",
          "---------------"
        ],
        "license.php||license.php": [
          "File: license.php -> license.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: header('Content-type: text/plain; charset=iso-8859-1');",
          "23: ?>",
          "",
          "[Removed Lines]",
          "22: readfile(LICENSE_FILE);",
          "",
          "[Added Lines]",
          "23: $filename = LICENSE_FILE;",
          "26: if (is_readable($filename)) {",
          "27:     readfile($filename);",
          "28: } else {",
          "29:     echo \"The $filename file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "30: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4c8c7080a76b837ae55cdc5e010c793b389a671a",
      "candidate_info": {
        "commit_hash": "4c8c7080a76b837ae55cdc5e010c793b389a671a",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/4c8c7080a76b837ae55cdc5e010c793b389a671a",
        "files": [
          "changelog.php",
          "license.php"
        ],
        "message": "PMASA-2011-1 fixes",
        "before_after_code_files": [
          "changelog.php||changelog.php",
          "license.php||license.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ],
          "candidate": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ]
        }
      },
      "candidate_diff": {
        "changelog.php||changelog.php": [
          "File: changelog.php -> changelog.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "23: } else {",
          "25: }",
          "",
          "[Removed Lines]",
          "18: if (substr(CHANGELOG_FILE, -3) == '.gz') {",
          "19:     ob_start();",
          "20:     readgzfile(CHANGELOG_FILE);",
          "21:     $changelog = ob_get_contents();",
          "22:     ob_end_clean();",
          "24:     $changelog = file_get_contents(CHANGELOG_FILE);",
          "",
          "[Added Lines]",
          "19: if (is_readable(CHANGELOG_FILE)) {",
          "20:     if (substr(CHANGELOG_FILE, -3) == '.gz') {",
          "21:         ob_start();",
          "22:         readgzfile(CHANGELOG_FILE);",
          "23:         $changelog = ob_get_contents();",
          "24:         ob_end_clean();",
          "25:     } else {",
          "26:         $changelog = file_get_contents(CHANGELOG_FILE);",
          "27:     }",
          "29:     echo \"The Changelog file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "30:     exit;",
          "",
          "---------------"
        ],
        "license.php||license.php": [
          "File: license.php -> license.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: header('Content-type: text/plain; charset=iso-8859-1');",
          "23: ?>",
          "",
          "[Removed Lines]",
          "22: readfile(LICENSE_FILE);",
          "",
          "[Added Lines]",
          "23: $filename = LICENSE_FILE;",
          "26: if (is_readable($filename)) {",
          "27:     readfile($filename);",
          "28: } else {",
          "29:     echo \"The $filename file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "30: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f0e8849034132e2114f1d77d9d37185bc5b49886",
      "candidate_info": {
        "commit_hash": "f0e8849034132e2114f1d77d9d37185bc5b49886",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/f0e8849034132e2114f1d77d9d37185bc5b49886",
        "files": [
          "changelog.php",
          "license.php",
          "readme.php"
        ],
        "message": "PMASA-2011-1 fixes",
        "before_after_code_files": [
          "changelog.php||changelog.php",
          "license.php||license.php",
          "readme.php||readme.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ],
          "candidate": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ]
        }
      },
      "candidate_diff": {
        "changelog.php||changelog.php": [
          "File: changelog.php -> changelog.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: $replaces = array(",
          "12:     '@(http://[./a-zA-Z0-9.-]*[/a-zA-Z0-9])@'",
          "",
          "[Removed Lines]",
          "9: $changelog = htmlspecialchars(file_get_contents('ChangeLog'));",
          "",
          "[Added Lines]",
          "9: $filename = 'ChangeLog';",
          "12: if (is_readable($filename)) {",
          "13:     $changelog = htmlspecialchars(file_get_contents($filename));",
          "14: } else {",
          "15:     echo \"The $filename file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "16:     exit;",
          "17: }",
          "",
          "---------------"
        ],
        "license.php||license.php": [
          "File: license.php -> license.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: header('Content-type: text/plain; charset=iso-8859-1');",
          "17: ?>",
          "",
          "[Removed Lines]",
          "16: readfile('LICENSE');",
          "",
          "[Added Lines]",
          "17: $filename = 'LICENSE';",
          "20: if (is_readable($filename)) {",
          "21:     readfile($filename);",
          "22: } else {",
          "23:     echo \"The $filename file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "24: }",
          "",
          "---------------"
        ],
        "readme.php||readme.php": [
          "File: readme.php -> readme.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: header('Content-type: text/plain; charset=utf-8');",
          "17: ?>",
          "",
          "[Removed Lines]",
          "16: readfile('README');",
          "",
          "[Added Lines]",
          "17: $filename = 'README';",
          "20: if (is_readable($filename)) {",
          "21:     readfile($filename);",
          "22: } else {",
          "23:     echo \"The $filename file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "24: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "87fad589653478875ba6f86a5c5ceec805d0f8b2",
      "candidate_info": {
        "commit_hash": "87fad589653478875ba6f86a5c5ceec805d0f8b2",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/87fad589653478875ba6f86a5c5ceec805d0f8b2",
        "files": [
          "changelog.php",
          "license.php",
          "readme.php"
        ],
        "message": "PMASA-2011-1 fixes",
        "before_after_code_files": [
          "changelog.php||changelog.php",
          "license.php||license.php",
          "readme.php||readme.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ],
          "candidate": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ]
        }
      },
      "candidate_diff": {
        "changelog.php||changelog.php": [
          "File: changelog.php -> changelog.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: $replaces = array(",
          "12:     '@(http://[./a-zA-Z0-9.-]*[/a-zA-Z0-9])@'",
          "",
          "[Removed Lines]",
          "9: $changelog = htmlspecialchars(file_get_contents('ChangeLog'));",
          "",
          "[Added Lines]",
          "9: $filename = 'ChangeLog';",
          "12: if (is_readable($filename)) {",
          "13:     $changelog = htmlspecialchars(file_get_contents($filename));",
          "14: } else {",
          "15:     echo \"The $filename file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "16:     exit;",
          "17: }",
          "",
          "---------------"
        ],
        "license.php||license.php": [
          "File: license.php -> license.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: header('Content-type: text/plain; charset=iso-8859-1');",
          "17: ?>",
          "",
          "[Removed Lines]",
          "16: readfile('LICENSE');",
          "",
          "[Added Lines]",
          "17: $filename = 'LICENSE';",
          "20: if (is_readable($filename)) {",
          "21:     readfile($filename);",
          "22: } else {",
          "23:     echo \"The $filename file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "24: }",
          "",
          "---------------"
        ],
        "readme.php||readme.php": [
          "File: readme.php -> readme.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: header('Content-type: text/plain; charset=utf-8');",
          "17: ?>",
          "",
          "[Removed Lines]",
          "16: readfile('README');",
          "",
          "[Added Lines]",
          "17: $filename = 'README';",
          "20: if (is_readable($filename)) {",
          "21:     readfile($filename);",
          "22: } else {",
          "23:     echo \"The $filename file is not available on this system, please visit www.phpmyadmin.net for more information.\";",
          "24: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "563143a9bc739657e8fea61e7ccc81e4425aa4a8",
      "candidate_info": {
        "commit_hash": "563143a9bc739657e8fea61e7ccc81e4425aa4a8",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/563143a9bc739657e8fea61e7ccc81e4425aa4a8",
        "files": [
          "changelog.php",
          "license.php"
        ],
        "message": "No need for require_once",
        "before_after_code_files": [
          "changelog.php||changelog.php",
          "license.php||license.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ],
          "candidate": [
            "changelog.php||changelog.php",
            "license.php||license.php"
          ]
        }
      },
      "candidate_diff": {
        "changelog.php||changelog.php": [
          "File: changelog.php -> changelog.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: $filename = CHANGELOG_FILE;",
          "",
          "[Removed Lines]",
          "12: require_once './libraries/common.inc.php';",
          "",
          "[Added Lines]",
          "12: require './libraries/common.inc.php';",
          "",
          "---------------"
        ],
        "license.php||license.php": [
          "File: license.php -> license.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "15: require_once './libraries/common.inc.php';",
          "",
          "[Added Lines]",
          "15: require './libraries/common.inc.php';",
          "",
          "---------------"
        ]
      }
    }
  ]
}