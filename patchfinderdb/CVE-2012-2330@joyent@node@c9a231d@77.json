{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7abbda8ba2ecabd93b11388bc593ad94da2546bc",
      "candidate_info": {
        "commit_hash": "7abbda8ba2ecabd93b11388bc593ad94da2546bc",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/7abbda8ba2ecabd93b11388bc593ad94da2546bc",
        "files": [
          "Makefile",
          "tools/changelog-head.sh",
          "tools/email-footer.md"
        ],
        "message": "Make rules for release blog post and email message",
        "before_after_code_files": [
          "tools/changelog-head.sh||tools/changelog-head.sh"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tools/changelog-head.sh||tools/changelog-head.sh": [
          "File: tools/changelog-head.sh -> tools/changelog-head.sh",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: #!/bin/bash",
          "2: cat ChangeLog | {",
          "3:   s=-1",
          "4:   while read line; do",
          "5:     if [ \"${line:0:1}\" == \"2\" ]; then",
          "6:       let \"++s\"",
          "7:     fi",
          "8:     if [ $s -eq 1 ]; then",
          "9:       exit",
          "10:     else",
          "11:       echo \"$line\"",
          "12:     fi",
          "13:   done",
          "14: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "daaccc7cb7f4ac208146ef3940fe61c3080fbc16",
      "candidate_info": {
        "commit_hash": "daaccc7cb7f4ac208146ef3940fe61c3080fbc16",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/daaccc7cb7f4ac208146ef3940fe61c3080fbc16",
        "files": [
          "deps/uv/include/uv.h",
          "deps/uv/src/unix/error.c",
          "deps/uv/src/win/error.c"
        ],
        "message": "uv: upgrade to 1ac71a31",
        "before_after_code_files": [
          "deps/uv/include/uv.h||deps/uv/include/uv.h",
          "deps/uv/src/unix/error.c||deps/uv/src/unix/error.c",
          "deps/uv/src/win/error.c||deps/uv/src/win/error.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/uv/include/uv.h||deps/uv/include/uv.h": [
          "File: deps/uv/include/uv.h -> deps/uv/include/uv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "79:   XX(  7, EAFNOSUPPORT, \"\") \\",
          "80:   XX(  8, EALREADY, \"\") \\",
          "81:   XX(  9, EBADF, \"bad file descriptor\") \\",
          "83:   XX( 11, ECONNABORTED, \"software caused connection abort\") \\",
          "84:   XX( 12, ECONNREFUSED, \"connection refused\") \\",
          "85:   XX( 13, ECONNRESET, \"connection reset by peer\") \\",
          "",
          "[Removed Lines]",
          "82:   XX( 10, EBUSY, \"mount device busy\") \\",
          "",
          "[Added Lines]",
          "82:   XX( 10, EBUSY, \"resource busy or locked\") \\",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "119:   XX( 49, ENAMETOOLONG, \"name too long\") \\",
          "120:   XX( 50, EPERM, \"operation not permitted\") \\",
          "121:   XX( 51, ELOOP, \"too many symbolic links encountered\") \\",
          "125: #define UV_ERRNO_GEN(val, name, s) UV_##name = val,",
          "",
          "[Removed Lines]",
          "122:   XX( 52, EXDEV, \"cross-device link not permitted\")",
          "",
          "[Added Lines]",
          "122:   XX( 52, EXDEV, \"cross-device link not permitted\") \\",
          "123:   XX( 53, ENOTEMPTY, \"directory not empty\")",
          "",
          "---------------"
        ],
        "deps/uv/src/unix/error.c||deps/uv/src/unix/error.c": [
          "File: deps/uv/src/unix/error.c -> deps/uv/src/unix/error.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "88:     case ESRCH: return UV_ESRCH;",
          "89:     case ETIMEDOUT: return UV_ETIMEDOUT;",
          "90:     case EXDEV: return UV_EXDEV;",
          "91:     default: return UV_UNKNOWN;",
          "92:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91:     case EBUSY: return UV_EBUSY;",
          "92:     case ENOTEMPTY: return UV_ENOTEMPTY;",
          "",
          "---------------"
        ],
        "deps/uv/src/win/error.c||deps/uv/src/win/error.c": [
          "File: deps/uv/src/win/error.c -> deps/uv/src/win/error.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "78:     case WSAEAFNOSUPPORT:                   return UV_EAFNOSUPPORT;",
          "79:     case WSAEWOULDBLOCK:                    return UV_EAGAIN;",
          "80:     case WSAEALREADY:                       return UV_EALREADY;",
          "81:     case ERROR_CONNECTION_ABORTED:          return UV_ECONNABORTED;",
          "82:     case WSAECONNABORTED:                   return UV_ECONNABORTED;",
          "83:     case ERROR_CONNECTION_REFUSED:          return UV_ECONNREFUSED;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "81:     case ERROR_LOCK_VIOLATION:              return UV_EBUSY;",
          "82:     case ERROR_SHARING_VIOLATION:           return UV_EBUSY;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "102:     case ERROR_OUTOFMEMORY:                 return UV_ENOMEM;",
          "103:     case ERROR_NOT_CONNECTED:               return UV_ENOTCONN;",
          "104:     case WSAENOTCONN:                       return UV_ENOTCONN;",
          "105:     case ERROR_NOT_SUPPORTED:               return UV_ENOTSUP;",
          "106:     case ERROR_INSUFFICIENT_BUFFER:         return UV_EINVAL;",
          "107:     case ERROR_INVALID_FLAGS:               return UV_EBADF;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "107:     case ERROR_DIR_NOT_EMPTY:               return UV_ENOTEMPTY;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5166758927e7538d413b030d3b586107cd53024d",
      "candidate_info": {
        "commit_hash": "5166758927e7538d413b030d3b586107cd53024d",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/5166758927e7538d413b030d3b586107cd53024d",
        "files": [
          "lib/querystring.js"
        ],
        "message": "Make QueryString.parse run faster\n\nUse decodeURIComponent when appropriate, and only fall back to\nquerystring.decode if it throws, or if the character is a '+'.\n\nFix #2248",
        "before_after_code_files": [
          "lib/querystring.js||liquerystring.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/querystring.js||liquerystring.js": [
          "File: lib/querystring.js -> liquerystring.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "170:   }",
          "172:   qs.split(sep).forEach(function(kvp) {",
          "177:     if (!hasOwnProperty(obj, k)) {",
          "178:       obj[k] = v;",
          "",
          "[Removed Lines]",
          "173:     var x = kvp.split(eq);",
          "174:     var k = QueryString.unescape(x[0], true);",
          "175:     var v = QueryString.unescape(x.slice(1).join(eq), true);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2786737417810c0a4f0b70ac80a9c298486de355",
      "candidate_info": {
        "commit_hash": "2786737417810c0a4f0b70ac80a9c298486de355",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/2786737417810c0a4f0b70ac80a9c298486de355",
        "files": [
          "common.gypi"
        ],
        "message": "build: compile with -fno-tree-sink if gcc <= 4.4\n\nFixes a 'pure virtual method called' run-time error with some versions of gcc\non some platforms, notably ARM.",
        "before_after_code_files": [
          "common.gypi||common.gypi"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "common.gypi||common.gypi": [
          "File: common.gypi -> common.gypi",
          "--- Hunk 1 ---",
          "[Context before]",
          "69:               ['clang == 0 and gcc_version >= 40', {",
          "70:                 'cflags': [ '-fno-tree-vrp' ],",
          "71:               }],",
          "72:             ],",
          "73:           }],",
          "74:           ['OS==\"solaris\"', {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "72:               ['clang == 0 and gcc_version <= 44', {",
          "73:                 'cflags': [ '-fno-tree-sink' ],",
          "74:               }],",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5046f8501c15ba42036f826c5fbb7a2fb5ee634d",
      "candidate_info": {
        "commit_hash": "5046f8501c15ba42036f826c5fbb7a2fb5ee634d",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/5046f8501c15ba42036f826c5fbb7a2fb5ee634d",
        "files": [
          "deps/v8/build/common.gypi"
        ],
        "message": "Revert \"Unbreak the Windows build\"\n\nIt is not needed for v8 3.10, and actually breaks the build.\nThis reverts commit bd33fea732fa74d23fc31855631eba14a03a0c49.",
        "before_after_code_files": [
          "deps/v8/build/common.gypi||deps/v8/build/common.gypi"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/v8/build/common.gypi||deps/v8/build/common.gypi": [
          "File: deps/v8/build/common.gypi -> deps/v8/build/common.gypi",
          "--- Hunk 1 ---",
          "[Context before]",
          "272:         'defines': [",
          "273:           'WIN32',",
          "274:         ],",
          "279:       }],",
          "280:       ['OS==\"win\" and v8_enable_prof==1', {",
          "281:         'msvs_settings': {",
          "",
          "[Removed Lines]",
          "275:         'msvs_configuration_attributes': {",
          "276:           'IntermediateDirectory': '$(OutDir)\\\\obj\\\\$(ProjectName)',",
          "277:           'CharacterSet': '1',",
          "278:         },",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}