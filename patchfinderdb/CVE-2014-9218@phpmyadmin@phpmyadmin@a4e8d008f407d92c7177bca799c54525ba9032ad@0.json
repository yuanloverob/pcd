{
  "cve_id": "CVE-2014-9218",
  "cve_desc": "libraries/common.inc.php in phpMyAdmin 4.0.x before 4.0.10.7, 4.1.x before 4.1.14.8, and 4.2.x before 4.2.13.1 allows remote attackers to cause a denial of service (resource consumption) via a long password.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "a4e8d008f407d92c7177bca799c54525ba9032ad",
  "patch_info": {
    "commit_hash": "a4e8d008f407d92c7177bca799c54525ba9032ad",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/a4e8d008f407d92c7177bca799c54525ba9032ad",
    "files": [
      "ChangeLog",
      "libraries/common.inc.php",
      "libraries/plugins/AuthenticationPlugin.class.php",
      "libraries/plugins/auth/AuthenticationCookie.class.php"
    ],
    "message": "bug #4611 [security] DOS attack with long passwords\n\nSigned-off-by: Marc Delisle <marc@infomarc.info>",
    "before_after_code_files": [
      "libraries/common.inc.php||libraries/common.inc.php",
      "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
      "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
    ]
  },
  "patch_diff": {
    "libraries/common.inc.php||libraries/common.inc.php": [
      "File: libraries/common.inc.php -> libraries/common.inc.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "858:                 . ' ' . $cfg['Server']['auth_type']",
      "859:             );",
      "860:         }",
      "861:         include_once  './libraries/plugins/auth/' . $auth_class . '.class.php';",
      "863:         $plugin_manager = null;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "861:         if (isset($_REQUEST['pma_password'])) {",
      "862:             $_REQUEST['pma_password'] = substr($_REQUEST['pma_password'], 0, 256);",
      "863:         }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "986:             $controllink = $userlink;",
      "987:         }",
      "990:         PMA_logUser($cfg['Server']['user']);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "992:         $auth_plugin->storeUserCredentials();",
      "",
      "---------------"
    ],
    "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php": [
      "File: libraries/plugins/AuthenticationPlugin.class.php -> libraries/plugins/AuthenticationPlugin.class.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "39:     abstract public function authSetUser();",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "46:     public function storeUserCredentials()",
      "47:     {",
      "48:     }",
      "",
      "---------------"
    ],
    "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php": [
      "File: libraries/plugins/auth/AuthenticationCookie.class.php -> libraries/plugins/auth/AuthenticationCookie.class.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "563:         } else {",
      "564:             $_SESSION['last_access_time'] = time();",
      "565:         }",
      "567:         $this->createIV();",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "566:     }",
      "573:     public function storeUserCredentials()",
      "574:     {",
      "575:         global $cfg;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "1ac863c7573d12012374d5d41e5c7dc5505ea6e1",
      "candidate_info": {
        "commit_hash": "1ac863c7573d12012374d5d41e5c7dc5505ea6e1",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/1ac863c7573d12012374d5d41e5c7dc5505ea6e1",
        "files": [
          "ChangeLog",
          "libraries/common.inc.php",
          "libraries/plugins/AuthenticationPlugin.class.php",
          "libraries/plugins/auth/AuthenticationCookie.class.php"
        ],
        "message": "bug #4611 [security] DOS attack with long passwords\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/common.inc.php||libraries/common.inc.php",
          "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
          "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.inc.php||libraries/common.inc.php",
            "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
            "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
          ],
          "candidate": [
            "libraries/common.inc.php||libraries/common.inc.php",
            "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
            "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.inc.php||libraries/common.inc.php": [
          "File: libraries/common.inc.php -> libraries/common.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "859:                 . ' ' . $cfg['Server']['auth_type']",
          "860:             );",
          "861:         }",
          "862:         include_once  './libraries/plugins/auth/' . $auth_class . '.class.php';",
          "864:         $plugin_manager = null;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "862:         if (isset($_REQUEST['pma_password'])) {",
          "863:             $_REQUEST['pma_password'] = substr($_REQUEST['pma_password'], 0, 256);",
          "864:         }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "988:             $controllink = $userlink;",
          "989:         }",
          "992:         PMA_logUser($cfg['Server']['user']);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "994:         $auth_plugin->storeUserCredentials();",
          "",
          "---------------"
        ],
        "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php": [
          "File: libraries/plugins/AuthenticationPlugin.class.php -> libraries/plugins/AuthenticationPlugin.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:     abstract public function authSetUser();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "49:     public function storeUserCredentials()",
          "50:     {",
          "51:     }",
          "",
          "---------------"
        ],
        "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php": [
          "File: libraries/plugins/auth/AuthenticationCookie.class.php -> libraries/plugins/auth/AuthenticationCookie.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "557:         unset($_SERVER['PHP_AUTH_PW']);",
          "559:         $_SESSION['last_access_time'] = time();",
          "561:         $this->createBlowfishIV();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "560:     }",
          "567:     public function storeUserCredentials()",
          "568:     {",
          "569:         global $cfg;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "095729d81205f15f40d216d25917017da4c2fff8",
      "candidate_info": {
        "commit_hash": "095729d81205f15f40d216d25917017da4c2fff8",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/095729d81205f15f40d216d25917017da4c2fff8",
        "files": [
          "ChangeLog",
          "libraries/common.inc.php",
          "libraries/plugins/AuthenticationPlugin.class.php",
          "libraries/plugins/auth/AuthenticationCookie.class.php"
        ],
        "message": "bug #4611 [security] DOS attack with long passwords\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/common.inc.php||libraries/common.inc.php",
          "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
          "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.inc.php||libraries/common.inc.php",
            "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
            "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
          ],
          "candidate": [
            "libraries/common.inc.php||libraries/common.inc.php",
            "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
            "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.inc.php||libraries/common.inc.php": [
          "File: libraries/common.inc.php -> libraries/common.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "866:                 . ' ' . $cfg['Server']['auth_type']",
          "867:             );",
          "868:         }",
          "869:         include_once  './libraries/plugins/auth/' . $auth_class . '.class.php';",
          "871:         $plugin_manager = null;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "869:         if (isset($_REQUEST['pma_password'])) {",
          "870:             $_REQUEST['pma_password'] = substr($_REQUEST['pma_password'], 0, 256);",
          "871:         }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "974:             $controllink = $userlink;",
          "975:         }",
          "978:         PMA_log_user($cfg['Server']['user']);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "980:         $auth_plugin->storeUserCredentials();",
          "",
          "---------------"
        ],
        "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php": [
          "File: libraries/plugins/AuthenticationPlugin.class.php -> libraries/plugins/AuthenticationPlugin.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:     abstract public function authSetUser();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "49:     public function storeUserCredentials()",
          "50:     {",
          "51:     }",
          "",
          "---------------"
        ],
        "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php": [
          "File: libraries/plugins/auth/AuthenticationCookie.class.php -> libraries/plugins/auth/AuthenticationCookie.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "475:         unset($_SERVER['PHP_AUTH_PW']);",
          "477:         $_SESSION['last_access_time'] = time();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "478:     }",
          "485:     public function storeUserCredentials()",
          "486:     {",
          "487:         global $cfg;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "62b2c918d26cc78d1763945e3d44d1a63294a819",
      "candidate_info": {
        "commit_hash": "62b2c918d26cc78d1763945e3d44d1a63294a819",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/62b2c918d26cc78d1763945e3d44d1a63294a819",
        "files": [
          "ChangeLog",
          "libraries/common.inc.php",
          "libraries/plugins/AuthenticationPlugin.class.php",
          "libraries/plugins/auth/AuthenticationCookie.class.php"
        ],
        "message": "bug #4611 [security] DOS attack with long passwords\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
        "before_after_code_files": [
          "libraries/common.inc.php||libraries/common.inc.php",
          "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
          "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "libraries/common.inc.php||libraries/common.inc.php",
            "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
            "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
          ],
          "candidate": [
            "libraries/common.inc.php||libraries/common.inc.php",
            "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php",
            "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.inc.php||libraries/common.inc.php": [
          "File: libraries/common.inc.php -> libraries/common.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "856:                 . ' ' . $cfg['Server']['auth_type']",
          "857:             );",
          "858:         }",
          "859:         include_once  './libraries/plugins/auth/' . $auth_class . '.class.php';",
          "861:         $plugin_manager = null;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "859:         if (isset($_REQUEST['pma_password'])) {",
          "860:             $_REQUEST['pma_password'] = substr($_REQUEST['pma_password'], 0, 256);",
          "861:         }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "985:             $controllink = $userlink;",
          "986:         }",
          "989:         PMA_logUser($cfg['Server']['user']);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "991:         $auth_plugin->storeUserCredentials();",
          "",
          "---------------"
        ],
        "libraries/plugins/AuthenticationPlugin.class.php||libraries/plugins/AuthenticationPlugin.class.php": [
          "File: libraries/plugins/AuthenticationPlugin.class.php -> libraries/plugins/AuthenticationPlugin.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:     abstract public function authSetUser();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "49:     public function storeUserCredentials()",
          "50:     {",
          "51:     }",
          "",
          "---------------"
        ],
        "libraries/plugins/auth/AuthenticationCookie.class.php||libraries/plugins/auth/AuthenticationCookie.class.php": [
          "File: libraries/plugins/auth/AuthenticationCookie.class.php -> libraries/plugins/auth/AuthenticationCookie.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "582:         unset($_SERVER['PHP_AUTH_PW']);",
          "584:         $_SESSION['last_access_time'] = time();",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "585:     }",
          "592:     public function storeUserCredentials()",
          "593:     {",
          "594:         global $cfg;",
          "",
          "---------------"
        ]
      }
    }
  ]
}