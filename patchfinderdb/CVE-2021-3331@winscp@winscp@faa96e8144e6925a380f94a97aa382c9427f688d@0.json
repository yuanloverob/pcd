{
  "cve_id": "CVE-2021-3331",
  "cve_desc": "WinSCP before 5.17.10 allows remote attackers to execute arbitrary programs when the URL handler encounters a crafted URL that loads session settings. (For example, this is exploitable in a default installation in which WinSCP is the handler for sftp:// URLs.)",
  "repo": "winscp/winscp",
  "patch_hash": "faa96e8144e6925a380f94a97aa382c9427f688d",
  "patch_info": {
    "commit_hash": "faa96e8144e6925a380f94a97aa382c9427f688d",
    "repo": "winscp/winscp",
    "commit_url": "https://github.com/winscp/winscp/commit/faa96e8144e6925a380f94a97aa382c9427f688d",
    "files": [
      "source/Console.cbproj",
      "source/DragExt.cbproj",
      "source/WinSCP.cbproj",
      "source/core/SessionData.cpp",
      "source/core/SessionData.h",
      "source/forms/Custom.cpp",
      "source/windows/ConsoleRunner.cpp",
      "source/windows/WinMain.cpp"
    ],
    "message": "Bug 1943: Prevent loading session settings that can lead to remote code execution from handled URLs\n\nhttps://winscp.net/tracker/1943\n(cherry picked from commit ec584f5189a856cd79509f754722a6898045c5e0)\n\nSource commit: 0f4be408b3f01132b00682da72d925d6c4ee649b",
    "before_after_code_files": [
      "source/Console.cbproj||source/Console.cbproj",
      "source/DragExt.cbproj||source/DragExt.cbproj",
      "source/WinSCP.cbproj||source/WinSCP.cbproj",
      "source/core/SessionData.cpp||source/core/SessionData.cpp",
      "source/core/SessionData.h||source/core/SessionData.h",
      "source/forms/Custom.cpp||source/forms/Custom.cpp",
      "source/windows/ConsoleRunner.cpp||source/windows/ConsoleRunner.cpp",
      "source/windows/WinMain.cpp||source/windows/WinMain.cpp"
    ]
  },
  "patch_diff": {
    "source/Console.cbproj||source/Console.cbproj": [
      "File: source/Console.cbproj -> source/Console.cbproj",
      "--- Hunk 1 ---",
      "[Context before]",
      "43:   <ProjectType>CppConsoleApplication</ProjectType>",
      "44:   <SanitizedProjectName>Console</SanitizedProjectName>",
      "45:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
      "47:   <VerInfo_Locale>1033</VerInfo_Locale>",
      "48:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
      "49:   <VerInfo_MinorVer>0</VerInfo_MinorVer>",
      "",
      "[Removed Lines]",
      "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
      "",
      "[Added Lines]",
      "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
      "",
      "---------------"
    ],
    "source/DragExt.cbproj||source/DragExt.cbproj": [
      "File: source/DragExt.cbproj -> source/DragExt.cbproj",
      "--- Hunk 1 ---",
      "[Context before]",
      "49:   <SanitizedProjectName>DragExt</SanitizedProjectName>",
      "50:   <VerInfo_DLL>true</VerInfo_DLL>",
      "51:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
      "53:   <VerInfo_Locale>1033</VerInfo_Locale>",
      "54:   <VerInfo_MajorVer>2</VerInfo_MajorVer>",
      "55:  </PropertyGroup>",
      "",
      "[Removed Lines]",
      "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
      "",
      "[Added Lines]",
      "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
      "",
      "---------------"
    ],
    "source/WinSCP.cbproj||source/WinSCP.cbproj": [
      "File: source/WinSCP.cbproj -> source/WinSCP.cbproj",
      "--- Hunk 1 ---",
      "[Context before]",
      "76:   <SanitizedProjectName>WinSCP</SanitizedProjectName>",
      "77:   <UsingDelphiRTL>true</UsingDelphiRTL>",
      "78:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
      "80:   <VerInfo_Locale>1033</VerInfo_Locale>",
      "81:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
      "82:   <VerInfo_MinorVer>17</VerInfo_MinorVer>",
      "",
      "[Removed Lines]",
      "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.10.0;InternalName=winscp;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
      "",
      "[Added Lines]",
      "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.10.0;InternalName=winscp;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
      "",
      "---------------"
    ],
    "source/core/SessionData.cpp||source/core/SessionData.cpp": [
      "File: source/core/SessionData.cpp -> source/core/SessionData.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "596:   return StartsText(UnixIncludeTrailingBackslash(AFolder), Name);",
      "597: }",
      "600: {",
      "",
      "[Removed Lines]",
      "599: void __fastcall TSessionData::DoLoad(THierarchicalStorage * Storage, bool PuttyImport, bool & RewritePassword)",
      "",
      "[Added Lines]",
      "599: void __fastcall TSessionData::DoLoad(THierarchicalStorage * Storage, bool PuttyImport, bool & RewritePassword, bool Unsafe)",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "668:   CipherList = Storage->ReadString(L\"Cipher\", CipherList);",
      "669:   KexList = Storage->ReadString(L\"KEX\", KexList);",
      "670:   HostKeyList = Storage->ReadString(L\"HostKey\", HostKeyList);",
      "672:   GssLibCustom = Storage->ReadString(L\"GSSCustom\", GssLibCustom);",
      "673:   PublicKeyFile = Storage->ReadString(L\"PublicKeyFile\", PublicKeyFile);",
      "674:   AddressFamily = static_cast<TAddressFamily>",
      "",
      "[Removed Lines]",
      "671:   GssLibList = Storage->ReadString(L\"GSSLibs\", GssLibList);",
      "",
      "[Added Lines]",
      "671:   if (!Unsafe)",
      "672:   {",
      "673:     GssLibList = Storage->ReadString(L\"GSSLibs\", GssLibList);",
      "674:   }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "690:   DSTMode = (TDSTMode)Storage->ReadInteger(L\"ConsiderDST\", DSTMode);",
      "691:   LockInHome = Storage->ReadBool(L\"LockInHome\", LockInHome);",
      "692:   Special = Storage->ReadBool(L\"Special\", Special);",
      "694:   ClearAliases = Storage->ReadBool(L\"ClearAliases\", ClearAliases);",
      "695:   UnsetNationalVars = Storage->ReadBool(L\"UnsetNationalVars\", UnsetNationalVars);",
      "698:   IgnoreLsWarnings = Storage->ReadBool(L\"IgnoreLsWarnings\", IgnoreLsWarnings);",
      "699:   SCPLsFullTime = TAutoSwitch(Storage->ReadInteger(L\"SCPLsFullTime\", SCPLsFullTime));",
      "700:   Scp1Compatibility = Storage->ReadBool(L\"Scp1Compatibility\", Scp1Compatibility);",
      "701:   TimeDifference = Storage->ReadFloat(L\"TimeDifference\", TimeDifference);",
      "702:   TimeDifferenceAuto = Storage->ReadBool(L\"TimeDifferenceAuto\", (TimeDifference == TDateTime()));",
      "709:   ExitCode1IsError = Storage->ReadBool(L\"ExitCode1IsError\", ExitCode1IsError);",
      "710:   LookupUserGroups = TAutoSwitch(Storage->ReadInteger(L\"LookupUserGroups2\", LookupUserGroups));",
      "711:   EOLType = (TEOLType)Storage->ReadInteger(L\"EOLType\", EOLType);",
      "",
      "[Removed Lines]",
      "693:   Shell = Storage->ReadString(L\"Shell\", Shell);",
      "696:   ListingCommand = Storage->ReadString(L\"ListingCommand\",",
      "697:     Storage->ReadBool(L\"AliasGroupList\", false) ? UnicodeString(L\"ls -gla\") : ListingCommand);",
      "703:   DeleteToRecycleBin = Storage->ReadBool(L\"DeleteToRecycleBin\", DeleteToRecycleBin);",
      "704:   OverwrittenToRecycleBin = Storage->ReadBool(L\"OverwrittenToRecycleBin\", OverwrittenToRecycleBin);",
      "705:   RecycleBinPath = Storage->ReadString(L\"RecycleBinPath\", RecycleBinPath);",
      "706:   PostLoginCommands = Storage->ReadString(L\"PostLoginCommands\", PostLoginCommands);",
      "708:   ReturnVar = Storage->ReadString(L\"ReturnVar\", ReturnVar);",
      "",
      "[Added Lines]",
      "696:   if (!Unsafe)",
      "697:   {",
      "698:     Shell = Storage->ReadString(L\"Shell\", Shell);",
      "699:   }",
      "702:   if (!Unsafe)",
      "703:   {",
      "704:     ListingCommand = Storage->ReadString(L\"ListingCommand\",",
      "705:       Storage->ReadBool(L\"AliasGroupList\", false) ? UnicodeString(L\"ls -gla\") : ListingCommand);",
      "706:   }",
      "712:   if (!Unsafe)",
      "713:   {",
      "714:     DeleteToRecycleBin = Storage->ReadBool(L\"DeleteToRecycleBin\", DeleteToRecycleBin);",
      "715:     OverwrittenToRecycleBin = Storage->ReadBool(L\"OverwrittenToRecycleBin\", OverwrittenToRecycleBin);",
      "716:     RecycleBinPath = Storage->ReadString(L\"RecycleBinPath\", RecycleBinPath);",
      "717:     PostLoginCommands = Storage->ReadString(L\"PostLoginCommands\", PostLoginCommands);",
      "718:     ReturnVar = Storage->ReadString(L\"ReturnVar\", ReturnVar);",
      "719:   }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "740:     RawByteString AProxyPassword = Storage->ReadStringAsBinaryData(L\"ProxyPasswordEnc\", FProxyPassword);",
      "741:     SET_SESSION_PROPERTY_FROM(ProxyPassword, AProxyPassword);",
      "742:   }",
      "744:   {",
      "750:   }",
      "751:   ProxyDNS = TAutoSwitch((Storage->ReadInteger(L\"ProxyDNS\", (ProxyDNS + 2) % 3) + 1) % 3);",
      "752:   ProxyLocalhost = Storage->ReadBool(L\"ProxyLocalhost\", ProxyLocalhost);",
      "",
      "[Removed Lines]",
      "743:   if (ProxyMethod == pmCmd)",
      "745:     ProxyLocalCommand = Storage->ReadStringRaw(L\"ProxyTelnetCommand\", ProxyLocalCommand);",
      "746:   }",
      "747:   else",
      "748:   {",
      "749:     ProxyTelnetCommand = Storage->ReadStringRaw(L\"ProxyTelnetCommand\", ProxyTelnetCommand);",
      "",
      "[Added Lines]",
      "755:   if (!Unsafe)",
      "757:     if (ProxyMethod == pmCmd)",
      "758:     {",
      "759:       ProxyLocalCommand = Storage->ReadStringRaw(L\"ProxyTelnetCommand\", ProxyLocalCommand);",
      "760:     }",
      "761:     else",
      "762:     {",
      "763:       ProxyTelnetCommand = Storage->ReadStringRaw(L\"ProxyTelnetCommand\", ProxyTelnetCommand);",
      "764:     }",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "775:       Bug[sbHMAC2] = asOn;",
      "776:   }",
      "779:   #define READ_SFTP_BUG(BUG) \\",
      "780:     SFTPBug[sb##BUG] = TAutoSwitch(Storage->ReadInteger(L\"SFTP\" #BUG \"Bug\", SFTPBug[sb##BUG]));",
      "781:   READ_SFTP_BUG(Symlink);",
      "",
      "[Removed Lines]",
      "778:   SftpServer = Storage->ReadString(L\"SftpServer\", SftpServer);",
      "",
      "[Added Lines]",
      "793:   if (!Unsafe)",
      "794:   {",
      "795:     SftpServer = Storage->ReadString(L\"SftpServer\", SftpServer);",
      "796:   }",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "920:     ClearSessionPasswords();",
      "921:     FProxyPassword = L\"\";",
      "925:     Storage->CloseSubKey();",
      "926:   }",
      "",
      "[Removed Lines]",
      "923:     DoLoad(Storage, PuttyImport, RewritePassword);",
      "",
      "[Added Lines]",
      "941:     DoLoad(Storage, PuttyImport, RewritePassword, false);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "1942:   }",
      "1944:   if (!Url.IsEmpty())",
      "1945:   {",
      "1946:     UnicodeString DecodedUrl = DecodeUrlChars(Url);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1962:   bool Unsafe = FLAGSET(Flags, pufUnsafe);",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "2106:       if (RawSettings->Count > 0) // optimization",
      "2107:       {",
      "2109:       }",
      "2111:       bool HasPassword = (UserInfo.Pos(L':') > 0);",
      "",
      "[Removed Lines]",
      "2108:         ApplyRawSettings(RawSettings.get());",
      "",
      "[Added Lines]",
      "2127:         ApplyRawSettings(RawSettings.get(), FLAGSET(Flags, pufUnsafe));",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "2254:       std::unique_ptr<TStrings> RawSettings(new TStringList());",
      "2255:       if (Options->FindSwitch(RawSettingsOption, RawSettings.get()))",
      "2256:       {",
      "2258:       }",
      "2259:     }",
      "2260:   }",
      "",
      "[Removed Lines]",
      "2257:         ApplyRawSettings(RawSettings.get());",
      "",
      "[Added Lines]",
      "2276:         ApplyRawSettings(RawSettings.get(), Unsafe);",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "2262:   return true;",
      "2263: }",
      "2266: {",
      "2267:   std::unique_ptr<TOptionsStorage> OptionsStorage(new TOptionsStorage(RawSettings, false));",
      "2269: }",
      "2272: {",
      "2273:   bool Dummy;",
      "2275: }",
      "2277: void __fastcall TSessionData::ConfigureTunnel(int APortNumber)",
      "",
      "[Removed Lines]",
      "2265: void __fastcall TSessionData::ApplyRawSettings(TStrings * RawSettings)",
      "2268:   ApplyRawSettings(OptionsStorage.get());",
      "2271: void __fastcall TSessionData::ApplyRawSettings(THierarchicalStorage * Storage)",
      "2274:   DoLoad(Storage, false, Dummy);",
      "",
      "[Added Lines]",
      "2284: void __fastcall TSessionData::ApplyRawSettings(TStrings * RawSettings, bool Unsafe)",
      "2287:   ApplyRawSettings(OptionsStorage.get(), Unsafe);",
      "2290: void __fastcall TSessionData::ApplyRawSettings(THierarchicalStorage * Storage, bool Unsafe)",
      "2293:   DoLoad(Storage, false, Dummy, Unsafe);",
      "",
      "---------------"
    ],
    "source/core/SessionData.h||source/core/SessionData.h": [
      "File: source/core/SessionData.h -> source/core/SessionData.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "55: enum TParseUrlFlags",
      "56: {",
      "57:   pufAllowStoredSiteWithProtocol = 0x01,",
      "58: };",
      "60: extern const UnicodeString CipherNames[CIPHER_COUNT];",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "58:   pufUnsafe = 0x02,",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "415:   UnicodeString __fastcall GetFolderName();",
      "416:   void __fastcall Modify();",
      "417:   UnicodeString __fastcall GetSource();",
      "419:   void __fastcall DoSave(THierarchicalStorage * Storage,",
      "420:     bool PuttyExport, const TSessionData * Default, bool DoNotEncryptPasswords);",
      "421:   UnicodeString __fastcall ReadXmlNode(_di_IXMLNode Node, const UnicodeString & Name, const UnicodeString & Default);",
      "",
      "[Removed Lines]",
      "418:   void __fastcall DoLoad(THierarchicalStorage * Storage, bool PuttyImport, bool & RewritePassword);",
      "",
      "[Added Lines]",
      "419:   void __fastcall DoLoad(THierarchicalStorage * Storage, bool PuttyImport, bool & RewritePassword, bool Unsafe);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "468:   void __fastcall DefaultSettings();",
      "469:   void __fastcall NonPersistant();",
      "470:   void __fastcall Load(THierarchicalStorage * Storage, bool PuttyImport);",
      "473:   void __fastcall ImportFromFilezilla(_di_IXMLNode Node, const UnicodeString & Path, _di_IXMLNode SettingsNode);",
      "474:   void __fastcall Save(THierarchicalStorage * Storage, bool PuttyExport,",
      "475:     const TSessionData * Default = NULL);",
      "",
      "[Removed Lines]",
      "471:   void __fastcall ApplyRawSettings(TStrings * RawSettings);",
      "472:   void __fastcall ApplyRawSettings(THierarchicalStorage * Storage);",
      "",
      "[Added Lines]",
      "472:   void __fastcall ApplyRawSettings(TStrings * RawSettings, bool Unsafe);",
      "473:   void __fastcall ApplyRawSettings(THierarchicalStorage * Storage, bool Unsafe);",
      "",
      "---------------"
    ],
    "source/forms/Custom.cpp||source/forms/Custom.cpp": [
      "File: source/forms/Custom.cpp -> source/forms/Custom.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "1507:     Data->Password = BackupData->Password;",
      "1508:     Data->Ftps = BackupData->Ftps;",
      "1511:   }",
      "1512:   return Result;",
      "1513: }",
      "",
      "[Removed Lines]",
      "1510:     Data->ApplyRawSettings(SettingsMemo->Lines);",
      "",
      "[Added Lines]",
      "1510:     Data->ApplyRawSettings(SettingsMemo->Lines, false);",
      "",
      "---------------"
    ],
    "source/windows/ConsoleRunner.cpp||source/windows/ConsoleRunner.cpp": [
      "File: source/windows/ConsoleRunner.cpp -> source/windows/ConsoleRunner.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "2368:             Matches++;",
      "2369:             std::unique_ptr<TSessionData> OriginalData(new TSessionData(L\"\"));",
      "2370:             OriginalData->CopyDataNoRecrypt(Data);",
      "2372:             bool Changed = !OriginalData->IsSame(Data, false);",
      "2373:             if (Changed)",
      "2374:             {",
      "",
      "[Removed Lines]",
      "2371:             Data->ApplyRawSettings(OptionsStorage.get());",
      "",
      "[Added Lines]",
      "2371:             Data->ApplyRawSettings(OptionsStorage.get(), false);",
      "",
      "---------------"
    ],
    "source/windows/WinMain.cpp||source/windows/WinMain.cpp": [
      "File: source/windows/WinMain.cpp -> source/windows/WinMain.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "1096:         std::unique_ptr<TObjectList> DataList(new TObjectList());",
      "1097:         try",
      "1098:         {",
      "1101:           if (DebugAlwaysTrue(!NeedSession || (DataList->Count > 0)))",
      "1102:           {",
      "",
      "[Removed Lines]",
      "1099:           GetLoginData(AutoStartSession, Params, DataList.get(), DownloadFile, NeedSession, NULL, pufAllowStoredSiteWithProtocol);",
      "",
      "[Added Lines]",
      "1099:           int Flags =",
      "1100:             pufAllowStoredSiteWithProtocol |",
      "1101:             FLAGMASK(!CheckSafe(Params), pufUnsafe);",
      "1102:           GetLoginData(AutoStartSession, Params, DataList.get(), DownloadFile, NeedSession, NULL, Flags);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "06577c46fc0357bdfe01312faf40ec08caee92c1",
      "candidate_info": {
        "commit_hash": "06577c46fc0357bdfe01312faf40ec08caee92c1",
        "repo": "winscp/winscp",
        "commit_url": "https://github.com/winscp/winscp/commit/06577c46fc0357bdfe01312faf40ec08caee92c1",
        "files": [
          "dotnet/properties/AssemblyInfo.cs",
          "source/Console.cbproj",
          "source/DragExt.cbproj",
          "source/WinSCP.cbproj"
        ],
        "message": "Bumping devel version to 5.17.3\n\nSource commit: e71910629f9cee8ff631dc67f0236f9304f1baff",
        "before_after_code_files": [
          "dotnet/properties/AssemblyInfo.cs||dotnet/properties/AssemblyInfo.cs",
          "source/Console.cbproj||source/Console.cbproj",
          "source/DragExt.cbproj||source/DragExt.cbproj",
          "source/WinSCP.cbproj||source/WinSCP.cbproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "source/Console.cbproj||source/Console.cbproj",
            "source/DragExt.cbproj||source/DragExt.cbproj",
            "source/WinSCP.cbproj||source/WinSCP.cbproj"
          ],
          "candidate": [
            "source/Console.cbproj||source/Console.cbproj",
            "source/DragExt.cbproj||source/DragExt.cbproj",
            "source/WinSCP.cbproj||source/WinSCP.cbproj"
          ]
        }
      },
      "candidate_diff": {
        "dotnet/properties/AssemblyInfo.cs||dotnet/properties/AssemblyInfo.cs": [
          "File: dotnet/properties/AssemblyInfo.cs -> dotnet/properties/AssemblyInfo.cs",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:         public const string UndefinedProductVersion = \"9.9.9.9\";",
          "38:         public const string Version = \"1.7.2.0\";",
          "40:     }",
          "41: }",
          "",
          "[Removed Lines]",
          "39:         public const string ProductVersion = \"5.17.2.0\";",
          "",
          "[Added Lines]",
          "39:         public const string ProductVersion = \"5.17.3.0\";",
          "",
          "---------------"
        ],
        "source/Console.cbproj||source/Console.cbproj": [
          "File: source/Console.cbproj -> source/Console.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "43:   <ProjectType>CppConsoleApplication</ProjectType>",
          "44:   <SanitizedProjectName>Console</SanitizedProjectName>",
          "45:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "47:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "48:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
          "49:   <VerInfo_MinorVer>0</VerInfo_MinorVer>",
          "",
          "[Removed Lines]",
          "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.2.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "[Added Lines]",
          "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.3.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "---------------"
        ],
        "source/DragExt.cbproj||source/DragExt.cbproj": [
          "File: source/DragExt.cbproj -> source/DragExt.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:   <SanitizedProjectName>DragExt</SanitizedProjectName>",
          "50:   <VerInfo_DLL>true</VerInfo_DLL>",
          "51:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "53:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "54:   <VerInfo_MajorVer>2</VerInfo_MajorVer>",
          "55:  </PropertyGroup>",
          "",
          "[Removed Lines]",
          "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.2.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "[Added Lines]",
          "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.3.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "---------------"
        ],
        "source/WinSCP.cbproj||source/WinSCP.cbproj": [
          "File: source/WinSCP.cbproj -> source/WinSCP.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:   <SanitizedProjectName>WinSCP</SanitizedProjectName>",
          "77:   <UsingDelphiRTL>true</UsingDelphiRTL>",
          "78:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "80:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "81:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
          "82:   <VerInfo_MinorVer>17</VerInfo_MinorVer>",
          "84:  </PropertyGroup>",
          "85:  <PropertyGroup Condition=\"'$(Cfg_1)'!=''\">",
          "86:   <BCC_AllCodeguardOptions>true</BCC_AllCodeguardOptions>",
          "",
          "[Removed Lines]",
          "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.2.0;InternalName=winscp;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.2.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "83:   <VerInfo_Release>2</VerInfo_Release>",
          "",
          "[Added Lines]",
          "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.3.0;InternalName=winscp;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.3.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "83:   <VerInfo_Release>3</VerInfo_Release>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "441cbb43f91d1b866c394f60512fafd7e7aa42ea",
      "candidate_info": {
        "commit_hash": "441cbb43f91d1b866c394f60512fafd7e7aa42ea",
        "repo": "winscp/winscp",
        "commit_url": "https://github.com/winscp/winscp/commit/441cbb43f91d1b866c394f60512fafd7e7aa42ea",
        "files": [
          "source/forms/CustomScpExplorer.cpp",
          "source/windows/WinInterface.h",
          "source/windows/WinMain.cpp"
        ],
        "message": "Bug 1992: When handling URL in an existing WinSCP instance, session settings from a stored site named after the URL hostname are not used\n\nhttps://winscp.net/tracker/1992\n(cherry picked from commit a2913d8d7965e2ec28b99267ba2f650cdd80c318)\n\nSource commit: 4033499eae3c90020b02cdefad2590bd1bae113f",
        "before_after_code_files": [
          "source/forms/CustomScpExplorer.cpp||source/forms/CustomScpExplorer.cpp",
          "source/windows/WinInterface.h||source/windows/WinInterface.h",
          "source/windows/WinMain.cpp||source/windows/WinMain.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "source/windows/WinMain.cpp||source/windows/WinMain.cpp"
          ],
          "candidate": [
            "source/windows/WinMain.cpp||source/windows/WinMain.cpp"
          ]
        }
      },
      "candidate_diff": {
        "source/forms/CustomScpExplorer.cpp||source/forms/CustomScpExplorer.cpp": [
          "File: source/forms/CustomScpExplorer.cpp -> source/forms/CustomScpExplorer.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "509:       StoredSessions->Reload();",
          "510:       UnicodeString SessionName = Params.Param[1];",
          "511:       std::unique_ptr<TObjectList> DataList(new TObjectList());",
          "513:       try",
          "514:       {",
          "516:       }",
          "517:       catch (EAbort &)",
          "518:       {",
          "",
          "[Removed Lines]",
          "512:       UnicodeString DownloadFile; // unused",
          "515:         GetLoginData(SessionName, &Params, DataList.get(), DownloadFile, true, this);",
          "",
          "[Added Lines]",
          "514:         UnicodeString DownloadFile; // unused",
          "515:         int Flags = GetCommandLineParseUrlFlags(&Params);",
          "516:         GetLoginData(SessionName, &Params, DataList.get(), DownloadFile, true, this, Flags);",
          "",
          "---------------"
        ],
        "source/windows/WinInterface.h||source/windows/WinInterface.h": [
          "File: source/windows/WinInterface.h -> source/windows/WinInterface.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "168: int __fastcall Execute();",
          "169: void __fastcall GetLoginData(UnicodeString SessionName, TOptions * Options,",
          "170:   TObjectList * DataList, UnicodeString & DownloadFile, bool NeedSession, TForm * LinkedForm, int Flags = 0);",
          "173: struct TInputDialogData",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "171: int GetCommandLineParseUrlFlags(TProgramParams * Params);",
          "",
          "---------------"
        ],
        "source/windows/WinMain.cpp||source/windows/WinMain.cpp": [
          "File: source/windows/WinMain.cpp -> source/windows/WinMain.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "93:   }",
          "94: }",
          "96: void __fastcall Upload(TTerminal * Terminal, TStrings * FileList, int UseDefaults)",
          "97: {",
          "98:   UnicodeString TargetDirectory;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "96: int GetCommandLineParseUrlFlags(TProgramParams * Params)",
          "97: {",
          "98:   return",
          "99:     pufAllowStoredSiteWithProtocol |",
          "100:     FLAGMASK(!CheckSafe(Params), pufUnsafe);",
          "101: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1129:         std::unique_ptr<TObjectList> DataList(new TObjectList());",
          "1130:         try",
          "1131:         {",
          "1135:           GetLoginData(AutoStartSession, Params, DataList.get(), DownloadFile, NeedSession, NULL, Flags);",
          "1137:           if (DebugAlwaysTrue(!NeedSession || (DataList->Count > 0)))",
          "",
          "[Removed Lines]",
          "1132:           int Flags =",
          "1133:             pufAllowStoredSiteWithProtocol |",
          "1134:             FLAGMASK(!CheckSafe(Params), pufUnsafe);",
          "",
          "[Added Lines]",
          "1139:           int Flags = GetCommandLineParseUrlFlags(Params);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d01545c3c22105f0c3bcea3b99ff4c8454045cb8",
      "candidate_info": {
        "commit_hash": "d01545c3c22105f0c3bcea3b99ff4c8454045cb8",
        "repo": "winscp/winscp",
        "commit_url": "https://github.com/winscp/winscp/commit/d01545c3c22105f0c3bcea3b99ff4c8454045cb8",
        "files": [
          "dotnet/properties/AssemblyInfo.cs",
          "source/Console.cbproj",
          "source/DragExt.cbproj",
          "source/WinSCP.cbproj"
        ],
        "message": "Bumping devel version to 5.17.9\n\nSource commit: 1a2b1772250d2c9a353db699e7e9ae666eef4a15",
        "before_after_code_files": [
          "dotnet/properties/AssemblyInfo.cs||dotnet/properties/AssemblyInfo.cs",
          "source/Console.cbproj||source/Console.cbproj",
          "source/DragExt.cbproj||source/DragExt.cbproj",
          "source/WinSCP.cbproj||source/WinSCP.cbproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "source/Console.cbproj||source/Console.cbproj",
            "source/DragExt.cbproj||source/DragExt.cbproj",
            "source/WinSCP.cbproj||source/WinSCP.cbproj"
          ],
          "candidate": [
            "source/Console.cbproj||source/Console.cbproj",
            "source/DragExt.cbproj||source/DragExt.cbproj",
            "source/WinSCP.cbproj||source/WinSCP.cbproj"
          ]
        }
      },
      "candidate_diff": {
        "dotnet/properties/AssemblyInfo.cs||dotnet/properties/AssemblyInfo.cs": [
          "File: dotnet/properties/AssemblyInfo.cs -> dotnet/properties/AssemblyInfo.cs",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:         public const string UndefinedProductVersion = \"9.9.9.9\";",
          "38:         public const string Version = \"1.7.2.0\";",
          "40:     }",
          "41: }",
          "",
          "[Removed Lines]",
          "39:         public const string ProductVersion = \"5.17.8.0\";",
          "",
          "[Added Lines]",
          "39:         public const string ProductVersion = \"5.17.9.0\";",
          "",
          "---------------"
        ],
        "source/Console.cbproj||source/Console.cbproj": [
          "File: source/Console.cbproj -> source/Console.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "43:   <ProjectType>CppConsoleApplication</ProjectType>",
          "44:   <SanitizedProjectName>Console</SanitizedProjectName>",
          "45:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "47:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "48:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
          "49:   <VerInfo_MinorVer>0</VerInfo_MinorVer>",
          "",
          "[Removed Lines]",
          "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.8.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "[Added Lines]",
          "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.9.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "---------------"
        ],
        "source/DragExt.cbproj||source/DragExt.cbproj": [
          "File: source/DragExt.cbproj -> source/DragExt.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:   <SanitizedProjectName>DragExt</SanitizedProjectName>",
          "50:   <VerInfo_DLL>true</VerInfo_DLL>",
          "51:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "53:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "54:   <VerInfo_MajorVer>2</VerInfo_MajorVer>",
          "55:  </PropertyGroup>",
          "",
          "[Removed Lines]",
          "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.8.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "[Added Lines]",
          "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.9.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "---------------"
        ],
        "source/WinSCP.cbproj||source/WinSCP.cbproj": [
          "File: source/WinSCP.cbproj -> source/WinSCP.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:   <SanitizedProjectName>WinSCP</SanitizedProjectName>",
          "77:   <UsingDelphiRTL>true</UsingDelphiRTL>",
          "78:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "80:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "81:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
          "82:   <VerInfo_MinorVer>17</VerInfo_MinorVer>",
          "84:  </PropertyGroup>",
          "85:  <PropertyGroup Condition=\"'$(Cfg_1)'!=''\">",
          "86:   <BCC_AllCodeguardOptions>true</BCC_AllCodeguardOptions>",
          "",
          "[Removed Lines]",
          "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.8.0;InternalName=winscp;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.8.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "83:   <VerInfo_Release>8</VerInfo_Release>",
          "",
          "[Added Lines]",
          "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.9.0;InternalName=winscp;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.9.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "83:   <VerInfo_Release>9</VerInfo_Release>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "49938a651c3c5901d95711feea0b73e1aa042294",
      "candidate_info": {
        "commit_hash": "49938a651c3c5901d95711feea0b73e1aa042294",
        "repo": "winscp/winscp",
        "commit_url": "https://github.com/winscp/winscp/commit/49938a651c3c5901d95711feea0b73e1aa042294",
        "files": [
          "dotnet/properties/AssemblyInfo.cs",
          "source/Console.cbproj",
          "source/DragExt.cbproj",
          "source/WinSCP.cbproj"
        ],
        "message": "Bumping devel version to 5.17.8\n\nSource commit: 657d15a5245ce15c6dbebc89f6789378e045b398",
        "before_after_code_files": [
          "dotnet/properties/AssemblyInfo.cs||dotnet/properties/AssemblyInfo.cs",
          "source/Console.cbproj||source/Console.cbproj",
          "source/DragExt.cbproj||source/DragExt.cbproj",
          "source/WinSCP.cbproj||source/WinSCP.cbproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "source/Console.cbproj||source/Console.cbproj",
            "source/DragExt.cbproj||source/DragExt.cbproj",
            "source/WinSCP.cbproj||source/WinSCP.cbproj"
          ],
          "candidate": [
            "source/Console.cbproj||source/Console.cbproj",
            "source/DragExt.cbproj||source/DragExt.cbproj",
            "source/WinSCP.cbproj||source/WinSCP.cbproj"
          ]
        }
      },
      "candidate_diff": {
        "dotnet/properties/AssemblyInfo.cs||dotnet/properties/AssemblyInfo.cs": [
          "File: dotnet/properties/AssemblyInfo.cs -> dotnet/properties/AssemblyInfo.cs",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:         public const string UndefinedProductVersion = \"9.9.9.9\";",
          "38:         public const string Version = \"1.7.2.0\";",
          "40:     }",
          "41: }",
          "",
          "[Removed Lines]",
          "39:         public const string ProductVersion = \"5.17.7.0\";",
          "",
          "[Added Lines]",
          "39:         public const string ProductVersion = \"5.17.8.0\";",
          "",
          "---------------"
        ],
        "source/Console.cbproj||source/Console.cbproj": [
          "File: source/Console.cbproj -> source/Console.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "43:   <ProjectType>CppConsoleApplication</ProjectType>",
          "44:   <SanitizedProjectName>Console</SanitizedProjectName>",
          "45:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "47:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "48:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
          "49:   <VerInfo_MinorVer>0</VerInfo_MinorVer>",
          "",
          "[Removed Lines]",
          "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.7.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "[Added Lines]",
          "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.8.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "---------------"
        ],
        "source/DragExt.cbproj||source/DragExt.cbproj": [
          "File: source/DragExt.cbproj -> source/DragExt.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:   <SanitizedProjectName>DragExt</SanitizedProjectName>",
          "50:   <VerInfo_DLL>true</VerInfo_DLL>",
          "51:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "53:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "54:   <VerInfo_MajorVer>2</VerInfo_MajorVer>",
          "55:  </PropertyGroup>",
          "",
          "[Removed Lines]",
          "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.7.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "[Added Lines]",
          "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.8.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "---------------"
        ],
        "source/WinSCP.cbproj||source/WinSCP.cbproj": [
          "File: source/WinSCP.cbproj -> source/WinSCP.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:   <SanitizedProjectName>WinSCP</SanitizedProjectName>",
          "77:   <UsingDelphiRTL>true</UsingDelphiRTL>",
          "78:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "80:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "81:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
          "82:   <VerInfo_MinorVer>17</VerInfo_MinorVer>",
          "84:  </PropertyGroup>",
          "85:  <PropertyGroup Condition=\"'$(Cfg_1)'!=''\">",
          "86:   <BCC_AllCodeguardOptions>true</BCC_AllCodeguardOptions>",
          "",
          "[Removed Lines]",
          "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.7.0;InternalName=winscp;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.7.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "83:   <VerInfo_Release>7</VerInfo_Release>",
          "",
          "[Added Lines]",
          "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.8.0;InternalName=winscp;LegalCopyright=(c) 2000-2020 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.8.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "83:   <VerInfo_Release>8</VerInfo_Release>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2eb9e95a6241338e7b88fc764df5bb648baef36d",
      "candidate_info": {
        "commit_hash": "2eb9e95a6241338e7b88fc764df5bb648baef36d",
        "repo": "winscp/winscp",
        "commit_url": "https://github.com/winscp/winscp/commit/2eb9e95a6241338e7b88fc764df5bb648baef36d",
        "files": [
          "dotnet/properties/AssemblyInfo.cs",
          "source/Console.cbproj",
          "source/DragExt.cbproj",
          "source/WinSCP.cbproj"
        ],
        "message": "Bumping devel version to 5.17.11\n\nSource commit: 24580f350423e8c9e4a6395b771ed1adfe0c588c",
        "before_after_code_files": [
          "dotnet/properties/AssemblyInfo.cs||dotnet/properties/AssemblyInfo.cs",
          "source/Console.cbproj||source/Console.cbproj",
          "source/DragExt.cbproj||source/DragExt.cbproj",
          "source/WinSCP.cbproj||source/WinSCP.cbproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "source/Console.cbproj||source/Console.cbproj",
            "source/DragExt.cbproj||source/DragExt.cbproj",
            "source/WinSCP.cbproj||source/WinSCP.cbproj"
          ],
          "candidate": [
            "source/Console.cbproj||source/Console.cbproj",
            "source/DragExt.cbproj||source/DragExt.cbproj",
            "source/WinSCP.cbproj||source/WinSCP.cbproj"
          ]
        }
      },
      "candidate_diff": {
        "dotnet/properties/AssemblyInfo.cs||dotnet/properties/AssemblyInfo.cs": [
          "File: dotnet/properties/AssemblyInfo.cs -> dotnet/properties/AssemblyInfo.cs",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:         public const string UndefinedProductVersion = \"9.9.9.9\";",
          "38:         public const string Version = \"1.7.2.0\";",
          "40:     }",
          "41: }",
          "",
          "[Removed Lines]",
          "39:         public const string ProductVersion = \"5.17.10.0\";",
          "",
          "[Added Lines]",
          "39:         public const string ProductVersion = \"5.17.11.0\";",
          "",
          "---------------"
        ],
        "source/Console.cbproj||source/Console.cbproj": [
          "File: source/Console.cbproj -> source/Console.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "43:   <ProjectType>CppConsoleApplication</ProjectType>",
          "44:   <SanitizedProjectName>Console</SanitizedProjectName>",
          "45:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "47:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "48:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
          "49:   <VerInfo_MinorVer>0</VerInfo_MinorVer>",
          "",
          "[Removed Lines]",
          "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "[Added Lines]",
          "46:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Console interface for WinSCP;FileVersion=5.0.1.0;InternalName=console;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.com;ProductName=WinSCP;ProductVersion=5.17.11.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "---------------"
        ],
        "source/DragExt.cbproj||source/DragExt.cbproj": [
          "File: source/DragExt.cbproj -> source/DragExt.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:   <SanitizedProjectName>DragExt</SanitizedProjectName>",
          "50:   <VerInfo_DLL>true</VerInfo_DLL>",
          "51:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "53:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "54:   <VerInfo_MajorVer>2</VerInfo_MajorVer>",
          "55:  </PropertyGroup>",
          "",
          "[Removed Lines]",
          "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "[Added Lines]",
          "52:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=Drag&amp;Drop shell extension for WinSCP ($(Platform));FileVersion=2.0.0.0;InternalName=dragext;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=dragext.dll;ProductName=WinSCP;ProductVersion=5.17.11.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "",
          "---------------"
        ],
        "source/WinSCP.cbproj||source/WinSCP.cbproj": [
          "File: source/WinSCP.cbproj -> source/WinSCP.cbproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:   <SanitizedProjectName>WinSCP</SanitizedProjectName>",
          "77:   <UsingDelphiRTL>true</UsingDelphiRTL>",
          "78:   <VerInfo_IncludeVerInfo>true</VerInfo_IncludeVerInfo>",
          "80:   <VerInfo_Locale>1033</VerInfo_Locale>",
          "81:   <VerInfo_MajorVer>5</VerInfo_MajorVer>",
          "82:   <VerInfo_MinorVer>17</VerInfo_MinorVer>",
          "84:  </PropertyGroup>",
          "85:  <PropertyGroup Condition=\"'$(Cfg_1)'!=''\">",
          "86:   <BCC_AllCodeguardOptions>true</BCC_AllCodeguardOptions>",
          "",
          "[Removed Lines]",
          "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.10.0;InternalName=winscp;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.10.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "83:   <VerInfo_Release>10</VerInfo_Release>",
          "",
          "[Added Lines]",
          "79:   <VerInfo_Keys>CompanyName=Martin Prikryl;FileDescription=WinSCP: SFTP, FTP, WebDAV, S3 and SCP client;FileVersion=5.17.11.0;InternalName=winscp;LegalCopyright=(c) 2000-2021 Martin Prikryl;LegalTrademarks=;OriginalFilename=winscp.exe;ProductName=WinSCP;ProductVersion=5.17.11.0;ReleaseType=stable;WWW=https://winscp.net/</VerInfo_Keys>",
          "83:   <VerInfo_Release>11</VerInfo_Release>",
          "",
          "---------------"
        ]
      }
    }
  ]
}