{
  "cve_id": "CVE-2016-2532",
  "cve_desc": "The dissect_llrp_parameters function in epan/dissectors/packet-llrp.c in the LLRP dissector in Wireshark 1.12.x before 1.12.10 and 2.0.x before 2.0.2 does not limit the recursion depth, which allows remote attackers to cause a denial of service (memory consumption or application crash) via a crafted packet.",
  "repo": "wireshark/wireshark",
  "patch_hash": "4a2cd6c79ecbf2cb21f985f01ce1c1e3030285ec",
  "patch_info": {
    "commit_hash": "4a2cd6c79ecbf2cb21f985f01ce1c1e3030285ec",
    "repo": "wireshark/wireshark",
    "commit_url": "https://github.com/wireshark/wireshark/commit/4a2cd6c79ecbf2cb21f985f01ce1c1e3030285ec",
    "files": [
      "epan/dissectors/packet-llrp.c"
    ],
    "message": "llrp: limit recursion depth\n\nLLRP defines fairly complex parameter nesting which we handle via recursion,\nhowever this means a large crafted packet could cause very deep stacks and\npotentially stack overflows. Limit our recursive depth to an arbitrary, which\nshould be more than enough for any legitimate packet (I hope).\n\nBug: 12048\nChange-Id: I9ac31bddfa4ffd1a79809387d10d2261749b95e7\nReviewed-on: https://code.wireshark.org/review/13794\nReviewed-by: Evan Huus <eapache@gmail.com>",
    "before_after_code_files": [
      "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
    ]
  },
  "patch_diff": {
    "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c": [
      "File: epan/dissectors/packet-llrp.c -> epan/dissectors/packet-llrp.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1426: static guint",
      "1427: dissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
      "1430: static guint dissect_llrp_utf8_parameter(tvbuff_t * const tvb, packet_info *pinfo,",
      "1431:         proto_tree * const tree, const guint hfindex, const guint offset)",
      "",
      "[Removed Lines]",
      "1428:         guint offset, const guint end);",
      "",
      "[Added Lines]",
      "1428:         guint offset, const guint end, const guint depth);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1720:         break;",
      "1721:     }",
      "1724: }",
      "1726: static guint",
      "1727: dissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
      "1729: {",
      "1730:     guint8      has_length;",
      "1731:     guint16     len, type;",
      "",
      "[Removed Lines]",
      "1723:     return dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "1728:         guint offset, const guint end)",
      "",
      "[Added Lines]",
      "1723:     return dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, 0);",
      "1728:         guint offset, const guint end, const guint depth)",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "1754:             param_end = offset + real_len;",
      "1756:             ti = proto_tree_add_none_format(tree, hf_llrp_param, tvb,",
      "1757:                     offset, real_len, \"TLV Parameter: %s\",",
      "1758:                     val_to_str_ext(type, &tlv_type_ext, \"Unknown Type: %d\"));",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1756:             if (depth > 16) {",
      "1757:                 return param_end;",
      "1758:             }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "1781:             case LLRP_TLV_READER_EVENT_NOTI_DATA:",
      "1782:             case LLRP_TLV_C1G2_UHF_RF_MD_TBL:",
      "1783:             case LLRP_TLV_C1G2_TAG_SPEC:",
      "1785:                 break;",
      "1786:             case LLRP_TLV_UTC_TIMESTAMP:",
      "1787:             case LLRP_TLV_UPTIME:",
      "",
      "[Removed Lines]",
      "1784:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1788:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "1794:                 PARAM_TREE_ADD(device_manufacturer, 4, ENC_BIG_ENDIAN);",
      "1795:                 PARAM_TREE_ADD(model, 4, ENC_BIG_ENDIAN);",
      "1796:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_firmware_version, suboffset);",
      "1798:                 break;",
      "1799:             case LLRP_TLV_MAX_RECEIVE_SENSE:",
      "1800:                 PARAM_TREE_ADD(max_receive_sense, 2, ENC_BIG_ENDIAN);",
      "",
      "[Removed Lines]",
      "1797:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1801:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "1859:             case LLRP_TLV_REGU_CAPABILITIES:",
      "1860:                 PARAM_TREE_ADD(country_code, 2, ENC_BIG_ENDIAN);",
      "1861:                 PARAM_TREE_ADD(comm_standard, 2, ENC_BIG_ENDIAN);",
      "1863:                 break;",
      "1864:             case LLRP_TLV_XMIT_POWER_LEVEL_ENTRY:",
      "1865:                 PARAM_TREE_ADD(index, 2, ENC_BIG_ENDIAN);",
      "",
      "[Removed Lines]",
      "1862:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1866:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "1867:                 break;",
      "1868:             case LLRP_TLV_FREQ_INFORMATION:",
      "1869:                 PARAM_TREE_ADD(hopping, 1, ENC_NA);",
      "1871:                 break;",
      "1872:             case LLRP_TLV_FREQ_HOP_TABLE:",
      "1873:                 PARAM_TREE_ADD(hop_table_id, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "1870:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1874:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "1887:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
      "1888:                 PARAM_TREE_ADD(priority, 1, ENC_NA);",
      "1889:                 PARAM_TREE_ADD(cur_state, 1, ENC_NA);",
      "1891:                 break;",
      "1892:             case LLRP_TLV_RO_SPEC_START_TRIGGER:",
      "1893:                 PARAM_TREE_ADD(rospec_start_trig_type, 1, ENC_NA);",
      "1895:                 break;",
      "1896:             case LLRP_TLV_PER_TRIGGER_VAL:",
      "1897:                 PARAM_TREE_ADD(offset, 4, ENC_BIG_ENDIAN);",
      "1898:                 PARAM_TREE_ADD(period, 4, ENC_BIG_ENDIAN);",
      "1900:                 break;",
      "1901:             case LLRP_TLV_GPI_TRIGGER_VAL:",
      "1902:                 PARAM_TREE_ADD(gpi_port, 2, ENC_BIG_ENDIAN);",
      "",
      "[Removed Lines]",
      "1890:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "1894:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "1899:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1894:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "1898:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "1903:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "1906:             case LLRP_TLV_RO_SPEC_STOP_TRIGGER:",
      "1907:                 PARAM_TREE_ADD(rospec_stop_trig_type, 1, ENC_NA);",
      "1908:                 PARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);",
      "1910:                 break;",
      "1911:             case LLRP_TLV_AI_SPEC:",
      "1912:                 suboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,",
      "1913:                         hf_llrp_antenna_count, hf_llrp_antenna, 2, suboffset);",
      "1915:                 break;",
      "1916:             case LLRP_TLV_AI_SPEC_STOP:",
      "1917:                 PARAM_TREE_ADD(aispec_stop_trig_type, 1, ENC_NA);",
      "1918:                 PARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);",
      "1920:                 break;",
      "1921:             case LLRP_TLV_TAG_OBSERV_TRIGGER:",
      "1922:                 PARAM_TREE_ADD(trig_type, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "1909:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "1914:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "1919:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1913:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "1918:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "1923:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "1929:             case LLRP_TLV_INVENTORY_PARAM_SPEC:",
      "1930:                 PARAM_TREE_ADD(inventory_spec_id, 2, ENC_BIG_ENDIAN);",
      "1931:                 PARAM_TREE_ADD(protocol_id, 1, ENC_NA);",
      "1933:                 break;",
      "1934:             case LLRP_TLV_RF_SURVEY_SPEC:",
      "1935:                 PARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);",
      "1936:                 PARAM_TREE_ADD(start_freq, 4, ENC_BIG_ENDIAN);",
      "1937:                 PARAM_TREE_ADD(stop_freq, 4, ENC_BIG_ENDIAN);",
      "1939:                 break;",
      "1940:             case LLRP_TLV_RF_SURVEY_SPEC_STOP_TR:",
      "1941:                 PARAM_TREE_ADD(stop_trig_type, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "1932:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "1938:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1936:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "1942:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "1951:                 PARAM_TREE_ADD(protocol_id, 1, ENC_BIG_ENDIAN);",
      "1952:                 PARAM_TREE_ADD(access_cur_state, 1, ENC_NA);",
      "1953:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
      "1955:                 break;",
      "1956:             case LLRP_TLV_ACCESS_SPEC_STOP_TRIG:",
      "1957:                 PARAM_TREE_ADD(access_stop_trig_type, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "1954:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1958:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "1962:                 break;",
      "1963:             case LLRP_TLV_CLIENT_REQ_RESPONSE:",
      "1964:                 PARAM_TREE_ADD(accessspec_id, 2, ENC_BIG_ENDIAN);",
      "1966:                 break;",
      "1967:             case LLRP_TLV_LLRP_CONF_STATE_VAL:",
      "1968:                 PARAM_TREE_ADD(conf_value, 4, ENC_BIG_ENDIAN);",
      "",
      "[Removed Lines]",
      "1965:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1969:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "1988:                 break;",
      "1989:             case LLRP_TLV_ANTENNA_CONF:",
      "1990:                 PARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);",
      "1992:                 break;",
      "1993:             case LLRP_TLV_RF_RECEIVER:",
      "1994:                 PARAM_TREE_ADD(receiver_sense, 2, ENC_BIG_ENDIAN);",
      "",
      "[Removed Lines]",
      "1991:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "1995:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "2009:             case LLRP_TLV_RO_REPORT_SPEC:",
      "2010:                 PARAM_TREE_ADD(ro_report_trig, 1, ENC_NA);",
      "2011:                 PARAM_TREE_ADD(n_2, 2, ENC_BIG_ENDIAN);",
      "2013:                 break;",
      "2014:             case LLRP_TLV_TAG_REPORT_CONTENT_SEL:",
      "2015:                 PARAM_TREE_ADD_STAY(enable_rospec_id, 2, ENC_BIG_ENDIAN);",
      "",
      "[Removed Lines]",
      "2012:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2016:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "2022:                 PARAM_TREE_ADD_STAY(enable_last_seen, 2, ENC_BIG_ENDIAN);",
      "2023:                 PARAM_TREE_ADD_STAY(enable_seen_count, 2, ENC_BIG_ENDIAN);",
      "2024:                 PARAM_TREE_ADD(enable_accessspec_id, 2, ENC_BIG_ENDIAN);",
      "2026:                 break;",
      "2027:             case LLRP_TLV_ACCESS_REPORT_SPEC:",
      "2028:                 PARAM_TREE_ADD(access_report_trig, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "2025:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2029:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "2035:                 PARAM_TREE_ADD(bandwidth, 4, ENC_BIG_ENDIAN);",
      "2036:                 PARAM_TREE_ADD(average_rssi, 1, ENC_NA);",
      "2037:                 PARAM_TREE_ADD(peak_rssi, 1, ENC_NA);",
      "2039:                 break;",
      "2040:             case LLRP_TLV_EVENT_NOTIF_STATE:",
      "2041:                 PARAM_TREE_ADD(event_type, 2, ENC_BIG_ENDIAN);",
      "",
      "[Removed Lines]",
      "2038:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2042:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "2057:             case LLRP_TLV_REPORT_BUF_LEVEL_WARN:",
      "2058:                 PARAM_TREE_ADD(buffer_full_percentage, 1, ENC_NA);",
      "2059:                 break;",
      "2062:             case LLRP_TLV_READER_EXCEPTION_EVENT:",
      "2063:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_message, suboffset);",
      "2065:                 break;",
      "2066:             case LLRP_TLV_RF_SURVEY_EVENT:",
      "2067:                 PARAM_TREE_ADD(rfevent_type, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "2060:             case LLRP_TLV_REPORT_BUF_OVERFLOW_ERR:",
      "2061:                 break;",
      "2064:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2064:             case LLRP_TLV_REPORT_BUF_OVERFLOW_ERR: break;",
      "2067:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "2072:                 PARAM_TREE_ADD(aievent_type, 1, ENC_NA);",
      "2073:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
      "2074:                 PARAM_TREE_ADD(spec_idx, 2, ENC_BIG_ENDIAN);",
      "2076:                 break;",
      "2077:             case LLRP_TLV_ANTENNA_EVENT:",
      "2078:                 PARAM_TREE_ADD(antenna_event_type, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "2075:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2078:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "2090:             case LLRP_TLV_LLRP_STATUS:",
      "2091:                 PARAM_TREE_ADD(status_code, 2, ENC_BIG_ENDIAN);",
      "2092:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_error_desc, suboffset);",
      "2094:                 break;",
      "2095:             case LLRP_TLV_FIELD_ERROR:",
      "2096:                 PARAM_TREE_ADD(field_num, 2, ENC_BIG_ENDIAN);",
      "",
      "[Removed Lines]",
      "2093:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2096:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "2099:             case LLRP_TLV_PARAM_ERROR:",
      "2100:                 PARAM_TREE_ADD(parameter_type, 2, ENC_BIG_ENDIAN);",
      "2101:                 PARAM_TREE_ADD(error_code, 2, ENC_BIG_ENDIAN);",
      "2103:                 break;",
      "2104:             case LLRP_TLV_C1G2_LLRP_CAP:",
      "2105:                 PARAM_TREE_ADD_STAY(can_support_block_erase, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "2102:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2105:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "2130:                 break;",
      "2131:             case LLRP_TLV_C1G2_INVENTORY_COMMAND:",
      "2132:                 PARAM_TREE_ADD(inventory_state_aware, 1, ENC_NA);",
      "2134:                 break;",
      "2135:             case LLRP_TLV_C1G2_FILTER:",
      "2136:                 PARAM_TREE_ADD(trunc, 1, ENC_NA);",
      "2138:                 break;",
      "2139:             case LLRP_TLV_C1G2_TAG_INV_MASK:",
      "2140:                 PARAM_TREE_ADD(mb, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "2133:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "2137:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2136:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "2140:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "2156:                 PARAM_TREE_ADD(session, 1, ENC_NA);",
      "2157:                 PARAM_TREE_ADD(tag_population, 2, ENC_BIG_ENDIAN);",
      "2158:                 PARAM_TREE_ADD(tag_transit_time, 4, ENC_BIG_ENDIAN);",
      "2160:                 break;",
      "2161:             case LLRP_TLV_C1G2_TAG_INV_AWARE_SING:",
      "2162:                 PARAM_TREE_ADD_STAY(sing_i, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "2159:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2162:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "2200:             case LLRP_TLV_C1G2_LOCK:",
      "2201:                 PARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);",
      "2202:                 PARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);",
      "2204:                 break;",
      "2205:             case LLRP_TLV_C1G2_LOCK_PAYLOAD:",
      "2206:                 PARAM_TREE_ADD(privilege, 1, ENC_NA);",
      "",
      "[Removed Lines]",
      "2203:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
      "",
      "[Added Lines]",
      "2206:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "2641:             DISSECTOR_ASSERT_NOT_REACHED();",
      "2642:     };",
      "2643:     if(ends_with_parameters) {",
      "2645:     }",
      "2646:     if(tvb_reported_length_remaining(tvb, offset) != 0) {",
      "",
      "[Removed Lines]",
      "2644:         offset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb));",
      "",
      "[Added Lines]",
      "2647:         offset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb), 0);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6dbf7ccc8e29f34286f6dca74ef6cc5fd15c949f",
      "candidate_info": {
        "commit_hash": "6dbf7ccc8e29f34286f6dca74ef6cc5fd15c949f",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/6dbf7ccc8e29f34286f6dca74ef6cc5fd15c949f",
        "files": [
          "epan/dissectors/packet-llrp.c"
        ],
        "message": "llrp: limit recursion depth\n\nLLRP defines fairly complex parameter nesting which we handle via recursion,\nhowever this means a large crafted packet could cause very deep stacks and\npotentially stack overflows. Limit our recursive depth to an arbitrary, which\nshould be more than enough for any legitimate packet (I hope).\n\nBug: 12048\nChange-Id: I9ac31bddfa4ffd1a79809387d10d2261749b95e7\nReviewed-on: https://code.wireshark.org/review/13794\nReviewed-by: Evan Huus <eapache@gmail.com>\n(cherry picked from commit 4a2cd6c79ecbf2cb21f985f01ce1c1e3030285ec)\nReviewed-on: https://code.wireshark.org/review/14343\nReviewed-by: Balint Reczey <balint@balintreczey.hu>",
        "before_after_code_files": [
          "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
          ],
          "candidate": [
            "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c": [
          "File: epan/dissectors/packet-llrp.c -> epan/dissectors/packet-llrp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1380: static guint",
          "1381: dissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1384: static guint dissect_llrp_utf8_parameter(tvbuff_t * const tvb, packet_info *pinfo,",
          "1385:         proto_tree * const tree, const guint hfindex, const guint offset)",
          "",
          "[Removed Lines]",
          "1382:         guint offset, const guint end);",
          "",
          "[Added Lines]",
          "1382:         guint offset, const guint end, const guint depth);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1663:         break;",
          "1664:     }",
          "1667: }",
          "1669: static guint",
          "1670: dissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1672: {",
          "1673:     guint8      has_length;",
          "1674:     guint16     len, type;",
          "",
          "[Removed Lines]",
          "1666:     return dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1671:         guint offset, const guint end)",
          "",
          "[Added Lines]",
          "1666:     return dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, 0);",
          "1671:         guint offset, const guint end, const guint depth)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1697:             param_end = offset + real_len;",
          "1699:             ti = proto_tree_add_none_format(tree, hf_llrp_param, tvb,",
          "1700:                     offset, real_len, \"TLV Parameter: %s\",",
          "1701:                     val_to_str_ext(type, &tlv_type_ext, \"Unknown Type: %d\"));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1699:             if (depth > 16) {",
          "1700:                 return param_end;",
          "1701:             }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1724:             case LLRP_TLV_READER_EVENT_NOTI_DATA:",
          "1725:             case LLRP_TLV_C1G2_UHF_RF_MD_TBL:",
          "1726:             case LLRP_TLV_C1G2_TAG_SPEC:",
          "1728:                 break;",
          "1729:             case LLRP_TLV_UTC_TIMESTAMP:",
          "1730:             case LLRP_TLV_UPTIME:",
          "",
          "[Removed Lines]",
          "1727:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1731:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1737:                 PARAM_TREE_ADD(device_manufacturer, 4, ENC_BIG_ENDIAN);",
          "1738:                 PARAM_TREE_ADD(model, 4, ENC_BIG_ENDIAN);",
          "1739:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_firmware_version, suboffset);",
          "1741:                 break;",
          "1742:             case LLRP_TLV_MAX_RECEIVE_SENSE:",
          "1743:                 PARAM_TREE_ADD(max_receive_sense, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1740:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1744:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1802:             case LLRP_TLV_REGU_CAPABILITIES:",
          "1803:                 PARAM_TREE_ADD(country_code, 2, ENC_BIG_ENDIAN);",
          "1804:                 PARAM_TREE_ADD(comm_standard, 2, ENC_BIG_ENDIAN);",
          "1806:                 break;",
          "1807:             case LLRP_TLV_XMIT_POWER_LEVEL_ENTRY:",
          "1808:                 PARAM_TREE_ADD(index, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1805:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1809:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1810:                 break;",
          "1811:             case LLRP_TLV_FREQ_INFORMATION:",
          "1812:                 PARAM_TREE_ADD(hopping, 1, ENC_NA);",
          "1814:                 break;",
          "1815:             case LLRP_TLV_FREQ_HOP_TABLE:",
          "1816:                 PARAM_TREE_ADD(hop_table_id, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1813:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1817:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1830:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "1831:                 PARAM_TREE_ADD(priority, 1, ENC_NA);",
          "1832:                 PARAM_TREE_ADD(cur_state, 1, ENC_NA);",
          "1834:                 break;",
          "1835:             case LLRP_TLV_RO_SPEC_START_TRIGGER:",
          "1836:                 PARAM_TREE_ADD(rospec_start_trig_type, 1, ENC_NA);",
          "1838:                 break;",
          "1839:             case LLRP_TLV_PER_TRIGGER_VAL:",
          "1840:                 PARAM_TREE_ADD(offset, 4, ENC_BIG_ENDIAN);",
          "1841:                 PARAM_TREE_ADD(period, 4, ENC_BIG_ENDIAN);",
          "1843:                 break;",
          "1844:             case LLRP_TLV_GPI_TRIGGER_VAL:",
          "1845:                 PARAM_TREE_ADD(gpi_port, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1833:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1837:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1842:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1837:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1841:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1846:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1849:             case LLRP_TLV_RO_SPEC_STOP_TRIGGER:",
          "1850:                 PARAM_TREE_ADD(rospec_stop_trig_type, 1, ENC_NA);",
          "1851:                 PARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);",
          "1853:                 break;",
          "1854:             case LLRP_TLV_AI_SPEC:",
          "1855:                 suboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,",
          "1856:                         hf_llrp_antenna_count, hf_llrp_antenna, 2, suboffset);",
          "1858:                 break;",
          "1859:             case LLRP_TLV_AI_SPEC_STOP:",
          "1860:                 PARAM_TREE_ADD(aispec_stop_trig_type, 1, ENC_NA);",
          "1861:                 PARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);",
          "1863:                 break;",
          "1864:             case LLRP_TLV_TAG_OBSERV_TRIGGER:",
          "1865:                 PARAM_TREE_ADD(trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1852:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1857:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1862:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1856:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1861:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1866:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1872:             case LLRP_TLV_INVENTORY_PARAM_SPEC:",
          "1873:                 PARAM_TREE_ADD(inventory_spec_id, 2, ENC_BIG_ENDIAN);",
          "1874:                 PARAM_TREE_ADD(protocol_id, 1, ENC_NA);",
          "1876:                 break;",
          "1877:             case LLRP_TLV_RF_SURVEY_SPEC:",
          "1878:                 PARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);",
          "1879:                 PARAM_TREE_ADD(start_freq, 4, ENC_BIG_ENDIAN);",
          "1880:                 PARAM_TREE_ADD(stop_freq, 4, ENC_BIG_ENDIAN);",
          "1882:                 break;",
          "1883:             case LLRP_TLV_RF_SURVEY_SPEC_STOP_TR:",
          "1884:                 PARAM_TREE_ADD(stop_trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1875:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1881:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1879:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1885:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1894:                 PARAM_TREE_ADD(protocol_id, 1, ENC_BIG_ENDIAN);",
          "1895:                 PARAM_TREE_ADD(access_cur_state, 1, ENC_NA);",
          "1896:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "1898:                 break;",
          "1899:             case LLRP_TLV_ACCESS_SPEC_STOP_TRIG:",
          "1900:                 PARAM_TREE_ADD(access_stop_trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1897:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1901:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1905:                 break;",
          "1906:             case LLRP_TLV_CLIENT_REQ_RESPONSE:",
          "1907:                 PARAM_TREE_ADD(accessspec_id, 2, ENC_BIG_ENDIAN);",
          "1909:                 break;",
          "1910:             case LLRP_TLV_LLRP_CONF_STATE_VAL:",
          "1911:                 PARAM_TREE_ADD(conf_value, 4, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1908:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1912:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1931:                 break;",
          "1932:             case LLRP_TLV_ANTENNA_CONF:",
          "1933:                 PARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);",
          "1935:                 break;",
          "1936:             case LLRP_TLV_RF_RECEIVER:",
          "1937:                 PARAM_TREE_ADD(receiver_sense, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1934:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1938:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1952:             case LLRP_TLV_RO_REPORT_SPEC:",
          "1953:                 PARAM_TREE_ADD(ro_report_trig, 1, ENC_NA);",
          "1954:                 PARAM_TREE_ADD(n_2, 2, ENC_BIG_ENDIAN);",
          "1956:                 break;",
          "1957:             case LLRP_TLV_TAG_REPORT_CONTENT_SEL:",
          "1958:                 PARAM_TREE_ADD_STAY(enable_rospec_id, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1955:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1959:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1965:                 PARAM_TREE_ADD_STAY(enable_last_seen, 2, ENC_BIG_ENDIAN);",
          "1966:                 PARAM_TREE_ADD_STAY(enable_seen_count, 2, ENC_BIG_ENDIAN);",
          "1967:                 PARAM_TREE_ADD(enable_accessspec_id, 2, ENC_BIG_ENDIAN);",
          "1969:                 break;",
          "1970:             case LLRP_TLV_ACCESS_REPORT_SPEC:",
          "1971:                 PARAM_TREE_ADD(access_report_trig, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1968:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1972:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1978:                 PARAM_TREE_ADD(bandwidth, 4, ENC_BIG_ENDIAN);",
          "1979:                 PARAM_TREE_ADD(average_rssi, 1, ENC_NA);",
          "1980:                 PARAM_TREE_ADD(peak_rssi, 1, ENC_NA);",
          "1982:                 break;",
          "1983:             case LLRP_TLV_EVENT_NOTIF_STATE:",
          "1984:                 PARAM_TREE_ADD(event_type, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1981:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1985:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "2000:             case LLRP_TLV_REPORT_BUF_LEVEL_WARN:",
          "2001:                 PARAM_TREE_ADD(buffer_full_percentage, 1, ENC_NA);",
          "2002:                 break;",
          "2005:             case LLRP_TLV_READER_EXCEPTION_EVENT:",
          "2006:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_message, suboffset);",
          "2008:                 break;",
          "2009:             case LLRP_TLV_RF_SURVEY_EVENT:",
          "2010:                 PARAM_TREE_ADD(rfevent_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2003:             case LLRP_TLV_REPORT_BUF_OVERFLOW_ERR:",
          "2004:                 break;",
          "2007:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2007:             case LLRP_TLV_REPORT_BUF_OVERFLOW_ERR: break;",
          "2010:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "2015:                 PARAM_TREE_ADD(aievent_type, 1, ENC_NA);",
          "2016:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "2017:                 PARAM_TREE_ADD(spec_idx, 2, ENC_BIG_ENDIAN);",
          "2019:                 break;",
          "2020:             case LLRP_TLV_ANTENNA_EVENT:",
          "2021:                 PARAM_TREE_ADD(antenna_event_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2018:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2021:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "2033:             case LLRP_TLV_LLRP_STATUS:",
          "2034:                 PARAM_TREE_ADD(status_code, 2, ENC_BIG_ENDIAN);",
          "2035:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_error_desc, suboffset);",
          "2037:                 break;",
          "2038:             case LLRP_TLV_FIELD_ERROR:",
          "2039:                 PARAM_TREE_ADD(field_num, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "2036:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2039:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "2042:             case LLRP_TLV_PARAM_ERROR:",
          "2043:                 PARAM_TREE_ADD(parameter_type, 2, ENC_BIG_ENDIAN);",
          "2044:                 PARAM_TREE_ADD(error_code, 2, ENC_BIG_ENDIAN);",
          "2046:                 break;",
          "2047:             case LLRP_TLV_C1G2_LLRP_CAP:",
          "2048:                 PARAM_TREE_ADD_STAY(can_support_block_erase, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2045:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2048:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "2073:                 break;",
          "2074:             case LLRP_TLV_C1G2_INVENTORY_COMMAND:",
          "2075:                 PARAM_TREE_ADD(inventory_state_aware, 1, ENC_NA);",
          "2077:                 break;",
          "2078:             case LLRP_TLV_C1G2_FILTER:",
          "2079:                 PARAM_TREE_ADD(trunc, 1, ENC_NA);",
          "2081:                 break;",
          "2082:             case LLRP_TLV_C1G2_TAG_INV_MASK:",
          "2083:                 PARAM_TREE_ADD(mb, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2076:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "2080:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2079:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "2083:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "2099:                 PARAM_TREE_ADD(session, 1, ENC_NA);",
          "2100:                 PARAM_TREE_ADD(tag_population, 2, ENC_BIG_ENDIAN);",
          "2101:                 PARAM_TREE_ADD(tag_transit_time, 4, ENC_BIG_ENDIAN);",
          "2103:                 break;",
          "2104:             case LLRP_TLV_C1G2_TAG_INV_AWARE_SING:",
          "2105:                 PARAM_TREE_ADD_STAY(sing_i, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2102:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2105:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "2143:             case LLRP_TLV_C1G2_LOCK:",
          "2144:                 PARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);",
          "2145:                 PARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);",
          "2147:                 break;",
          "2148:             case LLRP_TLV_C1G2_LOCK_PAYLOAD:",
          "2149:                 PARAM_TREE_ADD(privilege, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2146:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2149:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "2584:             DISSECTOR_ASSERT_NOT_REACHED();",
          "2585:     };",
          "2586:     if(ends_with_parameters) {",
          "2588:     }",
          "2589:     if(tvb_reported_length_remaining(tvb, offset) != 0) {",
          "",
          "[Removed Lines]",
          "2587:         offset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb));",
          "",
          "[Added Lines]",
          "2590:         offset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb), 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "38a01c8b4ec890703a5798e2b31263b9db33b46b",
      "candidate_info": {
        "commit_hash": "38a01c8b4ec890703a5798e2b31263b9db33b46b",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/38a01c8b4ec890703a5798e2b31263b9db33b46b",
        "files": [
          "epan/dissectors/packet-llrp.c"
        ],
        "message": "llrp: limit recursion depth\n\nLLRP defines fairly complex parameter nesting which we handle via recursion,\nhowever this means a large crafted packet could cause very deep stacks and\npotentially stack overflows. Limit our recursive depth to an arbitrary, which\nshould be more than enough for any legitimate packet (I hope).\n\nBug: 12048\nChange-Id: I9ac31bddfa4ffd1a79809387d10d2261749b95e7\nReviewed-on: https://code.wireshark.org/review/13795\nReviewed-by: Anders Broman <a.broman58@gmail.com>",
        "before_after_code_files": [
          "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
          ],
          "candidate": [
            "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c": [
          "File: epan/dissectors/packet-llrp.c -> epan/dissectors/packet-llrp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1426: static guint",
          "1427: dissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1430: static guint dissect_llrp_utf8_parameter(tvbuff_t * const tvb, packet_info *pinfo,",
          "1431:         proto_tree * const tree, const guint hfindex, const guint offset)",
          "",
          "[Removed Lines]",
          "1428:         guint offset, const guint end);",
          "",
          "[Added Lines]",
          "1428:         guint offset, const guint end, const guint depth);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1720:         break;",
          "1721:     }",
          "1724: }",
          "1726: static guint",
          "1727: dissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1729: {",
          "1730:     guint8      has_length;",
          "1731:     guint16     len, type;",
          "",
          "[Removed Lines]",
          "1723:     return dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1728:         guint offset, const guint end)",
          "",
          "[Added Lines]",
          "1723:     return dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, 0);",
          "1728:         guint offset, const guint end, const guint depth)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1754:             param_end = offset + real_len;",
          "1756:             ti = proto_tree_add_none_format(tree, hf_llrp_param, tvb,",
          "1757:                     offset, real_len, \"TLV Parameter: %s\",",
          "1758:                     val_to_str_ext(type, &tlv_type_ext, \"Unknown Type: %d\"));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1756:             if (depth > 16) {",
          "1757:                 return param_end;",
          "1758:             }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1781:             case LLRP_TLV_READER_EVENT_NOTI_DATA:",
          "1782:             case LLRP_TLV_C1G2_UHF_RF_MD_TBL:",
          "1783:             case LLRP_TLV_C1G2_TAG_SPEC:",
          "1785:                 break;",
          "1786:             case LLRP_TLV_UTC_TIMESTAMP:",
          "1787:             case LLRP_TLV_UPTIME:",
          "",
          "[Removed Lines]",
          "1784:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1788:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1794:                 PARAM_TREE_ADD(device_manufacturer, 4, ENC_BIG_ENDIAN);",
          "1795:                 PARAM_TREE_ADD(model, 4, ENC_BIG_ENDIAN);",
          "1796:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_firmware_version, suboffset);",
          "1798:                 break;",
          "1799:             case LLRP_TLV_MAX_RECEIVE_SENSE:",
          "1800:                 PARAM_TREE_ADD(max_receive_sense, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1797:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1801:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1859:             case LLRP_TLV_REGU_CAPABILITIES:",
          "1860:                 PARAM_TREE_ADD(country_code, 2, ENC_BIG_ENDIAN);",
          "1861:                 PARAM_TREE_ADD(comm_standard, 2, ENC_BIG_ENDIAN);",
          "1863:                 break;",
          "1864:             case LLRP_TLV_XMIT_POWER_LEVEL_ENTRY:",
          "1865:                 PARAM_TREE_ADD(index, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1862:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1866:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1867:                 break;",
          "1868:             case LLRP_TLV_FREQ_INFORMATION:",
          "1869:                 PARAM_TREE_ADD(hopping, 1, ENC_NA);",
          "1871:                 break;",
          "1872:             case LLRP_TLV_FREQ_HOP_TABLE:",
          "1873:                 PARAM_TREE_ADD(hop_table_id, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1870:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1874:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1887:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "1888:                 PARAM_TREE_ADD(priority, 1, ENC_NA);",
          "1889:                 PARAM_TREE_ADD(cur_state, 1, ENC_NA);",
          "1891:                 break;",
          "1892:             case LLRP_TLV_RO_SPEC_START_TRIGGER:",
          "1893:                 PARAM_TREE_ADD(rospec_start_trig_type, 1, ENC_NA);",
          "1895:                 break;",
          "1896:             case LLRP_TLV_PER_TRIGGER_VAL:",
          "1897:                 PARAM_TREE_ADD(offset, 4, ENC_BIG_ENDIAN);",
          "1898:                 PARAM_TREE_ADD(period, 4, ENC_BIG_ENDIAN);",
          "1900:                 break;",
          "1901:             case LLRP_TLV_GPI_TRIGGER_VAL:",
          "1902:                 PARAM_TREE_ADD(gpi_port, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1890:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1894:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1899:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1894:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1898:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1903:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1906:             case LLRP_TLV_RO_SPEC_STOP_TRIGGER:",
          "1907:                 PARAM_TREE_ADD(rospec_stop_trig_type, 1, ENC_NA);",
          "1908:                 PARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);",
          "1910:                 break;",
          "1911:             case LLRP_TLV_AI_SPEC:",
          "1912:                 suboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,",
          "1913:                         hf_llrp_antenna_count, hf_llrp_antenna, 2, suboffset);",
          "1915:                 break;",
          "1916:             case LLRP_TLV_AI_SPEC_STOP:",
          "1917:                 PARAM_TREE_ADD(aispec_stop_trig_type, 1, ENC_NA);",
          "1918:                 PARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);",
          "1920:                 break;",
          "1921:             case LLRP_TLV_TAG_OBSERV_TRIGGER:",
          "1922:                 PARAM_TREE_ADD(trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1909:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1914:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1919:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1913:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1918:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1923:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1929:             case LLRP_TLV_INVENTORY_PARAM_SPEC:",
          "1930:                 PARAM_TREE_ADD(inventory_spec_id, 2, ENC_BIG_ENDIAN);",
          "1931:                 PARAM_TREE_ADD(protocol_id, 1, ENC_NA);",
          "1933:                 break;",
          "1934:             case LLRP_TLV_RF_SURVEY_SPEC:",
          "1935:                 PARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);",
          "1936:                 PARAM_TREE_ADD(start_freq, 4, ENC_BIG_ENDIAN);",
          "1937:                 PARAM_TREE_ADD(stop_freq, 4, ENC_BIG_ENDIAN);",
          "1939:                 break;",
          "1940:             case LLRP_TLV_RF_SURVEY_SPEC_STOP_TR:",
          "1941:                 PARAM_TREE_ADD(stop_trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1932:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1938:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1936:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1942:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1951:                 PARAM_TREE_ADD(protocol_id, 1, ENC_BIG_ENDIAN);",
          "1952:                 PARAM_TREE_ADD(access_cur_state, 1, ENC_NA);",
          "1953:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "1955:                 break;",
          "1956:             case LLRP_TLV_ACCESS_SPEC_STOP_TRIG:",
          "1957:                 PARAM_TREE_ADD(access_stop_trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1954:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1958:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1962:                 break;",
          "1963:             case LLRP_TLV_CLIENT_REQ_RESPONSE:",
          "1964:                 PARAM_TREE_ADD(accessspec_id, 2, ENC_BIG_ENDIAN);",
          "1966:                 break;",
          "1967:             case LLRP_TLV_LLRP_CONF_STATE_VAL:",
          "1968:                 PARAM_TREE_ADD(conf_value, 4, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1965:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1969:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1988:                 break;",
          "1989:             case LLRP_TLV_ANTENNA_CONF:",
          "1990:                 PARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);",
          "1992:                 break;",
          "1993:             case LLRP_TLV_RF_RECEIVER:",
          "1994:                 PARAM_TREE_ADD(receiver_sense, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1991:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1995:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "2009:             case LLRP_TLV_RO_REPORT_SPEC:",
          "2010:                 PARAM_TREE_ADD(ro_report_trig, 1, ENC_NA);",
          "2011:                 PARAM_TREE_ADD(n_2, 2, ENC_BIG_ENDIAN);",
          "2013:                 break;",
          "2014:             case LLRP_TLV_TAG_REPORT_CONTENT_SEL:",
          "2015:                 PARAM_TREE_ADD_STAY(enable_rospec_id, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "2012:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2016:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "2022:                 PARAM_TREE_ADD_STAY(enable_last_seen, 2, ENC_BIG_ENDIAN);",
          "2023:                 PARAM_TREE_ADD_STAY(enable_seen_count, 2, ENC_BIG_ENDIAN);",
          "2024:                 PARAM_TREE_ADD(enable_accessspec_id, 2, ENC_BIG_ENDIAN);",
          "2026:                 break;",
          "2027:             case LLRP_TLV_ACCESS_REPORT_SPEC:",
          "2028:                 PARAM_TREE_ADD(access_report_trig, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2025:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2029:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "2035:                 PARAM_TREE_ADD(bandwidth, 4, ENC_BIG_ENDIAN);",
          "2036:                 PARAM_TREE_ADD(average_rssi, 1, ENC_NA);",
          "2037:                 PARAM_TREE_ADD(peak_rssi, 1, ENC_NA);",
          "2039:                 break;",
          "2040:             case LLRP_TLV_EVENT_NOTIF_STATE:",
          "2041:                 PARAM_TREE_ADD(event_type, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "2038:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2042:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "2057:             case LLRP_TLV_REPORT_BUF_LEVEL_WARN:",
          "2058:                 PARAM_TREE_ADD(buffer_full_percentage, 1, ENC_NA);",
          "2059:                 break;",
          "2062:             case LLRP_TLV_READER_EXCEPTION_EVENT:",
          "2063:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_message, suboffset);",
          "2065:                 break;",
          "2066:             case LLRP_TLV_RF_SURVEY_EVENT:",
          "2067:                 PARAM_TREE_ADD(rfevent_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2060:             case LLRP_TLV_REPORT_BUF_OVERFLOW_ERR:",
          "2061:                 break;",
          "2064:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2064:             case LLRP_TLV_REPORT_BUF_OVERFLOW_ERR: break;",
          "2067:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "2072:                 PARAM_TREE_ADD(aievent_type, 1, ENC_NA);",
          "2073:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "2074:                 PARAM_TREE_ADD(spec_idx, 2, ENC_BIG_ENDIAN);",
          "2076:                 break;",
          "2077:             case LLRP_TLV_ANTENNA_EVENT:",
          "2078:                 PARAM_TREE_ADD(antenna_event_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2075:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2078:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "2090:             case LLRP_TLV_LLRP_STATUS:",
          "2091:                 PARAM_TREE_ADD(status_code, 2, ENC_BIG_ENDIAN);",
          "2092:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_error_desc, suboffset);",
          "2094:                 break;",
          "2095:             case LLRP_TLV_FIELD_ERROR:",
          "2096:                 PARAM_TREE_ADD(field_num, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "2093:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2096:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "2099:             case LLRP_TLV_PARAM_ERROR:",
          "2100:                 PARAM_TREE_ADD(parameter_type, 2, ENC_BIG_ENDIAN);",
          "2101:                 PARAM_TREE_ADD(error_code, 2, ENC_BIG_ENDIAN);",
          "2103:                 break;",
          "2104:             case LLRP_TLV_C1G2_LLRP_CAP:",
          "2105:                 PARAM_TREE_ADD_STAY(can_support_block_erase, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2102:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2105:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "2130:                 break;",
          "2131:             case LLRP_TLV_C1G2_INVENTORY_COMMAND:",
          "2132:                 PARAM_TREE_ADD(inventory_state_aware, 1, ENC_NA);",
          "2134:                 break;",
          "2135:             case LLRP_TLV_C1G2_FILTER:",
          "2136:                 PARAM_TREE_ADD(trunc, 1, ENC_NA);",
          "2138:                 break;",
          "2139:             case LLRP_TLV_C1G2_TAG_INV_MASK:",
          "2140:                 PARAM_TREE_ADD(mb, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2133:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "2137:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2136:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "2140:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "2156:                 PARAM_TREE_ADD(session, 1, ENC_NA);",
          "2157:                 PARAM_TREE_ADD(tag_population, 2, ENC_BIG_ENDIAN);",
          "2158:                 PARAM_TREE_ADD(tag_transit_time, 4, ENC_BIG_ENDIAN);",
          "2160:                 break;",
          "2161:             case LLRP_TLV_C1G2_TAG_INV_AWARE_SING:",
          "2162:                 PARAM_TREE_ADD_STAY(sing_i, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2159:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2162:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "2200:             case LLRP_TLV_C1G2_LOCK:",
          "2201:                 PARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);",
          "2202:                 PARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);",
          "2204:                 break;",
          "2205:             case LLRP_TLV_C1G2_LOCK_PAYLOAD:",
          "2206:                 PARAM_TREE_ADD(privilege, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2203:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2206:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "2641:             DISSECTOR_ASSERT_NOT_REACHED();",
          "2642:     };",
          "2643:     if(ends_with_parameters) {",
          "2645:     }",
          "2646:     if(tvb_reported_length_remaining(tvb, offset) != 0) {",
          "",
          "[Removed Lines]",
          "2644:         offset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb));",
          "",
          "[Added Lines]",
          "2647:         offset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb), 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "74085a5911b2c9d3120f0a978698455cd191636a",
      "candidate_info": {
        "commit_hash": "74085a5911b2c9d3120f0a978698455cd191636a",
        "repo": "wireshark/wireshark",
        "commit_url": "https://github.com/wireshark/wireshark/commit/74085a5911b2c9d3120f0a978698455cd191636a",
        "files": [
          "epan/dissectors/packet-llrp.c"
        ],
        "message": "llrp: limit recursion depth\n\nLLRP defines fairly complex parameter nesting which we handle via recursion,\nhowever this means a large crafted packet could cause very deep stacks and\npotentially stack overflows. Limit our recursive depth to an arbitrary, which\nshould be more than enough for any legitimate packet (I hope).\n\nBug: 12048\nChange-Id: I9ac31bddfa4ffd1a79809387d10d2261749b95e7\nReviewed-on: https://code.wireshark.org/review/13796\nReviewed-by: Anders Broman <a.broman58@gmail.com>",
        "before_after_code_files": [
          "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
          ],
          "candidate": [
            "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c"
          ]
        }
      },
      "candidate_diff": {
        "epan/dissectors/packet-llrp.c||epan/dissectors/packet-llrp.c": [
          "File: epan/dissectors/packet-llrp.c -> epan/dissectors/packet-llrp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1380: static guint",
          "1381: dissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1384: static guint dissect_llrp_utf8_parameter(tvbuff_t * const tvb, packet_info *pinfo,",
          "1385:         proto_tree * const tree, const guint hfindex, const guint offset)",
          "",
          "[Removed Lines]",
          "1382:         guint offset, const guint end);",
          "",
          "[Added Lines]",
          "1382:         guint offset, const guint end, const guint depth);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1663:         break;",
          "1664:     }",
          "1667: }",
          "1669: static guint",
          "1670: dissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,",
          "1672: {",
          "1673:     guint8      has_length;",
          "1674:     guint16     len, type;",
          "",
          "[Removed Lines]",
          "1666:     return dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1671:         guint offset, const guint end)",
          "",
          "[Added Lines]",
          "1666:     return dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, 0);",
          "1671:         guint offset, const guint end, const guint depth)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1697:             param_end = offset + real_len;",
          "1699:             ti = proto_tree_add_none_format(tree, hf_llrp_param, tvb,",
          "1700:                     offset, real_len, \"TLV Parameter: %s\",",
          "1701:                     val_to_str_ext(type, &tlv_type_ext, \"Unknown Type: %d\"));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1699:             if (depth > 16) {",
          "1700:                 return param_end;",
          "1701:             }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1724:             case LLRP_TLV_READER_EVENT_NOTI_DATA:",
          "1725:             case LLRP_TLV_C1G2_UHF_RF_MD_TBL:",
          "1726:             case LLRP_TLV_C1G2_TAG_SPEC:",
          "1728:                 break;",
          "1729:             case LLRP_TLV_UTC_TIMESTAMP:",
          "1730:             case LLRP_TLV_UPTIME:",
          "",
          "[Removed Lines]",
          "1727:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1731:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1737:                 PARAM_TREE_ADD(device_manufacturer, 4, ENC_BIG_ENDIAN);",
          "1738:                 PARAM_TREE_ADD(model, 4, ENC_BIG_ENDIAN);",
          "1739:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_firmware_version, suboffset);",
          "1741:                 break;",
          "1742:             case LLRP_TLV_MAX_RECEIVE_SENSE:",
          "1743:                 PARAM_TREE_ADD(max_receive_sense, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1740:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1744:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1802:             case LLRP_TLV_REGU_CAPABILITIES:",
          "1803:                 PARAM_TREE_ADD(country_code, 2, ENC_BIG_ENDIAN);",
          "1804:                 PARAM_TREE_ADD(comm_standard, 2, ENC_BIG_ENDIAN);",
          "1806:                 break;",
          "1807:             case LLRP_TLV_XMIT_POWER_LEVEL_ENTRY:",
          "1808:                 PARAM_TREE_ADD(index, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1805:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1809:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1810:                 break;",
          "1811:             case LLRP_TLV_FREQ_INFORMATION:",
          "1812:                 PARAM_TREE_ADD(hopping, 1, ENC_NA);",
          "1814:                 break;",
          "1815:             case LLRP_TLV_FREQ_HOP_TABLE:",
          "1816:                 PARAM_TREE_ADD(hop_table_id, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1813:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1817:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1830:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "1831:                 PARAM_TREE_ADD(priority, 1, ENC_NA);",
          "1832:                 PARAM_TREE_ADD(cur_state, 1, ENC_NA);",
          "1834:                 break;",
          "1835:             case LLRP_TLV_RO_SPEC_START_TRIGGER:",
          "1836:                 PARAM_TREE_ADD(rospec_start_trig_type, 1, ENC_NA);",
          "1838:                 break;",
          "1839:             case LLRP_TLV_PER_TRIGGER_VAL:",
          "1840:                 PARAM_TREE_ADD(offset, 4, ENC_BIG_ENDIAN);",
          "1841:                 PARAM_TREE_ADD(period, 4, ENC_BIG_ENDIAN);",
          "1843:                 break;",
          "1844:             case LLRP_TLV_GPI_TRIGGER_VAL:",
          "1845:                 PARAM_TREE_ADD(gpi_port, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1833:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1837:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1842:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1837:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1841:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1846:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1849:             case LLRP_TLV_RO_SPEC_STOP_TRIGGER:",
          "1850:                 PARAM_TREE_ADD(rospec_stop_trig_type, 1, ENC_NA);",
          "1851:                 PARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);",
          "1853:                 break;",
          "1854:             case LLRP_TLV_AI_SPEC:",
          "1855:                 suboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,",
          "1856:                         hf_llrp_antenna_count, hf_llrp_antenna, 2, suboffset);",
          "1858:                 break;",
          "1859:             case LLRP_TLV_AI_SPEC_STOP:",
          "1860:                 PARAM_TREE_ADD(aispec_stop_trig_type, 1, ENC_NA);",
          "1861:                 PARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);",
          "1863:                 break;",
          "1864:             case LLRP_TLV_TAG_OBSERV_TRIGGER:",
          "1865:                 PARAM_TREE_ADD(trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1852:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1857:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1862:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1856:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1861:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1866:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1872:             case LLRP_TLV_INVENTORY_PARAM_SPEC:",
          "1873:                 PARAM_TREE_ADD(inventory_spec_id, 2, ENC_BIG_ENDIAN);",
          "1874:                 PARAM_TREE_ADD(protocol_id, 1, ENC_NA);",
          "1876:                 break;",
          "1877:             case LLRP_TLV_RF_SURVEY_SPEC:",
          "1878:                 PARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);",
          "1879:                 PARAM_TREE_ADD(start_freq, 4, ENC_BIG_ENDIAN);",
          "1880:                 PARAM_TREE_ADD(stop_freq, 4, ENC_BIG_ENDIAN);",
          "1882:                 break;",
          "1883:             case LLRP_TLV_RF_SURVEY_SPEC_STOP_TR:",
          "1884:                 PARAM_TREE_ADD(stop_trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1875:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "1881:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1879:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "1885:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1894:                 PARAM_TREE_ADD(protocol_id, 1, ENC_BIG_ENDIAN);",
          "1895:                 PARAM_TREE_ADD(access_cur_state, 1, ENC_NA);",
          "1896:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "1898:                 break;",
          "1899:             case LLRP_TLV_ACCESS_SPEC_STOP_TRIG:",
          "1900:                 PARAM_TREE_ADD(access_stop_trig_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1897:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1901:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1905:                 break;",
          "1906:             case LLRP_TLV_CLIENT_REQ_RESPONSE:",
          "1907:                 PARAM_TREE_ADD(accessspec_id, 2, ENC_BIG_ENDIAN);",
          "1909:                 break;",
          "1910:             case LLRP_TLV_LLRP_CONF_STATE_VAL:",
          "1911:                 PARAM_TREE_ADD(conf_value, 4, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1908:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1912:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1931:                 break;",
          "1932:             case LLRP_TLV_ANTENNA_CONF:",
          "1933:                 PARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);",
          "1935:                 break;",
          "1936:             case LLRP_TLV_RF_RECEIVER:",
          "1937:                 PARAM_TREE_ADD(receiver_sense, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1934:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1938:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1952:             case LLRP_TLV_RO_REPORT_SPEC:",
          "1953:                 PARAM_TREE_ADD(ro_report_trig, 1, ENC_NA);",
          "1954:                 PARAM_TREE_ADD(n_2, 2, ENC_BIG_ENDIAN);",
          "1956:                 break;",
          "1957:             case LLRP_TLV_TAG_REPORT_CONTENT_SEL:",
          "1958:                 PARAM_TREE_ADD_STAY(enable_rospec_id, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1955:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1959:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1965:                 PARAM_TREE_ADD_STAY(enable_last_seen, 2, ENC_BIG_ENDIAN);",
          "1966:                 PARAM_TREE_ADD_STAY(enable_seen_count, 2, ENC_BIG_ENDIAN);",
          "1967:                 PARAM_TREE_ADD(enable_accessspec_id, 2, ENC_BIG_ENDIAN);",
          "1969:                 break;",
          "1970:             case LLRP_TLV_ACCESS_REPORT_SPEC:",
          "1971:                 PARAM_TREE_ADD(access_report_trig, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "1968:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1972:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1978:                 PARAM_TREE_ADD(bandwidth, 4, ENC_BIG_ENDIAN);",
          "1979:                 PARAM_TREE_ADD(average_rssi, 1, ENC_NA);",
          "1980:                 PARAM_TREE_ADD(peak_rssi, 1, ENC_NA);",
          "1982:                 break;",
          "1983:             case LLRP_TLV_EVENT_NOTIF_STATE:",
          "1984:                 PARAM_TREE_ADD(event_type, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "1981:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "1985:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "2000:             case LLRP_TLV_REPORT_BUF_LEVEL_WARN:",
          "2001:                 PARAM_TREE_ADD(buffer_full_percentage, 1, ENC_NA);",
          "2002:                 break;",
          "2005:             case LLRP_TLV_READER_EXCEPTION_EVENT:",
          "2006:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_message, suboffset);",
          "2008:                 break;",
          "2009:             case LLRP_TLV_RF_SURVEY_EVENT:",
          "2010:                 PARAM_TREE_ADD(rfevent_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2003:             case LLRP_TLV_REPORT_BUF_OVERFLOW_ERR:",
          "2004:                 break;",
          "2007:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2007:             case LLRP_TLV_REPORT_BUF_OVERFLOW_ERR: break;",
          "2010:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "2015:                 PARAM_TREE_ADD(aievent_type, 1, ENC_NA);",
          "2016:                 PARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);",
          "2017:                 PARAM_TREE_ADD(spec_idx, 2, ENC_BIG_ENDIAN);",
          "2019:                 break;",
          "2020:             case LLRP_TLV_ANTENNA_EVENT:",
          "2021:                 PARAM_TREE_ADD(antenna_event_type, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2018:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2021:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "2033:             case LLRP_TLV_LLRP_STATUS:",
          "2034:                 PARAM_TREE_ADD(status_code, 2, ENC_BIG_ENDIAN);",
          "2035:                 suboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_error_desc, suboffset);",
          "2037:                 break;",
          "2038:             case LLRP_TLV_FIELD_ERROR:",
          "2039:                 PARAM_TREE_ADD(field_num, 2, ENC_BIG_ENDIAN);",
          "",
          "[Removed Lines]",
          "2036:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2039:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "2042:             case LLRP_TLV_PARAM_ERROR:",
          "2043:                 PARAM_TREE_ADD(parameter_type, 2, ENC_BIG_ENDIAN);",
          "2044:                 PARAM_TREE_ADD(error_code, 2, ENC_BIG_ENDIAN);",
          "2046:                 break;",
          "2047:             case LLRP_TLV_C1G2_LLRP_CAP:",
          "2048:                 PARAM_TREE_ADD_STAY(can_support_block_erase, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2045:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2048:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "2073:                 break;",
          "2074:             case LLRP_TLV_C1G2_INVENTORY_COMMAND:",
          "2075:                 PARAM_TREE_ADD(inventory_state_aware, 1, ENC_NA);",
          "2077:                 break;",
          "2078:             case LLRP_TLV_C1G2_FILTER:",
          "2079:                 PARAM_TREE_ADD(trunc, 1, ENC_NA);",
          "2081:                 break;",
          "2082:             case LLRP_TLV_C1G2_TAG_INV_MASK:",
          "2083:                 PARAM_TREE_ADD(mb, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2076:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "2080:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2079:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "2083:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "2099:                 PARAM_TREE_ADD(session, 1, ENC_NA);",
          "2100:                 PARAM_TREE_ADD(tag_population, 2, ENC_BIG_ENDIAN);",
          "2101:                 PARAM_TREE_ADD(tag_transit_time, 4, ENC_BIG_ENDIAN);",
          "2103:                 break;",
          "2104:             case LLRP_TLV_C1G2_TAG_INV_AWARE_SING:",
          "2105:                 PARAM_TREE_ADD_STAY(sing_i, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2102:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2105:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "2143:             case LLRP_TLV_C1G2_LOCK:",
          "2144:                 PARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);",
          "2145:                 PARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);",
          "2147:                 break;",
          "2148:             case LLRP_TLV_C1G2_LOCK_PAYLOAD:",
          "2149:                 PARAM_TREE_ADD(privilege, 1, ENC_NA);",
          "",
          "[Removed Lines]",
          "2146:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end);",
          "",
          "[Added Lines]",
          "2149:                 suboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "2584:             DISSECTOR_ASSERT_NOT_REACHED();",
          "2585:     };",
          "2586:     if(ends_with_parameters) {",
          "2588:     }",
          "2589:     if(tvb_reported_length_remaining(tvb, offset) != 0) {",
          "",
          "[Removed Lines]",
          "2587:         offset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb));",
          "",
          "[Added Lines]",
          "2590:         offset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb), 0);",
          "",
          "---------------"
        ]
      }
    }
  ]
}