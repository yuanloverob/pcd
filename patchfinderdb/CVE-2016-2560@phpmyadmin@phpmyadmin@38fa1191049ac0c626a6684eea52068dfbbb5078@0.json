{
  "cve_id": "CVE-2016-2560",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.15, 4.4.x before 4.4.15.5, and 4.5.x before 4.5.5.1 allow remote attackers to inject arbitrary web script or HTML via (1) a crafted Host HTTP header, related to libraries/Config.class.php; (2) crafted JSON data, related to file_echo.php; (3) a crafted SQL query, related to js/functions.js; (4) the initial parameter to libraries/server_privileges.lib.php in the user accounts page; or (5) the it parameter to libraries/controllers/TableSearchController.class.php in the zoom search page.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "38fa1191049ac0c626a6684eea52068dfbbb5078",
  "patch_info": {
    "commit_hash": "38fa1191049ac0c626a6684eea52068dfbbb5078",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/38fa1191049ac0c626a6684eea52068dfbbb5078",
    "files": [
      "libraries/Config.class.php"
    ],
    "message": "Urlencode hostname\n\nThis can come from the HTTP header, so we need to be sure to sanitize\nit.\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
    "before_after_code_files": [
      "libraries/Config.class.php||libraries/Config.class.php"
    ]
  },
  "patch_diff": {
    "libraries/Config.class.php||libraries/Config.class.php": [
      "File: libraries/Config.class.php -> libraries/Config.class.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1370:                 $pma_absolute_uri .= '@';",
      "1371:             }",
      "1376:             if (! empty($url['port'])",
      "",
      "[Removed Lines]",
      "1373:             $pma_absolute_uri .= $url['host'];",
      "",
      "[Added Lines]",
      "1373:             $pma_absolute_uri .= urlencode($url['host']);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "73c8245a3d1893a710447957e28dcfb18d9b47ad",
      "candidate_info": {
        "commit_hash": "73c8245a3d1893a710447957e28dcfb18d9b47ad",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/73c8245a3d1893a710447957e28dcfb18d9b47ad",
        "files": [
          "libraries/Config.class.php"
        ],
        "message": "Urlencode hostname\n\nThis can come from the HTTP header, so we need to be sure to sanitize\nit.\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
        "before_after_code_files": [
          "libraries/Config.class.php||libraries/Config.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libraries/Config.class.php||libraries/Config.class.php"
          ],
          "candidate": [
            "libraries/Config.class.php||libraries/Config.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/Config.class.php||libraries/Config.class.php": [
          "File: libraries/Config.class.php -> libraries/Config.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1291:                 $pma_absolute_uri .= '@';",
          "1292:             }",
          "1296:             if (! empty($url['port'])",
          "1297:                 && (($url['scheme'] == 'http' && $url['port'] != 80)",
          "",
          "[Removed Lines]",
          "1294:             $pma_absolute_uri .= $url['host'];",
          "",
          "[Added Lines]",
          "1294:             $pma_absolute_uri .= urlencode($url['host']);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9ec0b598bd0c5a5b63e483801057ab8a22e82527",
      "candidate_info": {
        "commit_hash": "9ec0b598bd0c5a5b63e483801057ab8a22e82527",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/9ec0b598bd0c5a5b63e483801057ab8a22e82527",
        "files": [
          "libraries/Config.class.php"
        ],
        "message": "Urlencode hostname\n\nThis can come from the HTTP header, so we need to be sure to sanitize\nit.\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
        "before_after_code_files": [
          "libraries/Config.class.php||libraries/Config.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libraries/Config.class.php||libraries/Config.class.php"
          ],
          "candidate": [
            "libraries/Config.class.php||libraries/Config.class.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/Config.class.php||libraries/Config.class.php": [
          "File: libraries/Config.class.php -> libraries/Config.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1347:                 $pma_absolute_uri .= '@';",
          "1348:             }",
          "1352:             if (! empty($url['port'])",
          "1353:                 && (($url['scheme'] == 'http' && $url['port'] != 80)",
          "",
          "[Removed Lines]",
          "1350:             $pma_absolute_uri .= $url['host'];",
          "",
          "[Added Lines]",
          "1350:             $pma_absolute_uri .= urlencode($url['host']);",
          "",
          "---------------"
        ]
      }
    }
  ]
}