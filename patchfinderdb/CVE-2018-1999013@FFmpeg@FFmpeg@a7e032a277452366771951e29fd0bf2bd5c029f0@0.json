{
  "cve_id": "CVE-2018-1999013",
  "cve_desc": "FFmpeg before commit a7e032a277452366771951e29fd0bf2bd5c029f0 contains a use-after-free vulnerability in the realmedia demuxer that can result in vulnerability allows attacker to read heap memory. This attack appear to be exploitable via specially crafted RM file has to be provided as input. This vulnerability appears to have been fixed in a7e032a277452366771951e29fd0bf2bd5c029f0 and later.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "a7e032a277452366771951e29fd0bf2bd5c029f0",
  "patch_info": {
    "commit_hash": "a7e032a277452366771951e29fd0bf2bd5c029f0",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/a7e032a277452366771951e29fd0bf2bd5c029f0",
    "files": [
      "libavformat/rmdec.c"
    ],
    "message": "avformat/rmdec: Do not pass mime type in rm_read_multi() to ff_rm_read_mdpr_codecdata()\n\nFixes: use after free()\nFixes: rmdec-crash-ffe85b4cab1597d1cfea6955705e53f1f5c8a362\n\nFound-by: Paul Ch <paulcher@icloud.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "before_after_code_files": [
      "libavformat/rmdec.c||libavformat/rmdec.c"
    ]
  },
  "patch_diff": {
    "libavformat/rmdec.c||libavformat/rmdec.c": [
      "File: libavformat/rmdec.c -> libavformat/rmdec.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "523:         size2 = avio_rb32(pb);",
      "524:         ret = ff_rm_read_mdpr_codecdata(s, s->pb, st2, st2->priv_data,",
      "526:         if (ret < 0)",
      "527:             return ret;",
      "528:     }",
      "",
      "[Removed Lines]",
      "525:                                         size2, mime);",
      "",
      "[Added Lines]",
      "525:                                         size2, NULL);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "34654d41d4bd9abb3b848477a6dd0a7d33816d4e",
      "candidate_info": {
        "commit_hash": "34654d41d4bd9abb3b848477a6dd0a7d33816d4e",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/34654d41d4bd9abb3b848477a6dd0a7d33816d4e",
        "files": [
          "libavformat/rmdec.c"
        ],
        "message": "avformat/rmdec: Do not pass mime type in rm_read_multi() to ff_rm_read_mdpr_codecdata()\n\nFixes: use after free()\nFixes: rmdec-crash-ffe85b4cab1597d1cfea6955705e53f1f5c8a362\n\nFound-by: Paul Ch <paulcher@icloud.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a7e032a277452366771951e29fd0bf2bd5c029f0)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/rmdec.c||libavformat/rmdec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ],
          "candidate": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/rmdec.c||libavformat/rmdec.c": [
          "File: libavformat/rmdec.c -> libavformat/rmdec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "527:         size2 = avio_rb32(pb);",
          "528:         ret = ff_rm_read_mdpr_codecdata(s, s->pb, st2, st2->priv_data,",
          "530:         if (ret < 0)",
          "531:             return ret;",
          "532:     }",
          "",
          "[Removed Lines]",
          "529:                                         size2, mime);",
          "",
          "[Added Lines]",
          "529:                                         size2, NULL);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ee8c6566e2abd9ae46976dba9873ecd9bb24001f",
      "candidate_info": {
        "commit_hash": "ee8c6566e2abd9ae46976dba9873ecd9bb24001f",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/ee8c6566e2abd9ae46976dba9873ecd9bb24001f",
        "files": [
          "libavformat/rmdec.c"
        ],
        "message": "avformat/rmdec: Do not pass mime type in rm_read_multi() to ff_rm_read_mdpr_codecdata()\n\nFixes: use after free()\nFixes: rmdec-crash-ffe85b4cab1597d1cfea6955705e53f1f5c8a362\n\nFound-by: Paul Ch <paulcher@icloud.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a7e032a277452366771951e29fd0bf2bd5c029f0)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/rmdec.c||libavformat/rmdec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ],
          "candidate": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/rmdec.c||libavformat/rmdec.c": [
          "File: libavformat/rmdec.c -> libavformat/rmdec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "524:         size2 = avio_rb32(pb);",
          "525:         ret = ff_rm_read_mdpr_codecdata(s, s->pb, st2, st2->priv_data,",
          "527:         if (ret < 0)",
          "528:             return ret;",
          "529:     }",
          "",
          "[Removed Lines]",
          "526:                                         size2, mime);",
          "",
          "[Added Lines]",
          "526:                                         size2, NULL);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "09401d0a0abec4d1db395af3ddb2c610c5b51153",
      "candidate_info": {
        "commit_hash": "09401d0a0abec4d1db395af3ddb2c610c5b51153",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/09401d0a0abec4d1db395af3ddb2c610c5b51153",
        "files": [
          "libavformat/rmdec.c"
        ],
        "message": "avformat/rmdec: Do not pass mime type in rm_read_multi() to ff_rm_read_mdpr_codecdata()\n\nFixes: use after free()\nFixes: rmdec-crash-ffe85b4cab1597d1cfea6955705e53f1f5c8a362\n\nFound-by: Paul Ch <paulcher@icloud.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a7e032a277452366771951e29fd0bf2bd5c029f0)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/rmdec.c||libavformat/rmdec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ],
          "candidate": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/rmdec.c||libavformat/rmdec.c": [
          "File: libavformat/rmdec.c -> libavformat/rmdec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "527:         size2 = avio_rb32(pb);",
          "528:         ret = ff_rm_read_mdpr_codecdata(s, s->pb, st2, st2->priv_data,",
          "530:         if (ret < 0)",
          "531:             return ret;",
          "532:     }",
          "",
          "[Removed Lines]",
          "529:                                         size2, mime);",
          "",
          "[Added Lines]",
          "529:                                         size2, NULL);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4a42353c7a0c906a38c7cfc2fe29c0242a2c2231",
      "candidate_info": {
        "commit_hash": "4a42353c7a0c906a38c7cfc2fe29c0242a2c2231",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/4a42353c7a0c906a38c7cfc2fe29c0242a2c2231",
        "files": [
          "libavformat/rmdec.c"
        ],
        "message": "avformat/rmdec: Do not pass mime type in rm_read_multi() to ff_rm_read_mdpr_codecdata()\n\nFixes: use after free()\nFixes: rmdec-crash-ffe85b4cab1597d1cfea6955705e53f1f5c8a362\n\nFound-by: Paul Ch <paulcher@icloud.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a7e032a277452366771951e29fd0bf2bd5c029f0)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/rmdec.c||libavformat/rmdec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ],
          "candidate": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/rmdec.c||libavformat/rmdec.c": [
          "File: libavformat/rmdec.c -> libavformat/rmdec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "525:         size2 = avio_rb32(pb);",
          "526:         ret = ff_rm_read_mdpr_codecdata(s, s->pb, st2, st2->priv_data,",
          "528:         if (ret < 0)",
          "529:             return ret;",
          "530:     }",
          "",
          "[Removed Lines]",
          "527:                                         size2, mime);",
          "",
          "[Added Lines]",
          "527:                                         size2, NULL);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "37f505cc853f592d93b6285c8a91eece2e5b8b07",
      "candidate_info": {
        "commit_hash": "37f505cc853f592d93b6285c8a91eece2e5b8b07",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/37f505cc853f592d93b6285c8a91eece2e5b8b07",
        "files": [
          "libavformat/rmdec.c"
        ],
        "message": "avformat/rmdec: Do not pass mime type in rm_read_multi() to ff_rm_read_mdpr_codecdata()\n\nFixes: use after free()\nFixes: rmdec-crash-ffe85b4cab1597d1cfea6955705e53f1f5c8a362\n\nFound-by: Paul Ch <paulcher@icloud.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a7e032a277452366771951e29fd0bf2bd5c029f0)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/rmdec.c||libavformat/rmdec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ],
          "candidate": [
            "libavformat/rmdec.c||libavformat/rmdec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/rmdec.c||libavformat/rmdec.c": [
          "File: libavformat/rmdec.c -> libavformat/rmdec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "523:         size2 = avio_rb32(pb);",
          "524:         ret = ff_rm_read_mdpr_codecdata(s, s->pb, st2, st2->priv_data,",
          "526:         if (ret < 0)",
          "527:             return ret;",
          "528:     }",
          "",
          "[Removed Lines]",
          "525:                                         size2, mime);",
          "",
          "[Added Lines]",
          "525:                                         size2, NULL);",
          "",
          "---------------"
        ]
      }
    }
  ]
}