{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "b4a2c06a2ef36de6245e69ad6162a2698940154c",
      "candidate_info": {
        "commit_hash": "b4a2c06a2ef36de6245e69ad6162a2698940154c",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/b4a2c06a2ef36de6245e69ad6162a2698940154c",
        "files": [
          "src/iso.c",
          "src/msapi_utf8.h",
          "src/process.c",
          "src/rufus.c",
          "src/rufus.h",
          "src/rufus.rc",
          "src/stdfn.c",
          "src/stdlg.c"
        ],
        "message": "[ui] ask user if they want proceed when conflicting processes are found\n\n* Rufus now checks for processes with handles opened on the drives/volumes before\n  starting the format operation and asks the user if they want to continue.\n* This mimics Windows' behaviour when formatting drives, and actually uses the\n  same message as the one from shell32.dll.mui.\n* Closes #773",
        "before_after_code_files": [
          "src/iso.c||src/iso.c",
          "src/msapi_utf8.h||src/msapi_utf8.h",
          "src/process.c||src/process.c",
          "src/rufus.c||src/rufus.c",
          "src/rufus.h||src/rufus.h",
          "src/rufus.rc||src/rufus.rc",
          "src/stdfn.c||src/stdfn.c",
          "src/stdlg.c||src/stdlg.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc",
            "src/stdlg.c||src/stdlg.c"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc",
            "src/stdlg.c||src/stdlg.c"
          ]
        }
      },
      "candidate_diff": {
        "src/iso.c||src/iso.c": [
          "File: src/iso.c -> src/iso.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "277:   if ((iso_label != NULL) && (usb_label != NULL)) {",
          "278:    if (replace_in_token_data(src, (props->is_grub_cfg) ? \"linuxefi\" : \"append\",",
          "279:     iso_label, usb_label, TRUE) != NULL)",
          "281:   }",
          "282:   safe_free(iso_label);",
          "283:   safe_free(usb_label);",
          "",
          "[Removed Lines]",
          "280:     uprintf(\"  Patched %s: '%s' \u21e8 '%s'\\n\", src, iso_label, usb_label);",
          "",
          "[Added Lines]",
          "280:     uprintf(\"  Patched %s: '%s' \u2794 '%s'\\n\", src, iso_label, usb_label);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "301:    safe_sprintf(iso_label, MAX_PATH, \"cd9660:/dev/iso9660/%s\", img_report.label);",
          "302:    safe_sprintf(usb_label, MAX_PATH, \"msdosfs:/dev/msdosfs/%s\", img_report.usb_label);",
          "303:    if (replace_in_token_data(src, \"set\", iso_label, usb_label, TRUE) != NULL)",
          "305:   }",
          "306:   safe_free(iso_label);",
          "307:   safe_free(usb_label);",
          "",
          "[Removed Lines]",
          "304:     uprintf(\"  Patched %s: '%s' \u21e8 '%s'\\n\", src, iso_label, usb_label);",
          "",
          "[Added Lines]",
          "304:     uprintf(\"  Patched %s: '%s' \u2794 '%s'\\n\", src, iso_label, usb_label);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "896:    fclose(fd);",
          "897:    fd = NULL;",
          "898:    safe_sprintf(path2, sizeof(path2), \"%s\\\\syslinux.org\", dest_dir);",
          "900:    IGNORE_RETVAL(rename(path, path2));",
          "901:   }",
          "902:   if (fd == NULL) {",
          "",
          "[Removed Lines]",
          "899:    uprintf(\"Renaming: %s \u21e8 %s\", path, path2);",
          "",
          "[Added Lines]",
          "899:    uprintf(\"Renaming: %s \u2794 %s\", path, path2);",
          "",
          "---------------"
        ],
        "src/msapi_utf8.h||src/msapi_utf8.h": [
          "File: src/msapi_utf8.h -> src/msapi_utf8.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "276: {",
          "277:  int ret;",
          "278:  DWORD err = ERROR_INVALID_DATA;",
          "280:  walloc(lpBuffer, nBufferMax);",
          "281:  ret = LoadStringW(hInstance, uID, wlpBuffer, nBufferMax);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "279:  if (nBufferMax == 0) {",
          "281:   SetLastError(ERROR_INVALID_PARAMETER);",
          "282:   return 0;",
          "283:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "461:  return ret;",
          "462: }",
          "464: static __inline int PathGetDriveNumberU(char* lpPath)",
          "465: {",
          "466:  int ret = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "469: static __inline BOOL PathFileExistsU(char* szPath)",
          "470: {",
          "471:  BOOL ret;",
          "472:  wconvert(szPath);",
          "473:  ret = PathFileExistsW(wszPath);",
          "474:  wfree(szPath);",
          "475:  return ret;",
          "476: }",
          "",
          "---------------"
        ],
        "src/process.c||src/process.c": [
          "File: src/process.c -> src/process.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "385:    if (bFound) {",
          "386:     vuprintf(\"\u25cf '%s' (pid: %ld, access: %s)\", exe_path, pid[cur_pid], access_rights_str[access_rights & 0x7]);",
          "388:     StrArrayAdd(&BlockingProcess, tmp, TRUE);",
          "389:     bFound = FALSE;",
          "390:     access_rights = 0;",
          "",
          "[Removed Lines]",
          "387:     static_sprintf(tmp, \"\u25cf %s (pid %ld)\", exe_path, pid[cur_pid]);",
          "",
          "[Added Lines]",
          "387:     static_sprintf(tmp, \"\u25cf %s (%s)\", exe_path, access_rights_str[access_rights & 0x7]);",
          "",
          "---------------"
        ],
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2153:  }",
          "2154: }",
          "2156: #ifdef RUFUS_TEST",
          "2157:  extern int SelectionDyn(char* title, char* message, char** szChoice, int nChoices);",
          "2158: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2158: static BOOL CheckDriveAccess(void)",
          "2159: {",
          "2160:  uint32_t i, j;",
          "2161:  BOOL bProceed = TRUE;",
          "2162:  BYTE access_mask;",
          "2163:  char *PhysicalPath, DevPath[MAX_PATH];",
          "2164:  char drive_letter[27], drive_name[] = \"?:\";",
          "2165:  char *message, title[128];",
          "2168:  DWORD DeviceNum = (DWORD)ComboBox_GetItemData(hDeviceList, ComboBox_GetCurSel(hDeviceList));",
          "2169:  if ((DeviceNum < 0x80) || (DeviceNum == (DWORD)-1))",
          "2170:   return FALSE;",
          "2173:  PhysicalPath = GetPhysicalName(DeviceNum);",
          "2174:  QueryDosDeviceA(&PhysicalPath[4], DevPath, sizeof(DevPath));",
          "2175:  access_mask = SearchProcess(DevPath, TRUE, TRUE, TRUE);",
          "2176:  if (access_mask != 0) {",
          "2177:   bProceed = FALSE;",
          "2178:   uprintf(\"Found potentially blocking process(es) against %s:\", &PhysicalPath[4]);",
          "2179:   for (j = 0; j < BlockingProcess.Index; j++)",
          "2180:    uprintf(BlockingProcess.String[j]);",
          "2181:  }",
          "2182:  free(PhysicalPath);",
          "2185:  GetDriveLetters(DeviceNum, drive_letter);",
          "2186:  for (i = 0; drive_letter[i]; i++) {",
          "2187:   drive_name[0] = drive_letter[i];",
          "2188:   if (QueryDosDeviceA(drive_name, DevPath, sizeof(DevPath)) != 0) {",
          "2189:    StrArrayClear(&BlockingProcess);",
          "2190:    access_mask = SearchProcess(DevPath, TRUE, TRUE, TRUE);",
          "2192:    if ((access_mask & 0x06) || (access_mask == 0x80)) {",
          "2193:     bProceed = FALSE;",
          "2194:     uprintf(\"Found potentially blocking process(es) against %s\", drive_name);",
          "2195:     for (j = 0; j < BlockingProcess.Index; j++)",
          "2196:      uprintf(BlockingProcess.String[j]);",
          "2197:    }",
          "2198:   }",
          "2199:  }",
          "2202:  if (!bProceed) {",
          "2204:   message = GetMuiString(\"shell32.dll\", 28701); // \"This drive is in use (...) Do you want to format it anyway?\"",
          "2205:   if (message != NULL) {",
          "2206:    ComboBox_GetTextU(hDeviceList, title, sizeof(title));",
          "2207:    bProceed = Notification(MSG_WARNING_QUESTION, NULL, title, message);",
          "2208:    free(message);",
          "2209:   }",
          "2210:  }",
          "2212:  return bProceed;",
          "2213: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2189:  case WM_COMMAND:",
          "2190: #ifdef RUFUS_TEST",
          "2191:   if (LOWORD(wParam) == IDC_TEST) {",
          "2195:    break;",
          "",
          "[Removed Lines]",
          "2192:    SearchProcess(\"\\\\Device\\\\Harddisk5\\\\DR5\", TRUE, TRUE);",
          "",
          "[Added Lines]",
          "2251:    uprintf(\"Proceed = %s\", CheckDriveAccess()?\"True\":\"False\");",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2509:      }",
          "2510:     }",
          "2512:     GetWindowTextU(hDeviceList, tmp, ARRAYSIZE(tmp));",
          "2513:     if (MessageBoxExU(hMainDialog, lmprintf(MSG_003, tmp),",
          "2514:      APPLICATION_NAME, MB_OKCANCEL|MB_ICONWARNING|MB_IS_RTL, selected_langid) == IDCANCEL) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2571:     if (!CheckDriveAccess()) {",
          "2572:      format_op_in_progress = FALSE;",
          "2573:      zero_drive = FALSE;",
          "2574:      PROCESS_QUEUED_EVENTS;",
          "2575:      break;",
          "2576:     }",
          "",
          "---------------"
        ],
        "src/rufus.h||src/rufus.h": [
          "File: src/rufus.h -> src/rufus.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "160:  MSG_WARNING,",
          "161:  MSG_ERROR,",
          "162:  MSG_QUESTION,",
          "163: };",
          "164: typedef INT_PTR (CALLBACK *Callback_t)(HWND, UINT, WPARAM, LPARAM);",
          "165: typedef struct {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "163:  MSG_WARNING_QUESTION",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "493: extern char* _printbits(size_t const size, void const * const ptr, int leading_zeroes);",
          "494: extern BOOL IsCurrentProcessElevated(void);",
          "495: extern char* GetCurrentMUI(void);",
          "496: extern BOOL SetFormatPromptHook(void);",
          "497: extern void ClrFormatPromptHook(void);",
          "498: extern BYTE SearchProcess(char* HandleName, BOOL bPartialMatch, BOOL bIgnoreSelf, BOOL bQuiet);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "497: extern char* GetMuiString(char* szModuleName, UINT uID);",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.16.1126\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.16.1127\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,16,1126,0",
          "370:  PRODUCTVERSION 2,16,1126,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,16,1127,0",
          "370:  PRODUCTVERSION 2,16,1127,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1126\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1126\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.16.1127\"",
          "393:             VALUE \"ProductVersion\", \"2.16.1127\"",
          "",
          "---------------"
        ],
        "src/stdfn.c||src/stdfn.c": [
          "File: src/stdfn.c -> src/stdfn.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "909:  }",
          "910:  return mui_str;",
          "911: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "913: char* GetMuiString(char* szModuleName, UINT uID)",
          "914: {",
          "915:  HMODULE hModule;",
          "916:  char path[MAX_PATH], *str;",
          "917:  wchar_t* wstr;",
          "918:  void* ptr;",
          "919:  int len;",
          "920:  static_sprintf(path, \"%s\\\\%s\\\\%s.mui\", system_dir, GetCurrentMUI(), szModuleName);",
          "922:  if (!PathFileExistsU(path))",
          "923:   static_sprintf(path, \"%s\\\\en-US\\\\%s.mui\", system_dir, szModuleName);",
          "924:  hModule = LoadLibraryExA(path, NULL, LOAD_LIBRARY_AS_IMAGE_RESOURCE | LOAD_LIBRARY_AS_DATAFILE);",
          "925:  if (hModule == NULL) {",
          "926:   uprintf(\"Could not load '%s': %s\", path, WindowsErrorString());",
          "927:   return NULL;",
          "928:  }",
          "930:  len = LoadStringW(hModule, uID, (LPWSTR)(&ptr), 0);",
          "931:  if (len <= 0) {",
          "932:   if (GetLastError() == ERROR_SUCCESS)",
          "933:    SetLastError(ERROR_RESOURCE_NAME_NOT_FOUND);",
          "934:   uprintf(\"Could not find string ID %d in '%s': %s\", uID, path, WindowsErrorString());",
          "935:   return NULL;",
          "936:  }",
          "937:  len += 1;",
          "938:  wstr = calloc(len, sizeof(wchar_t));",
          "939:  len = LoadStringW(hModule, uID, wstr, len);",
          "940:  str = wchar_to_utf8(wstr);",
          "941:  free(wstr);",
          "942:  return str;",
          "943: }",
          "",
          "---------------"
        ],
        "src/stdlg.c||src/stdlg.c": [
          "File: src/stdlg.c -> src/stdlg.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "823:  notification_is_question = FALSE;",
          "825:  switch(type) {",
          "826:  case MSG_WARNING:",
          "827:   hMessageIcon = LoadIcon(NULL, IDI_WARNING);",
          "828:   break;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "826:  case MSG_WARNING_QUESTION:",
          "827:   notification_is_question = TRUE;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "54004f7f6cde24cf9d9ea25238295e2492a33eed",
      "candidate_info": {
        "commit_hash": "54004f7f6cde24cf9d9ea25238295e2492a33eed",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/54004f7f6cde24cf9d9ea25238295e2492a33eed",
        "files": [
          "src/dev.c",
          "src/hdd_vs_ufd.h",
          "src/rufus.rc"
        ],
        "message": "[enum] fix default listing for Toshiba TransMemory UFDs",
        "before_after_code_files": [
          "src/dev.c||src/dev.c",
          "src/hdd_vs_ufd.h||src/hdd_vs_ufd.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/dev.c||src/dev.c": [
          "File: src/dev.c -> src/dev.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "255: #ifdef FORCED_DEVICE",
          "259: #endif",
          "",
          "[Removed Lines]",
          "256: #define FORCED_VID 0x058F",
          "257: #define FORCED_PID 0x6387",
          "258: #define FORCED_NAME \"Intenso Rainbow Line USB Device\"",
          "",
          "[Added Lines]",
          "256: #define FORCED_VID 0x0409",
          "257: #define FORCED_PID 0x005A",
          "258: #define FORCED_NAME \"TOSHIBA TransMemory USB Device\"",
          "",
          "---------------"
        ],
        "src/hdd_vs_ufd.h||src/hdd_vs_ufd.h": [
          "File: src/hdd_vs_ufd.h -> src/hdd_vs_ufd.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "106: static vid_score_t vid_score[] = {",
          "107:  { 0x0011, -5 },  // Kingston",
          "108:  { 0x03f0, -5 },  // HP",
          "109:  { 0x0411, 5 },  // Buffalo",
          "110:  { 0x0420, -5 },  // Chipsbank",
          "111:  { 0x046d, -5 },  // Logitech",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "109:  { 0x0409, -10 }, // NEC/Toshiba",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1057\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1058\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1057,0",
          "338:  PRODUCTVERSION 2,12,1057,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1058,0",
          "338:  PRODUCTVERSION 2,12,1058,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1057\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1057\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1058\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1058\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c4b9ec4a627cd27a957169f64603a92d79155619",
      "candidate_info": {
        "commit_hash": "c4b9ec4a627cd27a957169f64603a92d79155619",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/c4b9ec4a627cd27a957169f64603a92d79155619",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] fix two strings in the Czech translation\n\n* Closes #827",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "3430:  \"Dokon\u010den\u00ed t\u00e9to operace m\u016f\u017ee trvat dlouho, v z\u00e1vislosti na rychlosti va\u0161eho USB za\u0159\u00edzen\u00ed, \"",
          "3431:  \"zvl\u00e1\u0161t\u011b u velk\u00fdch soubor\u016f.\\n\\nDoporu\u010dujeme nechat Windows dokon\u010dit akci, zabr\u00e1n\u00edte tak po\u0161kozen\u00ed dat.\"",
          "3432:  \"Pokud u\u017e nechcete d\u00e1le \u010dekat, m\u016f\u017eete za\u0159\u00edzen\u00ed odpojit...\"",
          "3435: t MSG_083 \"Nahradit %s?\"",
          "3436: t MSG_084 \"Zd\u00e1 se, \u017ee tento ISO obraz pou\u017e\u00edv\u00e1 zastaralou verzi '%s'.\\n\"",
          "3437:  \"Nab\u00eddka boot syst\u00e9mu se proto nemus\u00ed zobrazovat spr\u00e1vn\u011b.\\n\\n\"",
          "",
          "[Removed Lines]",
          "3433: t MSG_081 \"Nepodporovan\u00e1 image\"",
          "3434: t MSG_082 \"Tento obr\u00e1z nen\u00ed bootovac\u00ed, nebo pou\u017e\u00edv\u00e1 metodu spu\u0161t\u011bn\u00ed anebo kompresi, kter\u00e1 nen\u00ed podporov\u00e1n Rufusem ...\"",
          "",
          "[Added Lines]",
          "3433: t MSG_081 \"Nepodporovan\u00fd obraz\"",
          "3434: t MSG_082 \"Tento obraz nen\u00ed bootovac\u00ed, nebo pou\u017e\u00edv\u00e1 metodu spu\u0161t\u011bn\u00ed anebo kompresi, kter\u00e1 nen\u00ed podporov\u00e1n Rufusem ...\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "17532: t MSG_285 \"T\u1eadp tin th\u1ef1c thi \u0111\u00e3 t\u1ea3i xu\u1ed1ng \u0111\u01b0\u1ee3c k\u00fd b\u1edfi '%s'.\\n\u0110\u00e2y kh\u00f4ng ph\u1ea3i ch\u1eef k\u00fd s\u1ed1 ch\u00fang t\u00f4i c\u00f4ng nh\u1eadn v\u00e0 c\u00f3 th\u1ec3 \"",
          "17533:  \"x\u00e1c \u0111\u1ecbnh l\u00e0 m\u1ed9t d\u1ea1ng ho\u1ea1t \u0111\u1ed9ng nguy hi\u1ec3m...\\nB\u1ea1n ch\u1eafc mu\u1ed1n ch\u1ea1y t\u1eadp tin n\u00e0y?\"",
          "17534: t MSG_286 \"Quy \u1ed5 \u0111\u0129a v\u1ec1 0: \u0111\u00e3 ho\u00e0n th\u00e0nh %0.1f%%\"",
          "",
          "[Removed Lines]",
          "17535: t MSG_287 \"Ph\u00e1t hi\u1ec7n \u1ed5 \u0111\u0129a th\u00e1o \u0111\u01b0\u1ee3c kh\u00f4ng ph\u1ea3i USB\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.11.995\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.11.996\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "322: VS_VERSION_INFO VERSIONINFO",
          "325:  FILEFLAGSMASK 0x3fL",
          "326: #ifdef _DEBUG",
          "327:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "323:  FILEVERSION 2,11,995,0",
          "324:  PRODUCTVERSION 2,11,995,0",
          "",
          "[Added Lines]",
          "323:  FILEVERSION 2,11,996,0",
          "324:  PRODUCTVERSION 2,11,996,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "338:         BEGIN",
          "339:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "340:             VALUE \"FileDescription\", \"Rufus\"",
          "342:             VALUE \"InternalName\", \"Rufus\"",
          "343:             VALUE \"LegalCopyright\", \"\ufffd 2011-2016 Pete Batard (GPL v3)\"",
          "344:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "345:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "346:             VALUE \"ProductName\", \"Rufus\"",
          "348:         END",
          "349:     END",
          "350:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "341:             VALUE \"FileVersion\", \"2.11.995\"",
          "347:             VALUE \"ProductVersion\", \"2.11.995\"",
          "",
          "[Added Lines]",
          "341:             VALUE \"FileVersion\", \"2.11.996\"",
          "347:             VALUE \"ProductVersion\", \"2.11.996\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a970e572d25c270276c7836d42af3e2400212d26",
      "candidate_info": {
        "commit_hash": "a970e572d25c270276c7836d42af3e2400212d26",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/a970e572d25c270276c7836d42af3e2400212d26",
        "files": [
          "res/localization/rufus.loc",
          "src/rufus.rc"
        ],
        "message": "[loc] update Serbian (Latin) translation to latest",
        "before_after_code_files": [
          "res/localization/rufus.loc||res/localization/rufus.loc",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "res/localization/rufus.loc||res/localization/rufus.loc",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "res/localization/rufus.loc||res/localization/rufus.loc": [
          "File: res/localization/rufus.loc -> res/localization/rufus.loc",
          "--- Hunk 1 ---",
          "[Context before]",
          "13981: ################################################################################",
          "13982: l \"sr-SP\" \"Serbian (Srpski)\" 0x241a, 0x081a, 0x181a, 0x2c1a, 0x701a, 0x7c1a",
          "13984: b \"en-US\"",
          "13986: # Main dialog",
          "",
          "[Removed Lines]",
          "13983: v 1.0.20",
          "",
          "[Added Lines]",
          "13983: v 1.0.21",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "14460:  \"ukazivati na neki oblik zlonamjerne aktivnosti...\\nDa li ste sigurni da \u017eelite pokrenuti ovaj program?\"",
          "14461: t MSG_286 \"Anuliranje ure\u0111aja: %0.1f%% zavr\u0161eno\"",
          "14462: t MSG_287 \"Detekcija ne-USB diskova\"",
          "14464: ################################################################################",
          "14465: l \"sk-SK\" \"Slovak (Slovensky)\" 0x041B",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14463: t MSG_288 \"Nedovoljno privilegija\"",
          "14464: t MSG_289 \"Aplikacija mo\u017ee biti pokrenuta samo uz administratorske privilegije\"",
          "14465: t MSG_290 \"Indeksiranje datoteka\"",
          "14466: t MSG_291 \"Odabir verzije\"",
          "14467: t MSG_292 \"Odaberite verziju Windows-a koju \u017eelite da instalirate:\"",
          "14468: t MSG_293 \"Nepodr\u017eana verzija Windows-a\"",
          "14469: t MSG_294 \"Rufus vi\u0161e ne podr\u017eava ovu verziju Windows-a.\"",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.12.1054\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.12.1055\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,12,1054,0",
          "338:  PRODUCTVERSION 2,12,1054,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,12,1055,0",
          "338:  PRODUCTVERSION 2,12,1055,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1054\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1054\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.12.1055\"",
          "361:             VALUE \"ProductVersion\", \"2.12.1055\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d6e6f46029df308246b0bcb0d955665e58894a41",
      "candidate_info": {
        "commit_hash": "d6e6f46029df308246b0bcb0d955665e58894a41",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/d6e6f46029df308246b0bcb0d955665e58894a41",
        "files": [
          "src/checksum.c",
          "src/rufus.c",
          "src/rufus.rc",
          "src/stdlg.c"
        ],
        "message": "[ui] fix notification dialog messages being truncated\n\n* We now auto resize the height of the Notification dialog according to the\n  number of lines of the message.\n* Also harmonize local RECT variable names according to what we do elsewhere.",
        "before_after_code_files": [
          "src/checksum.c||src/checksum.c",
          "src/rufus.c||src/rufus.c",
          "src/rufus.rc||src/rufus.rc",
          "src/stdlg.c||src/stdlg.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc",
            "src/stdlg.c||src/stdlg.c"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc",
            "src/stdlg.c||src/stdlg.c"
          ]
        }
      },
      "candidate_diff": {
        "src/checksum.c||src/checksum.c": [
          "File: src/checksum.c -> src/checksum.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "781: INT_PTR CALLBACK ChecksumCallback(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)",
          "782: {",
          "783:  int i, dw, dh;",
          "785:  HFONT hFont;",
          "786:  HDC hDC;",
          "",
          "[Removed Lines]",
          "784:  RECT rect;",
          "",
          "[Added Lines]",
          "784:  RECT rc;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "804:   hDC = GetDC(GetDlgItem(hDlg, IDC_MD5));",
          "805:   SelectFont(hDC, hFont); // Yes, you *MUST* reapply the font to the DC, even after SetWindowText!",
          "813:   ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDC_SHA256), 0, 0, dw, dh, 1.0f);",
          "819:   ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDC_MD5), 0, 0, dw, 0, 1.0f);",
          "820:   ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDC_SHA1), 0, 0, dw, 0, 1.0f);",
          "821:   ResizeButtonHeight(hDlg, IDOK);",
          "",
          "[Removed Lines]",
          "807:   GetWindowRect(GetDlgItem(hDlg, IDC_MD5), &rect);",
          "808:   dw = rect.right - rect.left;",
          "809:   dh = rect.bottom - rect.top;",
          "810:   DrawTextU(hDC, sum_str[0], -1, &rect, DT_CALCRECT);",
          "811:   dw = rect.right - rect.left - dw + 12; // Ideally we'd compute the field borders from the system, but hey...",
          "812:   dh = rect.bottom - rect.top - dh + 6;",
          "815:   GetWindowRect(GetDlgItem(hDlg, IDC_SHA1), &rect);",
          "816:   dw = rect.right - rect.left;",
          "817:   DrawTextU(hDC, sum_str[1], -1, &rect, DT_CALCRECT);",
          "818:   dw = rect.right - rect.left - dw + 12;",
          "",
          "[Added Lines]",
          "807:   GetWindowRect(GetDlgItem(hDlg, IDC_MD5), &rc);",
          "808:   dw = rc.right - rc.left;",
          "809:   dh = rc.bottom - rc.top;",
          "810:   DrawTextU(hDC, sum_str[0], -1, &rc, DT_CALCRECT);",
          "811:   dw = rc.right - rc.left - dw + 12; // Ideally we'd compute the field borders from the system, but hey...",
          "812:   dh = rc.bottom - rc.top - dh + 6;",
          "815:   GetWindowRect(GetDlgItem(hDlg, IDC_SHA1), &rc);",
          "816:   dw = rc.right - rc.left;",
          "817:   DrawTextU(hDC, sum_str[1], -1, &rc, DT_CALCRECT);",
          "818:   dw = rc.right - rc.left - dw + 12;",
          "",
          "---------------"
        ],
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2972:  case WM_COMMAND:",
          "2973: #ifdef RUFUS_TEST",
          "2974:   if (LOWORD(wParam) == IDC_TEST) {",
          "2976:    break;",
          "2977:   }",
          "2978: #endif",
          "",
          "[Removed Lines]",
          "2975:    ToggleImageSettings(\"blah.iso\");",
          "",
          "[Added Lines]",
          "2975:    Notification(MSG_ERROR, NULL, lmprintf(MSG_042), lmprintf(MSG_043, lmprintf(MSG_055)));",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.1.1312\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.1.1313\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "126:     DEFPUSHBUTTON   \"Close\",IDCANCEL,306,305,50,12",
          "127: END",
          "130: STYLE DS_SETFONT | DS_NOFAILCREATE | DS_CENTER | WS_POPUP | WS_VISIBLE | WS_CAPTION | WS_THICKFRAME",
          "131: CAPTION \"Rufus\"",
          "132: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "133: BEGIN",
          "136:     ICON            OCR_UP,IDC_NOTIFICATION_ICON,6,6,20,20",
          "141: END",
          "143: IDD_SELECTION DIALOGEX 0, 0, 312, 71",
          "",
          "[Removed Lines]",
          "129: IDD_NOTIFICATION DIALOGEX 0, 0, 263, 63",
          "134:     LTEXT           \"\",IDC_NOTIFICATION_LINE,0,0,263,39",
          "135:     LTEXT           \"\",IDC_STATIC,0,0,263,38",
          "137:     LTEXT           \"Message\",IDC_NOTIFICATION_TEXT,35,10,219,20",
          "138:     DEFPUSHBUTTON   \"No\",IDNO,206,44,50,14",
          "139:     PUSHBUTTON      \"More information\",IDC_MORE_INFO,8,44,76,14,NOT WS_VISIBLE",
          "140:     PUSHBUTTON      \"Yes\",IDYES,149,44,50,14,NOT WS_VISIBLE",
          "",
          "[Added Lines]",
          "129: IDD_NOTIFICATION DIALOGEX 0, 0, 263, 59",
          "134:     LTEXT           \"\",IDC_NOTIFICATION_LINE,0,0,263,35",
          "135:     LTEXT           \"\",IDC_STATIC,0,0,263,34",
          "137:     LTEXT           \"Message\",IDC_NOTIFICATION_TEXT,35,6,219,20",
          "138:     DEFPUSHBUTTON   \"No\",IDNO,206,40,50,14",
          "139:     PUSHBUTTON      \"More information\",IDC_MORE_INFO,8,40,76,14,NOT WS_VISIBLE",
          "140:     PUSHBUTTON      \"Yes\",IDYES,149,40,50,14,NOT WS_VISIBLE",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,1,1312,0",
          "393:  PRODUCTVERSION 3,1,1312,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,1,1313,0",
          "393:  PRODUCTVERSION 3,1,1313,0",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1312\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1312\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.1.1313\"",
          "416:             VALUE \"ProductVersion\", \"3.1.1313\"",
          "",
          "---------------"
        ],
        "src/stdlg.c||src/stdlg.c": [
          "File: src/stdlg.c -> src/stdlg.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "648: INT_PTR CALLBACK NotificationCallback(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)",
          "649: {",
          "650:  LRESULT loc;",
          "653:  static LRESULT disabled[9] = { HTLEFT, HTRIGHT, HTTOP, HTBOTTOM, HTSIZE,",
          "654:   HTTOPLEFT, HTTOPRIGHT, HTBOTTOMLEFT, HTBOTTOMRIGHT };",
          "",
          "[Removed Lines]",
          "651:  int i;",
          "",
          "[Added Lines]",
          "651:  int i, dh;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "658:  HFONT hDlgFont;",
          "659:  HWND hCtrl;",
          "660:  RECT rc;",
          "662:  switch (message) {",
          "663:  case WM_INITDIALOG:",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "661:  HDC hDC;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "710:     max(rc.right - rc.left, GetTextSize(hCtrl, NULL).cx + cbw), rc.bottom - rc.top, SWP_NOZORDER);",
          "711:    ShowWindow(hCtrl, SW_SHOW);",
          "712:   }",
          "714:   if (szMessageText != NULL) {",
          "716:   }",
          "717:   return (INT_PTR)TRUE;",
          "718:  case WM_CTLCOLORSTATIC:",
          "",
          "[Removed Lines]",
          "715:    SetWindowTextU(GetDlgItem(hDlg, IDC_NOTIFICATION_TEXT), szMessageText);",
          "",
          "[Added Lines]",
          "716:    hCtrl = GetDlgItem(hDlg, IDC_NOTIFICATION_TEXT);",
          "717:    SetWindowTextU(hCtrl, szMessageText);",
          "718:    hDC = GetDC(hCtrl);",
          "719:    SelectFont(hDC, hDlgFont); // Yes, you *MUST* reapply the font to the DC, even after SetWindowText!",
          "720:    GetWindowRect(hCtrl, &rc);",
          "721:    dh = rc.bottom - rc.top;",
          "722:    DrawTextU(hDC, szMessageText, -1, &rc, DT_CALCRECT | DT_WORDBREAK);",
          "723:    dh = rc.bottom - rc.top - dh + (int)(8.0f * fScale);",
          "724:    safe_release_dc(hCtrl, hDC);",
          "725:    if (dh > 0) {",
          "726:     ResizeMoveCtrl(hDlg, hCtrl, 0, 0, 0, dh, 1.0f);",
          "727:     ResizeMoveCtrl(hDlg, hDlg, 0, 0, 0, dh, 1.0f);",
          "728:     ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, -1), 0, 0, 0, dh, 1.0f); // IDC_STATIC = -1",
          "729:     ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDC_SELECTION_LINE), 0, dh, 0, 0, 1.0f);",
          "730:     ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDC_MORE_INFO), 0, dh, 0, 0, 1.0f);",
          "731:     ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDYES), 0, dh, 0, 0, 1.0f);",
          "732:     ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDNO), 0, dh, 0, 0, 1.0f);",
          "733:    }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "808:  static HBRUSH background_brush, separator_brush;",
          "810:  NONCLIENTMETRICS ncm;",
          "812:  HFONT hDlgFont;",
          "813:  HWND hCtrl;",
          "814:  HDC hDC;",
          "",
          "[Removed Lines]",
          "811:  RECT rect, rect2;",
          "",
          "[Added Lines]",
          "829:  RECT rc, rc2;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "851:   hCtrl = GetDlgItem(hDlg, IDC_SELECTION_TEXT);",
          "852:   hDC = GetDC(hCtrl);",
          "853:   SelectFont(hDC, hDlgFont); // Yes, you *MUST* reapply the font to the DC, even after SetWindowText!",
          "858:   safe_release_dc(hCtrl, hDC);",
          "859:   ResizeMoveCtrl(hDlg, hCtrl, 0, 0, 0, dh, 1.0f);",
          "860:   for (i = 0; i < nDialogItems; i++)",
          "861:    ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDC_SELECTION_CHOICE1 + i), 0, dh, 0, 0, 1.0f);",
          "862:   if (nDialogItems > 2) {",
          "866:   }",
          "867:   ResizeMoveCtrl(hDlg, hDlg, 0, 0, 0, dh, 1.0f);",
          "868:   ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, -1), 0, 0, 0, dh, 1.0f); // IDC_STATIC = -1",
          "",
          "[Removed Lines]",
          "854:   GetWindowRect(hCtrl, &rect);",
          "855:   dh = rect.bottom - rect.top;",
          "856:   DrawTextU(hDC, szMessageText, -1, &rect, DT_CALCRECT | DT_WORDBREAK);",
          "857:   dh = rect.bottom - rect.top - dh;",
          "863:    GetWindowRect(GetDlgItem(hDlg, IDC_SELECTION_CHOICE2), &rect);",
          "864:    GetWindowRect(GetDlgItem(hDlg, IDC_SELECTION_CHOICE1 + nDialogItems - 1), &rect2);",
          "865:    dh += rect2.top - rect.top;",
          "",
          "[Added Lines]",
          "872:   GetWindowRect(hCtrl, &rc);",
          "873:   dh = rc.bottom - rc.top;",
          "874:   DrawTextU(hDC, szMessageText, -1, &rc, DT_CALCRECT | DT_WORDBREAK);",
          "875:   dh = rc.bottom - rc.top - dh;",
          "881:    GetWindowRect(GetDlgItem(hDlg, IDC_SELECTION_CHOICE2), &rc);",
          "882:    GetWindowRect(GetDlgItem(hDlg, IDC_SELECTION_CHOICE1 + nDialogItems - 1), &rc2);",
          "883:    dh += rc2.top - rc.top;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "941:  static HBRUSH background_brush, separator_brush;",
          "943:  NONCLIENTMETRICS ncm;",
          "945:  HFONT hDlgFont;",
          "946:  HWND hCtrl;",
          "947:  HDC hDC;",
          "",
          "[Removed Lines]",
          "944:  RECT rect, rect2;",
          "",
          "[Added Lines]",
          "962:  RECT rc, rc2;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "984:   hCtrl = GetDlgItem(hDlg, IDC_LIST_TEXT);",
          "985:   hDC = GetDC(hCtrl);",
          "986:   SelectFont(hDC, hDlgFont); // Yes, you *MUST* reapply the font to the DC, even after SetWindowText!",
          "991:   safe_release_dc(hCtrl, hDC);",
          "992:   ResizeMoveCtrl(hDlg, hCtrl, 0, 0, 0, dh, 1.0f);",
          "993:   for (i = 0; i < nDialogItems; i++)",
          "994:    ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, IDC_LIST_ITEM1 + i), 0, dh, 0, 0, 1.0f);",
          "995:   if (nDialogItems > 1) {",
          "999:   }",
          "1000:   ResizeMoveCtrl(hDlg, hDlg, 0, 0, 0, dh, 1.0f);",
          "1001:   ResizeMoveCtrl(hDlg, GetDlgItem(hDlg, -1), 0, 0, 0, dh, 1.0f); // IDC_STATIC = -1",
          "",
          "[Removed Lines]",
          "987:   GetWindowRect(hCtrl, &rect);",
          "988:   dh = rect.bottom - rect.top;",
          "989:   DrawTextU(hDC, szMessageText, -1, &rect, DT_CALCRECT | DT_WORDBREAK);",
          "990:   dh = rect.bottom - rect.top - dh;",
          "996:    GetWindowRect(GetDlgItem(hDlg, IDC_LIST_ITEM1), &rect);",
          "997:    GetWindowRect(GetDlgItem(hDlg, IDC_LIST_ITEM1 + nDialogItems - 1), &rect2);",
          "998:    dh += rect2.top - rect.top;",
          "",
          "[Added Lines]",
          "1005:   GetWindowRect(hCtrl, &rc);",
          "1006:   dh = rc.bottom - rc.top;",
          "1007:   DrawTextU(hDC, szMessageText, -1, &rc, DT_CALCRECT | DT_WORDBREAK);",
          "1008:   dh = rc.bottom - rc.top - dh;",
          "1014:    GetWindowRect(GetDlgItem(hDlg, IDC_LIST_ITEM1), &rc);",
          "1015:    GetWindowRect(GetDlgItem(hDlg, IDC_LIST_ITEM1 + nDialogItems - 1), &rc2);",
          "1016:    dh += rc2.top - rc.top;",
          "",
          "---------------"
        ]
      }
    }
  ]
}