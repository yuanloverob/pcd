{
  "cve_id": "CVE-2020-26164",
  "cve_desc": "In kdeconnect-kde (aka KDE Connect) before 20.08.2, an attacker on the local network could send crafted packets that trigger use of large amounts of CPU, memory, or network connection slots, aka a Denial of Service attack.",
  "repo": "KDE/kdeconnect-kde",
  "patch_hash": "ce0f00fc2d3eccb51d0af4eba61a4f60de086a59",
  "patch_info": {
    "commit_hash": "ce0f00fc2d3eccb51d0af4eba61a4f60de086a59",
    "repo": "KDE/kdeconnect-kde",
    "commit_url": "https://github.com/KDE/kdeconnect-kde/commit/ce0f00fc2d3eccb51d0af4eba61a4f60de086a59",
    "files": [
      "core/backends/lan/lanlinkprovider.cpp"
    ],
    "message": "Limit the ports we try to connect to to the port range of KDE Connect\n\nSo we can't trigger connections to other services.\n\nThanks Matthias Gerstner <mgerstner@suse.de> for reporting this.",
    "before_after_code_files": [
      "core/backends/lan/lanlinkprovider.cpp||core/backends/lan/lanlinkprovider.cpp"
    ]
  },
  "patch_diff": {
    "core/backends/lan/lanlinkprovider.cpp||core/backends/lan/lanlinkprovider.cpp": [
      "File: core/backends/lan/lanlinkprovider.cpp -> core/backends/lan/lanlinkprovider.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "241:         }",
      "243:         int tcpPort = receivedPacket->get<int>(QStringLiteral(\"tcpPort\"));",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "244:         if (tcpPort < MIN_TCP_PORT || tcpPort > MAX_TCP_PORT) {",
      "245:             qCDebug(KDECONNECT_CORE) << \"TCP port outside of kdeconnect's range\";",
      "246:             delete receivedPacket;",
      "247:             continue;",
      "248:         }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "85b691e40f525e22ca5cc4ebe79c361d71d7dc05",
      "candidate_info": {
        "commit_hash": "85b691e40f525e22ca5cc4ebe79c361d71d7dc05",
        "repo": "KDE/kdeconnect-kde",
        "commit_url": "https://github.com/KDE/kdeconnect-kde/commit/85b691e40f525e22ca5cc4ebe79c361d71d7dc05",
        "files": [
          "core/backends/lan/lanlinkprovider.cpp"
        ],
        "message": "Limit the ports we try to connect to to the port range of KDE Connect\n\nSo we can't trigger connections to other services.\n\nThanks Matthias Gerstner <mgerstner@suse.de> for reporting this.",
        "before_after_code_files": [
          "core/backends/lan/lanlinkprovider.cpp||core/backends/lan/lanlinkprovider.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "core/backends/lan/lanlinkprovider.cpp||core/backends/lan/lanlinkprovider.cpp"
          ],
          "candidate": [
            "core/backends/lan/lanlinkprovider.cpp||core/backends/lan/lanlinkprovider.cpp"
          ]
        }
      },
      "candidate_diff": {
        "core/backends/lan/lanlinkprovider.cpp||core/backends/lan/lanlinkprovider.cpp": [
          "File: core/backends/lan/lanlinkprovider.cpp -> core/backends/lan/lanlinkprovider.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "223:         }",
          "225:         int tcpPort = receivedPacket->get<int>(QStringLiteral(\"tcpPort\"));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "226:         if (tcpPort < MIN_TCP_PORT || tcpPort > MAX_TCP_PORT) {",
          "227:             qCDebug(KDECONNECT_CORE) << \"TCP port outside of kdeconnect's range\";",
          "228:             delete receivedPacket;",
          "229:             continue;",
          "230:         }",
          "",
          "---------------"
        ]
      }
    }
  ]
}