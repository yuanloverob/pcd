{
  "cve_id": "CVE-2012-6617",
  "cve_desc": "The prepare_sdp_description function in ffserver.c in FFmpeg before 1.0.2 allows remote attackers to cause a denial of service (crash) via vectors related to the rtp format.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "cbe43e62c9ac7d4aefdc13476f6f691bd626525f",
  "patch_info": {
    "commit_hash": "cbe43e62c9ac7d4aefdc13476f6f691bd626525f",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/cbe43e62c9ac7d4aefdc13476f6f691bd626525f",
    "files": [
      "ffserver.c"
    ],
    "message": "ffserver: set oformat\n\nFix Ticket1986\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "before_after_code_files": [
      "ffserver.c||ffserver.c"
    ]
  },
  "patch_diff": {
    "ffserver.c||ffserver.c": [
      "File: ffserver.c -> ffserver.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2961: {",
      "2962:     AVFormatContext *avc;",
      "2963:     AVStream *avs = NULL;",
      "2964:     int i;",
      "2966:     avc =  avformat_alloc_context();",
      "2968:         return -1;",
      "2969:     }",
      "2970:     av_dict_set(&avc->metadata, \"title\",",
      "2971:                stream->title[0] ? stream->title : \"No Title\", 0);",
      "2972:     avc->nb_streams = stream->nb_streams;",
      "",
      "[Removed Lines]",
      "2967:     if (avc == NULL) {",
      "",
      "[Added Lines]",
      "2964:     AVOutputFormat *rtp_format = av_guess_format(\"rtp\", NULL, NULL);",
      "2968:     if (avc == NULL || !rtp_format) {",
      "2971:     avc->oformat = rtp_format;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9929991da7b843e7d80154fcacc4e80579b86a2d",
      "candidate_info": {
        "commit_hash": "9929991da7b843e7d80154fcacc4e80579b86a2d",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/9929991da7b843e7d80154fcacc4e80579b86a2d",
        "files": [
          "ffserver.c"
        ],
        "message": "ffserver: set oformat\n\nFix Ticket1986\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit cbe43e62c9ac7d4aefdc13476f6f691bd626525f)",
        "before_after_code_files": [
          "ffserver.c||ffserver.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ffserver.c||ffserver.c"
          ],
          "candidate": [
            "ffserver.c||ffserver.c"
          ]
        }
      },
      "candidate_diff": {
        "ffserver.c||ffserver.c": [
          "File: ffserver.c -> ffserver.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2937: {",
          "2938:     AVFormatContext *avc;",
          "2939:     AVStream *avs = NULL;",
          "2940:     int i;",
          "2942:     avc =  avformat_alloc_context();",
          "2944:         return -1;",
          "2945:     }",
          "2946:     av_dict_set(&avc->metadata, \"title\",",
          "2947:                stream->title[0] ? stream->title : \"No Title\", 0);",
          "2948:     avc->nb_streams = stream->nb_streams;",
          "",
          "[Removed Lines]",
          "2943:     if (avc == NULL) {",
          "",
          "[Added Lines]",
          "2940:     AVOutputFormat *rtp_format = av_guess_format(\"rtp\", NULL, NULL);",
          "2944:     if (avc == NULL || !rtp_format) {",
          "2947:     avc->oformat = rtp_format;",
          "",
          "---------------"
        ]
      }
    }
  ]
}