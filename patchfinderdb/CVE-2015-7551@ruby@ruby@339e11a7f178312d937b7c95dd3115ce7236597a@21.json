{
  "cve_id": "CVE-2015-7551",
  "cve_desc": "The Fiddle::Handle implementation in ext/fiddle/handle.c in Ruby before 2.0.0-p648, 2.1 before 2.1.8, and 2.2 before 2.2.4, as distributed in Apple OS X before 10.11.4 and other products, mishandles tainting, which allows context-dependent attackers to execute arbitrary code or cause a denial of service (application crash) via a crafted string, related to the DL module and the libffi library.  NOTE: this vulnerability exists because of a CVE-2009-5147 regression.",
  "repo": "ruby/ruby",
  "patch_hash": "339e11a7f178312d937b7c95dd3115ce7236597a",
  "patch_info": {
    "commit_hash": "339e11a7f178312d937b7c95dd3115ce7236597a",
    "repo": "ruby/ruby",
    "commit_url": "https://github.com/ruby/ruby/commit/339e11a7f178312d937b7c95dd3115ce7236597a",
    "files": [
      "ChangeLog",
      "ext/fiddle/handle.c",
      "test/fiddle/test_handle.rb",
      "version.h"
    ],
    "message": "merge revision(s): 53153 and 23405@ruby_1_9_1\n\n\t* ext/fiddle/handle.c: check tainted string arguments.\n\t  Patch provided by tenderlove and nobu.\n\n\t* test/fiddle/test_handle.rb (class TestHandle): add test for above.\n\n\t* ext/dl/handle.c (rb_dlhandle_initialize): prohibits DL::dlopen\n\t  with a tainted name of library.\n\t  Patch by sheepman <sheepman AT sheepman.sakura.ne.jp>.\n\n\t* ext/dl/handle.c (rb_dlhandle_sym): ditto\n\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@53156 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
    "before_after_code_files": [
      "ext/fiddle/handle.c||ext/fiddle/handle.c",
      "test/fiddle/test_handle.rb||test/fiddle/test_handle.rb",
      "version.h||version.h"
    ]
  },
  "patch_diff": {
    "ext/fiddle/handle.c||ext/fiddle/handle.c": [
      "File: ext/fiddle/handle.c -> ext/fiddle/handle.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #include <ruby.h>",
      "2: #include <fiddle.h>",
      "4: VALUE rb_cHandle;",
      "6: struct dl_handle {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4: #define SafeStringValueCStr(v) (rb_check_safe_obj(rb_string_value(&v)), StringValueCStr(v))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "143:  cflag = RTLD_LAZY | RTLD_GLOBAL;",
      "144:  break;",
      "145:       case 1:",
      "147:  cflag = RTLD_LAZY | RTLD_GLOBAL;",
      "148:  break;",
      "149:       case 2:",
      "151:  cflag = NUM2INT(flag);",
      "152:  break;",
      "153:       default:",
      "",
      "[Removed Lines]",
      "146:  clib = NIL_P(lib) ? NULL : StringValuePtr(lib);",
      "150:  clib = NIL_P(lib) ? NULL : StringValuePtr(lib);",
      "",
      "[Added Lines]",
      "148:  clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);",
      "152:  clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "263:     return PTR2NUM(fiddle_handle);",
      "264: }",
      "",
      "[Removed Lines]",
      "266: static VALUE fiddle_handle_sym(void *handle, const char *symbol);",
      "",
      "[Added Lines]",
      "268: static VALUE fiddle_handle_sym(void *handle, VALUE symbol);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "282:  rb_raise(rb_eFiddleError, \"closed handle\");",
      "283:     }",
      "286: }",
      "288: #ifndef RTLD_NEXT",
      "",
      "[Removed Lines]",
      "285:     return fiddle_handle_sym(fiddle_handle->ptr, StringValueCStr(sym));",
      "",
      "[Added Lines]",
      "287:     return fiddle_handle_sym(fiddle_handle->ptr, sym);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "305: static VALUE",
      "306: rb_fiddle_handle_s_sym(VALUE self, VALUE sym)",
      "307: {",
      "309: }",
      "311: static VALUE",
      "313: {",
      "314: #if defined(HAVE_DLERROR)",
      "315:     const char *err;",
      "",
      "[Removed Lines]",
      "308:     return fiddle_handle_sym(RTLD_NEXT, StringValueCStr(sym));",
      "312: fiddle_handle_sym(void *handle, const char *name)",
      "",
      "[Added Lines]",
      "310:     return fiddle_handle_sym(RTLD_NEXT, sym);",
      "314: fiddle_handle_sym(void *handle, VALUE symbol)",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "318: # define CHECK_DLERROR",
      "319: #endif",
      "320:     void (*func)();",
      "322:     rb_secure(2);",
      "323: #ifdef HAVE_DLERROR",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "323:     const char *name = SafeStringValueCStr(symbol);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "367:     }",
      "368: #endif",
      "369:     if( !func ){",
      "371:     }",
      "373:     return PTR2NUM(func);",
      "",
      "[Removed Lines]",
      "370:  rb_raise(rb_eFiddleError, \"unknown symbol \\\"%s\\\"\", name);",
      "",
      "[Added Lines]",
      "373:  rb_raise(rb_eFiddleError, \"unknown symbol \\\"%\"PRIsVALUE\"\\\"\", symbol);",
      "",
      "---------------"
    ],
    "test/fiddle/test_handle.rb||test/fiddle/test_handle.rb": [
      "File: test/fiddle/test_handle.rb -> test/fiddle/test_handle.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "11:     include Test::Unit::Assertions",
      "13:     def test_to_i",
      "14:       handle = Fiddle::Handle.new(LIBC_SO)",
      "15:       assert_kind_of Integer, handle.to_i",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13:     def test_safe_handle_open",
      "14:       t = Thread.new do",
      "15:         $SAFE = 1",
      "16:         Fiddle::Handle.new(LIBC_SO.taint)",
      "17:       end",
      "18:       assert_raise(SecurityError) { t.value }",
      "19:     end",
      "21:     def test_safe_function_lookup",
      "22:       t = Thread.new do",
      "23:         h = Fiddle::Handle.new(LIBC_SO)",
      "24:         $SAFE = 1",
      "25:         h[\"qsort\".taint]",
      "26:       end",
      "27:       assert_raise(SecurityError) { t.value }",
      "28:     end",
      "",
      "---------------"
    ],
    "version.h||version.h": [
      "File: version.h -> version.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #define RUBY_VERSION \"2.1.8\"",
      "2: #define RUBY_RELEASE_DATE \"2015-12-16\"",
      "5: #define RUBY_RELEASE_YEAR 2015",
      "6: #define RUBY_RELEASE_MONTH 12",
      "",
      "[Removed Lines]",
      "3: #define RUBY_PATCHLEVEL 438",
      "",
      "[Added Lines]",
      "3: #define RUBY_PATCHLEVEL 439",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "dacb9169c3fc92a6827ab8d1a16e34c341612f48",
      "candidate_info": {
        "commit_hash": "dacb9169c3fc92a6827ab8d1a16e34c341612f48",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/dacb9169c3fc92a6827ab8d1a16e34c341612f48",
        "files": [
          "ChangeLog",
          "ext/openssl/ossl_pkey.c",
          "version.h"
        ],
        "message": "merge revision(s) 52556,52557: [Backport #10735]\n\n\t* ext/openssl/ossl_pkey.c: Merge ruby/openssl@b9ea8ef [Bug #10735]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@52643 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "ext/openssl/ossl_pkey.c||ext/openssl/ossl_pkey.c",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "ext/openssl/ossl_pkey.c||ext/openssl/ossl_pkey.c": [
          "File: ext/openssl/ossl_pkey.c -> ext/openssl/ossl_pkey.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "275:     EVP_MD_CTX ctx;",
          "276:     unsigned int buf_len;",
          "277:     VALUE str;",
          "279:     if (rb_funcall(self, id_private_q, 0, NULL) != Qtrue) {",
          "280:  ossl_raise(rb_eArgError, \"Private key is needed.\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "278:     int result;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "284:     StringValue(data);",
          "285:     EVP_SignUpdate(&ctx, RSTRING_PTR(data), RSTRING_LEN(data));",
          "286:     str = rb_str_new(0, EVP_PKEY_size(pkey)+16);",
          "288:  ossl_raise(ePKeyError, NULL);",
          "289:     assert((long)buf_len <= RSTRING_LEN(str));",
          "290:     rb_str_set_len(str, buf_len);",
          "",
          "[Removed Lines]",
          "287:     if (!EVP_SignFinal(&ctx, (unsigned char *)RSTRING_PTR(str), &buf_len, pkey))",
          "",
          "[Added Lines]",
          "288:     result = EVP_SignFinal(&ctx, (unsigned char *)RSTRING_PTR(str), &buf_len, pkey);",
          "289:     EVP_MD_CTX_cleanup(&ctx);",
          "290:     if (!result)",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.8\"",
          "2: #define RUBY_RELEASE_DATE \"2015-11-18\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 11",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 418",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 419",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "26154da303cda2658cb6351e0a360d772ffd70d7",
      "candidate_info": {
        "commit_hash": "26154da303cda2658cb6351e0a360d772ffd70d7",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/26154da303cda2658cb6351e0a360d772ffd70d7",
        "files": [
          "ChangeLog",
          "lib/irb.rb",
          "version.h"
        ],
        "message": "merge revision(s) 53943: [Backport #11969]\n\n\t* lib/irb.rb: avoid to needless truncation when using back_trace_limit option.\n\t  [fix GH-1205][ruby-core:72773][Bug #11969]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@54263 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "lib/irb.rb||lib/irb.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "lib/irb.rb||lib/irb.rb": [
          "File: lib/irb.rb -> lib/irb.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "526:             print messages.join(\"\\n\"), \"\\n\"",
          "527:             unless lasts.empty?",
          "528:               printf \"... %d levels...\\n\", levels if levels > 0",
          "530:             end",
          "531:             print \"Maybe IRB bug!\\n\" if irb_bug",
          "532:           end",
          "",
          "[Removed Lines]",
          "529:               print lasts.join(\"\\n\")",
          "",
          "[Added Lines]",
          "529:               print lasts.join(\"\\n\"), \"\\n\"",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.9\"",
          "2: #define RUBY_RELEASE_DATE \"2016-03-25\"",
          "5: #define RUBY_RELEASE_YEAR 2016",
          "6: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 460",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 461",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "616b11e2464c160729e0bf9525f28e9574d3d1d2",
      "candidate_info": {
        "commit_hash": "616b11e2464c160729e0bf9525f28e9574d3d1d2",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/616b11e2464c160729e0bf9525f28e9574d3d1d2",
        "files": [
          "ChangeLog",
          "version.h"
        ],
        "message": "* version.h: bump to 2.1.9.  may this version be the last of 2.1.\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@53262 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 12",
          "9: #include \"ruby/version.h\"",
          "",
          "[Removed Lines]",
          "1: #define RUBY_VERSION \"2.1.8\"",
          "2: #define RUBY_RELEASE_DATE \"2015-12-16\"",
          "3: #define RUBY_PATCHLEVEL 440",
          "7: #define RUBY_RELEASE_DAY 16",
          "",
          "[Added Lines]",
          "1: #define RUBY_VERSION \"2.1.9\"",
          "2: #define RUBY_RELEASE_DATE \"2015-12-23\"",
          "3: #define RUBY_PATCHLEVEL 441",
          "7: #define RUBY_RELEASE_DAY 23",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7e9ce9f5d68d0a6129147e7cd69490554c6e7ae3",
      "candidate_info": {
        "commit_hash": "7e9ce9f5d68d0a6129147e7cd69490554c6e7ae3",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/7e9ce9f5d68d0a6129147e7cd69490554c6e7ae3",
        "files": [
          "ChangeLog",
          "test/openssl/test_ssl_session.rb",
          "version.h"
        ],
        "message": "merge revision(s) 49099: [Backport #10046]\n\n\t* test/openssl/test_ssl_session.rb (OpenSSL#test_ctx_client_session_cb):\n\t  fix test failure with OpenSSL disabled SSLv3 protocol.\n\t  [ruby-core:63772] [Bug #10046]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@52637 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "test/openssl/test_ssl_session.rb||test/openssl/test_ssl_session.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "test/openssl/test_ssl_session.rb||test/openssl/test_ssl_session.rb": [
          "File: test/openssl/test_ssl_session.rb -> test/openssl/test_ssl_session.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "274:   def test_ctx_client_session_cb",
          "275:     called = {}",
          "277:     ctx.session_cache_mode = OpenSSL::SSL::SSLContext::SESSION_CACHE_CLIENT",
          "279:     ctx.session_new_cb = lambda { |ary|",
          "",
          "[Removed Lines]",
          "276:     ctx = OpenSSL::SSL::SSLContext.new(\"SSLv3\")",
          "",
          "[Added Lines]",
          "276:     ctx = OpenSSL::SSL::SSLContext.new",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.8\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "9: #include \"ruby/version.h\"",
          "",
          "[Removed Lines]",
          "2: #define RUBY_RELEASE_DATE \"2015-10-29\"",
          "3: #define RUBY_PATCHLEVEL 412",
          "6: #define RUBY_RELEASE_MONTH 10",
          "7: #define RUBY_RELEASE_DAY 29",
          "",
          "[Added Lines]",
          "2: #define RUBY_RELEASE_DATE \"2015-11-18\"",
          "3: #define RUBY_PATCHLEVEL 413",
          "6: #define RUBY_RELEASE_MONTH 11",
          "7: #define RUBY_RELEASE_DAY 18",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a5ffcdaeffdc05bfa63c7f9542791798f2878757",
      "candidate_info": {
        "commit_hash": "a5ffcdaeffdc05bfa63c7f9542791798f2878757",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/a5ffcdaeffdc05bfa63c7f9542791798f2878757",
        "files": [
          "ChangeLog",
          "lib/net/http/response.rb",
          "test/net/http/test_httpresponse.rb",
          "version.h"
        ],
        "message": "merge revision(s) 46681,51464,51465: [Backport #11058]\n\n\t* lib/net/http/response.rb (Net::HTTPResponse.each_response_header):\n\t  raise first exception even if inflate_body_io.finish raises error.\n\t  when begin block raises error, finish usually raises error too.\n\n\t* lib/net/http/response.rb (Net::HTTPResponse#inflater):\n\t  fix TypeError. An exception object might be nil.\n\t  [ruby-core:68846] [Bug #11058]\n\n\t* lib/net/http/response.rb (Net::HTTPResponse::Inflater#finish):\n\t  fix a bug that empty gzipped response body causes Zlib::BufError.\n\t  [ruby-core:68846] [Bug #11058]\n\n\t* test/net/http/test_httpresponse.rb: tests for the above.\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@51609 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "lib/net/http/response.rb||lib/net/http/response.rb",
          "test/net/http/test_httpresponse.rb||test/net/http/test_httpresponse.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "lib/net/http/response.rb||lib/net/http/response.rb": [
          "File: lib/net/http/response.rb -> lib/net/http/response.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "260:       begin",
          "261:         yield inflate_body_io",
          "262:       ensure",
          "264:       end",
          "265:     when 'none', 'identity' then",
          "266:       self.delete 'content-encoding'",
          "",
          "[Removed Lines]",
          "263:         inflate_body_io.finish",
          "",
          "[Added Lines]",
          "263:         orig_err = $!",
          "264:         begin",
          "265:           inflate_body_io.finish",
          "266:         rescue => err",
          "267:           raise orig_err || err",
          "268:         end",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "355:     # Finishes the inflate stream.",
          "357:     def finish",
          "358:       @inflate.finish",
          "359:     end",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "363:       return if @inflate.total_in == 0",
          "",
          "---------------"
        ],
        "test/net/http/test_httpresponse.rb||test/net/http/test_httpresponse.rb": [
          "File: test/net/http/test_httpresponse.rb -> test/net/http/test_httpresponse.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "237:     assert_equal \"\\x1F\\x8B\\b\\x00\\x00\\x00\\x00\\x00\\x00\\x03\", body",
          "238:   end",
          "240:   def test_read_body_string",
          "241:     io = dummy_io(<<EOS)",
          "242: HTTP/1.1 200 OK",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "240:   def test_read_body_content_encoding_deflate_empty_body",
          "241:     io = dummy_io(<<EOS)",
          "242: HTTP/1.1 200 OK",
          "243: Connection: close",
          "244: Content-Encoding: deflate",
          "245: Content-Length: 0",
          "247: EOS",
          "249:     res = Net::HTTPResponse.read_new(io)",
          "250:     res.decode_content = true",
          "252:     body = nil",
          "254:     res.reading_body io, true do",
          "255:       body = res.read_body",
          "256:     end",
          "258:     if Net::HTTP::HAVE_ZLIB",
          "259:       assert_equal nil, res['content-encoding']",
          "260:       assert_equal '', body",
          "261:     else",
          "262:       assert_equal 'deflate', res['content-encoding']",
          "263:       assert_equal '', body",
          "264:     end",
          "265:   end",
          "267:   def test_read_body_content_encoding_deflate_empty_body_no_length",
          "268:     io = dummy_io(<<EOS)",
          "269: HTTP/1.1 200 OK",
          "270: Connection: close",
          "271: Content-Encoding: deflate",
          "273: EOS",
          "275:     res = Net::HTTPResponse.read_new(io)",
          "276:     res.decode_content = true",
          "278:     body = nil",
          "280:     res.reading_body io, true do",
          "281:       body = res.read_body",
          "282:     end",
          "284:     if Net::HTTP::HAVE_ZLIB",
          "285:       assert_equal nil, res['content-encoding']",
          "286:       assert_equal '', body",
          "287:     else",
          "288:       assert_equal 'deflate', res['content-encoding']",
          "289:       assert_equal '', body",
          "290:     end",
          "291:   end",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.7\"",
          "2: #define RUBY_RELEASE_DATE \"2015-08-17\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 8",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 391",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 392",
          "",
          "---------------"
        ]
      }
    }
  ]
}