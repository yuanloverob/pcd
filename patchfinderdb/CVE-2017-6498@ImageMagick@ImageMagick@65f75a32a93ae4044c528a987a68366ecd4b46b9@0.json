{
  "cve_id": "CVE-2017-6498",
  "cve_desc": "An issue was discovered in ImageMagick 6.9.7. Incorrect TGA files could trigger assertion failures, thus leading to DoS.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "65f75a32a93ae4044c528a987a68366ecd4b46b9",
  "patch_info": {
    "commit_hash": "65f75a32a93ae4044c528a987a68366ecd4b46b9",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/65f75a32a93ae4044c528a987a68366ecd4b46b9",
    "files": [
      "coders/tga.c"
    ],
    "message": "https://github.com/ImageMagick/ImageMagick/pull/359",
    "before_after_code_files": [
      "coders/tga.c||coders/tga.c"
    ]
  },
  "patch_diff": {
    "coders/tga.c||coders/tga.c": [
      "File: coders/tga.c -> coders/tga.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "710:     }",
      "711: }",
      "713: static MagickBooleanType WriteTGAImage(const ImageInfo *image_info,Image *image)",
      "714: {",
      "715:   CompressionType",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "713: static MagickBooleanType WriteTGAImage(const ImageInfo *image_info,Image *image)",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "767:   if ((image->columns > 65535L) || (image->rows > 65535L))",
      "768:     ThrowWriterException(ImageError,\"WidthOrHeightExceedsLimit\");",
      "772:     compression=image_info->compression;",
      "773:   range=GetQuantumRange(5UL);",
      "774:   tga_info.id_length=0;",
      "",
      "[Removed Lines]",
      "769:   (void) TransformImageColorspace(image,sRGBColorspace);",
      "770:   compression=image->compression;",
      "771:   if (image_info->compression != UndefinedCompression)",
      "",
      "[Added Lines]",
      "770:   (void) TransformImageColorspace(image,sRGBColorspace);",
      "771:   compression=image->compression;",
      "772:   if (image_info->compression != UndefinedCompression)",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "852:   (void) WriteBlobLSBShort(image,tga_info.colormap_length);",
      "853:   (void) WriteBlobByte(image,tga_info.colormap_size);",
      "854:   (void) WriteBlobLSBShort(image,tga_info.x_origin);",
      "856:   (void) WriteBlobLSBShort(image,tga_info.width);",
      "857:   (void) WriteBlobLSBShort(image,tga_info.height);",
      "858:   (void) WriteBlobByte(image,tga_info.bits_per_pixel);",
      "",
      "[Removed Lines]",
      "855:   (void) WriteBlobLSBShort(image,tga_info.y_origin);",
      "",
      "[Added Lines]",
      "856:   (void) WriteBlobLSBShort(image,tga_info.y_origin);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6e338677f5cd7c08b6fc5b319121909f70c19ab2",
      "candidate_info": {
        "commit_hash": "6e338677f5cd7c08b6fc5b319121909f70c19ab2",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/6e338677f5cd7c08b6fc5b319121909f70c19ab2",
        "files": [
          "coders/tga.c"
        ],
        "message": "https://github.com/ImageMagick/ImageMagick/pull/359",
        "before_after_code_files": [
          "coders/tga.c||coders/tga.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "coders/tga.c||coders/tga.c"
          ],
          "candidate": [
            "coders/tga.c||coders/tga.c"
          ]
        }
      },
      "candidate_diff": {
        "coders/tga.c||coders/tga.c": [
          "File: coders/tga.c -> coders/tga.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "772:   if ((image->columns > 65535L) || (image->rows > 65535L))",
          "773:     ThrowWriterException(ImageError,\"WidthOrHeightExceedsLimit\");",
          "777:     compression=image_info->compression;",
          "778:   range=GetQuantumRange(5UL);",
          "779:   tga_info.id_length=0;",
          "",
          "[Removed Lines]",
          "774:   (void) TransformImageColorspace(image,sRGBColorspace,exception);",
          "775:   compression=image->compression;",
          "776:   if (image_info->compression != UndefinedCompression)",
          "",
          "[Added Lines]",
          "775:   (void) TransformImageColorspace(image,sRGBColorspace,exception);",
          "776:   compression=image->compression;",
          "777:   if (image_info->compression != UndefinedCompression)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "857:   (void) WriteBlobLSBShort(image,tga_info.colormap_length);",
          "858:   (void) WriteBlobByte(image,tga_info.colormap_size);",
          "859:   (void) WriteBlobLSBShort(image,tga_info.x_origin);",
          "861:   (void) WriteBlobLSBShort(image,tga_info.width);",
          "862:   (void) WriteBlobLSBShort(image,tga_info.height);",
          "863:   (void) WriteBlobByte(image,tga_info.bits_per_pixel);",
          "",
          "[Removed Lines]",
          "860:   (void) WriteBlobLSBShort(image,tga_info.y_origin);",
          "",
          "[Added Lines]",
          "861:   (void) WriteBlobLSBShort(image,tga_info.y_origin);",
          "",
          "---------------"
        ]
      }
    }
  ]
}