{
  "cve_id": "CVE-2017-6952",
  "cve_desc": "Integer overflow in the cs_winkernel_malloc function in winkernel_mm.c in Capstone 3.0.4 and earlier allows attackers to cause a denial of service (heap-based buffer overflow in a kernel driver) or possibly have unspecified other impact via a large value.",
  "repo": "aquynh/capstone",
  "patch_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
  "patch_info": {
    "commit_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
    "repo": "aquynh/capstone",
    "commit_url": "https://github.com/aquynh/capstone/commit/6fe86eef621b9849f51a5e1e5d73258a93440403",
    "files": [
      "windows/winkernel_mm.c"
    ],
    "message": "provide a validity check to prevent against Integer overflow conditions (#870)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.",
    "before_after_code_files": [
      "windows/winkernel_mm.c||windows/winkernel_mm.c"
    ]
  },
  "patch_diff": {
    "windows/winkernel_mm.c||windows/winkernel_mm.c": [
      "File: windows/winkernel_mm.c -> windows/winkernel_mm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: #include \"winkernel_mm.h\"",
      "5: #include <ntddk.h>",
      "8: static const ULONG CS_WINKERNEL_POOL_TAG = 'kwsC';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "6: #include <Ntintsafe.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "35: #pragma prefast(suppress : 30030)  // Allocating executable POOL_TYPE memory",
      "38:  if (!block) {",
      "39:   return NULL;",
      "40:  }",
      "",
      "[Removed Lines]",
      "36:  CS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "37:    NonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);",
      "",
      "[Added Lines]",
      "37:  size_t number_of_bytes = 0;",
      "38:  CS_WINKERNEL_MEMBLOCK *block = NULL;",
      "42:  if (!NT_SUCCESS(RtlSizeTAdd(size, sizeof(CS_WINKERNEL_MEMBLOCK), &number_of_bytes))) {",
      "43:   return NULL;",
      "44:  }",
      "45:  block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "46:    NonPagedPool, number_of_bytes, CS_WINKERNEL_POOL_TAG);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "abded301c4b0461c4bb8c31615c170608ca03478",
      "candidate_info": {
        "commit_hash": "abded301c4b0461c4bb8c31615c170608ca03478",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/abded301c4b0461c4bb8c31615c170608ca03478",
        "files": [
          "include/capstone/capstone.h"
        ],
        "message": "Update capstone.h\n\nVS2015: error: C2440: 'initializing': cannot convert from 'const char [4]' to 'char *'",
        "before_after_code_files": [
          "include/capstone/capstone.h||include/capstone/capstone.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/capstone/capstone.h||include/capstone/capstone.h": [
          "File: include/capstone/capstone.h -> include/capstone/capstone.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "142:  unsigned int id;",
          "145: } cs_opt_mnem;",
          "",
          "[Removed Lines]",
          "144:  char *mnemonic;",
          "",
          "[Added Lines]",
          "144:  const char *mnemonic;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ad25742e89a20fdc507c4ef45cc37369be27374a",
      "candidate_info": {
        "commit_hash": "ad25742e89a20fdc507c4ef45cc37369be27374a",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/ad25742e89a20fdc507c4ef45cc37369be27374a",
        "files": [
          "cstool/cstool.c"
        ],
        "message": "cstool: version 2 could print all debug information for all arch.",
        "before_after_code_files": [
          "cstool/cstool.c||cstool/cstool.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "cstool/cstool.c||cstool/cstool.c": [
          "File: cstool/cstool.c -> cstool/cstool.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "324:     }",
          "325:    }",
          "326:    printf(\"  %s\\t%s\\n\", insn[i].mnemonic, insn[i].op_str);",
          "328:                 if (!strcmp(arch, \"x86\")) {",
          "329:                     print_insn_detail_x86(handle, md, &insn[i]);",
          "330:                 }",
          "",
          "[Removed Lines]",
          "327:             if (debug_flag) {//different mode should call different print functions",
          "",
          "[Added Lines]",
          "327:             if (debug_flag) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fe36ea98408117d66cae3136536fbebabfc2e226",
      "candidate_info": {
        "commit_hash": "fe36ea98408117d66cae3136536fbebabfc2e226",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/fe36ea98408117d66cae3136536fbebabfc2e226",
        "files": [
          "xcode/Capstone.xcodeproj/project.pbxproj",
          "xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Dynamic Library.xcscheme",
          "xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Framework.xcscheme",
          "xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Static Library.xcscheme",
          "xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Tests.xcscheme"
        ],
        "message": "Updated Xcode project for Xcode 9.1 (#1053)",
        "before_after_code_files": [
          "xcode/Capstone.xcodeproj/project.pbxproj||xcode/Capstone.xcodeproj/project.pbxproj",
          "xcode/Capstone.xcodeproj/xcshareddatxcschemes/Framework.xcscheme||xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Framework.xcscheme",
          "xcode/Capstone.xcodeproj/xcshareddatxcschemes/Tests.xcscheme||xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Tests.xcscheme"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "xcode/Capstone.xcodeproj/project.pbxproj||xcode/Capstone.xcodeproj/project.pbxproj": [
          "File: xcode/Capstone.xcodeproj/project.pbxproj -> xcode/Capstone.xcodeproj/project.pbxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "286:   DC474E6C19DDEA9500BCA449 /* test_arm.c */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.c; name = test_arm.c; path = ../tests/test_arm.c; sourceTree = \"<group>\"; };",
          "287:   DC474E6D19DDEA9500BCA449 /* test_arm64.c */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.c; name = test_arm64.c; path = ../tests/test_arm64.c; sourceTree = \"<group>\"; };",
          "288:   DC474E6E19DDEA9500BCA449 /* test_detail.c */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.c; name = test_detail.c; path = ../tests/test_detail.c; sourceTree = \"<group>\"; };",
          "",
          "[Removed Lines]",
          "285:   DC474E6419DDEA5F00BCA449 /* test_basic */ = {isa = PBXFileReference; explicitFileType = \"compiled.mach-o.executable\"; includeInIndex = 0; path = test; sourceTree = BUILT_PRODUCTS_DIR; };",
          "",
          "[Added Lines]",
          "285:   DC474E6419DDEA5F00BCA449 /* test */ = {isa = PBXFileReference; explicitFileType = \"compiled.mach-o.executable\"; includeInIndex = 0; name = test; path = test_basic; sourceTree = BUILT_PRODUCTS_DIR; };",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "633:    children = (",
          "634:     DCFE23BD19DDCC2D00EF8EA9 /* libcapstone.a */,",
          "635:     DCFE23CD19DDCC9500EF8EA9 /* libcapstone.dylib */,",
          "637:     DC474E8619DDEAA200BCA449 /* test_arm */,",
          "638:     DC474E9119DDEAA700BCA449 /* test_detail */,",
          "639:     DC474E9C19DDEAAC00BCA449 /* test_mips */,",
          "",
          "[Removed Lines]",
          "636:     DC474E6419DDEA5F00BCA449 /* test_basic */,",
          "",
          "[Added Lines]",
          "636:     DC474E6419DDEA5F00BCA449 /* test */,",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "904:    );",
          "905:    name = test_basic;",
          "906:    productName = test_basic;",
          "908:    productType = \"com.apple.product-type.tool\";",
          "909:   };",
          "910:   DC474E8519DDEAA200BCA449 /* test_arm */ = {",
          "",
          "[Removed Lines]",
          "907:    productReference = DC474E6419DDEA5F00BCA449 /* test_basic */;",
          "",
          "[Added Lines]",
          "907:    productReference = DC474E6419DDEA5F00BCA449 /* test */;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1152:   DCFE239A19DDCB4900EF8EA9 /* Project object */ = {",
          "1153:    isa = PBXProject;",
          "1154:    attributes = {",
          "1156:     TargetAttributes = {",
          "1157:      DC474E6319DDEA5F00BCA449 = {",
          "1158:       CreatedOnToolsVersion = 6.1;",
          "",
          "[Removed Lines]",
          "1155:     LastUpgradeCheck = 0610;",
          "",
          "[Added Lines]",
          "1155:     LastUpgradeCheck = 0910;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2649:   DCFE239E19DDCB4900EF8EA9 /* Debug */ = {",
          "2650:    isa = XCBuildConfiguration;",
          "2651:    buildSettings = {",
          "2652:    };",
          "2653:    name = Debug;",
          "2654:   };",
          "2655:   DCFE239F19DDCB4900EF8EA9 /* Release */ = {",
          "2656:    isa = XCBuildConfiguration;",
          "2657:    buildSettings = {",
          "2658:    };",
          "2659:    name = Release;",
          "2660:   };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2652:     CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING = YES;",
          "2653:     CLANG_WARN_BOOL_CONVERSION = YES;",
          "2654:     CLANG_WARN_COMMA = YES;",
          "2655:     CLANG_WARN_CONSTANT_CONVERSION = YES;",
          "2656:     CLANG_WARN_EMPTY_BODY = YES;",
          "2657:     CLANG_WARN_ENUM_CONVERSION = YES;",
          "2658:     CLANG_WARN_INFINITE_RECURSION = YES;",
          "2659:     CLANG_WARN_INT_CONVERSION = YES;",
          "2660:     CLANG_WARN_NON_LITERAL_NULL_CONVERSION = YES;",
          "2661:     CLANG_WARN_OBJC_LITERAL_CONVERSION = YES;",
          "2662:     CLANG_WARN_RANGE_LOOP_ANALYSIS = YES;",
          "2663:     CLANG_WARN_STRICT_PROTOTYPES = YES;",
          "2664:     CLANG_WARN_SUSPICIOUS_MOVE = YES;",
          "2665:     CLANG_WARN_UNREACHABLE_CODE = YES;",
          "2666:     CLANG_WARN__DUPLICATE_METHOD_MATCH = YES;",
          "2667:     ENABLE_STRICT_OBJC_MSGSEND = YES;",
          "2668:     ENABLE_TESTABILITY = YES;",
          "2669:     GCC_NO_COMMON_BLOCKS = YES;",
          "2670:     GCC_WARN_64_TO_32_BIT_CONVERSION = YES;",
          "2671:     GCC_WARN_ABOUT_RETURN_TYPE = YES;",
          "2672:     GCC_WARN_UNDECLARED_SELECTOR = YES;",
          "2673:     GCC_WARN_UNINITIALIZED_AUTOS = YES;",
          "2674:     GCC_WARN_UNUSED_FUNCTION = YES;",
          "2675:     GCC_WARN_UNUSED_VARIABLE = YES;",
          "2682:     CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING = YES;",
          "2683:     CLANG_WARN_BOOL_CONVERSION = YES;",
          "2684:     CLANG_WARN_COMMA = YES;",
          "2685:     CLANG_WARN_CONSTANT_CONVERSION = YES;",
          "2686:     CLANG_WARN_EMPTY_BODY = YES;",
          "2687:     CLANG_WARN_ENUM_CONVERSION = YES;",
          "2688:     CLANG_WARN_INFINITE_RECURSION = YES;",
          "2689:     CLANG_WARN_INT_CONVERSION = YES;",
          "2690:     CLANG_WARN_NON_LITERAL_NULL_CONVERSION = YES;",
          "2691:     CLANG_WARN_OBJC_LITERAL_CONVERSION = YES;",
          "2692:     CLANG_WARN_RANGE_LOOP_ANALYSIS = YES;",
          "2693:     CLANG_WARN_STRICT_PROTOTYPES = YES;",
          "2694:     CLANG_WARN_SUSPICIOUS_MOVE = YES;",
          "2695:     CLANG_WARN_UNREACHABLE_CODE = YES;",
          "2696:     CLANG_WARN__DUPLICATE_METHOD_MATCH = YES;",
          "2697:     ENABLE_STRICT_OBJC_MSGSEND = YES;",
          "2698:     GCC_NO_COMMON_BLOCKS = YES;",
          "2699:     GCC_WARN_64_TO_32_BIT_CONVERSION = YES;",
          "2700:     GCC_WARN_ABOUT_RETURN_TYPE = YES;",
          "2701:     GCC_WARN_UNDECLARED_SELECTOR = YES;",
          "2702:     GCC_WARN_UNINITIALIZED_AUTOS = YES;",
          "2703:     GCC_WARN_UNUSED_FUNCTION = YES;",
          "2704:     GCC_WARN_UNUSED_VARIABLE = YES;",
          "",
          "---------------"
        ],
        "xcode/Capstone.xcodeproj/xcshareddatxcschemes/Framework.xcscheme||xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Framework.xcscheme": [
          "File: xcode/Capstone.xcodeproj/xcshareddatxcschemes/Framework.xcscheme -> xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Framework.xcscheme",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3:    LastUpgradeVersion = \"0910\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "26:       buildConfiguration = \"Debug\"",
          "29:       language = \"\"",
          "30:       shouldUseLaunchSchemeArgsEnv = \"YES\">",
          "33:       <AdditionalOptions>",
          "34:       </AdditionalOptions>",
          "37:       buildConfiguration = \"Debug\"",
          "40:       language = \"\"",
          "45:       debugServiceExtension = \"internal\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "60:       buildConfiguration = \"Release\"",
          "",
          "---------------"
        ],
        "xcode/Capstone.xcodeproj/xcshareddatxcschemes/Tests.xcscheme||xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Tests.xcscheme": [
          "File: xcode/Capstone.xcodeproj/xcshareddatxcschemes/Tests.xcscheme -> xcode/Capstone.xcodeproj/xcshareddata/xcschemes/Tests.xcscheme",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3:    LastUpgradeVersion = \"0910\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "183:       language = \"\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "203:       language = \"\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "93bfcf16c15daf3b26750fa2f7e2f65df1ac5738",
      "candidate_info": {
        "commit_hash": "93bfcf16c15daf3b26750fa2f7e2f65df1ac5738",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/93bfcf16c15daf3b26750fa2f7e2f65df1ac5738",
        "files": [
          "xcode/Capstone.xcodeproj/project.pbxproj",
          "xcode/CapstoneFramework/module.modulemap"
        ],
        "message": "macOS framework - Added a module map for Swift/Objective-C. (#1056)",
        "before_after_code_files": [
          "xcode/Capstone.xcodeproj/project.pbxproj||xcode/Capstone.xcodeproj/project.pbxproj",
          "xcode/CapstoneFramework/module.modulemap||xcode/CapstoneFramework/module.modulemap"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "xcode/Capstone.xcodeproj/project.pbxproj||xcode/Capstone.xcodeproj/project.pbxproj": [
          "File: xcode/Capstone.xcodeproj/project.pbxproj -> xcode/Capstone.xcodeproj/project.pbxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "285:   DC474E6419DDEA5F00BCA449 /* test */ = {isa = PBXFileReference; explicitFileType = \"compiled.mach-o.executable\"; includeInIndex = 0; name = test; path = test_basic; sourceTree = BUILT_PRODUCTS_DIR; };",
          "286:   DC474E6C19DDEA9500BCA449 /* test_arm.c */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.c; name = test_arm.c; path = ../tests/test_arm.c; sourceTree = \"<group>\"; };",
          "287:   DC474E6D19DDEA9500BCA449 /* test_arm64.c */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = sourcecode.c.c; name = test_arm64.c; path = ../tests/test_arm64.c; sourceTree = \"<group>\"; };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "285:   05C355F01FC4AB0C00C89728 /* module.modulemap */ = {isa = PBXFileReference; fileEncoding = 4; lastKnownFileType = \"sourcecode.module-map\"; path = module.modulemap; sourceTree = \"<group>\"; };",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "595:   DC474F6919DE6F3B00BCA449 /* framework */ = {",
          "596:    isa = PBXGroup;",
          "597:    children = (",
          "598:     DC474F6B19DE6F3B00BCA449 /* Info.plist */,",
          "599:    );",
          "600:    name = framework;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "599:     05C355F01FC4AB0C00C89728 /* module.modulemap */,",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2489:     INSTALL_PATH = \"@rpath\";",
          "2490:     LD_RUNPATH_SEARCH_PATHS = \"$(inherited) @executable_path/../Frameworks @loader_path/Frameworks\";",
          "2491:     MACOSX_DEPLOYMENT_TARGET = 10.9;",
          "2492:     MTL_ENABLE_DEBUG_INFO = YES;",
          "2493:     ONLY_ACTIVE_ARCH = YES;",
          "2494:     PRODUCT_NAME = Capstone;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2494:     MODULEMAP_FILE = \"$(SRCROOT)/CapstoneFramework/module.modulemap\";",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2551:     INSTALL_PATH = \"@rpath\";",
          "2552:     LD_RUNPATH_SEARCH_PATHS = \"$(inherited) @executable_path/../Frameworks @loader_path/Frameworks\";",
          "2553:     MACOSX_DEPLOYMENT_TARGET = 10.9;",
          "2554:     MTL_ENABLE_DEBUG_INFO = NO;",
          "2555:     PRODUCT_NAME = Capstone;",
          "2556:     SDKROOT = macosx;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2557:     MODULEMAP_FILE = \"$(SRCROOT)/CapstoneFramework/module.modulemap\";",
          "",
          "---------------"
        ],
        "xcode/CapstoneFramework/module.modulemap||xcode/CapstoneFramework/module.modulemap": [
          "File: xcode/CapstoneFramework/module.modulemap -> xcode/CapstoneFramework/module.modulemap",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: module capstone {",
          "2:     header \"Headers/capstone.h\"",
          "3:     export *",
          "4: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1af1e412b7ce113c5398e70705e356d26f28288f",
      "candidate_info": {
        "commit_hash": "1af1e412b7ce113c5398e70705e356d26f28288f",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/1af1e412b7ce113c5398e70705e356d26f28288f",
        "files": [
          "cstool/cstool_arm64.c",
          "cstool/cstool_ppc.c",
          "tests/test_arm64.c",
          "tests/test_m680x.c"
        ],
        "message": "fix tests & cstool, so we can compile on MSVC 2010",
        "before_after_code_files": [
          "cstool/cstool_arm64.c||cstool/cstool_arm64.c",
          "cstool/cstool_ppc.c||cstool/cstool_ppc.c",
          "tests/test_arm64.c||tests/test_arm64.c",
          "tests/test_m680x.c||tests/test_m680x.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "cstool/cstool_arm64.c||cstool/cstool_arm64.c": [
          "File: cstool/cstool_arm64.c -> cstool/cstool_arm64.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "14:  int i;",
          "15:  cs_regs regs_read, regs_write;",
          "16:  uint8_t regs_read_count, regs_write_count;",
          "19:  if (ins->detail == NULL)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "17:  uint8_t access;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "75:     break;",
          "76:   }",
          "79:   switch(access) {",
          "80:    default:",
          "81:     break;",
          "",
          "[Removed Lines]",
          "78:   uint8_t access = op->access;",
          "",
          "[Added Lines]",
          "79:   access = op->access;",
          "",
          "---------------"
        ],
        "cstool/cstool_ppc.c||cstool/cstool_ppc.c": [
          "File: cstool/cstool_ppc.c -> cstool/cstool_ppc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #include <stdio.h>",
          "7: #include <capstone/capstone.h>",
          "",
          "[Removed Lines]",
          "4: #include <inttypes.h>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "tests/test_arm64.c||tests/test_arm64.c": [
          "File: tests/test_arm64.c -> tests/test_arm64.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "34:  cs_arm64 *arm64;",
          "35:  int i;",
          "36:  cs_regs regs_read, regs_write;",
          "40:  if (ins->detail == NULL)",
          "",
          "[Removed Lines]",
          "37:  uint8_t regs_read_count, regs_write_count;",
          "",
          "[Added Lines]",
          "37:  unsigned char regs_read_count, regs_write_count;",
          "38:  unsigned char access;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "96:     break;",
          "97:   }",
          "100:   switch(access) {",
          "101:    default:",
          "102:     break;",
          "",
          "[Removed Lines]",
          "99:   uint8_t access = op->access;",
          "",
          "[Added Lines]",
          "100:   access = op->access;",
          "",
          "---------------"
        ],
        "tests/test_m680x.c||tests/test_m680x.c": [
          "File: tests/test_m680x.c -> tests/test_m680x.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "360:    printf(\"Disasm:\\n\");",
          "362:    for (j = 0; j < count; j++) {",
          "363:     printf(\"0x%04X: \", (uint16_t)insn[j].address);",
          "364:     print_string_hex_short(insn[j].bytes,",
          "365:      insn[j].size);",
          "366:     printf(\"%.*s\", 1 + ((5 - insn[j].size) * 2),",
          "367:      nine_spaces);",
          "368:     printf(\"%s\", insn[j].mnemonic);",
          "370:     printf(\"%.*s\", 1 + (5 - slen), nine_spaces);",
          "371:     printf(\"%s\\n\", insn[j].op_str);",
          "372: #ifdef WITH_DETAILS",
          "",
          "[Removed Lines]",
          "369:     int slen = (int)strlen(insn[j].mnemonic);",
          "",
          "[Added Lines]",
          "363:     int slen;",
          "370:     slen = (int)strlen(insn[j].mnemonic);",
          "",
          "---------------"
        ]
      }
    }
  ]
}