{
  "cve_id": "CVE-2015-7551",
  "cve_desc": "The Fiddle::Handle implementation in ext/fiddle/handle.c in Ruby before 2.0.0-p648, 2.1 before 2.1.8, and 2.2 before 2.2.4, as distributed in Apple OS X before 10.11.4 and other products, mishandles tainting, which allows context-dependent attackers to execute arbitrary code or cause a denial of service (application crash) via a crafted string, related to the DL module and the libffi library.  NOTE: this vulnerability exists because of a CVE-2009-5147 regression.",
  "repo": "ruby/ruby",
  "patch_hash": "339e11a7f178312d937b7c95dd3115ce7236597a",
  "patch_info": {
    "commit_hash": "339e11a7f178312d937b7c95dd3115ce7236597a",
    "repo": "ruby/ruby",
    "commit_url": "https://github.com/ruby/ruby/commit/339e11a7f178312d937b7c95dd3115ce7236597a",
    "files": [
      "ChangeLog",
      "ext/fiddle/handle.c",
      "test/fiddle/test_handle.rb",
      "version.h"
    ],
    "message": "merge revision(s): 53153 and 23405@ruby_1_9_1\n\n\t* ext/fiddle/handle.c: check tainted string arguments.\n\t  Patch provided by tenderlove and nobu.\n\n\t* test/fiddle/test_handle.rb (class TestHandle): add test for above.\n\n\t* ext/dl/handle.c (rb_dlhandle_initialize): prohibits DL::dlopen\n\t  with a tainted name of library.\n\t  Patch by sheepman <sheepman AT sheepman.sakura.ne.jp>.\n\n\t* ext/dl/handle.c (rb_dlhandle_sym): ditto\n\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@53156 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
    "before_after_code_files": [
      "ext/fiddle/handle.c||ext/fiddle/handle.c",
      "test/fiddle/test_handle.rb||test/fiddle/test_handle.rb",
      "version.h||version.h"
    ]
  },
  "patch_diff": {
    "ext/fiddle/handle.c||ext/fiddle/handle.c": [
      "File: ext/fiddle/handle.c -> ext/fiddle/handle.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #include <ruby.h>",
      "2: #include <fiddle.h>",
      "4: VALUE rb_cHandle;",
      "6: struct dl_handle {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4: #define SafeStringValueCStr(v) (rb_check_safe_obj(rb_string_value(&v)), StringValueCStr(v))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "143:  cflag = RTLD_LAZY | RTLD_GLOBAL;",
      "144:  break;",
      "145:       case 1:",
      "147:  cflag = RTLD_LAZY | RTLD_GLOBAL;",
      "148:  break;",
      "149:       case 2:",
      "151:  cflag = NUM2INT(flag);",
      "152:  break;",
      "153:       default:",
      "",
      "[Removed Lines]",
      "146:  clib = NIL_P(lib) ? NULL : StringValuePtr(lib);",
      "150:  clib = NIL_P(lib) ? NULL : StringValuePtr(lib);",
      "",
      "[Added Lines]",
      "148:  clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);",
      "152:  clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "263:     return PTR2NUM(fiddle_handle);",
      "264: }",
      "",
      "[Removed Lines]",
      "266: static VALUE fiddle_handle_sym(void *handle, const char *symbol);",
      "",
      "[Added Lines]",
      "268: static VALUE fiddle_handle_sym(void *handle, VALUE symbol);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "282:  rb_raise(rb_eFiddleError, \"closed handle\");",
      "283:     }",
      "286: }",
      "288: #ifndef RTLD_NEXT",
      "",
      "[Removed Lines]",
      "285:     return fiddle_handle_sym(fiddle_handle->ptr, StringValueCStr(sym));",
      "",
      "[Added Lines]",
      "287:     return fiddle_handle_sym(fiddle_handle->ptr, sym);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "305: static VALUE",
      "306: rb_fiddle_handle_s_sym(VALUE self, VALUE sym)",
      "307: {",
      "309: }",
      "311: static VALUE",
      "313: {",
      "314: #if defined(HAVE_DLERROR)",
      "315:     const char *err;",
      "",
      "[Removed Lines]",
      "308:     return fiddle_handle_sym(RTLD_NEXT, StringValueCStr(sym));",
      "312: fiddle_handle_sym(void *handle, const char *name)",
      "",
      "[Added Lines]",
      "310:     return fiddle_handle_sym(RTLD_NEXT, sym);",
      "314: fiddle_handle_sym(void *handle, VALUE symbol)",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "318: # define CHECK_DLERROR",
      "319: #endif",
      "320:     void (*func)();",
      "322:     rb_secure(2);",
      "323: #ifdef HAVE_DLERROR",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "323:     const char *name = SafeStringValueCStr(symbol);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "367:     }",
      "368: #endif",
      "369:     if( !func ){",
      "371:     }",
      "373:     return PTR2NUM(func);",
      "",
      "[Removed Lines]",
      "370:  rb_raise(rb_eFiddleError, \"unknown symbol \\\"%s\\\"\", name);",
      "",
      "[Added Lines]",
      "373:  rb_raise(rb_eFiddleError, \"unknown symbol \\\"%\"PRIsVALUE\"\\\"\", symbol);",
      "",
      "---------------"
    ],
    "test/fiddle/test_handle.rb||test/fiddle/test_handle.rb": [
      "File: test/fiddle/test_handle.rb -> test/fiddle/test_handle.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "11:     include Test::Unit::Assertions",
      "13:     def test_to_i",
      "14:       handle = Fiddle::Handle.new(LIBC_SO)",
      "15:       assert_kind_of Integer, handle.to_i",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13:     def test_safe_handle_open",
      "14:       t = Thread.new do",
      "15:         $SAFE = 1",
      "16:         Fiddle::Handle.new(LIBC_SO.taint)",
      "17:       end",
      "18:       assert_raise(SecurityError) { t.value }",
      "19:     end",
      "21:     def test_safe_function_lookup",
      "22:       t = Thread.new do",
      "23:         h = Fiddle::Handle.new(LIBC_SO)",
      "24:         $SAFE = 1",
      "25:         h[\"qsort\".taint]",
      "26:       end",
      "27:       assert_raise(SecurityError) { t.value }",
      "28:     end",
      "",
      "---------------"
    ],
    "version.h||version.h": [
      "File: version.h -> version.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #define RUBY_VERSION \"2.1.8\"",
      "2: #define RUBY_RELEASE_DATE \"2015-12-16\"",
      "5: #define RUBY_RELEASE_YEAR 2015",
      "6: #define RUBY_RELEASE_MONTH 12",
      "",
      "[Removed Lines]",
      "3: #define RUBY_PATCHLEVEL 438",
      "",
      "[Added Lines]",
      "3: #define RUBY_PATCHLEVEL 439",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "4d683d0566a16c3a7bc0d91bb92a36358613cf63",
      "candidate_info": {
        "commit_hash": "4d683d0566a16c3a7bc0d91bb92a36358613cf63",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/4d683d0566a16c3a7bc0d91bb92a36358613cf63",
        "files": [
          "ChangeLog",
          "gc.c",
          "version.h"
        ],
        "message": "merge revision(s) r48999,r49484: [Backport #10646]\n\n\t* gc.c (wmap_final_func): fix memory size shortage when realloc wmap.\n\t  Fix SEGV during finilize of WeakRef on Solaris (though the SEGV\n\t  could occur on all OS/platforms). [ruby-dev:48779] [Bug #10646]\n\t  Fix SEGV during finalize of WeakRef on Solaris (though the SEGV\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@50132 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "gc.c||gc.c",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "gc.c||gc.c": [
          "File: gc.c -> gc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6413:  return ST_DELETE;",
          "6414:     }",
          "6415:     if (j < i) {",
          "6417:  ptr[0] = j;",
          "6419:     }",
          "",
          "[Removed Lines]",
          "6416:  ptr = ruby_sized_xrealloc2(ptr, j, sizeof(VALUE), i);",
          "",
          "[Added Lines]",
          "6416:  ptr = ruby_sized_xrealloc2(ptr, j + 1, sizeof(VALUE), i);",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.5\"",
          "2: #define RUBY_RELEASE_DATE \"2015-03-31\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 327",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 328",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "50a611e8c367517702ceefca09267cdb8caa3eb0",
      "candidate_info": {
        "commit_hash": "50a611e8c367517702ceefca09267cdb8caa3eb0",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/50a611e8c367517702ceefca09267cdb8caa3eb0",
        "files": [
          "ChangeLog",
          "test/ruby/test_string.rb",
          "version.h"
        ],
        "message": "* test/ruby/test_string.rb(test_LSHIFT_neary_long_max):   increase timeout for Arch Linux CI environment.\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@49150 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "test/ruby/test_string.rb||test/ruby/test_string.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "test/ruby/test_string.rb||test/ruby/test_string.rb": [
          "File: test/ruby/test_string.rb -> test/ruby/test_string.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "2228:   def test_LSHIFT_neary_long_max",
          "2229:     return unless @cls == String",
          "2231:       begin",
          "2232:         a = \"a\" * 0x4000_0000",
          "2233:         a << \"a\" * 0x1_0000",
          "",
          "[Removed Lines]",
          "2230:     assert_ruby_status([], <<-'end;', '[ruby-core:61886] [Bug #9709]', timeout: 20)",
          "",
          "[Added Lines]",
          "2230:     assert_ruby_status([], <<-'end;', '[ruby-core:61886] [Bug #9709]', timeout: 60)",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.5\"",
          "9: #include \"ruby/version.h\"",
          "",
          "[Removed Lines]",
          "2: #define RUBY_RELEASE_DATE \"2014-12-31\"",
          "3: #define RUBY_PATCHLEVEL 275",
          "5: #define RUBY_RELEASE_YEAR 2014",
          "6: #define RUBY_RELEASE_MONTH 12",
          "7: #define RUBY_RELEASE_DAY 31",
          "",
          "[Added Lines]",
          "2: #define RUBY_RELEASE_DATE \"2015-01-05\"",
          "3: #define RUBY_PATCHLEVEL 276",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 1",
          "7: #define RUBY_RELEASE_DAY 5",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a0cf0fbd84eb419120f36a1263b94f63008cfa62",
      "candidate_info": {
        "commit_hash": "a0cf0fbd84eb419120f36a1263b94f63008cfa62",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/a0cf0fbd84eb419120f36a1263b94f63008cfa62",
        "files": [
          "ChangeLog",
          "ext/bigdecimal/bigdecimal.gemspec",
          "ext/io/console/io-console.gemspec",
          "version.h"
        ],
        "message": "merge revision(s) 50860: [Backport #11249]\n\n\t* ext/bigdecimal/bigdecimal.gemspec: Fix require paths for released gem.\n\t  [fix GH-929] Patch by @voxik\n\n\t* ext/io/console/io-console.gemspec: ditto.\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@51177 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "ext/bigdecimal/bigdecimal.gemspec||ext/bigdecimal/bigdecimal.gemspec",
          "ext/io/console/io-console.gemspec||ext/io/console/io-console.gemspec",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "ext/bigdecimal/bigdecimal.gemspec||ext/bigdecimal/bigdecimal.gemspec": [
          "File: ext/bigdecimal/bigdecimal.gemspec -> ext/bigdecimal/bigdecimal.gemspec",
          "--- Hunk 1 ---",
          "[Context before]",
          "12:   s.email = \"mrkn@mrkn.jp\"",
          "13:   s.description = \"This library provides arbitrary-precision decimal floating-point number class.\"",
          "14:   s.authors = [\"Kenta Murata\", \"Zachary Scott\", \"Shigeo Kobayashi\"]",
          "16:   s.files = %w[",
          "17:     bigdecimal.gemspec",
          "18:     bigdecimal.c",
          "",
          "[Removed Lines]",
          "15:   s.require_path = %[.]",
          "",
          "[Added Lines]",
          "15:   s.require_path = %[lib]",
          "",
          "---------------"
        ],
        "ext/io/console/io-console.gemspec||ext/io/console/io-console.gemspec": [
          "File: ext/io/console/io-console.gemspec -> ext/io/console/io-console.gemspec",
          "--- Hunk 1 ---",
          "[Context before]",
          "12:   s.required_ruby_version = \">= 2.0.0\"",
          "13:   s.homepage = \"http://www.ruby-lang.org\"",
          "14:   s.authors = [\"Nobu Nakada\"]",
          "16:   s.files = %w[console.c extconf.rb lib/console/size.rb]",
          "17:   s.extensions = %w[extconf.rb]",
          "18:   s.licenses = \"ruby\"",
          "",
          "[Removed Lines]",
          "15:   s.require_path = %[.]",
          "",
          "[Added Lines]",
          "15:   s.require_path = %[lib]",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.7\"",
          "2: #define RUBY_RELEASE_DATE \"2015-07-07\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 7",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 377",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 378",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3e98a6494b35d2030ac2b4837a51d7e22d3d22a5",
      "candidate_info": {
        "commit_hash": "3e98a6494b35d2030ac2b4837a51d7e22d3d22a5",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/3e98a6494b35d2030ac2b4837a51d7e22d3d22a5",
        "files": [
          "ChangeLog",
          "ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb",
          "version.h"
        ],
        "message": "merge revision(s) 54022: [Backport #11893]\n\n\t* ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb: fix method name typo.\n\t  [ruby-core:72513] [Bug #11893] The patch provided by Akira Matsuda.\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@54281 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb||ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb||ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb": [
          "File: ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb -> ext/tk/lib/tkextlib/tcllib/tablelist_tile.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "15:   Tk::Tcllib::Tablelist_usingTile = true",
          "16: end",
          "20: module Tk",
          "21:   module Tcllib",
          "",
          "[Removed Lines]",
          "18: requrie 'tkextlib/tcllib/tablelist_core'",
          "",
          "[Added Lines]",
          "18: require 'tkextlib/tcllib/tablelist_core'",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.9\"",
          "2: #define RUBY_RELEASE_DATE \"2016-03-25\"",
          "5: #define RUBY_RELEASE_YEAR 2016",
          "6: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 478",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 479",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "485267354273fc2ca2c9b1f22e39c5f1f414f4ca",
      "candidate_info": {
        "commit_hash": "485267354273fc2ca2c9b1f22e39c5f1f414f4ca",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/485267354273fc2ca2c9b1f22e39c5f1f414f4ca",
        "files": [
          "ChangeLog",
          "parse.y",
          "test/ruby/test_syntax.rb",
          "version.h"
        ],
        "message": "merge revision(s) 50265: [Backport #10957]\n\n\t* parse.y (arg): fix segfault by null caused by syntax error.\n\t  [ruby-core:68851] [Bug #10957]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@50283 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "parse.y||parse.y",
          "test/ruby/test_syntax.rb||test/ruby/test_syntax.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "parse.y||parse.y": [
          "File: parse.y -> parse.y",
          "--- Hunk 1 ---",
          "[Context before]",
          "2047:    value_expr($3);",
          "2048:    $$ = NEW_DOT2($1, $3);",
          "2049:    if ($1 && nd_type($1) == NODE_LIT && FIXNUM_P($1->nd_lit) &&",
          "2051:        deferred_nodes = list_append(deferred_nodes, $$);",
          "2052:    }",
          "",
          "[Removed Lines]",
          "2050:        nd_type($3) == NODE_LIT && FIXNUM_P($3->nd_lit)) {",
          "",
          "[Added Lines]",
          "2050:        $3 && nd_type($3) == NODE_LIT && FIXNUM_P($3->nd_lit)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2061:    value_expr($3);",
          "2062:    $$ = NEW_DOT3($1, $3);",
          "2063:    if ($1 && nd_type($1) == NODE_LIT && FIXNUM_P($1->nd_lit) &&",
          "2065:        deferred_nodes = list_append(deferred_nodes, $$);",
          "2066:    }",
          "",
          "[Removed Lines]",
          "2064:        nd_type($3) == NODE_LIT && FIXNUM_P($3->nd_lit)) {",
          "",
          "[Added Lines]",
          "2064:        $3 && nd_type($3) == NODE_LIT && FIXNUM_P($3->nd_lit)) {",
          "",
          "---------------"
        ],
        "test/ruby/test_syntax.rb||test/ruby/test_syntax.rb": [
          "File: test/ruby/test_syntax.rb -> test/ruby/test_syntax.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "412:     bug10957 = '[ruby-core:68477] [Bug #10957]'",
          "413:     assert_ruby_status(['-c', '-e', 'p ()..0'], \"\", bug10957)",
          "414:     assert_ruby_status(['-c', '-e', 'p ()...0'], \"\", bug10957)",
          "415:   end",
          "417:   private",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "415:     assert_syntax_error('0..%w.', /unterminated string/, bug10957)",
          "416:     assert_syntax_error('0...%w.', /unterminated string/, bug10957)",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.5\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "9: #include \"ruby/version.h\"",
          "",
          "[Removed Lines]",
          "2: #define RUBY_RELEASE_DATE \"2015-03-31\"",
          "3: #define RUBY_PATCHLEVEL 329",
          "6: #define RUBY_RELEASE_MONTH 3",
          "7: #define RUBY_RELEASE_DAY 31",
          "",
          "[Added Lines]",
          "2: #define RUBY_RELEASE_DATE \"2015-04-13\"",
          "3: #define RUBY_PATCHLEVEL 330",
          "6: #define RUBY_RELEASE_MONTH 4",
          "7: #define RUBY_RELEASE_DAY 13",
          "",
          "---------------"
        ]
      }
    }
  ]
}