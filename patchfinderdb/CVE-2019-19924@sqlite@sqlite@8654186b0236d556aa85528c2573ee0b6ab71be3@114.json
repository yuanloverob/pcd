{
  "cve_id": "CVE-2019-19924",
  "cve_desc": "SQLite 3.30.1 mishandles certain parser-tree rewriting, related to expr.c, vdbeaux.c, and window.c. This is caused by incorrect sqlite3WindowRewrite() error handling.",
  "repo": "sqlite/sqlite",
  "patch_hash": "8654186b0236d556aa85528c2573ee0b6ab71be3",
  "patch_info": {
    "commit_hash": "8654186b0236d556aa85528c2573ee0b6ab71be3",
    "repo": "sqlite/sqlite",
    "commit_url": "https://github.com/sqlite/sqlite/commit/8654186b0236d556aa85528c2573ee0b6ab71be3",
    "files": [
      "manifest",
      "manifest.uuid",
      "src/expr.c",
      "src/vdbeaux.c",
      "src/window.c"
    ],
    "message": "When an error occurs while rewriting the parser tree for window functions in the sqlite3WindowRewrite() routine, make sure that pParse->nErr is set, and make sure that this shuts down any subsequent code generation that might depend on the transformations that were implemented.  This fixes a problem discovered by the Yongheng and Rui fuzzer.\n\nFossilOrigin-Name: e2bddcd4c55ba3cbe0130332679ff4b048630d0ced9a8899982edb5a3569ba7f",
    "before_after_code_files": [
      "manifest.uuid||manifest.uuid",
      "src/expr.c||src/expr.c",
      "src/vdbeaux.c||src/vdbeaux.c",
      "src/window.c||src/window.c"
    ]
  },
  "patch_diff": {
    "manifest.uuid||manifest.uuid": [
      "File: manifest.uuid -> manifest.uuid",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1: 4417c5bf0aabb34ed174f01afd981c924ae965a42128719d8d6735536631d12f",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "src/expr.c||src/expr.c": [
      "File: src/expr.c -> src/expr.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "376:   int addr;",
      "377:   CollSeq *p4;",
      "379:   if( isCommuted ){",
      "380:     p4 = sqlite3BinaryCompareCollSeq(pParse, pRight, pLeft);",
      "381:   }else{",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "379:   if( pParse->nErr ) return 0;",
      "",
      "---------------"
    ],
    "src/vdbeaux.c||src/vdbeaux.c": [
      "File: src/vdbeaux.c -> src/vdbeaux.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1304: static void vdbeVComment(Vdbe *p, const char *zFormat, va_list ap){",
      "1305:   assert( p->nOp>0 || p->aOp==0 );",
      "1307:   if( p->nOp ){",
      "1308:     assert( p->aOp );",
      "1309:     sqlite3DbFree(p->db, p->aOp[p->nOp-1].zComment);",
      "",
      "[Removed Lines]",
      "1306:   assert( p->aOp==0 || p->aOp[p->nOp-1].zComment==0 || p->db->mallocFailed );",
      "",
      "[Added Lines]",
      "1306:   assert( p->aOp==0 || p->aOp[p->nOp-1].zComment==0 || p->db->mallocFailed",
      "1307:           || p->pParse->nErr>0 );",
      "",
      "---------------"
    ],
    "src/window.c||src/window.c": [
      "File: src/window.c -> src/window.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "935:     pTab = sqlite3DbMallocZero(db, sizeof(Table));",
      "936:     if( pTab==0 ){",
      "938:     }",
      "940:     p->pSrc = 0;",
      "",
      "[Removed Lines]",
      "937:       return SQLITE_NOMEM;",
      "",
      "[Added Lines]",
      "937:       return sqlite3ErrorToParser(db, SQLITE_NOMEM);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1039:     sqlite3DbFree(db, pTab);",
      "1040:   }",
      "1042:   return rc;",
      "1043: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1042:   if( rc && pParse->nErr==0 ){",
      "1043:     assert( pParse->db->mallocFailed );",
      "1044:     return sqlite3ErrorToParser(pParse->db, SQLITE_NOMEM);",
      "1045:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0e14e987069924a90bb20a466cc0c3314dbda822",
      "candidate_info": {
        "commit_hash": "0e14e987069924a90bb20a466cc0c3314dbda822",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/0e14e987069924a90bb20a466cc0c3314dbda822",
        "files": [
          "manifest",
          "manifest.uuid",
          "src/alter.c",
          "test/altertab2.test"
        ],
        "message": "Fix a fairly obscure problem allowing an \"ALTER TABLE RENAME col TO ...\" statement to modify the schema in such a way as to break a reference within a trigger program.\n\nFossilOrigin-Name: 64bec9e6214c6932fab5a3fb8c569ae14cd2d603bd0f8b26104815c3bb9d396a",
        "before_after_code_files": [
          "manifest.uuid||manifest.uuid",
          "src/alter.c||src/alter.c",
          "test/altertab2.test||test/altertab2.test"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 05df5f7aeaf2132810452e8871132d1e66650a841991cb2a9ce32f2d03e20bf4",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/alter.c||src/alter.c": [
          "File: src/alter.c -> src/alter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1081:   Trigger *pNew = pParse->pNewTrigger;",
          "1082:   TriggerStep *pStep;",
          "1083:   NameContext sNC;",
          "1085:   int rc = SQLITE_OK;",
          "1087:   memset(&sNC, 0, sizeof(sNC));",
          "",
          "[Removed Lines]",
          "1084:   SrcList sSrc;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1112:       if( pTarget==0 ){",
          "1113:         rc = SQLITE_ERROR;",
          "1114:       }else if( SQLITE_OK==(rc = sqlite3ViewGetColumnNames(pParse, pTarget)) ){",
          "1115:         memset(&sSrc, 0, sizeof(sSrc));",
          "1116:         sSrc.nSrc = 1;",
          "1117:         sSrc.a[0].zName = pStep->zTarget;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1114:         SrcList sSrc;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1143:           }",
          "1144:           sNC.ncFlags = 0;",
          "1145:         }",
          "1146:       }",
          "1147:     }",
          "1148:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1146:         sNC.pSrcList = 0;",
          "",
          "---------------"
        ],
        "test/altertab2.test||test/altertab2.test": [
          "File: test/altertab2.test -> test/altertab2.test",
          "--- Hunk 1 ---",
          "[Context before]",
          "305:   END}",
          "306: }",
          "309: finish_test",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "308: #-------------------------------------------------------------------------",
          "309: reset_db",
          "310: do_execsql_test 8.0 {",
          "311:   CREATE TABLE t1(a, b, c);",
          "312:   CREATE TABLE t2(a, b, c);",
          "313:   CREATE TABLE t3(d, e, f);",
          "314:   CREATE VIEW v1 AS SELECT * FROM t1;",
          "315:   CREATE TRIGGER tr AFTER INSERT ON t3 BEGIN",
          "316:     UPDATE t2 SET a = new.d;",
          "317:     SELECT a, b, c FROM v1;",
          "318:   END;",
          "319: }",
          "321: do_execsql_test 8.1 {",
          "322:   INSERT INTO t3 VALUES(1, 2, 3);",
          "323: }",
          "325: # The following ALTER TABLE fails as if column \"t1.a\" is renamed the \"a\"",
          "326: # in the \"SELECT a, b, c FROM v1\" within the trigger can no longer be",
          "327: # resolved. But at one point there was a bug allowing the ALTER TABLE",
          "328: # succeed. Which meant the subsequent INSERT statement would fail.",
          "329: do_catchsql_test 8.2 {",
          "330:   ALTER TABLE t1 RENAME a TO aaa;",
          "331: } {1 {error in trigger tr after rename: no such column: a}}",
          "332: do_execsql_test 8.3 {",
          "333:   INSERT INTO t3 VALUES(4, 5, 6);",
          "334: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5a9c6bcc158633596ea7c7d9778c4e7671fd183b",
      "candidate_info": {
        "commit_hash": "5a9c6bcc158633596ea7c7d9778c4e7671fd183b",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/5a9c6bcc158633596ea7c7d9778c4e7671fd183b",
        "files": [
          "Makefile.in",
          "main.mk",
          "manifest",
          "manifest.uuid",
          "tool/index_usage.c"
        ],
        "message": "Enhancements to the index_usage utility program.\n\nFossilOrigin-Name: 19c739b4a8a43d894e37a99fa34838f3e3fa1fe0d019aefbc33f1d38d76af1a4",
        "before_after_code_files": [
          "Makefile.in||Makefile.in",
          "main.mk||main.mk",
          "manifest.uuid||manifest.uuid",
          "tool/index_usage.c||tool/index_usage.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "Makefile.in||Makefile.in": [
          "File: Makefile.in -> Makefile.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "1335:  $(LTLINK) -o $@ $(TOP)/tool/showshm.c",
          "1337: index_usage$(TEXE): $(TOP)/tool/index_usage.c sqlite3.lo",
          "1340: changeset$(TEXE): $(TOP)/ext/session/changeset.c sqlite3.lo",
          "1341:  $(LTLINK) -o $@ $(TOP)/ext/session/changeset.c sqlite3.lo $(TLIBS)",
          "",
          "[Removed Lines]",
          "1338:  $(LTLINK) -o $@ $(TOP)/tool/index_usage.c sqlite3.lo $(TLIBS)",
          "",
          "[Added Lines]",
          "1338:  $(LTLINK) $(SHELL_OPT) -o $@ $(TOP)/tool/index_usage.c sqlite3.lo $(TLIBS)",
          "",
          "---------------"
        ],
        "main.mk||main.mk": [
          "File: main.mk -> main.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "1021:  $(TCC) -o showshm$(EXE) $(TOP)/tool/showshm.c",
          "1023: index_usage$(EXE): $(TOP)/tool/index_usage.c sqlite3.o",
          "1025:   $(TOP)/tool/index_usage.c sqlite3.o $(THREADLIB)",
          "1027: changeset$(EXE): $(TOP)/ext/session/changeset.c sqlite3.o",
          "",
          "[Removed Lines]",
          "1024:  $(TCC) -DSQLITE_THREADSAFE=0 -DSQLITE_OMIT_DEPRECATED -o index_usage$(EXE) \\",
          "",
          "[Added Lines]",
          "1024:  $(TCC) -DSQLITE_THREADSAFE=0 -DSQLITE_OMIT_DEPRECATED $(SHELL_OPTS) -o index_usage$(EXE) \\",
          "",
          "---------------"
        ],
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 760d14374d40bcd9ce3a89771c18dc236c9728553c4747c9b7452ee7b24f4140",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "tool/index_usage.c||tool/index_usage.c": [
          "File: tool/index_usage.c -> tool/index_usage.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "90:            argv[2], sqlite3_errmsg(db));",
          "91:     goto errorOut;",
          "92:   }",
          "94:                           -1, &pStmt, 0);",
          "95:   if( rc ){",
          "96:     printf(\"Cannot read the SQLLOG table in the LOG database \\\"%s\\\" - %s\\n\",",
          "",
          "[Removed Lines]",
          "93:   rc = sqlite3_prepare_v2(db, \"SELECT sql, rowid FROM log.sqllog\",",
          "",
          "[Added Lines]",
          "93:   rc = sqlite3_prepare_v2(db,",
          "94:      \"SELECT sql, rowid FROM log.sqllog\"",
          "95:      \" WHERE upper(substr(sql,1,5)) NOT IN ('BEGIN','COMMI','ROLLB','PRAGM')\",",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "298680d15a694b4c4b5fb7f7bd5d06cb3f08016e",
      "candidate_info": {
        "commit_hash": "298680d15a694b4c4b5fb7f7bd5d06cb3f08016e",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/298680d15a694b4c4b5fb7f7bd5d06cb3f08016e",
        "files": [
          "ext/fts5/fts5_index.c",
          "ext/fts5/test/fts5corrupt3.test",
          "manifest",
          "manifest.uuid"
        ],
        "message": "Fix a potential buffer overrun in fts5 caused by corrupt database records.\n\nFossilOrigin-Name: 156d612800a7282fe0ebb20feb31d3fd577f4ab60fab8c00940c87143997aefb",
        "before_after_code_files": [
          "ext/fts5/fts5_index.c||ext/fts5/fts5_index.c",
          "ext/fts5/test/fts5corrupt3.test||ext/fts5/test/fts5corrupt3.test",
          "manifest.uuid||manifest.uuid"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "ext/fts5/fts5_index.c||ext/fts5/fts5_index.c": [
          "File: ext/fts5/fts5_index.c -> ext/fts5/fts5_index.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4997:         Fts5PoslistWriter writer;",
          "4998:         memset(&writer, 0, sizeof(writer));",
          "5000:         fts5MergeAppendDocid(&out, iLastRowid, i2.iRowid);",
          "5001:         fts5BufferZero(&tmp);",
          "5003:         if( p->rc ) break;",
          "5005:         sqlite3Fts5PoslistNext64(a1, i1.nPoslist, &iOff1, &iPos1);",
          "",
          "[Removed Lines]",
          "5002:         sqlite3Fts5BufferSize(&p->rc, &tmp, i1.nPoslist + i2.nPoslist);",
          "",
          "[Added Lines]",
          "5005:         sqlite3Fts5BufferSize(&p->rc, &tmp, i1.nPoslist + i2.nPoslist + 10 + 10);",
          "",
          "---------------"
        ],
        "ext/fts5/test/fts5corrupt3.test||ext/fts5/test/fts5corrupt3.test": [
          "File: ext/fts5/test/fts5corrupt3.test -> ext/fts5/test/fts5corrupt3.test",
          "--- Hunk 1 ---",
          "[Context before]",
          "9367:   SELECT * FROM t1 WHERE b MATCH 'thead*thead*theSt*';",
          "9368: } {/*malformed database schema*/}",
          "9370: sqlite3_fts5_may_be_corrupt 0",
          "9371: finish_test",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9370: #---------------------------------------------------------------------------",
          "9371: do_test 64.0 {",
          "9372:   sqlite3 db {}",
          "9373:   db deserialize [decode_hexdb {",
          "9374: .open --hexdb",
          "9375: | size 28672 pagesize 4096 filename crash-4470f0b94422f7.db",
          "9376: | page 1 offset 0",
          "9377: |      0: 53 51 4c 69 74 65 20 66 6f 72 6d 61 74 20 33 00   SQLite format 3.",
          "9378: |     16: 10 00 01 01 00 40 20 20 00 00 00 00 00 00 00 06   .....@  ........",
          "9379: |     32: 00 00 00 00 00 00 00 00 00 00 00 06 00 00 00 04   ................",
          "9380: |     96: 00 00 00 00 0d 00 00 00 06 0d e2 00 0f c4 0f 6a   ...............j",
          "9381: |    112: 0e fc 0e 9d 0e 3d 0d e2 00 00 00 00 00 01 00 00   .....=..........",
          "9382: |   3552: 00 00 59 06 06 17 21 21 01 7f 74 61 62 6c 65 74   ..Y...!!..tablet",
          "9383: |   3568: 74 74 5f 63 6f 6e 66 69 67 74 74 74 5f 63 6f 6e   tt_configttt_con",
          "9384: |   3584: 66 69 67 06 43 52 45 41 54 45 20 54 41 42 4c 45   fig.CREATE TABLE",
          "9385: |   3600: 20 27 74 74 74 5f 63 6f 6e 66 69 67 27 28 6b 20    'ttt_config'(k",
          "9386: |   3616: 50 52 49 4d 41 52 59 20 4b 45 59 2c 20 76 29 20   PRIMARY KEY, v)",
          "9387: |   3632: 57 49 54 48 4f 55 54 20 52 4f 57 49 44 5e 05 07   WITHOUT ROWID^..",
          "9388: |   3648: 17 23 23 01 81 03 74 61 62 6c 65 74 74 74 5f 64   .##...tablettt_d",
          "9389: |   3664: 6f 63 73 69 7a 65 74 74 74 5f 64 6f 63 73 69 7a   ocsizettt_docsiz",
          "9390: |   3680: 65 05 43 52 45 41 54 45 20 54 41 42 4c 45 20 27   e.CREATE TABLE '",
          "9391: |   3696: 74 74 74 5f 64 6f 63 73 69 7a 65 27 28 69 64 20   ttt_docsize'(id",
          "9392: |   3712: 49 4e 54 45 47 45 52 20 50 52 49 4d 41 52 59 20   INTEGER PRIMARY",
          "9393: |   3728: 4b 45 59 2c 20 73 7a 20 42 4c 4f 42 29 5d 04 07   KEY, sz BLOB)]..",
          "9394: |   3744: 17 23 23 01 81 01 74 61 62 6c 65 74 74 74 5f 63   .##...tablettt_c",
          "9395: |   3760: 6f 6e 74 65 6e 74 74 74 74 5f 63 6f 6e 74 65 6e   ontentttt_conten",
          "9396: |   3776: 74 04 43 52 45 41 54 45 20 54 41 42 4c 45 20 27   t.CREATE TABLE '",
          "9397: |   3792: 74 74 74 5f 63 6f 6e 74 65 6e 74 27 28 69 64 20   ttt_content'(id",
          "9398: |   3808: 49 4e 54 45 47 45 52 20 50 52 49 4d 41 52 59 20   INTEGER PRIMARY",
          "9399: |   3824: 4b 45 59 2c 20 63 30 2c 20 63 31 29 6c 03 07 17   KEY, c0, c1)l...",
          "9400: |   3840: 1b 1b 01 81 2f 74 61 62 6c 65 74 74 74 5f 69 64   ..../tablettt_id",
          "9401: |   3856: 78 74 74 74 5f 69 64 78 03 43 52 45 41 54 45 20   xttt_idx.CREATE",
          "9402: |   3872: 54 41 42 4c 45 20 27 74 74 74 5f 69 64 78 27 28   TABLE 'ttt_idx'(",
          "9403: |   3888: 73 65 67 69 64 2c 20 74 65 72 6d 2c 20 70 67 6e   segid, term, pgn",
          "9404: |   3904: 6f 2c 20 50 52 49 4d 41 52 59 20 4b 45 59 28 73   o, PRIMARY KEY(s",
          "9405: |   3920: 65 67 69 64 2c 20 74 65 72 6d 29 29 20 57 49 54   egid, term)) WIT",
          "9406: |   3936: 48 4f 55 54 20 52 4f 57 49 44 58 02 07 17 1d 1d   HOUT ROWIDX.....",
          "9407: |   3952: 01 81 03 74 61 62 6c 65 74 74 74 5f 64 61 74 61   ...tablettt_data",
          "9408: |   3968: 74 74 74 5f 64 61 74 61 02 43 52 45 41 54 45 20   ttt_data.CREATE",
          "9409: |   3984: 54 41 42 4c 45 20 27 74 74 74 5f 64 61 74 61 27   TABLE 'ttt_data'",
          "9410: |   4000: 28 69 64 20 49 4e 54 45 47 45 52 20 50 52 49 4d   (id INTEGER PRIM",
          "9411: |   4016: 41 52 59 20 4b 45 59 2c 20 62 6c 6f 63 6b 20 42   ARY KEY, block B",
          "9412: |   4032: 4c 4f 42 29 3a 01 06 17 13 13 08 5f 74 61 62 6c   LOB):......_tabl",
          "9413: |   4048: 65 74 74 74 74 74 74 43 52 45 41 54 45 20 56 49   ettttttCREATE VI",
          "9414: |   4064: 52 54 55 41 4c 20 54 41 42 4c 45 20 74 74 74 20   RTUAL TABLE ttt",
          "9415: |   4080: 55 53 49 4e 47 20 66 74 73 35 28 61 2c 20 62 29   USING fts5(a, b)",
          "9416: | page 2 offset 4096",
          "9417: |      0: 0d 0f 44 00 05 0e 81 00 0f 1a 0e 81 0f af 0f 58   ..D............X",
          "9418: |     16: 0e 98 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................",
          "9419: |   3712: 00 15 0a 03 00 30 00 00 00 00 01 03 03 00 03 01   .....0..........",
          "9420: |   3728: 01 01 02 01 01 03 01 01 81 24 8c 80 80 80 80 01   .........$......",
          "9421: |   3744: 04 00 82 4c 00 00 00 9b 02 30 65 03 1a 02 05 05   ...L.....0e.....",
          "9422: |   3760: 07 05 01 01 04 03 03 08 03 03 01 2e 02 05 05 07   ................",
          "9423: |   3776: 05 07 05 07 05 01 01 04 03 03 08 03 03 08 03 03   ................",
          "9424: |   3792: 07 f3 03 02 01 65 03 1e 03 05 05 04 05 05 01 00   .....e..........",
          "9425: |   3808: 03 06 04 04 06 04 03 01 36 03 05 05 04 06 05 04   ........6.......",
          "9426: |   3824: 06 05 04 05 05 01 01 03 06 04 04 06 04 04 06 04   ................",
          "9427: |   3840: 04 06 04 03 03 01 65 03 14 04 05 06 f5 05 01 01   ......e.........",
          "9428: |   3856: 02 08 09 01 20 04 05 07 05 07 05 07 05 05 01 00   .... ...........",
          "9429: |   3872: 02 08 0a 0a 0a 04 01 65 03 02 0a 01 06 0a 0a 0a   .......e........",
          "9430: |   3888: 05 01 65 03 06 01 01 0a 01 0a 01 01 0a 0a 0a 04   ..e.............",
          "9431: |   3904: 2b 31 21 0b 0f ef 00 14 2a 00 00 00 00 01 02 02   +1!.....*.......",
          "9432: |   3920: 00 02 01 01 01 02 01 01 50 88 80 80 80 80 01 04   ........P.......",
          "9433: |   3936: 00 81 24 00 00 00 47 02 30 65 02 1a 02 05 05 07   ..$...G.0e......",
          "9434: |   3952: 05 01 01 04 03 03 08 03 03 02 01 65 02 1e 03 05   ...........e....",
          "9435: |   3968: 05 04 05 05 01 01 03 06 04 04 06 04 03 03 01 65   ...............e",
          "9436: |   3984: 02 14 04 05 07 05 05 01 01 02 08 0a 04 01 65 02   ..............e.",
          "9437: |   4000: 02 0a 05 01 65 02 06 01 01 0a 04 12 14 0f 06 31   ....e..........1",
          "9438: |   4016: 84 80 80 80 80 01 03 00 68 00 00 00 2b 02 30 65   ........h...+.0e",
          "9439: |   4032: 01 10 02 05 05 01 01 04 03 03 02 01 65 01 12 03   ............e...",
          "9440: |   4048: 05 05 01 01 03 06 04 03 03 01 65 01 0e 04 05 05   ..........e.....",
          "9441: |   4064: 01 01 02 08 04 0d 0e 06 01 03 00 12 04 4c 4c 00   .............LL.",
          "9442: |   4080: 00 00 11 24 00 00 00 00 01 01 01 00 01 01 01 01   ...$............",
          "9443: | page 3 offset 8192",
          "9444: |      0: 0a 00 00 00 03 0f ec 00 0f 00 00 00 00 00 00 00   ................",
          "9445: |   4064: 00 00 00 00 00 00 00 00 00 00 00 00 06 04 01 0c   ................",
          "9446: |   4080: 01 03 02 06 04 01 0c 01 02 02 05 04 09 0c 01 02   ................",
          "9447: | page 4 offset 12288",
          "9448: |      0: 0d 00 00 00 04 0e 1a 00 0f c7 0f 5b 0e ef 0e 1a   ...........[....",
          "9449: |   3600: 00 00 00 00 00 00 00 00 00 00 81 52 04 06 00 81   ...........R....",
          "9450: |   3616: 5d 81 55 65 20 65 65 20 65 65 65 20 65 20 65 65   ].Ue ee eee e ee",
          "9451: |   3632: 20 65 65 65 20 65 20 65 65 20 65 65 65 66 20 65    eee e ee eeef e",
          "9452: |   3648: 65 20 65 65 65 20 65 20 65 65 20 65 65 65 20 65   e eee e ee eee e",
          "9453: |   3664: 20 65 65 20 65 65 65 65 20 65 65 20 65 65 65 20    ee eeee ee eee",
          "9454: |   3680: 65 20 65 65 20 65 65 65 20 65 20 65 65 20 65 65   e ee eee e ee ee",
          "9455: |   3696: 65 65 20 65 65 20 65 65 65 20 65 20 65 65 20 65   ee ee eee e ee e",
          "9456: |   3712: 65 65 20 65 20 65 65 20 65 65 65 65 65 65 20 65   ee e ee eeeeee e",
          "9457: |   3728: 65 20 65 20 65 20 65 20 65 65 20 65 65 65 20 65   e e e e ee eee e",
          "9458: |   3744: 65 20 65 65 65 65 65 20 65 65 20 65 20 65 1f 65   e eeeee ee e e.e",
          "9459: |   3760: 20 65 65 20 65 65 65 20 65 65 20 65 65 65 65 65    ee eee ee eeeee",
          "9460: |   3776: 20 65 65 20 65 20 65 20 65 20 65 65 20 65 65 65    ee e e e ee eee",
          "9461: |   3792: 20 65 65 20 65 65 65 65 65 20 65 65 20 65 20 65    ee eeeee ee e e",
          "9462: |   3808: 20 65 20 65 65 20 65 65 65 20 65 65 20 65 65 6a    e ee eee ee eej",
          "9463: |   3824: 03 03 ff 75 71 65 20 65 65 1f 65 65 65 20 65 20   ...uqe ee.eee e",
          "9464: |   3840: 65 65 20 65 65 65 20 65 20 65 65 20 65 65 65 65   ee eee e ee eeee",
          "9465: |   3856: 20 65 65 20 65 65 65 20 65 20 65 65 20 65 65 65    ee eee e ee eee",
          "9466: |   3872: 20 65 20 65 65 20 65 65 65 65 65 65 20 65 65 20    e ee eeeeee ee",
          "9467: |   3888: 65 20 65 20 65 20 65 65 20 65 65 65 20 65 65 20   e e e ee eee ee",
          "9468: |   3904: 65 65 65 65 65 20 65 65 20 65 20 65 20 65 20 65   eeeee ee e e e e",
          "9469: |   3920: 65 20 65 65 65 20 65 65 20 65 65 6a 02 04 00 75   e eee ee eej...u",
          "9470: |   3936: 40 65 20 65 65 20 65 65 65 20 65 20 65 65 20 65   @e ee eee e ee e",
          "9471: |   3952: 65 65 20 65 20 65 65 20 65 65 65 65 20 65 65 20   ee e ee eeee ee",
          "9472: |   3968: 65 65 65 20 65 20 65 65 20 65 65 65 20 65 20 65   eee e ee eee e e",
          "9473: |   3984: 65 20 65 65 65 65 65 65 20 65 65 20 65 20 65 20   e eeeeee ee e e",
          "9474: |   4000: 65 20 65 65 20 65 65 65 20 65 65 20 65 65 65 65   e ee eee ee eeee",
          "9475: |   4016: 65 20 65 65 20 65 20 65 20 65 20 65 65 20 65 65   e ee e e e ee ee",
          "9476: |   4032: 65 20 65 65 20 65 65 37 01 04 00 41 3f 65 20 65   e ee ee7...A?e e",
          "9477: |   4048: 65 20 65 65 65 20 65 20 65 65 20 65 65 65 20 65   e eee e ee eee e",
          "9478: |   4064: 20 65 65 20 65 65 65 65 65 65 20 65 65 20 65 20    ee eeeeee ee e",
          "9479: |   4080: 65 20 65 20 65 65 20 65 65 65 20 65 65 20 65 65   e e ee eee ee ee",
          "9480: | page 5 offset 16384",
          "9481: |      0: 0d 00 00 00 04 0f e4 00 0f f9 0f f2 0f eb 0f e4   ................",
          "9482: |   4064: 00 00 00 00 05 04 03 00 10 21 21 05 03 03 00 10   .........!!.....",
          "9483: |   4080: 11 11 05 02 03 00 10 11 11 05 01 03 00 10 09 09   ................",
          "9484: | page 6 offset 20480",
          "9485: |      0: 0a 00 00 00 01 0f f4 00 0f f4 00 00 00 00 00 00   ................",
          "9486: |   4080: 00 00 00 00 0b 03 1b 01 76 65 72 73 69 6f 6e 04   ........version.",
          "9487: | end crash-4470f0b94422f7.db",
          "9488: }]} {}",
          "9490: do_catchsql_test 64.1 {",
          "9491:   SELECT * FROM ttt('e*');",
          "9492: } {1 {database disk image is malformed}}",
          "",
          "---------------"
        ],
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: e32490128684cfeeb8213baecc78a7942b8fb63d00e375edd965bf236faeed18",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "491b6d897df09229cfa425d60ba095c1bd81c95f",
      "candidate_info": {
        "commit_hash": "491b6d897df09229cfa425d60ba095c1bd81c95f",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/491b6d897df09229cfa425d60ba095c1bd81c95f",
        "files": [
          "manifest",
          "manifest.uuid",
          "src/select.c"
        ],
        "message": "Make sure the column name flags are restored correctly after an error inside of sqlite3ResultSetOfSelect().\n\nFossilOrigin-Name: b1601db7adba2dccd4f90fbbe5099c801a2b0d97af087fbe82ed98d05496b38c",
        "before_after_code_files": [
          "manifest.uuid||manifest.uuid",
          "src/select.c||src/select.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: db4b4c2c1e9f1adacfb1b2fedb717a4d8bb0a299c3b11835404a99fcd67bf24b",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/select.c||src/select.c": [
          "File: src/select.c -> src/select.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2089:   db->flags &= ~(u64)SQLITE_FullColNames;",
          "2090:   db->flags |= SQLITE_ShortColNames;",
          "2091:   sqlite3SelectPrep(pParse, pSelect, 0);",
          "2092:   if( pParse->nErr ) return 0;",
          "2093:   while( pSelect->pPrior ) pSelect = pSelect->pPrior;",
          "2095:   pTab = sqlite3DbMallocZero(db, sizeof(Table) );",
          "2096:   if( pTab==0 ){",
          "2097:     return 0;",
          "",
          "[Removed Lines]",
          "2094:   db->flags = savedFlags;",
          "",
          "[Added Lines]",
          "2092:   db->flags = savedFlags;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "af63892337c6fe37972bbae9b77365eb8c33d47a",
      "candidate_info": {
        "commit_hash": "af63892337c6fe37972bbae9b77365eb8c33d47a",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/af63892337c6fe37972bbae9b77365eb8c33d47a",
        "files": [
          "manifest",
          "manifest.uuid",
          "test/fuzzcheck.c"
        ],
        "message": "In the fuzzcheck test program, make sure the isspace() and related routines are not given values outside the range of -1 to 255.\n\nFossilOrigin-Name: f298328771d5aaba798d05f50c77ac239c7c72422ff35953463d6876a9659f74",
        "before_after_code_files": [
          "manifest.uuid||manifest.uuid",
          "test/fuzzcheck.c||test/fuzzcheck.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: a505e34d4ec31159a4508ec827fcffed0cf3bd5ea5ef0ac293016da02367a53a",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/fuzzcheck.c||test/fuzzcheck.c": [
          "File: test/fuzzcheck.c -> test/fuzzcheck.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "533:   }",
          "534:   memset(a, 0, nAlloc);",
          "535:   for(i=k=0; i<n; i++){",
          "537:     if( isxdigit(c) ){",
          "538:       k++;",
          "539:       if( k & 1 ){",
          "",
          "[Removed Lines]",
          "536:     char c = zIn[i];",
          "",
          "[Added Lines]",
          "536:     unsigned char c = (unsigned char)zIn[i];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "651: static int runDbSql(sqlite3 *db, const char *zSql){",
          "652:   int rc;",
          "653:   sqlite3_stmt *pStmt;",
          "655:   if( zSql[0]==0 ) return SQLITE_OK;",
          "656:   if( eVerbosity>=4 ){",
          "657:     printf(\"RUNNING-SQL: [%s]\\n\", zSql);",
          "",
          "[Removed Lines]",
          "654:   while( isspace(zSql[0]) ) zSql++;",
          "",
          "[Added Lines]",
          "654:   while( isspace(zSql[0]&0x7f) ) zSql++;",
          "",
          "---------------"
        ]
      }
    }
  ]
}