{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a7cd76bb3b3c0696d61c600d9b91e5e97cbb6367",
      "candidate_info": {
        "commit_hash": "a7cd76bb3b3c0696d61c600d9b91e5e97cbb6367",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/a7cd76bb3b3c0696d61c600d9b91e5e97cbb6367",
        "files": [
          "deps/npm/node_modules/fast-list/.npmignore",
          "deps/npm/node_modules/fast-list/.travis.yml",
          "deps/npm/node_modules/fast-list/README.md",
          "deps/npm/node_modules/fast-list/fast-list.js",
          "deps/npm/node_modules/fast-list/package.json"
        ],
        "message": "Remove unused fast-list module from npm",
        "before_after_code_files": [
          "deps/npm/node_modules/fast-list/fast-list.js||deps/npm/node_modules/fast-list/fast-list.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/npm/node_modules/fast-list/fast-list.js||deps/npm/node_modules/fast-list/fast-list.js": [
          "File: deps/npm/node_modules/fast-list/fast-list.js -> deps/npm/node_modules/fast-list/fast-list.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b9bd2d3eb9aa57926dc76294a376ed95c76fc812",
      "candidate_info": {
        "commit_hash": "b9bd2d3eb9aa57926dc76294a376ed95c76fc812",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/b9bd2d3eb9aa57926dc76294a376ed95c76fc812",
        "files": [
          "src/node_version.h"
        ],
        "message": "Now working on v0.6.14",
        "before_after_code_files": [
          "src/node_version.h||src/node_version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_version.h||src/node_version.h": [
          "File: src/node_version.h -> src/node_version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #define NODE_MAJOR_VERSION 0",
          "30: #define NODE_MINOR_VERSION 6",
          "34: #ifndef NODE_STRINGIFY",
          "35: #define NODE_STRINGIFY(n) NODE_STRINGIFY_HELPER(n)",
          "",
          "[Removed Lines]",
          "31: #define NODE_PATCH_VERSION 13",
          "32: #define NODE_VERSION_IS_RELEASE 1",
          "",
          "[Added Lines]",
          "31: #define NODE_PATCH_VERSION 14",
          "32: #define NODE_VERSION_IS_RELEASE 0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a94ffdaec57d9999485b11183f8da10aec15ff8d",
      "candidate_info": {
        "commit_hash": "a94ffdaec57d9999485b11183f8da10aec15ff8d",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/a94ffdaec57d9999485b11183f8da10aec15ff8d",
        "files": [
          "lib/url.js",
          "test/simple/test-url.js"
        ],
        "message": "url: Support for IPv6 addresses in URLs.\n\nFixes #1138, #2610.",
        "before_after_code_files": [
          "lib/url.js||liurl.js",
          "test/simple/test-url.js||test/simple/test-url.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/url.js||liurl.js": [
          "File: lib/url.js -> liurl.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:     delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],",
          "40:     autoEscape = ['\\''],",
          "",
          "[Removed Lines]",
          "38:     unwise = ['{', '}', '|', '\\\\', '^', '~', '[', ']', '`'].concat(delims),",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "180:     out.hostname = out.hostname || '';",
          "183:     if (out.hostname.length > hostnameMaxLen) {",
          "184:       out.hostname = '';",
          "186:       var hostparts = out.hostname.split(/\\./);",
          "187:       for (var i = 0, l = hostparts.length; i < l; i++) {",
          "188:         var part = hostparts[i];",
          "",
          "[Removed Lines]",
          "185:     } else {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "222:     out.hostname = out.hostname.toLowerCase();",
          "234:     }",
          "237:     out.host = (out.hostname || '') +",
          "238:         ((out.port) ? ':' + out.port : '');",
          "239:     out.href += out.host;",
          "240:   }",
          "",
          "[Removed Lines]",
          "228:     var domainArray = out.hostname.split('.');",
          "229:     var newOut = [];",
          "230:     for (var i = 0; i < domainArray.length; ++i) {",
          "231:       var s = domainArray[i];",
          "232:       newOut.push(s.match(/[^A-Za-z0-9_-]/) ?",
          "233:           'xn--' + punycode.encode(s) : s);",
          "235:     out.hostname = newOut.join('.');",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "323:   }",
          "325:   var protocol = obj.protocol || '',",
          "332:       pathname = obj.pathname || '',",
          "341:   if (protocol && protocol.substr(-1) !== ':') protocol += ':';",
          "",
          "[Removed Lines]",
          "326:       host = (obj.host !== undefined) ? auth + obj.host :",
          "327:           obj.hostname !== undefined ? (",
          "328:               auth + obj.hostname +",
          "329:               (obj.port ? ':' + obj.port : '')",
          "330:           ) :",
          "331:           false,",
          "333:       query = obj.query &&",
          "334:               ((typeof obj.query === 'object' &&",
          "335:                 Object.keys(obj.query).length) ?",
          "336:                  querystring.stringify(obj.query) :",
          "337:                  '') || '',",
          "338:       search = obj.search || (query && ('?' + query)) || '',",
          "339:       hash = obj.hash || '';",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/simple/test-url.js||test/simple/test-url.js": [
          "File: test/simple/test-url.js -> test/simple/test-url.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "476:     'href': 'www.example.com',",
          "477:     'pathname': 'www.example.com',",
          "478:     'path': 'www.example.com'",
          "479:   }",
          "480: };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "479:   },",
          "481:   '[fe80::1]': {",
          "482:     'href': '[fe80::1]',",
          "483:     'pathname': '[fe80::1]',",
          "484:     'path': '[fe80::1]'",
          "485:   },",
          "486:   'coap://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]': {",
          "487:     'protocol': 'coap:',",
          "488:     'slashes': true,",
          "489:     'host': '[fedc:ba98:7654:3210:fedc:ba98:7654:3210]',",
          "490:     'hostname': 'fedc:ba98:7654:3210:fedc:ba98:7654:3210',",
          "491:     'href': 'coap://[fedc:ba98:7654:3210:fedc:ba98:7654:3210]/',",
          "492:     'pathname': '/',",
          "493:     'path': '/'",
          "494:   },",
          "495:   'coap://[1080:0:0:0:8:800:200C:417A]:61616/': {",
          "496:     'protocol': 'coap:',",
          "497:     'slashes': true,",
          "498:     'host': '[1080:0:0:0:8:800:200c:417a]:61616',",
          "499:     'port': '61616',",
          "500:     'hostname': '1080:0:0:0:8:800:200c:417a',",
          "501:     'href': 'coap://[1080:0:0:0:8:800:200c:417a]:61616/',",
          "502:     'pathname': '/',",
          "503:     'path': '/'",
          "504:   },",
          "505:   'http://user:password@[3ffe:2a00:100:7031::1]:8080': {",
          "506:     'protocol': 'http:',",
          "507:     'slashes': true,",
          "508:     'auth': 'user:password',",
          "509:     'host': '[3ffe:2a00:100:7031::1]:8080',",
          "510:     'port': '8080',",
          "511:     'hostname': '3ffe:2a00:100:7031::1',",
          "512:     'href': 'http://user:password@[3ffe:2a00:100:7031::1]:8080/',",
          "513:     'pathname': '/',",
          "514:     'path': '/'",
          "515:   },",
          "516:   'coap://u:p@[::192.9.5.5]:61616/.well-known/r?n=Temperature': {",
          "517:     'protocol': 'coap:',",
          "518:     'slashes': true,",
          "519:     'auth': 'u:p',",
          "520:     'host': '[::192.9.5.5]:61616',",
          "521:     'port': '61616',",
          "522:     'hostname': '::192.9.5.5',",
          "523:     'href': 'coap://u:p@[::192.9.5.5]:61616/.well-known/r?n=Temperature',",
          "524:     'search': '?n=Temperature',",
          "525:     'query': 'n=Temperature',",
          "526:     'pathname': '/.well-known/r',",
          "527:     'path': '/.well-known/r?n=Temperature'",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "650:     'hostname': 'foo',",
          "651:     'protocol': 'dot.test:',",
          "652:     'pathname': '/bar'",
          "653:   }",
          "654: };",
          "655: for (var u in formatTests) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "702:   },",
          "704:   'coap:u:p@[::1]:61616/.well-known/r?n=Temperature': {",
          "705:     'href': 'coap:u:p@[::1]:61616/.well-known/r?n=Temperature',",
          "706:     'protocol': 'coap:',",
          "707:     'auth': 'u:p',",
          "708:     'hostname': '::1',",
          "709:     'port': '61616',",
          "710:     'pathname': '/.well-known/r',",
          "711:     'search': 'n=Temperature'",
          "712:   },",
          "713:   'coap:[fedc:ba98:7654:3210:fedc:ba98:7654:3210]:61616/s/stopButton': {",
          "714:     'href': 'coap:[fedc:ba98:7654:3210:fedc:ba98:7654:3210]:61616/s/stopButton',",
          "715:     'protocol': 'coap',",
          "716:     'host': '[fedc:ba98:7654:3210:fedc:ba98:7654:3210]:61616',",
          "717:     'pathname': '/s/stopButton'",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d384b8b0d2ab7f05465f0a3e15fe20b4e25b5f86",
      "candidate_info": {
        "commit_hash": "d384b8b0d2ab7f05465f0a3e15fe20b4e25b5f86",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/d384b8b0d2ab7f05465f0a3e15fe20b4e25b5f86",
        "files": [
          "ChangeLog",
          "doc/about/index.html",
          "doc/community/index.html",
          "doc/index.html",
          "doc/logos/index.html",
          "doc/template.html",
          "src/node_version.h"
        ],
        "message": "2012.02.23, Version 0.7.5 (unstable)\n\n* startup speed improvements (Maciej Ma\u0142ecki)\n\n* crypto: add function getDiffieHellman() (Tomasz Buchert)\n\n* buffer: support decoding of URL-safe base64 (Ben Noordhuis)\n\n* Make QueryString.parse() even faster (Brian White)\n\n* url: decode url entities in auth section (Ben Noordhuis)\n\n* http: support PURGE request method (Ben Noordhuis)\n\n* http: Generate Date headers on responses (Mark Nottingham)\n\n* Fix #2762: Add callback to close function. (Mikeal Rogers)\n\n* dgram: fix out-of-bound memory read (Ben Noordhuis)\n\n* repl: add automatic loading of built-in libs (Brandon Benvie)\n\n* repl: remove double calls where possible (Fedor Indutny)\n\n* Readline improvements. Related: #2737 #2756 (Colton Baker)\n\n* build: disable -fomit-frame-pointer on solaris (Dave Pacheco)\n\n* build: arch detection improvements (Nathan Rajlich)\n\n* build: Make a fat binary for the OS X `make pkg`. (Nathan Rajlich)\n\n* jslint src/ and lib/ on 'make test' (isaacs)",
        "before_after_code_files": [
          "src/node_version.h||src/node_version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_version.h||src/node_version.h": [
          "File: src/node_version.h -> src/node_version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #define NODE_MAJOR_VERSION 0",
          "30: #define NODE_MINOR_VERSION 7",
          "31: #define NODE_PATCH_VERSION 5",
          "34: #ifndef NODE_STRINGIFY",
          "35: #define NODE_STRINGIFY(n) NODE_STRINGIFY_HELPER(n)",
          "",
          "[Removed Lines]",
          "32: #define NODE_VERSION_IS_RELEASE 0",
          "",
          "[Added Lines]",
          "32: #define NODE_VERSION_IS_RELEASE 1",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ecfe32e3a0a4f6b62063a2b56fbb23599cfb51f1",
      "candidate_info": {
        "commit_hash": "ecfe32e3a0a4f6b62063a2b56fbb23599cfb51f1",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/ecfe32e3a0a4f6b62063a2b56fbb23599cfb51f1",
        "files": [
          "lib/dns.js"
        ],
        "message": "dns: add more error codes",
        "before_after_code_files": [
          "lib/dns.js||lidns.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/dns.js||lidns.js": [
          "File: lib/dns.js -> lidns.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "200: exports.NODATA = 'ENODATA';",
          "202: exports.NOTFOUND = 'ENOTFOUND';",
          "203: exports.NOTIMP = 'ENOTIMP';",
          "205: exports.TIMEOUT = 'ETIMEOUT';",
          "",
          "[Removed Lines]",
          "194: exports.BADNAME = 'EBADNAME';",
          "195: exports.BADRESP = 'EBADRESP';",
          "196: exports.CONNREFUSED = 'ECONNREFUSED';",
          "197: exports.DESTRUCTION = 'EDESTRUCTION';",
          "198: exports.REFUSED = 'EREFUSED';",
          "199: exports.FORMERR = 'EFORMERR';",
          "201: exports.NOMEM = 'ENOMEM';",
          "204: exports.SERVFAIL = 'ESERVFAIL';",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}