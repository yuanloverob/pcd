{
  "cve_id": "CVE-2015-6826",
  "cve_desc": "The ff_rv34_decode_init_thread_copy function in libavcodec/rv34.c in FFmpeg before 2.7.2 does not initialize certain structure members, which allows remote attackers to cause a denial of service (invalid pointer access) or possibly have unspecified other impact via crafted (1) RV30 or (2) RV40 RealVideo data.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "3197c0aa87a3b7190e17d49e6fbc7b554e4b3f0a",
  "patch_info": {
    "commit_hash": "3197c0aa87a3b7190e17d49e6fbc7b554e4b3f0a",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/3197c0aa87a3b7190e17d49e6fbc7b554e4b3f0a",
    "files": [
      "libavcodec/rv34.c"
    ],
    "message": "avcodec/rv34: Clear pointers in ff_rv34_decode_init_thread_copy()\n\nAvoids leaving stale pointers\nFixes: signal_sigabrt_7ffff70eccc9_819_sabtriple.rm with memlimit 536870912\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "before_after_code_files": [
      "libavcodec/rv34.c||libavcodec/rv34.c"
    ]
  },
  "patch_diff": {
    "libavcodec/rv34.c||libavcodec/rv34.c": [
      "File: libavcodec/rv34.c -> libavcodec/rv34.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1535:     if (avctx->internal->is_copy) {",
      "1536:         r->tmp_b_block_base = NULL;",
      "1537:         ff_mpv_idct_init(&r->s);",
      "1538:         if ((err = ff_mpv_common_init(&r->s)) < 0)",
      "1539:             return err;",
      "1540:         if ((err = rv34_decoder_alloc(r)) < 0) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1537:         r->cbp_chroma       = NULL;",
      "1538:         r->cbp_luma         = NULL;",
      "1539:         r->deblock_coefs    = NULL;",
      "1540:         r->intra_types_hist = NULL;",
      "1541:         r->mb_type          = NULL;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "24f1698758f0bd2ed5968cde35ce96ad58ba4c8d",
      "candidate_info": {
        "commit_hash": "24f1698758f0bd2ed5968cde35ce96ad58ba4c8d",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/24f1698758f0bd2ed5968cde35ce96ad58ba4c8d",
        "files": [
          "libavcodec/rv34.c"
        ],
        "message": "avcodec/rv34: Clear pointers in ff_rv34_decode_init_thread_copy()\n\nAvoids leaving stale pointers\nFixes: signal_sigabrt_7ffff70eccc9_819_sabtriple.rm with memlimit 536870912\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 3197c0aa87a3b7190e17d49e6fbc7b554e4b3f0a)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/rv34.c||libavcodec/rv34.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/rv34.c||libavcodec/rv34.c"
          ],
          "candidate": [
            "libavcodec/rv34.c||libavcodec/rv34.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/rv34.c||libavcodec/rv34.c": [
          "File: libavcodec/rv34.c -> libavcodec/rv34.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1535:     if (avctx->internal->is_copy) {",
          "1536:         r->tmp_b_block_base = NULL;",
          "1537:         ff_mpv_idct_init(&r->s);",
          "1538:         if ((err = ff_mpv_common_init(&r->s)) < 0)",
          "1539:             return err;",
          "1540:         if ((err = rv34_decoder_alloc(r)) < 0) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1537:         r->cbp_chroma       = NULL;",
          "1538:         r->cbp_luma         = NULL;",
          "1539:         r->deblock_coefs    = NULL;",
          "1540:         r->intra_types_hist = NULL;",
          "1541:         r->mb_type          = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "620b3e680c388af7dd4a2ef2eb9544dc9cbdc092",
      "candidate_info": {
        "commit_hash": "620b3e680c388af7dd4a2ef2eb9544dc9cbdc092",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/620b3e680c388af7dd4a2ef2eb9544dc9cbdc092",
        "files": [
          "libavcodec/rv34.c"
        ],
        "message": "avcodec/rv34: Clear pointers in ff_rv34_decode_init_thread_copy()\n\nAvoids leaving stale pointers\nFixes: signal_sigabrt_7ffff70eccc9_819_sabtriple.rm with memlimit 536870912\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 3197c0aa87a3b7190e17d49e6fbc7b554e4b3f0a)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/rv34.c||libavcodec/rv34.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/rv34.c||libavcodec/rv34.c"
          ],
          "candidate": [
            "libavcodec/rv34.c||libavcodec/rv34.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/rv34.c||libavcodec/rv34.c": [
          "File: libavcodec/rv34.c -> libavcodec/rv34.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1535:     if (avctx->internal->is_copy) {",
          "1536:         r->tmp_b_block_base = NULL;",
          "1537:         ff_mpv_idct_init(&r->s);",
          "1538:         if ((err = ff_mpv_common_init(&r->s)) < 0)",
          "1539:             return err;",
          "1540:         if ((err = rv34_decoder_alloc(r)) < 0) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1537:         r->cbp_chroma       = NULL;",
          "1538:         r->cbp_luma         = NULL;",
          "1539:         r->deblock_coefs    = NULL;",
          "1540:         r->intra_types_hist = NULL;",
          "1541:         r->mb_type          = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8696762b9a3b66b7dac4bd7b8022a4ba0f72153a",
      "candidate_info": {
        "commit_hash": "8696762b9a3b66b7dac4bd7b8022a4ba0f72153a",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/8696762b9a3b66b7dac4bd7b8022a4ba0f72153a",
        "files": [
          "libavcodec/rv34.c"
        ],
        "message": "avcodec/rv34: Clear pointers in ff_rv34_decode_init_thread_copy()\n\nAvoids leaving stale pointers\nFixes: signal_sigabrt_7ffff70eccc9_819_sabtriple.rm with memlimit 536870912\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 3197c0aa87a3b7190e17d49e6fbc7b554e4b3f0a)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/rv34.c||libavcodec/rv34.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/rv34.c||libavcodec/rv34.c"
          ],
          "candidate": [
            "libavcodec/rv34.c||libavcodec/rv34.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/rv34.c||libavcodec/rv34.c": [
          "File: libavcodec/rv34.c -> libavcodec/rv34.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1535:     if (avctx->internal->is_copy) {",
          "1536:         r->tmp_b_block_base = NULL;",
          "1537:         ff_mpv_idct_init(&r->s);",
          "1538:         if ((err = ff_mpv_common_init(&r->s)) < 0)",
          "1539:             return err;",
          "1540:         if ((err = rv34_decoder_alloc(r)) < 0) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1537:         r->cbp_chroma       = NULL;",
          "1538:         r->cbp_luma         = NULL;",
          "1539:         r->deblock_coefs    = NULL;",
          "1540:         r->intra_types_hist = NULL;",
          "1541:         r->mb_type          = NULL;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "05684cee424a6e440c6757d224a748a2ffe87dde",
      "candidate_info": {
        "commit_hash": "05684cee424a6e440c6757d224a748a2ffe87dde",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/05684cee424a6e440c6757d224a748a2ffe87dde",
        "files": [
          "libavcodec/rv34.c"
        ],
        "message": "avcodec/rv34: Clear pointers in ff_rv34_decode_init_thread_copy()\n\nAvoids leaving stale pointers\nFixes: signal_sigabrt_7ffff70eccc9_819_sabtriple.rm with memlimit 536870912\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 3197c0aa87a3b7190e17d49e6fbc7b554e4b3f0a)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/rv34.c||libavcodec/rv34.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/rv34.c||libavcodec/rv34.c"
          ],
          "candidate": [
            "libavcodec/rv34.c||libavcodec/rv34.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/rv34.c||libavcodec/rv34.c": [
          "File: libavcodec/rv34.c -> libavcodec/rv34.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1535:     if (avctx->internal->is_copy) {",
          "1536:         r->tmp_b_block_base = NULL;",
          "1537:         ff_mpv_idct_init(&r->s);",
          "1538:         if ((err = ff_mpv_common_init(&r->s)) < 0)",
          "1539:             return err;",
          "1540:         if ((err = rv34_decoder_alloc(r)) < 0) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1537:         r->cbp_chroma       = NULL;",
          "1538:         r->cbp_luma         = NULL;",
          "1539:         r->deblock_coefs    = NULL;",
          "1540:         r->intra_types_hist = NULL;",
          "1541:         r->mb_type          = NULL;",
          "",
          "---------------"
        ]
      }
    }
  ]
}