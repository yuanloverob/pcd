{
  "cve_id": "CVE-2016-5730",
  "cve_desc": "phpMyAdmin 4.0.x before 4.0.10.16, 4.4.x before 4.4.15.7, and 4.6.x before 4.6.3 allows remote attackers to obtain sensitive information via vectors involving (1) an array value to FormDisplay.php, (2) incorrect data to validate.php, (3) unexpected data to Validator.php, (4) a missing config directory during setup, or (5) an incorrect OpenID identifier data type, which reveals the full path in an error message.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "27664605b945b13e1d2b71adea822ace2099cc96",
  "patch_info": {
    "commit_hash": "27664605b945b13e1d2b71adea822ace2099cc96",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/27664605b945b13e1d2b71adea822ace2099cc96",
    "files": [
      "examples/openid.php"
    ],
    "message": "Improve error handling in OpenID example\n\n- properly check parameter types\n- catch all exceptions (eg. network error)\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
    "before_after_code_files": [
      "examples/openid.php||examples/openid.php"
    ]
  },
  "patch_diff": {
    "examples/openid.php||examples/openid.php": [
      "File: examples/openid.php -> examples/openid.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "98: }",
      "102:     $identifier = $_POST['identifier'];",
      "104:     $identifier = $_SESSION['identifier'];",
      "105: } else {",
      "106:     $identifier = null;",
      "",
      "[Removed Lines]",
      "101: if (isset($_POST['identifier'])) {",
      "103: } else if (isset($_SESSION['identifier'])) {",
      "",
      "[Added Lines]",
      "101: if (isset($_POST['identifier']) && is_string($_POST['identifier'])) {",
      "103: } else if (isset($_SESSION['identifier']) && is_string($_SESSION['identifier'])) {",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "110: try {",
      "111:     $o = new OpenID_RelyingParty($returnTo, $realm, $identifier);",
      "113:     $contents = \"<div class='relyingparty_results'>\\n\";",
      "114:     $contents .= \"<pre>\" . $e->getMessage() . \"</pre>\\n\";",
      "115:     $contents .= \"</div class='relyingparty_results'>\";",
      "",
      "[Removed Lines]",
      "112: } catch (OpenID_Exception $e) {",
      "",
      "[Added Lines]",
      "112: } catch (Exception $e) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "70e917c654731c818b849dc326c2d171663fe287",
      "candidate_info": {
        "commit_hash": "70e917c654731c818b849dc326c2d171663fe287",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/70e917c654731c818b849dc326c2d171663fe287",
        "files": [
          "examples/openid.php"
        ],
        "message": "Improve error handling in OpenID example\n\n- properly check parameter types\n- catch all exceptions (eg. network error)\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
        "before_after_code_files": [
          "examples/openid.php||examples/openid.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "examples/openid.php||examples/openid.php"
          ],
          "candidate": [
            "examples/openid.php||examples/openid.php"
          ]
        }
      },
      "candidate_diff": {
        "examples/openid.php||examples/openid.php": [
          "File: examples/openid.php -> examples/openid.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "98: }",
          "102:     $identifier = $_POST['identifier'];",
          "104:     $identifier = $_SESSION['identifier'];",
          "105: } else {",
          "106:     $identifier = null;",
          "",
          "[Removed Lines]",
          "101: if (isset($_POST['identifier'])) {",
          "103: } else if (isset($_SESSION['identifier'])) {",
          "",
          "[Added Lines]",
          "101: if (isset($_POST['identifier']) && is_string($_POST['identifier'])) {",
          "103: } else if (isset($_SESSION['identifier']) && is_string($_SESSION['identifier'])) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "110: try {",
          "111:     $o = new OpenID_RelyingParty($returnTo, $realm, $identifier);",
          "113:     $contents = \"<div class='relyingparty_results'>\\n\";",
          "114:     $contents .= \"<pre>\" . $e->getMessage() . \"</pre>\\n\";",
          "115:     $contents .= \"</div class='relyingparty_results'>\";",
          "",
          "[Removed Lines]",
          "112: } catch (OpenID_Exception $e) {",
          "",
          "[Added Lines]",
          "112: } catch (Exception $e) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c795a395ba74d29a584abfe48d8a5139df92f0fd",
      "candidate_info": {
        "commit_hash": "c795a395ba74d29a584abfe48d8a5139df92f0fd",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/c795a395ba74d29a584abfe48d8a5139df92f0fd",
        "files": [
          "examples/openid.php"
        ],
        "message": "Improve error handling in OpenID example\n\n- properly check parameter types\n- catch all exceptions (eg. network error)\n\nSigned-off-by: Michal \u010ciha\u0159 <michal@cihar.com>",
        "before_after_code_files": [
          "examples/openid.php||examples/openid.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "examples/openid.php||examples/openid.php"
          ],
          "candidate": [
            "examples/openid.php||examples/openid.php"
          ]
        }
      },
      "candidate_diff": {
        "examples/openid.php||examples/openid.php": [
          "File: examples/openid.php -> examples/openid.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "96: }",
          "100:     $identifier = $_POST['identifier'];",
          "102:     $identifier = $_SESSION['identifier'];",
          "103: } else {",
          "104:     $identifier = null;",
          "",
          "[Removed Lines]",
          "99: if (isset($_POST['identifier'])) {",
          "101: } else if (isset($_SESSION['identifier'])) {",
          "",
          "[Added Lines]",
          "99: if (isset($_POST['identifier']) && is_string($_POST['identifier'])) {",
          "101: } else if (isset($_SESSION['identifier']) && is_string($_SESSION['identifier'])) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "108: try {",
          "109:     $o = new OpenID_RelyingParty($returnTo, $realm, $identifier);",
          "111:     $contents = \"<div class='relyingparty_results'>\\n\";",
          "112:     $contents .= \"<pre>\" . $e->getMessage() . \"</pre>\\n\";",
          "113:     $contents .= \"</div class='relyingparty_results'>\";",
          "",
          "[Removed Lines]",
          "110: } catch (OpenID_Exception $e) {",
          "",
          "[Added Lines]",
          "110: } catch (Exception $e) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}