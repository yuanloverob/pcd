{
  "cve_id": "CVE-2015-3330",
  "cve_desc": "The php_handler function in sapi/apache2handler/sapi_apache2.c in PHP before 5.4.40, 5.5.x before 5.5.24, and 5.6.x before 5.6.8, when the Apache HTTP Server 2.4.x is used, allows remote attackers to cause a denial of service (application crash) or possibly execute arbitrary code via pipelined HTTP requests that result in a \"deconfigured interpreter.\"",
  "repo": "php/php-src",
  "patch_hash": "809610f5ea38a83b284e1125d1fff129bdd615e7",
  "patch_info": {
    "commit_hash": "809610f5ea38a83b284e1125d1fff129bdd615e7",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/809610f5ea38a83b284e1125d1fff129bdd615e7",
    "files": [
      "sapi/apache2handler/sapi_apache2.c"
    ],
    "message": "Fix bug #68486 and bug #69218 (segfault in apache2handler with apache 2.4)",
    "before_after_code_files": [
      "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c"
    ]
  },
  "patch_diff": {
    "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c": [
      "File: sapi/apache2handler/sapi_apache2.c -> sapi/apache2handler/sapi_apache2.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "688: } zend_end_try();",
      "689:   }",
      "690:   apr_brigade_cleanup(brigade);",
      "691:  } else {",
      "692:   ctx->r = parent_req;",
      "693:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "691:   apr_pool_cleanup_run(r->pool, (void *)&SG(server_context), php_server_context_cleanup);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "af1cd45d171fbb06712f846cec7bf69438db8ec2",
      "candidate_info": {
        "commit_hash": "af1cd45d171fbb06712f846cec7bf69438db8ec2",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/af1cd45d171fbb06712f846cec7bf69438db8ec2",
        "files": [
          "NEWS",
          "sapi/apache2handler/sapi_apache2.c"
        ],
        "message": "Fix bug #68486 and bug #69218 (segfault in apache2handler with apache 2.4)",
        "before_after_code_files": [
          "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c"
          ],
          "candidate": [
            "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c"
          ]
        }
      },
      "candidate_diff": {
        "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c": [
          "File: sapi/apache2handler/sapi_apache2.c -> sapi/apache2handler/sapi_apache2.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "688: } zend_end_try();",
          "689:   }",
          "690:   apr_brigade_cleanup(brigade);",
          "691:  } else {",
          "692:   ctx->r = parent_req;",
          "693:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "691:   apr_pool_cleanup_run(r->pool, (void *)&SG(server_context), php_server_context_cleanup);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "01883bcffb682f34309f9fbf112eecb050559522",
      "candidate_info": {
        "commit_hash": "01883bcffb682f34309f9fbf112eecb050559522",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/01883bcffb682f34309f9fbf112eecb050559522",
        "files": [
          "sapi/apache2handler/sapi_apache2.c"
        ],
        "message": "Fix bug #68486 and bug #69218 (segfault in apache2handler with apache 2.4)",
        "before_after_code_files": [
          "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c"
          ],
          "candidate": [
            "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c"
          ]
        }
      },
      "candidate_diff": {
        "sapi/apache2handler/sapi_apache2.c||sapi/apache2handler/sapi_apache2.c": [
          "File: sapi/apache2handler/sapi_apache2.c -> sapi/apache2handler/sapi_apache2.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "688: } zend_end_try();",
          "689:   }",
          "690:   apr_brigade_cleanup(brigade);",
          "691:  } else {",
          "692:   ctx->r = parent_req;",
          "693:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "691:   apr_pool_cleanup_run(r->pool, (void *)&SG(server_context), php_server_context_cleanup);",
          "",
          "---------------"
        ]
      }
    }
  ]
}