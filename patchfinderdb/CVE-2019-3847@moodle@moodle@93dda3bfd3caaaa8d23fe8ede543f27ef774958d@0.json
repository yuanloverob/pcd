{
  "cve_id": "CVE-2019-3847",
  "cve_desc": "A vulnerability was found in moodle before versions 3.6.3, 3.5.5, 3.4.8 and 3.1.17. Users with the \"login as other users\" capability (such as administrators/managers) can access other users' Dashboards, but the JavaScript those other users may have added to their Dashboard was not being escaped when being viewed by the user logging in on their behalf.",
  "repo": "moodle/moodle",
  "patch_hash": "93dda3bfd3caaaa8d23fe8ede543f27ef774958d",
  "patch_info": {
    "commit_hash": "93dda3bfd3caaaa8d23fe8ede543f27ef774958d",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/93dda3bfd3caaaa8d23fe8ede543f27ef774958d",
    "files": [
      "course/loginas.php",
      "lang/en/moodle.php",
      "lib/moodlelib.php"
    ],
    "message": "MDL-63786 core: set $CFG->forceclean for logged in as sessions\n\nTurn on the forceclean config setting when a user is logged in as a\ndifferent user. This is a precautionary measure, which forces all\nuser submitted content to be cleaned of JavaScript before rendering\nit to the logged in as user.",
    "before_after_code_files": [
      "course/loginas.php||course/loginas.php",
      "lang/en/moodle.php||lang/en/moodle.php",
      "lib/moodlelib.php||lib/moodlelib.php"
    ]
  },
  "patch_diff": {
    "course/loginas.php||course/loginas.php": [
      "File: course/loginas.php -> course/loginas.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "81: \\core\\session\\manager::loginas($userid, $context);",
      "82: $newfullname = fullname($USER, true);",
      "84: $strloginas    = get_string('loginas');",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "84: \\core\\notification::info(get_string('sessionforceclean', 'core'));",
      "",
      "---------------"
    ],
    "lang/en/moodle.php||lang/en/moodle.php": [
      "File: lang/en/moodle.php -> lang/en/moodle.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1808: $string['separateandconnectedinfo'] = 'The scale based on the theory of separate and connected knowing. This theory describes two different ways that we can evaluate and learn about the things we see and hear.<ul><li><strong>Separate knowers</strong> remain as objective as possible without including feelings and emotions. In a discussion with other people, they like to defend their own ideas, using logic to find holes in opponent\\'s ideas.</li><li><strong>Connected knowers</strong> are more sensitive to other people. They are skilled at empathy and tend to listen and ask questions until they feel they can connect and \"understand things from their point of view\". They learn by trying to share the experiences that led to the knowledge they find in other people.</li></ul>';",
      "1809: $string['servererror'] = 'An error occurred whilst communicating with the server';",
      "1810: $string['serverlocaltime'] = 'Server\\'s local time';",
      "1811: $string['setcategorytheme'] = 'Set category theme';",
      "1812: $string['setpassword'] = 'Set password';",
      "1813: $string['setpasswordinstructions'] = 'Please enter your new password below, then save changes.';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1811: $string['sessionforceclean'] = 'As a security precaution, user generated scripts have been disabled within this session';",
      "",
      "---------------"
    ],
    "lib/moodlelib.php||lib/moodlelib.php": [
      "File: lib/moodlelib.php -> lib/moodlelib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "2758:     sesskey();",
      "2761:     if (is_siteadmin() && !($cm && $cm->deletioninprogress)) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2760:     if (\\core\\session\\manager::is_loggedinas()) {",
      "2764:         $CFG->forceclean = true;",
      "2765:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7aeeb44463cf1ddf4f34be0d139427da18d91459",
      "candidate_info": {
        "commit_hash": "7aeeb44463cf1ddf4f34be0d139427da18d91459",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/7aeeb44463cf1ddf4f34be0d139427da18d91459",
        "files": [
          "lang/en/error.php",
          "lang/en/moodle.php",
          "lib/ajax/service.php",
          "lib/amd/build/ajax.min.js",
          "lib/amd/build/network.min.js",
          "lib/amd/build/page_global.min.js",
          "lib/amd/src/ajax.js",
          "lib/amd/src/network.js",
          "lib/amd/src/page_global.js",
          "lib/classes/session/external.php",
          "lib/classes/session/manager.php",
          "lib/db/services.php",
          "lib/outputrequirementslib.php",
          "lib/sessionkeepalive_ajax.php",
          "lib/upgrade.txt",
          "lib/yui/build/moodle-core-checknet/assets/checknet.txt",
          "lib/yui/build/moodle-core-checknet/moodle-core-checknet-debug.js",
          "lib/yui/build/moodle-core-checknet/moodle-core-checknet-min.js",
          "lib/yui/build/moodle-core-checknet/moodle-core-checknet.js",
          "lib/yui/src/checknet/assets/checknet.txt",
          "lib/yui/src/checknet/build.json",
          "lib/yui/src/checknet/js/checknet.js",
          "lib/yui/src/checknet/meta/checknet.json",
          "mod/scorm/player.php",
          "version.php"
        ],
        "message": "MDL-34498 session: Add a checker to warn before session expiry\n\nReplaces old yui module checknet.",
        "before_after_code_files": [
          "lang/en/error.php||lang/en/error.php",
          "lang/en/moodle.php||lang/en/moodle.php",
          "lib/ajax/service.php||liajax/service.php",
          "lib/amd/src/ajax.js||liamd/src/ajax.js",
          "lib/amd/src/network.js||liamd/src/network.js",
          "lib/amd/src/page_global.js||liamd/src/page_global.js",
          "lib/classes/session/external.php||liclasses/session/external.php",
          "lib/classes/session/manager.php||liclasses/session/manager.php",
          "lib/db/services.php||lidservices.php",
          "lib/outputrequirementslib.php||lioutputrequirementslib.php",
          "lib/sessionkeepalive_ajax.php||lisessionkeepalive_ajax.php",
          "lib/yui/src/checknet/js/checknet.js||liyui/src/checknet/js/checknet.js",
          "mod/scorm/player.php||mod/scorm/player.php",
          "version.php||version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lang/en/moodle.php||lang/en/moodle.php"
          ],
          "candidate": [
            "lang/en/moodle.php||lang/en/moodle.php"
          ]
        }
      },
      "candidate_diff": {
        "lang/en/error.php||lang/en/error.php": [
          "File: lang/en/error.php -> lang/en/error.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "496: $string['serverconnection'] = 'Error connecting to the server';",
          "497: $string['servicedonotexist'] = 'The service does not exist';",
          "498: $string['sessionwaiterr'] = 'Timed out while waiting for session lock.<br />Wait for your current requests to finish and try again later.';",
          "499: $string['sessioncookiesdisable'] = 'Incorrect use of require_key_login() - session cookies must be disabled!';",
          "500: $string['sessiondiskfull'] = 'The session partition is full. It is not possible to log in at this time. Please notify the server administrator.';",
          "501: $string['sessionhandlerproblem'] = 'Session handler is misconfigured';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "499: $string['sessionexpired'] = 'Session expired';",
          "",
          "---------------"
        ],
        "lang/en/moodle.php||lang/en/moodle.php": [
          "File: lang/en/moodle.php -> lang/en/moodle.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "802: $string['existingcreators'] = 'Existing course creators';",
          "803: $string['existingstudents'] = 'Enrolled students';",
          "804: $string['existingteachers'] = 'Existing teachers';",
          "805: $string['expand'] = 'Expand';",
          "806: $string['expandall'] = 'Expand all';",
          "807: $string['expandcategory'] = 'Expand {$a}';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "805: $string['extendsession'] = 'Extend session';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1807: $string['separateandconnectedinfo'] = 'The scale based on the theory of separate and connected knowing. This theory describes two different ways that we can evaluate and learn about the things we see and hear.<ul><li><strong>Separate knowers</strong> remain as objective as possible without including feelings and emotions. In a discussion with other people, they like to defend their own ideas, using logic to find holes in opponent\\'s ideas.</li><li><strong>Connected knowers</strong> are more sensitive to other people. They are skilled at empathy and tend to listen and ask questions until they feel they can connect and \"understand things from their point of view\". They learn by trying to share the experiences that led to the knowledge they find in other people.</li></ul>';",
          "1808: $string['servererror'] = 'An error occurred whilst communicating with the server';",
          "1809: $string['serverlocaltime'] = 'Server\\'s local time';",
          "1811: $string['setcategorytheme'] = 'Set category theme';",
          "1812: $string['setpassword'] = 'Set password';",
          "1813: $string['setpasswordinstructions'] = 'Please enter your new password below, then save changes.';",
          "",
          "[Removed Lines]",
          "1810: $string['sessionforceclean'] = 'As a security precaution, user-generated scripts have been disabled within this session.';",
          "",
          "[Added Lines]",
          "1811: $string['sessionforceclean'] = 'As a security precaution, user-generated scripts have been disabled within this session';",
          "1812: $string['sessiontimeoutsoon'] = 'Your session is about to timeout. Do you want to extend your current session?';",
          "",
          "---------------"
        ],
        "lib/ajax/service.php||liajax/service.php": [
          "File: lib/ajax/service.php -> liajax/service.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: define('AJAX_SCRIPT', true);",
          "32: require_once(__DIR__ . '/../../config.php');",
          "33: require_once($CFG->libdir . '/externallib.php');",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/amd/src/ajax.js||liamd/src/ajax.js": [
          "File: lib/amd/src/ajax.js -> liamd/src/ajax.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "41:     var requestSuccess = function(responses) {",
          "49:         if (responses.error) {",
          "",
          "[Removed Lines]",
          "43:         var requests = this;",
          "44:         var exception = null;",
          "45:         var i = 0;",
          "46:         var request;",
          "47:         var response;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "69:                     request.deferred.resolve(response.data);",
          "70:                 } else {",
          "71:                     exception = response.exception;",
          "72:                     break;",
          "73:                 }",
          "74:             } else {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "81:         if (exception !== null) {",
          "84:                 window.location = URL.relativeUrl(\"/login/index.php\");",
          "85:             } else {",
          "86:                 requests.forEach(function(request) {",
          "",
          "[Removed Lines]",
          "83:             if (exception.errorcode === \"servicerequireslogin\") {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "138:             $(window).bind('beforeunload', function() {",
          "139:                 unloading = true;",
          "140:             });",
          "",
          "[Removed Lines]",
          "137:         call: function(requests, async, loginrequired) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "150:             if (typeof async === \"undefined\") {",
          "151:                 async = true;",
          "152:             }",
          "153:             for (i = 0; i < requests.length; i++) {",
          "154:                 var request = requests[i];",
          "155:                 ajaxRequestData.push({",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "157:                     methodname: request.methodname,",
          "158:                     args: request.args",
          "159:                 });",
          "160:                 request.deferred = $.Deferred();",
          "161:                 promises.push(request.deferred.promise());",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "185:                 dataType: 'json',",
          "186:                 processData: false,",
          "187:                 async: async,",
          "189:             };",
          "191:             var script = 'service.php';",
          "",
          "[Removed Lines]",
          "188:                 contentType: \"application/json\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "195:             var url = config.wwwroot + '/lib/ajax/' + script +",
          "196:                     '?sesskey=' + config.sesskey + '&info=' + requestInfo;",
          "199:             if (async) {",
          "200:                 $.ajax(url, settings)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/amd/src/network.js||liamd/src/network.js": [
          "File: lib/amd/src/network.js -> liamd/src/network.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/amd/src/page_global.js||liamd/src/page_global.js": [
          "File: lib/amd/src/page_global.js -> liamd/src/page_global.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "26:     'jquery',",
          "27:     'core/custom_interaction_events',",
          "28:     'core/str',",
          "29: ],",
          "30: function(",
          "31:     $,",
          "32:     CustomEvents,",
          "34: ) {",
          "",
          "[Removed Lines]",
          "33:     Str",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "128:     var init = function() {",
          "129:         initActionOptionDropdownHandler();",
          "130:     };",
          "132:     return {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/classes/session/external.php||liclasses/session/external.php": [
          "File: lib/classes/session/external.php -> liclasses/session/external.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/classes/session/manager.php||liclasses/session/manager.php": [
          "File: lib/classes/session/manager.php -> liclasses/session/manager.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "364:             }",
          "366:             if ($timeout) {",
          "367:                 session_regenerate_id(true);",
          "368:                 $_SESSION = array();",
          "369:                 $DB->delete_records('sessions', array('id'=>$record->id));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "398:                     $updated = true;",
          "399:                 }",
          "402:                     $update->id = $record->id;",
          "403:                     $DB->update_record('sessions', $update);",
          "404:                 }",
          "",
          "[Removed Lines]",
          "401:                 if ($updated) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "632:         return self::$handler->session_exists($sid);",
          "633:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "961:         global $CFG, $PAGE;",
          "963:         if ($frequency) {",
          "",
          "[Removed Lines]",
          "960:     public static function keepalive($identifier = 'sessionerroruser', $component = 'error', $frequency = null) {",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "966:                 throw new \\coding_exception('Keepalive frequency is longer than the session lifespan.');",
          "967:             }",
          "968:         } else {",
          "982:     }",
          "",
          "[Removed Lines]",
          "970:             $frequency = $CFG->sessiontimeout / 3;",
          "971:         }",
          "974:         $sessionkeepaliveurl = new \\moodle_url('/lib/sessionkeepalive_ajax.php');",
          "975:         $PAGE->requires->string_for_js($identifier, $component);",
          "976:         $PAGE->requires->yui_module('moodle-core-checknet', 'M.core.checknet.init', array(array(",
          "978:             'frequency' => $frequency * 1000,",
          "979:             'message' => array($identifier, $component),",
          "980:             'uri' => $sessionkeepaliveurl->out(),",
          "981:         )));",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/db/services.php||lidservices.php": [
          "File: lib/db/services.php -> lidservices.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "677:         'loginrequired' => false,",
          "678:         'ajax' => true,",
          "679:     ),",
          "680:     'core_files_get_files' => array(",
          "681:         'classname' => 'core_files_external',",
          "682:         'methodname' => 'get_files',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/outputrequirementslib.php||lioutputrequirementslib.php": [
          "File: lib/outputrequirementslib.php -> lioutputrequirementslib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "321:             $this->M_cfg = array(",
          "322:                 'wwwroot'             => $CFG->wwwroot,",
          "323:                 'sesskey'             => sesskey(),",
          "324:                 'themerev'            => theme_get_revision(),",
          "325:                 'slasharguments'      => (int)(!empty($CFG->slasharguments)),",
          "326:                 'theme'               => $page->theme->name,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/sessionkeepalive_ajax.php||lisessionkeepalive_ajax.php": [
          "File: lib/sessionkeepalive_ajax.php -> lisessionkeepalive_ajax.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "lib/yui/src/checknet/js/checknet.js||liyui/src/checknet/js/checknet.js": [
          "File: lib/yui/src/checknet/js/checknet.js -> liyui/src/checknet/js/checknet.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "mod/scorm/player.php||mod/scorm/player.php": [
          "File: mod/scorm/player.php -> mod/scorm/player.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "282:     include_once($CFG->dirroot.'/mod/scorm/datamodels/scorm_12.php');",
          "283: }",
          "295: echo $OUTPUT->footer();",
          "",
          "[Removed Lines]",
          "286: $PAGE->requires->string_for_js('networkdropped', 'mod_scorm');",
          "288: $args = array(",
          "289:     'message' => array('networkdropped', 'mod_scorm'),",
          "290:     'frequency' => 30000, // Frequency of network check.",
          "291:     'timeout' => 10000, // Timeout of network check.",
          "292:     'maxalerts' => 1 // Max number of alerts to be thrown.",
          "293: );",
          "294: $PAGE->requires->yui_module('moodle-core-checknet', 'M.core.checknet.init', array($args));",
          "",
          "[Added Lines]",
          "286: \\core\\session\\manager::keepalive('networkdropped', 'mod_scorm', 30, 10);",
          "",
          "---------------"
        ],
        "version.php||version.php": [
          "File: version.php -> version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "30: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "32: $version  = 2019053000.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "[Added Lines]",
          "32: $version  = 2019060600.00;              // YYYYMMDD      = weekly release date of this DEV branch.",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7ac4c9c1f621652291deac2c1fcff912db0a6973",
      "candidate_info": {
        "commit_hash": "7ac4c9c1f621652291deac2c1fcff912db0a6973",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/7ac4c9c1f621652291deac2c1fcff912db0a6973",
        "files": [
          "admin/tool/mobile/lang/en/tool_mobile.php",
          "blocks/myoverview/lang/en/block_myoverview.php",
          "filter/displayh5p/lang/en/filter_displayh5p.php",
          "lang/en/admin.php",
          "lang/en/auth.php",
          "lang/en/availability.php",
          "lang/en/badges.php",
          "lang/en/completion.php",
          "lang/en/course.php",
          "lang/en/moodle.php",
          "lang/en/role.php",
          "lang/en/user.php",
          "lib/mlbackend/python/lang/en/mlbackend_python.php",
          "mod/assign/lang/en/assign.php",
          "mod/forum/lang/en/forum.php",
          "report/insights/lang/en/report_insights.php"
        ],
        "message": "MDL-66990 lang: Import fixed English strings (en_fix)\n\nSignificant string changes:\n\n* hidegrader_help,mod_assign - note about setting having no effect on\n  comments box\n* configdefaultrequestcategory, configenablecourserequests,\n  configlockrequestcategory, lockrequestcategory, core_admin - clearer\n  explanation\n* configenablecompletion,core_completion - including reason for setting\n  activity completion conditions\n* emailstop,core - clearer wording\n* setuplink_desc,tool_mobile - including where the app download page\n  link is displayed and leaving the setting empty",
        "before_after_code_files": [
          "admin/tool/mobile/lang/en/tool_mobile.php||admin/tool/mobile/lang/en/tool_mobile.php",
          "blocks/myoverview/lang/en/block_myoverview.php||blocks/myoverview/lang/en/block_myoverview.php",
          "filter/displayh5p/lang/en/filter_displayh5p.php||filter/displayh5p/lang/en/filter_displayh5p.php",
          "lang/en/admin.php||lang/en/admin.php",
          "lang/en/auth.php||lang/en/auth.php",
          "lang/en/availability.php||lang/en/availability.php",
          "lang/en/badges.php||lang/en/badges.php",
          "lang/en/completion.php||lang/en/completion.php",
          "lang/en/course.php||lang/en/course.php",
          "lang/en/moodle.php||lang/en/moodle.php",
          "lang/en/role.php||lang/en/role.php",
          "lang/en/user.php||lang/en/user.php",
          "lib/mlbackend/python/lang/en/mlbackend_python.php||lib/mlbackend/python/lang/en/mlbackend_python.php",
          "mod/assign/lang/en/assign.php||mod/assign/lang/en/assign.php",
          "mod/forum/lang/en/forum.php||mod/forum/lang/en/forum.php",
          "report/insights/lang/en/report_insights.php||report/insights/lang/en/report_insights.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "lang/en/moodle.php||lang/en/moodle.php"
          ],
          "candidate": [
            "lang/en/moodle.php||lang/en/moodle.php"
          ]
        }
      },
      "candidate_diff": {
        "admin/tool/mobile/lang/en/tool_mobile.php||admin/tool/mobile/lang/en/tool_mobile.php": [
          "File: admin/tool/mobile/lang/en/tool_mobile.php -> admin/tool/mobile/lang/en/tool_mobile.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "75: $string['logininthebrowser'] = 'Via a browser window (for SSO plugins)';",
          "76: $string['loginintheembeddedbrowser'] = 'Via an embedded browser (for SSO plugins)';",
          "77: $string['mainmenu'] = 'Main menu';",
          "79: $string['minimumversion_key'] = 'Minimum app version required';",
          "80: $string['mobileapp'] = 'Mobile app';",
          "81: $string['mobileappconnected'] = 'Mobile app connected';",
          "",
          "[Removed Lines]",
          "78: $string['minimumversion'] = 'Require users to upgrade their apps to the minimum version indicated. Those using previous versions of the app will not be able to access to the site. This works since app version 3.8.0 onward.';",
          "",
          "[Added Lines]",
          "78: $string['minimumversion'] = 'If an app version is specified (3.8.0 or higher), any users using an older app version will be prompted to upgrade their app before being allowed access to the site.';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "93: $string['remoteaddons'] = 'Remote add-ons';",
          "94: $string['selfsignedoruntrustedcertificatewarning'] = 'It seems that the HTTPS certificate is self-signed or not trusted. The mobile app will only work with trusted sites.';",
          "95: $string['setuplink'] = 'App download page';",
          "97: $string['smartappbanners'] = 'App Banners';",
          "98: $string['typeoflogin'] = 'Type of login';",
          "99: $string['typeoflogin_desc'] = 'If the site uses a SSO authentication method, then select via a browser window or via an embedded browser. An embedded browser provides a better user experience, though it doesn\\'t work with all SSO plugins.';",
          "",
          "[Removed Lines]",
          "96: $string['setuplink_desc'] = 'URL of page with links to download the mobile app from the App Store and Google Play.';",
          "",
          "[Added Lines]",
          "96: $string['setuplink_desc'] = 'URL of page with options to download the mobile app from the App Store and Google Play. The app download page link is displayed in the page footer and in a user\\'s profile. Leave blank to not display a link.';",
          "",
          "---------------"
        ],
        "blocks/myoverview/lang/en/block_myoverview.php||blocks/myoverview/lang/en/block_myoverview.php": [
          "File: blocks/myoverview/lang/en/block_myoverview.php -> blocks/myoverview/lang/en/block_myoverview.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "38: $string['aria:favourites'] = 'Show starred courses';",
          "39: $string['aria:future'] = 'Show future courses';",
          "40: $string['aria:groupingdropdown'] = 'Grouping drop-down menu';",
          "42: $string['aria:lastaccessed'] = 'Sort courses by last accessed date';",
          "43: $string['aria:list'] = 'Switch to list view';",
          "44: $string['aria:title'] = 'Sort courses by course name';",
          "",
          "[Removed Lines]",
          "41: $string['aria:inprogress'] = 'Show in courses in progress';",
          "",
          "[Added Lines]",
          "41: $string['aria:inprogress'] = 'Show courses in progress';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "54: $string['completepercent'] = '{$a}% complete';",
          "55: $string['customfield'] = 'Custom field';",
          "56: $string['customfiltergrouping'] = 'Field to use';",
          "58: $string['displaycategories'] = 'Display categories';",
          "59: $string['displaycategories_help'] = 'Display the course category on dashboard course items including cards, list items and summary items.';",
          "60: $string['favourites'] = 'Starred';",
          "",
          "[Removed Lines]",
          "57: $string['customfiltergrouping_nofields'] = 'You need to add at least one course custom field in order to use this setting';",
          "",
          "[Added Lines]",
          "57: $string['customfiltergrouping_nofields'] = 'This option requires a course custom field to be set up.';",
          "",
          "---------------"
        ],
        "filter/displayh5p/lang/en/filter_displayh5p.php||filter/displayh5p/lang/en/filter_displayh5p.php": [
          "File: filter/displayh5p/lang/en/filter_displayh5p.php -> filter/displayh5p/lang/en/filter_displayh5p.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: defined('MOODLE_INTERNAL') || die;",
          "27: $string['allowedsourceslist'] = 'Allowed sources';",
          "33: $string['filtername'] = 'Display H5P';",
          "",
          "[Removed Lines]",
          "28: $string['allowedsourceslistdesc'] = 'List of sources from which users can embed H5P content. If empty, the filter won\\'t convert any external URL.",
          "30: <b>[id]</b> is a placeholder for the H5P content id in the external source.",
          "32: <b>*</b> wildcard is supported. For example, *.example.com will embed H5P content from any subdomain of example.com, but not from the example.com domain.';",
          "34: $string['privacy:metadata'] = 'This H5P filter does not store any personal data.';",
          "",
          "[Added Lines]",
          "28: $string['allowedsourceslistdesc'] = 'A list of URLs from which users can embed H5P content. If none are specified, all URLs will remain as links and not be displayed as embedded H5P content.",
          "30: \\'[id]\\' is a placeholder for the H5P content ID in the external source.",
          "32: The wildcard character \\'*\\' may be used to specify subdomains. For example, *.example.com will allow embedded H5P content from any subdomain of example.com, but not from the example.com domain.';",
          "34: $string['privacy:metadata'] = 'The display H5P filter does not store any personal data.';",
          "",
          "---------------"
        ],
        "lang/en/admin.php||lang/en/admin.php": [
          "File: lang/en/admin.php -> lang/en/admin.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "53: $string['allowediplist'] = 'Allowed IP list';",
          "54: $string['allowedemaildomains'] = 'Allowed email domains';",
          "55: $string['allowemailaddresses'] = 'Allowed email domains';",
          "57: $string['allowindexing'] = 'Allow indexing by search engines';",
          "58: $string['allowindexing_desc'] = 'This determines whether to allow search engines to index your site. \"Everywhere\" will allow the search engines to search everywhere including login and signup pages, which means sites with Force Login turned on are still indexed. To avoid the risk of spam involved with the signup page being searchable, use \"Everywhere except login and signup pages\". \"Nowhere\" will tell search engines not to index any page. Note this is only a tag in the header of the site. It is up to the search engine to respect the tag.';",
          "59: $string['allowindexingeverywhere'] = 'Everywhere';",
          "",
          "[Removed Lines]",
          "56: $string['allowemojipicker'] = 'Enable emoji picker';",
          "",
          "[Added Lines]",
          "56: $string['allowemojipicker'] = 'Emoji picker';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "105: $string['bookmarkthispage'] = 'Bookmark this page';",
          "106: $string['cachejs'] = 'Cache Javascript';",
          "107: $string['cachejs_help'] = 'Javascript caching and compression greatly improves page loading performance. it is strongly recommended for production sites. Developers will probably want to disable this feature.';",
          "109: $string['cachetemplates_help'] = 'Template caching will improve page loading performance and is strongly recommended for production sites. Developers will probably want to disable this feature.';",
          "110: $string['calendarexportsalt'] = 'Calendar export salt';",
          "111: $string['calendarsettings'] = 'Calendar';",
          "",
          "[Removed Lines]",
          "108: $string['cachetemplates'] = 'Cache Templates';",
          "",
          "[Added Lines]",
          "108: $string['cachetemplates'] = 'Cache templates';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "154: $string['configallowcoursethemes'] = 'If you enable this, then courses will be allowed to set their own themes.  Course themes override all other theme choices (site, user, or session themes)';",
          "155: $string['configallowedemaildomains'] = 'List email domains that are allowed to be disclosed in the \"From\" section of outgoing email. The default of \"Empty\" will use the No-reply address for all outgoing email. The use of wildcards is allowed e.g. *.example.com will allow emails sent from any subdomain of example.com, but not example.com itself. This will require separate entry.';",
          "156: $string['configallowemailaddresses'] = 'To restrict new email addresses to particular domains, list them here separated by spaces. All other domains will be rejected. To allow subdomains, add the domain with a preceding \\'.\\'. To allow a root domain together with its subdomains, add the domain twice - once with a preceding \\'.\\' and once without e.g. .ourcollege.edu.au ourcollege.edu.au.';",
          "159: $string['configallowguestmymoodle'] = 'If enabled guests can access Dashboard, otherwise guests are redirected to the site front page.';",
          "160: $string['configallowobjectembed'] = 'As a default security measure, normal users are not allowed to embed multimedia (like Flash) within texts using explicit EMBED and OBJECT tags in their HTML (although it can still be done safely using the mediaplugins filter).  If you wish to allow these tags then enable this option.';",
          "161: $string['configallowoverride'] = 'You can allow people with the roles on the left side to override some of the column roles';",
          "",
          "[Removed Lines]",
          "157: $string['configallowemojipicker'] = 'If enabled, the emoji picker will be available within the site';",
          "158: $string['configallowemojipickerincompatible'] = 'Your current database configuration does not properly support emojis. In order to enable the emoji picker you will need to <a href=\"https://docs.moodle.org/37/en/MySQL_full_unicode_support\">upgrade your database for full unicode support</a>.';",
          "",
          "[Added Lines]",
          "157: $string['configallowemojipicker'] = 'The emoji picker enables users to select emojis, such as smilies, to add to messages.';",
          "158: $string['configallowemojipickerincompatible'] = 'Your current database configuration does not properly support emojis. In order to enable the emoji picker you will need to <a href=\"https://docs.moodle.org/en/MySQL_full_unicode_support\">upgrade your database for full unicode support</a>.';",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "206: $string['configdebugpageinfo'] = 'Enable if you want page information printed in page footer.';",
          "207: $string['configdebugvalidators'] = 'Enable if you want to have links to external validator servers in page footer. You may need to create new user with username <em>w3cvalidator</em>, and enable guest access. These changes may allow unauthorized access to server, do not enable on production sites!';",
          "208: $string['configdefaulthomepage'] = 'This determines the first link in the navigation for logged-in users.';",
          "210: $string['configdefaultrequestedcategory'] = 'Default category to put courses that were requested into, if they\\'re approved.';",
          "211: $string['configdefaultuserroleid'] = 'All logged in users will be given the capabilities of the role you specify here, at the site level, in ADDITION to any other roles they may have been given.  The default is the Authenticated user role.  Note that this will not conflict with other roles they have unless you prohibit capabilities, it just ensures that all users have capabilities that are not assignable at the course level (eg post blog entries, manage own calendar, etc).';",
          "212: $string['configdeleteincompleteusers'] = 'After this period, any account without the first name, last name or email field filled in is deleted.';",
          "",
          "[Removed Lines]",
          "209: $string['configdefaultrequestcategory'] = 'Courses requested by users will be placed in this category if the category is not specified.';",
          "",
          "[Added Lines]",
          "209: $string['configdefaultrequestcategory'] = 'Courses requested by users with the capability to request new courses in the system context will be placed in this category unless users are able to select a different category.';",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "228: $string['configemailsubjectprefix'] = 'Text to be prefixed to the subject line of all outgoing mail.';",
          "229: $string['configenablecalendarexport'] = 'Enable exporting or subscribing to calendars.';",
          "230: $string['configenablecomments'] = 'Enable comments';",
          "232: $string['configenablemobilewebservice'] = 'Enable mobile service for the official Moodle app or other app requesting it. For more information, read the {$a}';",
          "233: $string['configenablerssfeeds'] = 'If enabled, RSS feeds are generated by various features across the site, such as blogs, forums, database activities and glossaries. Note that RSS feeds also need to be enabled for the particular activity modules.';",
          "234: $string['configenablerssfeedsdisabled'] = 'It is not available because RSS feeds are disabled in all the Site. To enable them, go to the Variables settings under Admin Configuration.';",
          "",
          "[Removed Lines]",
          "231: $string['configenablecourserequests'] = 'Enable course request functionality. Users with capability to request courses but without capability to create courses will be able to request courses.';",
          "",
          "[Added Lines]",
          "231: $string['configenablecourserequests'] = 'If enabled, users with the capability to request new courses (moodle/course:request) will have the option to request a course. This capability is not allowed for any of the default roles. It may be applied in the system or category context.';",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "273: $string['configlangmenu'] = 'Choose whether or not you want to display the general-purpose language menu on the home page, login page etc.  This does not affect the user\\'s ability to set the preferred language in their own profile.';",
          "274: $string['configlatinexcelexport'] = 'Choose the encoding for Excel exports.';",
          "275: $string['configlocale'] = 'Choose a sitewide locale - this will override the format and language of dates for all language packs (though names of days in calendar are not affected). You need to have this locale data installed on your operating system (eg for linux en_US.UTF-8 or es_ES.UTF-8). In most cases this field should be left blank.';",
          "277: $string['configloglifetime'] = 'This specifies the length of time you want to keep logs about user activity.  Logs that are older than this age are automatically deleted.  It is best to keep logs as long as possible, in case you need them, but if you have a very busy server and are experiencing performance problems, then you may want to lower the log lifetime. Values lower than 30 are not recommended because statistics may not work properly.';",
          "278: $string['configlookahead'] = 'Days to look ahead';",
          "279: $string['configmailnewline'] = 'Newline characters used in mail messages. CRLF is required according to RFC 822bis, some mail servers do automatic conversion from LF to CRLF, other mail servers do incorrect conversion from CRLF to CRCRLF, yet others reject mails with bare LF (qmail for example). Try changing this setting if you are having problems with undelivered emails or double newlines.';",
          "",
          "[Removed Lines]",
          "276: $string['configlockrequestcategory'] = 'Only allow course requests in the default course request category. This is a legacy setting, it is better not to use it but instead assign capability to request courses in the appropriate course category context';",
          "",
          "[Added Lines]",
          "276: $string['configlockrequestcategory'] = 'If enabled, users with the capability to request new courses in the system context will not be able to select a category in the request a new course form. An alternative way of restricting users to requesting a new course in just one category is to apply the capability to request new courses in the category context.';",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "719: $string['lockoutthreshold_desc'] = 'Select number of failed login attempts that result in account lockout. This feature may be abused in denial of service attacks.';",
          "720: $string['lockoutwindow'] = 'Account lockout observation window';",
          "721: $string['lockoutwindow_desc'] = 'Observation time for lockout threshold, if there are no failed attempts the threshold counter is reset after this time.';",
          "723: $string['log'] = 'Logs';",
          "724: $string['logguests'] = 'Log guest access';",
          "725: $string['logguests_help'] = 'This setting enables logging of actions by guest account and not logged in users. High profile sites may want to disable this logging for performance reasons. It is recommended to keep this setting enabled on production sites.';",
          "",
          "[Removed Lines]",
          "722: $string['lockrequestcategory'] = 'Lock category for the course requests';",
          "",
          "[Added Lines]",
          "722: $string['lockrequestcategory'] = 'Prevent category selection';",
          "",
          "---------------"
        ],
        "lang/en/auth.php||lang/en/auth.php": [
          "File: lang/en/auth.php -> lang/en/auth.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "51: $string['auth_remove_suspend'] = 'Suspend internal';",
          "52: $string['auth_remove_user'] = 'Specify what to do with internal user account during mass synchronisation when user was removed from external source. Only suspended users are automatically restored if they reappear in the external source.';",
          "53: $string['auth_remove_user_key'] = 'Removed ext user';",
          "55: $string['auth_sync_suspended_key'] = 'Synchronise local user suspension status';",
          "56: $string['auth_sync_script'] = 'User account synchronisation';",
          "57: $string['auth_updatelocal'] = 'Update local';",
          "",
          "[Removed Lines]",
          "54: $string['auth_sync_suspended']  = 'When enabled, the suspended attribute will be used to update the local user account\\'s suspension status.';",
          "",
          "[Added Lines]",
          "54: $string['auth_sync_suspended']  = 'If enabled, the suspended attribute will be used to update the local user account\\'s suspension status.';",
          "",
          "---------------"
        ],
        "lang/en/availability.php||lang/en/availability.php": [
          "File: lang/en/availability.php -> lang/en/availability.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: $string['condition_group'] = 'Restriction set';",
          "29: $string['condition_group_info'] = 'Add a set of nested restrictions to apply complex logic.';",
          "30: $string['enableavailability'] = 'Enable restricted access';",
          "32: $string['error_list_nochildren'] = 'Restriction sets should contain at least one condition.';",
          "33: $string['hidden_marker'] = '(hidden otherwise)';",
          "34: $string['hidden_individual'] = 'Hidden entirely if user does not meet this condition';",
          "",
          "[Removed Lines]",
          "31: $string['enableavailability_desc'] = 'When enabled, this lets you set conditions (based on date, grade, or completion) that control whether an activity or resource can be accessed.';",
          "",
          "[Added Lines]",
          "31: $string['enableavailability_desc'] = 'If enabled, conditions (based on date, grade, completion etc.) may be set to control whether an activity or resource can be accessed.';",
          "",
          "---------------"
        ],
        "lang/en/badges.php||lang/en/badges.php": [
          "File: lang/en/badges.php -> lang/en/badges.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "176: $string['clearsettings'] = 'Clear settings';",
          "177: $string['completionnotenabled'] = 'Course completion is not enabled for this course, so it cannot be included in badge criteria. Course completion may be enabled in the course settings.';",
          "178: $string['completioninfo'] = 'This badge was issued for completing: ';",
          "180: $string['configuremessage'] = 'Badge message';",
          "181: $string['connect'] = 'Connect';",
          "182: $string['connected'] = 'Connected';",
          "",
          "[Removed Lines]",
          "179: $string['configenablebadges'] = 'When enabled, this feature lets you create badges and award them to site users.';",
          "",
          "[Added Lines]",
          "179: $string['configenablebadges'] = 'If enabled, this feature lets you create badges and award them to site users.';",
          "",
          "---------------"
        ],
        "lang/en/completion.php||lang/en/completion.php": [
          "File: lang/en/completion.php -> lang/en/completion.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "112: $string['completionview'] = 'Require view';",
          "113: $string['completionview_desc'] = 'Student must view this activity to complete it';",
          "114: $string['configcompletiondefault'] = 'The default setting for completion tracking when creating new activities.';",
          "116: $string['confirmselfcompletion'] = 'Confirm self completion';",
          "117: $string['courseaggregation'] = 'Condition requires';",
          "118: $string['courseaggregation_all'] = 'ALL selected courses to be completed';",
          "",
          "[Removed Lines]",
          "115: $string['configenablecompletion'] = 'When enabled, this lets you turn on completion tracking (progress) features at course level.';",
          "",
          "[Added Lines]",
          "115: $string['configenablecompletion'] = 'If enabled, course and activity completion conditions may be set. Setting activity completion conditions is recommended so that meaningful data is displayed for users in their course overview on the Dashboard.';",
          "",
          "---------------"
        ],
        "lang/en/course.php||lang/en/course.php": [
          "File: lang/en/course.php -> lang/en/course.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: $string['nocoursestudents'] = 'No students';",
          "49: $string['noaccesssincestartinfomessage'] = 'Hi {$a->userfirstname},",
          "52: $string['norecentaccessesinfomessage'] = 'Hi {$a->userfirstname},",
          "55: $string['noteachinginfomessage'] = 'Hi {$a->userfirstname},",
          "57: </br><br/>Courses with start dates in the next week have been identified as having no teacher or student enrolments.';",
          "",
          "[Removed Lines]",
          "51: </br><br/>Students in {$a->coursename} have never accessed the course.';",
          "54: </br><br/>Students in {$a->coursename} have not accessed the course recently.';",
          "",
          "[Added Lines]",
          "51: </br><br/>A number of students in {$a->coursename} have never accessed the course.';",
          "54: </br><br/>A number of students in {$a->coursename} have not accessed the course recently.';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "75: $string['target:noaccesssincecoursestart'] = 'Students who have not accessed the course yet';",
          "76: $string['target:noaccesssincecoursestart_help'] = 'This target describes students who never accessed a course they are enrolled in.';",
          "77: $string['target:norecentaccesses'] = 'Students who have not accessed the course recently';",
          "79: $string['target:noteachingactivity'] = 'Courses at risk of not starting';",
          "80: $string['target:noteachingactivity_help'] = 'This target describes whether courses due to start in the coming week will have teaching activity.';",
          "81: $string['targetlabelstudentcompletionno'] = 'Student who is likely to meet the course completion conditions';",
          "",
          "[Removed Lines]",
          "78: $string['target:norecentaccesses_help'] = 'This target describes students who have not accessed a course recently.';",
          "",
          "[Added Lines]",
          "78: $string['target:norecentaccesses_help'] = 'This target identifies students who have not accessed a course they are enrolled in within the set analysis interval (by default the past month).';",
          "",
          "---------------"
        ],
        "lang/en/moodle.php||lang/en/moodle.php": [
          "File: lang/en/moodle.php -> lang/en/moodle.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "724: $string['emailresetconfirmsent'] = 'An email has been sent to your address at <b>{$a}</b>.",
          "725: <br />It contains easy instructions to confirm and complete this password change.",
          "726: If you continue to have difficulty, contact the site administrator.';",
          "728: $string['emailtoprivatefiles'] = 'You can also e-mail files as attachments straight to your private files space. Simply attach your files to an e-mail and send it to {$a}';",
          "729: $string['emailtoprivatefilesdenied'] = 'Your administrator has disabled the option to upload your own private files.';",
          "730: $string['emailvia'] = '{$a->name} (via {$a->siteshortname})';",
          "",
          "[Removed Lines]",
          "727: $string['emailstop'] = 'Email stop';",
          "",
          "[Added Lines]",
          "727: $string['emailstop'] = 'Disable notifications';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1057: $string['indicator:activitiesdue'] = 'Activities due';",
          "1058: $string['indicator:activitiesdue_help'] = 'The user has activities due.';",
          "1059: $string['indicator:anycourseaccess'] = 'Any course access';",
          "1061: $string['indicator:anywrite'] = 'Any write action';",
          "1062: $string['indicator:anywrite_help'] = 'This indicator represents any write (submit) action taken by the student.';",
          "1063: $string['indicator:anywriteincourse'] = 'Any write action in the course';",
          "",
          "[Removed Lines]",
          "1060: $string['indicator:anycourseaccess_help'] = 'This indicator reflects any accesses to the provided course for the provided user.';",
          "",
          "[Added Lines]",
          "1060: $string['indicator:anycourseaccess_help'] = 'This indicator reflects access to any course that the user is enrolled in.';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1816: $string['separateandconnectedinfo'] = 'The scale based on the theory of separate and connected knowing. This theory describes two different ways that we can evaluate and learn about the things we see and hear.<ul><li><strong>Separate knowers</strong> remain as objective as possible without including feelings and emotions. In a discussion with other people, they like to defend their own ideas, using logic to find holes in opponent\\'s ideas.</li><li><strong>Connected knowers</strong> are more sensitive to other people. They are skilled at empathy and tend to listen and ask questions until they feel they can connect and \"understand things from their point of view\". They learn by trying to share the experiences that led to the knowledge they find in other people.</li></ul>';",
          "1817: $string['servererror'] = 'An error occurred whilst communicating with the server';",
          "1818: $string['serverlocaltime'] = 'Server\\'s local time';",
          "1821: $string['setcategorytheme'] = 'Set category theme';",
          "1822: $string['setpassword'] = 'Set password';",
          "1823: $string['setpasswordinstructions'] = 'Please enter your new password below, then save changes.';",
          "",
          "[Removed Lines]",
          "1819: $string['sessionforceclean'] = 'As a security precaution, user-generated scripts have been disabled within this session';",
          "1820: $string['sessiontimeoutsoon'] = 'Your session is about to timeout. Do you want to extend your current session?';",
          "",
          "[Added Lines]",
          "1819: $string['sessionforceclean'] = 'As a security precaution, user-generated scripts have been disabled within this session.';",
          "1820: $string['sessiontimeoutsoon'] = 'Your session is about to time out. Do you want to extend your current session?';",
          "",
          "---------------"
        ],
        "lang/en/role.php||lang/en/role.php": [
          "File: lang/en/role.php -> lang/en/role.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "260: $string['grade:view'] = 'View own grades';",
          "261: $string['grade:viewall'] = 'View grades of other users';",
          "262: $string['grade:viewhidden'] = 'View hidden grades for owner';",
          "265: $string['highlightedcellsshowdefault'] = 'The permissions highlighted in the table below are the defaults for the role archetype currently selected above.';",
          "266: $string['highlightedcellsshowinherit'] = 'The highlighted cells in the table below show the permission (if any) that will be inherited. Apart from the capabilities whose permission you actually want to alter, you should leave everything set to Inherit.';",
          "267: $string['checkglobalpermissions'] = 'Check system permissions';",
          "",
          "[Removed Lines]",
          "263: $string['h5p:deploy'] = 'Allow to deploy H5P content';",
          "264: $string['h5p:setdisplayoptions'] = 'Set the display options to an H5P content';",
          "",
          "[Added Lines]",
          "263: $string['h5p:deploy'] = 'Deploy H5P content';",
          "264: $string['h5p:setdisplayoptions'] = 'Set H5P display options';",
          "",
          "---------------"
        ],
        "lang/en/user.php||lang/en/user.php": [
          "File: lang/en/user.php -> lang/en/user.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "47: $string['privacy:metadata:devicename'] = 'The device name, occam or iPhone etc..';",
          "48: $string['privacy:metadata:devicetablesummary'] = 'This table stores user\\'s mobile devices information in order to send PUSH notifications';",
          "49: $string['privacy:metadata:email'] = 'An email address for contact.';",
          "51: $string['privacy:metadata:fieldid'] = 'The ID relating to the custom user field.';",
          "52: $string['privacy:metadata:filelink'] = 'There are multiple different files for the user stored in the files table.';",
          "53: $string['privacy:metadata:firstaccess'] = 'The time that this user first accessed the site.';",
          "",
          "[Removed Lines]",
          "50: $string['privacy:metadata:emailstop'] = 'A preference to stop email being sent to the user.';",
          "",
          "[Added Lines]",
          "50: $string['privacy:metadata:emailstop'] = 'A preference to disable notifications from being sent to the user.';",
          "",
          "---------------"
        ],
        "lib/mlbackend/python/lang/en/mlbackend_python.php||lib/mlbackend/python/lang/en/mlbackend_python.php": [
          "File: lib/mlbackend/python/lang/en/mlbackend_python.php -> lib/mlbackend/python/lang/en/mlbackend_python.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: $string['errorserver'] = 'Server error {$a}';",
          "27: $string['host'] = 'Host';",
          "28: $string['hostdesc'] = 'Host';",
          "31: $string['pluginname'] = 'Python machine learning backend';",
          "32: $string['port'] = 'Port';",
          "33: $string['portdesc'] = 'Port';",
          "34: $string['privacy:metadata'] = 'The Python machine learning backend plugin does not store any personal data.';",
          "36: $string['pythonpathnotdefined'] = 'The path to your executable Python binary has not been defined. Please visit \"{$a}\" to set it.';",
          "38: $string['username'] = 'Username';",
          "40: $string['password'] = 'Password';",
          "42: $string['secure'] = 'Use HTTPS';",
          "44: $string['useserver'] = 'Use a server';",
          "46: $string['tensorboardinfo'] = 'Launch TensorBoard from command line by typing tensorboard --logdir=\\'{$a}\\' in your web server.';",
          "",
          "[Removed Lines]",
          "29: $string['packageinstalledshouldbe'] = '\"moodlemlbackend\" python package should be updated. The required version is \"{$a->required}\" and the installed version is \"{$a->installed}\"';",
          "30: $string['packageinstalledtoohigh'] = '\"moodlemlbackend\" python package is not compatible with this Moodle version. The required version is \"{$a->required}\" or higher as long as it is API-compatible. The installed version \"{$a->installed}\" is too high.';",
          "35: $string['pythonpackagenotinstalled'] = '\"moodlemlbackend\" python package is not installed or there is a problem with it. Please execute \"{$a}\" from command line interface for more info';",
          "37: $string['serversettingsinfo'] = 'Tick \"Use a server\" setting to show the server settings.';",
          "39: $string['usernamedesc'] = 'String of characters used as a username to communicate between your Moodle server and the python server';",
          "41: $string['passworddesc'] = 'String of characters used as a password to communicate between your Moodle server and the python server';",
          "43: $string['securedesc'] = 'Whether to use HTTP or HTTPS';",
          "45: $string['useserverdesc'] = 'The machine learning backend python package is not installed in the web server but in a different server.';",
          "",
          "[Added Lines]",
          "29: $string['packageinstalledshouldbe'] = 'The moodlemlbackend Python package should be updated. The required version is \"{$a->required}\" and the installed version is \"{$a->installed}\".';",
          "30: $string['packageinstalledtoohigh'] = 'The moodlemlbackend Python package is not compatible with this version of Moodle. The required version is \"{$a->required}\" or higher as long as it is API-compatible. The installed version \"{$a->installed}\" is too high.';",
          "35: $string['pythonpackagenotinstalled'] = 'The moodlemlbackend Python package is not installed or there is a problem with it. Please execute \"{$a}\" from command line interface for more info.';",
          "37: $string['serversettingsinfo'] = 'If \\'Use a server\\' is enabled, the server settings will be displayed.';",
          "39: $string['usernamedesc'] = 'String of characters used as a username to communicate between the Moodle server and the Python server.';",
          "41: $string['passworddesc'] = 'String of characters used as a password to communicate between the Moodle server and the Python server.';",
          "43: $string['securedesc'] = 'Whether to use HTTP or HTTPS.';",
          "45: $string['useserverdesc'] = 'The machine learning backend Python package is not installed on the web server but on a different server.';",
          "",
          "---------------"
        ],
        "mod/assign/lang/en/assign.php||mod/assign/lang/en/assign.php": [
          "File: mod/assign/lang/en/assign.php -> mod/assign/lang/en/assign.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "291: $string['groupoverridesdeleted'] = 'Group overrides deleted';",
          "292: $string['groupsnone'] = 'No groups you can access.';",
          "293: $string['hidegrader'] = 'Hide grader identity from students';",
          "295: $string['hideshow'] = 'Hide/Show';",
          "296: $string['hiddenuser'] = 'Participant ';",
          "297: $string['inactiveoverridehelp'] = '* Student does not have the correct group or role to attempt the assignment';",
          "",
          "[Removed Lines]",
          "294: $string['hidegrader_help'] = 'Hides the identity of any user who grades an assignment submission, so students can\\'t see who marked their work.';",
          "",
          "[Added Lines]",
          "294: $string['hidegrader_help'] = 'If enabled, the identity of any user who grades an assignment submission is not shown, so students can\\'t see who marked their work.",
          "296: Note that this setting has no effect on the comments box on the grading page.';",
          "",
          "---------------"
        ],
        "mod/forum/lang/en/forum.php||mod/forum/lang/en/forum.php": [
          "File: mod/forum/lang/en/forum.php -> mod/forum/lang/en/forum.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "263: $string['export'] = 'Export';",
          "264: $string['exportattachmentname'] = 'Export attachment {$a} to portfolio';",
          "265: $string['exportdiscussion'] = 'Export whole discussion to portfolio';",
          "268: $string['exportoptions'] = 'Export options';",
          "269: $string['exporthumandates'] = 'Human-readable dates';",
          "271: $string['firstpost'] = 'First post';",
          "272: $string['favourites'] = 'Starred';",
          "273: $string['favouriteupdated'] = 'Your star option has been updated.';",
          "",
          "[Removed Lines]",
          "266: $string['exportstriphtml'] = 'Strip HTML';",
          "267: $string['exportstriphtml_help'] = 'Select this option if you want the HTML tags to be stripped from the Whether to export raw HTML or strip HTML codes.';",
          "270: $string['exporthumandates_help'] = 'Select this option if you want dates to be exported in a human readable format. Otherwise, dates will be exported as timestamps.';",
          "",
          "[Added Lines]",
          "266: $string['exportstriphtml'] = 'Remove HTML';",
          "267: $string['exportstriphtml_help'] = 'Whether HTML tags such as p and br should be removed from the forum post message.';",
          "270: $string['exporthumandates_help'] = 'Whether dates should be exported in a human-readable format or as a timestamp (sequence of numbers).';",
          "",
          "---------------"
        ],
        "report/insights/lang/en/report_insights.php||report/insights/lang/en/report_insights.php": [
          "File: report/insights/lang/en/report_insights.php -> report/insights/lang/en/report_insights.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: $string['actionsaved'] = 'Your feedback of \\'{$a}\\' has been saved.';",
          "28: $string['indicators'] = 'Indicators';",
          "29: $string['insight'] = 'Insight';",
          "30: $string['insights'] = 'Insights';",
          "",
          "[Removed Lines]",
          "26: $string['confirmbulkaction'] = 'Are you use you want to flag the {$a->nitems} selected predictions as \"{$a->action}\"?';",
          "27: $string['disabledmodel'] = 'Sorry, this model has been disabled by the administrator';",
          "",
          "[Added Lines]",
          "26: $string['confirmbulkaction'] = 'Are you sure you want to flag the {$a->nitems} selected predictions as {$a->action}?';",
          "27: $string['disabledmodel'] = 'This model has been disabled by an administrator.';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a37e26d2efe1ca0e4d8d69c611a748af35b33674",
      "candidate_info": {
        "commit_hash": "a37e26d2efe1ca0e4d8d69c611a748af35b33674",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/a37e26d2efe1ca0e4d8d69c611a748af35b33674",
        "files": [
          "course/loginas.php",
          "lang/en/moodle.php",
          "lib/moodlelib.php"
        ],
        "message": "MDL-63786 core: set $CFG->forceclean for logged in as sessions\n\nTurn on the forceclean config setting when a user is logged in as a\ndifferent user. This is a precautionary measure, which forces all\nuser submitted content to be cleaned of JavaScript before rendering\nit to the logged in as user.",
        "before_after_code_files": [
          "course/loginas.php||course/loginas.php",
          "lang/en/moodle.php||lang/en/moodle.php",
          "lib/moodlelib.php||lib/moodlelib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "course/loginas.php||course/loginas.php",
            "lang/en/moodle.php||lang/en/moodle.php",
            "lib/moodlelib.php||lib/moodlelib.php"
          ],
          "candidate": [
            "course/loginas.php||course/loginas.php",
            "lang/en/moodle.php||lang/en/moodle.php",
            "lib/moodlelib.php||lib/moodlelib.php"
          ]
        }
      },
      "candidate_diff": {
        "course/loginas.php||course/loginas.php": [
          "File: course/loginas.php -> course/loginas.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "81: \\core\\session\\manager::loginas($userid, $context);",
          "82: $newfullname = fullname($USER, true);",
          "84: $strloginas    = get_string('loginas');",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "84: \\core\\notification::info(get_string('sessionforceclean', 'core'));",
          "",
          "---------------"
        ],
        "lang/en/moodle.php||lang/en/moodle.php": [
          "File: lang/en/moodle.php -> lang/en/moodle.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1804: $string['separateandconnectedinfo'] = 'The scale based on the theory of separate and connected knowing. This theory describes two different ways that we can evaluate and learn about the things we see and hear.<ul><li><strong>Separate knowers</strong> remain as objective as possible without including feelings and emotions. In a discussion with other people, they like to defend their own ideas, using logic to find holes in opponent\\'s ideas.</li><li><strong>Connected knowers</strong> are more sensitive to other people. They are skilled at empathy and tend to listen and ask questions until they feel they can connect and \"understand things from their point of view\". They learn by trying to share the experiences that led to the knowledge they find in other people.</li></ul>';",
          "1805: $string['servererror'] = 'An error occurred whilst communicating with the server';",
          "1806: $string['serverlocaltime'] = 'Server\\'s local time';",
          "1807: $string['setcategorytheme'] = 'Set category theme';",
          "1808: $string['setpassword'] = 'Set password';",
          "1809: $string['setpasswordinstructions'] = 'Please enter your new password below, then save changes.';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1807: $string['sessionforceclean'] = 'As a security precaution, user generated scripts have been disabled within this session';",
          "",
          "---------------"
        ],
        "lib/moodlelib.php||lib/moodlelib.php": [
          "File: lib/moodlelib.php -> lib/moodlelib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2758:     sesskey();",
          "2761:     if (is_siteadmin() && !($cm && $cm->deletioninprogress)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2760:     if (\\core\\session\\manager::is_loggedinas()) {",
          "2764:         $CFG->forceclean = true;",
          "2765:     }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "070f24d006eab6b958eb083530de159b43c538ed",
      "candidate_info": {
        "commit_hash": "070f24d006eab6b958eb083530de159b43c538ed",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/070f24d006eab6b958eb083530de159b43c538ed",
        "files": [
          "course/loginas.php",
          "lang/en/moodle.php",
          "lib/moodlelib.php"
        ],
        "message": "MDL-63786 core: set $CFG->forceclean for logged in as sessions\n\nTurn on the forceclean config setting when a user is logged in as a\ndifferent user. This is a precautionary measure, which forces all\nuser submitted content to be cleaned of JavaScript before rendering\nit to the logged in as user.",
        "before_after_code_files": [
          "course/loginas.php||course/loginas.php",
          "lang/en/moodle.php||lang/en/moodle.php",
          "lib/moodlelib.php||lib/moodlelib.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "course/loginas.php||course/loginas.php",
            "lang/en/moodle.php||lang/en/moodle.php",
            "lib/moodlelib.php||lib/moodlelib.php"
          ],
          "candidate": [
            "course/loginas.php||course/loginas.php",
            "lang/en/moodle.php||lang/en/moodle.php",
            "lib/moodlelib.php||lib/moodlelib.php"
          ]
        }
      },
      "candidate_diff": {
        "course/loginas.php||course/loginas.php": [
          "File: course/loginas.php -> course/loginas.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "81: \\core\\session\\manager::loginas($userid, $context);",
          "82: $newfullname = fullname($USER, true);",
          "84: $strloginas    = get_string('loginas');",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "84: \\core\\notification::info(get_string('sessionforceclean', 'core'));",
          "",
          "---------------"
        ],
        "lang/en/moodle.php||lang/en/moodle.php": [
          "File: lang/en/moodle.php -> lang/en/moodle.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1799: $string['separateandconnectedinfo'] = 'The scale based on the theory of separate and connected knowing. This theory describes two different ways that we can evaluate and learn about the things we see and hear.<ul><li><strong>Separate knowers</strong> remain as objective as possible without including feelings and emotions. In a discussion with other people, they like to defend their own ideas, using logic to find holes in opponent\\'s ideas.</li><li><strong>Connected knowers</strong> are more sensitive to other people. They are skilled at empathy and tend to listen and ask questions until they feel they can connect and \"understand things from their point of view\". They learn by trying to share the experiences that led to the knowledge they find in other people.</li></ul>';",
          "1800: $string['servererror'] = 'An error occurred whilst communicating with the server';",
          "1801: $string['serverlocaltime'] = 'Server\\'s local time';",
          "1802: $string['setcategorytheme'] = 'Set category theme';",
          "1803: $string['setpassword'] = 'Set password';",
          "1804: $string['setpasswordinstructions'] = 'Please enter your new password below, then save changes.';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1802: $string['sessionforceclean'] = 'As a security precaution, user generated scripts have been disabled within this session';",
          "",
          "---------------"
        ],
        "lib/moodlelib.php||lib/moodlelib.php": [
          "File: lib/moodlelib.php -> lib/moodlelib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "2694:     sesskey();",
          "2697:     if (is_siteadmin() && !($cm && $cm->deletioninprogress)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2696:     if (\\core\\session\\manager::is_loggedinas()) {",
          "2700:         $CFG->forceclean = true;",
          "2701:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}