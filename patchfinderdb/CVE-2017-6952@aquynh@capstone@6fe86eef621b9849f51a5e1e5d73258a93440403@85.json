{
  "cve_id": "CVE-2017-6952",
  "cve_desc": "Integer overflow in the cs_winkernel_malloc function in winkernel_mm.c in Capstone 3.0.4 and earlier allows attackers to cause a denial of service (heap-based buffer overflow in a kernel driver) or possibly have unspecified other impact via a large value.",
  "repo": "aquynh/capstone",
  "patch_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
  "patch_info": {
    "commit_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
    "repo": "aquynh/capstone",
    "commit_url": "https://github.com/aquynh/capstone/commit/6fe86eef621b9849f51a5e1e5d73258a93440403",
    "files": [
      "windows/winkernel_mm.c"
    ],
    "message": "provide a validity check to prevent against Integer overflow conditions (#870)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.",
    "before_after_code_files": [
      "windows/winkernel_mm.c||windows/winkernel_mm.c"
    ]
  },
  "patch_diff": {
    "windows/winkernel_mm.c||windows/winkernel_mm.c": [
      "File: windows/winkernel_mm.c -> windows/winkernel_mm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: #include \"winkernel_mm.h\"",
      "5: #include <ntddk.h>",
      "8: static const ULONG CS_WINKERNEL_POOL_TAG = 'kwsC';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "6: #include <Ntintsafe.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "35: #pragma prefast(suppress : 30030)  // Allocating executable POOL_TYPE memory",
      "38:  if (!block) {",
      "39:   return NULL;",
      "40:  }",
      "",
      "[Removed Lines]",
      "36:  CS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "37:    NonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);",
      "",
      "[Added Lines]",
      "37:  size_t number_of_bytes = 0;",
      "38:  CS_WINKERNEL_MEMBLOCK *block = NULL;",
      "42:  if (!NT_SUCCESS(RtlSizeTAdd(size, sizeof(CS_WINKERNEL_MEMBLOCK), &number_of_bytes))) {",
      "43:   return NULL;",
      "44:  }",
      "45:  block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "46:    NonPagedPool, number_of_bytes, CS_WINKERNEL_POOL_TAG);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0e407ea48ffd6f2dfd83b627712469193f3a8394",
      "candidate_info": {
        "commit_hash": "0e407ea48ffd6f2dfd83b627712469193f3a8394",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/0e407ea48ffd6f2dfd83b627712469193f3a8394",
        "files": [
          "bindings/python/test_basic.py",
          "bindings/python/test_detail.py",
          "bindings/python/test_lite.py"
        ],
        "message": "Add m68k to the general Python tests.",
        "before_after_code_files": [
          "bindings/python/test_basic.py||bindings/python/test_basic.py",
          "bindings/python/test_detail.py||bindings/python/test_detail.py",
          "bindings/python/test_lite.py||bindings/python/test_lite.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "bindings/python/test_basic.py||bindings/python/test_basic.py": [
          "File: bindings/python/test_basic.py -> bindings/python/test_basic.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: SPARCV9_CODE = b\"\\x81\\xa8\\x0a\\x24\\x89\\xa0\\x10\\x20\\x89\\xa0\\x1a\\x60\\x89\\xa0\\x00\\xe0\"",
          "32: SYSZ_CODE = b\"\\xed\\x00\\x00\\x00\\x00\\x1a\\x5a\\x0f\\x1f\\xff\\xc2\\x09\\x80\\x00\\x00\\x00\\x07\\xf7\\xeb\\x2a\\xff\\xff\\x7f\\x57\\xe3\\x01\\xff\\xff\\x7f\\x57\\xeb\\x00\\xf0\\x00\\x00\\x24\\xb2\\x4f\\x00\\x78\"",
          "33: XCORE_CODE = b\"\\xfe\\x0f\\xfe\\x17\\x13\\x17\\xc6\\xfe\\xec\\x17\\x97\\xf8\\xec\\x4f\\x1f\\xfd\\xec\\x37\\x07\\xf2\\x45\\x5b\\xf9\\xfa\\x02\\x06\\x1b\\x10\"",
          "35: all_tests = (",
          "36:         (CS_ARCH_X86, CS_MODE_16, X86_CODE16, \"X86 16bit (Intel syntax)\", None),",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "34: M68K_CODE = b\"\\xd4\\x40\\x87\\x5a\\x4e\\x71\\x02\\xb4\\xc0\\xde\\xc0\\xde\\x5c\\x00\\x1d\\x80\\x71\\x12\\x01\\x23\\xf2\\x3c\\x44\\x22\\x40\\x49\\x0e\\x56\\x54\\xc5\\xf2\\x3c\\x44\\x00\\x44\\x7a\\x00\\x00\\xf2\\x00\\x0a\\x28\\x4E\\xB9\\x00\\x00\\x00\\x12\\x4E\\x75\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "56:         (CS_ARCH_SPARC, CS_MODE_BIG_ENDIAN + CS_MODE_V9, SPARCV9_CODE, \"SparcV9\", None),",
          "57:         (CS_ARCH_SYSZ, 0, SYSZ_CODE, \"SystemZ\", None),",
          "58:         (CS_ARCH_XCORE, 0, XCORE_CODE, \"XCore\", None),",
          "59: )",
          "61: # ## Test cs_disasm_quick()",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "60:         (CS_ARCH_M68K, CS_MODE_BIG_ENDIAN | CS_MODE_M68K_040, M68K_CODE, \"M68K (68040)\", None),",
          "",
          "---------------"
        ],
        "bindings/python/test_detail.py||bindings/python/test_detail.py": [
          "File: bindings/python/test_detail.py -> bindings/python/test_detail.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: SPARCV9_CODE = b\"\\x81\\xa8\\x0a\\x24\\x89\\xa0\\x10\\x20\\x89\\xa0\\x1a\\x60\\x89\\xa0\\x00\\xe0\"",
          "26: SYSZ_CODE = b\"\\xed\\x00\\x00\\x00\\x00\\x1a\\x5a\\x0f\\x1f\\xff\\xc2\\x09\\x80\\x00\\x00\\x00\\x07\\xf7\\xeb\\x2a\\xff\\xff\\x7f\\x57\\xe3\\x01\\xff\\xff\\x7f\\x57\\xeb\\x00\\xf0\\x00\\x00\\x24\\xb2\\x4f\\x00\\x78\"",
          "27: XCORE_CODE = b\"\\xfe\\x0f\\xfe\\x17\\x13\\x17\\xc6\\xfe\\xec\\x17\\x97\\xf8\\xec\\x4f\\x1f\\xfd\\xec\\x37\\x07\\xf2\\x45\\x5b\\xf9\\xfa\\x02\\x06\\x1b\\x10\"",
          "29: all_tests = (",
          "30:         (CS_ARCH_X86, CS_MODE_16, X86_CODE16, \"X86 16bit (Intel syntax)\", None),",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "28: M68K_CODE = b\"\\xd4\\x40\\x87\\x5a\\x4e\\x71\\x02\\xb4\\xc0\\xde\\xc0\\xde\\x5c\\x00\\x1d\\x80\\x71\\x12\\x01\\x23\\xf2\\x3c\\x44\\x22\\x40\\x49\\x0e\\x56\\x54\\xc5\\xf2\\x3c\\x44\\x00\\x44\\x7a\\x00\\x00\\xf2\\x00\\x0a\\x28\\x4E\\xB9\\x00\\x00\\x00\\x12\\x4E\\x75\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "48:         (CS_ARCH_SPARC, CS_MODE_BIG_ENDIAN + CS_MODE_V9, SPARCV9_CODE, \"SparcV9\", None),",
          "49:         (CS_ARCH_SYSZ, 0, SYSZ_CODE, \"SystemZ\", None),",
          "50:         (CS_ARCH_XCORE, 0, XCORE_CODE, \"XCore\", None),",
          "51: )",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:         (CS_ARCH_M68K, CS_MODE_BIG_ENDIAN | CS_MODE_M68K_040, M68K_CODE, \"M68K (68040)\", None),",
          "",
          "---------------"
        ],
        "bindings/python/test_lite.py||bindings/python/test_lite.py": [
          "File: bindings/python/test_lite.py -> bindings/python/test_lite.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: SPARCV9_CODE = b\"\\x81\\xa8\\x0a\\x24\\x89\\xa0\\x10\\x20\\x89\\xa0\\x1a\\x60\\x89\\xa0\\x00\\xe0\"",
          "27: SYSZ_CODE = b\"\\xed\\x00\\x00\\x00\\x00\\x1a\\x5a\\x0f\\x1f\\xff\\xc2\\x09\\x80\\x00\\x00\\x00\\x07\\xf7\\xeb\\x2a\\xff\\xff\\x7f\\x57\\xe3\\x01\\xff\\xff\\x7f\\x57\\xeb\\x00\\xf0\\x00\\x00\\x24\\xb2\\x4f\\x00\\x78\"",
          "28: XCORE_CODE = b\"\\xfe\\x0f\\xfe\\x17\\x13\\x17\\xc6\\xfe\\xec\\x17\\x97\\xf8\\xec\\x4f\\x1f\\xfd\\xec\\x37\\x07\\xf2\\x45\\x5b\\xf9\\xfa\\x02\\x06\\x1b\\x10\"",
          "30: all_tests = (",
          "31:         (CS_ARCH_X86, CS_MODE_16, X86_CODE16, \"X86 16bit (Intel syntax)\", None),",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29: M68K_CODE = b\"\\xd4\\x40\\x87\\x5a\\x4e\\x71\\x02\\xb4\\xc0\\xde\\xc0\\xde\\x5c\\x00\\x1d\\x80\\x71\\x12\\x01\\x23\\xf2\\x3c\\x44\\x22\\x40\\x49\\x0e\\x56\\x54\\xc5\\xf2\\x3c\\x44\\x00\\x44\\x7a\\x00\\x00\\xf2\\x00\\x0a\\x28\\x4E\\xB9\\x00\\x00\\x00\\x12\\x4E\\x75\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "51:         (CS_ARCH_SPARC, CS_MODE_BIG_ENDIAN + CS_MODE_V9, SPARCV9_CODE, \"SparcV9\", None),",
          "52:         (CS_ARCH_SYSZ, 0, SYSZ_CODE, \"SystemZ\", None),",
          "53:         (CS_ARCH_XCORE, 0, XCORE_CODE, \"XCore\", None),",
          "54:         )",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "55:         (CS_ARCH_M68K, CS_MODE_BIG_ENDIAN | CS_MODE_M68K_040, M68K_CODE, \"M68K (68040)\", None),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ffbb083f31d07ff2c485252c74dba13ee5ddef19",
      "candidate_info": {
        "commit_hash": "ffbb083f31d07ff2c485252c74dba13ee5ddef19",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/ffbb083f31d07ff2c485252c74dba13ee5ddef19",
        "files": [
          "bindings/java/capstone/Ppc_const.java",
          "bindings/ocaml/ppc_const.ml",
          "bindings/python/capstone/ppc_const.py"
        ],
        "message": "bindings: update some consts",
        "before_after_code_files": [
          "bindings/javcapstone/Ppc_const.java||bindings/java/capstone/Ppc_const.java",
          "bindings/ocaml/ppc_const.ml||bindings/ocaml/ppc_const.ml",
          "bindings/python/capstone/ppc_const.py||bindings/python/capstone/ppc_const.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "bindings/javcapstone/Ppc_const.java||bindings/java/capstone/Ppc_const.java": [
          "File: bindings/javcapstone/Ppc_const.java -> bindings/java/capstone/Ppc_const.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "210:  public static final int PPC_OP_INVALID = 0;",
          "211:  public static final int PPC_OP_REG = 1;",
          "212:  public static final int PPC_OP_IMM = 2;",
          "213:  public static final int PPC_OP_MEM = 3;",
          "214:  public static final int PPC_OP_CRX = 64;",
          "",
          "---------------"
        ],
        "bindings/ocaml/ppc_const.ml||bindings/ocaml/ppc_const.ml": [
          "File: bindings/ocaml/ppc_const.ml -> bindings/ocaml/ppc_const.ml",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: let _PPC_BH_PLUS = 1;;",
          "21: let _PPC_BH_MINUS = 2;;",
          "31: (* PPC registers *)",
          "33: let _PPC_REG_INVALID = 0;;",
          "",
          "[Removed Lines]",
          "23: (* Operand type for instruction's operands *)",
          "25: let _PPC_OP_INVALID = 0;;",
          "26: let _PPC_OP_REG = 1;;",
          "27: let _PPC_OP_IMM = 2;;",
          "28: let _PPC_OP_MEM = 3;;",
          "29: let _PPC_OP_CRX = 64;;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "210: let _PPC_REG_CR1EQ = 177;;",
          "211: let _PPC_REG_ENDING = 178;;",
          "213: (* PPC instruction *)",
          "215: let _PPC_INS_INVALID = 0;;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "205: (* Operand type for instruction's operands *)",
          "207: let _PPC_OP_INVALID = 0;;",
          "208: let _PPC_OP_REG = 1;;",
          "209: let _PPC_OP_IMM = 2;;",
          "210: let _PPC_OP_MEM = 3;;",
          "211: let _PPC_OP_CRX = 64;;",
          "",
          "---------------"
        ],
        "bindings/python/capstone/ppc_const.py||bindings/python/capstone/ppc_const.py": [
          "File: bindings/python/capstone/ppc_const.py -> bindings/python/capstone/ppc_const.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "20: PPC_BH_PLUS = 1",
          "21: PPC_BH_MINUS = 2",
          "31: # PPC registers",
          "33: PPC_REG_INVALID = 0",
          "",
          "[Removed Lines]",
          "23: # Operand type for instruction's operands",
          "25: PPC_OP_INVALID = 0",
          "26: PPC_OP_REG = 1",
          "27: PPC_OP_IMM = 2",
          "28: PPC_OP_MEM = 3",
          "29: PPC_OP_CRX = 64",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "210: PPC_REG_CR1EQ = 177",
          "211: PPC_REG_ENDING = 178",
          "213: # PPC instruction",
          "215: PPC_INS_INVALID = 0",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "205: # Operand type for instruction's operands",
          "207: PPC_OP_INVALID = 0",
          "208: PPC_OP_REG = 1",
          "209: PPC_OP_IMM = 2",
          "210: PPC_OP_MEM = 3",
          "211: PPC_OP_CRX = 64",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c7cf97f8a8f73e3ad4559364e6ec773b90c77221",
      "candidate_info": {
        "commit_hash": "c7cf97f8a8f73e3ad4559364e6ec773b90c77221",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/c7cf97f8a8f73e3ad4559364e6ec773b90c77221",
        "files": [
          "contrib/cs_driver/README",
          "contrib/cs_driver/cs_driver.sln",
          "contrib/cs_driver/cs_driver/cs_driver.c",
          "contrib/cs_driver/cs_driver/cs_driver.vcxproj",
          "contrib/cs_driver/cs_driver/cs_driver.vcxproj.filters"
        ],
        "message": "add a sample project for a windows driver",
        "before_after_code_files": [
          "contrib/cs_driver/cs_driver.sln||contrics_driver/cs_driver.sln",
          "contrib/cs_driver/cs_driver/cs_driver.c||contrics_driver/cs_driver/cs_driver.c",
          "contrib/cs_driver/cs_driver/cs_driver.vcxproj||contrics_driver/cs_driver/cs_driver.vcxproj",
          "contrib/cs_driver/cs_driver/cs_driver.vcxproj.filters||contrics_driver/cs_driver/cs_driver.vcxproj.filters"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "contrib/cs_driver/cs_driver.sln||contrics_driver/cs_driver.sln": [
          "File: contrib/cs_driver/cs_driver.sln -> contrics_driver/cs_driver.sln",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "contrib/cs_driver/cs_driver/cs_driver.c||contrics_driver/cs_driver/cs_driver.c": [
          "File: contrib/cs_driver/cs_driver/cs_driver.c -> contrics_driver/cs_driver/cs_driver.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "contrib/cs_driver/cs_driver/cs_driver.vcxproj||contrics_driver/cs_driver/cs_driver.vcxproj": [
          "File: contrib/cs_driver/cs_driver/cs_driver.vcxproj -> contrics_driver/cs_driver/cs_driver.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "contrib/cs_driver/cs_driver/cs_driver.vcxproj.filters||contrics_driver/cs_driver/cs_driver.vcxproj.filters": [
          "File: contrib/cs_driver/cs_driver/cs_driver.vcxproj.filters -> contrics_driver/cs_driver/cs_driver.vcxproj.filters",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "bde76ebb4089072d013c0393c1c5e986c53af585",
      "candidate_info": {
        "commit_hash": "bde76ebb4089072d013c0393c1c5e986c53af585",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/bde76ebb4089072d013c0393c1c5e986c53af585",
        "files": [
          "bindings/java/capstone/X86_const.java",
          "bindings/ocaml/x86_const.ml",
          "bindings/python/capstone/x86_const.py",
          "include/capstone/x86.h"
        ],
        "message": "x86: fix FPU flags so const_generator.py can generate proper Python symbols",
        "before_after_code_files": [
          "bindings/javcapstone/X86_const.java||bindings/java/capstone/X86_const.java",
          "bindings/ocaml/x86_const.ml||bindings/ocaml/x86_const.ml",
          "bindings/python/capstone/x86_const.py||bindings/python/capstone/x86_const.py",
          "include/capstone/x86.h||include/capstone/x86.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "bindings/javcapstone/X86_const.java||bindings/java/capstone/X86_const.java": [
          "File: bindings/javcapstone/X86_const.java -> bindings/java/capstone/X86_const.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "312:  public static final int X86_FPU_FLAGS_MODIFY_C0 = 1<<0;",
          "313:  public static final int X86_FPU_FLAGS_MODIFY_C1 = 1<<1;",
          "314:  public static final int X86_FPU_FLAGS_MODIFY_C2 = 1<<2;",
          "315:  public static final int X86_FPU_FLAGS_MODIFY_C3 = 1<<3;",
          "316:  public static final int X86_FPU_FLAGS_RESET_C0 = 1<<4;",
          "317:  public static final int X86_FPU_FLAGS_RESET_C1 = 1<<5;",
          "318:  public static final int X86_FPU_FLAGS_RESET_C2 = 1<<6;",
          "319:  public static final int X86_FPU_FLAGS_RESET_C3 = 1<<7;",
          "320:  public static final int X86_FPU_FLAGS_SET_C0 = 1<<8;",
          "321:  public static final int X86_FPU_FLAGS_SET_C1 = 1<<9;",
          "322:  public static final int X86_FPU_FLAGS_SET_C2 = 1<<10;",
          "323:  public static final int X86_FPU_FLAGS_SET_C3 = 1<<11;",
          "324:  public static final int X86_FPU_FLAGS_UNDEFINED_C0 = 1<<12;",
          "325:  public static final int X86_FPU_FLAGS_UNDEFINED_C1 = 1<<13;",
          "326:  public static final int X86_FPU_FLAGS_UNDEFINED_C2 = 1<<14;",
          "327:  public static final int X86_FPU_FLAGS_UNDEFINED_C3 = 1<<15;",
          "328:  public static final int X86_FPU_FLAGS_TEST_C0 = 1<<16;",
          "329:  public static final int X86_FPU_FLAGS_TEST_C1 = 1<<17;",
          "330:  public static final int X86_FPU_FLAGS_TEST_C2 = 1<<18;",
          "331:  public static final int X86_FPU_FLAGS_TEST_C3 = 1<<19;",
          "",
          "---------------"
        ],
        "bindings/ocaml/x86_const.ml||bindings/ocaml/x86_const.ml": [
          "File: bindings/ocaml/x86_const.ml -> bindings/ocaml/x86_const.ml",
          "--- Hunk 1 ---",
          "[Context before]",
          "306: let _X86_EFLAGS_SET_PF = 1 lsl 56;;",
          "307: let _X86_EFLAGS_RESET_0F = 1 lsl 57;;",
          "308: let _X86_EFLAGS_RESET_AC = 1 lsl 58;;",
          "330: (* Operand type for instruction's operands *)",
          "",
          "[Removed Lines]",
          "309: let _X86_FPU_FLAGS_MODIFY_C0 = (1ULL lsl 0);;",
          "310: let _X86_FPU_FLAGS_MODIFY_C1 = (1ULL lsl 1);;",
          "311: let _X86_FPU_FLAGS_MODIFY_C2 = (1ULL lsl 2);;",
          "312: let _X86_FPU_FLAGS_MODIFY_C3 = (1ULL lsl 3);;",
          "313: let _X86_FPU_FLAGS_RESET_C0 = (1ULL lsl 4);;",
          "314: let _X86_FPU_FLAGS_RESET_C1 = (1ULL lsl 5);;",
          "315: let _X86_FPU_FLAGS_RESET_C2 = (1ULL lsl 6);;",
          "316: let _X86_FPU_FLAGS_RESET_C3 = (1ULL lsl 7);;",
          "317: let _X86_FPU_FLAGS_SET_C0 = (1ULL lsl 8);;",
          "318: let _X86_FPU_FLAGS_SET_C1 = (1ULL lsl 9);;",
          "319: let _X86_FPU_FLAGS_SET_C2 = (1ULL lsl 10);;",
          "320: let _X86_FPU_FLAGS_SET_C3 = (1ULL lsl 11);;",
          "321: let _X86_FPU_FLAGS_UNDEFINED_C0 = (1ULL lsl 12);;",
          "322: let _X86_FPU_FLAGS_UNDEFINED_C1 = (1ULL lsl 13);;",
          "323: let _X86_FPU_FLAGS_UNDEFINED_C2 = (1ULL lsl 14);;",
          "324: let _X86_FPU_FLAGS_UNDEFINED_C3 = (1ULL lsl 15);;",
          "325: let _X86_FPU_FLAGS_TEST_C0 = (1ULL lsl 16);;",
          "326: let _X86_FPU_FLAGS_TEST_C1 = (1ULL lsl 17);;",
          "327: let _X86_FPU_FLAGS_TEST_C2 = (1ULL lsl 18);;",
          "328: let _X86_FPU_FLAGS_TEST_C3 = (1ULL lsl 19);;",
          "",
          "[Added Lines]",
          "309: let _X86_FPU_FLAGS_MODIFY_C0 = 1 lsl 0;;",
          "310: let _X86_FPU_FLAGS_MODIFY_C1 = 1 lsl 1;;",
          "311: let _X86_FPU_FLAGS_MODIFY_C2 = 1 lsl 2;;",
          "312: let _X86_FPU_FLAGS_MODIFY_C3 = 1 lsl 3;;",
          "313: let _X86_FPU_FLAGS_RESET_C0 = 1 lsl 4;;",
          "314: let _X86_FPU_FLAGS_RESET_C1 = 1 lsl 5;;",
          "315: let _X86_FPU_FLAGS_RESET_C2 = 1 lsl 6;;",
          "316: let _X86_FPU_FLAGS_RESET_C3 = 1 lsl 7;;",
          "317: let _X86_FPU_FLAGS_SET_C0 = 1 lsl 8;;",
          "318: let _X86_FPU_FLAGS_SET_C1 = 1 lsl 9;;",
          "319: let _X86_FPU_FLAGS_SET_C2 = 1 lsl 10;;",
          "320: let _X86_FPU_FLAGS_SET_C3 = 1 lsl 11;;",
          "321: let _X86_FPU_FLAGS_UNDEFINED_C0 = 1 lsl 12;;",
          "322: let _X86_FPU_FLAGS_UNDEFINED_C1 = 1 lsl 13;;",
          "323: let _X86_FPU_FLAGS_UNDEFINED_C2 = 1 lsl 14;;",
          "324: let _X86_FPU_FLAGS_UNDEFINED_C3 = 1 lsl 15;;",
          "325: let _X86_FPU_FLAGS_TEST_C0 = 1 lsl 16;;",
          "326: let _X86_FPU_FLAGS_TEST_C1 = 1 lsl 17;;",
          "327: let _X86_FPU_FLAGS_TEST_C2 = 1 lsl 18;;",
          "328: let _X86_FPU_FLAGS_TEST_C3 = 1 lsl 19;;",
          "",
          "---------------"
        ],
        "bindings/python/capstone/x86_const.py||bindings/python/capstone/x86_const.py": [
          "File: bindings/python/capstone/x86_const.py -> bindings/python/capstone/x86_const.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "306: X86_EFLAGS_SET_PF = 1<<56",
          "307: X86_EFLAGS_RESET_0F = 1<<57",
          "308: X86_EFLAGS_RESET_AC = 1<<58",
          "330: # Operand type for instruction's operands",
          "",
          "[Removed Lines]",
          "309: X86_FPU_FLAGS_MODIFY_C0 = (1ULL<<0)",
          "310: X86_FPU_FLAGS_MODIFY_C1 = (1ULL<<1)",
          "311: X86_FPU_FLAGS_MODIFY_C2 = (1ULL<<2)",
          "312: X86_FPU_FLAGS_MODIFY_C3 = (1ULL<<3)",
          "313: X86_FPU_FLAGS_RESET_C0 = (1ULL<<4)",
          "314: X86_FPU_FLAGS_RESET_C1 = (1ULL<<5)",
          "315: X86_FPU_FLAGS_RESET_C2 = (1ULL<<6)",
          "316: X86_FPU_FLAGS_RESET_C3 = (1ULL<<7)",
          "317: X86_FPU_FLAGS_SET_C0 = (1ULL<<8)",
          "318: X86_FPU_FLAGS_SET_C1 = (1ULL<<9)",
          "319: X86_FPU_FLAGS_SET_C2 = (1ULL<<10)",
          "320: X86_FPU_FLAGS_SET_C3 = (1ULL<<11)",
          "321: X86_FPU_FLAGS_UNDEFINED_C0 = (1ULL<<12)",
          "322: X86_FPU_FLAGS_UNDEFINED_C1 = (1ULL<<13)",
          "323: X86_FPU_FLAGS_UNDEFINED_C2 = (1ULL<<14)",
          "324: X86_FPU_FLAGS_UNDEFINED_C3 = (1ULL<<15)",
          "325: X86_FPU_FLAGS_TEST_C0 = (1ULL<<16)",
          "326: X86_FPU_FLAGS_TEST_C1 = (1ULL<<17)",
          "327: X86_FPU_FLAGS_TEST_C2 = (1ULL<<18)",
          "328: X86_FPU_FLAGS_TEST_C3 = (1ULL<<19)",
          "",
          "[Added Lines]",
          "309: X86_FPU_FLAGS_MODIFY_C0 = 1<<0",
          "310: X86_FPU_FLAGS_MODIFY_C1 = 1<<1",
          "311: X86_FPU_FLAGS_MODIFY_C2 = 1<<2",
          "312: X86_FPU_FLAGS_MODIFY_C3 = 1<<3",
          "313: X86_FPU_FLAGS_RESET_C0 = 1<<4",
          "314: X86_FPU_FLAGS_RESET_C1 = 1<<5",
          "315: X86_FPU_FLAGS_RESET_C2 = 1<<6",
          "316: X86_FPU_FLAGS_RESET_C3 = 1<<7",
          "317: X86_FPU_FLAGS_SET_C0 = 1<<8",
          "318: X86_FPU_FLAGS_SET_C1 = 1<<9",
          "319: X86_FPU_FLAGS_SET_C2 = 1<<10",
          "320: X86_FPU_FLAGS_SET_C3 = 1<<11",
          "321: X86_FPU_FLAGS_UNDEFINED_C0 = 1<<12",
          "322: X86_FPU_FLAGS_UNDEFINED_C1 = 1<<13",
          "323: X86_FPU_FLAGS_UNDEFINED_C2 = 1<<14",
          "324: X86_FPU_FLAGS_UNDEFINED_C3 = 1<<15",
          "325: X86_FPU_FLAGS_TEST_C0 = 1<<16",
          "326: X86_FPU_FLAGS_TEST_C1 = 1<<17",
          "327: X86_FPU_FLAGS_TEST_C2 = 1<<18",
          "328: X86_FPU_FLAGS_TEST_C3 = 1<<19",
          "",
          "---------------"
        ],
        "include/capstone/x86.h||include/capstone/x86.h": [
          "File: include/capstone/x86.h -> include/capstone/x86.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "132: #define X86_EFLAGS_RESET_0F (1ULL << 57)",
          "133: #define X86_EFLAGS_RESET_AC (1ULL << 58)",
          "",
          "[Removed Lines]",
          "135: #define X86_FPU_FLAGS_MODIFY_C0 (1ULL<<0)",
          "136: #define X86_FPU_FLAGS_MODIFY_C1 (1ULL<<1)",
          "137: #define X86_FPU_FLAGS_MODIFY_C2 (1ULL<<2)",
          "138: #define X86_FPU_FLAGS_MODIFY_C3 (1ULL<<3)",
          "139: #define X86_FPU_FLAGS_RESET_C0 (1ULL<<4)",
          "140: #define X86_FPU_FLAGS_RESET_C1 (1ULL<<5)",
          "141: #define X86_FPU_FLAGS_RESET_C2 (1ULL<<6)",
          "142: #define X86_FPU_FLAGS_RESET_C3 (1ULL<<7)",
          "143: #define X86_FPU_FLAGS_SET_C0 (1ULL<<8)",
          "144: #define X86_FPU_FLAGS_SET_C1 (1ULL<<9)",
          "145: #define X86_FPU_FLAGS_SET_C2 (1ULL<<10)",
          "146: #define X86_FPU_FLAGS_SET_C3 (1ULL<<11)",
          "147: #define X86_FPU_FLAGS_UNDEFINED_C0 (1ULL<<12)",
          "148: #define X86_FPU_FLAGS_UNDEFINED_C1 (1ULL<<13)",
          "149: #define X86_FPU_FLAGS_UNDEFINED_C2 (1ULL<<14)",
          "150: #define X86_FPU_FLAGS_UNDEFINED_C3 (1ULL<<15)",
          "151: #define X86_FPU_FLAGS_TEST_C0 (1ULL<<16)",
          "152: #define X86_FPU_FLAGS_TEST_C1 (1ULL<<17)",
          "153: #define X86_FPU_FLAGS_TEST_C2 (1ULL<<18)",
          "154: #define X86_FPU_FLAGS_TEST_C3 (1ULL<<19)",
          "",
          "[Added Lines]",
          "135: #define X86_FPU_FLAGS_MODIFY_C0 (1ULL << 0)",
          "136: #define X86_FPU_FLAGS_MODIFY_C1 (1ULL << 1)",
          "137: #define X86_FPU_FLAGS_MODIFY_C2 (1ULL << 2)",
          "138: #define X86_FPU_FLAGS_MODIFY_C3 (1ULL << 3)",
          "139: #define X86_FPU_FLAGS_RESET_C0 (1ULL << 4)",
          "140: #define X86_FPU_FLAGS_RESET_C1 (1ULL << 5)",
          "141: #define X86_FPU_FLAGS_RESET_C2 (1ULL << 6)",
          "142: #define X86_FPU_FLAGS_RESET_C3 (1ULL << 7)",
          "143: #define X86_FPU_FLAGS_SET_C0 (1ULL << 8)",
          "144: #define X86_FPU_FLAGS_SET_C1 (1ULL << 9)",
          "145: #define X86_FPU_FLAGS_SET_C2 (1ULL << 10)",
          "146: #define X86_FPU_FLAGS_SET_C3 (1ULL << 11)",
          "147: #define X86_FPU_FLAGS_UNDEFINED_C0 (1ULL << 12)",
          "148: #define X86_FPU_FLAGS_UNDEFINED_C1 (1ULL << 13)",
          "149: #define X86_FPU_FLAGS_UNDEFINED_C2 (1ULL << 14)",
          "150: #define X86_FPU_FLAGS_UNDEFINED_C3 (1ULL << 15)",
          "151: #define X86_FPU_FLAGS_TEST_C0 (1ULL << 16)",
          "152: #define X86_FPU_FLAGS_TEST_C1 (1ULL << 17)",
          "153: #define X86_FPU_FLAGS_TEST_C2 (1ULL << 18)",
          "154: #define X86_FPU_FLAGS_TEST_C3 (1ULL << 19)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b4bde0cda19d9c43bf6ae5887528049cb37ae253",
      "candidate_info": {
        "commit_hash": "b4bde0cda19d9c43bf6ae5887528049cb37ae253",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/b4bde0cda19d9c43bf6ae5887528049cb37ae253",
        "files": [
          "include/capstone.h"
        ],
        "message": "Removed CAPSTONE_CDECL",
        "before_after_code_files": [
          "include/capstone.h||include/capstone.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/capstone.h||include/capstone.h": [
          "File: include/capstone.h -> include/capstone.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "22: #ifdef _MSC_VER",
          "23: #pragma warning(disable:4201)",
          "24: #pragma warning(disable:4100)",
          "27: #ifdef CAPSTONE_SHARED",
          "28: #define CAPSTONE_EXPORT __declspec(dllexport)",
          "29: #else    // defined(CAPSTONE_STATIC)",
          "",
          "[Removed Lines]",
          "25: #define CAPSTONE_API __stdcall",
          "26: #define CAPSTONE_CDECL __cdecl",
          "",
          "[Added Lines]",
          "25: #define CAPSTONE_API __cdecl",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "31: #endif",
          "32: #else",
          "33: #define CAPSTONE_API",
          "35: #ifdef __GNUC__",
          "36: #define CAPSTONE_EXPORT __attribute__((visibility(\"default\")))",
          "37: #else",
          "",
          "[Removed Lines]",
          "34: #define CAPSTONE_CDECL",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "103:  CS_MODE_MIPS64 = CS_MODE_64, // Mips64 ISA (Mips)",
          "104: } cs_mode;",
          "",
          "[Removed Lines]",
          "106: typedef void* (CAPSTONE_CDECL*cs_malloc_t)(size_t size);",
          "107: typedef void* (CAPSTONE_CDECL*cs_calloc_t)(size_t nmemb, size_t size);",
          "108: typedef void* (CAPSTONE_CDECL*cs_realloc_t)(void *ptr, size_t size);",
          "109: typedef void (CAPSTONE_CDECL*cs_free_t)(void *ptr);",
          "110: typedef int (CAPSTONE_CDECL*cs_vsnprintf_t)(char *str, size_t size, const char *format, va_list ap);",
          "",
          "[Added Lines]",
          "104: typedef void* (CAPSTONE_API*cs_malloc_t)(size_t size);",
          "105: typedef void* (CAPSTONE_API*cs_calloc_t)(size_t nmemb, size_t size);",
          "106: typedef void* (CAPSTONE_API*cs_realloc_t)(void *ptr, size_t size);",
          "107: typedef void (CAPSTONE_API*cs_free_t)(void *ptr);",
          "108: typedef int (CAPSTONE_API*cs_vsnprintf_t)(char *str, size_t size, const char *format, va_list ap);",
          "",
          "---------------"
        ]
      }
    }
  ]
}