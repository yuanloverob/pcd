{
  "cve_id": "CVE-2015-7551",
  "cve_desc": "The Fiddle::Handle implementation in ext/fiddle/handle.c in Ruby before 2.0.0-p648, 2.1 before 2.1.8, and 2.2 before 2.2.4, as distributed in Apple OS X before 10.11.4 and other products, mishandles tainting, which allows context-dependent attackers to execute arbitrary code or cause a denial of service (application crash) via a crafted string, related to the DL module and the libffi library.  NOTE: this vulnerability exists because of a CVE-2009-5147 regression.",
  "repo": "ruby/ruby",
  "patch_hash": "339e11a7f178312d937b7c95dd3115ce7236597a",
  "patch_info": {
    "commit_hash": "339e11a7f178312d937b7c95dd3115ce7236597a",
    "repo": "ruby/ruby",
    "commit_url": "https://github.com/ruby/ruby/commit/339e11a7f178312d937b7c95dd3115ce7236597a",
    "files": [
      "ChangeLog",
      "ext/fiddle/handle.c",
      "test/fiddle/test_handle.rb",
      "version.h"
    ],
    "message": "merge revision(s): 53153 and 23405@ruby_1_9_1\n\n\t* ext/fiddle/handle.c: check tainted string arguments.\n\t  Patch provided by tenderlove and nobu.\n\n\t* test/fiddle/test_handle.rb (class TestHandle): add test for above.\n\n\t* ext/dl/handle.c (rb_dlhandle_initialize): prohibits DL::dlopen\n\t  with a tainted name of library.\n\t  Patch by sheepman <sheepman AT sheepman.sakura.ne.jp>.\n\n\t* ext/dl/handle.c (rb_dlhandle_sym): ditto\n\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@53156 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
    "before_after_code_files": [
      "ext/fiddle/handle.c||ext/fiddle/handle.c",
      "test/fiddle/test_handle.rb||test/fiddle/test_handle.rb",
      "version.h||version.h"
    ]
  },
  "patch_diff": {
    "ext/fiddle/handle.c||ext/fiddle/handle.c": [
      "File: ext/fiddle/handle.c -> ext/fiddle/handle.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #include <ruby.h>",
      "2: #include <fiddle.h>",
      "4: VALUE rb_cHandle;",
      "6: struct dl_handle {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4: #define SafeStringValueCStr(v) (rb_check_safe_obj(rb_string_value(&v)), StringValueCStr(v))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "143:  cflag = RTLD_LAZY | RTLD_GLOBAL;",
      "144:  break;",
      "145:       case 1:",
      "147:  cflag = RTLD_LAZY | RTLD_GLOBAL;",
      "148:  break;",
      "149:       case 2:",
      "151:  cflag = NUM2INT(flag);",
      "152:  break;",
      "153:       default:",
      "",
      "[Removed Lines]",
      "146:  clib = NIL_P(lib) ? NULL : StringValuePtr(lib);",
      "150:  clib = NIL_P(lib) ? NULL : StringValuePtr(lib);",
      "",
      "[Added Lines]",
      "148:  clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);",
      "152:  clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "263:     return PTR2NUM(fiddle_handle);",
      "264: }",
      "",
      "[Removed Lines]",
      "266: static VALUE fiddle_handle_sym(void *handle, const char *symbol);",
      "",
      "[Added Lines]",
      "268: static VALUE fiddle_handle_sym(void *handle, VALUE symbol);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "282:  rb_raise(rb_eFiddleError, \"closed handle\");",
      "283:     }",
      "286: }",
      "288: #ifndef RTLD_NEXT",
      "",
      "[Removed Lines]",
      "285:     return fiddle_handle_sym(fiddle_handle->ptr, StringValueCStr(sym));",
      "",
      "[Added Lines]",
      "287:     return fiddle_handle_sym(fiddle_handle->ptr, sym);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "305: static VALUE",
      "306: rb_fiddle_handle_s_sym(VALUE self, VALUE sym)",
      "307: {",
      "309: }",
      "311: static VALUE",
      "313: {",
      "314: #if defined(HAVE_DLERROR)",
      "315:     const char *err;",
      "",
      "[Removed Lines]",
      "308:     return fiddle_handle_sym(RTLD_NEXT, StringValueCStr(sym));",
      "312: fiddle_handle_sym(void *handle, const char *name)",
      "",
      "[Added Lines]",
      "310:     return fiddle_handle_sym(RTLD_NEXT, sym);",
      "314: fiddle_handle_sym(void *handle, VALUE symbol)",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "318: # define CHECK_DLERROR",
      "319: #endif",
      "320:     void (*func)();",
      "322:     rb_secure(2);",
      "323: #ifdef HAVE_DLERROR",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "323:     const char *name = SafeStringValueCStr(symbol);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "367:     }",
      "368: #endif",
      "369:     if( !func ){",
      "371:     }",
      "373:     return PTR2NUM(func);",
      "",
      "[Removed Lines]",
      "370:  rb_raise(rb_eFiddleError, \"unknown symbol \\\"%s\\\"\", name);",
      "",
      "[Added Lines]",
      "373:  rb_raise(rb_eFiddleError, \"unknown symbol \\\"%\"PRIsVALUE\"\\\"\", symbol);",
      "",
      "---------------"
    ],
    "test/fiddle/test_handle.rb||test/fiddle/test_handle.rb": [
      "File: test/fiddle/test_handle.rb -> test/fiddle/test_handle.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "11:     include Test::Unit::Assertions",
      "13:     def test_to_i",
      "14:       handle = Fiddle::Handle.new(LIBC_SO)",
      "15:       assert_kind_of Integer, handle.to_i",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13:     def test_safe_handle_open",
      "14:       t = Thread.new do",
      "15:         $SAFE = 1",
      "16:         Fiddle::Handle.new(LIBC_SO.taint)",
      "17:       end",
      "18:       assert_raise(SecurityError) { t.value }",
      "19:     end",
      "21:     def test_safe_function_lookup",
      "22:       t = Thread.new do",
      "23:         h = Fiddle::Handle.new(LIBC_SO)",
      "24:         $SAFE = 1",
      "25:         h[\"qsort\".taint]",
      "26:       end",
      "27:       assert_raise(SecurityError) { t.value }",
      "28:     end",
      "",
      "---------------"
    ],
    "version.h||version.h": [
      "File: version.h -> version.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #define RUBY_VERSION \"2.1.8\"",
      "2: #define RUBY_RELEASE_DATE \"2015-12-16\"",
      "5: #define RUBY_RELEASE_YEAR 2015",
      "6: #define RUBY_RELEASE_MONTH 12",
      "",
      "[Removed Lines]",
      "3: #define RUBY_PATCHLEVEL 438",
      "",
      "[Added Lines]",
      "3: #define RUBY_PATCHLEVEL 439",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "2d5e2cc289b85b5df00ab32a171eb16e9055b7eb",
      "candidate_info": {
        "commit_hash": "2d5e2cc289b85b5df00ab32a171eb16e9055b7eb",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/2d5e2cc289b85b5df00ab32a171eb16e9055b7eb",
        "files": [
          "test/openssl/utils.rb",
          "version.h"
        ],
        "message": "* test/openssl/utils.rb (start_server): check nil.\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@54286 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "test/openssl/utils.rb||test/openssl/utils.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "test/openssl/utils.rb||test/openssl/utils.rb": [
          "File: test/openssl/utils.rb -> test/openssl/utils.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "321:         end",
          "322:       end",
          "323:     ensure",
          "326:       assert_join_threads(threads)",
          "327:     end",
          "",
          "[Removed Lines]",
          "324:       stop_pipe_r.close if !stop_pipe_r.closed?",
          "325:       stop_pipe_w.close if !stop_pipe_w.closed?",
          "",
          "[Added Lines]",
          "324:       stop_pipe_r.close if stop_pipe_r && !stop_pipe_r.closed?",
          "325:       stop_pipe_w.close if stop_pipe_w && !stop_pipe_w.closed?",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.9\"",
          "2: #define RUBY_RELEASE_DATE \"2016-03-25\"",
          "5: #define RUBY_RELEASE_YEAR 2016",
          "6: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 483",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 484",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6a2b4ced6ad48ee7db0afdf564dcbb6cd3bfbd76",
      "candidate_info": {
        "commit_hash": "6a2b4ced6ad48ee7db0afdf564dcbb6cd3bfbd76",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/6a2b4ced6ad48ee7db0afdf564dcbb6cd3bfbd76",
        "files": [
          "ChangeLog",
          "ext/io/console/console.c",
          "test/io/console/test_io_console.rb",
          "version.h"
        ],
        "message": "merge revision(s) r46254,r48982,r48984: [Backport #10649]\n\n\ttest/io/console/test_io_console.rb: Close FDs.\n\n\t* ext/io/console/console.c (console_dev): id_console is not a\n\t  constant name, use rb_const_remove() to get rid of NameError.\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@50126 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "ext/io/console/console.c||ext/io/console/console.c",
          "test/io/console/test_io_console.rb||test/io/console/test_io_console.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "ext/io/console/console.c||ext/io/console/console.c": [
          "File: ext/io/console/console.c -> ext/io/console/console.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "689:      if ((fptr = RFILE(con)->fptr) && GetReadFD(fptr) != -1)",
          "690:   return con;",
          "691:  }",
          "693:     }",
          "694:     {",
          "695:  VALUE args[2];",
          "",
          "[Removed Lines]",
          "692:  rb_mod_remove_const(klass, ID2SYM(id_console));",
          "",
          "[Added Lines]",
          "692:  rb_const_remove(klass, id_console);",
          "",
          "---------------"
        ],
        "test/io/console/test_io_console.rb||test/io/console/test_io_console.rb": [
          "File: test/io/console/test_io_console.rb -> test/io/console/test_io_console.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "217:   end",
          "219:   if IO.console",
          "220:     def test_sync",
          "221:       assert(IO.console.sync, \"console should be unbuffered\")",
          "222:     end",
          "223:   else",
          "224:     def test_sync",
          "232:     end",
          "233:   end",
          "",
          "[Removed Lines]",
          "225:       r, w, pid = PTY.spawn(EnvUtil.rubybin, \"-rio/console\", \"-e\", \"p IO.console.class\")",
          "226:     rescue RuntimeError",
          "227:       skip $!",
          "228:     else",
          "229:       con = r.gets.chomp",
          "230:       Process.wait(pid)",
          "231:       assert_match(\"File\", con)",
          "",
          "[Added Lines]",
          "220:     def test_close",
          "221:       IO.console.close",
          "222:       assert_kind_of(IO, IO.console)",
          "223:       assert_nothing_raised(IOError) {IO.console.fileno}",
          "224:     end",
          "230:     def test_close",
          "231:       assert_equal([\"true\"], run_pty(\"IO.console.close; p IO.console.fileno >= 0\"))",
          "232:     end",
          "235:       assert_equal([\"true\"], run_pty(\"p IO.console.sync\"))",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "243:     m.close if m",
          "244:     s.close if s",
          "245:   end",
          "246: end if defined?(PTY) and defined?(IO::console)",
          "248: class TestIO_Console < Test::Unit::TestCase",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "251:   def run_pty(src)",
          "252:     r, w, pid = PTY.spawn(EnvUtil.rubybin, \"-rio/console\", \"-e\", src)",
          "253:   rescue RuntimeError",
          "254:     skip $!",
          "255:   else",
          "256:     result = r.readlines(&:chomp)",
          "257:     Process.wait(pid)",
          "258:     if block_given?",
          "259:       yield result",
          "260:     else",
          "261:       result",
          "262:     end",
          "263:   ensure",
          "264:     r.close if r",
          "265:     w.close if w",
          "266:   end",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.5\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 3",
          "9: #include \"ruby/version.h\"",
          "",
          "[Removed Lines]",
          "2: #define RUBY_RELEASE_DATE \"2015-03-24\"",
          "3: #define RUBY_PATCHLEVEL 321",
          "7: #define RUBY_RELEASE_DAY 24",
          "",
          "[Added Lines]",
          "2: #define RUBY_RELEASE_DATE \"2015-03-30\"",
          "3: #define RUBY_PATCHLEVEL 322",
          "7: #define RUBY_RELEASE_DAY 30",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c3ec5fd6dafc50485e888c1f6701c6f2f068187a",
      "candidate_info": {
        "commit_hash": "c3ec5fd6dafc50485e888c1f6701c6f2f068187a",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/c3ec5fd6dafc50485e888c1f6701c6f2f068187a",
        "files": [
          "ChangeLog",
          "thread_pthread.c",
          "version.h"
        ],
        "message": "merge revision(s) 54000: [Backport #12148]\n\n\t* thread_pthread.c (getstack): __pi_stacksize returned by\n\t  pthread_getthrds_np() is wrong on AIX. Use\n\t  __pi_stackend - __pi_stackaddr instead.\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@54264 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "thread_pthread.c||thread_pthread.c",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "thread_pthread.c||thread_pthread.c": [
          "File: thread_pthread.c -> thread_pthread.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "608:        &thinfo, sizeof(thinfo),",
          "609:        &reg, &regsiz));",
          "612:     STACK_DIR_UPPER((void)0, (void)(*addr = (char *)*addr + *size));",
          "613: #else",
          "614: #error STACKADDR_AVAILABLE is defined but not implemented.",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "612:        It is around 3KB smaller than the correct size",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.9\"",
          "2: #define RUBY_RELEASE_DATE \"2016-03-25\"",
          "5: #define RUBY_RELEASE_YEAR 2016",
          "6: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 461",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 462",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "79d041dbdeeb95db9ef061c343b524463b5f5235",
      "candidate_info": {
        "commit_hash": "79d041dbdeeb95db9ef061c343b524463b5f5235",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/79d041dbdeeb95db9ef061c343b524463b5f5235",
        "files": [
          "ChangeLog",
          "test/ruby/test_io.rb",
          "version.h"
        ],
        "message": "merge revision(s) r49148: [Backport #9917]\n\n\t* test/ruby/test_io.rb: added timeout for AIX environment.\n\t  [ruby-core:62983][Bug #9917]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@49158 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "test/ruby/test_io.rb||test/ruby/test_io.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "test/ruby/test_io.rb||test/ruby/test_io.rb": [
          "File: test/ruby/test_io.rb -> test/ruby/test_io.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "2896:       }",
          "2898:       IO.select(tempfiles)",
          "2900:   end",
          "2902:   def test_read_32bit_boundary",
          "",
          "[Removed Lines]",
          "2899:   }, bug8080",
          "",
          "[Added Lines]",
          "2899:     }, bug8080, timeout: 30",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.5\"",
          "2: #define RUBY_RELEASE_DATE \"2015-01-06\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 1",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 276",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 277",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a6b6f9bb5941bb616608729fa9678b08d23e4c56",
      "candidate_info": {
        "commit_hash": "a6b6f9bb5941bb616608729fa9678b08d23e4c56",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/a6b6f9bb5941bb616608729fa9678b08d23e4c56",
        "files": [
          "ChangeLog",
          "internal.h",
          "proc.c",
          "string.c",
          "version.h"
        ],
        "message": "merge revision(s) 45576: [Backport #11572]\n\n\t* string.c (sym_to_proc), proc.c (rb_block_clear_env_self): clear\n\t  caller's self which is useless, so that it can get collected.\n\t  [Fixes GH-592]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@52362 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "internal.h||internal.h",
          "proc.c||proc.c",
          "string.c||string.c",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "internal.h||internal.h": [
          "File: internal.h -> internal.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "630: VALUE rb_proc_location(VALUE self);",
          "631: st_index_t rb_hash_proc(st_index_t hash, VALUE proc);",
          "632: int rb_block_arity(void);",
          "635: #define RB_MAX_GROUPS (65536)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "633: VALUE rb_block_clear_env_self(VALUE proc);",
          "",
          "---------------"
        ],
        "proc.c||proc.c": [
          "File: proc.c -> proc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "636:     return proc_new(rb_cProc, TRUE);",
          "637: }",
          "639: VALUE",
          "640: rb_f_lambda(void)",
          "641: {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "639: VALUE",
          "640: rb_block_clear_env_self(VALUE proc)",
          "641: {",
          "642:     rb_proc_t *po;",
          "643:     rb_env_t *env;",
          "644:     GetProcPtr(proc, po);",
          "645:     GetEnvPtr(po->envval, env);",
          "646:     env->env[0] = Qnil;",
          "647:     return proc;",
          "648: }",
          "",
          "---------------"
        ],
        "string.c||string.c": [
          "File: string.c -> string.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "8540:     }",
          "8541:     else {",
          "8542:  proc = rb_proc_new(sym_call, (VALUE)id);",
          "8543:  aryp[index] = sym;",
          "8544:  aryp[index + 1] = proc;",
          "8545:  return proc;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8543:  rb_block_clear_env_self(proc);",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.8\"",
          "2: #define RUBY_RELEASE_DATE \"2015-10-29\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 10",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 411",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 412",
          "",
          "---------------"
        ]
      }
    }
  ]
}