{
  "cve_id": "CVE-2016-6289",
  "cve_desc": "Integer overflow in the virtual_file_ex function in TSRM/tsrm_virtual_cwd.c in PHP before 5.5.38, 5.6.x before 5.6.24, and 7.x before 7.0.9 allows remote attackers to cause a denial of service (stack-based buffer overflow) or possibly have unspecified other impact via a crafted extract operation on a ZIP archive.",
  "repo": "php/php-src",
  "patch_hash": "0218acb7e756a469099c4ccfb22bce6c2bd1ef87",
  "patch_info": {
    "commit_hash": "0218acb7e756a469099c4ccfb22bce6c2bd1ef87",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/0218acb7e756a469099c4ccfb22bce6c2bd1ef87",
    "files": [
      "TSRM/tsrm_virtual_cwd.c"
    ],
    "message": "Fix for bug #72513",
    "before_after_code_files": [
      "TSRM/tsrm_virtual_cwd.c||TSRM/tsrm_virtual_cwd.c"
    ]
  },
  "patch_diff": {
    "TSRM/tsrm_virtual_cwd.c||TSRM/tsrm_virtual_cwd.c": [
      "File: TSRM/tsrm_virtual_cwd.c -> TSRM/tsrm_virtual_cwd.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1159:  int add_slash;",
      "1160:  void *tmp;",
      "1163: #ifdef TSRM_WIN32",
      "1164: # if _MSC_VER < 1300",
      "1165:   errno = EINVAL;",
      "",
      "[Removed Lines]",
      "1162:  if (path_length == 0 || path_length >= MAXPATHLEN-1) {",
      "",
      "[Added Lines]",
      "1162:  if (path_length <= 0 || path_length >= MAXPATHLEN-1) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a099545bec28c7ebe1641c8a45b68709901f6893",
      "candidate_info": {
        "commit_hash": "a099545bec28c7ebe1641c8a45b68709901f6893",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/a099545bec28c7ebe1641c8a45b68709901f6893",
        "files": [
          "Zend/zend_virtual_cwd.c"
        ],
        "message": "Fix for bug #72513",
        "before_after_code_files": [
          "Zend/zend_virtual_cwd.c||Zend/zend_virtual_cwd.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Zend/zend_virtual_cwd.c||Zend/zend_virtual_cwd.c": [
          "File: Zend/zend_virtual_cwd.c -> Zend/zend_virtual_cwd.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1190:  int add_slash;",
          "1191:  void *tmp;",
          "1194: #ifdef TSRM_WIN32",
          "1195: # if _MSC_VER < 1300",
          "1196:   errno = EINVAL;",
          "",
          "[Removed Lines]",
          "1193:  if (path_length == 0 || path_length >= MAXPATHLEN-1) {",
          "",
          "[Added Lines]",
          "1193:  if (path_length <= 0 || path_length >= MAXPATHLEN-1) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "374ae8e9da58464e22f3e5a461ee95f6240979e7",
      "candidate_info": {
        "commit_hash": "374ae8e9da58464e22f3e5a461ee95f6240979e7",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/374ae8e9da58464e22f3e5a461ee95f6240979e7",
        "files": [
          "Zend/zend_virtual_cwd.c"
        ],
        "message": "Fix for bug #72513\n\nThis is applicable to 7 as well, but was somehow missing from the merge.",
        "before_after_code_files": [
          "Zend/zend_virtual_cwd.c||Zend/zend_virtual_cwd.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Zend/zend_virtual_cwd.c||Zend/zend_virtual_cwd.c": [
          "File: Zend/zend_virtual_cwd.c -> Zend/zend_virtual_cwd.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1187:  int add_slash;",
          "1188:  void *tmp;",
          "1191: #ifdef ZEND_WIN32",
          "1192:   _set_errno(EINVAL);",
          "1193: #else",
          "",
          "[Removed Lines]",
          "1190:  if (path_length == 0 || path_length >= MAXPATHLEN-1) {",
          "",
          "[Added Lines]",
          "1190:  if (path_length <= 0 || path_length >= MAXPATHLEN-1) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "44d96c42d220072995ea5074230ed91f1c8c36e4",
      "candidate_info": {
        "commit_hash": "44d96c42d220072995ea5074230ed91f1c8c36e4",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/44d96c42d220072995ea5074230ed91f1c8c36e4",
        "files": [
          "Zend/zend_virtual_cwd.c"
        ],
        "message": "Fix for bug #72513",
        "before_after_code_files": [
          "Zend/zend_virtual_cwd.c||Zend/zend_virtual_cwd.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Zend/zend_virtual_cwd.c||Zend/zend_virtual_cwd.c": [
          "File: Zend/zend_virtual_cwd.c -> Zend/zend_virtual_cwd.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1190:  int add_slash;",
          "1191:  void *tmp;",
          "1194: #ifdef TSRM_WIN32",
          "1195: # if _MSC_VER < 1300",
          "1196:   errno = EINVAL;",
          "",
          "[Removed Lines]",
          "1193:  if (path_length == 0 || path_length >= MAXPATHLEN-1) {",
          "",
          "[Added Lines]",
          "1193:  if (path_length <= 0 || path_length >= MAXPATHLEN-1) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}