{
  "cve_id": "CVE-2020-13881",
  "cve_desc": "In support.c in pam_tacplus 1.3.8 through 1.5.1, the TACACS+ shared secret gets logged via syslog if the DEBUG loglevel and journald are used.",
  "repo": "kravietz/pam_tacplus",
  "patch_hash": "4a9852c31c2fd0c0e72fbb689a586aabcfb11cb0",
  "patch_info": {
    "commit_hash": "4a9852c31c2fd0c0e72fbb689a586aabcfb11cb0",
    "repo": "kravietz/pam_tacplus",
    "commit_url": "https://github.com/kravietz/pam_tacplus/commit/4a9852c31c2fd0c0e72fbb689a586aabcfb11cb0",
    "files": [
      "support.c"
    ],
    "message": "pam: don't leak TACACS+ secret to journald\n\nIf journald for syslog is used, the journal is going to store everything,\neven DEBUG loglevel messages. Pre-journald logging of system-wide DEBUG\nloglevel could be avoided and is not affected in all cases.\n\nWith journald presence it's probably safe to no longer log sensitive\ndetails at DEBUG level.\n\nFix #149\n\nSigned-off-by: Daniel Gollub <dgollub@att.com>",
    "before_after_code_files": [
      "support.c||support.c"
    ]
  },
  "patch_diff": {
    "support.c||support.c": [
      "File: support.c -> support.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "374:         _pam_log(LOG_DEBUG, \"%d servers defined\", tac_srv_no);",
      "376:         for (n = 0; n < tac_srv_no; n++) {",
      "379:         }",
      "381:         _pam_log(LOG_DEBUG, \"tac_service='%s'\", tac_service);",
      "",
      "[Removed Lines]",
      "377:             _pam_log(LOG_DEBUG, \"server[%lu] { addr=%s, key='%s' }\", n, tac_ntop(tac_srv[n].addr->ai_addr),",
      "378:                      tac_srv[n].key);",
      "",
      "[Added Lines]",
      "377:             _pam_log(LOG_DEBUG, \"server[%lu] { addr=%s, key='********' }\", n,",
      "378:        tac_ntop(tac_srv[n].addr->ai_addr));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "57acc34493caede512da9d24d83a0471970601d4",
      "candidate_info": {
        "commit_hash": "57acc34493caede512da9d24d83a0471970601d4",
        "repo": "kravietz/pam_tacplus",
        "commit_url": "https://github.com/kravietz/pam_tacplus/commit/57acc34493caede512da9d24d83a0471970601d4",
        "files": [
          "support.c"
        ],
        "message": "Fix minor signedness issue reported by LGTM",
        "before_after_code_files": [
          "support.c||support.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "support.c||support.c"
          ],
          "candidate": [
            "support.c||support.c"
          ]
        }
      },
      "candidate_diff": {
        "support.c||support.c": [
          "File: support.c -> support.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "244:             xstrcpy (tac_prompt, *argv + 7, sizeof(tac_prompt));",
          "247:             for (chr = 0; chr < strlen(tac_prompt); chr++) {",
          "248:                 if (tac_prompt[chr] == '_') {",
          "249:                     tac_prompt[chr] = ' ';",
          "",
          "[Removed Lines]",
          "246:             unsigned chr;",
          "",
          "[Added Lines]",
          "246:             unsigned long chr;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "334:         _pam_log(LOG_DEBUG, \"%d servers defined\", tac_srv_no);",
          "336:         for(n = 0; n < tac_srv_no; n++) {",
          "338:                      tac_srv[n].key);",
          "339:         }",
          "",
          "[Removed Lines]",
          "337:             _pam_log(LOG_DEBUG, \"server[%u] { addr=%s, key='%s' }\", n, tac_ntop(tac_srv[n].addr->ai_addr),",
          "",
          "[Added Lines]",
          "337:             _pam_log(LOG_DEBUG, \"server[%lu] { addr=%s, key='%s' }\", n, tac_ntop(tac_srv[n].addr->ai_addr),",
          "",
          "---------------"
        ]
      }
    }
  ]
}