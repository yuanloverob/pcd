{
  "cve_id": "CVE-2016-10161",
  "cve_desc": "The object_common1 function in ext/standard/var_unserializer.c in PHP before 5.6.30, 7.0.x before 7.0.15, and 7.1.x before 7.1.1 allows remote attackers to cause a denial of service (buffer over-read and application crash) via crafted serialized data that is mishandled in a finish_nested_data call.",
  "repo": "php/php-src",
  "patch_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
  "patch_info": {
    "commit_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/16b3003ffc6393e250f069aa28a78dc5a2c064b2",
    "files": [
      "ext/standard/tests/serialize/bug73825.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #73825 - Heap out of bounds read on unserialize in finish_nested_data()",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt": [
      "File: ext/standard/tests/serialize/bug73825.phpt -> ext/standard/tests/serialize/bug73825.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73825 Heap out of bounds read on unserialize in finish_nested_data()",
      "3: --FILE--",
      "4: <?php",
      "5: $obj = unserialize('O:8:\"00000000\":');",
      "6: var_dump($obj);",
      "7: ?>",
      "8: --EXPECTF--",
      "9: Warning: Bad unserialize data in %sbug73825.php on line %d",
      "11: Notice: unserialize(): Error at offset 13 of 15 bytes in %sbug73825.php on line %d",
      "12: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "405: {",
      "406:  long elements;",
      "408:  elements = parse_iv2((*p) + 2, p);",
      "410:  (*p) += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "408:  if( *p >= max - 2) {",
      "409:   zend_error(E_WARNING, \"Bad unserialize data\");",
      "410:   return -1;",
      "411:  }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "417:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
      "419:  }",
      "421:  return elements;",
      "",
      "[Removed Lines]",
      "418:   return 0;",
      "",
      "[Added Lines]",
      "423:   return -1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "496: {",
      "497:  YYCTYPE yych;",
      "498:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "495: #line 496 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "500: #line 501 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "552:  yych = *(YYMARKER = ++YYCURSOR);",
      "553:  if (yych == ':') goto yy95;",
      "554: yy3:",
      "556:  { return 0; }",
      "558: yy4:",
      "559:  yych = *(YYMARKER = ++YYCURSOR);",
      "560:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "555: #line 861 \"ext/standard/var_unserializer.re\"",
      "557: #line 558 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "560: #line 875 \"ext/standard/var_unserializer.re\"",
      "562: #line 563 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "597:  goto yy3;",
      "598: yy14:",
      "599:  ++YYCURSOR;",
      "601:  {",
      "603:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "605: }",
      "607: yy16:",
      "608:  yych = *++YYCURSOR;",
      "609:  goto yy3;",
      "",
      "[Removed Lines]",
      "600: #line 855 \"ext/standard/var_unserializer.re\"",
      "606: #line 607 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "605: #line 869 \"ext/standard/var_unserializer.re\"",
      "611: #line 612 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "634:  yych = *++YYCURSOR;",
      "635:  if (yych != '\"') goto yy18;",
      "636:  ++YYCURSOR;",
      "638:  {",
      "639:  size_t len, len2, len3, maxlen;",
      "640:  long elements;",
      "",
      "[Removed Lines]",
      "637: #line 708 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "642: #line 717 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "775:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
      "777:  if (incomplete_class) {",
      "778:   php_store_class_name(*rval, class_name, len2);",
      "779:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "782:  if (elements < 0) {",
      "783:     efree(class_name);",
      "784:     return 0;",
      "785:  }",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "782:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "783: }",
      "785: yy25:",
      "786:  yych = *++YYCURSOR;",
      "787:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "784: #line 785 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "794: #line 795 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "806:  yych = *++YYCURSOR;",
      "807:  if (yych != '\"') goto yy18;",
      "808:  ++YYCURSOR;",
      "810:  {",
      "811:     if (!var_hash) return 0;",
      "813:  INIT_PZVAL(*rval);",
      "817: }",
      "819: yy32:",
      "820:  yych = *++YYCURSOR;",
      "821:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "809: #line 699 \"ext/standard/var_unserializer.re\"",
      "815:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "816:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "818: #line 819 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "819: #line 704 \"ext/standard/var_unserializer.re\"",
      "821:  long elements;",
      "826:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
      "827:  if (elements < 0) {",
      "828:   return 0;",
      "829:  }",
      "830:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "832: #line 833 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "836:  yych = *++YYCURSOR;",
      "837:  if (yych != '{') goto yy18;",
      "838:  ++YYCURSOR;",
      "840:  {",
      "841:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "839: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "853: #line 683 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "858:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "859: }",
      "861: yy39:",
      "862:  yych = *++YYCURSOR;",
      "863:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "860: #line 861 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "874: #line 875 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "878:  yych = *++YYCURSOR;",
      "879:  if (yych != '\"') goto yy18;",
      "880:  ++YYCURSOR;",
      "882:  {",
      "883:  size_t len, maxlen;",
      "884:  char *str;",
      "",
      "[Removed Lines]",
      "881: #line 643 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "895: #line 648 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "913:  ZVAL_STRINGL(*rval, str, len, 0);",
      "914:  return 1;",
      "915: }",
      "917: yy46:",
      "918:  yych = *++YYCURSOR;",
      "919:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "916: #line 917 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "930: #line 931 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "934:  yych = *++YYCURSOR;",
      "935:  if (yych != '\"') goto yy18;",
      "936:  ++YYCURSOR;",
      "938:  {",
      "939:  size_t len, maxlen;",
      "940:  char *str;",
      "",
      "[Removed Lines]",
      "937: #line 610 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "951: #line 615 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "967:  ZVAL_STRINGL(*rval, str, len, 1);",
      "968:  return 1;",
      "969: }",
      "971: yy53:",
      "972:  yych = *++YYCURSOR;",
      "973:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "970: #line 971 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "984: #line 985 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1055:  }",
      "1056: yy63:",
      "1057:  ++YYCURSOR;",
      "1059:  {",
      "1060: #if SIZEOF_LONG == 4",
      "1061: use_double:",
      "",
      "[Removed Lines]",
      "1058: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1072: #line 605 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1065:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1066:  return 1;",
      "1067: }",
      "1069: yy65:",
      "1070:  yych = *++YYCURSOR;",
      "1071:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1082: #line 1083 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1124:  yych = *++YYCURSOR;",
      "1125:  if (yych != ';') goto yy18;",
      "1126:  ++YYCURSOR;",
      "1128:  {",
      "1130:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1127: #line 585 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1141: #line 590 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1140:  return 1;",
      "1141: }",
      "1143: yy76:",
      "1144:  yych = *++YYCURSOR;",
      "1145:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1156: #line 1157 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1166:  if (yych <= '9') goto yy79;",
      "1167:  if (yych != ';') goto yy18;",
      "1168:  ++YYCURSOR;",
      "1170:  {",
      "1171: #if SIZEOF_LONG == 4",
      "1172:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1169: #line 558 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1183: #line 563 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1193:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1194:  return 1;",
      "1195: }",
      "1197: yy83:",
      "1198:  yych = *++YYCURSOR;",
      "1199:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1201:  yych = *++YYCURSOR;",
      "1202:  if (yych != ';') goto yy18;",
      "1203:  ++YYCURSOR;",
      "1205:  {",
      "1207:  INIT_PZVAL(*rval);",
      "1208:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1209:  return 1;",
      "1210: }",
      "1212: yy87:",
      "1213:  ++YYCURSOR;",
      "1215:  {",
      "1217:  INIT_PZVAL(*rval);",
      "1218:  ZVAL_NULL(*rval);",
      "1219:  return 1;",
      "1220: }",
      "1222: yy89:",
      "1223:  yych = *++YYCURSOR;",
      "1224:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1204: #line 551 \"ext/standard/var_unserializer.re\"",
      "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
      "1214: #line 544 \"ext/standard/var_unserializer.re\"",
      "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1218: #line 556 \"ext/standard/var_unserializer.re\"",
      "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
      "1228: #line 549 \"ext/standard/var_unserializer.re\"",
      "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1241:  if (yych <= '9') goto yy91;",
      "1242:  if (yych != ';') goto yy18;",
      "1243:  ++YYCURSOR;",
      "1245:  {",
      "1246:  long id;",
      "",
      "[Removed Lines]",
      "1244: #line 521 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1258: #line 526 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1265:  return 1;",
      "1266: }",
      "1268: yy95:",
      "1269:  yych = *++YYCURSOR;",
      "1270:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1281: #line 1282 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1287:  if (yych <= '9') goto yy97;",
      "1288:  if (yych != ';') goto yy18;",
      "1289:  ++YYCURSOR;",
      "1291:  {",
      "1292:  long id;",
      "",
      "[Removed Lines]",
      "1290: #line 500 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1304: #line 505 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "1309:  return 1;",
      "1310: }",
      "1312: }",
      "1316:  return 0;",
      "",
      "[Removed Lines]",
      "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
      "1313: #line 863 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1325: #line 1326 \"ext/standard/var_unserializer.c\"",
      "1327: #line 877 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "409: {",
      "410:  long elements;",
      "412:  elements = parse_iv2((*p) + 2, p);",
      "414:  (*p) += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "412:  if( *p >= max - 2) {",
      "413:   zend_error(E_WARNING, \"Bad unserialize data\");",
      "414:   return -1;",
      "415:  }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
      "423:  }",
      "425:  return elements;",
      "",
      "[Removed Lines]",
      "422:   return 0;",
      "",
      "[Added Lines]",
      "427:   return -1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "697: }",
      "699: \"o:\" iv \":\" [\"] {",
      "700:     if (!var_hash) return 0;",
      "702:  INIT_PZVAL(*rval);",
      "706: }",
      "708: object \":\" uiv \":\" [\"] {",
      "",
      "[Removed Lines]",
      "704:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "705:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "",
      "[Added Lines]",
      "705:  long elements;",
      "710:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
      "711:  if (elements < 0) {",
      "712:   return 0;",
      "713:  }",
      "714:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "845:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
      "847:  if (incomplete_class) {",
      "848:   php_store_class_name(*rval, class_name, len2);",
      "849:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "856:  if (elements < 0) {",
      "857:     efree(class_name);",
      "858:     return 0;",
      "859:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "4fb7665c099eb2e2ee75ead8e77479866ab01b2a",
      "candidate_info": {
        "commit_hash": "4fb7665c099eb2e2ee75ead8e77479866ab01b2a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/4fb7665c099eb2e2ee75ead8e77479866ab01b2a",
        "files": [
          "NEWS",
          "ext/standard/tests/serialize/bug74103.phpt",
          "ext/standard/tests/serialize/bug75054.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-7.0' into PHP-7.1",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug74103.phpt||ext/standard/tests/serialize/bug74103.phpt",
          "ext/standard/tests/serialize/bug75054.phpt||ext/standard/tests/serialize/bug75054.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug74103.phpt||ext/standard/tests/serialize/bug74103.phpt": [
          "File: ext/standard/tests/serialize/bug74103.phpt -> ext/standard/tests/serialize/bug74103.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #74103: heap-use-after-free when unserializing invalid array size",
          "3: --FILE--",
          "4: <?php",
          "5: var_dump(unserialize('a:7:{i:0;i:04;s:1:\"a\";i:2;i:00009617006;i:4;s:1:\"a\";i:4;s:1:\"a\";R:5;s:1:\"7\";R:3;s:1:\"a\";R:5;;s:18;}}'));",
          "6: ?>",
          "7: --EXPECTF--",
          "8: Notice: unserialize(): Error at offset 68 of 100 bytes in %s on line %d",
          "9: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug75054.phpt||ext/standard/tests/serialize/bug75054.phpt": [
          "File: ext/standard/tests/serialize/bug75054.phpt -> ext/standard/tests/serialize/bug75054.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #75054: A Denial of Service Vulnerability was found when performing deserialization",
          "3: --FILE--",
          "4: <?php",
          "5: $poc = 'a:9:{i:0;s:4:\"0000\";i:0;s:4:\"0000\";i:0;R:2;s:4:\"5003\";R:2;s:4:\"0000\";R:2;s:4:\"0000\";R:2;s:4:\"';",
          "6: $poc .= \"\\x06\";",
          "7: $poc .= '000\";R:2;s:4:\"0000\";d:0;s:4:\"0000\";a:9:{s:4:\"0000\";';",
          "8: var_dump(unserialize($poc));",
          "9: ?>",
          "10: --EXPECTF--",
          "11: Notice: unserialize(): Error at offset 43 of 145 bytes in %s on line %d",
          "12: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "450:    return 0;",
          "451:   }",
          "463:   zval_dtor(&key);",
          "465:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "",
          "[Removed Lines]",
          "453:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "454:    if (Z_TYPE(key) == IS_LONG) {",
          "455:     zend_hash_index_del(ht, Z_LVAL(key));",
          "456:    } else {",
          "457:     zend_hash_del_ind(ht, Z_STR(key));",
          "458:    }",
          "459:   } else {",
          "460:    var_push_dtor(var_hash, data);",
          "461:   }",
          "",
          "[Added Lines]",
          "453:   var_push_dtor(var_hash, data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "620:  start = cursor;",
          "624: {",
          "625:  YYCTYPE yych;",
          "626:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "623: #line 624 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "614: #line 615 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "661:  yych = *YYCURSOR;",
          "662:  switch (yych) {",
          "663:  case 'C':",
          "665:  case 'N': goto yy5;",
          "672:  case 'o': goto yy12;",
          "677:  }",
          "678: yy2:",
          "681: yy3:",
          "683:  { return 0; }",
          "685: yy4:",
          "686:  yych = *(YYMARKER = ++YYCURSOR);",
          "688:  goto yy3;",
          "689: yy5:",
          "690:  yych = *++YYCURSOR;",
          "692:  goto yy3;",
          "693: yy6:",
          "694:  yych = *(YYMARKER = ++YYCURSOR);",
          "696:  goto yy3;",
          "697: yy7:",
          "698:  yych = *(YYMARKER = ++YYCURSOR);",
          "700:  goto yy3;",
          "701: yy8:",
          "702:  yych = *(YYMARKER = ++YYCURSOR);",
          "704:  goto yy3;",
          "705: yy9:",
          "706:  yych = *(YYMARKER = ++YYCURSOR);",
          "708:  goto yy3;",
          "709: yy10:",
          "710:  yych = *(YYMARKER = ++YYCURSOR);",
          "712:  goto yy3;",
          "713: yy11:",
          "714:  yych = *(YYMARKER = ++YYCURSOR);",
          "716:  goto yy3;",
          "717: yy12:",
          "718:  yych = *(YYMARKER = ++YYCURSOR);",
          "720:  goto yy3;",
          "721: yy13:",
          "722:  yych = *(YYMARKER = ++YYCURSOR);",
          "724:  goto yy3;",
          "725: yy14:",
          "726:  ++YYCURSOR;",
          "728:  {",
          "730:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "732: }",
          "737: yy17:",
          "738:  yych = *++YYCURSOR;",
          "739:  if (yybm[0+yych] & 128) {",
          "741:  }",
          "743: yy18:",
          "744:  YYCURSOR = YYMARKER;",
          "745:  goto yy3;",
          "746: yy19:",
          "747:  yych = *++YYCURSOR;",
          "750:  }",
          "751:  goto yy18;",
          "759:  if (yych <= '/') goto yy18;",
          "761:  yych = *++YYCURSOR;",
          "880:   }",
          "897:   }",
          "900:  }",
          "907:  }",
          "911:  }",
          "918:  yych = *++YYCURSOR;",
          "919:  if (yych <= ',') {",
          "921:  } else {",
          "923:   if (yych <= '/') goto yy18;",
          "925:   goto yy18;",
          "926:  }",
          "928:  yych = *++YYCURSOR;",
          "929:  if (yych <= '/') goto yy18;",
          "932:  ++YYCURSOR;",
          "933:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "934:  yych = *YYCURSOR;",
          "935:  if (yych <= '/') goto yy18;",
          "938:  yych = *++YYCURSOR;",
          "940:  ++YYCURSOR;",
          "956:  if (yych <= '/') goto yy18;",
          "957:  if (yych <= '9') goto yy34;",
          "958:  goto yy18;",
          "960:  yych = *++YYCURSOR;",
          "961:  if (yych <= '/') goto yy18;",
          "962:  if (yych >= ':') goto yy18;",
          "964:  ++YYCURSOR;",
          "965:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "966:  yych = *YYCURSOR;",
          "967:  if (yych <= '/') goto yy18;",
          "970:  yych = *++YYCURSOR;",
          "972:  ++YYCURSOR;",
          "989:  }",
          "993:  }",
          "999:  yych = *++YYCURSOR;",
          "1001:  if (yych <= '/') goto yy18;",
          "1003:  goto yy18;",
          "1005:  yych = *++YYCURSOR;",
          "1006:  if (yych <= '/') goto yy18;",
          "1007:  if (yych >= ':') goto yy18;",
          "1009:  ++YYCURSOR;",
          "1010:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "1011:  yych = *YYCURSOR;",
          "1012:  if (yych <= '/') goto yy18;",
          "1015:  yych = *++YYCURSOR;",
          "1017:  ++YYCURSOR;",
          "1056:  if (yych <= '/') goto yy18;",
          "1058:  goto yy18;",
          "1060:  yych = *++YYCURSOR;",
          "1061:  if (yych <= '/') goto yy18;",
          "1062:  if (yych >= ':') goto yy18;",
          "1064:  ++YYCURSOR;",
          "1065:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "1066:  yych = *YYCURSOR;",
          "1067:  if (yych <= '/') goto yy18;",
          "1070:  yych = *++YYCURSOR;",
          "1072:  ++YYCURSOR;",
          "1074:  {",
          "1091:   return 0;",
          "1092:  }",
          "1096:   return 0;",
          "1097:  }",
          "1103:  return 1;",
          "1104: }",
          "1126:  yych = *++YYCURSOR;",
          "1128:  goto yy18;",
          "1139:  yych = *++YYCURSOR;",
          "1141:  goto yy18;",
          "1148:  ++YYCURSOR;",
          "1175:  ++YYCURSOR;",
          "1176:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1177:  yych = *YYCURSOR;",
          "1178:  if (yych <= ';') {",
          "1179:   if (yych <= '/') goto yy18;",
          "1181:   if (yych <= ':') goto yy18;",
          "1182:  } else {",
          "1183:   if (yych <= 'E') {",
          "1184:    if (yych <= 'D') goto yy18;",
          "1186:   } else {",
          "1188:    goto yy18;",
          "1189:   }",
          "1190:  }",
          "1192:  ++YYCURSOR;",
          "1194:  {",
          "1195: #if SIZEOF_ZEND_LONG == 4",
          "1196: use_double:",
          "",
          "[Removed Lines]",
          "664:  case 'O': goto yy13;",
          "666:  case 'R': goto yy2;",
          "667:  case 'S': goto yy10;",
          "668:  case 'a': goto yy11;",
          "669:  case 'b': goto yy6;",
          "670:  case 'd': goto yy8;",
          "671:  case 'i': goto yy7;",
          "673:  case 'r': goto yy4;",
          "674:  case 's': goto yy9;",
          "675:  case '}': goto yy14;",
          "676:  default: goto yy16;",
          "679:  yych = *(YYMARKER = ++YYCURSOR);",
          "680:  if (yych == ':') goto yy95;",
          "682: #line 1001 \"ext/standard/var_unserializer.re\"",
          "684: #line 685 \"ext/standard/var_unserializer.c\"",
          "687:  if (yych == ':') goto yy89;",
          "691:  if (yych == ';') goto yy87;",
          "695:  if (yych == ':') goto yy83;",
          "699:  if (yych == ':') goto yy77;",
          "703:  if (yych == ':') goto yy53;",
          "707:  if (yych == ':') goto yy46;",
          "711:  if (yych == ':') goto yy39;",
          "715:  if (yych == ':') goto yy32;",
          "719:  if (yych == ':') goto yy25;",
          "723:  if (yych == ':') goto yy17;",
          "727: #line 995 \"ext/standard/var_unserializer.re\"",
          "733: #line 734 \"ext/standard/var_unserializer.c\"",
          "734: yy16:",
          "735:  yych = *++YYCURSOR;",
          "736:  goto yy3;",
          "740:   goto yy20;",
          "742:  if (yych == '+') goto yy19;",
          "748:  if (yybm[0+yych] & 128) {",
          "749:   goto yy20;",
          "752: yy20:",
          "753:  ++YYCURSOR;",
          "754:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "755:  yych = *YYCURSOR;",
          "756:  if (yybm[0+yych] & 128) {",
          "757:   goto yy20;",
          "758:  }",
          "760:  if (yych >= ';') goto yy18;",
          "762:  if (yych != '\"') goto yy18;",
          "763:  ++YYCURSOR;",
          "764: #line 843 \"ext/standard/var_unserializer.re\"",
          "765:  {",
          "766:  size_t len, len2, len3, maxlen;",
          "767:  zend_long elements;",
          "768:  char *str;",
          "769:  zend_string *class_name;",
          "770:  zend_class_entry *ce;",
          "771:  int incomplete_class = 0;",
          "773:  int custom_object = 0;",
          "775:  zval user_func;",
          "776:  zval retval;",
          "777:  zval args[1];",
          "779:     if (!var_hash) return 0;",
          "780:  if (*start == 'C') {",
          "781:   custom_object = 1;",
          "782:  }",
          "784:  len2 = len = parse_uiv(start + 2);",
          "785:  maxlen = max - YYCURSOR;",
          "786:  if (maxlen < len || len == 0) {",
          "788:   return 0;",
          "789:  }",
          "791:  str = (char*)YYCURSOR;",
          "793:  YYCURSOR += len;",
          "795:  if (*(YYCURSOR) != '\"') {",
          "797:   return 0;",
          "798:  }",
          "799:  if (*(YYCURSOR+1) != ':') {",
          "801:   return 0;",
          "802:  }",
          "804:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "805:  if (len3 != len)",
          "806:  {",
          "808:   return 0;",
          "809:  }",
          "811:  class_name = zend_string_init(str, len, 0);",
          "813:  do {",
          "814:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "815:    incomplete_class = 1;",
          "816:    ce = PHP_IC_ENTRY;",
          "817:    break;",
          "818:   }",
          "821:   BG(serialize_lock)++;",
          "822:   ce = zend_lookup_class(class_name);",
          "823:   if (ce) {",
          "824:    BG(serialize_lock)--;",
          "825:    if (EG(exception)) {",
          "826:     zend_string_release(class_name);",
          "827:     return 0;",
          "828:    }",
          "829:    break;",
          "830:   }",
          "831:   BG(serialize_lock)--;",
          "833:   if (EG(exception)) {",
          "834:    zend_string_release(class_name);",
          "835:    return 0;",
          "836:   }",
          "839:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "840:    incomplete_class = 1;",
          "841:    ce = PHP_IC_ENTRY;",
          "842:    break;",
          "843:   }",
          "846:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "848:   ZVAL_STR_COPY(&args[0], class_name);",
          "849:   BG(serialize_lock)++;",
          "850:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "851:    BG(serialize_lock)--;",
          "852:    if (EG(exception)) {",
          "853:     zend_string_release(class_name);",
          "854:     zval_ptr_dtor(&user_func);",
          "855:     zval_ptr_dtor(&args[0]);",
          "856:     return 0;",
          "857:    }",
          "858:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "859:    incomplete_class = 1;",
          "860:    ce = PHP_IC_ENTRY;",
          "861:    zval_ptr_dtor(&user_func);",
          "862:    zval_ptr_dtor(&args[0]);",
          "863:    break;",
          "864:   }",
          "865:   BG(serialize_lock)--;",
          "866:   zval_ptr_dtor(&retval);",
          "867:   if (EG(exception)) {",
          "868:    zend_string_release(class_name);",
          "869:    zval_ptr_dtor(&user_func);",
          "870:    zval_ptr_dtor(&args[0]);",
          "871:    return 0;",
          "872:   }",
          "875:   BG(serialize_lock)++;",
          "876:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "877:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "878:    incomplete_class = 1;",
          "879:    ce = PHP_IC_ENTRY;",
          "881:   BG(serialize_lock)--;",
          "883:   zval_ptr_dtor(&user_func);",
          "884:   zval_ptr_dtor(&args[0]);",
          "885:   break;",
          "886:  } while (1);",
          "890:  if (custom_object) {",
          "891:   int ret;",
          "893:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "895:   if (ret && incomplete_class) {",
          "896:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "898:   zend_string_release(class_name);",
          "899:   return ret;",
          "902:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "904:  if (elements < 0) {",
          "905:     zend_string_release(class_name);",
          "906:     return 0;",
          "909:  if (incomplete_class) {",
          "910:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "912:  zend_string_release(class_name);",
          "914:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "915: }",
          "916: #line 917 \"ext/standard/var_unserializer.c\"",
          "917: yy25:",
          "920:   if (yych != '+') goto yy18;",
          "922:   if (yych <= '-') goto yy26;",
          "924:   if (yych <= '9') goto yy27;",
          "927: yy26:",
          "930:  if (yych >= ':') goto yy18;",
          "931: yy27:",
          "936:  if (yych <= '9') goto yy27;",
          "937:  if (yych >= ';') goto yy18;",
          "939:  if (yych != '\"') goto yy18;",
          "941: #line 832 \"ext/standard/var_unserializer.re\"",
          "942:  {",
          "943:  zend_long elements;",
          "944:     if (!var_hash) return 0;",
          "946:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "947:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "948:   return 0;",
          "949:  }",
          "950:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "951: }",
          "952: #line 953 \"ext/standard/var_unserializer.c\"",
          "953: yy32:",
          "954:  yych = *++YYCURSOR;",
          "955:  if (yych == '+') goto yy33;",
          "959: yy33:",
          "963: yy34:",
          "968:  if (yych <= '9') goto yy34;",
          "969:  if (yych >= ';') goto yy18;",
          "971:  if (yych != '{') goto yy18;",
          "973: #line 808 \"ext/standard/var_unserializer.re\"",
          "974:  {",
          "975:  zend_long elements = parse_iv(start + 2);",
          "978:     if (!var_hash) return 0;",
          "980:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "981:   return 0;",
          "982:  }",
          "984:  array_init_size(rval, elements);",
          "985:  if (elements) {",
          "988:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "991:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "992:   return 0;",
          "995:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "996: }",
          "997: #line 998 \"ext/standard/var_unserializer.c\"",
          "998: yy39:",
          "1000:  if (yych == '+') goto yy40;",
          "1002:  if (yych <= '9') goto yy41;",
          "1004: yy40:",
          "1008: yy41:",
          "1013:  if (yych <= '9') goto yy41;",
          "1014:  if (yych >= ';') goto yy18;",
          "1016:  if (yych != '\"') goto yy18;",
          "1018: #line 774 \"ext/standard/var_unserializer.re\"",
          "1019:  {",
          "1020:  size_t len, maxlen;",
          "1021:  zend_string *str;",
          "1023:  len = parse_uiv(start + 2);",
          "1024:  maxlen = max - YYCURSOR;",
          "1025:  if (maxlen < len) {",
          "1027:   return 0;",
          "1028:  }",
          "1030:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1031:   return 0;",
          "1032:  }",
          "1034:  if (*(YYCURSOR) != '\"') {",
          "1035:   zend_string_free(str);",
          "1037:   return 0;",
          "1038:  }",
          "1040:  if (*(YYCURSOR + 1) != ';') {",
          "1041:   efree(str);",
          "1043:   return 0;",
          "1044:  }",
          "1046:  YYCURSOR += 2;",
          "1049:  ZVAL_STR(rval, str);",
          "1050:  return 1;",
          "1051: }",
          "1052: #line 1053 \"ext/standard/var_unserializer.c\"",
          "1053: yy46:",
          "1054:  yych = *++YYCURSOR;",
          "1055:  if (yych == '+') goto yy47;",
          "1057:  if (yych <= '9') goto yy48;",
          "1059: yy47:",
          "1063: yy48:",
          "1068:  if (yych <= '9') goto yy48;",
          "1069:  if (yych >= ';') goto yy18;",
          "1071:  if (yych != '\"') goto yy18;",
          "1073: #line 742 \"ext/standard/var_unserializer.re\"",
          "1075:  size_t len, maxlen;",
          "1076:  char *str;",
          "1078:  len = parse_uiv(start + 2);",
          "1079:  maxlen = max - YYCURSOR;",
          "1080:  if (maxlen < len) {",
          "1082:   return 0;",
          "1083:  }",
          "1085:  str = (char*)YYCURSOR;",
          "1087:  YYCURSOR += len;",
          "1089:  if (*(YYCURSOR) != '\"') {",
          "1094:  if (*(YYCURSOR + 1) != ';') {",
          "1099:  YYCURSOR += 2;",
          "1102:  ZVAL_STRINGL(rval, str, len);",
          "1105: #line 1106 \"ext/standard/var_unserializer.c\"",
          "1106: yy53:",
          "1107:  yych = *++YYCURSOR;",
          "1108:  if (yych <= '/') {",
          "1109:   if (yych <= ',') {",
          "1110:    if (yych == '+') goto yy57;",
          "1111:    goto yy18;",
          "1112:   } else {",
          "1113:    if (yych <= '-') goto yy55;",
          "1114:    if (yych <= '.') goto yy60;",
          "1115:    goto yy18;",
          "1116:   }",
          "1117:  } else {",
          "1118:   if (yych <= 'I') {",
          "1119:    if (yych <= '9') goto yy58;",
          "1120:    if (yych <= 'H') goto yy18;",
          "1121:    goto yy56;",
          "1122:   } else {",
          "1123:    if (yych != 'N') goto yy18;",
          "1124:   }",
          "1125:  }",
          "1127:  if (yych == 'A') goto yy76;",
          "1129: yy55:",
          "1130:  yych = *++YYCURSOR;",
          "1131:  if (yych <= '/') {",
          "1132:   if (yych == '.') goto yy60;",
          "1133:   goto yy18;",
          "1134:  } else {",
          "1135:   if (yych <= '9') goto yy58;",
          "1136:   if (yych != 'I') goto yy18;",
          "1137:  }",
          "1138: yy56:",
          "1140:  if (yych == 'N') goto yy72;",
          "1142: yy57:",
          "1143:  yych = *++YYCURSOR;",
          "1144:  if (yych == '.') goto yy60;",
          "1145:  if (yych <= '/') goto yy18;",
          "1146:  if (yych >= ':') goto yy18;",
          "1147: yy58:",
          "1149:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1150:  yych = *YYCURSOR;",
          "1151:  if (yych <= ':') {",
          "1152:   if (yych <= '.') {",
          "1153:    if (yych <= '-') goto yy18;",
          "1154:    goto yy70;",
          "1155:   } else {",
          "1156:    if (yych <= '/') goto yy18;",
          "1157:    if (yych <= '9') goto yy58;",
          "1158:    goto yy18;",
          "1159:   }",
          "1160:  } else {",
          "1161:   if (yych <= 'E') {",
          "1162:    if (yych <= ';') goto yy63;",
          "1163:    if (yych <= 'D') goto yy18;",
          "1164:    goto yy65;",
          "1165:   } else {",
          "1166:    if (yych == 'e') goto yy65;",
          "1167:    goto yy18;",
          "1168:   }",
          "1169:  }",
          "1170: yy60:",
          "1171:  yych = *++YYCURSOR;",
          "1172:  if (yych <= '/') goto yy18;",
          "1173:  if (yych >= ':') goto yy18;",
          "1174: yy61:",
          "1180:   if (yych <= '9') goto yy61;",
          "1185:    goto yy65;",
          "1187:    if (yych == 'e') goto yy65;",
          "1191: yy63:",
          "1193: #line 733 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "655:  case 'O': goto yy4;",
          "657:  case 'R': goto yy6;",
          "658:  case 'S': goto yy7;",
          "659:  case 'a': goto yy8;",
          "660:  case 'b': goto yy9;",
          "661:  case 'd': goto yy10;",
          "662:  case 'i': goto yy11;",
          "664:  case 'r': goto yy13;",
          "665:  case 's': goto yy14;",
          "666:  case '}': goto yy15;",
          "667:  default: goto yy2;",
          "670:  ++YYCURSOR;",
          "672: #line 990 \"ext/standard/var_unserializer.re\"",
          "674: #line 675 \"ext/standard/var_unserializer.c\"",
          "677:  if (yych == ':') goto yy17;",
          "681:  if (yych == ';') goto yy19;",
          "685:  if (yych == ':') goto yy21;",
          "689:  if (yych == ':') goto yy22;",
          "693:  if (yych == ':') goto yy23;",
          "697:  if (yych == ':') goto yy24;",
          "701:  if (yych == ':') goto yy25;",
          "705:  if (yych == ':') goto yy26;",
          "709:  if (yych == ':') goto yy27;",
          "713:  if (yych == ':') goto yy28;",
          "716:  yych = *(YYMARKER = ++YYCURSOR);",
          "717:  if (yych == ':') goto yy29;",
          "718:  goto yy3;",
          "719: yy15:",
          "721: #line 984 \"ext/standard/var_unserializer.re\"",
          "727: #line 728 \"ext/standard/var_unserializer.c\"",
          "731:   goto yy31;",
          "733:  if (yych == '+') goto yy30;",
          "738:  ++YYCURSOR;",
          "739: #line 668 \"ext/standard/var_unserializer.re\"",
          "740:  {",
          "742:  ZVAL_NULL(rval);",
          "743:  return 1;",
          "744: }",
          "745: #line 746 \"ext/standard/var_unserializer.c\"",
          "746: yy21:",
          "748:  if (yych <= ',') {",
          "749:   if (yych == '+') goto yy33;",
          "750:   goto yy18;",
          "751:  } else {",
          "752:   if (yych <= '-') goto yy33;",
          "753:   if (yych <= '/') goto yy18;",
          "754:   if (yych <= '9') goto yy34;",
          "755:   goto yy18;",
          "757: yy22:",
          "758:  yych = *++YYCURSOR;",
          "759:  if (yych == '+') goto yy36;",
          "760:  if (yych <= '/') goto yy18;",
          "761:  if (yych <= '9') goto yy37;",
          "763: yy23:",
          "764:  yych = *++YYCURSOR;",
          "765:  if (yych == '+') goto yy39;",
          "767:  if (yych <= '9') goto yy40;",
          "768:  goto yy18;",
          "769: yy24:",
          "771:  if (yych <= '/') goto yy18;",
          "772:  if (yych <= '1') goto yy42;",
          "773:  goto yy18;",
          "774: yy25:",
          "775:  yych = *++YYCURSOR;",
          "776:  if (yych <= '/') {",
          "777:   if (yych <= ',') {",
          "778:    if (yych == '+') goto yy43;",
          "779:    goto yy18;",
          "780:   } else {",
          "781:    if (yych <= '-') goto yy44;",
          "782:    if (yych <= '.') goto yy45;",
          "783:    goto yy18;",
          "785:  } else {",
          "786:   if (yych <= 'I') {",
          "787:    if (yych <= '9') goto yy46;",
          "788:    if (yych <= 'H') goto yy18;",
          "789:    goto yy48;",
          "790:   } else {",
          "791:    if (yych == 'N') goto yy49;",
          "792:    goto yy18;",
          "795: yy26:",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych <= ',') {",
          "798:   if (yych == '+') goto yy50;",
          "799:   goto yy18;",
          "800:  } else {",
          "801:   if (yych <= '-') goto yy50;",
          "802:   if (yych <= '/') goto yy18;",
          "803:   if (yych <= '9') goto yy51;",
          "804:   goto yy18;",
          "806: yy27:",
          "807:  yych = *++YYCURSOR;",
          "808:  if (yych <= ',') {",
          "809:   if (yych == '+') goto yy53;",
          "810:   goto yy18;",
          "811:  } else {",
          "812:   if (yych <= '-') goto yy53;",
          "813:   if (yych <= '/') goto yy18;",
          "814:   if (yych <= '9') goto yy54;",
          "815:   goto yy18;",
          "817: yy28:",
          "820:   if (yych == '+') goto yy56;",
          "821:   goto yy18;",
          "823:   if (yych <= '-') goto yy56;",
          "825:   if (yych <= '9') goto yy57;",
          "828: yy29:",
          "830:  if (yych == '+') goto yy59;",
          "832:  if (yych <= '9') goto yy60;",
          "833:  goto yy18;",
          "834: yy30:",
          "835:  yych = *++YYCURSOR;",
          "836:  if (yybm[0+yych] & 128) {",
          "837:   goto yy31;",
          "838:  }",
          "839:  goto yy18;",
          "840: yy31:",
          "844:  if (yybm[0+yych] & 128) {",
          "845:   goto yy31;",
          "846:  }",
          "848:  if (yych <= ':') goto yy62;",
          "849:  goto yy18;",
          "850: yy33:",
          "852:  if (yych <= '/') goto yy18;",
          "853:  if (yych >= ':') goto yy18;",
          "854: yy34:",
          "856:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "857:  yych = *YYCURSOR;",
          "860:  if (yych == ';') goto yy63;",
          "862: yy36:",
          "866: yy37:",
          "871:  if (yych <= '9') goto yy37;",
          "872:  if (yych <= ':') goto yy65;",
          "873:  goto yy18;",
          "874: yy39:",
          "876:  if (yych <= '/') goto yy18;",
          "877:  if (yych >= ':') goto yy18;",
          "878: yy40:",
          "880:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "881:  yych = *YYCURSOR;",
          "882:  if (yych <= '/') goto yy18;",
          "883:  if (yych <= '9') goto yy40;",
          "884:  if (yych <= ':') goto yy66;",
          "885:  goto yy18;",
          "886: yy42:",
          "887:  yych = *++YYCURSOR;",
          "888:  if (yych == ';') goto yy67;",
          "889:  goto yy18;",
          "890: yy43:",
          "891:  yych = *++YYCURSOR;",
          "892:  if (yych == '.') goto yy45;",
          "893:  if (yych <= '/') goto yy18;",
          "894:  if (yych <= '9') goto yy46;",
          "895:  goto yy18;",
          "896: yy44:",
          "897:  yych = *++YYCURSOR;",
          "898:  if (yych <= '/') {",
          "899:   if (yych != '.') goto yy18;",
          "900:  } else {",
          "901:   if (yych <= '9') goto yy46;",
          "902:   if (yych == 'I') goto yy48;",
          "903:   goto yy18;",
          "905: yy45:",
          "906:  yych = *++YYCURSOR;",
          "907:  if (yych <= '/') goto yy18;",
          "908:  if (yych <= '9') goto yy69;",
          "909:  goto yy18;",
          "910: yy46:",
          "911:  ++YYCURSOR;",
          "912:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "913:  yych = *YYCURSOR;",
          "914:  if (yych <= ':') {",
          "915:   if (yych <= '.') {",
          "916:    if (yych <= '-') goto yy18;",
          "917:    goto yy69;",
          "918:   } else {",
          "919:    if (yych <= '/') goto yy18;",
          "920:    if (yych <= '9') goto yy46;",
          "921:    goto yy18;",
          "922:   }",
          "923:  } else {",
          "924:   if (yych <= 'E') {",
          "925:    if (yych <= ';') goto yy71;",
          "926:    if (yych <= 'D') goto yy18;",
          "927:    goto yy73;",
          "928:   } else {",
          "929:    if (yych == 'e') goto yy73;",
          "930:    goto yy18;",
          "931:   }",
          "933: yy48:",
          "934:  yych = *++YYCURSOR;",
          "935:  if (yych == 'N') goto yy74;",
          "936:  goto yy18;",
          "937: yy49:",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych == 'A') goto yy75;",
          "940:  goto yy18;",
          "941: yy50:",
          "944:  if (yych >= ':') goto yy18;",
          "945: yy51:",
          "946:  ++YYCURSOR;",
          "947:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "948:  yych = *YYCURSOR;",
          "949:  if (yych <= '/') goto yy18;",
          "950:  if (yych <= '9') goto yy51;",
          "951:  if (yych == ';') goto yy76;",
          "953: yy53:",
          "957: yy54:",
          "962:  if (yych <= '9') goto yy54;",
          "963:  if (yych <= ':') goto yy78;",
          "964:  goto yy18;",
          "965: yy56:",
          "967:  if (yych <= '/') goto yy18;",
          "968:  if (yych >= ':') goto yy18;",
          "969: yy57:",
          "971:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "972:  yych = *YYCURSOR;",
          "974:  if (yych <= '9') goto yy57;",
          "975:  if (yych == ';') goto yy79;",
          "977: yy59:",
          "981: yy60:",
          "986:  if (yych <= '9') goto yy60;",
          "987:  if (yych <= ':') goto yy81;",
          "988:  goto yy18;",
          "989: yy62:",
          "991:  if (yych == '\"') goto yy82;",
          "992:  goto yy18;",
          "993: yy63:",
          "995: #line 619 \"ext/standard/var_unserializer.re\"",
          "997:  zend_long id;",
          "1000:  if (!var_hash) return 0;",
          "1002:  id = parse_iv(start + 2) - 1;",
          "1003:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1007:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1011:  if (Z_ISREF_P(rval_ref)) {",
          "1012:   ZVAL_COPY(rval, rval_ref);",
          "1013:  } else {",
          "1014:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1015:   ZVAL_COPY(rval, rval_ref);",
          "1016:  }",
          "1020: #line 1021 \"ext/standard/var_unserializer.c\"",
          "1021: yy65:",
          "1023:  if (yych == '\"') goto yy84;",
          "1025: yy66:",
          "1027:  if (yych == '{') goto yy86;",
          "1029: yy67:",
          "1031: #line 674 \"ext/standard/var_unserializer.re\"",
          "1032:  {",
          "1034:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1035:  return 1;",
          "1036: }",
          "1037: #line 1038 \"ext/standard/var_unserializer.c\"",
          "1038: yy69:",
          "1044:   if (yych <= '9') goto yy69;",
          "1049:    goto yy73;",
          "1051:    if (yych == 'e') goto yy73;",
          "1055: yy71:",
          "1057: #line 722 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1199:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1200:  return 1;",
          "1201: }",
          "1204:  yych = *++YYCURSOR;",
          "1205:  if (yych <= ',') {",
          "1207:  } else {",
          "1209:   if (yych <= '/') goto yy18;",
          "1211:   goto yy18;",
          "1212:  }",
          "1214:  yych = *++YYCURSOR;",
          "1230:  goto yy18;",
          "1232:  yych = *++YYCURSOR;",
          "1235:  goto yy18;",
          "1237:  ++YYCURSOR;",
          "1249:   } else {",
          "1252:   }",
          "1253:  }",
          "1258:  yych = *++YYCURSOR;",
          "1260:  ++YYCURSOR;",
          "1262:  {",
          "1273:  }",
          "1275:  return 1;",
          "1276: }",
          "1279:  yych = *++YYCURSOR;",
          "1281:  goto yy18;",
          "1297:  ++YYCURSOR;",
          "1305:  {",
          "1311:  }",
          "1320:    }",
          "1323:   }",
          "1329: }",
          "1337:  ++YYCURSOR;",
          "1339:  {",
          "1342:  return 1;",
          "1343: }",
          "1346:  ++YYCURSOR;",
          "1348:  {",
          "1352: }",
          "1355:  yych = *++YYCURSOR;",
          "1356:  if (yych <= ',') {",
          "1358:  } else {",
          "1360:   if (yych <= '/') goto yy18;",
          "1363:  }",
          "1369:  ++YYCURSOR;",
          "1370:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1371:  yych = *YYCURSOR;",
          "1372:  if (yych <= '/') goto yy18;",
          "1375:  ++YYCURSOR;",
          "1377:  {",
          "1385:   return 0;",
          "1386:  }",
          "1389:   return 0;",
          "1390:  }",
          "1395:  }",
          "1399:  return 1;",
          "1400: }",
          "1412: yy96:",
          "1413:  yych = *++YYCURSOR;",
          "1414:  if (yych <= '/') goto yy18;",
          "1416: yy97:",
          "1417:  ++YYCURSOR;",
          "1425:  {",
          "1443:  } else {",
          "1446:  }",
          "1448:  return 1;",
          "1449: }",
          "1451: }",
          "1455:  return 0;",
          "",
          "[Removed Lines]",
          "1202: #line 1203 \"ext/standard/var_unserializer.c\"",
          "1203: yy65:",
          "1206:   if (yych != '+') goto yy18;",
          "1208:   if (yych <= '-') goto yy66;",
          "1210:   if (yych <= '9') goto yy67;",
          "1213: yy66:",
          "1215:  if (yych <= ',') {",
          "1216:   if (yych == '+') goto yy69;",
          "1217:   goto yy18;",
          "1218:  } else {",
          "1219:   if (yych <= '-') goto yy69;",
          "1220:   if (yych <= '/') goto yy18;",
          "1221:   if (yych >= ':') goto yy18;",
          "1222:  }",
          "1223: yy67:",
          "1224:  ++YYCURSOR;",
          "1225:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1226:  yych = *YYCURSOR;",
          "1227:  if (yych <= '/') goto yy18;",
          "1228:  if (yych <= '9') goto yy67;",
          "1229:  if (yych == ';') goto yy63;",
          "1231: yy69:",
          "1233:  if (yych <= '/') goto yy18;",
          "1234:  if (yych <= '9') goto yy67;",
          "1236: yy70:",
          "1238:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1239:  yych = *YYCURSOR;",
          "1240:  if (yych <= ';') {",
          "1241:   if (yych <= '/') goto yy18;",
          "1242:   if (yych <= '9') goto yy70;",
          "1243:   if (yych <= ':') goto yy18;",
          "1244:   goto yy63;",
          "1245:  } else {",
          "1246:   if (yych <= 'E') {",
          "1247:    if (yych <= 'D') goto yy18;",
          "1248:    goto yy65;",
          "1250:    if (yych == 'e') goto yy65;",
          "1251:    goto yy18;",
          "1254: yy72:",
          "1255:  yych = *++YYCURSOR;",
          "1256:  if (yych != 'F') goto yy18;",
          "1257: yy73:",
          "1259:  if (yych != ';') goto yy18;",
          "1261: #line 717 \"ext/standard/var_unserializer.re\"",
          "1265:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1266:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1267:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1268:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1269:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1270:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1271:  } else {",
          "1272:   ZVAL_NULL(rval);",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "1278: yy76:",
          "1280:  if (yych == 'N') goto yy73;",
          "1282: yy77:",
          "1283:  yych = *++YYCURSOR;",
          "1284:  if (yych <= ',') {",
          "1285:   if (yych != '+') goto yy18;",
          "1286:  } else {",
          "1287:   if (yych <= '-') goto yy78;",
          "1288:   if (yych <= '/') goto yy18;",
          "1289:   if (yych <= '9') goto yy79;",
          "1290:   goto yy18;",
          "1291:  }",
          "1292: yy78:",
          "1293:  yych = *++YYCURSOR;",
          "1294:  if (yych <= '/') goto yy18;",
          "1295:  if (yych >= ':') goto yy18;",
          "1296: yy79:",
          "1298:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1299:  yych = *YYCURSOR;",
          "1300:  if (yych <= '/') goto yy18;",
          "1301:  if (yych <= '9') goto yy79;",
          "1302:  if (yych != ';') goto yy18;",
          "1303:  ++YYCURSOR;",
          "1304: #line 691 \"ext/standard/var_unserializer.re\"",
          "1306: #if SIZEOF_ZEND_LONG == 4",
          "1307:  int digits = YYCURSOR - start - 3;",
          "1309:  if (start[2] == '-' || start[2] == '+') {",
          "1310:   digits--;",
          "1314:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1315:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1316:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1318:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1319:     goto use_double;",
          "1321:   } else {",
          "1322:    goto use_double;",
          "1324:  }",
          "1325: #endif",
          "1327:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1328:  return 1;",
          "1330: #line 1331 \"ext/standard/var_unserializer.c\"",
          "1331: yy83:",
          "1332:  yych = *++YYCURSOR;",
          "1333:  if (yych <= '/') goto yy18;",
          "1334:  if (yych >= '2') goto yy18;",
          "1335:  yych = *++YYCURSOR;",
          "1336:  if (yych != ';') goto yy18;",
          "1338: #line 685 \"ext/standard/var_unserializer.re\"",
          "1341:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1344: #line 1345 \"ext/standard/var_unserializer.c\"",
          "1345: yy87:",
          "1347: #line 679 \"ext/standard/var_unserializer.re\"",
          "1350:  ZVAL_NULL(rval);",
          "1351:  return 1;",
          "1353: #line 1354 \"ext/standard/var_unserializer.c\"",
          "1354: yy89:",
          "1357:   if (yych != '+') goto yy18;",
          "1359:   if (yych <= '-') goto yy90;",
          "1361:   if (yych <= '9') goto yy91;",
          "1362:   goto yy18;",
          "1364: yy90:",
          "1365:  yych = *++YYCURSOR;",
          "1366:  if (yych <= '/') goto yy18;",
          "1367:  if (yych >= ':') goto yy18;",
          "1368: yy91:",
          "1373:  if (yych <= '9') goto yy91;",
          "1374:  if (yych != ';') goto yy18;",
          "1376: #line 654 \"ext/standard/var_unserializer.re\"",
          "1378:  zend_long id;",
          "1381:  if (!var_hash) return 0;",
          "1383:  id = parse_iv(start + 2) - 1;",
          "1384:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1388:  if (rval_ref == rval) {",
          "1392:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1393:   ZVAL_UNDEF(rval);",
          "1394:   return 1;",
          "1397:  ZVAL_COPY(rval, rval_ref);",
          "1401: #line 1402 \"ext/standard/var_unserializer.c\"",
          "1402: yy95:",
          "1403:  yych = *++YYCURSOR;",
          "1404:  if (yych <= ',') {",
          "1405:   if (yych != '+') goto yy18;",
          "1406:  } else {",
          "1407:   if (yych <= '-') goto yy96;",
          "1408:   if (yych <= '/') goto yy18;",
          "1409:   if (yych <= '9') goto yy97;",
          "1410:   goto yy18;",
          "1411:  }",
          "1415:  if (yych >= ':') goto yy18;",
          "1418:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1419:  yych = *YYCURSOR;",
          "1420:  if (yych <= '/') goto yy18;",
          "1421:  if (yych <= '9') goto yy97;",
          "1422:  if (yych != ';') goto yy18;",
          "1423:  ++YYCURSOR;",
          "1424: #line 628 \"ext/standard/var_unserializer.re\"",
          "1426:  zend_long id;",
          "1429:  if (!var_hash) return 0;",
          "1431:  id = parse_iv(start + 2) - 1;",
          "1432:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1433:   return 0;",
          "1434:  }",
          "1436:  zval_ptr_dtor(rval);",
          "1437:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1438:   ZVAL_UNDEF(rval);",
          "1439:   return 1;",
          "1440:  }",
          "1441:  if (Z_ISREF_P(rval_ref)) {",
          "1442:   ZVAL_COPY(rval, rval_ref);",
          "1444:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1445:   ZVAL_COPY(rval, rval_ref);",
          "1450: #line 1451 \"ext/standard/var_unserializer.c\"",
          "1452: #line 1003 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1066: #line 1067 \"ext/standard/var_unserializer.c\"",
          "1067: yy73:",
          "1070:   if (yych == '+') goto yy88;",
          "1071:   goto yy18;",
          "1073:   if (yych <= '-') goto yy88;",
          "1075:   if (yych <= '9') goto yy89;",
          "1078: yy74:",
          "1080:  if (yych == 'F') goto yy91;",
          "1082: yy75:",
          "1084:  if (yych == 'N') goto yy91;",
          "1086: yy76:",
          "1088: #line 680 \"ext/standard/var_unserializer.re\"",
          "1089:  {",
          "1090: #if SIZEOF_ZEND_LONG == 4",
          "1091:  int digits = YYCURSOR - start - 3;",
          "1093:  if (start[2] == '-' || start[2] == '+') {",
          "1094:   digits--;",
          "1095:  }",
          "1098:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1099:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1100:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1102:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1103:     goto use_double;",
          "1104:    }",
          "1106:    goto use_double;",
          "1109: #endif",
          "1111:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1112:  return 1;",
          "1113: }",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "1115: yy78:",
          "1117:  if (yych == '\"') goto yy92;",
          "1118:  goto yy18;",
          "1119: yy79:",
          "1121: #line 644 \"ext/standard/var_unserializer.re\"",
          "1123:  zend_long id;",
          "1126:  if (!var_hash) return 0;",
          "1128:  id = parse_iv(start + 2) - 1;",
          "1129:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1130:   return 0;",
          "1131:  }",
          "1133:  if (rval_ref == rval) {",
          "1134:   return 0;",
          "1137:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1138:   return 0;",
          "1139:  }",
          "1141:  ZVAL_COPY(rval, rval_ref);",
          "1145: #line 1146 \"ext/standard/var_unserializer.c\"",
          "1146: yy81:",
          "1148:  if (yych == '\"') goto yy94;",
          "1150: yy82:",
          "1152: #line 832 \"ext/standard/var_unserializer.re\"",
          "1154:  size_t len, len2, len3, maxlen;",
          "1155:  zend_long elements;",
          "1156:  char *str;",
          "1157:  zend_string *class_name;",
          "1158:  zend_class_entry *ce;",
          "1159:  int incomplete_class = 0;",
          "1161:  int custom_object = 0;",
          "1163:  zval user_func;",
          "1164:  zval retval;",
          "1165:  zval args[1];",
          "1167:     if (!var_hash) return 0;",
          "1168:  if (*start == 'C') {",
          "1169:   custom_object = 1;",
          "1172:  len2 = len = parse_uiv(start + 2);",
          "1173:  maxlen = max - YYCURSOR;",
          "1174:  if (maxlen < len || len == 0) {",
          "1176:   return 0;",
          "1177:  }",
          "1179:  str = (char*)YYCURSOR;",
          "1181:  YYCURSOR += len;",
          "1183:  if (*(YYCURSOR) != '\"') {",
          "1185:   return 0;",
          "1186:  }",
          "1187:  if (*(YYCURSOR+1) != ':') {",
          "1189:   return 0;",
          "1190:  }",
          "1192:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1193:  if (len3 != len)",
          "1194:  {",
          "1196:   return 0;",
          "1197:  }",
          "1199:  class_name = zend_string_init(str, len, 0);",
          "1201:  do {",
          "1202:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "1203:    incomplete_class = 1;",
          "1204:    ce = PHP_IC_ENTRY;",
          "1205:    break;",
          "1206:   }",
          "1209:   BG(serialize_lock)++;",
          "1210:   ce = zend_lookup_class(class_name);",
          "1211:   if (ce) {",
          "1212:    BG(serialize_lock)--;",
          "1213:    if (EG(exception)) {",
          "1214:     zend_string_release(class_name);",
          "1215:     return 0;",
          "1217:    break;",
          "1219:   BG(serialize_lock)--;",
          "1221:   if (EG(exception)) {",
          "1222:    zend_string_release(class_name);",
          "1223:    return 0;",
          "1224:   }",
          "1227:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1228:    incomplete_class = 1;",
          "1229:    ce = PHP_IC_ENTRY;",
          "1230:    break;",
          "1231:   }",
          "1234:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1236:   ZVAL_STR_COPY(&args[0], class_name);",
          "1237:   BG(serialize_lock)++;",
          "1238:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1239:    BG(serialize_lock)--;",
          "1240:    if (EG(exception)) {",
          "1241:     zend_string_release(class_name);",
          "1242:     zval_ptr_dtor(&user_func);",
          "1243:     zval_ptr_dtor(&args[0]);",
          "1244:     return 0;",
          "1245:    }",
          "1246:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1247:    incomplete_class = 1;",
          "1248:    ce = PHP_IC_ENTRY;",
          "1249:    zval_ptr_dtor(&user_func);",
          "1250:    zval_ptr_dtor(&args[0]);",
          "1251:    break;",
          "1252:   }",
          "1253:   BG(serialize_lock)--;",
          "1254:   zval_ptr_dtor(&retval);",
          "1255:   if (EG(exception)) {",
          "1256:    zend_string_release(class_name);",
          "1257:    zval_ptr_dtor(&user_func);",
          "1258:    zval_ptr_dtor(&args[0]);",
          "1259:    return 0;",
          "1260:   }",
          "1263:   BG(serialize_lock)++;",
          "1264:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1265:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1266:    incomplete_class = 1;",
          "1267:    ce = PHP_IC_ENTRY;",
          "1268:   }",
          "1269:   BG(serialize_lock)--;",
          "1271:   zval_ptr_dtor(&user_func);",
          "1272:   zval_ptr_dtor(&args[0]);",
          "1273:   break;",
          "1274:  } while (1);",
          "1278:  if (custom_object) {",
          "1279:   int ret;",
          "1281:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1283:   if (ret && incomplete_class) {",
          "1284:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1285:   }",
          "1286:   zend_string_release(class_name);",
          "1287:   return ret;",
          "1288:  }",
          "1290:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1292:  if (elements < 0) {",
          "1293:     zend_string_release(class_name);",
          "1294:     return 0;",
          "1295:  }",
          "1297:  if (incomplete_class) {",
          "1298:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1299:  }",
          "1300:  zend_string_release(class_name);",
          "1302:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1304: #line 1305 \"ext/standard/var_unserializer.c\"",
          "1305: yy84:",
          "1307: #line 763 \"ext/standard/var_unserializer.re\"",
          "1309:  size_t len, maxlen;",
          "1310:  zend_string *str;",
          "1312:  len = parse_uiv(start + 2);",
          "1313:  maxlen = max - YYCURSOR;",
          "1314:  if (maxlen < len) {",
          "1316:   return 0;",
          "1317:  }",
          "1319:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1320:   return 0;",
          "1321:  }",
          "1323:  if (*(YYCURSOR) != '\"') {",
          "1324:   zend_string_free(str);",
          "1326:   return 0;",
          "1327:  }",
          "1329:  if (*(YYCURSOR + 1) != ';') {",
          "1330:   efree(str);",
          "1332:   return 0;",
          "1333:  }",
          "1335:  YYCURSOR += 2;",
          "1338:  ZVAL_STR(rval, str);",
          "1341: #line 1342 \"ext/standard/var_unserializer.c\"",
          "1342: yy86:",
          "1344: #line 797 \"ext/standard/var_unserializer.re\"",
          "1346:  zend_long elements = parse_iv(start + 2);",
          "1349:     if (!var_hash) return 0;",
          "1351:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1352:   return 0;",
          "1353:  }",
          "1355:  array_init_size(rval, elements);",
          "1356:  if (elements) {",
          "1359:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1360:  }",
          "1362:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1363:   return 0;",
          "1364:  }",
          "1366:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1368: #line 1369 \"ext/standard/var_unserializer.c\"",
          "1369: yy88:",
          "1372:   if (yych == '+') goto yy96;",
          "1373:   goto yy18;",
          "1375:   if (yych <= '-') goto yy96;",
          "1377:   if (yych >= ':') goto yy18;",
          "1379: yy89:",
          "1384:  if (yych <= '9') goto yy89;",
          "1385:  if (yych == ';') goto yy71;",
          "1386:  goto yy18;",
          "1387: yy91:",
          "1388:  yych = *++YYCURSOR;",
          "1389:  if (yych == ';') goto yy97;",
          "1390:  goto yy18;",
          "1391: yy92:",
          "1393: #line 821 \"ext/standard/var_unserializer.re\"",
          "1395:  zend_long elements;",
          "1396:     if (!var_hash) return 0;",
          "1398:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1399:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1400:   return 0;",
          "1401:  }",
          "1402:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1403: }",
          "1404: #line 1405 \"ext/standard/var_unserializer.c\"",
          "1405: yy94:",
          "1406:  ++YYCURSOR;",
          "1407: #line 731 \"ext/standard/var_unserializer.re\"",
          "1408:  {",
          "1409:  size_t len, maxlen;",
          "1410:  char *str;",
          "1412:  len = parse_uiv(start + 2);",
          "1413:  maxlen = max - YYCURSOR;",
          "1414:  if (maxlen < len) {",
          "1419:  str = (char*)YYCURSOR;",
          "1421:  YYCURSOR += len;",
          "1423:  if (*(YYCURSOR) != '\"') {",
          "1428:  if (*(YYCURSOR + 1) != ';') {",
          "1430:   return 0;",
          "1433:  YYCURSOR += 2;",
          "1436:  ZVAL_STRINGL(rval, str, len);",
          "1439: #line 1440 \"ext/standard/var_unserializer.c\"",
          "1443:  if (yych <= '9') goto yy89;",
          "1444:  goto yy18;",
          "1447: #line 706 \"ext/standard/var_unserializer.re\"",
          "1451:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1452:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1453:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1454:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1455:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1456:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1458:   ZVAL_NULL(rval);",
          "1463: #line 1464 \"ext/standard/var_unserializer.c\"",
          "1465: #line 992 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "454:    return 0;",
          "455:   }",
          "467:   zval_dtor(&key);",
          "469:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "",
          "[Removed Lines]",
          "457:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "458:    if (Z_TYPE(key) == IS_LONG) {",
          "459:     zend_hash_index_del(ht, Z_LVAL(key));",
          "460:    } else {",
          "461:     zend_hash_del_ind(ht, Z_STR(key));",
          "462:    }",
          "463:   } else {",
          "464:    var_push_dtor(var_hash, data);",
          "465:   }",
          "",
          "[Added Lines]",
          "457:   var_push_dtor(var_hash, data);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "636:   return 0;",
          "637:  }",
          "640:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "643:  }",
          "644:  if (Z_ISREF_P(rval_ref)) {",
          "645:   ZVAL_COPY(rval, rval_ref);",
          "646:  } else {",
          "",
          "[Removed Lines]",
          "639:  zval_ptr_dtor(rval);",
          "641:   ZVAL_UNDEF(rval);",
          "642:   return 1;",
          "",
          "[Added Lines]",
          "631:   return 0;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "667:  }",
          "669:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "672:  }",
          "674:  ZVAL_COPY(rval, rval_ref);",
          "",
          "[Removed Lines]",
          "670:   ZVAL_UNDEF(rval);",
          "671:   return 1;",
          "",
          "[Added Lines]",
          "660:   return 0;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fe1a3fc08bf47b8d484922d698975f134c7e9e3b",
      "candidate_info": {
        "commit_hash": "fe1a3fc08bf47b8d484922d698975f134c7e9e3b",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/fe1a3fc08bf47b8d484922d698975f134c7e9e3b",
        "files": [
          "Zend/tests/bug71841.phpt",
          "Zend/zend_vm_def.h",
          "Zend/zend_vm_execute.h",
          "ext/standard/tests/serialize/bug71840.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-5.6' into PHP-7.0\n\n* PHP-5.6:\n  Fixed bug #71841 (EG(error_zval) is not handled well)\n  Fixed bug #71840 (Unserialize accepts wrongly data)\n\nConflicts:\n\tZend/zend_vm_def.h\n\tZend/zend_vm_execute.h\n\text/standard/var_unserializer.c",
        "before_after_code_files": [
          "Zend/tests/bug71841.phpt||Zend/tests/bug71841.phpt",
          "Zend/zend_vm_def.h||Zend/zend_vm_def.h",
          "ext/standard/tests/serialize/bug71840.phpt||ext/standard/tests/serialize/bug71840.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/tests/bug71841.phpt||Zend/tests/bug71841.phpt": [
          "File: Zend/tests/bug71841.phpt -> Zend/tests/bug71841.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #71841 (EG(error_zval) is not handled well)",
          "3: --INI--",
          "4: error_reporting=0",
          "5: --FILE--",
          "6: <?php",
          "7: $z = unserialize('O:1:\"A\":0:{}');",
          "8: var_dump($z->e.=0);",
          "9: var_dump(++$z->x);",
          "10: var_dump($z->y++);",
          "12: $y = array(PHP_INT_MAX => 0);",
          "13: var_dump($y[] .= 0);",
          "14: var_dump(++$y[]);",
          "15: var_dump($y[]++);",
          "16: ?>",
          "17: --EXPECT--",
          "18: NULL",
          "19: NULL",
          "20: NULL",
          "21: NULL",
          "22: NULL",
          "23: NULL",
          "",
          "---------------"
        ],
        "Zend/zend_vm_def.h||Zend/zend_vm_def.h": [
          "File: Zend/zend_vm_def.h -> Zend/zend_vm_def.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "745:   if (EXPECTED(Z_OBJ_HT_P(object)->get_property_ptr_ptr)",
          "746:    && EXPECTED((zptr = Z_OBJ_HT_P(object)->get_property_ptr_ptr(object, property, BP_VAR_RW, ((OP2_TYPE == IS_CONST) ? CACHE_ADDR(Z_CACHE_SLOT_P(property)) : NULL))) != NULL)) {",
          "754:    }",
          "755:   } else {",
          "756:    zend_assign_op_overloaded_property(object, property, ((OP2_TYPE == IS_CONST) ? CACHE_ADDR(Z_CACHE_SLOT_P(property)) : NULL), value, binary_op, (UNEXPECTED(RETURN_VALUE_USED(opline)) ? EX_VAR(opline->result.var) : NULL));",
          "",
          "[Removed Lines]",
          "748:    ZVAL_DEREF(zptr);",
          "749:    SEPARATE_ZVAL_NOREF(zptr);",
          "751:    binary_op(zptr, zptr, value);",
          "752:    if (UNEXPECTED(RETURN_VALUE_USED(opline))) {",
          "753:     ZVAL_COPY(EX_VAR(opline->result.var), zptr);",
          "",
          "[Added Lines]",
          "747:    if (UNEXPECTED(zptr == &EG(error_zval))) {",
          "748:     if (UNEXPECTED(RETURN_VALUE_USED(opline))) {",
          "749:      ZVAL_NULL(EX_VAR(opline->result.var));",
          "750:     }",
          "751:    } else {",
          "752:     ZVAL_DEREF(zptr);",
          "753:     SEPARATE_ZVAL_NOREF(zptr);",
          "755:     binary_op(zptr, zptr, value);",
          "756:     if (UNEXPECTED(RETURN_VALUE_USED(opline))) {",
          "757:      ZVAL_COPY(EX_VAR(opline->result.var), zptr);",
          "758:     }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1150:   }",
          "1154:   if (EXPECTED(Z_OBJ_HT_P(object)->get_property_ptr_ptr)",
          "1155:    && EXPECTED((zptr = Z_OBJ_HT_P(object)->get_property_ptr_ptr(object, property, BP_VAR_RW, ((OP2_TYPE == IS_CONST) ? CACHE_ADDR(Z_CACHE_SLOT_P(property)) : NULL))) != NULL)) {",
          "1162:     }",
          "1163:    } else {",
          "1169:     } else {",
          "1171:     }",
          "1175:    }",
          "1176:   } else {",
          "1177:    zend_pre_incdec_overloaded_property(object, property, ((OP2_TYPE == IS_CONST) ? CACHE_ADDR(Z_CACHE_SLOT_P(property)) : NULL), inc, (UNEXPECTED(RETURN_VALUE_USED(opline)) ? EX_VAR(opline->result.var) : NULL));",
          "",
          "[Removed Lines]",
          "1157:    if (EXPECTED(Z_TYPE_P(zptr) == IS_LONG)) {",
          "1158:     if (inc) {",
          "1159:      fast_long_increment_function(zptr);",
          "1160:     } else {",
          "1161:      fast_long_decrement_function(zptr);",
          "1164:     ZVAL_DEREF(zptr);",
          "1165:     SEPARATE_ZVAL_NOREF(zptr);",
          "1167:     if (inc) {",
          "1168:      increment_function(zptr);",
          "1170:      decrement_function(zptr);",
          "1172:    }",
          "1173:    if (UNEXPECTED(RETURN_VALUE_USED(opline))) {",
          "1174:     ZVAL_COPY(EX_VAR(opline->result.var), zptr);",
          "",
          "[Added Lines]",
          "1160:    if (UNEXPECTED(zptr == &EG(error_zval))) {",
          "1161:     if (UNEXPECTED(RETURN_VALUE_USED(opline))) {",
          "1162:      ZVAL_NULL(EX_VAR(opline->result.var));",
          "1165:     if (EXPECTED(Z_TYPE_P(zptr) == IS_LONG)) {",
          "1166:      if (inc) {",
          "1167:       fast_long_increment_function(zptr);",
          "1168:      } else {",
          "1169:       fast_long_decrement_function(zptr);",
          "1170:      }",
          "1172:      ZVAL_DEREF(zptr);",
          "1173:      SEPARATE_ZVAL_NOREF(zptr);",
          "1175:      if (inc) {",
          "1176:       increment_function(zptr);",
          "1177:      } else {",
          "1178:       decrement_function(zptr);",
          "1179:      }",
          "1180:     }",
          "1181:     if (UNEXPECTED(RETURN_VALUE_USED(opline))) {",
          "1182:      ZVAL_COPY(EX_VAR(opline->result.var), zptr);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1233:   if (EXPECTED(Z_OBJ_HT_P(object)->get_property_ptr_ptr)",
          "1234:    && EXPECTED((zptr = Z_OBJ_HT_P(object)->get_property_ptr_ptr(object, property, BP_VAR_RW, ((OP2_TYPE == IS_CONST) ? CACHE_ADDR(Z_CACHE_SLOT_P(property)) : NULL))) != NULL)) {",
          "1243:    } else {",
          "1249:     } else {",
          "1251:     }",
          "1252:    }",
          "1253:   } else {",
          "",
          "[Removed Lines]",
          "1236:    if (EXPECTED(Z_TYPE_P(zptr) == IS_LONG)) {",
          "1237:     ZVAL_COPY_VALUE(EX_VAR(opline->result.var), zptr);",
          "1238:     if (inc) {",
          "1239:      fast_long_increment_function(zptr);",
          "1240:     } else {",
          "1241:      fast_long_decrement_function(zptr);",
          "1242:     }",
          "1244:     ZVAL_DEREF(zptr);",
          "1245:     ZVAL_COPY_VALUE(EX_VAR(opline->result.var), zptr);",
          "1246:     zval_opt_copy_ctor(zptr);",
          "1247:     if (inc) {",
          "1248:      increment_function(zptr);",
          "1250:      decrement_function(zptr);",
          "",
          "[Added Lines]",
          "1244:    if (UNEXPECTED(zptr == &EG(error_zval))) {",
          "1245:     ZVAL_NULL(EX_VAR(opline->result.var));",
          "1247:     if (EXPECTED(Z_TYPE_P(zptr) == IS_LONG)) {",
          "1248:      ZVAL_COPY_VALUE(EX_VAR(opline->result.var), zptr);",
          "1249:      if (inc) {",
          "1250:       fast_long_increment_function(zptr);",
          "1251:      } else {",
          "1252:       fast_long_decrement_function(zptr);",
          "1253:      }",
          "1255:      ZVAL_DEREF(zptr);",
          "1256:      ZVAL_COPY_VALUE(EX_VAR(opline->result.var), zptr);",
          "1257:      zval_opt_copy_ctor(zptr);",
          "1258:      if (inc) {",
          "1259:       increment_function(zptr);",
          "1260:      } else {",
          "1261:       decrement_function(zptr);",
          "1262:      }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug71840.phpt||ext/standard/tests/serialize/bug71840.phpt": [
          "File: ext/standard/tests/serialize/bug71840.phpt -> ext/standard/tests/serialize/bug71840.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #71840 (Unserialize accepts wrongly data)",
          "3: --FILE--",
          "4: <?php",
          "5: var_dump(unserialize('a:1:{s:0:\"\"0a:0:{}}'));",
          "6: ?>",
          "7: --EXPECTF--",
          "8: Notice: unserialize(): Error at offset 11 of 19 bytes in %sbug71840.php on line %d",
          "9: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "574:  yych = *(YYMARKER = ++YYCURSOR);",
          "575:  if (yych == ':') goto yy95;",
          "576: yy3:",
          "578:  { return 0; }",
          "579: #line 580 \"ext/standard/var_unserializer.c\"",
          "580: yy4:",
          "",
          "[Removed Lines]",
          "577: #line 873 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "577: #line 884 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "619:  goto yy3;",
          "620: yy14:",
          "621:  ++YYCURSOR;",
          "623:  {",
          "625:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "",
          "[Removed Lines]",
          "622: #line 867 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "622: #line 878 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "655:  yych = *++YYCURSOR;",
          "656:  if (yych != '\"') goto yy18;",
          "657:  ++YYCURSOR;",
          "659:  {",
          "660:  size_t len, len2, len3, maxlen;",
          "661:  zend_long elements;",
          "",
          "[Removed Lines]",
          "658: #line 722 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "658: #line 733 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "825:  yych = *++YYCURSOR;",
          "826:  if (yych != '\"') goto yy18;",
          "827:  ++YYCURSOR;",
          "829:  {",
          "830:     if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "828: #line 715 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "828: #line 726 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "853:  yych = *++YYCURSOR;",
          "854:  if (yych != '{') goto yy18;",
          "855:  ++YYCURSOR;",
          "857:  {",
          "858:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "856: #line 691 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "856: #line 702 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "898:  yych = *++YYCURSOR;",
          "899:  if (yych != '\"') goto yy18;",
          "900:  ++YYCURSOR;",
          "902:  {",
          "903:  size_t len, maxlen;",
          "904:  zend_string *str;",
          "",
          "[Removed Lines]",
          "901: #line 663 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "901: #line 668 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "920:   return 0;",
          "921:  }",
          "923:  YYCURSOR += 2;",
          "926:  ZVAL_STR(rval, str);",
          "927:  return 1;",
          "928: }",
          "930: yy46:",
          "931:  yych = *++YYCURSOR;",
          "932:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "929: #line 930 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "923:  if (*(YYCURSOR + 1) != ';') {",
          "924:   efree(str);",
          "926:   return 0;",
          "927:  }",
          "935: #line 936 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "968:   return 0;",
          "969:  }",
          "971:  YYCURSOR += 2;",
          "974:  ZVAL_STRINGL(rval, str, len);",
          "975:  return 1;",
          "976: }",
          "978: yy53:",
          "979:  yych = *++YYCURSOR;",
          "980:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "977:  if (*(YYCURSOR + 1) != ';') {",
          "979:   return 0;",
          "980:  }",
          "988: #line 989 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "1071:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1072:  return 1;",
          "1073: }",
          "1075: yy65:",
          "1076:  yych = *++YYCURSOR;",
          "1077:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1074: #line 1075 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1085: #line 1086 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1147:  return 1;",
          "1148: }",
          "1150: yy76:",
          "1151:  yych = *++YYCURSOR;",
          "1152:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1149: #line 1150 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1160: #line 1161 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1199:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1200:  return 1;",
          "1201: }",
          "1203: yy83:",
          "1204:  yych = *++YYCURSOR;",
          "1205:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1202: #line 1203 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1213: #line 1214 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1213:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1214:  return 1;",
          "1215: }",
          "1217: yy87:",
          "1218:  ++YYCURSOR;",
          "1219: #line 573 \"ext/standard/var_unserializer.re\"",
          "",
          "[Removed Lines]",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1227: #line 1228 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1222:  ZVAL_NULL(rval);",
          "1223:  return 1;",
          "1224: }",
          "1226: yy89:",
          "1227:  yych = *++YYCURSOR;",
          "1228:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1236: #line 1237 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1271:  return 1;",
          "1272: }",
          "1274: yy95:",
          "1275:  yych = *++YYCURSOR;",
          "1276:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1273: #line 1274 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1320:  return 1;",
          "1321: }",
          "1323: }",
          "1327:  return 0;",
          "",
          "[Removed Lines]",
          "1322: #line 1323 \"ext/standard/var_unserializer.c\"",
          "1324: #line 875 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1333: #line 1334 \"ext/standard/var_unserializer.c\"",
          "1335: #line 886 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "653:   return 0;",
          "654:  }",
          "656:  YYCURSOR += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "656:  if (*(YYCURSOR + 1) != ';') {",
          "658:   return 0;",
          "659:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "681:   return 0;",
          "682:  }",
          "684:  YYCURSOR += 2;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "689:  if (*(YYCURSOR + 1) != ';') {",
          "690:   efree(str);",
          "692:   return 0;",
          "693:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9152214c1e20723f73b5f7b6c77b1183327bcf69",
      "candidate_info": {
        "commit_hash": "9152214c1e20723f73b5f7b6c77b1183327bcf69",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/9152214c1e20723f73b5f7b6c77b1183327bcf69",
        "files": [
          "ext/standard/tests/serialize/bug68594.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-5.6'\n\n* PHP-5.6:\n  update news\n  add CVE\n  add missing test file\n  Fix bug #68594 - Use after free vulnerability in unserialize()\n\nConflicts:\n\text/standard/var_unserializer.c\n\text/standard/var_unserializer.re",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt": [
          "File: ext/standard/tests/serialize/bug68594.phpt -> ext/standard/tests/serialize/bug68594.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68545 Use after free vulnerability in unserialize()",
          "3: --FILE--",
          "4: <?php",
          "5: for ($i=4; $i<100; $i++) {",
          "6:  $m = new StdClass();",
          "8:  $u = array(1);",
          "10:  $m->aaa = array(1,2,&$u,4,5);",
          "11:  $m->bbb = 1;",
          "12:  $m->ccc = &$u;",
          "13:  $m->ddd = str_repeat(\"A\", $i);",
          "15:  $z = serialize($m);",
          "16:  $z = str_replace(\"bbb\", \"aaa\", $z);",
          "17:  $y = unserialize($z);",
          "18:  $z = serialize($y);",
          "19: }",
          "20: ?>",
          "21: ===DONE===",
          "22: --EXPECTF--",
          "23: ===DONE===",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "362:   } else {",
          "364:    convert_to_string(&key);",
          "372:     }",
          "380:   }",
          "382:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "366: #if 1",
          "367:    data = zend_hash_update_ind(ht, Z_STR(key), &d);",
          "368: #else",
          "369:    if ((data = zend_hash_find(ht, Z_STR(key))) != NULL) {",
          "370:     if (Z_TYPE_P(data) == IS_INDIRECT) {",
          "371:      data = Z_INDIRECT_P(data);",
          "373:     zval_ptr_dtor(data);",
          "375:     ZVAL_UNDEF(data);",
          "376:    } else {",
          "377:     data = zend_hash_update(ht, Z_STR(key), &d);",
          "378:    }",
          "379: #endif",
          "",
          "[Added Lines]",
          "365:    if ((old_data = zend_hash_find(ht, Z_STR(key))) != NULL) {",
          "366:     if (Z_TYPE_P(old_data) == IS_INDIRECT) {",
          "367:      old_data = Z_INDIRECT_P(old_data);",
          "369:     zval_ptr_dtor(old_data);",
          "370:     var_push_dtor(var_hash, old_data);",
          "371:     ZVAL_UNDEF(old_data);",
          "372:    }",
          "373:    data = zend_hash_update(ht, Z_STR(key), &d);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "515:  start = cursor;",
          "519: {",
          "520:  YYCTYPE yych;",
          "521:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "518: #line 519 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "512: #line 513 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "575:  yych = *(YYMARKER = ++YYCURSOR);",
          "576:  if (yych == ':') goto yy95;",
          "577: yy3:",
          "579:  { return 0; }",
          "581: yy4:",
          "582:  yych = *(YYMARKER = ++YYCURSOR);",
          "583:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "578: #line 866 \"ext/standard/var_unserializer.re\"",
          "580: #line 581 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "572: #line 860 \"ext/standard/var_unserializer.re\"",
          "574: #line 575 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "620:  goto yy3;",
          "621: yy14:",
          "622:  ++YYCURSOR;",
          "624:  {",
          "626:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "628: }",
          "630: yy16:",
          "631:  yych = *++YYCURSOR;",
          "632:  goto yy3;",
          "",
          "[Removed Lines]",
          "623: #line 860 \"ext/standard/var_unserializer.re\"",
          "629: #line 630 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "617: #line 854 \"ext/standard/var_unserializer.re\"",
          "623: #line 624 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "652:  if (yybm[0+yych] & 128) {",
          "653:   goto yy20;",
          "654:  }",
          "656:  yych = *++YYCURSOR;",
          "657:  if (yych != '\"') goto yy18;",
          "658:  ++YYCURSOR;",
          "660:  {",
          "661:  size_t len, len2, len3, maxlen;",
          "662:  zend_long elements;",
          "",
          "[Removed Lines]",
          "655:  if (yych != ':') goto yy18;",
          "659: #line 715 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "649:  if (yych <= '/') goto yy18;",
          "650:  if (yych >= ';') goto yy18;",
          "654: #line 709 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "802:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "803: }",
          "805: yy25:",
          "806:  yych = *++YYCURSOR;",
          "807:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "804: #line 805 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "799: #line 800 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "826:  yych = *++YYCURSOR;",
          "827:  if (yych != '\"') goto yy18;",
          "828:  ++YYCURSOR;",
          "830:  {",
          "",
          "[Removed Lines]",
          "829: #line 707 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "824: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "834:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "835:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "836: }",
          "838: yy32:",
          "839:  yych = *++YYCURSOR;",
          "840:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "837: #line 838 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "832: #line 833 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "855:  yych = *++YYCURSOR;",
          "856:  if (yych != '{') goto yy18;",
          "857:  ++YYCURSOR;",
          "859:  {",
          "860:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "858: #line 686 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "853: #line 680 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "877:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "878: }",
          "880: yy39:",
          "881:  yych = *++YYCURSOR;",
          "882:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "879: #line 880 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "874: #line 875 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "897:  yych = *++YYCURSOR;",
          "898:  if (yych != '\"') goto yy18;",
          "899:  ++YYCURSOR;",
          "901:  {",
          "902:  size_t len, maxlen;",
          "903:  zend_string *str;",
          "",
          "[Removed Lines]",
          "900: #line 658 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "895: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "925:  ZVAL_STR(rval, str);",
          "926:  return 1;",
          "927: }",
          "929: yy46:",
          "930:  yych = *++YYCURSOR;",
          "931:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "928: #line 929 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "923: #line 924 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "946:  yych = *++YYCURSOR;",
          "947:  if (yych != '\"') goto yy18;",
          "948:  ++YYCURSOR;",
          "950:  {",
          "951:  size_t len, maxlen;",
          "952:  char *str;",
          "",
          "[Removed Lines]",
          "949: #line 631 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "944: #line 625 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "973:  ZVAL_STRINGL(rval, str, len);",
          "974:  return 1;",
          "975: }",
          "977: yy53:",
          "978:  yych = *++YYCURSOR;",
          "979:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "976: #line 977 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "971: #line 972 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1061:  }",
          "1062: yy63:",
          "1063:  ++YYCURSOR;",
          "1065:  {",
          "1066: #if SIZEOF_ZEND_LONG == 4",
          "1067: use_double:",
          "",
          "[Removed Lines]",
          "1064: #line 622 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1059: #line 616 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1070:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1071:  return 1;",
          "1072: }",
          "1074: yy65:",
          "1075:  yych = *++YYCURSOR;",
          "1076:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1073: #line 1074 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1129:  yych = *++YYCURSOR;",
          "1130:  if (yych != ';') goto yy18;",
          "1131:  ++YYCURSOR;",
          "1133:  {",
          "",
          "[Removed Lines]",
          "1132: #line 606 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1127: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1146:  return 1;",
          "1147: }",
          "1149: yy76:",
          "1150:  yych = *++YYCURSOR;",
          "1151:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1148: #line 1149 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1143: #line 1144 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1172:  if (yych <= '9') goto yy79;",
          "1173:  if (yych != ';') goto yy18;",
          "1174:  ++YYCURSOR;",
          "1176:  {",
          "1177: #if SIZEOF_ZEND_LONG == 4",
          "1178:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1175: #line 580 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1170: #line 574 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1198:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1199:  return 1;",
          "1200: }",
          "1202: yy83:",
          "1203:  yych = *++YYCURSOR;",
          "1204:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1201: #line 1202 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1206:  yych = *++YYCURSOR;",
          "1207:  if (yych != ';') goto yy18;",
          "1208:  ++YYCURSOR;",
          "1210:  {",
          "1212:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1213:  return 1;",
          "1214: }",
          "1216: yy87:",
          "1217:  ++YYCURSOR;",
          "1219:  {",
          "1221:  ZVAL_NULL(rval);",
          "1222:  return 1;",
          "1223: }",
          "1225: yy89:",
          "1226:  yych = *++YYCURSOR;",
          "1227:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1209: #line 574 \"ext/standard/var_unserializer.re\"",
          "1215: #line 1216 \"ext/standard/var_unserializer.c\"",
          "1218: #line 568 \"ext/standard/var_unserializer.re\"",
          "1224: #line 1225 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1204: #line 568 \"ext/standard/var_unserializer.re\"",
          "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
          "1213: #line 562 \"ext/standard/var_unserializer.re\"",
          "1219: #line 1220 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1244:  if (yych <= '9') goto yy91;",
          "1245:  if (yych != ';') goto yy18;",
          "1246:  ++YYCURSOR;",
          "1248:  {",
          "1249:  zend_long id;",
          "",
          "[Removed Lines]",
          "1247: #line 545 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1242: #line 539 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1268:  return 1;",
          "1269: }",
          "1271: yy95:",
          "1272:  yych = *++YYCURSOR;",
          "1273:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1270: #line 1271 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1265: #line 1266 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1290:  if (yych <= '9') goto yy97;",
          "1291:  if (yych != ';') goto yy18;",
          "1292:  ++YYCURSOR;",
          "1294:  {",
          "1295:  zend_long id;",
          "",
          "[Removed Lines]",
          "1293: #line 523 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1288: #line 517 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1313:  return 1;",
          "1314: }",
          "1316: }",
          "1320:  return 0;",
          "",
          "[Removed Lines]",
          "1315: #line 1316 \"ext/standard/var_unserializer.c\"",
          "1317: #line 868 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
          "1312: #line 862 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "366:   } else {",
          "368:    convert_to_string(&key);",
          "376:     }",
          "384:   }",
          "386:   zval_dtor(&key);",
          "",
          "[Removed Lines]",
          "370: #if 1",
          "371:    data = zend_hash_update_ind(ht, Z_STR(key), &d);",
          "372: #else",
          "373:    if ((data = zend_hash_find(ht, Z_STR(key))) != NULL) {",
          "374:     if (Z_TYPE_P(data) == IS_INDIRECT) {",
          "375:      data = Z_INDIRECT_P(data);",
          "377:     zval_ptr_dtor(data);",
          "379:     ZVAL_UNDEF(data);",
          "380:    } else {",
          "381:     data = zend_hash_update(ht, Z_STR(key), &d);",
          "382:    }",
          "383: #endif",
          "",
          "[Added Lines]",
          "369:    if ((old_data = zend_hash_find(ht, Z_STR(key))) != NULL) {",
          "370:     if (Z_TYPE_P(old_data) == IS_INDIRECT) {",
          "371:      old_data = Z_INDIRECT_P(old_data);",
          "373:     zval_ptr_dtor(old_data);",
          "374:     var_push_dtor(var_hash, old_data);",
          "375:     ZVAL_UNDEF(old_data);",
          "376:    }",
          "377:    data = zend_hash_update(ht, Z_STR(key), &d);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9d7c5dbed941c4d4c18d7d5ed308a07897b7596d",
      "candidate_info": {
        "commit_hash": "9d7c5dbed941c4d4c18d7d5ed308a07897b7596d",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/9d7c5dbed941c4d4c18d7d5ed308a07897b7596d",
        "files": [
          "ext/standard/php_var.h",
          "ext/standard/tests/serialize/serialization_error_001.phpt",
          "ext/standard/tests/serialize/unserialize_classes.phpt",
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "secured unserialize\n\n- update for BC-compatible unserialize\n- add tests",
        "before_after_code_files": [
          "ext/standard/php_var.h||ext/standard/php_var.h",
          "ext/standard/tests/serialize/serialization_error_001.phpt||ext/standard/tests/serialize/serialization_error_001.phpt",
          "ext/standard/tests/serialize/unserialize_classes.phpt||ext/standard/tests/serialize/unserialize_classes.phpt",
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/php_var.h||ext/standard/php_var.h": [
          "File: ext/standard/php_var.h -> ext/standard/php_var.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "57: PHPAPI int php_var_unserialize(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "58: PHPAPI int php_var_unserialize_ref(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "59: PHPAPI int php_var_unserialize_intern(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "61: #define PHP_VAR_SERIALIZE_INIT(d) \\",
          "62: do  { \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "60: PHPAPI int php_var_unserialize_ex(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash, HashTable *classes TSRMLS_DC);",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/serialization_error_001.phpt||ext/standard/tests/serialize/serialization_error_001.phpt": [
          "File: ext/standard/tests/serialize/serialization_error_001.phpt -> ext/standard/tests/serialize/serialization_error_001.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "23: var_dump( serialize(1,2) );",
          "26: echo \"Done\";",
          "27: ?>",
          "",
          "[Removed Lines]",
          "24: var_dump( unserialize(1,2) );",
          "",
          "[Added Lines]",
          "24: var_dump( unserialize(1,2,3) );",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "31: Warning: serialize() expects exactly 1 parameter, 0 given in %s on line 16",
          "32: NULL",
          "35: bool(false)",
          "37: Warning: serialize() expects exactly 1 parameter, 2 given in %s on line 20",
          "38: NULL",
          "41: bool(false)",
          "42: Done",
          "",
          "[Removed Lines]",
          "34: Warning: unserialize() expects exactly 1 parameter, 0 given in %s on line 17",
          "40: Warning: unserialize() expects exactly 1 parameter, 2 given in %s on line 21",
          "",
          "[Added Lines]",
          "34: Warning: unserialize() expects at least 1 parameter, 0 given in %s on line 17",
          "40: Warning: unserialize() expects at most 2 parameters, 3 given in %s on line 21",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/unserialize_classes.phpt||ext/standard/tests/serialize/unserialize_classes.phpt": [
          "File: ext/standard/tests/serialize/unserialize_classes.phpt -> ext/standard/tests/serialize/unserialize_classes.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Test unserialize() with second parameter",
          "3: --FILE--",
          "4: <?php",
          "5: class foo {",
          "6:         public $x = \"bar\";",
          "7: }",
          "8: $z = array(new foo(), 2, \"3\");",
          "9: $s = serialize($z);",
          "11: var_dump(unserialize($s));",
          "12: var_dump(unserialize($s, [\"allowed_classes\" => false]));",
          "13: var_dump(unserialize($s, [\"allowed_classes\" => true]));",
          "14: var_dump(unserialize($s, [\"allowed_classes\" => [\"bar\"]]));",
          "15: var_dump(unserialize($s, [\"allowed_classes\" => [\"FOO\"]]));",
          "16: var_dump(unserialize($s, [\"allowed_classes\" => [\"bar\", \"foO\"]]));",
          "18: --EXPECTF--",
          "19: array(3) {",
          "20:   [0]=>",
          "21:   object(foo)#%d (1) {",
          "22:     [\"x\"]=>",
          "23:     string(3) \"bar\"",
          "24:   }",
          "25:   [1]=>",
          "26:   int(2)",
          "27:   [2]=>",
          "28:   string(1) \"3\"",
          "29: }",
          "30: array(3) {",
          "31:   [0]=>",
          "32:   object(__PHP_Incomplete_Class)#%d (2) {",
          "33:     [\"__PHP_Incomplete_Class_Name\"]=>",
          "34:     string(3) \"foo\"",
          "35:     [\"x\"]=>",
          "36:     string(3) \"bar\"",
          "37:   }",
          "38:   [1]=>",
          "39:   int(2)",
          "40:   [2]=>",
          "41:   string(1) \"3\"",
          "42: }",
          "43: array(3) {",
          "44:   [0]=>",
          "45:   object(foo)#%d (1) {",
          "46:     [\"x\"]=>",
          "47:     string(3) \"bar\"",
          "48:   }",
          "49:   [1]=>",
          "50:   int(2)",
          "51:   [2]=>",
          "52:   string(1) \"3\"",
          "53: }",
          "54: array(3) {",
          "55:   [0]=>",
          "56:   object(__PHP_Incomplete_Class)#%d (2) {",
          "57:     [\"__PHP_Incomplete_Class_Name\"]=>",
          "58:     string(3) \"foo\"",
          "59:     [\"x\"]=>",
          "60:     string(3) \"bar\"",
          "61:   }",
          "62:   [1]=>",
          "63:   int(2)",
          "64:   [2]=>",
          "65:   string(1) \"3\"",
          "66: }",
          "67: array(3) {",
          "68:   [0]=>",
          "69:   object(foo)#%d (1) {",
          "70:     [\"x\"]=>",
          "71:     string(3) \"bar\"",
          "72:   }",
          "73:   [1]=>",
          "74:   int(2)",
          "75:   [2]=>",
          "76:   string(1) \"3\"",
          "77: }",
          "78: array(3) {",
          "79:   [0]=>",
          "80:   object(foo)#%d (1) {",
          "81:     [\"x\"]=>",
          "82:     string(3) \"bar\"",
          "83:   }",
          "84:   [1]=>",
          "85:   int(2)",
          "86:   [2]=>",
          "87:   string(1) \"3\"",
          "88: }",
          "",
          "---------------"
        ],
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "998:  size_t buf_len;",
          "999:  const unsigned char *p;",
          "1000:  php_unserialize_data_t var_hash;",
          "1003:   RETURN_FALSE;",
          "1004:  }",
          "",
          "[Removed Lines]",
          "1002:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &buf, &buf_len) == FAILURE) {",
          "",
          "[Added Lines]",
          "1001:  zval *options = NULL, *classes = NULL;",
          "1002:  HashTable *class_hash = NULL;",
          "1004:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s|a\", &buf, &buf_len, &options) == FAILURE) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1010:  p = (const unsigned char*) buf;",
          "1011:  PHP_VAR_UNSERIALIZE_INIT(var_hash);",
          "1013:   PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1014:   zval_dtor(return_value);",
          "1015:   if (!EG(exception)) {",
          "1016:    php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Error at offset \" ZEND_LONG_FMT \" of %d bytes\", (zend_long)((char*)p - buf), buf_len);",
          "",
          "[Removed Lines]",
          "1012:  if (!php_var_unserialize(return_value, &p, p + buf_len, &var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "1014:  if(options != NULL) {",
          "1015:   classes = zend_hash_str_find(Z_ARRVAL_P(options), \"allowed_classes\", sizeof(\"allowed_classes\")-1);",
          "1016:   if(classes && (Z_TYPE_P(classes) == IS_ARRAY || !zend_is_true(classes TSRMLS_CC))) {",
          "1017:    ALLOC_HASHTABLE(class_hash);",
          "1018:    zend_hash_init(class_hash, (Z_TYPE_P(classes) == IS_ARRAY)?zend_hash_num_elements(Z_ARRVAL_P(classes)):0, NULL, NULL, 0);",
          "1019:   }",
          "1020:   if(class_hash && Z_TYPE_P(classes) == IS_ARRAY) {",
          "1021:    zval *entry;",
          "1022:    zend_string *lcname;",
          "1024:    ZEND_HASH_FOREACH_VAL(Z_ARRVAL_P(classes), entry) {",
          "1025:     convert_to_string_ex(entry);",
          "1026:     lcname = zend_string_alloc(Z_STRLEN_P(entry), 0);",
          "1027:     zend_str_tolower_copy(lcname->val, Z_STRVAL_P(entry), Z_STRLEN_P(entry));",
          "1028:     zend_hash_add_empty_element(class_hash, lcname);",
          "1029:           zend_string_release(lcname);",
          "1030:    } ZEND_HASH_FOREACH_END();",
          "1031:   }",
          "1032:  }",
          "1034:  if (!php_var_unserialize_ex(return_value, &p, p + buf_len, &var_hash, class_hash TSRMLS_CC)) {",
          "1036:   if(class_hash) {",
          "1037:    zend_hash_destroy(class_hash);",
          "1038:    FREE_HASHTABLE(class_hash);",
          "1039:   }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1018:   RETURN_FALSE;",
          "1019:  }",
          "1020:  PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1021: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1047:  if(class_hash) {",
          "1048:   zend_hash_destroy(class_hash);",
          "1049:   FREE_HASHTABLE(class_hash);",
          "1050:  }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "226:  return str;",
          "227: }",
          "229: #define YYFILL(n) do { } while (0)",
          "230: #define YYCTYPE unsigned char",
          "231: #define YYCURSOR cursor",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "229: static inline int unserialize_allowed_class(zend_string *class_name, HashTable *classes)",
          "230: {",
          "231:  zend_string *lcname;",
          "232:  int res;",
          "233:  ALLOCA_FLAG(use_heap)",
          "235:  if(classes == NULL) {",
          "236:   return 1;",
          "237:  }",
          "238:  if(!zend_hash_num_elements(classes)) {",
          "239:   return 0;",
          "240:  }",
          "242:  STR_ALLOCA_ALLOC(lcname, class_name->len, use_heap);",
          "243:  zend_str_tolower_copy(lcname->val, class_name->val, class_name->len);",
          "244:  res = zend_hash_exists(classes, lcname);",
          "245:  STR_ALLOCA_FREE(lcname, use_heap);",
          "246:  return res;",
          "247: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "233: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "236: #line 241 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "256: #line 261 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "293:  return result;",
          "294: }",
          "299: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, zend_long elements, int objprops)",
          "300: {",
          "",
          "[Removed Lines]",
          "296: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC",
          "297: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash TSRMLS_CC",
          "",
          "[Added Lines]",
          "316: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash, HashTable *classes TSRMLS_DC",
          "317: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash, classes TSRMLS_CC",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "302:   zval key, *data, d, *old_data;",
          "304:   ZVAL_UNDEF(&key);",
          "306:    zval_dtor(&key);",
          "307:    return 0;",
          "308:   }",
          "",
          "[Removed Lines]",
          "305:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "326:   if (!php_var_unserialize_ex(&key, p, max, NULL, classes TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "355:   zval_dtor(&key);",
          "358:    return 0;",
          "359:   }",
          "",
          "[Removed Lines]",
          "357:   if (!php_var_unserialize(data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "378:   if (!php_var_unserialize_ex(data, p, max, var_hash, classes TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "462: # pragma optimize(\"\", on)",
          "463: #endif",
          "466: {",
          "467:  const unsigned char *cursor, *limit, *marker, *start;",
          "468:  zval *rval_ref;",
          "",
          "[Removed Lines]",
          "465: PHPAPI int php_var_unserialize(UNSERIALIZE_PARAMETER)",
          "",
          "[Added Lines]",
          "486: PHPAPI int php_var_unserialize(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC)",
          "487: {",
          "488:  HashTable *classes = NULL;",
          "489:  return php_var_unserialize_ex(UNSERIALIZE_PASSTHRU);",
          "490: }",
          "493: PHPAPI int php_var_unserialize_ex(UNSERIALIZE_PARAMETER)",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "481:  start = cursor;",
          "485: {",
          "486:  YYCTYPE yych;",
          "487:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "484: #line 485 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "512: #line 513 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "541:  yych = *(YYMARKER = ++YYCURSOR);",
          "542:  if (yych == ':') goto yy95;",
          "543: yy3:",
          "545:  { return 0; }",
          "547: yy4:",
          "548:  yych = *(YYMARKER = ++YYCURSOR);",
          "549:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "544: #line 826 \"ext/standard/var_unserializer.re\"",
          "546: #line 547 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "572: #line 860 \"ext/standard/var_unserializer.re\"",
          "574: #line 575 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "586:  goto yy3;",
          "587: yy14:",
          "588:  ++YYCURSOR;",
          "590:  {",
          "592:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "594: }",
          "596: yy16:",
          "597:  yych = *++YYCURSOR;",
          "598:  goto yy3;",
          "",
          "[Removed Lines]",
          "589: #line 820 \"ext/standard/var_unserializer.re\"",
          "595: #line 596 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "617: #line 854 \"ext/standard/var_unserializer.re\"",
          "623: #line 624 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "618:  if (yybm[0+yych] & 128) {",
          "619:   goto yy20;",
          "620:  }",
          "622:  yych = *++YYCURSOR;",
          "623:  if (yych != '\"') goto yy18;",
          "624:  ++YYCURSOR;",
          "626:  {",
          "627:  size_t len, len2, len3, maxlen;",
          "628:  zend_long elements;",
          "",
          "[Removed Lines]",
          "621:  if (yych != ':') goto yy18;",
          "625: #line 681 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "649:  if (yych <= '/') goto yy18;",
          "650:  if (yych >= ';') goto yy18;",
          "654: #line 709 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "672:  class_name = zend_string_init(str, len, 0);",
          "674:  do {",
          "676:   BG(serialize_lock)++;",
          "677:   ce = zend_lookup_class(class_name TSRMLS_CC);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "704:   if(!unserialize_allowed_class(class_name, classes)) {",
          "705:    incomplete_class = 1;",
          "706:    ce = PHP_IC_ENTRY;",
          "707:    break;",
          "708:   }",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "762:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "763: }",
          "765: yy25:",
          "766:  yych = *++YYCURSOR;",
          "767:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "764: #line 765 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "799: #line 800 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "786:  yych = *++YYCURSOR;",
          "787:  if (yych != '\"') goto yy18;",
          "788:  ++YYCURSOR;",
          "790:  {",
          "",
          "[Removed Lines]",
          "789: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "824: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "794:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "795:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "796: }",
          "798: yy32:",
          "799:  yych = *++YYCURSOR;",
          "800:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "797: #line 798 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "832: #line 833 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "815:  yych = *++YYCURSOR;",
          "816:  if (yych != '{') goto yy18;",
          "817:  ++YYCURSOR;",
          "819:  {",
          "820:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "818: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "853: #line 680 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "837:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "838: }",
          "840: yy39:",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "839: #line 840 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "874: #line 875 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "857:  yych = *++YYCURSOR;",
          "858:  if (yych != '\"') goto yy18;",
          "859:  ++YYCURSOR;",
          "861:  {",
          "862:  size_t len, maxlen;",
          "863:  zend_string *str;",
          "",
          "[Removed Lines]",
          "860: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "895: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "885:  ZVAL_STR(rval, str);",
          "886:  return 1;",
          "887: }",
          "889: yy46:",
          "890:  yych = *++YYCURSOR;",
          "891:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "888: #line 889 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "923: #line 924 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "906:  yych = *++YYCURSOR;",
          "907:  if (yych != '\"') goto yy18;",
          "908:  ++YYCURSOR;",
          "910:  {",
          "911:  size_t len, maxlen;",
          "912:  char *str;",
          "",
          "[Removed Lines]",
          "909: #line 597 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "944: #line 625 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "933:  ZVAL_STRINGL(rval, str, len);",
          "934:  return 1;",
          "935: }",
          "937: yy53:",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "936: #line 937 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "971: #line 972 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1021:  }",
          "1022: yy63:",
          "1023:  ++YYCURSOR;",
          "1025:  {",
          "1026: #if SIZEOF_ZEND_LONG == 4",
          "1027: use_double:",
          "",
          "[Removed Lines]",
          "1024: #line 588 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1059: #line 616 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1030:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1031:  return 1;",
          "1032: }",
          "1034: yy65:",
          "1035:  yych = *++YYCURSOR;",
          "1036:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1033: #line 1034 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1089:  yych = *++YYCURSOR;",
          "1090:  if (yych != ';') goto yy18;",
          "1091:  ++YYCURSOR;",
          "1093:  {",
          "",
          "[Removed Lines]",
          "1092: #line 572 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1127: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1106:  return 1;",
          "1107: }",
          "1109: yy76:",
          "1110:  yych = *++YYCURSOR;",
          "1111:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1108: #line 1109 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1143: #line 1144 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1132:  if (yych <= '9') goto yy79;",
          "1133:  if (yych != ';') goto yy18;",
          "1134:  ++YYCURSOR;",
          "1136:  {",
          "1137: #if SIZEOF_ZEND_LONG == 4",
          "1138:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1135: #line 546 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1170: #line 574 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1158:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1159:  return 1;",
          "1160: }",
          "1162: yy83:",
          "1163:  yych = *++YYCURSOR;",
          "1164:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1161: #line 1162 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1166:  yych = *++YYCURSOR;",
          "1167:  if (yych != ';') goto yy18;",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1172:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1173:  return 1;",
          "1174: }",
          "1176: yy87:",
          "1177:  ++YYCURSOR;",
          "1179:  {",
          "1181:  ZVAL_NULL(rval);",
          "1182:  return 1;",
          "1183: }",
          "1185: yy89:",
          "1186:  yych = *++YYCURSOR;",
          "1187:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1169: #line 540 \"ext/standard/var_unserializer.re\"",
          "1175: #line 1176 \"ext/standard/var_unserializer.c\"",
          "1178: #line 534 \"ext/standard/var_unserializer.re\"",
          "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1204: #line 568 \"ext/standard/var_unserializer.re\"",
          "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
          "1213: #line 562 \"ext/standard/var_unserializer.re\"",
          "1219: #line 1220 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1204:  if (yych <= '9') goto yy91;",
          "1205:  if (yych != ';') goto yy18;",
          "1206:  ++YYCURSOR;",
          "1208:  {",
          "1209:  zend_long id;",
          "",
          "[Removed Lines]",
          "1207: #line 511 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1242: #line 539 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1228:  return 1;",
          "1229: }",
          "1231: yy95:",
          "1232:  yych = *++YYCURSOR;",
          "1233:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1265: #line 1266 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "1250:  if (yych <= '9') goto yy97;",
          "1251:  if (yych != ';') goto yy18;",
          "1252:  ++YYCURSOR;",
          "1254:  {",
          "1255:  zend_long id;",
          "",
          "[Removed Lines]",
          "1253: #line 489 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1288: #line 517 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "1273:  return 1;",
          "1274: }",
          "1276: }",
          "1280:  return 0;",
          "",
          "[Removed Lines]",
          "1275: #line 1276 \"ext/standard/var_unserializer.c\"",
          "1277: #line 828 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
          "1312: #line 862 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "224:  return str;",
          "225: }",
          "227: #define YYFILL(n) do { } while (0)",
          "228: #define YYCTYPE unsigned char",
          "229: #define YYCURSOR cursor",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "227: static inline int unserialize_allowed_class(zend_string *class_name, HashTable *classes)",
          "228: {",
          "229:  zend_string *lcname;",
          "230:  int res;",
          "231:  ALLOCA_FLAG(use_heap)",
          "233:  if(classes == NULL) {",
          "234:   return 1;",
          "235:  }",
          "236:  if(!zend_hash_num_elements(classes)) {",
          "237:   return 0;",
          "238:  }",
          "240:  STR_ALLOCA_ALLOC(lcname, class_name->len, use_heap);",
          "241:  zend_str_tolower_copy(lcname->val, class_name->val, class_name->len);",
          "242:  res = zend_hash_exists(classes, lcname);",
          "243:  STR_ALLOCA_FREE(lcname, use_heap);",
          "244:  return res;",
          "245: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "297:  return result;",
          "298: }",
          "303: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, zend_long elements, int objprops)",
          "304: {",
          "",
          "[Removed Lines]",
          "300: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC",
          "301: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash TSRMLS_CC",
          "",
          "[Added Lines]",
          "320: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash, HashTable *classes TSRMLS_DC",
          "321: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash, classes TSRMLS_CC",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "306:   zval key, *data, d, *old_data;",
          "308:   ZVAL_UNDEF(&key);",
          "310:    zval_dtor(&key);",
          "311:    return 0;",
          "312:   }",
          "",
          "[Removed Lines]",
          "309:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "330:   if (!php_var_unserialize_ex(&key, p, max, NULL, classes TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "359:   zval_dtor(&key);",
          "362:    return 0;",
          "363:   }",
          "",
          "[Removed Lines]",
          "361:   if (!php_var_unserialize(data, p, max, var_hash TSRMLS_CC)) {",
          "",
          "[Added Lines]",
          "382:   if (!php_var_unserialize_ex(data, p, max, var_hash, classes TSRMLS_CC)) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "466: # pragma optimize(\"\", on)",
          "467: #endif",
          "470: {",
          "471:  const unsigned char *cursor, *limit, *marker, *start;",
          "472:  zval *rval_ref;",
          "",
          "[Removed Lines]",
          "469: PHPAPI int php_var_unserialize(UNSERIALIZE_PARAMETER)",
          "",
          "[Added Lines]",
          "490: PHPAPI int php_var_unserialize(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC)",
          "491: {",
          "492:  HashTable *classes = NULL;",
          "493:  return php_var_unserialize_ex(UNSERIALIZE_PASSTHRU);",
          "494: }",
          "497: PHPAPI int php_var_unserialize_ex(UNSERIALIZE_PARAMETER)",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "727:  class_name = zend_string_init(str, len, 0);",
          "729:  do {",
          "731:   BG(serialize_lock)++;",
          "732:   ce = zend_lookup_class(class_name TSRMLS_CC);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "758:   if(!unserialize_allowed_class(class_name, classes)) {",
          "759:    incomplete_class = 1;",
          "760:    ce = PHP_IC_ENTRY;",
          "761:    break;",
          "762:   }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5bb25776a00e1074d1230a311043b00f7cce9252",
      "candidate_info": {
        "commit_hash": "5bb25776a00e1074d1230a311043b00f7cce9252",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/5bb25776a00e1074d1230a311043b00f7cce9252",
        "files": [
          "Zend/zend.h",
          "Zend/zend_alloc.c",
          "Zend/zend_builtin_functions.c",
          "Zend/zend_compile.c",
          "Zend/zend_constants.c",
          "Zend/zend_constants.h",
          "Zend/zend_exceptions.c",
          "Zend/zend_execute.h",
          "Zend/zend_execute_API.c",
          "Zend/zend_language_scanner.c",
          "Zend/zend_language_scanner.l",
          "Zend/zend_multiply.h",
          "Zend/zend_objects.c",
          "Zend/zend_strtod.c",
          "ext/standard/filters.c",
          "ext/standard/html.c",
          "ext/standard/http.c",
          "ext/standard/info.c",
          "ext/standard/proc_open.c",
          "ext/standard/streamsfuncs.c",
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "further fixes on core",
        "before_after_code_files": [
          "Zend/zend.h||Zend/zend.h",
          "Zend/zend_alloc.c||Zend/zend_alloc.c",
          "Zend/zend_builtin_functions.c||Zend/zend_builtin_functions.c",
          "Zend/zend_compile.c||Zend/zend_compile.c",
          "Zend/zend_constants.c||Zend/zend_constants.c",
          "Zend/zend_constants.h||Zend/zend_constants.h",
          "Zend/zend_exceptions.c||Zend/zend_exceptions.c",
          "Zend/zend_execute.h||Zend/zend_execute.h",
          "Zend/zend_execute_API.c||Zend/zend_execute_API.c",
          "Zend/zend_language_scanner.c||Zend/zend_language_scanner.c",
          "Zend/zend_language_scanner.l||Zend/zend_language_scanner.l",
          "Zend/zend_multiply.h||Zend/zend_multiply.h",
          "Zend/zend_objects.c||Zend/zend_objects.c",
          "Zend/zend_strtod.c||Zend/zend_strtod.c",
          "ext/standard/filters.c||ext/standard/filters.c",
          "ext/standard/html.c||ext/standard/html.c",
          "ext/standard/http.c||ext/standard/http.c",
          "ext/standard/info.c||ext/standard/info.c",
          "ext/standard/proc_open.c||ext/standard/proc_open.c",
          "ext/standard/streamsfuncs.c||ext/standard/streamsfuncs.c",
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/zend.h||Zend/zend.h": [
          "File: Zend/zend.h -> Zend/zend.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "390: # define XtOffset(p_type, field) \\",
          "",
          "[Removed Lines]",
          "391:     ((long) (((char *) (&(((p_type)NULL)->field))) - ((char *) NULL)))",
          "",
          "[Added Lines]",
          "391:     ((zend_int_t) (((char *) (&(((p_type)NULL)->field))) - ((char *) NULL)))",
          "",
          "---------------"
        ],
        "Zend/zend_alloc.c||Zend/zend_alloc.c": [
          "File: Zend/zend_alloc.c -> Zend/zend_alloc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1373: #ifdef ZTS",
          "1374:  if (ZEND_MM_BAD_THREAD_ID(p)) {",
          "1375:   if (!silent) {",
          "1377:    had_problems = 1;",
          "1378:   } else {",
          "1379:    return zend_mm_check_ptr(heap, ptr, 0 ZEND_FILE_LINE_RELAY_CC ZEND_FILE_LINE_ORIG_RELAY_CC);",
          "",
          "[Removed Lines]",
          "1376:    zend_debug_alloc_output(\"Invalid pointer: ((thread_id=0x%0.8X) != (expected=0x%0.8X))\\n\", (long)p->thread_id, (long)tsrm_thread_id());",
          "",
          "[Added Lines]",
          "1376:    zend_debug_alloc_output(\"Invalid pointer: ((thread_id=0x%0.8X) != (expected=0x%0.8X))\\n\", (zend_int_t)p->thread_id, (zend_int_t)tsrm_thread_id());",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2474: static inline size_t safe_address(size_t nmemb, size_t size, size_t offset)",
          "2475: {",
          "2476:  size_t res = nmemb;",
          "2479:  __asm__ (\"mull %3\\n\\taddl %4,%0\\n\\tadcl $0,%1\"",
          "2480:       : \"=&a\"(res), \"=&d\" (overflow)",
          "",
          "[Removed Lines]",
          "2477:  unsigned long overflow = 0;",
          "",
          "[Added Lines]",
          "2477:  zend_uint_t overflow = 0;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2494: static inline size_t safe_address(size_t nmemb, size_t size, size_t offset)",
          "2495: {",
          "2496:         size_t res = nmemb;",
          "2500: # define LP_SUFF \"l\"",
          "",
          "[Removed Lines]",
          "2497:         unsigned long overflow = 0;",
          "",
          "[Added Lines]",
          "2497:         zend_uint_t overflow = 0;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2523: static inline size_t safe_address(size_t nmemb, size_t size, size_t offset)",
          "2524: {",
          "2525:         size_t res;",
          "2528:         __asm__ (\"umlal %0,%1,%2,%3\"",
          "2529:              : \"=r\"(res), \"=r\"(overflow)",
          "",
          "[Removed Lines]",
          "2526:         unsigned long overflow;",
          "",
          "[Added Lines]",
          "2526:         zend_uint_t overflow;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2544: static inline size_t safe_address(size_t nmemb, size_t size, size_t offset)",
          "2545: {",
          "2546:         size_t res;",
          "2549:         __asm__ (\"mul %0,%2,%3\\n\\tumulh %1,%2,%3\\n\\tadds %0,%0,%4\\n\\tadc %1,%1,xzr\"",
          "2550:              : \"=&r\"(res), \"=&r\"(overflow)",
          "",
          "[Removed Lines]",
          "2547:         unsigned long overflow;",
          "",
          "[Added Lines]",
          "2547:         zend_uint_t overflow;",
          "",
          "---------------"
        ],
        "Zend/zend_builtin_functions.c||Zend/zend_builtin_functions.c": [
          "File: Zend/zend_builtin_functions.c -> Zend/zend_builtin_functions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "411: {",
          "412:  int arg_count, first_extra_arg;",
          "413:  zval *arg;",
          "415:  zend_execute_data *ex;",
          "418:   return;",
          "419:  }",
          "",
          "[Removed Lines]",
          "414:  long requested_offset;",
          "417:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"l\", &requested_offset) == FAILURE) {",
          "",
          "[Added Lines]",
          "414:  zend_int_t requested_offset;",
          "417:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"i\", &requested_offset) == FAILURE) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1907: #ifdef ZTS",
          "1908: ZEND_FUNCTION(zend_thread_id)",
          "1909: {",
          "1911: }",
          "1912: #endif",
          "1913: #endif",
          "",
          "[Removed Lines]",
          "1910:  RETURN_INT((long)tsrm_thread_id());",
          "",
          "[Added Lines]",
          "1910:  RETURN_INT((zend_int_t)tsrm_thread_id());",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2111:  const char *include_filename = NULL;",
          "2112:  zval arg_array;",
          "2113:  int indent = 0;",
          "2118:   return;",
          "2119:  }",
          "",
          "[Removed Lines]",
          "2114:  long options = 0;",
          "2115:  long limit = 0;",
          "2117:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|ll\", &options, &limit) == FAILURE) {",
          "",
          "[Added Lines]",
          "2114:  zend_int_t options = 0;",
          "2115:  zend_int_t limit = 0;",
          "2117:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|ii\", &options, &limit) == FAILURE) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2500: ZEND_FUNCTION(debug_backtrace)",
          "2501: {",
          "2506:   return;",
          "2507:  }",
          "",
          "[Removed Lines]",
          "2502:  long options = DEBUG_BACKTRACE_PROVIDE_OBJECT;",
          "2503:  long limit = 0;",
          "2505:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|ll\", &options, &limit) == FAILURE) {",
          "",
          "[Added Lines]",
          "2502:  zend_int_t options = DEBUG_BACKTRACE_PROVIDE_OBJECT;",
          "2503:  zend_int_t limit = 0;",
          "2505:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|ii\", &options, &limit) == FAILURE) {",
          "",
          "---------------"
        ],
        "Zend/zend_compile.c||Zend/zend_compile.c": [
          "File: Zend/zend_compile.c -> Zend/zend_compile.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "6312:  if (constant_array) {",
          "6314:   zend_uint size;",
          "6316:   zend_string *str;",
          "6318:   if (init_opline->op1_type != IS_UNUSED) {",
          "",
          "[Removed Lines]",
          "6315:   long num;",
          "",
          "[Added Lines]",
          "6315:   zend_int_t num;",
          "",
          "---------------"
        ],
        "Zend/zend_constants.c||Zend/zend_constants.c": [
          "File: Zend/zend_constants.c -> Zend/zend_constants.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "323:  return c ? &c->value : NULL;",
          "324: }",
          "327: {",
          "328:  zend_constant *c;",
          "329:  const char *colon;",
          "",
          "[Removed Lines]",
          "326: ZEND_API zval *zend_get_constant_ex(zend_string *cname, zend_class_entry *scope, ulong flags TSRMLS_DC)",
          "",
          "[Added Lines]",
          "326: ZEND_API zval *zend_get_constant_ex(zend_string *cname, zend_class_entry *scope, zend_uint_t flags TSRMLS_DC)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "449:  }",
          "450: }",
          "453: {",
          "454:  zend_constant *c;",
          "",
          "[Removed Lines]",
          "452: zend_constant *zend_quick_get_constant(const zval *key, ulong flags TSRMLS_DC)",
          "",
          "[Added Lines]",
          "452: zend_constant *zend_quick_get_constant(const zval *key, zend_uint_t flags TSRMLS_DC)",
          "",
          "---------------"
        ],
        "Zend/zend_constants.h||Zend/zend_constants.h": [
          "File: Zend/zend_constants.h -> Zend/zend_constants.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "67: void clean_non_persistent_constants(TSRMLS_D);",
          "68: ZEND_API zval *zend_get_constant(zend_string *name TSRMLS_DC);",
          "69: ZEND_API zval *zend_get_constant_str(const char *name, uint name_len TSRMLS_DC);",
          "71: ZEND_API void zend_register_bool_constant(const char *name, uint name_len, zend_bool bval, int flags, int module_number TSRMLS_DC);",
          "72: ZEND_API void zend_register_null_constant(const char *name, uint name_len, int flags, int module_number TSRMLS_DC);",
          "73: ZEND_API void zend_register_int_constant(const char *name, uint name_len, zend_int_t lval, int flags, int module_number TSRMLS_DC);",
          "",
          "[Removed Lines]",
          "70: ZEND_API zval *zend_get_constant_ex(zend_string *name, zend_class_entry *scope, ulong flags TSRMLS_DC);",
          "",
          "[Added Lines]",
          "70: ZEND_API zval *zend_get_constant_ex(zend_string *name, zend_class_entry *scope, zend_uint_t flags TSRMLS_DC);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "76: ZEND_API void zend_register_stringl_constant(const char *name, uint name_len, char *strval, uint strlen, int flags, int module_number TSRMLS_DC);",
          "77: ZEND_API int zend_register_constant(zend_constant *c TSRMLS_DC);",
          "78: void zend_copy_constants(HashTable *target, HashTable *sourc);",
          "80: END_EXTERN_C()",
          "82: #define ZEND_CONSTANT_DTOR free_zend_constant",
          "",
          "[Removed Lines]",
          "79: zend_constant *zend_quick_get_constant(const zval *key, ulong flags TSRMLS_DC);",
          "",
          "[Added Lines]",
          "79: zend_constant *zend_quick_get_constant(const zval *key, zend_uint_t flags TSRMLS_DC);",
          "",
          "---------------"
        ],
        "Zend/zend_exceptions.c||Zend/zend_exceptions.c": [
          "File: Zend/zend_exceptions.c -> Zend/zend_exceptions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "459:    TRACE_APPEND_STR(\"true, \");",
          "460:    break;",
          "461:   case IS_RESOURCE: {",
          "463:    char s_tmp[MAX_LENGTH_OF_ZEND_INT + 1];",
          "465:    TRACE_APPEND_STR(\"Resource id #\");",
          "",
          "[Removed Lines]",
          "462:    long lval = Z_RES_HANDLE_P(arg);",
          "",
          "[Added Lines]",
          "462:    zend_int_t lval = Z_RES_HANDLE_P(arg);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "468:    break;",
          "469:   }",
          "470:   case IS_INT: {",
          "472:    char s_tmp[MAX_LENGTH_OF_ZEND_INT + 1];",
          "474:    TRACE_APPEND_STRL(s_tmp, l_tmp);",
          "",
          "[Removed Lines]",
          "471:    long lval = Z_IVAL_P(arg);",
          "",
          "[Added Lines]",
          "471:    zend_int_t lval = Z_IVAL_P(arg);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "584: ZEND_METHOD(exception, getTraceAsString)",
          "585: {",
          "586:  zval *trace, *frame;",
          "588:  zend_string *str, *key;",
          "589:  int num = 0, len;",
          "590:  char s_tmp[MAX_LENGTH_OF_ZEND_INT + 7 + 1 + 1];",
          "",
          "[Removed Lines]",
          "587:  ulong index;",
          "",
          "[Added Lines]",
          "587:  zend_uint_t index;",
          "",
          "---------------"
        ],
        "Zend/zend_execute.h||Zend/zend_execute.h": [
          "File: Zend/zend_execute.h -> Zend/zend_execute.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: ZEND_API int zend_eval_string_ex(char *str, zval *retval_ptr, char *string_name, int handle_exceptions TSRMLS_DC);",
          "49: ZEND_API int zend_eval_stringl_ex(char *str, int str_len, zval *retval_ptr, char *string_name, int handle_exceptions TSRMLS_DC);",
          "52: ZEND_API void zend_verify_arg_error(int error_type, const zend_function *zf, zend_uint arg_num, const char *need_msg, const char *need_kind, const char *given_msg, const char *given_kind, zval *arg TSRMLS_DC);",
          "54: static zend_always_inline void i_zval_ptr_dtor(zval *zval_ptr ZEND_FILE_LINE_DC TSRMLS_DC)",
          "",
          "[Removed Lines]",
          "51: ZEND_API char * zend_verify_arg_class_kind(const zend_arg_info *cur_arg_info, ulong fetch_type, char **class_name, zend_class_entry **pce TSRMLS_DC);",
          "",
          "[Added Lines]",
          "51: ZEND_API char * zend_verify_arg_class_kind(const zend_arg_info *cur_arg_info, zend_uint_t fetch_type, char **class_name, zend_class_entry **pce TSRMLS_DC);",
          "",
          "---------------"
        ],
        "Zend/zend_execute_API.c||Zend/zend_execute_API.c": [
          "File: Zend/zend_execute_API.c -> Zend/zend_execute_API.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1681:  if (execute_data) {",
          "1682:   if (!execute_data->symbol_table) {",
          "1684:    zend_op_array *op_array = &execute_data->func->op_array;",
          "1685:    int i;",
          "",
          "[Removed Lines]",
          "1683:    zend_ulong h = STR_HASH_VAL(name);",
          "",
          "[Added Lines]",
          "1683:    zend_uint_t h = STR_HASH_VAL(name);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1717:  if (execute_data) {",
          "1718:   if (!execute_data->symbol_table) {",
          "1720:    zend_op_array *op_array = &execute_data->func->op_array;",
          "1721:    int i;",
          "",
          "[Removed Lines]",
          "1719:    zend_ulong h = zend_hash_func(name, len);",
          "",
          "[Added Lines]",
          "1719:    zend_uint_t h = zend_hash_func(name, len);",
          "",
          "---------------"
        ],
        "Zend/zend_language_scanner.c||Zend/zend_language_scanner.c": [
          "File: Zend/zend_language_scanner.c -> Zend/zend_language_scanner.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1645:   yyleng = YYCURSOR - SCNG(yy_text);",
          "1646: #line 2153 \"Zend/zend_language_scanner.l\"",
          "1647:   {",
          "1649:  yy_push_state(ST_IN_SCRIPTING TSRMLS_CC);",
          "1650:  yyless(1);",
          "1651:  return T_CURLY_OPEN;",
          "",
          "[Removed Lines]",
          "1648:  Z_IVAL_P(zendlval) = (long) '{';",
          "",
          "[Added Lines]",
          "1648:  Z_IVAL_P(zendlval) = (zend_int_t) '{';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1873:   yyleng = YYCURSOR - SCNG(yy_text);",
          "1874: #line 2153 \"Zend/zend_language_scanner.l\"",
          "1875:   {",
          "1877:  yy_push_state(ST_IN_SCRIPTING TSRMLS_CC);",
          "1878:  yyless(1);",
          "1879:  return T_CURLY_OPEN;",
          "",
          "[Removed Lines]",
          "1876:  Z_IVAL_P(zendlval) = (long) '{';",
          "",
          "[Added Lines]",
          "1876:  Z_IVAL_P(zendlval) = (zend_int_t) '{';",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2132:   yyleng = YYCURSOR - SCNG(yy_text);",
          "2133: #line 2153 \"Zend/zend_language_scanner.l\"",
          "2134:   {",
          "2136:  yy_push_state(ST_IN_SCRIPTING TSRMLS_CC);",
          "2137:  yyless(1);",
          "2138:  return T_CURLY_OPEN;",
          "",
          "[Removed Lines]",
          "2135:  Z_IVAL_P(zendlval) = (long) '{';",
          "",
          "[Added Lines]",
          "2135:  Z_IVAL_P(zendlval) = (zend_int_t) '{';",
          "",
          "---------------"
        ],
        "Zend/zend_language_scanner.l||Zend/zend_language_scanner.l": [
          "File: Zend/zend_language_scanner.l -> Zend/zend_language_scanner.l",
          "--- Hunk 1 ---",
          "[Context before]",
          "2153: <ST_DOUBLE_QUOTES,ST_BACKQUOTE,ST_HEREDOC>\"{$\" {",
          "2155:  yy_push_state(ST_IN_SCRIPTING TSRMLS_CC);",
          "2156:  yyless(1);",
          "2157:  return T_CURLY_OPEN;",
          "",
          "[Removed Lines]",
          "2154:  Z_IVAL_P(zendlval) = (long) '{';",
          "",
          "[Added Lines]",
          "2154:  Z_IVAL_P(zendlval) = (zend_int_t) '{';",
          "",
          "---------------"
        ],
        "Zend/zend_multiply.h||Zend/zend_multiply.h": [
          "File: Zend/zend_multiply.h -> Zend/zend_multiply.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "81:  }                \\",
          "82: } while (0)",
          "86: #define ZEND_SIGNED_MULTIPLY_INT(a, b, lval, dval, usedval) do { \\",
          "87:  zend_long64 __result = (zend_long64) (a) * (zend_long64) (b); \\",
          "",
          "[Removed Lines]",
          "84: #elif SIZEOF_LONG == 4 && defined(HAVE_ZEND_LONG64)",
          "",
          "[Added Lines]",
          "84: #elif SIZEOF_ZEND_INT == 4 && defined(HAVE_ZEND_LONG64)",
          "",
          "---------------"
        ],
        "Zend/zend_objects.c||Zend/zend_objects.c": [
          "File: Zend/zend_objects.c -> Zend/zend_objects.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "149:  }",
          "150:  if (old_object->properties) {",
          "151:   zval *prop, new_prop;",
          "153:   zend_string *key;",
          "155:   if (!new_object->properties) {",
          "",
          "[Removed Lines]",
          "152:   ulong num_key;",
          "",
          "[Added Lines]",
          "152:   zend_uint_t num_key;",
          "",
          "---------------"
        ],
        "Zend/zend_strtod.c||Zend/zend_strtod.c": [
          "File: Zend/zend_strtod.c -> Zend/zend_strtod.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "174: #endif",
          "176: #define Long    int32_t",
          "179: #ifdef __cplusplus",
          "180: #include \"malloc.h\"",
          "",
          "[Removed Lines]",
          "177: #define ULong   uint32_t",
          "",
          "[Added Lines]",
          "177: #define zend_uint_t   uint32_t",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "273:  typedef union {",
          "274:       double d;",
          "276:  } _double;",
          "277: #define value(x) ((x).d)",
          "278: #ifdef IEEE_LITTLE_ENDIAN",
          "",
          "[Removed Lines]",
          "275:        ULong ul[2];",
          "",
          "[Added Lines]",
          "275:        zend_uint_t ul[2];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "418: struct Bigint {",
          "419:  struct Bigint *next;",
          "420:  int k, maxwds, sign, wds;",
          "422: };",
          "424: typedef struct Bigint Bigint;",
          "",
          "[Removed Lines]",
          "421:  ULong x[1];",
          "",
          "[Added Lines]",
          "421:  zend_uint_t x[1];",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "519: static char * rv_alloc(int i) {",
          "520:  int j, k, *r;",
          "523:  for(k = 0;",
          "525:    j <<= 1) {",
          "526:   k++;",
          "527:  }",
          "",
          "[Removed Lines]",
          "522:  j = sizeof(ULong);",
          "524:    sizeof(Bigint) - sizeof(ULong) - sizeof(int) + j <= i;",
          "",
          "[Added Lines]",
          "522:  j = sizeof(zend_uint_t);",
          "524:    sizeof(Bigint) - sizeof(zend_uint_t) - sizeof(int) + j <= i;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "549: {",
          "550:  int i, wds;",
          "552: #ifdef Pack_32",
          "554: #endif",
          "555:  Bigint *b1;",
          "",
          "[Removed Lines]",
          "551:  ULong *x, y;",
          "553:  ULong xi, z;",
          "",
          "[Added Lines]",
          "551:  zend_uint_t *x, y;",
          "553:  zend_uint_t xi, z;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "584:  return b;",
          "585: }",
          "588: {",
          "589:  int k = 0;",
          "",
          "[Removed Lines]",
          "587: static int hi0bits(ULong x)",
          "",
          "[Added Lines]",
          "587: static int hi0bits(zend_uint_t x)",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "613:  return k;",
          "614: }",
          "617: {",
          "618:  int k;",
          "621:  if (x & 7) {",
          "622:   if (x & 1) {",
          "",
          "[Removed Lines]",
          "616: static int lo0bits(ULong *y)",
          "619:  ULong x = *y;",
          "",
          "[Added Lines]",
          "616: static int lo0bits(zend_uint_t *y)",
          "619:  zend_uint_t x = *y;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "671: {",
          "672:  Bigint *c;",
          "673:  int k, wa, wb, wc;",
          "676: #ifdef Pack_32",
          "678: #endif",
          "680:  if (a->wds < b->wds) {",
          "",
          "[Removed Lines]",
          "674:  ULong carry, y, z;",
          "675:  ULong *x, *xa, *xae, *xb, *xbe, *xc, *xc0;",
          "677:  ULong z2;",
          "",
          "[Added Lines]",
          "674:  zend_uint_t carry, y, z;",
          "675:  zend_uint_t *x, *xa, *xae, *xb, *xbe, *xc, *xc0;",
          "677:  zend_uint_t z2;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "751:  return c;",
          "752: }",
          "755: {",
          "756:  Bigint *b;",
          "757:  int i, k;",
          "",
          "[Removed Lines]",
          "754: static Bigint * s2b (CONST char *s, int nd0, int nd, ULong y9)",
          "",
          "[Added Lines]",
          "754: static Bigint * s2b (CONST char *s, int nd0, int nd, zend_uint_t y9)",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "830: {",
          "831:  int i, k1, n, n1;",
          "832:  Bigint *b1;",
          "835: #ifdef Pack_32",
          "836:  n = k >> 5;",
          "",
          "[Removed Lines]",
          "833:  ULong *x, *x1, *xe, z;",
          "",
          "[Added Lines]",
          "833:  zend_uint_t *x, *x1, *xe, z;",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "887: static int cmp(Bigint *a, Bigint *b)",
          "888: {",
          "890:  int i, j;",
          "892:  i = a->wds;",
          "",
          "[Removed Lines]",
          "889:  ULong *xa, *xa0, *xb, *xb0;",
          "",
          "[Added Lines]",
          "889:  zend_uint_t *xa, *xa0, *xb, *xb0;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "918:  Bigint *c;",
          "919:  int i, wa, wb;",
          "922: #ifdef Pack_32",
          "923:  Long z;",
          "924: #endif",
          "",
          "[Removed Lines]",
          "921:  ULong *xa, *xae, *xb, *xbe, *xc;",
          "",
          "[Added Lines]",
          "921:  zend_uint_t *xa, *xae, *xb, *xbe, *xc;",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1030: (Bigint *a, int *e)",
          "1031: #endif",
          "1032: {",
          "1034:  int k;",
          "1035:  volatile _double d;",
          "1036: #ifdef VAX",
          "1038: #else",
          "1039: #define d0 word0(d)",
          "1040: #define d1 word1(d)",
          "",
          "[Removed Lines]",
          "1033:  ULong *xa, *xa0, w, y, z;",
          "1037:  ULong d0, d1;",
          "",
          "[Added Lines]",
          "1033:  zend_uint_t *xa, *xa0, w, y, z;",
          "1037:  zend_uint_t d0, d1;",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1097: {",
          "1098:  Bigint *b;",
          "1099:  int de, i, k;",
          "1101:  volatile _double d;",
          "1102: #ifdef VAX",
          "1104: #endif",
          "1106:  value(d) = _d;",
          "",
          "[Removed Lines]",
          "1100:  ULong *x, y, z;",
          "1103:  ULong d0, d1;",
          "",
          "[Added Lines]",
          "1100:  zend_uint_t *x, y, z;",
          "1103:  zend_uint_t d0, d1;",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1283: {",
          "1284:  int n;",
          "1285:  Long borrow, y;",
          "1288: #ifdef Pack_32",
          "1289:  Long z;",
          "1291: #endif",
          "1293:  n = S->wds;",
          "",
          "[Removed Lines]",
          "1286:  ULong carry, q, ys;",
          "1287:  ULong *bx, *bxe, *sx, *sxe;",
          "1290:  ULong si, zs;",
          "",
          "[Added Lines]",
          "1286:  zend_uint_t carry, q, ys;",
          "1287:  zend_uint_t *bx, *bxe, *sx, *sxe;",
          "1290:  zend_uint_t si, zs;",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1481:  Long L;",
          "1482: #ifndef Sudden_Underflow",
          "1483:  int denorm;",
          "1485: #endif",
          "1486:  Bigint *b, *b1, *delta, *mlo, *mhi, *S, *tmp;",
          "1487:  double ds;",
          "",
          "[Removed Lines]",
          "1484:  ULong x;",
          "",
          "[Added Lines]",
          "1484:  zend_uint_t x;",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "2044:  volatile double aadj, aadj1, adj;",
          "2045:  volatile _double rv, rv0;",
          "2046:  Long L;",
          "2048:  Bigint *bb, *bb1, *bd, *bd0, *bs, *delta, *tmp;",
          "2049:  double result;",
          "",
          "[Removed Lines]",
          "2047:  ULong y, z;",
          "",
          "[Added Lines]",
          "2047:  zend_uint_t y, z;",
          "",
          "---------------"
        ],
        "ext/standard/filters.c||ext/standard/filters.c": [
          "File: ext/standard/filters.c -> ext/standard/filters.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1232: }",
          "1234: #if IT_WAS_USED",
          "1236: {",
          "1237:  zval **tmpval;",
          "",
          "[Removed Lines]",
          "1235: static php_conv_err_t php_conv_get_long_prop_ex(const HashTable *ht, long *pretval, char *field_name, size_t field_name_len)",
          "",
          "[Added Lines]",
          "1235: static php_conv_err_t php_conv_get_long_prop_ex(const HashTable *ht, php_int_t *pretval, char *field_name, size_t field_name_len)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1255: }",
          "1256: #endif",
          "1259: {",
          "1260:  zval *tmpval;",
          "",
          "[Removed Lines]",
          "1258: static php_conv_err_t php_conv_get_ulong_prop_ex(const HashTable *ht, unsigned long *pretval, char *field_name, size_t field_name_len)",
          "",
          "[Added Lines]",
          "1258: static php_conv_err_t php_conv_get_ulong_prop_ex(const HashTable *ht, php_uint_t *pretval, char *field_name, size_t field_name_len)",
          "",
          "---------------"
        ],
        "ext/standard/html.c||ext/standard/html.c": [
          "File: ext/standard/html.c -> ext/standard/html.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "856: static inline int resolve_named_entity_html(const char *start, size_t length, const entity_ht *ht, unsigned *uni_cp1, unsigned *uni_cp2)",
          "857: {",
          "858:  const entity_cp_map *s;",
          "861:  s = ht->buckets[hash % ht->num_elems];",
          "862:  while (s->entity) {",
          "",
          "[Removed Lines]",
          "859:  ulong hash = zend_inline_hash_func(start, length);",
          "",
          "[Added Lines]",
          "859:  php_uint_t hash = zend_inline_hash_func(start, length);",
          "",
          "---------------"
        ],
        "ext/standard/http.c||ext/standard/http.c": [
          "File: ext/standard/http.c -> ext/standard/http.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "35:  char *newprefix, *p;",
          "36:  const char *prop_name;",
          "37:  int arg_sep_len, newprefix_len, prop_len;",
          "39:  zval *zdata = NULL, copyzval;",
          "41:  if (!ht) {",
          "",
          "[Removed Lines]",
          "38:  ulong idx;",
          "",
          "[Added Lines]",
          "38:  php_uint_t idx;",
          "",
          "---------------"
        ],
        "ext/standard/info.c||ext/standard/info.c": [
          "File: ext/standard/info.c -> ext/standard/info.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "196: {",
          "197:  zval *data, *tmp, tmp2;",
          "198:  zend_string *string_key;",
          "200:  zend_string *key;",
          "202:  key = STR_INIT(name, name_length, 0);",
          "",
          "[Removed Lines]",
          "199:  ulong num_key;",
          "",
          "[Added Lines]",
          "199:  php_uint_t num_key;",
          "",
          "---------------"
        ],
        "ext/standard/proc_open.c||ext/standard/proc_open.c": [
          "File: ext/standard/proc_open.c -> ext/standard/proc_open.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "427:  int i;",
          "428:  zval *descitem = NULL;",
          "429:  zend_string *str_index;",
          "431:  struct php_proc_open_descriptor_item descriptors[PHP_PROC_OPEN_MAX_DESCRIPTORS];",
          "432: #ifdef PHP_WIN32",
          "433:  PROCESS_INFORMATION pi;",
          "",
          "[Removed Lines]",
          "430:  ulong nindex;",
          "",
          "[Added Lines]",
          "430:  php_uint_t nindex;",
          "",
          "---------------"
        ],
        "ext/standard/streamsfuncs.c||ext/standard/streamsfuncs.c": [
          "File: ext/standard/streamsfuncs.c -> ext/standard/streamsfuncs.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "619:  php_stream *stream;",
          "620:  int ret = 0;",
          "621:  zend_string *key;",
          "624:  if (Z_TYPE_P(stream_array) != IS_ARRAY) {",
          "625:   return 0;",
          "",
          "[Removed Lines]",
          "622:  ulong num_ind;",
          "",
          "[Added Lines]",
          "622:  php_uint_t num_ind;",
          "",
          "---------------"
        ],
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "100:  zend_string *class_name;",
          "101:  int is_temp;",
          "102:  int is_ref = 0;",
          "104:  zend_string *key;",
          "105:  zval *val;",
          "",
          "[Removed Lines]",
          "103:  ulong num;",
          "",
          "[Added Lines]",
          "103:  php_uint_t num;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "171:     php_printf(\"%sobject(unknown class)#%d (%d) {\\n\", COMMON, Z_OBJ_HANDLE_P(struc), myht ? zend_obj_num_elements(myht) : 0);",
          "172:    }",
          "173:    if (myht) {",
          "175:     zend_string *key;",
          "176:     zval *val;",
          "",
          "[Removed Lines]",
          "174:     ulong num;",
          "",
          "[Added Lines]",
          "174:     php_uint_t num;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "271:  zend_string *class_name;",
          "272:  int is_temp = 0;",
          "273:  int is_ref = 0;",
          "275:  zend_string *key;",
          "276:  zval *val;",
          "",
          "[Removed Lines]",
          "274:  ulong index;",
          "",
          "[Added Lines]",
          "274:  php_uint_t index;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "459:  int tmp_len;",
          "460:  zend_string *class_name;",
          "461:  zend_string *ztmp, *ztmp2;",
          "463:  zend_string *key;",
          "464:  zval *val;",
          "",
          "[Removed Lines]",
          "462:  ulong index;",
          "",
          "[Added Lines]",
          "462:  php_uint_t index;",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "31: typedef struct {",
          "32:  zval *data[VAR_ENTRIES_MAX];",
          "34:  void *next;",
          "35: } var_entries;",
          "37: typedef struct {",
          "38:  zval data[VAR_ENTRIES_MAX];",
          "40:  void *next;",
          "41: } var_dtor_entries;",
          "",
          "[Removed Lines]",
          "33:  long used_slots;",
          "39:  long used_slots;",
          "",
          "[Added Lines]",
          "33:  php_int_t used_slots;",
          "39:  php_int_t used_slots;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "120: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "121: {",
          "123:  var_entries *var_hash = (*var_hashx)->first;",
          "124: #if VAR_ENTRIES_DBG",
          "125:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "",
          "[Removed Lines]",
          "122:  long i;",
          "",
          "[Added Lines]",
          "122:  php_int_t i;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "136:  }",
          "137: }",
          "140: {",
          "141:  var_entries *var_hash = (*var_hashx)->first;",
          "142: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "139: static zval *var_access(php_unserialize_data_t *var_hashx, long id)",
          "",
          "[Added Lines]",
          "139: static zval *var_access(php_unserialize_data_t *var_hashx, php_int_t id)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "158: PHPAPI void var_destroy(php_unserialize_data_t *var_hashx)",
          "159: {",
          "160:  void *next;",
          "162:  var_entries *var_hash = (*var_hashx)->first;",
          "163:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "164: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "161:  long i;",
          "",
          "[Added Lines]",
          "161:  php_int_t i;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "242: {",
          "243:  char cursor;",
          "245:  int neg = 0;",
          "247:  switch (*p) {",
          "",
          "[Removed Lines]",
          "241: static inline long parse_iv2(const unsigned char *p, const unsigned char **q)",
          "244:  long result = 0;",
          "",
          "[Added Lines]",
          "241: static inline php_int_t parse_iv2(const unsigned char *p, const unsigned char **q)",
          "244:  php_int_t result = 0;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "266:  return result;",
          "267: }",
          "270: {",
          "271:  return parse_iv2(p, NULL);",
          "272: }",
          "",
          "[Removed Lines]",
          "269: static inline long parse_iv(const unsigned char *p)",
          "",
          "[Added Lines]",
          "269: static inline php_int_t parse_iv(const unsigned char *p)",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "296: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC",
          "297: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash TSRMLS_CC",
          "300: {",
          "301:  while (elements-- > 0) {",
          "302:   zval key, *data, d, *old_data;",
          "",
          "[Removed Lines]",
          "299: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long elements, int objprops)",
          "",
          "[Added Lines]",
          "299: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, php_int_t elements, int objprops)",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "381: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "382: {",
          "385:  datalen = parse_iv2((*p) + 2, p);",
          "387:  (*p) += 2;",
          "389:  if (datalen < 0 || (*p) + datalen >= max) {",
          "391:   return 0;",
          "392:  }",
          "",
          "[Removed Lines]",
          "383:  long datalen;",
          "390:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "",
          "[Added Lines]",
          "383:  php_int_t datalen;",
          "390:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (php_int_t)(max - (*p)));",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "403:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "404: }",
          "407: {",
          "410:  elements = parse_iv2((*p) + 2, p);",
          "",
          "[Removed Lines]",
          "406: static inline long object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "408:  long elements;",
          "",
          "[Added Lines]",
          "406: static inline php_int_t object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "408:  php_int_t elements;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "426: #ifdef PHP_WIN32",
          "427: # pragma optimize(\"\", off)",
          "428: #endif",
          "430: {",
          "431:  zval retval;",
          "432:  zval fname;",
          "",
          "[Removed Lines]",
          "429: static inline int object_common2(UNSERIALIZE_PARAMETER, long elements)",
          "",
          "[Added Lines]",
          "429: static inline int object_common2(UNSERIALIZE_PARAMETER, php_int_t elements)",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "625: #line 681 \"ext/standard/var_unserializer.re\"",
          "626:  {",
          "627:  size_t len, len2, len3, maxlen;",
          "629:  char *str;",
          "630:  zend_string *class_name;",
          "631:  zend_class_entry *ce;",
          "",
          "[Removed Lines]",
          "628:  long elements;",
          "",
          "[Added Lines]",
          "628:  php_int_t elements;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "817:  ++YYCURSOR;",
          "818: #line 652 \"ext/standard/var_unserializer.re\"",
          "819:  {",
          "",
          "[Removed Lines]",
          "820:  long elements = parse_iv(start + 2);",
          "",
          "[Added Lines]",
          "820:  php_int_t elements = parse_iv(start + 2);",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1023:  ++YYCURSOR;",
          "1024: #line 588 \"ext/standard/var_unserializer.re\"",
          "1025:  {",
          "1027: use_double:",
          "1028: #endif",
          "",
          "[Removed Lines]",
          "1026: #if SIZEOF_LONG == 4",
          "",
          "[Added Lines]",
          "1026: #if SIZEOF_ZEND_INT == 4",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "1134:  ++YYCURSOR;",
          "1135: #line 546 \"ext/standard/var_unserializer.re\"",
          "1136:  {",
          "1138:  int digits = YYCURSOR - start - 3;",
          "1140:  if (start[2] == '-' || start[2] == '+') {",
          "1141:   digits--;",
          "1142:  }",
          "1145:  if (digits >= MAX_LENGTH_OF_ZEND_INT - 1) {",
          "1146:   if (digits == MAX_LENGTH_OF_ZEND_INT - 1) {",
          "1147:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_ZEND_INT, int_min_digits, MAX_LENGTH_OF_ZEND_INT - 1);",
          "",
          "[Removed Lines]",
          "1137: #if SIZEOF_LONG == 4",
          "",
          "[Added Lines]",
          "1137: #if SIZEOF_ZEND_INT == 4",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1206:  ++YYCURSOR;",
          "1207: #line 511 \"ext/standard/var_unserializer.re\"",
          "1208:  {",
          "1212:  if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1209:  long id;",
          "",
          "[Added Lines]",
          "1209:  php_int_t id;",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1252:  ++YYCURSOR;",
          "1253: #line 489 \"ext/standard/var_unserializer.re\"",
          "1254:  {",
          "1258:  if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "1255:  long id;",
          "",
          "[Added Lines]",
          "1255:  php_int_t id;",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: typedef struct {",
          "30:  zval *data[VAR_ENTRIES_MAX];",
          "32:  void *next;",
          "33: } var_entries;",
          "35: typedef struct {",
          "36:  zval data[VAR_ENTRIES_MAX];",
          "38:  void *next;",
          "39: } var_dtor_entries;",
          "",
          "[Removed Lines]",
          "31:  long used_slots;",
          "37:  long used_slots;",
          "",
          "[Added Lines]",
          "31:  php_int_t used_slots;",
          "37:  php_int_t used_slots;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "118: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "119: {",
          "121:  var_entries *var_hash = (*var_hashx)->first;",
          "122: #if VAR_ENTRIES_DBG",
          "123:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "",
          "[Removed Lines]",
          "120:  long i;",
          "",
          "[Added Lines]",
          "120:  php_int_t i;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "134:  }",
          "135: }",
          "138: {",
          "139:  var_entries *var_hash = (*var_hashx)->first;",
          "140: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "137: static zval *var_access(php_unserialize_data_t *var_hashx, long id)",
          "",
          "[Added Lines]",
          "137: static zval *var_access(php_unserialize_data_t *var_hashx, php_int_t id)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "156: PHPAPI void var_destroy(php_unserialize_data_t *var_hashx)",
          "157: {",
          "158:  void *next;",
          "160:  var_entries *var_hash = (*var_hashx)->first;",
          "161:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "162: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "159:  long i;",
          "",
          "[Added Lines]",
          "159:  php_int_t i;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "246: {",
          "247:  char cursor;",
          "249:  int neg = 0;",
          "251:  switch (*p) {",
          "",
          "[Removed Lines]",
          "245: static inline long parse_iv2(const unsigned char *p, const unsigned char **q)",
          "248:  long result = 0;",
          "",
          "[Added Lines]",
          "245: static inline php_int_t parse_iv2(const unsigned char *p, const unsigned char **q)",
          "248:  php_int_t result = 0;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "270:  return result;",
          "271: }",
          "274: {",
          "275:  return parse_iv2(p, NULL);",
          "276: }",
          "",
          "[Removed Lines]",
          "273: static inline long parse_iv(const unsigned char *p)",
          "",
          "[Added Lines]",
          "273: static inline php_int_t parse_iv(const unsigned char *p)",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "300: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC",
          "301: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash TSRMLS_CC",
          "304: {",
          "305:  while (elements-- > 0) {",
          "306:   zval key, *data, d, *old_data;",
          "",
          "[Removed Lines]",
          "303: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, long elements, int objprops)",
          "",
          "[Added Lines]",
          "303: static inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, php_int_t elements, int objprops)",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "385: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "386: {",
          "389:  datalen = parse_iv2((*p) + 2, p);",
          "391:  (*p) += 2;",
          "393:  if (datalen < 0 || (*p) + datalen >= max) {",
          "395:   return 0;",
          "396:  }",
          "",
          "[Removed Lines]",
          "387:  long datalen;",
          "394:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "",
          "[Added Lines]",
          "387:  php_int_t datalen;",
          "394:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (php_int_t)(max - (*p)));",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "407:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "408: }",
          "411: {",
          "414:  elements = parse_iv2((*p) + 2, p);",
          "",
          "[Removed Lines]",
          "410: static inline long object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "412:  long elements;",
          "",
          "[Added Lines]",
          "410: static inline php_int_t object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "412:  php_int_t elements;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "430: #ifdef PHP_WIN32",
          "431: # pragma optimize(\"\", off)",
          "432: #endif",
          "434: {",
          "435:  zval retval;",
          "436:  zval fname;",
          "",
          "[Removed Lines]",
          "433: static inline int object_common2(UNSERIALIZE_PARAMETER, long elements)",
          "",
          "[Added Lines]",
          "433: static inline int object_common2(UNSERIALIZE_PARAMETER, php_int_t elements)",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "489: \"R:\" iv \";\"  {",
          "493:  if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "490:  long id;",
          "",
          "[Added Lines]",
          "490:  php_int_t id;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "509: }",
          "511: \"r:\" iv \";\"  {",
          "515:  if (!var_hash) return 0;",
          "",
          "[Removed Lines]",
          "512:  long id;",
          "",
          "[Added Lines]",
          "512:  php_int_t id;",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "544: }",
          "546: \"i:\" iv \";\" {",
          "548:  int digits = YYCURSOR - start - 3;",
          "550:  if (start[2] == '-' || start[2] == '+') {",
          "551:   digits--;",
          "552:  }",
          "555:  if (digits >= MAX_LENGTH_OF_ZEND_INT - 1) {",
          "556:   if (digits == MAX_LENGTH_OF_ZEND_INT - 1) {",
          "557:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_ZEND_INT, int_min_digits, MAX_LENGTH_OF_ZEND_INT - 1);",
          "",
          "[Removed Lines]",
          "547: #if SIZEOF_LONG == 4",
          "",
          "[Added Lines]",
          "547: #if SIZEOF_ZEND_INT == 4",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "586: }",
          "588: \"d:\" (iv | nv | nvexp) \";\" {",
          "590: use_double:",
          "591: #endif",
          "",
          "[Removed Lines]",
          "589: #if SIZEOF_LONG == 4",
          "",
          "[Added Lines]",
          "589: #if SIZEOF_ZEND_INT == 4",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "650: }",
          "652: \"a:\" uiv \":\" \"{\" {",
          "",
          "[Removed Lines]",
          "653:  long elements = parse_iv(start + 2);",
          "",
          "[Added Lines]",
          "653:  php_int_t elements = parse_iv(start + 2);",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "681: object \":\" uiv \":\" [\"] {",
          "682:  size_t len, len2, len3, maxlen;",
          "684:  char *str;",
          "685:  zend_string *class_name;",
          "686:  zend_class_entry *ce;",
          "",
          "[Removed Lines]",
          "683:  long elements;",
          "",
          "[Added Lines]",
          "683:  php_int_t elements;",
          "",
          "---------------"
        ]
      }
    }
  ]
}