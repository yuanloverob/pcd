{
  "cve_id": "CVE-2021-29566",
  "cve_desc": "TensorFlow is an end-to-end open source platform for machine learning. An attacker can write outside the bounds of heap allocated arrays by passing invalid arguments to `tf.raw_ops.Dilation2DBackpropInput`. This is because the implementation(https://github.com/tensorflow/tensorflow/blob/afd954e65f15aea4d438d0a219136fc4a63a573d/tensorflow/core/kernels/dilation_ops.cc#L321-L322) does not validate before writing to the output array. The values for `h_out` and `w_out` are guaranteed to be in range for `out_backprop` (as they are loop indices bounded by the size of the array). However, there are no similar guarantees relating `h_in_max`/`w_in_max` and `in_backprop`. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.",
  "repo": "tensorflow/tensorflow",
  "patch_hash": "3f6fe4dfef6f57e768260b48166c27d148f3015f",
  "patch_info": {
    "commit_hash": "3f6fe4dfef6f57e768260b48166c27d148f3015f",
    "repo": "tensorflow/tensorflow",
    "commit_url": "https://github.com/tensorflow/tensorflow/commit/3f6fe4dfef6f57e768260b48166c27d148f3015f",
    "files": [
      "tensorflow/core/kernels/dilation_ops.cc"
    ],
    "message": "Add missing validations in dillation ops.\n\nPiperOrigin-RevId: 372037158\nChange-Id: I4ee304c84a02550c030288a6534000b934fc1599",
    "before_after_code_files": [
      "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
    ]
  },
  "patch_diff": {
    "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc": [
      "File: tensorflow/core/kernels/dilation_ops.cc -> tensorflow/core/kernels/dilation_ops.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "130:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
      "131:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
      "132:                &out_cols);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "133:     if (!context->status().ok()) return;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "229:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
      "230:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
      "231:                &out_cols);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "233:     if (!context->status().ok()) return;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "318:                 }",
      "319:               }",
      "320:             }",
      "323:           }",
      "324:         }",
      "325:       }",
      "",
      "[Removed Lines]",
      "321:             in_backprop(b, h_in_max, w_in_max, d) +=",
      "322:                 out_backprop(b, h_out, w_out, d);",
      "",
      "[Added Lines]",
      "323:             if (h_in_max < input_rows && w_in_max < input_cols) {",
      "324:               in_backprop(b, h_in_max, w_in_max, d) +=",
      "325:                   out_backprop(b, h_out, w_out, d);",
      "326:             }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "349:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
      "350:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
      "351:                &out_cols);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "356:     if (!context->status().ok()) return;",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "438:                 }",
      "439:               }",
      "440:             }",
      "443:           }",
      "444:         }",
      "445:       }",
      "",
      "[Removed Lines]",
      "441:             filter_backprop(h_max, w_max, d) +=",
      "442:                 out_backprop(b, h_out, w_out, d);",
      "",
      "[Added Lines]",
      "446:             if (h_max < filter_rows && w_max < filter_cols) {",
      "447:               filter_backprop(h_max, w_max, d) +=",
      "448:                   out_backprop(b, h_out, w_out, d);",
      "449:             }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8cd0dd556c56dcf9741f4d5893c9e2c67cfaf325",
      "candidate_info": {
        "commit_hash": "8cd0dd556c56dcf9741f4d5893c9e2c67cfaf325",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/8cd0dd556c56dcf9741f4d5893c9e2c67cfaf325",
        "files": [
          "tensorflow/core/kernels/dilation_ops.cc"
        ],
        "message": "Add missing validations in dillation ops.\n\nPiperOrigin-RevId: 372037158\nChange-Id: I4ee304c84a02550c030288a6534000b934fc1599",
        "before_after_code_files": [
          "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc": [
          "File: tensorflow/core/kernels/dilation_ops.cc -> tensorflow/core/kernels/dilation_ops.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "131:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "132:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "133:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "229:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "230:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "231:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "233:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "318:                 }",
          "319:               }",
          "320:             }",
          "323:           }",
          "324:         }",
          "325:       }",
          "",
          "[Removed Lines]",
          "321:             in_backprop(b, h_in_max, w_in_max, d) +=",
          "322:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "323:             if (h_in_max < input_rows && w_in_max < input_cols) {",
          "324:               in_backprop(b, h_in_max, w_in_max, d) +=",
          "325:                   out_backprop(b, h_out, w_out, d);",
          "326:             }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "349:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "350:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "351:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "356:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "438:                 }",
          "439:               }",
          "440:             }",
          "443:           }",
          "444:         }",
          "445:       }",
          "",
          "[Removed Lines]",
          "441:             filter_backprop(h_max, w_max, d) +=",
          "442:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "446:             if (h_max < filter_rows && w_max < filter_cols) {",
          "447:               filter_backprop(h_max, w_max, d) +=",
          "448:                   out_backprop(b, h_out, w_out, d);",
          "449:             }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "048526458b2637b16c8d97f5c9a47f57ec0ed635",
      "candidate_info": {
        "commit_hash": "048526458b2637b16c8d97f5c9a47f57ec0ed635",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/048526458b2637b16c8d97f5c9a47f57ec0ed635",
        "files": [
          "tensorflow/core/kernels/dilation_ops.cc"
        ],
        "message": "Add missing validations in dillation ops.\n\nPiperOrigin-RevId: 372037158\nChange-Id: I4ee304c84a02550c030288a6534000b934fc1599",
        "before_after_code_files": [
          "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc": [
          "File: tensorflow/core/kernels/dilation_ops.cc -> tensorflow/core/kernels/dilation_ops.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "131:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "132:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "133:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "229:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "230:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "231:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "233:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "318:                 }",
          "319:               }",
          "320:             }",
          "323:           }",
          "324:         }",
          "325:       }",
          "",
          "[Removed Lines]",
          "321:             in_backprop(b, h_in_max, w_in_max, d) +=",
          "322:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "323:             if (h_in_max < input_rows && w_in_max < input_cols) {",
          "324:               in_backprop(b, h_in_max, w_in_max, d) +=",
          "325:                   out_backprop(b, h_out, w_out, d);",
          "326:             }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "349:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "350:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "351:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "356:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "438:                 }",
          "439:               }",
          "440:             }",
          "443:           }",
          "444:         }",
          "445:       }",
          "",
          "[Removed Lines]",
          "441:             filter_backprop(h_max, w_max, d) +=",
          "442:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "446:             if (h_max < filter_rows && w_max < filter_cols) {",
          "447:               filter_backprop(h_max, w_max, d) +=",
          "448:                   out_backprop(b, h_out, w_out, d);",
          "449:             }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "bce9d7c9545bf09fce34fbf4e7006508fd9260e9",
      "candidate_info": {
        "commit_hash": "bce9d7c9545bf09fce34fbf4e7006508fd9260e9",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/bce9d7c9545bf09fce34fbf4e7006508fd9260e9",
        "files": [
          "tensorflow/core/kernels/dilation_ops.cc"
        ],
        "message": "Add missing validations in dillation ops.\n\nPiperOrigin-RevId: 372037158\nChange-Id: I4ee304c84a02550c030288a6534000b934fc1599",
        "before_after_code_files": [
          "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc": [
          "File: tensorflow/core/kernels/dilation_ops.cc -> tensorflow/core/kernels/dilation_ops.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "131:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "132:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "133:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "229:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "230:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "231:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "233:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "318:                 }",
          "319:               }",
          "320:             }",
          "323:           }",
          "324:         }",
          "325:       }",
          "",
          "[Removed Lines]",
          "321:             in_backprop(b, h_in_max, w_in_max, d) +=",
          "322:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "323:             if (h_in_max < input_rows && w_in_max < input_cols) {",
          "324:               in_backprop(b, h_in_max, w_in_max, d) +=",
          "325:                   out_backprop(b, h_out, w_out, d);",
          "326:             }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "349:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "350:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "351:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "356:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "438:                 }",
          "439:               }",
          "440:             }",
          "443:           }",
          "444:         }",
          "445:       }",
          "",
          "[Removed Lines]",
          "441:             filter_backprop(h_max, w_max, d) +=",
          "442:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "446:             if (h_max < filter_rows && w_max < filter_cols) {",
          "447:               filter_backprop(h_max, w_max, d) +=",
          "448:                   out_backprop(b, h_out, w_out, d);",
          "449:             }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5cfa1d3e6040b5abc3c94709ba713982948f701e",
      "candidate_info": {
        "commit_hash": "5cfa1d3e6040b5abc3c94709ba713982948f701e",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/5cfa1d3e6040b5abc3c94709ba713982948f701e",
        "files": [
          "tensorflow/core/kernels/dilation_ops.cc"
        ],
        "message": "Add missing validations in dillation ops.\n\nPiperOrigin-RevId: 372037158\nChange-Id: I4ee304c84a02550c030288a6534000b934fc1599",
        "before_after_code_files": [
          "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc": [
          "File: tensorflow/core/kernels/dilation_ops.cc -> tensorflow/core/kernels/dilation_ops.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "131:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "132:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "133:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "229:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "230:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "231:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "233:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "318:                 }",
          "319:               }",
          "320:             }",
          "323:           }",
          "324:         }",
          "325:       }",
          "",
          "[Removed Lines]",
          "321:             in_backprop(b, h_in_max, w_in_max, d) +=",
          "322:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "323:             if (h_in_max < input_rows && w_in_max < input_cols) {",
          "324:               in_backprop(b, h_in_max, w_in_max, d) +=",
          "325:                   out_backprop(b, h_out, w_out, d);",
          "326:             }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "349:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "350:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "351:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "356:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "438:                 }",
          "439:               }",
          "440:             }",
          "443:           }",
          "444:         }",
          "445:       }",
          "",
          "[Removed Lines]",
          "441:             filter_backprop(h_max, w_max, d) +=",
          "442:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "446:             if (h_max < filter_rows && w_max < filter_cols) {",
          "447:               filter_backprop(h_max, w_max, d) +=",
          "448:                   out_backprop(b, h_out, w_out, d);",
          "449:             }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2a996db49a8c1ddf5321f99718e8a5cff6ac0e50",
      "candidate_info": {
        "commit_hash": "2a996db49a8c1ddf5321f99718e8a5cff6ac0e50",
        "repo": "tensorflow/tensorflow",
        "commit_url": "https://github.com/tensorflow/tensorflow/commit/2a996db49a8c1ddf5321f99718e8a5cff6ac0e50",
        "files": [
          "tensorflow/core/kernels/dilation_ops.cc"
        ],
        "message": "Add missing validations in dillation ops.\n\nPiperOrigin-RevId: 372037158\nChange-Id: I4ee304c84a02550c030288a6534000b934fc1599",
        "before_after_code_files": [
          "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ],
          "candidate": [
            "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc"
          ]
        }
      },
      "candidate_diff": {
        "tensorflow/core/kernels/dilation_ops.cc||tensorflow/core/kernels/dilation_ops.cc": [
          "File: tensorflow/core/kernels/dilation_ops.cc -> tensorflow/core/kernels/dilation_ops.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "131:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "132:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "133:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "229:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "230:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "231:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "233:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "318:                 }",
          "319:               }",
          "320:             }",
          "323:           }",
          "324:         }",
          "325:       }",
          "",
          "[Removed Lines]",
          "321:             in_backprop(b, h_in_max, w_in_max, d) +=",
          "322:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "323:             if (h_in_max < input_rows && w_in_max < input_cols) {",
          "324:               in_backprop(b, h_in_max, w_in_max, d) +=",
          "325:                   out_backprop(b, h_out, w_out, d);",
          "326:             }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "349:     ParseSizes(context, strides_, rates_, padding_, &stride_rows, &stride_cols,",
          "350:                &rate_rows, &rate_cols, &pad_top, &pad_left, &out_rows,",
          "351:                &out_cols);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "356:     if (!context->status().ok()) return;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "438:                 }",
          "439:               }",
          "440:             }",
          "443:           }",
          "444:         }",
          "445:       }",
          "",
          "[Removed Lines]",
          "441:             filter_backprop(h_max, w_max, d) +=",
          "442:                 out_backprop(b, h_out, w_out, d);",
          "",
          "[Added Lines]",
          "446:             if (h_max < filter_rows && w_max < filter_cols) {",
          "447:               filter_backprop(h_max, w_max, d) +=",
          "448:                   out_backprop(b, h_out, w_out, d);",
          "449:             }",
          "",
          "---------------"
        ]
      }
    }
  ]
}