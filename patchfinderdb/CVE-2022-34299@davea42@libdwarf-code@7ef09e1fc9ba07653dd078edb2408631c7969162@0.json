{
  "cve_id": "CVE-2022-34299",
  "cve_desc": "There is a heap-based buffer over-read in libdwarf 0.4.0. This issue is related to dwarf_global_formref_b.",
  "repo": "davea42/libdwarf-code",
  "patch_hash": "7ef09e1fc9ba07653dd078edb2408631c7969162",
  "patch_info": {
    "commit_hash": "7ef09e1fc9ba07653dd078edb2408631c7969162",
    "repo": "davea42/libdwarf-code",
    "commit_url": "https://github.com/davea42/libdwarf-code/commit/7ef09e1fc9ba07653dd078edb2408631c7969162",
    "files": [
      "src/lib/libdwarf/dwarf_form.c"
    ],
    "message": "Fixes old bug(which could result in Denial of Service) due to a missing check before reading the 8 bytes of a DW_FORM_ref_sig8. DW202206-001 \tmodified:   src/lib/libdwarf/dwarf_form.c",
    "before_after_code_files": [
      "src/lib/libdwarf/dwarf_form.c||src/lib/libdwarf/dwarf_form.c"
    ]
  },
  "patch_diff": {
    "src/lib/libdwarf/dwarf_form.c||src/lib/libdwarf/dwarf_form.c": [
      "File: src/lib/libdwarf/dwarf_form.c -> src/lib/libdwarf/dwarf_form.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "837:         Dwarf_Bool t_is_info = TRUE;",
      "838:         Dwarf_Unsigned t_offset = 0;",
      "840:         memcpy(&sig8,attr->ar_debug_ptr,sizeof(Dwarf_Sig8));",
      "841:         res = find_sig8_target_as_global_offset(attr,",
      "842:             &sig8,&t_is_info,&t_offset,error);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "839:         if ((attr->ar_debug_ptr + sizeof(Dwarf_Sig8)) > section_end) {",
      "840:             _dwarf_error_string(dbg, error,",
      "841:                 DW_DLE_REF_SIG8_NOT_HANDLED,",
      "842:                 \"DW_DLE_REF_SIG8_NOT_HANDLED: \"",
      "843:                 \" Dwarf_Sig8 content runs off the end of its section\");",
      "844:             return DW_DLV_ERROR;",
      "845:         }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "aefc12ea2baf55f68c2025874a61728d30864266",
      "candidate_info": {
        "commit_hash": "aefc12ea2baf55f68c2025874a61728d30864266",
        "repo": "davea42/libdwarf-code",
        "commit_url": "https://github.com/davea42/libdwarf-code/commit/aefc12ea2baf55f68c2025874a61728d30864266",
        "files": [
          "src/lib/libdwarf/dwarf_form.c"
        ],
        "message": "Shortened one line past the libdwarf line length limit. \tmodified:   dwarf_form.c",
        "before_after_code_files": [
          "src/lib/libdwarf/dwarf_form.c||src/lib/libdwarf/dwarf_form.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/lib/libdwarf/dwarf_form.c||src/lib/libdwarf/dwarf_form.c"
          ],
          "candidate": [
            "src/lib/libdwarf/dwarf_form.c||src/lib/libdwarf/dwarf_form.c"
          ]
        }
      },
      "candidate_diff": {
        "src/lib/libdwarf/dwarf_form.c||src/lib/libdwarf/dwarf_form.c": [
          "File: src/lib/libdwarf/dwarf_form.c -> src/lib/libdwarf/dwarf_form.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "840:             _dwarf_error_string(dbg, error,",
          "841:                 DW_DLE_REF_SIG8_NOT_HANDLED,",
          "842:                 \"DW_DLE_REF_SIG8_NOT_HANDLED: \"",
          "844:             return DW_DLV_ERROR;",
          "845:         }",
          "846:         memcpy(&sig8,attr->ar_debug_ptr,sizeof(Dwarf_Sig8));",
          "",
          "[Removed Lines]",
          "843:                 \" Dwarf_Sig8 content runs off the end of its section\");",
          "",
          "[Added Lines]",
          "843:                 \" Dwarf_Sig8 content runs off the end of \"",
          "844:                 \"its section\");",
          "",
          "---------------"
        ]
      }
    }
  ]
}