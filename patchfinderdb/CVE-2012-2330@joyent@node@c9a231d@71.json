{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "531eba18a67805f7a95d20f7f9e684d83c5091b6",
      "candidate_info": {
        "commit_hash": "531eba18a67805f7a95d20f7f9e684d83c5091b6",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/531eba18a67805f7a95d20f7f9e684d83c5091b6",
        "files": [
          "src/node_zlib.cc"
        ],
        "message": "zlib: fix include of zlib.h\n\nIncluding <zlib.h> may lead to false positives when the user specifies a bad\npath in `./configure --shared-zlib --shared-zlib-includes=/path/to/zlib`. If\na zlib.h exists somewhere on the system include path (common on UNIX systems),\nthe compiler will include that instead, possibly leading to header mismatch\nerrors that are hard to debug.",
        "before_after_code_files": [
          "src/node_zlib.cc||src/node_zlib.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_zlib.cc||src/node_zlib.cc": [
          "File: src/node_zlib.cc -> src/node_zlib.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: #include <string.h>",
          "26: #include <stdlib.h>",
          "27: #include <sys/types.h>",
          "30: #include \"node.h\"",
          "31: #include \"node_buffer.h\"",
          "",
          "[Removed Lines]",
          "28: #include <zlib.h>",
          "",
          "[Added Lines]",
          "29: #include \"zlib.h\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "89556f5a2f64abcc6cecd3d412488e2ff6d6cd01",
      "candidate_info": {
        "commit_hash": "89556f5a2f64abcc6cecd3d412488e2ff6d6cd01",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/89556f5a2f64abcc6cecd3d412488e2ff6d6cd01",
        "files": [
          "src/node_zlib.cc"
        ],
        "message": "zlib: C++ style fixes for dictionary",
        "before_after_code_files": [
          "src/node_zlib.cc||src/node_zlib.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_zlib.cc||src/node_zlib.cc": [
          "File: src/node_zlib.cc -> src/node_zlib.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "166:           assert(ctx->dictionary_ != NULL && \"Stream has no dictionary\");",
          "174:           assert(err == Z_OK && \"Failed to set dictionary\");",
          "178:         }",
          "179:         break;",
          "180:       default:",
          "",
          "[Removed Lines]",
          "169:           err = inflateSetDictionary(",
          "170:               &(ctx->strm_),",
          "171:               ctx->dictionary_,",
          "172:               ctx->dictionary_len_",
          "173:           );",
          "177:           err = inflate(&(ctx->strm_), ctx->flush_);",
          "",
          "[Added Lines]",
          "169:           err = inflateSetDictionary(&ctx->strm_,",
          "170:                                      ctx->dictionary_,",
          "171:                                      ctx->dictionary_len_);",
          "175:           err = inflate(&ctx->strm_, ctx->flush_);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "284:       case DEFLATE:",
          "285:       case GZIP:",
          "286:       case DEFLATERAW:",
          "288:                            ctx->level_,",
          "289:                            Z_DEFLATED,",
          "290:                            ctx->windowBits_,",
          "",
          "[Removed Lines]",
          "287:         err = deflateInit2(&(ctx->strm_),",
          "",
          "[Added Lines]",
          "285:         err = deflateInit2(&ctx->strm_,",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "295:       case GUNZIP:",
          "296:       case INFLATERAW:",
          "297:       case UNZIP:",
          "299:         break;",
          "300:       default:",
          "301:         assert(0 && \"wtf?\");",
          "",
          "[Removed Lines]",
          "298:         err = inflateInit2(&(ctx->strm_), ctx->windowBits_);",
          "",
          "[Added Lines]",
          "296:         err = inflateInit2(&ctx->strm_, ctx->windowBits_);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "310:       switch (mode) {",
          "311:         case DEFLATE:",
          "312:         case DEFLATERAW:",
          "318:           break;",
          "319:         default:",
          "320:           break;",
          "",
          "[Removed Lines]",
          "313:           err = deflateSetDictionary(",
          "314:               &(ctx->strm_),",
          "315:               ctx->dictionary_,",
          "316:               dictionary_len",
          "317:           );",
          "",
          "[Added Lines]",
          "311:           err = deflateSetDictionary(&ctx->strm_,",
          "312:                                      ctx->dictionary_,",
          "313:                                      dictionary_len);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7817f4832271efc51e3d6615d1d2aa8cdb781fa4",
      "candidate_info": {
        "commit_hash": "7817f4832271efc51e3d6615d1d2aa8cdb781fa4",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/7817f4832271efc51e3d6615d1d2aa8cdb781fa4",
        "files": [
          "tools/installer.js"
        ],
        "message": "fixed booleans being treated as strings, resulting in missing node-waf and npm",
        "before_after_code_files": [
          "tools/installer.js||tools/installer.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tools/installer.js||tools/installer.js": [
          "File: tools/installer.js -> tools/installer.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "118:   copy('out/Release/node', 'bin/node');",
          "122:     copy('tools/wafadmin', 'lib/node/');",
          "123:     copy('tools/node-waf', 'bin/node-waf');",
          "124:   }",
          "128:     copy('deps/npm', 'lib/node_modules/npm');",
          "129:     queue.push('ln -sf ../lib/node_modules/npm/bin/npm-cli.js ' +",
          "130:                path.join(node_prefix, 'bin/npm'));",
          "",
          "[Removed Lines]",
          "121:   if (variables.node_install_waf == 'true') {",
          "127:   if (variables.node_install_npm == 'true') {",
          "",
          "[Added Lines]",
          "121:   if (variables.node_install_waf) {",
          "127:   if (variables.node_install_npm) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "42ea37afb2b6e8cf6cd2aad36b7106be87e89e4a",
      "candidate_info": {
        "commit_hash": "42ea37afb2b6e8cf6cd2aad36b7106be87e89e4a",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/42ea37afb2b6e8cf6cd2aad36b7106be87e89e4a",
        "files": [
          "src/node_version.h"
        ],
        "message": "Now working on 0.9.0",
        "before_after_code_files": [
          "src/node_version.h||src/node_version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_version.h||src/node_version.h": [
          "File: src/node_version.h -> src/node_version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "23: #define NODE_VERSION_H",
          "25: #define NODE_MAJOR_VERSION 0",
          "28: #define NODE_VERSION_IS_RELEASE 0",
          "30: #ifndef NODE_STRINGIFY",
          "",
          "[Removed Lines]",
          "26: #define NODE_MINOR_VERSION 8",
          "27: #define NODE_PATCH_VERSION 1",
          "",
          "[Added Lines]",
          "26: #define NODE_MINOR_VERSION 9",
          "27: #define NODE_PATCH_VERSION 0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3e8857271bf237d9edc19b2b3e75466801dd0405",
      "candidate_info": {
        "commit_hash": "3e8857271bf237d9edc19b2b3e75466801dd0405",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/3e8857271bf237d9edc19b2b3e75466801dd0405",
        "files": [
          "tools/msvs/msi/product.wxs"
        ],
        "message": "Windows: installer shows license agreement dialog",
        "before_after_code_files": [
          "tools/msvs/msi/product.wxs||tools/msvs/msi/product.wxs"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tools/msvs/msi/product.wxs||tools/msvs/msi/product.wxs": [
          "File: tools/msvs/msi/product.wxs -> tools/msvs/msi/product.wxs",
          "--- Hunk 1 ---",
          "[Context before]",
          "102:       <DialogRef Id=\"ProgressDlg\" />",
          "103:       <DialogRef Id=\"ResumeDlg\" />",
          "104:       <DialogRef Id=\"UserExit\" />",
          "108:       <Publish Dialog=\"ExitDialog\" Control=\"Finish\" Event=\"EndDialog\" Value=\"Return\" Order=\"999\">1</Publish>",
          "109:       <Publish Dialog=\"VerifyReadyDlg\" Control=\"Back\" Event=\"NewDialog\" Value=\"MaintenanceTypeDlg\">1</Publish>",
          "110:       <Publish Dialog=\"MaintenanceWelcomeDlg\" Control=\"Next\" Event=\"NewDialog\" Value=\"MaintenanceTypeDlg\">1</Publish>",
          "",
          "[Removed Lines]",
          "105:       <DialogRef Id=\"WelcomeDlg\" />",
          "107:       <Publish Dialog=\"WelcomeDlg\" Control=\"Next\" Event=\"NewDialog\" Value=\"PrepareDlg\">1</Publish>",
          "",
          "[Added Lines]",
          "105:       <DialogRef Id=\"WelcomeDlg\" />",
          "106:       <DialogRef Id=\"LicenseAgreementDlg\"/>",
          "108:       <Publish Dialog=\"WelcomeDlg\" Control=\"Next\" Event=\"NewDialog\" Value=\"LicenseAgreementDlg\">1</Publish>",
          "109:       <Publish Dialog=\"LicenseAgreementDlg\" Control=\"Back\" Event=\"NewDialog\" Value=\"WelcomeDlg\">1</Publish>",
          "110:       <Publish Dialog=\"LicenseAgreementDlg\" Control=\"Next\" Event=\"NewDialog\" Value=\"PrepareDlg\">1</Publish>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "120:     <UIRef Id=\"WixUI_Common\" />",
          "121:     <WixVariable Id=\"WixUIBannerBmp\" Value=\"..\\..\\..\\doc\\thin-white-stripe.jpg\" />",
          "122:     <WixVariable Id=\"WixUIDialogBmp\" Value=\"..\\..\\..\\doc\\full-white-stripe.jpg\" />",
          "123:   </Product>",
          "125: </Wix>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "126:     <WixVariable Id=\"WixUILicenseRtf\" Value=\"$(var.sourcedir)\\LICENSE.rtf\" />",
          "",
          "---------------"
        ]
      }
    }
  ]
}