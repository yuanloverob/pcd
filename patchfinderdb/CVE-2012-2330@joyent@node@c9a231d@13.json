{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "50cfeef65e60690b6d318a294981aaed4bc98dcc",
      "candidate_info": {
        "commit_hash": "50cfeef65e60690b6d318a294981aaed4bc98dcc",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/50cfeef65e60690b6d318a294981aaed4bc98dcc",
        "files": [
          "deps/v8/build/common.gypi"
        ],
        "message": "Remove -Wall from v8 build",
        "before_after_code_files": [
          "deps/v8/build/common.gypi||deps/v8/build/common.gypi"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/v8/build/common.gypi||deps/v8/build/common.gypi": [
          "File: deps/v8/build/common.gypi -> deps/v8/build/common.gypi",
          "--- Hunk 1 ---",
          "[Context before]",
          "305:             'cflags': [ '-I/usr/pkg/include' ],",
          "306:           }],",
          "307:           ['OS==\"linux\" or OS==\"freebsd\" or OS==\"openbsd\" or OS==\"netbsd\"', {",
          "309:                         '-Wnon-virtual-dtor', '-Woverloaded-virtual' ],",
          "310:           }],",
          "311:         ],",
          "",
          "[Removed Lines]",
          "308:             'cflags': [ '-Wall', '<(werror)', '-W', '-Wno-unused-parameter',",
          "",
          "[Added Lines]",
          "308:             'cflags': [ '-Wno-unused-parameter',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "de65ba7aba0e48a846e8cad86278f51372d3de23",
      "candidate_info": {
        "commit_hash": "de65ba7aba0e48a846e8cad86278f51372d3de23",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/de65ba7aba0e48a846e8cad86278f51372d3de23",
        "files": [
          "lib/net.js",
          "test/simple/test-net-socket-pause-resume-immediate.js"
        ],
        "message": "net.Socket: Delay pause/resume until after connect\n\nFix #3118",
        "before_after_code_files": [
          "lib/net.js||linet.js",
          "test/simple/test-net-socket-pause-resume-immediate.js||test/simple/test-net-socket-pause-resume-immediate.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/net.js||linet.js": [
          "File: lib/net.js -> linet.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "238: Socket.prototype.pause = function() {",
          "239:   if (this._handle) {",
          "240:     this._handle.readStop();",
          "241:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "245: Socket.prototype.resume = function() {",
          "246:   if (this._handle) {",
          "247:     this._handle.readStart();",
          "248:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "733:   assert.ok(self._connecting);",
          "734:   self._connecting = false;",
          "736:   if (status == 0) {",
          "737:     self.readable = readable;",
          "738:     self.writable = writable;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/simple/test-net-socket-pause-resume-immediate.js||test/simple/test-net-socket-pause-resume-immediate.js": [
          "File: test/simple/test-net-socket-pause-resume-immediate.js -> test/simple/test-net-socket-pause-resume-immediate.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22: var common = require('../common');",
          "23: var assert = require('assert');",
          "24: var net = require('net');",
          "26: var sock = net.connect(1234, 'localhost');",
          "27: sock.pause();",
          "28: sock.resume();",
          "29: console.log('ok');",
          "30: process.exit(0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5937d02aed663ca0832f2bad09620ee50579695c",
      "candidate_info": {
        "commit_hash": "5937d02aed663ca0832f2bad09620ee50579695c",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/5937d02aed663ca0832f2bad09620ee50579695c",
        "files": [
          "tools/msvs/msi/product.wxs"
        ],
        "message": "msi: npm bash shim fixes",
        "before_after_code_files": [
          "tools/msvs/msi/product.wxs||tools/msvs/msi/product.wxs"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tools/msvs/msi/product.wxs||tools/msvs/msi/product.wxs": [
          "File: tools/msvs/msi/product.wxs -> tools/msvs/msi/product.wxs",
          "--- Hunk 1 ---",
          "[Context before]",
          "47:             <File Id=\"filenpmcmd\" KeyPath=\"yes\" Source=\"$(var.NPMSourceDir)\\bin\\npm.cmd\" />",
          "48:           </Component>",
          "49:           <Component Id=\"npmsh\" Guid=\"57754e12-9269-4198-a38c-2c098bf5276e\">",
          "51:           </Component>",
          "52:           <?if $(var.Configuration) = Debug ?>",
          "53:           <Component Id=\"nodepdb\" Guid=\"BEC0F08E-89B3-4C35-A286-8DB8598597F2\">",
          "",
          "[Removed Lines]",
          "50:             <File Id=\"filenpmcmd\" KeyPath=\"yes\" Source=\"$(var.NPMSourceDir)\\bin\\npm\" />",
          "",
          "[Added Lines]",
          "50:             <File Id=\"filenpmsh\" KeyPath=\"yes\" Source=\"$(var.NPMSourceDir)\\bin\\npm\" />",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "72:     <ComponentGroup Id=\"allfiles\">",
          "73:       <ComponentRef Id=\"nodeexe\"/>",
          "74:       <ComponentRef Id=\"npmcmd\"/>",
          "75:       <ComponentRef Id=\"npmrc\" />",
          "76:       <ComponentRef Id=\"npmappdata_folder\" />",
          "77:       <ComponentGroupRef Id=\"NPMFiles\" />",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "75:       <ComponentRef Id=\"npmsh\"/>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b72d43cbf9116fb5eb0dc92006dbc180d4db7d3e",
      "candidate_info": {
        "commit_hash": "b72d43cbf9116fb5eb0dc92006dbc180d4db7d3e",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/b72d43cbf9116fb5eb0dc92006dbc180d4db7d3e",
        "files": [
          "lib/dgram.js",
          "test/simple/test-dgram-bind.js"
        ],
        "message": "dgram: fix when we call .close() inside 'listening'",
        "before_after_code_files": [
          "lib/dgram.js||lidgram.js",
          "test/simple/test-dgram-bind.js||test/simple/test-dgram-bind.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/dgram.js||lidgram.js": [
          "File: lib/dgram.js -> lidgram.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "124:       }",
          "125:       else {",
          "126:         self._bound = true;",
          "128:         self._startReceiving();",
          "129:       }",
          "130:     }",
          "",
          "[Removed Lines]",
          "127:         self.emit('listening');",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/simple/test-dgram-bind.js||test/simple/test-dgram-bind.js": [
          "File: test/simple/test-dgram-bind.js -> test/simple/test-dgram-bind.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22: var common = require('../common');",
          "23: var assert = require('assert');",
          "24: var dgram = require('dgram');",
          "26: var socket = dgram.createSocket('udp4');",
          "28: socket.on('listening', function () {",
          "29:   socket.close();",
          "30: });",
          "32: socket.bind(); // should not throw",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3f4062309e6bead91111db9811b5e6e2c20ca2a9",
      "candidate_info": {
        "commit_hash": "3f4062309e6bead91111db9811b5e6e2c20ca2a9",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/3f4062309e6bead91111db9811b5e6e2c20ca2a9",
        "files": [
          "src/node.cc"
        ],
        "message": "core: ignore too many arguments, don't assert",
        "before_after_code_files": [
          "src/node.cc||src/node.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node.cc||src/node.cc": [
          "File: src/node.cc -> src/node.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "1333: static Handle<Value> GetUid(const Arguments& args) {",
          "1334:   HandleScope scope;",
          "1336:   int uid = getuid();",
          "1337:   return scope.Close(Integer::New(uid));",
          "1338: }",
          "",
          "[Removed Lines]",
          "1335:   assert(args.Length() == 0);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1341: static Handle<Value> GetGid(const Arguments& args) {",
          "1342:   HandleScope scope;",
          "1344:   int gid = getgid();",
          "1345:   return scope.Close(Integer::New(gid));",
          "1346: }",
          "",
          "[Removed Lines]",
          "1343:   assert(args.Length() == 0);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1464: static Handle<Value> Uptime(const Arguments& args) {",
          "1465:   HandleScope scope;",
          "1467:   double uptime;",
          "1469:   uv_err_t err = uv_uptime(&uptime);",
          "",
          "[Removed Lines]",
          "1466:   assert(args.Length() == 0);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1511: v8::Handle<v8::Value> MemoryUsage(const v8::Arguments& args) {",
          "1512:   HandleScope scope;",
          "1515:   size_t rss;",
          "",
          "[Removed Lines]",
          "1513:   assert(args.Length() == 0);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}