{
  "cve_id": "CVE-2015-0216",
  "cve_desc": "access.php in the Lesson module in Moodle 2.8.x before 2.8.2 does not set the RISK_XSS bit for graders, which allows remote authenticated users to conduct cross-site scripting (XSS) attacks via crafted essay feedback.",
  "repo": "moodle/moodle",
  "patch_hash": "b9c86823c70a1cba20bca1c4b5b032ee1559e22d",
  "patch_info": {
    "commit_hash": "b9c86823c70a1cba20bca1c4b5b032ee1559e22d",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/b9c86823c70a1cba20bca1c4b5b032ee1559e22d",
    "files": [
      "mod/lesson/db/access.php",
      "mod/lesson/version.php"
    ],
    "message": "MDL-48034 mod_lesson: grade capability missing RISK_XSS",
    "before_after_code_files": [
      "mod/lesson/db/access.php||mod/lesson/db/access.php",
      "mod/lesson/version.php||mod/lesson/version.php"
    ]
  },
  "patch_diff": {
    "mod/lesson/db/access.php||mod/lesson/db/access.php": [
      "File: mod/lesson/db/access.php -> mod/lesson/db/access.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "56:     'mod/lesson:grade' => array(",
      "58:         'captype' => 'write',",
      "59:         'contextlevel' => CONTEXT_MODULE,",
      "60:         'archetypes' => array(",
      "",
      "[Removed Lines]",
      "57:         'riskbitmask' => RISK_SPAM,",
      "",
      "[Added Lines]",
      "57:         'riskbitmask' => RISK_SPAM | RISK_XSS,",
      "",
      "---------------"
    ],
    "mod/lesson/version.php||mod/lesson/version.php": [
      "File: mod/lesson/version.php -> mod/lesson/version.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "25: defined('MOODLE_INTERNAL') || die();",
      "28: $plugin->requires  = 2014110400;    // Requires this Moodle version",
      "29: $plugin->component = 'mod_lesson'; // Full name of the plugin (used for diagnostics)",
      "30: $plugin->cron      = 0;",
      "",
      "[Removed Lines]",
      "27: $plugin->version   = 2014122900;       // The current module version (Date: YYYYMMDDXX)",
      "",
      "[Added Lines]",
      "27: $plugin->version   = 2015010600;       // The current module version (Date: YYYYMMDDXX)",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "106486c7adc2f64a997c406157d8ef7eeeffa772",
      "candidate_info": {
        "commit_hash": "106486c7adc2f64a997c406157d8ef7eeeffa772",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/106486c7adc2f64a997c406157d8ef7eeeffa772",
        "files": [
          "mod/lesson/db/upgrade.php",
          "mod/lesson/version.php"
        ],
        "message": "MDL-38106 lesson: don't require intro when upgraded",
        "before_after_code_files": [
          "mod/lesson/db/upgrade.php||mod/lesson/dupgrade.php",
          "mod/lesson/version.php||mod/lesson/version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "mod/lesson/version.php||mod/lesson/version.php"
          ],
          "candidate": [
            "mod/lesson/version.php||mod/lesson/version.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/lesson/db/upgrade.php||mod/lesson/dupgrade.php": [
          "File: mod/lesson/db/upgrade.php -> mod/lesson/dupgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "92:         upgrade_mod_savepoint(true, 2014091001, 'lesson');",
          "93:     }",
          "95:     return true;",
          "96: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "mod/lesson/version.php||mod/lesson/version.php": [
          "File: mod/lesson/version.php -> mod/lesson/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: defined('MOODLE_INTERNAL') || die();",
          "28: $plugin->requires  = 2014050800;    // Requires this Moodle version",
          "29: $plugin->component = 'mod_lesson'; // Full name of the plugin (used for diagnostics)",
          "30: $plugin->cron      = 0;",
          "",
          "[Removed Lines]",
          "27: $plugin->version   = 2014091001;       // The current module version (Date: YYYYMMDDXX)",
          "",
          "[Added Lines]",
          "27: $plugin->version   = 2014100600;       // The current module version (Date: YYYYMMDDXX)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "672ce966c6109ba12c4bdc9dcf569ae09f3886e8",
      "candidate_info": {
        "commit_hash": "672ce966c6109ba12c4bdc9dcf569ae09f3886e8",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/672ce966c6109ba12c4bdc9dcf569ae09f3886e8",
        "files": [
          "mod/assign/version.php",
          "mod/assignment/version.php",
          "mod/book/version.php",
          "mod/chat/version.php",
          "mod/choice/version.php",
          "mod/data/version.php",
          "mod/feedback/version.php",
          "mod/folder/version.php",
          "mod/forum/version.php",
          "mod/glossary/version.php",
          "mod/imscp/version.php",
          "mod/label/version.php",
          "mod/lesson/version.php",
          "mod/lti/version.php",
          "mod/page/version.php",
          "mod/quiz/version.php",
          "mod/resource/version.php",
          "mod/scorm/version.php",
          "mod/survey/version.php",
          "mod/url/version.php",
          "mod/wiki/version.php",
          "mod/workshop/version.php"
        ],
        "message": "MDL-43040 Replace $module with $plugin in all mod/*/version.php\n\nConflicts:\n\tmod/quiz/version.php",
        "before_after_code_files": [
          "mod/assign/version.php||mod/assign/version.php",
          "mod/assignment/version.php||mod/assignment/version.php",
          "mod/book/version.php||mod/book/version.php",
          "mod/chat/version.php||mod/chat/version.php",
          "mod/choice/version.php||mod/choice/version.php",
          "mod/data/version.php||mod/data/version.php",
          "mod/feedback/version.php||mod/feedback/version.php",
          "mod/folder/version.php||mod/folder/version.php",
          "mod/forum/version.php||mod/forum/version.php",
          "mod/glossary/version.php||mod/glossary/version.php",
          "mod/imscp/version.php||mod/imscp/version.php",
          "mod/label/version.php||mod/label/version.php",
          "mod/lesson/version.php||mod/lesson/version.php",
          "mod/lti/version.php||mod/lti/version.php",
          "mod/page/version.php||mod/page/version.php",
          "mod/quiz/version.php||mod/quiz/version.php",
          "mod/resource/version.php||mod/resource/version.php",
          "mod/scorm/version.php||mod/scorm/version.php",
          "mod/survey/version.php||mod/survey/version.php",
          "mod/url/version.php||mod/url/version.php",
          "mod/wiki/version.php||mod/wiki/version.php",
          "mod/workshop/version.php||mod/workshop/version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "mod/lesson/version.php||mod/lesson/version.php"
          ],
          "candidate": [
            "mod/lesson/version.php||mod/lesson/version.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/assign/version.php||mod/assign/version.php": [
          "File: mod/assign/version.php -> mod/assign/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "27: $module->component = 'mod_assign'; // Full name of the plugin (used for diagnostics).",
          "28: $module->version  = 2014011500;    // The current module version (Date: YYYYMMDDXX).",
          "29: $module->requires = 2013110500;    // Requires this Moodle version.",
          "30: $module->cron     = 60;",
          "",
          "[Added Lines]",
          "27: $plugin->component = 'mod_assign'; // Full name of the plugin (used for diagnostics).",
          "28: $plugin->version  = 2014011500;    // The current module version (Date: YYYYMMDDXX).",
          "29: $plugin->requires = 2013110500;    // Requires this Moodle version.",
          "30: $plugin->cron     = 60;",
          "",
          "---------------"
        ],
        "mod/assignment/version.php||mod/assignment/version.php": [
          "File: mod/assignment/version.php -> mod/assignment/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013121900;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_assignment'; // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 60;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013121900;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_assignment'; // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 60;",
          "",
          "---------------"
        ],
        "mod/book/version.php||mod/book/version.php": [
          "File: mod/book/version.php -> mod/book/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: defined('MOODLE_INTERNAL') || die;",
          "",
          "[Removed Lines]",
          "27: $module->component = 'mod_book'; // Full name of the plugin (used for diagnostics)",
          "28: $module->version   = 2013110500; // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500; // Requires this Moodle version",
          "30: $module->cron      = 0;          // Period for cron to check this module (secs)",
          "",
          "[Added Lines]",
          "27: $plugin->component = 'mod_book'; // Full name of the plugin (used for diagnostics)",
          "28: $plugin->version   = 2013110500; // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500; // Requires this Moodle version",
          "30: $plugin->cron      = 0;          // Period for cron to check this module (secs)",
          "",
          "---------------"
        ],
        "mod/chat/version.php||mod/chat/version.php": [
          "File: mod/chat/version.php -> mod/chat/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_chat';       // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 300;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_chat';       // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 300;",
          "",
          "---------------"
        ],
        "mod/choice/version.php||mod/choice/version.php": [
          "File: mod/choice/version.php -> mod/choice/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_choice';     // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_choice';     // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/data/version.php||mod/data/version.php": [
          "File: mod/data/version.php -> mod/data/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;       // Requires this Moodle version",
          "30: $module->component = 'mod_data';       // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;       // Requires this Moodle version",
          "30: $plugin->component = 'mod_data';       // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/feedback/version.php||mod/feedback/version.php": [
          "File: mod/feedback/version.php -> mod/feedback/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "33: $feedback_version_intern = 1; //this version is used for restore older backups",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_feedback';   // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_feedback';   // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/folder/version.php||mod/folder/version.php": [
          "File: mod/folder/version.php -> mod/folder/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_folder';     // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_folder';     // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/forum/version.php||mod/forum/version.php": [
          "File: mod/forum/version.php -> mod/forum/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;       // Requires this Moodle version",
          "30: $module->component = 'mod_forum';      // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 60;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;       // Requires this Moodle version",
          "30: $plugin->component = 'mod_forum';      // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 60;",
          "",
          "---------------"
        ],
        "mod/glossary/version.php||mod/glossary/version.php": [
          "File: mod/glossary/version.php -> mod/glossary/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_glossary';   // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_glossary';   // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/imscp/version.php||mod/imscp/version.php": [
          "File: mod/imscp/version.php -> mod/imscp/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_imscp';      // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_imscp';      // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/label/version.php||mod/label/version.php": [
          "File: mod/label/version.php -> mod/label/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_label'; // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_label'; // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/lesson/version.php||mod/lesson/version.php": [
          "File: mod/lesson/version.php -> mod/lesson/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_lesson'; // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_lesson'; // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/lti/version.php||mod/lti/version.php": [
          "File: mod/lti/version.php -> mod/lti/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "50: defined('MOODLE_INTERNAL') || die;",
          "",
          "[Removed Lines]",
          "52: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "53: $module->requires  = 2013110500;    // Requires this Moodle version",
          "54: $module->component = 'mod_lti';        // Full name of the plugin (used for diagnostics)",
          "55: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "52: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "53: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "54: $plugin->component = 'mod_lti';        // Full name of the plugin (used for diagnostics)",
          "55: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/page/version.php||mod/page/version.php": [
          "File: mod/page/version.php -> mod/page/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_page';       // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_page';       // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/quiz/version.php||mod/quiz/version.php": [
          "File: mod/quiz/version.php -> mod/quiz/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2014011306; // The current module version (Date: YYYYMMDDXX).",
          "29: $module->requires  = 2013110500; // Requires this Moodle version.",
          "30: $module->component = 'mod_quiz'; // Full name of the plugin (used for diagnostics).",
          "31: $module->cron      = 60;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2014011306; // The current module version (Date: YYYYMMDDXX).",
          "29: $plugin->requires  = 2013110500; // Requires this Moodle version.",
          "30: $plugin->component = 'mod_quiz'; // Full name of the plugin (used for diagnostics).",
          "31: $plugin->cron      = 60;",
          "",
          "---------------"
        ],
        "mod/resource/version.php||mod/resource/version.php": [
          "File: mod/resource/version.php -> mod/resource/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_resource'; // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_resource'; // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/scorm/version.php||mod/scorm/version.php": [
          "File: mod/scorm/version.php -> mod/scorm/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110501;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_scorm'; // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 300;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110501;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_scorm'; // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 300;",
          "",
          "---------------"
        ],
        "mod/survey/version.php||mod/survey/version.php": [
          "File: mod/survey/version.php -> mod/survey/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_survey';     // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_survey';     // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/url/version.php||mod/url/version.php": [
          "File: mod/url/version.php -> mod/url/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "28: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $module->requires  = 2013110500;    // Requires this Moodle version",
          "30: $module->component = 'mod_url';        // Full name of the plugin (used for diagnostics)",
          "31: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "28: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "29: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "30: $plugin->component = 'mod_url';        // Full name of the plugin (used for diagnostics)",
          "31: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/wiki/version.php||mod/wiki/version.php": [
          "File: mod/wiki/version.php -> mod/wiki/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "34: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "36: $module->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "37: $module->requires  = 2013110500;    // Requires this Moodle version",
          "38: $module->component = 'mod_wiki';       // Full name of the plugin (used for diagnostics)",
          "39: $module->cron      = 0;",
          "",
          "[Added Lines]",
          "36: $plugin->version   = 2013110500;       // The current module version (Date: YYYYMMDDXX)",
          "37: $plugin->requires  = 2013110500;    // Requires this Moodle version",
          "38: $plugin->component = 'mod_wiki';       // Full name of the plugin (used for diagnostics)",
          "39: $plugin->cron      = 0;",
          "",
          "---------------"
        ],
        "mod/workshop/version.php||mod/workshop/version.php": [
          "File: mod/workshop/version.php -> mod/workshop/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: defined('MOODLE_INTERNAL') || die();",
          "",
          "[Removed Lines]",
          "27: $module->version   = 2013110500;        // the current module version (YYYYMMDDXX)",
          "28: $module->requires  = 2013110500;        // requires this Moodle version",
          "29: $module->component = 'mod_workshop';    // full name of the plugin (used for diagnostics)",
          "30: $module->cron      = 60;                // give as a chance every minute",
          "",
          "[Added Lines]",
          "27: $plugin->version   = 2013110500;        // the current module version (YYYYMMDDXX)",
          "28: $plugin->requires  = 2013110500;        // requires this Moodle version",
          "29: $plugin->component = 'mod_workshop';    // full name of the plugin (used for diagnostics)",
          "30: $plugin->cron      = 60;                // give as a chance every minute",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d0445cf70d94ba8f128941e2931c7a221ddd9bcd",
      "candidate_info": {
        "commit_hash": "d0445cf70d94ba8f128941e2931c7a221ddd9bcd",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/d0445cf70d94ba8f128941e2931c7a221ddd9bcd",
        "files": [
          "mod/lesson/backup/moodle2/backup_lesson_stepslib.php",
          "mod/lesson/backup/moodle2/restore_lesson_stepslib.php",
          "mod/lesson/db/install.xml",
          "mod/lesson/db/upgrade.php",
          "mod/lesson/lang/en/lesson.php",
          "mod/lesson/lib.php",
          "mod/lesson/mod_form.php",
          "mod/lesson/version.php",
          "mod/lesson/view.php"
        ],
        "message": "MDL-48715 mod_lesson: add a time spent custom completion rule",
        "before_after_code_files": [
          "mod/lesson/backup/moodle2/backup_lesson_stepslib.php||mod/lesson/backup/moodle2/backup_lesson_stepslib.php",
          "mod/lesson/backup/moodle2/restore_lesson_stepslib.php||mod/lesson/backup/moodle2/restore_lesson_stepslib.php",
          "mod/lesson/db/upgrade.php||mod/lesson/db/upgrade.php",
          "mod/lesson/lang/en/lesson.php||mod/lesson/lang/en/lesson.php",
          "mod/lesson/lib.php||mod/lesson/lib.php",
          "mod/lesson/mod_form.php||mod/lesson/mod_form.php",
          "mod/lesson/version.php||mod/lesson/version.php",
          "mod/lesson/view.php||mod/lesson/view.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "mod/lesson/version.php||mod/lesson/version.php"
          ],
          "candidate": [
            "mod/lesson/version.php||mod/lesson/version.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/lesson/backup/moodle2/backup_lesson_stepslib.php||mod/lesson/backup/moodle2/backup_lesson_stepslib.php": [
          "File: mod/lesson/backup/moodle2/backup_lesson_stepslib.php -> mod/lesson/backup/moodle2/backup_lesson_stepslib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:             'mediafile', 'mediaheight', 'mediawidth', 'mediaclose', 'slideshow',",
          "77:             'width', 'height', 'bgcolor', 'displayleft', 'displayleftif', 'progressbar',",
          "78:             'showhighscores', 'maxhighscores', 'available', 'deadline', 'timemodified',",
          "80:         ));",
          "",
          "[Removed Lines]",
          "79:             'completionendreached'",
          "",
          "[Added Lines]",
          "79:             'completionendreached', 'completiontimespend', 'timetospend'",
          "",
          "---------------"
        ],
        "mod/lesson/backup/moodle2/restore_lesson_stepslib.php||mod/lesson/backup/moodle2/restore_lesson_stepslib.php": [
          "File: mod/lesson/backup/moodle2/restore_lesson_stepslib.php -> mod/lesson/backup/moodle2/restore_lesson_stepslib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "72:             unset($data->showhighscores);",
          "73:         }",
          "76:         if (!isset($data->completionendreached)) {",
          "77:             $data->completionendreached = 0;",
          "78:         }",
          "81:         if (!isset($data->timelimit)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "79:         if (!isset($data->completiontimespend)) {",
          "80:             $data->completiontimespend = 0;",
          "81:             $data->timetospend = 0;",
          "82:         }",
          "",
          "---------------"
        ],
        "mod/lesson/db/upgrade.php||mod/lesson/db/upgrade.php": [
          "File: mod/lesson/db/upgrade.php -> mod/lesson/db/upgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "217:         upgrade_mod_savepoint(true, 2015030401, 'lesson');",
          "218:     }",
          "220:     return true;",
          "221: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "220:     if ($oldversion < 2015031500) {",
          "223:         $table = new xmldb_table('lesson');",
          "224:         $field = new xmldb_field('completiontimespend', XMLDB_TYPE_INTEGER, '1', null, null, null, '0', 'completionendreached');",
          "227:         if (!$dbman->field_exists($table, $field)) {",
          "228:             $dbman->add_field($table, $field);",
          "229:         }",
          "232:         $field = new xmldb_field('timetospend', XMLDB_TYPE_INTEGER, '11', null, null, null, '0', 'completiontimespend');",
          "235:         if (!$dbman->field_exists($table, $field)) {",
          "236:             $dbman->add_field($table, $field);",
          "237:         }",
          "239:         upgrade_mod_savepoint(true, 2015031500, 'lesson');",
          "240:     }",
          "",
          "---------------"
        ],
        "mod/lesson/lang/en/lesson.php||mod/lesson/lang/en/lesson.php": [
          "File: mod/lesson/lang/en/lesson.php -> mod/lesson/lang/en/lesson.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "97: $string['completethefollowingconditions'] = 'You must complete the following condition(s) in <b>{$a}</b> lesson before you can proceed.';",
          "98: $string['completionendreached'] = 'Require end reached';",
          "99: $string['completionendreached_desc'] = 'Student must reach the end of lesson page to complete this activity';",
          "100: $string['conditionsfordependency'] = 'Condition(s) for the dependency';",
          "101: $string['configactionaftercorrectanswer'] = 'The default action to take after a correct answer';",
          "102: $string['configmaxanswers'] = 'Default maximum number of answers per page';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "100: $string['completiontimespend'] = 'Student must do this activity for';",
          "101: $string['completiontimespendgroup'] = 'Require time spent';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "322: $string['notcompleted'] = 'Not completed';",
          "323: $string['notdefined'] = 'Not defined';",
          "324: $string['notenoughsubquestions'] = 'Not enough sub-questions have been defined!';",
          "325: $string['nothighscore'] = 'You did not make the top {$a} high scores list.';",
          "326: $string['notitle'] = 'No title';",
          "327: $string['numberofcorrectanswers'] = 'Number of correct answers: {$a}';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "327: $string['notenoughtimespent'] = 'You completed this lesson in {$a->timespent}, which is less than the required time of {$a->timerequired}. You might need to attempt the lesson again.';",
          "",
          "---------------"
        ],
        "mod/lesson/lib.php||mod/lesson/lib.php": [
          "File: mod/lesson/lib.php -> mod/lesson/lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "779:     $lesson = $DB->get_record('lesson', array('id' => $cm->instance), '*',",
          "780:             MUST_EXIST);",
          "783:     if ($lesson->completionendreached) {",
          "785:                 'lessonid' => $lesson->id, 'userid' => $userid, 'completed' => 1));",
          "789:     }",
          "790: }",
          "",
          "[Removed Lines]",
          "784:         return $DB->record_exists('lesson_timer', array(",
          "786:     } else {",
          "788:         return $type;",
          "",
          "[Added Lines]",
          "782:     $result = $type; // Default return value.",
          "785:         $value = $DB->record_exists('lesson_timer', array(",
          "787:         if ($type == COMPLETION_AND) {",
          "788:             $result = $result && $value;",
          "789:         } else {",
          "790:             $result = $result || $value;",
          "791:         }",
          "792:     }",
          "793:     if ($lesson->completiontimespend) {",
          "794:         $duration = $DB->get_field_sql(",
          "795:                         \"SELECT SUM(lessontime - starttime)",
          "796:                                FROM {lesson_timer}",
          "797:                               WHERE lessonid = :lessonid",
          "798:                                 AND userid = :userid\",",
          "799:                         array('userid' => $userid, 'lessonid' => $lesson->id));",
          "800:         if (!$duration) {",
          "801:             $duration = 0;",
          "802:         }",
          "803:         if ($type == COMPLETION_AND) {",
          "804:             $result = $result && ($lesson->timetospend < $duration);",
          "805:         } else {",
          "806:             $result = $result || ($lesson->timetospend < $duration);",
          "807:         }",
          "809:     return $result;",
          "",
          "---------------"
        ],
        "mod/lesson/mod_form.php||mod/lesson/mod_form.php": [
          "File: mod/lesson/mod_form.php -> mod/lesson/mod_form.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:         $mform->addElement('checkbox', 'completionendreached', get_string('completionendreached', 'lesson'),",
          "341:                 get_string('completionendreached_desc', 'lesson'));",
          "343:     }",
          "",
          "[Removed Lines]",
          "342:         return array('completionendreached');",
          "",
          "[Added Lines]",
          "343:         $group = array();",
          "344:         $group[] =& $mform->createElement('checkbox', 'completiontimespend', '', get_string('completiontimespend', 'lesson'));",
          "345:         $group[] =& $mform->createElement('duration', 'timetospend', array('optional' => true));",
          "346:         $mform->addGroup($group, 'completiontimespendgroup', get_string('completiontimespendgroup', 'lesson'), array(' '), false);",
          "347:         $mform->disabledIf('timetospend[number]', 'completiontimespend', 'notchecked');",
          "348:         $mform->disabledIf('timetospend[timeunit]', 'completiontimespend', 'notchecked');",
          "349:         return array('completionendreached', 'completiontimespendgroup');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "351:     public function completion_rule_enabled($data) {",
          "353:     }",
          "354: }",
          "",
          "[Removed Lines]",
          "352:         return !empty($data['completionendreached']);",
          "",
          "[Added Lines]",
          "359:         return !empty($data['completionendreached']) ||",
          "360:                 (!empty($data['completiontimespend']) && $data['timetospend'] != 0);",
          "",
          "---------------"
        ],
        "mod/lesson/version.php||mod/lesson/version.php": [
          "File: mod/lesson/version.php -> mod/lesson/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: defined('MOODLE_INTERNAL') || die();",
          "28: $plugin->requires  = 2014110400;    // Requires this Moodle version",
          "29: $plugin->component = 'mod_lesson'; // Full name of the plugin (used for diagnostics)",
          "30: $plugin->cron      = 0;",
          "",
          "[Removed Lines]",
          "27: $plugin->version   = 2015030401;       // The current module version (Date: YYYYMMDDXX)",
          "",
          "[Added Lines]",
          "27: $plugin->version   = 2015031500;       // The current module version (Date: YYYYMMDDXX)",
          "",
          "---------------"
        ],
        "mod/lesson/view.php||mod/lesson/view.php": [
          "File: mod/lesson/view.php -> mod/lesson/view.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "460:         $completion = new completion_info($course);",
          "462:             $completion->update_state($cm, COMPLETION_COMPLETE);",
          "463:         }",
          "465:         if ($gradeinfo->attempts) {",
          "466:             if (!$lesson->custom) {",
          "467:                 $lessoncontent .= $lessonoutput->paragraph(get_string(\"numberofpagesviewed\", \"lesson\", $gradeinfo->nquestions), 'center');",
          "",
          "[Removed Lines]",
          "461:         if ($completion->is_enabled($cm) && $lesson->completionendreached) {",
          "",
          "[Added Lines]",
          "461:         if ($completion->is_enabled($cm) && ($lesson->completionendreached || $lesson->completiontimespend)) {",
          "465:         if ($lesson->completiontimespend) {",
          "466:             $duration = $DB->get_field_sql(",
          "467:                             \"SELECT SUM(lessontime - starttime)",
          "468:                                FROM {lesson_timer}",
          "469:                               WHERE lessonid = :lessonid",
          "470:                                 AND userid = :userid\",",
          "471:                             array('userid' => $USER->id, 'lessonid' => $lesson->id));",
          "472:             if (!$duration) {",
          "473:                 $duration = 0;",
          "474:             }",
          "477:             if ($duration < $lesson->timetospend) {",
          "478:                 $a = new stdClass;",
          "479:                 $a->timespent = format_time($duration);",
          "480:                 $a->timerequired = format_time($lesson->timetospend);",
          "481:                 $lessoncontent .= $lessonoutput->paragraph(get_string(\"notenoughtimespent\", \"lesson\", $a), 'center');",
          "482:             }",
          "483:         }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d83891729a252980b692fad40fc7fb92a47adaa4",
      "candidate_info": {
        "commit_hash": "d83891729a252980b692fad40fc7fb92a47adaa4",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/d83891729a252980b692fad40fc7fb92a47adaa4",
        "files": [
          "mod/lesson/db/install.xml",
          "mod/lesson/db/upgrade.php",
          "mod/lesson/lib.php",
          "mod/lesson/mod_form.php",
          "mod/lesson/settings.php",
          "mod/lesson/version.php"
        ],
        "message": "MDL-38106 mod_lesson: Add introduction field",
        "before_after_code_files": [
          "mod/lesson/db/upgrade.php||mod/lesson/dupgrade.php",
          "mod/lesson/lib.php||mod/lesson/lib.php",
          "mod/lesson/mod_form.php||mod/lesson/mod_form.php",
          "mod/lesson/settings.php||mod/lesson/settings.php",
          "mod/lesson/version.php||mod/lesson/version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "mod/lesson/version.php||mod/lesson/version.php"
          ],
          "candidate": [
            "mod/lesson/version.php||mod/lesson/version.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/lesson/db/upgrade.php||mod/lesson/dupgrade.php": [
          "File: mod/lesson/db/upgrade.php -> mod/lesson/dupgrade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "81:     return true;",
          "82: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "mod/lesson/lib.php||mod/lesson/lib.php": [
          "File: mod/lesson/lib.php -> mod/lesson/lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "739: function lesson_supports($feature) {",
          "740:     switch($feature) {",
          "749:     }",
          "750: }",
          "",
          "[Removed Lines]",
          "741:         case FEATURE_GROUPS:                  return false;",
          "742:         case FEATURE_GROUPINGS:               return false;",
          "743:         case FEATURE_MOD_INTRO:               return false;",
          "744:         case FEATURE_COMPLETION_TRACKS_VIEWS: return true;",
          "745:         case FEATURE_GRADE_HAS_GRADE:         return true;",
          "746:         case FEATURE_GRADE_OUTCOMES:          return true;",
          "747:         case FEATURE_BACKUP_MOODLE2:          return true;",
          "748:         default: return null;",
          "",
          "[Added Lines]",
          "741:         case FEATURE_GROUPS:",
          "742:             return false;",
          "743:         case FEATURE_GROUPINGS:",
          "744:             return false;",
          "745:         case FEATURE_GROUPMEMBERSONLY:",
          "746:             return true;",
          "747:         case FEATURE_MOD_INTRO:",
          "748:             return true;",
          "749:         case FEATURE_COMPLETION_TRACKS_VIEWS:",
          "750:             return true;",
          "751:         case FEATURE_GRADE_HAS_GRADE:",
          "752:             return true;",
          "753:         case FEATURE_GRADE_OUTCOMES:",
          "754:             return true;",
          "755:         case FEATURE_BACKUP_MOODLE2:",
          "756:             return true;",
          "757:         case FEATURE_SHOW_DESCRIPTION:",
          "758:             return true;",
          "759:         default:",
          "760:             return null;",
          "",
          "---------------"
        ],
        "mod/lesson/mod_form.php||mod/lesson/mod_form.php": [
          "File: mod/lesson/mod_form.php -> mod/lesson/mod_form.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "44:         $mform    = $this->_form;",
          "47:         $mform->addElement('header', 'general', get_string('general', 'form'));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "46:         $config = get_config('lesson');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "89:         }",
          "90:         $mform->addRule('name', null, 'required', null, 'client');",
          "91:         $mform->addRule('name', get_string('maximumchars', '', 255), 'maxlength', 255, 'client');",
          "94:         $mform->addElement('header', 'appearancehdr', get_string('appearance'));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "93:         $this->add_intro_editor($config->requiremodintro);",
          "",
          "---------------"
        ],
        "mod/lesson/settings.php||mod/lesson/settings.php": [
          "File: mod/lesson/settings.php -> mod/lesson/settings.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "66:     $defaultnextpages[LESSON_UNANSWEREDPAGE] = get_string(\"showanunansweredpage\", \"lesson\");",
          "67:     $settings->add(new admin_setting_configselect('lesson_defaultnextpage', get_string('actionaftercorrectanswer','lesson'),",
          "68:             get_string('configactionaftercorrectanswer', 'lesson'), 0, $defaultnextpages));",
          "",
          "[Removed Lines]",
          "69: }",
          "",
          "[Added Lines]",
          "70:         get_string('requiremodintro', 'admin'), get_string('configrequiremodintro', 'admin'), 1));",
          "71: }",
          "",
          "---------------"
        ],
        "mod/lesson/version.php||mod/lesson/version.php": [
          "File: mod/lesson/version.php -> mod/lesson/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: defined('MOODLE_INTERNAL') || die();",
          "28: $plugin->requires  = 2014050800;    // Requires this Moodle version",
          "29: $plugin->component = 'mod_lesson'; // Full name of the plugin (used for diagnostics)",
          "30: $plugin->cron      = 0;",
          "",
          "[Removed Lines]",
          "27: $plugin->version   = 2014051200;       // The current module version (Date: YYYYMMDDXX)",
          "",
          "[Added Lines]",
          "27: $plugin->version   = 2014091001;       // The current module version (Date: YYYYMMDDXX)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c80603ddc4ba4e7d85ea2b79f644a4a041cee137",
      "candidate_info": {
        "commit_hash": "c80603ddc4ba4e7d85ea2b79f644a4a041cee137",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/c80603ddc4ba4e7d85ea2b79f644a4a041cee137",
        "files": [
          "mod/lesson/db/access.php",
          "mod/lesson/version.php"
        ],
        "message": "MDL-48034 mod_lesson: grade capability missing RISK_XSS",
        "before_after_code_files": [
          "mod/lesson/db/access.php||mod/lesson/db/access.php",
          "mod/lesson/version.php||mod/lesson/version.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "mod/lesson/db/access.php||mod/lesson/db/access.php",
            "mod/lesson/version.php||mod/lesson/version.php"
          ],
          "candidate": [
            "mod/lesson/db/access.php||mod/lesson/db/access.php",
            "mod/lesson/version.php||mod/lesson/version.php"
          ]
        }
      },
      "candidate_diff": {
        "mod/lesson/db/access.php||mod/lesson/db/access.php": [
          "File: mod/lesson/db/access.php -> mod/lesson/db/access.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "56:     'mod/lesson:grade' => array(",
          "58:         'captype' => 'write',",
          "59:         'contextlevel' => CONTEXT_MODULE,",
          "60:         'archetypes' => array(",
          "",
          "[Removed Lines]",
          "57:         'riskbitmask' => RISK_SPAM,",
          "",
          "[Added Lines]",
          "57:         'riskbitmask' => RISK_SPAM | RISK_XSS,",
          "",
          "---------------"
        ],
        "mod/lesson/version.php||mod/lesson/version.php": [
          "File: mod/lesson/version.php -> mod/lesson/version.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: defined('MOODLE_INTERNAL') || die();",
          "28: $plugin->requires  = 2014110400;    // Requires this Moodle version",
          "29: $plugin->component = 'mod_lesson'; // Full name of the plugin (used for diagnostics)",
          "30: $plugin->cron      = 0;",
          "",
          "[Removed Lines]",
          "27: $plugin->version   = 2014111001;       // The current module version (Date: YYYYMMDDXX)",
          "",
          "[Added Lines]",
          "27: $plugin->version   = 2014111002;       // The current module version (Date: YYYYMMDDXX)",
          "",
          "---------------"
        ]
      }
    }
  ]
}