{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "5ec056633f4ce1a19058dbb55a24e9d0dff3c183",
      "candidate_info": {
        "commit_hash": "5ec056633f4ce1a19058dbb55a24e9d0dff3c183",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/5ec056633f4ce1a19058dbb55a24e9d0dff3c183",
        "files": [
          "src/node.js",
          "test/simple/test-stdin-pipe-resume.js"
        ],
        "message": "Fix #3503: stdin: resume() on pipe(dest)",
        "before_after_code_files": [
          "src/node.js||src/node.js",
          "test/simple/test-stdin-pipe-resume.js||test/simple/test-stdin-pipe-resume.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node.js||src/node.js": [
          "File: src/node.js -> src/node.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "401:       stdin.pause();",
          "403:       return stdin;",
          "404:     });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "405:       var pipe = stdin.pipe;",
          "406:       stdin.pipe = function(dest) {",
          "407:         stdin.resume();",
          "408:         return pipe.call(stdin, dest);",
          "409:       };",
          "",
          "---------------"
        ],
        "test/simple/test-stdin-pipe-resume.js||test/simple/test-stdin-pipe-resume.js": [
          "File: test/simple/test-stdin-pipe-resume.js -> test/simple/test-stdin-pipe-resume.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "23: var common = require('../common');",
          "24: var assert = require('assert');",
          "26: if (process.argv[2] === 'child') {",
          "27:   process.stdin.pipe(process.stdout);",
          "28: } else {",
          "29:   var spawn = require('child_process').spawn;",
          "30:   var buffers = [];",
          "31:   var child = spawn(process.execPath, [__filename, 'child']);",
          "32:   child.stdout.on('data', function(c) {",
          "33:     buffers.push(c);",
          "34:   });",
          "35:   child.stdout.on('close', function() {",
          "36:     var b = Buffer.concat(buffers).toString();",
          "37:     assert.equal(b, 'Hello, world\\n');",
          "38:     console.log('ok');",
          "39:   });",
          "40:   child.stdin.write('Hel');",
          "41:   child.stdin.write('lo,');",
          "42:   child.stdin.write(' wo');",
          "43:   setTimeout(function() {",
          "44:     child.stdin.write('rld\\n');",
          "45:     child.stdin.end();",
          "46:   }, 10);",
          "47: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "82ad1f87fa99b420a97cc9bfae727fce0b1bf8a4",
      "candidate_info": {
        "commit_hash": "82ad1f87fa99b420a97cc9bfae727fce0b1bf8a4",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/82ad1f87fa99b420a97cc9bfae727fce0b1bf8a4",
        "files": [
          "common.gypi",
          "configure"
        ],
        "message": "Fix #2830 for the old gcc bug on SmartOS",
        "before_after_code_files": [
          "common.gypi||common.gypi"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "common.gypi||common.gypi": [
          "File: common.gypi -> common.gypi",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:       'Release': {",
          "37:         'conditions': [",
          "38:           [ 'OS!=\"solaris\"', {",
          "40:           }],",
          "45:           ['target_arch==\"x64\"', {",
          "46:             'msvs_configuration_platform': 'x64',",
          "47:           }],",
          "",
          "[Removed Lines]",
          "39:             'cflags': [ '-fomit-frame-pointer' ]",
          "41:         ],",
          "42:         # 'defines': [ 'NDEBUG' ],",
          "43:         'cflags': [ '-O3', '-fdata-sections', '-ffunction-sections' ],",
          "44:         'conditions': [",
          "",
          "[Added Lines]",
          "39:               'cflags': [ '-O3','-fomit-frame-pointer', '-fdata-sections', '-ffunction-sections' ],",
          "40:           }],",
          "41:           [ 'OS==\"solaris\" and gcc_optimize_level ==\"-O3\"', {",
          "42:               'cflags': [ '-O3', '-fdata-sections', '-ffunction-sections' ],",
          "43:           }],",
          "44:           [ 'OS==\"solaris\" and gcc_optimize_level ==\"-O\"', {",
          "45:               'cflags': [ '-O', '-fdata-sections', '-ffunction-sections' ], # For bug fix of #2830",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "dff467d9825a174130bf9379e09b9421d70e3f0d",
      "candidate_info": {
        "commit_hash": "dff467d9825a174130bf9379e09b9421d70e3f0d",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/dff467d9825a174130bf9379e09b9421d70e3f0d",
        "files": [
          "deps/uv/config-mingw.mk",
          "deps/uv/config-unix.mk",
          "deps/uv/include/uv-private/uv-unix.h",
          "deps/uv/include/uv-private/uv-win.h",
          "deps/uv/include/uv.h",
          "deps/uv/src/unix/cares.c",
          "deps/uv/src/unix/internal.h",
          "deps/uv/src/unix/loop.c",
          "deps/uv/src/uv-common.c",
          "deps/uv/src/uv-common.h",
          "deps/uv/src/win/cares.c",
          "deps/uv/src/win/core.c",
          "deps/uv/src/win/fs.c",
          "deps/uv/src/win/internal.h",
          "deps/uv/src/win/req.c",
          "deps/uv/test/benchmark-ares.c",
          "deps/uv/test/test-list.h",
          "deps/uv/uv.gyp"
        ],
        "message": "update uv to 2df831723fad25d2d97b824b2e52c65082af2723",
        "before_after_code_files": [
          "deps/uv/config-mingw.mk||deps/uv/config-mingw.mk",
          "deps/uv/config-unix.mk||deps/uv/config-unix.mk",
          "deps/uv/include/uv-private/uv-unix.h||deps/uv/include/uv-private/uv-unix.h",
          "deps/uv/include/uv-private/uv-win.h||deps/uv/include/uv-private/uv-win.h",
          "deps/uv/include/uv.h||deps/uv/include/uv.h",
          "deps/uv/src/unix/cares.c||deps/uv/src/unix/cares.c",
          "deps/uv/src/unix/internal.h||deps/uv/src/unix/internal.h",
          "deps/uv/src/unix/loop.c||deps/uv/src/unix/loop.c",
          "deps/uv/src/uv-common.c||deps/uv/src/uv-common.c",
          "deps/uv/src/uv-common.h||deps/uv/src/uv-common.h",
          "deps/uv/src/win/cares.c||deps/uv/src/win/cares.c",
          "deps/uv/src/win/core.c||deps/uv/src/win/core.c",
          "deps/uv/src/win/fs.c||deps/uv/src/win/fs.c",
          "deps/uv/src/win/internal.h||deps/uv/src/win/internal.h",
          "deps/uv/src/win/req.c||deps/uv/src/win/req.c",
          "deps/uv/test/benchmark-ares.c||deps/uv/test/benchmark-ares.c",
          "deps/uv/test/test-list.h||deps/uv/test/test-list.h",
          "deps/uv/uv.gyp||deps/uv/uv.gyp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/uv/config-mingw.mk||deps/uv/config-mingw.mk": [
          "File: deps/uv/config-mingw.mk -> deps/uv/config-mingw.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "37: RUNNER_LIBS=-lws2_32 -lpsapi -liphlpapi",
          "38: RUNNER_SRC=test/runner-win.c",
          "49: EIO_CPPFLAGS += $(CPPFLAGS)",
          "50: EIO_CPPFLAGS += -DEIO_STACKSIZE=65536",
          "",
          "[Removed Lines]",
          "40: uv.a: $(WIN_OBJS) src/uv-common.o $(CARES_OBJS)",
          "41:  $(AR) rcs uv.a src/win/*.o src/uv-common.o $(CARES_OBJS)",
          "43: src/win/%.o: src/win/%.c src/win/internal.h",
          "44:  $(CC) $(CFLAGS) -o $@ -c $<",
          "46: src/uv-common.o: src/uv-common.c include/uv.h include/uv-private/uv-win.h",
          "47:  $(CC) $(CFLAGS) -c src/uv-common.c -o src/uv-common.o",
          "",
          "[Added Lines]",
          "40: uv.a: $(WIN_OBJS) src/cares.o src/uv-common.o $(CARES_OBJS)",
          "41:  $(AR) rcs uv.a $(WIN_OBJS) src/cares.o src/uv-common.o $(CARES_OBJS)",
          "43: src/%.o: src/%.c include/uv.h include/uv-private/uv-win.h",
          "44:  $(CC) $(CFLAGS) -c $< -o $@",
          "46: src/win/%.o: src/win/%.c include/uv.h include/uv-private/uv-win.h src/win/internal.h",
          "47:  $(CC) $(CFLAGS) -o $@ -c $<",
          "",
          "---------------"
        ],
        "deps/uv/config-unix.mk||deps/uv/config-unix.mk": [
          "File: deps/uv/config-unix.mk -> deps/uv/config-unix.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "21: E=",
          "22: CSTDFLAG=--std=c89 -pedantic -Wall -Wextra -Wno-unused-parameter",
          "23: CFLAGS += -g",
          "25: LINKFLAGS=-lm",
          "27: CPPFLAGS += -D_LARGEFILE_SOURCE",
          "28: CPPFLAGS += -D_FILE_OFFSET_BITS=64",
          "30: OBJS += src/unix/async.o",
          "32: OBJS += src/unix/core.o",
          "33: OBJS += src/unix/dl.o",
          "34: OBJS += src/unix/error.o",
          "",
          "[Removed Lines]",
          "24: CPPFLAGS += -Isrc/unix/ev",
          "31: OBJS += src/unix/cares.o",
          "",
          "[Added Lines]",
          "24: CPPFLAGS += -Isrc -Isrc/unix/ev",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "129: RUNNER_LIBS=",
          "130: RUNNER_SRC=test/runner-unix.c",
          "141: src/unix/ev/ev.o: src/unix/ev/ev.c",
          "142:  $(CC) $(CPPFLAGS) $(CFLAGS) -c src/unix/ev/ev.c -o src/unix/ev/ev.o -DEV_CONFIG_H=\\\"$(EV_CONFIG)\\\"",
          "",
          "[Removed Lines]",
          "132: uv.a: $(OBJS) src/uv-common.o src/unix/ev/ev.o src/unix/uv-eio.o src/unix/eio/eio.o $(CARES_OBJS)",
          "133:  $(AR) rcs uv.a $(OBJS) src/uv-common.o src/unix/uv-eio.o src/unix/ev/ev.o src/unix/eio/eio.o $(CARES_OBJS)",
          "135: src/unix/%.o: src/unix/%.c include/uv.h include/uv-private/uv-unix.h src/unix/internal.h",
          "136:  $(CC) $(CSTDFLAG) $(CPPFLAGS) -Isrc  $(CFLAGS) -c $< -o $@",
          "138: src/uv-common.o: src/uv-common.c include/uv.h include/uv-private/uv-unix.h",
          "139:  $(CC) $(CSTDFLAG) $(CPPFLAGS) $(CFLAGS) -c src/uv-common.c -o src/uv-common.o",
          "",
          "[Added Lines]",
          "131: uv.a: $(OBJS) src/cares.o src/uv-common.o src/unix/ev/ev.o src/unix/uv-eio.o src/unix/eio/eio.o $(CARES_OBJS)",
          "132:  $(AR) rcs uv.a $(OBJS) src/cares.o src/uv-common.o src/unix/uv-eio.o src/unix/ev/ev.o src/unix/eio/eio.o $(CARES_OBJS)",
          "134: src/%.o: src/%.c include/uv.h include/uv-private/uv-unix.h",
          "135:  $(CC) $(CSTDFLAG) $(CPPFLAGS) $(CFLAGS) -c $< -o $@",
          "137: src/unix/%.o: src/unix/%.c include/uv.h include/uv-private/uv-unix.h src/unix/internal.h",
          "138:  $(CC) $(CSTDFLAG) $(CPPFLAGS) $(CFLAGS) -c $< -o $@",
          "",
          "---------------"
        ],
        "deps/uv/include/uv-private/uv-unix.h||deps/uv/include/uv-private/uv-unix.h": [
          "File: deps/uv/include/uv-private/uv-unix.h -> deps/uv/include/uv-private/uv-unix.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "90: #endif",
          "92: #define UV_LOOP_PRIVATE_FIELDS \\",
          "101:   eio_channel uv_eio_channel; \\",
          "102:   struct ev_loop* ev; \\",
          "",
          "[Removed Lines]",
          "93:   ares_channel channel; \\",
          "99:   uv_timer_t timer; \\",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/include/uv-private/uv-win.h||deps/uv/include/uv-private/uv-win.h": [
          "File: deps/uv/include/uv-private/uv-win.h -> deps/uv/include/uv-private/uv-win.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "231:   uv_idle_t* next_idle_handle;                                                \\",
          "233:   SOCKET poll_peer_sockets[UV_MSAFD_PROVIDER_COUNT];                          \\",
          "239:   unsigned int active_tcp_streams;                                            \\",
          "241:   unsigned int active_udp_streams;",
          "246: #define UV_REQ_TYPE_PRIVATE               \\",
          "248:   UV_ACCEPT,                              \\",
          "251:   UV_FS_EVENT_REQ,                        \\",
          "252:   UV_POLL_REQ,                            \\",
          "253:   UV_PROCESS_EXIT,                        \\",
          "",
          "[Removed Lines]",
          "235:   ares_channel ares_chan;                                                     \\",
          "236:   int ares_active_sockets;                                                    \\",
          "237:   uv_timer_t ares_polling_timer;                                              \\",
          "243: #define UV_HANDLE_TYPE_PRIVATE            \\",
          "244:   UV_ARES_EVENT,",
          "249:   UV_ARES_EVENT_REQ,                      \\",
          "250:   UV_ARES_CLEANUP_REQ,                    \\",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/include/uv.h||deps/uv/include/uv.h": [
          "File: deps/uv/include/uv.h -> deps/uv/include/uv.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "137: #undef UV_ERRNO_GEN",
          "139: #define UV_HANDLE_TYPE_MAP(XX)  \\",
          "141:   XX(ASYNC, async)              \\",
          "142:   XX(CHECK, check)              \\",
          "143:   XX(FS_EVENT, fs_event)        \\",
          "",
          "[Removed Lines]",
          "140:   XX(ARES_TASK, ares_task)      \\",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "165: #define XX(uc, lc) UV_##uc,",
          "166:   UV_HANDLE_TYPE_MAP(XX)",
          "167: #undef XX",
          "168:   UV_FILE,",
          "170:   UV_HANDLE_TYPE_MAX",
          "171: } uv_handle_type;",
          "",
          "[Removed Lines]",
          "169:   UV_HANDLE_TYPE_PRIVATE",
          "",
          "[Added Lines]",
          "167:   UV_ARES_TASK,",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1646: struct uv_loop_s {",
          "1647:   UV_LOOP_PRIVATE_FIELDS",
          "1651:   uv_counters_t counters;",
          "",
          "[Removed Lines]",
          "1649:   struct uv__ares_tasks { uv_ares_task_t* rbh_root; } uv_ares_handles_;",
          "",
          "[Added Lines]",
          "1647:   ares_channel channel;",
          "1651:   uv_timer_t ares_timer; \\",
          "1653:   struct uv__ares_tasks { uv_ares_task_t* rbh_root; } ares_handles;",
          "",
          "---------------"
        ],
        "deps/uv/src/unix/cares.c||deps/uv/src/unix/cares.c": [
          "File: deps/uv/src/unix/cares.c -> deps/uv/src/unix/cares.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/src/unix/internal.h||deps/uv/src/unix/internal.h": [
          "File: deps/uv/src/unix/internal.h -> deps/uv/src/unix/internal.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "64: # define HAVE_KQUEUE 1",
          "65: #endif",
          "70: #define UNREACHABLE()                                                         \\",
          "71:   do {                                                                        \\",
          "72:     assert(0 && \"unreachable code\");                                          \\",
          "",
          "[Removed Lines]",
          "67: #define container_of(ptr, type, member) \\",
          "68:   ((type *) ((char *) (ptr) - offsetof(type, member)))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/src/unix/loop.c||deps/uv/src/unix/loop.c": [
          "File: deps/uv/src/unix/loop.c -> deps/uv/src/unix/loop.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "41:   ngx_queue_init(&loop->active_reqs);",
          "42: #endif",
          "45:   ngx_queue_init(&loop->idle_handles);",
          "46:   ngx_queue_init(&loop->check_handles);",
          "47:   ngx_queue_init(&loop->prepare_handles);",
          "",
          "[Removed Lines]",
          "44:   RB_INIT(&loop->uv_ares_handles_);",
          "",
          "[Added Lines]",
          "44:   RB_INIT(&loop->ares_handles);",
          "",
          "---------------"
        ],
        "deps/uv/src/uv-common.c||deps/uv/src/uv-common.c": [
          "File: deps/uv/src/uv-common.c -> deps/uv/src/uv-common.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "199: }",
          "239: int uv_tcp_bind(uv_tcp_t* handle, struct sockaddr_in addr) {",
          "240:   if (handle->type != UV_TCP || addr.sin_family != AF_INET) {",
          "241:     uv__set_artificial_error(handle->loop, UV_EFAULT);",
          "",
          "[Removed Lines]",
          "202: static int cmp_ares_tasks(const uv_ares_task_t* a, const uv_ares_task_t* b) {",
          "203:   if (a->sock < b->sock) return -1;",
          "204:   if (a->sock > b->sock) return 1;",
          "205:   return 0;",
          "206: }",
          "209: RB_GENERATE_STATIC(uv__ares_tasks, uv_ares_task_s, node, cmp_ares_tasks)",
          "213: void uv_add_ares_handle(uv_loop_t* loop, uv_ares_task_t* handle) {",
          "214:   assert(loop == handle->loop);",
          "215:   RB_INSERT(uv__ares_tasks, &loop->uv_ares_handles_, handle);",
          "216: }",
          "220: uv_ares_task_t* uv_find_ares_handle(uv_loop_t* loop, ares_socket_t sock) {",
          "221:   uv_ares_task_t handle;",
          "222:   handle.sock = sock;",
          "223:   return RB_FIND(uv__ares_tasks, &loop->uv_ares_handles_, &handle);",
          "224: }",
          "228: void uv_remove_ares_handle(uv_ares_task_t* handle) {",
          "229:   RB_REMOVE(uv__ares_tasks, &handle->loop->uv_ares_handles_, handle);",
          "230: }",
          "234: int uv_ares_handles_empty(uv_loop_t* loop) {",
          "235:   return RB_EMPTY(&loop->uv_ares_handles_);",
          "236: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/src/uv-common.h||deps/uv/src/uv-common.h": [
          "File: deps/uv/src/uv-common.h -> deps/uv/src/uv-common.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "28: #define UV_COMMON_H_",
          "30: #include <assert.h>",
          "32: #include \"uv.h\"",
          "33: #include \"tree.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "31: #include <stddef.h>",
          "32: #include <stdint.h>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "36: #define ARRAY_SIZE(a) (sizeof(a) / sizeof((a)[0]))",
          "38: #ifdef _MSC_VER",
          "40: #else",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "40: #define container_of(ptr, type, member) \\",
          "41:   ((type *) ((char *) (ptr) - offsetof(type, member)))",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "52: # define UV__ACTIVE  0x00000040",
          "53: #endif",
          "80: extern const uv_err_t uv_ok_;",
          "82: uv_err_code uv_translate_sys_error(int sys_errno);",
          "",
          "[Removed Lines]",
          "55: struct uv_ares_task_s {",
          "56:   UV_HANDLE_FIELDS",
          "57: #if _WIN32",
          "58:   struct uv_req_s ares_req;",
          "59:   SOCKET sock;",
          "60:   HANDLE h_wait;",
          "61:   WSAEVENT h_event;",
          "62:   HANDLE h_close_event;",
          "63: #else",
          "64:   int sock;",
          "65:   ev_io read_watcher;",
          "66:   ev_io write_watcher;",
          "67: #endif",
          "68:   RB_ENTRY(uv_ares_task_s) node;",
          "69: };",
          "72: void uv_remove_ares_handle(uv_ares_task_t* handle);",
          "73: uv_ares_task_t* uv_find_ares_handle(uv_loop_t*, ares_socket_t sock);",
          "76: void uv_add_ares_handle(uv_loop_t* loop, uv_ares_task_t* handle);",
          "78: int uv_ares_handles_empty(uv_loop_t* loop);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/src/win/cares.c||deps/uv/src/win/cares.c": [
          "File: deps/uv/src/win/cares.c -> deps/uv/src/win/cares.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/src/win/core.c||deps/uv/src/win/core.c": [
          "File: deps/uv/src/win/core.c -> deps/uv/src/win/core.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "79:   loop->endgame_handles = NULL;",
          "81:   RB_INIT(&loop->timers);",
          "84:   loop->check_handles = NULL;",
          "85:   loop->prepare_handles = NULL;",
          "",
          "[Removed Lines]",
          "82:   RB_INIT(&loop->uv_ares_handles_);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "92:   memset(&loop->poll_peer_sockets, 0, sizeof loop->poll_peer_sockets);",
          "97:   loop->active_tcp_streams = 0;",
          "98:   loop->active_udp_streams = 0;",
          "",
          "[Removed Lines]",
          "94:   loop->ares_active_sockets = 0;",
          "95:   loop->ares_chan = NULL;",
          "",
          "[Added Lines]",
          "93:   loop->channel = NULL;",
          "94:   RB_INIT(&loop->ares_handles);",
          "",
          "---------------"
        ],
        "deps/uv/src/win/fs.c||deps/uv/src/win/fs.c": [
          "File: deps/uv/src/win/fs.c -> deps/uv/src/win/fs.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "856:   if (!is_absolute) {",
          "859:     return;",
          "860:   }",
          "",
          "[Removed Lines]",
          "858:     SET_REQ_UV_ERROR(req, EINVAL, ERROR_NOT_SUPPORTED);",
          "",
          "[Added Lines]",
          "858:     SET_REQ_UV_ERROR(req, UV_EINVAL, ERROR_NOT_SUPPORTED);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1445:   if (cb) {",
          "1446:     uv_fs_req_init_async(loop, req, UV_FS_SYMLINK, path, pathw, cb);",
          "1447:     req->new_pathw = new_pathw;",
          "1448:     req->flags |= UV_FS_FREE_NEW_PATH;",
          "1449:     QUEUE_FS_TP_JOB(loop, req);",
          "1450:   } else {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1448:     req->file_flags = flags;",
          "",
          "---------------"
        ],
        "deps/uv/src/win/internal.h||deps/uv/src/win/internal.h": [
          "File: deps/uv/src/win/internal.h -> deps/uv/src/win/internal.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "312: void uv_process_endgame(uv_loop_t* loop, uv_process_t* handle);",
          "",
          "[Removed Lines]",
          "318: typedef struct uv_ares_action_s uv_ares_action_t;",
          "320: void uv_process_ares_event_req(uv_loop_t* loop, uv_ares_action_t* handle,",
          "321:     uv_req_t* req);",
          "322: void uv_process_ares_cleanup_req(uv_loop_t* loop, uv_ares_task_t* handle,",
          "323:     uv_req_t* req);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/src/win/req.c||deps/uv/src/win/req.c": [
          "File: deps/uv/src/win/req.c -> deps/uv/src/win/req.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "138:         uv_process_poll_req(loop, (uv_poll_t*) req->data, req);",
          "139:         break;",
          "149:       case UV_GETADDRINFO:",
          "150:         uv_process_getaddrinfo_req(loop, (uv_getaddrinfo_t*) req);",
          "151:         break;",
          "",
          "[Removed Lines]",
          "141:       case UV_ARES_EVENT_REQ:",
          "142:         uv_process_ares_event_req(loop, (uv_ares_action_t*) req->data, req);",
          "143:         break;",
          "145:       case UV_ARES_CLEANUP_REQ:",
          "146:         uv_process_ares_cleanup_req(loop, (uv_ares_task_t*) req->data, req);",
          "147:         break;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "deps/uv/test/benchmark-ares.c||deps/uv/test/benchmark-ares.c": [
          "File: deps/uv/test/benchmark-ares.c -> deps/uv/test/benchmark-ares.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "41: static int64_t start_time;",
          "42: static int64_t end_time;",
          "54: }",
          "",
          "[Removed Lines]",
          "45: static void aresbynamecallback( void *arg,",
          "46:                           int status,",
          "47:                           int timeouts,",
          "48:                           struct hostent *hostent) {",
          "49:     ares_callbacks++;",
          "50:     if (status != 0) {",
          "51:       ares_errors++;",
          "52:     }",
          "",
          "[Added Lines]",
          "46: static void aresbynamecallback(void *arg,",
          "47:                                int status,",
          "48:                                int timeouts,",
          "49:                                struct hostent *hostent) {",
          "50:   ares_callbacks++;",
          "51:   if (status != 0) {",
          "52:     ares_errors++;",
          "53:   }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "89:   ares_callbacks = 0;",
          "90:   ares_errors = 0;",
          "95:   prep_tcploopback();",
          "97:   for (ares_start = 0; ares_start < NUM_CALLS_TO_START; ares_start++) {",
          "98:     ares_gethostbyname(channel,",
          "103:   }",
          "105:   uv_run(loop);",
          "107:   uv_ares_destroy(loop, channel);",
          "111:   if (ares_errors > 0) {",
          "112:     printf(\"There were %d failures\\n\", ares_errors);",
          "113:   }",
          "114:   LOGF(\"ares_gethostbyname: %.0f req/s\\n\",",
          "117:   return 0;",
          "118: }",
          "",
          "[Removed Lines]",
          "92:   uv_update_time(loop);",
          "93:   start_time = uv_now(loop);",
          "99:                       \"echos.srv\",",
          "100:                       AF_INET,",
          "101:                       &aresbynamecallback,",
          "102:                       &argument);",
          "109:   end_time = uv_now(loop);",
          "115:       1000.0 * ares_callbacks / (double)(end_time - start_time));",
          "",
          "[Added Lines]",
          "92:   start_time = uv_hrtime();",
          "98:                        \"echos.srv\",",
          "99:                        AF_INET,",
          "100:                        &aresbynamecallback,",
          "101:                        &argument);",
          "108:   end_time = uv_hrtime();",
          "114:        1e9 * ares_callbacks / (double)(end_time - start_time));",
          "",
          "---------------"
        ],
        "deps/uv/test/test-list.h||deps/uv/test/test-list.h": [
          "File: deps/uv/test/test-list.h -> deps/uv/test/test-list.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "182: TASK_LIST_START",
          "183:   TEST_OUTPUT_ENTRY  (platform_output)",
          "185:   TEST_ENTRY  (callback_order)",
          "186:   TEST_ENTRY  (pipe_connect_bad_name)",
          "187:   TEST_ENTRY  (pipe_connect_to_file)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "185: #if 0",
          "187: #endif",
          "",
          "---------------"
        ],
        "deps/uv/uv.gyp||deps/uv/uv.gyp": [
          "File: deps/uv/uv.gyp -> deps/uv/uv.gyp",
          "--- Hunk 1 ---",
          "[Context before]",
          "49:         'include/uv.h',",
          "50:         'include/uv-private/ngx-queue.h',",
          "51:         'include/uv-private/tree.h',",
          "52:         'src/uv-common.c',",
          "53:         'src/uv-common.h',",
          "54:         'src/ares/ares_cancel.c',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:         'src/cares.c',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "134:             'src/ares/ares_iphlpapi.h',",
          "135:             'src/ares/ares_platform.c',",
          "136:             'src/win/async.c',",
          "138:             'src/win/core.c',",
          "139:             'src/win/dl.c',",
          "140:             'src/win/error.c',",
          "",
          "[Removed Lines]",
          "137:             'src/win/cares.c',",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "182:             'include/uv-private/ev.h',",
          "183:             'include/uv-private/uv-unix.h',",
          "184:             'src/unix/async.c',",
          "186:             'src/unix/core.c',",
          "187:             'src/unix/dl.c',",
          "188:             'src/unix/eio/ecb.h',",
          "",
          "[Removed Lines]",
          "185:             'src/unix/cares.c',",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c05f52c254a070f8b58f12b37687d4e40a0edb8e",
      "candidate_info": {
        "commit_hash": "c05f52c254a070f8b58f12b37687d4e40a0edb8e",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/c05f52c254a070f8b58f12b37687d4e40a0edb8e",
        "files": [
          "lib/child_process.js"
        ],
        "message": "child_process: improve maxBuffer error message\n\nMention what buffer (stdout, stderr) overflowed.",
        "before_after_code_files": [
          "lib/child_process.js||lichild_process.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/child_process.js||lichild_process.js": [
          "File: lib/child_process.js -> lichild_process.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "574:   child.stdout.addListener('data', function(chunk) {",
          "575:     stdout += chunk;",
          "576:     if (stdout.length > options.maxBuffer) {",
          "578:       kill();",
          "579:     }",
          "580:   });",
          "",
          "[Removed Lines]",
          "577:       err = new Error('maxBuffer exceeded.');",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "582:   child.stderr.addListener('data', function(chunk) {",
          "583:     stderr += chunk;",
          "584:     if (stderr.length > options.maxBuffer) {",
          "586:       kill();",
          "587:     }",
          "588:   });",
          "",
          "[Removed Lines]",
          "585:       err = new Error('maxBuffer exceeded.');",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "036d907df702c1db3a4da826dd04ea85f384d69d",
      "candidate_info": {
        "commit_hash": "036d907df702c1db3a4da826dd04ea85f384d69d",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/036d907df702c1db3a4da826dd04ea85f384d69d",
        "files": [
          "src/tcp_wrap.cc"
        ],
        "message": "tcp: root JS objects in HandleScope with Local<>",
        "before_after_code_files": [
          "src/tcp_wrap.cc||src/tcp_wrap.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/tcp_wrap.cc||src/tcp_wrap.cc": [
          "File: src/tcp_wrap.cc -> src/tcp_wrap.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "58: namespace node {",
          "61: using v8::Handle;",
          "62: using v8::Local;",
          "63: using v8::Persistent;",
          "67: using v8::String;",
          "69: using v8::TryCatch;",
          "73: using v8::Undefined;",
          "75: static Persistent<Function> tcpConstructor;",
          "76: static Persistent<String> family_symbol;",
          "",
          "[Removed Lines]",
          "60: using v8::Object;",
          "64: using v8::Value;",
          "65: using v8::HandleScope;",
          "66: using v8::FunctionTemplate;",
          "68: using v8::Function;",
          "70: using v8::Context;",
          "71: using v8::Arguments;",
          "72: using v8::Integer;",
          "",
          "[Added Lines]",
          "60: using v8::Arguments;",
          "61: using v8::Context;",
          "62: using v8::Function;",
          "63: using v8::FunctionTemplate;",
          "65: using v8::HandleScope;",
          "66: using v8::Integer;",
          "68: using v8::Object;",
          "69: using v8::Null;",
          "74: using v8::Value;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "356:   assert(wrap->object_.IsEmpty() == false);",
          "360:   if (status == 0) {",
          "",
          "[Removed Lines]",
          "358:   Handle<Value> argv[1];",
          "",
          "[Added Lines]",
          "359:   Local<Value> argv[1];",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "372:     argv[0] = client_obj;",
          "373:   } else {",
          "374:     SetErrno(uv_last_error(uv_default_loop()));",
          "376:   }",
          "378:   MakeCallback(wrap->object_, \"onconnection\", 1, argv);",
          "",
          "[Removed Lines]",
          "375:     argv[0] = v8::Null();",
          "",
          "[Added Lines]",
          "376:     argv[0] = Local<Value>::New(Null());",
          "",
          "---------------"
        ]
      }
    }
  ]
}