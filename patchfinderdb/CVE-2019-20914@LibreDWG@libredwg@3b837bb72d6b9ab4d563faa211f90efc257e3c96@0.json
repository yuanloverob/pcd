{
  "cve_id": "CVE-2019-20914",
  "cve_desc": "An issue was discovered in GNU LibreDWG through 0.9.3. There is a NULL pointer dereference in the function dwg_encode_common_entity_handle_data in common_entity_handle_data.spec.",
  "repo": "LibreDWG/libredwg",
  "patch_hash": "3b837bb72d6b9ab4d563faa211f90efc257e3c96",
  "patch_info": {
    "commit_hash": "3b837bb72d6b9ab4d563faa211f90efc257e3c96",
    "repo": "LibreDWG/libredwg",
    "commit_url": "https://github.com/LibreDWG/libredwg/commit/3b837bb72d6b9ab4d563faa211f90efc257e3c96",
    "files": [
      "programs/dwgrewrite.c",
      "src/encode.c"
    ],
    "message": "free: protect freeing obj->dxfname\n\ndont set INDXF when HANDSEED is missing.\ne.g. GH #178 null_pointer2 testcase",
    "before_after_code_files": [
      "programs/dwgrewrite.c||programs/dwgrewrite.c",
      "src/encode.c||src/encode.c"
    ]
  },
  "patch_diff": {
    "programs/dwgrewrite.c||programs/dwgrewrite.c": [
      "File: programs/dwgrewrite.c -> programs/dwgrewrite.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "197:   i = optind;",
      "199:   memset (&dwg, 0, sizeof (Dwg_Data));",
      "202:   filename_in = argv[i];",
      "203:   if (!filename_in)",
      "",
      "[Removed Lines]",
      "200:   dwg.opts = opts;",
      "",
      "[Added Lines]",
      "200:   dwg.opts = opts & 0xf;",
      "",
      "---------------"
    ],
    "src/encode.c||src/encode.c": [
      "File: src/encode.c -> src/encode.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "2421:   if (!_obj->HANDSEED) // minimal or broken DXF",
      "2422:     {",
      "2424:       dat->from_version = dat->version - 1;",
      "2425:       LOG_TRACE (\"encode from minimal DXF\\n\");",
      "2426:       _obj->HANDSEED = calloc(1, sizeof(Dwg_Object_Ref));",
      "",
      "[Removed Lines]",
      "2423:       dwg->opts |= (DWG_OPTS_MINIMAL | DWG_OPTS_INDXF);",
      "",
      "[Added Lines]",
      "2423:       dwg->opts |= DWG_OPTS_MINIMAL;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "6deea06760022108a4b78cc0cb4a0dddc5b99603",
      "candidate_info": {
        "commit_hash": "6deea06760022108a4b78cc0cb4a0dddc5b99603",
        "repo": "LibreDWG/libredwg",
        "commit_url": "https://github.com/LibreDWG/libredwg/commit/6deea06760022108a4b78cc0cb4a0dddc5b99603",
        "files": [
          "programs/dwgrewrite.c",
          "src/encode.c"
        ],
        "message": "free: protect freeing obj->dxfname\n\ndont set INDXF when HANDSEED is missing.\ne.g. GH #178 null_pointer2 testcase",
        "before_after_code_files": [
          "programs/dwgrewrite.c||programs/dwgrewrite.c",
          "src/encode.c||src/encode.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "programs/dwgrewrite.c||programs/dwgrewrite.c",
            "src/encode.c||src/encode.c"
          ],
          "candidate": [
            "programs/dwgrewrite.c||programs/dwgrewrite.c",
            "src/encode.c||src/encode.c"
          ]
        }
      },
      "candidate_diff": {
        "programs/dwgrewrite.c||programs/dwgrewrite.c": [
          "File: programs/dwgrewrite.c -> programs/dwgrewrite.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "197:   i = optind;",
          "199:   memset (&dwg, 0, sizeof (Dwg_Data));",
          "202:   filename_in = argv[i];",
          "203:   if (!filename_in)",
          "",
          "[Removed Lines]",
          "200:   dwg.opts = opts;",
          "",
          "[Added Lines]",
          "200:   dwg.opts = opts & 0xf;",
          "",
          "---------------"
        ],
        "src/encode.c||src/encode.c": [
          "File: src/encode.c -> src/encode.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2421:   if (!_obj->HANDSEED) // minimal or broken DXF",
          "2422:     {",
          "2424:       dat->from_version = dat->version - 1;",
          "2425:       LOG_TRACE (\"encode from minimal DXF\\n\");",
          "2426:       _obj->HANDSEED = calloc(1, sizeof(Dwg_Object_Ref));",
          "",
          "[Removed Lines]",
          "2423:       dwg->opts |= (DWG_OPTS_MINIMAL | DWG_OPTS_INDXF);",
          "",
          "[Added Lines]",
          "2423:       dwg->opts |= DWG_OPTS_MINIMAL;",
          "",
          "---------------"
        ]
      }
    }
  ]
}