{
  "cve_id": "CVE-2015-0208",
  "cve_desc": "The ASN.1 signature-verification implementation in the rsa_item_verify function in crypto/rsa/rsa_ameth.c in OpenSSL 1.0.2 before 1.0.2a allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via crafted RSA PSS parameters to an endpoint that uses the certificate-verification feature.",
  "repo": "openssl/openssl",
  "patch_hash": "09f06923e636019c39c807cb59c481375e720556",
  "patch_info": {
    "commit_hash": "09f06923e636019c39c807cb59c481375e720556",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/09f06923e636019c39c807cb59c481375e720556",
    "files": [
      "crypto/rsa/rsa_ameth.c"
    ],
    "message": "Reject invalid PSS parameters.\n\nFix a bug where invalid PSS parameters are not rejected resulting in a\nNULL pointer exception. This can be triggered during certificate\nverification so could be a DoS attack against a client or a server\nenabling client authentication.\n\nThanks to Brian Carpenter for reporting this issues.\n\nCVE-2015-0208\n\nReviewed-by: Tim Hudson <tjh@openssl.org>",
    "before_after_code_files": [
      "crypto/rsa/rsa_ameth.c||crypto/rsa/rsa_ameth.c"
    ]
  },
  "patch_diff": {
    "crypto/rsa/rsa_ameth.c||crypto/rsa/rsa_ameth.c": [
      "File: crypto/rsa/rsa_ameth.c -> crypto/rsa/rsa_ameth.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "703:         RSAerr(RSA_F_RSA_ITEM_VERIFY, RSA_R_UNSUPPORTED_SIGNATURE_TYPE);",
      "704:         return -1;",
      "705:     }",
      "708:         return 2;",
      "709:     return -1;",
      "710: }",
      "",
      "[Removed Lines]",
      "706:     if (rsa_pss_to_ctx(ctx, NULL, sigalg, pkey))",
      "",
      "[Added Lines]",
      "706:     if (rsa_pss_to_ctx(ctx, NULL, sigalg, pkey) > 0) {",
      "709:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "4b22cce3812052fe64fc3f6d58d8cc884e3cb834",
      "candidate_info": {
        "commit_hash": "4b22cce3812052fe64fc3f6d58d8cc884e3cb834",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/4b22cce3812052fe64fc3f6d58d8cc884e3cb834",
        "files": [
          "crypto/rsa/rsa_ameth.c"
        ],
        "message": "Reject invalid PSS parameters.\n\nFix a bug where invalid PSS parameters are not rejected resulting in a\nNULL pointer exception. This can be triggered during certificate\nverification so could be a DoS attack against a client or a server\nenabling client authentication.\n\nThanks to Brian Carpenter for reporting this issues.\n\nCVE-2015-0208\n\nReviewed-by: Tim Hudson <tjh@openssl.org>",
        "before_after_code_files": [
          "crypto/rsa/rsa_ameth.c||crypto/rsa/rsa_ameth.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "crypto/rsa/rsa_ameth.c||crypto/rsa/rsa_ameth.c"
          ],
          "candidate": [
            "crypto/rsa/rsa_ameth.c||crypto/rsa/rsa_ameth.c"
          ]
        }
      },
      "candidate_diff": {
        "crypto/rsa/rsa_ameth.c||crypto/rsa/rsa_ameth.c": [
          "File: crypto/rsa/rsa_ameth.c -> crypto/rsa/rsa_ameth.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "698:         RSAerr(RSA_F_RSA_ITEM_VERIFY, RSA_R_UNSUPPORTED_SIGNATURE_TYPE);",
          "699:         return -1;",
          "700:     }",
          "703:         return 2;",
          "704:     return -1;",
          "705: }",
          "",
          "[Removed Lines]",
          "701:     if (rsa_pss_to_ctx(ctx, NULL, sigalg, pkey))",
          "",
          "[Added Lines]",
          "701:     if (rsa_pss_to_ctx(ctx, NULL, sigalg, pkey) > 0) {",
          "704:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}