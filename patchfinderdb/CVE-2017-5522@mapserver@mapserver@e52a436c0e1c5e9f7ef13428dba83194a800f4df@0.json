{
  "cve_id": "CVE-2017-5522",
  "cve_desc": "Stack-based buffer overflow in MapServer before 6.0.6, 6.2.x before 6.2.4, 6.4.x before 6.4.5, and 7.0.x before 7.0.4 allows remote attackers to cause a denial of service (crash) or execute arbitrary code via vectors involving WFS get feature requests.",
  "repo": "mapserver/mapserver",
  "patch_hash": "e52a436c0e1c5e9f7ef13428dba83194a800f4df",
  "patch_info": {
    "commit_hash": "e52a436c0e1c5e9f7ef13428dba83194a800f4df",
    "repo": "mapserver/mapserver",
    "commit_url": "https://github.com/mapserver/mapserver/commit/e52a436c0e1c5e9f7ef13428dba83194a800f4df",
    "files": [
      "mapogcfilter.c",
      "mapogcfiltercommon.c"
    ],
    "message": "security fix (patch by EvenR)",
    "before_after_code_files": [
      "mapogcfilter.c||mapogcfilter.c",
      "mapogcfiltercommon.c||mapogcfiltercommon.c"
    ]
  },
  "patch_diff": {
    "mapogcfilter.c||mapogcfilter.c": [
      "File: mapogcfilter.c -> mapogcfilter.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "3005:   pszValue = psFilterNode->psRightNode->pszValue;",
      "3006:   nLength = strlen(pszValue);",
      "3008:   iTmp =0;",
      "3009:   if (nLength > 0 && pszValue[0] != pszWild[0] &&",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3007:   if( 1 + 2 * nLength + 1 + 1 >= sizeof(szTmp) )",
      "3008:       return NULL;",
      "",
      "---------------"
    ],
    "mapogcfiltercommon.c||mapogcfiltercommon.c": [
      "File: mapogcfiltercommon.c -> mapogcfiltercommon.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "89:   pszValue = psFilterNode->psRightNode->pszValue;",
      "90:   nLength = strlen(pszValue);",
      "92:   iTmp =0;",
      "93:   if (nLength > 0 && pszValue[0] != pszWild[0] && pszValue[0] != pszSingle[0] && pszValue[0] != pszEscape[0]) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "91:   if( 1 + 2 * nLength + 1 + 1 >= sizeof(szTmp) )",
      "92:       return NULL;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "fb00f8149898fcf9fcb490a179984e481248f066",
      "candidate_info": {
        "commit_hash": "fb00f8149898fcf9fcb490a179984e481248f066",
        "repo": "mapserver/mapserver",
        "commit_url": "https://github.com/mapserver/mapserver/commit/fb00f8149898fcf9fcb490a179984e481248f066",
        "files": [
          "mapogcfiltercommon.c"
        ],
        "message": "security fix",
        "before_after_code_files": [
          "mapogcfiltercommon.c||mapogcfiltercommon.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "mapogcfiltercommon.c||mapogcfiltercommon.c"
          ],
          "candidate": [
            "mapogcfiltercommon.c||mapogcfiltercommon.c"
          ]
        }
      },
      "candidate_diff": {
        "mapogcfiltercommon.c||mapogcfiltercommon.c": [
          "File: mapogcfiltercommon.c -> mapogcfiltercommon.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "94:   pszValue = psFilterNode->psRightNode->pszValue;",
          "95:   nLength = strlen(pszValue);",
          "97:   iTmp =0;",
          "98:   if (nLength > 0 && pszValue[0] != pszWild[0] &&",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "96:   if( 1 + 2 * nLength + 1 + 1 >= sizeof(szTmp) )",
          "97:       return NULL;",
          "",
          "---------------"
        ]
      }
    }
  ]
}