{
  "cve_id": "CVE-2017-6952",
  "cve_desc": "Integer overflow in the cs_winkernel_malloc function in winkernel_mm.c in Capstone 3.0.4 and earlier allows attackers to cause a denial of service (heap-based buffer overflow in a kernel driver) or possibly have unspecified other impact via a large value.",
  "repo": "aquynh/capstone",
  "patch_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
  "patch_info": {
    "commit_hash": "6fe86eef621b9849f51a5e1e5d73258a93440403",
    "repo": "aquynh/capstone",
    "commit_url": "https://github.com/aquynh/capstone/commit/6fe86eef621b9849f51a5e1e5d73258a93440403",
    "files": [
      "windows/winkernel_mm.c"
    ],
    "message": "provide a validity check to prevent against Integer overflow conditions (#870)\n\n* provide a validity check to prevent against Integer overflow conditions\n\n* fix some style issues.",
    "before_after_code_files": [
      "windows/winkernel_mm.c||windows/winkernel_mm.c"
    ]
  },
  "patch_diff": {
    "windows/winkernel_mm.c||windows/winkernel_mm.c": [
      "File: windows/winkernel_mm.c -> windows/winkernel_mm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: #include \"winkernel_mm.h\"",
      "5: #include <ntddk.h>",
      "8: static const ULONG CS_WINKERNEL_POOL_TAG = 'kwsC';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "6: #include <Ntintsafe.h>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "35: #pragma prefast(suppress : 30030)  // Allocating executable POOL_TYPE memory",
      "38:  if (!block) {",
      "39:   return NULL;",
      "40:  }",
      "",
      "[Removed Lines]",
      "36:  CS_WINKERNEL_MEMBLOCK *block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "37:    NonPagedPool, size + sizeof(CS_WINKERNEL_MEMBLOCK), CS_WINKERNEL_POOL_TAG);",
      "",
      "[Added Lines]",
      "37:  size_t number_of_bytes = 0;",
      "38:  CS_WINKERNEL_MEMBLOCK *block = NULL;",
      "42:  if (!NT_SUCCESS(RtlSizeTAdd(size, sizeof(CS_WINKERNEL_MEMBLOCK), &number_of_bytes))) {",
      "43:   return NULL;",
      "44:  }",
      "45:  block = (CS_WINKERNEL_MEMBLOCK *)ExAllocatePoolWithTag(",
      "46:    NonPagedPool, number_of_bytes, CS_WINKERNEL_POOL_TAG);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ab93c00ea3ac8d5574d4e4996d58cddbd8e6374a",
      "candidate_info": {
        "commit_hash": "ab93c00ea3ac8d5574d4e4996d58cddbd8e6374a",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/ab93c00ea3ac8d5574d4e4996d58cddbd8e6374a",
        "files": [
          "arch/Sparc/SparcInstPrinter.c"
        ],
        "message": "sparc: fix target address of CALL instruction. issue #653",
        "before_after_code_files": [
          "arch/Sparc/SparcInstPrinter.c||arch/Sparc/SparcInstPrinter.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/Sparc/SparcInstPrinter.c||arch/Sparc/SparcInstPrinter.c": [
          "File: arch/Sparc/SparcInstPrinter.c -> arch/Sparc/SparcInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "196:   switch (MI->Opcode) {",
          "197:    case SP_CALL:",
          "199:     Imm += (uint32_t)MI->address;",
          "200:     break;",
          "",
          "[Removed Lines]",
          "198:     Imm = SignExtend32(Imm, 30);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a1422bd8f6a41a6bc1dfc56eac19f2ef366e7bdc",
      "candidate_info": {
        "commit_hash": "a1422bd8f6a41a6bc1dfc56eac19f2ef366e7bdc",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/a1422bd8f6a41a6bc1dfc56eac19f2ef366e7bdc",
        "files": [
          "arch/ARM/ARMInstPrinter.c"
        ],
        "message": "arm: add IMM operand for printPostIdxImm8s4Operand(). issue #861",
        "before_after_code_files": [
          "arch/ARM/ARMInstPrinter.c||arch/ARM/ARMInstPrinter.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "arch/ARM/ARMInstPrinter.c||arch/ARM/ARMInstPrinter.c": [
          "File: arch/ARM/ARMInstPrinter.c -> arch/ARM/ARMInstPrinter.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1266: {",
          "1267:  MCOperand *MO = MCInst_getOperand(MI, OpNum);",
          "1268:  unsigned Imm = (unsigned int)MCOperand_getImm(MO);",
          "1270:   SStream_concat(O, \"#%s0x%x\", ((Imm & 256) ? \"\" : \"-\"), ((Imm & 0xff) << 2));",
          "1272:   SStream_concat(O, \"#%s%u\", ((Imm & 256) ? \"\" : \"-\"), ((Imm & 0xff) << 2));",
          "1273: }",
          "1275: static void printAddrMode5Operand(MCInst *MI, unsigned OpNum, SStream *O,",
          "",
          "[Removed Lines]",
          "1269:  if (((Imm & 0xff) << 2) > HEX_THRESHOLD)",
          "1271:  else",
          "",
          "[Added Lines]",
          "1270:  if (((Imm & 0xff) << 2) > HEX_THRESHOLD) {",
          "1272:  } else {",
          "1274:  }",
          "1276:  if (MI->csh->detail) {",
          "1277:   int v = (Imm & 256) ? ((Imm & 0xff) << 2) : -((Imm & 0xff) << 2);",
          "1278:   MI->flat_insn->detail->arm.operands[MI->flat_insn->detail->arm.op_count].type = ARM_OP_IMM;",
          "1279:   MI->flat_insn->detail->arm.operands[MI->flat_insn->detail->arm.op_count].imm = v;",
          "1280:   MI->flat_insn->detail->arm.op_count++;",
          "1281:  }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8ae679e0dee211a7ea0cbebb50a978e63414877a",
      "candidate_info": {
        "commit_hash": "8ae679e0dee211a7ea0cbebb50a978e63414877a",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/8ae679e0dee211a7ea0cbebb50a978e63414877a",
        "files": [
          "msvc/capstone_static/capstone_static.vcxproj"
        ],
        "message": "Added compile configurations for WDK",
        "before_after_code_files": [
          "msvc/capstone_static/capstone_static.vcxproj||msvc/capstone_static/capstone_static.vcxproj"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "msvc/capstone_static/capstone_static.vcxproj||msvc/capstone_static/capstone_static.vcxproj": [
          "File: msvc/capstone_static/capstone_static.vcxproj -> msvc/capstone_static/capstone_static.vcxproj",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: \ufeff<?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "3:   <ItemGroup Label=\"ProjectConfigurations\">",
          "4:     <ProjectConfiguration Include=\"Debug|Win32\">",
          "5:       <Configuration>Debug</Configuration>",
          "6:       <Platform>Win32</Platform>",
          "",
          "[Removed Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"4.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "",
          "[Added Lines]",
          "2: <Project DefaultTargets=\"Build\" ToolsVersion=\"14.0\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\">",
          "4:     <ProjectConfiguration Include=\"Debug_WDK|Win32\">",
          "5:       <Configuration>Debug_WDK</Configuration>",
          "6:       <Platform>Win32</Platform>",
          "7:     </ProjectConfiguration>",
          "8:     <ProjectConfiguration Include=\"Debug_WDK|x64\">",
          "9:       <Configuration>Debug_WDK</Configuration>",
          "10:       <Platform>x64</Platform>",
          "11:     </ProjectConfiguration>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "9:       <Configuration>Debug</Configuration>",
          "10:       <Platform>x64</Platform>",
          "11:     </ProjectConfiguration>",
          "12:     <ProjectConfiguration Include=\"Release|Win32\">",
          "13:       <Configuration>Release</Configuration>",
          "14:       <Platform>Win32</Platform>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "20:     <ProjectConfiguration Include=\"Release_WDK|Win32\">",
          "21:       <Configuration>Release_WDK</Configuration>",
          "22:       <Platform>Win32</Platform>",
          "23:     </ProjectConfiguration>",
          "24:     <ProjectConfiguration Include=\"Release_WDK|x64\">",
          "25:       <Configuration>Release_WDK</Configuration>",
          "26:       <Platform>x64</Platform>",
          "27:     </ProjectConfiguration>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "67:     <Keyword>Win32Proj</Keyword>",
          "68:     <RootNamespace>capstonewin32</RootNamespace>",
          "69:     <ProjectName>capstone_static</ProjectName>",
          "70:   </PropertyGroup>",
          "71:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />",
          "72:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\" Label=\"Configuration\">",
          "73:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "74:     <UseDebugLibraries>true</UseDebugLibraries>",
          "75:     <CharacterSet>Unicode</CharacterSet>",
          "76:   </PropertyGroup>",
          "77:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"Configuration\">",
          "78:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "79:     <UseDebugLibraries>true</UseDebugLibraries>",
          "80:     <CharacterSet>Unicode</CharacterSet>",
          "81:   </PropertyGroup>",
          "82:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">",
          "83:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "84:     <UseDebugLibraries>false</UseDebugLibraries>",
          "85:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "86:     <CharacterSet>Unicode</CharacterSet>",
          "87:   </PropertyGroup>",
          "88:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"Configuration\">",
          "89:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "90:     <UseDebugLibraries>false</UseDebugLibraries>",
          "91:     <WholeProgramOptimization>true</WholeProgramOptimization>",
          "92:     <CharacterSet>Unicode</CharacterSet>",
          "93:   </PropertyGroup>",
          "94:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />",
          "95:   <ImportGroup Label=\"ExtensionSettings\">",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "86:     <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>",
          "93:     <PlatformToolset>v140</PlatformToolset>",
          "94:   </PropertyGroup>",
          "95:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\" Label=\"Configuration\">",
          "96:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "97:     <UseDebugLibraries>true</UseDebugLibraries>",
          "98:     <CharacterSet>Unicode</CharacterSet>",
          "99:     <PlatformToolset>v140</PlatformToolset>",
          "105:     <PlatformToolset>v140</PlatformToolset>",
          "106:   </PropertyGroup>",
          "107:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\" Label=\"Configuration\">",
          "108:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "109:     <UseDebugLibraries>true</UseDebugLibraries>",
          "110:     <CharacterSet>Unicode</CharacterSet>",
          "111:     <PlatformToolset>v140</PlatformToolset>",
          "118:     <PlatformToolset>v140</PlatformToolset>",
          "119:   </PropertyGroup>",
          "120:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\" Label=\"Configuration\">",
          "121:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "122:     <UseDebugLibraries>false</UseDebugLibraries>",
          "123:     <CharacterSet>Unicode</CharacterSet>",
          "124:     <PlatformToolset>v140</PlatformToolset>",
          "131:     <PlatformToolset>v140</PlatformToolset>",
          "132:   </PropertyGroup>",
          "133:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\" Label=\"Configuration\">",
          "134:     <ConfigurationType>StaticLibrary</ConfigurationType>",
          "135:     <UseDebugLibraries>false</UseDebugLibraries>",
          "136:     <CharacterSet>Unicode</CharacterSet>",
          "137:     <PlatformToolset>v140</PlatformToolset>",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "97:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "98:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "99:   </ImportGroup>",
          "100:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\" Label=\"PropertySheets\">",
          "101:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "102:   </ImportGroup>",
          "103:   <ImportGroup Label=\"PropertySheets\" Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "104:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "105:   </ImportGroup>",
          "106:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\" Label=\"PropertySheets\">",
          "107:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "108:   </ImportGroup>",
          "109:   <PropertyGroup Label=\"UserMacros\" />",
          "110:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "111:     <TargetName>capstone</TargetName>",
          "112:   </PropertyGroup>",
          "113:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "114:     <TargetName>capstone</TargetName>",
          "115:   </PropertyGroup>",
          "116:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "117:     <TargetName>capstone</TargetName>",
          "118:   </PropertyGroup>",
          "119:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "120:     <TargetName>capstone</TargetName>",
          "121:   </PropertyGroup>",
          "122:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|Win32'\">",
          "123:     <ClCompile>",
          "124:       <PrecompiledHeader>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "145:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\" Label=\"PropertySheets\">",
          "146:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "147:   </ImportGroup>",
          "151:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\" Label=\"PropertySheets\">",
          "152:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "153:   </ImportGroup>",
          "157:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\" Label=\"PropertySheets\">",
          "158:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "159:   </ImportGroup>",
          "163:   <ImportGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\" Label=\"PropertySheets\">",
          "164:     <Import Project=\"$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props\" Condition=\"exists('$(UserRootDir)\\Microsoft.Cpp.$(Platform).user.props')\" Label=\"LocalAppDataPlatform\" />",
          "165:   </ImportGroup>",
          "170:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\">",
          "171:     <TargetName>capstone</TargetName>",
          "172:   </PropertyGroup>",
          "176:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\">",
          "177:     <TargetName>capstone</TargetName>",
          "178:   </PropertyGroup>",
          "182:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\">",
          "183:     <TargetName>capstone</TargetName>",
          "184:   </PropertyGroup>",
          "188:   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\">",
          "189:     <TargetName>capstone</TargetName>",
          "190:   </PropertyGroup>",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "135:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "136:     </Link>",
          "137:   </ItemDefinitionGroup>",
          "138:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug|x64'\">",
          "139:     <ClCompile>",
          "140:       <PrecompiledHeader>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "207:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|Win32'\">",
          "208:     <ClCompile>",
          "209:       <PrecompiledHeader>",
          "210:       </PrecompiledHeader>",
          "211:       <WarningLevel>Level3</WarningLevel>",
          "212:       <Optimization>Disabled</Optimization>",
          "213:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;_DEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "214:       <SDLCheck>true</SDLCheck>",
          "215:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "216:       <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>",
          "217:       <BasicRuntimeChecks>Default</BasicRuntimeChecks>",
          "218:       <RuntimeLibrary />",
          "219:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "220:     </ClCompile>",
          "221:     <Link>",
          "222:       <SubSystem>Windows</SubSystem>",
          "223:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "224:     </Link>",
          "225:   </ItemDefinitionGroup>",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "151:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "152:     </Link>",
          "153:   </ItemDefinitionGroup>",
          "154:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\">",
          "155:     <ClCompile>",
          "156:       <WarningLevel>Level3</WarningLevel>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "242:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Debug_WDK|x64'\">",
          "243:     <ClCompile>",
          "244:       <PrecompiledHeader>",
          "245:       </PrecompiledHeader>",
          "246:       <WarningLevel>Level3</WarningLevel>",
          "247:       <Optimization>Disabled</Optimization>",
          "248:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;_DEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "249:       <SDLCheck>true</SDLCheck>",
          "250:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "251:       <DebugInformationFormat>ProgramDatabase</DebugInformationFormat>",
          "252:       <BasicRuntimeChecks>Default</BasicRuntimeChecks>",
          "253:       <RuntimeLibrary />",
          "254:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "255:     </ClCompile>",
          "256:     <Link>",
          "257:       <SubSystem>Windows</SubSystem>",
          "258:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "259:     </Link>",
          "260:   </ItemDefinitionGroup>",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "171:       <OptimizeReferences>true</OptimizeReferences>",
          "172:     </Link>",
          "173:   </ItemDefinitionGroup>",
          "174:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|x64'\">",
          "175:     <ClCompile>",
          "176:       <WarningLevel>Level3</WarningLevel>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "281:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|Win32'\">",
          "282:     <ClCompile>",
          "283:       <WarningLevel>Level3</WarningLevel>",
          "284:       <PrecompiledHeader>",
          "285:       </PrecompiledHeader>",
          "286:       <Optimization>MaxSpeed</Optimization>",
          "287:       <FunctionLevelLinking>true</FunctionLevelLinking>",
          "288:       <IntrinsicFunctions>true</IntrinsicFunctions>",
          "289:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;NDEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "290:       <SDLCheck>true</SDLCheck>",
          "291:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "292:       <RuntimeLibrary>",
          "293:       </RuntimeLibrary>",
          "294:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "295:     </ClCompile>",
          "296:     <Link>",
          "297:       <SubSystem>Windows</SubSystem>",
          "298:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "299:       <EnableCOMDATFolding>true</EnableCOMDATFolding>",
          "300:       <OptimizeReferences>true</OptimizeReferences>",
          "301:     </Link>",
          "302:   </ItemDefinitionGroup>",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "191:       <OptimizeReferences>true</OptimizeReferences>",
          "192:     </Link>",
          "193:   </ItemDefinitionGroup>",
          "194:   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.targets\" />",
          "195:   <ImportGroup Label=\"ExtensionTargets\">",
          "196:   </ImportGroup>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "323:   <ItemDefinitionGroup Condition=\"'$(Configuration)|$(Platform)'=='Release_WDK|x64'\">",
          "324:     <ClCompile>",
          "325:       <WarningLevel>Level3</WarningLevel>",
          "326:       <PrecompiledHeader>",
          "327:       </PrecompiledHeader>",
          "328:       <Optimization>MaxSpeed</Optimization>",
          "329:       <FunctionLevelLinking>true</FunctionLevelLinking>",
          "330:       <IntrinsicFunctions>true</IntrinsicFunctions>",
          "331:       <PreprocessorDefinitions>CAPSTONE_X86_ATT_DISABLE_NO;CAPSTONE_DIET_NO;CAPSTONE_X86_REDUCE_NO;CAPSTONE_HAS_ARM;CAPSTONE_HAS_ARM64;CAPSTONE_HAS_MIPS;CAPSTONE_HAS_POWERPC;CAPSTONE_HAS_SPARC;CAPSTONE_HAS_SYSZ;CAPSTONE_HAS_X86;CAPSTONE_HAS_XCORE;WIN32;NDEBUG;_LIB;%(PreprocessorDefinitions)</PreprocessorDefinitions>",
          "332:       <SDLCheck>true</SDLCheck>",
          "333:       <AdditionalIncludeDirectories>..\\..\\include;..\\headers;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>",
          "334:       <RuntimeLibrary>",
          "335:       </RuntimeLibrary>",
          "336:       <AdditionalOptions>/kernel</AdditionalOptions>",
          "337:     </ClCompile>",
          "338:     <Link>",
          "339:       <SubSystem>Windows</SubSystem>",
          "340:       <GenerateDebugInformation>true</GenerateDebugInformation>",
          "341:       <EnableCOMDATFolding>true</EnableCOMDATFolding>",
          "342:       <OptimizeReferences>true</OptimizeReferences>",
          "343:     </Link>",
          "344:   </ItemDefinitionGroup>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "541e890cc31834396c4e4d516227c909efbb7a4b",
      "candidate_info": {
        "commit_hash": "541e890cc31834396c4e4d516227c909efbb7a4b",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/541e890cc31834396c4e4d516227c909efbb7a4b",
        "files": [
          "contrib/objdump/objdump-m68k.py"
        ],
        "message": "[python][contrib][objdump] fixup op.register_bits access",
        "before_after_code_files": [
          "contrib/objdump/objdump-m68k.py||contriobjdump/objdump-m68k.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "contrib/objdump/objdump-m68k.py||contriobjdump/objdump-m68k.py": [
          "File: contrib/objdump/objdump-m68k.py -> contriobjdump/objdump-m68k.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "150:     if op.address_mode in [ M68K_AM_PCI_INDEX_8_BIT_DISP, M68K_AM_AREGI_INDEX_8_BIT_DISP ]:",
          "151:         disp = op.mem.disp",
          "153:             disp = extsign8(op.mem.disp)",
          "155:             disp = extsign1632(op.mem.disp)",
          "157:         str = dump_op_reg(insn, op.mem.base_reg) + \"@(\" + \"{0:016x}\".format(disp) + \",\" + dump_op_reg(insn, op.mem.index_reg) + \":\" + map_index_size_str[op.mem.index_size]",
          "160:         return str + \")\"",
          "",
          "[Removed Lines]",
          "152:         if op.mem.register_bits == 2:",
          "154:         if op.mem.register_bits == 4:",
          "158:         if op.mem.register_bits:",
          "159:             str += format(\":%u\" % (op.mem.register_bits))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "165:         str += format(\"@(%016x)@(%016x\" % (extsign1632(op.mem.in_disp), extsign1632(op.mem.out_disp)))",
          "166:         if op.mem.index_reg:",
          "167:             str += \",\" + dump_op_reg(insn, op.mem.index_reg) + \":\" + map_index_size_str[op.mem.index_size]",
          "170:         str += \")\"",
          "171:         return str",
          "",
          "[Removed Lines]",
          "168:         if op.mem.register_bits:",
          "169:             str += format(\":%u\" % (op.mem.register_bits))",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fbfa991cae29068297582e2e04d1a2376925ec27",
      "candidate_info": {
        "commit_hash": "fbfa991cae29068297582e2e04d1a2376925ec27",
        "repo": "aquynh/capstone",
        "commit_url": "https://github.com/aquynh/capstone/commit/fbfa991cae29068297582e2e04d1a2376925ec27",
        "files": [
          "COMPILE_CMAKE.TXT",
          "nmake.bat"
        ],
        "message": "add nmake.bat",
        "before_after_code_files": [
          "nmake.bat||nmake.bat"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/NeatNerdPrime/capstone/pull/17"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "nmake.bat||nmake.bat": [
          "File: nmake.bat -> nmake.bat",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: :: Capstone disassembler engine (www.capstone-engine.org)",
          "2: :: Build Capstone libs (capstone.dll & capstone.lib) on Windows with CMake & Nmake",
          "3: :: By Nguyen Anh Quynh, 2017",
          "5: cmake -DCMAKE_BUILD_TYPE=Release -G \"NMake Makefiles\" ..",
          "6: nmake",
          "",
          "---------------"
        ]
      }
    }
  ]
}