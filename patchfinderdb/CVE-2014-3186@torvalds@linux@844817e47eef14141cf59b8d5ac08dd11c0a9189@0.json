{
  "cve_id": "CVE-2014-3186",
  "cve_desc": "Buffer overflow in the picolcd_raw_event function in devices/hid/hid-picolcd_core.c in the PicoLCD HID device driver in the Linux kernel through 3.16.3, as used in Android on Nexus 7 devices, allows physically proximate attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a crafted device that sends a large report.",
  "repo": "torvalds/linux",
  "patch_hash": "844817e47eef14141cf59b8d5ac08dd11c0a9189",
  "patch_info": {
    "commit_hash": "844817e47eef14141cf59b8d5ac08dd11c0a9189",
    "repo": "torvalds/linux",
    "commit_url": "https://github.com/torvalds/linux/commit/844817e47eef14141cf59b8d5ac08dd11c0a9189",
    "files": [
      "drivers/hid/hid-picolcd_core.c"
    ],
    "message": "HID: picolcd: sanity check report size in raw_event() callback\n\nThe report passed to us from transport driver could potentially be\narbitrarily large, therefore we better sanity-check it so that raw_data\nthat we hold in picolcd_pending structure are always kept within proper\nbounds.\n\nCc: stable@vger.kernel.org\nReported-by: Steven Vittitoe <scvitti@google.com>\nSigned-off-by: Jiri Kosina <jkosina@suse.cz>",
    "before_after_code_files": [
      "drivers/hid/hid-picolcd_core.c||drivers/hid/hid-picolcd_core.c"
    ]
  },
  "patch_diff": {
    "drivers/hid/hid-picolcd_core.c||drivers/hid/hid-picolcd_core.c": [
      "File: drivers/hid/hid-picolcd_core.c -> drivers/hid/hid-picolcd_core.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "350:  if (!data)",
      "351:   return 1;",
      "353:  if (report->id == REPORT_KEY_STATE) {",
      "354:   if (data->input_keys)",
      "355:    ret = picolcd_raw_keypad(data, report, raw_data+1, size-1);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "353:  if (size > 64) {",
      "354:   hid_warn(hdev, \"invalid size value (%d) for picolcd raw event\\n\",",
      "355:     size);",
      "356:   return 0;",
      "357:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "604b607748a576c3861f549772b72fb62c05a3fd",
      "candidate_info": {
        "commit_hash": "604b607748a576c3861f549772b72fb62c05a3fd",
        "repo": "torvalds/linux",
        "commit_url": "https://github.com/torvalds/linux/commit/604b607748a576c3861f549772b72fb62c05a3fd",
        "files": [
          "drivers/hid/hid-picolcd_core.c"
        ],
        "message": "HID: picolcd: be more verbose when reporting report size error\n\npicolcd device is not expected to send any report with size larger than\n64 bytes.\n\nIf this impossible event happens (sic!), print also a report ID to allow\nfor easier debugging.\n\nSuggested-by: Bruno Pr\u00e9mont <bonbons@linux-vserver.org>\nSigned-off-by: Jiri Kosina <jkosina@suse.cz>",
        "before_after_code_files": [
          "drivers/hid/hid-picolcd_core.c||drivers/hid/hid-picolcd_core.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "drivers/hid/hid-picolcd_core.c||drivers/hid/hid-picolcd_core.c"
          ],
          "candidate": [
            "drivers/hid/hid-picolcd_core.c||drivers/hid/hid-picolcd_core.c"
          ]
        }
      },
      "candidate_diff": {
        "drivers/hid/hid-picolcd_core.c||drivers/hid/hid-picolcd_core.c": [
          "File: drivers/hid/hid-picolcd_core.c -> drivers/hid/hid-picolcd_core.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "351:   return 1;",
          "353:  if (size > 64) {",
          "356:   return 0;",
          "357:  }",
          "",
          "[Removed Lines]",
          "354:   hid_warn(hdev, \"invalid size value (%d) for picolcd raw event\\n\",",
          "355:     size);",
          "",
          "[Added Lines]",
          "354:   hid_warn(hdev, \"invalid size value (%d) for picolcd raw event (%d)\\n\",",
          "355:     size, report->id);",
          "",
          "---------------"
        ]
      }
    }
  ]
}