{
  "cve_id": "CVE-2015-0278",
  "cve_desc": "libuv before 0.10.34 does not properly drop group privileges, which allows context-dependent attackers to gain privileges via unspecified vectors.",
  "repo": "libuv/libuv",
  "patch_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
  "patch_info": {
    "commit_hash": "66ab38918c911bcff025562cf06237d7fedaba0c",
    "repo": "libuv/libuv",
    "commit_url": "https://github.com/libuv/libuv/commit/66ab38918c911bcff025562cf06237d7fedaba0c",
    "files": [
      "src/unix/process.c"
    ],
    "message": "unix: call setgoups before calling setuid/setgid\n\nPartial fix for #1093",
    "before_after_code_files": [
      "src/unix/process.c||src/unix/process.c"
    ]
  },
  "patch_diff": {
    "src/unix/process.c||src/unix/process.c": [
      "File: src/unix/process.c -> src/unix/process.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "330:     _exit(127);",
      "331:   }",
      "333:   if ((options->flags & UV_PROCESS_SETGID) && setgid(options->gid)) {",
      "334:     uv__write_int(error_fd, -errno);",
      "335:     perror(\"setgid()\");",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "333:   if (options->flags & (UV_PROCESS_SETUID | UV_PROCESS_SETGID)) {",
      "341:     SAVE_ERRNO(setgroups(0, NULL));",
      "342:   }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "37e12bdafbb82e652f84f131b72779de769e4ccf",
      "candidate_info": {
        "commit_hash": "37e12bdafbb82e652f84f131b72779de769e4ccf",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/37e12bdafbb82e652f84f131b72779de769e4ccf",
        "files": [
          "src/unix/linux-core.c"
        ],
        "message": "Revert \"linux: silence uninitialized variable warning\"\n\nThis reverts commit 5008f8de08019af46ee844489ee9eeb18e5c7dd7.",
        "before_after_code_files": [
          "src/unix/linux-core.c||src/unix/linux-core.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/unix/linux-core.c||src/unix/linux-core.c": [
          "File: src/unix/linux-core.c -> src/unix/linux-core.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "637:     {",
          "639:       assert(sscanf(buf, \"cpu%u \", &n) == 1);",
          "640:       for (len = sizeof(\"cpu0\"); n /= 10; len++);",
          "641:     }",
          "",
          "[Removed Lines]",
          "638:       unsigned int n = 0;",
          "",
          "[Added Lines]",
          "638:       unsigned int n;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0fdd99f02b2b22b0ba4e23f70017fa77393caa11",
      "candidate_info": {
        "commit_hash": "0fdd99f02b2b22b0ba4e23f70017fa77393caa11",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/0fdd99f02b2b22b0ba4e23f70017fa77393caa11",
        "files": [
          "src/unix/fsevents.c"
        ],
        "message": "fsevents: increase stack size for OSX 10.9\n\nOtherwise it fails with `EXC_BAD_ACCESS`.",
        "before_after_code_files": [
          "src/unix/fsevents.c||src/unix/fsevents.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/unix/fsevents.c||src/unix/fsevents.c": [
          "File: src/unix/fsevents.c -> src/unix/fsevents.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "552:     attr = NULL;",
          "554:   if (attr != NULL)",
          "556:       abort();",
          "558:   loop->cf_state = state;",
          "",
          "[Removed Lines]",
          "555:     if (pthread_attr_setstacksize(attr, 3 * PTHREAD_STACK_MIN))",
          "",
          "[Added Lines]",
          "555:     if (pthread_attr_setstacksize(attr, 4 * PTHREAD_STACK_MIN))",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "09cb5b534e325fa93ec2d72491dff85179797f89",
      "candidate_info": {
        "commit_hash": "09cb5b534e325fa93ec2d72491dff85179797f89",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/09cb5b534e325fa93ec2d72491dff85179797f89",
        "files": [
          "test/test-spawn.c"
        ],
        "message": "test: fix spawn_reads_child_path when using autoconf\n\nDon't hardcode the name of the executable, take it from the exepath.\n\nFixes #1407",
        "before_after_code_files": [
          "test/test-spawn.c||test/test-spawn.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/test-spawn.c||test/test-spawn.c": [
          "File: test/test-spawn.c -> test/test-spawn.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1295: TEST_IMPL(spawn_reads_child_path) {",
          "1296:   int r;",
          "1297:   int len;",
          "1298:   char path[1024];",
          "1299:   char *env[2] = {path, NULL};",
          "1303:   init_process_options(\"spawn_helper1\", exit_cb);",
          "1308:   for (len = strlen(exepath);",
          "1309:        exepath[len - 1] != '/' && exepath[len - 1] != '\\\\';",
          "1310:        len--);",
          "1311:   exepath[len] = 0;",
          "1312:   strcpy(path, \"PATH=\");",
          "1313:   strcpy(path + 5, exepath);",
          "1315:   options.env = env;",
          "1317:   r = uv_spawn(uv_default_loop(), &process, &options);",
          "",
          "[Removed Lines]",
          "1304:   options.file = \"run-tests\";",
          "1305:   args[0] = \"run-tests\";",
          "",
          "[Added Lines]",
          "1298:   char file[64];",
          "1310:   strcpy(file, exepath + len);",
          "1315:   options.file = file;",
          "1316:   options.args[0] = file;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0c28bbf7b42882853d1799ab96ff68b07f7f8d49",
      "candidate_info": {
        "commit_hash": "0c28bbf7b42882853d1799ab96ff68b07f7f8d49",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/0c28bbf7b42882853d1799ab96ff68b07f7f8d49",
        "files": [
          "include/uv-version.h"
        ],
        "message": "version: set version to 1.0.0-rc1",
        "before_after_code_files": [
          "include/uv-version.h||include/uv-version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "include/uv-version.h||include/uv-version.h": [
          "File: include/uv-version.h -> include/uv-version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: #define UV_VERSION_MAJOR 1",
          "34: #define UV_VERSION_MINOR 0",
          "35: #define UV_VERSION_PATCH 0",
          "",
          "[Removed Lines]",
          "36: #define UV_VERSION_IS_RELEASE 0",
          "37: #define UV_VERSION_SUFFIX \"dev\"",
          "",
          "[Added Lines]",
          "36: #define UV_VERSION_IS_RELEASE 1",
          "37: #define UV_VERSION_SUFFIX \"rc1\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4b1043d43279ba13de92cef5da56c32d60616204",
      "candidate_info": {
        "commit_hash": "4b1043d43279ba13de92cef5da56c32d60616204",
        "repo": "libuv/libuv",
        "commit_url": "https://github.com/libuv/libuv/commit/4b1043d43279ba13de92cef5da56c32d60616204",
        "files": [
          "uv.gyp"
        ],
        "message": "build: removed unused and old option on AIX",
        "before_after_code_files": [
          "uv.gyp||uv.gyp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/libuv/libuv/pull/41"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "uv.gyp||uv.gyp": [
          "File: uv.gyp -> uv.gyp",
          "--- Hunk 1 ---",
          "[Context before]",
          "238:           },",
          "239:         }],",
          "240:         [ 'OS==\"aix\"', {",
          "242:           'sources': [ 'src/unix/aix.c' ],",
          "243:           'defines': [",
          "244:             '_ALL_SOURCE',",
          "",
          "[Removed Lines]",
          "241:           'include_dirs': [ 'src/ares/config_aix' ],",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}