{
  "cve_id": "CVE-2015-7551",
  "cve_desc": "The Fiddle::Handle implementation in ext/fiddle/handle.c in Ruby before 2.0.0-p648, 2.1 before 2.1.8, and 2.2 before 2.2.4, as distributed in Apple OS X before 10.11.4 and other products, mishandles tainting, which allows context-dependent attackers to execute arbitrary code or cause a denial of service (application crash) via a crafted string, related to the DL module and the libffi library.  NOTE: this vulnerability exists because of a CVE-2009-5147 regression.",
  "repo": "ruby/ruby",
  "patch_hash": "339e11a7f178312d937b7c95dd3115ce7236597a",
  "patch_info": {
    "commit_hash": "339e11a7f178312d937b7c95dd3115ce7236597a",
    "repo": "ruby/ruby",
    "commit_url": "https://github.com/ruby/ruby/commit/339e11a7f178312d937b7c95dd3115ce7236597a",
    "files": [
      "ChangeLog",
      "ext/fiddle/handle.c",
      "test/fiddle/test_handle.rb",
      "version.h"
    ],
    "message": "merge revision(s): 53153 and 23405@ruby_1_9_1\n\n\t* ext/fiddle/handle.c: check tainted string arguments.\n\t  Patch provided by tenderlove and nobu.\n\n\t* test/fiddle/test_handle.rb (class TestHandle): add test for above.\n\n\t* ext/dl/handle.c (rb_dlhandle_initialize): prohibits DL::dlopen\n\t  with a tainted name of library.\n\t  Patch by sheepman <sheepman AT sheepman.sakura.ne.jp>.\n\n\t* ext/dl/handle.c (rb_dlhandle_sym): ditto\n\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@53156 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
    "before_after_code_files": [
      "ext/fiddle/handle.c||ext/fiddle/handle.c",
      "test/fiddle/test_handle.rb||test/fiddle/test_handle.rb",
      "version.h||version.h"
    ]
  },
  "patch_diff": {
    "ext/fiddle/handle.c||ext/fiddle/handle.c": [
      "File: ext/fiddle/handle.c -> ext/fiddle/handle.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #include <ruby.h>",
      "2: #include <fiddle.h>",
      "4: VALUE rb_cHandle;",
      "6: struct dl_handle {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "4: #define SafeStringValueCStr(v) (rb_check_safe_obj(rb_string_value(&v)), StringValueCStr(v))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "143:  cflag = RTLD_LAZY | RTLD_GLOBAL;",
      "144:  break;",
      "145:       case 1:",
      "147:  cflag = RTLD_LAZY | RTLD_GLOBAL;",
      "148:  break;",
      "149:       case 2:",
      "151:  cflag = NUM2INT(flag);",
      "152:  break;",
      "153:       default:",
      "",
      "[Removed Lines]",
      "146:  clib = NIL_P(lib) ? NULL : StringValuePtr(lib);",
      "150:  clib = NIL_P(lib) ? NULL : StringValuePtr(lib);",
      "",
      "[Added Lines]",
      "148:  clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);",
      "152:  clib = NIL_P(lib) ? NULL : SafeStringValueCStr(lib);",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "263:     return PTR2NUM(fiddle_handle);",
      "264: }",
      "",
      "[Removed Lines]",
      "266: static VALUE fiddle_handle_sym(void *handle, const char *symbol);",
      "",
      "[Added Lines]",
      "268: static VALUE fiddle_handle_sym(void *handle, VALUE symbol);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "282:  rb_raise(rb_eFiddleError, \"closed handle\");",
      "283:     }",
      "286: }",
      "288: #ifndef RTLD_NEXT",
      "",
      "[Removed Lines]",
      "285:     return fiddle_handle_sym(fiddle_handle->ptr, StringValueCStr(sym));",
      "",
      "[Added Lines]",
      "287:     return fiddle_handle_sym(fiddle_handle->ptr, sym);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "305: static VALUE",
      "306: rb_fiddle_handle_s_sym(VALUE self, VALUE sym)",
      "307: {",
      "309: }",
      "311: static VALUE",
      "313: {",
      "314: #if defined(HAVE_DLERROR)",
      "315:     const char *err;",
      "",
      "[Removed Lines]",
      "308:     return fiddle_handle_sym(RTLD_NEXT, StringValueCStr(sym));",
      "312: fiddle_handle_sym(void *handle, const char *name)",
      "",
      "[Added Lines]",
      "310:     return fiddle_handle_sym(RTLD_NEXT, sym);",
      "314: fiddle_handle_sym(void *handle, VALUE symbol)",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "318: # define CHECK_DLERROR",
      "319: #endif",
      "320:     void (*func)();",
      "322:     rb_secure(2);",
      "323: #ifdef HAVE_DLERROR",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "323:     const char *name = SafeStringValueCStr(symbol);",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "367:     }",
      "368: #endif",
      "369:     if( !func ){",
      "371:     }",
      "373:     return PTR2NUM(func);",
      "",
      "[Removed Lines]",
      "370:  rb_raise(rb_eFiddleError, \"unknown symbol \\\"%s\\\"\", name);",
      "",
      "[Added Lines]",
      "373:  rb_raise(rb_eFiddleError, \"unknown symbol \\\"%\"PRIsVALUE\"\\\"\", symbol);",
      "",
      "---------------"
    ],
    "test/fiddle/test_handle.rb||test/fiddle/test_handle.rb": [
      "File: test/fiddle/test_handle.rb -> test/fiddle/test_handle.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "11:     include Test::Unit::Assertions",
      "13:     def test_to_i",
      "14:       handle = Fiddle::Handle.new(LIBC_SO)",
      "15:       assert_kind_of Integer, handle.to_i",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "13:     def test_safe_handle_open",
      "14:       t = Thread.new do",
      "15:         $SAFE = 1",
      "16:         Fiddle::Handle.new(LIBC_SO.taint)",
      "17:       end",
      "18:       assert_raise(SecurityError) { t.value }",
      "19:     end",
      "21:     def test_safe_function_lookup",
      "22:       t = Thread.new do",
      "23:         h = Fiddle::Handle.new(LIBC_SO)",
      "24:         $SAFE = 1",
      "25:         h[\"qsort\".taint]",
      "26:       end",
      "27:       assert_raise(SecurityError) { t.value }",
      "28:     end",
      "",
      "---------------"
    ],
    "version.h||version.h": [
      "File: version.h -> version.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: #define RUBY_VERSION \"2.1.8\"",
      "2: #define RUBY_RELEASE_DATE \"2015-12-16\"",
      "5: #define RUBY_RELEASE_YEAR 2015",
      "6: #define RUBY_RELEASE_MONTH 12",
      "",
      "[Removed Lines]",
      "3: #define RUBY_PATCHLEVEL 438",
      "",
      "[Added Lines]",
      "3: #define RUBY_PATCHLEVEL 439",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7a03d4637cefadadad31fff5bdd6c20a8e5a00bd",
      "candidate_info": {
        "commit_hash": "7a03d4637cefadadad31fff5bdd6c20a8e5a00bd",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/7a03d4637cefadadad31fff5bdd6c20a8e5a00bd",
        "files": [
          "ChangeLog",
          "range.c",
          "test/ruby/test_range.rb",
          "version.h"
        ],
        "message": "merge revision(s) 50421: [Backport #11113]\n\n\t* range.c (linear_object_p, range_include): test if covered for\n\t  linear objects.  [ruby-core:69052] [Bug #11113]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@50581 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "range.c||range.c",
          "test/ruby/test_range.rb||test/ruby/test_range.rb",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "range.c||range.c": [
          "File: range.c -> range.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "329:     return rb_respond_to(obj, id_succ);",
          "330: }",
          "332: static VALUE",
          "333: range_step_size(VALUE range, VALUE args, VALUE eobj)",
          "334: {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "332: static int",
          "333: linear_object_p(VALUE obj)",
          "334: {",
          "335:     if (FIXNUM_P(obj) || FLONUM_P(obj)) return TRUE;",
          "336:     if (SPECIAL_CONST_P(obj)) return FALSE;",
          "337:     switch (BUILTIN_TYPE(obj)) {",
          "338:       case T_FLOAT:",
          "339:       case T_BIGNUM:",
          "340:  return TRUE;",
          "341:     }",
          "342:     if (rb_obj_is_kind_of(obj, rb_cNumeric)) return TRUE;",
          "343:     if (rb_obj_is_kind_of(obj, rb_cTime)) return TRUE;",
          "344:     return FALSE;",
          "345: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1148:     VALUE beg = RANGE_BEG(range);",
          "1149:     VALUE end = RANGE_END(range);",
          "1150:     int nv = FIXNUM_P(beg) || FIXNUM_P(end) ||",
          "1154:     if (nv ||",
          "1155:  !NIL_P(rb_check_to_integer(beg, \"to_int\")) ||",
          "",
          "[Removed Lines]",
          "1151:       rb_obj_is_kind_of(beg, rb_cNumeric) ||",
          "1152:       rb_obj_is_kind_of(end, rb_cNumeric);",
          "",
          "[Added Lines]",
          "1166:       linear_object_p(beg) || linear_object_p(end);",
          "",
          "---------------"
        ],
        "test/ruby/test_range.rb||test/ruby/test_range.rb": [
          "File: test/ruby/test_range.rb -> test/ruby/test_range.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "278:     assert_not_operator(0..10, :===, 11)",
          "279:   end",
          "281:   def test_include",
          "282:     assert_include(\"a\"..\"z\", \"c\")",
          "283:     assert_not_include(\"a\"..\"z\", \"5\")",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "281:   def test_eqq_time",
          "282:     bug11113 = '[ruby-core:69052] [Bug #11113]'",
          "283:     t = Time.now",
          "284:     assert_nothing_raised(TypeError, bug11113) {",
          "285:       assert_operator(t..(t+10), :===, t+5)",
          "286:     }",
          "287:   end",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.7\"",
          "2: #define RUBY_RELEASE_DATE \"2015-05-21\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 5",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 353",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 354",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7d7ed2c23116b8f2c0bfcd902eaf8a2a15301bb3",
      "candidate_info": {
        "commit_hash": "7d7ed2c23116b8f2c0bfcd902eaf8a2a15301bb3",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/7d7ed2c23116b8f2c0bfcd902eaf8a2a15301bb3",
        "files": [
          "ChangeLog",
          "ext/openssl/ossl_asn1.c",
          "version.h"
        ],
        "message": "merge revision(s) 50646: [Backport #11185]\n\n\t* ext/openssl/ossl_asn1.c (ossl_asn1_traverse, ossl_asn1_decode,\n\t  ossl_asn1_decode_all): use RB_GC_GUARD instead of volatile\n\t  [ruby-core:69371] [Bug #11185]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@50808 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "ext/openssl/ossl_asn1.c||ext/openssl/ossl_asn1.c",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "ext/openssl/ossl_asn1.c||ext/openssl/ossl_asn1.c": [
          "File: ext/openssl/ossl_asn1.c -> ext/openssl/ossl_asn1.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1029: ossl_asn1_traverse(VALUE self, VALUE obj)",
          "1030: {",
          "1031:     unsigned char *p;",
          "1033:     long len, read = 0, offset = 0;",
          "1035:     obj = ossl_to_der_if_possible(obj);",
          "",
          "[Removed Lines]",
          "1032:     volatile VALUE tmp;",
          "",
          "[Added Lines]",
          "1032:     VALUE tmp;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1037:     p = (unsigned char *)RSTRING_PTR(tmp);",
          "1038:     len = RSTRING_LEN(tmp);",
          "1039:     ossl_asn1_decode0(&p, len, &offset, 0, 1, &read);",
          "1040:     int_ossl_decode_sanity_check(len, read, offset);",
          "1041:     return Qnil;",
          "1042: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1040:     RB_GC_GUARD(tmp);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1058: {",
          "1059:     VALUE ret;",
          "1060:     unsigned char *p;",
          "1062:     long len, read = 0, offset = 0;",
          "1064:     obj = ossl_to_der_if_possible(obj);",
          "",
          "[Removed Lines]",
          "1061:     volatile VALUE tmp;",
          "",
          "[Added Lines]",
          "1062:     VALUE tmp;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1066:     p = (unsigned char *)RSTRING_PTR(tmp);",
          "1067:     len = RSTRING_LEN(tmp);",
          "1068:     ret = ossl_asn1_decode0(&p, len, &offset, 0, 0, &read);",
          "1069:     int_ossl_decode_sanity_check(len, read, offset);",
          "1070:     return ret;",
          "1071: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1070:     RB_GC_GUARD(tmp);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1089:     VALUE ary, val;",
          "1090:     unsigned char *p;",
          "1091:     long len, tmp_len = 0, read = 0, offset = 0;",
          "1094:     obj = ossl_to_der_if_possible(obj);",
          "1095:     tmp = rb_str_new4(StringValue(obj));",
          "",
          "[Removed Lines]",
          "1092:     volatile VALUE tmp;",
          "",
          "[Added Lines]",
          "1094:     VALUE tmp;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1104:  read += tmp_read;",
          "1105:  tmp_len -= tmp_read;",
          "1106:     }",
          "1107:     int_ossl_decode_sanity_check(len, read, offset);",
          "1108:     return ary;",
          "1109: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1109:     RB_GC_GUARD(tmp);",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.7\"",
          "2: #define RUBY_RELEASE_DATE \"2015-06-09\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 6",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 364",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 365",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9ee867c44f70452c9871c69d4b6f2328d3d5cc70",
      "candidate_info": {
        "commit_hash": "9ee867c44f70452c9871c69d4b6f2328d3d5cc70",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/9ee867c44f70452c9871c69d4b6f2328d3d5cc70",
        "files": [
          "ChangeLog",
          "spec/default.mspec",
          "version.h"
        ],
        "message": "merge revision(s) r49752,r49753: [Backport #10953]\n\n\t* spec/default.mspec: remove specific version number.\n\t  https://github.com/ruby/rubyspec/commit/7a909e925c1baa9c700bd44af9241aef6e596714\n\n\t* spec/default.mspec: use default configuration file name.\n\t  https://github.com/ruby/rubyspec/commit/cc69f337b06362e5607ffa3e3ad40ef7494960cf\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@49909 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "spec/default.mspec||spec/default.mspec",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "spec/default.mspec||spec/default.mspec": [
          "File: spec/default.mspec -> spec/default.mspec",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: class MSpecScript",
          "3:   builddir = Dir.pwd",
          "4:   srcdir = ENV['SRCDIR']",
          "",
          "[Removed Lines]",
          "1: load File.dirname(__FILE__) + '/rubyspec/ruby.1.9.mspec'",
          "",
          "[Added Lines]",
          "1: load File.dirname(__FILE__) + '/rubyspec/default.mspec'",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.5\"",
          "2: #define RUBY_RELEASE_DATE \"2015-03-09\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 308",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 309",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "32089305127f6bd26bd684c75818df4fcd9c0f9d",
      "candidate_info": {
        "commit_hash": "32089305127f6bd26bd684c75818df4fcd9c0f9d",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/32089305127f6bd26bd684c75818df4fcd9c0f9d",
        "files": [
          "ChangeLog",
          "enc/windows_1250.c",
          "version.h"
        ],
        "message": "merge revision(s) 53202: [Backport #11843]\n\n\t* enc/windows_1250.c: Should not use C++ style comments (C99 feature).\n\t  [Bug #11843]\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@54262 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "enc/windows_1250.c||enc/windows_1250.c",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "enc/windows_1250.c||enc/windows_1250.c": [
          "File: enc/windows_1250.c -> enc/windows_1250.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "86:   0x70e2, 0x70e2, 0x70e2, 0x70e2, 0x70e2, 0x70e2, 0x70e2, 0x70e2,",
          "87:   0x70e2, 0x70e2, 0x70e2, 0x70e2, 0x70e2, 0x70e2, 0x70e2, 0x70e2,",
          "88:   0x70e2, 0x70e2, 0x70e2, 0x41a0, 0x41a0, 0x41a0, 0x41a0, 0x4008,",
          "90:   0x0008, 0x0008, 0x34a2, 0x0008, 0x34a2, 0x34a2, 0x34a2, 0x34a2,",
          "92:   0x0008, 0x0008, 0x30e2, 0x0008, 0x30e2, 0x30e2, 0x30e2, 0x30e2,",
          "94:   0x00a0, 0x00a0, 0x34a2, 0x01a0, 0x00a0, 0x01a0, 0x00a0, 0x34a2,",
          "96:   0x00a0, 0x30e2, 0x30e2, 0x01a0, 0x34a2, 0x10a0, 0x30e2, 0x30e2,",
          "98:   0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2,",
          "100:   0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x30e2,",
          "102:   0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2,",
          "104:   0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2,",
          "105: };",
          "",
          "[Removed Lines]",
          "89:   0x00a0, 0x0000, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008,//8",
          "91:   0x0000, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008, 0x0008,//9",
          "93:   0x0284, 0x01a0, 0x00a0, 0x34a2, 0x00a0, 0x34a2, 0x00a0, 0x00a0,//A",
          "95:   0x00a0, 0x00a0, 0x10a0, 0x30e2, 0x00a0, 0x30e2, 0x00a0, 0x01a0,//B",
          "97:   0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2,//C",
          "99:   0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x34a2, 0x00a0,//D",
          "101:   0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2,//E",
          "103:   0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x30e2, 0x00a0,//F",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.9\"",
          "2: #define RUBY_RELEASE_DATE \"2016-03-25\"",
          "5: #define RUBY_RELEASE_YEAR 2016",
          "6: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 459",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 460",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "cac1786add3304434e5b6ab1b9cfda5df0f8fcd0",
      "candidate_info": {
        "commit_hash": "cac1786add3304434e5b6ab1b9cfda5df0f8fcd0",
        "repo": "ruby/ruby",
        "commit_url": "https://github.com/ruby/ruby/commit/cac1786add3304434e5b6ab1b9cfda5df0f8fcd0",
        "files": [
          "ChangeLog",
          "common.mk",
          "version.h"
        ],
        "message": "merge revision(s) r49689: [Backport #10953]\n\n\t* common.mk: use ruby organization for rubyspec.\n\n\ngit-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_1@49908 b2dd03c8-39d4-4d8f-98ff-823fe69b080e",
        "before_after_code_files": [
          "common.mk||common.mk",
          "version.h||version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "version.h||version.h"
          ],
          "candidate": [
            "version.h||version.h"
          ]
        }
      },
      "candidate_diff": {
        "common.mk||common.mk": [
          "File: common.mk -> common.mk",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: RUBYOPT       = -",
          "15: RUN_OPTS      = --disable-gems",
          "18: MSPEC_GIT_URL = $(SPEC_GIT_BASE)/mspec.git",
          "19: RUBYSPEC_GIT_URL = $(SPEC_GIT_BASE)/rubyspec.git",
          "",
          "[Removed Lines]",
          "17: SPEC_GIT_BASE = git://github.com/nurse",
          "",
          "[Added Lines]",
          "17: SPEC_GIT_BASE = git://github.com/ruby",
          "",
          "---------------"
        ],
        "version.h||version.h": [
          "File: version.h -> version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: #define RUBY_VERSION \"2.1.5\"",
          "2: #define RUBY_RELEASE_DATE \"2015-03-09\"",
          "5: #define RUBY_RELEASE_YEAR 2015",
          "6: #define RUBY_RELEASE_MONTH 3",
          "",
          "[Removed Lines]",
          "3: #define RUBY_PATCHLEVEL 307",
          "",
          "[Added Lines]",
          "3: #define RUBY_PATCHLEVEL 308",
          "",
          "---------------"
        ]
      }
    }
  ]
}