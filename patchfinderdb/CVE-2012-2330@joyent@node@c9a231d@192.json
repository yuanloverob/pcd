{
  "cve_id": "CVE-2012-2330",
  "cve_desc": "The Update method in src/node_http_parser.cc in Node.js before 0.6.17 and 0.7 before 0.7.8 does not properly check the length of a string, which allows remote attackers to obtain sensitive information (request header contents) and possibly spoof HTTP headers via a zero length string.",
  "repo": "joyent/node",
  "patch_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
  "patch_info": {
    "commit_hash": "c9a231db0e59658be419d926b1dfa17b939ba158",
    "repo": "joyent/node",
    "commit_url": "https://github.com/joyent/node/commit/c9a231d",
    "files": [
      "src/node_http_parser.cc"
    ],
    "message": "typo in node_http_parser",
    "before_after_code_files": [
      "src/node_http_parser.cc||src/node_http_parser.cc"
    ]
  },
  "patch_diff": {
    "src/node_http_parser.cc||src/node_http_parser.cc": [
      "File: src/node_http_parser.cc -> src/node_http_parser.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "191:   void Update(const char* str, size_t size) {",
      "192:     if (str_ == NULL)",
      "193:       str_ = str;",
      "197:       char* s = new char[size_ + size];",
      "",
      "[Removed Lines]",
      "194:     else if (on_heap_ || str_ + size != str) {",
      "",
      "[Added Lines]",
      "194:     else if (on_heap_ || str_ + size_ != str) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "3b6a00b664afdc7695ddddefc637b1fbebf94fc6",
      "candidate_info": {
        "commit_hash": "3b6a00b664afdc7695ddddefc637b1fbebf94fc6",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/3b6a00b664afdc7695ddddefc637b1fbebf94fc6",
        "files": [
          "deps/v8/build/common.gypi"
        ],
        "message": "Unbreak the Windows build\n\nThe v8 team apparently decided that all build products should go\ninto ./build/\u00abtype\u00bb, and updated their common.gypi file to do so.\nUnfortunately v8's common.gypi is only used for some targets. All\nthe other targets would still look in the old place to find their\ntheir dependencies, which effectively broke the build.\n\nIn the long run it would be good for node to send all build\noutput to ./build too, on all platforms.",
        "before_after_code_files": [
          "deps/v8/build/common.gypi||deps/v8/build/common.gypi"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "deps/v8/build/common.gypi||deps/v8/build/common.gypi": [
          "File: deps/v8/build/common.gypi -> deps/v8/build/common.gypi",
          "--- Hunk 1 ---",
          "[Context before]",
          "239:           'WIN32',",
          "240:         ],",
          "241:         'msvs_configuration_attributes': {",
          "243:           'IntermediateDirectory': '$(OutDir)\\\\obj\\\\$(ProjectName)',",
          "244:           'CharacterSet': '1',",
          "245:         },",
          "",
          "[Removed Lines]",
          "242:           'OutputDirectory': '<(DEPTH)\\\\build\\\\$(ConfigurationName)',",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f1f5de1c8d289766ee1628a06cb7dbab440e12f8",
      "candidate_info": {
        "commit_hash": "f1f5de1c8d289766ee1628a06cb7dbab440e12f8",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/f1f5de1c8d289766ee1628a06cb7dbab440e12f8",
        "files": [
          "lib/tty.js"
        ],
        "message": "tty: throw an Error when getWindowSize() fails",
        "before_after_code_files": [
          "lib/tty.js||litty.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/tty.js||litty.js": [
          "File: lib/tty.js -> litty.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "84:   this.writable = true;",
          "86:   var winSize = this._handle.getWindowSize();",
          "89: }",
          "90: inherits(WriteStream, net.Socket);",
          "91: exports.WriteStream = WriteStream;",
          "",
          "[Removed Lines]",
          "87:   this.columns = winSize[0];",
          "88:   this.rows = winSize[1];",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "98:   var oldCols = this.columns;",
          "99:   var oldRows = this.rows;",
          "100:   var winSize = this._handle.getWindowSize();",
          "101:   var newCols = winSize[0];",
          "102:   var newRows = winSize[1];",
          "103:   if (oldCols !== newCols || oldRows !== newRows) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124: WriteStream.prototype.getWindowSize = function() {",
          "125:   return [this.columns, this.rows];",
          "126: };",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "659d449460d84c40fc5b3bf0e23575378d72d312",
      "candidate_info": {
        "commit_hash": "659d449460d84c40fc5b3bf0e23575378d72d312",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/659d449460d84c40fc5b3bf0e23575378d72d312",
        "files": [
          "lib/repl.js"
        ],
        "message": "repl: make REPLServer emit an \"exit\" event\n\nThis can happen when \"SIGINT\" is processed by the readline interface,\nor when the user types \".exit\" into the REPL.",
        "before_after_code_files": [
          "lib/repl.js||lirepl.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "lib/repl.js||lirepl.js": [
          "File: lib/repl.js -> lirepl.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "140:   rli.on('SIGINT', function() {",
          "141:     if (sawSIGINT) {",
          "142:       rli.pause();",
          "144:     }",
          "146:     rli.line = '';",
          "",
          "[Removed Lines]",
          "143:       process.exit();",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "766:     help: 'Exit the repl',",
          "767:     action: function() {",
          "768:       this.rli.pause();",
          "769:     }",
          "770:   });",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ec1d1ee61fa90471e1f9f1f89a4582ffc32424a0",
      "candidate_info": {
        "commit_hash": "ec1d1ee61fa90471e1f9f1f89a4582ffc32424a0",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/ec1d1ee61fa90471e1f9f1f89a4582ffc32424a0",
        "files": [
          "src/node_version.h"
        ],
        "message": "Now working on 0.6.9",
        "before_after_code_files": [
          "src/node_version.h||src/node_version.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/node_version.h||src/node_version.h": [
          "File: src/node_version.h -> src/node_version.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #define NODE_MAJOR_VERSION 0",
          "30: #define NODE_MINOR_VERSION 6",
          "34: #ifndef NODE_STRINGIFY",
          "35: #define NODE_STRINGIFY(n) NODE_STRINGIFY_HELPER(n)",
          "",
          "[Removed Lines]",
          "31: #define NODE_PATCH_VERSION 8",
          "32: #define NODE_VERSION_IS_RELEASE 1",
          "",
          "[Added Lines]",
          "31: #define NODE_PATCH_VERSION 9",
          "32: #define NODE_VERSION_IS_RELEASE 0",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7a4dfb6aa8544805a638bf59d07648b1b6ce8142",
      "candidate_info": {
        "commit_hash": "7a4dfb6aa8544805a638bf59d07648b1b6ce8142",
        "repo": "joyent/node",
        "commit_url": "https://github.com/joyent/node/commit/7a4dfb6aa8544805a638bf59d07648b1b6ce8142",
        "files": [
          "test/simple/test-cluster-worker-kill.js"
        ],
        "message": "test-cluster-worker-kill: use SIGKILL instead of SIGHUP\n\nIn this test sending SIGKILL has the same effect as sending SIGHUP,\nbut SIGKILL has the advantage that it works on Windows too.",
        "before_after_code_files": [
          "test/simple/test-cluster-worker-kill.js||test/simple/test-cluster-worker-kill.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/roamm/node/pull/1",
          "https://github.com/kingzone/node/pull/1",
          "https://github.com/OpenFPGAduino/node/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "test/simple/test-cluster-worker-kill.js||test/simple/test-cluster-worker-kill.js": [
          "File: test/simple/test-cluster-worker-kill.js -> test/simple/test-cluster-worker-kill.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "41: } else if (cluster.isMaster) {",
          "44:     expected_results = {",
          "45:       cluster_emitDisconnect: [1, \"the cluster did not emit 'disconnect'\"],",
          "46:       cluster_emitExit: [1, \"the cluster did not emit 'exit'\"],",
          "",
          "[Removed Lines]",
          "43:   var KILL_SIGNAL = 'SIGHUP',",
          "",
          "[Added Lines]",
          "43:   var KILL_SIGNAL = 'SIGKILL',",
          "",
          "---------------"
        ]
      }
    }
  ]
}