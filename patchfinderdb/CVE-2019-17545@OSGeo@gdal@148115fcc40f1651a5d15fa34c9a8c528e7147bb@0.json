{
  "cve_id": "CVE-2019-17545",
  "cve_desc": "GDAL through 3.0.1 has a poolDestroy double free in OGRExpatRealloc in ogr/ogr_expat.cpp when the 10MB threshold is exceeded.",
  "repo": "OSGeo/gdal",
  "patch_hash": "148115fcc40f1651a5d15fa34c9a8c528e7147bb",
  "patch_info": {
    "commit_hash": "148115fcc40f1651a5d15fa34c9a8c528e7147bb",
    "repo": "OSGeo/gdal",
    "commit_url": "https://github.com/OSGeo/gdal/commit/148115fcc40f1651a5d15fa34c9a8c528e7147bb",
    "files": [
      "gdal/ogr/ogr_expat.cpp"
    ],
    "message": "OGRExpatRealloc(): fix double-free when size to allocate is above the default 10MB threshold. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16178. Credit to OSS Fuzz",
    "before_after_code_files": [
      "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp"
    ]
  },
  "patch_diff": {
    "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp": [
      "File: gdal/ogr/ogr_expat.cpp -> gdal/ogr/ogr_expat.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "89:     if( CanAlloc(size) )",
      "90:         return realloc(ptr, size);",
      "93:     return nullptr;",
      "94: }",
      "",
      "[Removed Lines]",
      "92:     free(ptr);",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8cd2d2eb6327cf782a74dae263ffa6f89f46c93d",
      "candidate_info": {
        "commit_hash": "8cd2d2eb6327cf782a74dae263ffa6f89f46c93d",
        "repo": "OSGeo/gdal",
        "commit_url": "https://github.com/OSGeo/gdal/commit/8cd2d2eb6327cf782a74dae263ffa6f89f46c93d",
        "files": [
          "gdal/ogr/ogr_expat.cpp"
        ],
        "message": "OGRExpatRealloc(): fix double-free when size to allocate is above the default 10MB threshold. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16178. Credit to OSS Fuzz",
        "before_after_code_files": [
          "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp"
          ],
          "candidate": [
            "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp"
          ]
        }
      },
      "candidate_diff": {
        "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp": [
          "File: gdal/ogr/ogr_expat.cpp -> gdal/ogr/ogr_expat.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "73:     CPLError(CE_Failure, CPLE_OutOfMemory,",
          "74:              \"Expat tried to realloc %d bytes. File probably corrupted\",",
          "75:              static_cast<int>(size));",
          "77:     return nullptr;",
          "78: }",
          "",
          "[Removed Lines]",
          "76:     free(ptr);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ddb98717c6ef6a73aaa65601daf4f5baf874025a",
      "candidate_info": {
        "commit_hash": "ddb98717c6ef6a73aaa65601daf4f5baf874025a",
        "repo": "OSGeo/gdal",
        "commit_url": "https://github.com/OSGeo/gdal/commit/ddb98717c6ef6a73aaa65601daf4f5baf874025a",
        "files": [
          "gdal/ogr/ogr_expat.cpp"
        ],
        "message": "OGRExpatRealloc(): fix double-free when size to allocate is above the default 10MB threshold. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16178. Credit to OSS Fuzz",
        "before_after_code_files": [
          "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp"
          ],
          "candidate": [
            "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp"
          ]
        }
      },
      "candidate_diff": {
        "gdal/ogr/ogr_expat.cpp||gdal/ogr/ogr_expat.cpp": [
          "File: gdal/ogr/ogr_expat.cpp -> gdal/ogr/ogr_expat.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "89:     if( CanAlloc(size) )",
          "90:         return realloc(ptr, size);",
          "93:     return nullptr;",
          "94: }",
          "",
          "[Removed Lines]",
          "92:     free(ptr);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}