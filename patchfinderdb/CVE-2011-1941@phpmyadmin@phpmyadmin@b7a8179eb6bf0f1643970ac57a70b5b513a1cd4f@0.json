{
  "cve_id": "CVE-2011-1941",
  "cve_desc": "Open redirect vulnerability in the redirector feature in phpMyAdmin 3.4.x before 3.4.1 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via unspecified vectors.",
  "repo": "phpmyadmin/phpmyadmin",
  "patch_hash": "b7a8179eb6bf0f1643970ac57a70b5b513a1cd4f",
  "patch_info": {
    "commit_hash": "b7a8179eb6bf0f1643970ac57a70b5b513a1cd4f",
    "repo": "phpmyadmin/phpmyadmin",
    "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/b7a8179eb6bf0f1643970ac57a70b5b513a1cd4f",
    "files": [
      "libraries/core.lib.php"
    ],
    "message": "Can not use redirector for setup.\n\nWe currently have no reasonable way to protect it there.",
    "before_after_code_files": [
      "libraries/core.lib.php||libraries/core.lib.php"
    ]
  },
  "patch_diff": {
    "libraries/core.lib.php||libraries/core.lib.php": [
      "File: libraries/core.lib.php -> libraries/core.lib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "683: function PMA_linkURL($url) {",
      "688:         return $url;",
      "691:     } else {",
      "693:     }",
      "694: }",
      "",
      "[Removed Lines]",
      "684:     $params = array();",
      "685:     $params['url'] = $url;",
      "686:     $goto = 'url.php' . PMA_generate_common_url($params);",
      "687:     if (!preg_match('#^https?://#', $url)) {",
      "689:     } elseif (defined('PMA_SETUP')) {",
      "690:         return '../' . $goto;",
      "692:         return './' . $goto;",
      "",
      "[Added Lines]",
      "684:     if (!preg_match('#^https?://#', $url) || defined('PMA_SETUP')) {",
      "687:         $params = array();",
      "688:         $params['url'] = $url;",
      "689:         return './url.php' . PMA_generate_common_url($params);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ecfc8ba4f7b4ea612c58ab5726054ed0f28e200d",
      "candidate_info": {
        "commit_hash": "ecfc8ba4f7b4ea612c58ab5726054ed0f28e200d",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/ecfc8ba4f7b4ea612c58ab5726054ed0f28e200d",
        "files": [
          "libraries/common.inc.php",
          "libraries/core.lib.php",
          "url.php"
        ],
        "message": "Make redirector require valid token",
        "before_after_code_files": [
          "libraries/common.inc.php||libraries/common.inc.php",
          "libraries/core.lib.php||libraries/core.lib.php",
          "url.php||url.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "libraries/core.lib.php||libraries/core.lib.php"
          ],
          "candidate": [
            "libraries/core.lib.php||libraries/core.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/common.inc.php||libraries/common.inc.php": [
          "File: libraries/common.inc.php -> libraries/common.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "477:         'media_type', 'custom_type', 'bs_reference',",
          "479:         'bs_db', 'bs_table', 'bs_ref', 'bs_new_mime_type',",
          "482:     );",
          "",
          "[Removed Lines]",
          "481:         'url'",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "libraries/core.lib.php||libraries/core.lib.php": [
          "File: libraries/core.lib.php -> libraries/core.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "683: function PMA_linkURL($url) {",
          "684:     if (!preg_match('#^https?://#', $url)) {",
          "685:         return $url;",
          "686:     } elseif (defined('PMA_SETUP')) {",
          "688:     } else {",
          "690:     }",
          "691: }",
          "",
          "[Removed Lines]",
          "687:         return '../url.php?url=' . $url;",
          "689:         return './url.php?url=' . $url;",
          "",
          "[Added Lines]",
          "684:     $params = array();",
          "685:     $params['url'] = $url;",
          "686:     $goto = 'url.php' . PMA_generate_common_url($params);",
          "690:         return '../' . $goto;",
          "692:         return './' . $goto;",
          "",
          "---------------"
        ],
        "url.php||url.php": [
          "File: url.php -> url.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: require_once './libraries/common.inc.php';",
          "14:     header('Location: ' . $cfg['PmaAbsoluteUri']);",
          "15: } else {",
          "17: }",
          "18: ?>",
          "",
          "[Removed Lines]",
          "6: define('PMA_MINIMUM_COMMON', TRUE);",
          "13: if (empty($GLOBALS['url']) || ! preg_match('/^https?:\\/\\/[^\\n\\r]*$/', $GLOBALS['url'])) {",
          "16:     header('Location: ' . $GLOBALS['url']);",
          "",
          "[Added Lines]",
          "11: if (! PMA_isValid($_GET['url']) || ! preg_match('/^https?:\\/\\/[^\\n\\r]*$/', $_GET['url'])) {",
          "14:     header('Location: ' . $_GET['url']);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1208ed935f5ca51bf26ecac547a7de56a9089c07",
      "candidate_info": {
        "commit_hash": "1208ed935f5ca51bf26ecac547a7de56a9089c07",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/1208ed935f5ca51bf26ecac547a7de56a9089c07",
        "files": [
          "libraries/core.lib.php",
          "libraries/header_scripts.inc.php"
        ],
        "message": "Factor out code for generating JS inclusion.",
        "before_after_code_files": [
          "libraries/core.lib.php||libraries/core.lib.php",
          "libraries/header_scripts.inc.php||libraries/header_scripts.inc.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "libraries/core.lib.php||libraries/core.lib.php"
          ],
          "candidate": [
            "libraries/core.lib.php||libraries/core.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/core.lib.php||libraries/core.lib.php": [
          "File: libraries/core.lib.php -> libraries/core.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "673:         return './url.php?url=' . $url;",
          "674:     }",
          "675: }",
          "676: ?>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "684: function PMA_includeJS($url) {",
          "685:     if (strpos($js_script_file, '?') === FALSE) {",
          "686:         return '<script src=\"./js/' . $js_script_file . '?ts=' . filemtime('./js/' . $js_script_file) . '\" type=\"text/javascript\"></script>' . \"\\n\";",
          "687:     } else {",
          "688:         return '<script src=\"./js/' . $js_script_file . '\" type=\"text/javascript\"></script>' . \"\\n\";",
          "689:     }",
          "690: }",
          "",
          "---------------"
        ],
        "libraries/header_scripts.inc.php||libraries/header_scripts.inc.php": [
          "File: libraries/header_scripts.inc.php -> libraries/header_scripts.inc.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: $GLOBALS['js_include'] = array_unique($GLOBALS['js_include']);",
          "49: foreach ($GLOBALS['js_include'] as $js_script_file) {",
          "55: }",
          "56: ?>",
          "57: <script type=\"text/javascript\">",
          "",
          "[Removed Lines]",
          "50:     if (strpos($js_script_file, '?') === FALSE) {",
          "51:         echo '<script src=\"./js/' . $js_script_file . '?ts=' . filemtime('./js/' . $js_script_file) . '\" type=\"text/javascript\"></script>' . \"\\n\";",
          "52:     } else {",
          "53:         echo '<script src=\"./js/' . $js_script_file . '\" type=\"text/javascript\"></script>' . \"\\n\";",
          "54:     }",
          "",
          "[Added Lines]",
          "50:     echo PMA_includeJS($js_script_file);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "67e4994490749dbd065805b2f345176a3becf9e7",
      "candidate_info": {
        "commit_hash": "67e4994490749dbd065805b2f345176a3becf9e7",
        "repo": "phpmyadmin/phpmyadmin",
        "commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/67e4994490749dbd065805b2f345176a3becf9e7",
        "files": [
          "libraries/auth/cookie.auth.lib.php",
          "libraries/auth/swekey/swekey.auth.lib.php",
          "libraries/blobstreaming.lib.php",
          "libraries/common.lib.php",
          "libraries/config/FormDisplay.class.php",
          "libraries/config/config_functions.lib.php",
          "libraries/core.lib.php",
          "libraries/display_export.lib.php",
          "libraries/engines/pbms.lib.php",
          "libraries/engines/pbxt.lib.php",
          "libraries/sanitizing.lib.php",
          "main.php",
          "themes.php"
        ],
        "message": "Single place to handle redirection.",
        "before_after_code_files": [
          "libraries/auth/cookie.auth.lib.php||libraries/auth/cookie.auth.lib.php",
          "libraries/auth/swekey/swekey.auth.lib.php||libraries/auth/swekey/swekey.auth.lib.php",
          "libraries/blobstreaming.lib.php||libraries/blobstreaming.lib.php",
          "libraries/common.lib.php||libraries/common.lib.php",
          "libraries/config/FormDisplay.class.php||libraries/config/FormDisplay.class.php",
          "libraries/config/config_functions.lib.php||libraries/config/config_functions.lib.php",
          "libraries/core.lib.php||libraries/core.lib.php",
          "libraries/display_export.lib.php||libraries/display_export.lib.php",
          "libraries/engines/pbms.lib.php||libraries/engines/pbms.lib.php",
          "libraries/engines/pbxt.lib.php||libraries/engines/pbxt.lib.php",
          "libraries/sanitizing.lib.php||libraries/sanitizing.lib.php",
          "main.php||main.php",
          "themes.php||themes.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "libraries/core.lib.php||libraries/core.lib.php"
          ],
          "candidate": [
            "libraries/core.lib.php||libraries/core.lib.php"
          ]
        }
      },
      "candidate_diff": {
        "libraries/auth/cookie.auth.lib.php||libraries/auth/cookie.auth.lib.php": [
          "File: libraries/auth/cookie.auth.lib.php -> libraries/auth/cookie.auth.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "192:     ?>",
          "194: <div class=\"container\">",
          "196:     $logo_image = $GLOBALS['pmaThemeImage'] . 'logo_right.png';",
          "197:     if (@file_exists($logo_image)) {",
          "198:         echo '<img src=\"' . $logo_image . '\" id=\"imLogo\" name=\"imLogo\" alt=\"phpMyAdmin\" border=\"0\" />';",
          "",
          "[Removed Lines]",
          "195: <a href=\"./url.php?url=http://www.phpmyadmin.net\" target=\"_blank\" class=\"logo\"><?php",
          "",
          "[Added Lines]",
          "195: <a href=\"<?php echo PMA_linkURL('http://www.phpmyadmin.net/'); ?>\" target=\"_blank\" class=\"logo\"><?php",
          "",
          "---------------"
        ],
        "libraries/auth/swekey/swekey.auth.lib.php||libraries/auth/swekey/swekey.auth.lib.php": [
          "File: libraries/auth/swekey/swekey.auth.lib.php -> libraries/auth/swekey/swekey.auth.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "231:         ?>",
          "232:             function open_swekey_site()",
          "233:             {",
          "235:             }",
          "237:             var input_username = document.getElementById(\"<?php echo $input_name; ?>\");",
          "",
          "[Removed Lines]",
          "234:                 window.open(\"./url.php?url=http://phpmyadmin.net/auth_key\");",
          "",
          "[Added Lines]",
          "234:                 window.open(\"<?php echo PMA_linkURL('http://phpmyadmin.net/auth_key'); ?>\");",
          "",
          "---------------"
        ],
        "libraries/blobstreaming.lib.php||libraries/blobstreaming.lib.php": [
          "File: libraries/blobstreaming.lib.php -> libraries/blobstreaming.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "497:         return FALSE;",
          "498:     }",
          "501:     return $bs_url;",
          "502: }",
          "",
          "[Removed Lines]",
          "500:     $bs_url = './url.php?url=http://' . $bs_server . '/' . rtrim($reference);",
          "",
          "[Added Lines]",
          "500:     $bs_url = PMA_linkURL('http://' . $bs_server . '/' . rtrim($reference));",
          "",
          "---------------"
        ],
        "libraries/common.lib.php||libraries/common.lib.php": [
          "File: libraries/common.lib.php -> libraries/common.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "419:     }",
          "421:     if ($just_open) {",
          "423:     } elseif ($big_icon) {",
          "425:     } elseif ($GLOBALS['cfg']['ReplaceHelpImg']) {",
          "427:     } else {",
          "429:     }",
          "430: } // end of the 'PMA_showMySQLDocu()' function",
          "",
          "[Removed Lines]",
          "422:         return '<a href=\"./url.php?url=' . $url . '\" target=\"mysql_doc\">';",
          "424:         return '<a href=\"./url.php?url=' . $url . '\" target=\"mysql_doc\"><img class=\"icon\" src=\"' . $GLOBALS['pmaThemeImage'] . 'b_sqlhelp.png\" width=\"16\" height=\"16\" alt=\"' . __('Documentation') . '\" title=\"' . __('Documentation') . '\" /></a>';",
          "426:         return '<a href=\"./url.php?url=' . $url . '\" target=\"mysql_doc\"><img class=\"icon\" src=\"' . $GLOBALS['pmaThemeImage'] . 'b_help.png\" width=\"11\" height=\"11\" alt=\"' . __('Documentation') . '\" title=\"' . __('Documentation') . '\" /></a>';",
          "428:         return '[<a href=\"./url.php?url=' . $url . '\" target=\"mysql_doc\">' . __('Documentation') . '</a>]';",
          "",
          "[Added Lines]",
          "422:         return '<a href=\"' . PMA_linkURL($url) . '\" target=\"mysql_doc\">';",
          "424:         return '<a href=\"' . PMA_linkURL($url) . '\" target=\"mysql_doc\"><img class=\"icon\" src=\"' . $GLOBALS['pmaThemeImage'] . 'b_sqlhelp.png\" width=\"16\" height=\"16\" alt=\"' . __('Documentation') . '\" title=\"' . __('Documentation') . '\" /></a>';",
          "426:         return '<a href=\"' . PMA_linkURL($url) . '\" target=\"mysql_doc\"><img class=\"icon\" src=\"' . $GLOBALS['pmaThemeImage'] . 'b_help.png\" width=\"11\" height=\"11\" alt=\"' . __('Documentation') . '\" title=\"' . __('Documentation') . '\" /></a>';",
          "428:         return '[<a href=\"' . PMA_linkURL($url) . '\" target=\"mysql_doc\">' . __('Documentation') . '</a>]';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2425: function PMA_externalBug($functionality, $component, $minimum_version, $bugref)",
          "2426: {",
          "2427:     if ($component == 'mysql' && PMA_MYSQL_INT_VERSION < $minimum_version) {",
          "2429:     }",
          "2430: }",
          "",
          "[Removed Lines]",
          "2428:         echo PMA_showHint(sprintf(__('The %s functionality is affected by a known bug, see %s'), $functionality, './url.php?url=http://bugs.mysql.com/' . $bugref));",
          "",
          "[Added Lines]",
          "2428:         echo PMA_showHint(sprintf(__('The %s functionality is affected by a known bug, see %s'), $functionality, PMA_linkURL('http://bugs.mysql.com/') . $bugref));",
          "",
          "---------------"
        ],
        "libraries/config/FormDisplay.class.php||libraries/config/FormDisplay.class.php": [
          "File: libraries/config/FormDisplay.class.php -> libraries/config/FormDisplay.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "681:         if ($test == 'Export') {",
          "682:             $opt_name = substr($opt_name, 7);",
          "683:         }",
          "685:     }",
          "",
          "[Removed Lines]",
          "684:         return './url.php?url=http://wiki.phpmyadmin.net/pma/Config#' . $opt_name;",
          "",
          "[Added Lines]",
          "684:         return PMA_linkURL('http://wiki.phpmyadmin.net/pma/Config#' . $opt_name);",
          "",
          "---------------"
        ],
        "libraries/config/config_functions.lib.php||libraries/config/config_functions.lib.php": [
          "File: libraries/config/config_functions.lib.php -> libraries/config/config_functions.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "94:     if (!preg_match('#^https?://#', $link)) {",
          "95:         $link = str_replace('&amp;', $separator, $link);",
          "98:     } else {",
          "100:     }",
          "102:     return '<a href=\"' . $link . '\">' . $text . '</a>';",
          "",
          "[Removed Lines]",
          "96:     } elseif (defined('PMA_SETUP')) {",
          "97:         $link = '../url.php?url=' . $link;",
          "99:         $link = './url.php?url=' . $link;",
          "",
          "[Added Lines]",
          "97:         $link = PMA_linkURL($link);",
          "",
          "---------------"
        ],
        "libraries/core.lib.php||libraries/core.lib.php": [
          "File: libraries/core.lib.php -> libraries/core.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "656:         }",
          "657:     }",
          "658: }",
          "659: ?>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "667: function PMA_linkURL($url) {",
          "668:     if (!preg_match('#^https?://#', $url)) {",
          "669:         return $url;",
          "670:     } elseif (defined('PMA_SETUP')) {",
          "671:         return '../url.php?url=' . $url;",
          "672:     } else {",
          "673:         return './url.php?url=' . $url;",
          "674:     }",
          "675: }",
          "",
          "---------------"
        ],
        "libraries/display_export.lib.php||libraries/display_export.lib.php": [
          "File: libraries/display_export.lib.php -> libraries/display_export.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "235:                     }",
          "237:                     $message = new PMA_Message(__('This value is interpreted using %1$sstrftime%2$s, so you can use time formatting strings. Additionally the following transformations will happen: %3$s. Other text will be kept as is. See the %4$sFAQ%5$s for details.'));",
          "239:                         . __('Documentation') . '\">', false);",
          "240:                     $message->addParam('</a>', false);",
          "241:                     $message->addParam($trans);",
          "",
          "[Removed Lines]",
          "238:                     $message->addParam('<a href=\"./url.php?url=http://php.net/strftime\" target=\"documentation\" title=\"'",
          "",
          "[Added Lines]",
          "238:                     $message->addParam('<a href=\"' . PMA_linkURL('http://php.net/strftime') . '\" target=\"documentation\" title=\"'",
          "",
          "---------------"
        ],
        "libraries/engines/pbms.lib.php||libraries/engines/pbms.lib.php": [
          "File: libraries/engines/pbms.lib.php -> libraries/engines/pbms.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "91:     function getPageDocumentation()",
          "92:     {",
          "93:         $output = '<p> Documentation and further information about PBMS can be found on '  . \"\\n\"",
          "95:         . '<table id=\"PBMS_Related_Links\" >' . \"\\n\"",
          "96:                 . '<tr>' . \"\\n\"",
          "97:         . '<td>' . \"\\n\"",
          "98:         . '<p>' . \"\\n\"",
          "99:         . '<strong><font size=\"2\"><b>Related Links</b></font></strong>' . \"\\n\"",
          "100:         . '<br>' . \"\\n\"",
          "103:         . '</font>' . \"\\n\"",
          "104:         . '</td>' . \"\\n\"",
          "105:         . '</tr>' . \"\\n\"",
          "",
          "[Removed Lines]",
          "94:         . '<a href=\"./url.php?url=http://www.blobstreaming.org/\" target=\"_blank\">The PrimeBase Media Streaming home page</a>.<br><br>' . \"\\n\"",
          "101:         . '<a href=\"./url.php?url=http://bpbdev.blogspot.com/\" target=\"_blank\">The PrimeBase Media Streaming Blog by Barry Leslie</a><br><br>' . \"\\n\"",
          "102:         . '<a href=\"./url.php?url=http://www.primebase.com/xt\" target=\"_blank\">PrimeBase XT Home Page</a><br><br>' . \"\\n\"",
          "",
          "[Added Lines]",
          "94:         . '<a href=\"' . PMA_linkURL('http://www.blobstreaming.org/') . '\" target=\"_blank\">The PrimeBase Media Streaming home page</a>.<br><br>' . \"\\n\"",
          "101:         . '<a href=\"' . PMA_linkURL('http://bpbdev.blogspot.com/') . '\" target=\"_blank\">The PrimeBase Media Streaming Blog by Barry Leslie</a><br><br>' . \"\\n\"",
          "102:         . '<a href=\"' . PMA_linkURL('http://www.primebase.com/xt') . '\" target=\"_blank\">PrimeBase XT Home Page</a><br><br>' . \"\\n\"",
          "",
          "---------------"
        ],
        "libraries/engines/pbxt.lib.php||libraries/engines/pbxt.lib.php": [
          "File: libraries/engines/pbxt.lib.php -> libraries/engines/pbxt.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "122:     function getPageDocumentation()",
          "123:     {",
          "124:         $output = '<p> Documentation and further information about PBXT can be found on the '  . \"\\n\"",
          "126:         . '<table id=\"PBMS_Related_Links\" >' . \"\\n\"",
          "127:         . '<tr>' . \"\\n\"",
          "128:         . '<td>' . \"\\n\"",
          "129:         . '<p>' . \"\\n\"",
          "130:         . '<strong><font size=\"2\"><b>Related Links</b></font></strong>' . \"\\n\"",
          "131:         . '<br>' . \"\\n\"",
          "134:         . '</font>' . \"\\n\"",
          "135:         . '</td>' . \"\\n\"",
          "136:         . '</tr>' . \"\\n\"",
          "",
          "[Removed Lines]",
          "125:         . '<a href=\"./url.php?url=http://www.primebase.com/xt/\" target=\"_blank\">PrimeBase XT Home Page</a>.<br><br>' . \"\\n\"",
          "132:         . '<a href=\"./url.php?url=http://pbxt.blogspot.com/\" target=\"_blank\">The PrimeBase XT Blog by Paul McCullagh</a><br><br>' . \"\\n\"",
          "133:         . '<a href=\"./url.php?url=http://www.blobstreaming.org/\" target=\"_blank\">The PrimeBase Media Streaming (PBMS) home page</a>.<br><br>' . \"\\n\"",
          "",
          "[Added Lines]",
          "125:         . '<a href=\"' . PMA_linkURL('http://www.primebase.com/xt/') . '\" target=\"_blank\">PrimeBase XT Home Page</a>.<br><br>' . \"\\n\"",
          "132:         . '<a href=\"' . PMA_linkURL('http://pbxt.blogspot.com/') . '\" target=\"_blank\">The PrimeBase XT Blog by Paul McCullagh</a><br><br>' . \"\\n\"",
          "133:         . '<a href=\"' . PMA_linkURL('http://www.blobstreaming.org/') . '\" target=\"_blank\">The PrimeBase Media Streaming (PBMS) home page</a>.<br><br>' . \"\\n\"",
          "",
          "---------------"
        ],
        "libraries/sanitizing.lib.php||libraries/sanitizing.lib.php": [
          "File: libraries/sanitizing.lib.php -> libraries/sanitizing.lib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "74:         }",
          "76:         if (substr($found[1], 0, 4) == 'http') {",
          "78:         } else {",
          "79:             $message = preg_replace($pattern, '<a href=\"\\1\" target=\"\\2\">', $message);",
          "80:         }",
          "",
          "[Removed Lines]",
          "77:             $message = preg_replace($pattern, '<a href=\"./url.php?url=\\1\" target=\"\\2\">', $message);",
          "",
          "[Added Lines]",
          "77:             $message = preg_replace($pattern, '<a href=\"' . PMA_linkURL($found[1]) . '\" target=\"\\2\">', $message);",
          "",
          "---------------"
        ],
        "main.php||main.php": [
          "File: main.php -> main.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "210: echo '<ul>';",
          "211: PMA_printListItem(__('Version information') . ': ' . PMA_VERSION, 'li_pma_version');",
          "212: PMA_printListItem(__('Documentation'), 'li_pma_docs', 'Documentation.html', null, '_blank');",
          "217: ?>",
          "218:     <li><bdo xml:lang=\"en\" dir=\"ltr\">",
          "219:         [<a href=\"changelog.php\" target=\"_blank\">ChangeLog</a>]",
          "221:             target=\"_blank\">Git</a>]",
          "223:             target=\"_blank\"><?php echo __('Mailing lists'); ?></a>]",
          "224:         </bdo>",
          "225:     </li>",
          "",
          "[Removed Lines]",
          "213: PMA_printListItem(__('Wiki'), 'li_pma_wiki', './url.php?url=http://wiki.phpmyadmin.net', null, '_blank');",
          "216: PMA_printListItem(__('Official Homepage'), 'li_pma_homepage', './url.php?url=http://www.phpMyAdmin.net/', null, '_blank');",
          "220:         [<a href=\"./url.php?url=http://phpmyadmin.git.sourceforge.net/git/gitweb-index.cgi\"",
          "222:         [<a href=\"./url.php?url=http://sourceforge.net/mail/?group_id=23067\"",
          "",
          "[Added Lines]",
          "213: PMA_printListItem(__('Wiki'), 'li_pma_wiki', PMA_linkURL('http://wiki.phpmyadmin.net/'), null, '_blank');",
          "216: PMA_printListItem(__('Official Homepage'), 'li_pma_homepage', PMA_linkURL('http://www.phpMyAdmin.net/'), null, '_blank');",
          "220:         [<a href=\"<?php echo PMA_linkURL('http://phpmyadmin.git.sourceforge.net/git/gitweb-index.cgi'); ?>\"",
          "222:         [<a href=\"<?php echo PMA_linkURL('http://sourceforge.net/mail/?group_id=23067'); ?>\"",
          "",
          "---------------"
        ],
        "themes.php||themes.php": [
          "File: themes.php -> themes.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "39: <body id=\"bodythemes\">",
          "40: <h1>phpMyAdmin - <?php echo __('Theme / Style'); ?></h1>",
          "42: <?php",
          "43: $_SESSION['PMA_Theme_Manager']->printPreviews();",
          "44: ?>",
          "",
          "[Removed Lines]",
          "41: <p><a href=\"./url.php?url=http://www.phpmyadmin.net/home_page/themes.php#pma_<?php echo preg_replace('/([0-9]*)\\.([0-9]*)\\..*/', '\\1_\\2', PMA_VERSION); ?>\"><?php echo __('Get more themes!'); ?></a></p>",
          "",
          "[Added Lines]",
          "41: <p><a href=\"<?php echo PMA_linkURL('http://www.phpmyadmin.net/home_page/themes.php'); ?>#pma_<?php echo preg_replace('/([0-9]*)\\.([0-9]*)\\..*/', '\\1_\\2', PMA_VERSION); ?>\"><?php echo __('Get more themes!'); ?></a></p>",
          "",
          "---------------"
        ]
      }
    }
  ]
}