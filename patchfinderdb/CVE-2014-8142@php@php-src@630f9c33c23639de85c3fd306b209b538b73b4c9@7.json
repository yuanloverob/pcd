{
  "cve_id": "CVE-2014-8142",
  "cve_desc": "Use-after-free vulnerability in the process_nested_data function in ext/standard/var_unserializer.re in PHP before 5.4.36, 5.5.x before 5.5.20, and 5.6.x before 5.6.4 allows remote attackers to execute arbitrary code via a crafted unserialize call that leverages improper handling of duplicate keys within the serialized properties of an object, a different vulnerability than CVE-2004-1019.",
  "repo": "php/php-src",
  "patch_hash": "630f9c33c23639de85c3fd306b209b538b73b4c9",
  "patch_info": {
    "commit_hash": "630f9c33c23639de85c3fd306b209b538b73b4c9",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/630f9c33c23639de85c3fd306b209b538b73b4c9",
    "files": [
      "NEWS",
      "ext/standard/tests/serialize/bug68594.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #68594 - Use after free vulnerability in unserialize()",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt": [
      "File: ext/standard/tests/serialize/bug68594.phpt -> ext/standard/tests/serialize/bug68594.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #68545 Use after free vulnerability in unserialize()",
      "3: --FILE--",
      "4: <?php",
      "5: for ($i=4; $i<100; $i++) {",
      "6:  $m = new StdClass();",
      "8:  $u = array(1);",
      "10:  $m->aaa = array(1,2,&$u,4,5);",
      "11:  $m->bbb = 1;",
      "12:  $m->ccc = &$u;",
      "13:  $m->ddd = str_repeat(\"A\", $i);",
      "15:  $z = serialize($m);",
      "16:  $z = str_replace(\"bbb\", \"aaa\", $z);",
      "17:  $y = unserialize($z);",
      "18:  $z = serialize($y);",
      "19: }",
      "20: ?>",
      "21: ===DONE===",
      "22: --EXPECTF--",
      "23: ===DONE===",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "343:   } else {",
      "345:    convert_to_string(key);",
      "346:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
      "347:      sizeof data, NULL);",
      "348:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "346:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
      "347:     var_push_dtor(var_hash, old_data);",
      "348:    }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "484: {",
      "485:  YYCTYPE yych;",
      "486:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "483: #line 484 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "486: #line 487 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "540:  yych = *(YYMARKER = ++YYCURSOR);",
      "541:  if (yych == ':') goto yy95;",
      "542: yy3:",
      "544:  { return 0; }",
      "546: yy4:",
      "547:  yych = *(YYMARKER = ++YYCURSOR);",
      "548:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "543: #line 835 \"ext/standard/var_unserializer.re\"",
      "545: #line 546 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "546: #line 838 \"ext/standard/var_unserializer.re\"",
      "548: #line 549 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "585:  goto yy3;",
      "586: yy14:",
      "587:  ++YYCURSOR;",
      "589:  {",
      "591:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "593: }",
      "595: yy16:",
      "596:  yych = *++YYCURSOR;",
      "597:  goto yy3;",
      "",
      "[Removed Lines]",
      "588: #line 829 \"ext/standard/var_unserializer.re\"",
      "594: #line 595 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "591: #line 832 \"ext/standard/var_unserializer.re\"",
      "597: #line 598 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "617:  if (yybm[0+yych] & 128) {",
      "618:   goto yy20;",
      "619:  }",
      "621:  yych = *++YYCURSOR;",
      "622:  if (yych != '\"') goto yy18;",
      "623:  ++YYCURSOR;",
      "625:  {",
      "626:  size_t len, len2, len3, maxlen;",
      "627:  long elements;",
      "",
      "[Removed Lines]",
      "620:  if (yych != ':') goto yy18;",
      "624: #line 683 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "623:  if (yych <= '/') goto yy18;",
      "624:  if (yych >= ';') goto yy18;",
      "628: #line 686 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "768:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "769: }",
      "771: yy25:",
      "772:  yych = *++YYCURSOR;",
      "773:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "770: #line 771 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "774: #line 775 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "792:  yych = *++YYCURSOR;",
      "793:  if (yych != '\"') goto yy18;",
      "794:  ++YYCURSOR;",
      "796:  {",
      "798:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "795: #line 675 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "799: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "800:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "801:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "802: }",
      "804: yy32:",
      "805:  yych = *++YYCURSOR;",
      "806:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "803: #line 804 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "807: #line 808 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "821:  yych = *++YYCURSOR;",
      "822:  if (yych != '{') goto yy18;",
      "823:  ++YYCURSOR;",
      "825:  {",
      "826:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "824: #line 655 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "828: #line 658 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "842:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "843: }",
      "845: yy39:",
      "846:  yych = *++YYCURSOR;",
      "847:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "844: #line 845 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "848: #line 849 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "862:  yych = *++YYCURSOR;",
      "863:  if (yych != '\"') goto yy18;",
      "864:  ++YYCURSOR;",
      "866:  {",
      "867:  size_t len, maxlen;",
      "868:  char *str;",
      "",
      "[Removed Lines]",
      "865: #line 626 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "869: #line 629 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "891:  ZVAL_STRINGL(*rval, str, len, 0);",
      "892:  return 1;",
      "893: }",
      "895: yy46:",
      "896:  yych = *++YYCURSOR;",
      "897:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "894: #line 895 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "898: #line 899 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "912:  yych = *++YYCURSOR;",
      "913:  if (yych != '\"') goto yy18;",
      "914:  ++YYCURSOR;",
      "916:  {",
      "917:  size_t len, maxlen;",
      "918:  char *str;",
      "",
      "[Removed Lines]",
      "915: #line 598 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "919: #line 601 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "940:  ZVAL_STRINGL(*rval, str, len, 1);",
      "941:  return 1;",
      "942: }",
      "944: yy53:",
      "945:  yych = *++YYCURSOR;",
      "946:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "943: #line 944 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "947: #line 948 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1028:  }",
      "1029: yy63:",
      "1030:  ++YYCURSOR;",
      "1032:  {",
      "1033: #if SIZEOF_LONG == 4",
      "1034: use_double:",
      "",
      "[Removed Lines]",
      "1031: #line 588 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1035: #line 591 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1038:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1039:  return 1;",
      "1040: }",
      "1042: yy65:",
      "1043:  yych = *++YYCURSOR;",
      "1044:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1041: #line 1042 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1097:  yych = *++YYCURSOR;",
      "1098:  if (yych != ';') goto yy18;",
      "1099:  ++YYCURSOR;",
      "1101:  {",
      "1103:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1100: #line 573 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1104: #line 576 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1113:  return 1;",
      "1114: }",
      "1116: yy76:",
      "1117:  yych = *++YYCURSOR;",
      "1118:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1115: #line 1116 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1119: #line 1120 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1139:  if (yych <= '9') goto yy79;",
      "1140:  if (yych != ';') goto yy18;",
      "1141:  ++YYCURSOR;",
      "1143:  {",
      "1144: #if SIZEOF_LONG == 4",
      "1145:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1142: #line 546 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1146: #line 549 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1166:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1167:  return 1;",
      "1168: }",
      "1170: yy83:",
      "1171:  yych = *++YYCURSOR;",
      "1172:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1169: #line 1170 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1173: #line 1174 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1174:  yych = *++YYCURSOR;",
      "1175:  if (yych != ';') goto yy18;",
      "1176:  ++YYCURSOR;",
      "1178:  {",
      "1180:  INIT_PZVAL(*rval);",
      "1181:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1182:  return 1;",
      "1183: }",
      "1185: yy87:",
      "1186:  ++YYCURSOR;",
      "1188:  {",
      "1190:  INIT_PZVAL(*rval);",
      "1191:  ZVAL_NULL(*rval);",
      "1192:  return 1;",
      "1193: }",
      "1195: yy89:",
      "1196:  yych = *++YYCURSOR;",
      "1197:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1177: #line 539 \"ext/standard/var_unserializer.re\"",
      "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
      "1187: #line 532 \"ext/standard/var_unserializer.re\"",
      "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1181: #line 542 \"ext/standard/var_unserializer.re\"",
      "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
      "1191: #line 535 \"ext/standard/var_unserializer.re\"",
      "1198: #line 1199 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1214:  if (yych <= '9') goto yy91;",
      "1215:  if (yych != ';') goto yy18;",
      "1216:  ++YYCURSOR;",
      "1218:  {",
      "1219:  long id;",
      "",
      "[Removed Lines]",
      "1217: #line 509 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1221: #line 512 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1238:  return 1;",
      "1239: }",
      "1241: yy95:",
      "1242:  yych = *++YYCURSOR;",
      "1243:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1240: #line 1241 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1260:  if (yych <= '9') goto yy97;",
      "1261:  if (yych != ';') goto yy18;",
      "1262:  ++YYCURSOR;",
      "1264:  {",
      "1265:  long id;",
      "",
      "[Removed Lines]",
      "1263: #line 488 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1267: #line 491 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1282:  return 1;",
      "1283: }",
      "1285: }",
      "1289:  return 0;",
      "",
      "[Removed Lines]",
      "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
      "1286: #line 837 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1288: #line 1289 \"ext/standard/var_unserializer.c\"",
      "1290: #line 840 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "347:   } else {",
      "349:    convert_to_string(key);",
      "350:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
      "351:      sizeof data, NULL);",
      "352:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "350:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
      "351:     var_push_dtor(var_hash, old_data);",
      "352:    }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7c3b55049f9866795693a0aa0736f1e7a660ab1a",
      "candidate_info": {
        "commit_hash": "7c3b55049f9866795693a0aa0736f1e7a660ab1a",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/7c3b55049f9866795693a0aa0736f1e7a660ab1a",
        "files": [
          "ext/standard/tests/serialize/bug68594.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fix bug #68594 - Use after free vulnerability in unserialize()",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt": [
          "File: ext/standard/tests/serialize/bug68594.phpt -> ext/standard/tests/serialize/bug68594.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68545 Use after free vulnerability in unserialize()",
          "3: --FILE--",
          "4: <?php",
          "5: for ($i=4; $i<100; $i++) {",
          "6:  $m = new StdClass();",
          "8:  $u = array(1);",
          "10:  $m->aaa = array(1,2,&$u,4,5);",
          "11:  $m->bbb = 1;",
          "12:  $m->ccc = &$u;",
          "13:  $m->ddd = str_repeat(\"A\", $i);",
          "15:  $z = serialize($m);",
          "16:  $z = str_replace(\"bbb\", \"aaa\", $z);",
          "17:  $y = unserialize($z);",
          "18:  $z = serialize($y);",
          "19: }",
          "20: ?>",
          "21: ===DONE===",
          "22: --EXPECTF--",
          "23: ===DONE===",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "343:   } else {",
          "345:    convert_to_string(key);",
          "346:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "347:      sizeof data, NULL);",
          "348:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "346:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "347:     var_push_dtor(var_hash, old_data);",
          "348:    }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "484: {",
          "485:  YYCTYPE yych;",
          "486:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "483: #line 484 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "486: #line 487 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "540:  yych = *(YYMARKER = ++YYCURSOR);",
          "541:  if (yych == ':') goto yy95;",
          "542: yy3:",
          "544:  { return 0; }",
          "546: yy4:",
          "547:  yych = *(YYMARKER = ++YYCURSOR);",
          "548:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "543: #line 835 \"ext/standard/var_unserializer.re\"",
          "545: #line 546 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "546: #line 838 \"ext/standard/var_unserializer.re\"",
          "548: #line 549 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "585:  goto yy3;",
          "586: yy14:",
          "587:  ++YYCURSOR;",
          "589:  {",
          "591:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "593: }",
          "595: yy16:",
          "596:  yych = *++YYCURSOR;",
          "597:  goto yy3;",
          "",
          "[Removed Lines]",
          "588: #line 829 \"ext/standard/var_unserializer.re\"",
          "594: #line 595 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "591: #line 832 \"ext/standard/var_unserializer.re\"",
          "597: #line 598 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "617:  if (yybm[0+yych] & 128) {",
          "618:   goto yy20;",
          "619:  }",
          "621:  yych = *++YYCURSOR;",
          "622:  if (yych != '\"') goto yy18;",
          "623:  ++YYCURSOR;",
          "625:  {",
          "626:  size_t len, len2, len3, maxlen;",
          "627:  long elements;",
          "",
          "[Removed Lines]",
          "620:  if (yych != ':') goto yy18;",
          "624: #line 683 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "623:  if (yych <= '/') goto yy18;",
          "624:  if (yych >= ';') goto yy18;",
          "628: #line 686 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "768:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "769: }",
          "771: yy25:",
          "772:  yych = *++YYCURSOR;",
          "773:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "770: #line 771 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "774: #line 775 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "792:  yych = *++YYCURSOR;",
          "793:  if (yych != '\"') goto yy18;",
          "794:  ++YYCURSOR;",
          "796:  {",
          "798:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "795: #line 675 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "799: #line 678 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "800:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "801:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "802: }",
          "804: yy32:",
          "805:  yych = *++YYCURSOR;",
          "806:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "803: #line 804 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "807: #line 808 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "821:  yych = *++YYCURSOR;",
          "822:  if (yych != '{') goto yy18;",
          "823:  ++YYCURSOR;",
          "825:  {",
          "826:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "824: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "828: #line 658 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "842:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "843: }",
          "845: yy39:",
          "846:  yych = *++YYCURSOR;",
          "847:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "844: #line 845 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "848: #line 849 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "862:  yych = *++YYCURSOR;",
          "863:  if (yych != '\"') goto yy18;",
          "864:  ++YYCURSOR;",
          "866:  {",
          "867:  size_t len, maxlen;",
          "868:  char *str;",
          "",
          "[Removed Lines]",
          "865: #line 626 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "869: #line 629 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "891:  ZVAL_STRINGL(*rval, str, len, 0);",
          "892:  return 1;",
          "893: }",
          "895: yy46:",
          "896:  yych = *++YYCURSOR;",
          "897:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "894: #line 895 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "898: #line 899 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "912:  yych = *++YYCURSOR;",
          "913:  if (yych != '\"') goto yy18;",
          "914:  ++YYCURSOR;",
          "916:  {",
          "917:  size_t len, maxlen;",
          "918:  char *str;",
          "",
          "[Removed Lines]",
          "915: #line 598 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "919: #line 601 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "940:  ZVAL_STRINGL(*rval, str, len, 1);",
          "941:  return 1;",
          "942: }",
          "944: yy53:",
          "945:  yych = *++YYCURSOR;",
          "946:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "943: #line 944 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "947: #line 948 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1028:  }",
          "1029: yy63:",
          "1030:  ++YYCURSOR;",
          "1032:  {",
          "1033: #if SIZEOF_LONG == 4",
          "1034: use_double:",
          "",
          "[Removed Lines]",
          "1031: #line 588 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1035: #line 591 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1038:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1039:  return 1;",
          "1040: }",
          "1042: yy65:",
          "1043:  yych = *++YYCURSOR;",
          "1044:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1041: #line 1042 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1097:  yych = *++YYCURSOR;",
          "1098:  if (yych != ';') goto yy18;",
          "1099:  ++YYCURSOR;",
          "1101:  {",
          "1103:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1100: #line 573 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1104: #line 576 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1113:  return 1;",
          "1114: }",
          "1116: yy76:",
          "1117:  yych = *++YYCURSOR;",
          "1118:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1115: #line 1116 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1119: #line 1120 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1139:  if (yych <= '9') goto yy79;",
          "1140:  if (yych != ';') goto yy18;",
          "1141:  ++YYCURSOR;",
          "1143:  {",
          "1144: #if SIZEOF_LONG == 4",
          "1145:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1142: #line 546 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1146: #line 549 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1166:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1167:  return 1;",
          "1168: }",
          "1170: yy83:",
          "1171:  yych = *++YYCURSOR;",
          "1172:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1169: #line 1170 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1173: #line 1174 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1174:  yych = *++YYCURSOR;",
          "1175:  if (yych != ';') goto yy18;",
          "1176:  ++YYCURSOR;",
          "1178:  {",
          "1180:  INIT_PZVAL(*rval);",
          "1181:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1182:  return 1;",
          "1183: }",
          "1185: yy87:",
          "1186:  ++YYCURSOR;",
          "1188:  {",
          "1190:  INIT_PZVAL(*rval);",
          "1191:  ZVAL_NULL(*rval);",
          "1192:  return 1;",
          "1193: }",
          "1195: yy89:",
          "1196:  yych = *++YYCURSOR;",
          "1197:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1177: #line 539 \"ext/standard/var_unserializer.re\"",
          "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
          "1187: #line 532 \"ext/standard/var_unserializer.re\"",
          "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1181: #line 542 \"ext/standard/var_unserializer.re\"",
          "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
          "1191: #line 535 \"ext/standard/var_unserializer.re\"",
          "1198: #line 1199 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1214:  if (yych <= '9') goto yy91;",
          "1215:  if (yych != ';') goto yy18;",
          "1216:  ++YYCURSOR;",
          "1218:  {",
          "1219:  long id;",
          "",
          "[Removed Lines]",
          "1217: #line 509 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1221: #line 512 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1238:  return 1;",
          "1239: }",
          "1241: yy95:",
          "1242:  yych = *++YYCURSOR;",
          "1243:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1240: #line 1241 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1260:  if (yych <= '9') goto yy97;",
          "1261:  if (yych != ';') goto yy18;",
          "1262:  ++YYCURSOR;",
          "1264:  {",
          "1265:  long id;",
          "",
          "[Removed Lines]",
          "1263: #line 488 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1267: #line 491 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1282:  return 1;",
          "1283: }",
          "1285: }",
          "1289:  return 0;",
          "",
          "[Removed Lines]",
          "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
          "1286: #line 837 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1288: #line 1289 \"ext/standard/var_unserializer.c\"",
          "1290: #line 840 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "347:   } else {",
          "349:    convert_to_string(key);",
          "350:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "351:      sizeof data, NULL);",
          "352:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "350:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "351:     var_push_dtor(var_hash, old_data);",
          "352:    }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c37265eacdd0186cb3b0bfeb0e0104c8563807ef",
      "candidate_info": {
        "commit_hash": "c37265eacdd0186cb3b0bfeb0e0104c8563807ef",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/c37265eacdd0186cb3b0bfeb0e0104c8563807ef",
        "files": [
          "ext/standard/tests/serialize/bug68594.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-5.5' into PHP-5.6\n\n* PHP-5.5:\n  update news\n  add CVE\n  add missing test file\n  Fix bug #68594 - Use after free vulnerability in unserialize()\n\nConflicts:\n\text/standard/var_unserializer.c",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt": [
          "File: ext/standard/tests/serialize/bug68594.phpt -> ext/standard/tests/serialize/bug68594.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68545 Use after free vulnerability in unserialize()",
          "3: --FILE--",
          "4: <?php",
          "5: for ($i=4; $i<100; $i++) {",
          "6:  $m = new StdClass();",
          "8:  $u = array(1);",
          "10:  $m->aaa = array(1,2,&$u,4,5);",
          "11:  $m->bbb = 1;",
          "12:  $m->ccc = &$u;",
          "13:  $m->ddd = str_repeat(\"A\", $i);",
          "15:  $z = serialize($m);",
          "16:  $z = str_replace(\"bbb\", \"aaa\", $z);",
          "17:  $y = unserialize($z);",
          "18:  $z = serialize($y);",
          "19: }",
          "20: ?>",
          "21: ===DONE===",
          "22: --EXPECTF--",
          "23: ===DONE===",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "342:   } else {",
          "344:    convert_to_string(key);",
          "345:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "346:      sizeof data, NULL);",
          "347:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "345:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "346:     var_push_dtor(var_hash, old_data);",
          "347:    }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "479: {",
          "480:  YYCTYPE yych;",
          "481:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "478: #line 479 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "481: #line 482 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "535:  yych = *(YYMARKER = ++YYCURSOR);",
          "536:  if (yych == ':') goto yy95;",
          "537: yy3:",
          "539:  { return 0; }",
          "541: yy4:",
          "542:  yych = *(YYMARKER = ++YYCURSOR);",
          "543:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "538: #line 830 \"ext/standard/var_unserializer.re\"",
          "540: #line 541 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "541: #line 833 \"ext/standard/var_unserializer.re\"",
          "543: #line 544 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "580:  goto yy3;",
          "581: yy14:",
          "582:  ++YYCURSOR;",
          "584:  {",
          "586:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "588: }",
          "590: yy16:",
          "591:  yych = *++YYCURSOR;",
          "592:  goto yy3;",
          "",
          "[Removed Lines]",
          "583: #line 824 \"ext/standard/var_unserializer.re\"",
          "589: #line 590 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "586: #line 827 \"ext/standard/var_unserializer.re\"",
          "592: #line 593 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "612:  if (yybm[0+yych] & 128) {",
          "613:   goto yy20;",
          "614:  }",
          "616:  yych = *++YYCURSOR;",
          "617:  if (yych != '\"') goto yy18;",
          "618:  ++YYCURSOR;",
          "620:  {",
          "621:  size_t len, len2, len3, maxlen;",
          "622:  long elements;",
          "",
          "[Removed Lines]",
          "615:  if (yych != ':') goto yy18;",
          "619: #line 678 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "618:  if (yych <= '/') goto yy18;",
          "619:  if (yych >= ';') goto yy18;",
          "623: #line 681 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "763:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "764: }",
          "766: yy25:",
          "767:  yych = *++YYCURSOR;",
          "768:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "765: #line 766 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "769: #line 770 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "787:  yych = *++YYCURSOR;",
          "788:  if (yych != '\"') goto yy18;",
          "789:  ++YYCURSOR;",
          "791:  {",
          "793:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "790: #line 670 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "794: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "795:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "796:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "797: }",
          "799: yy32:",
          "800:  yych = *++YYCURSOR;",
          "801:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "798: #line 799 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "802: #line 803 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "816:  yych = *++YYCURSOR;",
          "817:  if (yych != '{') goto yy18;",
          "818:  ++YYCURSOR;",
          "820:  {",
          "821:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "819: #line 650 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "823: #line 653 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "837:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "838: }",
          "840: yy39:",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "839: #line 840 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "843: #line 844 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "857:  yych = *++YYCURSOR;",
          "858:  if (yych != '\"') goto yy18;",
          "859:  ++YYCURSOR;",
          "861:  {",
          "862:  size_t len, maxlen;",
          "863:  char *str;",
          "",
          "[Removed Lines]",
          "860: #line 621 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "864: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "886:  ZVAL_STRINGL(*rval, str, len, 0);",
          "887:  return 1;",
          "888: }",
          "890: yy46:",
          "891:  yych = *++YYCURSOR;",
          "892:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "889: #line 890 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "893: #line 894 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "907:  yych = *++YYCURSOR;",
          "908:  if (yych != '\"') goto yy18;",
          "909:  ++YYCURSOR;",
          "911:  {",
          "912:  size_t len, maxlen;",
          "913:  char *str;",
          "",
          "[Removed Lines]",
          "910: #line 593 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "914: #line 596 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "935:  ZVAL_STRINGL(*rval, str, len, 1);",
          "936:  return 1;",
          "937: }",
          "939: yy53:",
          "940:  yych = *++YYCURSOR;",
          "941:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "938: #line 939 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "942: #line 943 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "1023:  }",
          "1024: yy63:",
          "1025:  ++YYCURSOR;",
          "1027:  {",
          "1028: #if SIZEOF_LONG == 4",
          "1029: use_double:",
          "",
          "[Removed Lines]",
          "1026: #line 583 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1030: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1033:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1034:  return 1;",
          "1035: }",
          "1037: yy65:",
          "1038:  yych = *++YYCURSOR;",
          "1039:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1036: #line 1037 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1040: #line 1041 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1092:  yych = *++YYCURSOR;",
          "1093:  if (yych != ';') goto yy18;",
          "1094:  ++YYCURSOR;",
          "1096:  {",
          "1098:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1095: #line 568 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1099: #line 571 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1108:  return 1;",
          "1109: }",
          "1111: yy76:",
          "1112:  yych = *++YYCURSOR;",
          "1113:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1110: #line 1111 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1134:  if (yych <= '9') goto yy79;",
          "1135:  if (yych != ';') goto yy18;",
          "1136:  ++YYCURSOR;",
          "1138:  {",
          "1139: #if SIZEOF_LONG == 4",
          "1140:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1137: #line 541 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1141: #line 544 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1161:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1162:  return 1;",
          "1163: }",
          "1165: yy83:",
          "1166:  yych = *++YYCURSOR;",
          "1167:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1164: #line 1165 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1168: #line 1169 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1169:  yych = *++YYCURSOR;",
          "1170:  if (yych != ';') goto yy18;",
          "1171:  ++YYCURSOR;",
          "1173:  {",
          "1175:  INIT_PZVAL(*rval);",
          "1176:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1177:  return 1;",
          "1178: }",
          "1180: yy87:",
          "1181:  ++YYCURSOR;",
          "1183:  {",
          "1185:  INIT_PZVAL(*rval);",
          "1186:  ZVAL_NULL(*rval);",
          "1187:  return 1;",
          "1188: }",
          "1190: yy89:",
          "1191:  yych = *++YYCURSOR;",
          "1192:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1172: #line 534 \"ext/standard/var_unserializer.re\"",
          "1179: #line 1180 \"ext/standard/var_unserializer.c\"",
          "1182: #line 527 \"ext/standard/var_unserializer.re\"",
          "1189: #line 1190 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1176: #line 537 \"ext/standard/var_unserializer.re\"",
          "1183: #line 1184 \"ext/standard/var_unserializer.c\"",
          "1186: #line 530 \"ext/standard/var_unserializer.re\"",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1209:  if (yych <= '9') goto yy91;",
          "1210:  if (yych != ';') goto yy18;",
          "1211:  ++YYCURSOR;",
          "1213:  {",
          "1214:  long id;",
          "",
          "[Removed Lines]",
          "1212: #line 504 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1216: #line 507 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1233:  return 1;",
          "1234: }",
          "1236: yy95:",
          "1237:  yych = *++YYCURSOR;",
          "1238:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1239: #line 1240 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1255:  if (yych <= '9') goto yy97;",
          "1256:  if (yych != ';') goto yy18;",
          "1257:  ++YYCURSOR;",
          "1259:  {",
          "1260:  long id;",
          "",
          "[Removed Lines]",
          "1258: #line 483 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1262: #line 486 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1277:  return 1;",
          "1278: }",
          "1280: }",
          "1284:  return 0;",
          "",
          "[Removed Lines]",
          "1279: #line 1280 \"ext/standard/var_unserializer.c\"",
          "1281: #line 832 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1283: #line 1284 \"ext/standard/var_unserializer.c\"",
          "1285: #line 835 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "346:   } else {",
          "348:    convert_to_string(key);",
          "349:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "350:      sizeof data, NULL);",
          "351:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "349:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "350:     var_push_dtor(var_hash, old_data);",
          "351:    }",
          "",
          "---------------"
        ]
      }
    }
  ]
}