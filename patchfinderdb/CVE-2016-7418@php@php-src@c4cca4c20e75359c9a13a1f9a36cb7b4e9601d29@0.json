{
  "cve_id": "CVE-2016-7418",
  "cve_desc": "The php_wddx_push_element function in ext/wddx/wddx.c in PHP before 5.6.26 and 7.x before 7.0.11 allows remote attackers to cause a denial of service (invalid pointer access and out-of-bounds read) or possibly have unspecified other impact via an incorrect boolean element in a wddxPacket XML document, leading to mishandling in a wddx_deserialize call.",
  "repo": "php/php-src",
  "patch_hash": "c4cca4c20e75359c9a13a1f9a36cb7b4e9601d29",
  "patch_info": {
    "commit_hash": "c4cca4c20e75359c9a13a1f9a36cb7b4e9601d29",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/c4cca4c20e75359c9a13a1f9a36cb7b4e9601d29",
    "files": [
      "ext/wddx/tests/bug73065.phpt",
      "ext/wddx/wddx.c"
    ],
    "message": "Fix bug #73065: Out-Of-Bounds Read in php_wddx_push_element of wddx.c",
    "before_after_code_files": [
      "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt",
      "ext/wddx/wddx.c||ext/wddx/wddx.c"
    ]
  },
  "patch_diff": {
    "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt": [
      "File: ext/wddx/tests/bug73065.phpt -> ext/wddx/tests/bug73065.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73065: Out-Of-Bounds Read in php_wddx_push_element of wddx.c",
      "3: --SKIPIF--",
      "4: <?php",
      "5: if (!extension_loaded('wddx')) {",
      "6:     die('skip. wddx not available');",
      "7: }",
      "8: ?>",
      "9: --FILE--",
      "10: <?php",
      "12: $xml1 = <<<XML",
      "13: <?xml version='1.0' ?>",
      "14:     <!DOCTYPE et SYSTEM 'w'>",
      "15:     <wddxPacket ven='1.0'>",
      "16:         <array>",
      "17:             <var Name=\"name\">",
      "18:                 <boolean value=\"keliu\"></boolean>",
      "19:             </var>",
      "20:             <var name=\"1111\">",
      "21:                 <var name=\"2222\">",
      "22:                     <var name=\"3333\"></var>",
      "23:                 </var>",
      "24:             </var>",
      "25:         </array>",
      "26:     </wddxPacket>",
      "27: XML;",
      "29: $xml2 = <<<XML",
      "30: <?xml version='1.0' ?>",
      "31:     <!DOCTYPE et SYSTEM 'w'>",
      "32:     <wddxPacket ven='1.0'>",
      "33:         <array>",
      "34:             <char Name=\"code\">",
      "35:                 <boolean value=\"keliu\"></boolean>",
      "36:             </char>",
      "37:         </array>",
      "38:     </wddxPacket>",
      "39: XML;",
      "41: $xml3 = <<<XML",
      "42: <?xml version='1.0' ?>",
      "43:     <!DOCTYPE et SYSTEM 'w'>",
      "44:     <wddxPacket ven='1.0'>",
      "45:         <array>",
      "46:             <boolean Name=\"value\">",
      "47:                 <boolean value=\"keliu\"></boolean>",
      "48:             </boolean>",
      "49:         </array>",
      "50:     </wddxPacket>",
      "51: XML;",
      "53: $xml4 = <<<XML",
      "54: <?xml version='1.0' ?>",
      "55:     <!DOCTYPE et SYSTEM 'w'>",
      "56:     <wddxPacket ven='1.0'>",
      "57:         <array>",
      "58:             <recordset Name=\"fieldNames\">",
      "59:                 <boolean value=\"keliu\"></boolean>",
      "60:             </recordset>",
      "61:         </array>",
      "62:     </wddxPacket>",
      "63: XML;",
      "65: $xml5 = <<<XML",
      "66: <?xml version='1.0' ?>",
      "67:     <!DOCTYPE et SYSTEM 'w'>",
      "68:     <wddxPacket ven='1.0'>",
      "69:         <array>",
      "70:             <field Name=\"name\">",
      "71:                 <boolean value=\"keliu\"></boolean>",
      "72:             </field>",
      "73:         </array>",
      "74:     </wddxPacket>",
      "75: XML;",
      "77: for($i=1;$i<=5;$i++) {",
      "78:  $xmlvar = \"xml$i\";",
      "79:     $array = wddx_deserialize($$xmlvar);",
      "80:     var_dump($array);",
      "81: }",
      "82: ?>",
      "83: DONE",
      "84: --EXPECTF--",
      "85: array(0) {",
      "86: }",
      "87: array(0) {",
      "88: }",
      "89: array(0) {",
      "90: }",
      "91: array(1) {",
      "92:   [0]=>",
      "93:   array(0) {",
      "94:   }",
      "95: }",
      "96: array(0) {",
      "97: }",
      "98: DONE",
      "",
      "---------------"
    ],
    "ext/wddx/wddx.c||ext/wddx/wddx.c": [
      "File: ext/wddx/wddx.c -> ext/wddx/wddx.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "780:   int i;",
      "782:   if (atts) for (i = 0; atts[i]; i++) {",
      "784:     char tmp_buf[2];",
      "787:     php_wddx_process_data(user_data, tmp_buf, strlen(tmp_buf));",
      "788:     break;",
      "789:    }",
      "",
      "[Removed Lines]",
      "783:    if (!strcmp(atts[i], EL_CHAR_CODE) && atts[++i] && atts[i][0]) {",
      "786:     snprintf(tmp_buf, sizeof(tmp_buf), \"%c\", (char)strtol(atts[i], NULL, 16));",
      "",
      "[Added Lines]",
      "783:    if (!strcmp(atts[i], EL_CHAR_CODE) && atts[i+1] && atts[i+1][0]) {",
      "786:     snprintf(tmp_buf, sizeof(tmp_buf), \"%c\", (char)strtol(atts[i+1], NULL, 16));",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "801:   int i;",
      "803:   if (atts) for (i = 0; atts[i]; i++) {",
      "805:     ent.type = ST_BOOLEAN;",
      "806:     SET_STACK_VARNAME;",
      "",
      "[Removed Lines]",
      "804:    if (!strcmp(atts[i], EL_VALUE) && atts[++i] && atts[i][0]) {",
      "",
      "[Added Lines]",
      "804:    if (!strcmp(atts[i], EL_VALUE) && atts[i+1] && atts[i+1][0]) {",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "809:     INIT_PZVAL(ent.data);",
      "810:     Z_TYPE_P(ent.data) = IS_BOOL;",
      "811:     wddx_stack_push((wddx_stack *)stack, &ent, sizeof(st_entry));",
      "813:     break;",
      "814:    }",
      "815:   }",
      "",
      "[Removed Lines]",
      "812:     php_wddx_process_data(user_data, atts[i], strlen(atts[i]));",
      "",
      "[Added Lines]",
      "812:     php_wddx_process_data(user_data, atts[i+1], strlen(atts[i+1]));",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "842:   int i;",
      "844:   if (atts) for (i = 0; atts[i]; i++) {",
      "846:     if (stack->varname) efree(stack->varname);",
      "848:     break;",
      "849:    }",
      "850:   }",
      "",
      "[Removed Lines]",
      "845:    if (!strcmp(atts[i], EL_NAME) && atts[++i] && atts[i][0]) {",
      "847:     stack->varname = estrdup(atts[i]);",
      "",
      "[Added Lines]",
      "845:    if (!strcmp(atts[i], EL_NAME) && atts[i+1] && atts[i+1][0]) {",
      "847:     stack->varname = estrdup(atts[i+1]);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "857:   array_init(ent.data);",
      "859:   if (atts) for (i = 0; atts[i]; i++) {",
      "861:     zval *tmp;",
      "862:     char *key;",
      "863:     char *p1, *p2, *endp;",
      "865:     endp = (char *)atts[i] + strlen(atts[i]);",
      "866:     p1 = (char *)atts[i];",
      "867:     while ((p2 = php_memnstr(p1, \",\", sizeof(\",\")-1, endp)) != NULL) {",
      "",
      "[Removed Lines]",
      "860:    if (!strcmp(atts[i], \"fieldNames\") && atts[++i] && atts[i][0]) {",
      "",
      "[Added Lines]",
      "860:    if (!strcmp(atts[i], \"fieldNames\") && atts[i+1] && atts[i+1][0]) {",
      "865:     i++;",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "893:   ent.data = NULL;",
      "895:   if (atts) for (i = 0; atts[i]; i++) {",
      "897:     st_entry *recordset;",
      "898:     zval **field;",
      "900:     if (wddx_stack_top(stack, (void**)&recordset) == SUCCESS &&",
      "901:      recordset->type == ST_RECORDSET &&",
      "903:      ent.data = *field;",
      "904:     }",
      "",
      "[Removed Lines]",
      "896:    if (!strcmp(atts[i], EL_NAME) && atts[++i] && atts[i][0]) {",
      "902:      zend_hash_find(Z_ARRVAL_P(recordset->data), (char*)atts[i], strlen(atts[i])+1, (void**)&field) == SUCCESS) {",
      "",
      "[Added Lines]",
      "897:    if (!strcmp(atts[i], EL_NAME) && atts[i+1] && atts[i+1][0]) {",
      "903:      zend_hash_find(Z_ARRVAL_P(recordset->data), (char*)atts[i+1], strlen(atts[i+1])+1, (void**)&field) == SUCCESS) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "9528ce73156e2b6a5e96e371068b24a5975f4bcd",
      "candidate_info": {
        "commit_hash": "9528ce73156e2b6a5e96e371068b24a5975f4bcd",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/9528ce73156e2b6a5e96e371068b24a5975f4bcd",
        "files": [
          "ext/wddx/tests/bug73065.phpt",
          "ext/wddx/wddx.c"
        ],
        "message": "Fix bug #73065: Out-Of-Bounds Read in php_wddx_push_element of wddx.c\n\n(cherry picked from commit bbaf784f8d213e201baf67e861f20b38c6e87d3b)\n\nConflicts:\n\text/wddx/wddx.c",
        "before_after_code_files": [
          "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt",
          "ext/wddx/wddx.c||ext/wddx/wddx.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt",
            "ext/wddx/wddx.c||ext/wddx/wddx.c"
          ],
          "candidate": [
            "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt",
            "ext/wddx/wddx.c||ext/wddx/wddx.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt": [
          "File: ext/wddx/tests/bug73065.phpt -> ext/wddx/tests/bug73065.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73065: Out-Of-Bounds Read in php_wddx_push_element of wddx.c",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded('wddx')) {",
          "6:     die('skip. wddx not available');",
          "7: }",
          "8: ?>",
          "9: --FILE--",
          "10: <?php",
          "12: $xml1 = <<<XML",
          "13: <?xml version='1.0' ?>",
          "14:     <!DOCTYPE et SYSTEM 'w'>",
          "15:     <wddxPacket ven='1.0'>",
          "16:         <array>",
          "17:             <var Name=\"name\">",
          "18:                 <boolean value=\"keliu\"></boolean>",
          "19:             </var>",
          "20:             <var name=\"1111\">",
          "21:                 <var name=\"2222\">",
          "22:                     <var name=\"3333\"></var>",
          "23:                 </var>",
          "24:             </var>",
          "25:         </array>",
          "26:     </wddxPacket>",
          "27: XML;",
          "29: $xml2 = <<<XML",
          "30: <?xml version='1.0' ?>",
          "31:     <!DOCTYPE et SYSTEM 'w'>",
          "32:     <wddxPacket ven='1.0'>",
          "33:         <array>",
          "34:             <char Name=\"code\">",
          "35:                 <boolean value=\"keliu\"></boolean>",
          "36:             </char>",
          "37:         </array>",
          "38:     </wddxPacket>",
          "39: XML;",
          "41: $xml3 = <<<XML",
          "42: <?xml version='1.0' ?>",
          "43:     <!DOCTYPE et SYSTEM 'w'>",
          "44:     <wddxPacket ven='1.0'>",
          "45:         <array>",
          "46:             <boolean Name=\"value\">",
          "47:                 <boolean value=\"keliu\"></boolean>",
          "48:             </boolean>",
          "49:         </array>",
          "50:     </wddxPacket>",
          "51: XML;",
          "53: $xml4 = <<<XML",
          "54: <?xml version='1.0' ?>",
          "55:     <!DOCTYPE et SYSTEM 'w'>",
          "56:     <wddxPacket ven='1.0'>",
          "57:         <array>",
          "58:             <recordset Name=\"fieldNames\">",
          "59:                 <boolean value=\"keliu\"></boolean>",
          "60:             </recordset>",
          "61:         </array>",
          "62:     </wddxPacket>",
          "63: XML;",
          "65: $xml5 = <<<XML",
          "66: <?xml version='1.0' ?>",
          "67:     <!DOCTYPE et SYSTEM 'w'>",
          "68:     <wddxPacket ven='1.0'>",
          "69:         <array>",
          "70:             <field Name=\"name\">",
          "71:                 <boolean value=\"keliu\"></boolean>",
          "72:             </field>",
          "73:         </array>",
          "74:     </wddxPacket>",
          "75: XML;",
          "77: for($i=1;$i<=5;$i++) {",
          "78:  $xmlvar = \"xml$i\";",
          "79:     $array = wddx_deserialize($$xmlvar);",
          "80:     var_dump($array);",
          "81: }",
          "82: ?>",
          "83: DONE",
          "84: --EXPECTF--",
          "85: array(0) {",
          "86: }",
          "87: array(0) {",
          "88: }",
          "89: array(0) {",
          "90: }",
          "91: array(1) {",
          "92:   [0]=>",
          "93:   array(0) {",
          "94:   }",
          "95: }",
          "96: array(0) {",
          "97: }",
          "98: DONE",
          "",
          "---------------"
        ],
        "ext/wddx/wddx.c||ext/wddx/wddx.c": [
          "File: ext/wddx/wddx.c -> ext/wddx/wddx.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "741:   int i;",
          "743:   if (atts) for (i = 0; atts[i]; i++) {",
          "745:     char tmp_buf[2];",
          "748:     php_wddx_process_data(user_data, (XML_Char *) tmp_buf, strlen(tmp_buf));",
          "749:     break;",
          "750:    }",
          "",
          "[Removed Lines]",
          "744:    if (!strcmp((char *)atts[i], EL_CHAR_CODE) && atts[++i] && atts[i][0]) {",
          "747:     snprintf(tmp_buf, sizeof(tmp_buf), \"%c\", (char)strtol((char *)atts[i], NULL, 16));",
          "",
          "[Added Lines]",
          "744:    if (!strcmp((char *)atts[i], EL_CHAR_CODE) && atts[i+1] && atts[i+1][0]) {",
          "747:     snprintf(tmp_buf, sizeof(tmp_buf), \"%c\", (char)strtol((char *)atts[i+1], NULL, 16));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "759:   int i;",
          "761:   if (atts) for (i = 0; atts[i]; i++) {",
          "763:     ent.type = ST_BOOLEAN;",
          "764:     SET_STACK_VARNAME;",
          "766:     ZVAL_TRUE(&ent.data);",
          "767:     wddx_stack_push((wddx_stack *)stack, &ent, sizeof(st_entry));",
          "769:     break;",
          "770:    }",
          "771:   }",
          "",
          "[Removed Lines]",
          "762:    if (!strcmp((char *)atts[i], EL_VALUE) && atts[++i] && atts[i][0]) {",
          "768:     php_wddx_process_data(user_data, atts[i], strlen((char *)atts[i]));",
          "",
          "[Added Lines]",
          "762:    if (!strcmp((char *)atts[i], EL_VALUE) && atts[i+1] && atts[i+1][0]) {",
          "768:     php_wddx_process_data(user_data, atts[i+1], strlen((char *)atts[i+1]));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "791:   int i;",
          "793:   if (atts) for (i = 0; atts[i]; i++) {",
          "795:     if (stack->varname) efree(stack->varname);",
          "797:     break;",
          "798:    }",
          "799:   }",
          "",
          "[Removed Lines]",
          "794:    if (!strcmp((char *)atts[i], EL_NAME) && atts[++i] && atts[i][0]) {",
          "796:     stack->varname = estrdup((char *)atts[i]);",
          "",
          "[Added Lines]",
          "794:    if (!strcmp((char *)atts[i], EL_NAME) && atts[i+1] && atts[i+1][0]) {",
          "796:     stack->varname = estrdup((char *)atts[i+1]);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "805:   array_init(&ent.data);",
          "807:   if (atts) for (i = 0; atts[i]; i++) {",
          "809:     zval tmp;",
          "810:     char *key;",
          "811:     const char *p1, *p2, *endp;",
          "813:     endp = (char *)atts[i] + strlen((char *)atts[i]);",
          "814:     p1 = (char *)atts[i];",
          "815:     while ((p2 = php_memnstr(p1, \",\", sizeof(\",\")-1, endp)) != NULL) {",
          "",
          "[Removed Lines]",
          "808:    if (!strcmp((char *)atts[i], \"fieldNames\") && atts[++i] && atts[i][0]) {",
          "",
          "[Added Lines]",
          "808:    if (!strcmp((char *)atts[i], \"fieldNames\") && atts[i+1] && atts[i+1][0]) {",
          "813:     i++;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "839:   ZVAL_UNDEF(&ent.data);",
          "841:   if (atts) for (i = 0; atts[i]; i++) {",
          "843:     st_entry *recordset;",
          "844:     zval *field;",
          "846:     if (wddx_stack_top(stack, (void**)&recordset) == SUCCESS &&",
          "847:      recordset->type == ST_RECORDSET &&",
          "849:      ZVAL_COPY_VALUE(&ent.data, field);",
          "850:     }",
          "",
          "[Removed Lines]",
          "842:    if (!strcmp((char *)atts[i], EL_NAME) && atts[++i] && atts[i][0]) {",
          "848:      (field = zend_hash_str_find(Z_ARRVAL(recordset->data), (char*)atts[i], strlen((char *)atts[i]))) != NULL) {",
          "",
          "[Added Lines]",
          "843:    if (!strcmp((char *)atts[i], EL_NAME) && atts[i+1] && atts[i+1][0]) {",
          "849:      (field = zend_hash_str_find(Z_ARRVAL(recordset->data), (char*)atts[i+1], strlen((char *)atts[i+1]))) != NULL) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7d011b6f59a3f5a59a9835f9ad40d9b40c266bec",
      "candidate_info": {
        "commit_hash": "7d011b6f59a3f5a59a9835f9ad40d9b40c266bec",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/7d011b6f59a3f5a59a9835f9ad40d9b40c266bec",
        "files": [
          "ext/wddx/tests/bug73065.phpt",
          "ext/wddx/wddx.c"
        ],
        "message": "Fix bug #73065: Out-Of-Bounds Read in php_wddx_push_element of wddx.c",
        "before_after_code_files": [
          "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt",
          "ext/wddx/wddx.c||ext/wddx/wddx.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt",
            "ext/wddx/wddx.c||ext/wddx/wddx.c"
          ],
          "candidate": [
            "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt",
            "ext/wddx/wddx.c||ext/wddx/wddx.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/wddx/tests/bug73065.phpt||ext/wddx/tests/bug73065.phpt": [
          "File: ext/wddx/tests/bug73065.phpt -> ext/wddx/tests/bug73065.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73065: Out-Of-Bounds Read in php_wddx_push_element of wddx.c",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if (!extension_loaded('wddx')) {",
          "6:     die('skip. wddx not available');",
          "7: }",
          "8: ?>",
          "9: --FILE--",
          "10: <?php",
          "12: $xml1 = <<<XML",
          "13: <?xml version='1.0' ?>",
          "14:     <!DOCTYPE et SYSTEM 'w'>",
          "15:     <wddxPacket ven='1.0'>",
          "16:         <array>",
          "17:             <var Name=\"name\">",
          "18:                 <boolean value=\"keliu\"></boolean>",
          "19:             </var>",
          "20:             <var name=\"1111\">",
          "21:                 <var name=\"2222\">",
          "22:                     <var name=\"3333\"></var>",
          "23:                 </var>",
          "24:             </var>",
          "25:         </array>",
          "26:     </wddxPacket>",
          "27: XML;",
          "29: $xml2 = <<<XML",
          "30: <?xml version='1.0' ?>",
          "31:     <!DOCTYPE et SYSTEM 'w'>",
          "32:     <wddxPacket ven='1.0'>",
          "33:         <array>",
          "34:             <char Name=\"code\">",
          "35:                 <boolean value=\"keliu\"></boolean>",
          "36:             </char>",
          "37:         </array>",
          "38:     </wddxPacket>",
          "39: XML;",
          "41: $xml3 = <<<XML",
          "42: <?xml version='1.0' ?>",
          "43:     <!DOCTYPE et SYSTEM 'w'>",
          "44:     <wddxPacket ven='1.0'>",
          "45:         <array>",
          "46:             <boolean Name=\"value\">",
          "47:                 <boolean value=\"keliu\"></boolean>",
          "48:             </boolean>",
          "49:         </array>",
          "50:     </wddxPacket>",
          "51: XML;",
          "53: $xml4 = <<<XML",
          "54: <?xml version='1.0' ?>",
          "55:     <!DOCTYPE et SYSTEM 'w'>",
          "56:     <wddxPacket ven='1.0'>",
          "57:         <array>",
          "58:             <recordset Name=\"fieldNames\">",
          "59:                 <boolean value=\"keliu\"></boolean>",
          "60:             </recordset>",
          "61:         </array>",
          "62:     </wddxPacket>",
          "63: XML;",
          "65: $xml5 = <<<XML",
          "66: <?xml version='1.0' ?>",
          "67:     <!DOCTYPE et SYSTEM 'w'>",
          "68:     <wddxPacket ven='1.0'>",
          "69:         <array>",
          "70:             <field Name=\"name\">",
          "71:                 <boolean value=\"keliu\"></boolean>",
          "72:             </field>",
          "73:         </array>",
          "74:     </wddxPacket>",
          "75: XML;",
          "77: for($i=1;$i<=5;$i++) {",
          "78:  $xmlvar = \"xml$i\";",
          "79:     $array = wddx_deserialize($$xmlvar);",
          "80:     var_dump($array);",
          "81: }",
          "82: ?>",
          "83: DONE",
          "84: --EXPECTF--",
          "85: array(0) {",
          "86: }",
          "87: array(0) {",
          "88: }",
          "89: array(0) {",
          "90: }",
          "91: array(1) {",
          "92:   [0]=>",
          "93:   array(0) {",
          "94:   }",
          "95: }",
          "96: array(0) {",
          "97: }",
          "98: DONE",
          "",
          "---------------"
        ],
        "ext/wddx/wddx.c||ext/wddx/wddx.c": [
          "File: ext/wddx/wddx.c -> ext/wddx/wddx.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "780:   int i;",
          "782:   if (atts) for (i = 0; atts[i]; i++) {",
          "784:     char tmp_buf[2];",
          "787:     php_wddx_process_data(user_data, tmp_buf, strlen(tmp_buf));",
          "788:     break;",
          "789:    }",
          "",
          "[Removed Lines]",
          "783:    if (!strcmp(atts[i], EL_CHAR_CODE) && atts[++i] && atts[i][0]) {",
          "786:     snprintf(tmp_buf, sizeof(tmp_buf), \"%c\", (char)strtol(atts[i], NULL, 16));",
          "",
          "[Added Lines]",
          "783:    if (!strcmp(atts[i], EL_CHAR_CODE) && atts[i+1] && atts[i+1][0]) {",
          "786:     snprintf(tmp_buf, sizeof(tmp_buf), \"%c\", (char)strtol(atts[i+1], NULL, 16));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "801:   int i;",
          "803:   if (atts) for (i = 0; atts[i]; i++) {",
          "805:     ent.type = ST_BOOLEAN;",
          "806:     SET_STACK_VARNAME;",
          "",
          "[Removed Lines]",
          "804:    if (!strcmp(atts[i], EL_VALUE) && atts[++i] && atts[i][0]) {",
          "",
          "[Added Lines]",
          "804:    if (!strcmp(atts[i], EL_VALUE) && atts[i+1] && atts[i+1][0]) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "809:     INIT_PZVAL(ent.data);",
          "810:     Z_TYPE_P(ent.data) = IS_BOOL;",
          "811:     wddx_stack_push((wddx_stack *)stack, &ent, sizeof(st_entry));",
          "813:     break;",
          "814:    }",
          "815:   }",
          "",
          "[Removed Lines]",
          "812:     php_wddx_process_data(user_data, atts[i], strlen(atts[i]));",
          "",
          "[Added Lines]",
          "812:     php_wddx_process_data(user_data, atts[i+1], strlen(atts[i+1]));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "842:   int i;",
          "844:   if (atts) for (i = 0; atts[i]; i++) {",
          "846:     if (stack->varname) efree(stack->varname);",
          "848:     break;",
          "849:    }",
          "850:   }",
          "",
          "[Removed Lines]",
          "845:    if (!strcmp(atts[i], EL_NAME) && atts[++i] && atts[i][0]) {",
          "847:     stack->varname = estrdup(atts[i]);",
          "",
          "[Added Lines]",
          "845:    if (!strcmp(atts[i], EL_NAME) && atts[i+1] && atts[i+1][0]) {",
          "847:     stack->varname = estrdup(atts[i+1]);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "857:   array_init(ent.data);",
          "859:   if (atts) for (i = 0; atts[i]; i++) {",
          "861:     zval *tmp;",
          "862:     char *key;",
          "863:     char *p1, *p2, *endp;",
          "865:     endp = (char *)atts[i] + strlen(atts[i]);",
          "866:     p1 = (char *)atts[i];",
          "867:     while ((p2 = php_memnstr(p1, \",\", sizeof(\",\")-1, endp)) != NULL) {",
          "",
          "[Removed Lines]",
          "860:    if (!strcmp(atts[i], \"fieldNames\") && atts[++i] && atts[i][0]) {",
          "",
          "[Added Lines]",
          "860:    if (!strcmp(atts[i], \"fieldNames\") && atts[i+1] && atts[i+1][0]) {",
          "865:     i++;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "893:   ent.data = NULL;",
          "895:   if (atts) for (i = 0; atts[i]; i++) {",
          "897:     st_entry *recordset;",
          "898:     zval **field;",
          "900:     if (wddx_stack_top(stack, (void**)&recordset) == SUCCESS &&",
          "901:      recordset->type == ST_RECORDSET &&",
          "903:      ent.data = *field;",
          "904:     }",
          "",
          "[Removed Lines]",
          "896:    if (!strcmp(atts[i], EL_NAME) && atts[++i] && atts[i][0]) {",
          "902:      zend_hash_find(Z_ARRVAL_P(recordset->data), (char*)atts[i], strlen(atts[i])+1, (void**)&field) == SUCCESS) {",
          "",
          "[Added Lines]",
          "897:    if (!strcmp(atts[i], EL_NAME) && atts[i+1] && atts[i+1][0]) {",
          "903:      zend_hash_find(Z_ARRVAL_P(recordset->data), (char*)atts[i+1], strlen(atts[i+1])+1, (void**)&field) == SUCCESS) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}