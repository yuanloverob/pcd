{
  "cve_id": "CVE-2015-6822",
  "cve_desc": "The destroy_buffers function in libavcodec/sanm.c in FFmpeg before 2.7.2 does not properly maintain height and width values in the video context, which allows remote attackers to cause a denial of service (segmentation violation and application crash) or possibly have unspecified other impact via crafted LucasArts Smush video data.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "39bbdebb1ed8eb9c9b0cd6db85afde6ba89d86e4",
  "patch_info": {
    "commit_hash": "39bbdebb1ed8eb9c9b0cd6db85afde6ba89d86e4",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/39bbdebb1ed8eb9c9b0cd6db85afde6ba89d86e4",
    "files": [
      "libavcodec/sanm.c"
    ],
    "message": "avcodec/sanm: Reset sizes in destroy_buffers()\n\nFixes crash in 1288a2fe8e9ae6b00ca40e089d08ca65_signal_sigsegv_7ffff71426a7_354_accident.san with allocation limit 65536\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "before_after_code_files": [
      "libavcodec/sanm.c||libavcodec/sanm.c"
    ]
  },
  "patch_diff": {
    "libavcodec/sanm.c||libavcodec/sanm.c": [
      "File: libavcodec/sanm.c -> libavcodec/sanm.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "457:     ctx->frm0_size =",
      "458:     ctx->frm1_size =",
      "459:     ctx->frm2_size = 0;",
      "460: }",
      "462: static av_cold int init_buffers(SANMVideoContext *ctx)",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "460:     init_sizes(ctx, 0, 0);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f78573466d447546d26fc959f2a94a1d10c9e425",
      "candidate_info": {
        "commit_hash": "f78573466d447546d26fc959f2a94a1d10c9e425",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/f78573466d447546d26fc959f2a94a1d10c9e425",
        "files": [
          "libavcodec/sanm.c"
        ],
        "message": "avcodec/sanm: Reset sizes in destroy_buffers()\n\nFixes crash in 1288a2fe8e9ae6b00ca40e089d08ca65_signal_sigsegv_7ffff71426a7_354_accident.san with allocation limit 65536\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 39bbdebb1ed8eb9c9b0cd6db85afde6ba89d86e4)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/sanm.c||libavcodec/sanm.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/sanm.c||libavcodec/sanm.c"
          ],
          "candidate": [
            "libavcodec/sanm.c||libavcodec/sanm.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/sanm.c||libavcodec/sanm.c": [
          "File: libavcodec/sanm.c -> libavcodec/sanm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "457:     ctx->frm0_size =",
          "458:     ctx->frm1_size =",
          "459:     ctx->frm2_size = 0;",
          "460: }",
          "462: static av_cold int init_buffers(SANMVideoContext *ctx)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "460:     init_sizes(ctx, 0, 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1cb19f4f08d5681464fc19eb8d327775921de2c9",
      "candidate_info": {
        "commit_hash": "1cb19f4f08d5681464fc19eb8d327775921de2c9",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/1cb19f4f08d5681464fc19eb8d327775921de2c9",
        "files": [
          "libavcodec/sanm.c"
        ],
        "message": "avcodec/sanm: Reset sizes in destroy_buffers()\n\nFixes crash in 1288a2fe8e9ae6b00ca40e089d08ca65_signal_sigsegv_7ffff71426a7_354_accident.san with allocation limit 65536\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 39bbdebb1ed8eb9c9b0cd6db85afde6ba89d86e4)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/sanm.c||libavcodec/sanm.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/sanm.c||libavcodec/sanm.c"
          ],
          "candidate": [
            "libavcodec/sanm.c||libavcodec/sanm.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/sanm.c||libavcodec/sanm.c": [
          "File: libavcodec/sanm.c -> libavcodec/sanm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "457:     ctx->frm0_size =",
          "458:     ctx->frm1_size =",
          "459:     ctx->frm2_size = 0;",
          "460: }",
          "462: static av_cold int init_buffers(SANMVideoContext *ctx)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "460:     init_sizes(ctx, 0, 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "df6f2daccf66954f900be9b785a07d699ab5beda",
      "candidate_info": {
        "commit_hash": "df6f2daccf66954f900be9b785a07d699ab5beda",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/df6f2daccf66954f900be9b785a07d699ab5beda",
        "files": [
          "libavcodec/sanm.c"
        ],
        "message": "avcodec/sanm: Reset sizes in destroy_buffers()\n\nFixes crash in 1288a2fe8e9ae6b00ca40e089d08ca65_signal_sigsegv_7ffff71426a7_354_accident.san with allocation limit 65536\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 39bbdebb1ed8eb9c9b0cd6db85afde6ba89d86e4)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/sanm.c||libavcodec/sanm.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/sanm.c||libavcodec/sanm.c"
          ],
          "candidate": [
            "libavcodec/sanm.c||libavcodec/sanm.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/sanm.c||libavcodec/sanm.c": [
          "File: libavcodec/sanm.c -> libavcodec/sanm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "457:     ctx->frm0_size =",
          "458:     ctx->frm1_size =",
          "459:     ctx->frm2_size = 0;",
          "460: }",
          "462: static av_cold int init_buffers(SANMVideoContext *ctx)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "460:     init_sizes(ctx, 0, 0);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "237751eb257fd528a91f35f0a835c2273957ee62",
      "candidate_info": {
        "commit_hash": "237751eb257fd528a91f35f0a835c2273957ee62",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/237751eb257fd528a91f35f0a835c2273957ee62",
        "files": [
          "libavcodec/sanm.c"
        ],
        "message": "avcodec/sanm: Reset sizes in destroy_buffers()\n\nFixes crash in 1288a2fe8e9ae6b00ca40e089d08ca65_signal_sigsegv_7ffff71426a7_354_accident.san with allocation limit 65536\n\nFound-by: Samuel Gro\u00df, Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 39bbdebb1ed8eb9c9b0cd6db85afde6ba89d86e4)\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavcodec/sanm.c||libavcodec/sanm.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavcodec/sanm.c||libavcodec/sanm.c"
          ],
          "candidate": [
            "libavcodec/sanm.c||libavcodec/sanm.c"
          ]
        }
      },
      "candidate_diff": {
        "libavcodec/sanm.c||libavcodec/sanm.c": [
          "File: libavcodec/sanm.c -> libavcodec/sanm.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "457:     ctx->frm0_size =",
          "458:     ctx->frm1_size =",
          "459:     ctx->frm2_size = 0;",
          "460: }",
          "462: static av_cold int init_buffers(SANMVideoContext *ctx)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "460:     init_sizes(ctx, 0, 0);",
          "",
          "---------------"
        ]
      }
    }
  ]
}