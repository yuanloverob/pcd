{
  "cve_id": "CVE-2017-13083",
  "cve_desc": "Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code",
  "repo": "pbatard/rufus",
  "patch_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
  "patch_info": {
    "commit_hash": "c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "repo": "pbatard/rufus",
    "commit_url": "https://github.com/pbatard/rufus/commit/c3c39f7f8a11f612c4ebf7affce25ec6928eb1cb",
    "files": [
      "res/localization/rufus.loc",
      "src/pki.c",
      "src/rufus.rc",
      "src/stdlg.c"
    ],
    "message": "[pki] fix https://www.kb.cert.org/vuls/id/403768\n\n* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as\n  it is described per its revision 11, which is the latest revision at the time of this commit,\n  by disabling Windows prompts, enacted during signature validation, that allow the user to\n  bypass the intended signature verification checks.\n* It needs to be pointed out that the vulnerability (\"allow(ing) the use of a self-signed\n  certificate\"), which relies on the end-user actively ignoring a Windows prompt that tells\n  them that the update failed the signature validation whilst also advising against running it,\n  is being fully addressed, even as the update protocol remains HTTP.\n* It also need to be pointed out that the extended delay (48 hours) between the time the\n  vulnerability was reported and the moment it is fixed in our codebase has to do with\n  the fact that the reporter chose to deviate from standard security practices by not\n  disclosing the details of the vulnerability with us, be it publicly or privately,\n  before creating the cert.org report. The only advance notification we received was a\n  generic note about the use of HTTP vs HTTPS, which, as have established, is not\n  immediately relevant to addressing the reported vulnerability.\n* Closes #1009\n* Note: The other vulnerability scenario described towards the end of #1009, which\n  doesn't have to do with the \"lack of CA checking\", will be addressed separately.",
    "before_after_code_files": [
      "res/localization/rufus.loc||res/localization/rufus.loc",
      "src/pki.c||src/pki.c",
      "src/rufus.rc||src/rufus.rc",
      "src/stdlg.c||src/stdlg.c"
    ]
  },
  "patch_diff": {
    "res/localization/rufus.loc||res/localization/rufus.loc": [
      "File: res/localization/rufus.loc -> res/localization/rufus.loc",
      "--- Hunk 1 ---",
      "[Context before]",
      "487: # eg. \"Partitioning (MBR)...\"",
      "488: t MSG_238 \"Partitioning (%s)...\"",
      "489: t MSG_239 \"Deleting partitions...\"",
      "490: t MSG_241 \"Downloading: %0.1f%%\"",
      "491: t MSG_242 \"Failed to download file.\"",
      "492: t MSG_243 \"Checking for Rufus updates...\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "490: t MSG_240 \"The signature for the downloaded update can not be validated. This could mean that your \"",
      "491:  \"system is improperly configured for signature validation or indicate a malicious download.\\n\\n\"",
      "492:  \"The download will be deleted. Please check the log for more details.\"",
      "",
      "---------------"
    ],
    "src/pki.c||src/pki.c": [
      "File: src/pki.c -> src/pki.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "53:  static char error_string[64];",
      "54:  DWORD error_code = GetLastError();",
      "57:   return WindowsErrorString();",
      "59:  switch (error_code) {",
      "",
      "[Removed Lines]",
      "56:  if ((error_code >> 16) != 0x8009)",
      "",
      "[Added Lines]",
      "56:  if (((error_code >> 16) != 0x8009) && ((error_code >> 16) != 0x800B))",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "113:   return \"Cannot complete usage check.\";",
      "114:  case CRYPT_E_NO_TRUSTED_SIGNER:",
      "115:   return \"None of the signers of the cryptographic message or certificate trust list is trusted.\";",
      "116:  default:",
      "117:   static_sprintf(error_string, \"Unknown PKI error 0x%08lX\", error_code);",
      "118:   return error_string;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "116:  case CERT_E_UNTRUSTEDROOT:",
      "117:   return \"The root certificate is not trusted.\";",
      "118:  case TRUST_E_NOSIGNATURE:",
      "119:   return \"Not digitally signed.\";",
      "120:  case TRUST_E_EXPLICIT_DISTRUST:",
      "121:   return \"One of the certificates used was marked as untrusted by the user.\";",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "268:  }",
      "270:  trust_data.cbStruct = sizeof(trust_data);",
      "273:  trust_data.fdwRevocationChecks = WTD_REVOKE_WHOLECHAIN;",
      "",
      "[Removed Lines]",
      "271:  trust_data.dwUIChoice = WTD_UI_ALL;",
      "",
      "[Added Lines]",
      "283:  trust_data.dwUIChoice = WTD_UI_NONE;",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "279:  r = WinVerifyTrust(NULL, &guid_generic_verify, &trust_data);",
      "280:  safe_free(trust_file.pcwszFilePath);",
      "282:  return r;",
      "283: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "293:  switch (r) {",
      "294:  case ERROR_SUCCESS:",
      "295:   break;",
      "296:  case TRUST_E_NOSIGNATURE:",
      "298:   uprintf(\"PKI: File does not appear to be signed: %s\", WinPKIErrorString());",
      "299:   MessageBoxExU(hDlg, lmprintf(MSG_284), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "300:   break;",
      "301:  default:",
      "302:   uprintf(\"PKI: Failed to validate signature: %s\", WinPKIErrorString());",
      "303:   MessageBoxExU(hDlg, lmprintf(MSG_240), lmprintf(MSG_283), MB_OK | MB_ICONERROR | MB_IS_RTL, selected_langid);",
      "304:   break;",
      "305:  }",
      "",
      "---------------"
    ],
    "src/rufus.rc||src/rufus.rc": [
      "File: src/rufus.rc -> src/rufus.rc",
      "--- Hunk 1 ---",
      "[Context before]",
      "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
      "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
      "35: EXSTYLE WS_EX_ACCEPTFILES",
      "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
      "38: BEGIN",
      "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
      "",
      "[Removed Lines]",
      "36: CAPTION \"Rufus 2.17.1186\"",
      "",
      "[Added Lines]",
      "36: CAPTION \"Rufus 2.17.1187\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "368: VS_VERSION_INFO VERSIONINFO",
      "371:  FILEFLAGSMASK 0x3fL",
      "372: #ifdef _DEBUG",
      "373:  FILEFLAGS 0x1L",
      "",
      "[Removed Lines]",
      "369:  FILEVERSION 2,17,1186,0",
      "370:  PRODUCTVERSION 2,17,1186,0",
      "",
      "[Added Lines]",
      "369:  FILEVERSION 2,17,1187,0",
      "370:  PRODUCTVERSION 2,17,1187,0",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "384:         BEGIN",
      "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
      "386:             VALUE \"FileDescription\", \"Rufus\"",
      "388:             VALUE \"InternalName\", \"Rufus\"",
      "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
      "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
      "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
      "392:             VALUE \"ProductName\", \"Rufus\"",
      "394:         END",
      "395:     END",
      "396:     BLOCK \"VarFileInfo\"",
      "",
      "[Removed Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1186\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1186\"",
      "",
      "[Added Lines]",
      "387:             VALUE \"FileVersion\", \"2.17.1187\"",
      "393:             VALUE \"ProductVersion\", \"2.17.1187\"",
      "",
      "---------------"
    ],
    "src/stdlg.c||src/stdlg.c": [
      "File: src/stdlg.c -> src/stdlg.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1674:    case 2:  // Launch newer version and close this one",
      "1675:     Sleep(1000); // Add a delay on account of antivirus scanners",
      "1678:      break;",
      "1680:     memset(&si, 0, sizeof(si));",
      "1681:     memset(&pi, 0, sizeof(pi));",
      "",
      "[Removed Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR)",
      "",
      "[Added Lines]",
      "1677:     if (ValidateSignature(hDlg, filepath) != NO_ERROR) {",
      "1679:      _unlinkU(filepath);",
      "1680:      EnableWindow(GetDlgItem(hDlg, IDC_DOWNLOAD), FALSE);",
      "1682:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "efcdbe30e5b8eea4848888733e0fd584d5ccc487",
      "candidate_info": {
        "commit_hash": "efcdbe30e5b8eea4848888733e0fd584d5ccc487",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/efcdbe30e5b8eea4848888733e0fd584d5ccc487",
        "files": [
          "src/pki.c",
          "src/rufus.rc"
        ],
        "message": "[pki] clear buffer on invalid signature\n\n* Avoid keeping potentially nasty stuff in memory for too long...",
        "before_after_code_files": [
          "src/pki.c||src/pki.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/pki.c||src/pki.c",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/pki.c||src/pki.c",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/pki.c||src/pki.c": [
          "File: src/pki.c -> src/pki.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "691:  r = CryptImportKey(hProv, (BYTE*)&pbMyPubKey.BlobHeader, dwMyPubKeyLen, 0, 0, &hPubKey);",
          "692:  if (!r) {",
          "694:   goto out;",
          "695:  }",
          "698:  r = CryptCreateHash(hProv, CALG_SHA_256, 0, 0, &hHash);",
          "699:  if (!r) {",
          "701:   goto out;",
          "702:  }",
          "705:  r = CryptHashData(hHash, pbBuffer, dwBufferLen, 0);",
          "706:  if (!r) {",
          "708:   goto out;",
          "709:  }",
          "",
          "[Removed Lines]",
          "693:   uprintf(\"Could not import public key: %s\", WinPKIErrorString());",
          "700:   uprintf(\"Could not create empty hash: %s\", WinPKIErrorString());",
          "707:   uprintf(\"Could not hash data: %s\", WinPKIErrorString());",
          "",
          "[Added Lines]",
          "693:   uprintf(\"PKI: Could not import public key: %s\", WinPKIErrorString());",
          "700:   uprintf(\"PKI: Could not create empty hash: %s\", WinPKIErrorString());",
          "707:   uprintf(\"PKI: Could not hash data: %s\", WinPKIErrorString());",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "720:  r = CryptVerifySignature(hHash, pbSignature, dwSigLen, hPubKey, NULL, 0);",
          "722:   uprintf(\"Signature validation failed: %s\", WinPKIErrorString());",
          "724: out:",
          "725:  if (hHash)",
          "",
          "[Removed Lines]",
          "721:  if (!r)",
          "",
          "[Added Lines]",
          "721:  if (!r) {",
          "724:   memset(pbBuffer, 0, dwBufferLen);",
          "726:  }",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.2.1376\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.2.1377\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "394: VS_VERSION_INFO VERSIONINFO",
          "397:  FILEFLAGSMASK 0x3fL",
          "398: #ifdef _DEBUG",
          "399:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "395:  FILEVERSION 3,2,1376,0",
          "396:  PRODUCTVERSION 3,2,1376,0",
          "",
          "[Added Lines]",
          "395:  FILEVERSION 3,2,1377,0",
          "396:  PRODUCTVERSION 3,2,1377,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "411:             VALUE \"Comments\", \"https://akeo.ie\"",
          "412:             VALUE \"CompanyName\", \"Akeo Consulting\"",
          "413:             VALUE \"FileDescription\", \"Rufus\"",
          "415:             VALUE \"InternalName\", \"Rufus\"",
          "416:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "417:             VALUE \"LegalTrademarks\", \"https://www.gnu.org/copyleft/gpl.html\"",
          "418:             VALUE \"OriginalFilename\", \"rufus-3.2.exe\"",
          "419:             VALUE \"ProductName\", \"Rufus\"",
          "421:         END",
          "422:     END",
          "423:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "414:             VALUE \"FileVersion\", \"3.2.1376\"",
          "420:             VALUE \"ProductVersion\", \"3.2.1376\"",
          "",
          "[Added Lines]",
          "414:             VALUE \"FileVersion\", \"3.2.1377\"",
          "420:             VALUE \"ProductVersion\", \"3.2.1377\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "13ba3e75b3f825884ebd612dc187356f34d13d36",
      "candidate_info": {
        "commit_hash": "13ba3e75b3f825884ebd612dc187356f34d13d36",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/13ba3e75b3f825884ebd612dc187356f34d13d36",
        "files": [
          "configure",
          "configure.ac",
          "res/appstore/AppxManifest.xml",
          "res/appstore/packme.cmd",
          "src/checksum.c",
          "src/pki.c",
          "src/registry.h",
          "src/rufus.rc"
        ],
        "message": "[misc] fix VS2017 code analysis warnings\n\n* Also set rufus-next to 2.18",
        "before_after_code_files": [
          "configure.ac||configure.ac",
          "res/appstore/packme.cmd||res/appstore/packme.cmd",
          "src/checksum.c||src/checksum.c",
          "src/pki.c||src/pki.c",
          "src/registry.h||src/registry.h",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/pki.c||src/pki.c",
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/pki.c||src/pki.c",
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "configure.ac||configure.ac": [
          "File: configure.ac -> configure.ac",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: AM_INIT_AUTOMAKE([-Wno-portability foreign no-dist no-dependencies])",
          "3: AC_CONFIG_SRCDIR([src/rufus.c])",
          "4: AC_CONFIG_MACRO_DIR([m4])",
          "",
          "[Removed Lines]",
          "1: AC_INIT([rufus], [2.17], [https://github.com/pbatard/rufus/issues], [rufus], [https://rufus.akeo.ie])",
          "",
          "[Added Lines]",
          "1: AC_INIT([rufus], [2.18], [https://github.com/pbatard/rufus/issues], [rufus], [https://rufus.akeo.ie])",
          "",
          "---------------"
        ],
        "res/appstore/packme.cmd||res/appstore/packme.cmd": [
          "File: res/appstore/packme.cmd -> res/appstore/packme.cmd",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: @echo off",
          "4: rem Make sure you don't have anything you don't want included in the package, as anything residing in the",
          "5: rem current directory will be included, including any previous .appx, which makes for nice recursion...",
          "",
          "[Removed Lines]",
          "2: set VERSION=2.17",
          "",
          "[Added Lines]",
          "2: set VERSION=2.18",
          "",
          "---------------"
        ],
        "src/checksum.c||src/checksum.c": [
          "File: src/checksum.c -> src/checksum.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "67: char sum_str[CHECKSUM_MAX][65];",
          "68: uint32_t bufnum, sum_count[CHECKSUM_MAX] = { 16, 20, 32 };",
          "70: DWORD read_size[2];",
          "71: unsigned char ALIGNED(64) buffer[2][BUFFER_SIZE];",
          "",
          "[Removed Lines]",
          "69: HANDLE data_ready[CHECKSUM_MAX], thread_ready[CHECKSUM_MAX];",
          "",
          "[Added Lines]",
          "69: HANDLE data_ready[CHECKSUM_MAX] = { 0 }, thread_ready[CHECKSUM_MAX] = { 0 };",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "886:  float format_percent = 0.0f;",
          "888:  if ((image_path == NULL) || (thread_affinity == NULL))",
          "891:  uprintf(\"\\r\\nComputing checksum for '%s'...\", image_path);",
          "",
          "[Removed Lines]",
          "889:   goto out;",
          "",
          "[Added Lines]",
          "889:   ExitThread(r);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "985:  for (i = 0; i < CHECKSUM_MAX; i++) {",
          "986:   if (sum_thread[i] != NULL)",
          "987:    TerminateThread(sum_thread[i], 1);",
          "990:  }",
          "991:  safe_closehandle(h);",
          "992:  PostMessage(hMainDialog, UM_FORMAT_COMPLETED, (WPARAM)FALSE, 0);",
          "",
          "[Removed Lines]",
          "988:   CloseHandle(data_ready[i]);",
          "989:   CloseHandle(thread_ready[i]);",
          "",
          "[Added Lines]",
          "988:   safe_closehandle(data_ready[i]);",
          "989:   safe_closehandle(thread_ready[i]);",
          "",
          "---------------"
        ],
        "src/pki.c||src/pki.c": [
          "File: src/pki.c -> src/pki.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "258: static uint64_t GetRFC3161TimeStamp(PCMSG_SIGNER_INFO pSignerInfo)",
          "259: {",
          "260:  BOOL r, found = FALSE;",
          "262:  PCRYPT_CONTENT_INFO pCounterSignerInfo = NULL;",
          "263:  uint64_t ts = 0ULL;",
          "264:  uint8_t *timestamp_token;",
          "",
          "[Removed Lines]",
          "261:  DWORD n, dwSize;",
          "",
          "[Added Lines]",
          "261:  DWORD n, dwSize = 0;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "318: static uint64_t GetNestedRFC3161TimeStamp(PCMSG_SIGNER_INFO pSignerInfo)",
          "319: {",
          "320:  BOOL r, found = FALSE;",
          "322:  PCRYPT_CONTENT_INFO pNestedSignature = NULL;",
          "323:  PCMSG_SIGNER_INFO pNestedSignerInfo = NULL;",
          "324:  HCRYPTMSG hMsg = NULL;",
          "",
          "[Removed Lines]",
          "321:  DWORD n, dwSize;",
          "",
          "[Added Lines]",
          "321:  DWORD n, dwSize = 0;",
          "",
          "---------------"
        ],
        "src/registry.h||src/registry.h": [
          "File: src/registry.h -> src/registry.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "83:    break;",
          "84:  }",
          "88:   if (_strnicmp(key_name, software_prefix, sizeof(software_prefix) - 1) != 0) {",
          "89:    if (i + sizeof(software_prefix) >= sizeof(long_key_name))",
          "",
          "[Removed Lines]",
          "86:  if (i != 0) {",
          "",
          "[Added Lines]",
          "86:  if (i > 0) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "146:  }",
          "150:   if (key_name[i] == '\\\\')",
          "151:    break;",
          "152:  }",
          "163:   if (_strnicmp(key_name, software_prefix, sizeof(software_prefix) - 1) != 0) {",
          "164:    if (i + sizeof(software_prefix) >= sizeof(long_key_name))",
          "",
          "[Removed Lines]",
          "149:  for (i = safe_strlen(key_name); i>0; i--) {",
          "154:  if (i == 0) {",
          "156:   if (RegCreateKeyExA(hRoot, \"SOFTWARE\\\\\" COMPANY_NAME \"\\\\\" APPLICATION_NAME, 0, NULL, 0,",
          "157:    KEY_SET_VALUE | KEY_QUERY_VALUE | KEY_CREATE_SUB_KEY, NULL, &hApp, &dwDisp) != ERROR_SUCCESS) {",
          "158:    hApp = NULL;",
          "159:    goto out;",
          "160:   }",
          "161:  } else {",
          "",
          "[Added Lines]",
          "149:  for (i = safe_strlen(key_name); i > 0; i--) {",
          "154:  if (i > 0) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "178:    hApp = NULL;",
          "179:    goto out;",
          "180:   }",
          "181:  }",
          "183:  r = (RegSetValueExA(hApp, &key_name[i], 0, dwType, src, src_size) == ERROR_SUCCESS);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "174:  } else {",
          "176:   if (RegCreateKeyExA(hRoot, \"SOFTWARE\\\\\" COMPANY_NAME \"\\\\\" APPLICATION_NAME, 0, NULL, 0,",
          "177:    KEY_SET_VALUE | KEY_QUERY_VALUE | KEY_CREATE_SUB_KEY, NULL, &hApp, &dwDisp) != ERROR_SUCCESS) {",
          "178:    hApp = NULL;",
          "179:    goto out;",
          "180:   }",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.17.1199\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.18.1200\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "368: VS_VERSION_INFO VERSIONINFO",
          "371:  FILEFLAGSMASK 0x3fL",
          "372: #ifdef _DEBUG",
          "373:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "369:  FILEVERSION 2,17,1199,0",
          "370:  PRODUCTVERSION 2,17,1199,0",
          "",
          "[Added Lines]",
          "369:  FILEVERSION 2,18,1200,0",
          "370:  PRODUCTVERSION 2,18,1200,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "384:         BEGIN",
          "385:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "386:             VALUE \"FileDescription\", \"Rufus\"",
          "388:             VALUE \"InternalName\", \"Rufus\"",
          "389:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "390:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "391:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "392:             VALUE \"ProductName\", \"Rufus\"",
          "394:         END",
          "395:     END",
          "396:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "387:             VALUE \"FileVersion\", \"2.17.1199\"",
          "393:             VALUE \"ProductVersion\", \"2.17.1199\"",
          "",
          "[Added Lines]",
          "387:             VALUE \"FileVersion\", \"2.18.1200\"",
          "393:             VALUE \"ProductVersion\", \"2.18.1200\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5602494690dc86ec8978b1b021a5a0fbd5084b8e",
      "candidate_info": {
        "commit_hash": "5602494690dc86ec8978b1b021a5a0fbd5084b8e",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/5602494690dc86ec8978b1b021a5a0fbd5084b8e",
        "files": [
          "src/rufus.c",
          "src/rufus.rc"
        ],
        "message": "[ui] fix application exit when cancelling the ISO scan",
        "before_after_code_files": [
          "src/rufus.c||src/rufus.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1345:   }",
          "1346:  }",
          "1356: }",
          "",
          "[Removed Lines]",
          "1348:  if (image_path != NULL) {",
          "1349:   ComboBox_DeleteString(hBootType, index);",
          "1350:   ComboBox_InsertStringU(hBootType, index, short_image_path);",
          "1351:   ComboBox_SetItemData(hBootType, index, BT_IMAGE);",
          "1352:   IGNORE_RETVAL(ComboBox_SetCurSel(hBootType, index));",
          "1353:   bt = (int)ComboBox_GetItemData(hBootType, ComboBox_GetCurSel(hBootType));",
          "1354:   SetBootTypeDropdownWidth();",
          "1355:  }",
          "",
          "[Added Lines]",
          "1348:  ComboBox_DeleteString(hBootType, index);",
          "1349:  ComboBox_InsertStringU(hBootType, index,",
          "1350:   (image_path == NULL) ? lmprintf(MSG_281, lmprintf(MSG_280)) : short_image_path);",
          "1351:  ComboBox_SetItemData(hBootType, index, BT_IMAGE);",
          "1352:  IGNORE_RETVAL(ComboBox_SetCurSel(hBootType, index));",
          "1353:  bt = (int)ComboBox_GetItemData(hBootType, ComboBox_GetCurSel(hBootType));",
          "1354:  SetBootTypeDropdownWidth();",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1363:  if (image_path == NULL)",
          "1364:   goto out;",
          "1365:  PrintInfoDebug(0, MSG_202);",
          "1366:  user_notified = FALSE;",
          "1367:  EnableControls(FALSE);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1364:  format_op_in_progress = TRUE;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1369:  img_report.is_iso = (BOOLEAN)ExtractISO(image_path, \"\", TRUE);",
          "1370:  img_report.is_bootable_img = (BOOLEAN)IsBootableImage(image_path);",
          "1374:   SendMessage(hMainDialog, UM_PROGRESS_EXIT, 0, 0);",
          "1375:   safe_free(image_path);",
          "1377:   SetMBRProps();",
          "1378:   PopulateProperties();",
          "1379:   PrintInfoDebug(0, MSG_203);",
          "1380:   PrintStatus(0, MSG_203);",
          "1381:   goto out;",
          "1382:  }",
          "",
          "[Removed Lines]",
          "1372:  if ((img_report.image_size == 0) || (!img_report.is_iso && !img_report.is_bootable_img)) {",
          "1376:   EnableControls(TRUE);",
          "",
          "[Added Lines]",
          "1372:  if (IS_ERROR(FormatStatus) || (img_report.image_size == 0) || (!img_report.is_iso && !img_report.is_bootable_img)) {",
          "1376:   UpdateImage();",
          "1381:   EnableControls(TRUE);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1440: out:",
          "1441:  dont_display_image_name = FALSE;",
          "1442:  PrintInfo(0, MSG_210);",
          "1443:  ExitThread(0);",
          "1444: }",
          "1446: static DWORD WINAPI BootCheckThread(LPVOID param)",
          "1447: {",
          "1448:  int i, r;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1443:  format_op_in_progress = FALSE;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1777: out:",
          "1778:  PostMessage(hMainDialog, UM_FORMAT_START, ret, 0);",
          "1780: }",
          "1782: static __inline const char* IsAlphaOrBeta(void)",
          "",
          "[Removed Lines]",
          "1779:  return (DWORD)ret;",
          "",
          "[Added Lines]",
          "1782:  ExitThread((DWORD)ret);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3036:     FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|ERROR_CANCELLED;",
          "3037:     PrintInfo(0, MSG_201);",
          "3038:     return (INT_PTR)TRUE;",
          "3039:    }",
          "3040:    if (ulRegister != 0)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3041:     EnableWindow(GetDlgItem(hDlg, IDCANCEL), TRUE);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "3232:     }",
          "3233:    }",
          "3234:    FormatStatus = 0;",
          "3235:    if (CreateThread(NULL, 0, ISOScanThread, NULL, 0, NULL) == NULL) {",
          "3236:     uprintf(\"Unable to start ISO scanning thread\");",
          "3237:     FormatStatus = ERROR_SEVERITY_ERROR|FAC(FACILITY_STORAGE)|APPERR(ERROR_CANT_START_THREAD);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3239:    format_op_in_progress = FALSE;",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.2.1327\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.2.1328\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "391: VS_VERSION_INFO VERSIONINFO",
          "394:  FILEFLAGSMASK 0x3fL",
          "395: #ifdef _DEBUG",
          "396:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "392:  FILEVERSION 3,2,1327,0",
          "393:  PRODUCTVERSION 3,2,1327,0",
          "",
          "[Added Lines]",
          "392:  FILEVERSION 3,2,1328,0",
          "393:  PRODUCTVERSION 3,2,1328,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "407:         BEGIN",
          "408:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "409:             VALUE \"FileDescription\", \"Rufus\"",
          "411:             VALUE \"InternalName\", \"Rufus\"",
          "412:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "413:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "414:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "415:             VALUE \"ProductName\", \"Rufus\"",
          "417:         END",
          "418:     END",
          "419:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "410:             VALUE \"FileVersion\", \"3.2.1327\"",
          "416:             VALUE \"ProductVersion\", \"3.2.1327\"",
          "",
          "[Added Lines]",
          "410:             VALUE \"FileVersion\", \"3.2.1328\"",
          "416:             VALUE \"ProductVersion\", \"3.2.1328\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a51d17742b0356b02ce323faedb6035e21304178",
      "candidate_info": {
        "commit_hash": "a51d17742b0356b02ce323faedb6035e21304178",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/a51d17742b0356b02ce323faedb6035e21304178",
        "files": [
          "_coverity.cmd",
          "src/rufus.rc"
        ],
        "message": "[internal] update coverity script",
        "before_after_code_files": [
          "_coverity.cmd||_coverity.cmd",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "_coverity.cmd||_coverity.cmd": [
          "File: _coverity.cmd -> _coverity.cmd",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: @echo off",
          "3: set PATH=%PATH%;%COV_DIR%\\bin",
          "4: set PWD=%~dp0",
          "5: rmdir cov-int /s /q >NUL 2>NUL",
          "6: del cov-int.zip >NUL 2>NUL",
          "7: mkdir cov-int",
          "8: rem *** for when/if Coverity manage to clean their act",
          "10: rem cov-build --dir cov-int C:\\msys64\\usr\\bin\\bash -cl \"export PATH=/mingw32/bin:$PATH; cd /c/rufus; ./configure --build=i686-w64-mingw32 --host=i686-w64-mingw32 --disable-debug; make -j4\"",
          "12: rem *** zip script by Peter Mortensen - http://superuser.com/a/111266/286681",
          "13: echo Set objArgs = WScript.Arguments> zip.vbs",
          "14: echo InputFolder = objArgs(0)>> zip.vbs",
          "",
          "[Removed Lines]",
          "2: set COV_DIR=E:\\cov-analysis-win32-7.7.0.4",
          "9: rem cov-build --dir cov-int msbuild rufus.sln /p:Configuration=Release,Platform=x86_32 /maxcpucount",
          "11: cov-build --dir cov-int wdk_build.cmd",
          "",
          "[Added Lines]",
          "1: @rem *** Internal developer script to run Coverity ***",
          "3: call \"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\Common7\\Tools\\VsDevCmd.bat\"",
          "4: set COV_DIR=D:\\cov-analysis-win64-8.7.0",
          "7: set TARGET=x86_32",
          "9: rmdir %TARGET% /s /q >NUL 2>NUL",
          "12: cov-build --dir cov-int msbuild rufus.sln /p:Configuration=Release,Platform=%TARGET% /maxcpucount",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "17: echo Set objShell = CreateObject(\"Shell.Application\")>> zip.vbs",
          "18: echo Set source = objShell.NameSpace(InputFolder)>> zip.vbs",
          "19: echo objShell.NameSpace(ZipFile).CopyHere(source)>> zip.vbs",
          "21: CScript zip.vbs %PWD%cov-int %PWD%cov-int.zip",
          "22: del zip.vbs",
          "",
          "[Removed Lines]",
          "20: echo wScript.Sleep 2000>> zip.vbs",
          "",
          "[Added Lines]",
          "23: echo wScript.Sleep 8000>> zip.vbs",
          "26: pause",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 242, 376",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 8, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Device\",IDS_DEVICE_TXT,9,6,200,8",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 2.13.1067\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 2.13.1068\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "336: VS_VERSION_INFO VERSIONINFO",
          "339:  FILEFLAGSMASK 0x3fL",
          "340: #ifdef _DEBUG",
          "341:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "337:  FILEVERSION 2,13,1067,0",
          "338:  PRODUCTVERSION 2,13,1067,0",
          "",
          "[Added Lines]",
          "337:  FILEVERSION 2,13,1068,0",
          "338:  PRODUCTVERSION 2,13,1068,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "352:         BEGIN",
          "353:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "354:             VALUE \"FileDescription\", \"Rufus\"",
          "356:             VALUE \"InternalName\", \"Rufus\"",
          "357:             VALUE \"LegalCopyright\", \"\ufffd 2011-2017 Pete Batard (GPL v3)\"",
          "358:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "359:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "360:             VALUE \"ProductName\", \"Rufus\"",
          "362:         END",
          "363:     END",
          "364:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1067\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1067\"",
          "",
          "[Added Lines]",
          "355:             VALUE \"FileVersion\", \"2.13.1068\"",
          "361:             VALUE \"ProductVersion\", \"2.13.1068\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "efe7ccb43c5f2a918634f8f717610b3f8796ddc5",
      "candidate_info": {
        "commit_hash": "efe7ccb43c5f2a918634f8f717610b3f8796ddc5",
        "repo": "pbatard/rufus",
        "commit_url": "https://github.com/pbatard/rufus/commit/efe7ccb43c5f2a918634f8f717610b3f8796ddc5",
        "files": [
          "src/rufus.c",
          "src/rufus.rc"
        ],
        "message": "[ui] fix an issue where the advanced toolbars may not display\n\n* Super-strange behaviour, that happens on Windows 7, at low zoom\n  factors, only when compiled with MSVC (MinGW is fine) and only\n  when the advanced options are set to be displayed on startup...\n* Looks like TB_GETIDEALSIZE is screwy - Thanks a lot Microsoft!",
        "before_after_code_files": [
          "src/rufus.c||src/rufus.c",
          "src/rufus.rc||src/rufus.rc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/rufus.rc||src/rufus.rc"
          ],
          "candidate": [
            "src/rufus.rc||src/rufus.rc"
          ]
        }
      },
      "candidate_diff": {
        "src/rufus.c||src/rufus.c": [
          "File: src/rufus.c -> src/rufus.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1847:  GetWindowRect(GetDlgItem(hDlg, IDC_ADVANCED_DRIVE_PROPERTIES), &rc);",
          "1848:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "1849:  SendMessage(hAdvancedDeviceToolbar, TB_GETIDEALSIZE, (WPARAM)FALSE, (LPARAM)&sz);",
          "1850:  SetWindowPos(hAdvancedDeviceToolbar, HWND_TOP, rc.left + toolbar_dx, rc.top, sz.cx, rc.bottom - rc.top, 0);",
          "1852:  utf8_to_wchar_no_alloc(lmprintf((advanced_mode_format) ? MSG_122 : MSG_121, lmprintf(MSG_120)), wtbtext[1], ARRAYSIZE(wtbtext[1]));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1851:  if (sz.cx < 16)",
          "1852:   sz.cx = fw;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1867:  GetWindowRect(GetDlgItem(hDlg, IDC_ADVANCED_FORMAT_OPTIONS), &rc);",
          "1868:  MapWindowPoints(NULL, hDlg, (POINT*)&rc, 2);",
          "1869:  SendMessage(hAdvancedFormatToolbar, TB_GETIDEALSIZE, (WPARAM)FALSE, (LPARAM)&sz);",
          "1870:  SetWindowPos(hAdvancedFormatToolbar, HWND_TOP, rc.left + toolbar_dx, rc.top, sz.cx, rc.bottom - rc.top, 0);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1873:  if (sz.cx < 16)",
          "1874:   sz.cx = fw;",
          "",
          "---------------"
        ],
        "src/rufus.rc||src/rufus.rc": [
          "File: src/rufus.rc -> src/rufus.rc",
          "--- Hunk 1 ---",
          "[Context before]",
          "33: IDD_DIALOG DIALOGEX 12, 12, 232, 326",
          "34: STYLE DS_SETFONT | DS_MODALFRAME | DS_CENTER | WS_MINIMIZEBOX | WS_POPUP | WS_CAPTION | WS_SYSMENU",
          "35: EXSTYLE WS_EX_ACCEPTFILES",
          "37: FONT 9, \"Segoe UI Symbol\", 400, 0, 0x0",
          "38: BEGIN",
          "39:     LTEXT           \"Drive Properties\",IDS_DRIVE_PROPERTIES_TXT,8,6,53,12,NOT WS_GROUP",
          "",
          "[Removed Lines]",
          "36: CAPTION \"Rufus 3.0.1237\"",
          "",
          "[Added Lines]",
          "36: CAPTION \"Rufus 3.0.1238\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "373: VS_VERSION_INFO VERSIONINFO",
          "376:  FILEFLAGSMASK 0x3fL",
          "377: #ifdef _DEBUG",
          "378:  FILEFLAGS 0x1L",
          "",
          "[Removed Lines]",
          "374:  FILEVERSION 2,18,1237,0",
          "375:  PRODUCTVERSION 2,18,1237,0",
          "",
          "[Added Lines]",
          "374:  FILEVERSION 2,18,1238,0",
          "375:  PRODUCTVERSION 2,18,1238,0",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "389:         BEGIN",
          "390:             VALUE \"CompanyName\", \"Akeo Consulting (http://akeo.ie)\"",
          "391:             VALUE \"FileDescription\", \"Rufus\"",
          "393:             VALUE \"InternalName\", \"Rufus\"",
          "394:             VALUE \"LegalCopyright\", \"\ufffd 2011-2018 Pete Batard (GPL v3)\"",
          "395:             VALUE \"LegalTrademarks\", \"http://www.gnu.org/copyleft/gpl.html\"",
          "396:             VALUE \"OriginalFilename\", \"rufus.exe\"",
          "397:             VALUE \"ProductName\", \"Rufus\"",
          "399:         END",
          "400:     END",
          "401:     BLOCK \"VarFileInfo\"",
          "",
          "[Removed Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1237\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1237\"",
          "",
          "[Added Lines]",
          "392:             VALUE \"FileVersion\", \"2.18.1238\"",
          "398:             VALUE \"ProductVersion\", \"2.18.1238\"",
          "",
          "---------------"
        ]
      }
    }
  ]
}