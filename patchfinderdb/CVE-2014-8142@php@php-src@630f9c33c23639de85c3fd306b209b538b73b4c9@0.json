{
  "cve_id": "CVE-2014-8142",
  "cve_desc": "Use-after-free vulnerability in the process_nested_data function in ext/standard/var_unserializer.re in PHP before 5.4.36, 5.5.x before 5.5.20, and 5.6.x before 5.6.4 allows remote attackers to execute arbitrary code via a crafted unserialize call that leverages improper handling of duplicate keys within the serialized properties of an object, a different vulnerability than CVE-2004-1019.",
  "repo": "php/php-src",
  "patch_hash": "630f9c33c23639de85c3fd306b209b538b73b4c9",
  "patch_info": {
    "commit_hash": "630f9c33c23639de85c3fd306b209b538b73b4c9",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/630f9c33c23639de85c3fd306b209b538b73b4c9",
    "files": [
      "NEWS",
      "ext/standard/tests/serialize/bug68594.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #68594 - Use after free vulnerability in unserialize()",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug68594.phpt||ext/standard/tests/serialize/bug68594.phpt": [
      "File: ext/standard/tests/serialize/bug68594.phpt -> ext/standard/tests/serialize/bug68594.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #68545 Use after free vulnerability in unserialize()",
      "3: --FILE--",
      "4: <?php",
      "5: for ($i=4; $i<100; $i++) {",
      "6:  $m = new StdClass();",
      "8:  $u = array(1);",
      "10:  $m->aaa = array(1,2,&$u,4,5);",
      "11:  $m->bbb = 1;",
      "12:  $m->ccc = &$u;",
      "13:  $m->ddd = str_repeat(\"A\", $i);",
      "15:  $z = serialize($m);",
      "16:  $z = str_replace(\"bbb\", \"aaa\", $z);",
      "17:  $y = unserialize($z);",
      "18:  $z = serialize($y);",
      "19: }",
      "20: ?>",
      "21: ===DONE===",
      "22: --EXPECTF--",
      "23: ===DONE===",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "343:   } else {",
      "345:    convert_to_string(key);",
      "346:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
      "347:      sizeof data, NULL);",
      "348:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "346:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
      "347:     var_push_dtor(var_hash, old_data);",
      "348:    }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "484: {",
      "485:  YYCTYPE yych;",
      "486:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "483: #line 484 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "486: #line 487 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "540:  yych = *(YYMARKER = ++YYCURSOR);",
      "541:  if (yych == ':') goto yy95;",
      "542: yy3:",
      "544:  { return 0; }",
      "546: yy4:",
      "547:  yych = *(YYMARKER = ++YYCURSOR);",
      "548:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "543: #line 835 \"ext/standard/var_unserializer.re\"",
      "545: #line 546 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "546: #line 838 \"ext/standard/var_unserializer.re\"",
      "548: #line 549 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "585:  goto yy3;",
      "586: yy14:",
      "587:  ++YYCURSOR;",
      "589:  {",
      "591:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "593: }",
      "595: yy16:",
      "596:  yych = *++YYCURSOR;",
      "597:  goto yy3;",
      "",
      "[Removed Lines]",
      "588: #line 829 \"ext/standard/var_unserializer.re\"",
      "594: #line 595 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "591: #line 832 \"ext/standard/var_unserializer.re\"",
      "597: #line 598 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "617:  if (yybm[0+yych] & 128) {",
      "618:   goto yy20;",
      "619:  }",
      "621:  yych = *++YYCURSOR;",
      "622:  if (yych != '\"') goto yy18;",
      "623:  ++YYCURSOR;",
      "625:  {",
      "626:  size_t len, len2, len3, maxlen;",
      "627:  long elements;",
      "",
      "[Removed Lines]",
      "620:  if (yych != ':') goto yy18;",
      "624: #line 683 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "623:  if (yych <= '/') goto yy18;",
      "624:  if (yych >= ';') goto yy18;",
      "628: #line 686 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "768:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "769: }",
      "771: yy25:",
      "772:  yych = *++YYCURSOR;",
      "773:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "770: #line 771 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "774: #line 775 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "792:  yych = *++YYCURSOR;",
      "793:  if (yych != '\"') goto yy18;",
      "794:  ++YYCURSOR;",
      "796:  {",
      "798:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "795: #line 675 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "799: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "800:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "801:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "802: }",
      "804: yy32:",
      "805:  yych = *++YYCURSOR;",
      "806:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "803: #line 804 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "807: #line 808 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "821:  yych = *++YYCURSOR;",
      "822:  if (yych != '{') goto yy18;",
      "823:  ++YYCURSOR;",
      "825:  {",
      "826:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "824: #line 655 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "828: #line 658 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "842:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "843: }",
      "845: yy39:",
      "846:  yych = *++YYCURSOR;",
      "847:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "844: #line 845 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "848: #line 849 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "862:  yych = *++YYCURSOR;",
      "863:  if (yych != '\"') goto yy18;",
      "864:  ++YYCURSOR;",
      "866:  {",
      "867:  size_t len, maxlen;",
      "868:  char *str;",
      "",
      "[Removed Lines]",
      "865: #line 626 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "869: #line 629 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "891:  ZVAL_STRINGL(*rval, str, len, 0);",
      "892:  return 1;",
      "893: }",
      "895: yy46:",
      "896:  yych = *++YYCURSOR;",
      "897:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "894: #line 895 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "898: #line 899 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "912:  yych = *++YYCURSOR;",
      "913:  if (yych != '\"') goto yy18;",
      "914:  ++YYCURSOR;",
      "916:  {",
      "917:  size_t len, maxlen;",
      "918:  char *str;",
      "",
      "[Removed Lines]",
      "915: #line 598 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "919: #line 601 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "940:  ZVAL_STRINGL(*rval, str, len, 1);",
      "941:  return 1;",
      "942: }",
      "944: yy53:",
      "945:  yych = *++YYCURSOR;",
      "946:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "943: #line 944 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "947: #line 948 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1028:  }",
      "1029: yy63:",
      "1030:  ++YYCURSOR;",
      "1032:  {",
      "1033: #if SIZEOF_LONG == 4",
      "1034: use_double:",
      "",
      "[Removed Lines]",
      "1031: #line 588 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1035: #line 591 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1038:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1039:  return 1;",
      "1040: }",
      "1042: yy65:",
      "1043:  yych = *++YYCURSOR;",
      "1044:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1041: #line 1042 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1045: #line 1046 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1097:  yych = *++YYCURSOR;",
      "1098:  if (yych != ';') goto yy18;",
      "1099:  ++YYCURSOR;",
      "1101:  {",
      "1103:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1100: #line 573 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1104: #line 576 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1113:  return 1;",
      "1114: }",
      "1116: yy76:",
      "1117:  yych = *++YYCURSOR;",
      "1118:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1115: #line 1116 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1119: #line 1120 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1139:  if (yych <= '9') goto yy79;",
      "1140:  if (yych != ';') goto yy18;",
      "1141:  ++YYCURSOR;",
      "1143:  {",
      "1144: #if SIZEOF_LONG == 4",
      "1145:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1142: #line 546 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1146: #line 549 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1166:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1167:  return 1;",
      "1168: }",
      "1170: yy83:",
      "1171:  yych = *++YYCURSOR;",
      "1172:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1169: #line 1170 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1173: #line 1174 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1174:  yych = *++YYCURSOR;",
      "1175:  if (yych != ';') goto yy18;",
      "1176:  ++YYCURSOR;",
      "1178:  {",
      "1180:  INIT_PZVAL(*rval);",
      "1181:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1182:  return 1;",
      "1183: }",
      "1185: yy87:",
      "1186:  ++YYCURSOR;",
      "1188:  {",
      "1190:  INIT_PZVAL(*rval);",
      "1191:  ZVAL_NULL(*rval);",
      "1192:  return 1;",
      "1193: }",
      "1195: yy89:",
      "1196:  yych = *++YYCURSOR;",
      "1197:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1177: #line 539 \"ext/standard/var_unserializer.re\"",
      "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
      "1187: #line 532 \"ext/standard/var_unserializer.re\"",
      "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1181: #line 542 \"ext/standard/var_unserializer.re\"",
      "1188: #line 1189 \"ext/standard/var_unserializer.c\"",
      "1191: #line 535 \"ext/standard/var_unserializer.re\"",
      "1198: #line 1199 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1214:  if (yych <= '9') goto yy91;",
      "1215:  if (yych != ';') goto yy18;",
      "1216:  ++YYCURSOR;",
      "1218:  {",
      "1219:  long id;",
      "",
      "[Removed Lines]",
      "1217: #line 509 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1221: #line 512 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1238:  return 1;",
      "1239: }",
      "1241: yy95:",
      "1242:  yych = *++YYCURSOR;",
      "1243:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1240: #line 1241 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1244: #line 1245 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1260:  if (yych <= '9') goto yy97;",
      "1261:  if (yych != ';') goto yy18;",
      "1262:  ++YYCURSOR;",
      "1264:  {",
      "1265:  long id;",
      "",
      "[Removed Lines]",
      "1263: #line 488 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1267: #line 491 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1282:  return 1;",
      "1283: }",
      "1285: }",
      "1289:  return 0;",
      "",
      "[Removed Lines]",
      "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
      "1286: #line 837 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1288: #line 1289 \"ext/standard/var_unserializer.c\"",
      "1290: #line 840 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "347:   } else {",
      "349:    convert_to_string(key);",
      "350:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
      "351:      sizeof data, NULL);",
      "352:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "350:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
      "351:     var_push_dtor(var_hash, old_data);",
      "352:    }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f4f068000ba3b99c0d9910fa11d2ca13d748958b",
      "candidate_info": {
        "commit_hash": "f4f068000ba3b99c0d9910fa11d2ca13d748958b",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/f4f068000ba3b99c0d9910fa11d2ca13d748958b",
        "files": [
          "ext/standard/tests/strings/bug68710.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fix for bug #68710 (Use After Free Vulnerability in PHP's unserialize())\n\nConflicts:\n\text/standard/var_unserializer.c",
        "before_after_code_files": [
          "ext/standard/tests/strings/bug68710.phpt||ext/standard/tests/strings/bug68710.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/strings/bug68710.phpt||ext/standard/tests/strings/bug68710.phpt": [
          "File: ext/standard/tests/strings/bug68710.phpt -> ext/standard/tests/strings/bug68710.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68710 Use after free vulnerability in unserialize() (bypassing the",
          "3: CVE-2014-8142 fix)",
          "4: --FILE--",
          "5: <?php",
          "6: for ($i=4; $i<100; $i++) {",
          "7:     $m = new StdClass();",
          "9:     $u = array(1);",
          "11:     $m->aaa = array(1,2,&$u,4,5);",
          "12:     $m->bbb = 1;",
          "13:     $m->ccc = &$u;",
          "14:     $m->ddd = str_repeat(\"A\", $i);",
          "16:     $z = serialize($m);",
          "17:     $z = str_replace(\"aaa\", \"123\", $z);",
          "18:     $z = str_replace(\"bbb\", \"123\", $z);",
          "19:     $y = unserialize($z);",
          "20:     $z = serialize($y);",
          "21: }",
          "22: ?>",
          "23: ===DONE===",
          "24: --EXPECTF--",
          "25: ===DONE===",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "342:   } else {",
          "344:    convert_to_string(key);",
          "346:     var_push_dtor(var_hash, old_data);",
          "347:    }",
          "348:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "",
          "[Removed Lines]",
          "345:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "",
          "[Added Lines]",
          "345:    if (zend_hash_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "346:   } else {",
          "348:    convert_to_string(key);",
          "350:     var_push_dtor(var_hash, old_data);",
          "351:    }",
          "352:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "",
          "[Removed Lines]",
          "349:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "",
          "[Added Lines]",
          "349:    if (zend_hash_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "df4bf28f9f104ca3ef78ed94b497859f15b004e5",
      "candidate_info": {
        "commit_hash": "df4bf28f9f104ca3ef78ed94b497859f15b004e5",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/df4bf28f9f104ca3ef78ed94b497859f15b004e5",
        "files": [
          "ext/session/session.c",
          "ext/session/tests/session_decode_error2.phpt",
          "ext/session/tests/session_decode_variation3.phpt",
          "ext/standard/tests/serialize/bug70219.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fix bug #70219 (Use after free vulnerability in session deserializer)",
        "before_after_code_files": [
          "ext/session/session.c||ext/session/session.c",
          "ext/session/tests/session_decode_error2.phpt||ext/session/tests/session_decode_error2.phpt",
          "ext/session/tests/session_decode_variation3.phpt||ext/session/tests/session_decode_variation3.phpt",
          "ext/standard/tests/serialize/bug70219.phpt||ext/standard/tests/serialize/bug70219.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/session/session.c||ext/session/session.c": [
          "File: ext/session/session.c -> ext/session/session.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "210: }",
          "214: {",
          "215:  if (!PS(serializer)) {",
          "216:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Unknown session.serialize_handler. Failed to decode session object\");",
          "218:  }",
          "219:  if (PS(serializer)->decode(val, vallen TSRMLS_CC) == FAILURE) {",
          "220:   php_session_destroy(TSRMLS_C);",
          "221:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Failed to decode session object. Session has been destroyed\");",
          "222:  }",
          "223: }",
          "",
          "[Removed Lines]",
          "217:   return;",
          "",
          "[Added Lines]",
          "217:   return FAILURE;",
          "222:   return FAILURE;",
          "224:  return SUCCESS;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "855:    ALLOC_INIT_ZVAL(current);",
          "856:    if (php_var_unserialize(&current, (const unsigned char **) &p, (const unsigned char *) endptr, &var_hash TSRMLS_CC)) {",
          "857:     php_set_session_var(name, namelen, current, &var_hash  TSRMLS_CC);",
          "858:    }",
          "860:   }",
          "861:   PS_ADD_VARL(name, namelen);",
          "862:   efree(name);",
          "",
          "[Removed Lines]",
          "859:    zval_ptr_dtor(&current);",
          "",
          "[Added Lines]",
          "860:    } else {",
          "861:     PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "862:     return FAILURE;",
          "864:    var_push_dtor_no_addref(&var_hash, &current);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "947:    ALLOC_INIT_ZVAL(current);",
          "948:    if (php_var_unserialize(&current, (const unsigned char **) &q, (const unsigned char *) endptr, &var_hash TSRMLS_CC)) {",
          "949:     php_set_session_var(name, namelen, current, &var_hash  TSRMLS_CC);",
          "950:    }",
          "952:   }",
          "953:   PS_ADD_VARL(name, namelen);",
          "954: skip:",
          "",
          "[Removed Lines]",
          "951:    zval_ptr_dtor(&current);",
          "",
          "[Added Lines]",
          "955:    } else {",
          "956:     var_push_dtor_no_addref(&var_hash, &current);",
          "957:     efree(name);",
          "958:     PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "959:     return FAILURE;",
          "961:    var_push_dtor_no_addref(&var_hash, &current);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1922:   return;",
          "1923:  }",
          "1928: }",
          "",
          "[Removed Lines]",
          "1925:  php_session_decode(str, str_len TSRMLS_CC);",
          "1927:  RETURN_TRUE;",
          "",
          "[Added Lines]",
          "1935:  RETVAL_BOOL(php_session_decode(str, str_len TSRMLS_CC) == SUCCESS);",
          "",
          "---------------"
        ],
        "ext/session/tests/session_decode_error2.phpt||ext/session/tests/session_decode_error2.phpt": [
          "File: ext/session/tests/session_decode_error2.phpt -> ext/session/tests/session_decode_error2.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "53: }",
          "55: -- Iteration 4 --",
          "60: }",
          "62: -- Iteration 5 --",
          "67: }",
          "69: -- Iteration 6 --",
          "74: }",
          "76: -- Iteration 7 --",
          "81: }",
          "83: -- Iteration 8 --",
          "88: }",
          "90: -- Iteration 9 --",
          "95: }",
          "97: -- Iteration 10 --",
          "102: }",
          "104: -- Iteration 11 --",
          "109: }",
          "111: -- Iteration 12 --",
          "116: }",
          "118: -- Iteration 13 --",
          "123: }",
          "125: -- Iteration 14 --",
          "130: }",
          "132: -- Iteration 15 --",
          "137: }",
          "139: -- Iteration 16 --",
          "144: }",
          "146: -- Iteration 17 --",
          "151: }",
          "153: -- Iteration 18 --",
          "158: }",
          "160: -- Iteration 19 --",
          "165: }",
          "167: -- Iteration 20 --",
          "172: }",
          "174: -- Iteration 21 --",
          "179: }",
          "181: -- Iteration 22 --",
          "186: }",
          "188: -- Iteration 23 --",
          "193: }",
          "195: -- Iteration 24 --",
          "200: }",
          "202: -- Iteration 25 --",
          "207: }",
          "209: -- Iteration 26 --",
          "214: }",
          "216: -- Iteration 27 --",
          "221: }",
          "223: -- Iteration 28 --",
          "228: }",
          "230: -- Iteration 29 --",
          "235: }",
          "237: -- Iteration 30 --",
          "242: }",
          "244: -- Iteration 31 --",
          "249: }",
          "251: -- Iteration 32 --",
          "256: }",
          "258: -- Iteration 33 --",
          "263: }",
          "265: -- Iteration 34 --",
          "277: }",
          "279: -- Iteration 35 --",
          "291: }",
          "293: -- Iteration 36 --",
          "305: }",
          "307: -- Iteration 37 --",
          "319: }",
          "321: -- Iteration 38 --",
          "333: }",
          "335: -- Iteration 39 --",
          "349: }",
          "351: -- Iteration 40 --",
          "365: }",
          "367: -- Iteration 41 --",
          "381: }",
          "383: -- Iteration 42 --",
          "397: }",
          "399: -- Iteration 43 --",
          "420: }",
          "422: -- Iteration 44 --",
          "443: }",
          "445: -- Iteration 45 --",
          "466: }",
          "468: -- Iteration 46 --",
          "489: }",
          "491: -- Iteration 47 --",
          "512: }",
          "514: -- Iteration 48 --",
          "537: }",
          "539: -- Iteration 49 --",
          "562: }",
          "564: -- Iteration 50 --",
          "587: }",
          "589: -- Iteration 51 --",
          "612: }",
          "",
          "[Removed Lines]",
          "56: bool(true)",
          "57: array(1) {",
          "58:   [\"foo\"]=>",
          "59:   NULL",
          "63: bool(true)",
          "64: array(1) {",
          "65:   [\"foo\"]=>",
          "66:   NULL",
          "70: bool(true)",
          "71: array(1) {",
          "72:   [\"foo\"]=>",
          "73:   NULL",
          "77: bool(true)",
          "78: array(1) {",
          "79:   [\"foo\"]=>",
          "80:   NULL",
          "84: bool(true)",
          "85: array(1) {",
          "86:   [\"foo\"]=>",
          "87:   NULL",
          "91: bool(true)",
          "92: array(1) {",
          "93:   [\"foo\"]=>",
          "94:   NULL",
          "98: bool(true)",
          "99: array(1) {",
          "100:   [\"foo\"]=>",
          "101:   NULL",
          "105: bool(true)",
          "106: array(1) {",
          "107:   [\"foo\"]=>",
          "108:   NULL",
          "112: bool(true)",
          "113: array(1) {",
          "114:   [\"foo\"]=>",
          "115:   NULL",
          "119: bool(true)",
          "120: array(1) {",
          "121:   [\"foo\"]=>",
          "122:   NULL",
          "126: bool(true)",
          "127: array(1) {",
          "128:   [\"foo\"]=>",
          "129:   NULL",
          "133: bool(true)",
          "134: array(1) {",
          "135:   [\"foo\"]=>",
          "136:   NULL",
          "140: bool(true)",
          "141: array(1) {",
          "142:   [\"foo\"]=>",
          "143:   NULL",
          "147: bool(true)",
          "148: array(1) {",
          "149:   [\"foo\"]=>",
          "150:   NULL",
          "154: bool(true)",
          "155: array(1) {",
          "156:   [\"foo\"]=>",
          "157:   NULL",
          "161: bool(true)",
          "162: array(1) {",
          "163:   [\"foo\"]=>",
          "164:   NULL",
          "168: bool(true)",
          "169: array(1) {",
          "170:   [\"foo\"]=>",
          "171:   NULL",
          "175: bool(true)",
          "176: array(1) {",
          "177:   [\"foo\"]=>",
          "178:   NULL",
          "182: bool(true)",
          "183: array(1) {",
          "184:   [\"foo\"]=>",
          "185:   NULL",
          "189: bool(true)",
          "190: array(1) {",
          "191:   [\"foo\"]=>",
          "192:   NULL",
          "196: bool(true)",
          "197: array(1) {",
          "198:   [\"foo\"]=>",
          "199:   NULL",
          "203: bool(true)",
          "204: array(1) {",
          "205:   [\"foo\"]=>",
          "206:   NULL",
          "210: bool(true)",
          "211: array(1) {",
          "212:   [\"foo\"]=>",
          "213:   NULL",
          "217: bool(true)",
          "218: array(1) {",
          "219:   [\"foo\"]=>",
          "220:   NULL",
          "224: bool(true)",
          "225: array(1) {",
          "226:   [\"foo\"]=>",
          "227:   NULL",
          "231: bool(true)",
          "232: array(1) {",
          "233:   [\"foo\"]=>",
          "234:   NULL",
          "238: bool(true)",
          "239: array(1) {",
          "240:   [\"foo\"]=>",
          "241:   NULL",
          "245: bool(true)",
          "246: array(1) {",
          "247:   [\"foo\"]=>",
          "248:   NULL",
          "252: bool(true)",
          "253: array(1) {",
          "254:   [\"foo\"]=>",
          "255:   NULL",
          "259: bool(true)",
          "260: array(1) {",
          "261:   [\"foo\"]=>",
          "262:   NULL",
          "266: bool(true)",
          "267: array(1) {",
          "268:   [\"foo\"]=>",
          "269:   array(3) {",
          "270:     [0]=>",
          "271:     int(1)",
          "272:     [1]=>",
          "273:     int(2)",
          "274:     [2]=>",
          "275:     int(3)",
          "276:   }",
          "280: bool(true)",
          "281: array(1) {",
          "282:   [\"foo\"]=>",
          "283:   array(3) {",
          "284:     [0]=>",
          "285:     int(1)",
          "286:     [1]=>",
          "287:     int(2)",
          "288:     [2]=>",
          "289:     int(3)",
          "290:   }",
          "294: bool(true)",
          "295: array(1) {",
          "296:   [\"foo\"]=>",
          "297:   array(3) {",
          "298:     [0]=>",
          "299:     int(1)",
          "300:     [1]=>",
          "301:     int(2)",
          "302:     [2]=>",
          "303:     int(3)",
          "304:   }",
          "308: bool(true)",
          "309: array(1) {",
          "310:   [\"foo\"]=>",
          "311:   array(3) {",
          "312:     [0]=>",
          "313:     int(1)",
          "314:     [1]=>",
          "315:     int(2)",
          "316:     [2]=>",
          "317:     int(3)",
          "318:   }",
          "322: bool(true)",
          "323: array(1) {",
          "324:   [\"foo\"]=>",
          "325:   array(3) {",
          "326:     [0]=>",
          "327:     int(1)",
          "328:     [1]=>",
          "329:     int(2)",
          "330:     [2]=>",
          "331:     int(3)",
          "332:   }",
          "336: bool(true)",
          "337: array(2) {",
          "338:   [\"foo\"]=>",
          "339:   array(3) {",
          "340:     [0]=>",
          "341:     int(1)",
          "342:     [1]=>",
          "343:     int(2)",
          "344:     [2]=>",
          "345:     int(3)",
          "346:   }",
          "347:   [\"guff\"]=>",
          "348:   NULL",
          "352: bool(true)",
          "353: array(2) {",
          "354:   [\"foo\"]=>",
          "355:   array(3) {",
          "356:     [0]=>",
          "357:     int(1)",
          "358:     [1]=>",
          "359:     int(2)",
          "360:     [2]=>",
          "361:     int(3)",
          "362:   }",
          "363:   [\"guff\"]=>",
          "364:   NULL",
          "368: bool(true)",
          "369: array(2) {",
          "370:   [\"foo\"]=>",
          "371:   array(3) {",
          "372:     [0]=>",
          "373:     int(1)",
          "374:     [1]=>",
          "375:     int(2)",
          "376:     [2]=>",
          "377:     int(3)",
          "378:   }",
          "379:   [\"guff\"]=>",
          "380:   NULL",
          "384: bool(true)",
          "385: array(2) {",
          "386:   [\"foo\"]=>",
          "387:   array(3) {",
          "388:     [0]=>",
          "389:     int(1)",
          "390:     [1]=>",
          "391:     int(2)",
          "392:     [2]=>",
          "393:     int(3)",
          "394:   }",
          "395:   [\"guff\"]=>",
          "396:   NULL",
          "400: bool(true)",
          "401: array(2) {",
          "402:   [\"foo\"]=>",
          "403:   &array(3) {",
          "404:     [0]=>",
          "405:     int(1)",
          "406:     [1]=>",
          "407:     int(2)",
          "408:     [2]=>",
          "409:     int(3)",
          "410:   }",
          "411:   [\"guff\"]=>",
          "412:   &array(3) {",
          "413:     [0]=>",
          "414:     int(1)",
          "415:     [1]=>",
          "416:     int(2)",
          "417:     [2]=>",
          "418:     int(3)",
          "419:   }",
          "423: bool(true)",
          "424: array(2) {",
          "425:   [\"foo\"]=>",
          "426:   &array(3) {",
          "427:     [0]=>",
          "428:     int(1)",
          "429:     [1]=>",
          "430:     int(2)",
          "431:     [2]=>",
          "432:     int(3)",
          "433:   }",
          "434:   [\"guff\"]=>",
          "435:   &array(3) {",
          "436:     [0]=>",
          "437:     int(1)",
          "438:     [1]=>",
          "439:     int(2)",
          "440:     [2]=>",
          "441:     int(3)",
          "442:   }",
          "446: bool(true)",
          "447: array(2) {",
          "448:   [\"foo\"]=>",
          "449:   &array(3) {",
          "450:     [0]=>",
          "451:     int(1)",
          "452:     [1]=>",
          "453:     int(2)",
          "454:     [2]=>",
          "455:     int(3)",
          "456:   }",
          "457:   [\"guff\"]=>",
          "458:   &array(3) {",
          "459:     [0]=>",
          "460:     int(1)",
          "461:     [1]=>",
          "462:     int(2)",
          "463:     [2]=>",
          "464:     int(3)",
          "465:   }",
          "469: bool(true)",
          "470: array(2) {",
          "471:   [\"foo\"]=>",
          "472:   &array(3) {",
          "473:     [0]=>",
          "474:     int(1)",
          "475:     [1]=>",
          "476:     int(2)",
          "477:     [2]=>",
          "478:     int(3)",
          "479:   }",
          "480:   [\"guff\"]=>",
          "481:   &array(3) {",
          "482:     [0]=>",
          "483:     int(1)",
          "484:     [1]=>",
          "485:     int(2)",
          "486:     [2]=>",
          "487:     int(3)",
          "488:   }",
          "492: bool(true)",
          "493: array(2) {",
          "494:   [\"foo\"]=>",
          "495:   &array(3) {",
          "496:     [0]=>",
          "497:     int(1)",
          "498:     [1]=>",
          "499:     int(2)",
          "500:     [2]=>",
          "501:     int(3)",
          "502:   }",
          "503:   [\"guff\"]=>",
          "504:   &array(3) {",
          "505:     [0]=>",
          "506:     int(1)",
          "507:     [1]=>",
          "508:     int(2)",
          "509:     [2]=>",
          "510:     int(3)",
          "511:   }",
          "515: bool(true)",
          "516: array(3) {",
          "517:   [\"foo\"]=>",
          "518:   &array(3) {",
          "519:     [0]=>",
          "520:     int(1)",
          "521:     [1]=>",
          "522:     int(2)",
          "523:     [2]=>",
          "524:     int(3)",
          "525:   }",
          "526:   [\"guff\"]=>",
          "527:   &array(3) {",
          "528:     [0]=>",
          "529:     int(1)",
          "530:     [1]=>",
          "531:     int(2)",
          "532:     [2]=>",
          "533:     int(3)",
          "534:   }",
          "535:   [\"blah\"]=>",
          "536:   NULL",
          "540: bool(true)",
          "541: array(3) {",
          "542:   [\"foo\"]=>",
          "543:   &array(3) {",
          "544:     [0]=>",
          "545:     int(1)",
          "546:     [1]=>",
          "547:     int(2)",
          "548:     [2]=>",
          "549:     int(3)",
          "550:   }",
          "551:   [\"guff\"]=>",
          "552:   &array(3) {",
          "553:     [0]=>",
          "554:     int(1)",
          "555:     [1]=>",
          "556:     int(2)",
          "557:     [2]=>",
          "558:     int(3)",
          "559:   }",
          "560:   [\"blah\"]=>",
          "561:   NULL",
          "565: bool(true)",
          "566: array(3) {",
          "567:   [\"foo\"]=>",
          "568:   &array(3) {",
          "569:     [0]=>",
          "570:     int(1)",
          "571:     [1]=>",
          "572:     int(2)",
          "573:     [2]=>",
          "574:     int(3)",
          "575:   }",
          "576:   [\"guff\"]=>",
          "577:   &array(3) {",
          "578:     [0]=>",
          "579:     int(1)",
          "580:     [1]=>",
          "581:     int(2)",
          "582:     [2]=>",
          "583:     int(3)",
          "584:   }",
          "585:   [\"blah\"]=>",
          "586:   NULL",
          "590: bool(true)",
          "591: array(3) {",
          "592:   [\"foo\"]=>",
          "593:   &array(3) {",
          "594:     [0]=>",
          "595:     int(1)",
          "596:     [1]=>",
          "597:     int(2)",
          "598:     [2]=>",
          "599:     int(3)",
          "600:   }",
          "601:   [\"guff\"]=>",
          "602:   &array(3) {",
          "603:     [0]=>",
          "604:     int(1)",
          "605:     [1]=>",
          "606:     int(2)",
          "607:     [2]=>",
          "608:     int(3)",
          "609:   }",
          "610:   [\"blah\"]=>",
          "611:   NULL",
          "613: bool(true)",
          "614: Done",
          "",
          "[Added Lines]",
          "57: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "58: bool(false)",
          "59: array(0) {",
          "63: bool(false)",
          "64: array(0) {",
          "68: bool(false)",
          "69: array(0) {",
          "73: bool(false)",
          "74: array(0) {",
          "78: bool(false)",
          "79: array(0) {",
          "83: bool(false)",
          "84: array(0) {",
          "88: bool(false)",
          "89: array(0) {",
          "93: bool(false)",
          "94: array(0) {",
          "98: bool(false)",
          "99: array(0) {",
          "103: bool(false)",
          "104: array(0) {",
          "108: bool(false)",
          "109: array(0) {",
          "113: bool(false)",
          "114: array(0) {",
          "118: bool(false)",
          "119: array(0) {",
          "123: bool(false)",
          "124: array(0) {",
          "128: bool(false)",
          "129: array(0) {",
          "133: bool(false)",
          "134: array(0) {",
          "138: bool(false)",
          "139: array(0) {",
          "143: bool(false)",
          "144: array(0) {",
          "148: bool(false)",
          "149: array(0) {",
          "153: bool(false)",
          "154: array(0) {",
          "158: bool(false)",
          "159: array(0) {",
          "163: bool(false)",
          "164: array(0) {",
          "168: bool(false)",
          "169: array(0) {",
          "173: bool(false)",
          "174: array(0) {",
          "178: bool(false)",
          "179: array(0) {",
          "183: bool(false)",
          "184: array(0) {",
          "188: bool(false)",
          "189: array(0) {",
          "193: bool(false)",
          "194: array(0) {",
          "198: bool(false)",
          "199: array(0) {",
          "203: bool(false)",
          "204: array(0) {",
          "208: bool(false)",
          "209: array(0) {",
          "213: bool(false)",
          "214: array(0) {",
          "218: bool(false)",
          "219: array(0) {",
          "223: bool(false)",
          "224: array(0) {",
          "228: bool(false)",
          "229: array(0) {",
          "233: bool(false)",
          "234: array(0) {",
          "238: bool(false)",
          "239: array(0) {",
          "243: bool(false)",
          "244: array(0) {",
          "248: bool(false)",
          "249: array(0) {",
          "253: bool(false)",
          "254: array(0) {",
          "258: bool(false)",
          "259: array(0) {",
          "263: bool(false)",
          "264: array(0) {",
          "268: bool(false)",
          "269: array(0) {",
          "273: bool(false)",
          "274: array(0) {",
          "278: bool(false)",
          "279: array(0) {",
          "283: bool(false)",
          "284: array(0) {",
          "288: bool(false)",
          "289: array(0) {",
          "293: bool(false)",
          "294: array(0) {",
          "297: Warning: session_destroy(): Trying to destroy uninitialized session in %s/session_decode_error2.php on line %d",
          "298: bool(false)",
          "299: Done",
          "",
          "---------------"
        ],
        "ext/session/tests/session_decode_variation3.phpt||ext/session/tests/session_decode_variation3.phpt": [
          "File: ext/session/tests/session_decode_variation3.phpt -> ext/session/tests/session_decode_variation3.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "49: }",
          "51: Warning: session_decode(): Unknown session.serialize_handler. Failed to decode session object in %s on line %d",
          "53: array(3) {",
          "54:   [\"foo\"]=>",
          "55:   int(1234567890)",
          "",
          "[Removed Lines]",
          "52: bool(true)",
          "",
          "[Added Lines]",
          "52: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70219.phpt||ext/standard/tests/serialize/bug70219.phpt": [
          "File: ext/standard/tests/serialize/bug70219.phpt -> ext/standard/tests/serialize/bug70219.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70219 Use after free vulnerability in session deserializer",
          "3: --FILE--",
          "4: <?php",
          "5: class obj implements Serializable {",
          "6:     var $data;",
          "7:     function serialize() {",
          "8:         return serialize($this->data);",
          "9:     }",
          "10:     function unserialize($data) {",
          "11:         session_start();",
          "12:         session_decode($data);",
          "13:     }",
          "14: }",
          "16: $inner = 'ryat|a:1:{i:0;a:1:{i:1;';",
          "17: $exploit = 'a:2:{i:0;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}i:1;R:4;}';",
          "19: $data = unserialize($exploit);",
          "21: for ($i = 0; $i < 5; $i++) {",
          "22:     $v[$i] = 'hi'.$i;",
          "23: }",
          "25: var_dump($data);",
          "26: ?>",
          "27: --EXPECTF--",
          "28: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s on line %d",
          "29: array(2) {",
          "30:   [0]=>",
          "31:   object(obj)#%d (1) {",
          "32:     [\"data\"]=>",
          "33:     NULL",
          "34:   }",
          "35:   [1]=>",
          "36:   array(0) {",
          "37:   }",
          "38: }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "93: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval **rval)",
          "94: {",
          "96: #if VAR_ENTRIES_DBG",
          "97:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "98: #endif",
          "",
          "[Removed Lines]",
          "95:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "",
          "[Added Lines]",
          "95:  var_entries *var_hash;",
          "97:     if (!var_hashx || !*var_hashx) {",
          "98:         return;",
          "99:     }",
          "101:     var_hash = (*var_hashx)->last_dtor;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "233: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "236: #line 241 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "242: #line 247 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "304:   ALLOC_INIT_ZVAL(key);",
          "306:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "309:    return 0;",
          "310:   }",
          "312:   if (Z_TYPE_P(key) != IS_LONG && Z_TYPE_P(key) != IS_STRING) {",
          "315:    return 0;",
          "316:   }",
          "318:   ALLOC_INIT_ZVAL(data);",
          "320:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "325:    return 0;",
          "326:   }",
          "",
          "[Removed Lines]",
          "307:    zval_dtor(key);",
          "308:    FREE_ZVAL(key);",
          "313:    zval_dtor(key);",
          "314:    FREE_ZVAL(key);",
          "321:    zval_dtor(key);",
          "322:    FREE_ZVAL(key);",
          "323:    zval_dtor(data);",
          "324:    FREE_ZVAL(data);",
          "",
          "[Added Lines]",
          "313:             var_push_dtor_no_addref(var_hash, &key);",
          "318:             var_push_dtor_no_addref(var_hash, &key);",
          "325:             var_push_dtor_no_addref(var_hash, &key);",
          "326:             var_push_dtor_no_addref(var_hash, &data);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "350:      sizeof data, NULL);",
          "351:   }",
          "352:   var_push_dtor(var_hash, &data);",
          "357:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "358:    (*p)--;",
          "",
          "[Removed Lines]",
          "354:   zval_dtor(key);",
          "355:   FREE_ZVAL(key);",
          "",
          "[Added Lines]",
          "355:         var_push_dtor_no_addref(var_hash, &key);",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "91: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval **rval)",
          "92: {",
          "94: #if VAR_ENTRIES_DBG",
          "95:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "96: #endif",
          "",
          "[Removed Lines]",
          "93:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "",
          "[Added Lines]",
          "93:  var_entries *var_hash;",
          "95:     if (!var_hashx || !*var_hashx) {",
          "96:         return;",
          "97:     }",
          "99:     var_hash = (*var_hashx)->last_dtor;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "308:   ALLOC_INIT_ZVAL(key);",
          "310:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "313:    return 0;",
          "314:   }",
          "316:   if (Z_TYPE_P(key) != IS_LONG && Z_TYPE_P(key) != IS_STRING) {",
          "319:    return 0;",
          "320:   }",
          "322:   ALLOC_INIT_ZVAL(data);",
          "324:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "329:    return 0;",
          "330:   }",
          "",
          "[Removed Lines]",
          "311:    zval_dtor(key);",
          "312:    FREE_ZVAL(key);",
          "317:    zval_dtor(key);",
          "318:    FREE_ZVAL(key);",
          "325:    zval_dtor(key);",
          "326:    FREE_ZVAL(key);",
          "327:    zval_dtor(data);",
          "328:    FREE_ZVAL(data);",
          "",
          "[Added Lines]",
          "317:             var_push_dtor_no_addref(var_hash, &key);",
          "322:             var_push_dtor_no_addref(var_hash, &key);",
          "329:             var_push_dtor_no_addref(var_hash, &key);",
          "330:             var_push_dtor_no_addref(var_hash, &data);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "354:      sizeof data, NULL);",
          "355:   }",
          "356:   var_push_dtor(var_hash, &data);",
          "361:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "362:    (*p)--;",
          "",
          "[Removed Lines]",
          "358:   zval_dtor(key);",
          "359:   FREE_ZVAL(key);",
          "",
          "[Added Lines]",
          "359:         var_push_dtor_no_addref(var_hash, &key);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6735df19b8a1c4095e2d6716fcd058582fa05930",
      "candidate_info": {
        "commit_hash": "6735df19b8a1c4095e2d6716fcd058582fa05930",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/6735df19b8a1c4095e2d6716fcd058582fa05930",
        "files": [
          "ext/standard/tests/strings/bug68710.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fix for bug #68710 (Use After Free Vulnerability in PHP's unserialize())\n\nConflicts:\n\text/standard/var_unserializer.c",
        "before_after_code_files": [
          "ext/standard/tests/strings/bug68710.phpt||ext/standard/tests/strings/bug68710.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/strings/bug68710.phpt||ext/standard/tests/strings/bug68710.phpt": [
          "File: ext/standard/tests/strings/bug68710.phpt -> ext/standard/tests/strings/bug68710.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68710 Use after free vulnerability in unserialize() (bypassing the",
          "3: CVE-2014-8142 fix)",
          "4: --FILE--",
          "5: <?php",
          "6: for ($i=4; $i<100; $i++) {",
          "7:     $m = new StdClass();",
          "9:     $u = array(1);",
          "11:     $m->aaa = array(1,2,&$u,4,5);",
          "12:     $m->bbb = 1;",
          "13:     $m->ccc = &$u;",
          "14:     $m->ddd = str_repeat(\"A\", $i);",
          "16:     $z = serialize($m);",
          "17:     $z = str_replace(\"aaa\", \"123\", $z);",
          "18:     $z = str_replace(\"bbb\", \"123\", $z);",
          "19:     $y = unserialize($z);",
          "20:     $z = serialize($y);",
          "21: }",
          "22: ?>",
          "23: ===DONE===",
          "24: --EXPECTF--",
          "25: ===DONE===",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "343:   } else {",
          "345:    convert_to_string(key);",
          "347:     var_push_dtor(var_hash, old_data);",
          "348:    }",
          "349:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "",
          "[Removed Lines]",
          "346:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "",
          "[Added Lines]",
          "346:    if (zend_hash_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "347:   } else {",
          "349:    convert_to_string(key);",
          "351:     var_push_dtor(var_hash, old_data);",
          "352:    }",
          "353:    zend_hash_update(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, &data,",
          "",
          "[Removed Lines]",
          "350:    if (zend_symtable_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "",
          "[Added Lines]",
          "350:    if (zend_hash_find(ht, Z_STRVAL_P(key), Z_STRLEN_P(key) + 1, (void **)&old_data)==SUCCESS) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9b1a224d4e994219a6ef1d1d8fdcc1b0598ba3ab",
      "candidate_info": {
        "commit_hash": "9b1a224d4e994219a6ef1d1d8fdcc1b0598ba3ab",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/9b1a224d4e994219a6ef1d1d8fdcc1b0598ba3ab",
        "files": [
          "Zend/zend_API.c",
          "ext/exif/exif.c",
          "ext/gmp/gmp.c",
          "ext/gmp/tests/bug70284.phpt",
          "ext/hash/hash_haval.c",
          "ext/hash/tests/bug70312.phpt",
          "ext/hash/tests/hash_file_basic1.phpt",
          "ext/hash/tests/hash_hmac_basic.phpt",
          "ext/hash/tests/hash_hmac_file_basic.phpt",
          "ext/pcre/php_pcre.c",
          "ext/pcre/tests/bug70345.phpt",
          "ext/session/session.c",
          "ext/session/tests/session_decode_error2.phpt",
          "ext/soap/soap.c",
          "ext/soap/tests/bug70388.phpt",
          "ext/spl/spl_dllist.c",
          "ext/spl/tests/bug70155.phpt",
          "ext/spl/tests/bug70365.phpt",
          "ext/spl/tests/bug70366.phpt",
          "ext/standard/tests/serialize/bug70172.phpt",
          "ext/standard/tests/serialize/bug70172_2.phpt",
          "ext/standard/tests/serialize/bug70219.phpt",
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "ext/xsl/xsltprocessor.c",
          "ext/zip/php_zip.c",
          "ext/zip/tests/bug70350.phpt"
        ],
        "message": "Merge branch 'PHP-5.6'\n\n* PHP-5.6: (21 commits)\n  fix unit tests\n  update NEWS\n  add NEWS for fixes\n  Improve fix for #70172\n  Fix bug #70312 - HAVAL gives wrong hashes in specific cases\n  fix test\n  add test\n  Fix bug #70366 - use-after-free vulnerability in unserialize() with SplDoublyLinkedList\n  Fix bug #70365 - use-after-free vulnerability in unserialize() with SplObjectStorage\n  Fix bug #70172 - Use After Free Vulnerability in unserialize()\n  Fix bug #70388 - SOAP serialize_function_call() type confusion\n  Fixed bug #70350: ZipArchive::extractTo allows for directory traversal when creating directories\n  Improve fix for #70385\n  Fix bug #70345 (Multiple vulnerabilities related to PCRE functions)\n  Fix bug #70385 (Buffer over-read in exif_read_data with TIFF IFD tag byte value of 32 bytes)\n  Fix bug #70219 (Use after free vulnerability in session deserializer)\n  Fix bug ##70284 (Use after free vulnerability in unserialize() with GMP)\n  Fix for bug #69782\n  Add CVE IDs asigned (post release) to PHP 5.4.43\n  Add CVE IDs asigned to #69085 (PHP 5.4.39)\n  ...\n\nConflicts:\n\text/exif/exif.c\n\text/gmp/gmp.c\n\text/pcre/php_pcre.c\n\text/session/session.c\n\text/session/tests/session_decode_variation3.phpt\n\text/soap/soap.c\n\text/spl/spl_observer.c\n\text/standard/var.c\n\text/standard/var_unserializer.c\n\text/standard/var_unserializer.re\n\text/xsl/xsltprocessor.c",
        "before_after_code_files": [
          "Zend/zend_API.c||Zend/zend_API.c",
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/gmp/gmp.c||ext/gmp/gmp.c",
          "ext/gmp/tests/bug70284.phpt||ext/gmp/tests/bug70284.phpt",
          "ext/hash/hash_haval.c||ext/hash/hash_haval.c",
          "ext/hash/tests/bug70312.phpt||ext/hash/tests/bug70312.phpt",
          "ext/hash/tests/hash_file_basic1.phpt||ext/hash/tests/hash_file_basic1.phpt",
          "ext/hash/tests/hash_hmac_basic.phpt||ext/hash/tests/hash_hmac_basic.phpt",
          "ext/hash/tests/hash_hmac_file_basic.phpt||ext/hash/tests/hash_hmac_file_basic.phpt",
          "ext/pcre/php_pcre.c||ext/pcre/php_pcre.c",
          "ext/pcre/tests/bug70345.phpt||ext/pcre/tests/bug70345.phpt",
          "ext/session/session.c||ext/session/session.c",
          "ext/session/tests/session_decode_error2.phpt||ext/session/tests/session_decode_error2.phpt",
          "ext/soap/soap.c||ext/soap/soap.c",
          "ext/soap/tests/bug70388.phpt||ext/soap/tests/bug70388.phpt",
          "ext/spl/spl_dllist.c||ext/spl/spl_dllist.c",
          "ext/spl/tests/bug70155.phpt||ext/spl/tests/bug70155.phpt",
          "ext/spl/tests/bug70365.phpt||ext/spl/tests/bug70365.phpt",
          "ext/spl/tests/bug70366.phpt||ext/spl/tests/bug70366.phpt",
          "ext/standard/tests/serialize/bug70172.phpt||ext/standard/tests/serialize/bug70172.phpt",
          "ext/standard/tests/serialize/bug70172_2.phpt||ext/standard/tests/serialize/bug70172_2.phpt",
          "ext/standard/tests/serialize/bug70219.phpt||ext/standard/tests/serialize/bug70219.phpt",
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "ext/xsl/xsltprocessor.c||ext/xsl/xsltprocessor.c",
          "ext/zip/php_zip.c||ext/zip/php_zip.c",
          "ext/zip/tests/bug70350.phpt||ext/zip/tests/bug70350.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/zend_API.c||Zend/zend_API.c": [
          "File: Zend/zend_API.c -> Zend/zend_API.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1243: {",
          "1244:     zval *prop, tmp;",
          "1245:     zend_string *key;",
          "1246:     zend_property_info *property_info;",
          "1260:    }",
          "1261:   } else {",
          "1262:    if (!object->properties) {",
          "1263:     rebuild_object_properties(object);",
          "1264:    }",
          "1266:    zval_add_ref(prop);",
          "1267:   }",
          "1268:  } ZEND_HASH_FOREACH_END();",
          "",
          "[Removed Lines]",
          "1248:  ZEND_HASH_FOREACH_STR_KEY_VAL(properties, key, prop) {",
          "1249:   property_info = zend_get_property_info(object->ce, key, 1);",
          "1250:   if (property_info != ZEND_WRONG_PROPERTY_INFO &&",
          "1251:       property_info &&",
          "1252:       (property_info->flags & ZEND_ACC_STATIC) == 0) {",
          "1253:    zval *slot = OBJ_PROP(object, property_info->offset);",
          "1254:    zval_ptr_dtor(slot);",
          "1255:    ZVAL_COPY_VALUE(slot, prop);",
          "1256:    zval_add_ref(slot);",
          "1257:    if (object->properties) {",
          "1258:     ZVAL_INDIRECT(&tmp, slot);",
          "1259:     zend_hash_update(object->properties, key, &tmp);",
          "1265:    prop = zend_hash_update(object->properties, key, prop);",
          "",
          "[Added Lines]",
          "1246:     zend_long h;",
          "1249:     ZEND_HASH_FOREACH_KEY_VAL(properties, h, key, prop) {",
          "1250:   if(key) {",
          "1251:    property_info = zend_get_property_info(object->ce, key, 1);",
          "1252:    if (property_info != ZEND_WRONG_PROPERTY_INFO &&",
          "1253:     property_info &&",
          "1254:     (property_info->flags & ZEND_ACC_STATIC) == 0) {",
          "1255:     zval *slot = OBJ_PROP(object, property_info->offset);",
          "1256:     zval_ptr_dtor(slot);",
          "1257:     ZVAL_COPY_VALUE(slot, prop);",
          "1258:     zval_add_ref(slot);",
          "1259:     if (object->properties) {",
          "1260:      ZVAL_INDIRECT(&tmp, slot);",
          "1261:      zend_hash_update(object->properties, key, &tmp);",
          "1262:     }",
          "1263:    } else {",
          "1264:     if (!object->properties) {",
          "1265:      rebuild_object_properties(object);",
          "1266:     }",
          "1267:     prop = zend_hash_update(object->properties, key, prop);",
          "1268:     zval_add_ref(prop);",
          "1274:    prop = zend_hash_index_update(object->properties, h, prop);",
          "",
          "---------------"
        ],
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2945:      if (length<byte_count-1) {",
          "2947:       ImageInfo->CopyrightPhotographer  = estrdup(value_ptr);",
          "2949:       spprintf(&ImageInfo->Copyright, 0, \"%s, %s\", value_ptr, value_ptr+length+1);",
          "2953:      } else {",
          "2955:      }",
          "2956:     }",
          "2957:     break;",
          "",
          "[Removed Lines]",
          "2948:       ImageInfo->CopyrightEditor        = estrdup(value_ptr+length+1);",
          "2954:       ImageInfo->Copyright = estrdup(value_ptr);",
          "",
          "[Added Lines]",
          "2948:       ImageInfo->CopyrightEditor        = estrndup(value_ptr+length+1, byte_count-length-1);",
          "2954:       ImageInfo->Copyright = estrndup(value_ptr, byte_count);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3042:     break;",
          "3044:    case TAG_MAKE:",
          "3046:     break;",
          "3047:    case TAG_MODEL:",
          "3049:     break;",
          "3051:    case TAG_MAKER_NOTE:",
          "",
          "[Removed Lines]",
          "3045:     ImageInfo->make = estrdup(value_ptr);",
          "3048:     ImageInfo->model = estrdup(value_ptr);",
          "",
          "[Added Lines]",
          "3045:     ImageInfo->make = estrndup(value_ptr, byte_count);",
          "3048:     ImageInfo->model = estrndup(value_ptr, byte_count);",
          "",
          "---------------"
        ],
        "ext/gmp/gmp.c||ext/gmp/gmp.c": [
          "File: ext/gmp/gmp.c -> ext/gmp/gmp.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "585: {",
          "586:  mpz_ptr gmpnum;",
          "587:  const unsigned char *p, *max;",
          "589:  int retval = FAILURE;",
          "590:  php_unserialize_data_t unserialize_data = (php_unserialize_data_t) data;",
          "593:  PHP_VAR_UNSERIALIZE_INIT(unserialize_data);",
          "594:  gmp_create(object, &gmpnum);",
          "596:  p = buf;",
          "597:  max = buf + buf_len;",
          "602:  ) {",
          "603:   zend_throw_exception(NULL, \"Could not unserialize number\", 0);",
          "604:   goto exit;",
          "605:  }",
          "611:  ) {",
          "612:   zend_throw_exception(NULL, \"Could not unserialize properties\", 0);",
          "613:   goto exit;",
          "614:  }",
          "617:   zend_hash_copy(",
          "619:    (copy_ctor_func_t) zval_add_ref",
          "620:   );",
          "621:  }",
          "623:  retval = SUCCESS;",
          "624: exit:",
          "626:  PHP_VAR_UNSERIALIZE_DESTROY(unserialize_data);",
          "627:  return retval;",
          "628: }",
          "",
          "[Removed Lines]",
          "588:  zval zv;",
          "592:  ZVAL_UNDEF(&zv);",
          "599:  if (!php_var_unserialize(&zv, &p, max, &unserialize_data)",
          "600:   || Z_TYPE(zv) != IS_STRING",
          "601:   || convert_to_gmp(gmpnum, &zv, 10) == FAILURE",
          "606:  zval_dtor(&zv);",
          "607:  ZVAL_UNDEF(&zv);",
          "609:  if (!php_var_unserialize(&zv, &p, max, &unserialize_data)",
          "610:   || Z_TYPE(zv) != IS_ARRAY",
          "616:  if (zend_hash_num_elements(Z_ARRVAL(zv)) != 0) {",
          "618:    zend_std_get_properties(object), Z_ARRVAL(zv),",
          "625:  zval_dtor(&zv);",
          "",
          "[Added Lines]",
          "588:  zval *zv;",
          "598:  zv = var_tmp_var(&unserialize_data);",
          "599:  if (!php_var_unserialize(zv, &p, max, &unserialize_data)",
          "600:   || Z_TYPE_P(zv) != IS_STRING",
          "601:   || convert_to_gmp(gmpnum, zv, 10) == FAILURE",
          "607:  zv = var_tmp_var(&unserialize_data);",
          "608:  if (!php_var_unserialize(zv, &p, max, &unserialize_data)",
          "609:   || Z_TYPE_P(zv) != IS_ARRAY",
          "615:  if (zend_hash_num_elements(Z_ARRVAL_P(zv)) != 0) {",
          "617:    zend_std_get_properties(object), Z_ARRVAL_P(zv),",
          "",
          "---------------"
        ],
        "ext/gmp/tests/bug70284.phpt||ext/gmp/tests/bug70284.phpt": [
          "File: ext/gmp/tests/bug70284.phpt -> ext/gmp/tests/bug70284.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70284 (Use after free vulnerability in unserialize() with GMP)",
          "3: --SKIPIF--",
          "4: <?php if (!extension_loaded(\"gmp\")) print \"skip\"; ?>",
          "5: --FILE--",
          "6: <?php",
          "8: $inner = 'r:2;a:1:{i:0;a:1:{i:0;r:4;}}';",
          "9: $exploit = 'a:2:{i:0;s:1:\"1\";i:1;C:3:\"GMP\":'.strlen($inner).':{'.$inner.'}}';",
          "11: $data = unserialize($exploit);",
          "13: $fakezval = ptr2str(1122334455);",
          "14: $fakezval .= ptr2str(0);",
          "15: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "16: $fakezval .= \"\\x01\";",
          "17: $fakezval .= \"\\x00\";",
          "18: $fakezval .= \"\\x00\\x00\";",
          "20: for ($i = 0; $i < 5; $i++) {",
          "21:  $v[$i] = $fakezval.$i;",
          "22: }",
          "24: var_dump($data);",
          "26: function ptr2str($ptr)",
          "27: {",
          "28: $out = '';",
          "29:  for ($i = 0; $i < 8; $i++) {",
          "30:   $out .= chr($ptr & 0xff);",
          "31:   $ptr >>= 8;",
          "32:  }",
          "33:  return $out;",
          "34: }",
          "35: ?>",
          "36: --EXPECTF--",
          "37: array(2) {",
          "38:   [0]=>",
          "39:   string(1) \"1\"",
          "40:   [1]=>",
          "41:   object(GMP)#%d (2) {",
          "42:     [0]=>",
          "43:     array(1) {",
          "44:       [0]=>",
          "45:       string(1) \"1\"",
          "46:     }",
          "47:     [\"num\"]=>",
          "48:     string(1) \"1\"",
          "49:   }",
          "50: }",
          "",
          "---------------"
        ],
        "ext/hash/hash_haval.c||ext/hash/hash_haval.c": [
          "File: ext/hash/hash_haval.c -> ext/hash/hash_haval.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "341:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "339:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "339:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "394:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "395:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "393:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "393:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "448:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "449:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "447:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "447:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "488:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "489:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "487:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "487:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "529:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "530:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "528:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "528:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------"
        ],
        "ext/hash/tests/bug70312.phpt||ext/hash/tests/bug70312.phpt": [
          "File: ext/hash/tests/bug70312.phpt -> ext/hash/tests/bug70312.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70312 HAVAL gives wrong hashes in specific cases",
          "3: --SKIPIF--",
          "4: <?php if(!extension_loaded(\"hash\")) print \"skip\"; ?>",
          "5: --FILE--",
          "6: <?php",
          "7: var_dump(hash('haval128,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "8: var_dump(hash('haval160,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "9: var_dump(hash('haval192,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "10: var_dump(hash('haval224,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "11: var_dump(hash('haval256,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "12: ?>",
          "13: --EXPECTF--",
          "14: string(32) \"f3f0d23819b87228b4b70ee350afaa9d\"",
          "15: string(40) \"aded6485e137f11d7292212ba3fa961714df0564\"",
          "16: string(48) \"e53da2b16269fe732e9a898a96707a9f28404d7333b02286\"",
          "17: string(56) \"c574fb307f0817b514b9bb2e7c4bfaffb7ad667aca3c8b523fefcf10\"",
          "18: string(64) \"fb73c19300b14d5cb393d929bf005e6c2d459a4c9c009e9813af1d2d3637ee8f\"",
          "",
          "---------------"
        ],
        "ext/hash/tests/hash_file_basic1.phpt||ext/hash/tests/hash_file_basic1.phpt": [
          "File: ext/hash/tests/hash_file_basic1.phpt -> ext/hash/tests/hash_file_basic1.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "64: adler32: ff87222e",
          "65: crc32: 61664d33",
          "66: gost: d9e65f0c0c2ef944e4f8a01f4a46365c4f33a2853756878182a7f03e1490a4cd",
          "68: md2: 70f791c0d8fa9edd7d08e32fcba8c354",
          "69: md4: a9d034b16bb290c57a645afd6f14cd3b",
          "70: md5: 704bf818448f5bbb94061332d2c889aa",
          "",
          "[Removed Lines]",
          "67: haval128,3: 8bb81269aca8b7f87829020d76a4e841",
          "",
          "[Added Lines]",
          "67: haval128,3: c25962b13383c3ed9f13817c8f2ae7d6",
          "",
          "---------------"
        ],
        "ext/hash/tests/hash_hmac_basic.phpt||ext/hash/tests/hash_hmac_basic.phpt": [
          "File: ext/hash/tests/hash_hmac_basic.phpt -> ext/hash/tests/hash_hmac_basic.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "45: adler32: 12c803f7",
          "46: crc32: 96859101",
          "47: gost: a4a3c80bdf3f8665bf07376a34dc9c1b11af7c813f4928f62e39f0c0dc564dad",
          "49: md2: 6d111dab563025e4cb5f4425c991fa12",
          "50: md4: 10cdbfe843000c623f8b8da0d5d20b0b",
          "51: md5: 2a632783e2812cf23de100d7d6a463ae",
          "",
          "[Removed Lines]",
          "48: haval128,3: 82cd0f4bd36729b5c80c33efa8c13ac5",
          "",
          "[Added Lines]",
          "48: haval128,3: 4d1318607f0406bd1b7bd50907772672",
          "",
          "---------------"
        ],
        "ext/hash/tests/hash_hmac_file_basic.phpt||ext/hash/tests/hash_hmac_file_basic.phpt": [
          "File: ext/hash/tests/hash_hmac_file_basic.phpt -> ext/hash/tests/hash_hmac_file_basic.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "73: adler32: 0f8c02f9",
          "74: crc32: f2a60b9c",
          "75: gost: 94c39a40d5db852a8dc3d24e37eebf2d53e3d711457c59cd02b614f792a9d918",
          "77: md2: a685475e600314bb549ab4f33c3b27cb",
          "78: md4: cbc6bff781f48f57378d3effa27553e4",
          "79: md5: 8bddf39dd1c566c27acc7fa85ec36acf",
          "",
          "[Removed Lines]",
          "76: haval128,3: e8fcff647f1a675acb429130fb94a17e",
          "",
          "[Added Lines]",
          "76: haval128,3: f1cea637451097d790354a86de3f54a3",
          "",
          "---------------"
        ],
        "ext/pcre/php_pcre.c||ext/pcre/php_pcre.c": [
          "File: ext/pcre/php_pcre.c -> ext/pcre/php_pcre.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "759:    if (subpats != NULL) {",
          "762:      if (subpat_names) {",
          "763:       efree(subpat_names);",
          "764:      }",
          "",
          "[Removed Lines]",
          "761:     if (pcre_get_substring_list(subject, offsets, count, &stringlist) < 0) {",
          "",
          "[Added Lines]",
          "761:     if ((offsets[1] - offsets[0] < 0) || pcre_get_substring_list(subject, offsets, count, &stringlist) < 0) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1177:   piece = subject + start_offset;",
          "1181:    if (UNEXPECTED(replace_count)) {",
          "1182:     ++*replace_count;",
          "1183:    }",
          "",
          "[Removed Lines]",
          "1180:   if (EXPECTED(count > 0 && limit)) {",
          "",
          "[Added Lines]",
          "1180:   if (EXPECTED(count > 0 && (offsets[1] - offsets[0] >= 0) && limit)) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1799:   }",
          "1803:    if (!no_empty || &subject[offsets[0]] != last_match) {",
          "1805:     if (offset_capture) {",
          "",
          "[Removed Lines]",
          "1802:   if (count > 0) {",
          "",
          "[Added Lines]",
          "1802:   if (count > 0 && (offsets[1] - offsets[0] >= 0)) {",
          "",
          "---------------"
        ],
        "ext/pcre/tests/bug70345.phpt||ext/pcre/tests/bug70345.phpt": [
          "File: ext/pcre/tests/bug70345.phpt -> ext/pcre/tests/bug70345.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70345 (Multiple vulnerabilities related to PCRE functions)",
          "3: --FILE--",
          "4: <?php",
          "5: $regex = '/(?=xyz\\K)/';",
          "6: $subject = \"aaaaxyzaaaa\";",
          "8: $v = preg_split($regex, $subject);",
          "9: print_r($v);",
          "11: $regex = '/(a(?=xyz\\K))/';",
          "12: $subject = \"aaaaxyzaaaa\";",
          "13: preg_match($regex, $subject, $matches);",
          "15: var_dump($matches);",
          "16: --EXPECTF--",
          "17: Array",
          "18: (",
          "19:     [0] => aaaaxyzaaaa",
          "20: )",
          "22: Warning: preg_match(): Get subpatterns list failed in %s on line %d",
          "23: array(0) {",
          "24: }",
          "",
          "---------------"
        ],
        "ext/session/session.c||ext/session/session.c": [
          "File: ext/session/session.c -> ext/session/session.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "65: static int php_session_rfc1867_callback(unsigned int event, void *event_data, void **extra);",
          "66: static int (*php_session_rfc1867_orig_callback)(unsigned int event, void *event_data, void **extra);",
          "69: zend_class_entry *php_session_class_entry;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "67: static void php_session_track_init(void);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "139: {",
          "140:  int retval = SUCCESS;",
          "142:  if (PS(session_status) != php_session_active) {",
          "143:   php_error_docref(NULL, E_WARNING, \"Trying to destroy uninitialized session\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "142:  zend_string *var_name;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "235:  }",
          "236:  if (PS(serializer)->decode(ZSTR_VAL(data), ZSTR_LEN(data)) == FAILURE) {",
          "237:   php_session_destroy();",
          "238:   php_error_docref(NULL, E_WARNING, \"Failed to decode session object. Session has been destroyed\");",
          "239:   return FAILURE;",
          "240:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "240:   php_session_track_init();",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "952:     var_replace(&var_hash, &current, zv);",
          "953:    } else {",
          "954:     zval_ptr_dtor(&current);",
          "955:    }",
          "956:   }",
          "957:   PS_ADD_VARL(name);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "958:     PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "959:     return FAILURE;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1042:     var_replace(&var_hash, &current, zv);",
          "1043:    } else {",
          "1044:     zval_ptr_dtor(&current);",
          "1045:    }",
          "1046:   }",
          "1047:   PS_ADD_VARL(name);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1050:     PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1051:     return FAILURE;",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2169:  }",
          "2171:  if (php_session_decode(str) == FAILURE) {",
          "2174:  }",
          "2175:  RETURN_TRUE;",
          "2176: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2179:   RETURN_FALSE;",
          "",
          "---------------"
        ],
        "ext/session/tests/session_decode_error2.phpt||ext/session/tests/session_decode_error2.phpt": [
          "File: ext/session/tests/session_decode_error2.phpt -> ext/session/tests/session_decode_error2.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: var_dump(session_start());",
          "20: for($index = 0; $index < strlen($data); $index++) {",
          "21:     echo \"\\n-- Iteration $index --\\n\";",
          "22:     $encoded = substr($data, 0, $index);",
          "23:     var_dump(session_decode($encoded));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21:  if(session_status() != PHP_SESSION_ACTIVE) { session_start(); }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "53: }",
          "55: -- Iteration 4 --",
          "60: }",
          "62: -- Iteration 5 --",
          "67: }",
          "69: -- Iteration 6 --",
          "74: }",
          "76: -- Iteration 7 --",
          "81: }",
          "83: -- Iteration 8 --",
          "88: }",
          "90: -- Iteration 9 --",
          "95: }",
          "97: -- Iteration 10 --",
          "102: }",
          "104: -- Iteration 11 --",
          "109: }",
          "111: -- Iteration 12 --",
          "116: }",
          "118: -- Iteration 13 --",
          "123: }",
          "125: -- Iteration 14 --",
          "130: }",
          "132: -- Iteration 15 --",
          "137: }",
          "139: -- Iteration 16 --",
          "144: }",
          "146: -- Iteration 17 --",
          "151: }",
          "153: -- Iteration 18 --",
          "158: }",
          "160: -- Iteration 19 --",
          "165: }",
          "167: -- Iteration 20 --",
          "172: }",
          "174: -- Iteration 21 --",
          "179: }",
          "181: -- Iteration 22 --",
          "186: }",
          "188: -- Iteration 23 --",
          "193: }",
          "195: -- Iteration 24 --",
          "200: }",
          "202: -- Iteration 25 --",
          "207: }",
          "209: -- Iteration 26 --",
          "214: }",
          "216: -- Iteration 27 --",
          "221: }",
          "223: -- Iteration 28 --",
          "228: }",
          "230: -- Iteration 29 --",
          "235: }",
          "237: -- Iteration 30 --",
          "242: }",
          "244: -- Iteration 31 --",
          "249: }",
          "251: -- Iteration 32 --",
          "256: }",
          "258: -- Iteration 33 --",
          "263: }",
          "265: -- Iteration 34 --",
          "",
          "[Removed Lines]",
          "56: bool(true)",
          "57: array(1) {",
          "58:   [\"foo\"]=>",
          "59:   NULL",
          "63: bool(true)",
          "64: array(1) {",
          "65:   [\"foo\"]=>",
          "66:   NULL",
          "70: bool(true)",
          "71: array(1) {",
          "72:   [\"foo\"]=>",
          "73:   NULL",
          "77: bool(true)",
          "78: array(1) {",
          "79:   [\"foo\"]=>",
          "80:   NULL",
          "84: bool(true)",
          "85: array(1) {",
          "86:   [\"foo\"]=>",
          "87:   NULL",
          "91: bool(true)",
          "92: array(1) {",
          "93:   [\"foo\"]=>",
          "94:   NULL",
          "98: bool(true)",
          "99: array(1) {",
          "100:   [\"foo\"]=>",
          "101:   NULL",
          "105: bool(true)",
          "106: array(1) {",
          "107:   [\"foo\"]=>",
          "108:   NULL",
          "112: bool(true)",
          "113: array(1) {",
          "114:   [\"foo\"]=>",
          "115:   NULL",
          "119: bool(true)",
          "120: array(1) {",
          "121:   [\"foo\"]=>",
          "122:   NULL",
          "126: bool(true)",
          "127: array(1) {",
          "128:   [\"foo\"]=>",
          "129:   NULL",
          "133: bool(true)",
          "134: array(1) {",
          "135:   [\"foo\"]=>",
          "136:   NULL",
          "140: bool(true)",
          "141: array(1) {",
          "142:   [\"foo\"]=>",
          "143:   NULL",
          "147: bool(true)",
          "148: array(1) {",
          "149:   [\"foo\"]=>",
          "150:   NULL",
          "154: bool(true)",
          "155: array(1) {",
          "156:   [\"foo\"]=>",
          "157:   NULL",
          "161: bool(true)",
          "162: array(1) {",
          "163:   [\"foo\"]=>",
          "164:   NULL",
          "168: bool(true)",
          "169: array(1) {",
          "170:   [\"foo\"]=>",
          "171:   NULL",
          "175: bool(true)",
          "176: array(1) {",
          "177:   [\"foo\"]=>",
          "178:   NULL",
          "182: bool(true)",
          "183: array(1) {",
          "184:   [\"foo\"]=>",
          "185:   NULL",
          "189: bool(true)",
          "190: array(1) {",
          "191:   [\"foo\"]=>",
          "192:   NULL",
          "196: bool(true)",
          "197: array(1) {",
          "198:   [\"foo\"]=>",
          "199:   NULL",
          "203: bool(true)",
          "204: array(1) {",
          "205:   [\"foo\"]=>",
          "206:   NULL",
          "210: bool(true)",
          "211: array(1) {",
          "212:   [\"foo\"]=>",
          "213:   NULL",
          "217: bool(true)",
          "218: array(1) {",
          "219:   [\"foo\"]=>",
          "220:   NULL",
          "224: bool(true)",
          "225: array(1) {",
          "226:   [\"foo\"]=>",
          "227:   NULL",
          "231: bool(true)",
          "232: array(1) {",
          "233:   [\"foo\"]=>",
          "234:   NULL",
          "238: bool(true)",
          "239: array(1) {",
          "240:   [\"foo\"]=>",
          "241:   NULL",
          "245: bool(true)",
          "246: array(1) {",
          "247:   [\"foo\"]=>",
          "248:   NULL",
          "252: bool(true)",
          "253: array(1) {",
          "254:   [\"foo\"]=>",
          "255:   NULL",
          "259: bool(true)",
          "260: array(1) {",
          "261:   [\"foo\"]=>",
          "262:   NULL",
          "",
          "[Added Lines]",
          "58: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "59: bool(false)",
          "60: array(0) {",
          "65: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "66: bool(false)",
          "67: array(0) {",
          "72: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "73: bool(false)",
          "74: array(0) {",
          "79: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "80: bool(false)",
          "81: array(0) {",
          "86: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "87: bool(false)",
          "88: array(0) {",
          "93: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "94: bool(false)",
          "95: array(0) {",
          "100: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "101: bool(false)",
          "102: array(0) {",
          "107: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "108: bool(false)",
          "109: array(0) {",
          "114: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "115: bool(false)",
          "116: array(0) {",
          "121: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "122: bool(false)",
          "123: array(0) {",
          "128: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "129: bool(false)",
          "130: array(0) {",
          "135: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "136: bool(false)",
          "137: array(0) {",
          "142: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "143: bool(false)",
          "144: array(0) {",
          "149: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "150: bool(false)",
          "151: array(0) {",
          "156: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "157: bool(false)",
          "158: array(0) {",
          "163: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "164: bool(false)",
          "165: array(0) {",
          "170: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "171: bool(false)",
          "172: array(0) {",
          "177: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "178: bool(false)",
          "179: array(0) {",
          "184: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "185: bool(false)",
          "186: array(0) {",
          "191: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "192: bool(false)",
          "193: array(0) {",
          "198: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "199: bool(false)",
          "200: array(0) {",
          "205: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "206: bool(false)",
          "207: array(0) {",
          "212: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "213: bool(false)",
          "214: array(0) {",
          "219: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "220: bool(false)",
          "221: array(0) {",
          "226: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "227: bool(false)",
          "228: array(0) {",
          "233: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "234: bool(false)",
          "235: array(0) {",
          "240: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "241: bool(false)",
          "242: array(0) {",
          "247: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "248: bool(false)",
          "249: array(0) {",
          "254: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "255: bool(false)",
          "256: array(0) {",
          "261: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "262: bool(false)",
          "263: array(0) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "333: }",
          "335: -- Iteration 39 --",
          "349: }",
          "351: -- Iteration 40 --",
          "365: }",
          "367: -- Iteration 41 --",
          "381: }",
          "383: -- Iteration 42 --",
          "397: }",
          "399: -- Iteration 43 --",
          "",
          "[Removed Lines]",
          "336: bool(true)",
          "337: array(2) {",
          "338:   [\"foo\"]=>",
          "339:   array(3) {",
          "340:     [0]=>",
          "341:     int(1)",
          "342:     [1]=>",
          "343:     int(2)",
          "344:     [2]=>",
          "345:     int(3)",
          "346:   }",
          "347:   [\"guff\"]=>",
          "348:   NULL",
          "352: bool(true)",
          "353: array(2) {",
          "354:   [\"foo\"]=>",
          "355:   array(3) {",
          "356:     [0]=>",
          "357:     int(1)",
          "358:     [1]=>",
          "359:     int(2)",
          "360:     [2]=>",
          "361:     int(3)",
          "362:   }",
          "363:   [\"guff\"]=>",
          "364:   NULL",
          "368: bool(true)",
          "369: array(2) {",
          "370:   [\"foo\"]=>",
          "371:   array(3) {",
          "372:     [0]=>",
          "373:     int(1)",
          "374:     [1]=>",
          "375:     int(2)",
          "376:     [2]=>",
          "377:     int(3)",
          "378:   }",
          "379:   [\"guff\"]=>",
          "380:   NULL",
          "384: bool(true)",
          "385: array(2) {",
          "386:   [\"foo\"]=>",
          "387:   array(3) {",
          "388:     [0]=>",
          "389:     int(1)",
          "390:     [1]=>",
          "391:     int(2)",
          "392:     [2]=>",
          "393:     int(3)",
          "394:   }",
          "395:   [\"guff\"]=>",
          "396:   NULL",
          "",
          "[Added Lines]",
          "338: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "339: bool(false)",
          "340: array(0) {",
          "345: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "346: bool(false)",
          "347: array(0) {",
          "352: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "353: bool(false)",
          "354: array(0) {",
          "359: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "360: bool(false)",
          "361: array(0) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "512: }",
          "514: -- Iteration 48 --",
          "537: }",
          "539: -- Iteration 49 --",
          "562: }",
          "564: -- Iteration 50 --",
          "587: }",
          "589: -- Iteration 51 --",
          "612: }",
          "",
          "[Removed Lines]",
          "515: bool(true)",
          "516: array(3) {",
          "517:   [\"foo\"]=>",
          "518:   &array(3) {",
          "519:     [0]=>",
          "520:     int(1)",
          "521:     [1]=>",
          "522:     int(2)",
          "523:     [2]=>",
          "524:     int(3)",
          "525:   }",
          "526:   [\"guff\"]=>",
          "527:   &array(3) {",
          "528:     [0]=>",
          "529:     int(1)",
          "530:     [1]=>",
          "531:     int(2)",
          "532:     [2]=>",
          "533:     int(3)",
          "534:   }",
          "535:   [\"blah\"]=>",
          "536:   NULL",
          "540: bool(true)",
          "541: array(3) {",
          "542:   [\"foo\"]=>",
          "543:   &array(3) {",
          "544:     [0]=>",
          "545:     int(1)",
          "546:     [1]=>",
          "547:     int(2)",
          "548:     [2]=>",
          "549:     int(3)",
          "550:   }",
          "551:   [\"guff\"]=>",
          "552:   &array(3) {",
          "553:     [0]=>",
          "554:     int(1)",
          "555:     [1]=>",
          "556:     int(2)",
          "557:     [2]=>",
          "558:     int(3)",
          "559:   }",
          "560:   [\"blah\"]=>",
          "561:   NULL",
          "565: bool(true)",
          "566: array(3) {",
          "567:   [\"foo\"]=>",
          "568:   &array(3) {",
          "569:     [0]=>",
          "570:     int(1)",
          "571:     [1]=>",
          "572:     int(2)",
          "573:     [2]=>",
          "574:     int(3)",
          "575:   }",
          "576:   [\"guff\"]=>",
          "577:   &array(3) {",
          "578:     [0]=>",
          "579:     int(1)",
          "580:     [1]=>",
          "581:     int(2)",
          "582:     [2]=>",
          "583:     int(3)",
          "584:   }",
          "585:   [\"blah\"]=>",
          "586:   NULL",
          "590: bool(true)",
          "591: array(3) {",
          "592:   [\"foo\"]=>",
          "593:   &array(3) {",
          "594:     [0]=>",
          "595:     int(1)",
          "596:     [1]=>",
          "597:     int(2)",
          "598:     [2]=>",
          "599:     int(3)",
          "600:   }",
          "601:   [\"guff\"]=>",
          "602:   &array(3) {",
          "603:     [0]=>",
          "604:     int(1)",
          "605:     [1]=>",
          "606:     int(2)",
          "607:     [2]=>",
          "608:     int(3)",
          "609:   }",
          "610:   [\"blah\"]=>",
          "611:   NULL",
          "613: bool(true)",
          "614: Done",
          "",
          "[Added Lines]",
          "481: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "482: bool(false)",
          "483: array(0) {",
          "488: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "489: bool(false)",
          "490: array(0) {",
          "495: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "496: bool(false)",
          "497: array(0) {",
          "502: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "503: bool(false)",
          "504: array(0) {",
          "507: Warning: session_destroy(): Trying to destroy uninitialized session in %s/session_decode_error2.php on line %d",
          "508: bool(false)",
          "509: Done",
          "",
          "---------------"
        ],
        "ext/soap/soap.c||ext/soap/soap.c": [
          "File: ext/soap/soap.c -> ext/soap/soap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1505:    add_soap_fault_ex(&exception_object, this_ptr, \"Server\", \"Internal Error\", NULL, NULL);",
          "1506:   }",
          "1507:   soap_server_fault_ex(function, &exception_object, NULL);",
          "1509: }",
          "",
          "[Removed Lines]",
          "1508:  }",
          "",
          "[Added Lines]",
          "1508:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2924:     free_soap_headers = 1;",
          "2925:    }",
          "2926:    ZEND_HASH_FOREACH_VAL(default_headers, tmp) {",
          "2929:    } ZEND_HASH_FOREACH_END();",
          "2930:   } else {",
          "2931:    soap_headers = Z_ARRVAL_P(tmp);",
          "",
          "[Removed Lines]",
          "2927:     Z_ADDREF_P(tmp);",
          "2928:     zend_hash_next_index_insert(soap_headers, tmp);",
          "",
          "[Added Lines]",
          "2927:     if(Z_TYPE_P(tmp) == IS_OBJECT) {",
          "2928:      Z_ADDREF_P(tmp);",
          "2929:      zend_hash_next_index_insert(soap_headers, tmp);",
          "2930:     }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "4332:   zval* header;",
          "4334:   ZEND_HASH_FOREACH_VAL(soap_headers, header) {",
          "4336:    zval *name, *ns, *tmp;",
          "4338:    if ((name = zend_hash_str_find(ht, \"name\", sizeof(\"name\")-1)) != NULL &&",
          "4339:        Z_TYPE_P(name) == IS_STRING &&",
          "4340:        (ns = zend_hash_str_find(ht, \"namespace\", sizeof(\"namespace\")-1)) != NULL &&",
          "",
          "[Removed Lines]",
          "4335:    HashTable *ht = Z_OBJPROP_P(header);",
          "",
          "[Added Lines]",
          "4337:    HashTable *ht;",
          "4340:    if (Z_TYPE_P(header) != IS_OBJECT) {",
          "4341:     continue;",
          "4342:    }",
          "4344:    ht = Z_OBJPROP_P(header);",
          "",
          "---------------"
        ],
        "ext/soap/tests/bug70388.phpt||ext/soap/tests/bug70388.phpt": [
          "File: ext/soap/tests/bug70388.phpt -> ext/soap/tests/bug70388.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70388 (SOAP serialize_function_call() type confusion / RCE)",
          "3: --SKIPIF--",
          "4: <?php require_once('skipif.inc'); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: $dummy = unserialize('O:10:\"SoapClient\":3:{s:3:\"uri\";s:1:\"X\";s:8:\"location\";s:22:\"http://localhost/a.xml\";s:17:\"__default_headers\";a:1:{i:1;s:1337:\"'.str_repeat(\"X\", 1337).'\";}}');",
          "8: try {",
          "9:  var_dump($dummy->notexisting());",
          "10: } catch(Exception $e) {",
          "11:  var_dump($e->getMessage());",
          "12:  var_dump(get_class($e));",
          "13: }",
          "14: ?>",
          "15: --EXPECTF--",
          "16: string(%d) \"%s\"",
          "17: string(9) \"SoapFault\"",
          "",
          "---------------"
        ],
        "ext/spl/spl_dllist.c||ext/spl/spl_dllist.c": [
          "File: ext/spl/spl_dllist.c -> ext/spl/spl_dllist.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1210:   if (!php_var_unserialize(elem, &p, s + buf_len, &var_hash)) {",
          "1211:    goto error;",
          "1212:   }",
          "1214:   spl_ptr_llist_push(intern->llist, elem);",
          "1215:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1213:   var_push_dtor(&var_hash, elem);",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70155.phpt||ext/spl/tests/bug70155.phpt": [
          "File: ext/spl/tests/bug70155.phpt -> ext/spl/tests/bug70155.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70155 Use After Free Vulnerability in unserialize() with SPLArrayObject",
          "3: --FILE--",
          "4: <?php",
          "5: $inner = 'x:i:0;O:12:\"DateInterval\":1:{s:1:\"y\";i:3;};m:a:1:{i:0;R:2;}';",
          "6: $exploit = 'C:11:\"ArrayObject\":'.strlen($inner).':{'.$inner.'}';",
          "7: $data = unserialize($exploit);",
          "9: var_dump($data);",
          "10: ?>",
          "11: ===DONE===",
          "12: --EXPECTF--",
          "13: object(ArrayObject)#1 (2) {",
          "14:   [0]=>",
          "15:   int(0)",
          "16:   [\"storage\":\"ArrayObject\":private]=>",
          "17:   object(DateInterval)#2 (15) {",
          "18:     [\"y\"]=>",
          "19:     int(3)",
          "20:     [\"m\"]=>",
          "21:     int(-1)",
          "22:     [\"d\"]=>",
          "23:     int(-1)",
          "24:     [\"h\"]=>",
          "25:     int(-1)",
          "26:     [\"i\"]=>",
          "27:     int(-1)",
          "28:     [\"s\"]=>",
          "29:     int(-1)",
          "30:     [\"weekday\"]=>",
          "31:     int(-1)",
          "32:     [\"weekday_behavior\"]=>",
          "33:     int(-1)",
          "34:     [\"first_last_day_of\"]=>",
          "35:     int(-1)",
          "36:     [\"invert\"]=>",
          "37:     int(0)",
          "38:     [\"days\"]=>",
          "39:     int(-1)",
          "40:     [\"special_type\"]=>",
          "41:     int(0)",
          "42:     [\"special_amount\"]=>",
          "43:     int(-1)",
          "44:     [\"have_weekday_relative\"]=>",
          "45:     int(0)",
          "46:     [\"have_special_relative\"]=>",
          "47:     int(0)",
          "48:   }",
          "49: }",
          "50: ===DONE===",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70365.phpt||ext/spl/tests/bug70365.phpt": [
          "File: ext/spl/tests/bug70365.phpt -> ext/spl/tests/bug70365.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70365 use-after-free vulnerability in unserialize() with SplObjectStorage",
          "3: --FILE--",
          "4: <?php",
          "5: class obj {",
          "6:  var $ryat;",
          "7:  function __wakeup() {",
          "8:   $this->ryat = 1;",
          "9:  }",
          "10: }",
          "12: $fakezval = ptr2str(1122334455);",
          "13: $fakezval .= ptr2str(0);",
          "14: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "15: $fakezval .= \"\\x01\";",
          "16: $fakezval .= \"\\x00\";",
          "17: $fakezval .= \"\\x00\\x00\";",
          "19: $inner = 'x:i:1;O:8:\"stdClass\":0:{},i:1;;m:a:0:{}';",
          "20: $exploit = 'a:5:{i:0;i:1;i:1;C:16:\"SplObjectStorage\":'.strlen($inner).':{'.$inner.'}i:2;O:3:\"obj\":1:{s:4:\"ryat\";R:3;}i:3;R:6;i:4;s:'.strlen($fakezval).':\"'.$fakezval.'\";}';",
          "22: $data = unserialize($exploit);",
          "24: var_dump($data);",
          "26: function ptr2str($ptr)",
          "27: {",
          "28:  $out = '';",
          "29:  for ($i = 0; $i < 8; $i++) {",
          "30:   $out .= chr($ptr & 0xff);",
          "31:   $ptr >>= 8;",
          "32:  }",
          "33:  return $out;",
          "34: }",
          "35: --EXPECTF--",
          "36: array(5) {",
          "37:   [0]=>",
          "38:   int(1)",
          "39:   [1]=>",
          "40:   &int(1)",
          "41:   [2]=>",
          "42:   object(obj)#%d (1) {",
          "43:     [\"ryat\"]=>",
          "44:     &int(1)",
          "45:   }",
          "46:   [3]=>",
          "47:   int(1)",
          "48:   [4]=>",
          "49:   string(24) \"%s\"",
          "50: }",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70366.phpt||ext/spl/tests/bug70366.phpt": [
          "File: ext/spl/tests/bug70366.phpt -> ext/spl/tests/bug70366.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70366 use-after-free vulnerability in unserialize() with SplDoublyLinkedList",
          "3: --FILE--",
          "4: <?php",
          "5: class obj {",
          "6:  var $ryat;",
          "7:  function __wakeup() {",
          "8:   $this->ryat = 1;",
          "9:  }",
          "10: }",
          "12: $fakezval = ptr2str(1122334455);",
          "13: $fakezval .= ptr2str(0);",
          "14: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "15: $fakezval .= \"\\x01\";",
          "16: $fakezval .= \"\\x00\";",
          "17: $fakezval .= \"\\x00\\x00\";",
          "19: $inner = 'i:1234;:i:1;';",
          "20: $exploit = 'a:5:{i:0;i:1;i:1;C:19:\"SplDoublyLinkedList\":'.strlen($inner).':{'.$inner.'}i:2;O:3:\"obj\":1:{s:4:\"ryat\";R:3;}i:3;a:1:{i:0;R:5;}i:4;s:'.strlen($fakezval).':\"'.$fakezval.'\";}';",
          "22: $data = unserialize($exploit);",
          "24: var_dump($data);",
          "26: function ptr2str($ptr)",
          "27: {",
          "28:  $out = '';",
          "29:  for ($i = 0; $i < 8; $i++) {",
          "30:   $out .= chr($ptr & 0xff);",
          "31:   $ptr >>= 8;",
          "32:  }",
          "33:  return $out;",
          "34: }",
          "35: ?>",
          "36: --EXPECTF--",
          "37: array(5) {",
          "38:   [0]=>",
          "39:   int(1)",
          "40:   [1]=>",
          "41:   &int(1)",
          "42:   [2]=>",
          "43:   object(obj)#%d (1) {",
          "44:     [\"ryat\"]=>",
          "45:     &int(1)",
          "46:   }",
          "47:   [3]=>",
          "48:   array(1) {",
          "49:     [0]=>",
          "50:     int(1)",
          "51:   }",
          "52:   [4]=>",
          "53:   string(24) \"%s\"",
          "54: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70172.phpt||ext/standard/tests/serialize/bug70172.phpt": [
          "File: ext/standard/tests/serialize/bug70172.phpt -> ext/standard/tests/serialize/bug70172.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70172 - Use After Free Vulnerability in unserialize()",
          "3: --XFAIL--",
          "4: Memory leak on debug build, needs fix.",
          "5: --FILE--",
          "6: <?php",
          "7: class obj implements Serializable {",
          "8:  var $data;",
          "9:  function serialize() {",
          "10:   return serialize($this->data);",
          "11:  }",
          "12:  function unserialize($data) {",
          "13:   $this->data = unserialize($data);",
          "14:  }",
          "15: }",
          "17: $fakezval = ptr2str(1122334455);",
          "18: $fakezval .= ptr2str(0);",
          "19: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "20: $fakezval .= \"\\x01\";",
          "21: $fakezval .= \"\\x00\";",
          "22: $fakezval .= \"\\x00\\x00\";",
          "24: $inner = 'r:2;';",
          "25: $exploit = 'a:2:{i:0;i:1;i:1;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}}';",
          "27: $data = unserialize($exploit);",
          "29: for ($i = 0; $i < 5; $i++) {",
          "30:  $v[$i] = $fakezval.$i;",
          "31: }",
          "33: var_dump($data);",
          "35: function ptr2str($ptr)",
          "36: {",
          "37:  $out = '';",
          "38:  for ($i = 0; $i < 8; $i++) {",
          "39:   $out .= chr($ptr & 0xff);",
          "40:   $ptr >>= 8;",
          "41:  }",
          "42:  return $out;",
          "43: }",
          "44: ?>",
          "45: --EXPECTF--",
          "46: array(2) {",
          "47:   [0]=>",
          "48:   int(1)",
          "49:   [1]=>",
          "50:   object(obj)#%d (1) {",
          "51:     [\"data\"]=>",
          "52:     int(1)",
          "53:   }",
          "54: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70172_2.phpt||ext/standard/tests/serialize/bug70172_2.phpt": [
          "File: ext/standard/tests/serialize/bug70172_2.phpt -> ext/standard/tests/serialize/bug70172_2.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70172 - Use After Free Vulnerability in unserialize()",
          "3: --FILE--",
          "4: <?php",
          "5: class obj implements Serializable {",
          "6:  var $data;",
          "7:  function serialize() {",
          "8:   return serialize($this->data);",
          "9:  }",
          "10:  function unserialize($data) {",
          "11:   $this->data = unserialize($data);",
          "12:  }",
          "13: }",
          "15: class obj2 {",
          "16:  var $ryat;",
          "17:  function __wakeup() {",
          "18:   $this->ryat = 1;",
          "19:  }",
          "20: }",
          "22: $fakezval = ptr2str(1122334455);",
          "23: $fakezval .= ptr2str(0);",
          "24: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "25: $fakezval .= \"\\x01\";",
          "26: $fakezval .= \"\\x00\";",
          "27: $fakezval .= \"\\x00\\x00\";",
          "29: $inner = 'r:2;';",
          "30: $exploit = 'a:2:{i:0;O:4:\"obj2\":1:{s:4:\"ryat\";C:3:\"obj\":'.strlen($inner).':{'.$inner.'}}i:1;a:1:{i:0;a:1:{i:0;R:4;}}}';",
          "32: $data = unserialize($exploit);",
          "34: for ($i = 0; $i < 5; $i++) {",
          "35:  $v[$i] = $fakezval.$i;",
          "36: }",
          "38: var_dump($data);",
          "40: function ptr2str($ptr)",
          "41: {",
          "42:  $out = '';",
          "43:  for ($i = 0; $i < 8; $i++) {",
          "44:   $out .= chr($ptr & 0xff);",
          "45:   $ptr >>= 8;",
          "46:  }",
          "47:  return $out;",
          "48: }",
          "49: ?>",
          "50: --EXPECTF--",
          "51: array(2) {",
          "52:   [0]=>",
          "53:   object(obj2)#%d (1) {",
          "54:     [\"ryat\"]=>",
          "55:     int(1)",
          "56:   }",
          "57:   [1]=>",
          "58:   array(1) {",
          "59:     [0]=>",
          "60:     array(1) {",
          "61:       [0]=>",
          "62:       &object(obj2)#%d (1) {",
          "63:         [\"ryat\"]=>",
          "64:         int(1)",
          "65:       }",
          "66:     }",
          "67:   }",
          "68: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70219.phpt||ext/standard/tests/serialize/bug70219.phpt": [
          "File: ext/standard/tests/serialize/bug70219.phpt -> ext/standard/tests/serialize/bug70219.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70219 Use after free vulnerability in session deserializer",
          "3: --FILE--",
          "4: <?php",
          "5: class obj implements Serializable {",
          "6:     var $data;",
          "7:     function serialize() {",
          "8:         return serialize($this->data);",
          "9:     }",
          "10:     function unserialize($data) {",
          "11:         session_start();",
          "12:         session_decode($data);",
          "13:     }",
          "14: }",
          "16: $inner = 'ryat|a:1:{i:0;a:1:{i:1;';",
          "17: $exploit = 'a:2:{i:0;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}i:1;R:4;}';",
          "19: $data = unserialize($exploit);",
          "21: for ($i = 0; $i < 5; $i++) {",
          "22:     $v[$i] = 'hi'.$i;",
          "23: }",
          "25: var_dump($data);",
          "26: ?>",
          "27: --EXPECTF--",
          "28: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s on line %d",
          "29: array(2) {",
          "30:   [0]=>",
          "31:   object(obj)#%d (1) {",
          "32:     [\"data\"]=>",
          "33:     NULL",
          "34:   }",
          "35:   [1]=>",
          "36:   &array(1) {",
          "37:     [\"data\"]=>",
          "38:     NULL",
          "39:   }",
          "40: }",
          "",
          "---------------"
        ],
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1045:  php_unserialize_data_t var_hash;",
          "1046:  zval *options = NULL, *classes = NULL;",
          "1047:  HashTable *class_hash = NULL;",
          "1049:  if (zend_parse_parameters(ZEND_NUM_ARGS(), \"s|a\", &buf, &buf_len, &options) == FAILURE) {",
          "1050:   RETURN_FALSE;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1048:  zval *old_rval = return_value;",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "103: #if 0",
          "104: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "105: {",
          "107: #if VAR_ENTRIES_DBG",
          "109: #endif",
          "111:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "106:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "108:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "[Added Lines]",
          "106:  var_entries *var_hash;",
          "108:     if (!var_hashx || !*var_hashx) {",
          "109:         return;",
          "110:     }",
          "112:     var_hash = (*var_hashx)->last_dtor;",
          "114:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "184:  while (var_dtor_hash) {",
          "185:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "186:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "187:   }",
          "188:   next = var_dtor_hash->next;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "192: #if VAR_ENTRIES_DBG",
          "193:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "194: #endif",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "263: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "266: #line 271 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "275: #line 280 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "530:  start = cursor;",
          "534: {",
          "535:  YYCTYPE yych;",
          "536:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "533: #line 534 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "542: #line 543 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "590:  yych = *(YYMARKER = ++YYCURSOR);",
          "591:  if (yych == ':') goto yy95;",
          "592: yy3:",
          "594:  { return 0; }",
          "596: yy4:",
          "597:  yych = *(YYMARKER = ++YYCURSOR);",
          "598:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "593: #line 881 \"ext/standard/var_unserializer.re\"",
          "595: #line 596 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "602: #line 893 \"ext/standard/var_unserializer.re\"",
          "604: #line 605 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "635:  goto yy3;",
          "636: yy14:",
          "637:  ++YYCURSOR;",
          "639:  {",
          "641:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "643: }",
          "645: yy16:",
          "646:  yych = *++YYCURSOR;",
          "647:  goto yy3;",
          "",
          "[Removed Lines]",
          "638: #line 875 \"ext/standard/var_unserializer.re\"",
          "644: #line 645 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "647: #line 887 \"ext/standard/var_unserializer.re\"",
          "653: #line 654 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "667:  if (yybm[0+yych] & 128) {",
          "668:   goto yy20;",
          "669:  }",
          "671:  yych = *++YYCURSOR;",
          "672:  if (yych != '\"') goto yy18;",
          "673:  ++YYCURSOR;",
          "675:  {",
          "676:  size_t len, len2, len3, maxlen;",
          "677:  zend_long elements;",
          "",
          "[Removed Lines]",
          "670:  if (yych != ':') goto yy18;",
          "674: #line 730 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "679:  if (yych <= '/') goto yy18;",
          "680:  if (yych >= ';') goto yy18;",
          "684: #line 741 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "686:  zval retval;",
          "687:  zval args[1];",
          "689:  if (*start == 'C') {",
          "690:   custom_object = 1;",
          "691:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "699:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "817:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "818: }",
          "820: yy25:",
          "821:  yych = *++YYCURSOR;",
          "822:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "819: #line 820 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "830: #line 831 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yych != '\"') goto yy18;",
          "843:  ++YYCURSOR;",
          "845:  {",
          "849:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "850:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "851: }",
          "853: yy32:",
          "854:  yych = *++YYCURSOR;",
          "855:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "844: #line 722 \"ext/standard/var_unserializer.re\"",
          "852: #line 853 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "855: #line 732 \"ext/standard/var_unserializer.re\"",
          "857:     if (!var_hash) return 0;",
          "864: #line 865 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "870:  yych = *++YYCURSOR;",
          "871:  if (yych != '{') goto yy18;",
          "872:  ++YYCURSOR;",
          "874:  {",
          "875:  zend_long elements = parse_iv(start + 2);",
          "879:  if (elements < 0) {",
          "880:   return 0;",
          "",
          "[Removed Lines]",
          "873: #line 701 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "885: #line 710 \"ext/standard/var_unserializer.re\"",
          "890:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "892:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "893: }",
          "895: yy39:",
          "896:  yych = *++YYCURSOR;",
          "897:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "894: #line 895 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "907: #line 908 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "912:  yych = *++YYCURSOR;",
          "913:  if (yych != '\"') goto yy18;",
          "914:  ++YYCURSOR;",
          "916:  {",
          "917:  size_t len, maxlen;",
          "918:  zend_string *str;",
          "",
          "[Removed Lines]",
          "915: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "928: #line 682 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "940:  ZVAL_STR(rval, str);",
          "941:  return 1;",
          "942: }",
          "944: yy46:",
          "945:  yych = *++YYCURSOR;",
          "946:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "943: #line 944 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "956: #line 957 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "961:  yych = *++YYCURSOR;",
          "962:  if (yych != '\"') goto yy18;",
          "963:  ++YYCURSOR;",
          "965:  {",
          "966:  size_t len, maxlen;",
          "967:  char *str;",
          "",
          "[Removed Lines]",
          "964: #line 646 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "977: #line 655 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "988:  ZVAL_STRINGL(rval, str, len);",
          "989:  return 1;",
          "990: }",
          "992: yy53:",
          "993:  yych = *++YYCURSOR;",
          "994:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "991: #line 992 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1004: #line 1005 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1076:  }",
          "1077: yy63:",
          "1078:  ++YYCURSOR;",
          "1080:  {",
          "1081: #if SIZEOF_ZEND_LONG == 4",
          "1082: use_double:",
          "",
          "[Removed Lines]",
          "1079: #line 637 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1092: #line 646 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1085:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1086:  return 1;",
          "1087: }",
          "1089: yy65:",
          "1090:  yych = *++YYCURSOR;",
          "1091:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1088: #line 1089 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1101: #line 1102 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1144:  yych = *++YYCURSOR;",
          "1145:  if (yych != ';') goto yy18;",
          "1146:  ++YYCURSOR;",
          "1148:  {",
          "",
          "[Removed Lines]",
          "1147: #line 621 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1160: #line 630 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1161:  return 1;",
          "1162: }",
          "1164: yy76:",
          "1165:  yych = *++YYCURSOR;",
          "1166:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1163: #line 1164 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1176: #line 1177 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1187:  if (yych <= '9') goto yy79;",
          "1188:  if (yych != ';') goto yy18;",
          "1189:  ++YYCURSOR;",
          "1191:  {",
          "1192: #if SIZEOF_ZEND_LONG == 4",
          "1193:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1190: #line 595 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1203: #line 604 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1213:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1214:  return 1;",
          "1215: }",
          "1217: yy83:",
          "1218:  yych = *++YYCURSOR;",
          "1219:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1216: #line 1217 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1229: #line 1230 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1221:  yych = *++YYCURSOR;",
          "1222:  if (yych != ';') goto yy18;",
          "1223:  ++YYCURSOR;",
          "1225:  {",
          "1227:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1228:  return 1;",
          "1229: }",
          "1231: yy87:",
          "1232:  ++YYCURSOR;",
          "1234:  {",
          "1236:  ZVAL_NULL(rval);",
          "1237:  return 1;",
          "1238: }",
          "1240: yy89:",
          "1241:  yych = *++YYCURSOR;",
          "1242:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1224: #line 589 \"ext/standard/var_unserializer.re\"",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "1233: #line 583 \"ext/standard/var_unserializer.re\"",
          "1239: #line 1240 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1237: #line 598 \"ext/standard/var_unserializer.re\"",
          "1243: #line 1244 \"ext/standard/var_unserializer.c\"",
          "1246: #line 592 \"ext/standard/var_unserializer.re\"",
          "1252: #line 1253 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1259:  if (yych <= '9') goto yy91;",
          "1260:  if (yych != ';') goto yy18;",
          "1261:  ++YYCURSOR;",
          "1263:  {",
          "1264:  zend_long id;",
          "",
          "[Removed Lines]",
          "1262: #line 560 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1275: #line 569 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1283:  return 1;",
          "1284: }",
          "1286: yy95:",
          "1287:  yych = *++YYCURSOR;",
          "1288:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1285: #line 1286 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1298: #line 1299 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1305:  if (yych <= '9') goto yy97;",
          "1306:  if (yych != ';') goto yy18;",
          "1307:  ++YYCURSOR;",
          "1309:  {",
          "1310:  zend_long id;",
          "",
          "[Removed Lines]",
          "1308: #line 538 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1321: #line 547 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1328:  return 1;",
          "1329: }",
          "1331: }",
          "1335:  return 0;",
          "",
          "[Removed Lines]",
          "1330: #line 1331 \"ext/standard/var_unserializer.c\"",
          "1332: #line 883 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1343: #line 1344 \"ext/standard/var_unserializer.c\"",
          "1345: #line 895 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "101: #if 0",
          "102: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "103: {",
          "105: #if VAR_ENTRIES_DBG",
          "107: #endif",
          "109:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "104:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "106:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "[Added Lines]",
          "104:  var_entries *var_hash;",
          "106:     if (!var_hashx || !*var_hashx) {",
          "107:         return;",
          "108:     }",
          "110:     var_hash = (*var_hashx)->last_dtor;",
          "112:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "182:  while (var_dtor_hash) {",
          "183:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "184:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "185:   }",
          "186:   next = var_dtor_hash->next;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "190: #if VAR_ENTRIES_DBG",
          "191:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "192: #endif",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "702:  zend_long elements = parse_iv(start + 2);",
          "706:  if (elements < 0) {",
          "707:   return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "714:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "720: }",
          "722: \"o:\" iv \":\" [\"] {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "733:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "741:  zval retval;",
          "742:  zval args[1];",
          "744:  if (*start == 'C') {",
          "745:   custom_object = 1;",
          "746:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "755:     if (!var_hash) return 0;",
          "",
          "---------------"
        ],
        "ext/xsl/xsltprocessor.c||ext/xsl/xsltprocessor.c": [
          "File: ext/xsl/xsltprocessor.c -> ext/xsl/xsltprocessor.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "218:  if (error == 1) {",
          "219:   for (i = nargs - 1; i >= 0; i--) {",
          "220:    obj = valuePop(ctxt);",
          "222:   }",
          "223:   return;",
          "224:  }",
          "",
          "[Removed Lines]",
          "221:    xmlXPathFreeObject(obj);",
          "",
          "[Added Lines]",
          "221:    if (obj) {",
          "222:     xmlXPathFreeObject(obj);",
          "223:    }",
          "",
          "---------------"
        ],
        "ext/zip/php_zip.c||ext/zip/php_zip.c": [
          "File: ext/zip/php_zip.c -> ext/zip/php_zip.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "173:  if (path_cleaned_len > 1 && IS_SLASH(path_cleaned[path_cleaned_len - 1])) {",
          "175:   is_dir_only = 1;",
          "176:  } else {",
          "177:   memcpy(file_dirname, path_cleaned, path_cleaned_len);",
          "",
          "[Removed Lines]",
          "174:   len = spprintf(&file_dirname_fullpath, 0, \"%s/%s\", dest, file);",
          "",
          "[Added Lines]",
          "174:   len = spprintf(&file_dirname_fullpath, 0, \"%s/%s\", dest, path_cleaned);",
          "",
          "---------------"
        ],
        "ext/zip/tests/bug70350.phpt||ext/zip/tests/bug70350.phpt": [
          "File: ext/zip/tests/bug70350.phpt -> ext/zip/tests/bug70350.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70350 (ZipArchive::extractTo allows for directory traversal when creating directories)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if(!extension_loaded('zip')) die('skip');",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "10: $dir = dirname(__FILE__).\"/bug70350\";",
          "11: mkdir($dir);",
          "12: $archive = new ZipArchive();",
          "13: $archive->open(\"$dir/a.zip\",ZipArchive::CREATE);",
          "14: $archive->addEmptyDir(\"../down2/\");",
          "15: $archive->close();",
          "17: $archive2 = new ZipArchive();",
          "18: $archive2->open(\"$dir/a.zip\");",
          "19: $archive2->extractTo($dir);",
          "20: $archive2->close();",
          "21: var_dump(file_exists(\"$dir/down2/\"));",
          "22: var_dump(file_exists(\"../down2/\"));",
          "23: ?>",
          "24: --CLEAN--",
          "25: <?php",
          "26: $dir = dirname(__FILE__).\"/bug70350\";",
          "27: rmdir(\"$dir/down2\");",
          "28: unlink(\"$dir/a.zip\");",
          "29: rmdir($dir);",
          "30: ?>",
          "31: --EXPECT--",
          "32: bool(true)",
          "33: bool(false)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c19d59c550053ffa797fce59aadf7bc79727390c",
      "candidate_info": {
        "commit_hash": "c19d59c550053ffa797fce59aadf7bc79727390c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/c19d59c550053ffa797fce59aadf7bc79727390c",
        "files": [
          "ext/exif/exif.c",
          "ext/hash/hash_haval.c",
          "ext/hash/tests/bug70312.phpt",
          "ext/pcre/php_pcre.c",
          "ext/pcre/tests/bug70345.phpt",
          "ext/session/session.c",
          "ext/session/tests/session_decode_error2.phpt",
          "ext/session/tests/session_decode_variation3.phpt",
          "ext/soap/soap.c",
          "ext/soap/tests/bug70388.phpt",
          "ext/spl/spl_dllist.c",
          "ext/spl/spl_observer.c",
          "ext/spl/tests/bug70155.phpt",
          "ext/spl/tests/bug70365.phpt",
          "ext/spl/tests/bug70366.phpt",
          "ext/standard/tests/serialize/bug70172.phpt",
          "ext/standard/tests/serialize/bug70172_2.phpt",
          "ext/standard/tests/serialize/bug70219.phpt",
          "ext/standard/var.c",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re",
          "ext/xsl/xsltprocessor.c",
          "ext/zip/php_zip.c",
          "ext/zip/tests/bug70350.phpt"
        ],
        "message": "Merge branch 'PHP-5.5' into PHP-5.6\n\n* PHP-5.5:\n  update NEWS\n  add NEWS for fixes\n  Improve fix for #70172\n  Fix bug #70312 - HAVAL gives wrong hashes in specific cases\n  fix test\n  add test\n  Fix bug #70366 - use-after-free vulnerability in unserialize() with SplDoublyLinkedList\n  Fix bug #70365 - use-after-free vulnerability in unserialize() with SplObjectStorage\n  Fix bug #70172 - Use After Free Vulnerability in unserialize()\n  Fix bug #70388 - SOAP serialize_function_call() type confusion\n  Fixed bug #70350: ZipArchive::extractTo allows for directory traversal when creating directories\n  Improve fix for #70385\n  Fix bug #70345 (Multiple vulnerabilities related to PCRE functions)\n  Fix bug #70385 (Buffer over-read in exif_read_data with TIFF IFD tag byte value of 32 bytes)\n  Fix bug #70219 (Use after free vulnerability in session deserializer)\n  Fix for bug #69782\n  Add CVE IDs asigned (post release) to PHP 5.4.43\n  Add CVE IDs asigned to #69085 (PHP 5.4.39)\n  5.4.45 next\n\nConflicts:\n\text/pcre/php_pcre.c\n\text/standard/var_unserializer.c\n\text/standard/var_unserializer.re\n\text/zip/php_zip.c",
        "before_after_code_files": [
          "ext/exif/exif.c||ext/exif/exif.c",
          "ext/hash/hash_haval.c||ext/hash/hash_haval.c",
          "ext/hash/tests/bug70312.phpt||ext/hash/tests/bug70312.phpt",
          "ext/pcre/php_pcre.c||ext/pcre/php_pcre.c",
          "ext/pcre/tests/bug70345.phpt||ext/pcre/tests/bug70345.phpt",
          "ext/session/session.c||ext/session/session.c",
          "ext/session/tests/session_decode_error2.phpt||ext/session/tests/session_decode_error2.phpt",
          "ext/session/tests/session_decode_variation3.phpt||ext/session/tests/session_decode_variation3.phpt",
          "ext/soap/soap.c||ext/soap/soap.c",
          "ext/soap/tests/bug70388.phpt||ext/soap/tests/bug70388.phpt",
          "ext/spl/spl_dllist.c||ext/spl/spl_dllist.c",
          "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
          "ext/spl/tests/bug70155.phpt||ext/spl/tests/bug70155.phpt",
          "ext/spl/tests/bug70365.phpt||ext/spl/tests/bug70365.phpt",
          "ext/spl/tests/bug70366.phpt||ext/spl/tests/bug70366.phpt",
          "ext/standard/tests/serialize/bug70172.phpt||ext/standard/tests/serialize/bug70172.phpt",
          "ext/standard/tests/serialize/bug70172_2.phpt||ext/standard/tests/serialize/bug70172_2.phpt",
          "ext/standard/tests/serialize/bug70219.phpt||ext/standard/tests/serialize/bug70219.phpt",
          "ext/standard/var.c||ext/standard/var.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re",
          "ext/xsl/xsltprocessor.c||ext/xsl/xsltprocessor.c",
          "ext/zip/php_zip.c||ext/zip/php_zip.c",
          "ext/zip/tests/bug70350.phpt||ext/zip/tests/bug70350.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/exif/exif.c||ext/exif/exif.c": [
          "File: ext/exif/exif.c -> ext/exif/exif.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "64: #include \"php_ini.h\"",
          "65: #include \"ext/standard/php_string.h\"",
          "66: #include \"ext/standard/php_image.h\"",
          "70: #include <sys/types.h>",
          "",
          "[Removed Lines]",
          "67: #include \"ext/standard/info.h\"",
          "",
          "[Added Lines]",
          "67: #include \"ext/standard/info.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "151:  char * encode_jis;",
          "152:  char * decode_jis_be;",
          "153:  char * decode_jis_le;",
          "156: ZEND_DECLARE_MODULE_GLOBALS(exif)",
          "",
          "[Removed Lines]",
          "154: ZEND_END_MODULE_GLOBALS(exif)",
          "",
          "[Added Lines]",
          "154: ZEND_END_MODULE_GLOBALS(exif)",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "223: {",
          "224:  REGISTER_INI_ENTRIES();",
          "225:  if (zend_hash_exists(&module_registry, \"mbstring\", sizeof(\"mbstring\"))) {",
          "227:  } else {",
          "229:  }",
          "230:  return SUCCESS;",
          "231: }",
          "",
          "[Removed Lines]",
          "226:   REGISTER_LONG_CONSTANT(\"EXIF_USE_MBSTRING\", 1, CONST_CS | CONST_PERSISTENT);",
          "228:   REGISTER_LONG_CONSTANT(\"EXIF_USE_MBSTRING\", 0, CONST_CS | CONST_PERSISTENT);",
          "",
          "[Added Lines]",
          "226:   REGISTER_LONG_CONSTANT(\"EXIF_USE_MBSTRING\", 1, CONST_CS | CONST_PERSISTENT);",
          "228:   REGISTER_LONG_CONSTANT(\"EXIF_USE_MBSTRING\", 0, CONST_CS | CONST_PERSISTENT);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "255:  exif_module_deps,",
          "256:  \"exif\",",
          "257:  exif_functions,",
          "259:  PHP_MSHUTDOWN(exif),",
          "260:  NULL, NULL,",
          "261:  PHP_MINFO(exif),",
          "",
          "[Removed Lines]",
          "258:  PHP_MINIT(exif),",
          "",
          "[Added Lines]",
          "258:  PHP_MINIT(exif),",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "268:  NULL,",
          "269:  NULL,",
          "270:  STANDARD_MODULE_PROPERTIES_EX",
          "272:  STANDARD_MODULE_PROPERTIES",
          "273: #endif",
          "274: };",
          "",
          "[Removed Lines]",
          "271: #else",
          "",
          "[Added Lines]",
          "271: #else",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "657:   { 0x0213, \"YCbCrPositioning\"},",
          "658:   { 0x0214, \"ReferenceBlackWhite\"},",
          "727:   { 0x1000, \"RelatedImageFileFormat\"},",
          "728:   { 0x800D, \"ImageID\"},",
          "",
          "[Removed Lines]",
          "660:   { 0x0301, \"Gamma\"},",
          "661:   { 0x0302, \"ICCProfileDescriptor\"},",
          "662:   { 0x0303, \"SRGBRenderingIntent\"},",
          "663:   { 0x0320, \"ImageTitle\"},",
          "664:   { 0x5001, \"ResolutionXUnit\"},",
          "665:   { 0x5002, \"ResolutionYUnit\"},",
          "666:   { 0x5003, \"ResolutionXLengthUnit\"},",
          "667:   { 0x5004, \"ResolutionYLengthUnit\"},",
          "668:   { 0x5005, \"PrintFlags\"},",
          "669:   { 0x5006, \"PrintFlagsVersion\"},",
          "670:   { 0x5007, \"PrintFlagsCrop\"},",
          "671:   { 0x5008, \"PrintFlagsBleedWidth\"},",
          "672:   { 0x5009, \"PrintFlagsBleedWidthScale\"},",
          "673:   { 0x500A, \"HalftoneLPI\"},",
          "674:   { 0x500B, \"HalftoneLPIUnit\"},",
          "675:   { 0x500C, \"HalftoneDegree\"},",
          "676:   { 0x500D, \"HalftoneShape\"},",
          "677:   { 0x500E, \"HalftoneMisc\"},",
          "678:   { 0x500F, \"HalftoneScreen\"},",
          "679:   { 0x5010, \"JPEGQuality\"},",
          "680:   { 0x5011, \"GridSize\"},",
          "681:   { 0x5012, \"ThumbnailFormat\"},",
          "682:   { 0x5013, \"ThumbnailWidth\"},",
          "683:   { 0x5014, \"ThumbnailHeight\"},",
          "684:   { 0x5015, \"ThumbnailColorDepth\"},",
          "685:   { 0x5016, \"ThumbnailPlanes\"},",
          "686:   { 0x5017, \"ThumbnailRawBytes\"},",
          "687:   { 0x5018, \"ThumbnailSize\"},",
          "688:   { 0x5019, \"ThumbnailCompressedSize\"},",
          "689:   { 0x501A, \"ColorTransferFunction\"},",
          "690:   { 0x501B, \"ThumbnailData\"},",
          "691:   { 0x5020, \"ThumbnailImageWidth\"},",
          "692:   { 0x5021, \"ThumbnailImageHeight\"},",
          "693:   { 0x5022, \"ThumbnailBitsPerSample\"},",
          "694:   { 0x5023, \"ThumbnailCompression\"},",
          "695:   { 0x5024, \"ThumbnailPhotometricInterp\"},",
          "696:   { 0x5025, \"ThumbnailImageDescription\"},",
          "697:   { 0x5026, \"ThumbnailEquipMake\"},",
          "698:   { 0x5027, \"ThumbnailEquipModel\"},",
          "699:   { 0x5028, \"ThumbnailStripOffsets\"},",
          "700:   { 0x5029, \"ThumbnailOrientation\"},",
          "701:   { 0x502A, \"ThumbnailSamplesPerPixel\"},",
          "702:   { 0x502B, \"ThumbnailRowsPerStrip\"},",
          "703:   { 0x502C, \"ThumbnailStripBytesCount\"},",
          "704:   { 0x502D, \"ThumbnailResolutionX\"},",
          "705:   { 0x502E, \"ThumbnailResolutionY\"},",
          "706:   { 0x502F, \"ThumbnailPlanarConfig\"},",
          "707:   { 0x5030, \"ThumbnailResolutionUnit\"},",
          "708:   { 0x5031, \"ThumbnailTransferFunction\"},",
          "709:   { 0x5032, \"ThumbnailSoftwareUsed\"},",
          "710:   { 0x5033, \"ThumbnailDateTime\"},",
          "711:   { 0x5034, \"ThumbnailArtist\"},",
          "712:   { 0x5035, \"ThumbnailWhitePoint\"},",
          "713:   { 0x5036, \"ThumbnailPrimaryChromaticities\"},",
          "714:   { 0x5037, \"ThumbnailYCbCrCoefficients\"},",
          "715:   { 0x5038, \"ThumbnailYCbCrSubsampling\"},",
          "716:   { 0x5039, \"ThumbnailYCbCrPositioning\"},",
          "717:   { 0x503A, \"ThumbnailRefBlackWhite\"},",
          "718:   { 0x503B, \"ThumbnailCopyRight\"},",
          "719:   { 0x5090, \"LuminanceTable\"},",
          "720:   { 0x5091, \"ChrominanceTable\"},",
          "721:   { 0x5100, \"FrameDelay\"},",
          "722:   { 0x5101, \"LoopCount\"},",
          "723:   { 0x5110, \"PixelUnit\"},",
          "724:   { 0x5111, \"PixelPerUnitX\"},",
          "725:   { 0x5112, \"PixelPerUnitY\"},",
          "726:   { 0x5113, \"PaletteHistogram\"},",
          "",
          "[Added Lines]",
          "660:   { 0x0301, \"Gamma\"},",
          "661:   { 0x0302, \"ICCProfileDescriptor\"},",
          "662:   { 0x0303, \"SRGBRenderingIntent\"},",
          "663:   { 0x0320, \"ImageTitle\"},",
          "664:   { 0x5001, \"ResolutionXUnit\"},",
          "665:   { 0x5002, \"ResolutionYUnit\"},",
          "666:   { 0x5003, \"ResolutionXLengthUnit\"},",
          "667:   { 0x5004, \"ResolutionYLengthUnit\"},",
          "668:   { 0x5005, \"PrintFlags\"},",
          "669:   { 0x5006, \"PrintFlagsVersion\"},",
          "670:   { 0x5007, \"PrintFlagsCrop\"},",
          "671:   { 0x5008, \"PrintFlagsBleedWidth\"},",
          "672:   { 0x5009, \"PrintFlagsBleedWidthScale\"},",
          "673:   { 0x500A, \"HalftoneLPI\"},",
          "674:   { 0x500B, \"HalftoneLPIUnit\"},",
          "675:   { 0x500C, \"HalftoneDegree\"},",
          "676:   { 0x500D, \"HalftoneShape\"},",
          "677:   { 0x500E, \"HalftoneMisc\"},",
          "678:   { 0x500F, \"HalftoneScreen\"},",
          "679:   { 0x5010, \"JPEGQuality\"},",
          "680:   { 0x5011, \"GridSize\"},",
          "681:   { 0x5012, \"ThumbnailFormat\"},",
          "682:   { 0x5013, \"ThumbnailWidth\"},",
          "683:   { 0x5014, \"ThumbnailHeight\"},",
          "684:   { 0x5015, \"ThumbnailColorDepth\"},",
          "685:   { 0x5016, \"ThumbnailPlanes\"},",
          "686:   { 0x5017, \"ThumbnailRawBytes\"},",
          "687:   { 0x5018, \"ThumbnailSize\"},",
          "688:   { 0x5019, \"ThumbnailCompressedSize\"},",
          "689:   { 0x501A, \"ColorTransferFunction\"},",
          "690:   { 0x501B, \"ThumbnailData\"},",
          "691:   { 0x5020, \"ThumbnailImageWidth\"},",
          "692:   { 0x5021, \"ThumbnailImageHeight\"},",
          "693:   { 0x5022, \"ThumbnailBitsPerSample\"},",
          "694:   { 0x5023, \"ThumbnailCompression\"},",
          "695:   { 0x5024, \"ThumbnailPhotometricInterp\"},",
          "696:   { 0x5025, \"ThumbnailImageDescription\"},",
          "697:   { 0x5026, \"ThumbnailEquipMake\"},",
          "698:   { 0x5027, \"ThumbnailEquipModel\"},",
          "699:   { 0x5028, \"ThumbnailStripOffsets\"},",
          "700:   { 0x5029, \"ThumbnailOrientation\"},",
          "701:   { 0x502A, \"ThumbnailSamplesPerPixel\"},",
          "702:   { 0x502B, \"ThumbnailRowsPerStrip\"},",
          "703:   { 0x502C, \"ThumbnailStripBytesCount\"},",
          "704:   { 0x502D, \"ThumbnailResolutionX\"},",
          "705:   { 0x502E, \"ThumbnailResolutionY\"},",
          "706:   { 0x502F, \"ThumbnailPlanarConfig\"},",
          "707:   { 0x5030, \"ThumbnailResolutionUnit\"},",
          "708:   { 0x5031, \"ThumbnailTransferFunction\"},",
          "709:   { 0x5032, \"ThumbnailSoftwareUsed\"},",
          "710:   { 0x5033, \"ThumbnailDateTime\"},",
          "711:   { 0x5034, \"ThumbnailArtist\"},",
          "712:   { 0x5035, \"ThumbnailWhitePoint\"},",
          "713:   { 0x5036, \"ThumbnailPrimaryChromaticities\"},",
          "714:   { 0x5037, \"ThumbnailYCbCrCoefficients\"},",
          "715:   { 0x5038, \"ThumbnailYCbCrSubsampling\"},",
          "716:   { 0x5039, \"ThumbnailYCbCrPositioning\"},",
          "717:   { 0x503A, \"ThumbnailRefBlackWhite\"},",
          "718:   { 0x503B, \"ThumbnailCopyRight\"},",
          "719:   { 0x5090, \"LuminanceTable\"},",
          "720:   { 0x5091, \"ChrominanceTable\"},",
          "721:   { 0x5100, \"FrameDelay\"},",
          "722:   { 0x5101, \"LoopCount\"},",
          "723:   { 0x5110, \"PixelUnit\"},",
          "724:   { 0x5111, \"PixelPerUnitX\"},",
          "725:   { 0x5112, \"PixelPerUnitY\"},",
          "726:   { 0x5113, \"PaletteHistogram\"},",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1214:   if (components > 0) {",
          "1215:    dump = erealloc(dump, len + 2 + 1);",
          "1216:    snprintf(dump + len, 2 + 1, \", \");",
          "1218:    components--;",
          "1219:   } else{",
          "1220:    break;",
          "",
          "[Removed Lines]",
          "1217:    len += 2;",
          "",
          "[Added Lines]",
          "1217:    len += 2;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2635:    }",
          "2637:    if (zend_multibyte_encoding_converter(",
          "2640:      (unsigned char*)szValuePtr,",
          "2641:      ByteCount,",
          "2642:      zend_multibyte_fetch_encoding(ImageInfo->encode_unicode TSRMLS_CC),",
          "",
          "[Removed Lines]",
          "2638:      (unsigned char**)pszInfoPtr,",
          "2639:      &len,",
          "",
          "[Added Lines]",
          "2638:      (unsigned char**)pszInfoPtr,",
          "2639:      &len,",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2656:    ByteCount -= 8;",
          "2658:    if (zend_multibyte_encoding_converter(",
          "2661:      (unsigned char*)szValuePtr,",
          "2662:      ByteCount,",
          "2663:      zend_multibyte_fetch_encoding(ImageInfo->encode_jis TSRMLS_CC),",
          "",
          "[Removed Lines]",
          "2659:      (unsigned char**)pszInfoPtr,",
          "2660:      &len,",
          "",
          "[Added Lines]",
          "2659:      (unsigned char**)pszInfoPtr,",
          "2660:      &len,",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "2692: static int exif_process_unicode(image_info_type *ImageInfo, xp_field_type *xp_field, int tag, char *szValuePtr, int ByteCount TSRMLS_DC)",
          "2693: {",
          "2695:  xp_field->value = NULL;",
          "2697:  if (zend_multibyte_encoding_converter(",
          "2700:    (unsigned char*)szValuePtr,",
          "2701:    ByteCount,",
          "2702:    zend_multibyte_fetch_encoding(ImageInfo->encode_unicode TSRMLS_CC),",
          "",
          "[Removed Lines]",
          "2694:  xp_field->tag = tag;",
          "2698:    (unsigned char**)&xp_field->value,",
          "2699:    &xp_field->size,",
          "",
          "[Added Lines]",
          "2694:  xp_field->tag = tag;",
          "2698:    (unsigned char**)&xp_field->value,",
          "2699:    &xp_field->size,",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "2842:   offset_val = php_ifd_get32u(dir_entry+8, ImageInfo->motorola_intel);",
          "2844:   value_ptr = offset_base+offset_val;",
          "2846:             dir_entry is ImageInfo->file.list[sn].data+2+i*12",
          "2848:             dir_entry - offset_base is dir_offset+2+i*12",
          "2850:   if (byte_count > IFDlength || offset_val > IFDlength-byte_count || value_ptr < dir_entry || offset_val < (size_t)(dir_entry-offset_base)) {",
          "",
          "[Removed Lines]",
          "2847:             offset_base is ImageInfo->file.list[sn].data-dir_offset",
          "",
          "[Added Lines]",
          "2847:             offset_base is ImageInfo->file.list[sn].data-dir_offset",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "2954:      if (length<byte_count-1) {",
          "2956:       ImageInfo->CopyrightPhotographer  = estrdup(value_ptr);",
          "2958:       spprintf(&ImageInfo->Copyright, 0, \"%s, %s\", value_ptr, value_ptr+length+1);",
          "2962:      } else {",
          "2964:      }",
          "2965:     }",
          "2968:    case TAG_USERCOMMENT:",
          "2969:     ImageInfo->UserCommentLength = exif_process_user_comment(ImageInfo, &(ImageInfo->UserComment), &(ImageInfo->UserCommentEncoding), value_ptr, byte_count TSRMLS_CC);",
          "",
          "[Removed Lines]",
          "2957:       ImageInfo->CopyrightEditor        = estrdup(value_ptr+length+1);",
          "2963:       ImageInfo->Copyright = estrdup(value_ptr);",
          "2966:     break;",
          "",
          "[Added Lines]",
          "2957:       ImageInfo->CopyrightEditor        = estrndup(value_ptr+length+1, byte_count-length-1);",
          "2963:       ImageInfo->Copyright = estrndup(value_ptr, byte_count);",
          "2966:     break;",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "3051:     break;",
          "3053:    case TAG_MAKE:",
          "3055:     break;",
          "3056:    case TAG_MODEL:",
          "3058:     break;",
          "3060:    case TAG_MAKER_NOTE:",
          "",
          "[Removed Lines]",
          "3054:     ImageInfo->make = estrdup(value_ptr);",
          "3057:     ImageInfo->model = estrdup(value_ptr);",
          "",
          "[Added Lines]",
          "3054:     ImageInfo->make = estrndup(value_ptr, byte_count);",
          "3057:     ImageInfo->model = estrndup(value_ptr, byte_count);",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "3449:  }",
          "3450:  for (;;) {",
          "3451:   pos += length;",
          "3453:    return FALSE;",
          "3454:   c = data[pos++];",
          "3456:    return FALSE;",
          "3457:   if (c != 0xFF) {",
          "3458:    return FALSE;",
          "3459:   }",
          "3460:   n = 8;",
          "3461:   while ((c = data[pos++]) == 0xFF && n--) {",
          "3463:     return FALSE;",
          "3465:   }",
          "3467:    return FALSE;",
          "3468:   marker = c;",
          "3469:   length = php_jpg_get16(data+pos);",
          "",
          "[Removed Lines]",
          "3452:   if (pos>=ImageInfo->Thumbnail.size)",
          "3455:   if (pos>=ImageInfo->Thumbnail.size)",
          "3462:    if (pos+3>=ImageInfo->Thumbnail.size)",
          "3466:   if (c == 0xFF)",
          "",
          "[Added Lines]",
          "3452:   if (pos>=ImageInfo->Thumbnail.size)",
          "3455:   if (pos>=ImageInfo->Thumbnail.size)",
          "3462:    if (pos+3>=ImageInfo->Thumbnail.size)",
          "3466:   if (c == 0xFF)",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "3777:     exif_error_docref(NULL EXIFERR_CC, ImageInfo, E_NOTICE, \"File has TIFF/II format\");",
          "3778: #endif",
          "3779:     ImageInfo->sections_found |= FOUND_IFD0;",
          "3781:             php_ifd_get32u(file_header + 4, ImageInfo->motorola_intel),",
          "3782:             SECTION_IFD0 TSRMLS_CC)) {",
          "3783:      ret = TRUE;",
          "",
          "[Removed Lines]",
          "3780:     if (exif_process_IFD_in_TIFF(ImageInfo,",
          "",
          "[Added Lines]",
          "3780:     if (exif_process_IFD_in_TIFF(ImageInfo,",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "3957:  sections_str = exif_get_sectionlist(ImageInfo.sections_found TSRMLS_CC);",
          "3959: #ifdef EXIF_DEBUG",
          "3961:   exif_error_docref(NULL EXIFERR_CC, &ImageInfo, E_NOTICE, \"Sections found: %s\", sections_str[0] ? sections_str : \"None\");",
          "3962: #endif",
          "",
          "[Removed Lines]",
          "3960:  if (sections_str)",
          "",
          "[Added Lines]",
          "3960:  if (sections_str)",
          "",
          "---------------"
        ],
        "ext/hash/hash_haval.c||ext/hash/hash_haval.c": [
          "File: ext/hash/hash_haval.c -> ext/hash/hash_haval.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "340:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "341:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "339:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "339:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "394:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "395:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "393:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "393:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "448:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "449:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "447:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "447:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "488:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "489:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "487:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "487:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "529:  padLen = (index < 118) ? (118 - index) : (246 - index);",
          "530:  PHP_HAVALUpdate(context, PADDING, padLen);",
          "",
          "[Removed Lines]",
          "528:  index = (unsigned int) ((context->count[0] >> 3) & 0x3f);",
          "",
          "[Added Lines]",
          "528:  index = (unsigned int) ((context->count[0] >> 3) & 0x7f);",
          "",
          "---------------"
        ],
        "ext/hash/tests/bug70312.phpt||ext/hash/tests/bug70312.phpt": [
          "File: ext/hash/tests/bug70312.phpt -> ext/hash/tests/bug70312.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70312 HAVAL gives wrong hashes in specific cases",
          "3: --SKIPIF--",
          "4: <?php if(!extension_loaded(\"hash\")) print \"skip\"; ?>",
          "5: --FILE--",
          "6: <?php",
          "7: var_dump(hash('haval128,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "8: var_dump(hash('haval160,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "9: var_dump(hash('haval192,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "10: var_dump(hash('haval224,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "11: var_dump(hash('haval256,5', '1234567890123456789012345678901234567890123456789012345678901234'));",
          "12: ?>",
          "13: --EXPECTF--",
          "14: string(32) \"f3f0d23819b87228b4b70ee350afaa9d\"",
          "15: string(40) \"aded6485e137f11d7292212ba3fa961714df0564\"",
          "16: string(48) \"e53da2b16269fe732e9a898a96707a9f28404d7333b02286\"",
          "17: string(56) \"c574fb307f0817b514b9bb2e7c4bfaffb7ad667aca3c8b523fefcf10\"",
          "18: string(64) \"fb73c19300b14d5cb393d929bf005e6c2d459a4c9c009e9813af1d2d3637ee8f\"",
          "",
          "---------------"
        ],
        "ext/pcre/php_pcre.c||ext/pcre/php_pcre.c": [
          "File: ext/pcre/php_pcre.c -> ext/pcre/php_pcre.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "301: #endif",
          "302:   }",
          "303:  }",
          "305:  p = regex;",
          "309:  while (isspace((int)*(unsigned char *)p)) p++;",
          "310:  if (*p == 0) {",
          "312:        p < regex + regex_len ? \"Null byte in regex\" : \"Empty regular expression\");",
          "313:   return NULL;",
          "314:  }",
          "318:  delimiter = *p++;",
          "",
          "[Removed Lines]",
          "311:   php_error_docref(NULL TSRMLS_CC, E_WARNING,",
          "",
          "[Added Lines]",
          "311:   php_error_docref(NULL TSRMLS_CC, E_WARNING,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "395: #ifdef PCRE_UCP",
          "396:       coptions |= PCRE_UCP;",
          "398:     break;",
          "401:    case 'e': poptions |= PREG_REPLACE_EVAL; break;",
          "403:    case ' ':",
          "404:    case '\\n':",
          "405:     break;",
          "",
          "[Removed Lines]",
          "397: #endif",
          "",
          "[Added Lines]",
          "397: #endif",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "710:    if (subpats != NULL) {",
          "713:      efree(subpat_names);",
          "714:      efree(offsets);",
          "715:      if (match_sets) efree(match_sets);",
          "",
          "[Removed Lines]",
          "712:     if (pcre_get_substring_list(subject, offsets, count, &stringlist) < 0) {",
          "",
          "[Added Lines]",
          "712:     if ((offsets[1] - offsets[0] < 0) || pcre_get_substring_list(subject, offsets, count, &stringlist) < 0) {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "903:   else",
          "904:    walk++;",
          "905:  }",
          "909: }",
          "",
          "[Removed Lines]",
          "908:  return 1;",
          "",
          "[Added Lines]",
          "908:  return 1;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1067:  int is_callable_replace, int *result_len, int limit, int *replace_count TSRMLS_DC)",
          "1068: {",
          "",
          "[Removed Lines]",
          "1066: PHPAPI char *php_pcre_replace_impl(pcre_cache_entry *pce, char *subject, int subject_len, zval *replace_val,",
          "",
          "[Added Lines]",
          "1066: PHPAPI char *php_pcre_replace_impl(pcre_cache_entry *pce, char *subject, int subject_len, zval *replace_val,",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1171:   piece = subject + start_offset;",
          "1174:    if (replace_count) {",
          "1175:     ++*replace_count;",
          "1176:    }",
          "",
          "[Removed Lines]",
          "1173:   if (count > 0 && (limit == -1 || limit > 0)) {",
          "",
          "[Added Lines]",
          "1173:   if (count > 0 && (offsets[1] - offsets[0] >= 0) && (limit == -1 || limit > 0)) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "1625:    php_error_docref(NULL TSRMLS_CC,E_NOTICE, \"Matched, but too many substrings\");",
          "1626:    count = size_offsets/3;",
          "1627:   }",
          "1631:    if (!no_empty || &subject[offsets[0]] != last_match) {",
          "1633:     if (offset_capture) {",
          "",
          "[Removed Lines]",
          "1630:   if (count > 0) {",
          "",
          "[Added Lines]",
          "1630:   if (count > 0 && (offsets[1] - offsets[0] >= 0)) {",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "1987:     ZEND_ARG_INFO(0, pattern)",
          "1988:     ZEND_ARG_INFO(0, subject)",
          "1989:     ZEND_ARG_INFO(0, limit)",
          "1991: ZEND_END_ARG_INFO()",
          "1993: ZEND_BEGIN_ARG_INFO_EX(arginfo_preg_quote, 0, 0, 1)",
          "",
          "[Removed Lines]",
          "1990:     ZEND_ARG_INFO(0, flags)",
          "",
          "[Added Lines]",
          "1990:     ZEND_ARG_INFO(0, flags)",
          "",
          "---------------"
        ],
        "ext/pcre/tests/bug70345.phpt||ext/pcre/tests/bug70345.phpt": [
          "File: ext/pcre/tests/bug70345.phpt -> ext/pcre/tests/bug70345.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70345 (Multiple vulnerabilities related to PCRE functions)",
          "3: --FILE--",
          "4: <?php",
          "5: $regex = '/(?=xyz\\K)/';",
          "6: $subject = \"aaaaxyzaaaa\";",
          "8: $v = preg_split($regex, $subject);",
          "9: print_r($v);",
          "11: $regex = '/(a(?=xyz\\K))/';",
          "12: $subject = \"aaaaxyzaaaa\";",
          "13: preg_match($regex, $subject, $matches);",
          "15: var_dump($matches);",
          "16: --EXPECTF--",
          "17: Array",
          "18: (",
          "19:     [0] => aaaaxyzaaaa",
          "20: )",
          "22: Warning: preg_match(): Get subpatterns list failed in %s on line %d",
          "23: array(0) {",
          "24: }",
          "",
          "---------------"
        ],
        "ext/session/session.c||ext/session/session.c": [
          "File: ext/session/session.c -> ext/session/session.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "216: }",
          "220: {",
          "221:  if (!PS(serializer)) {",
          "222:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Unknown session.serialize_handler. Failed to decode session object\");",
          "224:  }",
          "225:  if (PS(serializer)->decode(val, vallen TSRMLS_CC) == FAILURE) {",
          "226:   php_session_destroy(TSRMLS_C);",
          "227:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Failed to decode session object. Session has been destroyed\");",
          "228:  }",
          "229: }",
          "",
          "[Removed Lines]",
          "223:   return;",
          "",
          "[Added Lines]",
          "223:   return FAILURE;",
          "228:   return FAILURE;",
          "230:  return SUCCESS;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "947:    ALLOC_INIT_ZVAL(current);",
          "948:    if (php_var_unserialize(&current, (const unsigned char **) &p, (const unsigned char *) endptr, &var_hash TSRMLS_CC)) {",
          "949:     php_set_session_var(name, namelen, current, &var_hash  TSRMLS_CC);",
          "950:    }",
          "952:   }",
          "953:   PS_ADD_VARL(name, namelen);",
          "954:   efree(name);",
          "",
          "[Removed Lines]",
          "951:    zval_ptr_dtor(&current);",
          "",
          "[Added Lines]",
          "952:    } else {",
          "953:     PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "954:     return FAILURE;",
          "956:    var_push_dtor_no_addref(&var_hash, &current);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1039:    ALLOC_INIT_ZVAL(current);",
          "1040:    if (php_var_unserialize(&current, (const unsigned char **) &q, (const unsigned char *) endptr, &var_hash TSRMLS_CC)) {",
          "1041:     php_set_session_var(name, namelen, current, &var_hash  TSRMLS_CC);",
          "1042:    }",
          "1044:   }",
          "1045:   PS_ADD_VARL(name, namelen);",
          "1046: skip:",
          "",
          "[Removed Lines]",
          "1043:    zval_ptr_dtor(&current);",
          "",
          "[Added Lines]",
          "1047:    } else {",
          "1048:     var_push_dtor_no_addref(&var_hash, &current);",
          "1049:     efree(name);",
          "1050:     PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1051:     return FAILURE;",
          "1053:    var_push_dtor_no_addref(&var_hash, &current);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2063:   return;",
          "2064:  }",
          "2069: }",
          "",
          "[Removed Lines]",
          "2066:  php_session_decode(str, str_len TSRMLS_CC);",
          "2068:  RETURN_TRUE;",
          "",
          "[Added Lines]",
          "2076:  RETVAL_BOOL(php_session_decode(str, str_len TSRMLS_CC) == SUCCESS);",
          "",
          "---------------"
        ],
        "ext/session/tests/session_decode_error2.phpt||ext/session/tests/session_decode_error2.phpt": [
          "File: ext/session/tests/session_decode_error2.phpt -> ext/session/tests/session_decode_error2.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "53: }",
          "55: -- Iteration 4 --",
          "60: }",
          "62: -- Iteration 5 --",
          "67: }",
          "69: -- Iteration 6 --",
          "74: }",
          "76: -- Iteration 7 --",
          "81: }",
          "83: -- Iteration 8 --",
          "88: }",
          "90: -- Iteration 9 --",
          "95: }",
          "97: -- Iteration 10 --",
          "102: }",
          "104: -- Iteration 11 --",
          "109: }",
          "111: -- Iteration 12 --",
          "116: }",
          "118: -- Iteration 13 --",
          "123: }",
          "125: -- Iteration 14 --",
          "130: }",
          "132: -- Iteration 15 --",
          "137: }",
          "139: -- Iteration 16 --",
          "144: }",
          "146: -- Iteration 17 --",
          "151: }",
          "153: -- Iteration 18 --",
          "158: }",
          "160: -- Iteration 19 --",
          "165: }",
          "167: -- Iteration 20 --",
          "172: }",
          "174: -- Iteration 21 --",
          "179: }",
          "181: -- Iteration 22 --",
          "186: }",
          "188: -- Iteration 23 --",
          "193: }",
          "195: -- Iteration 24 --",
          "200: }",
          "202: -- Iteration 25 --",
          "207: }",
          "209: -- Iteration 26 --",
          "214: }",
          "216: -- Iteration 27 --",
          "221: }",
          "223: -- Iteration 28 --",
          "228: }",
          "230: -- Iteration 29 --",
          "235: }",
          "237: -- Iteration 30 --",
          "242: }",
          "244: -- Iteration 31 --",
          "249: }",
          "251: -- Iteration 32 --",
          "256: }",
          "258: -- Iteration 33 --",
          "263: }",
          "265: -- Iteration 34 --",
          "277: }",
          "279: -- Iteration 35 --",
          "291: }",
          "293: -- Iteration 36 --",
          "305: }",
          "307: -- Iteration 37 --",
          "319: }",
          "321: -- Iteration 38 --",
          "333: }",
          "335: -- Iteration 39 --",
          "349: }",
          "351: -- Iteration 40 --",
          "365: }",
          "367: -- Iteration 41 --",
          "381: }",
          "383: -- Iteration 42 --",
          "397: }",
          "399: -- Iteration 43 --",
          "420: }",
          "422: -- Iteration 44 --",
          "443: }",
          "445: -- Iteration 45 --",
          "466: }",
          "468: -- Iteration 46 --",
          "489: }",
          "491: -- Iteration 47 --",
          "512: }",
          "514: -- Iteration 48 --",
          "537: }",
          "539: -- Iteration 49 --",
          "562: }",
          "564: -- Iteration 50 --",
          "587: }",
          "589: -- Iteration 51 --",
          "612: }",
          "",
          "[Removed Lines]",
          "56: bool(true)",
          "57: array(1) {",
          "58:   [\"foo\"]=>",
          "59:   NULL",
          "63: bool(true)",
          "64: array(1) {",
          "65:   [\"foo\"]=>",
          "66:   NULL",
          "70: bool(true)",
          "71: array(1) {",
          "72:   [\"foo\"]=>",
          "73:   NULL",
          "77: bool(true)",
          "78: array(1) {",
          "79:   [\"foo\"]=>",
          "80:   NULL",
          "84: bool(true)",
          "85: array(1) {",
          "86:   [\"foo\"]=>",
          "87:   NULL",
          "91: bool(true)",
          "92: array(1) {",
          "93:   [\"foo\"]=>",
          "94:   NULL",
          "98: bool(true)",
          "99: array(1) {",
          "100:   [\"foo\"]=>",
          "101:   NULL",
          "105: bool(true)",
          "106: array(1) {",
          "107:   [\"foo\"]=>",
          "108:   NULL",
          "112: bool(true)",
          "113: array(1) {",
          "114:   [\"foo\"]=>",
          "115:   NULL",
          "119: bool(true)",
          "120: array(1) {",
          "121:   [\"foo\"]=>",
          "122:   NULL",
          "126: bool(true)",
          "127: array(1) {",
          "128:   [\"foo\"]=>",
          "129:   NULL",
          "133: bool(true)",
          "134: array(1) {",
          "135:   [\"foo\"]=>",
          "136:   NULL",
          "140: bool(true)",
          "141: array(1) {",
          "142:   [\"foo\"]=>",
          "143:   NULL",
          "147: bool(true)",
          "148: array(1) {",
          "149:   [\"foo\"]=>",
          "150:   NULL",
          "154: bool(true)",
          "155: array(1) {",
          "156:   [\"foo\"]=>",
          "157:   NULL",
          "161: bool(true)",
          "162: array(1) {",
          "163:   [\"foo\"]=>",
          "164:   NULL",
          "168: bool(true)",
          "169: array(1) {",
          "170:   [\"foo\"]=>",
          "171:   NULL",
          "175: bool(true)",
          "176: array(1) {",
          "177:   [\"foo\"]=>",
          "178:   NULL",
          "182: bool(true)",
          "183: array(1) {",
          "184:   [\"foo\"]=>",
          "185:   NULL",
          "189: bool(true)",
          "190: array(1) {",
          "191:   [\"foo\"]=>",
          "192:   NULL",
          "196: bool(true)",
          "197: array(1) {",
          "198:   [\"foo\"]=>",
          "199:   NULL",
          "203: bool(true)",
          "204: array(1) {",
          "205:   [\"foo\"]=>",
          "206:   NULL",
          "210: bool(true)",
          "211: array(1) {",
          "212:   [\"foo\"]=>",
          "213:   NULL",
          "217: bool(true)",
          "218: array(1) {",
          "219:   [\"foo\"]=>",
          "220:   NULL",
          "224: bool(true)",
          "225: array(1) {",
          "226:   [\"foo\"]=>",
          "227:   NULL",
          "231: bool(true)",
          "232: array(1) {",
          "233:   [\"foo\"]=>",
          "234:   NULL",
          "238: bool(true)",
          "239: array(1) {",
          "240:   [\"foo\"]=>",
          "241:   NULL",
          "245: bool(true)",
          "246: array(1) {",
          "247:   [\"foo\"]=>",
          "248:   NULL",
          "252: bool(true)",
          "253: array(1) {",
          "254:   [\"foo\"]=>",
          "255:   NULL",
          "259: bool(true)",
          "260: array(1) {",
          "261:   [\"foo\"]=>",
          "262:   NULL",
          "266: bool(true)",
          "267: array(1) {",
          "268:   [\"foo\"]=>",
          "269:   array(3) {",
          "270:     [0]=>",
          "271:     int(1)",
          "272:     [1]=>",
          "273:     int(2)",
          "274:     [2]=>",
          "275:     int(3)",
          "276:   }",
          "280: bool(true)",
          "281: array(1) {",
          "282:   [\"foo\"]=>",
          "283:   array(3) {",
          "284:     [0]=>",
          "285:     int(1)",
          "286:     [1]=>",
          "287:     int(2)",
          "288:     [2]=>",
          "289:     int(3)",
          "290:   }",
          "294: bool(true)",
          "295: array(1) {",
          "296:   [\"foo\"]=>",
          "297:   array(3) {",
          "298:     [0]=>",
          "299:     int(1)",
          "300:     [1]=>",
          "301:     int(2)",
          "302:     [2]=>",
          "303:     int(3)",
          "304:   }",
          "308: bool(true)",
          "309: array(1) {",
          "310:   [\"foo\"]=>",
          "311:   array(3) {",
          "312:     [0]=>",
          "313:     int(1)",
          "314:     [1]=>",
          "315:     int(2)",
          "316:     [2]=>",
          "317:     int(3)",
          "318:   }",
          "322: bool(true)",
          "323: array(1) {",
          "324:   [\"foo\"]=>",
          "325:   array(3) {",
          "326:     [0]=>",
          "327:     int(1)",
          "328:     [1]=>",
          "329:     int(2)",
          "330:     [2]=>",
          "331:     int(3)",
          "332:   }",
          "336: bool(true)",
          "337: array(2) {",
          "338:   [\"foo\"]=>",
          "339:   array(3) {",
          "340:     [0]=>",
          "341:     int(1)",
          "342:     [1]=>",
          "343:     int(2)",
          "344:     [2]=>",
          "345:     int(3)",
          "346:   }",
          "347:   [\"guff\"]=>",
          "348:   NULL",
          "352: bool(true)",
          "353: array(2) {",
          "354:   [\"foo\"]=>",
          "355:   array(3) {",
          "356:     [0]=>",
          "357:     int(1)",
          "358:     [1]=>",
          "359:     int(2)",
          "360:     [2]=>",
          "361:     int(3)",
          "362:   }",
          "363:   [\"guff\"]=>",
          "364:   NULL",
          "368: bool(true)",
          "369: array(2) {",
          "370:   [\"foo\"]=>",
          "371:   array(3) {",
          "372:     [0]=>",
          "373:     int(1)",
          "374:     [1]=>",
          "375:     int(2)",
          "376:     [2]=>",
          "377:     int(3)",
          "378:   }",
          "379:   [\"guff\"]=>",
          "380:   NULL",
          "384: bool(true)",
          "385: array(2) {",
          "386:   [\"foo\"]=>",
          "387:   array(3) {",
          "388:     [0]=>",
          "389:     int(1)",
          "390:     [1]=>",
          "391:     int(2)",
          "392:     [2]=>",
          "393:     int(3)",
          "394:   }",
          "395:   [\"guff\"]=>",
          "396:   NULL",
          "400: bool(true)",
          "401: array(2) {",
          "402:   [\"foo\"]=>",
          "403:   &array(3) {",
          "404:     [0]=>",
          "405:     int(1)",
          "406:     [1]=>",
          "407:     int(2)",
          "408:     [2]=>",
          "409:     int(3)",
          "410:   }",
          "411:   [\"guff\"]=>",
          "412:   &array(3) {",
          "413:     [0]=>",
          "414:     int(1)",
          "415:     [1]=>",
          "416:     int(2)",
          "417:     [2]=>",
          "418:     int(3)",
          "419:   }",
          "423: bool(true)",
          "424: array(2) {",
          "425:   [\"foo\"]=>",
          "426:   &array(3) {",
          "427:     [0]=>",
          "428:     int(1)",
          "429:     [1]=>",
          "430:     int(2)",
          "431:     [2]=>",
          "432:     int(3)",
          "433:   }",
          "434:   [\"guff\"]=>",
          "435:   &array(3) {",
          "436:     [0]=>",
          "437:     int(1)",
          "438:     [1]=>",
          "439:     int(2)",
          "440:     [2]=>",
          "441:     int(3)",
          "442:   }",
          "446: bool(true)",
          "447: array(2) {",
          "448:   [\"foo\"]=>",
          "449:   &array(3) {",
          "450:     [0]=>",
          "451:     int(1)",
          "452:     [1]=>",
          "453:     int(2)",
          "454:     [2]=>",
          "455:     int(3)",
          "456:   }",
          "457:   [\"guff\"]=>",
          "458:   &array(3) {",
          "459:     [0]=>",
          "460:     int(1)",
          "461:     [1]=>",
          "462:     int(2)",
          "463:     [2]=>",
          "464:     int(3)",
          "465:   }",
          "469: bool(true)",
          "470: array(2) {",
          "471:   [\"foo\"]=>",
          "472:   &array(3) {",
          "473:     [0]=>",
          "474:     int(1)",
          "475:     [1]=>",
          "476:     int(2)",
          "477:     [2]=>",
          "478:     int(3)",
          "479:   }",
          "480:   [\"guff\"]=>",
          "481:   &array(3) {",
          "482:     [0]=>",
          "483:     int(1)",
          "484:     [1]=>",
          "485:     int(2)",
          "486:     [2]=>",
          "487:     int(3)",
          "488:   }",
          "492: bool(true)",
          "493: array(2) {",
          "494:   [\"foo\"]=>",
          "495:   &array(3) {",
          "496:     [0]=>",
          "497:     int(1)",
          "498:     [1]=>",
          "499:     int(2)",
          "500:     [2]=>",
          "501:     int(3)",
          "502:   }",
          "503:   [\"guff\"]=>",
          "504:   &array(3) {",
          "505:     [0]=>",
          "506:     int(1)",
          "507:     [1]=>",
          "508:     int(2)",
          "509:     [2]=>",
          "510:     int(3)",
          "511:   }",
          "515: bool(true)",
          "516: array(3) {",
          "517:   [\"foo\"]=>",
          "518:   &array(3) {",
          "519:     [0]=>",
          "520:     int(1)",
          "521:     [1]=>",
          "522:     int(2)",
          "523:     [2]=>",
          "524:     int(3)",
          "525:   }",
          "526:   [\"guff\"]=>",
          "527:   &array(3) {",
          "528:     [0]=>",
          "529:     int(1)",
          "530:     [1]=>",
          "531:     int(2)",
          "532:     [2]=>",
          "533:     int(3)",
          "534:   }",
          "535:   [\"blah\"]=>",
          "536:   NULL",
          "540: bool(true)",
          "541: array(3) {",
          "542:   [\"foo\"]=>",
          "543:   &array(3) {",
          "544:     [0]=>",
          "545:     int(1)",
          "546:     [1]=>",
          "547:     int(2)",
          "548:     [2]=>",
          "549:     int(3)",
          "550:   }",
          "551:   [\"guff\"]=>",
          "552:   &array(3) {",
          "553:     [0]=>",
          "554:     int(1)",
          "555:     [1]=>",
          "556:     int(2)",
          "557:     [2]=>",
          "558:     int(3)",
          "559:   }",
          "560:   [\"blah\"]=>",
          "561:   NULL",
          "565: bool(true)",
          "566: array(3) {",
          "567:   [\"foo\"]=>",
          "568:   &array(3) {",
          "569:     [0]=>",
          "570:     int(1)",
          "571:     [1]=>",
          "572:     int(2)",
          "573:     [2]=>",
          "574:     int(3)",
          "575:   }",
          "576:   [\"guff\"]=>",
          "577:   &array(3) {",
          "578:     [0]=>",
          "579:     int(1)",
          "580:     [1]=>",
          "581:     int(2)",
          "582:     [2]=>",
          "583:     int(3)",
          "584:   }",
          "585:   [\"blah\"]=>",
          "586:   NULL",
          "590: bool(true)",
          "591: array(3) {",
          "592:   [\"foo\"]=>",
          "593:   &array(3) {",
          "594:     [0]=>",
          "595:     int(1)",
          "596:     [1]=>",
          "597:     int(2)",
          "598:     [2]=>",
          "599:     int(3)",
          "600:   }",
          "601:   [\"guff\"]=>",
          "602:   &array(3) {",
          "603:     [0]=>",
          "604:     int(1)",
          "605:     [1]=>",
          "606:     int(2)",
          "607:     [2]=>",
          "608:     int(3)",
          "609:   }",
          "610:   [\"blah\"]=>",
          "611:   NULL",
          "613: bool(true)",
          "614: Done",
          "",
          "[Added Lines]",
          "57: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s/session_decode_error2.php on line %d",
          "58: bool(false)",
          "59: array(0) {",
          "63: bool(false)",
          "64: array(0) {",
          "68: bool(false)",
          "69: array(0) {",
          "73: bool(false)",
          "74: array(0) {",
          "78: bool(false)",
          "79: array(0) {",
          "83: bool(false)",
          "84: array(0) {",
          "88: bool(false)",
          "89: array(0) {",
          "93: bool(false)",
          "94: array(0) {",
          "98: bool(false)",
          "99: array(0) {",
          "103: bool(false)",
          "104: array(0) {",
          "108: bool(false)",
          "109: array(0) {",
          "113: bool(false)",
          "114: array(0) {",
          "118: bool(false)",
          "119: array(0) {",
          "123: bool(false)",
          "124: array(0) {",
          "128: bool(false)",
          "129: array(0) {",
          "133: bool(false)",
          "134: array(0) {",
          "138: bool(false)",
          "139: array(0) {",
          "143: bool(false)",
          "144: array(0) {",
          "148: bool(false)",
          "149: array(0) {",
          "153: bool(false)",
          "154: array(0) {",
          "158: bool(false)",
          "159: array(0) {",
          "163: bool(false)",
          "164: array(0) {",
          "168: bool(false)",
          "169: array(0) {",
          "173: bool(false)",
          "174: array(0) {",
          "178: bool(false)",
          "179: array(0) {",
          "183: bool(false)",
          "184: array(0) {",
          "188: bool(false)",
          "189: array(0) {",
          "193: bool(false)",
          "194: array(0) {",
          "198: bool(false)",
          "199: array(0) {",
          "203: bool(false)",
          "204: array(0) {",
          "208: bool(false)",
          "209: array(0) {",
          "213: bool(false)",
          "214: array(0) {",
          "218: bool(false)",
          "219: array(0) {",
          "223: bool(false)",
          "224: array(0) {",
          "228: bool(false)",
          "229: array(0) {",
          "233: bool(false)",
          "234: array(0) {",
          "238: bool(false)",
          "239: array(0) {",
          "243: bool(false)",
          "244: array(0) {",
          "248: bool(false)",
          "249: array(0) {",
          "253: bool(false)",
          "254: array(0) {",
          "258: bool(false)",
          "259: array(0) {",
          "263: bool(false)",
          "264: array(0) {",
          "268: bool(false)",
          "269: array(0) {",
          "273: bool(false)",
          "274: array(0) {",
          "278: bool(false)",
          "279: array(0) {",
          "283: bool(false)",
          "284: array(0) {",
          "288: bool(false)",
          "289: array(0) {",
          "293: bool(false)",
          "294: array(0) {",
          "297: Warning: session_destroy(): Trying to destroy uninitialized session in %s/session_decode_error2.php on line %d",
          "298: bool(false)",
          "299: Done",
          "",
          "---------------"
        ],
        "ext/session/tests/session_decode_variation3.phpt||ext/session/tests/session_decode_variation3.phpt": [
          "File: ext/session/tests/session_decode_variation3.phpt -> ext/session/tests/session_decode_variation3.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "49: }",
          "51: Warning: session_decode(): Unknown session.serialize_handler. Failed to decode session object in %s on line %d",
          "53: array(3) {",
          "54:   [\"foo\"]=>",
          "55:   int(1234567890)",
          "",
          "[Removed Lines]",
          "52: bool(true)",
          "",
          "[Added Lines]",
          "52: bool(false)",
          "",
          "---------------"
        ],
        "ext/soap/soap.c||ext/soap/soap.c": [
          "File: ext/soap/soap.c -> ext/soap/soap.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1041:     }",
          "1042:    }",
          "1043:    zend_hash_move_forward_ex(ht2, &pos2);",
          "1046:   if (type_name) {",
          "1047:    smart_str nscat = {0};",
          "",
          "[Removed Lines]",
          "1044:   }",
          "",
          "[Added Lines]",
          "1044:   }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1071:    new_enc->to_xml = enc->to_xml;",
          "1072:    new_enc->to_zval = enc->to_zval;",
          "1073:    new_enc->details.map = emalloc(sizeof(soapMapping));",
          "1075:    if (to_xml) {",
          "1076:     zval_add_ref(&to_xml);",
          "1077:     new_enc->details.map->to_xml = to_xml;",
          "",
          "[Removed Lines]",
          "1074:    memset(new_enc->details.map, 0, sizeof(soapMapping));",
          "",
          "[Added Lines]",
          "1074:    memset(new_enc->details.map, 0, sizeof(soapMapping));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1936:   if (size == 0) {",
          "1937:    php_error_docref(NULL TSRMLS_CC, E_ERROR, \"Dump memory failed\");",
          "1940:   if (soap_version == SOAP_1_2) {",
          "1941:    sapi_add_header(\"Content-Type: application/soap+xml; charset=utf-8\", sizeof(\"Content-Type: application/soap+xml; charset=utf-8\")-1, 1);",
          "",
          "[Removed Lines]",
          "1938:   }",
          "",
          "[Added Lines]",
          "1938:   }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "2151:        use_exceptions = 1;",
          "2152:   }",
          "2156:        error_num == E_CORE_ERROR ||",
          "2158:        error_num == E_PARSE) &&",
          "2159:       use_exceptions) {",
          "2160:    zval *fault, *exception;",
          "",
          "[Removed Lines]",
          "2154:   if ((error_num == E_USER_ERROR ||",
          "2155:        error_num == E_COMPILE_ERROR ||",
          "2157:        error_num == E_ERROR ||",
          "",
          "[Added Lines]",
          "2154:   if ((error_num == E_USER_ERROR ||",
          "2155:        error_num == E_COMPILE_ERROR ||",
          "2157:        error_num == E_ERROR ||",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "2223:   va_list argcopy;",
          "2224: #endif",
          "2228:       error_num == E_CORE_ERROR ||",
          "2230:       error_num == E_PARSE) {",
          "2232:    char* code = SOAP_GLOBAL(error_code);",
          "",
          "[Removed Lines]",
          "2226:   if (error_num == E_USER_ERROR ||",
          "2227:       error_num == E_COMPILE_ERROR ||",
          "2229:       error_num == E_ERROR ||",
          "",
          "[Added Lines]",
          "2226:   if (error_num == E_USER_ERROR ||",
          "2227:       error_num == E_COMPILE_ERROR ||",
          "2229:       error_num == E_ERROR ||",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2456:   if (zend_hash_find(ht, \"encoding\", sizeof(\"encoding\"), (void**)&tmp) == SUCCESS &&",
          "2457:       Z_TYPE_PP(tmp) == IS_STRING) {",
          "2458:    xmlCharEncodingHandlerPtr encoding;",
          "2460:    encoding = xmlFindCharEncodingHandler(Z_STRVAL_PP(tmp));",
          "2461:    if (encoding == NULL) {",
          "2462:     php_error_docref(NULL TSRMLS_CC, E_ERROR, \"Invalid 'encoding' option - '%s'\", Z_STRVAL_PP(tmp));",
          "2463:    } else {",
          "2464:     xmlCharEncCloseFunc(encoding);",
          "2466:    }",
          "2467:   }",
          "2468:   if (zend_hash_find(ht, \"classmap\", sizeof(\"classmap\"), (void**)&tmp) == SUCCESS &&",
          "",
          "[Removed Lines]",
          "2465:     add_property_stringl(this_ptr, \"_encoding\", Z_STRVAL_PP(tmp), Z_STRLEN_PP(tmp), 1);",
          "",
          "[Added Lines]",
          "2465:     add_property_stringl(this_ptr, \"_encoding\", Z_STRVAL_PP(tmp), Z_STRLEN_PP(tmp), 1);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2615:  xmlFree(buf);",
          "2616:  if (ret && zend_hash_find(Z_OBJPROP_P(this_ptr), \"__soap_fault\", sizeof(\"__soap_fault\"), (void **) &fault) == SUCCESS) {",
          "2617:    return FALSE;",
          "2619:   return ret;",
          "2620: }",
          "",
          "[Removed Lines]",
          "2618:  }",
          "",
          "[Added Lines]",
          "2618:  }",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2921:    }",
          "2922:    zend_hash_internal_pointer_reset(default_headers);",
          "2923:    while (zend_hash_get_current_data(default_headers, (void**)&tmp) == SUCCESS) {",
          "2926:     zend_hash_move_forward(default_headers);",
          "2927:    }",
          "2928:   } else {",
          "",
          "[Removed Lines]",
          "2924:     Z_ADDREF_PP(tmp);",
          "2925:     zend_hash_next_index_insert(soap_headers, tmp, sizeof(zval *), NULL);",
          "",
          "[Added Lines]",
          "2924:     if(Z_TYPE_PP(tmp) == IS_OBJECT) {",
          "2925:      Z_ADDREF_PP(tmp);",
          "2926:      zend_hash_next_index_insert(soap_headers, tmp, sizeof(zval *), NULL);",
          "2927:     }",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "3231:    following SOAP requests).",
          "3232:    If new_location is not specified or null then SoapClient will use endpoint",
          "3235: PHP_METHOD(SoapClient, __setLocation)",
          "3236: {",
          "",
          "[Removed Lines]",
          "3230:    Sets the location option (the endpoint URL that will be touched by the",
          "3233:    from WSDL file.",
          "",
          "[Added Lines]",
          "3232:    Sets the location option (the endpoint URL that will be touched by the",
          "3235:    from WSDL file.",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3989:   }",
          "3991:   if (fault_ns == NULL &&",
          "3994:       zend_hash_num_elements(fault->details) == 1) {",
          "3995:    sdlParamPtr sparam;",
          "",
          "[Removed Lines]",
          "3992:       fault &&",
          "3993:       fault->details &&",
          "",
          "[Added Lines]",
          "3994:       fault &&",
          "3995:       fault->details &&",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "4014:      xmlChar *code = xmlBuildQName(BAD_CAST(str), nsptr->prefix, NULL, 0);",
          "4015:      xmlNodeSetContent(node, code);",
          "4016:      xmlFree(code);",
          "4018:      xmlNodeSetContentLen(node, BAD_CAST(str), (int)new_len);",
          "4019:     }",
          "4020:     str_efree(str);",
          "",
          "[Removed Lines]",
          "4017:     } else {",
          "",
          "[Added Lines]",
          "4019:     } else {",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "4040:      xmlChar *code = xmlBuildQName(BAD_CAST(str), nsptr->prefix, NULL, 0);",
          "4041:      xmlNodeSetContent(node, code);",
          "4042:      xmlFree(code);",
          "4044:      xmlNodeSetContentLen(node, BAD_CAST(str), (int)new_len);",
          "4045:     }",
          "4046:     str_efree(str);",
          "",
          "[Removed Lines]",
          "4043:     } else {",
          "",
          "[Added Lines]",
          "4045:     } else {",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "4213:  encode_finish();",
          "4216:      body->children == NULL && head == NULL) {",
          "4217:   xmlFreeDoc(doc);",
          "4218:   return NULL;",
          "",
          "[Removed Lines]",
          "4215:  if (function && function->responseName == NULL &&",
          "",
          "[Added Lines]",
          "4217:  if (function && function->responseName == NULL &&",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "4346:  if (head) {",
          "4347:   zval** header;",
          "4352:    zval **name, **ns, **tmp;",
          "4354:    if (zend_hash_find(ht, \"name\", sizeof(\"name\"), (void**)&name) == SUCCESS &&",
          "4355:        Z_TYPE_PP(name) == IS_STRING &&",
          "4356:        zend_hash_find(ht, \"namespace\", sizeof(\"namespace\"), (void**)&ns) == SUCCESS &&",
          "",
          "[Removed Lines]",
          "4349:   zend_hash_internal_pointer_reset(soap_headers);",
          "4350:   while (zend_hash_get_current_data(soap_headers,(void**)&header) == SUCCESS) {",
          "4351:    HashTable *ht = Z_OBJPROP_PP(header);",
          "",
          "[Added Lines]",
          "4351:   for(zend_hash_internal_pointer_reset(soap_headers);",
          "4352:     zend_hash_get_current_data(soap_headers,(void**)&header) == SUCCESS;",
          "4353:     zend_hash_move_forward(soap_headers)",
          "4354:    ) {",
          "4355:    HashTable *ht;",
          "4358:    if (Z_TYPE_PP(header) != IS_OBJECT) {",
          "4359:     continue;",
          "4360:    }",
          "4362:    ht = Z_OBJPROP_PP(header);",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "4389:     xmlSetNs(h, nsptr);",
          "4390:     set_soap_header_attributes(h, ht, version);",
          "4391:    }",
          "4393:   }",
          "4394:  }",
          "",
          "[Removed Lines]",
          "4392:    zend_hash_move_forward(soap_headers);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/soap/tests/bug70388.phpt||ext/soap/tests/bug70388.phpt": [
          "File: ext/soap/tests/bug70388.phpt -> ext/soap/tests/bug70388.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70388 (SOAP serialize_function_call() type confusion / RCE)",
          "3: --SKIPIF--",
          "4: <?php require_once('skipif.inc'); ?>",
          "5: --FILE--",
          "6: <?php",
          "7: $dummy = unserialize('O:10:\"SoapClient\":3:{s:3:\"uri\";s:1:\"X\";s:8:\"location\";s:22:\"http://localhost/a.xml\";s:17:\"__default_headers\";a:1:{i:1;s:1337:\"'.str_repeat(\"X\", 1337).'\";}}');",
          "8: try {",
          "9:  var_dump($dummy->notexisting());",
          "10: } catch(Exception $e) {",
          "11:  var_dump($e->getMessage());",
          "12:  var_dump(get_class($e));",
          "13: }",
          "14: ?>",
          "15: --EXPECTF--",
          "16: string(%d) \"%s\"",
          "17: string(9) \"SoapFault\"",
          "",
          "---------------"
        ],
        "ext/spl/spl_dllist.c||ext/spl/spl_dllist.c": [
          "File: ext/spl/spl_dllist.c -> ext/spl/spl_dllist.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1219:    zval_ptr_dtor(&elem);",
          "1220:    goto error;",
          "1221:   }",
          "1223:   spl_ptr_llist_push(intern->llist, elem TSRMLS_CC);",
          "1224:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1222:   var_push_dtor(&var_hash, &elem);",
          "",
          "---------------"
        ],
        "ext/spl/spl_observer.c||ext/spl/spl_observer.c": [
          "File: ext/spl/spl_observer.c -> ext/spl/spl_observer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "859:    zval_ptr_dtor(&pentry);",
          "860:    goto outexcept;",
          "861:   }",
          "862:   if(Z_TYPE_P(pentry) != IS_OBJECT) {",
          "863:    zval_ptr_dtor(&pentry);",
          "864:    goto outexcept;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "862:   var_push_dtor(&var_hash, &pentry);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "870:     zval_ptr_dtor(&pinf);",
          "871:     goto outexcept;",
          "872:    }",
          "873:   }",
          "875:   hash = spl_object_storage_get_hash(intern, getThis(), pentry, &hash_len TSRMLS_CC);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "874:    var_push_dtor(&var_hash, &pinf);",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70155.phpt||ext/spl/tests/bug70155.phpt": [
          "File: ext/spl/tests/bug70155.phpt -> ext/spl/tests/bug70155.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70155 Use After Free Vulnerability in unserialize() with SPLArrayObject",
          "3: --FILE--",
          "4: <?php",
          "5: $inner = 'x:i:0;O:12:\"DateInterval\":1:{s:1:\"y\";i:3;};m:a:1:{i:0;R:2;}';",
          "6: $exploit = 'C:11:\"ArrayObject\":'.strlen($inner).':{'.$inner.'}';",
          "7: $data = unserialize($exploit);",
          "9: var_dump($data);",
          "10: ?>",
          "11: ===DONE===",
          "12: --EXPECTF--",
          "13: object(ArrayObject)#1 (2) {",
          "14:   [0]=>",
          "15:   int(0)",
          "16:   [\"storage\":\"ArrayObject\":private]=>",
          "17:   object(DateInterval)#2 (15) {",
          "18:     [\"y\"]=>",
          "19:     int(3)",
          "20:     [\"m\"]=>",
          "21:     int(-1)",
          "22:     [\"d\"]=>",
          "23:     int(-1)",
          "24:     [\"h\"]=>",
          "25:     int(-1)",
          "26:     [\"i\"]=>",
          "27:     int(-1)",
          "28:     [\"s\"]=>",
          "29:     int(-1)",
          "30:     [\"weekday\"]=>",
          "31:     int(-1)",
          "32:     [\"weekday_behavior\"]=>",
          "33:     int(-1)",
          "34:     [\"first_last_day_of\"]=>",
          "35:     int(-1)",
          "36:     [\"invert\"]=>",
          "37:     int(0)",
          "38:     [\"days\"]=>",
          "39:     int(-1)",
          "40:     [\"special_type\"]=>",
          "41:     int(0)",
          "42:     [\"special_amount\"]=>",
          "43:     int(-1)",
          "44:     [\"have_weekday_relative\"]=>",
          "45:     int(0)",
          "46:     [\"have_special_relative\"]=>",
          "47:     int(0)",
          "48:   }",
          "49: }",
          "50: ===DONE===",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70365.phpt||ext/spl/tests/bug70365.phpt": [
          "File: ext/spl/tests/bug70365.phpt -> ext/spl/tests/bug70365.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70365 use-after-free vulnerability in unserialize() with SplObjectStorage",
          "3: --FILE--",
          "4: <?php",
          "5: class obj {",
          "6:  var $ryat;",
          "7:  function __wakeup() {",
          "8:   $this->ryat = 1;",
          "9:  }",
          "10: }",
          "12: $fakezval = ptr2str(1122334455);",
          "13: $fakezval .= ptr2str(0);",
          "14: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "15: $fakezval .= \"\\x01\";",
          "16: $fakezval .= \"\\x00\";",
          "17: $fakezval .= \"\\x00\\x00\";",
          "19: $inner = 'x:i:1;O:8:\"stdClass\":0:{},i:1;;m:a:0:{}';",
          "20: $exploit = 'a:5:{i:0;i:1;i:1;C:16:\"SplObjectStorage\":'.strlen($inner).':{'.$inner.'}i:2;O:3:\"obj\":1:{s:4:\"ryat\";R:3;}i:3;R:6;i:4;s:'.strlen($fakezval).':\"'.$fakezval.'\";}';",
          "22: $data = unserialize($exploit);",
          "24: var_dump($data);",
          "26: function ptr2str($ptr)",
          "27: {",
          "28:  $out = '';",
          "29:  for ($i = 0; $i < 8; $i++) {",
          "30:   $out .= chr($ptr & 0xff);",
          "31:   $ptr >>= 8;",
          "32:  }",
          "33:  return $out;",
          "34: }",
          "35: --EXPECTF--",
          "36: array(5) {",
          "37:   [0]=>",
          "38:   int(1)",
          "39:   [1]=>",
          "40:   &int(1)",
          "41:   [2]=>",
          "42:   object(obj)#%d (1) {",
          "43:     [\"ryat\"]=>",
          "44:     &int(1)",
          "45:   }",
          "46:   [3]=>",
          "47:   int(1)",
          "48:   [4]=>",
          "49:   string(24) \"%s\"",
          "50: }",
          "",
          "---------------"
        ],
        "ext/spl/tests/bug70366.phpt||ext/spl/tests/bug70366.phpt": [
          "File: ext/spl/tests/bug70366.phpt -> ext/spl/tests/bug70366.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: SPL: Bug #70366 use-after-free vulnerability in unserialize() with SplDoublyLinkedList",
          "3: --FILE--",
          "4: <?php",
          "5: class obj {",
          "6:  var $ryat;",
          "7:  function __wakeup() {",
          "8:   $this->ryat = 1;",
          "9:  }",
          "10: }",
          "12: $fakezval = ptr2str(1122334455);",
          "13: $fakezval .= ptr2str(0);",
          "14: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "15: $fakezval .= \"\\x01\";",
          "16: $fakezval .= \"\\x00\";",
          "17: $fakezval .= \"\\x00\\x00\";",
          "19: $inner = 'i:1234;:i:1;';",
          "20: $exploit = 'a:5:{i:0;i:1;i:1;C:19:\"SplDoublyLinkedList\":'.strlen($inner).':{'.$inner.'}i:2;O:3:\"obj\":1:{s:4:\"ryat\";R:3;}i:3;a:1:{i:0;R:5;}i:4;s:'.strlen($fakezval).':\"'.$fakezval.'\";}';",
          "22: $data = unserialize($exploit);",
          "24: var_dump($data);",
          "26: function ptr2str($ptr)",
          "27: {",
          "28:  $out = '';",
          "29:  for ($i = 0; $i < 8; $i++) {",
          "30:   $out .= chr($ptr & 0xff);",
          "31:   $ptr >>= 8;",
          "32:  }",
          "33:  return $out;",
          "34: }",
          "35: ?>",
          "36: --EXPECTF--",
          "37: array(5) {",
          "38:   [0]=>",
          "39:   int(1)",
          "40:   [1]=>",
          "41:   &int(1)",
          "42:   [2]=>",
          "43:   object(obj)#%d (1) {",
          "44:     [\"ryat\"]=>",
          "45:     &int(1)",
          "46:   }",
          "47:   [3]=>",
          "48:   array(1) {",
          "49:     [0]=>",
          "50:     int(1)",
          "51:   }",
          "52:   [4]=>",
          "53:   string(24) \"%s\"",
          "54: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70172.phpt||ext/standard/tests/serialize/bug70172.phpt": [
          "File: ext/standard/tests/serialize/bug70172.phpt -> ext/standard/tests/serialize/bug70172.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70172 - Use After Free Vulnerability in unserialize()",
          "3: --XFAIL--",
          "4: Memory leak on debug build, needs fix.",
          "5: --FILE--",
          "6: <?php",
          "7: class obj implements Serializable {",
          "8:  var $data;",
          "9:  function serialize() {",
          "10:   return serialize($this->data);",
          "11:  }",
          "12:  function unserialize($data) {",
          "13:   $this->data = unserialize($data);",
          "14:  }",
          "15: }",
          "17: $fakezval = ptr2str(1122334455);",
          "18: $fakezval .= ptr2str(0);",
          "19: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "20: $fakezval .= \"\\x01\";",
          "21: $fakezval .= \"\\x00\";",
          "22: $fakezval .= \"\\x00\\x00\";",
          "24: $inner = 'r:2;';",
          "25: $exploit = 'a:2:{i:0;i:1;i:1;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}}';",
          "27: $data = unserialize($exploit);",
          "29: for ($i = 0; $i < 5; $i++) {",
          "30:  $v[$i] = $fakezval.$i;",
          "31: }",
          "33: var_dump($data);",
          "35: function ptr2str($ptr)",
          "36: {",
          "37:  $out = '';",
          "38:  for ($i = 0; $i < 8; $i++) {",
          "39:   $out .= chr($ptr & 0xff);",
          "40:   $ptr >>= 8;",
          "41:  }",
          "42:  return $out;",
          "43: }",
          "44: ?>",
          "45: --EXPECTF--",
          "46: array(2) {",
          "47:   [0]=>",
          "48:   int(1)",
          "49:   [1]=>",
          "50:   object(obj)#%d (1) {",
          "51:     [\"data\"]=>",
          "52:     int(1)",
          "53:   }",
          "54: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70172_2.phpt||ext/standard/tests/serialize/bug70172_2.phpt": [
          "File: ext/standard/tests/serialize/bug70172_2.phpt -> ext/standard/tests/serialize/bug70172_2.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70172 - Use After Free Vulnerability in unserialize()",
          "3: --FILE--",
          "4: <?php",
          "5: class obj implements Serializable {",
          "6:  var $data;",
          "7:  function serialize() {",
          "8:   return serialize($this->data);",
          "9:  }",
          "10:  function unserialize($data) {",
          "11:   $this->data = unserialize($data);",
          "12:  }",
          "13: }",
          "15: class obj2 {",
          "16:  var $ryat;",
          "17:  function __wakeup() {",
          "18:   $this->ryat = 1;",
          "19:  }",
          "20: }",
          "22: $fakezval = ptr2str(1122334455);",
          "23: $fakezval .= ptr2str(0);",
          "24: $fakezval .= \"\\x00\\x00\\x00\\x00\";",
          "25: $fakezval .= \"\\x01\";",
          "26: $fakezval .= \"\\x00\";",
          "27: $fakezval .= \"\\x00\\x00\";",
          "29: $inner = 'r:2;';",
          "30: $exploit = 'a:2:{i:0;O:4:\"obj2\":1:{s:4:\"ryat\";C:3:\"obj\":'.strlen($inner).':{'.$inner.'}}i:1;a:1:{i:0;a:1:{i:0;R:4;}}}';",
          "32: $data = unserialize($exploit);",
          "34: for ($i = 0; $i < 5; $i++) {",
          "35:  $v[$i] = $fakezval.$i;",
          "36: }",
          "38: var_dump($data);",
          "40: function ptr2str($ptr)",
          "41: {",
          "42:  $out = '';",
          "43:  for ($i = 0; $i < 8; $i++) {",
          "44:   $out .= chr($ptr & 0xff);",
          "45:   $ptr >>= 8;",
          "46:  }",
          "47:  return $out;",
          "48: }",
          "49: ?>",
          "50: --EXPECTF--",
          "51: array(2) {",
          "52:   [0]=>",
          "53:   object(obj2)#%d (1) {",
          "54:     [\"ryat\"]=>",
          "55:     int(1)",
          "56:   }",
          "57:   [1]=>",
          "58:   array(1) {",
          "59:     [0]=>",
          "60:     array(1) {",
          "61:       [0]=>",
          "62:       object(obj2)#%d (1) {",
          "63:         [\"ryat\"]=>",
          "64:         int(1)",
          "65:       }",
          "66:     }",
          "67:   }",
          "68: }",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug70219.phpt||ext/standard/tests/serialize/bug70219.phpt": [
          "File: ext/standard/tests/serialize/bug70219.phpt -> ext/standard/tests/serialize/bug70219.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70219 Use after free vulnerability in session deserializer",
          "3: --FILE--",
          "4: <?php",
          "5: class obj implements Serializable {",
          "6:     var $data;",
          "7:     function serialize() {",
          "8:         return serialize($this->data);",
          "9:     }",
          "10:     function unserialize($data) {",
          "11:         session_start();",
          "12:         session_decode($data);",
          "13:     }",
          "14: }",
          "16: $inner = 'ryat|a:1:{i:0;a:1:{i:1;';",
          "17: $exploit = 'a:2:{i:0;C:3:\"obj\":'.strlen($inner).':{'.$inner.'}i:1;R:4;}';",
          "19: $data = unserialize($exploit);",
          "21: for ($i = 0; $i < 5; $i++) {",
          "22:     $v[$i] = 'hi'.$i;",
          "23: }",
          "25: var_dump($data);",
          "26: ?>",
          "27: --EXPECTF--",
          "28: Warning: session_decode(): Failed to decode session object. Session has been destroyed in %s on line %d",
          "29: array(2) {",
          "30:   [0]=>",
          "31:   object(obj)#%d (1) {",
          "32:     [\"data\"]=>",
          "33:     NULL",
          "34:   }",
          "35:   [1]=>",
          "36:   array(0) {",
          "37:   }",
          "38: }",
          "",
          "---------------"
        ],
        "ext/standard/var.c||ext/standard/var.c": [
          "File: ext/standard/var.c -> ext/standard/var.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "948:  int buf_len;",
          "949:  const unsigned char *p;",
          "950:  php_unserialize_data_t var_hash;",
          "952:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &buf, &buf_len) == FAILURE) {",
          "953:   RETURN_FALSE;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "951:  int oldlevel;",
          "952:  zval *old_rval = return_value;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "967:   }",
          "968:   RETURN_FALSE;",
          "969:  }",
          "970:  PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "971: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "972:  if (return_value != old_rval) {",
          "977:   zval_dtor(old_rval);",
          "979:   zval_copy_ctor(old_rval);",
          "980:   var_push_dtor_no_addref(&var_hash, &return_value);",
          "983:  } else {",
          "984:   var_push_dtor(&var_hash, &return_value);",
          "985:  }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "69:  var_hash = (*var_hashx)->last_dtor;",
          "70: #if VAR_ENTRIES_DBG",
          "72: #endif",
          "74:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "71:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "[Added Lines]",
          "71:  fprintf(stderr, \"var_push_dtor(%p, %ld): %d\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "92: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval **rval)",
          "93: {",
          "95: #if VAR_ENTRIES_DBG",
          "97: #endif",
          "99:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "94:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "96:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "[Added Lines]",
          "94:  var_entries *var_hash;",
          "96:     if (!var_hashx || !*var_hashx) {",
          "97:         return;",
          "98:     }",
          "100:     var_hash = (*var_hashx)->last_dtor;",
          "102:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "169:  }",
          "171:  var_hash = (*var_hashx)->first_dtor;",
          "173:  while (var_hash) {",
          "174:   for (i = 0; i < var_hash->used_slots; i++) {",
          "175:    zval_ptr_dtor(&var_hash->data[i]);",
          "176:   }",
          "177:   next = var_hash->next;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "181: #if VAR_ENTRIES_DBG",
          "182:     fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_hash->data[i], Z_REFCOUNT_P(var_hash->data[i]));",
          "183: #endif",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "232: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "235: #line 240 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "244: #line 249 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "303:   ALLOC_INIT_ZVAL(key);",
          "305:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "308:    return 0;",
          "309:   }",
          "311:   if (Z_TYPE_P(key) != IS_LONG && Z_TYPE_P(key) != IS_STRING) {",
          "314:    return 0;",
          "315:   }",
          "317:   ALLOC_INIT_ZVAL(data);",
          "319:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "323:    return 0;",
          "324:   }",
          "",
          "[Removed Lines]",
          "306:    zval_dtor(key);",
          "307:    FREE_ZVAL(key);",
          "312:    zval_dtor(key);",
          "313:    FREE_ZVAL(key);",
          "320:    zval_dtor(key);",
          "321:    FREE_ZVAL(key);",
          "322:    zval_ptr_dtor(&data);",
          "",
          "[Added Lines]",
          "315:             var_push_dtor_no_addref(var_hash, &key);",
          "320:             var_push_dtor_no_addref(var_hash, &key);",
          "327:             var_push_dtor_no_addref(var_hash, &key);",
          "328:             var_push_dtor_no_addref(var_hash, &data);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "348:      sizeof data, NULL);",
          "349:   }",
          "350:   var_push_dtor(var_hash, &data);",
          "355:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "356:    (*p)--;",
          "",
          "[Removed Lines]",
          "352:   zval_dtor(key);",
          "353:   FREE_ZVAL(key);",
          "",
          "[Added Lines]",
          "357:         var_push_dtor_no_addref(var_hash, &key);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "465:  limit = max;",
          "466:  cursor = *p;",
          "468:  if (YYCURSOR >= YYLIMIT) {",
          "469:   return 0;",
          "470:  }",
          "472:  if (var_hash && cursor[0] != 'R') {",
          "473:   var_push(var_hash, rval);",
          "474:  }",
          "476:  start = cursor;",
          "482: {",
          "483:  YYCTYPE yych;",
          "484:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "481: #line 482 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "485: #line 486 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "538:  yych = *(YYMARKER = ++YYCURSOR);",
          "539:  if (yych == ':') goto yy95;",
          "540: yy3:",
          "542:  { return 0; }",
          "544: yy4:",
          "545:  yych = *(YYMARKER = ++YYCURSOR);",
          "546:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "541: #line 833 \"ext/standard/var_unserializer.re\"",
          "543: #line 544 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "545: #line 840 \"ext/standard/var_unserializer.re\"",
          "547: #line 548 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "583:  goto yy3;",
          "584: yy14:",
          "585:  ++YYCURSOR;",
          "587:  {",
          "589:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "591: }",
          "593: yy16:",
          "594:  yych = *++YYCURSOR;",
          "595:  goto yy3;",
          "",
          "[Removed Lines]",
          "586: #line 827 \"ext/standard/var_unserializer.re\"",
          "592: #line 593 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "590: #line 834 \"ext/standard/var_unserializer.re\"",
          "596: #line 597 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "620:  yych = *++YYCURSOR;",
          "621:  if (yych != '\"') goto yy18;",
          "622:  ++YYCURSOR;",
          "624:  {",
          "625:  size_t len, len2, len3, maxlen;",
          "626:  long elements;",
          "",
          "[Removed Lines]",
          "623: #line 681 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "627: #line 687 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "636:  zval **args[1];",
          "637:  zval *arg_func_name;",
          "639:  if (*start == 'C') {",
          "640:   custom_object = 1;",
          "641:  }",
          "643:  INIT_PZVAL(*rval);",
          "644:  len2 = len = parse_uiv(start + 2);",
          "645:  maxlen = max - YYCURSOR;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "643:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "767:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "768: }",
          "770: yy25:",
          "771:  yych = *++YYCURSOR;",
          "772:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "769: #line 770 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "774: #line 775 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "791:  yych = *++YYCURSOR;",
          "792:  if (yych != '\"') goto yy18;",
          "793:  ++YYCURSOR;",
          "795:  {",
          "797:  INIT_PZVAL(*rval);",
          "799:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "800:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "801: }",
          "803: yy32:",
          "804:  yych = *++YYCURSOR;",
          "805:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "794: #line 673 \"ext/standard/var_unserializer.re\"",
          "802: #line 803 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "799: #line 678 \"ext/standard/var_unserializer.re\"",
          "801:     if (!var_hash) return 0;",
          "808: #line 809 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "820:  yych = *++YYCURSOR;",
          "821:  if (yych != '{') goto yy18;",
          "822:  ++YYCURSOR;",
          "824:  {",
          "825:  long elements = parse_iv(start + 2);",
          "829:  if (elements < 0) {",
          "830:   return 0;",
          "",
          "[Removed Lines]",
          "823: #line 653 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "829: #line 657 \"ext/standard/var_unserializer.re\"",
          "834:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "841:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "842: }",
          "844: yy39:",
          "845:  yych = *++YYCURSOR;",
          "846:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "843: #line 844 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "850: #line 851 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "861:  yych = *++YYCURSOR;",
          "862:  if (yych != '\"') goto yy18;",
          "863:  ++YYCURSOR;",
          "865:  {",
          "866:  size_t len, maxlen;",
          "867:  char *str;",
          "",
          "[Removed Lines]",
          "864: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "871: #line 628 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "890:  ZVAL_STRINGL(*rval, str, len, 0);",
          "891:  return 1;",
          "892: }",
          "894: yy46:",
          "895:  yych = *++YYCURSOR;",
          "896:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "893: #line 894 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "900: #line 901 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "911:  yych = *++YYCURSOR;",
          "912:  if (yych != '\"') goto yy18;",
          "913:  ++YYCURSOR;",
          "915:  {",
          "916:  size_t len, maxlen;",
          "917:  char *str;",
          "",
          "[Removed Lines]",
          "914: #line 596 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "921: #line 600 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "939:  ZVAL_STRINGL(*rval, str, len, 1);",
          "940:  return 1;",
          "941: }",
          "943: yy53:",
          "944:  yych = *++YYCURSOR;",
          "945:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "942: #line 943 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "949: #line 950 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1027:  }",
          "1028: yy63:",
          "1029:  ++YYCURSOR;",
          "1031:  {",
          "1032: #if SIZEOF_LONG == 4",
          "1033: use_double:",
          "",
          "[Removed Lines]",
          "1030: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1037: #line 590 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1037:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1038:  return 1;",
          "1039: }",
          "1041: yy65:",
          "1042:  yych = *++YYCURSOR;",
          "1043:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1040: #line 1041 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1047: #line 1048 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1096:  yych = *++YYCURSOR;",
          "1097:  if (yych != ';') goto yy18;",
          "1098:  ++YYCURSOR;",
          "1100:  {",
          "1102:  INIT_PZVAL(*rval);",
          "",
          "[Removed Lines]",
          "1099: #line 571 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1106: #line 575 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1112:  return 1;",
          "1113: }",
          "1115: yy76:",
          "1116:  yych = *++YYCURSOR;",
          "1117:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1114: #line 1115 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1121: #line 1122 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1138:  if (yych <= '9') goto yy79;",
          "1139:  if (yych != ';') goto yy18;",
          "1140:  ++YYCURSOR;",
          "1142:  {",
          "1143: #if SIZEOF_LONG == 4",
          "1144:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1141: #line 544 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1148: #line 548 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1165:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1166:  return 1;",
          "1167: }",
          "1169: yy83:",
          "1170:  yych = *++YYCURSOR;",
          "1171:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1168: #line 1169 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1175: #line 1176 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1173:  yych = *++YYCURSOR;",
          "1174:  if (yych != ';') goto yy18;",
          "1175:  ++YYCURSOR;",
          "1177:  {",
          "1179:  INIT_PZVAL(*rval);",
          "1180:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1181:  return 1;",
          "1182: }",
          "1184: yy87:",
          "1185:  ++YYCURSOR;",
          "1187:  {",
          "1189:  INIT_PZVAL(*rval);",
          "1190:  ZVAL_NULL(*rval);",
          "1191:  return 1;",
          "1192: }",
          "1194: yy89:",
          "1195:  yych = *++YYCURSOR;",
          "1196:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1176: #line 537 \"ext/standard/var_unserializer.re\"",
          "1183: #line 1184 \"ext/standard/var_unserializer.c\"",
          "1186: #line 530 \"ext/standard/var_unserializer.re\"",
          "1193: #line 1194 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1183: #line 541 \"ext/standard/var_unserializer.re\"",
          "1190: #line 1191 \"ext/standard/var_unserializer.c\"",
          "1193: #line 534 \"ext/standard/var_unserializer.re\"",
          "1200: #line 1201 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1213:  if (yych <= '9') goto yy91;",
          "1214:  if (yych != ';') goto yy18;",
          "1215:  ++YYCURSOR;",
          "1217:  {",
          "1218:  long id;",
          "",
          "[Removed Lines]",
          "1216: #line 507 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1223: #line 511 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1234:  Z_ADDREF_PP(rval);",
          "1235:  Z_UNSET_ISREF_PP(rval);",
          "1237:  return 1;",
          "1238: }",
          "1240: yy95:",
          "1241:  yych = *++YYCURSOR;",
          "1242:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1239: #line 1240 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1246: #line 1247 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1259:  if (yych <= '9') goto yy97;",
          "1260:  if (yych != ';') goto yy18;",
          "1261:  ++YYCURSOR;",
          "1263:  {",
          "1264:  long id;",
          "",
          "[Removed Lines]",
          "1262: #line 486 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1269: #line 490 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "1272:  }",
          "1274:  if (*rval != NULL) {",
          "1276:  }",
          "1278:  Z_ADDREF_PP(rval);",
          "1279:  Z_SET_ISREF_PP(rval);",
          "1281:  return 1;",
          "1282: }",
          "1284: }",
          "1288:  return 0;",
          "",
          "[Removed Lines]",
          "1275:   zval_ptr_dtor(rval);",
          "1283: #line 1284 \"ext/standard/var_unserializer.c\"",
          "1285: #line 835 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1282:   var_push_dtor_no_addref(var_hash, rval);",
          "1290: #line 1291 \"ext/standard/var_unserializer.c\"",
          "1292: #line 842 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "67:  var_hash = (*var_hashx)->last_dtor;",
          "68: #if VAR_ENTRIES_DBG",
          "70: #endif",
          "72:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "69:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "[Added Lines]",
          "69:  fprintf(stderr, \"var_push_dtor(%p, %ld): %d\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "90: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval **rval)",
          "91: {",
          "93: #if VAR_ENTRIES_DBG",
          "95: #endif",
          "97:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "",
          "[Removed Lines]",
          "92:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "94:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "[Added Lines]",
          "92:  var_entries *var_hash;",
          "94:     if (!var_hashx || !*var_hashx) {",
          "95:         return;",
          "96:     }",
          "98:     var_hash = (*var_hashx)->last_dtor;",
          "100:  fprintf(stderr, \"var_push_dtor_no_addref(%p, %ld): %d (%d)\\n\", *rval, var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "167:  }",
          "169:  var_hash = (*var_hashx)->first_dtor;",
          "171:  while (var_hash) {",
          "172:   for (i = 0; i < var_hash->used_slots; i++) {",
          "173:    zval_ptr_dtor(&var_hash->data[i]);",
          "174:   }",
          "175:   next = var_hash->next;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "179: #if VAR_ENTRIES_DBG",
          "180:     fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_hash->data[i], Z_REFCOUNT_P(var_hash->data[i]));",
          "181: #endif",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "307:   ALLOC_INIT_ZVAL(key);",
          "309:   if (!php_var_unserialize(&key, p, max, NULL TSRMLS_CC)) {",
          "312:    return 0;",
          "313:   }",
          "315:   if (Z_TYPE_P(key) != IS_LONG && Z_TYPE_P(key) != IS_STRING) {",
          "318:    return 0;",
          "319:   }",
          "321:   ALLOC_INIT_ZVAL(data);",
          "323:   if (!php_var_unserialize(&data, p, max, var_hash TSRMLS_CC)) {",
          "327:    return 0;",
          "328:   }",
          "",
          "[Removed Lines]",
          "310:    zval_dtor(key);",
          "311:    FREE_ZVAL(key);",
          "316:    zval_dtor(key);",
          "317:    FREE_ZVAL(key);",
          "324:    zval_dtor(key);",
          "325:    FREE_ZVAL(key);",
          "326:    zval_ptr_dtor(&data);",
          "",
          "[Added Lines]",
          "319:             var_push_dtor_no_addref(var_hash, &key);",
          "324:             var_push_dtor_no_addref(var_hash, &key);",
          "331:             var_push_dtor_no_addref(var_hash, &key);",
          "332:             var_push_dtor_no_addref(var_hash, &data);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "352:      sizeof data, NULL);",
          "353:   }",
          "354:   var_push_dtor(var_hash, &data);",
          "359:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "360:    (*p)--;",
          "",
          "[Removed Lines]",
          "356:   zval_dtor(key);",
          "357:   FREE_ZVAL(key);",
          "",
          "[Added Lines]",
          "361:         var_push_dtor_no_addref(var_hash, &key);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "495:  }",
          "497:  if (*rval != NULL) {",
          "499:  }",
          "501:  Z_ADDREF_PP(rval);",
          "502:  Z_SET_ISREF_PP(rval);",
          "504:  return 1;",
          "505: }",
          "",
          "[Removed Lines]",
          "498:   zval_ptr_dtor(rval);",
          "",
          "[Added Lines]",
          "502:   var_push_dtor_no_addref(var_hash, rval);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "654:  long elements = parse_iv(start + 2);",
          "658:  if (elements < 0) {",
          "659:   return 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "661:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "671: }",
          "673: \"o:\" iv \":\" [\"] {",
          "675:  INIT_PZVAL(*rval);",
          "677:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "678:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "679: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "679:     if (!var_hash) return 0;",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "693:  zval **args[1];",
          "694:  zval *arg_func_name;",
          "696:  if (*start == 'C') {",
          "697:   custom_object = 1;",
          "698:  }",
          "700:  INIT_PZVAL(*rval);",
          "701:  len2 = len = parse_uiv(start + 2);",
          "702:  maxlen = max - YYCURSOR;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "702:     if (!var_hash) return 0;",
          "",
          "---------------"
        ],
        "ext/xsl/xsltprocessor.c||ext/xsl/xsltprocessor.c": [
          "File: ext/xsl/xsltprocessor.c -> ext/xsl/xsltprocessor.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "219:    }",
          "220:   }",
          "221:  }",
          "223:  if (error == 1) {",
          "224:   for (i = nargs - 1; i >= 0; i--) {",
          "225:    obj = valuePop(ctxt);",
          "227:   }",
          "228:   return;",
          "229:  }",
          "231:  fci.param_count = nargs - 1;",
          "232:  if (fci.param_count > 0) {",
          "233:   fci.params = safe_emalloc(fci.param_count, sizeof(zval**), 0);",
          "",
          "[Removed Lines]",
          "226:    xmlXPathFreeObject(obj);",
          "",
          "[Added Lines]",
          "226:    if (obj) {",
          "227:     xmlXPathFreeObject(obj);",
          "228:    }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "297:   xmlXPathFreeObject(obj);",
          "298:   fci.params[i] = &args[i];",
          "299:  }",
          "301:  fci.size = sizeof(fci);",
          "302:  fci.function_table = EG(function_table);",
          "304:  obj = valuePop(ctxt);",
          "308:   valuePush(ctxt, xmlXPathNewString(\"\"));",
          "309:   if (fci.param_count > 0) {",
          "310:    for (i = 0; i < nargs - 1; i++) {",
          "",
          "[Removed Lines]",
          "305:  if (obj->stringval == NULL) {",
          "306:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Handler name must be a string\");",
          "307:   xmlXPathFreeObject(obj);",
          "",
          "[Added Lines]",
          "307:  if (obj == NULL || obj->stringval == NULL) {",
          "308:   if (obj) {",
          "309:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Handler name must be a string\");",
          "310:    xmlXPathFreeObject(obj);",
          "311:   }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "313:    efree(args);",
          "314:    efree(fci.params);",
          "315:   }",
          "317:  }",
          "318:  INIT_PZVAL(&handler);",
          "319:  ZVAL_STRING(&handler, obj->stringval, 1);",
          "320:  xmlXPathFreeObject(obj);",
          "322:  fci.function_name = &handler;",
          "323:  fci.symbol_table = NULL;",
          "324:  fci.object_ptr = NULL;",
          "",
          "[Removed Lines]",
          "316:   return;",
          "",
          "[Added Lines]",
          "320:   return;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "328:  if (!zend_make_callable(&handler, &callable TSRMLS_CC)) {",
          "329:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Unable to call handler %s()\", callable);",
          "330:   valuePush(ctxt, xmlXPathNewString(\"\"));",
          "332:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Not allowed to call handler '%s()'\", callable);",
          "334:   valuePush(ctxt, xmlXPathNewString(\"\"));",
          "",
          "[Removed Lines]",
          "331:  } else if ( intern->registerPhpFunctions == 2 && zend_hash_exists(intern->registered_phpfunctions, callable, strlen(callable) + 1) == 0) {",
          "",
          "[Added Lines]",
          "335:  } else if ( intern->registerPhpFunctions == 2 && zend_hash_exists(intern->registered_phpfunctions, callable, strlen(callable) + 1) == 0) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "394: URL: http://www.w3.org/TR/2003/WD-DOM-Level-3-Core-20030226/DOM3-Core.html#",
          "397: PHP_FUNCTION(xsl_xsltprocessor_import_stylesheet)",
          "398: {",
          "",
          "[Removed Lines]",
          "395: Since:",
          "",
          "[Added Lines]",
          "399: Since:",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "436:   RETURN_FALSE;",
          "437:  }",
          "441:  std_hnd = zend_get_std_object_handlers();",
          "442:  MAKE_STD_ZVAL(member);",
          "",
          "[Removed Lines]",
          "439:  intern = (xsl_object *)zend_object_store_get_object(id TSRMLS_CC);",
          "",
          "[Added Lines]",
          "443:  intern = (xsl_object *)zend_object_store_get_object(id TSRMLS_CC);",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "463:   intern->hasKeys = clone_docu;",
          "464:  }",
          "468:   if (((xsltStylesheetPtr) intern->ptr)->_private != NULL) {",
          "470:   }",
          "471:   xsltFreeStylesheet((xsltStylesheetPtr) intern->ptr);",
          "472:   intern->ptr = NULL;",
          "",
          "[Removed Lines]",
          "466:  if ((oldsheetp = (xsltStylesheetPtr)intern->ptr)) {",
          "469:    ((xsltStylesheetPtr) intern->ptr)->_private = NULL;",
          "",
          "[Added Lines]",
          "470:  if ((oldsheetp = (xsltStylesheetPtr)intern->ptr)) {",
          "473:    ((xsltStylesheetPtr) intern->ptr)->_private = NULL;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "571:  if (secPrefsValue != XSL_SECPREF_NONE) {",
          "575:     secPrefsError = 1;",
          "576:    }",
          "577:   }",
          "580:     secPrefsError = 1;",
          "581:    }",
          "582:   }",
          "585:     secPrefsError = 1;",
          "586:    }",
          "587:   }",
          "590:     secPrefsError = 1;",
          "591:    }",
          "592:   }",
          "595:     secPrefsError = 1;",
          "596:    }",
          "597:   }",
          "600:    secPrefsError = 1;",
          "601:   }",
          "602:  }",
          "604:  if (secPrefsError == 1) {",
          "605:   php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Can't set libxslt security properties, not doing transformation for security reasons\");",
          "606:  } else {",
          "",
          "[Removed Lines]",
          "572:   secPrefs = xsltNewSecurityPrefs();",
          "573:   if (secPrefsValue & XSL_SECPREF_READ_FILE ) {",
          "574:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_READ_FILE, xsltSecurityForbid)) {",
          "578:   if (secPrefsValue & XSL_SECPREF_WRITE_FILE ) {",
          "579:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_WRITE_FILE, xsltSecurityForbid)) {",
          "583:   if (secPrefsValue & XSL_SECPREF_CREATE_DIRECTORY ) {",
          "584:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_CREATE_DIRECTORY, xsltSecurityForbid)) {",
          "588:   if (secPrefsValue & XSL_SECPREF_READ_NETWORK) {",
          "589:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_READ_NETWORK, xsltSecurityForbid)) {",
          "593:   if (secPrefsValue & XSL_SECPREF_WRITE_NETWORK) {",
          "594:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_WRITE_NETWORK, xsltSecurityForbid)) {",
          "599:   if (0 != xsltSetCtxtSecurityPrefs(secPrefs, ctxt)) {",
          "",
          "[Added Lines]",
          "576:   secPrefs = xsltNewSecurityPrefs();",
          "577:   if (secPrefsValue & XSL_SECPREF_READ_FILE ) {",
          "578:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_READ_FILE, xsltSecurityForbid)) {",
          "582:   if (secPrefsValue & XSL_SECPREF_WRITE_FILE ) {",
          "583:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_WRITE_FILE, xsltSecurityForbid)) {",
          "587:   if (secPrefsValue & XSL_SECPREF_CREATE_DIRECTORY ) {",
          "588:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_CREATE_DIRECTORY, xsltSecurityForbid)) {",
          "592:   if (secPrefsValue & XSL_SECPREF_READ_NETWORK) {",
          "593:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_READ_NETWORK, xsltSecurityForbid)) {",
          "597:   if (secPrefsValue & XSL_SECPREF_WRITE_NETWORK) {",
          "598:    if (0 != xsltSetSecurityPrefs(secPrefs, XSLT_SECPREF_WRITE_NETWORK, xsltSecurityForbid)) {",
          "603:   if (0 != xsltSetCtxtSecurityPrefs(secPrefs, ctxt)) {",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "618:  if (intern->node_list != NULL) {",
          "619:   zend_hash_destroy(intern->node_list);",
          "621:   intern->node_list = NULL;",
          "622:  }",
          "",
          "[Removed Lines]",
          "620:   FREE_HASHTABLE(intern->node_list);",
          "",
          "[Added Lines]",
          "624:   FREE_HASHTABLE(intern->node_list);",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "642: URL: http://www.w3.org/TR/2003/WD-DOM-Level-3-Core-20030226/DOM3-Core.html#",
          "645: PHP_FUNCTION(xsl_xsltprocessor_transform_to_doc)",
          "646: {",
          "",
          "[Removed Lines]",
          "643: Since:",
          "",
          "[Added Lines]",
          "647: Since:",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "677:    found = zend_lookup_class(ret_class, ret_class_len, &ce TSRMLS_CC);",
          "678:    if ((found != SUCCESS) || !instanceof_function(*ce, curce TSRMLS_CC)) {",
          "679:     xmlFreeDoc(newdocp);",
          "681:      \"Expecting class compatible with %s, '%s' given\", curclass_name, ret_class);",
          "682:     RETURN_FALSE;",
          "683:    }",
          "685:    object_init_ex(return_value, *ce);",
          "687:    interndoc = (php_libxml_node_object *)zend_objects_get_address(return_value TSRMLS_CC);",
          "688:    php_libxml_increment_doc_ref(interndoc, newdocp TSRMLS_CC);",
          "689:    php_libxml_increment_node_ptr(interndoc, (xmlNodePtr)newdocp, (void *)interndoc TSRMLS_CC);",
          "",
          "[Removed Lines]",
          "680:     php_error_docref(NULL TSRMLS_CC, E_WARNING,",
          "",
          "[Added Lines]",
          "684:     php_error_docref(NULL TSRMLS_CC, E_WARNING,",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "947:   return;",
          "948:  }",
          "949:  intern = (xsl_object *)zend_object_store_get_object(id TSRMLS_CC);",
          "951:  intern->securityPrefs = securityPrefs;",
          "953:  intern->securityPrefsSet = 1;",
          "",
          "[Removed Lines]",
          "950:  oldSecurityPrefs = intern->securityPrefs;",
          "",
          "[Added Lines]",
          "954:  oldSecurityPrefs = intern->securityPrefs;",
          "",
          "---------------"
        ],
        "ext/zip/php_zip.c||ext/zip/php_zip.c": [
          "File: ext/zip/php_zip.c -> ext/zip/php_zip.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "202:  if (path_cleaned_len > 1 && IS_SLASH(path_cleaned[path_cleaned_len - 1])) {",
          "204:   is_dir_only = 1;",
          "205:  } else {",
          "206:   memcpy(file_dirname, path_cleaned, path_cleaned_len);",
          "",
          "[Removed Lines]",
          "203:   len = spprintf(&file_dirname_fullpath, 0, \"%s/%s\", dest, file);",
          "",
          "[Added Lines]",
          "203:   len = spprintf(&file_dirname_fullpath, 0, \"%s/%s\", dest, path_cleaned);",
          "",
          "---------------"
        ],
        "ext/zip/tests/bug70350.phpt||ext/zip/tests/bug70350.phpt": [
          "File: ext/zip/tests/bug70350.phpt -> ext/zip/tests/bug70350.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70350 (ZipArchive::extractTo allows for directory traversal when creating directories)",
          "3: --SKIPIF--",
          "4: <?php",
          "5: if(!extension_loaded('zip')) die('skip');",
          "6: ?>",
          "7: --FILE--",
          "8: <?php",
          "10: $dir = dirname(__FILE__).\"/bug70350\";",
          "11: mkdir($dir);",
          "12: $archive = new ZipArchive();",
          "13: $archive->open(\"$dir/a.zip\",ZipArchive::CREATE);",
          "14: $archive->addEmptyDir(\"../down2/\");",
          "15: $archive->close();",
          "17: $archive2 = new ZipArchive();",
          "18: $archive2->open(\"$dir/a.zip\");",
          "19: $archive2->extractTo($dir);",
          "20: $archive2->close();",
          "21: var_dump(file_exists(\"$dir/down2/\"));",
          "22: var_dump(file_exists(\"../down2/\"));",
          "23: ?>",
          "24: --CLEAN--",
          "25: <?php",
          "26: $dir = dirname(__FILE__).\"/bug70350\";",
          "27: rmdir(\"$dir/down2\");",
          "28: unlink(\"$dir/a.zip\");",
          "29: rmdir($dir);",
          "30: ?>",
          "31: --EXPECT--",
          "32: bool(true)",
          "33: bool(false)",
          "",
          "---------------"
        ]
      }
    }
  ]
}