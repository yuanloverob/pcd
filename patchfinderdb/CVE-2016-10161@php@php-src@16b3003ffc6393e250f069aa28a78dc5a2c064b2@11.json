{
  "cve_id": "CVE-2016-10161",
  "cve_desc": "The object_common1 function in ext/standard/var_unserializer.c in PHP before 5.6.30, 7.0.x before 7.0.15, and 7.1.x before 7.1.1 allows remote attackers to cause a denial of service (buffer over-read and application crash) via crafted serialized data that is mishandled in a finish_nested_data call.",
  "repo": "php/php-src",
  "patch_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
  "patch_info": {
    "commit_hash": "16b3003ffc6393e250f069aa28a78dc5a2c064b2",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/16b3003ffc6393e250f069aa28a78dc5a2c064b2",
    "files": [
      "ext/standard/tests/serialize/bug73825.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #73825 - Heap out of bounds read on unserialize in finish_nested_data()",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug73825.phpt||ext/standard/tests/serialize/bug73825.phpt": [
      "File: ext/standard/tests/serialize/bug73825.phpt -> ext/standard/tests/serialize/bug73825.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73825 Heap out of bounds read on unserialize in finish_nested_data()",
      "3: --FILE--",
      "4: <?php",
      "5: $obj = unserialize('O:8:\"00000000\":');",
      "6: var_dump($obj);",
      "7: ?>",
      "8: --EXPECTF--",
      "9: Warning: Bad unserialize data in %sbug73825.php on line %d",
      "11: Notice: unserialize(): Error at offset 13 of 15 bytes in %sbug73825.php on line %d",
      "12: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "405: {",
      "406:  long elements;",
      "408:  elements = parse_iv2((*p) + 2, p);",
      "410:  (*p) += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "408:  if( *p >= max - 2) {",
      "409:   zend_error(E_WARNING, \"Bad unserialize data\");",
      "410:   return -1;",
      "411:  }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "417:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
      "419:  }",
      "421:  return elements;",
      "",
      "[Removed Lines]",
      "418:   return 0;",
      "",
      "[Added Lines]",
      "423:   return -1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "496: {",
      "497:  YYCTYPE yych;",
      "498:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "495: #line 496 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "500: #line 501 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "552:  yych = *(YYMARKER = ++YYCURSOR);",
      "553:  if (yych == ':') goto yy95;",
      "554: yy3:",
      "556:  { return 0; }",
      "558: yy4:",
      "559:  yych = *(YYMARKER = ++YYCURSOR);",
      "560:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "555: #line 861 \"ext/standard/var_unserializer.re\"",
      "557: #line 558 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "560: #line 875 \"ext/standard/var_unserializer.re\"",
      "562: #line 563 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "597:  goto yy3;",
      "598: yy14:",
      "599:  ++YYCURSOR;",
      "601:  {",
      "603:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "605: }",
      "607: yy16:",
      "608:  yych = *++YYCURSOR;",
      "609:  goto yy3;",
      "",
      "[Removed Lines]",
      "600: #line 855 \"ext/standard/var_unserializer.re\"",
      "606: #line 607 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "605: #line 869 \"ext/standard/var_unserializer.re\"",
      "611: #line 612 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "634:  yych = *++YYCURSOR;",
      "635:  if (yych != '\"') goto yy18;",
      "636:  ++YYCURSOR;",
      "638:  {",
      "639:  size_t len, len2, len3, maxlen;",
      "640:  long elements;",
      "",
      "[Removed Lines]",
      "637: #line 708 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "642: #line 717 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "775:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
      "777:  if (incomplete_class) {",
      "778:   php_store_class_name(*rval, class_name, len2);",
      "779:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "782:  if (elements < 0) {",
      "783:     efree(class_name);",
      "784:     return 0;",
      "785:  }",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "782:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "783: }",
      "785: yy25:",
      "786:  yych = *++YYCURSOR;",
      "787:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "784: #line 785 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "794: #line 795 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "806:  yych = *++YYCURSOR;",
      "807:  if (yych != '\"') goto yy18;",
      "808:  ++YYCURSOR;",
      "810:  {",
      "811:     if (!var_hash) return 0;",
      "813:  INIT_PZVAL(*rval);",
      "817: }",
      "819: yy32:",
      "820:  yych = *++YYCURSOR;",
      "821:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "809: #line 699 \"ext/standard/var_unserializer.re\"",
      "815:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "816:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "818: #line 819 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "819: #line 704 \"ext/standard/var_unserializer.re\"",
      "821:  long elements;",
      "826:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
      "827:  if (elements < 0) {",
      "828:   return 0;",
      "829:  }",
      "830:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "832: #line 833 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "836:  yych = *++YYCURSOR;",
      "837:  if (yych != '{') goto yy18;",
      "838:  ++YYCURSOR;",
      "840:  {",
      "841:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "839: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "853: #line 683 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "858:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "859: }",
      "861: yy39:",
      "862:  yych = *++YYCURSOR;",
      "863:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "860: #line 861 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "874: #line 875 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "878:  yych = *++YYCURSOR;",
      "879:  if (yych != '\"') goto yy18;",
      "880:  ++YYCURSOR;",
      "882:  {",
      "883:  size_t len, maxlen;",
      "884:  char *str;",
      "",
      "[Removed Lines]",
      "881: #line 643 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "895: #line 648 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "913:  ZVAL_STRINGL(*rval, str, len, 0);",
      "914:  return 1;",
      "915: }",
      "917: yy46:",
      "918:  yych = *++YYCURSOR;",
      "919:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "916: #line 917 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "930: #line 931 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "934:  yych = *++YYCURSOR;",
      "935:  if (yych != '\"') goto yy18;",
      "936:  ++YYCURSOR;",
      "938:  {",
      "939:  size_t len, maxlen;",
      "940:  char *str;",
      "",
      "[Removed Lines]",
      "937: #line 610 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "951: #line 615 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "967:  ZVAL_STRINGL(*rval, str, len, 1);",
      "968:  return 1;",
      "969: }",
      "971: yy53:",
      "972:  yych = *++YYCURSOR;",
      "973:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "970: #line 971 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "984: #line 985 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1055:  }",
      "1056: yy63:",
      "1057:  ++YYCURSOR;",
      "1059:  {",
      "1060: #if SIZEOF_LONG == 4",
      "1061: use_double:",
      "",
      "[Removed Lines]",
      "1058: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1072: #line 605 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1065:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1066:  return 1;",
      "1067: }",
      "1069: yy65:",
      "1070:  yych = *++YYCURSOR;",
      "1071:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1082: #line 1083 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1124:  yych = *++YYCURSOR;",
      "1125:  if (yych != ';') goto yy18;",
      "1126:  ++YYCURSOR;",
      "1128:  {",
      "1130:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1127: #line 585 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1141: #line 590 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1140:  return 1;",
      "1141: }",
      "1143: yy76:",
      "1144:  yych = *++YYCURSOR;",
      "1145:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1156: #line 1157 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1166:  if (yych <= '9') goto yy79;",
      "1167:  if (yych != ';') goto yy18;",
      "1168:  ++YYCURSOR;",
      "1170:  {",
      "1171: #if SIZEOF_LONG == 4",
      "1172:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1169: #line 558 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1183: #line 563 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1193:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1194:  return 1;",
      "1195: }",
      "1197: yy83:",
      "1198:  yych = *++YYCURSOR;",
      "1199:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1201:  yych = *++YYCURSOR;",
      "1202:  if (yych != ';') goto yy18;",
      "1203:  ++YYCURSOR;",
      "1205:  {",
      "1207:  INIT_PZVAL(*rval);",
      "1208:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1209:  return 1;",
      "1210: }",
      "1212: yy87:",
      "1213:  ++YYCURSOR;",
      "1215:  {",
      "1217:  INIT_PZVAL(*rval);",
      "1218:  ZVAL_NULL(*rval);",
      "1219:  return 1;",
      "1220: }",
      "1222: yy89:",
      "1223:  yych = *++YYCURSOR;",
      "1224:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1204: #line 551 \"ext/standard/var_unserializer.re\"",
      "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
      "1214: #line 544 \"ext/standard/var_unserializer.re\"",
      "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1218: #line 556 \"ext/standard/var_unserializer.re\"",
      "1225: #line 1226 \"ext/standard/var_unserializer.c\"",
      "1228: #line 549 \"ext/standard/var_unserializer.re\"",
      "1235: #line 1236 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1241:  if (yych <= '9') goto yy91;",
      "1242:  if (yych != ';') goto yy18;",
      "1243:  ++YYCURSOR;",
      "1245:  {",
      "1246:  long id;",
      "",
      "[Removed Lines]",
      "1244: #line 521 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1258: #line 526 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1265:  return 1;",
      "1266: }",
      "1268: yy95:",
      "1269:  yych = *++YYCURSOR;",
      "1270:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1281: #line 1282 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1287:  if (yych <= '9') goto yy97;",
      "1288:  if (yych != ';') goto yy18;",
      "1289:  ++YYCURSOR;",
      "1291:  {",
      "1292:  long id;",
      "",
      "[Removed Lines]",
      "1290: #line 500 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1304: #line 505 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 26 ---",
      "[Context before]",
      "1309:  return 1;",
      "1310: }",
      "1312: }",
      "1316:  return 0;",
      "",
      "[Removed Lines]",
      "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
      "1313: #line 863 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1325: #line 1326 \"ext/standard/var_unserializer.c\"",
      "1327: #line 877 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "409: {",
      "410:  long elements;",
      "412:  elements = parse_iv2((*p) + 2, p);",
      "414:  (*p) += 2;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "412:  if( *p >= max - 2) {",
      "413:   zend_error(E_WARNING, \"Bad unserialize data\");",
      "414:   return -1;",
      "415:  }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "421:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ce->name);",
      "423:  }",
      "425:  return elements;",
      "",
      "[Removed Lines]",
      "422:   return 0;",
      "",
      "[Added Lines]",
      "427:   return -1;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "697: }",
      "699: \"o:\" iv \":\" [\"] {",
      "700:     if (!var_hash) return 0;",
      "702:  INIT_PZVAL(*rval);",
      "706: }",
      "708: object \":\" uiv \":\" [\"] {",
      "",
      "[Removed Lines]",
      "704:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "705:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "",
      "[Added Lines]",
      "705:  long elements;",
      "710:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
      "711:  if (elements < 0) {",
      "712:   return 0;",
      "713:  }",
      "714:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "845:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
      "847:  if (incomplete_class) {",
      "848:   php_store_class_name(*rval, class_name, len2);",
      "849:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "856:  if (elements < 0) {",
      "857:     efree(class_name);",
      "858:     return 0;",
      "859:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a29264eb8c933f8569e62f1d6d6eba524e76ef70",
      "candidate_info": {
        "commit_hash": "a29264eb8c933f8569e62f1d6d6eba524e76ef70",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/a29264eb8c933f8569e62f1d6d6eba524e76ef70",
        "files": [
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "fix datatype",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1365:  ++YYCURSOR;",
          "1366: #line 794 \"ext/standard/var_unserializer.re\"",
          "1367:  {",
          "1369:     if (!var_hash) return 0;",
          "1371:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "",
          "[Removed Lines]",
          "1368:  long elements;",
          "",
          "[Added Lines]",
          "1368:  zend_long elements;",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "792: }",
          "794: \"o:\" iv \":\" [\"] {",
          "796:     if (!var_hash) return 0;",
          "798:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "",
          "[Removed Lines]",
          "795:  long elements;",
          "",
          "[Added Lines]",
          "795:  zend_long elements;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "d5f7e01f7cd2d3d51ea9bb96286da442b38e1d00",
      "candidate_info": {
        "commit_hash": "d5f7e01f7cd2d3d51ea9bb96286da442b38e1d00",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/d5f7e01f7cd2d3d51ea9bb96286da442b38e1d00",
        "files": [
          "ext/standard/var_unserializer.c"
        ],
        "message": "restore file deleted by mistake in a merge commit",
        "before_after_code_files": [
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2: #line 1 \"ext/standard/var_unserializer.re\"",
          "4:   +----------------------------------------------------------------------+",
          "5:   | PHP Version 7                                                        |",
          "6:   +----------------------------------------------------------------------+",
          "7:   | Copyright (c) 1997-2017 The PHP Group                                |",
          "8:   +----------------------------------------------------------------------+",
          "9:   | This source file is subject to version 3.01 of the PHP license,      |",
          "10:   | that is bundled with this package in the file LICENSE, and is        |",
          "11:   | available through the world-wide-web at the following url:           |",
          "12:   | http://www.php.net/license/3_01.txt                                  |",
          "13:   | If you did not receive a copy of the PHP license and are unable to   |",
          "14:   | obtain it through the world-wide-web, please send a note to          |",
          "15:   | license@php.net so we can mail you a copy immediately.               |",
          "16:   +----------------------------------------------------------------------+",
          "17:   | Author: Sascha Schumann <sascha@schumann.cx>                         |",
          "18:   +----------------------------------------------------------------------+",
          "23: #include \"php.h\"",
          "24: #include \"ext/standard/php_var.h\"",
          "25: #include \"php_incomplete_class.h\"",
          "26: #include \"zend_portability.h\"",
          "28: struct php_unserialize_data {",
          "29:  void *first;",
          "30:  void *last;",
          "31:  void *first_dtor;",
          "32:  void *last_dtor;",
          "33:  HashTable *allowed_classes;",
          "34: };",
          "36: PHPAPI php_unserialize_data_t php_var_unserialize_init() {",
          "37:  php_unserialize_data_t d;",
          "39:  if (BG(serialize_lock) || !BG(unserialize).level) {",
          "40:   d = ecalloc(1, sizeof(struct php_unserialize_data));",
          "41:   if (!BG(serialize_lock)) {",
          "42:    BG(unserialize).data = d;",
          "43:    BG(unserialize).level = 1;",
          "44:   }",
          "45:  } else {",
          "46:   d = BG(unserialize).data;",
          "47:   ++BG(unserialize).level;",
          "48:  }",
          "49:  return d;",
          "50: }",
          "52: PHPAPI void php_var_unserialize_destroy(php_unserialize_data_t d) {",
          "54:  if (BG(serialize_lock) || BG(unserialize).level == 1) {",
          "55:   var_destroy(&d);",
          "56:   efree(d);",
          "57:  }",
          "58:  if (!BG(serialize_lock) && !--BG(unserialize).level) {",
          "59:   BG(unserialize).data = NULL;",
          "60:  }",
          "61: }",
          "63: PHPAPI HashTable *php_var_unserialize_get_allowed_classes(php_unserialize_data_t d) {",
          "64:  return d->allowed_classes;",
          "65: }",
          "66: PHPAPI void php_var_unserialize_set_allowed_classes(php_unserialize_data_t d, HashTable *classes) {",
          "67:  d->allowed_classes = classes;",
          "68: }",
          "72: #define VAR_ENTRIES_MAX 1024",
          "73: #define VAR_ENTRIES_DBG 0",
          "76: #define VAR_WAKEUP_FLAG 1",
          "78: typedef struct {",
          "79:  zval *data[VAR_ENTRIES_MAX];",
          "80:  zend_long used_slots;",
          "81:  void *next;",
          "82: } var_entries;",
          "84: typedef struct {",
          "85:  zval data[VAR_ENTRIES_MAX];",
          "86:  zend_long used_slots;",
          "87:  void *next;",
          "88: } var_dtor_entries;",
          "90: static inline void var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "91: {",
          "92:  var_entries *var_hash = (*var_hashx)->last;",
          "93: #if VAR_ENTRIES_DBG",
          "94:  fprintf(stderr, \"var_push(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(rval));",
          "95: #endif",
          "97:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "98:   var_hash = emalloc(sizeof(var_entries));",
          "99:   var_hash->used_slots = 0;",
          "100:   var_hash->next = 0;",
          "102:   if (!(*var_hashx)->first) {",
          "103:    (*var_hashx)->first = var_hash;",
          "104:   } else {",
          "105:    ((var_entries *) (*var_hashx)->last)->next = var_hash;",
          "106:   }",
          "108:   (*var_hashx)->last = var_hash;",
          "109:  }",
          "111:  var_hash->data[var_hash->used_slots++] = rval;",
          "112: }",
          "114: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "115: {",
          "116:  zval *tmp_var = var_tmp_var(var_hashx);",
          "117:     if (!tmp_var) {",
          "118:         return;",
          "119:     }",
          "120:  ZVAL_COPY(tmp_var, rval);",
          "121: }",
          "123: PHPAPI zval *var_tmp_var(php_unserialize_data_t *var_hashx)",
          "124: {",
          "125:     var_dtor_entries *var_hash;",
          "127:     if (!var_hashx || !*var_hashx) {",
          "128:         return NULL;",
          "129:     }",
          "131:     var_hash = (*var_hashx)->last_dtor;",
          "132:     if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "133:         var_hash = emalloc(sizeof(var_dtor_entries));",
          "134:         var_hash->used_slots = 0;",
          "135:         var_hash->next = 0;",
          "137:         if (!(*var_hashx)->first_dtor) {",
          "138:             (*var_hashx)->first_dtor = var_hash;",
          "139:         } else {",
          "140:             ((var_dtor_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "141:         }",
          "143:         (*var_hashx)->last_dtor = var_hash;",
          "144:     }",
          "145:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "146:  Z_EXTRA(var_hash->data[var_hash->used_slots]) = 0;",
          "147:     return &var_hash->data[var_hash->used_slots++];",
          "148: }",
          "150: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "151: {",
          "152:  zend_long i;",
          "153:  var_entries *var_hash = (*var_hashx)->first;",
          "154: #if VAR_ENTRIES_DBG",
          "155:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_P(nzval));",
          "156: #endif",
          "158:  while (var_hash) {",
          "159:   for (i = 0; i < var_hash->used_slots; i++) {",
          "160:    if (var_hash->data[i] == ozval) {",
          "161:     var_hash->data[i] = nzval;",
          "163:    }",
          "164:   }",
          "165:   var_hash = var_hash->next;",
          "166:  }",
          "167: }",
          "169: static zval *var_access(php_unserialize_data_t *var_hashx, zend_long id)",
          "170: {",
          "171:  var_entries *var_hash = (*var_hashx)->first;",
          "172: #if VAR_ENTRIES_DBG",
          "173:  fprintf(stderr, \"var_access(%ld): %ld\\n\", var_hash?var_hash->used_slots:-1L, id);",
          "174: #endif",
          "176:  while (id >= VAR_ENTRIES_MAX && var_hash && var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "177:   var_hash = var_hash->next;",
          "178:   id -= VAR_ENTRIES_MAX;",
          "179:  }",
          "181:  if (!var_hash) return NULL;",
          "183:  if (id < 0 || id >= var_hash->used_slots) return NULL;",
          "185:  return var_hash->data[id];",
          "186: }",
          "188: PHPAPI void var_destroy(php_unserialize_data_t *var_hashx)",
          "189: {",
          "190:  void *next;",
          "191:  zend_long i;",
          "192:  var_entries *var_hash = (*var_hashx)->first;",
          "193:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "194:  zend_bool wakeup_failed = 0;",
          "195:  zval wakeup_name;",
          "196:  ZVAL_UNDEF(&wakeup_name);",
          "198: #if VAR_ENTRIES_DBG",
          "199:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "200: #endif",
          "202:  while (var_hash) {",
          "203:   next = var_hash->next;",
          "204:   efree_size(var_hash, sizeof(var_entries));",
          "205:   var_hash = next;",
          "206:  }",
          "208:  while (var_dtor_hash) {",
          "209:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "210:    zval *zv = &var_dtor_hash->data[i];",
          "211: #if VAR_ENTRIES_DBG",
          "212:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "213: #endif",
          "216:    if (Z_EXTRA_P(zv) == VAR_WAKEUP_FLAG) {",
          "217:     if (!wakeup_failed) {",
          "218:      zval retval;",
          "219:      if (Z_ISUNDEF(wakeup_name)) {",
          "220:       ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "221:      }",
          "223:      BG(serialize_lock)++;",
          "224:      if (call_user_function_ex(CG(function_table), zv, &wakeup_name, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "225:       wakeup_failed = 1;",
          "226:       GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "227:      }",
          "228:      BG(serialize_lock)--;",
          "230:      zval_ptr_dtor(&retval);",
          "231:     } else {",
          "232:      GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "233:     }",
          "234:    }",
          "236:    i_zval_ptr_dtor(zv ZEND_FILE_LINE_CC);",
          "237:   }",
          "238:   next = var_dtor_hash->next;",
          "239:   efree_size(var_dtor_hash, sizeof(var_dtor_entries));",
          "240:   var_dtor_hash = next;",
          "241:  }",
          "243:  zval_ptr_dtor_nogc(&wakeup_name);",
          "244: }",
          "248: static zend_string *unserialize_str(const unsigned char **p, size_t len, size_t maxlen)",
          "249: {",
          "250:  size_t i, j;",
          "251:  zend_string *str = zend_string_safe_alloc(1, len, 0, 0);",
          "252:  unsigned char *end = *(unsigned char **)p+maxlen;",
          "254:  if (end < *p) {",
          "255:   zend_string_free(str);",
          "256:   return NULL;",
          "257:  }",
          "259:  for (i = 0; i < len; i++) {",
          "260:   if (*p >= end) {",
          "261:    zend_string_free(str);",
          "262:    return NULL;",
          "263:   }",
          "264:   if (**p != '\\\\') {",
          "265:    ZSTR_VAL(str)[i] = (char)**p;",
          "266:   } else {",
          "267:    unsigned char ch = 0;",
          "269:    for (j = 0; j < 2; j++) {",
          "270:     (*p)++;",
          "271:     if (**p >= '0' && **p <= '9') {",
          "272:      ch = (ch << 4) + (**p -'0');",
          "273:     } else if (**p >= 'a' && **p <= 'f') {",
          "274:      ch = (ch << 4) + (**p -'a'+10);",
          "275:     } else if (**p >= 'A' && **p <= 'F') {",
          "276:      ch = (ch << 4) + (**p -'A'+10);",
          "277:     } else {",
          "278:      zend_string_free(str);",
          "279:      return NULL;",
          "280:     }",
          "281:    }",
          "282:    ZSTR_VAL(str)[i] = (char)ch;",
          "283:   }",
          "284:   (*p)++;",
          "285:  }",
          "286:  ZSTR_VAL(str)[i] = 0;",
          "287:  ZSTR_LEN(str) = i;",
          "288:  return str;",
          "289: }",
          "291: static inline int unserialize_allowed_class(",
          "292:   zend_string *class_name, php_unserialize_data_t *var_hashx)",
          "293: {",
          "294:  HashTable *classes = (*var_hashx)->allowed_classes;",
          "295:  zend_string *lcname;",
          "296:  int res;",
          "297:  ALLOCA_FLAG(use_heap)",
          "299:  if(classes == NULL) {",
          "300:   return 1;",
          "301:  }",
          "302:  if(!zend_hash_num_elements(classes)) {",
          "303:   return 0;",
          "304:  }",
          "306:  ZSTR_ALLOCA_ALLOC(lcname, ZSTR_LEN(class_name), use_heap);",
          "307:  zend_str_tolower_copy(ZSTR_VAL(lcname), ZSTR_VAL(class_name), ZSTR_LEN(class_name));",
          "308:  res = zend_hash_exists(classes, lcname);",
          "309:  ZSTR_ALLOCA_FREE(lcname, use_heap);",
          "310:  return res;",
          "311: }",
          "313: #define YYFILL(n) do { } while (0)",
          "314: #define YYCTYPE unsigned char",
          "315: #define YYCURSOR cursor",
          "316: #define YYLIMIT limit",
          "317: #define YYMARKER marker",
          "320: #line 325 \"ext/standard/var_unserializer.re\"",
          "325: static inline zend_long parse_iv2(const unsigned char *p, const unsigned char **q)",
          "326: {",
          "327:  char cursor;",
          "328:  zend_long result = 0;",
          "329:  int neg = 0;",
          "331:  switch (*p) {",
          "332:   case '-':",
          "333:    neg++;",
          "335:   case '+':",
          "336:    p++;",
          "337:  }",
          "339:  while (1) {",
          "340:   cursor = (char)*p;",
          "341:   if (cursor >= '0' && cursor <= '9') {",
          "342:    result = result * 10 + (size_t)(cursor - (unsigned char)'0');",
          "343:   } else {",
          "344:    break;",
          "345:   }",
          "346:   p++;",
          "347:  }",
          "348:  if (q) *q = p;",
          "349:  if (neg) return -result;",
          "350:  return result;",
          "351: }",
          "353: static inline zend_long parse_iv(const unsigned char *p)",
          "354: {",
          "355:  return parse_iv2(p, NULL);",
          "356: }",
          "359: static inline size_t parse_uiv(const unsigned char *p)",
          "360: {",
          "361:  unsigned char cursor;",
          "362:  size_t result = 0;",
          "364:  while (1) {",
          "365:   cursor = *p;",
          "366:   if (cursor >= '0' && cursor <= '9') {",
          "367:    result = result * 10 + (size_t)(cursor - (unsigned char)'0');",
          "368:   } else {",
          "369:    break;",
          "370:   }",
          "371:   p++;",
          "372:  }",
          "373:  return result;",
          "374: }",
          "376: #define UNSERIALIZE_PARAMETER zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash",
          "377: #define UNSERIALIZE_PASSTHRU rval, p, max, var_hash",
          "379: static int php_var_unserialize_internal(UNSERIALIZE_PARAMETER);",
          "381: static zend_always_inline int process_nested_data(UNSERIALIZE_PARAMETER, HashTable *ht, zend_long elements, int objprops)",
          "382: {",
          "383:  while (elements-- > 0) {",
          "384:   zval key, *data, d, *old_data;",
          "385:   zend_ulong idx;",
          "387:   ZVAL_UNDEF(&key);",
          "389:   if (!php_var_unserialize_internal(&key, p, max, NULL)) {",
          "390:    zval_ptr_dtor(&key);",
          "391:    return 0;",
          "392:   }",
          "394:   data = NULL;",
          "395:   ZVAL_UNDEF(&d);",
          "397:   if (!objprops) {",
          "398:    if (Z_TYPE(key) == IS_LONG) {",
          "399:     idx = Z_LVAL(key);",
          "400: numeric_key:",
          "401:     if (UNEXPECTED((old_data = zend_hash_index_find(ht, idx)) != NULL)) {",
          "403:      var_push_dtor(var_hash, old_data);",
          "404:      data = zend_hash_index_update(ht, idx, &d);",
          "405:     } else {",
          "406:      data = zend_hash_index_add_new(ht, idx, &d);",
          "407:     }",
          "408:    } else if (Z_TYPE(key) == IS_STRING) {",
          "409:     if (UNEXPECTED(ZEND_HANDLE_NUMERIC(Z_STR(key), idx))) {",
          "410:      goto numeric_key;",
          "411:     }",
          "412:     if (UNEXPECTED((old_data = zend_hash_find(ht, Z_STR(key))) != NULL)) {",
          "414:      var_push_dtor(var_hash, old_data);",
          "415:      data = zend_hash_update(ht, Z_STR(key), &d);",
          "416:     } else {",
          "417:      data = zend_hash_add_new(ht, Z_STR(key), &d);",
          "418:     }",
          "419:    } else {",
          "420:     zval_ptr_dtor(&key);",
          "421:     return 0;",
          "422:    }",
          "423:   } else {",
          "424:    if (EXPECTED(Z_TYPE(key) == IS_STRING)) {",
          "425: string_key:",
          "426:     {",
          "427:      zend_property_info *existing_propinfo;",
          "428:      zend_string *new_key, *unmangled;",
          "429:      const char *unmangled_class = NULL;",
          "430:      const char *unmangled_prop;",
          "431:      size_t unmangled_prop_len;",
          "433:      if (UNEXPECTED(zend_unmangle_property_name_ex(Z_STR(key), &unmangled_class, &unmangled_prop, &unmangled_prop_len) == FAILURE)) {",
          "434:       zval_ptr_dtor(&key);",
          "435:       return 0;",
          "436:      }",
          "438:      unmangled = zend_string_init(unmangled_prop, unmangled_prop_len, 0);",
          "439:      if (Z_TYPE_P(rval) == IS_OBJECT",
          "440:        && ((existing_propinfo = zend_hash_find_ptr(&Z_OBJCE_P(rval)->properties_info, unmangled)) != NULL)",
          "441:        && (existing_propinfo->flags & ZEND_ACC_PPP_MASK)) {",
          "442:       if (existing_propinfo->flags & ZEND_ACC_PROTECTED) {",
          "443:        new_key = zend_mangle_property_name(",
          "444:         \"*\", 1, ZSTR_VAL(unmangled), ZSTR_LEN(unmangled), Z_OBJCE_P(rval)->type & ZEND_INTERNAL_CLASS);",
          "445:        zend_string_release(unmangled);",
          "446:       } else if (existing_propinfo->flags & ZEND_ACC_PRIVATE) {",
          "447:        if (unmangled_class != NULL && strcmp(unmangled_class, \"*\") != 0) {",
          "448:         new_key = zend_mangle_property_name(",
          "449:          unmangled_class, strlen(unmangled_class),",
          "450:          ZSTR_VAL(unmangled), ZSTR_LEN(unmangled),",
          "451:          Z_OBJCE_P(rval)->type & ZEND_INTERNAL_CLASS);",
          "452:        } else {",
          "453:         new_key = zend_mangle_property_name(",
          "454:          ZSTR_VAL(existing_propinfo->ce->name), ZSTR_LEN(existing_propinfo->ce->name),",
          "455:          ZSTR_VAL(unmangled), ZSTR_LEN(unmangled),",
          "456:          Z_OBJCE_P(rval)->type & ZEND_INTERNAL_CLASS);",
          "457:        }",
          "458:        zend_string_release(unmangled);",
          "459:       } else {",
          "460:        ZEND_ASSERT(existing_propinfo->flags & ZEND_ACC_PUBLIC);",
          "461:        new_key = unmangled;",
          "462:       }",
          "463:       zend_string_release(Z_STR(key));",
          "464:       ZVAL_STR(&key, new_key);",
          "465:      } else {",
          "466:       zend_string_release(unmangled);",
          "467:      }",
          "469:      if ((old_data = zend_hash_find(ht, Z_STR(key))) != NULL) {",
          "470:       if (Z_TYPE_P(old_data) == IS_INDIRECT) {",
          "471:        old_data = Z_INDIRECT_P(old_data);",
          "472:       }",
          "473:       var_push_dtor(var_hash, old_data);",
          "474:       data = zend_hash_update_ind(ht, Z_STR(key), &d);",
          "475:      } else {",
          "476:       data = zend_hash_add_new(ht, Z_STR(key), &d);",
          "477:      }",
          "478:     }",
          "479:    } else if (Z_TYPE(key) == IS_LONG) {",
          "481:     convert_to_string(&key);",
          "482:     goto string_key;",
          "483:    } else {",
          "484:     zval_ptr_dtor(&key);",
          "485:     return 0;",
          "486:    }",
          "487:   }",
          "489:   if (!php_var_unserialize_internal(data, p, max, var_hash)) {",
          "490:    zval_ptr_dtor(&key);",
          "491:    return 0;",
          "492:   }",
          "494:   if (UNEXPECTED(Z_ISUNDEF_P(data))) {",
          "495:    if (Z_TYPE(key) == IS_LONG) {",
          "496:     zend_hash_index_del(ht, Z_LVAL(key));",
          "497:    } else {",
          "498:     zend_hash_del_ind(ht, Z_STR(key));",
          "499:    }",
          "500:   } else {",
          "501:    var_push_dtor(var_hash, data);",
          "502:   }",
          "504:   zval_ptr_dtor(&key);",
          "506:   if (elements && *(*p-1) != ';' && *(*p-1) != '}') {",
          "507:    (*p)--;",
          "508:    return 0;",
          "509:   }",
          "510:  }",
          "512:  return 1;",
          "513: }",
          "515: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "516: {",
          "517:  if (*p >= max || **p != '}') {",
          "518:   return 0;",
          "519:  }",
          "521:  (*p)++;",
          "522:  return 1;",
          "523: }",
          "525: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "526: {",
          "527:  zend_long datalen;",
          "529:  datalen = parse_iv2((*p) + 2, p);",
          "531:  (*p) += 2;",
          "533:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "534:   zend_error(E_WARNING, \"Insufficient data for unserializing - \" ZEND_LONG_FMT \" required, \" ZEND_LONG_FMT \" present\", datalen, (zend_long)(max - (*p)));",
          "535:   return 0;",
          "536:  }",
          "538:  if (ce->unserialize == NULL) {",
          "539:   zend_error(E_WARNING, \"Class %s has no unserializer\", ZSTR_VAL(ce->name));",
          "540:   object_init_ex(rval, ce);",
          "541:  } else if (ce->unserialize(rval, ce, (const unsigned char*)*p, datalen, (zend_unserialize_data *)var_hash) != SUCCESS) {",
          "542:   return 0;",
          "543:  }",
          "545:  (*p) += datalen;",
          "547:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "548: }",
          "550: static inline zend_long object_common1(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "551: {",
          "552:  zend_long elements;",
          "554:  if( *p >= max - 2) {",
          "555:   zend_error(E_WARNING, \"Bad unserialize data\");",
          "556:   return -1;",
          "557:  }",
          "559:  elements = parse_iv2((*p) + 2, p);",
          "561:  (*p) += 2;",
          "563:  if (ce->serialize == NULL) {",
          "564:   object_init_ex(rval, ce);",
          "565:  } else {",
          "568:   zend_error(E_WARNING, \"Erroneous data format for unserializing '%s'\", ZSTR_VAL(ce->name));",
          "569:   return -1;",
          "570:  }",
          "572:  return elements;",
          "573: }",
          "575: #ifdef PHP_WIN32",
          "576: # pragma optimize(\"\", off)",
          "577: #endif",
          "578: static inline int object_common2(UNSERIALIZE_PARAMETER, zend_long elements)",
          "579: {",
          "580:  HashTable *ht;",
          "581:  zend_bool has_wakeup;",
          "583:  if (Z_TYPE_P(rval) != IS_OBJECT) {",
          "584:   return 0;",
          "585:  }",
          "587:  has_wakeup = Z_OBJCE_P(rval) != PHP_IC_ENTRY",
          "588:   && zend_hash_str_exists(&Z_OBJCE_P(rval)->function_table, \"__wakeup\", sizeof(\"__wakeup\")-1);",
          "590:  ht = Z_OBJPROP_P(rval);",
          "591:  if (elements >= HT_MAX_SIZE - zend_hash_num_elements(ht)) {",
          "592:   return 0;",
          "593:  }",
          "595:  zend_hash_extend(ht, zend_hash_num_elements(ht) + elements, (ht->u.flags & HASH_FLAG_PACKED));",
          "596:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, ht, elements, 1)) {",
          "597:   if (has_wakeup) {",
          "598:    ZVAL_DEREF(rval);",
          "599:    GC_FLAGS(Z_OBJ_P(rval)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "600:   }",
          "601:   return 0;",
          "602:  }",
          "604:  ZVAL_DEREF(rval);",
          "605:  if (has_wakeup) {",
          "607:   zval *wakeup_var = var_tmp_var(var_hash);",
          "608:   ZVAL_COPY(wakeup_var, rval);",
          "609:   Z_EXTRA_P(wakeup_var) = VAR_WAKEUP_FLAG;",
          "610:  }",
          "612:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "613: }",
          "614: #ifdef PHP_WIN32",
          "615: # pragma optimize(\"\", on)",
          "616: #endif",
          "618: PHPAPI int php_var_unserialize(UNSERIALIZE_PARAMETER)",
          "619: {",
          "620:  var_entries *orig_var_entries = (*var_hash)->last;",
          "621:  zend_long orig_used_slots = orig_var_entries ? orig_var_entries->used_slots : 0;",
          "622:  int result;",
          "624:  result = php_var_unserialize_internal(UNSERIALIZE_PASSTHRU);",
          "626:  if (!result) {",
          "630:   var_entries *e = orig_var_entries;",
          "631:   zend_long s = orig_used_slots;",
          "632:   while (e) {",
          "633:    for (; s < e->used_slots; s++) {",
          "634:     e->data[s] = NULL;",
          "635:    }",
          "637:    e = e->next;",
          "638:    s = 0;",
          "639:   }",
          "640:  }",
          "642:  return result;",
          "643: }",
          "645: static int php_var_unserialize_internal(UNSERIALIZE_PARAMETER)",
          "646: {",
          "647:  const unsigned char *cursor, *limit, *marker, *start;",
          "648:  zval *rval_ref;",
          "650:  limit = max;",
          "651:  cursor = *p;",
          "653:  if (YYCURSOR >= YYLIMIT) {",
          "654:   return 0;",
          "655:  }",
          "657:  if (var_hash && (*p)[0] != 'R') {",
          "658:   var_push(var_hash, rval);",
          "659:  }",
          "661:  start = cursor;",
          "664: #line 665 \"ext/standard/var_unserializer.c\"",
          "665: {",
          "666:  YYCTYPE yych;",
          "667:  static const unsigned char yybm[] = {",
          "668:     0,   0,   0,   0,   0,   0,   0,   0,",
          "669:     0,   0,   0,   0,   0,   0,   0,   0,",
          "670:     0,   0,   0,   0,   0,   0,   0,   0,",
          "671:     0,   0,   0,   0,   0,   0,   0,   0,",
          "672:     0,   0,   0,   0,   0,   0,   0,   0,",
          "673:     0,   0,   0,   0,   0,   0,   0,   0,",
          "674:   128, 128, 128, 128, 128, 128, 128, 128,",
          "675:   128, 128,   0,   0,   0,   0,   0,   0,",
          "676:     0,   0,   0,   0,   0,   0,   0,   0,",
          "677:     0,   0,   0,   0,   0,   0,   0,   0,",
          "678:     0,   0,   0,   0,   0,   0,   0,   0,",
          "679:     0,   0,   0,   0,   0,   0,   0,   0,",
          "680:     0,   0,   0,   0,   0,   0,   0,   0,",
          "681:     0,   0,   0,   0,   0,   0,   0,   0,",
          "682:     0,   0,   0,   0,   0,   0,   0,   0,",
          "683:     0,   0,   0,   0,   0,   0,   0,   0,",
          "684:     0,   0,   0,   0,   0,   0,   0,   0,",
          "685:     0,   0,   0,   0,   0,   0,   0,   0,",
          "686:     0,   0,   0,   0,   0,   0,   0,   0,",
          "687:     0,   0,   0,   0,   0,   0,   0,   0,",
          "688:     0,   0,   0,   0,   0,   0,   0,   0,",
          "689:     0,   0,   0,   0,   0,   0,   0,   0,",
          "690:     0,   0,   0,   0,   0,   0,   0,   0,",
          "691:     0,   0,   0,   0,   0,   0,   0,   0,",
          "692:     0,   0,   0,   0,   0,   0,   0,   0,",
          "693:     0,   0,   0,   0,   0,   0,   0,   0,",
          "694:     0,   0,   0,   0,   0,   0,   0,   0,",
          "695:     0,   0,   0,   0,   0,   0,   0,   0,",
          "696:     0,   0,   0,   0,   0,   0,   0,   0,",
          "697:     0,   0,   0,   0,   0,   0,   0,   0,",
          "698:     0,   0,   0,   0,   0,   0,   0,   0,",
          "699:     0,   0,   0,   0,   0,   0,   0,   0,",
          "700:  };",
          "702:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "703:  yych = *YYCURSOR;",
          "704:  switch (yych) {",
          "705:  case 'C':",
          "706:  case 'O': goto yy13;",
          "707:  case 'N': goto yy5;",
          "708:  case 'R': goto yy2;",
          "709:  case 'S': goto yy10;",
          "710:  case 'a': goto yy11;",
          "711:  case 'b': goto yy6;",
          "712:  case 'd': goto yy8;",
          "713:  case 'i': goto yy7;",
          "714:  case 'o': goto yy12;",
          "715:  case 'r': goto yy4;",
          "716:  case 's': goto yy9;",
          "717:  case '}': goto yy14;",
          "718:  default: goto yy16;",
          "719:  }",
          "720: yy2:",
          "721:  yych = *(YYMARKER = ++YYCURSOR);",
          "722:  if (yych == ':') goto yy88;",
          "723: yy3:",
          "724: #line 1054 \"ext/standard/var_unserializer.re\"",
          "725:  { return 0; }",
          "726: #line 727 \"ext/standard/var_unserializer.c\"",
          "727: yy4:",
          "728:  yych = *(YYMARKER = ++YYCURSOR);",
          "729:  if (yych == ':') goto yy83;",
          "730:  goto yy3;",
          "731: yy5:",
          "732:  yych = *++YYCURSOR;",
          "733:  if (yych == ';') goto yy81;",
          "734:  goto yy3;",
          "735: yy6:",
          "736:  yych = *(YYMARKER = ++YYCURSOR);",
          "737:  if (yych == ':') goto yy77;",
          "738:  goto yy3;",
          "739: yy7:",
          "740:  yych = *(YYMARKER = ++YYCURSOR);",
          "741:  if (yych == ':') goto yy71;",
          "742:  goto yy3;",
          "743: yy8:",
          "744:  yych = *(YYMARKER = ++YYCURSOR);",
          "745:  if (yych == ':') goto yy48;",
          "746:  goto yy3;",
          "747: yy9:",
          "748:  yych = *(YYMARKER = ++YYCURSOR);",
          "749:  if (yych == ':') goto yy42;",
          "750:  goto yy3;",
          "751: yy10:",
          "752:  yych = *(YYMARKER = ++YYCURSOR);",
          "753:  if (yych == ':') goto yy36;",
          "754:  goto yy3;",
          "755: yy11:",
          "756:  yych = *(YYMARKER = ++YYCURSOR);",
          "757:  if (yych == ':') goto yy30;",
          "758:  goto yy3;",
          "759: yy12:",
          "760:  yych = *(YYMARKER = ++YYCURSOR);",
          "761:  if (yych == ':') goto yy24;",
          "762:  goto yy3;",
          "763: yy13:",
          "764:  yych = *(YYMARKER = ++YYCURSOR);",
          "765:  if (yych == ':') goto yy17;",
          "766:  goto yy3;",
          "767: yy14:",
          "768:  ++YYCURSOR;",
          "769: #line 1048 \"ext/standard/var_unserializer.re\"",
          "770:  {",
          "772:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "774: }",
          "775: #line 776 \"ext/standard/var_unserializer.c\"",
          "776: yy16:",
          "777:  yych = *++YYCURSOR;",
          "778:  goto yy3;",
          "779: yy17:",
          "780:  yych = *++YYCURSOR;",
          "781:  if (yybm[0+yych] & 128) {",
          "782:   goto yy19;",
          "783:  }",
          "784: yy18:",
          "785:  YYCURSOR = YYMARKER;",
          "786:  goto yy3;",
          "787: yy19:",
          "788:  ++YYCURSOR;",
          "789:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "790:  yych = *YYCURSOR;",
          "791:  if (yybm[0+yych] & 128) {",
          "792:   goto yy19;",
          "793:  }",
          "794:  if (yych <= '/') goto yy18;",
          "795:  if (yych >= ';') goto yy18;",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych != '\"') goto yy18;",
          "798:  ++YYCURSOR;",
          "799: #line 896 \"ext/standard/var_unserializer.re\"",
          "800:  {",
          "801:  size_t len, len2, len3, maxlen;",
          "802:  zend_long elements;",
          "803:  char *str;",
          "804:  zend_string *class_name;",
          "805:  zend_class_entry *ce;",
          "806:  int incomplete_class = 0;",
          "808:  int custom_object = 0;",
          "810:  zval user_func;",
          "811:  zval retval;",
          "812:  zval args[1];",
          "814:     if (!var_hash) return 0;",
          "815:  if (*start == 'C') {",
          "816:   custom_object = 1;",
          "817:  }",
          "819:  len2 = len = parse_uiv(start + 2);",
          "820:  maxlen = max - YYCURSOR;",
          "821:  if (maxlen < len || len == 0) {",
          "823:   return 0;",
          "824:  }",
          "826:  str = (char*)YYCURSOR;",
          "828:  YYCURSOR += len;",
          "830:  if (*(YYCURSOR) != '\"') {",
          "832:   return 0;",
          "833:  }",
          "834:  if (*(YYCURSOR+1) != ':') {",
          "836:   return 0;",
          "837:  }",
          "839:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "840:  if (len3 != len)",
          "841:  {",
          "843:   return 0;",
          "844:  }",
          "846:  class_name = zend_string_init(str, len, 0);",
          "848:  do {",
          "849:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "850:    incomplete_class = 1;",
          "851:    ce = PHP_IC_ENTRY;",
          "852:    break;",
          "853:   }",
          "856:   BG(serialize_lock)++;",
          "857:   ce = zend_lookup_class(class_name);",
          "858:   if (ce) {",
          "859:    BG(serialize_lock)--;",
          "860:    if (EG(exception)) {",
          "861:     zend_string_release(class_name);",
          "862:     return 0;",
          "863:    }",
          "864:    break;",
          "865:   }",
          "866:   BG(serialize_lock)--;",
          "868:   if (EG(exception)) {",
          "869:    zend_string_release(class_name);",
          "870:    return 0;",
          "871:   }",
          "874:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "875:    incomplete_class = 1;",
          "876:    ce = PHP_IC_ENTRY;",
          "877:    break;",
          "878:   }",
          "881:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "883:   ZVAL_STR_COPY(&args[0], class_name);",
          "884:   BG(serialize_lock)++;",
          "885:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "886:    BG(serialize_lock)--;",
          "887:    if (EG(exception)) {",
          "888:     zend_string_release(class_name);",
          "889:     zval_ptr_dtor(&user_func);",
          "890:     zval_ptr_dtor(&args[0]);",
          "891:     return 0;",
          "892:    }",
          "893:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "894:    incomplete_class = 1;",
          "895:    ce = PHP_IC_ENTRY;",
          "896:    zval_ptr_dtor(&user_func);",
          "897:    zval_ptr_dtor(&args[0]);",
          "898:    break;",
          "899:   }",
          "900:   BG(serialize_lock)--;",
          "901:   zval_ptr_dtor(&retval);",
          "902:   if (EG(exception)) {",
          "903:    zend_string_release(class_name);",
          "904:    zval_ptr_dtor(&user_func);",
          "905:    zval_ptr_dtor(&args[0]);",
          "906:    return 0;",
          "907:   }",
          "910:   BG(serialize_lock)++;",
          "911:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "912:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "913:    incomplete_class = 1;",
          "914:    ce = PHP_IC_ENTRY;",
          "915:   }",
          "916:   BG(serialize_lock)--;",
          "918:   zval_ptr_dtor(&user_func);",
          "919:   zval_ptr_dtor(&args[0]);",
          "920:   break;",
          "921:  } while (1);",
          "925:  if (custom_object) {",
          "926:   int ret;",
          "928:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "930:   if (ret && incomplete_class) {",
          "931:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "932:   }",
          "933:   zend_string_release(class_name);",
          "934:   return ret;",
          "935:  }",
          "937:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "939:  if (elements < 0) {",
          "940:     zend_string_release(class_name);",
          "941:     return 0;",
          "942:  }",
          "944:  if (incomplete_class) {",
          "945:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "946:  }",
          "947:  zend_string_release(class_name);",
          "949:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "950: }",
          "951: #line 952 \"ext/standard/var_unserializer.c\"",
          "952: yy24:",
          "953:  yych = *++YYCURSOR;",
          "954:  if (yych <= '/') goto yy18;",
          "955:  if (yych >= ':') goto yy18;",
          "956: yy25:",
          "957:  ++YYCURSOR;",
          "958:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "959:  yych = *YYCURSOR;",
          "960:  if (yych <= '/') goto yy18;",
          "961:  if (yych <= '9') goto yy25;",
          "962:  if (yych >= ';') goto yy18;",
          "963:  yych = *++YYCURSOR;",
          "964:  if (yych != '\"') goto yy18;",
          "965:  ++YYCURSOR;",
          "966: #line 885 \"ext/standard/var_unserializer.re\"",
          "967:  {",
          "968:  zend_long elements;",
          "969:     if (!var_hash) return 0;",
          "971:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "972:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "973:   return 0;",
          "974:  }",
          "975:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "976: }",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "978: yy30:",
          "979:  yych = *++YYCURSOR;",
          "980:  if (yych <= '/') goto yy18;",
          "981:  if (yych >= ':') goto yy18;",
          "982: yy31:",
          "983:  ++YYCURSOR;",
          "984:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "985:  yych = *YYCURSOR;",
          "986:  if (yych <= '/') goto yy18;",
          "987:  if (yych <= '9') goto yy31;",
          "988:  if (yych >= ';') goto yy18;",
          "989:  yych = *++YYCURSOR;",
          "990:  if (yych != '{') goto yy18;",
          "991:  ++YYCURSOR;",
          "992: #line 855 \"ext/standard/var_unserializer.re\"",
          "993:  {",
          "994:  zend_long elements = parse_iv(start + 2);",
          "997:     if (!var_hash) return 0;",
          "999:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1000:   return 0;",
          "1001:  }",
          "1003:  array_init_size(rval, elements);",
          "1004:  if (elements) {",
          "1007:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1008:  }",
          "1014:  HT_ALLOW_COW_VIOLATION(Z_ARRVAL_P(rval));",
          "1016:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1017:   return 0;",
          "1018:  }",
          "1020:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1021: }",
          "1022: #line 1023 \"ext/standard/var_unserializer.c\"",
          "1023: yy36:",
          "1024:  yych = *++YYCURSOR;",
          "1025:  if (yych <= '/') goto yy18;",
          "1026:  if (yych >= ':') goto yy18;",
          "1027: yy37:",
          "1028:  ++YYCURSOR;",
          "1029:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "1030:  yych = *YYCURSOR;",
          "1031:  if (yych <= '/') goto yy18;",
          "1032:  if (yych <= '9') goto yy37;",
          "1033:  if (yych >= ';') goto yy18;",
          "1034:  yych = *++YYCURSOR;",
          "1035:  if (yych != '\"') goto yy18;",
          "1036:  ++YYCURSOR;",
          "1037: #line 821 \"ext/standard/var_unserializer.re\"",
          "1038:  {",
          "1039:  size_t len, maxlen;",
          "1040:  zend_string *str;",
          "1042:  len = parse_uiv(start + 2);",
          "1043:  maxlen = max - YYCURSOR;",
          "1044:  if (maxlen < len) {",
          "1046:   return 0;",
          "1047:  }",
          "1049:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1050:   return 0;",
          "1051:  }",
          "1053:  if (*(YYCURSOR) != '\"') {",
          "1054:   zend_string_free(str);",
          "1056:   return 0;",
          "1057:  }",
          "1059:  if (*(YYCURSOR + 1) != ';') {",
          "1060:   efree(str);",
          "1062:   return 0;",
          "1063:  }",
          "1065:  YYCURSOR += 2;",
          "1068:  ZVAL_STR(rval, str);",
          "1069:  return 1;",
          "1070: }",
          "1071: #line 1072 \"ext/standard/var_unserializer.c\"",
          "1072: yy42:",
          "1073:  yych = *++YYCURSOR;",
          "1074:  if (yych <= '/') goto yy18;",
          "1075:  if (yych >= ':') goto yy18;",
          "1076: yy43:",
          "1077:  ++YYCURSOR;",
          "1078:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "1079:  yych = *YYCURSOR;",
          "1080:  if (yych <= '/') goto yy18;",
          "1081:  if (yych <= '9') goto yy43;",
          "1082:  if (yych >= ';') goto yy18;",
          "1083:  yych = *++YYCURSOR;",
          "1084:  if (yych != '\"') goto yy18;",
          "1085:  ++YYCURSOR;",
          "1086: #line 783 \"ext/standard/var_unserializer.re\"",
          "1087:  {",
          "1088:  size_t len, maxlen;",
          "1089:  char *str;",
          "1091:  len = parse_uiv(start + 2);",
          "1092:  maxlen = max - YYCURSOR;",
          "1093:  if (maxlen < len) {",
          "1095:   return 0;",
          "1096:  }",
          "1098:  str = (char*)YYCURSOR;",
          "1100:  YYCURSOR += len;",
          "1102:  if (*(YYCURSOR) != '\"') {",
          "1104:   return 0;",
          "1105:  }",
          "1107:  if (*(YYCURSOR + 1) != ';') {",
          "1109:   return 0;",
          "1110:  }",
          "1112:  YYCURSOR += 2;",
          "1115:  if (len == 0) {",
          "1116:   ZVAL_EMPTY_STRING(rval);",
          "1117:  } else if (len == 1) {",
          "1118:   ZVAL_INTERNED_STR(rval, ZSTR_CHAR((zend_uchar)*str));",
          "1119:  } else {",
          "1120:   ZVAL_STRINGL(rval, str, len);",
          "1121:  }",
          "1122:  return 1;",
          "1123: }",
          "1124: #line 1125 \"ext/standard/var_unserializer.c\"",
          "1125: yy48:",
          "1126:  yych = *++YYCURSOR;",
          "1127:  if (yych <= '/') {",
          "1128:   if (yych <= ',') {",
          "1129:    if (yych == '+') goto yy52;",
          "1130:    goto yy18;",
          "1131:   } else {",
          "1132:    if (yych <= '-') goto yy50;",
          "1133:    if (yych <= '.') goto yy55;",
          "1134:    goto yy18;",
          "1135:   }",
          "1136:  } else {",
          "1137:   if (yych <= 'I') {",
          "1138:    if (yych <= '9') goto yy53;",
          "1139:    if (yych <= 'H') goto yy18;",
          "1140:    goto yy51;",
          "1141:   } else {",
          "1142:    if (yych != 'N') goto yy18;",
          "1143:   }",
          "1144:  }",
          "1145:  yych = *++YYCURSOR;",
          "1146:  if (yych == 'A') goto yy70;",
          "1147:  goto yy18;",
          "1148: yy50:",
          "1149:  yych = *++YYCURSOR;",
          "1150:  if (yych <= '/') {",
          "1151:   if (yych == '.') goto yy55;",
          "1152:   goto yy18;",
          "1153:  } else {",
          "1154:   if (yych <= '9') goto yy53;",
          "1155:   if (yych != 'I') goto yy18;",
          "1156:  }",
          "1157: yy51:",
          "1158:  yych = *++YYCURSOR;",
          "1159:  if (yych == 'N') goto yy66;",
          "1160:  goto yy18;",
          "1161: yy52:",
          "1162:  yych = *++YYCURSOR;",
          "1163:  if (yych == '.') goto yy55;",
          "1164:  if (yych <= '/') goto yy18;",
          "1165:  if (yych >= ':') goto yy18;",
          "1166: yy53:",
          "1167:  ++YYCURSOR;",
          "1168:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "1169:  yych = *YYCURSOR;",
          "1170:  if (yych <= ':') {",
          "1171:   if (yych <= '.') {",
          "1172:    if (yych <= '-') goto yy18;",
          "1173:    goto yy64;",
          "1174:   } else {",
          "1175:    if (yych <= '/') goto yy18;",
          "1176:    if (yych <= '9') goto yy53;",
          "1177:    goto yy18;",
          "1178:   }",
          "1179:  } else {",
          "1180:   if (yych <= 'E') {",
          "1181:    if (yych <= ';') goto yy58;",
          "1182:    if (yych <= 'D') goto yy18;",
          "1183:    goto yy60;",
          "1184:   } else {",
          "1185:    if (yych == 'e') goto yy60;",
          "1186:    goto yy18;",
          "1187:   }",
          "1188:  }",
          "1189: yy55:",
          "1190:  yych = *++YYCURSOR;",
          "1191:  if (yych <= '/') goto yy18;",
          "1192:  if (yych >= ':') goto yy18;",
          "1193: yy56:",
          "1194:  ++YYCURSOR;",
          "1195:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "1196:  yych = *YYCURSOR;",
          "1197:  if (yych <= ';') {",
          "1198:   if (yych <= '/') goto yy18;",
          "1199:   if (yych <= '9') goto yy56;",
          "1200:   if (yych <= ':') goto yy18;",
          "1201:  } else {",
          "1202:   if (yych <= 'E') {",
          "1203:    if (yych <= 'D') goto yy18;",
          "1204:    goto yy60;",
          "1205:   } else {",
          "1206:    if (yych == 'e') goto yy60;",
          "1207:    goto yy18;",
          "1208:   }",
          "1209:  }",
          "1210: yy58:",
          "1211:  ++YYCURSOR;",
          "1212: #line 774 \"ext/standard/var_unserializer.re\"",
          "1213:  {",
          "1214: #if SIZEOF_ZEND_LONG == 4",
          "1215: use_double:",
          "1216: #endif",
          "1218:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1219:  return 1;",
          "1220: }",
          "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
          "1222: yy60:",
          "1223:  yych = *++YYCURSOR;",
          "1224:  if (yych <= ',') {",
          "1225:   if (yych != '+') goto yy18;",
          "1226:  } else {",
          "1227:   if (yych <= '-') goto yy61;",
          "1228:   if (yych <= '/') goto yy18;",
          "1229:   if (yych <= '9') goto yy62;",
          "1230:   goto yy18;",
          "1231:  }",
          "1232: yy61:",
          "1233:  yych = *++YYCURSOR;",
          "1234:  if (yych <= '/') goto yy18;",
          "1235:  if (yych >= ':') goto yy18;",
          "1236: yy62:",
          "1237:  ++YYCURSOR;",
          "1238:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1239:  yych = *YYCURSOR;",
          "1240:  if (yych <= '/') goto yy18;",
          "1241:  if (yych <= '9') goto yy62;",
          "1242:  if (yych == ';') goto yy58;",
          "1243:  goto yy18;",
          "1244: yy64:",
          "1245:  ++YYCURSOR;",
          "1246:  if ((YYLIMIT - YYCURSOR) < 3) YYFILL(3);",
          "1247:  yych = *YYCURSOR;",
          "1248:  if (yych <= ';') {",
          "1249:   if (yych <= '/') goto yy18;",
          "1250:   if (yych <= '9') goto yy64;",
          "1251:   if (yych <= ':') goto yy18;",
          "1252:   goto yy58;",
          "1253:  } else {",
          "1254:   if (yych <= 'E') {",
          "1255:    if (yych <= 'D') goto yy18;",
          "1256:    goto yy60;",
          "1257:   } else {",
          "1258:    if (yych == 'e') goto yy60;",
          "1259:    goto yy18;",
          "1260:   }",
          "1261:  }",
          "1262: yy66:",
          "1263:  yych = *++YYCURSOR;",
          "1264:  if (yych != 'F') goto yy18;",
          "1265: yy67:",
          "1266:  yych = *++YYCURSOR;",
          "1267:  if (yych != ';') goto yy18;",
          "1268:  ++YYCURSOR;",
          "1269: #line 758 \"ext/standard/var_unserializer.re\"",
          "1270:  {",
          "1273:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1274:   ZVAL_DOUBLE(rval, ZEND_NAN);",
          "1275:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1276:   ZVAL_DOUBLE(rval, ZEND_INFINITY);",
          "1277:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1278:   ZVAL_DOUBLE(rval, -ZEND_INFINITY);",
          "1279:  } else {",
          "1280:   ZVAL_NULL(rval);",
          "1281:  }",
          "1283:  return 1;",
          "1284: }",
          "1285: #line 1286 \"ext/standard/var_unserializer.c\"",
          "1286: yy70:",
          "1287:  yych = *++YYCURSOR;",
          "1288:  if (yych == 'N') goto yy67;",
          "1289:  goto yy18;",
          "1290: yy71:",
          "1291:  yych = *++YYCURSOR;",
          "1292:  if (yych <= ',') {",
          "1293:   if (yych != '+') goto yy18;",
          "1294:  } else {",
          "1295:   if (yych <= '-') goto yy72;",
          "1296:   if (yych <= '/') goto yy18;",
          "1297:   if (yych <= '9') goto yy73;",
          "1298:   goto yy18;",
          "1299:  }",
          "1300: yy72:",
          "1301:  yych = *++YYCURSOR;",
          "1302:  if (yych <= '/') goto yy18;",
          "1303:  if (yych >= ':') goto yy18;",
          "1304: yy73:",
          "1305:  ++YYCURSOR;",
          "1306:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1307:  yych = *YYCURSOR;",
          "1308:  if (yych <= '/') goto yy18;",
          "1309:  if (yych <= '9') goto yy73;",
          "1310:  if (yych != ';') goto yy18;",
          "1311:  ++YYCURSOR;",
          "1312: #line 732 \"ext/standard/var_unserializer.re\"",
          "1313:  {",
          "1314: #if SIZEOF_ZEND_LONG == 4",
          "1315:  int digits = YYCURSOR - start - 3;",
          "1317:  if (start[2] == '-' || start[2] == '+') {",
          "1318:   digits--;",
          "1319:  }",
          "1322:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1323:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1324:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1326:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1327:     goto use_double;",
          "1328:    }",
          "1329:   } else {",
          "1330:    goto use_double;",
          "1331:   }",
          "1332:  }",
          "1333: #endif",
          "1335:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1336:  return 1;",
          "1337: }",
          "1338: #line 1339 \"ext/standard/var_unserializer.c\"",
          "1339: yy77:",
          "1340:  yych = *++YYCURSOR;",
          "1341:  if (yych <= '/') goto yy18;",
          "1342:  if (yych >= '2') goto yy18;",
          "1343:  yych = *++YYCURSOR;",
          "1344:  if (yych != ';') goto yy18;",
          "1345:  ++YYCURSOR;",
          "1346: #line 726 \"ext/standard/var_unserializer.re\"",
          "1347:  {",
          "1349:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1350:  return 1;",
          "1351: }",
          "1352: #line 1353 \"ext/standard/var_unserializer.c\"",
          "1353: yy81:",
          "1354:  ++YYCURSOR;",
          "1355: #line 720 \"ext/standard/var_unserializer.re\"",
          "1356:  {",
          "1358:  ZVAL_NULL(rval);",
          "1359:  return 1;",
          "1360: }",
          "1361: #line 1362 \"ext/standard/var_unserializer.c\"",
          "1362: yy83:",
          "1363:  yych = *++YYCURSOR;",
          "1364:  if (yych <= '/') goto yy18;",
          "1365:  if (yych >= ':') goto yy18;",
          "1366: yy84:",
          "1367:  ++YYCURSOR;",
          "1368:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1369:  yych = *YYCURSOR;",
          "1370:  if (yych <= '/') goto yy18;",
          "1371:  if (yych <= '9') goto yy84;",
          "1372:  if (yych != ';') goto yy18;",
          "1373:  ++YYCURSOR;",
          "1374: #line 695 \"ext/standard/var_unserializer.re\"",
          "1375:  {",
          "1376:  zend_long id;",
          "1379:  if (!var_hash) return 0;",
          "1381:  id = parse_uiv(start + 2) - 1;",
          "1382:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1383:   return 0;",
          "1384:  }",
          "1386:  if (rval_ref == rval) {",
          "1387:   return 0;",
          "1388:  }",
          "1390:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1391:   ZVAL_UNDEF(rval);",
          "1392:   return 1;",
          "1393:  }",
          "1395:  ZVAL_COPY(rval, rval_ref);",
          "1397:  return 1;",
          "1398: }",
          "1399: #line 1400 \"ext/standard/var_unserializer.c\"",
          "1400: yy88:",
          "1401:  yych = *++YYCURSOR;",
          "1402:  if (yych <= '/') goto yy18;",
          "1403:  if (yych >= ':') goto yy18;",
          "1404: yy89:",
          "1405:  ++YYCURSOR;",
          "1406:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1407:  yych = *YYCURSOR;",
          "1408:  if (yych <= '/') goto yy18;",
          "1409:  if (yych <= '9') goto yy89;",
          "1410:  if (yych != ';') goto yy18;",
          "1411:  ++YYCURSOR;",
          "1412: #line 669 \"ext/standard/var_unserializer.re\"",
          "1413:  {",
          "1414:  zend_long id;",
          "1417:  if (!var_hash) return 0;",
          "1419:  id = parse_uiv(start + 2) - 1;",
          "1420:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1421:   return 0;",
          "1422:  }",
          "1424:  zval_ptr_dtor(rval);",
          "1425:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1426:   ZVAL_UNDEF(rval);",
          "1427:   return 1;",
          "1428:  }",
          "1429:  if (Z_ISREF_P(rval_ref)) {",
          "1430:   ZVAL_COPY(rval, rval_ref);",
          "1431:  } else {",
          "1432:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1433:   ZVAL_COPY(rval, rval_ref);",
          "1434:  }",
          "1436:  return 1;",
          "1437: }",
          "1438: #line 1439 \"ext/standard/var_unserializer.c\"",
          "1439: }",
          "1440: #line 1056 \"ext/standard/var_unserializer.re\"",
          "1443:  return 0;",
          "1444: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8d8e94936959eb2466ec77d1e537427f92650363",
      "candidate_info": {
        "commit_hash": "8d8e94936959eb2466ec77d1e537427f92650363",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/8d8e94936959eb2466ec77d1e537427f92650363",
        "files": [
          "ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-7.0' into PHP-7.1",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70963.phpt||ext/standard/tests/serialize/bug70963.phpt": [
          "File: ext/standard/tests/serialize/bug70963.phpt -> ext/standard/tests/serialize/bug70963.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "6: var_dump(unserialize('a:2:{i:0;O:9:\"exception\":1:{s:16:\"'.\"\\0\".'Exception'.\"\\0\".'trace\";s:4:\"test\";}i:1;r:3;}'));",
          "7: ?>",
          "8: --EXPECTF--",
          "10:   [0]=>",
          "11:   object(Exception)#%d (6) {",
          "12:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "9: array(1) {",
          "",
          "[Added Lines]",
          "9: array(2) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "22:     [\"previous\":\"Exception\":private]=>",
          "23:     NULL",
          "24:   }",
          "25: }",
          "27:   [0]=>",
          "28:   object(Exception)#%d (6) {",
          "29:     [\"message\":protected]=>",
          "",
          "[Removed Lines]",
          "26: array(1) {",
          "",
          "[Added Lines]",
          "25:   [1]=>",
          "26:   string(4) \"test\"",
          "28: array(2) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "39:     [\"previous\":\"Exception\":private]=>",
          "40:     NULL",
          "41:   }",
          "42: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44:   [1]=>",
          "45:   string(4) \"test\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "71: #define VAR_ENTRIES_MAX 1024",
          "72: #define VAR_ENTRIES_DBG 0",
          "74: typedef struct {",
          "75:  zval *data[VAR_ENTRIES_MAX];",
          "76:  zend_long used_slots;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "75: #define VAR_WAKEUP_FLAG 1",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "139:         (*var_hashx)->last_dtor = var_hash;",
          "140:     }",
          "141:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "142:     return &var_hash->data[var_hash->used_slots++];",
          "143: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "145:  Z_ACCESS_FLAGS(var_hash->data[var_hash->used_slots]) = 0;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "186:  zend_long i;",
          "187:  var_entries *var_hash = (*var_hashx)->first;",
          "188:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "189: #if VAR_ENTRIES_DBG",
          "190:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "191: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "193:  zend_bool wakeup_failed = 0;",
          "194:  zval wakeup_name;",
          "195:  ZVAL_UNDEF(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "199:  while (var_dtor_hash) {",
          "200:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "201: #if VAR_ENTRIES_DBG",
          "202:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "203: #endif",
          "205:   }",
          "206:   next = var_dtor_hash->next;",
          "207:   efree_size(var_dtor_hash, sizeof(var_dtor_entries));",
          "208:   var_dtor_hash = next;",
          "209:  }",
          "210: }",
          "",
          "[Removed Lines]",
          "204:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "",
          "[Added Lines]",
          "209:    zval *zv = &var_dtor_hash->data[i];",
          "215:    if (Z_ACCESS_FLAGS_P(zv) == VAR_WAKEUP_FLAG) {",
          "216:     if (!wakeup_failed) {",
          "217:      zval retval;",
          "218:      if (Z_ISUNDEF(wakeup_name)) {",
          "219:       ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "220:      }",
          "222:      BG(serialize_lock)++;",
          "223:      if (call_user_function_ex(CG(function_table), zv, &wakeup_name, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "224:       wakeup_failed = 1;",
          "225:       GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "226:      }",
          "227:      BG(serialize_lock)--;",
          "229:      zval_ptr_dtor(&retval);",
          "230:     } else {",
          "231:      GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "232:     }",
          "233:    }",
          "235:    zval_ptr_dtor(zv);",
          "242:  zval_ptr_dtor(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "283: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "286: #line 291 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "319: #line 324 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "504: #endif",
          "505: static inline int object_common2(UNSERIALIZE_PARAMETER, zend_long elements)",
          "506: {",
          "509:  HashTable *ht;",
          "510:  zend_bool has_wakeup;",
          "",
          "[Removed Lines]",
          "507:  zval retval;",
          "508:  zval fname;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "529:  ZVAL_DEREF(rval);",
          "530:  if (has_wakeup) {",
          "543:  }",
          "545:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "",
          "[Removed Lines]",
          "531:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "532:   BG(serialize_lock)++;",
          "533:   if (call_user_function_ex(CG(function_table), rval, &fname, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "534:    GC_FLAGS(Z_OBJ_P(rval)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "535:   }",
          "536:   BG(serialize_lock)--;",
          "537:   zval_dtor(&fname);",
          "538:   zval_dtor(&retval);",
          "539:  }",
          "541:  if (EG(exception)) {",
          "542:   return 0;",
          "",
          "[Added Lines]",
          "563:   zval *wakeup_var = var_tmp_var(var_hash);",
          "564:   ZVAL_COPY(wakeup_var, rval);",
          "565:   Z_ACCESS_FLAGS_P(wakeup_var) = VAR_WAKEUP_FLAG;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "594:  start = cursor;",
          "598: {",
          "599:  YYCTYPE yych;",
          "600:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "597: #line 598 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "620: #line 621 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "631:     0,   0,   0,   0,   0,   0,   0,   0,",
          "632:     0,   0,   0,   0,   0,   0,   0,   0,",
          "633:  };",
          "635:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "636:  yych = *YYCURSOR;",
          "637:  switch (yych) {",
          "638:  case 'C':",
          "640:  case 'N': goto yy5;",
          "647:  case 'o': goto yy12;",
          "652:  }",
          "653: yy2:",
          "656: yy3:",
          "658:  { return 0; }",
          "660: yy4:",
          "661:  yych = *(YYMARKER = ++YYCURSOR);",
          "663:  goto yy3;",
          "664: yy5:",
          "665:  yych = *++YYCURSOR;",
          "667:  goto yy3;",
          "668: yy6:",
          "669:  yych = *(YYMARKER = ++YYCURSOR);",
          "671:  goto yy3;",
          "672: yy7:",
          "673:  yych = *(YYMARKER = ++YYCURSOR);",
          "675:  goto yy3;",
          "676: yy8:",
          "677:  yych = *(YYMARKER = ++YYCURSOR);",
          "679:  goto yy3;",
          "680: yy9:",
          "681:  yych = *(YYMARKER = ++YYCURSOR);",
          "683:  goto yy3;",
          "684: yy10:",
          "685:  yych = *(YYMARKER = ++YYCURSOR);",
          "687:  goto yy3;",
          "688: yy11:",
          "689:  yych = *(YYMARKER = ++YYCURSOR);",
          "691:  goto yy3;",
          "692: yy12:",
          "693:  yych = *(YYMARKER = ++YYCURSOR);",
          "695:  goto yy3;",
          "696: yy13:",
          "697:  yych = *(YYMARKER = ++YYCURSOR);",
          "699:  goto yy3;",
          "700: yy14:",
          "701:  ++YYCURSOR;",
          "703:  {",
          "705:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "707: }",
          "712: yy17:",
          "713:  yych = *++YYCURSOR;",
          "714:  if (yybm[0+yych] & 128) {",
          "716:  }",
          "718: yy18:",
          "719:  YYCURSOR = YYMARKER;",
          "720:  goto yy3;",
          "721: yy19:",
          "722:  yych = *++YYCURSOR;",
          "725:  }",
          "726:  goto yy18;",
          "734:  if (yych <= '/') goto yy18;",
          "736:  yych = *++YYCURSOR;",
          "855:   }",
          "872:   }",
          "875:  }",
          "882:  }",
          "886:  }",
          "893:  yych = *++YYCURSOR;",
          "894:  if (yych <= ',') {",
          "896:  } else {",
          "898:   if (yych <= '/') goto yy18;",
          "900:   goto yy18;",
          "901:  }",
          "903:  yych = *++YYCURSOR;",
          "904:  if (yych <= '/') goto yy18;",
          "907:  ++YYCURSOR;",
          "908:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "909:  yych = *YYCURSOR;",
          "924:  }",
          "931:  if (yych <= '/') goto yy18;",
          "933:  goto yy18;",
          "934: yy33:",
          "935:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "639:  case 'O': goto yy13;",
          "641:  case 'R': goto yy2;",
          "642:  case 'S': goto yy10;",
          "643:  case 'a': goto yy11;",
          "644:  case 'b': goto yy6;",
          "645:  case 'd': goto yy8;",
          "646:  case 'i': goto yy7;",
          "648:  case 'r': goto yy4;",
          "649:  case 's': goto yy9;",
          "650:  case '}': goto yy14;",
          "651:  default: goto yy16;",
          "654:  yych = *(YYMARKER = ++YYCURSOR);",
          "655:  if (yych == ':') goto yy95;",
          "657: #line 975 \"ext/standard/var_unserializer.re\"",
          "659: #line 660 \"ext/standard/var_unserializer.c\"",
          "662:  if (yych == ':') goto yy89;",
          "666:  if (yych == ';') goto yy87;",
          "670:  if (yych == ':') goto yy83;",
          "674:  if (yych == ':') goto yy77;",
          "678:  if (yych == ':') goto yy53;",
          "682:  if (yych == ':') goto yy46;",
          "686:  if (yych == ':') goto yy39;",
          "690:  if (yych == ':') goto yy32;",
          "694:  if (yych == ':') goto yy25;",
          "698:  if (yych == ':') goto yy17;",
          "702: #line 969 \"ext/standard/var_unserializer.re\"",
          "708: #line 709 \"ext/standard/var_unserializer.c\"",
          "709: yy16:",
          "710:  yych = *++YYCURSOR;",
          "711:  goto yy3;",
          "715:   goto yy20;",
          "717:  if (yych == '+') goto yy19;",
          "723:  if (yybm[0+yych] & 128) {",
          "724:   goto yy20;",
          "727: yy20:",
          "728:  ++YYCURSOR;",
          "729:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "730:  yych = *YYCURSOR;",
          "731:  if (yybm[0+yych] & 128) {",
          "732:   goto yy20;",
          "733:  }",
          "735:  if (yych >= ';') goto yy18;",
          "737:  if (yych != '\"') goto yy18;",
          "738:  ++YYCURSOR;",
          "739: #line 817 \"ext/standard/var_unserializer.re\"",
          "740:  {",
          "741:  size_t len, len2, len3, maxlen;",
          "742:  zend_long elements;",
          "743:  char *str;",
          "744:  zend_string *class_name;",
          "745:  zend_class_entry *ce;",
          "746:  int incomplete_class = 0;",
          "748:  int custom_object = 0;",
          "750:  zval user_func;",
          "751:  zval retval;",
          "752:  zval args[1];",
          "754:     if (!var_hash) return 0;",
          "755:  if (*start == 'C') {",
          "756:   custom_object = 1;",
          "757:  }",
          "759:  len2 = len = parse_uiv(start + 2);",
          "760:  maxlen = max - YYCURSOR;",
          "761:  if (maxlen < len || len == 0) {",
          "763:   return 0;",
          "764:  }",
          "766:  str = (char*)YYCURSOR;",
          "768:  YYCURSOR += len;",
          "770:  if (*(YYCURSOR) != '\"') {",
          "772:   return 0;",
          "773:  }",
          "774:  if (*(YYCURSOR+1) != ':') {",
          "776:   return 0;",
          "777:  }",
          "779:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "780:  if (len3 != len)",
          "781:  {",
          "783:   return 0;",
          "784:  }",
          "786:  class_name = zend_string_init(str, len, 0);",
          "788:  do {",
          "789:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "790:    incomplete_class = 1;",
          "791:    ce = PHP_IC_ENTRY;",
          "792:    break;",
          "793:   }",
          "796:   BG(serialize_lock)++;",
          "797:   ce = zend_lookup_class(class_name);",
          "798:   if (ce) {",
          "799:    BG(serialize_lock)--;",
          "800:    if (EG(exception)) {",
          "801:     zend_string_release(class_name);",
          "802:     return 0;",
          "803:    }",
          "804:    break;",
          "805:   }",
          "806:   BG(serialize_lock)--;",
          "808:   if (EG(exception)) {",
          "809:    zend_string_release(class_name);",
          "810:    return 0;",
          "811:   }",
          "814:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "815:    incomplete_class = 1;",
          "816:    ce = PHP_IC_ENTRY;",
          "817:    break;",
          "818:   }",
          "821:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "823:   ZVAL_STR_COPY(&args[0], class_name);",
          "824:   BG(serialize_lock)++;",
          "825:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "826:    BG(serialize_lock)--;",
          "827:    if (EG(exception)) {",
          "828:     zend_string_release(class_name);",
          "829:     zval_ptr_dtor(&user_func);",
          "830:     zval_ptr_dtor(&args[0]);",
          "831:     return 0;",
          "832:    }",
          "833:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "834:    incomplete_class = 1;",
          "835:    ce = PHP_IC_ENTRY;",
          "836:    zval_ptr_dtor(&user_func);",
          "837:    zval_ptr_dtor(&args[0]);",
          "838:    break;",
          "839:   }",
          "840:   BG(serialize_lock)--;",
          "841:   zval_ptr_dtor(&retval);",
          "842:   if (EG(exception)) {",
          "843:    zend_string_release(class_name);",
          "844:    zval_ptr_dtor(&user_func);",
          "845:    zval_ptr_dtor(&args[0]);",
          "846:    return 0;",
          "847:   }",
          "850:   BG(serialize_lock)++;",
          "851:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "852:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "853:    incomplete_class = 1;",
          "854:    ce = PHP_IC_ENTRY;",
          "856:   BG(serialize_lock)--;",
          "858:   zval_ptr_dtor(&user_func);",
          "859:   zval_ptr_dtor(&args[0]);",
          "860:   break;",
          "861:  } while (1);",
          "865:  if (custom_object) {",
          "866:   int ret;",
          "868:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "870:   if (ret && incomplete_class) {",
          "871:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "873:   zend_string_release(class_name);",
          "874:   return ret;",
          "877:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "879:  if (elements < 0) {",
          "880:     zend_string_release(class_name);",
          "881:     return 0;",
          "884:  if (incomplete_class) {",
          "885:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "887:  zend_string_release(class_name);",
          "889:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "890: }",
          "891: #line 892 \"ext/standard/var_unserializer.c\"",
          "892: yy25:",
          "895:   if (yych != '+') goto yy18;",
          "897:   if (yych <= '-') goto yy26;",
          "899:   if (yych <= '9') goto yy27;",
          "902: yy26:",
          "905:  if (yych >= ':') goto yy18;",
          "906: yy27:",
          "910:  if (yych <= '/') goto yy18;",
          "911:  if (yych <= '9') goto yy27;",
          "912:  if (yych >= ';') goto yy18;",
          "913:  yych = *++YYCURSOR;",
          "914:  if (yych != '\"') goto yy18;",
          "915:  ++YYCURSOR;",
          "916: #line 806 \"ext/standard/var_unserializer.re\"",
          "917:  {",
          "918:  long elements;",
          "919:     if (!var_hash) return 0;",
          "921:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "922:  if (elements < 0) {",
          "923:   return 0;",
          "925:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "926: }",
          "927: #line 928 \"ext/standard/var_unserializer.c\"",
          "928: yy32:",
          "929:  yych = *++YYCURSOR;",
          "930:  if (yych == '+') goto yy33;",
          "932:  if (yych <= '9') goto yy34;",
          "",
          "[Added Lines]",
          "661:  case 'O': goto yy4;",
          "663:  case 'R': goto yy6;",
          "664:  case 'S': goto yy7;",
          "665:  case 'a': goto yy8;",
          "666:  case 'b': goto yy9;",
          "667:  case 'd': goto yy10;",
          "668:  case 'i': goto yy11;",
          "670:  case 'r': goto yy13;",
          "671:  case 's': goto yy14;",
          "672:  case '}': goto yy15;",
          "673:  default: goto yy2;",
          "676:  ++YYCURSOR;",
          "678: #line 998 \"ext/standard/var_unserializer.re\"",
          "680: #line 681 \"ext/standard/var_unserializer.c\"",
          "683:  if (yych == ':') goto yy17;",
          "687:  if (yych == ';') goto yy19;",
          "691:  if (yych == ':') goto yy21;",
          "695:  if (yych == ':') goto yy22;",
          "699:  if (yych == ':') goto yy23;",
          "703:  if (yych == ':') goto yy24;",
          "707:  if (yych == ':') goto yy25;",
          "711:  if (yych == ':') goto yy26;",
          "715:  if (yych == ':') goto yy27;",
          "719:  if (yych == ':') goto yy28;",
          "722:  yych = *(YYMARKER = ++YYCURSOR);",
          "723:  if (yych == ':') goto yy29;",
          "724:  goto yy3;",
          "725: yy15:",
          "727: #line 992 \"ext/standard/var_unserializer.re\"",
          "733: #line 734 \"ext/standard/var_unserializer.c\"",
          "737:   goto yy31;",
          "739:  if (yych == '+') goto yy30;",
          "744:  ++YYCURSOR;",
          "745: #line 676 \"ext/standard/var_unserializer.re\"",
          "746:  {",
          "748:  ZVAL_NULL(rval);",
          "749:  return 1;",
          "750: }",
          "751: #line 752 \"ext/standard/var_unserializer.c\"",
          "752: yy21:",
          "754:  if (yych <= ',') {",
          "755:   if (yych == '+') goto yy33;",
          "756:   goto yy18;",
          "757:  } else {",
          "758:   if (yych <= '-') goto yy33;",
          "759:   if (yych <= '/') goto yy18;",
          "760:   if (yych <= '9') goto yy34;",
          "761:   goto yy18;",
          "763: yy22:",
          "764:  yych = *++YYCURSOR;",
          "765:  if (yych == '+') goto yy36;",
          "766:  if (yych <= '/') goto yy18;",
          "767:  if (yych <= '9') goto yy37;",
          "769: yy23:",
          "770:  yych = *++YYCURSOR;",
          "771:  if (yych == '+') goto yy39;",
          "773:  if (yych <= '9') goto yy40;",
          "774:  goto yy18;",
          "775: yy24:",
          "777:  if (yych <= '/') goto yy18;",
          "778:  if (yych <= '1') goto yy42;",
          "779:  goto yy18;",
          "780: yy25:",
          "781:  yych = *++YYCURSOR;",
          "782:  if (yych <= '/') {",
          "783:   if (yych <= ',') {",
          "784:    if (yych == '+') goto yy43;",
          "785:    goto yy18;",
          "786:   } else {",
          "787:    if (yych <= '-') goto yy44;",
          "788:    if (yych <= '.') goto yy45;",
          "789:    goto yy18;",
          "791:  } else {",
          "792:   if (yych <= 'I') {",
          "793:    if (yych <= '9') goto yy46;",
          "794:    if (yych <= 'H') goto yy18;",
          "795:    goto yy48;",
          "796:   } else {",
          "797:    if (yych == 'N') goto yy49;",
          "798:    goto yy18;",
          "801: yy26:",
          "802:  yych = *++YYCURSOR;",
          "803:  if (yych <= ',') {",
          "804:   if (yych == '+') goto yy50;",
          "805:   goto yy18;",
          "806:  } else {",
          "807:   if (yych <= '-') goto yy50;",
          "808:   if (yych <= '/') goto yy18;",
          "809:   if (yych <= '9') goto yy51;",
          "810:   goto yy18;",
          "812: yy27:",
          "813:  yych = *++YYCURSOR;",
          "814:  if (yych <= ',') {",
          "815:   if (yych == '+') goto yy53;",
          "816:   goto yy18;",
          "817:  } else {",
          "818:   if (yych <= '-') goto yy53;",
          "819:   if (yych <= '/') goto yy18;",
          "820:   if (yych <= '9') goto yy54;",
          "821:   goto yy18;",
          "823: yy28:",
          "826:   if (yych == '+') goto yy56;",
          "827:   goto yy18;",
          "829:   if (yych <= '-') goto yy56;",
          "831:   if (yych <= '9') goto yy57;",
          "834: yy29:",
          "836:  if (yych == '+') goto yy59;",
          "838:  if (yych <= '9') goto yy60;",
          "839:  goto yy18;",
          "840: yy30:",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yybm[0+yych] & 128) {",
          "843:   goto yy31;",
          "844:  }",
          "845:  goto yy18;",
          "846: yy31:",
          "850:  if (yybm[0+yych] & 128) {",
          "851:   goto yy31;",
          "854:  if (yych <= ':') goto yy62;",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "937:  if (yych >= ':') goto yy18;",
          "938: yy34:",
          "939:  ++YYCURSOR;",
          "941:  yych = *YYCURSOR;",
          "942:  if (yych <= '/') goto yy18;",
          "943:  if (yych <= '9') goto yy34;",
          "980:  yych = *++YYCURSOR;",
          "981:  if (yych <= '/') goto yy18;",
          "982:  if (yych >= ':') goto yy18;",
          "984:  ++YYCURSOR;",
          "985:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "986:  yych = *YYCURSOR;",
          "987:  if (yych <= '/') goto yy18;",
          "1033:  goto yy18;",
          "1035:  yych = *++YYCURSOR;",
          "1036:  if (yych <= '/') goto yy18;",
          "1037:  if (yych >= ':') goto yy18;",
          "1039:  ++YYCURSOR;",
          "1040:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "1041:  yych = *YYCURSOR;",
          "1042:  if (yych <= '/') goto yy18;",
          "1082:  yych = *++YYCURSOR;",
          "1101:  yych = *++YYCURSOR;",
          "1103:  goto yy18;",
          "1105:  yych = *++YYCURSOR;",
          "1106:  if (yych <= '/') {",
          "1109:  } else {",
          "1112:  }",
          "1114:  yych = *++YYCURSOR;",
          "1120:  if (yych <= '/') goto yy18;",
          "1123:  ++YYCURSOR;",
          "1124:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1125:  yych = *YYCURSOR;",
          "1126:  if (yych <= ':') {",
          "1127:   if (yych <= '.') {",
          "1128:    if (yych <= '-') goto yy18;",
          "1130:   } else {",
          "1131:    if (yych <= '/') goto yy18;",
          "1133:    goto yy18;",
          "1134:   }",
          "1135:  } else {",
          "1136:   if (yych <= 'E') {",
          "1138:    if (yych <= 'D') goto yy18;",
          "1140:   } else {",
          "1142:    goto yy18;",
          "1143:   }",
          "1144:  }",
          "1146:  yych = *++YYCURSOR;",
          "1147:  if (yych <= '/') goto yy18;",
          "1148:  if (yych >= ':') goto yy18;",
          "1150:  ++YYCURSOR;",
          "1151:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1152:  yych = *YYCURSOR;",
          "1153:  if (yych <= ';') {",
          "1154:   if (yych <= '/') goto yy18;",
          "1156:   if (yych <= ':') goto yy18;",
          "1157:  } else {",
          "1158:   if (yych <= 'E') {",
          "1159:    if (yych <= 'D') goto yy18;",
          "1161:   } else {",
          "1163:    goto yy18;",
          "1164:   }",
          "1165:  }",
          "1167:  ++YYCURSOR;",
          "1169:  {",
          "1170: #if SIZEOF_ZEND_LONG == 4",
          "1171: use_double:",
          "",
          "[Removed Lines]",
          "940:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "944:  if (yych >= ';') goto yy18;",
          "945:  yych = *++YYCURSOR;",
          "946:  if (yych != '{') goto yy18;",
          "947:  ++YYCURSOR;",
          "948: #line 782 \"ext/standard/var_unserializer.re\"",
          "949:  {",
          "950:  zend_long elements = parse_iv(start + 2);",
          "953:     if (!var_hash) return 0;",
          "955:  if (elements < 0) {",
          "956:   return 0;",
          "957:  }",
          "959:  array_init_size(rval, elements);",
          "960:  if (elements) {",
          "963:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "964:  }",
          "966:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "967:   return 0;",
          "968:  }",
          "970:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "971: }",
          "972: #line 973 \"ext/standard/var_unserializer.c\"",
          "973: yy39:",
          "974:  yych = *++YYCURSOR;",
          "975:  if (yych == '+') goto yy40;",
          "976:  if (yych <= '/') goto yy18;",
          "977:  if (yych <= '9') goto yy41;",
          "978:  goto yy18;",
          "979: yy40:",
          "983: yy41:",
          "988:  if (yych <= '9') goto yy41;",
          "989:  if (yych >= ';') goto yy18;",
          "990:  yych = *++YYCURSOR;",
          "991:  if (yych != '\"') goto yy18;",
          "992:  ++YYCURSOR;",
          "993: #line 748 \"ext/standard/var_unserializer.re\"",
          "994:  {",
          "995:  size_t len, maxlen;",
          "996:  zend_string *str;",
          "998:  len = parse_uiv(start + 2);",
          "999:  maxlen = max - YYCURSOR;",
          "1000:  if (maxlen < len) {",
          "1002:   return 0;",
          "1003:  }",
          "1005:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1006:   return 0;",
          "1007:  }",
          "1009:  if (*(YYCURSOR) != '\"') {",
          "1010:   zend_string_free(str);",
          "1012:   return 0;",
          "1013:  }",
          "1015:  if (*(YYCURSOR + 1) != ';') {",
          "1016:   efree(str);",
          "1018:   return 0;",
          "1019:  }",
          "1021:  YYCURSOR += 2;",
          "1024:  ZVAL_STR(rval, str);",
          "1025:  return 1;",
          "1026: }",
          "1027: #line 1028 \"ext/standard/var_unserializer.c\"",
          "1028: yy46:",
          "1029:  yych = *++YYCURSOR;",
          "1030:  if (yych == '+') goto yy47;",
          "1031:  if (yych <= '/') goto yy18;",
          "1032:  if (yych <= '9') goto yy48;",
          "1034: yy47:",
          "1038: yy48:",
          "1043:  if (yych <= '9') goto yy48;",
          "1044:  if (yych >= ';') goto yy18;",
          "1045:  yych = *++YYCURSOR;",
          "1046:  if (yych != '\"') goto yy18;",
          "1047:  ++YYCURSOR;",
          "1048: #line 716 \"ext/standard/var_unserializer.re\"",
          "1049:  {",
          "1050:  size_t len, maxlen;",
          "1051:  char *str;",
          "1053:  len = parse_uiv(start + 2);",
          "1054:  maxlen = max - YYCURSOR;",
          "1055:  if (maxlen < len) {",
          "1057:   return 0;",
          "1058:  }",
          "1060:  str = (char*)YYCURSOR;",
          "1062:  YYCURSOR += len;",
          "1064:  if (*(YYCURSOR) != '\"') {",
          "1066:   return 0;",
          "1067:  }",
          "1069:  if (*(YYCURSOR + 1) != ';') {",
          "1071:   return 0;",
          "1072:  }",
          "1074:  YYCURSOR += 2;",
          "1077:  ZVAL_STRINGL(rval, str, len);",
          "1078:  return 1;",
          "1079: }",
          "1080: #line 1081 \"ext/standard/var_unserializer.c\"",
          "1081: yy53:",
          "1083:  if (yych <= '/') {",
          "1084:   if (yych <= ',') {",
          "1085:    if (yych == '+') goto yy57;",
          "1086:    goto yy18;",
          "1087:   } else {",
          "1088:    if (yych <= '-') goto yy55;",
          "1089:    if (yych <= '.') goto yy60;",
          "1090:    goto yy18;",
          "1091:   }",
          "1092:  } else {",
          "1093:   if (yych <= 'I') {",
          "1094:    if (yych <= '9') goto yy58;",
          "1095:    if (yych <= 'H') goto yy18;",
          "1096:    goto yy56;",
          "1097:   } else {",
          "1098:    if (yych != 'N') goto yy18;",
          "1099:   }",
          "1100:  }",
          "1102:  if (yych == 'A') goto yy76;",
          "1104: yy55:",
          "1107:   if (yych == '.') goto yy60;",
          "1108:   goto yy18;",
          "1110:   if (yych <= '9') goto yy58;",
          "1111:   if (yych != 'I') goto yy18;",
          "1113: yy56:",
          "1115:  if (yych == 'N') goto yy72;",
          "1116:  goto yy18;",
          "1117: yy57:",
          "1118:  yych = *++YYCURSOR;",
          "1119:  if (yych == '.') goto yy60;",
          "1121:  if (yych >= ':') goto yy18;",
          "1122: yy58:",
          "1129:    goto yy70;",
          "1132:    if (yych <= '9') goto yy58;",
          "1137:    if (yych <= ';') goto yy63;",
          "1139:    goto yy65;",
          "1141:    if (yych == 'e') goto yy65;",
          "1145: yy60:",
          "1149: yy61:",
          "1155:   if (yych <= '9') goto yy61;",
          "1160:    goto yy65;",
          "1162:    if (yych == 'e') goto yy65;",
          "1166: yy63:",
          "1168: #line 707 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "862:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "866:  if (yych == ';') goto yy63;",
          "867:  goto yy18;",
          "868: yy36:",
          "872: yy37:",
          "877:  if (yych <= '9') goto yy37;",
          "878:  if (yych <= ':') goto yy65;",
          "880: yy39:",
          "884: yy40:",
          "889:  if (yych <= '9') goto yy40;",
          "890:  if (yych <= ':') goto yy66;",
          "891:  goto yy18;",
          "892: yy42:",
          "894:  if (yych == ';') goto yy67;",
          "895:  goto yy18;",
          "896: yy43:",
          "898:  if (yych == '.') goto yy45;",
          "899:  if (yych <= '/') goto yy18;",
          "900:  if (yych <= '9') goto yy46;",
          "902: yy44:",
          "905:   if (yych != '.') goto yy18;",
          "907:   if (yych <= '9') goto yy46;",
          "908:   if (yych == 'I') goto yy48;",
          "909:   goto yy18;",
          "911: yy45:",
          "914:  if (yych <= '9') goto yy69;",
          "915:  goto yy18;",
          "916: yy46:",
          "923:    goto yy69;",
          "926:    if (yych <= '9') goto yy46;",
          "931:    if (yych <= ';') goto yy71;",
          "933:    goto yy73;",
          "935:    if (yych == 'e') goto yy73;",
          "939: yy48:",
          "940:  yych = *++YYCURSOR;",
          "941:  if (yych == 'N') goto yy74;",
          "942:  goto yy18;",
          "943: yy49:",
          "944:  yych = *++YYCURSOR;",
          "945:  if (yych == 'A') goto yy75;",
          "946:  goto yy18;",
          "947: yy50:",
          "948:  yych = *++YYCURSOR;",
          "949:  if (yych <= '/') goto yy18;",
          "950:  if (yych >= ':') goto yy18;",
          "951: yy51:",
          "952:  ++YYCURSOR;",
          "953:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "954:  yych = *YYCURSOR;",
          "955:  if (yych <= '/') goto yy18;",
          "956:  if (yych <= '9') goto yy51;",
          "957:  if (yych == ';') goto yy76;",
          "958:  goto yy18;",
          "959: yy53:",
          "960:  yych = *++YYCURSOR;",
          "961:  if (yych <= '/') goto yy18;",
          "962:  if (yych >= ':') goto yy18;",
          "963: yy54:",
          "964:  ++YYCURSOR;",
          "965:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "966:  yych = *YYCURSOR;",
          "967:  if (yych <= '/') goto yy18;",
          "968:  if (yych <= '9') goto yy54;",
          "969:  if (yych <= ':') goto yy78;",
          "970:  goto yy18;",
          "971: yy56:",
          "972:  yych = *++YYCURSOR;",
          "973:  if (yych <= '/') goto yy18;",
          "974:  if (yych >= ':') goto yy18;",
          "975: yy57:",
          "976:  ++YYCURSOR;",
          "977:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "978:  yych = *YYCURSOR;",
          "979:  if (yych <= '/') goto yy18;",
          "980:  if (yych <= '9') goto yy57;",
          "981:  if (yych == ';') goto yy79;",
          "982:  goto yy18;",
          "983: yy59:",
          "987: yy60:",
          "988:  ++YYCURSOR;",
          "989:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "990:  yych = *YYCURSOR;",
          "991:  if (yych <= '/') goto yy18;",
          "992:  if (yych <= '9') goto yy60;",
          "993:  if (yych <= ':') goto yy81;",
          "994:  goto yy18;",
          "995: yy62:",
          "996:  yych = *++YYCURSOR;",
          "997:  if (yych == '\"') goto yy82;",
          "998:  goto yy18;",
          "999: yy63:",
          "1000:  ++YYCURSOR;",
          "1001: #line 625 \"ext/standard/var_unserializer.re\"",
          "1002:  {",
          "1003:  zend_long id;",
          "1006:  if (!var_hash) return 0;",
          "1008:  id = parse_iv(start + 2) - 1;",
          "1009:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1010:   return 0;",
          "1011:  }",
          "1013:  zval_ptr_dtor(rval);",
          "1014:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1015:   ZVAL_UNDEF(rval);",
          "1016:   return 1;",
          "1017:  }",
          "1018:  if (Z_ISREF_P(rval_ref)) {",
          "1019:   ZVAL_COPY(rval, rval_ref);",
          "1020:  } else {",
          "1021:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1022:   ZVAL_COPY(rval, rval_ref);",
          "1023:  }",
          "1025:  return 1;",
          "1026: }",
          "1027: #line 1028 \"ext/standard/var_unserializer.c\"",
          "1028: yy65:",
          "1029:  yych = *++YYCURSOR;",
          "1030:  if (yych == '\"') goto yy84;",
          "1031:  goto yy18;",
          "1032: yy66:",
          "1033:  yych = *++YYCURSOR;",
          "1034:  if (yych == '{') goto yy86;",
          "1035:  goto yy18;",
          "1036: yy67:",
          "1037:  ++YYCURSOR;",
          "1038: #line 682 \"ext/standard/var_unserializer.re\"",
          "1039:  {",
          "1041:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1042:  return 1;",
          "1043: }",
          "1044: #line 1045 \"ext/standard/var_unserializer.c\"",
          "1045: yy69:",
          "1051:   if (yych <= '9') goto yy69;",
          "1056:    goto yy73;",
          "1058:    if (yych == 'e') goto yy73;",
          "1062: yy71:",
          "1064: #line 730 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1174:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1175:  return 1;",
          "1176: }",
          "1179:  yych = *++YYCURSOR;",
          "1180:  if (yych <= ',') {",
          "1182:  } else {",
          "1184:   if (yych <= '/') goto yy18;",
          "1186:   goto yy18;",
          "1187:  }",
          "1189:  yych = *++YYCURSOR;",
          "1205:  goto yy18;",
          "1207:  yych = *++YYCURSOR;",
          "1210:  goto yy18;",
          "1235:  ++YYCURSOR;",
          "1237:  {",
          "1284:  if (start[2] == '-' || start[2] == '+') {",
          "1285:   digits--;",
          "",
          "[Removed Lines]",
          "1177: #line 1178 \"ext/standard/var_unserializer.c\"",
          "1178: yy65:",
          "1181:   if (yych != '+') goto yy18;",
          "1183:   if (yych <= '-') goto yy66;",
          "1185:   if (yych <= '9') goto yy67;",
          "1188: yy66:",
          "1190:  if (yych <= ',') {",
          "1191:   if (yych == '+') goto yy69;",
          "1192:   goto yy18;",
          "1193:  } else {",
          "1194:   if (yych <= '-') goto yy69;",
          "1195:   if (yych <= '/') goto yy18;",
          "1196:   if (yych >= ':') goto yy18;",
          "1197:  }",
          "1198: yy67:",
          "1199:  ++YYCURSOR;",
          "1200:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1201:  yych = *YYCURSOR;",
          "1202:  if (yych <= '/') goto yy18;",
          "1203:  if (yych <= '9') goto yy67;",
          "1204:  if (yych == ';') goto yy63;",
          "1206: yy69:",
          "1208:  if (yych <= '/') goto yy18;",
          "1209:  if (yych <= '9') goto yy67;",
          "1211: yy70:",
          "1212:  ++YYCURSOR;",
          "1213:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1214:  yych = *YYCURSOR;",
          "1215:  if (yych <= ';') {",
          "1216:   if (yych <= '/') goto yy18;",
          "1217:   if (yych <= '9') goto yy70;",
          "1218:   if (yych <= ':') goto yy18;",
          "1219:   goto yy63;",
          "1220:  } else {",
          "1221:   if (yych <= 'E') {",
          "1222:    if (yych <= 'D') goto yy18;",
          "1223:    goto yy65;",
          "1224:   } else {",
          "1225:    if (yych == 'e') goto yy65;",
          "1226:    goto yy18;",
          "1227:   }",
          "1228:  }",
          "1229: yy72:",
          "1230:  yych = *++YYCURSOR;",
          "1231:  if (yych != 'F') goto yy18;",
          "1232: yy73:",
          "1233:  yych = *++YYCURSOR;",
          "1234:  if (yych != ';') goto yy18;",
          "1236: #line 691 \"ext/standard/var_unserializer.re\"",
          "1240:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1241:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1242:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1243:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1244:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1245:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1246:  } else {",
          "1247:   ZVAL_NULL(rval);",
          "1248:  }",
          "1250:  return 1;",
          "1251: }",
          "1252: #line 1253 \"ext/standard/var_unserializer.c\"",
          "1253: yy76:",
          "1254:  yych = *++YYCURSOR;",
          "1255:  if (yych == 'N') goto yy73;",
          "1256:  goto yy18;",
          "1257: yy77:",
          "1258:  yych = *++YYCURSOR;",
          "1259:  if (yych <= ',') {",
          "1260:   if (yych != '+') goto yy18;",
          "1261:  } else {",
          "1262:   if (yych <= '-') goto yy78;",
          "1263:   if (yych <= '/') goto yy18;",
          "1264:   if (yych <= '9') goto yy79;",
          "1265:   goto yy18;",
          "1266:  }",
          "1267: yy78:",
          "1268:  yych = *++YYCURSOR;",
          "1269:  if (yych <= '/') goto yy18;",
          "1270:  if (yych >= ':') goto yy18;",
          "1271: yy79:",
          "1272:  ++YYCURSOR;",
          "1273:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1274:  yych = *YYCURSOR;",
          "1275:  if (yych <= '/') goto yy18;",
          "1276:  if (yych <= '9') goto yy79;",
          "1277:  if (yych != ';') goto yy18;",
          "1278:  ++YYCURSOR;",
          "1279: #line 665 \"ext/standard/var_unserializer.re\"",
          "1280:  {",
          "1281: #if SIZEOF_ZEND_LONG == 4",
          "1282:  int digits = YYCURSOR - start - 3;",
          "",
          "[Added Lines]",
          "1073: #line 1074 \"ext/standard/var_unserializer.c\"",
          "1074: yy73:",
          "1077:   if (yych == '+') goto yy88;",
          "1078:   goto yy18;",
          "1080:   if (yych <= '-') goto yy88;",
          "1082:   if (yych <= '9') goto yy89;",
          "1085: yy74:",
          "1087:  if (yych == 'F') goto yy91;",
          "1089: yy75:",
          "1091:  if (yych == 'N') goto yy91;",
          "1093: yy76:",
          "1095: #line 688 \"ext/standard/var_unserializer.re\"",
          "1097: #if SIZEOF_ZEND_LONG == 4",
          "1098:  int digits = YYCURSOR - start - 3;",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1302:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1303:  return 1;",
          "1304: }",
          "1340:  yych = *++YYCURSOR;",
          "1350:  ++YYCURSOR;",
          "1352:  {",
          "1353:  zend_long id;",
          "",
          "[Removed Lines]",
          "1305: #line 1306 \"ext/standard/var_unserializer.c\"",
          "1306: yy83:",
          "1307:  yych = *++YYCURSOR;",
          "1308:  if (yych <= '/') goto yy18;",
          "1309:  if (yych >= '2') goto yy18;",
          "1310:  yych = *++YYCURSOR;",
          "1311:  if (yych != ';') goto yy18;",
          "1312:  ++YYCURSOR;",
          "1313: #line 659 \"ext/standard/var_unserializer.re\"",
          "1314:  {",
          "1316:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1317:  return 1;",
          "1318: }",
          "1319: #line 1320 \"ext/standard/var_unserializer.c\"",
          "1320: yy87:",
          "1321:  ++YYCURSOR;",
          "1322: #line 653 \"ext/standard/var_unserializer.re\"",
          "1323:  {",
          "1325:  ZVAL_NULL(rval);",
          "1326:  return 1;",
          "1327: }",
          "1328: #line 1329 \"ext/standard/var_unserializer.c\"",
          "1329: yy89:",
          "1330:  yych = *++YYCURSOR;",
          "1331:  if (yych <= ',') {",
          "1332:   if (yych != '+') goto yy18;",
          "1333:  } else {",
          "1334:   if (yych <= '-') goto yy90;",
          "1335:   if (yych <= '/') goto yy18;",
          "1336:   if (yych <= '9') goto yy91;",
          "1337:   goto yy18;",
          "1338:  }",
          "1339: yy90:",
          "1341:  if (yych <= '/') goto yy18;",
          "1342:  if (yych >= ':') goto yy18;",
          "1343: yy91:",
          "1344:  ++YYCURSOR;",
          "1345:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1346:  yych = *YYCURSOR;",
          "1347:  if (yych <= '/') goto yy18;",
          "1348:  if (yych <= '9') goto yy91;",
          "1349:  if (yych != ';') goto yy18;",
          "1351: #line 628 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1121: #line 1122 \"ext/standard/var_unserializer.c\"",
          "1122: yy78:",
          "1124:  if (yych == '\"') goto yy92;",
          "1125:  goto yy18;",
          "1126: yy79:",
          "1128: #line 651 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "1374:  return 1;",
          "1375: }",
          "1376: #line 1377 \"ext/standard/var_unserializer.c\"",
          "1378:  yych = *++YYCURSOR;",
          "1379:  if (yych <= ',') {",
          "1381:  } else {",
          "1382:   if (yych <= '-') goto yy96;",
          "1383:   if (yych <= '/') goto yy18;",
          "1386:  }",
          "1392:  ++YYCURSOR;",
          "1393:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1394:  yych = *YYCURSOR;",
          "1395:  if (yych <= '/') goto yy18;",
          "1398:  ++YYCURSOR;",
          "1400:  {",
          "1408:   return 0;",
          "1409:  }",
          "1415:  }",
          "1418:  } else {",
          "1421:  }",
          "1423:  return 1;",
          "1424: }",
          "1426: }",
          "1430:  return 0;",
          "",
          "[Removed Lines]",
          "1377: yy95:",
          "1380:   if (yych != '+') goto yy18;",
          "1384:   if (yych <= '9') goto yy97;",
          "1385:   goto yy18;",
          "1387: yy96:",
          "1388:  yych = *++YYCURSOR;",
          "1389:  if (yych <= '/') goto yy18;",
          "1390:  if (yych >= ':') goto yy18;",
          "1391: yy97:",
          "1396:  if (yych <= '9') goto yy97;",
          "1397:  if (yych != ';') goto yy18;",
          "1399: #line 602 \"ext/standard/var_unserializer.re\"",
          "1401:  zend_long id;",
          "1404:  if (!var_hash) return 0;",
          "1406:  id = parse_iv(start + 2) - 1;",
          "1407:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1411:  zval_ptr_dtor(rval);",
          "1412:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1413:   ZVAL_UNDEF(rval);",
          "1414:   return 1;",
          "1416:  if (Z_ISREF_P(rval_ref)) {",
          "1417:   ZVAL_COPY(rval, rval_ref);",
          "1419:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1420:   ZVAL_COPY(rval, rval_ref);",
          "1425: #line 1426 \"ext/standard/var_unserializer.c\"",
          "1427: #line 977 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1153: #line 1154 \"ext/standard/var_unserializer.c\"",
          "1154: yy81:",
          "1155:  yych = *++YYCURSOR;",
          "1156:  if (yych == '\"') goto yy94;",
          "1157:  goto yy18;",
          "1158: yy82:",
          "1159:  ++YYCURSOR;",
          "1160: #line 840 \"ext/standard/var_unserializer.re\"",
          "1161:  {",
          "1162:  size_t len, len2, len3, maxlen;",
          "1163:  zend_long elements;",
          "1164:  char *str;",
          "1165:  zend_string *class_name;",
          "1166:  zend_class_entry *ce;",
          "1167:  int incomplete_class = 0;",
          "1169:  int custom_object = 0;",
          "1171:  zval user_func;",
          "1172:  zval retval;",
          "1173:  zval args[1];",
          "1175:     if (!var_hash) return 0;",
          "1176:  if (*start == 'C') {",
          "1177:   custom_object = 1;",
          "1178:  }",
          "1180:  len2 = len = parse_uiv(start + 2);",
          "1181:  maxlen = max - YYCURSOR;",
          "1182:  if (maxlen < len || len == 0) {",
          "1184:   return 0;",
          "1185:  }",
          "1187:  str = (char*)YYCURSOR;",
          "1189:  YYCURSOR += len;",
          "1191:  if (*(YYCURSOR) != '\"') {",
          "1193:   return 0;",
          "1194:  }",
          "1195:  if (*(YYCURSOR+1) != ':') {",
          "1197:   return 0;",
          "1198:  }",
          "1200:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1201:  if (len3 != len)",
          "1202:  {",
          "1204:   return 0;",
          "1205:  }",
          "1207:  class_name = zend_string_init(str, len, 0);",
          "1209:  do {",
          "1210:   if(!unserialize_allowed_class(class_name, var_hash)) {",
          "1211:    incomplete_class = 1;",
          "1212:    ce = PHP_IC_ENTRY;",
          "1213:    break;",
          "1214:   }",
          "1217:   BG(serialize_lock)++;",
          "1218:   ce = zend_lookup_class(class_name);",
          "1219:   if (ce) {",
          "1220:    BG(serialize_lock)--;",
          "1221:    if (EG(exception)) {",
          "1222:     zend_string_release(class_name);",
          "1223:     return 0;",
          "1224:    }",
          "1225:    break;",
          "1226:   }",
          "1227:   BG(serialize_lock)--;",
          "1229:   if (EG(exception)) {",
          "1230:    zend_string_release(class_name);",
          "1231:    return 0;",
          "1232:   }",
          "1235:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1236:    incomplete_class = 1;",
          "1237:    ce = PHP_IC_ENTRY;",
          "1238:    break;",
          "1239:   }",
          "1242:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1244:   ZVAL_STR_COPY(&args[0], class_name);",
          "1245:   BG(serialize_lock)++;",
          "1246:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1247:    BG(serialize_lock)--;",
          "1248:    if (EG(exception)) {",
          "1249:     zend_string_release(class_name);",
          "1250:     zval_ptr_dtor(&user_func);",
          "1251:     zval_ptr_dtor(&args[0]);",
          "1252:     return 0;",
          "1253:    }",
          "1254:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1255:    incomplete_class = 1;",
          "1256:    ce = PHP_IC_ENTRY;",
          "1257:    zval_ptr_dtor(&user_func);",
          "1258:    zval_ptr_dtor(&args[0]);",
          "1259:    break;",
          "1260:   }",
          "1261:   BG(serialize_lock)--;",
          "1262:   zval_ptr_dtor(&retval);",
          "1263:   if (EG(exception)) {",
          "1264:    zend_string_release(class_name);",
          "1265:    zval_ptr_dtor(&user_func);",
          "1266:    zval_ptr_dtor(&args[0]);",
          "1267:    return 0;",
          "1268:   }",
          "1271:   BG(serialize_lock)++;",
          "1272:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1273:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1274:    incomplete_class = 1;",
          "1275:    ce = PHP_IC_ENTRY;",
          "1276:   }",
          "1277:   BG(serialize_lock)--;",
          "1279:   zval_ptr_dtor(&user_func);",
          "1280:   zval_ptr_dtor(&args[0]);",
          "1281:   break;",
          "1282:  } while (1);",
          "1286:  if (custom_object) {",
          "1287:   int ret;",
          "1289:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1291:   if (ret && incomplete_class) {",
          "1292:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1293:   }",
          "1294:   zend_string_release(class_name);",
          "1295:   return ret;",
          "1296:  }",
          "1298:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1300:  if (elements < 0) {",
          "1301:     zend_string_release(class_name);",
          "1302:     return 0;",
          "1303:  }",
          "1305:  if (incomplete_class) {",
          "1306:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1307:  }",
          "1308:  zend_string_release(class_name);",
          "1310:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1311: }",
          "1312: #line 1313 \"ext/standard/var_unserializer.c\"",
          "1313: yy84:",
          "1314:  ++YYCURSOR;",
          "1315: #line 771 \"ext/standard/var_unserializer.re\"",
          "1316:  {",
          "1317:  size_t len, maxlen;",
          "1318:  zend_string *str;",
          "1320:  len = parse_uiv(start + 2);",
          "1321:  maxlen = max - YYCURSOR;",
          "1322:  if (maxlen < len) {",
          "1324:   return 0;",
          "1325:  }",
          "1327:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1328:   return 0;",
          "1329:  }",
          "1331:  if (*(YYCURSOR) != '\"') {",
          "1332:   zend_string_free(str);",
          "1334:   return 0;",
          "1335:  }",
          "1337:  if (*(YYCURSOR + 1) != ';') {",
          "1338:   efree(str);",
          "1340:   return 0;",
          "1341:  }",
          "1343:  YYCURSOR += 2;",
          "1346:  ZVAL_STR(rval, str);",
          "1347:  return 1;",
          "1348: }",
          "1349: #line 1350 \"ext/standard/var_unserializer.c\"",
          "1350: yy86:",
          "1351:  ++YYCURSOR;",
          "1352: #line 805 \"ext/standard/var_unserializer.re\"",
          "1353:  {",
          "1354:  zend_long elements = parse_iv(start + 2);",
          "1357:     if (!var_hash) return 0;",
          "1359:  if (elements < 0) {",
          "1360:   return 0;",
          "1361:  }",
          "1363:  array_init_size(rval, elements);",
          "1364:  if (elements) {",
          "1367:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1368:  }",
          "1370:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1371:   return 0;",
          "1372:  }",
          "1374:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1375: }",
          "1377: yy88:",
          "1380:   if (yych == '+') goto yy96;",
          "1381:   goto yy18;",
          "1385:   if (yych >= ':') goto yy18;",
          "1387: yy89:",
          "1392:  if (yych <= '9') goto yy89;",
          "1393:  if (yych == ';') goto yy71;",
          "1394:  goto yy18;",
          "1395: yy91:",
          "1396:  yych = *++YYCURSOR;",
          "1397:  if (yych == ';') goto yy97;",
          "1398:  goto yy18;",
          "1399: yy92:",
          "1401: #line 829 \"ext/standard/var_unserializer.re\"",
          "1403:  long elements;",
          "1404:     if (!var_hash) return 0;",
          "1406:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1407:  if (elements < 0) {",
          "1408:   return 0;",
          "1409:  }",
          "1410:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1411: }",
          "1412: #line 1413 \"ext/standard/var_unserializer.c\"",
          "1413: yy94:",
          "1414:  ++YYCURSOR;",
          "1415: #line 739 \"ext/standard/var_unserializer.re\"",
          "1416:  {",
          "1417:  size_t len, maxlen;",
          "1418:  char *str;",
          "1420:  len = parse_uiv(start + 2);",
          "1421:  maxlen = max - YYCURSOR;",
          "1422:  if (maxlen < len) {",
          "1427:  str = (char*)YYCURSOR;",
          "1429:  YYCURSOR += len;",
          "1431:  if (*(YYCURSOR) != '\"') {",
          "1433:   return 0;",
          "1436:  if (*(YYCURSOR + 1) != ';') {",
          "1438:   return 0;",
          "1439:  }",
          "1441:  YYCURSOR += 2;",
          "1444:  ZVAL_STRINGL(rval, str, len);",
          "1445:  return 1;",
          "1446: }",
          "1447: #line 1448 \"ext/standard/var_unserializer.c\"",
          "1448: yy96:",
          "1449:  yych = *++YYCURSOR;",
          "1450:  if (yych <= '/') goto yy18;",
          "1451:  if (yych <= '9') goto yy89;",
          "1452:  goto yy18;",
          "1453: yy97:",
          "1454:  ++YYCURSOR;",
          "1455: #line 714 \"ext/standard/var_unserializer.re\"",
          "1456:  {",
          "1459:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1460:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1461:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1462:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1463:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1464:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1466:   ZVAL_NULL(rval);",
          "1471: #line 1472 \"ext/standard/var_unserializer.c\"",
          "1473: #line 1000 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "69: #define VAR_ENTRIES_MAX 1024",
          "70: #define VAR_ENTRIES_DBG 0",
          "72: typedef struct {",
          "73:  zval *data[VAR_ENTRIES_MAX];",
          "74:  zend_long used_slots;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "73: #define VAR_WAKEUP_FLAG 1",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "137:         (*var_hashx)->last_dtor = var_hash;",
          "138:     }",
          "139:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "140:     return &var_hash->data[var_hash->used_slots++];",
          "141: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "143:  Z_ACCESS_FLAGS(var_hash->data[var_hash->used_slots]) = 0;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "184:  zend_long i;",
          "185:  var_entries *var_hash = (*var_hashx)->first;",
          "186:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "187: #if VAR_ENTRIES_DBG",
          "188:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "189: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "191:  zend_bool wakeup_failed = 0;",
          "192:  zval wakeup_name;",
          "193:  ZVAL_UNDEF(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "197:  while (var_dtor_hash) {",
          "198:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "199: #if VAR_ENTRIES_DBG",
          "200:    fprintf(stderr, \"var_destroy dtor(%p, %ld)\\n\", var_dtor_hash->data[i], Z_REFCOUNT_P(var_dtor_hash->data[i]));",
          "201: #endif",
          "203:   }",
          "204:   next = var_dtor_hash->next;",
          "205:   efree_size(var_dtor_hash, sizeof(var_dtor_entries));",
          "206:   var_dtor_hash = next;",
          "207:  }",
          "208: }",
          "",
          "[Removed Lines]",
          "202:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "",
          "[Added Lines]",
          "207:    zval *zv = &var_dtor_hash->data[i];",
          "213:    if (Z_ACCESS_FLAGS_P(zv) == VAR_WAKEUP_FLAG) {",
          "214:     if (!wakeup_failed) {",
          "215:      zval retval;",
          "216:      if (Z_ISUNDEF(wakeup_name)) {",
          "217:       ZVAL_STRINGL(&wakeup_name, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "218:      }",
          "220:      BG(serialize_lock)++;",
          "221:      if (call_user_function_ex(CG(function_table), zv, &wakeup_name, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "222:       wakeup_failed = 1;",
          "223:       GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "224:      }",
          "225:      BG(serialize_lock)--;",
          "227:      zval_ptr_dtor(&retval);",
          "228:     } else {",
          "229:      GC_FLAGS(Z_OBJ_P(zv)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "230:     }",
          "231:    }",
          "233:    zval_ptr_dtor(zv);",
          "240:  zval_ptr_dtor(&wakeup_name);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "508: #endif",
          "509: static inline int object_common2(UNSERIALIZE_PARAMETER, zend_long elements)",
          "510: {",
          "513:  HashTable *ht;",
          "514:  zend_bool has_wakeup;",
          "",
          "[Removed Lines]",
          "511:  zval retval;",
          "512:  zval fname;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "533:  ZVAL_DEREF(rval);",
          "534:  if (has_wakeup) {",
          "547:  }",
          "549:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "",
          "[Removed Lines]",
          "535:   ZVAL_STRINGL(&fname, \"__wakeup\", sizeof(\"__wakeup\") - 1);",
          "536:   BG(serialize_lock)++;",
          "537:   if (call_user_function_ex(CG(function_table), rval, &fname, &retval, 0, 0, 1, NULL) == FAILURE || Z_ISUNDEF(retval)) {",
          "538:    GC_FLAGS(Z_OBJ_P(rval)) |= IS_OBJ_DESTRUCTOR_CALLED;",
          "539:   }",
          "540:   BG(serialize_lock)--;",
          "541:   zval_dtor(&fname);",
          "542:   zval_dtor(&retval);",
          "543:  }",
          "545:  if (EG(exception)) {",
          "546:   return 0;",
          "",
          "[Added Lines]",
          "567:   zval *wakeup_var = var_tmp_var(var_hash);",
          "568:   ZVAL_COPY(wakeup_var, rval);",
          "569:   Z_ACCESS_FLAGS_P(wakeup_var) = VAR_WAKEUP_FLAG;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "feeb2fba93a451c467ec70963995ca6371b3a568",
      "candidate_info": {
        "commit_hash": "feeb2fba93a451c467ec70963995ca6371b3a568",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/feeb2fba93a451c467ec70963995ca6371b3a568",
        "files": [
          "Zend/zend_exceptions.c",
          "ext/date/tests/bug53437_var5.phpt",
          "ext/spl/spl_array.c",
          "ext/spl/spl_dllist.c",
          "ext/spl/spl_observer.c",
          "ext/standard/php_var.h",
          "ext/standard/tests/serialize/bug69793.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "fix merge",
        "before_after_code_files": [
          "Zend/zend_exceptions.c||Zend/zend_exceptions.c",
          "ext/date/tests/bug53437_var5.phpt||ext/date/tests/bug53437_var5.phpt",
          "ext/spl/spl_array.c||ext/spl/spl_array.c",
          "ext/spl/spl_dllist.c||ext/spl/spl_dllist.c",
          "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
          "ext/standard/php_var.h||ext/standard/php_var.h",
          "ext/standard/tests/serialize/bug69793.phpt||ext/standard/tests/serialize/bug69793.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "Zend/zend_exceptions.c||Zend/zend_exceptions.c": [
          "File: Zend/zend_exceptions.c -> Zend/zend_exceptions.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "284: #define CHECK_EXC_TYPE(name, type) \\",
          "287:   zval tmp; \\",
          "288:   ZVAL_STRINGL(&tmp, name, sizeof(name) - 1); \\",
          "289:   Z_OBJ_HANDLER_P(object, unset_property)(object, &tmp, NULL); \\",
          "",
          "[Removed Lines]",
          "285:  if(zend_read_property(i_get_exception_base(object), (object), name, sizeof(name) - 1, 1, &value) != &EG(uninitialized_zval) \\",
          "286:   && Z_TYPE(value) != type) { \\",
          "",
          "[Added Lines]",
          "285:  ZVAL_UNDEF(&value); \\",
          "286:  pvalue = zend_read_property(i_get_exception_base(object), (object), name, sizeof(name) - 1, 1, &value); \\",
          "287:  if(Z_TYPE_P(pvalue) != IS_UNDEF && Z_TYPE_P(pvalue) != type) { \\",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "293: ZEND_METHOD(exception, __wakeup)",
          "294: {",
          "296:  zval *object = getThis();",
          "297:  CHECK_EXC_TYPE(\"message\", IS_STRING);",
          "298:  CHECK_EXC_TYPE(\"string\", IS_STRING);",
          "",
          "[Removed Lines]",
          "295:  zval value;",
          "",
          "[Added Lines]",
          "296:  zval value, *pvalue;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "711:  exception = getThis();",
          "712:  ZVAL_STRINGL(&fname, \"gettraceasstring\", sizeof(\"gettraceasstring\")-1);",
          "715:   zend_string *prev_str = str;",
          "716:   zend_string *message = zval_get_string(GET_PROPERTY(exception, \"message\"));",
          "717:   zend_string *file = zval_get_string(GET_PROPERTY(exception, \"file\"));",
          "",
          "[Removed Lines]",
          "714:  while (exception && Z_TYPE_P(exception) == IS_OBJECT) {",
          "",
          "[Added Lines]",
          "715:  while (exception && Z_TYPE_P(exception) == IS_OBJECT && instanceof_function(Z_OBJCE_P(exception), zend_ce_throwable)) {",
          "",
          "---------------"
        ],
        "ext/date/tests/bug53437_var5.phpt||ext/date/tests/bug53437_var5.phpt": [
          "File: ext/date/tests/bug53437_var5.phpt -> ext/date/tests/bug53437_var5.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: --EXPECTF--",
          "15: object(DateInterval)#%d (15) {",
          "16:   [\"y\"]=>",
          "18:   [\"m\"]=>",
          "20:   [\"d\"]=>",
          "22:   [\"h\"]=>",
          "24:   [\"i\"]=>",
          "26:   [\"s\"]=>",
          "28:   [\"weekday\"]=>",
          "29:   int(10)",
          "30:   [\"weekday_behavior\"]=>",
          "",
          "[Removed Lines]",
          "17:   int(-1)",
          "19:   int(-1)",
          "21:   int(-1)",
          "23:   int(-1)",
          "25:   int(-1)",
          "27:   int(-1)",
          "",
          "[Added Lines]",
          "17:   int(2)",
          "19:   int(0)",
          "21:   int(0)",
          "23:   int(6)",
          "25:   int(8)",
          "27:   int(0)",
          "",
          "---------------"
        ],
        "ext/spl/spl_array.c||ext/spl/spl_array.c": [
          "File: ext/spl/spl_array.c -> ext/spl/spl_array.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1710:  size_t buf_len;",
          "1711:  const unsigned char *p, *s;",
          "1712:  php_unserialize_data_t var_hash;",
          "1714:  HashTable *aht;",
          "1715:  zend_long flags;",
          "",
          "[Removed Lines]",
          "1713:  zval members, zflags;",
          "",
          "[Added Lines]",
          "1713:  zval *members, *zflags;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1737:  }",
          "1738:  ++p;",
          "1741:   goto outexcept;",
          "1742:  }",
          "",
          "[Removed Lines]",
          "1740:  if (!php_var_unserialize(&zflags, &p, s + buf_len, &var_hash) || Z_TYPE(zflags) != IS_LONG) {",
          "1744:  var_push_dtor(&var_hash, &zflags);",
          "1746:  flags = Z_LVAL(zflags);",
          "",
          "[Added Lines]",
          "1740:  zflags = var_tmp_var(&var_hash);",
          "1741:  if (!php_var_unserialize(zflags, &p, s + buf_len, &var_hash) || Z_TYPE_P(zflags) != IS_LONG) {",
          "1746:  flags = Z_LVAL_P(zflags);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1777:  }",
          "1778:  ++p;",
          "1783:   goto outexcept;",
          "1784:  }",
          "1793:  PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1794:  return;",
          "",
          "[Removed Lines]",
          "1780:  ZVAL_UNDEF(&members);",
          "1781:  if (!php_var_unserialize(&members, &p, s + buf_len, &var_hash) || Z_TYPE(members) != IS_ARRAY) {",
          "1782:   zval_ptr_dtor(&members);",
          "1786:  var_push_dtor(&var_hash, &members);",
          "1788:  object_properties_load(&intern->std, Z_ARRVAL(members));",
          "1789:  zval_ptr_dtor(&members);",
          "",
          "[Added Lines]",
          "1780:  members = var_tmp_var(&var_hash);",
          "1781:  if (!php_var_unserialize(members, &p, s + buf_len, &var_hash) || Z_TYPE_P(members) != IS_ARRAY) {",
          "1786:  object_properties_load(&intern->std, Z_ARRVAL_P(members));",
          "",
          "---------------"
        ],
        "ext/spl/spl_dllist.c||ext/spl/spl_dllist.c": [
          "File: ext/spl/spl_dllist.c -> ext/spl/spl_dllist.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1178: SPL_METHOD(SplDoublyLinkedList, unserialize)",
          "1179: {",
          "1180:  spl_dllist_object *intern = Z_SPLDLLIST_P(getThis());",
          "1182:  char *buf;",
          "1183:  size_t buf_len;",
          "1184:  const unsigned char *p, *s;",
          "",
          "[Removed Lines]",
          "1181:  zval flags, elem;",
          "",
          "[Added Lines]",
          "1181:  zval *flags, *elem;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1196:  PHP_VAR_UNSERIALIZE_INIT(var_hash);",
          "1200:   goto error;",
          "1201:  }",
          "1212:  while(*p == ':') {",
          "1213:   ++p;",
          "1215:    goto error;",
          "1216:   }",
          "1220:  }",
          "1222:  if (*p != '\\0') {",
          "",
          "[Removed Lines]",
          "1199:  if (!php_var_unserialize(&flags, &p, s + buf_len, &var_hash)) {",
          "1203:  if (Z_TYPE(flags) != IS_LONG) {",
          "1204:   zval_ptr_dtor(&flags);",
          "1205:   goto error;",
          "1206:  }",
          "1208:  intern->flags = (int)Z_LVAL(flags);",
          "1209:  zval_ptr_dtor(&flags);",
          "1214:   if (!php_var_unserialize(&elem, &p, s + buf_len, &var_hash)) {",
          "1218:   spl_ptr_llist_push(intern->llist, &elem);",
          "1219:   zval_ptr_dtor(&elem);",
          "",
          "[Added Lines]",
          "1199:  flags = var_tmp_var(&var_hash);",
          "1200:  if (!php_var_unserialize(flags, &p, s + buf_len, &var_hash) || Z_TYPE_P(flags) != IS_LONG) {",
          "1204:  intern->flags = (int)Z_LVAL_P(flags);",
          "1209:   elem = var_tmp_var(&var_hash);",
          "1210:   if (!php_var_unserialize(elem, &p, s + buf_len, &var_hash)) {",
          "1214:   spl_ptr_llist_push(intern->llist, elem);",
          "",
          "---------------"
        ],
        "ext/spl/spl_observer.c||ext/spl/spl_observer.c": [
          "File: ext/spl/spl_observer.c -> ext/spl/spl_observer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "780:  size_t buf_len;",
          "781:  const unsigned char *p, *s;",
          "782:  php_unserialize_data_t var_hash;",
          "784:  spl_SplObjectStorageElement *element;",
          "785:  zend_long count;",
          "",
          "[Removed Lines]",
          "783:  zval entry, pmembers, pcount, inf;",
          "",
          "[Added Lines]",
          "783:  zval entry, inf;",
          "784:  zval *pcount, *pmembers;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "801:  }",
          "802:  ++p;",
          "809:   goto outexcept;",
          "810:  }",
          "816:  while (count-- > 0) {",
          "817:   spl_SplObjectStorageElement *pelement;",
          "",
          "[Removed Lines]",
          "804:  if (!php_var_unserialize(&pcount, &p, s + buf_len, &var_hash)) {",
          "805:   goto outexcept;",
          "806:  }",
          "807:  if (Z_TYPE(pcount) != IS_LONG) {",
          "808:   zval_ptr_dtor(&pcount);",
          "812:  var_push_dtor(&var_hash, &pcount);",
          "814:  count = Z_LVAL(pcount);",
          "",
          "[Added Lines]",
          "805:  pcount = var_tmp_var(&var_hash);",
          "806:  if (!php_var_unserialize(pcount, &p, s + buf_len, &var_hash) || Z_TYPE_P(pcount) != IS_LONG) {",
          "811:  count = Z_LVAL_P(pcount);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "838:     zval_ptr_dtor(&entry);",
          "839:     goto outexcept;",
          "840:    }",
          "841:   }",
          "843:   hash = spl_object_storage_get_hash(intern, getThis(), &entry);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "838:   } else {",
          "839:    ZVAL_UNDEF(&inf);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "856:     var_push_dtor(&var_hash, &pelement->obj);",
          "857:    }",
          "858:   }",
          "860:   var_replace(&var_hash, &entry, &element->obj);",
          "861:   var_replace(&var_hash, &inf, &element->inf);",
          "862:   zval_ptr_dtor(&entry);",
          "",
          "[Removed Lines]",
          "859:   element = spl_object_storage_attach(intern, getThis(), &entry, &inf);",
          "",
          "[Added Lines]",
          "858:   element = spl_object_storage_attach(intern, getThis(), &entry, Z_ISUNDEF(inf)?NULL:&inf);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "874:  }",
          "875:  ++p;",
          "880:   goto outexcept;",
          "881:  }",
          "885:  if (!intern->std.properties) {",
          "886:   rebuild_object_properties(&intern->std);",
          "887:  }",
          "891:  PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "892:  return;",
          "",
          "[Removed Lines]",
          "877:  ZVAL_UNDEF(&pmembers);",
          "878:  if (!php_var_unserialize(&pmembers, &p, s + buf_len, &var_hash) || Z_TYPE(pmembers) != IS_ARRAY) {",
          "879:   zval_ptr_dtor(&pmembers);",
          "883:  var_push_dtor(&var_hash, &pmembers);",
          "888:  zend_hash_copy(intern->std.properties, Z_ARRVAL(pmembers), (copy_ctor_func_t) zval_add_ref);",
          "889:  zval_ptr_dtor(&pmembers);",
          "",
          "[Added Lines]",
          "876:  pmembers = var_tmp_var(&var_hash);",
          "877:  if (!php_var_unserialize(pmembers, &p, s + buf_len, &var_hash) || Z_TYPE_P(pmembers) != IS_ARRAY) {",
          "885:  zend_hash_copy(intern->std.properties, Z_ARRVAL_P(pmembers), (copy_ctor_func_t) zval_add_ref);",
          "",
          "---------------"
        ],
        "ext/standard/php_var.h||ext/standard/php_var.h": [
          "File: ext/standard/php_var.h -> ext/standard/php_var.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "118: PHPAPI void var_replace(php_unserialize_data_t *var_hash, zval *ozval, zval *nzval);",
          "119: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hash, zval *val);",
          "121: PHPAPI void var_destroy(php_unserialize_data_t *var_hash);",
          "",
          "[Removed Lines]",
          "120: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval);",
          "",
          "[Added Lines]",
          "120: PHPAPI zval *var_tmp_var(php_unserialize_data_t *var_hashx);",
          "",
          "---------------"
        ],
        "ext/standard/tests/serialize/bug69793.phpt||ext/standard/tests/serialize/bug69793.phpt": [
          "File: ext/standard/tests/serialize/bug69793.phpt -> ext/standard/tests/serialize/bug69793.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "12: Notice: Undefined property: Exception::$file in %s/bug69793.php on line %d",
          "14: Notice: Undefined property: Exception::$previous in %s/bug69793.php on line %d",
          "16: Stack trace:",
          "17: #0 {main}\"",
          "",
          "[Removed Lines]",
          "15: string(53) \"exception 'Exception' in :1337",
          "",
          "[Added Lines]",
          "15: string(41) \"Exception in :1337",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "67: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "68: {",
          "96: }",
          "",
          "[Removed Lines]",
          "69:  var_dtor_entries *var_hash;",
          "71:  if (!var_hashx || !*var_hashx) {",
          "72:   return;",
          "73:  }",
          "75:  var_hash = (*var_hashx)->last_dtor;",
          "76: #if VAR_ENTRIES_DBG",
          "77:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "78: #endif",
          "80:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "81:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "82:   var_hash->used_slots = 0;",
          "83:   var_hash->next = 0;",
          "85:   if (!(*var_hashx)->first_dtor) {",
          "86:    (*var_hashx)->first_dtor = var_hash;",
          "87:   } else {",
          "88:    ((var_dtor_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "89:   }",
          "91:   (*var_hashx)->last_dtor = var_hash;",
          "92:  }",
          "94:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "95:  var_hash->used_slots++;",
          "",
          "[Added Lines]",
          "69:  zval *tmp_var = var_tmp_var(var_hashx);",
          "70:     if (!tmp_var) {",
          "71:         return;",
          "72:     }",
          "73:  ZVAL_COPY(tmp_var, rval);",
          "74: }",
          "76: PHPAPI zval *var_tmp_var(php_unserialize_data_t *var_hashx)",
          "77: {",
          "78:     var_dtor_entries *var_hash;",
          "80:     if (!var_hashx || !*var_hashx) {",
          "81:         return NULL;",
          "82:     }",
          "84:     var_hash = (*var_hashx)->last_dtor;",
          "85:     if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "86:         var_hash = emalloc(sizeof(var_dtor_entries));",
          "87:         var_hash->used_slots = 0;",
          "88:         var_hash->next = 0;",
          "90:         if (!(*var_hashx)->first_dtor) {",
          "91:             (*var_hashx)->first_dtor = var_hash;",
          "92:         } else {",
          "93:             ((var_dtor_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "94:         }",
          "96:         (*var_hashx)->last_dtor = var_hash;",
          "97:     }",
          "98:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "99:     return &var_hash->data[var_hash->used_slots++];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "259: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "262: #line 267 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "266: #line 271 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "524:  start = cursor;",
          "528: {",
          "529:  YYCTYPE yych;",
          "530:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "527: #line 528 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "531: #line 532 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "584:  yych = *(YYMARKER = ++YYCURSOR);",
          "585:  if (yych == ':') goto yy95;",
          "586: yy3:",
          "588:  { return 0; }",
          "590: yy4:",
          "591:  yych = *(YYMARKER = ++YYCURSOR);",
          "592:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "587: #line 875 \"ext/standard/var_unserializer.re\"",
          "589: #line 590 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "591: #line 879 \"ext/standard/var_unserializer.re\"",
          "593: #line 594 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "629:  goto yy3;",
          "630: yy14:",
          "631:  ++YYCURSOR;",
          "633:  {",
          "635:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "637: }",
          "639: yy16:",
          "640:  yych = *++YYCURSOR;",
          "641:  goto yy3;",
          "",
          "[Removed Lines]",
          "632: #line 869 \"ext/standard/var_unserializer.re\"",
          "638: #line 639 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "636: #line 873 \"ext/standard/var_unserializer.re\"",
          "642: #line 643 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "661:  if (yybm[0+yych] & 128) {",
          "662:   goto yy20;",
          "663:  }",
          "665:  yych = *++YYCURSOR;",
          "666:  if (yych != '\"') goto yy18;",
          "667:  ++YYCURSOR;",
          "669:  {",
          "670:  size_t len, len2, len3, maxlen;",
          "671:  zend_long elements;",
          "",
          "[Removed Lines]",
          "664:  if (yych != ':') goto yy18;",
          "668: #line 724 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "668:  if (yych <= '/') goto yy18;",
          "669:  if (yych >= ';') goto yy18;",
          "673: #line 728 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "811:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "812: }",
          "814: yy25:",
          "815:  yych = *++YYCURSOR;",
          "816:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "813: #line 814 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "818: #line 819 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "835:  yych = *++YYCURSOR;",
          "836:  if (yych != '\"') goto yy18;",
          "837:  ++YYCURSOR;",
          "839:  {",
          "",
          "[Removed Lines]",
          "838: #line 716 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "843: #line 720 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "843:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "844:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "845: }",
          "847: yy32:",
          "848:  yych = *++YYCURSOR;",
          "849:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "846: #line 847 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "851: #line 852 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "864:  yych = *++YYCURSOR;",
          "865:  if (yych != '{') goto yy18;",
          "866:  ++YYCURSOR;",
          "868:  {",
          "869:  zend_long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "867: #line 695 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "872: #line 699 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "886:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "887: }",
          "889: yy39:",
          "890:  yych = *++YYCURSOR;",
          "891:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "888: #line 889 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "893: #line 894 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "906:  yych = *++YYCURSOR;",
          "907:  if (yych != '\"') goto yy18;",
          "908:  ++YYCURSOR;",
          "910:  {",
          "911:  size_t len, maxlen;",
          "912:  zend_string *str;",
          "",
          "[Removed Lines]",
          "909: #line 667 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "914: #line 671 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "934:  ZVAL_STR(rval, str);",
          "935:  return 1;",
          "936: }",
          "938: yy46:",
          "939:  yych = *++YYCURSOR;",
          "940:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "937: #line 938 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "942: #line 943 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "955:  yych = *++YYCURSOR;",
          "956:  if (yych != '\"') goto yy18;",
          "957:  ++YYCURSOR;",
          "959:  {",
          "960:  size_t len, maxlen;",
          "961:  char *str;",
          "",
          "[Removed Lines]",
          "958: #line 640 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "963: #line 644 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "982:  ZVAL_STRINGL(rval, str, len);",
          "983:  return 1;",
          "984: }",
          "986: yy53:",
          "987:  yych = *++YYCURSOR;",
          "988:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "985: #line 986 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "990: #line 991 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1070:  }",
          "1071: yy63:",
          "1072:  ++YYCURSOR;",
          "1074:  {",
          "1075: #if SIZEOF_ZEND_LONG == 4",
          "1076: use_double:",
          "",
          "[Removed Lines]",
          "1073: #line 631 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1078: #line 635 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1079:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1080:  return 1;",
          "1081: }",
          "1083: yy65:",
          "1084:  yych = *++YYCURSOR;",
          "1085:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1082: #line 1083 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1087: #line 1088 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1138:  yych = *++YYCURSOR;",
          "1139:  if (yych != ';') goto yy18;",
          "1140:  ++YYCURSOR;",
          "1142:  {",
          "",
          "[Removed Lines]",
          "1141: #line 615 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1146: #line 619 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1155:  return 1;",
          "1156: }",
          "1158: yy76:",
          "1159:  yych = *++YYCURSOR;",
          "1160:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1157: #line 1158 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1162: #line 1163 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1181:  if (yych <= '9') goto yy79;",
          "1182:  if (yych != ';') goto yy18;",
          "1183:  ++YYCURSOR;",
          "1185:  {",
          "1186: #if SIZEOF_ZEND_LONG == 4",
          "1187:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1184: #line 589 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1189: #line 593 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1207:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1208:  return 1;",
          "1209: }",
          "1211: yy83:",
          "1212:  yych = *++YYCURSOR;",
          "1213:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1215: #line 1216 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1215:  yych = *++YYCURSOR;",
          "1216:  if (yych != ';') goto yy18;",
          "1217:  ++YYCURSOR;",
          "1219:  {",
          "1221:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1222:  return 1;",
          "1223: }",
          "1225: yy87:",
          "1226:  ++YYCURSOR;",
          "1228:  {",
          "1230:  ZVAL_NULL(rval);",
          "1231:  return 1;",
          "1232: }",
          "1234: yy89:",
          "1235:  yych = *++YYCURSOR;",
          "1236:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1218: #line 583 \"ext/standard/var_unserializer.re\"",
          "1224: #line 1225 \"ext/standard/var_unserializer.c\"",
          "1227: #line 577 \"ext/standard/var_unserializer.re\"",
          "1233: #line 1234 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1223: #line 587 \"ext/standard/var_unserializer.re\"",
          "1229: #line 1230 \"ext/standard/var_unserializer.c\"",
          "1232: #line 581 \"ext/standard/var_unserializer.re\"",
          "1238: #line 1239 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1253:  if (yych <= '9') goto yy91;",
          "1254:  if (yych != ';') goto yy18;",
          "1255:  ++YYCURSOR;",
          "1257:  {",
          "1258:  zend_long id;",
          "",
          "[Removed Lines]",
          "1256: #line 554 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1261: #line 558 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1277:  return 1;",
          "1278: }",
          "1280: yy95:",
          "1281:  yych = *++YYCURSOR;",
          "1282:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1279: #line 1280 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1284: #line 1285 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1299:  if (yych <= '9') goto yy97;",
          "1300:  if (yych != ';') goto yy18;",
          "1301:  ++YYCURSOR;",
          "1303:  {",
          "1304:  zend_long id;",
          "",
          "[Removed Lines]",
          "1302: #line 532 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1307: #line 536 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1322:  return 1;",
          "1323: }",
          "1325: }",
          "1329:  return 0;",
          "",
          "[Removed Lines]",
          "1324: #line 1325 \"ext/standard/var_unserializer.c\"",
          "1326: #line 877 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1329: #line 1330 \"ext/standard/var_unserializer.c\"",
          "1331: #line 881 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "65: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "66: {",
          "94: }",
          "",
          "[Removed Lines]",
          "67:  var_dtor_entries *var_hash;",
          "69:  if (!var_hashx || !*var_hashx) {",
          "70:   return;",
          "71:  }",
          "73:  var_hash = (*var_hashx)->last_dtor;",
          "74: #if VAR_ENTRIES_DBG",
          "75:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "76: #endif",
          "78:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "79:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "80:   var_hash->used_slots = 0;",
          "81:   var_hash->next = 0;",
          "83:   if (!(*var_hashx)->first_dtor) {",
          "84:    (*var_hashx)->first_dtor = var_hash;",
          "85:   } else {",
          "86:    ((var_dtor_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "87:   }",
          "89:   (*var_hashx)->last_dtor = var_hash;",
          "90:  }",
          "92:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "93:  var_hash->used_slots++;",
          "",
          "[Added Lines]",
          "67:  zval *tmp_var = var_tmp_var(var_hashx);",
          "68:     if (!tmp_var) {",
          "69:         return;",
          "70:     }",
          "71:  ZVAL_COPY(tmp_var, rval);",
          "72: }",
          "74: PHPAPI zval *var_tmp_var(php_unserialize_data_t *var_hashx)",
          "75: {",
          "76:     var_dtor_entries *var_hash;",
          "78:     if (!var_hashx || !*var_hashx) {",
          "79:         return NULL;",
          "80:     }",
          "82:     var_hash = (*var_hashx)->last_dtor;",
          "83:     if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "84:         var_hash = emalloc(sizeof(var_dtor_entries));",
          "85:         var_hash->used_slots = 0;",
          "86:         var_hash->next = 0;",
          "88:         if (!(*var_hashx)->first_dtor) {",
          "89:             (*var_hashx)->first_dtor = var_hash;",
          "90:         } else {",
          "91:             ((var_dtor_entries *) (*var_hashx)->last_dtor)->next = var_hash;",
          "92:         }",
          "94:         (*var_hashx)->last_dtor = var_hash;",
          "95:     }",
          "96:     ZVAL_UNDEF(&var_hash->data[var_hash->used_slots]);",
          "97:     return &var_hash->data[var_hash->used_slots++];",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9f560baef5eacbe3fdb6a23a2d4e1996a30a2d2c",
      "candidate_info": {
        "commit_hash": "9f560baef5eacbe3fdb6a23a2d4e1996a30a2d2c",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/9f560baef5eacbe3fdb6a23a2d4e1996a30a2d2c",
        "files": [
          "NEWS",
          "ext/standard/tests/serialize/bug70213.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Merge branch 'PHP-5.6' into PHP-7.0",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70213.phpt||ext/standard/tests/serialize/bug70213.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70213.phpt||ext/standard/tests/serialize/bug70213.phpt": [
          "File: ext/standard/tests/serialize/bug70213.phpt -> ext/standard/tests/serialize/bug70213.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70213: Unserialize context shared on double class lookup",
          "3: --FILE--",
          "4: <?php",
          "6: ini_set('unserialize_callback_func', 'evil');",
          "8: function evil() {",
          "9:  function __autoload($arg) {",
          "10:         var_dump(unserialize('R:1;'));",
          "11:     }",
          "12: }",
          "14: var_dump(unserialize('a:2:{i:0;i:42;i:1;O:4:\"evil\":0:{}}'));",
          "16: ?>",
          "17: --EXPECTF--",
          "18: Notice: unserialize(): Error at offset 4 of 4 bytes in %s on line %d",
          "19: bool(false)",
          "21: Warning: unserialize(): Function evil() hasn't defined the class it was called for in %s on line %d",
          "22: array(2) {",
          "23:   [0]=>",
          "24:   int(42)",
          "25:   [1]=>",
          "26:   object(__PHP_Incomplete_Class)#1 (1) {",
          "27:     [\"__PHP_Incomplete_Class_Name\"]=>",
          "28:     string(4) \"evil\"",
          "29:   }",
          "30: }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "587:     0,   0,   0,   0,   0,   0,   0,   0,",
          "588:     0,   0,   0,   0,   0,   0,   0,   0,",
          "589:  };",
          "591:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "592:  yych = *YYCURSOR;",
          "593:  switch (yych) {",
          "594:  case 'C':",
          "596:  case 'N': goto yy5;",
          "603:  case 'o': goto yy12;",
          "608:  }",
          "609: yy2:",
          "612: yy3:",
          "614:  { return 0; }",
          "616: yy4:",
          "617:  yych = *(YYMARKER = ++YYCURSOR);",
          "619:  goto yy3;",
          "620: yy5:",
          "621:  yych = *++YYCURSOR;",
          "623:  goto yy3;",
          "624: yy6:",
          "625:  yych = *(YYMARKER = ++YYCURSOR);",
          "627:  goto yy3;",
          "628: yy7:",
          "629:  yych = *(YYMARKER = ++YYCURSOR);",
          "631:  goto yy3;",
          "632: yy8:",
          "633:  yych = *(YYMARKER = ++YYCURSOR);",
          "635:  goto yy3;",
          "636: yy9:",
          "637:  yych = *(YYMARKER = ++YYCURSOR);",
          "639:  goto yy3;",
          "640: yy10:",
          "641:  yych = *(YYMARKER = ++YYCURSOR);",
          "643:  goto yy3;",
          "644: yy11:",
          "645:  yych = *(YYMARKER = ++YYCURSOR);",
          "647:  goto yy3;",
          "648: yy12:",
          "649:  yych = *(YYMARKER = ++YYCURSOR);",
          "651:  goto yy3;",
          "652: yy13:",
          "653:  yych = *(YYMARKER = ++YYCURSOR);",
          "655:  goto yy3;",
          "656: yy14:",
          "657:  ++YYCURSOR;",
          "659:  {",
          "661:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "663: }",
          "668: yy17:",
          "669:  yych = *++YYCURSOR;",
          "670:  if (yybm[0+yych] & 128) {",
          "672:  }",
          "674: yy18:",
          "675:  YYCURSOR = YYMARKER;",
          "676:  goto yy3;",
          "677: yy19:",
          "678:  yych = *++YYCURSOR;",
          "681:  }",
          "682:  goto yy18;",
          "690:  if (yych <= '/') goto yy18;",
          "692:  yych = *++YYCURSOR;",
          "810:   }",
          "826:   }",
          "829:  }",
          "835:  }",
          "842:  yych = *++YYCURSOR;",
          "843:  if (yych <= ',') {",
          "845:  } else {",
          "847:   if (yych <= '/') goto yy18;",
          "849:   goto yy18;",
          "850:  }",
          "852:  yych = *++YYCURSOR;",
          "853:  if (yych <= '/') goto yy18;",
          "856:  ++YYCURSOR;",
          "857:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "858:  yych = *YYCURSOR;",
          "859:  if (yych <= '/') goto yy18;",
          "862:  yych = *++YYCURSOR;",
          "864:  ++YYCURSOR;",
          "876:  if (yych <= '/') goto yy18;",
          "877:  if (yych <= '9') goto yy34;",
          "878:  goto yy18;",
          "880:  yych = *++YYCURSOR;",
          "881:  if (yych <= '/') goto yy18;",
          "882:  if (yych >= ':') goto yy18;",
          "884:  ++YYCURSOR;",
          "885:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "886:  yych = *YYCURSOR;",
          "887:  if (yych <= '/') goto yy18;",
          "890:  yych = *++YYCURSOR;",
          "929:  ++YYCURSOR;",
          "930:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "931:  yych = *YYCURSOR;",
          "932:  if (yych <= '/') goto yy18;",
          "974:  yych = *++YYCURSOR;",
          "978:  goto yy18;",
          "980:  yych = *++YYCURSOR;",
          "981:  if (yych <= '/') goto yy18;",
          "1048:  goto yy18;",
          "1050:  yych = *++YYCURSOR;",
          "1051:  if (yych <= '/') {",
          "1054:  } else {",
          "1057:  }",
          "1059:  yych = *++YYCURSOR;",
          "1065:  if (yych <= '/') goto yy18;",
          "1068:  ++YYCURSOR;",
          "1069:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1070:  yych = *YYCURSOR;",
          "1071:  if (yych <= ':') {",
          "1072:   if (yych <= '.') {",
          "1073:    if (yych <= '-') goto yy18;",
          "1075:   } else {",
          "1076:    if (yych <= '/') goto yy18;",
          "1078:    goto yy18;",
          "1079:   }",
          "1080:  } else {",
          "1081:   if (yych <= 'E') {",
          "1083:    if (yych <= 'D') goto yy18;",
          "1085:   } else {",
          "1087:    goto yy18;",
          "1088:   }",
          "1089:  }",
          "1091:  yych = *++YYCURSOR;",
          "1092:  if (yych <= '/') goto yy18;",
          "1093:  if (yych >= ':') goto yy18;",
          "1095:  ++YYCURSOR;",
          "1097:  yych = *YYCURSOR;",
          "1111: yy63:",
          "1112:  ++YYCURSOR;",
          "1114:  {",
          "1120:  return 1;",
          "1121: }",
          "1123: yy65:",
          "1124:  yych = *++YYCURSOR;",
          "1133: yy66:",
          "1134:  yych = *++YYCURSOR;",
          "1143: yy67:",
          "1144:  ++YYCURSOR;",
          "1151: yy69:",
          "1157:  ++YYCURSOR;",
          "1158:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1159:  yych = *YYCURSOR;",
          "1160:  if (yych <= ';') {",
          "1161:   if (yych <= '/') goto yy18;",
          "1163:   if (yych <= ':') goto yy18;",
          "1165:  } else {",
          "1166:   if (yych <= 'E') {",
          "1167:    if (yych <= 'D') goto yy18;",
          "1169:   } else {",
          "1171:    goto yy18;",
          "1172:   }",
          "1173:  }",
          "1180:  ++YYCURSOR;",
          "1182:  {",
          "1195:  return 1;",
          "1196: }",
          "1203:  yych = *++YYCURSOR;",
          "1204:  if (yych <= ',') {",
          "1206:  } else {",
          "1208:   if (yych <= '/') goto yy18;",
          "1210:   goto yy18;",
          "1211:  }",
          "1213:  yych = *++YYCURSOR;",
          "1223:  ++YYCURSOR;",
          "1225:  {",
          "1226: #if SIZEOF_ZEND_LONG == 4",
          "1227:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "595:  case 'O': goto yy13;",
          "597:  case 'R': goto yy2;",
          "598:  case 'S': goto yy10;",
          "599:  case 'a': goto yy11;",
          "600:  case 'b': goto yy6;",
          "601:  case 'd': goto yy8;",
          "602:  case 'i': goto yy7;",
          "604:  case 'r': goto yy4;",
          "605:  case 's': goto yy9;",
          "606:  case '}': goto yy14;",
          "607:  default: goto yy16;",
          "610:  yych = *(YYMARKER = ++YYCURSOR);",
          "611:  if (yych == ':') goto yy95;",
          "613: #line 884 \"ext/standard/var_unserializer.re\"",
          "615: #line 580 \"ext/standard/var_unserializer.c\"",
          "618:  if (yych == ':') goto yy89;",
          "622:  if (yych == ';') goto yy87;",
          "626:  if (yych == ':') goto yy83;",
          "630:  if (yych == ':') goto yy77;",
          "634:  if (yych == ':') goto yy53;",
          "638:  if (yych == ':') goto yy46;",
          "642:  if (yych == ':') goto yy39;",
          "646:  if (yych == ':') goto yy32;",
          "650:  if (yych == ':') goto yy25;",
          "654:  if (yych == ':') goto yy17;",
          "658: #line 878 \"ext/standard/var_unserializer.re\"",
          "664: #line 629 \"ext/standard/var_unserializer.c\"",
          "665: yy16:",
          "666:  yych = *++YYCURSOR;",
          "667:  goto yy3;",
          "671:   goto yy20;",
          "673:  if (yych == '+') goto yy19;",
          "679:  if (yybm[0+yych] & 128) {",
          "680:   goto yy20;",
          "683: yy20:",
          "684:  ++YYCURSOR;",
          "685:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "686:  yych = *YYCURSOR;",
          "687:  if (yybm[0+yych] & 128) {",
          "688:   goto yy20;",
          "689:  }",
          "691:  if (yych >= ';') goto yy18;",
          "693:  if (yych != '\"') goto yy18;",
          "694:  ++YYCURSOR;",
          "695: #line 733 \"ext/standard/var_unserializer.re\"",
          "696:  {",
          "697:  size_t len, len2, len3, maxlen;",
          "698:  zend_long elements;",
          "699:  char *str;",
          "700:  zend_string *class_name;",
          "701:  zend_class_entry *ce;",
          "702:  int incomplete_class = 0;",
          "704:  int custom_object = 0;",
          "706:  zval user_func;",
          "707:  zval retval;",
          "708:  zval args[1];",
          "710:     if (!var_hash) return 0;",
          "711:  if (*start == 'C') {",
          "712:   custom_object = 1;",
          "713:  }",
          "715:  len2 = len = parse_uiv(start + 2);",
          "716:  maxlen = max - YYCURSOR;",
          "717:  if (maxlen < len || len == 0) {",
          "719:   return 0;",
          "720:  }",
          "722:  str = (char*)YYCURSOR;",
          "724:  YYCURSOR += len;",
          "726:  if (*(YYCURSOR) != '\"') {",
          "728:   return 0;",
          "729:  }",
          "730:  if (*(YYCURSOR+1) != ':') {",
          "732:   return 0;",
          "733:  }",
          "735:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "736:  if (len3 != len)",
          "737:  {",
          "739:   return 0;",
          "740:  }",
          "742:  class_name = zend_string_init(str, len, 0);",
          "744:  do {",
          "745:   if(!unserialize_allowed_class(class_name, classes)) {",
          "746:    incomplete_class = 1;",
          "747:    ce = PHP_IC_ENTRY;",
          "748:    break;",
          "749:   }",
          "752:   BG(serialize_lock)++;",
          "753:   ce = zend_lookup_class(class_name);",
          "754:   if (ce) {",
          "755:    BG(serialize_lock)--;",
          "756:    if (EG(exception)) {",
          "757:     zend_string_release(class_name);",
          "758:     return 0;",
          "759:    }",
          "760:    break;",
          "761:   }",
          "762:   BG(serialize_lock)--;",
          "764:   if (EG(exception)) {",
          "765:    zend_string_release(class_name);",
          "766:    return 0;",
          "767:   }",
          "770:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "771:    incomplete_class = 1;",
          "772:    ce = PHP_IC_ENTRY;",
          "773:    break;",
          "774:   }",
          "777:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "779:   ZVAL_STR_COPY(&args[0], class_name);",
          "780:   BG(serialize_lock)++;",
          "781:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "782:    BG(serialize_lock)--;",
          "783:    if (EG(exception)) {",
          "784:     zend_string_release(class_name);",
          "785:     zval_ptr_dtor(&user_func);",
          "786:     zval_ptr_dtor(&args[0]);",
          "787:     return 0;",
          "788:    }",
          "789:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "790:    incomplete_class = 1;",
          "791:    ce = PHP_IC_ENTRY;",
          "792:    zval_ptr_dtor(&user_func);",
          "793:    zval_ptr_dtor(&args[0]);",
          "794:    break;",
          "795:   }",
          "796:   BG(serialize_lock)--;",
          "797:   zval_ptr_dtor(&retval);",
          "798:   if (EG(exception)) {",
          "799:    zend_string_release(class_name);",
          "800:    zval_ptr_dtor(&user_func);",
          "801:    zval_ptr_dtor(&args[0]);",
          "802:    return 0;",
          "803:   }",
          "806:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "807:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "808:    incomplete_class = 1;",
          "809:    ce = PHP_IC_ENTRY;",
          "812:   zval_ptr_dtor(&user_func);",
          "813:   zval_ptr_dtor(&args[0]);",
          "814:   break;",
          "815:  } while (1);",
          "819:  if (custom_object) {",
          "820:   int ret;",
          "822:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "824:   if (ret && incomplete_class) {",
          "825:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "827:   zend_string_release(class_name);",
          "828:   return ret;",
          "831:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "833:  if (incomplete_class) {",
          "834:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "836:  zend_string_release(class_name);",
          "838:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "839: }",
          "840: #line 805 \"ext/standard/var_unserializer.c\"",
          "841: yy25:",
          "844:   if (yych != '+') goto yy18;",
          "846:   if (yych <= '-') goto yy26;",
          "848:   if (yych <= '9') goto yy27;",
          "851: yy26:",
          "854:  if (yych >= ':') goto yy18;",
          "855: yy27:",
          "860:  if (yych <= '9') goto yy27;",
          "861:  if (yych >= ';') goto yy18;",
          "863:  if (yych != '\"') goto yy18;",
          "865: #line 726 \"ext/standard/var_unserializer.re\"",
          "866:  {",
          "867:     if (!var_hash) return 0;",
          "869:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "870:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "871: }",
          "872: #line 837 \"ext/standard/var_unserializer.c\"",
          "873: yy32:",
          "874:  yych = *++YYCURSOR;",
          "875:  if (yych == '+') goto yy33;",
          "879: yy33:",
          "883: yy34:",
          "888:  if (yych <= '9') goto yy34;",
          "889:  if (yych >= ';') goto yy18;",
          "891:  if (yych != '{') goto yy18;",
          "892:  ++YYCURSOR;",
          "893: #line 702 \"ext/standard/var_unserializer.re\"",
          "894:  {",
          "895:  zend_long elements = parse_iv(start + 2);",
          "898:     if (!var_hash) return 0;",
          "900:  if (elements < 0) {",
          "901:   return 0;",
          "902:  }",
          "904:  array_init_size(rval, elements);",
          "905:  if (elements) {",
          "908:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "909:  }",
          "911:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "912:   return 0;",
          "913:  }",
          "915:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "916: }",
          "917: #line 882 \"ext/standard/var_unserializer.c\"",
          "918: yy39:",
          "919:  yych = *++YYCURSOR;",
          "920:  if (yych == '+') goto yy40;",
          "921:  if (yych <= '/') goto yy18;",
          "922:  if (yych <= '9') goto yy41;",
          "923:  goto yy18;",
          "924: yy40:",
          "925:  yych = *++YYCURSOR;",
          "926:  if (yych <= '/') goto yy18;",
          "927:  if (yych >= ':') goto yy18;",
          "928: yy41:",
          "933:  if (yych <= '9') goto yy41;",
          "934:  if (yych >= ';') goto yy18;",
          "935:  yych = *++YYCURSOR;",
          "936:  if (yych != '\"') goto yy18;",
          "937:  ++YYCURSOR;",
          "938: #line 668 \"ext/standard/var_unserializer.re\"",
          "939:  {",
          "940:  size_t len, maxlen;",
          "941:  zend_string *str;",
          "943:  len = parse_uiv(start + 2);",
          "944:  maxlen = max - YYCURSOR;",
          "945:  if (maxlen < len) {",
          "947:   return 0;",
          "948:  }",
          "950:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "951:   return 0;",
          "952:  }",
          "954:  if (*(YYCURSOR) != '\"') {",
          "955:   zend_string_free(str);",
          "957:   return 0;",
          "958:  }",
          "960:  if (*(YYCURSOR + 1) != ';') {",
          "961:   efree(str);",
          "963:   return 0;",
          "964:  }",
          "966:  YYCURSOR += 2;",
          "969:  ZVAL_STR(rval, str);",
          "970:  return 1;",
          "971: }",
          "972: #line 937 \"ext/standard/var_unserializer.c\"",
          "973: yy46:",
          "975:  if (yych == '+') goto yy47;",
          "976:  if (yych <= '/') goto yy18;",
          "977:  if (yych <= '9') goto yy48;",
          "979: yy47:",
          "982:  if (yych >= ':') goto yy18;",
          "983: yy48:",
          "984:  ++YYCURSOR;",
          "985:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "986:  yych = *YYCURSOR;",
          "987:  if (yych <= '/') goto yy18;",
          "988:  if (yych <= '9') goto yy48;",
          "989:  if (yych >= ';') goto yy18;",
          "990:  yych = *++YYCURSOR;",
          "991:  if (yych != '\"') goto yy18;",
          "992:  ++YYCURSOR;",
          "993: #line 636 \"ext/standard/var_unserializer.re\"",
          "994:  {",
          "995:  size_t len, maxlen;",
          "996:  char *str;",
          "998:  len = parse_uiv(start + 2);",
          "999:  maxlen = max - YYCURSOR;",
          "1000:  if (maxlen < len) {",
          "1002:   return 0;",
          "1003:  }",
          "1005:  str = (char*)YYCURSOR;",
          "1007:  YYCURSOR += len;",
          "1009:  if (*(YYCURSOR) != '\"') {",
          "1011:   return 0;",
          "1012:  }",
          "1014:  if (*(YYCURSOR + 1) != ';') {",
          "1016:   return 0;",
          "1017:  }",
          "1019:  YYCURSOR += 2;",
          "1022:  ZVAL_STRINGL(rval, str, len);",
          "1023:  return 1;",
          "1024: }",
          "1025: #line 990 \"ext/standard/var_unserializer.c\"",
          "1026: yy53:",
          "1027:  yych = *++YYCURSOR;",
          "1028:  if (yych <= '/') {",
          "1029:   if (yych <= ',') {",
          "1030:    if (yych == '+') goto yy57;",
          "1031:    goto yy18;",
          "1032:   } else {",
          "1033:    if (yych <= '-') goto yy55;",
          "1034:    if (yych <= '.') goto yy60;",
          "1035:    goto yy18;",
          "1036:   }",
          "1037:  } else {",
          "1038:   if (yych <= 'I') {",
          "1039:    if (yych <= '9') goto yy58;",
          "1040:    if (yych <= 'H') goto yy18;",
          "1041:    goto yy56;",
          "1042:   } else {",
          "1043:    if (yych != 'N') goto yy18;",
          "1044:   }",
          "1045:  }",
          "1046:  yych = *++YYCURSOR;",
          "1047:  if (yych == 'A') goto yy76;",
          "1049: yy55:",
          "1052:   if (yych == '.') goto yy60;",
          "1053:   goto yy18;",
          "1055:   if (yych <= '9') goto yy58;",
          "1056:   if (yych != 'I') goto yy18;",
          "1058: yy56:",
          "1060:  if (yych == 'N') goto yy72;",
          "1061:  goto yy18;",
          "1062: yy57:",
          "1063:  yych = *++YYCURSOR;",
          "1064:  if (yych == '.') goto yy60;",
          "1066:  if (yych >= ':') goto yy18;",
          "1067: yy58:",
          "1074:    goto yy70;",
          "1077:    if (yych <= '9') goto yy58;",
          "1082:    if (yych <= ';') goto yy63;",
          "1084:    goto yy65;",
          "1086:    if (yych == 'e') goto yy65;",
          "1090: yy60:",
          "1094: yy61:",
          "1096:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1098:  if (yych <= ';') {",
          "1099:   if (yych <= '/') goto yy18;",
          "1100:   if (yych <= '9') goto yy61;",
          "1101:   if (yych <= ':') goto yy18;",
          "1102:  } else {",
          "1103:   if (yych <= 'E') {",
          "1104:    if (yych <= 'D') goto yy18;",
          "1105:    goto yy65;",
          "1106:   } else {",
          "1107:    if (yych == 'e') goto yy65;",
          "1108:    goto yy18;",
          "1109:   }",
          "1110:  }",
          "1113: #line 627 \"ext/standard/var_unserializer.re\"",
          "1115: #if SIZEOF_ZEND_LONG == 4",
          "1116: use_double:",
          "1117: #endif",
          "1119:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1122: #line 1087 \"ext/standard/var_unserializer.c\"",
          "1125:  if (yych <= ',') {",
          "1126:   if (yych != '+') goto yy18;",
          "1127:  } else {",
          "1128:   if (yych <= '-') goto yy66;",
          "1129:   if (yych <= '/') goto yy18;",
          "1130:   if (yych <= '9') goto yy67;",
          "1131:   goto yy18;",
          "1132:  }",
          "1135:  if (yych <= ',') {",
          "1136:   if (yych == '+') goto yy69;",
          "1137:   goto yy18;",
          "1138:  } else {",
          "1139:   if (yych <= '-') goto yy69;",
          "1140:   if (yych <= '/') goto yy18;",
          "1141:   if (yych >= ':') goto yy18;",
          "1142:  }",
          "1145:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1146:  yych = *YYCURSOR;",
          "1147:  if (yych <= '/') goto yy18;",
          "1148:  if (yych <= '9') goto yy67;",
          "1149:  if (yych == ';') goto yy63;",
          "1150:  goto yy18;",
          "1152:  yych = *++YYCURSOR;",
          "1153:  if (yych <= '/') goto yy18;",
          "1154:  if (yych <= '9') goto yy67;",
          "1155:  goto yy18;",
          "1156: yy70:",
          "1162:   if (yych <= '9') goto yy70;",
          "1164:   goto yy63;",
          "1168:    goto yy65;",
          "1170:    if (yych == 'e') goto yy65;",
          "1174: yy72:",
          "1175:  yych = *++YYCURSOR;",
          "1176:  if (yych != 'F') goto yy18;",
          "1177: yy73:",
          "1178:  yych = *++YYCURSOR;",
          "1179:  if (yych != ';') goto yy18;",
          "1181: #line 611 \"ext/standard/var_unserializer.re\"",
          "1185:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1186:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1187:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1188:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1189:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1190:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1191:  } else {",
          "1192:   ZVAL_NULL(rval);",
          "1193:  }",
          "1197: #line 1162 \"ext/standard/var_unserializer.c\"",
          "1198: yy76:",
          "1199:  yych = *++YYCURSOR;",
          "1200:  if (yych == 'N') goto yy73;",
          "1201:  goto yy18;",
          "1202: yy77:",
          "1205:   if (yych != '+') goto yy18;",
          "1207:   if (yych <= '-') goto yy78;",
          "1209:   if (yych <= '9') goto yy79;",
          "1212: yy78:",
          "1214:  if (yych <= '/') goto yy18;",
          "1215:  if (yych >= ':') goto yy18;",
          "1216: yy79:",
          "1217:  ++YYCURSOR;",
          "1218:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1219:  yych = *YYCURSOR;",
          "1220:  if (yych <= '/') goto yy18;",
          "1221:  if (yych <= '9') goto yy79;",
          "1222:  if (yych != ';') goto yy18;",
          "1224: #line 585 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "594:  case 'O': goto yy4;",
          "596:  case 'R': goto yy6;",
          "597:  case 'S': goto yy7;",
          "598:  case 'a': goto yy8;",
          "599:  case 'b': goto yy9;",
          "600:  case 'd': goto yy10;",
          "601:  case 'i': goto yy11;",
          "603:  case 'r': goto yy13;",
          "604:  case 's': goto yy14;",
          "605:  case '}': goto yy15;",
          "606:  default: goto yy2;",
          "609:  ++YYCURSOR;",
          "611: #line 922 \"ext/standard/var_unserializer.re\"",
          "613: #line 614 \"ext/standard/var_unserializer.c\"",
          "616:  if (yych == ':') goto yy17;",
          "620:  if (yych == ';') goto yy19;",
          "624:  if (yych == ':') goto yy21;",
          "628:  if (yych == ':') goto yy22;",
          "632:  if (yych == ':') goto yy23;",
          "636:  if (yych == ':') goto yy24;",
          "640:  if (yych == ':') goto yy25;",
          "644:  if (yych == ':') goto yy26;",
          "648:  if (yych == ':') goto yy27;",
          "652:  if (yych == ':') goto yy28;",
          "655:  yych = *(YYMARKER = ++YYCURSOR);",
          "656:  if (yych == ':') goto yy29;",
          "657:  goto yy3;",
          "658: yy15:",
          "660: #line 916 \"ext/standard/var_unserializer.re\"",
          "666: #line 667 \"ext/standard/var_unserializer.c\"",
          "670:   goto yy31;",
          "672:  if (yych == '+') goto yy30;",
          "677:  ++YYCURSOR;",
          "678: #line 609 \"ext/standard/var_unserializer.re\"",
          "679:  {",
          "681:  ZVAL_NULL(rval);",
          "682:  return 1;",
          "683: }",
          "684: #line 685 \"ext/standard/var_unserializer.c\"",
          "685: yy21:",
          "687:  if (yych <= ',') {",
          "688:   if (yych == '+') goto yy33;",
          "689:   goto yy18;",
          "690:  } else {",
          "691:   if (yych <= '-') goto yy33;",
          "692:   if (yych <= '/') goto yy18;",
          "693:   if (yych <= '9') goto yy34;",
          "694:   goto yy18;",
          "696: yy22:",
          "697:  yych = *++YYCURSOR;",
          "698:  if (yych == '+') goto yy36;",
          "699:  if (yych <= '/') goto yy18;",
          "700:  if (yych <= '9') goto yy37;",
          "702: yy23:",
          "703:  yych = *++YYCURSOR;",
          "704:  if (yych == '+') goto yy39;",
          "706:  if (yych <= '9') goto yy40;",
          "707:  goto yy18;",
          "708: yy24:",
          "710:  if (yych <= '/') goto yy18;",
          "711:  if (yych <= '1') goto yy42;",
          "712:  goto yy18;",
          "713: yy25:",
          "714:  yych = *++YYCURSOR;",
          "715:  if (yych <= '/') {",
          "716:   if (yych <= ',') {",
          "717:    if (yych == '+') goto yy43;",
          "718:    goto yy18;",
          "719:   } else {",
          "720:    if (yych <= '-') goto yy44;",
          "721:    if (yych <= '.') goto yy45;",
          "722:    goto yy18;",
          "724:  } else {",
          "725:   if (yych <= 'I') {",
          "726:    if (yych <= '9') goto yy46;",
          "727:    if (yych <= 'H') goto yy18;",
          "728:    goto yy48;",
          "729:   } else {",
          "730:    if (yych == 'N') goto yy49;",
          "731:    goto yy18;",
          "734: yy26:",
          "735:  yych = *++YYCURSOR;",
          "736:  if (yych <= ',') {",
          "737:   if (yych == '+') goto yy50;",
          "738:   goto yy18;",
          "739:  } else {",
          "740:   if (yych <= '-') goto yy50;",
          "741:   if (yych <= '/') goto yy18;",
          "742:   if (yych <= '9') goto yy51;",
          "743:   goto yy18;",
          "745: yy27:",
          "748:   if (yych == '+') goto yy53;",
          "749:   goto yy18;",
          "751:   if (yych <= '-') goto yy53;",
          "753:   if (yych <= '9') goto yy54;",
          "756: yy28:",
          "757:  yych = *++YYCURSOR;",
          "758:  if (yych <= ',') {",
          "759:   if (yych == '+') goto yy56;",
          "760:   goto yy18;",
          "761:  } else {",
          "762:   if (yych <= '-') goto yy56;",
          "763:   if (yych <= '/') goto yy18;",
          "764:   if (yych <= '9') goto yy57;",
          "765:   goto yy18;",
          "766:  }",
          "767: yy29:",
          "769:  if (yych == '+') goto yy59;",
          "771:  if (yych <= '9') goto yy60;",
          "772:  goto yy18;",
          "773: yy30:",
          "774:  yych = *++YYCURSOR;",
          "775:  if (yybm[0+yych] & 128) {",
          "776:   goto yy31;",
          "777:  }",
          "778:  goto yy18;",
          "779: yy31:",
          "783:  if (yybm[0+yych] & 128) {",
          "784:   goto yy31;",
          "785:  }",
          "787:  if (yych <= ':') goto yy62;",
          "788:  goto yy18;",
          "789: yy33:",
          "791:  if (yych <= '/') goto yy18;",
          "792:  if (yych >= ':') goto yy18;",
          "793: yy34:",
          "795:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "796:  yych = *YYCURSOR;",
          "799:  if (yych == ';') goto yy63;",
          "801: yy36:",
          "805: yy37:",
          "810:  if (yych <= '9') goto yy37;",
          "811:  if (yych <= ':') goto yy65;",
          "812:  goto yy18;",
          "813: yy39:",
          "815:  if (yych <= '/') goto yy18;",
          "816:  if (yych >= ':') goto yy18;",
          "817: yy40:",
          "822:  if (yych <= '9') goto yy40;",
          "823:  if (yych <= ':') goto yy66;",
          "824:  goto yy18;",
          "825: yy42:",
          "827:  if (yych == ';') goto yy67;",
          "829: yy43:",
          "831:  if (yych == '.') goto yy45;",
          "833:  if (yych <= '9') goto yy46;",
          "835: yy44:",
          "838:   if (yych != '.') goto yy18;",
          "840:   if (yych <= '9') goto yy46;",
          "841:   if (yych == 'I') goto yy48;",
          "842:   goto yy18;",
          "844: yy45:",
          "847:  if (yych <= '9') goto yy69;",
          "848:  goto yy18;",
          "849: yy46:",
          "856:    goto yy69;",
          "859:    if (yych <= '9') goto yy46;",
          "864:    if (yych <= ';') goto yy71;",
          "866:    goto yy73;",
          "868:    if (yych == 'e') goto yy73;",
          "872: yy48:",
          "873:  yych = *++YYCURSOR;",
          "874:  if (yych == 'N') goto yy74;",
          "875:  goto yy18;",
          "876: yy49:",
          "877:  yych = *++YYCURSOR;",
          "878:  if (yych == 'A') goto yy75;",
          "879:  goto yy18;",
          "880: yy50:",
          "884: yy51:",
          "886:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "888:  if (yych <= '/') goto yy18;",
          "889:  if (yych <= '9') goto yy51;",
          "890:  if (yych == ';') goto yy76;",
          "891:  goto yy18;",
          "892: yy53:",
          "893:  yych = *++YYCURSOR;",
          "894:  if (yych <= '/') goto yy18;",
          "895:  if (yych >= ':') goto yy18;",
          "896: yy54:",
          "897:  ++YYCURSOR;",
          "898:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "899:  yych = *YYCURSOR;",
          "900:  if (yych <= '/') goto yy18;",
          "901:  if (yych <= '9') goto yy54;",
          "902:  if (yych <= ':') goto yy78;",
          "903:  goto yy18;",
          "904: yy56:",
          "905:  yych = *++YYCURSOR;",
          "906:  if (yych <= '/') goto yy18;",
          "907:  if (yych >= ':') goto yy18;",
          "908: yy57:",
          "909:  ++YYCURSOR;",
          "910:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "911:  yych = *YYCURSOR;",
          "912:  if (yych <= '/') goto yy18;",
          "913:  if (yych <= '9') goto yy57;",
          "914:  if (yych == ';') goto yy79;",
          "915:  goto yy18;",
          "916: yy59:",
          "917:  yych = *++YYCURSOR;",
          "918:  if (yych <= '/') goto yy18;",
          "919:  if (yych >= ':') goto yy18;",
          "920: yy60:",
          "921:  ++YYCURSOR;",
          "922:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "923:  yych = *YYCURSOR;",
          "924:  if (yych <= '/') goto yy18;",
          "925:  if (yych <= '9') goto yy60;",
          "926:  if (yych <= ':') goto yy81;",
          "927:  goto yy18;",
          "928: yy62:",
          "929:  yych = *++YYCURSOR;",
          "930:  if (yych == '\"') goto yy82;",
          "931:  goto yy18;",
          "934: #line 558 \"ext/standard/var_unserializer.re\"",
          "936:  zend_long id;",
          "939:  if (!var_hash) return 0;",
          "941:  id = parse_iv(start + 2) - 1;",
          "942:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "943:   return 0;",
          "944:  }",
          "946:  zval_ptr_dtor(rval);",
          "947:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "948:   ZVAL_UNDEF(rval);",
          "949:   return 1;",
          "950:  }",
          "951:  if (Z_ISREF_P(rval_ref)) {",
          "952:   ZVAL_COPY(rval, rval_ref);",
          "953:  } else {",
          "954:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "955:   ZVAL_COPY(rval, rval_ref);",
          "956:  }",
          "960: #line 961 \"ext/standard/var_unserializer.c\"",
          "963:  if (yych == '\"') goto yy84;",
          "964:  goto yy18;",
          "967:  if (yych == '{') goto yy86;",
          "968:  goto yy18;",
          "971: #line 615 \"ext/standard/var_unserializer.re\"",
          "972:  {",
          "974:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "975:  return 1;",
          "976: }",
          "977: #line 978 \"ext/standard/var_unserializer.c\"",
          "984:   if (yych <= '9') goto yy69;",
          "989:    goto yy73;",
          "991:    if (yych == 'e') goto yy73;",
          "995: yy71:",
          "997: #line 663 \"ext/standard/var_unserializer.re\"",
          "999: #if SIZEOF_ZEND_LONG == 4",
          "1000: use_double:",
          "1001: #endif",
          "1003:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1006: #line 1007 \"ext/standard/var_unserializer.c\"",
          "1007: yy73:",
          "1010:   if (yych == '+') goto yy88;",
          "1011:   goto yy18;",
          "1013:   if (yych <= '-') goto yy88;",
          "1015:   if (yych <= '9') goto yy89;",
          "1018: yy74:",
          "1020:  if (yych == 'F') goto yy91;",
          "1021:  goto yy18;",
          "1022: yy75:",
          "1023:  yych = *++YYCURSOR;",
          "1024:  if (yych == 'N') goto yy91;",
          "1025:  goto yy18;",
          "1026: yy76:",
          "1028: #line 621 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1247:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1248:  return 1;",
          "1249: }",
          "1255:  yych = *++YYCURSOR;",
          "1295:  ++YYCURSOR;",
          "1297:  {",
          "1298:  zend_long id;",
          "",
          "[Removed Lines]",
          "1250: #line 1215 \"ext/standard/var_unserializer.c\"",
          "1251: yy83:",
          "1252:  yych = *++YYCURSOR;",
          "1253:  if (yych <= '/') goto yy18;",
          "1254:  if (yych >= '2') goto yy18;",
          "1256:  if (yych != ';') goto yy18;",
          "1257:  ++YYCURSOR;",
          "1258: #line 579 \"ext/standard/var_unserializer.re\"",
          "1259:  {",
          "1261:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1262:  return 1;",
          "1263: }",
          "1264: #line 1229 \"ext/standard/var_unserializer.c\"",
          "1265: yy87:",
          "1266:  ++YYCURSOR;",
          "1267: #line 573 \"ext/standard/var_unserializer.re\"",
          "1268:  {",
          "1270:  ZVAL_NULL(rval);",
          "1271:  return 1;",
          "1272: }",
          "1273: #line 1238 \"ext/standard/var_unserializer.c\"",
          "1274: yy89:",
          "1275:  yych = *++YYCURSOR;",
          "1276:  if (yych <= ',') {",
          "1277:   if (yych != '+') goto yy18;",
          "1278:  } else {",
          "1279:   if (yych <= '-') goto yy90;",
          "1280:   if (yych <= '/') goto yy18;",
          "1281:   if (yych <= '9') goto yy91;",
          "1282:   goto yy18;",
          "1283:  }",
          "1284: yy90:",
          "1285:  yych = *++YYCURSOR;",
          "1286:  if (yych <= '/') goto yy18;",
          "1287:  if (yych >= ':') goto yy18;",
          "1288: yy91:",
          "1289:  ++YYCURSOR;",
          "1290:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1291:  yych = *YYCURSOR;",
          "1292:  if (yych <= '/') goto yy18;",
          "1293:  if (yych <= '9') goto yy91;",
          "1294:  if (yych != ';') goto yy18;",
          "1296: #line 548 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1054: #line 1055 \"ext/standard/var_unserializer.c\"",
          "1055: yy78:",
          "1057:  if (yych == '\"') goto yy92;",
          "1058:  goto yy18;",
          "1059: yy79:",
          "1061: #line 584 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1319:  return 1;",
          "1320: }",
          "1323:  yych = *++YYCURSOR;",
          "1324:  if (yych <= ',') {",
          "1326:  } else {",
          "1327:   if (yych <= '-') goto yy96;",
          "1328:   if (yych <= '/') goto yy18;",
          "1331:  }",
          "1337:  ++YYCURSOR;",
          "1338:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1339:  yych = *YYCURSOR;",
          "1340:  if (yych <= '/') goto yy18;",
          "1343:  ++YYCURSOR;",
          "1345:  {",
          "1353:   return 0;",
          "1354:  }",
          "1360:  }",
          "1363:  } else {",
          "1366:  }",
          "1368:  return 1;",
          "1369: }",
          "1371: }",
          "1375:  return 0;",
          "",
          "[Removed Lines]",
          "1321: #line 1286 \"ext/standard/var_unserializer.c\"",
          "1322: yy95:",
          "1325:   if (yych != '+') goto yy18;",
          "1329:   if (yych <= '9') goto yy97;",
          "1330:   goto yy18;",
          "1332: yy96:",
          "1333:  yych = *++YYCURSOR;",
          "1334:  if (yych <= '/') goto yy18;",
          "1335:  if (yych >= ':') goto yy18;",
          "1336: yy97:",
          "1341:  if (yych <= '9') goto yy97;",
          "1342:  if (yych != ';') goto yy18;",
          "1344: #line 522 \"ext/standard/var_unserializer.re\"",
          "1346:  zend_long id;",
          "1349:  if (!var_hash) return 0;",
          "1351:  id = parse_iv(start + 2) - 1;",
          "1352:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1356:  zval_ptr_dtor(rval);",
          "1357:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1358:   ZVAL_UNDEF(rval);",
          "1359:   return 1;",
          "1361:  if (Z_ISREF_P(rval_ref)) {",
          "1362:   ZVAL_COPY(rval, rval_ref);",
          "1364:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1365:   ZVAL_COPY(rval, rval_ref);",
          "1370: #line 1335 \"ext/standard/var_unserializer.c\"",
          "1372: #line 886 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1086: #line 1087 \"ext/standard/var_unserializer.c\"",
          "1087: yy81:",
          "1088:  yych = *++YYCURSOR;",
          "1089:  if (yych == '\"') goto yy94;",
          "1090:  goto yy18;",
          "1091: yy82:",
          "1092:  ++YYCURSOR;",
          "1093: #line 769 \"ext/standard/var_unserializer.re\"",
          "1094:  {",
          "1095:  size_t len, len2, len3, maxlen;",
          "1096:  zend_long elements;",
          "1097:  char *str;",
          "1098:  zend_string *class_name;",
          "1099:  zend_class_entry *ce;",
          "1100:  int incomplete_class = 0;",
          "1102:  int custom_object = 0;",
          "1104:  zval user_func;",
          "1105:  zval retval;",
          "1106:  zval args[1];",
          "1108:     if (!var_hash) return 0;",
          "1109:  if (*start == 'C') {",
          "1110:   custom_object = 1;",
          "1111:  }",
          "1113:  len2 = len = parse_uiv(start + 2);",
          "1114:  maxlen = max - YYCURSOR;",
          "1115:  if (maxlen < len || len == 0) {",
          "1117:   return 0;",
          "1118:  }",
          "1120:  str = (char*)YYCURSOR;",
          "1122:  YYCURSOR += len;",
          "1124:  if (*(YYCURSOR) != '\"') {",
          "1126:   return 0;",
          "1127:  }",
          "1128:  if (*(YYCURSOR+1) != ':') {",
          "1130:   return 0;",
          "1131:  }",
          "1133:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1134:  if (len3 != len)",
          "1135:  {",
          "1137:   return 0;",
          "1138:  }",
          "1140:  class_name = zend_string_init(str, len, 0);",
          "1142:  do {",
          "1143:   if(!unserialize_allowed_class(class_name, classes)) {",
          "1144:    incomplete_class = 1;",
          "1145:    ce = PHP_IC_ENTRY;",
          "1146:    break;",
          "1147:   }",
          "1150:   BG(serialize_lock)++;",
          "1151:   ce = zend_lookup_class(class_name);",
          "1152:   if (ce) {",
          "1153:    BG(serialize_lock)--;",
          "1154:    if (EG(exception)) {",
          "1155:     zend_string_release(class_name);",
          "1156:     return 0;",
          "1157:    }",
          "1158:    break;",
          "1159:   }",
          "1160:   BG(serialize_lock)--;",
          "1162:   if (EG(exception)) {",
          "1163:    zend_string_release(class_name);",
          "1164:    return 0;",
          "1165:   }",
          "1168:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1169:    incomplete_class = 1;",
          "1170:    ce = PHP_IC_ENTRY;",
          "1171:    break;",
          "1172:   }",
          "1175:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1177:   ZVAL_STR_COPY(&args[0], class_name);",
          "1178:   BG(serialize_lock)++;",
          "1179:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1180:    BG(serialize_lock)--;",
          "1181:    if (EG(exception)) {",
          "1182:     zend_string_release(class_name);",
          "1183:     zval_ptr_dtor(&user_func);",
          "1184:     zval_ptr_dtor(&args[0]);",
          "1185:     return 0;",
          "1186:    }",
          "1187:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1188:    incomplete_class = 1;",
          "1189:    ce = PHP_IC_ENTRY;",
          "1190:    zval_ptr_dtor(&user_func);",
          "1191:    zval_ptr_dtor(&args[0]);",
          "1192:    break;",
          "1193:   }",
          "1194:   BG(serialize_lock)--;",
          "1195:   zval_ptr_dtor(&retval);",
          "1196:   if (EG(exception)) {",
          "1197:    zend_string_release(class_name);",
          "1198:    zval_ptr_dtor(&user_func);",
          "1199:    zval_ptr_dtor(&args[0]);",
          "1200:    return 0;",
          "1201:   }",
          "1204:   BG(serialize_lock)++;",
          "1205:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1206:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1207:    incomplete_class = 1;",
          "1208:    ce = PHP_IC_ENTRY;",
          "1209:   }",
          "1210:   BG(serialize_lock)--;",
          "1212:   zval_ptr_dtor(&user_func);",
          "1213:   zval_ptr_dtor(&args[0]);",
          "1214:   break;",
          "1215:  } while (1);",
          "1219:  if (custom_object) {",
          "1220:   int ret;",
          "1222:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1224:   if (ret && incomplete_class) {",
          "1225:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1226:   }",
          "1227:   zend_string_release(class_name);",
          "1228:   return ret;",
          "1229:  }",
          "1231:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1233:  if (incomplete_class) {",
          "1234:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1235:  }",
          "1236:  zend_string_release(class_name);",
          "1238:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1239: }",
          "1240: #line 1241 \"ext/standard/var_unserializer.c\"",
          "1241: yy84:",
          "1242:  ++YYCURSOR;",
          "1243: #line 704 \"ext/standard/var_unserializer.re\"",
          "1244:  {",
          "1245:  size_t len, maxlen;",
          "1246:  zend_string *str;",
          "1248:  len = parse_uiv(start + 2);",
          "1249:  maxlen = max - YYCURSOR;",
          "1250:  if (maxlen < len) {",
          "1252:   return 0;",
          "1253:  }",
          "1255:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1256:   return 0;",
          "1257:  }",
          "1259:  if (*(YYCURSOR) != '\"') {",
          "1260:   zend_string_free(str);",
          "1262:   return 0;",
          "1263:  }",
          "1265:  if (*(YYCURSOR + 1) != ';') {",
          "1266:   efree(str);",
          "1268:   return 0;",
          "1269:  }",
          "1271:  YYCURSOR += 2;",
          "1274:  ZVAL_STR(rval, str);",
          "1275:  return 1;",
          "1276: }",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "1278: yy86:",
          "1279:  ++YYCURSOR;",
          "1280: #line 738 \"ext/standard/var_unserializer.re\"",
          "1281:  {",
          "1282:  zend_long elements = parse_iv(start + 2);",
          "1285:     if (!var_hash) return 0;",
          "1287:  if (elements < 0) {",
          "1288:   return 0;",
          "1289:  }",
          "1291:  array_init_size(rval, elements);",
          "1292:  if (elements) {",
          "1295:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1296:  }",
          "1298:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1299:   return 0;",
          "1300:  }",
          "1302:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1303: }",
          "1304: #line 1305 \"ext/standard/var_unserializer.c\"",
          "1305: yy88:",
          "1308:   if (yych == '+') goto yy96;",
          "1309:   goto yy18;",
          "1313:   if (yych >= ':') goto yy18;",
          "1315: yy89:",
          "1320:  if (yych <= '9') goto yy89;",
          "1321:  if (yych == ';') goto yy71;",
          "1322:  goto yy18;",
          "1323: yy91:",
          "1324:  yych = *++YYCURSOR;",
          "1325:  if (yych == ';') goto yy97;",
          "1326:  goto yy18;",
          "1327: yy92:",
          "1329: #line 762 \"ext/standard/var_unserializer.re\"",
          "1331:     if (!var_hash) return 0;",
          "1333:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "1334:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "1335: }",
          "1336: #line 1337 \"ext/standard/var_unserializer.c\"",
          "1337: yy94:",
          "1338:  ++YYCURSOR;",
          "1339: #line 672 \"ext/standard/var_unserializer.re\"",
          "1340:  {",
          "1341:  size_t len, maxlen;",
          "1342:  char *str;",
          "1344:  len = parse_uiv(start + 2);",
          "1345:  maxlen = max - YYCURSOR;",
          "1346:  if (maxlen < len) {",
          "1351:  str = (char*)YYCURSOR;",
          "1353:  YYCURSOR += len;",
          "1355:  if (*(YYCURSOR) != '\"') {",
          "1357:   return 0;",
          "1360:  if (*(YYCURSOR + 1) != ';') {",
          "1362:   return 0;",
          "1363:  }",
          "1365:  YYCURSOR += 2;",
          "1368:  ZVAL_STRINGL(rval, str, len);",
          "1369:  return 1;",
          "1370: }",
          "1371: #line 1372 \"ext/standard/var_unserializer.c\"",
          "1372: yy96:",
          "1373:  yych = *++YYCURSOR;",
          "1374:  if (yych <= '/') goto yy18;",
          "1375:  if (yych <= '9') goto yy89;",
          "1376:  goto yy18;",
          "1377: yy97:",
          "1378:  ++YYCURSOR;",
          "1379: #line 647 \"ext/standard/var_unserializer.re\"",
          "1380:  {",
          "1383:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1384:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1385:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1386:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1387:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1388:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1390:   ZVAL_NULL(rval);",
          "1395: #line 1396 \"ext/standard/var_unserializer.c\"",
          "1397: #line 924 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "876:   }",
          "879:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "880:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "881:    incomplete_class = 1;",
          "882:    ce = PHP_IC_ENTRY;",
          "883:   }",
          "885:   zval_ptr_dtor(&user_func);",
          "886:   zval_ptr_dtor(&args[0]);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "879:   BG(serialize_lock)++;",
          "885:   BG(serialize_lock)--;",
          "",
          "---------------"
        ]
      }
    }
  ]
}