{
  "cve_id": "CVE-2019-13296",
  "cve_desc": "ImageMagick 7.0.8-50 Q16 has direct memory leaks in AcquireMagickMemory because of an error in CLIListOperatorImages in MagickWand/operation.c for a NULL value.",
  "repo": "ImageMagick/ImageMagick",
  "patch_hash": "ce08a3691a8ac29125e29fc41967b3737fa3f425",
  "patch_info": {
    "commit_hash": "ce08a3691a8ac29125e29fc41967b3737fa3f425",
    "repo": "ImageMagick/ImageMagick",
    "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/ce08a3691a8ac29125e29fc41967b3737fa3f425",
    "files": [
      "MagickWand/operation.c"
    ],
    "message": "https://github.com/ImageMagick/ImageMagick/issues/1604",
    "before_after_code_files": [
      "MagickWand/operation.c||MagickWand/operation.c"
    ]
  },
  "patch_diff": {
    "MagickWand/operation.c||MagickWand/operation.c": [
      "File: MagickWand/operation.c -> MagickWand/operation.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "3868:             metric;",
      "3872:             image and its reconstruction.",
      "3874:           image=RemoveFirstImageFromList(&_images);",
      "",
      "[Removed Lines]",
      "3871:             Mathematically and visually annotate the difference between an",
      "",
      "[Added Lines]",
      "3871:             Mathematically and visually annotate the difference between an",
      "3872:             image and its reconstruction.",
      "3874:           image=RemoveFirstImageFromList(&_images);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "4a334bbf5584de37c6f5a47c380a531c8c4b140a",
      "candidate_info": {
        "commit_hash": "4a334bbf5584de37c6f5a47c380a531c8c4b140a",
        "repo": "ImageMagick/ImageMagick",
        "commit_url": "https://github.com/ImageMagick/ImageMagick/commit/4a334bbf5584de37c6f5a47c380a531c8c4b140a",
        "files": [
          "MagickWand/mogrify.c",
          "MagickWand/operation.c"
        ],
        "message": "https://github.com/ImageMagick/ImageMagick/issues/1623",
        "before_after_code_files": [
          "MagickWand/mogrify.c||MagickWand/mogrify.c",
          "MagickWand/operation.c||MagickWand/operation.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "MagickWand/operation.c||MagickWand/operation.c"
          ],
          "candidate": [
            "MagickWand/operation.c||MagickWand/operation.c"
          ]
        }
      },
      "candidate_diff": {
        "MagickWand/mogrify.c||MagickWand/mogrify.c": [
          "File: MagickWand/mogrify.c -> MagickWand/mogrify.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "7824:         if (LocaleCompare(\"clut\",option+1) == 0)",
          "7825:           {",
          "7826:             Image",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "7896:               metric;",
          "7899:               Mathematically and visually annotate the difference between an",
          "7900:               image and its reconstruction.",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7902:               Mathematically and visually annotate the difference between an",
          "7903:               image and its reconstruction.",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "7976:             clip_to_self=GetCompositeClipToSelf(compose);",
          "7977:             value=GetImageOption(mogrify_info,\"compose:clip-to-self\");",
          "7978:             if (value != (const char *) NULL)",
          "7979:               clip_to_self=IsStringTrue(value);",
          "7980:             value=GetImageOption(mogrify_info,\"compose:outside-overlay\");",
          "7981:             if (value != (const char *) NULL)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7985:               clip_to_self=IsStringTrue(value);",
          "7986:             value=GetImageOption(mogrify_info,\"compose:outside-overlay\");",
          "7987:             if (value != (const char *) NULL)",
          "7990:             new_images=RemoveFirstImageFromList(images);",
          "7991:             source_image=RemoveFirstImageFromList(images);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "8228:         if (LocaleCompare(\"hald-clut\",option+1) == 0)",
          "8229:           {",
          "8230:             Image",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "8261:               Implements the inverse fourier discrete Fourier transform (DFT).",
          "8263:             (void) SyncImagesSettings(mogrify_info,*images,exception);",
          "8264:             magnitude_image=RemoveFirstImageFromList(images);",
          "8265:             phase_image=RemoveFirstImageFromList(images);",
          "8266:             if (phase_image == (Image *) NULL)",
          "8267:               {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8276:               Implements the inverse fourier discrete Fourier transform (DFT).",
          "8283:                 (void) ThrowMagickException(exception,GetMagickModule(),",
          "8284:                   OptionError,\"ImageSequenceRequired\",\"`%s'\",option);",
          "",
          "---------------"
        ],
        "MagickWand/operation.c||MagickWand/operation.c": [
          "File: MagickWand/operation.c -> MagickWand/operation.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "3821:       if (LocaleCompare(\"clut\",option+1) == 0)",
          "3822:         {",
          "3823:           Image",
          "3828:              _images.",
          "3830:           new_images=RemoveFirstImageFromList(&_images);",
          "",
          "[Removed Lines]",
          "3827:              with layers compose or even compose last image over all other",
          "",
          "[Added Lines]",
          "3827:              with layers compose or even compose last image over all other",
          "3828:              _images.",
          "3830:           new_images=RemoveFirstImageFromList(&_images);",
          "3831:           clut_image=RemoveFirstImageFromList(&_images);",
          "3833:           if (clut_image == (Image *) NULL)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3868:             metric;",
          "3872:             image and its reconstruction.",
          "3874:           image=RemoveFirstImageFromList(&_images);",
          "3875:           reconstruct_image=RemoveFirstImageFromList(&_images);",
          "",
          "[Removed Lines]",
          "3871:             Mathematically and visually annotate the difference between an",
          "",
          "[Added Lines]",
          "3877:             Mathematically and visually annotate the difference between an",
          "3878:             image and its reconstruction.",
          "3881:           reconstruct_image=RemoveFirstImageFromList(&_images);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "3931:           value=GetImageOption(_image_info,\"compose:clip-to-self\");",
          "3932:           if (value != (const char *) NULL)",
          "3933:             clip_to_self=IsStringTrue(value);",
          "3934:           value=GetImageOption(_image_info,\"compose:outside-overlay\");",
          "3935:           if (value != (const char *) NULL)",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3943:           value=GetImageOption(_image_info,\"compose:outside-overlay\");",
          "3944:           if (value != (const char *) NULL)",
          "3947:           new_images=RemoveFirstImageFromList(&_images);",
          "3948:           source_image=RemoveFirstImageFromList(&_images);",
          "3949:           if (source_image == (Image *) NULL)",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "4121:         {",
          "4123:              or perhaps compose last image over all other _images.",
          "4125:           Image",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4140:           Image",
          "4143:           new_images=RemoveFirstImageFromList(&_images);",
          "4144:           hald_image=RemoveLastImageFromList(&_images);",
          "4145:           if (hald_image == (Image *) NULL)",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "4136:       CLIWandExceptionBreak(OptionError,\"UnrecognizedOption\",option);",
          "4137:     }",
          "4138:     case 'i':",
          "4149:            if (phase_image == (Image *) NULL)",
          "4150:              break;",
          "",
          "[Removed Lines]",
          "4139:     {",
          "4140:       if (LocaleCompare(\"ift\",option+1) == 0)",
          "4141:         {",
          "4142:           Image",
          "4146:            magnitude_image=RemoveFirstImageFromList(&_images);",
          "4147:            phase_image=RemoveFirstImageFromList(&_images);",
          "",
          "[Added Lines]",
          "4160:     {",
          "4161:       if (LocaleCompare(\"ift\",option+1) == 0)",
          "4162:         {",
          "4163:           Image",
          "4167:           magnitude_image=RemoveFirstImageFromList(&_images);",
          "4168:           phase_image=RemoveFirstImageFromList(&_images);",
          "4169:           if (phase_image == (Image *) NULL)",
          "4170:             {",
          "4171:               (void) ThrowMagickException(_exception,GetMagickModule(),",
          "4172:                 OptionError,\"ImageSequenceRequired\",\"`%s'\",option);",
          "4173:               magnitude_image=DestroyImage(magnitude_image);",
          "",
          "---------------"
        ]
      }
    }
  ]
}