{
  "cve_id": "CVE-2016-2190",
  "cve_desc": "Moodle through 2.6.11, 2.7.x before 2.7.13, 2.8.x before 2.8.11, 2.9.x before 2.9.5, and 3.0.x before 3.0.3 does not properly restrict links, which allows remote attackers to obtain sensitive URL information by reading a Referer log.",
  "repo": "moodle/moodle",
  "patch_hash": "1688564a6eee6000013f6e185f704049283ae375",
  "patch_info": {
    "commit_hash": "1688564a6eee6000013f6e185f704049283ae375",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/1688564a6eee6000013f6e185f704049283ae375",
    "files": [
      "lib/htmlpurifier/locallib.php",
      "lib/tests/htmlpurifier_test.php",
      "lib/weblib.php",
      "mod/data/field/url/field.class.php"
    ],
    "message": "MDL-52651 htmlpurifier: Append rel=noreferrer to links.\n\nThank you to Zachary Durber for originally working on this issue.",
    "before_after_code_files": [
      "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
      "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
      "lib/weblib.php||lib/weblib.php",
      "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
    ]
  },
  "patch_diff": {
    "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php": [
      "File: lib/htmlpurifier/locallib.php -> lib/htmlpurifier/locallib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "119:     }",
      "121: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "130: class HTMLPurifier_AttrTransform_Noreferrer extends HTMLPurifier_AttrTransform {",
      "132:     private $parser;",
      "137:     public function __construct() {",
      "138:         $this->parser = new HTMLPurifier_URIParser();",
      "139:     }",
      "152:     public function transform($attr, $config, $context) {",
      "154:         if (!empty($attr['rel']) && substr($attr['rel'], 'noreferrer') !== false) {",
      "155:             return $attr;",
      "156:         }",
      "159:         if (!empty($attr['target']) && $attr['target'] == '_blank') {",
      "160:             $attr['rel'] = !empty($attr['rel']) ? $attr['rel'] . ' noreferrer' : 'noreferrer';",
      "161:         }",
      "163:         return $attr;",
      "164:     }",
      "165: }",
      "174: class HTMLPurifier_HTMLModule_Noreferrer extends HTMLPurifier_HTMLModule {",
      "176:     public $name = 'Noreferrer';",
      "183:     public function setup($config) {",
      "184:         $a = $this->addBlankElement('a');",
      "185:         $a->attr_transform_post[] = new HTMLPurifier_AttrTransform_Noreferrer();",
      "186:     }",
      "187: }",
      "",
      "---------------"
    ],
    "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php": [
      "File: lib/tests/htmlpurifier_test.php -> lib/tests/htmlpurifier_test.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "42:     public function test_allow_blank_target() {",
      "43:         $text = '<a href=\"http://moodle.org\" target=\"_blank\">Some link</a>';",
      "44:         $result = format_text($text, FORMAT_HTML);",
      "47:         $result = format_text('<a href=\"http://moodle.org\" target=\"some\">Some link</a>', FORMAT_HTML);",
      "48:         $this->assertSame('<a href=\"http://moodle.org\">Some link</a>', $result);",
      "",
      "[Removed Lines]",
      "45:         $this->assertSame($text, $result);",
      "",
      "[Added Lines]",
      "47:         $expected = '<a href=\"http://moodle.org\" target=\"_blank\" rel=\"noreferrer\">Some link</a>';",
      "49:         $this->assertSame($expected, $result);",
      "",
      "---------------"
    ],
    "lib/weblib.php||lib/weblib.php": [
      "File: lib/weblib.php -> lib/weblib.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1754:         $config = HTMLPurifier_Config::createDefault();",
      "1756:         $config->set('HTML.DefinitionID', 'moodlehtml');",
      "1758:         $config->set('Cache.SerializerPath', $cachedir);",
      "1759:         $config->set('Cache.SerializerPermissions', $CFG->directorypermissions);",
      "1760:         $config->set('Core.NormalizeNewlines', false);",
      "",
      "[Removed Lines]",
      "1757:         $config->set('HTML.DefinitionRev', 3);",
      "",
      "[Added Lines]",
      "1757:         $config->set('HTML.DefinitionRev', 4);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "1798:             $def->manager->addModule(new HTMLPurifier_HTMLModule_Ruby());",
      "1799:         }",
      "1801:         $purifier = new HTMLPurifier($config);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1801:             $def->manager->addModule(new HTMLPurifier_HTMLModule_Noreferrer());",
      "",
      "---------------"
    ],
    "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php": [
      "File: mod/data/field/url/field.class.php -> mod/data/field/url/field.class.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "143:                 if ($this->field->param3) {",
      "145:                     $attributes['target'] = '_blank';",
      "146:                 }",
      "148:                 if (empty($text)) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "146:                     $attributes['rel'] = 'noreferrer';",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "4d6f159f681882496e05ddacf2561929d2d23f0e",
      "candidate_info": {
        "commit_hash": "4d6f159f681882496e05ddacf2561929d2d23f0e",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/4d6f159f681882496e05ddacf2561929d2d23f0e",
        "files": [
          "lib/htmlpurifier/locallib.php",
          "lib/tests/htmlpurifier_test.php",
          "lib/weblib.php",
          "mod/data/field/url/field.class.php"
        ],
        "message": "MDL-52651 htmlpurifier: Append rel=noreferrer to links.\n\nThank you to Zachary Durber for originally working on this issue.",
        "before_after_code_files": [
          "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
          "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
          "lib/weblib.php||lib/weblib.php",
          "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
            "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
            "lib/weblib.php||lib/weblib.php",
            "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
          ],
          "candidate": [
            "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
            "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
            "lib/weblib.php||lib/weblib.php",
            "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php": [
          "File: lib/htmlpurifier/locallib.php -> lib/htmlpurifier/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "119:     }",
          "121: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "130: class HTMLPurifier_AttrTransform_Noreferrer extends HTMLPurifier_AttrTransform {",
          "132:     private $parser;",
          "137:     public function __construct() {",
          "138:         $this->parser = new HTMLPurifier_URIParser();",
          "139:     }",
          "152:     public function transform($attr, $config, $context) {",
          "154:         if (!empty($attr['rel']) && substr($attr['rel'], 'noreferrer') !== false) {",
          "155:             return $attr;",
          "156:         }",
          "159:         if (!empty($attr['target']) && $attr['target'] == '_blank') {",
          "160:             $attr['rel'] = !empty($attr['rel']) ? $attr['rel'] . ' noreferrer' : 'noreferrer';",
          "161:         }",
          "163:         return $attr;",
          "164:     }",
          "165: }",
          "174: class HTMLPurifier_HTMLModule_Noreferrer extends HTMLPurifier_HTMLModule {",
          "176:     public $name = 'Noreferrer';",
          "183:     public function setup($config) {",
          "184:         $a = $this->addBlankElement('a');",
          "185:         $a->attr_transform_post[] = new HTMLPurifier_AttrTransform_Noreferrer();",
          "186:     }",
          "187: }",
          "",
          "---------------"
        ],
        "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php": [
          "File: lib/tests/htmlpurifier_test.php -> lib/tests/htmlpurifier_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:     public function test_allow_blank_target() {",
          "43:         $text = '<a href=\"http://moodle.org\" target=\"_blank\">Some link</a>';",
          "44:         $result = format_text($text, FORMAT_HTML);",
          "47:         $result = format_text('<a href=\"http://moodle.org\" target=\"some\">Some link</a>', FORMAT_HTML);",
          "48:         $this->assertSame('<a href=\"http://moodle.org\">Some link</a>', $result);",
          "",
          "[Removed Lines]",
          "45:         $this->assertSame($text, $result);",
          "",
          "[Added Lines]",
          "47:         $expected = '<a href=\"http://moodle.org\" target=\"_blank\" rel=\"noreferrer\">Some link</a>';",
          "49:         $this->assertSame($expected, $result);",
          "",
          "---------------"
        ],
        "lib/weblib.php||lib/weblib.php": [
          "File: lib/weblib.php -> lib/weblib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1733:         $config = HTMLPurifier_Config::createDefault();",
          "1735:         $config->set('HTML.DefinitionID', 'moodlehtml');",
          "1737:         $config->set('Cache.SerializerPath', $cachedir);",
          "1738:         $config->set('Cache.SerializerPermissions', $CFG->directorypermissions);",
          "1739:         $config->set('Core.NormalizeNewlines', false);",
          "",
          "[Removed Lines]",
          "1736:         $config->set('HTML.DefinitionRev', 3);",
          "",
          "[Added Lines]",
          "1736:         $config->set('HTML.DefinitionRev', 4);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1777:             $def->manager->addModule(new HTMLPurifier_HTMLModule_Ruby());",
          "1778:         }",
          "1780:         $purifier = new HTMLPurifier($config);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1780:             $def->manager->addModule(new HTMLPurifier_HTMLModule_Noreferrer());",
          "",
          "---------------"
        ],
        "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php": [
          "File: mod/data/field/url/field.class.php -> mod/data/field/url/field.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "143:                 if ($this->field->param3) {",
          "145:                     $attributes['target'] = '_blank';",
          "146:                 }",
          "148:                 if (empty($text)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "146:                     $attributes['rel'] = 'noreferrer';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "190757854d9ce3b3ce3100dc76de54277f3bdd14",
      "candidate_info": {
        "commit_hash": "190757854d9ce3b3ce3100dc76de54277f3bdd14",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/190757854d9ce3b3ce3100dc76de54277f3bdd14",
        "files": [
          "lib/htmlpurifier/locallib.php",
          "lib/tests/htmlpurifier_test.php",
          "lib/weblib.php",
          "mod/data/field/url/field.class.php"
        ],
        "message": "MDL-52651 htmlpurifier: Append rel=noreferrer to links.\n\nThank you to Zachary Durber for originally working on this issue.",
        "before_after_code_files": [
          "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
          "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
          "lib/weblib.php||lib/weblib.php",
          "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
            "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
            "lib/weblib.php||lib/weblib.php",
            "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
          ],
          "candidate": [
            "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
            "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
            "lib/weblib.php||lib/weblib.php",
            "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php": [
          "File: lib/htmlpurifier/locallib.php -> lib/htmlpurifier/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "119:     }",
          "121: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "130: class HTMLPurifier_AttrTransform_Noreferrer extends HTMLPurifier_AttrTransform {",
          "132:     private $parser;",
          "137:     public function __construct() {",
          "138:         $this->parser = new HTMLPurifier_URIParser();",
          "139:     }",
          "152:     public function transform($attr, $config, $context) {",
          "154:         if (!empty($attr['rel']) && substr($attr['rel'], 'noreferrer') !== false) {",
          "155:             return $attr;",
          "156:         }",
          "159:         if (!empty($attr['target']) && $attr['target'] == '_blank') {",
          "160:             $attr['rel'] = !empty($attr['rel']) ? $attr['rel'] . ' noreferrer' : 'noreferrer';",
          "161:         }",
          "163:         return $attr;",
          "164:     }",
          "165: }",
          "174: class HTMLPurifier_HTMLModule_Noreferrer extends HTMLPurifier_HTMLModule {",
          "176:     public $name = 'Noreferrer';",
          "183:     public function setup($config) {",
          "184:         $a = $this->addBlankElement('a');",
          "185:         $a->attr_transform_post[] = new HTMLPurifier_AttrTransform_Noreferrer();",
          "186:     }",
          "187: }",
          "",
          "---------------"
        ],
        "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php": [
          "File: lib/tests/htmlpurifier_test.php -> lib/tests/htmlpurifier_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:     public function test_allow_blank_target() {",
          "43:         $text = '<a href=\"http://moodle.org\" target=\"_blank\">Some link</a>';",
          "44:         $result = format_text($text, FORMAT_HTML);",
          "47:         $result = format_text('<a href=\"http://moodle.org\" target=\"some\">Some link</a>', FORMAT_HTML);",
          "48:         $this->assertSame('<a href=\"http://moodle.org\">Some link</a>', $result);",
          "",
          "[Removed Lines]",
          "45:         $this->assertSame($text, $result);",
          "",
          "[Added Lines]",
          "47:         $expected = '<a href=\"http://moodle.org\" target=\"_blank\" rel=\"noreferrer\">Some link</a>';",
          "49:         $this->assertSame($expected, $result);",
          "",
          "---------------"
        ],
        "lib/weblib.php||lib/weblib.php": [
          "File: lib/weblib.php -> lib/weblib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1733:         $config = HTMLPurifier_Config::createDefault();",
          "1735:         $config->set('HTML.DefinitionID', 'moodlehtml');",
          "1737:         $config->set('Cache.SerializerPath', $cachedir);",
          "1738:         $config->set('Cache.SerializerPermissions', $CFG->directorypermissions);",
          "1739:         $config->set('Core.NormalizeNewlines', false);",
          "",
          "[Removed Lines]",
          "1736:         $config->set('HTML.DefinitionRev', 3);",
          "",
          "[Added Lines]",
          "1736:         $config->set('HTML.DefinitionRev', 4);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1777:             $def->manager->addModule(new HTMLPurifier_HTMLModule_Ruby());",
          "1778:         }",
          "1780:         $purifier = new HTMLPurifier($config);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1780:             $def->manager->addModule(new HTMLPurifier_HTMLModule_Noreferrer());",
          "",
          "---------------"
        ],
        "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php": [
          "File: mod/data/field/url/field.class.php -> mod/data/field/url/field.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "114:                 if ($this->field->param3) {",
          "116:                     $attributes['target'] = '_blank';",
          "117:                 }",
          "119:                 if (empty($text)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "117:                     $attributes['rel'] = 'noreferrer';",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9f91c23536a31ba2dc91b0ba2ae726b1757a20cb",
      "candidate_info": {
        "commit_hash": "9f91c23536a31ba2dc91b0ba2ae726b1757a20cb",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/9f91c23536a31ba2dc91b0ba2ae726b1757a20cb",
        "files": [
          "lib/htmlpurifier/locallib.php",
          "lib/tests/htmlpurifier_test.php",
          "lib/weblib.php",
          "mod/data/field/url/field.class.php"
        ],
        "message": "MDL-52651 htmlpurifier: Append rel=noreferrer to links.\n\nThank you to Zachary Durber for originally working on this issue.",
        "before_after_code_files": [
          "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
          "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
          "lib/weblib.php||lib/weblib.php",
          "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
            "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
            "lib/weblib.php||lib/weblib.php",
            "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
          ],
          "candidate": [
            "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php",
            "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php",
            "lib/weblib.php||lib/weblib.php",
            "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php"
          ]
        }
      },
      "candidate_diff": {
        "lib/htmlpurifier/locallib.php||lib/htmlpurifier/locallib.php": [
          "File: lib/htmlpurifier/locallib.php -> lib/htmlpurifier/locallib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "103:     }",
          "105: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "114: class HTMLPurifier_AttrTransform_Noreferrer extends HTMLPurifier_AttrTransform {",
          "116:     private $parser;",
          "121:     public function __construct() {",
          "122:         $this->parser = new HTMLPurifier_URIParser();",
          "123:     }",
          "136:     public function transform($attr, $config, $context) {",
          "138:         if (!empty($attr['rel']) && substr($attr['rel'], 'noreferrer') !== false) {",
          "139:             return $attr;",
          "140:         }",
          "143:         if (!empty($attr['target']) && $attr['target'] == '_blank') {",
          "144:             $attr['rel'] = !empty($attr['rel']) ? $attr['rel'] . ' noreferrer' : 'noreferrer';",
          "145:         }",
          "147:         return $attr;",
          "148:     }",
          "149: }",
          "158: class HTMLPurifier_HTMLModule_Noreferrer extends HTMLPurifier_HTMLModule {",
          "160:     public $name = 'Noreferrer';",
          "167:     public function setup($config) {",
          "168:         $a = $this->addBlankElement('a');",
          "169:         $a->attr_transform_post[] = new HTMLPurifier_AttrTransform_Noreferrer();",
          "170:     }",
          "171: }",
          "",
          "---------------"
        ],
        "lib/tests/htmlpurifier_test.php||lib/tests/htmlpurifier_test.php": [
          "File: lib/tests/htmlpurifier_test.php -> lib/tests/htmlpurifier_test.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "42:     public function test_allow_blank_target() {",
          "43:         $text = '<a href=\"http://moodle.org\" target=\"_blank\">Some link</a>';",
          "44:         $result = format_text($text, FORMAT_HTML);",
          "47:         $result = format_text('<a href=\"http://moodle.org\" target=\"some\">Some link</a>', FORMAT_HTML);",
          "48:         $this->assertSame('<a href=\"http://moodle.org\">Some link</a>', $result);",
          "",
          "[Removed Lines]",
          "45:         $this->assertSame($text, $result);",
          "",
          "[Added Lines]",
          "47:         $expected = '<a href=\"http://moodle.org\" target=\"_blank\" rel=\"noreferrer\">Some link</a>';",
          "49:         $this->assertSame($expected, $result);",
          "",
          "---------------"
        ],
        "lib/weblib.php||lib/weblib.php": [
          "File: lib/weblib.php -> lib/weblib.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1671:         $config = HTMLPurifier_Config::createDefault();",
          "1673:         $config->set('HTML.DefinitionID', 'moodlehtml');",
          "1675:         $config->set('Cache.SerializerPath', $cachedir);",
          "1676:         $config->set('Cache.SerializerPermissions', $CFG->directorypermissions);",
          "1677:         $config->set('Core.NormalizeNewlines', false);",
          "",
          "[Removed Lines]",
          "1674:         $config->set('HTML.DefinitionRev', 2);",
          "",
          "[Added Lines]",
          "1674:         $config->set('HTML.DefinitionRev', 3);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1709:             $def->addElement('algebra', 'Inline', 'Inline', array());                   // Algebra syntax, equivalent to @@xx@@.",
          "1710:             $def->addElement('lang', 'Block', 'Flow', array(), array('lang'=>'CDATA')); // Original multilang style - only our hacked lang attribute.",
          "1711:             $def->addAttribute('span', 'xxxlang', 'CDATA');                             // Current very problematic multilang.",
          "1712:         }",
          "1714:         $purifier = new HTMLPurifier($config);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1714:             $def->manager->addModule(new HTMLPurifier_HTMLModule_Noreferrer());",
          "",
          "---------------"
        ],
        "mod/data/field/url/field.class.php||mod/data/field/url/field.class.php": [
          "File: mod/data/field/url/field.class.php -> mod/data/field/url/field.class.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "114:                 if ($this->field->param3) {",
          "116:                     $attributes['target'] = '_blank';",
          "117:                 }",
          "119:                 if (empty($text)) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "117:                     $attributes['rel'] = 'noreferrer';",
          "",
          "---------------"
        ]
      }
    }
  ]
}