{
  "cve_id": "CVE-2020-23907",
  "cve_desc": "An issue was discovered in retdec v3.3. In function canSplitFunctionOn() of ir_modifications.cpp, there is a possible out of bounds read due to a heap buffer overflow. The impact is: Deny of Service, Memory Disclosure, and Possible Code Execution.",
  "repo": "avast/retdec",
  "patch_hash": "517298bafaaff0a8e3dd60dd055a67c41b545807",
  "patch_info": {
    "commit_hash": "517298bafaaff0a8e3dd60dd055a67c41b545807",
    "repo": "avast/retdec",
    "commit_url": "https://github.com/avast/retdec/commit/517298bafaaff0a8e3dd60dd055a67c41b545807",
    "files": [
      "src/bin2llvmir/optimizations/decoder/ir_modifications.cpp"
    ],
    "message": "Try to fix issue #637\n\nReference: https://github.com/avast/retdec/issues/637",
    "before_after_code_files": [
      "src/bin2llvmir/optimizations/decoder/ir_modifications.cpp||src/bin2llvmir/optimizations/decoder/ir_modifications.cpp"
    ]
  },
  "patch_diff": {
    "src/bin2llvmir/optimizations/decoder/ir_modifications.cpp||src/bin2llvmir/optimizations/decoder/ir_modifications.cpp": [
      "File: src/bin2llvmir/optimizations/decoder/ir_modifications.cpp -> src/bin2llvmir/optimizations/decoder/ir_modifications.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "423:     continue;",
      "424:    }",
      "425:    auto up = fncStarts.upper_bound(bAddr);",
      "426:    --up;",
      "427:    Address bFnc = *up;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "426:    if (up == fncStarts.begin()) {",
      "427:     return false;",
      "428:    }",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "442:      continue;",
      "443:     }",
      "444:     auto up = fncStarts.upper_bound(pAddr);",
      "445:     --up;",
      "446:     Address pFnc = *up;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "448:     if (up == fncStarts.begin()) {",
      "449:      return false;",
      "450:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "29bf76ea1c209bb8ae2fab290f7ba5d81b262466",
      "candidate_info": {
        "commit_hash": "29bf76ea1c209bb8ae2fab290f7ba5d81b262466",
        "repo": "avast/retdec",
        "commit_url": "https://github.com/avast/retdec/commit/29bf76ea1c209bb8ae2fab290f7ba5d81b262466",
        "files": [
          "src/bin2llvmir/optimizations/decoder/ir_modifications.cpp"
        ],
        "message": "bin2llvmir: Remove useless trailing whitespace.",
        "before_after_code_files": [
          "src/bin2llvmir/optimizations/decoder/ir_modifications.cpp||src/bin2llvmir/optimizations/decoder/ir_modifications.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/bin2llvmir/optimizations/decoder/ir_modifications.cpp||src/bin2llvmir/optimizations/decoder/ir_modifications.cpp"
          ],
          "candidate": [
            "src/bin2llvmir/optimizations/decoder/ir_modifications.cpp||src/bin2llvmir/optimizations/decoder/ir_modifications.cpp"
          ]
        }
      },
      "candidate_diff": {
        "src/bin2llvmir/optimizations/decoder/ir_modifications.cpp||src/bin2llvmir/optimizations/decoder/ir_modifications.cpp": [
          "File: src/bin2llvmir/optimizations/decoder/ir_modifications.cpp -> src/bin2llvmir/optimizations/decoder/ir_modifications.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "425:    auto up = fncStarts.upper_bound(bAddr);",
          "426:    if (up == fncStarts.begin()) {",
          "427:     return false;",
          "429:    --up;",
          "430:    Address bFnc = *up;",
          "",
          "[Removed Lines]",
          "428:    }",
          "",
          "[Added Lines]",
          "428:    }",
          "",
          "---------------"
        ]
      }
    }
  ]
}