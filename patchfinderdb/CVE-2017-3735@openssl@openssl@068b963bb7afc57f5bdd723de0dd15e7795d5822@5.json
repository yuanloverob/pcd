{
  "cve_id": "CVE-2017-3735",
  "cve_desc": "While parsing an IPAddressFamily extension in an X.509 certificate, it is possible to do a one-byte overread. This would result in an incorrect text display of the certificate. This bug has been present since 2006 and is present in all versions of OpenSSL before 1.0.2m and 1.1.0g.",
  "repo": "openssl/openssl",
  "patch_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
  "patch_info": {
    "commit_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
    "repo": "openssl/openssl",
    "commit_url": "https://github.com/openssl/openssl/commit/068b963bb7afc57f5bdd723de0dd15e7795d5822",
    "files": [
      "crypto/x509v3/v3_addr.c"
    ],
    "message": "Avoid out-of-bounds read\n\nFixes CVE 2017-3735\n\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\n(Merged from https://github.com/openssl/openssl/pull/4276)\n\n(cherry picked from commit b23171744b01e473ebbfd6edad70c1c3825ffbcd)",
    "before_after_code_files": [
      "crypto/x509v3/v3_addr.c||crypto/x509v3/v3_addr.c"
    ]
  },
  "patch_diff": {
    "crypto/x509v3/v3_addr.c||crypto/x509v3/v3_addr.c": [
      "File: crypto/x509v3/v3_addr.c -> crypto/x509v3/v3_addr.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "85: unsigned int X509v3_addr_get_afi(const IPAddressFamily *f)",
      "86: {",
      "91: }",
      "",
      "[Removed Lines]",
      "87:     return ((f != NULL &&",
      "88:              f->addressFamily != NULL && f->addressFamily->data != NULL)",
      "89:             ? ((f->addressFamily->data[0] << 8) | (f->addressFamily->data[1]))",
      "90:             : 0);",
      "",
      "[Added Lines]",
      "87:     if (f == NULL",
      "88:             || f->addressFamily == NULL",
      "89:             || f->addressFamily->data == NULL",
      "90:             || f->addressFamily->length < 2)",
      "91:         return 0;",
      "92:     return (f->addressFamily->data[0] << 8) | f->addressFamily->data[1];",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e98d190693482b5bd94c1bd68cd8798ca486bc0c",
      "candidate_info": {
        "commit_hash": "e98d190693482b5bd94c1bd68cd8798ca486bc0c",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/e98d190693482b5bd94c1bd68cd8798ca486bc0c",
        "files": [
          "util/libcrypto.num"
        ],
        "message": "make update\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\nReviewed-by: Tim Hudson <tjh@openssl.org>\n\n(cherry picked from commit f1d3de718bc96e70ce76bf2b4ccee128ecbcd100)\n\nReviewed-by: Matt Caswell <matt@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/4723)",
        "before_after_code_files": [
          "util/libcrypto.num||util/libcrypto.num"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "util/libcrypto.num||util/libcrypto.num": [
          "File: util/libcrypto.num -> util/libcrypto.num",
          "--- Hunk 1 ---",
          "[Context before]",
          "4232: ZINT64_it                               4215 1_1_0f EXIST:EXPORT_VAR_AS_FUNCTION:FUNCTION:",
          "4233: CRYPTO_secure_clear_free                4315 1_1_0g EXIST::FUNCTION:",
          "4234: EVP_PKEY_set1_engine                    4347 1_1_0g EXIST::FUNCTION:ENGINE",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4235: OCSP_resp_get0_signer                   4374 1_1_0h EXIST::FUNCTION:OCSP",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b4d6f713d6c5b55a2887d79435490a503da39ae5",
      "candidate_info": {
        "commit_hash": "b4d6f713d6c5b55a2887d79435490a503da39ae5",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/b4d6f713d6c5b55a2887d79435490a503da39ae5",
        "files": [
          "apps/speed.c",
          "crypto/dh/dh_key.c",
          "crypto/dh/dh_lib.c",
          "crypto/dsa/dsa_lib.c",
          "crypto/dsa/dsa_ossl.c",
          "crypto/rsa/rsa_lib.c",
          "crypto/rsa/rsa_ossl.c",
          "crypto/ui/ui_lib.c",
          "crypto/ui/ui_openssl.c",
          "doc/crypto/DH_set_method.pod",
          "doc/crypto/DSA_set_method.pod",
          "doc/crypto/RSA_set_method.pod"
        ],
        "message": "Make default_method mostly compile-time\n\nDocument thread-safety issues\n\nCherry-pick from 076fc55527a1499391fa6de109c8387895199ee9 but\nkeeps the RSA_null method.\n\nReviewed-by: Geoff Thorpe <geoff@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/3146)",
        "before_after_code_files": [
          "apps/speed.c||apps/speed.c",
          "crypto/dh/dh_key.c||crypto/dh/dh_key.c",
          "crypto/dh/dh_lib.c||crypto/dh/dh_lib.c",
          "crypto/dsdsa_lib.c||crypto/dsa/dsa_lib.c",
          "crypto/dsdsa_ossl.c||crypto/dsa/dsa_ossl.c",
          "crypto/rsrsa_lib.c||crypto/rsa/rsa_lib.c",
          "crypto/rsrsa_ossl.c||crypto/rsa/rsa_ossl.c",
          "crypto/ui/ui_lib.c||crypto/ui/ui_lib.c",
          "crypto/ui/ui_openssl.c||crypto/ui/ui_openssl.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "apps/speed.c||apps/speed.c": [
          "File: apps/speed.c -> apps/speed.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1465:             continue;",
          "1466:         }",
          "1467: #ifndef OPENSSL_NO_RSA",
          "1471:             continue;",
          "1474:         if (strcmp(*argv, \"rsa\") == 0) {",
          "1475:             rsa_doit[R_RSA_512] = rsa_doit[R_RSA_1024] =",
          "1476:                 rsa_doit[R_RSA_2048] = rsa_doit[R_RSA_3072] =",
          "",
          "[Removed Lines]",
          "1468: # ifndef RSA_NULL",
          "1469:         if (strcmp(*argv, \"openssl\") == 0) {",
          "1470:             RSA_set_default_method(RSA_PKCS1_OpenSSL());",
          "1472:         }",
          "1473: # endif",
          "",
          "[Added Lines]",
          "1468:         if (strcmp(*argv, \"openssl\") == 0)",
          "",
          "---------------"
        ],
        "crypto/dh/dh_key.c||crypto/dh/dh_key.c": [
          "File: crypto/dh/dh_key.c -> crypto/dh/dh_key.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "56:     NULL",
          "57: };",
          "59: const DH_METHOD *DH_OpenSSL(void)",
          "60: {",
          "61:     return &dh_ossl;",
          "62: }",
          "64: static int generate_key(DH *dh)",
          "65: {",
          "66:     int ok = 0;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "59: static const DH_METHOD *default_DH_method = &dh_ossl;",
          "66: void DH_set_default_method(const DH_METHOD *meth)",
          "67: {",
          "68:     default_DH_method = meth;",
          "69: }",
          "71: const DH_METHOD *DH_get_default_method(void)",
          "72: {",
          "73:     return default_DH_method;",
          "74: }",
          "",
          "---------------"
        ],
        "crypto/dh/dh_lib.c||crypto/dh/dh_lib.c": [
          "File: crypto/dh/dh_lib.c -> crypto/dh/dh_lib.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "13: #include \"dh_locl.h\"",
          "14: #include <openssl/engine.h>",
          "30: int DH_set_method(DH *dh, const DH_METHOD *meth)",
          "31: {",
          "",
          "[Removed Lines]",
          "16: static const DH_METHOD *default_DH_method = NULL;",
          "18: void DH_set_default_method(const DH_METHOD *meth)",
          "19: {",
          "20:     default_DH_method = meth;",
          "21: }",
          "23: const DH_METHOD *DH_get_default_method(void)",
          "24: {",
          "25:     if (!default_DH_method)",
          "26:         default_DH_method = DH_OpenSSL();",
          "27:     return default_DH_method;",
          "28: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "crypto/dsdsa_lib.c||crypto/dsa/dsa_lib.c": [
          "File: crypto/dsdsa_lib.c -> crypto/dsa/dsa_lib.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "crypto/dsdsa_ossl.c||crypto/dsa/dsa_ossl.c": [
          "File: crypto/dsdsa_ossl.c -> crypto/dsa/dsa_ossl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44: static const DSA_METHOD *default_DSA_method = &openssl_dsa_meth;",
          "46: void DSA_set_default_method(const DSA_METHOD *meth)",
          "47: {",
          "48:     default_DSA_method = meth;",
          "49: }",
          "51: const DSA_METHOD *DSA_get_default_method(void)",
          "52: {",
          "53:     return default_DSA_method;",
          "54: }",
          "",
          "---------------"
        ],
        "crypto/rsrsa_lib.c||crypto/rsa/rsa_lib.c": [
          "File: crypto/rsrsa_lib.c -> crypto/rsa/rsa_lib.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "20:     return RSA_new_method(NULL);",
          "",
          "---------------"
        ],
        "crypto/rsrsa_ossl.c||crypto/rsa/rsa_ossl.c": [
          "File: crypto/rsrsa_ossl.c -> crypto/rsa/rsa_ossl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "27:     \"OpenSSL PKCS#1 RSA\",",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44: static const RSA_METHOD *default_RSA_meth = &rsa_pkcs1_ossl_meth;",
          "46: void RSA_set_default_method(const RSA_METHOD *meth)",
          "47: {",
          "48:     default_RSA_meth = meth;",
          "49: }",
          "51: const RSA_METHOD *RSA_get_default_method(void)",
          "52: {",
          "53:     return default_RSA_meth;",
          "54: }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "crypto/ui/ui_lib.c||crypto/ui/ui_lib.c": [
          "File: crypto/ui/ui_lib.c -> crypto/ui/ui_lib.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "15: #include <openssl/err.h>",
          "16: #include \"ui_locl.h\"",
          "20: UI *UI_new(void)",
          "21: {",
          "22:     return (UI_new_method(NULL));",
          "",
          "[Removed Lines]",
          "18: static const UI_METHOD *default_UI_meth = NULL;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "531:     return (CRYPTO_get_ex_data(&r->ex_data, idx));",
          "532: }",
          "547: const UI_METHOD *UI_get_method(UI *ui)",
          "548: {",
          "549:     return ui->meth;",
          "",
          "[Removed Lines]",
          "534: void UI_set_default_method(const UI_METHOD *meth)",
          "535: {",
          "536:     default_UI_meth = meth;",
          "537: }",
          "539: const UI_METHOD *UI_get_default_method(void)",
          "540: {",
          "541:     if (default_UI_meth == NULL) {",
          "542:         default_UI_meth = UI_OpenSSL();",
          "543:     }",
          "544:     return default_UI_meth;",
          "545: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "crypto/ui/ui_openssl.c||crypto/ui/ui_openssl.c": [
          "File: crypto/ui/ui_openssl.c -> crypto/ui/ui_openssl.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "202:     NULL",
          "203: };",
          "206: UI_METHOD *UI_OpenSSL(void)",
          "207: {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "205: static const UI_METHOD *default_UI_meth = &ui_openssl;",
          "207: void UI_set_default_method(const UI_METHOD *meth)",
          "208: {",
          "209:     default_UI_meth = meth;",
          "210: }",
          "212: const UI_METHOD *UI_get_default_method(void)",
          "213: {",
          "214:     return default_UI_meth;",
          "215: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "39184b24ebf99e4b237725255e679cd3a3d7a7d3",
      "candidate_info": {
        "commit_hash": "39184b24ebf99e4b237725255e679cd3a3d7a7d3",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/39184b24ebf99e4b237725255e679cd3a3d7a7d3",
        "files": [
          "crypto/armcap.c",
          "crypto/ia64cpuid.S",
          "crypto/init.c",
          "crypto/o_time.c"
        ],
        "message": "Fix typo in files in crypto folder\n\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\nReviewed-by: Andy Polyakov <appro@openssl.org>\nGH: #4093\n(cherry picked from commit c9a41d7dd631a69b73bea8af714a3a8b872b8309)",
        "before_after_code_files": [
          "crypto/armcap.c||crypto/armcap.c",
          "crypto/ia64cpuid.S||crypto/ia64cpuid.S",
          "crypto/init.c||crypto/init.c",
          "crypto/o_time.c||crypto/o_time.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "crypto/armcap.c||crypto/armcap.c": [
          "File: crypto/armcap.c -> crypto/armcap.c"
        ],
        "crypto/ia64cpuid.S||crypto/ia64cpuid.S": [
          "File: crypto/ia64cpuid.S -> crypto/ia64cpuid.S"
        ],
        "crypto/init.c||crypto/init.c": [
          "File: crypto/init.c -> crypto/init.c"
        ],
        "crypto/o_time.c||crypto/o_time.c": [
          "File: crypto/o_time.c -> crypto/o_time.c"
        ]
      }
    },
    {
      "candidate_hash": "4f321cc19e28442e313b6915a1b9928e77a75ab7",
      "candidate_info": {
        "commit_hash": "4f321cc19e28442e313b6915a1b9928e77a75ab7",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/4f321cc19e28442e313b6915a1b9928e77a75ab7",
        "files": [
          "Configurations/10-main.conf"
        ],
        "message": "Add anything specifying a threads library to ex_libs\n\nEven -pthread gets treated that way.  The reason to do this is so it\nends up in 'Libs.private' in libcrypto.pc.\n\nFixes #3884\n\nReviewed-by: Bernd Edlinger <bernd.edlinger@hotmail.de>\n(Merged from https://github.com/openssl/openssl/pull/5135)",
        "before_after_code_files": [
          "Configurations/10-main.conf||Configurations/10-main.conf"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Configurations/10-main.conf||Configurations/10-main.conf": [
          "File: Configurations/10-main.conf -> Configurations/10-main.conf",
          "--- Hunk 1 ---",
          "[Context before]",
          "204:                                               debug   => \"-O0 -g\",",
          "205:                                               release => \"-O3 -fomit-frame-pointer\"),",
          "206:                                        threads(\"-pthread\")),",
          "207:         bn_ops           => \"BN_LLONG\",",
          "208:         shared_cflag     => \"-fPIC\",",
          "209:         shared_ldflag    => \"-shared -static-libgcc\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "207:         ex_libs          => add(threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "223:                                               debug   => \"-O0 -g\",",
          "224:                                               release => \"-O3\"),",
          "225:                                        threads(\"-pthread\")),",
          "226:         bn_ops           => \"SIXTY_FOUR_BIT_LONG\",",
          "227:         perlasm_scheme   => \"elf\",",
          "228:         shared_cflag     => \"-fPIC\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "227:         ex_libs          => add(threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "268:                                               debug   => \"-O0 -g\",",
          "269:                                               release => \"-O3\"),",
          "270:                                        threads(\"-pthread\")),",
          "271:         bn_ops           => \"BN_LLONG RC4_CHAR\",",
          "272:         shared_cflag     => \"-fPIC\",",
          "273:         shared_ldflag    => \"-shared\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "273:         ex_libs          => add(threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "432:                                            debug   => \"-O0 -g\",",
          "433:                                            release => \"-O3\"),",
          "434:                                     threads(\"-pthread\")),",
          "436:         bn_ops           => \"BN_LLONG\",",
          "437:         thread_scheme    => \"pthreads\",",
          "438:         dso_scheme       => \"dl\",",
          "",
          "[Removed Lines]",
          "435:         ex_libs          => add(\"-Wl,+s -ldld\"),",
          "",
          "[Added Lines]",
          "438:         ex_libs          => add(\"-Wl,+s -ldld\", threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "551:                                            debug   => \"-O0 -g\",",
          "552:                                            release => \"-O3\"),",
          "553:                                     threads(\"-pthread\")),",
          "555:         bn_ops           => \"SIXTY_FOUR_BIT\",",
          "556:         thread_scheme    => \"pthreads\",",
          "557:         dso_scheme       => \"dlfcn\",",
          "",
          "[Removed Lines]",
          "554:         ex_libs          => add(\"-ldl\"),",
          "",
          "[Added Lines]",
          "557:         ex_libs          => add(\"-ldl\", threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "568:                                            debug   => \"-O0 -g\",",
          "569:                                            release => \"-O3\"),",
          "570:                                     threads(\"-pthread\")),",
          "572:         bn_ops           => \"SIXTY_FOUR_BIT_LONG\",",
          "573:         thread_scheme    => \"pthreads\",",
          "574:         dso_scheme       => \"dlfcn\",",
          "",
          "[Removed Lines]",
          "571:         ex_libs          => add(\"-ldl\"),",
          "",
          "[Added Lines]",
          "574:         ex_libs          => add(\"-ldl\", threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "599:         cc               => \"gcc\",",
          "600:         cflags           => combine(\"-std=c9x -D_XOPEN_SOURCE=500 -D_OSF_SOURCE -O3\",",
          "601:                                     threads(\"-pthread\")),",
          "603:         bn_ops           => \"SIXTY_FOUR_BIT_LONG\",",
          "604:         thread_scheme    => \"pthreads\",",
          "605:         dso_scheme       => \"dlfcn\",",
          "",
          "[Removed Lines]",
          "602:         ex_libs          => \"-lrt\",    # for mlock(2)",
          "",
          "[Added Lines]",
          "605:         ex_libs          => add(\"-lrt\", threads(\"-pthread\")), # for mlock(2)",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "611:         cc               => \"cc\",",
          "612:         cflags           => combine(\"-std1 -D_XOPEN_SOURCE=500 -D_OSF_SOURCE -tune host -fast -readonly_strings\",",
          "613:                                     threads(\"-pthread\")),",
          "615:         bn_ops           => \"SIXTY_FOUR_BIT_LONG\",",
          "616:         thread_scheme    => \"pthreads\",",
          "617:         dso_scheme       => \"dlfcn\",",
          "",
          "[Removed Lines]",
          "614:         ex_libs          => \"-lrt\",    # for mlock(2)",
          "",
          "[Added Lines]",
          "617:         ex_libs          => add(\"-lrt\", threads(\"-pthread\")), # for mlock(2)",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "632:                                            debug   => \"-O0 -g\",",
          "633:                                            release => \"-O3\"),",
          "634:                                     threads(\"-pthread\")),",
          "636:         bn_ops           => \"BN_LLONG RC4_CHAR\",",
          "637:         thread_scheme    => \"pthreads\",",
          "638:         dso_scheme       => \"dlfcn\",",
          "",
          "[Removed Lines]",
          "635:         ex_libs          => add(\"-ldl\"),",
          "",
          "[Added Lines]",
          "638:         ex_libs          => add(\"-ldl\", threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "1177:                                            debug   => \"-O0 -g\",",
          "1178:                                            release => \"-O\"),",
          "1179:                                     threads(\"-pthread\")),",
          "1180:         sys_id           => \"AIX\",",
          "1181:         bn_ops           => \"BN_LLONG RC4_CHAR\",",
          "1182:         thread_scheme    => \"pthreads\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1183:         ex_libs          => add(threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "1194:                                            debug   => \"-O0 -g\",",
          "1195:                                            release => \"-O\"),",
          "1196:                                     threads(\"-pthread\")),",
          "1197:         sys_id           => \"AIX\",",
          "1198:         bn_ops           => \"SIXTY_FOUR_BIT_LONG RC4_CHAR\",",
          "1199:         thread_scheme    => \"pthreads\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1201:         ex_libs          => add(threads(\"-pthread\")),",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "1647:         cc               => \"gcc\",",
          "1648:         cflags           => combine(\"-DL_ENDIAN -O3 -fomit-frame-pointer -Wall\",",
          "1649:                                     threads(\"-pthread\")),",
          "1651:         bn_ops           => \"BN_LLONG\",",
          "1652:         thread_scheme    => \"pthreads\",",
          "1653:         dso_scheme       => \"dlfcn\",",
          "",
          "[Removed Lines]",
          "1650:         ex_libs          => add(\"-ldl\"),",
          "",
          "[Added Lines]",
          "1655:         ex_libs          => add(\"-ldl\", threads(\"-pthread\")),",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "8e5cd8b012b0fdab1374aefe70959b781c545b10",
      "candidate_info": {
        "commit_hash": "8e5cd8b012b0fdab1374aefe70959b781c545b10",
        "repo": "openssl/openssl",
        "commit_url": "https://github.com/openssl/openssl/commit/8e5cd8b012b0fdab1374aefe70959b781c545b10",
        "files": [
          "Configurations/unix-Makefile.tmpl",
          "Makefile.shared"
        ],
        "message": "Simplify Makefile.shared\n\nMakefile.shared was designed to figure out static library names,\nshared library names, library version compatibility, import library\nnames and the like on its own.  This was a design for pre-1.1.0\nOpenSSL because the main Makefile didn't have all that knowledge.\n\nWith 1.1.0, the situation isn't the same, a lot more knowledge is\nincluded in the main Makefile, and while Makefile.shared did things\nright most of the time (there are some corner cases, such as the\nchoice of .sl or .so as DSO extension on some HPUX versions), there's\nstill an inherent fragility when one has to keep an eye on\nMakefile.shared to make sure it produces what the main Makefile\nproduces.\n\nThis change simplifies Makefile.shared by removing all its\n\"intelligence\" and have it depend entirely on the input from the main\nMakefile instead.  That way, all the naming is driven from\nconfiguration data.\n\nReviewed-by: Rich Salz <rsalz@openssl.org>\n(Merged from https://github.com/openssl/openssl/pull/3983)\n\n(cherry picked from commit d07abe13a7955296da756d3f5032a276ac3d47ee)",
        "before_after_code_files": [
          "Configurations/unix-Makefile.tmpl||Configurations/unix-Makefile.tmpl",
          "Makefile.shared||Makefile.shared"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/EktapopaT/openssl/pull/1"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "Configurations/unix-Makefile.tmpl||Configurations/unix-Makefile.tmpl": [
          "File: Configurations/unix-Makefile.tmpl -> Configurations/unix-Makefile.tmpl",
          "--- Hunk 1 ---",
          "[Context before]",
          "893:       my $shlib_target = $target{shared_target};",
          "894:       my $ordinalsfile = defined($args{ordinals}) ? $args{ordinals}->[1] : \"\";",
          "895:       my $target = shlib_simple($lib);",
          "896:       return <<\"EOF\"",
          "897: # With a build on a Windows POSIX layer (Cygwin or Mingw), we know for a fact",
          "898: # that two files get produced, {shlibname}.dll and {libname}.dll.a.",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "896:       my $target_full = shlib($lib);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "907:   PERL=\"\\$(PERL)\" SRCDIR='\\$(SRCDIR)' DSTDIR=\"$libd\" \\\\",
          "908:   INSTALLTOP='\\$(INSTALLTOP)' LIBDIR='\\$(LIBDIR)' \\\\",
          "909:   LIBDEPS='\\$(PLIB_LDFLAGS) '\"$linklibs\"' \\$(EX_LIBS)' \\\\",
          "912:   CC='\\$(CC)' CFLAGS='\\$(CFLAGS) \\$(LIB_CFLAGS)' \\\\",
          "915:   RC='\\$(RC)' SHARED_RCFLAGS='\\$(RCFLAGS)' \\\\",
          "916:   link_shlib.$shlib_target",
          "917: EOF",
          "",
          "[Removed Lines]",
          "910:   LIBNAME=$libname LIBVERSION=\\$(SHLIB_MAJOR).\\$(SHLIB_MINOR) \\\\",
          "911:   LIBCOMPATVERSIONS=';\\$(SHLIB_VERSION_HISTORY)' \\\\",
          "913:   LDFLAGS='\\$(LDFLAGS)' \\\\",
          "914:   SHARED_LDFLAGS='\\$(LIB_LDFLAGS)' SHLIB_EXT=$shlibext \\\\",
          "",
          "[Added Lines]",
          "911:   LIBNAME=$libname SHLIBVERSION=\\$(SHLIB_MAJOR).\\$(SHLIB_MINOR) \\\\",
          "912:   STLIBNAME=$lib$libext \\\\",
          "913:   SHLIBNAME=$target SHLIBNAME_FULL=$target_full \\\\",
          "915:   LDFLAGS='\\$(LDFLAGS)' SHARED_LDFLAGS='\\$(LIB_LDFLAGS)' \\\\",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "924:   }",
          "925:   sub obj2dso {",
          "926:       my %args = @_;",
          "931:       my $shlibdeps = join(\"\", map { my $d = dirname($_);",
          "932:                                      my $f = basename($_);",
          "933:                                      (my $l = $f) =~ s/^lib//;",
          "",
          "[Removed Lines]",
          "927:       my $lib = $args{lib};",
          "928:       my $libd = dirname($lib);",
          "929:       my $libn = basename($lib);",
          "930:       (my $libname = $libn) =~ s/^lib//;",
          "",
          "[Added Lines]",
          "928:       my $dso = $args{lib};",
          "929:       my $dsod = dirname($dso);",
          "930:       my $dson = basename($dso);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "935:       my $deps = join(\" \",compute_lib_depends(@{$args{deps}}));",
          "936:       my $shlib_target = $target{shared_target};",
          "937:       my $objs = join(\" \", map { $_.$objext } @{$args{objs}});",
          "939:       return <<\"EOF\";",
          "940: $target: $objs $deps",
          "941:  \\$(MAKE) -f \\$(SRCDIR)/Makefile.shared -e \\\\",
          "942:   PLATFORM=\\$(PLATFORM) \\\\",
          "944:   LIBDEPS='\\$(PLIB_LDFLAGS) '\"$shlibdeps\"' \\$(EX_LIBS)' \\\\",
          "946:   CC='\\$(CC)' CFLAGS='\\$(CFLAGS) \\$(DSO_CFLAGS)' \\\\",
          "947:   SHARED_LDFLAGS='\\$(DSO_LDFLAGS)' \\\\",
          "949:   LIBEXTRAS=\"$objs\" \\\\",
          "950:   link_dso.$shlib_target",
          "951: EOF",
          "",
          "[Removed Lines]",
          "938:       my $target = dso($lib);",
          "943:   PERL=\"\\$(PERL)\" SRCDIR='\\$(SRCDIR)' DSTDIR=\"$libd\" \\\\",
          "945:   LIBNAME=$libname LDFLAGS='\\$(LDFLAGS)' \\\\",
          "948:   SHLIB_EXT=$dsoext \\\\",
          "",
          "[Added Lines]",
          "938:       my $target = dso($dso);",
          "943:   PERL=\"\\$(PERL)\" SRCDIR='\\$(SRCDIR)' DSTDIR=\"$dsod\" \\\\",
          "945:   SHLIBNAME_FULL=$target LDFLAGS='\\$(LDFLAGS)' \\\\",
          "",
          "---------------"
        ],
        "Makefile.shared||Makefile.shared": [
          "File: Makefile.shared -> Makefile.shared",
          "--- Hunk 1 ---",
          "[Context before]",
          "29: #LIBNAME=foo",
          "30: LIBNAME=",
          "32: # APPNAME contains just the name of the application, without suffix (\"\"",
          "33: # on Unix, \".exe\" on Windows, ...).  This one MUST have a value when using",
          "34: # this makefile to build applications.",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "32: # STLIBNAME contains the path of the static library to build the shared",
          "33: # library from, for example:",
          "34: #STLIBNAME=libfoo.a",
          "35: STLIBNAME=",
          "37: # On most Unix platforms, SHLIBNAME contains the path of the short name of",
          "38: # the shared library to build, for example",
          "39: #SHLIBNAME=libfoo.so",
          "40: # On Windows POSIX layers (cygwin and mingw), SHLIBNAME contains the import",
          "41: # library name for the shared library to be built, for example:",
          "42: #SHLIBNAME=libfoo.dll.a",
          "44: # SHLIBNAME_FULL contains the path of the full name of the shared library to",
          "45: # build, for example:",
          "46: #SHLIBNAME_FULL=libfoo.so.1.2",
          "47: # When building DSOs, SHLIBNAME_FULL contains path of the full DSO name, for",
          "48: # example:",
          "49: #SHLIBNAME_FULL=dir/dso.so",
          "50: SHLIBNAME_FULL=",
          "52: # SHLIBVERSION contains the current version of the shared library (not to",
          "53: # be confused with the project version)",
          "54: #SHLIBVERSION=1.2",
          "55: SHLIBVERSION=",
          "57: # NOTE: to build shared libraries, LIBNAME, STLIBNAME, SHLIBNAME and",
          "58: # SHLIBNAME_FULL MUST have values when using this makefile, and in some",
          "59: # cases, SHLIBVERSION as well.  To build DSOs, SHLIBNAME_FULL MUST have",
          "60: # a value, the rest can be left alone.",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "36: #APPNAME=foo",
          "37: APPNAME=",
          "42: # SRCDIR is the top directory of the source tree.",
          "43: SRCDIR=.",
          "",
          "[Removed Lines]",
          "39: # DSTDIR is the directory where the built file should end up in.",
          "40: DSTDIR=.",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "55: # names of all object files that go into the target shared object.",
          "56: LIBEXTRAS=",
          "76: # LIBDEPS contains all the flags necessary to cover all necessary",
          "77: # dependencies to other libraries.",
          "78: LIBDEPS=",
          "",
          "[Removed Lines]",
          "58: # LIBVERSION contains the current version of the library.",
          "59: # For example, to build libfoo.so.1.2, you need to do the following:",
          "60: #LIBVERSION=1.2",
          "61: LIBVERSION=",
          "63: # LIBCOMPATVERSIONS contains the compatibility versions (a list) of",
          "64: # the library.  They MUST be in decreasing order.",
          "65: # For example, if libfoo.so.1.2.1 is backward compatible with libfoo.so.1.2",
          "66: # and libfoo.so.1, you need to do the following:",
          "67: #LIBCOMPATVERSIONS=1.2 1",
          "68: # Note that on systems that use sonames, the last number will appear as",
          "69: # part of it.",
          "70: # It's also possible, for systems that support it (Tru64, for example),",
          "71: # to add extra compatibility info with more precision, by adding a second",
          "72: # list of versions, separated from the first with a semicolon, like this:",
          "73: #LIBCOMPATVERSIONS=1.2 1;1.2.0 1.1.2 1.1.1 1.1.0 1.0.0",
          "74: LIBCOMPATVERSIONS=",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "86: top:",
          "87:  echo \"Trying to use this makefile interactively?  Don't.\"",
          "103: LINK_APP= \\",
          "104:   ( $(SET_X);   \\",
          "105:     LIBDEPS=\"$${LIBDEPS:-$(LIBDEPS)}\"; \\",
          "",
          "[Removed Lines]",
          "89: CALC_VERSIONS= \\",
          "90:  SHLIB_COMPAT=; SHLIB_SOVER=; \\",
          "91:  if [ -n \"$(LIBVERSION)$(LIBCOMPATVERSIONS)\" ]; then \\",
          "92:   prev=\"\"; \\",
          "93:   for v in `echo \"$(LIBVERSION) $(LIBCOMPATVERSIONS)\" | cut -d';' -f1`; do \\",
          "94:    SHLIB_SOVER_NODOT=$$v; \\",
          "95:    SHLIB_SOVER=.$$v; \\",
          "96:    if [ -n \"$$prev\" ]; then \\",
          "97:     SHLIB_COMPAT=\"$$SHLIB_COMPAT .$$prev\"; \\",
          "98:    fi; \\",
          "99:    prev=$$v; \\",
          "100:   done; \\",
          "101:  fi",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "120:     LIBPATH=`echo $$LIBPATH | sed -e 's/ /:/g'`; \\",
          "121:     echo LD_LIBRARY_PATH=$$LIBPATH:$$LD_LIBRARY_PATH \\",
          "122:          $${SHAREDCMD} $${SHAREDFLAGS} \\",
          "124:       $$ALLSYMSFLAGS $$SHOBJECTS $$NOALLSYMSFLAGS $$LIBDEPS; \\",
          "125:     LD_LIBRARY_PATH=$$LIBPATH:$$LD_LIBRARY_PATH \\",
          "126:     $${SHAREDCMD} $${SHAREDFLAGS} \\",
          "128:  $$ALLSYMSFLAGS $$SHOBJECTS $$NOALLSYMSFLAGS $$LIBDEPS \\",
          "129:   ) && $(SYMLINK_SO)",
          "131: SYMLINK_SO= \\",
          "132:  if [ -n \"$$INHIBIT_SYMLINKS\" ]; then :; else \\",
          "144:   fi; \\",
          "145:  fi",
          "148: LINK_SO_DSO= INHIBIT_SYMLINKS=yes; SHOBJECTS=\"$(LIBEXTRAS)\"; $(LINK_SO)",
          "150: LINK_SO_SHLIB_VIA_O= \\",
          "152:   ALL=$$ALLSYMSFLAGS; ALLSYMSFLAGS=; NOALLSYMSFLAGS=; \\",
          "155:   $(LINK_SO) && ( echo rm -f $$SHOBJECTS; rm -f $$SHOBJECTS )",
          "157: LINK_SO_SHLIB_UNPACKED= \\",
          "158:   UNPACKDIR=link_tmp.$$$$; rm -rf $$UNPACKDIR; mkdir $$UNPACKDIR; \\",
          "160:   ([ -z \"$(LIBEXTRAS)\" ] || cp $(LIBEXTRAS) $$UNPACKDIR) && \\",
          "161:   SHOBJECTS=$$UNPACKDIR/*.o; \\",
          "162:   $(LINK_SO) && rm -rf $$UNPACKDIR",
          "",
          "[Removed Lines]",
          "123:       -o $(DSTDIR)/$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX \\",
          "127:  -o $(DSTDIR)/$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX \\",
          "133:   prev=$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX; \\",
          "134:   if [ -n \"$$SHLIB_COMPAT\" ]; then \\",
          "135:    for x in $$SHLIB_COMPAT; do \\",
          "136:     ( $(SET_X); rm -f $(DSTDIR)/$$SHLIB$$x$$SHLIB_SUFFIX; \\",
          "137:       ln -s $$prev $(DSTDIR)/$$SHLIB$$x$$SHLIB_SUFFIX ); \\",
          "138:     prev=$$SHLIB$$x$$SHLIB_SUFFIX; \\",
          "139:    done; \\",
          "140:   fi; \\",
          "141:   if [ -n \"$$SHLIB_SOVER\" ]; then \\",
          "142:    ( $(SET_X); rm -f $(DSTDIR)/$$SHLIB$$SHLIB_SUFFIX; \\",
          "143:      ln -s $$prev $(DSTDIR)/$$SHLIB$$SHLIB_SUFFIX ); \\",
          "147: LINK_SO_SHLIB= SHOBJECTS=\"$(DSTDIR)/lib$(LIBNAME).a $(LIBEXTRAS)\"; $(LINK_SO)",
          "151:   SHOBJECTS=$(DSTDIR)/lib$(LIBNAME).o; \\",
          "153:   ( echo ld $(LDFLAGS) -r -o $$SHOBJECTS $$ALL lib$(LIBNAME).a $(LIBEXTRAS); \\",
          "154:     ld $(LDFLAGS) -r -o $$SHOBJECTS $$ALL $(DSTDIR)/lib$(LIBNAME).a $(LIBEXTRAS) ); \\",
          "159:   (cd $$UNPACKDIR; ar x ../$(DSTDIR)/lib$(LIBNAME).a) && \\",
          "",
          "[Added Lines]",
          "119:       -o $(SHLIBNAME_FULL) \\",
          "123:  -o $(SHLIBNAME_FULL) \\",
          "129:   if [ -n \"$(SHLIBNAME_FULL)\" -a -n \"$(SHLIBNAME)\" -a \\",
          "130:        \"$(SHLIBNAME_FULL)\" != \"$(SHLIBNAME)\" ]; then \\",
          "131:    ( $(SET_X); \\",
          "132:      rm -f $(SHLIBNAME); \\",
          "133:      ln -s $(SHLIBNAME_FULL) $(SHLIBNAME) ); \\",
          "137: LINK_SO_SHLIB= SHOBJECTS=\"$(STLIBNAME) $(LIBEXTRAS)\"; $(LINK_SO)",
          "141:   SHOBJECTS=$(STLIBNAME).o; \\",
          "143:   ( echo ld $(LDFLAGS) -r -o $$SHOBJECTS $$ALL $(STLIBNAME) $(LIBEXTRAS); \\",
          "144:     ld $(LDFLAGS) -r -o $$SHOBJECTS $$ALL $(STLIBNAME) $(LIBEXTRAS) ); \\",
          "149:   (cd $$UNPACKDIR; ar x ../$(STLIBNAME)) && \\",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "164: DETECT_GNU_LD=($(CC) -Wl,-V /dev/null 2>&1 | grep '^GNU ld' )>/dev/null",
          "166: DO_GNU_SO_COMMON=\\",
          "168: DO_GNU_DSO=\\",
          "172:  $(DO_GNU_SO_COMMON)",
          "173: DO_GNU_SO=\\",
          "176:  ALLSYMSFLAGS='-Wl,--whole-archive'; \\",
          "177:  NOALLSYMSFLAGS='-Wl,--no-whole-archive'; \\",
          "178:  $(DO_GNU_SO_COMMON)",
          "",
          "[Removed Lines]",
          "167:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-Bsymbolic -Wl,-soname=$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX\"",
          "169:  SHLIB=$(LIBNAME).so; \\",
          "170:  SHLIB_SOVER=; \\",
          "171:  SHLIB_SUFFIX=; \\",
          "174:  $(CALC_VERSIONS); \\",
          "175:  SHLIB=lib$(LIBNAME).so; \\",
          "",
          "[Added Lines]",
          "157:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-Bsymbolic -Wl,-soname=$(SHLIBNAME_FULL)\"",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "202: link_dso.bsd:",
          "203:  @if $(DETECT_GNU_LD); then $(DO_GNU_DSO); else \\",
          "206:  LIBDEPS=\" \"; \\",
          "207:  ALLSYMSFLAGS=; \\",
          "208:  NOALLSYMSFLAGS=; \\",
          "",
          "[Removed Lines]",
          "204:  SHLIB=$(LIBNAME).so; \\",
          "205:  SHLIB_SUFFIX=; \\",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "210:  fi; $(LINK_SO_DSO)",
          "211: link_shlib.bsd:",
          "212:  @if $(DETECT_GNU_LD); then $(DO_GNU_SO); else \\",
          "216:  LIBDEPS=\" \"; \\",
          "217:  ALLSYMSFLAGS=\"-Wl,-Bforcearchive\"; \\",
          "218:  NOALLSYMSFLAGS=; \\",
          "",
          "[Removed Lines]",
          "213:  $(CALC_VERSIONS); \\",
          "214:  SHLIB=lib$(LIBNAME).so; \\",
          "215:  SHLIB_SUFFIX=; \\",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "241: # Alternative to this heuristic approach is to develop specific",
          "242: # MacOS X dso module relying on whichever \"native\" dyld interface.",
          "243: link_dso.darwin:",
          "247:  NOALLSYMSFLAGS=''; \\",
          "248:  SHAREDFLAGS=\"$(CFLAGS) `echo $(SHARED_LDFLAGS) | sed s/dynamiclib/bundle/`\"; \\",
          "249:  $(LINK_SO_DSO)",
          "250: link_shlib.darwin:",
          "255:  NOALLSYMSFLAGS=''; \\",
          "264:  $(LINK_SO_SHLIB)",
          "265: link_app.darwin: # is there run-path on darwin?",
          "266:  $(LINK_APP)",
          "268: link_dso.cygwin:",
          "272:  NOALLSYMSFLAGS=''; \\",
          "273:  base=-Wl,--enable-auto-image-base; \\",
          "274:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared $$base -Wl,-Bsymbolic\"; \\",
          "275:  $(LINK_SO_DSO)",
          "276: link_shlib.cygwin:",
          "282:        \"$(RC) $(SHARED_RCFLAGS) -o rc.o\"; \\",
          "284:   $(RC) $(SHARED_RCFLAGS) -o rc.o; \\",
          "285:  ALLSYMSFLAGS='-Wl,--whole-archive'; \\",
          "286:  NOALLSYMSFLAGS='-Wl,--no-whole-archive'; \\",
          "288:  $(LINK_SO_SHLIB) || exit 1; \\",
          "289:  rm rc.o",
          "290: link_app.cygwin:",
          "",
          "[Removed Lines]",
          "244:  @ SHLIB=$(LIBNAME); \\",
          "245:  SHLIB_SUFFIX=.dylib; \\",
          "246:  ALLSYMSFLAGS=''; \\",
          "251:  @ $(CALC_VERSIONS); \\",
          "252:  SHLIB=lib$(LIBNAME); \\",
          "253:  SHLIB_SUFFIX=.dylib; \\",
          "254:  ALLSYMSFLAGS='-all_load'; \\",
          "256:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS)\"; \\",
          "257:  if [ -n \"$(LIBVERSION)\" ]; then \\",
          "258:   SHAREDFLAGS=\"$$SHAREDFLAGS -current_version $(LIBVERSION)\"; \\",
          "259:  fi; \\",
          "260:  if [ -n \"$$SHLIB_SOVER_NODOT\" ]; then \\",
          "261:   SHAREDFLAGS=\"$$SHAREDFLAGS -compatibility_version $$SHLIB_SOVER_NODOT\"; \\",
          "262:  fi; \\",
          "263:  SHAREDFLAGS=\"$$SHAREDFLAGS -install_name $(INSTALLTOP)/$(LIBDIR)/$$SHLIB$(SHLIB_EXT)\"; \\",
          "269:  @SHLIB=$(LIBNAME); \\",
          "270:  SHLIB_SUFFIX=.dll; \\",
          "271:  ALLSYMSFLAGS=''; \\",
          "277:  @ $(CALC_VERSIONS); \\",
          "278:  INHIBIT_SYMLINKS=yes; \\",
          "279:  SHLIB=cyg$(LIBNAME); SHLIB_SOVER=-$(LIBVERSION); SHLIB_SUFFIX=.dll; \\",
          "280:  dll_name=$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX; \\",
          "281:  echo \"$(PERL) $(SRCDIR)/util/mkrc.pl $$dll_name |\" \\",
          "283:  $(PERL) $(SRCDIR)/util/mkrc.pl $$dll_name | \\",
          "287:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,--enable-auto-image-base -Wl,-Bsymbolic -Wl,--out-implib,lib$(LIBNAME).dll.a rc.o\"; \\",
          "",
          "[Added Lines]",
          "224:  @ ALLSYMSFLAGS=''; \\",
          "229:  @ ALLSYMSFLAGS='-all_load'; \\",
          "231:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -current_version $(SHLIBVERSION) -compatibility_version $(SHLIBVERSION) -install_name $(INSTALLTOP)/$(LIBDIR)/$(SHLIBNAME_FULL)\"; \\",
          "237:  @ALLSYMSFLAGS=''; \\",
          "243:  @ INHIBIT_SYMLINKS=yes; \\",
          "244:  echo \"$(PERL) $(SRCDIR)/util/mkrc.pl $(SHLIBNAME_FULL) |\" \\",
          "246:  $(PERL) $(SRCDIR)/util/mkrc.pl $(SHLIBNAME_FULL) | \\",
          "250:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,--enable-auto-image-base -Wl,-Bsymbolic -Wl,--out-implib,$(SHLIBNAME) rc.o\"; \\",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "293: # link_dso.mingw-shared and link_app.mingw-shared are mapped to the",
          "294: # corresponding cygwin targets, as they do the exact same thing.",
          "295: link_shlib.mingw:",
          "305:  base=; [ $(LIBNAME) = \"crypto\" -a -n \"$(FIPSCANLIB)\" ] && base=-Wl,--image-base,0x63000000; \\",
          "306:  $(PERL) $(SRCDIR)/util/mkdef.pl 32 $(LIBNAME) \\",
          "308:   > $(LIBNAME).def; \\",
          "310:   \"$(RC) $(SHARED_RCFLAGS) -o rc.o\"; \\",
          "312:   $(RC) $(SHARED_RCFLAGS) -o rc.o; \\",
          "313:  ALLSYMSFLAGS='-Wl,--whole-archive'; \\",
          "314:  NOALLSYMSFLAGS='-Wl,--no-whole-archive'; \\",
          "316:  $(LINK_SO_SHLIB) || exit 1; \\",
          "317:  rm $(LIBNAME).def rc.o",
          "",
          "[Removed Lines]",
          "296:  @ $(CALC_VERSIONS); \\",
          "297:  INHIBIT_SYMLINKS=yes; \\",
          "298:  arch=; \\",
          "299:  if expr $(PLATFORM) : mingw64 > /dev/null; then arch=-x64; fi; \\",
          "300:  sover=`echo $(LIBVERSION) | sed -e 's/\\./_/g'` ; \\",
          "301:  SHLIB=lib$(LIBNAME); \\",
          "302:  SHLIB_SOVER=-$$sover$$arch; \\",
          "303:  SHLIB_SUFFIX=.dll; \\",
          "304:  dll_name=$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX; \\",
          "307:   | sed -e 's|^\\(LIBRARY  *\\)$(LIBNAME)32|\\1'\"$$dll_name\"'|' \\",
          "309:  echo \"$(PERL) $(SRCDIR)/util/mkrc.pl $$dll_name |\" \\",
          "311:  $(PERL) $(SRCDIR)/util/mkrc.pl $$dll_name | \\",
          "315:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared $$base -Wl,-Bsymbolic -Wl,--out-implib,lib$(LIBNAME).dll.a $(LIBNAME).def rc.o\"; \\",
          "",
          "[Added Lines]",
          "259:  @ INHIBIT_SYMLINKS=yes; \\",
          "262:   | sed -e 's|^\\(LIBRARY  *\\)$(LIBNAME)32|\\1$(SHLIBNAME_FULL)|' \\",
          "264:  echo \"$(PERL) $(SRCDIR)/util/mkrc.pl $(SHLIBNAME_FULL) |\" \\",
          "266:  $(PERL) $(SRCDIR)/util/mkrc.pl $(SHLIBNAME_FULL) | \\",
          "270:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared $$base -Wl,-Bsymbolic -Wl,--out-implib,$(SHLIBNAME) $(LIBNAME).def rc.o\"; \\",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "320:  @ if $(DETECT_GNU_LD); then \\",
          "321:   $(DO_GNU_DSO); \\",
          "322:  else \\",
          "325:   ALLSYMSFLAGS=''; \\",
          "326:   NOALLSYMSFLAGS=''; \\",
          "327:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-B,symbolic\"; \\",
          "",
          "[Removed Lines]",
          "323:   SHLIB=$(LIBNAME).so; \\",
          "324:   SHLIB_SUFFIX=; \\",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "331:  @ if $(DETECT_GNU_LD); then \\",
          "332:   $(DO_GNU_SO); \\",
          "333:  else \\",
          "343:   ALLSYMSFLAGS='-all'; \\",
          "344:   NOALLSYMSFLAGS='-none'; \\",
          "349:  fi; \\",
          "350:  $(LINK_SO_SHLIB)",
          "351: link_app.alpha-osf1:",
          "",
          "[Removed Lines]",
          "334:   SHLIB=lib$(LIBNAME).so; \\",
          "335:   SHLIB_SUFFIX=; \\",
          "336:   SHLIB_HIST=`echo \"$(LIBCOMPATVERSIONS)\" | cut -d';' -f2 | sed -e 's/ */:/'`; \\",
          "337:   if [ -n \"$$SHLIB_HIST\" ]; then \\",
          "338:    SHLIB_HIST=\"$${SHLIB_HIST}:$(LIBVERSION)\"; \\",
          "339:   else \\",
          "340:    SHLIB_HIST=\"$(LIBVERSION)\"; \\",
          "341:   fi; \\",
          "342:   SHLIB_SOVER=; \\",
          "345:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-B,symbolic\"; \\",
          "346:   if [ -n \"$$SHLIB_HIST\" ]; then \\",
          "347:    SHAREDFLAGS=\"$$SHAREDFLAGS -set_version $$SHLIB_HIST\"; \\",
          "348:   fi; \\",
          "",
          "[Added Lines]",
          "289:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-B,symbolic -set_version $(SHLIBVERSION)\"; \\",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "360:  @ if $(DETECT_GNU_LD); then \\",
          "361:   $(DO_GNU_DSO); \\",
          "362:  else \\",
          "366:   ALLSYMSFLAGS=\"\"; \\",
          "367:   NOALLSYMSFLAGS=\"\"; \\",
          "369:  fi; \\",
          "370:  $(LINK_SO_DSO)",
          "371: link_shlib.solaris:",
          "372:  @ if $(DETECT_GNU_LD); then \\",
          "373:   $(DO_GNU_SO); \\",
          "374:  else \\",
          "378:   $(PERL) $(SRCDIR)/util/mkdef.pl $(LIBNAME) linux >$(LIBNAME).map; \\",
          "379:   ALLSYMSFLAGS=\"-Wl,-z,allextract,-M,$(LIBNAME).map\"; \\",
          "380:   NOALLSYMSFLAGS=\"-Wl,-z,defaultextract\"; \\",
          "382:  fi; \\",
          "383:  $(LINK_SO_SHLIB)",
          "384: link_app.solaris:",
          "",
          "[Removed Lines]",
          "363:   $(CALC_VERSIONS); \\",
          "364:   SHLIB=$(LIBNAME).so; \\",
          "365:   SHLIB_SUFFIX=; \\",
          "368:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -h $$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX -Wl,-Bsymbolic\"; \\",
          "375:   $(CALC_VERSIONS); \\",
          "376:   SHLIB=lib$(LIBNAME).so; \\",
          "377:   SHLIB_SUFFIX=;\\",
          "381:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -h $$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX -Wl,-Bsymbolic\"; \\",
          "",
          "[Added Lines]",
          "306:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -h $(SHLIBNAME_FULL) -Wl,-Bsymbolic\"; \\",
          "316:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -h $(SHLIBNAME_FULL) -Wl,-Bsymbolic\"; \\",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "394:  @ if $(DETECT_GNU_LD); then \\",
          "395:   $(DO_GNU_DSO); \\",
          "396:  else \\",
          "400:   ALLSYMSFLAGS=''; \\",
          "401:   NOALLSYMSFLAGS=''; \\",
          "403:  fi; \\",
          "404:  $(LINK_SO_DSO)",
          "405: link_shlib.svr3:",
          "406:  @ if $(DETECT_GNU_LD); then \\",
          "407:   $(DO_GNU_SO); \\",
          "408:  else \\",
          "412:   ALLSYMSFLAGS=''; \\",
          "413:   NOALLSYMSFLAGS=''; \\",
          "415:  fi; \\",
          "416:  $(LINK_SO_SHLIB_UNPACKED)",
          "417: link_app.svr3:",
          "",
          "[Removed Lines]",
          "397:   $(CALC_VERSIONS); \\",
          "398:   SHLIB=$(LIBNAME).so; \\",
          "399:   SHLIB_SUFFIX=; \\",
          "402:   SHAREDFLAGS=\"$(CFLAGS) -G -h $$SHLIB$$SHLIB_SUFFIX\"; \\",
          "409:   $(CALC_VERSIONS); \\",
          "410:   SHLIB=lib$(LIBNAME).so; \\",
          "411:   SHLIB_SUFFIX=; \\",
          "414:   SHAREDFLAGS=\"$(CFLAGS) -G -h $$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX\"; \\",
          "",
          "[Added Lines]",
          "334:   SHAREDFLAGS=\"$(CFLAGS) -G -h $(SHLIBNAME_FULL)\"; \\",
          "343:   SHAREDFLAGS=\"$(CFLAGS) -G -h $(SHLIBNAME_FULL)\"; \\",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "425:  else \\",
          "426:   SHARE_FLAG='-G'; \\",
          "427:   ($(CC) -v 2>&1 | grep gcc) > /dev/null && SHARE_FLAG='-shared'; \\",
          "430:   ALLSYMSFLAGS=''; \\",
          "431:   NOALLSYMSFLAGS=''; \\",
          "433:  fi; \\",
          "434:  $(LINK_SO_DSO)",
          "435: link_shlib.svr5:",
          "436:  @ if $(DETECT_GNU_LD); then \\",
          "437:   $(DO_GNU_SO); \\",
          "438:  else \\",
          "440:   SHARE_FLAG='-G'; \\",
          "441:   ($(CC) -v 2>&1 | grep gcc) > /dev/null && SHARE_FLAG='-shared'; \\",
          "444:   ALLSYMSFLAGS=''; \\",
          "445:   NOALLSYMSFLAGS=''; \\",
          "447:  fi; \\",
          "448:  $(LINK_SO_SHLIB_UNPACKED)",
          "449: link_app.svr5:",
          "",
          "[Removed Lines]",
          "428:   SHLIB=$(LIBNAME).so; \\",
          "429:   SHLIB_SUFFIX=; \\",
          "432:   SHAREDFLAGS=\"$(CFLAGS) $${SHARE_FLAG} -h $$SHLIB$$SHLIB_SUFFIX\"; \\",
          "439:   $(CALC_VERSIONS); \\",
          "442:   SHLIB=lib$(LIBNAME).so; \\",
          "443:   SHLIB_SUFFIX=; \\",
          "446:   SHAREDFLAGS=\"$(CFLAGS) $${SHARE_FLAG} -h $$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX\"; \\",
          "",
          "[Added Lines]",
          "359:   SHAREDFLAGS=\"$(CFLAGS) $${SHARE_FLAG} -h $(SHLIBNAME_FULL)\"; \\",
          "370:   SHAREDFLAGS=\"$(CFLAGS) $${SHARE_FLAG} -h $(SHLIBNAME_FULL)\"; \\",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "454:  @ if $(DETECT_GNU_LD); then \\",
          "455:   $(DO_GNU_DSO); \\",
          "456:  else \\",
          "459:   ALLSYMSFLAGS=\"\"; \\",
          "460:   NOALLSYMSFLAGS=\"\"; \\",
          "462:  fi; \\",
          "463:  $(LINK_SO_DSO)",
          "464: link_shlib.irix:",
          "465:  @ if $(DETECT_GNU_LD); then \\",
          "466:   $(DO_GNU_SO); \\",
          "467:  else \\",
          "471:   MINUSWL=\"\"; \\",
          "472:   ($(CC) -v 2>&1 | grep gcc) > /dev/null && MINUSWL=\"-Wl,\"; \\",
          "473:   ALLSYMSFLAGS=\"$${MINUSWL}-all\"; \\",
          "474:   NOALLSYMSFLAGS=\"$${MINUSWL}-none\"; \\",
          "476:  fi; \\",
          "477:  $(LINK_SO_SHLIB)",
          "478: link_app.irix:",
          "",
          "[Removed Lines]",
          "457:   SHLIB=$(LIBNAME).so; \\",
          "458:   SHLIB_SUFFIX=; \\",
          "461:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-soname,$$SHLIB$$SHLIB_SUFFIX,-B,symbolic\"; \\",
          "468:   $(CALC_VERSIONS); \\",
          "469:   SHLIB=lib$(LIBNAME).so; \\",
          "470:   SHLIB_SUFFIX=; \\",
          "475:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-soname,$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX,-B,symbolic\"; \\",
          "",
          "[Added Lines]",
          "383:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-soname,$(SHLIBNAME_FULL),-B,symbolic\"; \\",
          "394:   SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -shared -Wl,-soname,$(SHLIBNAME_FULL),-B,symbolic\"; \\",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "489: #",
          "490: link_dso.hpux:",
          "491:  @if $(DETECT_GNU_LD); then $(DO_GNU_DSO); else \\",
          "495:  ALLSYMSFLAGS=''; \\",
          "496:  NOALLSYMSFLAGS=''; \\",
          "497:  expr $(PLATFORM) : 'hpux64' > /dev/null && ALLSYMSFLAGS='-Wl,+forceload'; \\",
          "499:  fi; \\",
          "502: link_shlib.hpux:",
          "503:  @if $(DETECT_GNU_LD); then $(DO_GNU_SO); else \\",
          "508:  ALLSYMSFLAGS='-Wl,-Fl'; \\",
          "509:  NOALLSYMSFLAGS=''; \\",
          "510:  expr $(PLATFORM) : 'hpux64' > /dev/null && ALLSYMSFLAGS='-Wl,+forceload'; \\",
          "512:  fi; \\",
          "515: link_app.hpux:",
          "516:  @if $(DETECT_GNU_LD); then $(DO_GNU_APP); else \\",
          "517:  LDFLAGS=\"$(CFLAGS) $(LDFLAGS) -Wl,+s,+cdp,../:,+cdp,./:\"; \\",
          "",
          "[Removed Lines]",
          "492:  SHLIB=$(LIBNAME).sl; \\",
          "493:  expr \"$(CFLAGS)\" : '.*DSO_DLFCN' > /dev/null && SHLIB=$(LIBNAME).so; \\",
          "494:  SHLIB_SUFFIX=; \\",
          "498:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-B,symbolic,+vnocompatwarnings,-z,+s,+h,$$SHLIB$$SHLIB_SUFFIX,+cdp,../:,+cdp,./:\"; \\",
          "500:  rm -f $(DSTDIR)/$$SHLIB$$SHLIB_SUFFIX || :; \\",
          "501:  $(LINK_SO_DSO) && chmod a=rx $(DSTDIR)/$$SHLIB$$SHLIB_SUFFIX",
          "504:  $(CALC_VERSIONS); \\",
          "505:  SHLIB=lib$(LIBNAME).sl; \\",
          "506:  expr $(PLATFORM) : '.*ia64' > /dev/null && SHLIB=lib$(LIBNAME).so; \\",
          "507:  SHLIB_SUFFIX=; \\",
          "511:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-B,symbolic,+vnocompatwarnings,-z,+s,+h,$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX,+cdp,../:,+cdp,./:\"; \\",
          "513:  rm -f $(DSTDIR)/$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX || :; \\",
          "514:  $(LINK_SO_SHLIB) && chmod a=rx $(DSTDIR)/$$SHLIB$$SHLIB_SOVER$$SHLIB_SUFFIX",
          "",
          "[Added Lines]",
          "414:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-B,symbolic,+vnocompatwarnings,-z,+s,+h,$(SHLIBNAME_FULL),+cdp,../:,+cdp,./:\"; \\",
          "416:  rm -f $(SHLIBNAME_FULL) || :; \\",
          "417:  $(LINK_SO_DSO) && chmod a=rx $(SHLIBNAME_FULL)",
          "423:  SHAREDFLAGS=\"$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-B,symbolic,+vnocompatwarnings,-z,+s,+h,$(SHLIBNAME_FULL),+cdp,../:,+cdp,./:\"; \\",
          "425:  rm -f $(SHLIBNAME_FULL) || :; \\",
          "426:  $(LINK_SO_SHLIB) && chmod a=rx $(SHLIBNAME_FULL)",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "521: link_dso.aix:",
          "522:  @OBJECT_MODE=`expr \"x$(SHARED_LDFLAGS)\" : 'x\\-[a-z]*\\(64\\)'` || :; \\",
          "523:  OBJECT_MODE=$${OBJECT_MODE:-32}; export OBJECT_MODE; \\",
          "526:  ALLSYMSFLAGS=''; \\",
          "527:  NOALLSYMSFLAGS=''; \\",
          "528:  SHAREDFLAGS='$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-bexpall,-bnolibpath,-bM:SRE'; \\",
          "530:  $(LINK_SO_DSO);",
          "531: link_shlib.aix:",
          "534:  OBJECT_MODE=$${OBJECT_MODE:-32}; export OBJECT_MODE; \\",
          "537:  ALLSYMSFLAGS='-bnogc'; \\",
          "538:  NOALLSYMSFLAGS=''; \\",
          "539:  SHAREDFLAGS='$(CFLAGS) $(SHARED_LDFLAGS) -Wl,-bexpall,-bnolibpath,-bM:SRE'; \\",
          "541:  $(LINK_SO_SHLIB_VIA_O)",
          "542: link_app.aix:",
          "543:  LDFLAGS=\"$(CFLAGS) -Wl,-bsvr4 $(LDFLAGS)\"; \\",
          "",
          "[Removed Lines]",
          "524:  SHLIB=$(LIBNAME).so; \\",
          "525:  SHLIB_SUFFIX=; \\",
          "529:  rm -f $(DSTDIR)/$$SHLIB$$SHLIB_SOVER 2>&1 > /dev/null ; \\",
          "532:  @ $(CALC_VERSIONS); \\",
          "533:  OBJECT_MODE=`expr \"x$(SHARED_LDFLAGS)\" : 'x\\-[a-z]*\\(64\\)'` || : ; \\",
          "535:  SHLIB=lib$(LIBNAME).so; \\",
          "536:  SHLIB_SUFFIX=; \\",
          "540:  rm -f $(DSTDIR)/$$SHLIB$$SHLIB_SOVER 2>&1 > /dev/null ; \\",
          "",
          "[Added Lines]",
          "439:  rm -f $(SHLIBNAME_FULL) 2>&1 > /dev/null ; \\",
          "442:  @ OBJECT_MODE=`expr \"x$(SHARED_LDFLAGS)\" : 'x\\-[a-z]*\\(64\\)'` || : ; \\",
          "447:  rm -f $(SHLIBNAME_FULL) 2>&1 > /dev/null ; \\",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "547: # Targets to build symbolic links when needed",
          "548: symlink.gnu symlink.solaris symlink.svr3 symlink.svr5 symlink.irix \\",
          "549: symlink.aix:",
          "553: symlink.darwin:",
          "558: symlink.hpux:",
          "563: # The following lines means those specific architectures do no symlinks",
          "564: symlink.cygwin symlink.alpha-osf1 symlink.tru64 symlink.tru64-rpath:",
          "",
          "[Removed Lines]",
          "550:  @ $(CALC_VERSIONS); \\",
          "551:  SHLIB=lib$(LIBNAME).so; \\",
          "552:  $(SYMLINK_SO)",
          "554:  @ $(CALC_VERSIONS); \\",
          "555:  SHLIB=lib$(LIBNAME); \\",
          "556:  SHLIB_SUFFIX=.dylib; \\",
          "557:  $(SYMLINK_SO)",
          "559:  @ $(CALC_VERSIONS); \\",
          "560:  SHLIB=lib$(LIBNAME).sl; \\",
          "561:  expr $(PLATFORM) : '.*ia64' > /dev/null && SHLIB=lib$(LIBNAME).so; \\",
          "562:  $(SYMLINK_SO)",
          "",
          "[Added Lines]",
          "457:  @ $(SYMLINK_SO)",
          "459:  @ $(SYMLINK_SO)",
          "461:  @ $(SYMLINK_SO)",
          "",
          "---------------"
        ]
      }
    }
  ]
}