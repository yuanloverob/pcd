{
  "cve_id": "CVE-2017-1000458",
  "cve_desc": "Bro before Bro v2.5.2 is vulnerable to an out of bounds write in the ContentLine analyzer allowing remote attackers to cause a denial of service (crash) and possibly other exploitation.",
  "repo": "bro/bro",
  "patch_hash": "6c0f101a62489b1c5927b4ed63b0e1d37db40282",
  "patch_info": {
    "commit_hash": "6c0f101a62489b1c5927b4ed63b0e1d37db40282",
    "repo": "bro/bro",
    "commit_url": "https://github.com/bro/bro/commit/6c0f101a62489b1c5927b4ed63b0e1d37db40282",
    "files": [
      "src/analyzer/protocol/tcp/ContentLine.cc"
    ],
    "message": "Patch OOB write in content-line analyzer.\n\nA combination of packets can trigger an out of bound write of '0' byte\nin the content-line analyzer.\n\nThis bug was found by Frank Meier.\n\nAddresses BIT-1856.",
    "before_after_code_files": [
      "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc"
    ]
  },
  "patch_diff": {
    "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc": [
      "File: src/analyzer/protocol/tcp/ContentLine.cc -> src/analyzer/protocol/tcp/ContentLine.cc",
      "--- Hunk 1 ---",
      "[Context before]",
      "250:   case '\\n':",
      "251:    if ( last_char == '\\r' )",
      "252:     {",
      "253:     --offset; // remove '\\r'",
      "254:     EMIT_LINE",
      "255:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "258:     if ( offset == 0 )",
      "259:      {",
      "260:      last_char = c;",
      "261:      break;",
      "262:      }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ef24568818b708a9a49eec06fb5af4f5075cffe8",
      "candidate_info": {
        "commit_hash": "ef24568818b708a9a49eec06fb5af4f5075cffe8",
        "repo": "bro/bro",
        "commit_url": "https://github.com/bro/bro/commit/ef24568818b708a9a49eec06fb5af4f5075cffe8",
        "files": [
          "src/analyzer/protocol/tcp/ContentLine.cc"
        ],
        "message": "Patch OOB write in content-line analyzer.\n\nA combination of packets can trigger an out of bound write of '0' byte\nin the content-line analyzer.\n\nThis bug was found by Frank Meier.\n\nAddresses BIT-1856.",
        "before_after_code_files": [
          "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc"
          ],
          "candidate": [
            "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc"
          ]
        }
      },
      "candidate_diff": {
        "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc": [
          "File: src/analyzer/protocol/tcp/ContentLine.cc -> src/analyzer/protocol/tcp/ContentLine.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "250:   case '\\n':",
          "251:    if ( last_char == '\\r' )",
          "252:     {",
          "253:     --offset; // remove '\\r'",
          "254:     EMIT_LINE",
          "255:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "258:     if ( offset == 0 )",
          "259:      {",
          "260:      last_char = c;",
          "261:      break;",
          "262:      }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "09a6e5439313ced9453584027dc123fb1ffe70d3",
      "candidate_info": {
        "commit_hash": "09a6e5439313ced9453584027dc123fb1ffe70d3",
        "repo": "bro/bro",
        "commit_url": "https://github.com/bro/bro/commit/09a6e5439313ced9453584027dc123fb1ffe70d3",
        "files": [
          "src/analyzer/protocol/tcp/ContentLine.cc"
        ],
        "message": "Patch OOB write in content-line analyzer.\n\nA combination of packets can trigger an out of bound write of '0' byte\nin the content-line analyzer.\n\nThis bug was found by Frank Meier.\n\nAddresses BIT-1856.",
        "before_after_code_files": [
          "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc"
          ],
          "candidate": [
            "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc"
          ]
        }
      },
      "candidate_diff": {
        "src/analyzer/protocol/tcp/ContentLine.cc||src/analyzer/protocol/tcp/ContentLine.cc": [
          "File: src/analyzer/protocol/tcp/ContentLine.cc -> src/analyzer/protocol/tcp/ContentLine.cc",
          "--- Hunk 1 ---",
          "[Context before]",
          "250:   case '\\n':",
          "251:    if ( last_char == '\\r' )",
          "252:     {",
          "253:     --offset; // remove '\\r'",
          "254:     EMIT_LINE",
          "255:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "258:     if ( offset == 0 )",
          "259:      {",
          "260:      last_char = c;",
          "261:      break;",
          "262:      }",
          "",
          "---------------"
        ]
      }
    }
  ]
}