{
  "cve_id": "CVE-2016-7411",
  "cve_desc": "ext/standard/var_unserializer.re in PHP before 5.6.26 mishandles object-deserialization failures, which allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via an unserialize call that references a partially constructed object.",
  "repo": "php/php-src",
  "patch_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
  "patch_info": {
    "commit_hash": "6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/6a7cc8ff85827fa9ac715b3a83c2d9147f33cd43",
    "files": [
      "Zend/zend_objects_API.c",
      "ext/standard/tests/serialize/bug73052.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fix bug #73052 - Memory Corruption in During Deserialized-object Destruction",
    "before_after_code_files": [
      "Zend/zend_objects_API.c||Zend/zend_objects_API.c",
      "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "Zend/zend_objects_API.c||Zend/zend_objects_API.c": [
      "File: Zend/zend_objects_API.c -> Zend/zend_objects_API.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "306: {",
      "307:  zend_object_handle handle = Z_OBJ_HANDLE_P(zobject);",
      "308:  zend_object_store_bucket *obj_bucket = &EG(objects_store).object_buckets[handle];",
      "311:  obj_bucket->destructor_called = 1;",
      "312: }",
      "",
      "[Removed Lines]",
      "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);;",
      "",
      "[Added Lines]",
      "310:  obj_bucket->bucket.obj.handlers = Z_OBJ_HT_P(zobject);",
      "",
      "---------------"
    ],
    "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt": [
      "File: ext/standard/tests/serialize/bug73052.phpt -> ext/standard/tests/serialize/bug73052.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73052: Memory Corruption in During Deserialized-object Destruction",
      "3: --FILE--",
      "4: <?php",
      "6: class obj {",
      "7:     var $ryat;",
      "8:     public function __destruct() {",
      "9:         $this->ryat = null;",
      "10:     }",
      "11: }",
      "13: $poc = 'O:3:\"obj\":1:{';",
      "14: var_dump(unserialize($poc));",
      "15: ?>",
      "16: --EXPECTF--",
      "17: Notice: unserialize(): Error at offset 13 of 13 bytes in %sbug73052.php on line %d",
      "18: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "438:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
      "439:         zend_hash_clean(Z_OBJPROP_PP(rval));",
      "440:      }",
      "441:      ZVAL_NULL(*rval);",
      "442:   return 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "440:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "495: {",
      "496:  YYCTYPE yych;",
      "497:  static const unsigned char yybm[] = {",
      "",
      "[Removed Lines]",
      "494: #line 495 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "495: #line 496 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "551:  yych = *(YYMARKER = ++YYCURSOR);",
      "552:  if (yych == ':') goto yy95;",
      "553: yy3:",
      "555:  { return 0; }",
      "557: yy4:",
      "558:  yych = *(YYMARKER = ++YYCURSOR);",
      "559:  if (yych == ':') goto yy89;",
      "",
      "[Removed Lines]",
      "554: #line 860 \"ext/standard/var_unserializer.re\"",
      "556: #line 557 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "555: #line 861 \"ext/standard/var_unserializer.re\"",
      "557: #line 558 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "596:  goto yy3;",
      "597: yy14:",
      "598:  ++YYCURSOR;",
      "600:  {",
      "602:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
      "604: }",
      "606: yy16:",
      "607:  yych = *++YYCURSOR;",
      "608:  goto yy3;",
      "",
      "[Removed Lines]",
      "599: #line 854 \"ext/standard/var_unserializer.re\"",
      "605: #line 606 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "600: #line 855 \"ext/standard/var_unserializer.re\"",
      "606: #line 607 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "633:  yych = *++YYCURSOR;",
      "634:  if (yych != '\"') goto yy18;",
      "635:  ++YYCURSOR;",
      "637:  {",
      "638:  size_t len, len2, len3, maxlen;",
      "639:  long elements;",
      "",
      "[Removed Lines]",
      "636: #line 707 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "637: #line 708 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "781:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
      "782: }",
      "784: yy25:",
      "785:  yych = *++YYCURSOR;",
      "786:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "783: #line 784 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "784: #line 785 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 7 ---",
      "[Context before]",
      "805:  yych = *++YYCURSOR;",
      "806:  if (yych != '\"') goto yy18;",
      "807:  ++YYCURSOR;",
      "809:  {",
      "810:     if (!var_hash) return 0;",
      "",
      "[Removed Lines]",
      "808: #line 698 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "809: #line 699 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 8 ---",
      "[Context before]",
      "814:  return object_common2(UNSERIALIZE_PASSTHRU,",
      "815:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
      "816: }",
      "818: yy32:",
      "819:  yych = *++YYCURSOR;",
      "820:  if (yych == '+') goto yy33;",
      "",
      "[Removed Lines]",
      "817: #line 818 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "818: #line 819 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 9 ---",
      "[Context before]",
      "835:  yych = *++YYCURSOR;",
      "836:  if (yych != '{') goto yy18;",
      "837:  ++YYCURSOR;",
      "839:  {",
      "840:  long elements = parse_iv(start + 2);",
      "",
      "[Removed Lines]",
      "838: #line 677 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "839: #line 678 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 10 ---",
      "[Context before]",
      "857:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
      "858: }",
      "860: yy39:",
      "861:  yych = *++YYCURSOR;",
      "862:  if (yych == '+') goto yy40;",
      "",
      "[Removed Lines]",
      "859: #line 860 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "860: #line 861 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 11 ---",
      "[Context before]",
      "877:  yych = *++YYCURSOR;",
      "878:  if (yych != '\"') goto yy18;",
      "879:  ++YYCURSOR;",
      "881:  {",
      "882:  size_t len, maxlen;",
      "883:  char *str;",
      "",
      "[Removed Lines]",
      "880: #line 642 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "881: #line 643 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 12 ---",
      "[Context before]",
      "912:  ZVAL_STRINGL(*rval, str, len, 0);",
      "913:  return 1;",
      "914: }",
      "916: yy46:",
      "917:  yych = *++YYCURSOR;",
      "918:  if (yych == '+') goto yy47;",
      "",
      "[Removed Lines]",
      "915: #line 916 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "916: #line 917 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 13 ---",
      "[Context before]",
      "933:  yych = *++YYCURSOR;",
      "934:  if (yych != '\"') goto yy18;",
      "935:  ++YYCURSOR;",
      "937:  {",
      "938:  size_t len, maxlen;",
      "939:  char *str;",
      "",
      "[Removed Lines]",
      "936: #line 609 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "937: #line 610 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 14 ---",
      "[Context before]",
      "966:  ZVAL_STRINGL(*rval, str, len, 1);",
      "967:  return 1;",
      "968: }",
      "970: yy53:",
      "971:  yych = *++YYCURSOR;",
      "972:  if (yych <= '/') {",
      "",
      "[Removed Lines]",
      "969: #line 970 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "970: #line 971 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 15 ---",
      "[Context before]",
      "1054:  }",
      "1055: yy63:",
      "1056:  ++YYCURSOR;",
      "1058:  {",
      "1059: #if SIZEOF_LONG == 4",
      "1060: use_double:",
      "",
      "[Removed Lines]",
      "1057: #line 599 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1058: #line 600 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 16 ---",
      "[Context before]",
      "1064:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
      "1065:  return 1;",
      "1066: }",
      "1068: yy65:",
      "1069:  yych = *++YYCURSOR;",
      "1070:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1067: #line 1068 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 17 ---",
      "[Context before]",
      "1123:  yych = *++YYCURSOR;",
      "1124:  if (yych != ';') goto yy18;",
      "1125:  ++YYCURSOR;",
      "1127:  {",
      "1129:  INIT_PZVAL(*rval);",
      "",
      "[Removed Lines]",
      "1126: #line 584 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1127: #line 585 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 18 ---",
      "[Context before]",
      "1139:  return 1;",
      "1140: }",
      "1142: yy76:",
      "1143:  yych = *++YYCURSOR;",
      "1144:  if (yych == 'N') goto yy73;",
      "",
      "[Removed Lines]",
      "1141: #line 1142 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 19 ---",
      "[Context before]",
      "1165:  if (yych <= '9') goto yy79;",
      "1166:  if (yych != ';') goto yy18;",
      "1167:  ++YYCURSOR;",
      "1169:  {",
      "1170: #if SIZEOF_LONG == 4",
      "1171:  int digits = YYCURSOR - start - 3;",
      "",
      "[Removed Lines]",
      "1168: #line 557 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1169: #line 558 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 20 ---",
      "[Context before]",
      "1192:  ZVAL_LONG(*rval, parse_iv(start + 2));",
      "1193:  return 1;",
      "1194: }",
      "1196: yy83:",
      "1197:  yych = *++YYCURSOR;",
      "1198:  if (yych <= '/') goto yy18;",
      "",
      "[Removed Lines]",
      "1195: #line 1196 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 21 ---",
      "[Context before]",
      "1200:  yych = *++YYCURSOR;",
      "1201:  if (yych != ';') goto yy18;",
      "1202:  ++YYCURSOR;",
      "1204:  {",
      "1206:  INIT_PZVAL(*rval);",
      "1207:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
      "1208:  return 1;",
      "1209: }",
      "1211: yy87:",
      "1212:  ++YYCURSOR;",
      "1214:  {",
      "1216:  INIT_PZVAL(*rval);",
      "1217:  ZVAL_NULL(*rval);",
      "1218:  return 1;",
      "1219: }",
      "1221: yy89:",
      "1222:  yych = *++YYCURSOR;",
      "1223:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1203: #line 550 \"ext/standard/var_unserializer.re\"",
      "1210: #line 1211 \"ext/standard/var_unserializer.c\"",
      "1213: #line 543 \"ext/standard/var_unserializer.re\"",
      "1220: #line 1221 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1204: #line 551 \"ext/standard/var_unserializer.re\"",
      "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
      "1214: #line 544 \"ext/standard/var_unserializer.re\"",
      "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 22 ---",
      "[Context before]",
      "1240:  if (yych <= '9') goto yy91;",
      "1241:  if (yych != ';') goto yy18;",
      "1242:  ++YYCURSOR;",
      "1244:  {",
      "1245:  long id;",
      "",
      "[Removed Lines]",
      "1243: #line 520 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1244: #line 521 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 23 ---",
      "[Context before]",
      "1264:  return 1;",
      "1265: }",
      "1267: yy95:",
      "1268:  yych = *++YYCURSOR;",
      "1269:  if (yych <= ',') {",
      "",
      "[Removed Lines]",
      "1266: #line 1267 \"ext/standard/var_unserializer.c\"",
      "",
      "[Added Lines]",
      "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
      "",
      "---------------",
      "--- Hunk 24 ---",
      "[Context before]",
      "1286:  if (yych <= '9') goto yy97;",
      "1287:  if (yych != ';') goto yy18;",
      "1288:  ++YYCURSOR;",
      "1290:  {",
      "1291:  long id;",
      "",
      "[Removed Lines]",
      "1289: #line 499 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1290: #line 500 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------",
      "--- Hunk 25 ---",
      "[Context before]",
      "1308:  return 1;",
      "1309: }",
      "1311: }",
      "1315:  return 0;",
      "",
      "[Removed Lines]",
      "1310: #line 1311 \"ext/standard/var_unserializer.c\"",
      "1312: #line 862 \"ext/standard/var_unserializer.re\"",
      "",
      "[Added Lines]",
      "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
      "1313: #line 863 \"ext/standard/var_unserializer.re\"",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "442:      if(Z_TYPE_PP(rval) == IS_OBJECT) {",
      "443:         zend_hash_clean(Z_OBJPROP_PP(rval));",
      "444:      }",
      "445:      ZVAL_NULL(*rval);",
      "446:   return 0;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "444:         zend_object_store_ctor_failed(*rval TSRMLS_CC);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "27876d22ef47cd8efe6230ee5cb52ab5d650c848",
      "candidate_info": {
        "commit_hash": "27876d22ef47cd8efe6230ee5cb52ab5d650c848",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/27876d22ef47cd8efe6230ee5cb52ab5d650c848",
        "files": [
          "ext/standard/tests/serialize/bug73052.phpt"
        ],
        "message": "Fix bug #73052 - Memory Corruption in During Deserialized-object Destruction\n\n(cherry picked from commit b6e1e5e0b3e6221c7b14fa10cba30f5c5e719e1b)\n\nConflicts:\n\tZend/zend_objects_API.c\n\text/standard/var_unserializer.c\n\text/standard/var_unserializer.re",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug73052.phpt||ext/standard/tests/serialize/bug73052.phpt": [
          "File: ext/standard/tests/serialize/bug73052.phpt -> ext/standard/tests/serialize/bug73052.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #73052: Memory Corruption in During Deserialized-object Destruction",
          "3: --FILE--",
          "4: <?php",
          "6: class obj {",
          "7:     var $ryat;",
          "8:     public function __destruct() {",
          "9:         $this->ryat = null;",
          "10:     }",
          "11: }",
          "13: $poc = 'O:3:\"obj\":1:{';",
          "14: var_dump(unserialize($poc));",
          "15: ?>",
          "16: --EXPECTF--",
          "17: Notice: unserialize(): Error at offset 13 of 13 bytes in %sbug73052.php on line %d",
          "18: bool(false)",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "3a25a56a92ac1d0d6028a8ecd32ccf03bcd71ade",
      "candidate_info": {
        "commit_hash": "3a25a56a92ac1d0d6028a8ecd32ccf03bcd71ade",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/3a25a56a92ac1d0d6028a8ecd32ccf03bcd71ade",
        "files": [
          "ext/standard/tests/serialize/bug25378.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #74111",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug25378.phpt||ext/standard/tests/serialize/bug25378.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug25378.phpt||ext/standard/tests/serialize/bug25378.phpt": [
          "File: ext/standard/tests/serialize/bug25378.phpt -> ext/standard/tests/serialize/bug25378.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: Notice: unserialize(): Error at offset 17 of 33 bytes in %sbug25378.php on line %d",
          "43: bool(false)",
          "46: bool(false)",
          "48: Notice: unserialize(): Error at offset 2 of 13 bytes in %sbug25378.php on line %d",
          "",
          "[Removed Lines]",
          "45: Notice: unserialize(): Error at offset 33 of 32 bytes in %sbug25378.php on line %d",
          "",
          "[Added Lines]",
          "45: Notice: unserialize(): Error at offset 32 of 32 bytes in %sbug25378.php on line %d",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "429: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "430: {",
          "438: }",
          "440: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "",
          "[Removed Lines]",
          "431:  if (*((*p)++) == '}')",
          "432:   return 1;",
          "434: #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE",
          "435:  zval_ptr_dtor(rval);",
          "436: #endif",
          "437:  return 0;",
          "",
          "[Added Lines]",
          "431:  if (*p >= max || **p != '}') {",
          "432:   return 0;",
          "433:  }",
          "435:  (*p)++;",
          "436:  return 1;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "582:  start = cursor;",
          "586: {",
          "587:  YYCTYPE yych;",
          "588:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "585: #line 586 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "584: #line 585 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "623:  yych = *YYCURSOR;",
          "624:  switch (yych) {",
          "625:  case 'C':",
          "627:  case 'N': goto yy5;",
          "634:  case 'o': goto yy12;",
          "639:  }",
          "640: yy2:",
          "642: yy3:",
          "644:  { return 0; }",
          "645: #line 646 \"ext/standard/var_unserializer.c\"",
          "646: yy4:",
          "647:  yych = *(YYMARKER = ++YYCURSOR);",
          "649:  goto yy3;",
          "650: yy5:",
          "651:  yych = *++YYCURSOR;",
          "653:  goto yy3;",
          "654: yy6:",
          "655:  yych = *(YYMARKER = ++YYCURSOR);",
          "657:  goto yy3;",
          "658: yy7:",
          "659:  yych = *(YYMARKER = ++YYCURSOR);",
          "661:  goto yy3;",
          "662: yy8:",
          "663:  yych = *(YYMARKER = ++YYCURSOR);",
          "665:  goto yy3;",
          "666: yy9:",
          "667:  yych = *(YYMARKER = ++YYCURSOR);",
          "669:  goto yy3;",
          "670: yy10:",
          "671:  yych = *(YYMARKER = ++YYCURSOR);",
          "673:  goto yy3;",
          "674: yy11:",
          "675:  yych = *(YYMARKER = ++YYCURSOR);",
          "677:  goto yy3;",
          "678: yy12:",
          "679:  yych = *(YYMARKER = ++YYCURSOR);",
          "681:  goto yy3;",
          "682: yy13:",
          "683:  yych = *(YYMARKER = ++YYCURSOR);",
          "685:  goto yy3;",
          "686: yy14:",
          "691:  ++YYCURSOR;",
          "693:  {",
          "695:  php_error_docref(NULL, E_NOTICE, \"Unexpected end of serialized data\");",
          "697: }",
          "699: yy17:",
          "700:  yych = *++YYCURSOR;",
          "701:  if (yybm[0+yych] & 128) {",
          "703:  }",
          "705: yy18:",
          "706:  YYCURSOR = YYMARKER;",
          "707:  goto yy3;",
          "708: yy19:",
          "718:  yych = *++YYCURSOR;",
          "727:  }",
          "739:  goto yy18;",
          "742:  if (yych <= '/') goto yy18;",
          "746:  yych = *++YYCURSOR;",
          "755:   }",
          "764:   }",
          "765:  }",
          "776:  }",
          "787:  }",
          "789:  yych = *++YYCURSOR;",
          "790:  if (yych <= ',') {",
          "793:  } else {",
          "795:   if (yych <= '/') goto yy18;",
          "797:   goto yy18;",
          "798:  }",
          "800:  yych = *++YYCURSOR;",
          "802:  if (yych <= '/') goto yy18;",
          "812:  ++YYCURSOR;",
          "813:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "814:  yych = *YYCURSOR;",
          "818:  if (yych <= '/') goto yy18;",
          "822:  yych = *++YYCURSOR;",
          "826:  ++YYCURSOR;",
          "829:  if (yych <= '/') goto yy18;",
          "830:  if (yych <= '9') goto yy34;",
          "832:  goto yy18;",
          "834:  yych = *++YYCURSOR;",
          "835:  if (yych <= '/') goto yy18;",
          "836:  if (yych >= ':') goto yy18;",
          "838:  ++YYCURSOR;",
          "839:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "840:  yych = *YYCURSOR;",
          "841:  if (yych <= '/') goto yy18;",
          "846:  yych = *++YYCURSOR;",
          "850:  ++YYCURSOR;",
          "875:  }",
          "903:  }",
          "913:  yych = *++YYCURSOR;",
          "914:  if (yych <= '/') goto yy18;",
          "923:  goto yy18;",
          "925:  yych = *++YYCURSOR;",
          "926:  if (yych <= '/') goto yy18;",
          "927:  if (yych >= ':') goto yy18;",
          "929:  ++YYCURSOR;",
          "930:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "931:  yych = *YYCURSOR;",
          "932:  if (yych <= '/') goto yy18;",
          "937:  yych = *++YYCURSOR;",
          "941:  ++YYCURSOR;",
          "944:  if (yych <= '/') goto yy18;",
          "947:  goto yy18;",
          "949:  yych = *++YYCURSOR;",
          "950:  if (yych <= '/') goto yy18;",
          "951:  if (yych >= ':') goto yy18;",
          "953:  ++YYCURSOR;",
          "954:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "955:  yych = *YYCURSOR;",
          "956:  if (yych <= '/') goto yy18;",
          "961:  yych = *++YYCURSOR;",
          "965:  ++YYCURSOR;",
          "967:  {",
          "975:   return 0;",
          "976:  }",
          "982:  }",
          "988:  }",
          "990:  return 1;",
          "991: }",
          "994:  yych = *++YYCURSOR;",
          "996:  goto yy18;",
          "998:  yych = *++YYCURSOR;",
          "1000:  goto yy18;",
          "1002:  ++YYCURSOR;",
          "1011:  ++YYCURSOR;",
          "1012:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1013:  yych = *YYCURSOR;",
          "1014:  if (yych <= ';') {",
          "1015:   if (yych <= '/') goto yy18;",
          "1017:   if (yych <= ':') goto yy18;",
          "1018:  } else {",
          "1019:   if (yych <= 'E') {",
          "1020:    if (yych <= 'D') goto yy18;",
          "1022:   } else {",
          "1024:    goto yy18;",
          "1025:   }",
          "1026:  }",
          "1028:  ++YYCURSOR;",
          "1030:  {",
          "1031: #if SIZEOF_ZEND_LONG == 4",
          "1032: use_double:",
          "",
          "[Removed Lines]",
          "626:  case 'O': goto yy4;",
          "628:  case 'R': goto yy6;",
          "629:  case 'S': goto yy7;",
          "630:  case 'a': goto yy8;",
          "631:  case 'b': goto yy9;",
          "632:  case 'd': goto yy10;",
          "633:  case 'i': goto yy11;",
          "635:  case 'r': goto yy13;",
          "636:  case 's': goto yy14;",
          "637:  case '}': goto yy15;",
          "638:  default: goto yy2;",
          "641:  ++YYCURSOR;",
          "643: #line 963 \"ext/standard/var_unserializer.re\"",
          "648:  if (yych == ':') goto yy17;",
          "652:  if (yych == ';') goto yy19;",
          "656:  if (yych == ':') goto yy21;",
          "660:  if (yych == ':') goto yy22;",
          "664:  if (yych == ':') goto yy23;",
          "668:  if (yych == ':') goto yy24;",
          "672:  if (yych == ':') goto yy25;",
          "676:  if (yych == ':') goto yy26;",
          "680:  if (yych == ':') goto yy27;",
          "684:  if (yych == ':') goto yy28;",
          "687:  yych = *(YYMARKER = ++YYCURSOR);",
          "688:  if (yych == ':') goto yy29;",
          "689:  goto yy3;",
          "690: yy15:",
          "692: #line 957 \"ext/standard/var_unserializer.re\"",
          "698: #line 699 \"ext/standard/var_unserializer.c\"",
          "702:   goto yy31;",
          "704:  if (yych == '+') goto yy30;",
          "709:  ++YYCURSOR;",
          "710: #line 641 \"ext/standard/var_unserializer.re\"",
          "711:  {",
          "713:  ZVAL_NULL(rval);",
          "714:  return 1;",
          "715: }",
          "716: #line 717 \"ext/standard/var_unserializer.c\"",
          "717: yy21:",
          "719:  if (yych <= ',') {",
          "720:   if (yych == '+') goto yy33;",
          "721:   goto yy18;",
          "722:  } else {",
          "723:   if (yych <= '-') goto yy33;",
          "724:   if (yych <= '/') goto yy18;",
          "725:   if (yych <= '9') goto yy34;",
          "726:   goto yy18;",
          "728: yy22:",
          "729:  yych = *++YYCURSOR;",
          "730:  if (yych == '+') goto yy36;",
          "731:  if (yych <= '/') goto yy18;",
          "732:  if (yych <= '9') goto yy37;",
          "733:  goto yy18;",
          "734: yy23:",
          "735:  yych = *++YYCURSOR;",
          "736:  if (yych == '+') goto yy39;",
          "737:  if (yych <= '/') goto yy18;",
          "738:  if (yych <= '9') goto yy40;",
          "740: yy24:",
          "741:  yych = *++YYCURSOR;",
          "743:  if (yych <= '1') goto yy42;",
          "744:  goto yy18;",
          "745: yy25:",
          "747:  if (yych <= '/') {",
          "748:   if (yych <= ',') {",
          "749:    if (yych == '+') goto yy43;",
          "750:    goto yy18;",
          "751:   } else {",
          "752:    if (yych <= '-') goto yy44;",
          "753:    if (yych <= '.') goto yy45;",
          "754:    goto yy18;",
          "756:  } else {",
          "757:   if (yych <= 'I') {",
          "758:    if (yych <= '9') goto yy46;",
          "759:    if (yych <= 'H') goto yy18;",
          "760:    goto yy48;",
          "761:   } else {",
          "762:    if (yych == 'N') goto yy49;",
          "763:    goto yy18;",
          "766: yy26:",
          "767:  yych = *++YYCURSOR;",
          "768:  if (yych <= ',') {",
          "769:   if (yych == '+') goto yy50;",
          "770:   goto yy18;",
          "771:  } else {",
          "772:   if (yych <= '-') goto yy50;",
          "773:   if (yych <= '/') goto yy18;",
          "774:   if (yych <= '9') goto yy51;",
          "775:   goto yy18;",
          "777: yy27:",
          "778:  yych = *++YYCURSOR;",
          "779:  if (yych <= ',') {",
          "780:   if (yych == '+') goto yy53;",
          "781:   goto yy18;",
          "782:  } else {",
          "783:   if (yych <= '-') goto yy53;",
          "784:   if (yych <= '/') goto yy18;",
          "785:   if (yych <= '9') goto yy54;",
          "786:   goto yy18;",
          "788: yy28:",
          "791:   if (yych == '+') goto yy56;",
          "792:   goto yy18;",
          "794:   if (yych <= '-') goto yy56;",
          "796:   if (yych <= '9') goto yy57;",
          "799: yy29:",
          "801:  if (yych == '+') goto yy59;",
          "803:  if (yych <= '9') goto yy60;",
          "804:  goto yy18;",
          "805: yy30:",
          "806:  yych = *++YYCURSOR;",
          "807:  if (yybm[0+yych] & 128) {",
          "808:   goto yy31;",
          "809:  }",
          "810:  goto yy18;",
          "811: yy31:",
          "815:  if (yybm[0+yych] & 128) {",
          "816:   goto yy31;",
          "817:  }",
          "819:  if (yych <= ':') goto yy62;",
          "820:  goto yy18;",
          "821: yy33:",
          "823:  if (yych <= '/') goto yy18;",
          "824:  if (yych >= ':') goto yy18;",
          "825: yy34:",
          "827:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "828:  yych = *YYCURSOR;",
          "831:  if (yych == ';') goto yy63;",
          "833: yy36:",
          "837: yy37:",
          "842:  if (yych <= '9') goto yy37;",
          "843:  if (yych <= ':') goto yy65;",
          "844:  goto yy18;",
          "845: yy39:",
          "847:  if (yych <= '/') goto yy18;",
          "848:  if (yych >= ':') goto yy18;",
          "849: yy40:",
          "851:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "852:  yych = *YYCURSOR;",
          "853:  if (yych <= '/') goto yy18;",
          "854:  if (yych <= '9') goto yy40;",
          "855:  if (yych <= ':') goto yy66;",
          "856:  goto yy18;",
          "857: yy42:",
          "858:  yych = *++YYCURSOR;",
          "859:  if (yych == ';') goto yy67;",
          "860:  goto yy18;",
          "861: yy43:",
          "862:  yych = *++YYCURSOR;",
          "863:  if (yych == '.') goto yy45;",
          "864:  if (yych <= '/') goto yy18;",
          "865:  if (yych <= '9') goto yy46;",
          "866:  goto yy18;",
          "867: yy44:",
          "868:  yych = *++YYCURSOR;",
          "869:  if (yych <= '/') {",
          "870:   if (yych != '.') goto yy18;",
          "871:  } else {",
          "872:   if (yych <= '9') goto yy46;",
          "873:   if (yych == 'I') goto yy48;",
          "874:   goto yy18;",
          "876: yy45:",
          "877:  yych = *++YYCURSOR;",
          "878:  if (yych <= '/') goto yy18;",
          "879:  if (yych <= '9') goto yy69;",
          "880:  goto yy18;",
          "881: yy46:",
          "882:  ++YYCURSOR;",
          "883:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "884:  yych = *YYCURSOR;",
          "885:  if (yych <= ':') {",
          "886:   if (yych <= '.') {",
          "887:    if (yych <= '-') goto yy18;",
          "888:    goto yy69;",
          "889:   } else {",
          "890:    if (yych <= '/') goto yy18;",
          "891:    if (yych <= '9') goto yy46;",
          "892:    goto yy18;",
          "893:   }",
          "894:  } else {",
          "895:   if (yych <= 'E') {",
          "896:    if (yych <= ';') goto yy71;",
          "897:    if (yych <= 'D') goto yy18;",
          "898:    goto yy73;",
          "899:   } else {",
          "900:    if (yych == 'e') goto yy73;",
          "901:    goto yy18;",
          "902:   }",
          "904: yy48:",
          "905:  yych = *++YYCURSOR;",
          "906:  if (yych == 'N') goto yy74;",
          "907:  goto yy18;",
          "908: yy49:",
          "909:  yych = *++YYCURSOR;",
          "910:  if (yych == 'A') goto yy75;",
          "911:  goto yy18;",
          "912: yy50:",
          "915:  if (yych >= ':') goto yy18;",
          "916: yy51:",
          "917:  ++YYCURSOR;",
          "918:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "919:  yych = *YYCURSOR;",
          "920:  if (yych <= '/') goto yy18;",
          "921:  if (yych <= '9') goto yy51;",
          "922:  if (yych == ';') goto yy76;",
          "924: yy53:",
          "928: yy54:",
          "933:  if (yych <= '9') goto yy54;",
          "934:  if (yych <= ':') goto yy78;",
          "935:  goto yy18;",
          "936: yy56:",
          "938:  if (yych <= '/') goto yy18;",
          "939:  if (yych >= ':') goto yy18;",
          "940: yy57:",
          "942:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "943:  yych = *YYCURSOR;",
          "945:  if (yych <= '9') goto yy57;",
          "946:  if (yych == ';') goto yy79;",
          "948: yy59:",
          "952: yy60:",
          "957:  if (yych <= '9') goto yy60;",
          "958:  if (yych <= ':') goto yy81;",
          "959:  goto yy18;",
          "960: yy62:",
          "962:  if (yych == '\"') goto yy82;",
          "963:  goto yy18;",
          "964: yy63:",
          "966: #line 590 \"ext/standard/var_unserializer.re\"",
          "968:  zend_long id;",
          "971:  if (!var_hash) return 0;",
          "973:  id = parse_iv(start + 2) - 1;",
          "974:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "978:  zval_ptr_dtor(rval);",
          "979:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "980:   ZVAL_UNDEF(rval);",
          "981:   return 1;",
          "983:  if (Z_ISREF_P(rval_ref)) {",
          "984:   ZVAL_COPY(rval, rval_ref);",
          "985:  } else {",
          "986:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "987:   ZVAL_COPY(rval, rval_ref);",
          "992: #line 993 \"ext/standard/var_unserializer.c\"",
          "993: yy65:",
          "995:  if (yych == '\"') goto yy84;",
          "997: yy66:",
          "999:  if (yych == '{') goto yy86;",
          "1001: yy67:",
          "1003: #line 647 \"ext/standard/var_unserializer.re\"",
          "1004:  {",
          "1006:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1007:  return 1;",
          "1008: }",
          "1009: #line 1010 \"ext/standard/var_unserializer.c\"",
          "1010: yy69:",
          "1016:   if (yych <= '9') goto yy69;",
          "1021:    goto yy73;",
          "1023:    if (yych == 'e') goto yy73;",
          "1027: yy71:",
          "1029: #line 695 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "625:  case 'O': goto yy13;",
          "627:  case 'R': goto yy2;",
          "628:  case 'S': goto yy10;",
          "629:  case 'a': goto yy11;",
          "630:  case 'b': goto yy6;",
          "631:  case 'd': goto yy8;",
          "632:  case 'i': goto yy7;",
          "634:  case 'r': goto yy4;",
          "635:  case 's': goto yy9;",
          "636:  case '}': goto yy14;",
          "637:  default: goto yy16;",
          "640:  yych = *(YYMARKER = ++YYCURSOR);",
          "641:  if (yych == ':') goto yy95;",
          "643: #line 962 \"ext/standard/var_unserializer.re\"",
          "648:  if (yych == ':') goto yy89;",
          "652:  if (yych == ';') goto yy87;",
          "656:  if (yych == ':') goto yy83;",
          "660:  if (yych == ':') goto yy77;",
          "664:  if (yych == ':') goto yy53;",
          "668:  if (yych == ':') goto yy46;",
          "672:  if (yych == ':') goto yy39;",
          "676:  if (yych == ':') goto yy32;",
          "680:  if (yych == ':') goto yy25;",
          "684:  if (yych == ':') goto yy17;",
          "688: #line 956 \"ext/standard/var_unserializer.re\"",
          "694: #line 695 \"ext/standard/var_unserializer.c\"",
          "695: yy16:",
          "696:  yych = *++YYCURSOR;",
          "697:  goto yy3;",
          "701:   goto yy20;",
          "703:  if (yych == '+') goto yy19;",
          "709:  if (yybm[0+yych] & 128) {",
          "710:   goto yy20;",
          "713: yy20:",
          "714:  ++YYCURSOR;",
          "715:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "716:  yych = *YYCURSOR;",
          "717:  if (yybm[0+yych] & 128) {",
          "718:   goto yy20;",
          "719:  }",
          "721:  if (yych >= ';') goto yy18;",
          "723:  if (yych != '\"') goto yy18;",
          "724:  ++YYCURSOR;",
          "725: #line 804 \"ext/standard/var_unserializer.re\"",
          "726:  {",
          "727:  size_t len, len2, len3, maxlen;",
          "728:  zend_long elements;",
          "729:  char *str;",
          "730:  zend_string *class_name;",
          "731:  zend_class_entry *ce;",
          "732:  int incomplete_class = 0;",
          "734:  int custom_object = 0;",
          "736:  zval user_func;",
          "737:  zval retval;",
          "738:  zval args[1];",
          "740:     if (!var_hash) return 0;",
          "741:  if (*start == 'C') {",
          "742:   custom_object = 1;",
          "743:  }",
          "745:  len2 = len = parse_uiv(start + 2);",
          "746:  maxlen = max - YYCURSOR;",
          "747:  if (maxlen < len || len == 0) {",
          "749:   return 0;",
          "750:  }",
          "752:  str = (char*)YYCURSOR;",
          "754:  YYCURSOR += len;",
          "756:  if (*(YYCURSOR) != '\"') {",
          "758:   return 0;",
          "759:  }",
          "760:  if (*(YYCURSOR+1) != ':') {",
          "762:   return 0;",
          "763:  }",
          "765:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "766:  if (len3 != len)",
          "767:  {",
          "769:   return 0;",
          "770:  }",
          "772:  class_name = zend_string_init(str, len, 0);",
          "774:  do {",
          "775:   if(!unserialize_allowed_class(class_name, classes)) {",
          "776:    incomplete_class = 1;",
          "777:    ce = PHP_IC_ENTRY;",
          "778:    break;",
          "782:   BG(serialize_lock)++;",
          "783:   ce = zend_lookup_class(class_name);",
          "784:   if (ce) {",
          "785:    BG(serialize_lock)--;",
          "786:    if (EG(exception)) {",
          "787:     zend_string_release(class_name);",
          "788:     return 0;",
          "789:    }",
          "790:    break;",
          "791:   }",
          "792:   BG(serialize_lock)--;",
          "794:   if (EG(exception)) {",
          "795:    zend_string_release(class_name);",
          "796:    return 0;",
          "797:   }",
          "800:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "801:    incomplete_class = 1;",
          "802:    ce = PHP_IC_ENTRY;",
          "803:    break;",
          "804:   }",
          "807:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "809:   ZVAL_STR_COPY(&args[0], class_name);",
          "810:   BG(serialize_lock)++;",
          "811:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "812:    BG(serialize_lock)--;",
          "813:    if (EG(exception)) {",
          "814:     zend_string_release(class_name);",
          "815:     zval_ptr_dtor(&user_func);",
          "816:     zval_ptr_dtor(&args[0]);",
          "817:     return 0;",
          "818:    }",
          "819:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "820:    incomplete_class = 1;",
          "821:    ce = PHP_IC_ENTRY;",
          "822:    zval_ptr_dtor(&user_func);",
          "823:    zval_ptr_dtor(&args[0]);",
          "824:    break;",
          "825:   }",
          "826:   BG(serialize_lock)--;",
          "827:   zval_ptr_dtor(&retval);",
          "828:   if (EG(exception)) {",
          "829:    zend_string_release(class_name);",
          "830:    zval_ptr_dtor(&user_func);",
          "831:    zval_ptr_dtor(&args[0]);",
          "832:    return 0;",
          "833:   }",
          "836:   BG(serialize_lock)++;",
          "837:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "838:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "839:    incomplete_class = 1;",
          "840:    ce = PHP_IC_ENTRY;",
          "841:   }",
          "842:   BG(serialize_lock)--;",
          "844:   zval_ptr_dtor(&user_func);",
          "845:   zval_ptr_dtor(&args[0]);",
          "846:   break;",
          "847:  } while (1);",
          "851:  if (custom_object) {",
          "852:   int ret;",
          "854:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "856:   if (ret && incomplete_class) {",
          "857:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "859:   zend_string_release(class_name);",
          "860:   return ret;",
          "863:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "865:  if (elements < 0) {",
          "866:     zend_string_release(class_name);",
          "867:     return 0;",
          "870:  if (incomplete_class) {",
          "871:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "873:  zend_string_release(class_name);",
          "875:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "876: }",
          "877: #line 878 \"ext/standard/var_unserializer.c\"",
          "878: yy25:",
          "881:   if (yych != '+') goto yy18;",
          "883:   if (yych <= '-') goto yy26;",
          "885:   if (yych <= '9') goto yy27;",
          "888: yy26:",
          "891:  if (yych >= ':') goto yy18;",
          "892: yy27:",
          "897:  if (yych <= '9') goto yy27;",
          "898:  if (yych >= ';') goto yy18;",
          "900:  if (yych != '\"') goto yy18;",
          "902: #line 793 \"ext/standard/var_unserializer.re\"",
          "903:  {",
          "904:  zend_long elements;",
          "905:     if (!var_hash) return 0;",
          "907:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "908:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "909:   return 0;",
          "910:  }",
          "911:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "912: }",
          "913: #line 914 \"ext/standard/var_unserializer.c\"",
          "914: yy32:",
          "915:  yych = *++YYCURSOR;",
          "916:  if (yych == '+') goto yy33;",
          "920: yy33:",
          "924: yy34:",
          "929:  if (yych <= '9') goto yy34;",
          "930:  if (yych >= ';') goto yy18;",
          "932:  if (yych != '{') goto yy18;",
          "934: #line 769 \"ext/standard/var_unserializer.re\"",
          "935:  {",
          "936:  zend_long elements = parse_iv(start + 2);",
          "939:     if (!var_hash) return 0;",
          "941:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "942:   return 0;",
          "945:  array_init_size(rval, elements);",
          "946:  if (elements) {",
          "949:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "952:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "953:   return 0;",
          "954:  }",
          "956:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "957: }",
          "958: #line 959 \"ext/standard/var_unserializer.c\"",
          "959: yy39:",
          "961:  if (yych == '+') goto yy40;",
          "963:  if (yych <= '9') goto yy41;",
          "965: yy40:",
          "969: yy41:",
          "974:  if (yych <= '9') goto yy41;",
          "975:  if (yych >= ';') goto yy18;",
          "977:  if (yych != '\"') goto yy18;",
          "979: #line 735 \"ext/standard/var_unserializer.re\"",
          "980:  {",
          "981:  size_t len, maxlen;",
          "982:  zend_string *str;",
          "984:  len = parse_uiv(start + 2);",
          "985:  maxlen = max - YYCURSOR;",
          "986:  if (maxlen < len) {",
          "988:   return 0;",
          "989:  }",
          "991:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "992:   return 0;",
          "993:  }",
          "995:  if (*(YYCURSOR) != '\"') {",
          "996:   zend_string_free(str);",
          "998:   return 0;",
          "999:  }",
          "1001:  if (*(YYCURSOR + 1) != ';') {",
          "1002:   efree(str);",
          "1004:   return 0;",
          "1005:  }",
          "1007:  YYCURSOR += 2;",
          "1010:  ZVAL_STR(rval, str);",
          "1011:  return 1;",
          "1012: }",
          "1013: #line 1014 \"ext/standard/var_unserializer.c\"",
          "1014: yy46:",
          "1015:  yych = *++YYCURSOR;",
          "1016:  if (yych == '+') goto yy47;",
          "1018:  if (yych <= '9') goto yy48;",
          "1020: yy47:",
          "1024: yy48:",
          "1029:  if (yych <= '9') goto yy48;",
          "1030:  if (yych >= ';') goto yy18;",
          "1032:  if (yych != '\"') goto yy18;",
          "1034: #line 703 \"ext/standard/var_unserializer.re\"",
          "1036:  size_t len, maxlen;",
          "1037:  char *str;",
          "1039:  len = parse_uiv(start + 2);",
          "1040:  maxlen = max - YYCURSOR;",
          "1041:  if (maxlen < len) {",
          "1046:  str = (char*)YYCURSOR;",
          "1048:  YYCURSOR += len;",
          "1050:  if (*(YYCURSOR) != '\"') {",
          "1052:   return 0;",
          "1055:  if (*(YYCURSOR + 1) != ';') {",
          "1057:   return 0;",
          "1060:  YYCURSOR += 2;",
          "1063:  ZVAL_STRINGL(rval, str, len);",
          "1066: #line 1067 \"ext/standard/var_unserializer.c\"",
          "1067: yy53:",
          "1068:  yych = *++YYCURSOR;",
          "1069:  if (yych <= '/') {",
          "1070:   if (yych <= ',') {",
          "1071:    if (yych == '+') goto yy57;",
          "1072:    goto yy18;",
          "1073:   } else {",
          "1074:    if (yych <= '-') goto yy55;",
          "1075:    if (yych <= '.') goto yy60;",
          "1076:    goto yy18;",
          "1077:   }",
          "1078:  } else {",
          "1079:   if (yych <= 'I') {",
          "1080:    if (yych <= '9') goto yy58;",
          "1081:    if (yych <= 'H') goto yy18;",
          "1082:    goto yy56;",
          "1083:   } else {",
          "1084:    if (yych != 'N') goto yy18;",
          "1085:   }",
          "1086:  }",
          "1088:  if (yych == 'A') goto yy76;",
          "1090: yy55:",
          "1091:  yych = *++YYCURSOR;",
          "1092:  if (yych <= '/') {",
          "1093:   if (yych == '.') goto yy60;",
          "1094:   goto yy18;",
          "1095:  } else {",
          "1096:   if (yych <= '9') goto yy58;",
          "1097:   if (yych != 'I') goto yy18;",
          "1098:  }",
          "1099: yy56:",
          "1101:  if (yych == 'N') goto yy72;",
          "1103: yy57:",
          "1104:  yych = *++YYCURSOR;",
          "1105:  if (yych == '.') goto yy60;",
          "1106:  if (yych <= '/') goto yy18;",
          "1107:  if (yych >= ':') goto yy18;",
          "1108: yy58:",
          "1110:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1111:  yych = *YYCURSOR;",
          "1112:  if (yych <= ':') {",
          "1113:   if (yych <= '.') {",
          "1114:    if (yych <= '-') goto yy18;",
          "1115:    goto yy70;",
          "1116:   } else {",
          "1117:    if (yych <= '/') goto yy18;",
          "1118:    if (yych <= '9') goto yy58;",
          "1119:    goto yy18;",
          "1120:   }",
          "1121:  } else {",
          "1122:   if (yych <= 'E') {",
          "1123:    if (yych <= ';') goto yy63;",
          "1124:    if (yych <= 'D') goto yy18;",
          "1125:    goto yy65;",
          "1126:   } else {",
          "1127:    if (yych == 'e') goto yy65;",
          "1128:    goto yy18;",
          "1129:   }",
          "1130:  }",
          "1131: yy60:",
          "1132:  yych = *++YYCURSOR;",
          "1133:  if (yych <= '/') goto yy18;",
          "1134:  if (yych >= ':') goto yy18;",
          "1135: yy61:",
          "1141:   if (yych <= '9') goto yy61;",
          "1146:    goto yy65;",
          "1148:    if (yych == 'e') goto yy65;",
          "1152: yy63:",
          "1154: #line 694 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "1035:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1036:  return 1;",
          "1037: }",
          "1040:  yych = *++YYCURSOR;",
          "1041:  if (yych <= ',') {",
          "1044:  } else {",
          "1046:   if (yych <= '/') goto yy18;",
          "1048:   goto yy18;",
          "1049:  }",
          "1051:  yych = *++YYCURSOR;",
          "1053:  goto yy18;",
          "1055:  yych = *++YYCURSOR;",
          "1057:  goto yy18;",
          "1059:  ++YYCURSOR;",
          "1077:   } else {",
          "1079:   }",
          "1080:  }",
          "1088:  yych = *++YYCURSOR;",
          "1092:  ++YYCURSOR;",
          "1094:  {",
          "1112:  }",
          "1116:  return 1;",
          "1117: }",
          "1120:  yych = *++YYCURSOR;",
          "1122:  goto yy18;",
          "1124:  ++YYCURSOR;",
          "1126:  {",
          "1170:  }",
          "1218:    }",
          "1258:   }",
          "1268:  }",
          "1276: }",
          "1279:  ++YYCURSOR;",
          "1281:  {",
          "1312:  return 1;",
          "1313: }",
          "1316:  ++YYCURSOR;",
          "1318:  {",
          "1340: }",
          "1343:  yych = *++YYCURSOR;",
          "1344:  if (yych <= ',') {",
          "1347:  } else {",
          "1349:   if (yych <= '/') goto yy18;",
          "1351:  }",
          "1353:  ++YYCURSOR;",
          "1354:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1355:  yych = *YYCURSOR;",
          "1356:  if (yych <= '/') goto yy18;",
          "1365:  ++YYCURSOR;",
          "1367:  {",
          "1389:   return 0;",
          "1390:  }",
          "1398:   return 0;",
          "1399:  }",
          "1404:  }",
          "1410:  return 1;",
          "1411: }",
          "1413: yy96:",
          "1414:  yych = *++YYCURSOR;",
          "1415:  if (yych <= '/') goto yy18;",
          "1418: yy97:",
          "1419:  ++YYCURSOR;",
          "1421:  {",
          "1430:  } else {",
          "1432:  }",
          "1434:  return 1;",
          "1435: }",
          "1437: }",
          "1441:  return 0;",
          "",
          "[Removed Lines]",
          "1038: #line 1039 \"ext/standard/var_unserializer.c\"",
          "1039: yy73:",
          "1042:   if (yych == '+') goto yy88;",
          "1043:   goto yy18;",
          "1045:   if (yych <= '-') goto yy88;",
          "1047:   if (yych <= '9') goto yy89;",
          "1050: yy74:",
          "1052:  if (yych == 'F') goto yy91;",
          "1054: yy75:",
          "1056:  if (yych == 'N') goto yy91;",
          "1058: yy76:",
          "1060: #line 653 \"ext/standard/var_unserializer.re\"",
          "1061:  {",
          "1062: #if SIZEOF_ZEND_LONG == 4",
          "1063:  int digits = YYCURSOR - start - 3;",
          "1065:  if (start[2] == '-' || start[2] == '+') {",
          "1066:   digits--;",
          "1067:  }",
          "1070:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1071:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1072:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1074:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1075:     goto use_double;",
          "1076:    }",
          "1078:    goto use_double;",
          "1081: #endif",
          "1083:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1084:  return 1;",
          "1085: }",
          "1086: #line 1087 \"ext/standard/var_unserializer.c\"",
          "1087: yy78:",
          "1089:  if (yych == '\"') goto yy92;",
          "1090:  goto yy18;",
          "1091: yy79:",
          "1093: #line 616 \"ext/standard/var_unserializer.re\"",
          "1095:  zend_long id;",
          "1098:  if (!var_hash) return 0;",
          "1100:  id = parse_iv(start + 2) - 1;",
          "1101:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1102:   return 0;",
          "1103:  }",
          "1105:  if (rval_ref == rval) {",
          "1106:   return 0;",
          "1107:  }",
          "1109:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1110:   ZVAL_UNDEF(rval);",
          "1111:   return 1;",
          "1114:  ZVAL_COPY(rval, rval_ref);",
          "1118: #line 1119 \"ext/standard/var_unserializer.c\"",
          "1119: yy81:",
          "1121:  if (yych == '\"') goto yy94;",
          "1123: yy82:",
          "1125: #line 805 \"ext/standard/var_unserializer.re\"",
          "1127:  size_t len, len2, len3, maxlen;",
          "1128:  zend_long elements;",
          "1129:  char *str;",
          "1130:  zend_string *class_name;",
          "1131:  zend_class_entry *ce;",
          "1132:  int incomplete_class = 0;",
          "1134:  int custom_object = 0;",
          "1136:  zval user_func;",
          "1137:  zval retval;",
          "1138:  zval args[1];",
          "1140:     if (!var_hash) return 0;",
          "1141:  if (*start == 'C') {",
          "1142:   custom_object = 1;",
          "1143:  }",
          "1145:  len2 = len = parse_uiv(start + 2);",
          "1146:  maxlen = max - YYCURSOR;",
          "1147:  if (maxlen < len || len == 0) {",
          "1149:   return 0;",
          "1150:  }",
          "1152:  str = (char*)YYCURSOR;",
          "1154:  YYCURSOR += len;",
          "1156:  if (*(YYCURSOR) != '\"') {",
          "1158:   return 0;",
          "1159:  }",
          "1160:  if (*(YYCURSOR+1) != ':') {",
          "1162:   return 0;",
          "1163:  }",
          "1165:  len3 = strspn(str, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1166:  if (len3 != len)",
          "1167:  {",
          "1169:   return 0;",
          "1172:  class_name = zend_string_init(str, len, 0);",
          "1174:  do {",
          "1175:   if(!unserialize_allowed_class(class_name, classes)) {",
          "1176:    incomplete_class = 1;",
          "1177:    ce = PHP_IC_ENTRY;",
          "1178:    break;",
          "1179:   }",
          "1182:   BG(serialize_lock)++;",
          "1183:   ce = zend_lookup_class(class_name);",
          "1184:   if (ce) {",
          "1185:    BG(serialize_lock)--;",
          "1186:    if (EG(exception)) {",
          "1187:     zend_string_release(class_name);",
          "1188:     return 0;",
          "1189:    }",
          "1190:    break;",
          "1191:   }",
          "1192:   BG(serialize_lock)--;",
          "1194:   if (EG(exception)) {",
          "1195:    zend_string_release(class_name);",
          "1196:    return 0;",
          "1197:   }",
          "1200:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1201:    incomplete_class = 1;",
          "1202:    ce = PHP_IC_ENTRY;",
          "1203:    break;",
          "1204:   }",
          "1207:   ZVAL_STRING(&user_func, PG(unserialize_callback_func));",
          "1209:   ZVAL_STR_COPY(&args[0], class_name);",
          "1210:   BG(serialize_lock)++;",
          "1211:   if (call_user_function_ex(CG(function_table), NULL, &user_func, &retval, 1, args, 0, NULL) != SUCCESS) {",
          "1212:    BG(serialize_lock)--;",
          "1213:    if (EG(exception)) {",
          "1214:     zend_string_release(class_name);",
          "1215:     zval_ptr_dtor(&user_func);",
          "1216:     zval_ptr_dtor(&args[0]);",
          "1217:     return 0;",
          "1219:    php_error_docref(NULL, E_WARNING, \"defined (%s) but not found\", Z_STRVAL(user_func));",
          "1220:    incomplete_class = 1;",
          "1221:    ce = PHP_IC_ENTRY;",
          "1222:    zval_ptr_dtor(&user_func);",
          "1223:    zval_ptr_dtor(&args[0]);",
          "1224:    break;",
          "1225:   }",
          "1226:   BG(serialize_lock)--;",
          "1227:   zval_ptr_dtor(&retval);",
          "1228:   if (EG(exception)) {",
          "1229:    zend_string_release(class_name);",
          "1230:    zval_ptr_dtor(&user_func);",
          "1231:    zval_ptr_dtor(&args[0]);",
          "1232:    return 0;",
          "1233:   }",
          "1236:   BG(serialize_lock)++;",
          "1237:   if ((ce = zend_lookup_class(class_name)) == NULL) {",
          "1238:    php_error_docref(NULL, E_WARNING, \"Function %s() hasn't defined the class it was called for\", Z_STRVAL(user_func));",
          "1239:    incomplete_class = 1;",
          "1240:    ce = PHP_IC_ENTRY;",
          "1241:   }",
          "1242:   BG(serialize_lock)--;",
          "1244:   zval_ptr_dtor(&user_func);",
          "1245:   zval_ptr_dtor(&args[0]);",
          "1246:   break;",
          "1247:  } while (1);",
          "1251:  if (custom_object) {",
          "1252:   int ret;",
          "1254:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1256:   if (ret && incomplete_class) {",
          "1257:    php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1259:   zend_string_release(class_name);",
          "1260:   return ret;",
          "1261:  }",
          "1263:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1265:  if (elements < 0) {",
          "1266:     zend_string_release(class_name);",
          "1267:     return 0;",
          "1270:  if (incomplete_class) {",
          "1271:   php_store_class_name(rval, ZSTR_VAL(class_name), len2);",
          "1272:  }",
          "1273:  zend_string_release(class_name);",
          "1275:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "1278: yy84:",
          "1280: #line 736 \"ext/standard/var_unserializer.re\"",
          "1282:  size_t len, maxlen;",
          "1283:  zend_string *str;",
          "1285:  len = parse_uiv(start + 2);",
          "1286:  maxlen = max - YYCURSOR;",
          "1287:  if (maxlen < len) {",
          "1289:   return 0;",
          "1290:  }",
          "1292:  if ((str = unserialize_str(&YYCURSOR, len, maxlen)) == NULL) {",
          "1293:   return 0;",
          "1294:  }",
          "1296:  if (*(YYCURSOR) != '\"') {",
          "1297:   zend_string_free(str);",
          "1299:   return 0;",
          "1300:  }",
          "1302:  if (*(YYCURSOR + 1) != ';') {",
          "1303:   efree(str);",
          "1305:   return 0;",
          "1306:  }",
          "1308:  YYCURSOR += 2;",
          "1311:  ZVAL_STR(rval, str);",
          "1314: #line 1315 \"ext/standard/var_unserializer.c\"",
          "1315: yy86:",
          "1317: #line 770 \"ext/standard/var_unserializer.re\"",
          "1319:  zend_long elements = parse_iv(start + 2);",
          "1322:     if (!var_hash) return 0;",
          "1324:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1325:   return 0;",
          "1326:  }",
          "1328:  array_init_size(rval, elements);",
          "1329:  if (elements) {",
          "1332:   zend_hash_real_init(Z_ARRVAL_P(rval), 0);",
          "1333:  }",
          "1335:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_P(rval), elements, 0)) {",
          "1336:   return 0;",
          "1337:  }",
          "1339:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1341: #line 1342 \"ext/standard/var_unserializer.c\"",
          "1342: yy88:",
          "1345:   if (yych == '+') goto yy96;",
          "1346:   goto yy18;",
          "1348:   if (yych <= '-') goto yy96;",
          "1350:   if (yych >= ':') goto yy18;",
          "1352: yy89:",
          "1357:  if (yych <= '9') goto yy89;",
          "1358:  if (yych == ';') goto yy71;",
          "1359:  goto yy18;",
          "1360: yy91:",
          "1361:  yych = *++YYCURSOR;",
          "1362:  if (yych == ';') goto yy97;",
          "1363:  goto yy18;",
          "1364: yy92:",
          "1366: #line 794 \"ext/standard/var_unserializer.re\"",
          "1368:  zend_long elements;",
          "1369:     if (!var_hash) return 0;",
          "1371:  elements = object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR);",
          "1372:  if (elements < 0 || elements >= HT_MAX_SIZE) {",
          "1373:   return 0;",
          "1374:  }",
          "1375:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1376: }",
          "1377: #line 1378 \"ext/standard/var_unserializer.c\"",
          "1378: yy94:",
          "1379:  ++YYCURSOR;",
          "1380: #line 704 \"ext/standard/var_unserializer.re\"",
          "1381:  {",
          "1382:  size_t len, maxlen;",
          "1383:  char *str;",
          "1385:  len = parse_uiv(start + 2);",
          "1386:  maxlen = max - YYCURSOR;",
          "1387:  if (maxlen < len) {",
          "1392:  str = (char*)YYCURSOR;",
          "1394:  YYCURSOR += len;",
          "1396:  if (*(YYCURSOR) != '\"') {",
          "1401:  if (*(YYCURSOR + 1) != ';') {",
          "1403:   return 0;",
          "1406:  YYCURSOR += 2;",
          "1409:  ZVAL_STRINGL(rval, str, len);",
          "1412: #line 1413 \"ext/standard/var_unserializer.c\"",
          "1416:  if (yych <= '9') goto yy89;",
          "1417:  goto yy18;",
          "1420: #line 679 \"ext/standard/var_unserializer.re\"",
          "1424:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1425:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1426:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1427:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1428:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1429:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1431:   ZVAL_NULL(rval);",
          "1436: #line 1437 \"ext/standard/var_unserializer.c\"",
          "1438: #line 965 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1163: #line 1164 \"ext/standard/var_unserializer.c\"",
          "1164: yy65:",
          "1167:   if (yych != '+') goto yy18;",
          "1169:   if (yych <= '-') goto yy66;",
          "1171:   if (yych <= '9') goto yy67;",
          "1174: yy66:",
          "1176:  if (yych <= ',') {",
          "1177:   if (yych == '+') goto yy69;",
          "1178:   goto yy18;",
          "1179:  } else {",
          "1180:   if (yych <= '-') goto yy69;",
          "1181:   if (yych <= '/') goto yy18;",
          "1182:   if (yych >= ':') goto yy18;",
          "1183:  }",
          "1184: yy67:",
          "1185:  ++YYCURSOR;",
          "1186:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1187:  yych = *YYCURSOR;",
          "1188:  if (yych <= '/') goto yy18;",
          "1189:  if (yych <= '9') goto yy67;",
          "1190:  if (yych == ';') goto yy63;",
          "1192: yy69:",
          "1194:  if (yych <= '/') goto yy18;",
          "1195:  if (yych <= '9') goto yy67;",
          "1197: yy70:",
          "1199:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1200:  yych = *YYCURSOR;",
          "1201:  if (yych <= ';') {",
          "1202:   if (yych <= '/') goto yy18;",
          "1203:   if (yych <= '9') goto yy70;",
          "1204:   if (yych <= ':') goto yy18;",
          "1205:   goto yy63;",
          "1206:  } else {",
          "1207:   if (yych <= 'E') {",
          "1208:    if (yych <= 'D') goto yy18;",
          "1209:    goto yy65;",
          "1211:    if (yych == 'e') goto yy65;",
          "1212:    goto yy18;",
          "1215: yy72:",
          "1217:  if (yych != 'F') goto yy18;",
          "1218: yy73:",
          "1219:  yych = *++YYCURSOR;",
          "1220:  if (yych != ';') goto yy18;",
          "1222: #line 678 \"ext/standard/var_unserializer.re\"",
          "1226:  if (!strncmp((char*)start + 2, \"NAN\", 3)) {",
          "1227:   ZVAL_DOUBLE(rval, php_get_nan());",
          "1228:  } else if (!strncmp((char*)start + 2, \"INF\", 3)) {",
          "1229:   ZVAL_DOUBLE(rval, php_get_inf());",
          "1230:  } else if (!strncmp((char*)start + 2, \"-INF\", 4)) {",
          "1231:   ZVAL_DOUBLE(rval, -php_get_inf());",
          "1232:  } else {",
          "1233:   ZVAL_NULL(rval);",
          "1238: #line 1239 \"ext/standard/var_unserializer.c\"",
          "1239: yy76:",
          "1241:  if (yych == 'N') goto yy73;",
          "1243: yy77:",
          "1244:  yych = *++YYCURSOR;",
          "1245:  if (yych <= ',') {",
          "1246:   if (yych != '+') goto yy18;",
          "1247:  } else {",
          "1248:   if (yych <= '-') goto yy78;",
          "1249:   if (yych <= '/') goto yy18;",
          "1250:   if (yych <= '9') goto yy79;",
          "1251:   goto yy18;",
          "1252:  }",
          "1253: yy78:",
          "1254:  yych = *++YYCURSOR;",
          "1255:  if (yych <= '/') goto yy18;",
          "1256:  if (yych >= ':') goto yy18;",
          "1257: yy79:",
          "1259:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1260:  yych = *YYCURSOR;",
          "1261:  if (yych <= '/') goto yy18;",
          "1262:  if (yych <= '9') goto yy79;",
          "1263:  if (yych != ';') goto yy18;",
          "1264:  ++YYCURSOR;",
          "1265: #line 652 \"ext/standard/var_unserializer.re\"",
          "1267: #if SIZEOF_ZEND_LONG == 4",
          "1268:  int digits = YYCURSOR - start - 3;",
          "1270:  if (start[2] == '-' || start[2] == '+') {",
          "1271:   digits--;",
          "1275:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1276:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1277:    int cmp = strncmp((char*)YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1279:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1280:     goto use_double;",
          "1282:   } else {",
          "1283:    goto use_double;",
          "1286: #endif",
          "1288:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1289:  return 1;",
          "1291: #line 1292 \"ext/standard/var_unserializer.c\"",
          "1292: yy83:",
          "1293:  yych = *++YYCURSOR;",
          "1294:  if (yych <= '/') goto yy18;",
          "1295:  if (yych >= '2') goto yy18;",
          "1296:  yych = *++YYCURSOR;",
          "1297:  if (yych != ';') goto yy18;",
          "1299: #line 646 \"ext/standard/var_unserializer.re\"",
          "1302:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1305: #line 1306 \"ext/standard/var_unserializer.c\"",
          "1306: yy87:",
          "1308: #line 640 \"ext/standard/var_unserializer.re\"",
          "1311:  ZVAL_NULL(rval);",
          "1312:  return 1;",
          "1314: #line 1315 \"ext/standard/var_unserializer.c\"",
          "1315: yy89:",
          "1318:   if (yych != '+') goto yy18;",
          "1320:   if (yych <= '-') goto yy90;",
          "1322:   if (yych <= '9') goto yy91;",
          "1323:   goto yy18;",
          "1325: yy90:",
          "1326:  yych = *++YYCURSOR;",
          "1327:  if (yych <= '/') goto yy18;",
          "1328:  if (yych >= ':') goto yy18;",
          "1329: yy91:",
          "1334:  if (yych <= '9') goto yy91;",
          "1335:  if (yych != ';') goto yy18;",
          "1337: #line 615 \"ext/standard/var_unserializer.re\"",
          "1339:  zend_long id;",
          "1342:  if (!var_hash) return 0;",
          "1344:  id = parse_iv(start + 2) - 1;",
          "1345:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1349:  if (rval_ref == rval) {",
          "1353:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1354:   ZVAL_UNDEF(rval);",
          "1355:   return 1;",
          "1358:  ZVAL_COPY(rval, rval_ref);",
          "1362: #line 1363 \"ext/standard/var_unserializer.c\"",
          "1363: yy95:",
          "1364:  yych = *++YYCURSOR;",
          "1365:  if (yych <= ',') {",
          "1366:   if (yych != '+') goto yy18;",
          "1367:  } else {",
          "1368:   if (yych <= '-') goto yy96;",
          "1369:   if (yych <= '/') goto yy18;",
          "1370:   if (yych <= '9') goto yy97;",
          "1371:   goto yy18;",
          "1372:  }",
          "1376:  if (yych >= ':') goto yy18;",
          "1379:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1380:  yych = *YYCURSOR;",
          "1381:  if (yych <= '/') goto yy18;",
          "1382:  if (yych <= '9') goto yy97;",
          "1383:  if (yych != ';') goto yy18;",
          "1384:  ++YYCURSOR;",
          "1385: #line 589 \"ext/standard/var_unserializer.re\"",
          "1387:  zend_long id;",
          "1390:  if (!var_hash) return 0;",
          "1392:  id = parse_iv(start + 2) - 1;",
          "1393:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1394:   return 0;",
          "1395:  }",
          "1397:  zval_ptr_dtor(rval);",
          "1398:  if (Z_ISUNDEF_P(rval_ref) || (Z_ISREF_P(rval_ref) && Z_ISUNDEF_P(Z_REFVAL_P(rval_ref)))) {",
          "1399:   ZVAL_UNDEF(rval);",
          "1400:   return 1;",
          "1401:  }",
          "1402:  if (Z_ISREF_P(rval_ref)) {",
          "1403:   ZVAL_COPY(rval, rval_ref);",
          "1405:   ZVAL_NEW_REF(rval_ref, rval_ref);",
          "1406:   ZVAL_COPY(rval, rval_ref);",
          "1411: #line 1412 \"ext/standard/var_unserializer.c\"",
          "1413: #line 964 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "433: static inline int finish_nested_data(UNSERIALIZE_PARAMETER)",
          "434: {",
          "442: }",
          "444: static inline int object_custom(UNSERIALIZE_PARAMETER, zend_class_entry *ce)",
          "",
          "[Removed Lines]",
          "435:  if (*((*p)++) == '}')",
          "436:   return 1;",
          "438: #if SOMETHING_NEW_MIGHT_LEAD_TO_CRASH_ENABLE_IF_YOU_ARE_BRAVE",
          "439:  zval_ptr_dtor(rval);",
          "440: #endif",
          "441:  return 0;",
          "",
          "[Added Lines]",
          "435:  if (*p >= max || **p != '}') {",
          "436:   return 0;",
          "437:  }",
          "439:  (*p)++;",
          "440:  return 1;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "a65ad951ad95944e357703caa2001f06a4225bf6",
      "candidate_info": {
        "commit_hash": "a65ad951ad95944e357703caa2001f06a4225bf6",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/a65ad951ad95944e357703caa2001f06a4225bf6",
        "files": [
          "NEWS",
          "ext/standard/tests/serialize/bug70213.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "FIx bug #70213",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug70213.phpt||ext/standard/tests/serialize/bug70213.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug70213.phpt||ext/standard/tests/serialize/bug70213.phpt": [
          "File: ext/standard/tests/serialize/bug70213.phpt -> ext/standard/tests/serialize/bug70213.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #70213: Unserialize context shared on double class lookup",
          "3: --FILE--",
          "4: <?php",
          "6: ini_set('unserialize_callback_func', 'evil');",
          "8: function evil() {",
          "9:  function __autoload($arg) {",
          "10:         var_dump(unserialize('R:1;'));",
          "11:     }",
          "12: }",
          "14: var_dump(unserialize('a:2:{i:0;i:42;i:1;O:4:\"evil\":0:{}}'));",
          "16: ?>",
          "17: --EXPECTF--",
          "18: Notice: unserialize(): Error at offset 4 of 4 bytes in %s on line %d",
          "19: bool(false)",
          "21: Warning: unserialize(): Function evil() hasn't defined the class it was called for in %s on line %d",
          "22: array(2) {",
          "23:   [0]=>",
          "24:   int(42)",
          "25:   [1]=>",
          "26:   object(__PHP_Incomplete_Class)#1 (1) {",
          "27:     [\"__PHP_Incomplete_Class_Name\"]=>",
          "28:     string(4) \"evil\"",
          "29:   }",
          "30: }",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "529:     0,   0,   0,   0,   0,   0,   0,   0,",
          "530:     0,   0,   0,   0,   0,   0,   0,   0,",
          "531:  };",
          "533:  if ((YYLIMIT - YYCURSOR) < 7) YYFILL(7);",
          "534:  yych = *YYCURSOR;",
          "535:  switch (yych) {",
          "536:  case 'C':",
          "538:  case 'N': goto yy5;",
          "545:  case 'o': goto yy12;",
          "550:  }",
          "551: yy2:",
          "554: yy3:",
          "556:  { return 0; }",
          "558: yy4:",
          "559:  yych = *(YYMARKER = ++YYCURSOR);",
          "561:  goto yy3;",
          "562: yy5:",
          "563:  yych = *++YYCURSOR;",
          "565:  goto yy3;",
          "566: yy6:",
          "567:  yych = *(YYMARKER = ++YYCURSOR);",
          "569:  goto yy3;",
          "570: yy7:",
          "571:  yych = *(YYMARKER = ++YYCURSOR);",
          "573:  goto yy3;",
          "574: yy8:",
          "575:  yych = *(YYMARKER = ++YYCURSOR);",
          "577:  goto yy3;",
          "578: yy9:",
          "579:  yych = *(YYMARKER = ++YYCURSOR);",
          "581:  goto yy3;",
          "582: yy10:",
          "583:  yych = *(YYMARKER = ++YYCURSOR);",
          "585:  goto yy3;",
          "586: yy11:",
          "587:  yych = *(YYMARKER = ++YYCURSOR);",
          "589:  goto yy3;",
          "590: yy12:",
          "591:  yych = *(YYMARKER = ++YYCURSOR);",
          "593:  goto yy3;",
          "594: yy13:",
          "595:  yych = *(YYMARKER = ++YYCURSOR);",
          "597:  goto yy3;",
          "598: yy14:",
          "599:  ++YYCURSOR;",
          "601:  {",
          "603:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "605: }",
          "610: yy17:",
          "611:  yych = *++YYCURSOR;",
          "612:  if (yybm[0+yych] & 128) {",
          "614:  }",
          "616: yy18:",
          "617:  YYCURSOR = YYMARKER;",
          "618:  goto yy3;",
          "619: yy19:",
          "620:  yych = *++YYCURSOR;",
          "623:  }",
          "624:  goto yy18;",
          "632:  if (yych <= '/') goto yy18;",
          "634:  yych = *++YYCURSOR;",
          "750:   } else {",
          "754:   }",
          "770:   }",
          "773:  }",
          "779:  }",
          "786:  yych = *++YYCURSOR;",
          "787:  if (yych <= ',') {",
          "789:  } else {",
          "791:   if (yych <= '/') goto yy18;",
          "793:   goto yy18;",
          "794:  }",
          "796:  yych = *++YYCURSOR;",
          "797:  if (yych <= '/') goto yy18;",
          "800:  ++YYCURSOR;",
          "801:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "802:  yych = *YYCURSOR;",
          "803:  if (yych <= '/') goto yy18;",
          "806:  yych = *++YYCURSOR;",
          "808:  ++YYCURSOR;",
          "822:  if (yych <= '/') goto yy18;",
          "823:  if (yych <= '9') goto yy34;",
          "824:  goto yy18;",
          "826:  yych = *++YYCURSOR;",
          "827:  if (yych <= '/') goto yy18;",
          "828:  if (yych >= ':') goto yy18;",
          "830:  ++YYCURSOR;",
          "831:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "832:  yych = *YYCURSOR;",
          "833:  if (yych <= '/') goto yy18;",
          "836:  yych = *++YYCURSOR;",
          "838:  ++YYCURSOR;",
          "856:  }",
          "862:  yych = *++YYCURSOR;",
          "864:  if (yych <= '/') goto yy18;",
          "866:  goto yy18;",
          "868:  yych = *++YYCURSOR;",
          "869:  if (yych <= '/') goto yy18;",
          "870:  if (yych >= ':') goto yy18;",
          "872:  ++YYCURSOR;",
          "874:  yych = *YYCURSOR;",
          "875:  if (yych <= '/') goto yy18;",
          "878:  yych = *++YYCURSOR;",
          "880:  ++YYCURSOR;",
          "918:  yych = *++YYCURSOR;",
          "920:  if (yych <= '/') goto yy18;",
          "922:  goto yy18;",
          "924:  yych = *++YYCURSOR;",
          "925:  if (yych <= '/') goto yy18;",
          "926:  if (yych >= ':') goto yy18;",
          "928:  ++YYCURSOR;",
          "929:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "930:  yych = *YYCURSOR;",
          "931:  if (yych <= '/') goto yy18;",
          "934:  yych = *++YYCURSOR;",
          "936:  ++YYCURSOR;",
          "938:  {",
          "955:   return 0;",
          "956:  }",
          "961:  }",
          "968:  return 1;",
          "969: }",
          "991:  yych = *++YYCURSOR;",
          "993:  goto yy18;",
          "1004:  yych = *++YYCURSOR;",
          "1006:  goto yy18;",
          "1013:  ++YYCURSOR;",
          "1040:  ++YYCURSOR;",
          "1041:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1042:  yych = *YYCURSOR;",
          "1043:  if (yych <= ';') {",
          "1044:   if (yych <= '/') goto yy18;",
          "1046:   if (yych <= ':') goto yy18;",
          "1047:  } else {",
          "1048:   if (yych <= 'E') {",
          "1049:    if (yych <= 'D') goto yy18;",
          "1051:   } else {",
          "1053:    goto yy18;",
          "1054:   }",
          "1055:  }",
          "1057:  ++YYCURSOR;",
          "1058: #line 600 \"ext/standard/var_unserializer.re\"",
          "1059:  {",
          "",
          "[Removed Lines]",
          "537:  case 'O': goto yy13;",
          "539:  case 'R': goto yy2;",
          "540:  case 'S': goto yy10;",
          "541:  case 'a': goto yy11;",
          "542:  case 'b': goto yy6;",
          "543:  case 'd': goto yy8;",
          "544:  case 'i': goto yy7;",
          "546:  case 'r': goto yy4;",
          "547:  case 's': goto yy9;",
          "548:  case '}': goto yy14;",
          "549:  default: goto yy16;",
          "552:  yych = *(YYMARKER = ++YYCURSOR);",
          "553:  if (yych == ':') goto yy95;",
          "555: #line 861 \"ext/standard/var_unserializer.re\"",
          "557: #line 558 \"ext/standard/var_unserializer.c\"",
          "560:  if (yych == ':') goto yy89;",
          "564:  if (yych == ';') goto yy87;",
          "568:  if (yych == ':') goto yy83;",
          "572:  if (yych == ':') goto yy77;",
          "576:  if (yych == ':') goto yy53;",
          "580:  if (yych == ':') goto yy46;",
          "584:  if (yych == ':') goto yy39;",
          "588:  if (yych == ':') goto yy32;",
          "592:  if (yych == ':') goto yy25;",
          "596:  if (yych == ':') goto yy17;",
          "600: #line 855 \"ext/standard/var_unserializer.re\"",
          "606: #line 607 \"ext/standard/var_unserializer.c\"",
          "607: yy16:",
          "608:  yych = *++YYCURSOR;",
          "609:  goto yy3;",
          "613:   goto yy20;",
          "615:  if (yych == '+') goto yy19;",
          "621:  if (yybm[0+yych] & 128) {",
          "622:   goto yy20;",
          "625: yy20:",
          "626:  ++YYCURSOR;",
          "627:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "628:  yych = *YYCURSOR;",
          "629:  if (yybm[0+yych] & 128) {",
          "630:   goto yy20;",
          "631:  }",
          "633:  if (yych >= ';') goto yy18;",
          "635:  if (yych != '\"') goto yy18;",
          "636:  ++YYCURSOR;",
          "637: #line 708 \"ext/standard/var_unserializer.re\"",
          "638:  {",
          "639:  size_t len, len2, len3, maxlen;",
          "640:  long elements;",
          "641:  char *class_name;",
          "642:  zend_class_entry *ce;",
          "643:  zend_class_entry **pce;",
          "644:  int incomplete_class = 0;",
          "646:  int custom_object = 0;",
          "648:  zval *user_func;",
          "649:  zval *retval_ptr;",
          "650:  zval **args[1];",
          "651:  zval *arg_func_name;",
          "653:     if (!var_hash) return 0;",
          "654:  if (*start == 'C') {",
          "655:   custom_object = 1;",
          "656:  }",
          "658:  INIT_PZVAL(*rval);",
          "659:  len2 = len = parse_uiv(start + 2);",
          "660:  maxlen = max - YYCURSOR;",
          "661:  if (maxlen < len || len == 0) {",
          "663:   return 0;",
          "664:  }",
          "666:  class_name = (char*)YYCURSOR;",
          "668:  YYCURSOR += len;",
          "670:  if (*(YYCURSOR) != '\"') {",
          "672:   return 0;",
          "673:  }",
          "674:  if (*(YYCURSOR+1) != ':') {",
          "676:   return 0;",
          "677:  }",
          "679:  len3 = strspn(class_name, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "680:  if (len3 != len)",
          "681:  {",
          "683:   return 0;",
          "684:  }",
          "686:  class_name = estrndup(class_name, len);",
          "688:  do {",
          "690:   BG(serialize_lock)++;",
          "691:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "692:    BG(serialize_lock)--;",
          "693:    if (EG(exception)) {",
          "694:     efree(class_name);",
          "695:     return 0;",
          "696:    }",
          "697:    ce = *pce;",
          "698:    break;",
          "699:   }",
          "700:   BG(serialize_lock)--;",
          "702:   if (EG(exception)) {",
          "703:    efree(class_name);",
          "704:    return 0;",
          "705:   }",
          "708:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "709:    incomplete_class = 1;",
          "710:    ce = PHP_IC_ENTRY;",
          "711:    break;",
          "712:   }",
          "715:   MAKE_STD_ZVAL(user_func);",
          "716:   ZVAL_STRING(user_func, PG(unserialize_callback_func), 1);",
          "717:   args[0] = &arg_func_name;",
          "718:   MAKE_STD_ZVAL(arg_func_name);",
          "719:   ZVAL_STRING(arg_func_name, class_name, 1);",
          "720:   BG(serialize_lock)++;",
          "721:   if (call_user_function_ex(CG(function_table), NULL, user_func, &retval_ptr, 1, args, 0, NULL TSRMLS_CC) != SUCCESS) {",
          "722:    BG(serialize_lock)--;",
          "723:    if (EG(exception)) {",
          "724:     efree(class_name);",
          "725:     zval_ptr_dtor(&user_func);",
          "726:     zval_ptr_dtor(&arg_func_name);",
          "727:     return 0;",
          "728:    }",
          "729:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"defined (%s) but not found\", user_func->value.str.val);",
          "730:    incomplete_class = 1;",
          "731:    ce = PHP_IC_ENTRY;",
          "732:    zval_ptr_dtor(&user_func);",
          "733:    zval_ptr_dtor(&arg_func_name);",
          "734:    break;",
          "735:   }",
          "736:   BG(serialize_lock)--;",
          "737:   if (retval_ptr) {",
          "738:    zval_ptr_dtor(&retval_ptr);",
          "739:   }",
          "740:   if (EG(exception)) {",
          "741:    efree(class_name);",
          "742:    zval_ptr_dtor(&user_func);",
          "743:    zval_ptr_dtor(&arg_func_name);",
          "744:    return 0;",
          "745:   }",
          "748:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "749:    ce = *pce;",
          "751:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Function %s() hasn't defined the class it was called for\", user_func->value.str.val);",
          "752:    incomplete_class = 1;",
          "753:    ce = PHP_IC_ENTRY;",
          "756:   zval_ptr_dtor(&user_func);",
          "757:   zval_ptr_dtor(&arg_func_name);",
          "758:   break;",
          "759:  } while (1);",
          "763:  if (custom_object) {",
          "764:   int ret;",
          "766:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "768:   if (ret && incomplete_class) {",
          "769:    php_store_class_name(*rval, class_name, len2);",
          "771:   efree(class_name);",
          "772:   return ret;",
          "775:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "777:  if (incomplete_class) {",
          "778:   php_store_class_name(*rval, class_name, len2);",
          "780:  efree(class_name);",
          "782:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "783: }",
          "784: #line 785 \"ext/standard/var_unserializer.c\"",
          "785: yy25:",
          "788:   if (yych != '+') goto yy18;",
          "790:   if (yych <= '-') goto yy26;",
          "792:   if (yych <= '9') goto yy27;",
          "795: yy26:",
          "798:  if (yych >= ':') goto yy18;",
          "799: yy27:",
          "804:  if (yych <= '9') goto yy27;",
          "805:  if (yych >= ';') goto yy18;",
          "807:  if (yych != '\"') goto yy18;",
          "809: #line 699 \"ext/standard/var_unserializer.re\"",
          "810:  {",
          "811:     if (!var_hash) return 0;",
          "813:  INIT_PZVAL(*rval);",
          "815:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "816:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "817: }",
          "818: #line 819 \"ext/standard/var_unserializer.c\"",
          "819: yy32:",
          "820:  yych = *++YYCURSOR;",
          "821:  if (yych == '+') goto yy33;",
          "825: yy33:",
          "829: yy34:",
          "834:  if (yych <= '9') goto yy34;",
          "835:  if (yych >= ';') goto yy18;",
          "837:  if (yych != '{') goto yy18;",
          "839: #line 678 \"ext/standard/var_unserializer.re\"",
          "840:  {",
          "841:  long elements = parse_iv(start + 2);",
          "844:     if (!var_hash) return 0;",
          "846:  if (elements < 0) {",
          "847:   return 0;",
          "848:  }",
          "850:  INIT_PZVAL(*rval);",
          "852:  array_init_size(*rval, elements);",
          "854:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_PP(rval), elements, 0)) {",
          "855:   return 0;",
          "858:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "859: }",
          "860: #line 861 \"ext/standard/var_unserializer.c\"",
          "861: yy39:",
          "863:  if (yych == '+') goto yy40;",
          "865:  if (yych <= '9') goto yy41;",
          "867: yy40:",
          "871: yy41:",
          "873:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "876:  if (yych <= '9') goto yy41;",
          "877:  if (yych >= ';') goto yy18;",
          "879:  if (yych != '\"') goto yy18;",
          "881: #line 643 \"ext/standard/var_unserializer.re\"",
          "882:  {",
          "883:  size_t len, maxlen;",
          "884:  char *str;",
          "886:  len = parse_uiv(start + 2);",
          "887:  maxlen = max - YYCURSOR;",
          "888:  if (maxlen < len) {",
          "890:   return 0;",
          "891:  }",
          "893:  if ((str = unserialize_str(&YYCURSOR, &len, maxlen)) == NULL) {",
          "894:   return 0;",
          "895:  }",
          "897:  if (*(YYCURSOR) != '\"') {",
          "898:   efree(str);",
          "900:   return 0;",
          "901:  }",
          "903:  if (*(YYCURSOR + 1) != ';') {",
          "904:   efree(str);",
          "906:   return 0;",
          "907:  }",
          "909:  YYCURSOR += 2;",
          "912:  INIT_PZVAL(*rval);",
          "913:  ZVAL_STRINGL(*rval, str, len, 0);",
          "914:  return 1;",
          "915: }",
          "916: #line 917 \"ext/standard/var_unserializer.c\"",
          "917: yy46:",
          "919:  if (yych == '+') goto yy47;",
          "921:  if (yych <= '9') goto yy48;",
          "923: yy47:",
          "927: yy48:",
          "932:  if (yych <= '9') goto yy48;",
          "933:  if (yych >= ';') goto yy18;",
          "935:  if (yych != '\"') goto yy18;",
          "937: #line 610 \"ext/standard/var_unserializer.re\"",
          "939:  size_t len, maxlen;",
          "940:  char *str;",
          "942:  len = parse_uiv(start + 2);",
          "943:  maxlen = max - YYCURSOR;",
          "944:  if (maxlen < len) {",
          "946:   return 0;",
          "947:  }",
          "949:  str = (char*)YYCURSOR;",
          "951:  YYCURSOR += len;",
          "953:  if (*(YYCURSOR) != '\"') {",
          "958:  if (*(YYCURSOR + 1) != ';') {",
          "960:   return 0;",
          "963:  YYCURSOR += 2;",
          "966:  INIT_PZVAL(*rval);",
          "967:  ZVAL_STRINGL(*rval, str, len, 1);",
          "970: #line 971 \"ext/standard/var_unserializer.c\"",
          "971: yy53:",
          "972:  yych = *++YYCURSOR;",
          "973:  if (yych <= '/') {",
          "974:   if (yych <= ',') {",
          "975:    if (yych == '+') goto yy57;",
          "976:    goto yy18;",
          "977:   } else {",
          "978:    if (yych <= '-') goto yy55;",
          "979:    if (yych <= '.') goto yy60;",
          "980:    goto yy18;",
          "981:   }",
          "982:  } else {",
          "983:   if (yych <= 'I') {",
          "984:    if (yych <= '9') goto yy58;",
          "985:    if (yych <= 'H') goto yy18;",
          "986:    goto yy56;",
          "987:   } else {",
          "988:    if (yych != 'N') goto yy18;",
          "989:   }",
          "990:  }",
          "992:  if (yych == 'A') goto yy76;",
          "994: yy55:",
          "995:  yych = *++YYCURSOR;",
          "996:  if (yych <= '/') {",
          "997:   if (yych == '.') goto yy60;",
          "998:   goto yy18;",
          "999:  } else {",
          "1000:   if (yych <= '9') goto yy58;",
          "1001:   if (yych != 'I') goto yy18;",
          "1002:  }",
          "1003: yy56:",
          "1005:  if (yych == 'N') goto yy72;",
          "1007: yy57:",
          "1008:  yych = *++YYCURSOR;",
          "1009:  if (yych == '.') goto yy60;",
          "1010:  if (yych <= '/') goto yy18;",
          "1011:  if (yych >= ':') goto yy18;",
          "1012: yy58:",
          "1014:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1015:  yych = *YYCURSOR;",
          "1016:  if (yych <= ':') {",
          "1017:   if (yych <= '.') {",
          "1018:    if (yych <= '-') goto yy18;",
          "1019:    goto yy70;",
          "1020:   } else {",
          "1021:    if (yych <= '/') goto yy18;",
          "1022:    if (yych <= '9') goto yy58;",
          "1023:    goto yy18;",
          "1024:   }",
          "1025:  } else {",
          "1026:   if (yych <= 'E') {",
          "1027:    if (yych <= ';') goto yy63;",
          "1028:    if (yych <= 'D') goto yy18;",
          "1029:    goto yy65;",
          "1030:   } else {",
          "1031:    if (yych == 'e') goto yy65;",
          "1032:    goto yy18;",
          "1033:   }",
          "1034:  }",
          "1035: yy60:",
          "1036:  yych = *++YYCURSOR;",
          "1037:  if (yych <= '/') goto yy18;",
          "1038:  if (yych >= ':') goto yy18;",
          "1039: yy61:",
          "1045:   if (yych <= '9') goto yy61;",
          "1050:    goto yy65;",
          "1052:    if (yych == 'e') goto yy65;",
          "1056: yy63:",
          "",
          "[Added Lines]",
          "536:  case 'O': goto yy4;",
          "538:  case 'R': goto yy6;",
          "539:  case 'S': goto yy7;",
          "540:  case 'a': goto yy8;",
          "541:  case 'b': goto yy9;",
          "542:  case 'd': goto yy10;",
          "543:  case 'i': goto yy11;",
          "545:  case 'r': goto yy13;",
          "546:  case 's': goto yy14;",
          "547:  case '}': goto yy15;",
          "548:  default: goto yy2;",
          "551:  ++YYCURSOR;",
          "553: #line 863 \"ext/standard/var_unserializer.re\"",
          "555: #line 556 \"ext/standard/var_unserializer.c\"",
          "558:  if (yych == ':') goto yy17;",
          "562:  if (yych == ';') goto yy19;",
          "566:  if (yych == ':') goto yy21;",
          "570:  if (yych == ':') goto yy22;",
          "574:  if (yych == ':') goto yy23;",
          "578:  if (yych == ':') goto yy24;",
          "582:  if (yych == ':') goto yy25;",
          "586:  if (yych == ':') goto yy26;",
          "590:  if (yych == ':') goto yy27;",
          "594:  if (yych == ':') goto yy28;",
          "597:  yych = *(YYMARKER = ++YYCURSOR);",
          "598:  if (yych == ':') goto yy29;",
          "599:  goto yy3;",
          "600: yy15:",
          "602: #line 857 \"ext/standard/var_unserializer.re\"",
          "608: #line 609 \"ext/standard/var_unserializer.c\"",
          "612:   goto yy31;",
          "614:  if (yych == '+') goto yy30;",
          "619:  ++YYCURSOR;",
          "620: #line 544 \"ext/standard/var_unserializer.re\"",
          "621:  {",
          "623:  INIT_PZVAL(*rval);",
          "624:  ZVAL_NULL(*rval);",
          "625:  return 1;",
          "626: }",
          "627: #line 628 \"ext/standard/var_unserializer.c\"",
          "628: yy21:",
          "630:  if (yych <= ',') {",
          "631:   if (yych == '+') goto yy33;",
          "632:   goto yy18;",
          "633:  } else {",
          "634:   if (yych <= '-') goto yy33;",
          "635:   if (yych <= '/') goto yy18;",
          "636:   if (yych <= '9') goto yy34;",
          "637:   goto yy18;",
          "639: yy22:",
          "640:  yych = *++YYCURSOR;",
          "641:  if (yych == '+') goto yy36;",
          "642:  if (yych <= '/') goto yy18;",
          "643:  if (yych <= '9') goto yy37;",
          "645: yy23:",
          "646:  yych = *++YYCURSOR;",
          "647:  if (yych == '+') goto yy39;",
          "649:  if (yych <= '9') goto yy40;",
          "650:  goto yy18;",
          "651: yy24:",
          "653:  if (yych <= '/') goto yy18;",
          "654:  if (yych <= '1') goto yy42;",
          "655:  goto yy18;",
          "656: yy25:",
          "657:  yych = *++YYCURSOR;",
          "658:  if (yych <= '/') {",
          "659:   if (yych <= ',') {",
          "660:    if (yych == '+') goto yy43;",
          "661:    goto yy18;",
          "663:    if (yych <= '-') goto yy44;",
          "664:    if (yych <= '.') goto yy45;",
          "665:    goto yy18;",
          "667:  } else {",
          "668:   if (yych <= 'I') {",
          "669:    if (yych <= '9') goto yy46;",
          "670:    if (yych <= 'H') goto yy18;",
          "671:    goto yy48;",
          "672:   } else {",
          "673:    if (yych == 'N') goto yy49;",
          "674:    goto yy18;",
          "677: yy26:",
          "678:  yych = *++YYCURSOR;",
          "679:  if (yych <= ',') {",
          "680:   if (yych == '+') goto yy50;",
          "681:   goto yy18;",
          "682:  } else {",
          "683:   if (yych <= '-') goto yy50;",
          "684:   if (yych <= '/') goto yy18;",
          "685:   if (yych <= '9') goto yy51;",
          "686:   goto yy18;",
          "688: yy27:",
          "691:   if (yych == '+') goto yy53;",
          "692:   goto yy18;",
          "694:   if (yych <= '-') goto yy53;",
          "696:   if (yych <= '9') goto yy54;",
          "699: yy28:",
          "700:  yych = *++YYCURSOR;",
          "701:  if (yych <= ',') {",
          "702:   if (yych == '+') goto yy56;",
          "703:   goto yy18;",
          "704:  } else {",
          "705:   if (yych <= '-') goto yy56;",
          "706:   if (yych <= '/') goto yy18;",
          "707:   if (yych <= '9') goto yy57;",
          "708:   goto yy18;",
          "709:  }",
          "710: yy29:",
          "712:  if (yych == '+') goto yy59;",
          "714:  if (yych <= '9') goto yy60;",
          "715:  goto yy18;",
          "716: yy30:",
          "717:  yych = *++YYCURSOR;",
          "718:  if (yybm[0+yych] & 128) {",
          "719:   goto yy31;",
          "720:  }",
          "721:  goto yy18;",
          "722: yy31:",
          "726:  if (yybm[0+yych] & 128) {",
          "727:   goto yy31;",
          "728:  }",
          "730:  if (yych <= ':') goto yy62;",
          "731:  goto yy18;",
          "732: yy33:",
          "734:  if (yych <= '/') goto yy18;",
          "735:  if (yych >= ':') goto yy18;",
          "736: yy34:",
          "738:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "739:  yych = *YYCURSOR;",
          "742:  if (yych == ';') goto yy63;",
          "744: yy36:",
          "748: yy37:",
          "753:  if (yych <= '9') goto yy37;",
          "754:  if (yych <= ':') goto yy65;",
          "755:  goto yy18;",
          "756: yy39:",
          "758:  if (yych <= '/') goto yy18;",
          "759:  if (yych >= ':') goto yy18;",
          "760: yy40:",
          "762:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "763:  yych = *YYCURSOR;",
          "764:  if (yych <= '/') goto yy18;",
          "765:  if (yych <= '9') goto yy40;",
          "766:  if (yych <= ':') goto yy66;",
          "767:  goto yy18;",
          "768: yy42:",
          "769:  yych = *++YYCURSOR;",
          "770:  if (yych == ';') goto yy67;",
          "771:  goto yy18;",
          "772: yy43:",
          "773:  yych = *++YYCURSOR;",
          "774:  if (yych == '.') goto yy45;",
          "775:  if (yych <= '/') goto yy18;",
          "776:  if (yych <= '9') goto yy46;",
          "777:  goto yy18;",
          "778: yy44:",
          "779:  yych = *++YYCURSOR;",
          "780:  if (yych <= '/') {",
          "781:   if (yych != '.') goto yy18;",
          "782:  } else {",
          "783:   if (yych <= '9') goto yy46;",
          "784:   if (yych == 'I') goto yy48;",
          "785:   goto yy18;",
          "787: yy45:",
          "790:  if (yych <= '9') goto yy69;",
          "792: yy46:",
          "793:  ++YYCURSOR;",
          "794:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "795:  yych = *YYCURSOR;",
          "796:  if (yych <= ':') {",
          "797:   if (yych <= '.') {",
          "798:    if (yych <= '-') goto yy18;",
          "799:    goto yy69;",
          "800:   } else {",
          "801:    if (yych <= '/') goto yy18;",
          "802:    if (yych <= '9') goto yy46;",
          "803:    goto yy18;",
          "804:   }",
          "805:  } else {",
          "806:   if (yych <= 'E') {",
          "807:    if (yych <= ';') goto yy71;",
          "808:    if (yych <= 'D') goto yy18;",
          "809:    goto yy73;",
          "810:   } else {",
          "811:    if (yych == 'e') goto yy73;",
          "812:    goto yy18;",
          "813:   }",
          "814:  }",
          "815: yy48:",
          "816:  yych = *++YYCURSOR;",
          "817:  if (yych == 'N') goto yy74;",
          "818:  goto yy18;",
          "819: yy49:",
          "820:  yych = *++YYCURSOR;",
          "821:  if (yych == 'A') goto yy75;",
          "822:  goto yy18;",
          "823: yy50:",
          "827: yy51:",
          "829:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "832:  if (yych <= '9') goto yy51;",
          "833:  if (yych == ';') goto yy76;",
          "834:  goto yy18;",
          "835: yy53:",
          "837:  if (yych <= '/') goto yy18;",
          "838:  if (yych >= ':') goto yy18;",
          "839: yy54:",
          "841:  if ((YYLIMIT - YYCURSOR) < 2) YYFILL(2);",
          "842:  yych = *YYCURSOR;",
          "843:  if (yych <= '/') goto yy18;",
          "844:  if (yych <= '9') goto yy54;",
          "845:  if (yych <= ':') goto yy78;",
          "846:  goto yy18;",
          "847: yy56:",
          "850:  if (yych >= ':') goto yy18;",
          "851: yy57:",
          "852:  ++YYCURSOR;",
          "853:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "854:  yych = *YYCURSOR;",
          "855:  if (yych <= '/') goto yy18;",
          "856:  if (yych <= '9') goto yy57;",
          "857:  if (yych == ';') goto yy79;",
          "859: yy59:",
          "863: yy60:",
          "868:  if (yych <= '9') goto yy60;",
          "869:  if (yych <= ':') goto yy81;",
          "870:  goto yy18;",
          "871: yy62:",
          "873:  if (yych == '\"') goto yy82;",
          "874:  goto yy18;",
          "875: yy63:",
          "877: #line 500 \"ext/standard/var_unserializer.re\"",
          "879:  long id;",
          "882:  if (!var_hash) return 0;",
          "884:  id = parse_iv(start + 2) - 1;",
          "885:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "889:  if (*rval != NULL) {",
          "890:   var_push_dtor_no_addref(var_hash, rval);",
          "893:  Z_ADDREF_PP(rval);",
          "894:  Z_SET_ISREF_PP(rval);",
          "898: #line 899 \"ext/standard/var_unserializer.c\"",
          "899: yy65:",
          "901:  if (yych == '\"') goto yy84;",
          "903: yy66:",
          "905:  if (yych == '{') goto yy86;",
          "907: yy67:",
          "909: #line 551 \"ext/standard/var_unserializer.re\"",
          "910:  {",
          "912:  INIT_PZVAL(*rval);",
          "913:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "914:  return 1;",
          "915: }",
          "916: #line 917 \"ext/standard/var_unserializer.c\"",
          "917: yy69:",
          "923:   if (yych <= '9') goto yy69;",
          "928:    goto yy73;",
          "930:    if (yych == 'e') goto yy73;",
          "934: yy71:",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1065:  ZVAL_DOUBLE(*rval, zend_strtod((const char *)start + 2, NULL));",
          "1066:  return 1;",
          "1067: }",
          "1070:  yych = *++YYCURSOR;",
          "1071:  if (yych <= ',') {",
          "1073:  } else {",
          "1075:   if (yych <= '/') goto yy18;",
          "1077:   goto yy18;",
          "1078:  }",
          "1080:  yych = *++YYCURSOR;",
          "1096:  goto yy18;",
          "1098:  yych = *++YYCURSOR;",
          "1101:  goto yy18;",
          "1103:  ++YYCURSOR;",
          "1115:   } else {",
          "1118:   }",
          "1119:  }",
          "1124:  yych = *++YYCURSOR;",
          "1126:  ++YYCURSOR;",
          "1128:  {",
          "1138:  }",
          "1140:  return 1;",
          "1141: }",
          "1144:  yych = *++YYCURSOR;",
          "1146:  goto yy18;",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1176:  }",
          "1185:    }",
          "1186:   } else {",
          "1188:   }",
          "1195: }",
          "1203:  ++YYCURSOR;",
          "1205:  {",
          "1207:  INIT_PZVAL(*rval);",
          "1209:  return 1;",
          "1210: }",
          "1213:  ++YYCURSOR;",
          "1215:  {",
          "1217:  INIT_PZVAL(*rval);",
          "1220: }",
          "1223:  yych = *++YYCURSOR;",
          "1224:  if (yych <= ',') {",
          "1226:  } else {",
          "1228:   if (yych <= '/') goto yy18;",
          "1231:  }",
          "1237:  ++YYCURSOR;",
          "1238:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1239:  yych = *YYCURSOR;",
          "1240:  if (yych <= '/') goto yy18;",
          "1243:  ++YYCURSOR;",
          "1245:  {",
          "1253:   return 0;",
          "1254:  }",
          "1260:  }",
          "1265:  return 1;",
          "1266: }",
          "1278: yy96:",
          "1279:  yych = *++YYCURSOR;",
          "1280:  if (yych <= '/') goto yy18;",
          "1282: yy97:",
          "1283:  ++YYCURSOR;",
          "1291:  {",
          "1304:  }",
          "1309:  return 1;",
          "1310: }",
          "1312: }",
          "1316:  return 0;",
          "",
          "[Removed Lines]",
          "1068: #line 1069 \"ext/standard/var_unserializer.c\"",
          "1069: yy65:",
          "1072:   if (yych != '+') goto yy18;",
          "1074:   if (yych <= '-') goto yy66;",
          "1076:   if (yych <= '9') goto yy67;",
          "1079: yy66:",
          "1081:  if (yych <= ',') {",
          "1082:   if (yych == '+') goto yy69;",
          "1083:   goto yy18;",
          "1084:  } else {",
          "1085:   if (yych <= '-') goto yy69;",
          "1086:   if (yych <= '/') goto yy18;",
          "1087:   if (yych >= ':') goto yy18;",
          "1088:  }",
          "1089: yy67:",
          "1090:  ++YYCURSOR;",
          "1091:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1092:  yych = *YYCURSOR;",
          "1093:  if (yych <= '/') goto yy18;",
          "1094:  if (yych <= '9') goto yy67;",
          "1095:  if (yych == ';') goto yy63;",
          "1097: yy69:",
          "1099:  if (yych <= '/') goto yy18;",
          "1100:  if (yych <= '9') goto yy67;",
          "1102: yy70:",
          "1104:  if ((YYLIMIT - YYCURSOR) < 4) YYFILL(4);",
          "1105:  yych = *YYCURSOR;",
          "1106:  if (yych <= ';') {",
          "1107:   if (yych <= '/') goto yy18;",
          "1108:   if (yych <= '9') goto yy70;",
          "1109:   if (yych <= ':') goto yy18;",
          "1110:   goto yy63;",
          "1111:  } else {",
          "1112:   if (yych <= 'E') {",
          "1113:    if (yych <= 'D') goto yy18;",
          "1114:    goto yy65;",
          "1116:    if (yych == 'e') goto yy65;",
          "1117:    goto yy18;",
          "1120: yy72:",
          "1121:  yych = *++YYCURSOR;",
          "1122:  if (yych != 'F') goto yy18;",
          "1123: yy73:",
          "1125:  if (yych != ';') goto yy18;",
          "1127: #line 585 \"ext/standard/var_unserializer.re\"",
          "1130:  INIT_PZVAL(*rval);",
          "1132:  if (!strncmp(start + 2, \"NAN\", 3)) {",
          "1133:   ZVAL_DOUBLE(*rval, php_get_nan());",
          "1134:  } else if (!strncmp(start + 2, \"INF\", 3)) {",
          "1135:   ZVAL_DOUBLE(*rval, php_get_inf());",
          "1136:  } else if (!strncmp(start + 2, \"-INF\", 4)) {",
          "1137:   ZVAL_DOUBLE(*rval, -php_get_inf());",
          "1142: #line 1143 \"ext/standard/var_unserializer.c\"",
          "1143: yy76:",
          "1145:  if (yych == 'N') goto yy73;",
          "1147: yy77:",
          "1148:  yych = *++YYCURSOR;",
          "1149:  if (yych <= ',') {",
          "1150:   if (yych != '+') goto yy18;",
          "1151:  } else {",
          "1152:   if (yych <= '-') goto yy78;",
          "1153:   if (yych <= '/') goto yy18;",
          "1154:   if (yych <= '9') goto yy79;",
          "1155:   goto yy18;",
          "1156:  }",
          "1157: yy78:",
          "1158:  yych = *++YYCURSOR;",
          "1159:  if (yych <= '/') goto yy18;",
          "1160:  if (yych >= ':') goto yy18;",
          "1161: yy79:",
          "1162:  ++YYCURSOR;",
          "1163:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1164:  yych = *YYCURSOR;",
          "1165:  if (yych <= '/') goto yy18;",
          "1166:  if (yych <= '9') goto yy79;",
          "1167:  if (yych != ';') goto yy18;",
          "1169: #line 558 \"ext/standard/var_unserializer.re\"",
          "1171: #if SIZEOF_LONG == 4",
          "1172:  int digits = YYCURSOR - start - 3;",
          "1174:  if (start[2] == '-' || start[2] == '+') {",
          "1175:   digits--;",
          "1179:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "1180:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "1181:    int cmp = strncmp(YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "1183:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "1184:     goto use_double;",
          "1187:    goto use_double;",
          "1189:  }",
          "1190: #endif",
          "1192:  INIT_PZVAL(*rval);",
          "1193:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "1194:  return 1;",
          "1196: #line 1197 \"ext/standard/var_unserializer.c\"",
          "1197: yy83:",
          "1198:  yych = *++YYCURSOR;",
          "1199:  if (yych <= '/') goto yy18;",
          "1200:  if (yych >= '2') goto yy18;",
          "1201:  yych = *++YYCURSOR;",
          "1202:  if (yych != ';') goto yy18;",
          "1204: #line 551 \"ext/standard/var_unserializer.re\"",
          "1208:  ZVAL_BOOL(*rval, parse_iv(start + 2));",
          "1211: #line 1212 \"ext/standard/var_unserializer.c\"",
          "1212: yy87:",
          "1214: #line 544 \"ext/standard/var_unserializer.re\"",
          "1218:  ZVAL_NULL(*rval);",
          "1219:  return 1;",
          "1221: #line 1222 \"ext/standard/var_unserializer.c\"",
          "1222: yy89:",
          "1225:   if (yych != '+') goto yy18;",
          "1227:   if (yych <= '-') goto yy90;",
          "1229:   if (yych <= '9') goto yy91;",
          "1230:   goto yy18;",
          "1232: yy90:",
          "1233:  yych = *++YYCURSOR;",
          "1234:  if (yych <= '/') goto yy18;",
          "1235:  if (yych >= ':') goto yy18;",
          "1236: yy91:",
          "1241:  if (yych <= '9') goto yy91;",
          "1242:  if (yych != ';') goto yy18;",
          "1244: #line 521 \"ext/standard/var_unserializer.re\"",
          "1246:  long id;",
          "1249:  if (!var_hash) return 0;",
          "1251:  id = parse_iv(start + 2) - 1;",
          "1252:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "1256:  if (*rval == *rval_ref) return 0;",
          "1258:  if (*rval != NULL) {",
          "1259:   var_push_dtor_no_addref(var_hash, rval);",
          "1262:  Z_ADDREF_PP(rval);",
          "1263:  Z_UNSET_ISREF_PP(rval);",
          "1267: #line 1268 \"ext/standard/var_unserializer.c\"",
          "1268: yy95:",
          "1269:  yych = *++YYCURSOR;",
          "1270:  if (yych <= ',') {",
          "1271:   if (yych != '+') goto yy18;",
          "1272:  } else {",
          "1273:   if (yych <= '-') goto yy96;",
          "1274:   if (yych <= '/') goto yy18;",
          "1275:   if (yych <= '9') goto yy97;",
          "1276:   goto yy18;",
          "1277:  }",
          "1281:  if (yych >= ':') goto yy18;",
          "1284:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "1285:  yych = *YYCURSOR;",
          "1286:  if (yych <= '/') goto yy18;",
          "1287:  if (yych <= '9') goto yy97;",
          "1288:  if (yych != ';') goto yy18;",
          "1289:  ++YYCURSOR;",
          "1290: #line 500 \"ext/standard/var_unserializer.re\"",
          "1292:  long id;",
          "1295:  if (!var_hash) return 0;",
          "1297:  id = parse_iv(start + 2) - 1;",
          "1298:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "1299:   return 0;",
          "1300:  }",
          "1302:  if (*rval != NULL) {",
          "1303:   var_push_dtor_no_addref(var_hash, rval);",
          "1306:  Z_ADDREF_PP(rval);",
          "1307:  Z_SET_ISREF_PP(rval);",
          "1311: #line 1312 \"ext/standard/var_unserializer.c\"",
          "1313: #line 863 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "946: #line 947 \"ext/standard/var_unserializer.c\"",
          "947: yy73:",
          "950:   if (yych == '+') goto yy88;",
          "951:   goto yy18;",
          "953:   if (yych <= '-') goto yy88;",
          "955:   if (yych <= '9') goto yy89;",
          "958: yy74:",
          "960:  if (yych == 'F') goto yy91;",
          "962: yy75:",
          "964:  if (yych == 'N') goto yy91;",
          "966: yy76:",
          "968: #line 558 \"ext/standard/var_unserializer.re\"",
          "969:  {",
          "970: #if SIZEOF_LONG == 4",
          "971:  int digits = YYCURSOR - start - 3;",
          "973:  if (start[2] == '-' || start[2] == '+') {",
          "974:   digits--;",
          "975:  }",
          "978:  if (digits >= MAX_LENGTH_OF_LONG - 1) {",
          "979:   if (digits == MAX_LENGTH_OF_LONG - 1) {",
          "980:    int cmp = strncmp(YYCURSOR - MAX_LENGTH_OF_LONG, long_min_digits, MAX_LENGTH_OF_LONG - 1);",
          "982:    if (!(cmp < 0 || (cmp == 0 && start[2] == '-'))) {",
          "983:     goto use_double;",
          "984:    }",
          "986:    goto use_double;",
          "989: #endif",
          "991:  INIT_PZVAL(*rval);",
          "992:  ZVAL_LONG(*rval, parse_iv(start + 2));",
          "993:  return 1;",
          "994: }",
          "995: #line 996 \"ext/standard/var_unserializer.c\"",
          "996: yy78:",
          "998:  if (yych == '\"') goto yy92;",
          "999:  goto yy18;",
          "1000: yy79:",
          "1002: #line 521 \"ext/standard/var_unserializer.re\"",
          "1004:  long id;",
          "1007:  if (!var_hash) return 0;",
          "1009:  id = parse_iv(start + 2) - 1;",
          "1010:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "1011:   return 0;",
          "1014:  if (*rval == *rval_ref) return 0;",
          "1016:  if (*rval != NULL) {",
          "1017:   var_push_dtor_no_addref(var_hash, rval);",
          "1018:  }",
          "1020:  Z_ADDREF_PP(rval);",
          "1021:  Z_UNSET_ISREF_PP(rval);",
          "1025: #line 1026 \"ext/standard/var_unserializer.c\"",
          "1026: yy81:",
          "1028:  if (yych == '\"') goto yy94;",
          "1030: yy82:",
          "1032: #line 708 \"ext/standard/var_unserializer.re\"",
          "1034:  size_t len, len2, len3, maxlen;",
          "1035:  long elements;",
          "1036:  char *class_name;",
          "1037:  zend_class_entry *ce;",
          "1038:  zend_class_entry **pce;",
          "1039:  int incomplete_class = 0;",
          "1041:  int custom_object = 0;",
          "1043:  zval *user_func;",
          "1044:  zval *retval_ptr;",
          "1045:  zval **args[1];",
          "1046:  zval *arg_func_name;",
          "1048:     if (!var_hash) return 0;",
          "1049:  if (*start == 'C') {",
          "1050:   custom_object = 1;",
          "1053:  INIT_PZVAL(*rval);",
          "1054:  len2 = len = parse_uiv(start + 2);",
          "1055:  maxlen = max - YYCURSOR;",
          "1056:  if (maxlen < len || len == 0) {",
          "1058:   return 0;",
          "1059:  }",
          "1061:  class_name = (char*)YYCURSOR;",
          "1063:  YYCURSOR += len;",
          "1065:  if (*(YYCURSOR) != '\"') {",
          "1067:   return 0;",
          "1068:  }",
          "1069:  if (*(YYCURSOR+1) != ':') {",
          "1071:   return 0;",
          "1072:  }",
          "1074:  len3 = strspn(class_name, \"0123456789_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\\177\\200\\201\\202\\203\\204\\205\\206\\207\\210\\211\\212\\213\\214\\215\\216\\217\\220\\221\\222\\223\\224\\225\\226\\227\\230\\231\\232\\233\\234\\235\\236\\237\\240\\241\\242\\243\\244\\245\\246\\247\\250\\251\\252\\253\\254\\255\\256\\257\\260\\261\\262\\263\\264\\265\\266\\267\\270\\271\\272\\273\\274\\275\\276\\277\\300\\301\\302\\303\\304\\305\\306\\307\\310\\311\\312\\313\\314\\315\\316\\317\\320\\321\\322\\323\\324\\325\\326\\327\\330\\331\\332\\333\\334\\335\\336\\337\\340\\341\\342\\343\\344\\345\\346\\347\\350\\351\\352\\353\\354\\355\\356\\357\\360\\361\\362\\363\\364\\365\\366\\367\\370\\371\\372\\373\\374\\375\\376\\377\\\\\");",
          "1075:  if (len3 != len)",
          "1076:  {",
          "1078:   return 0;",
          "1079:  }",
          "1081:  class_name = estrndup(class_name, len);",
          "1083:  do {",
          "1085:   BG(serialize_lock)++;",
          "1086:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "1087:    BG(serialize_lock)--;",
          "1088:    if (EG(exception)) {",
          "1089:     efree(class_name);",
          "1090:     return 0;",
          "1091:    }",
          "1092:    ce = *pce;",
          "1093:    break;",
          "1094:   }",
          "1095:   BG(serialize_lock)--;",
          "1097:   if (EG(exception)) {",
          "1098:    efree(class_name);",
          "1099:    return 0;",
          "1100:   }",
          "1103:   if ((PG(unserialize_callback_func) == NULL) || (PG(unserialize_callback_func)[0] == '\\0')) {",
          "1104:    incomplete_class = 1;",
          "1105:    ce = PHP_IC_ENTRY;",
          "1106:    break;",
          "1107:   }",
          "1110:   MAKE_STD_ZVAL(user_func);",
          "1111:   ZVAL_STRING(user_func, PG(unserialize_callback_func), 1);",
          "1112:   args[0] = &arg_func_name;",
          "1113:   MAKE_STD_ZVAL(arg_func_name);",
          "1114:   ZVAL_STRING(arg_func_name, class_name, 1);",
          "1115:   BG(serialize_lock)++;",
          "1116:   if (call_user_function_ex(CG(function_table), NULL, user_func, &retval_ptr, 1, args, 0, NULL TSRMLS_CC) != SUCCESS) {",
          "1117:    BG(serialize_lock)--;",
          "1118:    if (EG(exception)) {",
          "1119:     efree(class_name);",
          "1120:     zval_ptr_dtor(&user_func);",
          "1121:     zval_ptr_dtor(&arg_func_name);",
          "1122:     return 0;",
          "1124:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"defined (%s) but not found\", user_func->value.str.val);",
          "1125:    incomplete_class = 1;",
          "1126:    ce = PHP_IC_ENTRY;",
          "1127:    zval_ptr_dtor(&user_func);",
          "1128:    zval_ptr_dtor(&arg_func_name);",
          "1129:    break;",
          "1130:   }",
          "1131:   BG(serialize_lock)--;",
          "1132:   if (retval_ptr) {",
          "1133:    zval_ptr_dtor(&retval_ptr);",
          "1134:   }",
          "1135:   if (EG(exception)) {",
          "1136:    efree(class_name);",
          "1137:    zval_ptr_dtor(&user_func);",
          "1138:    zval_ptr_dtor(&arg_func_name);",
          "1139:    return 0;",
          "1140:   }",
          "1143:   BG(serialize_lock)++;",
          "1144:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "1145:    ce = *pce;",
          "1147:    php_error_docref(NULL TSRMLS_CC, E_WARNING, \"Function %s() hasn't defined the class it was called for\", user_func->value.str.val);",
          "1148:    incomplete_class = 1;",
          "1149:    ce = PHP_IC_ENTRY;",
          "1151:   BG(serialize_lock)--;",
          "1153:   zval_ptr_dtor(&user_func);",
          "1154:   zval_ptr_dtor(&arg_func_name);",
          "1155:   break;",
          "1156:  } while (1);",
          "1160:  if (custom_object) {",
          "1161:   int ret;",
          "1163:   ret = object_custom(UNSERIALIZE_PASSTHRU, ce);",
          "1165:   if (ret && incomplete_class) {",
          "1166:    php_store_class_name(*rval, class_name, len2);",
          "1167:   }",
          "1168:   efree(class_name);",
          "1169:   return ret;",
          "1170:  }",
          "1172:  elements = object_common1(UNSERIALIZE_PASSTHRU, ce);",
          "1174:  if (incomplete_class) {",
          "1175:   php_store_class_name(*rval, class_name, len2);",
          "1176:  }",
          "1177:  efree(class_name);",
          "1179:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "1181: #line 1182 \"ext/standard/var_unserializer.c\"",
          "1182: yy84:",
          "1184: #line 643 \"ext/standard/var_unserializer.re\"",
          "1186:  size_t len, maxlen;",
          "1187:  char *str;",
          "1189:  len = parse_uiv(start + 2);",
          "1190:  maxlen = max - YYCURSOR;",
          "1191:  if (maxlen < len) {",
          "1193:   return 0;",
          "1194:  }",
          "1196:  if ((str = unserialize_str(&YYCURSOR, &len, maxlen)) == NULL) {",
          "1197:   return 0;",
          "1198:  }",
          "1200:  if (*(YYCURSOR) != '\"') {",
          "1201:   efree(str);",
          "1203:   return 0;",
          "1204:  }",
          "1206:  if (*(YYCURSOR + 1) != ';') {",
          "1207:   efree(str);",
          "1209:   return 0;",
          "1210:  }",
          "1212:  YYCURSOR += 2;",
          "1216:  ZVAL_STRINGL(*rval, str, len, 0);",
          "1219: #line 1220 \"ext/standard/var_unserializer.c\"",
          "1220: yy86:",
          "1222: #line 678 \"ext/standard/var_unserializer.re\"",
          "1224:  long elements = parse_iv(start + 2);",
          "1227:     if (!var_hash) return 0;",
          "1229:  if (elements < 0) {",
          "1230:   return 0;",
          "1231:  }",
          "1235:  array_init_size(*rval, elements);",
          "1237:  if (!process_nested_data(UNSERIALIZE_PASSTHRU, Z_ARRVAL_PP(rval), elements, 0)) {",
          "1238:   return 0;",
          "1239:  }",
          "1241:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "1243: #line 1244 \"ext/standard/var_unserializer.c\"",
          "1244: yy88:",
          "1247:   if (yych == '+') goto yy96;",
          "1248:   goto yy18;",
          "1250:   if (yych <= '-') goto yy96;",
          "1252:   if (yych >= ':') goto yy18;",
          "1254: yy89:",
          "1259:  if (yych <= '9') goto yy89;",
          "1260:  if (yych == ';') goto yy71;",
          "1261:  goto yy18;",
          "1262: yy91:",
          "1263:  yych = *++YYCURSOR;",
          "1264:  if (yych == ';') goto yy97;",
          "1265:  goto yy18;",
          "1266: yy92:",
          "1268: #line 699 \"ext/standard/var_unserializer.re\"",
          "1270:     if (!var_hash) return 0;",
          "1272:  INIT_PZVAL(*rval);",
          "1274:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "1275:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "1276: }",
          "1277: #line 1278 \"ext/standard/var_unserializer.c\"",
          "1278: yy94:",
          "1279:  ++YYCURSOR;",
          "1280: #line 610 \"ext/standard/var_unserializer.re\"",
          "1281:  {",
          "1282:  size_t len, maxlen;",
          "1283:  char *str;",
          "1285:  len = parse_uiv(start + 2);",
          "1286:  maxlen = max - YYCURSOR;",
          "1287:  if (maxlen < len) {",
          "1292:  str = (char*)YYCURSOR;",
          "1294:  YYCURSOR += len;",
          "1296:  if (*(YYCURSOR) != '\"') {",
          "1298:   return 0;",
          "1299:  }",
          "1301:  if (*(YYCURSOR + 1) != ';') {",
          "1303:   return 0;",
          "1306:  YYCURSOR += 2;",
          "1309:  INIT_PZVAL(*rval);",
          "1310:  ZVAL_STRINGL(*rval, str, len, 1);",
          "1313: #line 1314 \"ext/standard/var_unserializer.c\"",
          "1317:  if (yych <= '9') goto yy89;",
          "1318:  goto yy18;",
          "1321: #line 585 \"ext/standard/var_unserializer.re\"",
          "1324:  INIT_PZVAL(*rval);",
          "1326:  if (!strncmp(start + 2, \"NAN\", 3)) {",
          "1327:   ZVAL_DOUBLE(*rval, php_get_nan());",
          "1328:  } else if (!strncmp(start + 2, \"INF\", 3)) {",
          "1329:   ZVAL_DOUBLE(*rval, php_get_inf());",
          "1330:  } else if (!strncmp(start + 2, \"-INF\", 4)) {",
          "1331:   ZVAL_DOUBLE(*rval, -php_get_inf());",
          "1336: #line 1337 \"ext/standard/var_unserializer.c\"",
          "1338: #line 865 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "815:   }",
          "818:   if (zend_lookup_class(class_name, len2, &pce TSRMLS_CC) == SUCCESS) {",
          "819:    ce = *pce;",
          "820:   } else {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "818:   BG(serialize_lock)++;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "822:    incomplete_class = 1;",
          "823:    ce = PHP_IC_ENTRY;",
          "824:   }",
          "826:   zval_ptr_dtor(&user_func);",
          "827:   zval_ptr_dtor(&arg_func_name);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "826:   BG(serialize_lock)--;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "6bfedfd22eb8521cd0f38ab45fca3c877ee724ca",
      "candidate_info": {
        "commit_hash": "6bfedfd22eb8521cd0f38ab45fca3c877ee724ca",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/6bfedfd22eb8521cd0f38ab45fca3c877ee724ca",
        "files": [
          "ext/session/php_session.h",
          "ext/session/session.c",
          "ext/spl/spl_observer.c",
          "ext/standard/php_var.h",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed unserialize()",
        "before_after_code_files": [
          "ext/session/php_session.h||ext/session/php_session.h",
          "ext/session/session.c||ext/session/session.c",
          "ext/spl/spl_observer.c||ext/spl/spl_observer.c",
          "ext/standard/php_var.h||ext/standard/php_var.h",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/session/php_session.h||ext/session/php_session.h": [
          "File: ext/session/php_session.h -> ext/session/php_session.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "221: PHPAPI void session_adapt_url(const char *, size_t, char **, size_t * TSRMLS_DC);",
          "223: PHPAPI void php_add_session_var(zend_string *name TSRMLS_DC);",
          "225: PHPAPI zval *php_get_session_var(zend_string *name TSRMLS_DC);",
          "227: PHPAPI int php_session_register_module(ps_module *);",
          "",
          "[Removed Lines]",
          "224: PHPAPI void php_set_session_var(zend_string *name, zval *state_val, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "",
          "[Added Lines]",
          "224: PHPAPI zval *php_set_session_var(zend_string *name, zval *state_val, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "",
          "---------------"
        ],
        "ext/session/session.c||ext/session/session.c": [
          "File: ext/session/session.c -> ext/session/session.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "159: }",
          "163: {",
          "164:  IF_SESSION_VARS() {",
          "166:  }",
          "167: }",
          "",
          "[Removed Lines]",
          "165:   zend_set_hash_symbol(state_val, name->val, name->len, Z_ISREF_P(state_val), 1, Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))));",
          "",
          "[Added Lines]",
          "165:   return zend_hash_update(Z_ARRVAL_P(Z_REFVAL(PS(http_session_vars))), name, state_val);",
          "167:  return NULL;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "924:   }",
          "926:   if (has_value) {",
          "928:    if (php_var_unserialize(&current, (const unsigned char **) &p, (const unsigned char *) endptr, &var_hash TSRMLS_CC)) {",
          "930:    }",
          "932:   }",
          "933:   PS_ADD_VARL(name);",
          "934:   STR_RELEASE(name);",
          "",
          "[Removed Lines]",
          "927:    ZVAL_NULL(&current);",
          "929:     php_set_session_var(name, &current, &var_hash  TSRMLS_CC);",
          "931:    zval_ptr_dtor(&current);",
          "",
          "[Added Lines]",
          "928:    ZVAL_UNDEF(&current);",
          "930:     zval *zv = php_set_session_var(name, &current, &var_hash  TSRMLS_CC);",
          "931:     var_replace(&var_hash, &current, zv);",
          "932:    } else {",
          "933:     zval_ptr_dtor(&current);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "978: {",
          "979:  const char *p, *q;",
          "980:  const char *endptr = val + vallen;",
          "982:  int has_value;",
          "983:  int namelen;",
          "984:  zend_string *name;",
          "",
          "[Removed Lines]",
          "981:  zval stack, *current = NULL;",
          "",
          "[Added Lines]",
          "984:  zval current;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "989:  p = val;",
          "992:  while (p < endptr) {",
          "993:   zval *tmp;",
          "994:   q = p;",
          "",
          "[Removed Lines]",
          "991:  array_init(&stack);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1013:   }",
          "1015:   if (has_value) {",
          "1022:    }",
          "1023:   }",
          "1024:   PS_ADD_VARL(name);",
          "",
          "[Removed Lines]",
          "1016:    zval dummy;",
          "1017:    ZVAL_NULL(&dummy);",
          "1019:    current = zend_hash_next_index_insert(Z_ARRVAL(stack), &dummy);",
          "1020:    if (php_var_unserialize(current, (const unsigned char **) &q, (const unsigned char *) endptr, &var_hash TSRMLS_CC)) {",
          "1021:     php_set_session_var(name, current, &var_hash TSRMLS_CC);",
          "",
          "[Added Lines]",
          "1018:    ZVAL_UNDEF(&current);",
          "1019:    if (php_var_unserialize(&current, (const unsigned char **) &q, (const unsigned char *) endptr, &var_hash TSRMLS_CC)) {",
          "1020:     zval *zv = php_set_session_var(name, &current, &var_hash TSRMLS_CC);",
          "1021:     var_replace(&var_hash, &current, zv);",
          "1022:    } else {",
          "1023:     zval_ptr_dtor(&current);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1030: break_outer_loop:",
          "1032:  PHP_VAR_UNSERIALIZE_DESTROY(var_hash);",
          "1035:  return SUCCESS;",
          "1036: }",
          "",
          "[Removed Lines]",
          "1033:  zval_ptr_dtor(&stack);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/spl/spl_observer.c||ext/spl/spl_observer.c": [
          "File: ext/spl/spl_observer.c -> ext/spl/spl_observer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "213:    ZVAL_NULL(&pelement->inf);",
          "214:   }",
          "215:   spl_object_storage_free_hash(intern, hash);",
          "217:  }",
          "219:  ZVAL_COPY(&element.obj, obj);",
          "",
          "[Removed Lines]",
          "216:   return;",
          "",
          "[Added Lines]",
          "216:   return pelement;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "222:  } else {",
          "223:   ZVAL_NULL(&element.inf);",
          "224:  }",
          "226:  spl_object_storage_free_hash(intern, hash);",
          "",
          "[Removed Lines]",
          "225:  zend_hash_update_mem(&intern->storage, hash, &element, sizeof(spl_SplObjectStorageElement));",
          "",
          "[Added Lines]",
          "225:  pelement = zend_hash_update_mem(&intern->storage, hash, &element, sizeof(spl_SplObjectStorageElement));",
          "227:  return pelement;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "796:  const unsigned char *p, *s;",
          "797:  php_unserialize_data_t var_hash;",
          "798:  zval entry, pmembers, pcount, inf;",
          "799:  long count;",
          "801:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &buf, &buf_len) == FAILURE) {",
          "802:   return;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "800:  spl_SplObjectStorageElement *element;",
          "802:  HashPosition pos;",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "869:     var_push_dtor(&var_hash, &pelement->obj);",
          "870:    }",
          "871:   }",
          "873:   zval_ptr_dtor(&entry);",
          "874:   zval_ptr_dtor(&inf);",
          "875:  }",
          "",
          "[Removed Lines]",
          "872:   spl_object_storage_attach(intern, getThis(), &entry, &inf TSRMLS_CC);",
          "",
          "[Added Lines]",
          "876:   element = spl_object_storage_attach(intern, getThis(), &entry, &inf TSRMLS_CC);",
          "877:   var_replace(&var_hash, &entry, &element->obj);",
          "878:   var_replace(&var_hash, &inf, &element->inf);",
          "",
          "---------------"
        ],
        "ext/standard/php_var.h||ext/standard/php_var.h": [
          "File: ext/standard/php_var.h -> ext/standard/php_var.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "52: PHPAPI void php_var_serialize(smart_str *buf, zval *struc, php_serialize_data_t *var_hash TSRMLS_DC);",
          "53: PHPAPI int php_var_unserialize(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "54: PHPAPI int php_var_unserialize_intern(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "56: #define PHP_VAR_SERIALIZE_INIT(var_hash_ptr) \\",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "54: PHPAPI int php_var_unserialize_ref(zval *rval, const unsigned char **p, const unsigned char *max, php_unserialize_data_t *var_hash TSRMLS_DC);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "114:  } \\",
          "115: } while (0)",
          "117: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hash, zval *val);",
          "118: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval);",
          "119: PHPAPI void var_destroy(php_unserialize_data_t *var_hash);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "118: PHPAPI void var_replace(php_unserialize_data_t *var_hash, zval *ozval, zval *nzval);",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "34:  void *next;",
          "35: } var_entries;",
          "37: static inline void var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "38: {",
          "39:  var_entries *var_hash = (*var_hashx)->last;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "37: typedef struct {",
          "38:  zval data[VAR_ENTRIES_MAX];",
          "39:  long used_slots;",
          "40:  void *next;",
          "41: } var_dtor_entries;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "61: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "62: {",
          "64: #if VAR_ENTRIES_DBG",
          "65:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "66: #endif",
          "68:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "70:   var_hash->used_slots = 0;",
          "71:   var_hash->next = 0;",
          "",
          "[Removed Lines]",
          "63:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "69:   var_hash = emalloc(sizeof(var_entries));",
          "",
          "[Added Lines]",
          "69:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "75:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "79:   (*var_hashx)->last_dtor = var_hash;",
          "80:  }",
          "84: }",
          "87: #if 0",
          "88: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "89: {",
          "91: #if VAR_ENTRIES_DBG",
          "92:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "93: #endif",
          "95:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "97:   var_hash->used_slots = 0;",
          "98:   var_hash->next = 0;",
          "",
          "[Removed Lines]",
          "82:  if (Z_REFCOUNTED_P(rval)) Z_ADDREF_P(rval);",
          "83:  var_hash->data[var_hash->used_slots++] = rval;",
          "90:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "96:   var_hash = emalloc(sizeof(var_entries));",
          "",
          "[Added Lines]",
          "88:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "89:  var_hash->used_slots++;",
          "96:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "102:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "106:   (*var_hashx)->last_dtor = var_hash;",
          "107:  }",
          "110: }",
          "111: #endif",
          "114: {",
          "115:  var_entries *var_hash = (*var_hashx)->first;",
          "116: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "109:  var_hash->data[var_hash->used_slots++] = rval;",
          "113: static int var_access(php_unserialize_data_t *var_hashx, long id, zval **store)",
          "",
          "[Added Lines]",
          "115:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "116:  var_hash->used_slots++;",
          "120: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "121: {",
          "122:  long i;",
          "123:  var_entries *var_hash = (*var_hashx)->first;",
          "124: #if VAR_ENTRIES_DBG",
          "125:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "126: #endif",
          "128:  while (var_hash) {",
          "129:   for (i = 0; i < var_hash->used_slots; i++) {",
          "130:    if (var_hash->data[i] == ozval) {",
          "131:     var_hash->data[i] = nzval;",
          "133:    }",
          "134:   }",
          "135:   var_hash = var_hash->next;",
          "136:  }",
          "137: }",
          "139: static zval *var_access(php_unserialize_data_t *var_hashx, long id)",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "122:   id -= VAR_ENTRIES_MAX;",
          "123:  }",
          "132: }",
          "134: PHPAPI void var_destroy(php_unserialize_data_t *var_hashx)",
          "",
          "[Removed Lines]",
          "125:  if (!var_hash) return !SUCCESS;",
          "127:  if (id < 0 || id >= var_hash->used_slots) return !SUCCESS;",
          "131:  return SUCCESS;",
          "",
          "[Added Lines]",
          "151:  if (!var_hash) return NULL;",
          "153:  if (id < 0 || id >= var_hash->used_slots) return NULL;",
          "155:  return var_hash->data[id];",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "136:  void *next;",
          "137:  long i;",
          "138:  var_entries *var_hash = (*var_hashx)->first;",
          "139: #if VAR_ENTRIES_DBG",
          "140:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "141: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "163:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "146:   var_hash = next;",
          "147:  }",
          "154:   }",
          "158:  }",
          "159: }",
          "",
          "[Removed Lines]",
          "149:  var_hash = (*var_hashx)->first_dtor;",
          "151:  while (var_hash) {",
          "152:   for (i = 0; i < var_hash->used_slots; i++) {",
          "153:    zval_ptr_dtor(var_hash->data[i]);",
          "155:   next = var_hash->next;",
          "156:   efree(var_hash);",
          "157:   var_hash = next;",
          "",
          "[Added Lines]",
          "174:  while (var_dtor_hash) {",
          "175:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "176:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "178:   next = var_dtor_hash->next;",
          "179:   efree(var_dtor_hash);",
          "180:   var_dtor_hash = next;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "210: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "213: #line 218 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "236: #line 241 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "443:  start = cursor;",
          "447: {",
          "448:  YYCTYPE yych;",
          "449:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "446: #line 447 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "472: #line 473 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "503:  yych = *(YYMARKER = ++YYCURSOR);",
          "504:  if (yych == ':') goto yy95;",
          "505: yy3:",
          "507:  { return 0; }",
          "509: yy4:",
          "510:  yych = *(YYMARKER = ++YYCURSOR);",
          "511:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "506: #line 793 \"ext/standard/var_unserializer.re\"",
          "508: #line 509 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "532: #line 817 \"ext/standard/var_unserializer.re\"",
          "534: #line 535 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "548:  goto yy3;",
          "549: yy14:",
          "550:  ++YYCURSOR;",
          "552:  {",
          "554:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "556: }",
          "558: yy16:",
          "559:  yych = *++YYCURSOR;",
          "560:  goto yy3;",
          "",
          "[Removed Lines]",
          "551: #line 787 \"ext/standard/var_unserializer.re\"",
          "557: #line 558 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "577: #line 811 \"ext/standard/var_unserializer.re\"",
          "583: #line 584 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "584:  yych = *++YYCURSOR;",
          "585:  if (yych != '\"') goto yy18;",
          "586:  ++YYCURSOR;",
          "588:  {",
          "589:  size_t len, len2, len3, maxlen;",
          "590:  long elements;",
          "",
          "[Removed Lines]",
          "587: #line 648 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "613: #line 672 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "724:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "725: }",
          "727: yy25:",
          "728:  yych = *++YYCURSOR;",
          "729:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "726: #line 727 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "752: #line 753 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "748:  yych = *++YYCURSOR;",
          "749:  if (yych != '\"') goto yy18;",
          "750:  ++YYCURSOR;",
          "752:  {",
          "",
          "[Removed Lines]",
          "751: #line 640 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "777: #line 664 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "756:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "757:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "758: }",
          "760: yy32:",
          "761:  yych = *++YYCURSOR;",
          "762:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "759: #line 760 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "785: #line 786 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "777:  yych = *++YYCURSOR;",
          "778:  if (yych != '{') goto yy18;",
          "779:  ++YYCURSOR;",
          "781:  {",
          "782:  long elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "780: #line 619 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "806: #line 643 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "799:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "800: }",
          "802: yy39:",
          "803:  yych = *++YYCURSOR;",
          "804:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "801: #line 802 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "827: #line 828 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "819:  yych = *++YYCURSOR;",
          "820:  if (yych != '\"') goto yy18;",
          "821:  ++YYCURSOR;",
          "823:  {",
          "824:  size_t len, maxlen;",
          "",
          "[Removed Lines]",
          "822: #line 589 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "848: #line 613 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "849:  efree(str);",
          "850:  return 1;",
          "851: }",
          "853: yy46:",
          "854:  yych = *++YYCURSOR;",
          "855:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "852: #line 853 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "878: #line 879 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "870:  yych = *++YYCURSOR;",
          "871:  if (yych != '\"') goto yy18;",
          "872:  ++YYCURSOR;",
          "874:  {",
          "875:  size_t len, maxlen;",
          "876:  char *str;",
          "",
          "[Removed Lines]",
          "873: #line 562 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "899: #line 586 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "897:  ZVAL_STRINGL(rval, str, len);",
          "898:  return 1;",
          "899: }",
          "901: yy53:",
          "902:  yych = *++YYCURSOR;",
          "903:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "900: #line 901 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "926: #line 927 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "985:  }",
          "986: yy63:",
          "987:  ++YYCURSOR;",
          "989:  {",
          "990: #if SIZEOF_LONG == 4",
          "991: use_double:",
          "",
          "[Removed Lines]",
          "988: #line 553 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1014: #line 577 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "994:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "995:  return 1;",
          "996: }",
          "998: yy65:",
          "999:  yych = *++YYCURSOR;",
          "1000:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "997: #line 998 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1023: #line 1024 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1053:  yych = *++YYCURSOR;",
          "1054:  if (yych != ';') goto yy18;",
          "1055:  ++YYCURSOR;",
          "1057:  {",
          "",
          "[Removed Lines]",
          "1056: #line 537 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1082: #line 561 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1070:  return 1;",
          "1071: }",
          "1073: yy76:",
          "1074:  yych = *++YYCURSOR;",
          "1075:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1072: #line 1073 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1098: #line 1099 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1096:  if (yych <= '9') goto yy79;",
          "1097:  if (yych != ';') goto yy18;",
          "1098:  ++YYCURSOR;",
          "1100:  {",
          "1101: #if SIZEOF_LONG == 4",
          "1102:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1099: #line 511 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1125: #line 535 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "1122:  ZVAL_LONG(rval, parse_iv(start + 2));",
          "1123:  return 1;",
          "1124: }",
          "1126: yy83:",
          "1127:  yych = *++YYCURSOR;",
          "1128:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1125: #line 1126 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1151: #line 1152 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "1130:  yych = *++YYCURSOR;",
          "1131:  if (yych != ';') goto yy18;",
          "1132:  ++YYCURSOR;",
          "1134:  {",
          "1136:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1137:  return 1;",
          "1138: }",
          "1140: yy87:",
          "1141:  ++YYCURSOR;",
          "1143:  {",
          "1145:  ZVAL_NULL(rval);",
          "1146:  return 1;",
          "1147: }",
          "1149: yy89:",
          "1150:  yych = *++YYCURSOR;",
          "1151:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1133: #line 505 \"ext/standard/var_unserializer.re\"",
          "1139: #line 1140 \"ext/standard/var_unserializer.c\"",
          "1142: #line 499 \"ext/standard/var_unserializer.re\"",
          "1148: #line 1149 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1159: #line 529 \"ext/standard/var_unserializer.re\"",
          "1165: #line 1166 \"ext/standard/var_unserializer.c\"",
          "1168: #line 523 \"ext/standard/var_unserializer.re\"",
          "1174: #line 1175 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "1168:  if (yych <= '9') goto yy91;",
          "1169:  if (yych != ';') goto yy18;",
          "1170:  ++YYCURSOR;",
          "1172:  {",
          "1173:  long id;",
          "",
          "[Removed Lines]",
          "1171: #line 476 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1197: #line 500 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "1176:  if (!var_hash) return 0;",
          "1178:  id = parse_iv(start + 2) - 1;",
          "1180:   return 0;",
          "1181:  }",
          "",
          "[Removed Lines]",
          "1179:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "",
          "[Added Lines]",
          "1205:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "1192:  return 1;",
          "1193: }",
          "1195: yy95:",
          "1196:  yych = *++YYCURSOR;",
          "1197:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1194: #line 1195 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "1220: #line 1221 \"ext/standard/var_unserializer.c\"",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "1214:  if (yych <= '9') goto yy97;",
          "1215:  if (yych != ';') goto yy18;",
          "1216:  ++YYCURSOR;",
          "1218:  {",
          "1219:  long id;",
          "",
          "[Removed Lines]",
          "1217: #line 451 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1243: #line 477 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "1222:  if (!var_hash) return 0;",
          "1224:  id = parse_iv(start + 2) - 1;",
          "1226:   return 0;",
          "1227:  }",
          "1232:  if (Z_ISREF_P(rval_ref)) {",
          "1233:   ZVAL_COPY(rval, rval_ref);",
          "1234:  } else {",
          "",
          "[Removed Lines]",
          "1225:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "1229:  if (!ZVAL_IS_UNDEF(rval)) {",
          "1230:   zval_ptr_dtor(rval);",
          "1231:  }",
          "",
          "[Added Lines]",
          "1251:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "1255:  zval_ptr_dtor(rval);",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "1240:  return 1;",
          "1241: }",
          "1243: }",
          "1247:  return 0;",
          "",
          "[Removed Lines]",
          "1242: #line 1243 \"ext/standard/var_unserializer.c\"",
          "1244: #line 795 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "1266: #line 1267 \"ext/standard/var_unserializer.c\"",
          "1268: #line 819 \"ext/standard/var_unserializer.re\"",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "32:  void *next;",
          "33: } var_entries;",
          "35: static inline void var_push(php_unserialize_data_t *var_hashx, zval *rval)",
          "36: {",
          "37:  var_entries *var_hash = (*var_hashx)->last;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "35: typedef struct {",
          "36:  zval data[VAR_ENTRIES_MAX];",
          "37:  long used_slots;",
          "38:  void *next;",
          "39: } var_dtor_entries;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "59: PHPAPI void var_push_dtor(php_unserialize_data_t *var_hashx, zval *rval)",
          "60: {",
          "62: #if VAR_ENTRIES_DBG",
          "63:  fprintf(stderr, \"var_push_dtor(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval));",
          "64: #endif",
          "66:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "68:   var_hash->used_slots = 0;",
          "69:   var_hash->next = 0;",
          "",
          "[Removed Lines]",
          "61:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "67:   var_hash = emalloc(sizeof(var_entries));",
          "",
          "[Added Lines]",
          "67:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "73:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "77:   (*var_hashx)->last_dtor = var_hash;",
          "78:  }",
          "82: }",
          "85: #if 0",
          "86: PHPAPI void var_push_dtor_no_addref(php_unserialize_data_t *var_hashx, zval *rval)",
          "87: {",
          "89: #if VAR_ENTRIES_DBG",
          "90:  fprintf(stderr, \"var_push_dtor_no_addref(%ld): %d (%d)\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(rval), Z_REFCOUNT_PP(rval));",
          "91: #endif",
          "93:  if (!var_hash || var_hash->used_slots == VAR_ENTRIES_MAX) {",
          "95:   var_hash->used_slots = 0;",
          "96:   var_hash->next = 0;",
          "",
          "[Removed Lines]",
          "80:  if (Z_REFCOUNTED_P(rval)) Z_ADDREF_P(rval);",
          "81:  var_hash->data[var_hash->used_slots++] = rval;",
          "88:  var_entries *var_hash = (*var_hashx)->last_dtor;",
          "94:   var_hash = emalloc(sizeof(var_entries));",
          "",
          "[Added Lines]",
          "86:  ZVAL_COPY(&var_hash->data[var_hash->used_slots], rval);",
          "87:  var_hash->used_slots++;",
          "94:  var_dtor_entries *var_hash = (*var_hashx)->last_dtor;",
          "100:   var_hash = emalloc(sizeof(var_dtor_entries));",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "104:   (*var_hashx)->last_dtor = var_hash;",
          "105:  }",
          "108: }",
          "109: #endif",
          "112: {",
          "113:  var_entries *var_hash = (*var_hashx)->first;",
          "114: #if VAR_ENTRIES_DBG",
          "",
          "[Removed Lines]",
          "107:  var_hash->data[var_hash->used_slots++] = rval;",
          "111: static int var_access(php_unserialize_data_t *var_hashx, long id, zval **store)",
          "",
          "[Added Lines]",
          "113:  ZVAL_COPY_VALUE(&var_hash->data[var_hash->used_slots], rval);",
          "114:  var_hash->used_slots++;",
          "118: PHPAPI void var_replace(php_unserialize_data_t *var_hashx, zval *ozval, zval *nzval)",
          "119: {",
          "120:  long i;",
          "121:  var_entries *var_hash = (*var_hashx)->first;",
          "122: #if VAR_ENTRIES_DBG",
          "123:  fprintf(stderr, \"var_replace(%ld): %d\\n\", var_hash?var_hash->used_slots:-1L, Z_TYPE_PP(nzval));",
          "124: #endif",
          "126:  while (var_hash) {",
          "127:   for (i = 0; i < var_hash->used_slots; i++) {",
          "128:    if (var_hash->data[i] == ozval) {",
          "129:     var_hash->data[i] = nzval;",
          "131:    }",
          "132:   }",
          "133:   var_hash = var_hash->next;",
          "134:  }",
          "135: }",
          "137: static zval *var_access(php_unserialize_data_t *var_hashx, long id)",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "120:   id -= VAR_ENTRIES_MAX;",
          "121:  }",
          "130: }",
          "132: PHPAPI void var_destroy(php_unserialize_data_t *var_hashx)",
          "",
          "[Removed Lines]",
          "123:  if (!var_hash) return !SUCCESS;",
          "125:  if (id < 0 || id >= var_hash->used_slots) return !SUCCESS;",
          "129:  return SUCCESS;",
          "",
          "[Added Lines]",
          "149:  if (!var_hash) return NULL;",
          "151:  if (id < 0 || id >= var_hash->used_slots) return NULL;",
          "153:  return var_hash->data[id];",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "134:  void *next;",
          "135:  long i;",
          "136:  var_entries *var_hash = (*var_hashx)->first;",
          "137: #if VAR_ENTRIES_DBG",
          "138:  fprintf(stderr, \"var_destroy(%ld)\\n\", var_hash?var_hash->used_slots:-1L);",
          "139: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "161:  var_dtor_entries *var_dtor_hash = (*var_hashx)->first_dtor;",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "144:   var_hash = next;",
          "145:  }",
          "152:   }",
          "156:  }",
          "157: }",
          "",
          "[Removed Lines]",
          "147:  var_hash = (*var_hashx)->first_dtor;",
          "149:  while (var_hash) {",
          "150:   for (i = 0; i < var_hash->used_slots; i++) {",
          "151:    zval_ptr_dtor(var_hash->data[i]);",
          "153:   next = var_hash->next;",
          "154:   efree(var_hash);",
          "155:   var_hash = next;",
          "",
          "[Added Lines]",
          "172:  while (var_dtor_hash) {",
          "173:   for (i = 0; i < var_dtor_hash->used_slots; i++) {",
          "174:    zval_ptr_dtor(&var_dtor_hash->data[i]);",
          "176:   next = var_dtor_hash->next;",
          "177:   efree(var_dtor_hash);",
          "178:   var_dtor_hash = next;",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "455:  if (!var_hash) return 0;",
          "457:  id = parse_iv(start + 2) - 1;",
          "459:   return 0;",
          "460:  }",
          "465:  if (Z_ISREF_P(rval_ref)) {",
          "466:   ZVAL_COPY(rval, rval_ref);",
          "467:  } else {",
          "",
          "[Removed Lines]",
          "458:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "462:  if (!ZVAL_IS_UNDEF(rval)) {",
          "463:   zval_ptr_dtor(rval);",
          "464:  }",
          "",
          "[Added Lines]",
          "484:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "488:  zval_ptr_dtor(rval);",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "480:  if (!var_hash) return 0;",
          "482:  id = parse_iv(start + 2) - 1;",
          "484:   return 0;",
          "485:  }",
          "",
          "[Removed Lines]",
          "483:  if (id == -1 || var_access(var_hash, id, &rval_ref) != SUCCESS) {",
          "",
          "[Added Lines]",
          "507:  if (id == -1 || (rval_ref = var_access(var_hash, id)) == NULL) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "41115d3d9dc1f7116ac2d1bb7087a24098885a03",
      "candidate_info": {
        "commit_hash": "41115d3d9dc1f7116ac2d1bb7087a24098885a03",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/41115d3d9dc1f7116ac2d1bb7087a24098885a03",
        "files": [
          "ext/date/lib/parse_date.c",
          "ext/pdo/pdo_sql_parser.c",
          "ext/standard/url_scanner_ex.c",
          "ext/standard/var_unserializer.c",
          "sapi/cli/php_cli.c"
        ],
        "message": "regenerated parser files",
        "before_after_code_files": [
          "ext/date/lib/parse_date.c||ext/date/liparse_date.c",
          "ext/pdo/pdo_sql_parser.c||ext/pdo/pdo_sql_parser.c",
          "ext/standard/url_scanner_ex.c||ext/standard/url_scanner_ex.c",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "sapi/cli/php_cli.c||sapi/cli/php_cli.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
          ],
          "candidate": [
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/date/lib/parse_date.c||ext/date/liparse_date.c": [
          "File: ext/date/lib/parse_date.c -> ext/date/liparse_date.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:    +----------------------------------------------------------------------+",
          "5:    | PHP Version 5                                                        |",
          "",
          "[Removed Lines]",
          "2: #line 1 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "840: std:",
          "841:  s->tok = cursor;",
          "842:  s->len = 0;",
          "848: {",
          "849:  YYCTYPE yych;",
          "850:  unsigned int yyaccept = 0;",
          "",
          "[Removed Lines]",
          "843: #line 966 \"ext/date/lib/parse_date.re\"",
          "847: #line 848 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "984:  }",
          "985: yy3:",
          "986:  YYDEBUG(3, *YYCURSOR);",
          "988:  {",
          "989:   int tz_not_found;",
          "990:   DEBUG_OUTPUT(\"tzcorrection | tz\");",
          "",
          "[Removed Lines]",
          "987: #line 1646 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "997:   TIMELIB_DEINIT;",
          "998:   return TIMELIB_TIMEZONE;",
          "999:  }",
          "1001: yy4:",
          "1002:  YYDEBUG(4, *YYCURSOR);",
          "1003:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "1000: #line 1001 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1308:  if (yych <= '9') goto yy1385;",
          "1309: yy12:",
          "1310:  YYDEBUG(12, *YYCURSOR);",
          "1312:  {",
          "1313:   add_error(s, \"Unexpected character\");",
          "1314:   goto std;",
          "1315:  }",
          "1317: yy13:",
          "1318:  YYDEBUG(13, *YYCURSOR);",
          "1319:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "1311: #line 1741 \"ext/date/lib/parse_date.re\"",
          "1316: #line 1317 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "2370:  if (yych <= '9') goto yy54;",
          "2371: yy49:",
          "2372:  YYDEBUG(49, *YYCURSOR);",
          "2374:  {",
          "2375:   goto std;",
          "2376:  }",
          "2378: yy50:",
          "2379:  YYDEBUG(50, *YYCURSOR);",
          "2380:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "2373: #line 1730 \"ext/date/lib/parse_date.re\"",
          "2377: #line 2378 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "2383:  YYDEBUG(51, *YYCURSOR);",
          "2384:  ++YYCURSOR;",
          "2385:  YYDEBUG(52, *YYCURSOR);",
          "2387:  {",
          "2388:   s->pos = cursor; s->line++;",
          "2389:   goto std;",
          "2390:  }",
          "2392: yy53:",
          "2393:  YYDEBUG(53, *YYCURSOR);",
          "2394:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "2386: #line 1735 \"ext/date/lib/parse_date.re\"",
          "2391: #line 2392 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "2775:  if (yych == 's') goto yy73;",
          "2776: yy72:",
          "2777:  YYDEBUG(72, *YYCURSOR);",
          "2779:  {",
          "2780:   timelib_ull i;",
          "2781:   DEBUG_OUTPUT(\"relative\");",
          "",
          "[Removed Lines]",
          "2778: #line 1714 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "2790:   TIMELIB_DEINIT;",
          "2791:   return TIMELIB_RELATIVE;",
          "2792:  }",
          "2794: yy73:",
          "2795:  YYDEBUG(73, *YYCURSOR);",
          "2796:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "2793: #line 2794 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "3552:  }",
          "3553: yy166:",
          "3554:  YYDEBUG(166, *YYCURSOR);",
          "3556:  {",
          "3557:   const timelib_relunit* relunit;",
          "3558:   DEBUG_OUTPUT(\"daytext\");",
          "",
          "[Removed Lines]",
          "3555: #line 1577 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "3569:   TIMELIB_DEINIT;",
          "3570:   return TIMELIB_WEEKDAY;",
          "3571:  }",
          "3573: yy167:",
          "3574:  YYDEBUG(167, *YYCURSOR);",
          "3575:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "3572: #line 3573 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "4089:  }",
          "4090: yy193:",
          "4091:  YYDEBUG(193, *YYCURSOR);",
          "4093:  {",
          "4094:   DEBUG_OUTPUT(\"monthtext\");",
          "4095:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "4092: #line 1636 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "4098:   TIMELIB_DEINIT;",
          "4099:   return TIMELIB_DATE_TEXT;",
          "4100:  }",
          "4102: yy194:",
          "4103:  YYDEBUG(194, *YYCURSOR);",
          "4104:  ++YYCURSOR;",
          "",
          "[Removed Lines]",
          "4101: #line 4102 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "4149:  }",
          "4150: yy198:",
          "4151:  YYDEBUG(198, *YYCURSOR);",
          "4153:  {",
          "4154:   int length = 0;",
          "4155:   DEBUG_OUTPUT(\"datetextual | datenoyear\");",
          "",
          "[Removed Lines]",
          "4152: #line 1382 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "4162:   TIMELIB_DEINIT;",
          "4163:   return TIMELIB_DATE_TEXT;",
          "4164:  }",
          "4166: yy199:",
          "4167:  YYDEBUG(199, *YYCURSOR);",
          "4168:  yyaccept = 6;",
          "",
          "[Removed Lines]",
          "4165: #line 4166 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "4431:  }",
          "4432: yy222:",
          "4433:  YYDEBUG(222, *YYCURSOR);",
          "4435:  {",
          "4436:   int tz_not_found;",
          "4437:   DEBUG_OUTPUT(\"dateshortwithtimeshort | dateshortwithtimelong | dateshortwithtimelongtz\");",
          "",
          "[Removed Lines]",
          "4434: #line 1684 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "4460:   TIMELIB_DEINIT;",
          "4461:   return TIMELIB_SHORTDATE_WITH_TIME;",
          "4462:  }",
          "4464: yy223:",
          "4465:  YYDEBUG(223, *YYCURSOR);",
          "4466:  yyaccept = 7;",
          "",
          "[Removed Lines]",
          "4463: #line 4464 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "5158:  YYDEBUG(277, *YYCURSOR);",
          "5159:  ++YYCURSOR;",
          "5160:  YYDEBUG(278, *YYCURSOR);",
          "5162:  {",
          "5163:   DEBUG_OUTPUT(\"dateshortwithtimeshort12 | dateshortwithtimelong12\");",
          "5164:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "5161: #line 1660 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "5181:   TIMELIB_DEINIT;",
          "5182:   return TIMELIB_SHORTDATE_WITH_TIME;",
          "5183:  }",
          "5185: yy279:",
          "5186:  YYDEBUG(279, *YYCURSOR);",
          "5187:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "5184: #line 5185 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "5359:  ++YYCURSOR;",
          "5360: yy294:",
          "5361:  YYDEBUG(294, *YYCURSOR);",
          "5363:  {",
          "5364:   int length = 0;",
          "5365:   DEBUG_OUTPUT(\"datenoday\");",
          "",
          "[Removed Lines]",
          "5362: #line 1354 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "5372:   TIMELIB_DEINIT;",
          "5373:   return TIMELIB_DATE_NO_DAY;",
          "5374:  }",
          "5376: yy295:",
          "5377:  YYDEBUG(295, *YYCURSOR);",
          "5378:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "5375: #line 5376 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "6592:  if (yych <= '9') goto yy364;",
          "6593: yy363:",
          "6594:  YYDEBUG(363, *YYCURSOR);",
          "6596:  {",
          "6597:   int length = 0;",
          "6598:   DEBUG_OUTPUT(\"pgtextshort\");",
          "",
          "[Removed Lines]",
          "6595: #line 1498 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "6605:   TIMELIB_DEINIT;",
          "6606:   return TIMELIB_PG_TEXT;",
          "6607:  }",
          "6609: yy364:",
          "6610:  YYDEBUG(364, *YYCURSOR);",
          "6611:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "6608: #line 6609 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "7243:  }",
          "7244: yy392:",
          "7245:  YYDEBUG(392, *YYCURSOR);",
          "7247:  {",
          "7248:   DEBUG_OUTPUT(\"ago\");",
          "7249:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "7246: #line 1556 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "7263:   TIMELIB_DEINIT;",
          "7264:   return TIMELIB_AGO;",
          "7265:  }",
          "7267: yy393:",
          "7268:  YYDEBUG(393, *YYCURSOR);",
          "7269:  yyaccept = 5;",
          "",
          "[Removed Lines]",
          "7266: #line 7267 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "9013:  ++YYCURSOR;",
          "9014: yy454:",
          "9015:  YYDEBUG(454, *YYCURSOR);",
          "9017:  {",
          "9018:   DEBUG_OUTPUT(\"iso8601date4 | iso8601date2 | iso8601dateslash | dateslash\");",
          "9019:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "9016: #line 1259 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 27 ---",
          "[Context before]",
          "9024:   TIMELIB_DEINIT;",
          "9025:   return TIMELIB_ISO_DATE;",
          "9026:  }",
          "9028: yy455:",
          "9029:  YYDEBUG(455, *YYCURSOR);",
          "9030:  yyaccept = 0;",
          "",
          "[Removed Lines]",
          "9027: #line 9028 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 28 ---",
          "[Context before]",
          "9584:  }",
          "9585: yy475:",
          "9586:  YYDEBUG(475, *YYCURSOR);",
          "9588:  {",
          "9589:   DEBUG_OUTPUT(\"datenoyearrev\");",
          "9590:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "9587: #line 1396 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 29 ---",
          "[Context before]",
          "9595:   TIMELIB_DEINIT;",
          "9596:   return TIMELIB_DATE_TEXT;",
          "9597:  }",
          "9599: yy476:",
          "9600:  YYDEBUG(476, *YYCURSOR);",
          "9601:  yyaccept = 10;",
          "",
          "[Removed Lines]",
          "9598: #line 9599 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 30 ---",
          "[Context before]",
          "9736:  YYDEBUG(487, *YYCURSOR);",
          "9737:  ++YYCURSOR;",
          "9738:  YYDEBUG(488, *YYCURSOR);",
          "9740:  {",
          "9741:   DEBUG_OUTPUT(\"timetiny12 | timeshort12 | timelong12\");",
          "9742:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "9739: #line 1114 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 31 ---",
          "[Context before]",
          "9752:   TIMELIB_DEINIT;",
          "9753:   return TIMELIB_TIME12;",
          "9754:  }",
          "9756: yy489:",
          "9757:  YYDEBUG(489, *YYCURSOR);",
          "9758:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "9755: #line 9756 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 32 ---",
          "[Context before]",
          "9765:  }",
          "9766: yy490:",
          "9767:  YYDEBUG(490, *YYCURSOR);",
          "9769:  {",
          "9770:   int tz_not_found;",
          "9771:   DEBUG_OUTPUT(\"timeshort24 | timelong24 | iso8601long\");",
          "",
          "[Removed Lines]",
          "9768: #line 1151 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 33 ---",
          "[Context before]",
          "9790:   TIMELIB_DEINIT;",
          "9791:   return TIMELIB_TIME24_WITH_ZONE;",
          "9792:  }",
          "9794: yy491:",
          "9795:  YYDEBUG(491, *YYCURSOR);",
          "9796:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "9793: #line 9794 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 34 ---",
          "[Context before]",
          "10100:  YYDEBUG(522, *YYCURSOR);",
          "10101:  ++YYCURSOR;",
          "10102:  YYDEBUG(523, *YYCURSOR);",
          "10104:  {",
          "10105:   DEBUG_OUTPUT(\"mssqltime\");",
          "10106:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "10103: #line 1131 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 35 ---",
          "[Context before]",
          "10119:   TIMELIB_DEINIT;",
          "10120:   return TIMELIB_TIME24_WITH_ZONE;",
          "10121:  }",
          "10123: yy524:",
          "10124:  YYDEBUG(524, *YYCURSOR);",
          "10125:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "10122: #line 10123 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 36 ---",
          "[Context before]",
          "10225:  if (yych <= '9') goto yy540;",
          "10226: yy534:",
          "10227:  YYDEBUG(534, *YYCURSOR);",
          "10229:  {",
          "10230:   int length = 0;",
          "10231:   DEBUG_OUTPUT(\"datefull\");",
          "",
          "[Removed Lines]",
          "10228: #line 1313 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 37 ---",
          "[Context before]",
          "10239:   TIMELIB_DEINIT;",
          "10240:   return TIMELIB_DATE_FULL;",
          "10241:  }",
          "10243: yy535:",
          "10244:  YYDEBUG(535, *YYCURSOR);",
          "10245:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "10242: #line 10243 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 38 ---",
          "[Context before]",
          "10976:  YYDEBUG(605, *YYCURSOR);",
          "10977:  ++YYCURSOR;",
          "10978:  YYDEBUG(606, *YYCURSOR);",
          "10980:  {",
          "10981:   DEBUG_OUTPUT(\"pointed date YYYY\");",
          "10982:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "10979: #line 1328 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 39 ---",
          "[Context before]",
          "10987:   TIMELIB_DEINIT;",
          "10988:   return TIMELIB_DATE_FULL_POINTED;",
          "10989:  }",
          "10991: yy607:",
          "10992:  YYDEBUG(607, *YYCURSOR);",
          "10993:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "10990: #line 10991 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 40 ---",
          "[Context before]",
          "11023:  if (yych <= '9') goto yy604;",
          "11024: yy611:",
          "11025:  YYDEBUG(611, *YYCURSOR);",
          "11027:  {",
          "11028:   int length = 0;",
          "11029:   DEBUG_OUTPUT(\"pointed date YY\");",
          "",
          "[Removed Lines]",
          "11026: #line 1340 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 41 ---",
          "[Context before]",
          "11036:   TIMELIB_DEINIT;",
          "11037:   return TIMELIB_DATE_FULL_POINTED;",
          "11038:  }",
          "11040: yy612:",
          "11041:  YYDEBUG(612, *YYCURSOR);",
          "11042:  yyaccept = 11;",
          "",
          "[Removed Lines]",
          "11039: #line 11040 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 42 ---",
          "[Context before]",
          "11677:  }",
          "11678: yy656:",
          "11679:  YYDEBUG(656, *YYCURSOR);",
          "11681:  {",
          "11682:   int length = 0;",
          "11683:   DEBUG_OUTPUT(\"gnudateshort\");",
          "",
          "[Removed Lines]",
          "11680: #line 1299 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 43 ---",
          "[Context before]",
          "11690:   TIMELIB_DEINIT;",
          "11691:   return TIMELIB_ISO_DATE;",
          "11692:  }",
          "11694: yy657:",
          "11695:  YYDEBUG(657, *YYCURSOR);",
          "11696:  yyaccept = 13;",
          "",
          "[Removed Lines]",
          "11693: #line 11694 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 44 ---",
          "[Context before]",
          "11796:  }",
          "11797: yy666:",
          "11798:  YYDEBUG(666, *YYCURSOR);",
          "11800:  {",
          "11801:   int length = 0;",
          "11802:   DEBUG_OUTPUT(\"americanshort | american\");",
          "",
          "[Removed Lines]",
          "11799: #line 1243 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 45 ---",
          "[Context before]",
          "11811:   TIMELIB_DEINIT;",
          "11812:   return TIMELIB_AMERICAN;",
          "11813:  }",
          "11815: yy667:",
          "11816:  YYDEBUG(667, *YYCURSOR);",
          "11817:  yyaccept = 14;",
          "",
          "[Removed Lines]",
          "11814: #line 11815 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 46 ---",
          "[Context before]",
          "12044:  if (yych <= ':') goto yy703;",
          "12045: yy700:",
          "12046:  YYDEBUG(700, *YYCURSOR);",
          "12048:  {",
          "12049:   int tz_not_found;",
          "12050:   DEBUG_OUTPUT(\"clf\");",
          "",
          "[Removed Lines]",
          "12047: #line 1526 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 47 ---",
          "[Context before]",
          "12064:   TIMELIB_DEINIT;",
          "12065:   return TIMELIB_CLF;",
          "12066:  }",
          "12068: yy701:",
          "12069:  YYDEBUG(701, *YYCURSOR);",
          "12070:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12067: #line 12068 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 48 ---",
          "[Context before]",
          "12616:  }",
          "12617: yy763:",
          "12618:  YYDEBUG(763, *YYCURSOR);",
          "12620:  {",
          "12621:   int length = 0;",
          "12622:   DEBUG_OUTPUT(\"iso8601date2\");",
          "",
          "[Removed Lines]",
          "12619: #line 1271 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 49 ---",
          "[Context before]",
          "12629:   TIMELIB_DEINIT;",
          "12630:   return TIMELIB_ISO_DATE;",
          "12631:  }",
          "12633: yy764:",
          "12634:  YYDEBUG(764, *YYCURSOR);",
          "12635:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12632: #line 12633 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 50 ---",
          "[Context before]",
          "12668:  YYDEBUG(770, *YYCURSOR);",
          "12669:  ++YYCURSOR;",
          "12670:  YYDEBUG(771, *YYCURSOR);",
          "12672:  {",
          "12673:   int length = 0;",
          "12674:   DEBUG_OUTPUT(\"pgtextreverse\");",
          "",
          "[Removed Lines]",
          "12671: #line 1512 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 51 ---",
          "[Context before]",
          "12681:   TIMELIB_DEINIT;",
          "12682:   return TIMELIB_PG_TEXT;",
          "12683:  }",
          "12685: yy772:",
          "12686:  YYDEBUG(772, *YYCURSOR);",
          "12687:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12684: #line 12685 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 52 ---",
          "[Context before]",
          "12819:  }",
          "12820: yy783:",
          "12821:  YYDEBUG(783, *YYCURSOR);",
          "12823:  {",
          "12824:   DEBUG_OUTPUT(\"year4\");",
          "12825:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "12822: #line 1547 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 53 ---",
          "[Context before]",
          "12827:   TIMELIB_DEINIT;",
          "12828:   return TIMELIB_CLF;",
          "12829:  }",
          "12831: yy784:",
          "12832:  YYDEBUG(784, *YYCURSOR);",
          "12833:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12830: #line 12831 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 54 ---",
          "[Context before]",
          "12978:  }",
          "12979: yy793:",
          "12980:  YYDEBUG(793, *YYCURSOR);",
          "12982:  {",
          "12983:   int length = 0;",
          "12984:   DEBUG_OUTPUT(\"datenodayrev\");",
          "",
          "[Removed Lines]",
          "12981: #line 1368 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 55 ---",
          "[Context before]",
          "12991:   TIMELIB_DEINIT;",
          "12992:   return TIMELIB_DATE_NO_DAY;",
          "12993:  }",
          "12995: yy794:",
          "12996:  YYDEBUG(794, *YYCURSOR);",
          "12997:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "12994: #line 12995 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 56 ---",
          "[Context before]",
          "13206:  if (yych <= '7') goto yy816;",
          "13207: yy814:",
          "13208:  YYDEBUG(814, *YYCURSOR);",
          "13210:  {",
          "13211:   timelib_sll w, d;",
          "13212:   DEBUG_OUTPUT(\"isoweek\");",
          "",
          "[Removed Lines]",
          "13209: #line 1479 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 57 ---",
          "[Context before]",
          "13224:   TIMELIB_DEINIT;",
          "13225:   return TIMELIB_ISO_WEEK;",
          "13226:  }",
          "13228: yy815:",
          "13229:  YYDEBUG(815, *YYCURSOR);",
          "13230:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13227: #line 13228 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 58 ---",
          "[Context before]",
          "13234:  YYDEBUG(816, *YYCURSOR);",
          "13235:  ++YYCURSOR;",
          "13236:  YYDEBUG(817, *YYCURSOR);",
          "13238:  {",
          "13239:   timelib_sll w, d;",
          "13240:   DEBUG_OUTPUT(\"isoweekday\");",
          "",
          "[Removed Lines]",
          "13237: #line 1460 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 59 ---",
          "[Context before]",
          "13252:   TIMELIB_DEINIT;",
          "13253:   return TIMELIB_ISO_WEEK;",
          "13254:  }",
          "13256: yy818:",
          "13257:  YYDEBUG(818, *YYCURSOR);",
          "13258:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13255: #line 13256 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 60 ---",
          "[Context before]",
          "13316:  }",
          "13317: yy821:",
          "13318:  YYDEBUG(821, *YYCURSOR);",
          "13320:  {",
          "13321:   int length = 0;",
          "13322:   DEBUG_OUTPUT(\"pgydotd\");",
          "",
          "[Removed Lines]",
          "13319: #line 1446 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 61 ---",
          "[Context before]",
          "13329:   TIMELIB_DEINIT;",
          "13330:   return TIMELIB_PG_YEARDAY;",
          "13331:  }",
          "13333: yy822:",
          "13334:  YYDEBUG(822, *YYCURSOR);",
          "13335:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13332: #line 13333 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 62 ---",
          "[Context before]",
          "13432:  ++YYCURSOR;",
          "13433: yy842:",
          "13434:  YYDEBUG(842, *YYCURSOR);",
          "13436:  {",
          "13437:   int tz_not_found;",
          "13438:   DEBUG_OUTPUT(\"xmlrpc | xmlrpcnocolon | soap | wddx | exif\");",
          "",
          "[Removed Lines]",
          "13435: #line 1420 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 63 ---",
          "[Context before]",
          "13457:   TIMELIB_DEINIT;",
          "13458:   return TIMELIB_XMLRPC_SOAP;",
          "13459:  }",
          "13461: yy843:",
          "13462:  YYDEBUG(843, *YYCURSOR);",
          "13463:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13460: #line 13461 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 64 ---",
          "[Context before]",
          "13719:  }",
          "13720: yy848:",
          "13721:  YYDEBUG(848, *YYCURSOR);",
          "13723:  {",
          "13724:   DEBUG_OUTPUT(\"datenocolon\");",
          "13725:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "13722: #line 1408 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 65 ---",
          "[Context before]",
          "13730:   TIMELIB_DEINIT;",
          "13731:   return TIMELIB_DATE_NOCOLON;",
          "13732:  }",
          "13734: yy849:",
          "13735:  YYDEBUG(849, *YYCURSOR);",
          "13736:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "13733: #line 13734 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 66 ---",
          "[Context before]",
          "14650:  if (yych <= '9') goto yy995;",
          "14651: yy973:",
          "14652:  YYDEBUG(973, *YYCURSOR);",
          "14654:  {",
          "14655:   int length = 0;",
          "14656:   DEBUG_OUTPUT(\"gnudateshorter\");",
          "",
          "[Removed Lines]",
          "14653: #line 1285 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 67 ---",
          "[Context before]",
          "14663:   TIMELIB_DEINIT;",
          "14664:   return TIMELIB_ISO_DATE;",
          "14665:  }",
          "14667: yy974:",
          "14668:  YYDEBUG(974, *YYCURSOR);",
          "14669:  yyaccept = 22;",
          "",
          "[Removed Lines]",
          "14666: #line 14667 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 68 ---",
          "[Context before]",
          "15672:  }",
          "15673: yy1067:",
          "15674:  YYDEBUG(1067, *YYCURSOR);",
          "15676:  {",
          "15677:   DEBUG_OUTPUT(\"gnunocolon\");",
          "15678:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "15675: #line 1177 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 69 ---",
          "[Context before]",
          "15694:   TIMELIB_DEINIT;",
          "15695:   return TIMELIB_GNU_NOCOLON;",
          "15696:  }",
          "15698: yy1068:",
          "15699:  YYDEBUG(1068, *YYCURSOR);",
          "15700:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "15697: #line 15698 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 70 ---",
          "[Context before]",
          "15786:  }",
          "15787: yy1075:",
          "15788:  YYDEBUG(1075, *YYCURSOR);",
          "15790:  {",
          "15791:   int tz_not_found;",
          "15792:   DEBUG_OUTPUT(\"iso8601nocolon\");",
          "",
          "[Removed Lines]",
          "15789: #line 1223 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 71 ---",
          "[Context before]",
          "15805:   TIMELIB_DEINIT;",
          "15806:   return TIMELIB_ISO_NOCOLON;",
          "15807:  }",
          "15809: yy1076:",
          "15810:  YYDEBUG(1076, *YYCURSOR);",
          "15811:  yyaccept = 25;",
          "",
          "[Removed Lines]",
          "15808: #line 15809 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 72 ---",
          "[Context before]",
          "16703:  }",
          "16704: yy1117:",
          "16705:  YYDEBUG(1117, *YYCURSOR);",
          "16707:  {",
          "16708:   timelib_sll i;",
          "16709:   int         behavior = 0;",
          "",
          "[Removed Lines]",
          "16706: #line 1619 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 73 ---",
          "[Context before]",
          "16719:   TIMELIB_DEINIT;",
          "16720:   return TIMELIB_RELATIVE;",
          "16721:  }",
          "16723: yy1118:",
          "16724:  YYDEBUG(1118, *YYCURSOR);",
          "16725:  ++YYCURSOR;",
          "",
          "[Removed Lines]",
          "16722: #line 16723 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 74 ---",
          "[Context before]",
          "16770:  YYDEBUG(1125, *YYCURSOR);",
          "16771:  ++YYCURSOR;",
          "16772:  YYDEBUG(1126, *YYCURSOR);",
          "16774:  {",
          "16775:   timelib_sll i;",
          "16776:   int         behavior = 0;",
          "",
          "[Removed Lines]",
          "16773: #line 1092 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 75 ---",
          "[Context before]",
          "16791:   TIMELIB_DEINIT;",
          "16792:   return TIMELIB_WEEK_DAY_OF_MONTH;",
          "16793:  }",
          "16795: yy1127:",
          "16796:  YYDEBUG(1127, *YYCURSOR);",
          "16797:  yyaccept = 26;",
          "",
          "[Removed Lines]",
          "16794: #line 16795 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 76 ---",
          "[Context before]",
          "16899:  }",
          "16900: yy1141:",
          "16901:  YYDEBUG(1141, *YYCURSOR);",
          "16903:  {",
          "16904:   timelib_sll i;",
          "16905:   int         behavior = 0;",
          "",
          "[Removed Lines]",
          "16902: #line 1595 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 77 ---",
          "[Context before]",
          "16922:   TIMELIB_DEINIT;",
          "16923:   return TIMELIB_RELATIVE;",
          "16924:  }",
          "16926: yy1142:",
          "16927:  YYDEBUG(1142, *YYCURSOR);",
          "16928:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "16925: #line 16926 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 78 ---",
          "[Context before]",
          "19599:  goto yy1297;",
          "19600: yy1294:",
          "19601:  YYDEBUG(1294, *YYCURSOR);",
          "19603:  {",
          "19604:   DEBUG_OUTPUT(\"backof | frontof\");",
          "19605:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "19602: #line 1069 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 79 ---",
          "[Context before]",
          "19621:   TIMELIB_DEINIT;",
          "19622:   return TIMELIB_LF_DAY_OF_MONTH;",
          "19623:  }",
          "19625: yy1295:",
          "19626:  YYDEBUG(1295, *YYCURSOR);",
          "19627:  yyaccept = 28;",
          "",
          "[Removed Lines]",
          "19624: #line 19625 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 80 ---",
          "[Context before]",
          "19882:  YYDEBUG(1315, *YYCURSOR);",
          "19883:  ++YYCURSOR;",
          "19884:  YYDEBUG(1316, *YYCURSOR);",
          "19886:  {",
          "19887:   DEBUG_OUTPUT(\"firstdayof | lastdayof\");",
          "19888:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "19885: #line 1052 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 81 ---",
          "[Context before]",
          "19898:   TIMELIB_DEINIT;",
          "19899:   return TIMELIB_LF_DAY_OF_MONTH;",
          "19900:  }",
          "19902: yy1317:",
          "19903:  YYDEBUG(1317, *YYCURSOR);",
          "19904:  yyaccept = 0;",
          "",
          "[Removed Lines]",
          "19901: #line 19902 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 82 ---",
          "[Context before]",
          "21329:  if (yych <= '9') goto yy1385;",
          "21330: yy1387:",
          "21331:  YYDEBUG(1387, *YYCURSOR);",
          "21333:  {",
          "21334:   timelib_ull i;",
          "",
          "[Removed Lines]",
          "21332: #line 1026 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 83 ---",
          "[Context before]",
          "21354:   TIMELIB_DEINIT;",
          "21355:   return TIMELIB_RELATIVE;",
          "21356:  }",
          "21358: yy1388:",
          "21359:  YYDEBUG(1388, *YYCURSOR);",
          "21360:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "21357: #line 21358 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 84 ---",
          "[Context before]",
          "21790:  ++YYCURSOR;",
          "21791: yy1417:",
          "21792:  YYDEBUG(1417, *YYCURSOR);",
          "21794:  {",
          "21795:   DEBUG_OUTPUT(\"tomorrow\");",
          "21796:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "21793: #line 1014 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 85 ---",
          "[Context before]",
          "21801:   TIMELIB_DEINIT;",
          "21802:   return TIMELIB_RELATIVE;",
          "21803:  }",
          "21805: yy1418:",
          "21806:  YYDEBUG(1418, *YYCURSOR);",
          "21807:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "21804: #line 21805 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 86 ---",
          "[Context before]",
          "21836:  }",
          "21837: yy1420:",
          "21838:  YYDEBUG(1420, *YYCURSOR);",
          "21840:  {",
          "21841:   DEBUG_OUTPUT(\"midnight | today\");",
          "21842:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "21839: #line 1004 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 87 ---",
          "[Context before]",
          "21845:   TIMELIB_DEINIT;",
          "21846:   return TIMELIB_RELATIVE;",
          "21847:  }",
          "21849: yy1421:",
          "21850:  YYDEBUG(1421, *YYCURSOR);",
          "21851:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "21848: #line 21849 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 88 ---",
          "[Context before]",
          "23857:  }",
          "23858: yy1500:",
          "23859:  YYDEBUG(1500, *YYCURSOR);",
          "23861:  {",
          "23862:   DEBUG_OUTPUT(\"now\");",
          "23863:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "23860: #line 983 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 89 ---",
          "[Context before]",
          "23865:   TIMELIB_DEINIT;",
          "23866:   return TIMELIB_RELATIVE;",
          "23867:  }",
          "23869: yy1501:",
          "23870:  YYDEBUG(1501, *YYCURSOR);",
          "23871:  yych = *++YYCURSOR;",
          "",
          "[Removed Lines]",
          "23868: #line 23869 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 90 ---",
          "[Context before]",
          "24004:  }",
          "24005: yy1508:",
          "24006:  YYDEBUG(1508, *YYCURSOR);",
          "24008:  {",
          "24009:   DEBUG_OUTPUT(\"noon\");",
          "24010:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "24007: #line 992 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 91 ---",
          "[Context before]",
          "24015:   TIMELIB_DEINIT;",
          "24016:   return TIMELIB_RELATIVE;",
          "24017:  }",
          "24019: yy1509:",
          "24020:  YYDEBUG(1509, *YYCURSOR);",
          "24021:  yyaccept = 0;",
          "",
          "[Removed Lines]",
          "24018: #line 24019 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 92 ---",
          "[Context before]",
          "24548:  ++YYCURSOR;",
          "24549: yy1531:",
          "24550:  YYDEBUG(1531, *YYCURSOR);",
          "24552:  {",
          "24553:   DEBUG_OUTPUT(\"yesterday\");",
          "24554:   TIMELIB_INIT;",
          "",
          "[Removed Lines]",
          "24551: #line 971 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 93 ---",
          "[Context before]",
          "24559:   TIMELIB_DEINIT;",
          "24560:   return TIMELIB_RELATIVE;",
          "24561:  }",
          "24563: yy1532:",
          "24564:  YYDEBUG(1532, *YYCURSOR);",
          "24565:  yyaccept = 0;",
          "",
          "[Removed Lines]",
          "24562: #line 24563 \"ext/date/lib/parse_date.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 94 ---",
          "[Context before]",
          "24732:   goto yy1531;",
          "24733:  }",
          "24734: }",
          "24737: }",
          "",
          "[Removed Lines]",
          "24735: #line 1745 \"ext/date/lib/parse_date.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/pdo/pdo_sql_parser.c||ext/pdo/pdo_sql_parser.c": [
          "File: ext/pdo/pdo_sql_parser.c -> ext/pdo/pdo_sql_parser.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:   +----------------------------------------------------------------------+",
          "5:   | PHP Version 5                                                        |",
          "",
          "[Removed Lines]",
          "2: #line 1 \"ext/pdo/pdo_sql_parser.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "47:  char *cursor = s->cur;",
          "49:  s->tok = cursor;",
          "55: {",
          "56:  YYCTYPE yych;",
          "57:  unsigned int yyaccept = 0;",
          "",
          "[Removed Lines]",
          "50:  #line 55 \"ext/pdo/pdo_sql_parser.re\"",
          "54: #line 55 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "79:  yych = *(YYMARKER = ++YYCURSOR);",
          "80:  if (yych >= 0x01) goto yy43;",
          "81: yy4:",
          "83:  { SKIP_ONE(PDO_PARSER_TEXT); }",
          "85: yy5:",
          "86:  yyaccept = 0;",
          "87:  yych = *(YYMARKER = ++YYCURSOR);",
          "",
          "[Removed Lines]",
          "82: #line 63 \"ext/pdo/pdo_sql_parser.re\"",
          "84: #line 85 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "163:  default: goto yy8;",
          "164:  }",
          "165: yy8:",
          "167:  { RET(PDO_PARSER_BIND_POS); }",
          "169: yy9:",
          "170:  ++YYCURSOR;",
          "171:  switch ((yych = *YYCURSOR)) {",
          "",
          "[Removed Lines]",
          "166: #line 62 \"ext/pdo/pdo_sql_parser.re\"",
          "168: #line 169 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "173:  default: goto yy13;",
          "174:  }",
          "175: yy10:",
          "177:  { RET(PDO_PARSER_TEXT); }",
          "179: yy11:",
          "180:  yych = *++YYCURSOR;",
          "181:  switch (yych) {",
          "",
          "[Removed Lines]",
          "176: #line 65 \"ext/pdo/pdo_sql_parser.re\"",
          "178: #line 179 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "210:  default: goto yy14;",
          "211:  }",
          "212: yy16:",
          "214:  { RET(PDO_PARSER_TEXT); }",
          "216: yy17:",
          "217:  ++YYCURSOR;",
          "218:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "213: #line 64 \"ext/pdo/pdo_sql_parser.re\"",
          "215: #line 216 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "290:  default: goto yy31;",
          "291:  }",
          "292: yy31:",
          "294:  { RET(PDO_PARSER_TEXT); }",
          "296: yy32:",
          "297:  ++YYCURSOR;",
          "298:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "293: #line 60 \"ext/pdo/pdo_sql_parser.re\"",
          "295: #line 296 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "364:  default: goto yy34;",
          "365:  }",
          "366: yy34:",
          "368:  { RET(PDO_PARSER_BIND); }",
          "370: yy35:",
          "371:  ++YYCURSOR;",
          "372:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "367: #line 61 \"ext/pdo/pdo_sql_parser.re\"",
          "369: #line 370 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "394:  goto yy37;",
          "395: yy40:",
          "396:  ++YYCURSOR;",
          "398:  { RET(PDO_PARSER_TEXT); }",
          "400: yy42:",
          "401:  ++YYCURSOR;",
          "402:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "397: #line 59 \"ext/pdo/pdo_sql_parser.re\"",
          "399: #line 400 \"ext/pdo/pdo_sql_parser.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "416:  goto yy42;",
          "417: yy45:",
          "418:  ++YYCURSOR;",
          "420:  { RET(PDO_PARSER_TEXT); }",
          "422: }",
          "425: }",
          "",
          "[Removed Lines]",
          "419: #line 58 \"ext/pdo/pdo_sql_parser.re\"",
          "421: #line 422 \"ext/pdo/pdo_sql_parser.c\"",
          "423: #line 66 \"ext/pdo/pdo_sql_parser.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/url_scanner_ex.c||ext/standard/url_scanner_ex.c": [
          "File: ext/standard/url_scanner_ex.c -> ext/standard/url_scanner_ex.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:   +----------------------------------------------------------------------+",
          "5:   | PHP Version 5                                                        |",
          "",
          "[Removed Lines]",
          "2: #line 1 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "100:  STD_PHP_INI_ENTRY(\"url_rewriter.tags\", \"a=href,area=href,frame=src,form=,fieldset=\", PHP_INI_ALL, OnUpdateTags, url_adapt_state_ex, php_basic_globals, basic_globals)",
          "101: PHP_INI_END()",
          "106: #define YYFILL(n) goto done",
          "",
          "[Removed Lines]",
          "103: #line 107 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "120: scan:",
          "123: {",
          "124:  YYCTYPE yych;",
          "125:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "122: #line 123 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "165:  if (yych <= '9') goto yy6;",
          "166:  if (yych >= ';') goto yy4;",
          "167:  ++YYCURSOR;",
          "169:  { smart_str_append(dest, url); return; }",
          "171: yy4:",
          "172:  ++YYCURSOR;",
          "174:  { sep = separator; goto scan; }",
          "176: yy6:",
          "177:  ++YYCURSOR;",
          "179:  { bash = p - 1; goto done; }",
          "181: yy8:",
          "182:  ++YYCURSOR;",
          "183:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "168: #line 125 \"ext/standard/url_scanner_ex.re\"",
          "170: #line 171 \"ext/standard/url_scanner_ex.c\"",
          "173: #line 126 \"ext/standard/url_scanner_ex.re\"",
          "175: #line 176 \"ext/standard/url_scanner_ex.c\"",
          "178: #line 127 \"ext/standard/url_scanner_ex.re\"",
          "180: #line 181 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "185:  if (yybm[0+yych] & 128) {",
          "186:   goto yy8;",
          "187:  }",
          "189:  { goto scan; }",
          "191: }",
          "194: done:",
          "",
          "[Removed Lines]",
          "188: #line 128 \"ext/standard/url_scanner_ex.re\"",
          "190: #line 191 \"ext/standard/url_scanner_ex.c\"",
          "192: #line 129 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "374: state_plain:",
          "375:  start = YYCURSOR;",
          "378: {",
          "379:  YYCTYPE yych;",
          "380:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "377: #line 378 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "417:   goto yy15;",
          "418:  }",
          "419:  ++YYCURSOR;",
          "421:  { passthru(STD_ARGS); STATE = STATE_TAG; goto state_tag; }",
          "423: yy15:",
          "424:  ++YYCURSOR;",
          "425:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "420: #line 313 \"ext/standard/url_scanner_ex.re\"",
          "422: #line 423 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "427:  if (yybm[0+yych] & 128) {",
          "428:   goto yy15;",
          "429:  }",
          "431:  { passthru(STD_ARGS); goto state_plain; }",
          "433: }",
          "437: state_tag:",
          "438:  start = YYCURSOR;",
          "441: {",
          "442:  YYCTYPE yych;",
          "443:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "430: #line 314 \"ext/standard/url_scanner_ex.re\"",
          "432: #line 433 \"ext/standard/url_scanner_ex.c\"",
          "434: #line 315 \"ext/standard/url_scanner_ex.re\"",
          "440: #line 441 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "488:  yych = *YYCURSOR;",
          "489:  goto yy25;",
          "490: yy21:",
          "492:  { handle_tag(STD_ARGS); /* Sets STATE */; passthru(STD_ARGS); if (STATE == STATE_PLAIN) goto state_plain; else goto state_next_arg; }",
          "494: yy22:",
          "495:  ++YYCURSOR;",
          "497:  { passthru(STD_ARGS); goto state_plain_begin; }",
          "499: yy24:",
          "500:  ++YYCURSOR;",
          "501:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "491: #line 320 \"ext/standard/url_scanner_ex.re\"",
          "493: #line 494 \"ext/standard/url_scanner_ex.c\"",
          "496: #line 321 \"ext/standard/url_scanner_ex.re\"",
          "498: #line 499 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "506:  }",
          "507:  goto yy21;",
          "508: }",
          "512: state_next_arg_begin:",
          "",
          "[Removed Lines]",
          "509: #line 322 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "515: state_next_arg:",
          "516:  start = YYCURSOR;",
          "519: {",
          "520:  YYCTYPE yych;",
          "521:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "518: #line 519 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "580:  ++YYCURSOR;",
          "581:  if ((yych = *YYCURSOR) == '>') goto yy39;",
          "582: yy29:",
          "584:  { passthru(STD_ARGS); goto state_plain_begin; }",
          "586: yy30:",
          "587:  ++YYCURSOR;",
          "588: yy31:",
          "590:  { passthru(STD_ARGS); handle_form(STD_ARGS); goto state_plain_begin; }",
          "592: yy32:",
          "593:  ++YYCURSOR;",
          "594:  yych = *YYCURSOR;",
          "595:  goto yy38;",
          "596: yy33:",
          "598:  { passthru(STD_ARGS); goto state_next_arg; }",
          "600: yy34:",
          "601:  ++YYCURSOR;",
          "603:  { --YYCURSOR; STATE = STATE_ARG; goto state_arg; }",
          "605: yy36:",
          "606:  yych = *++YYCURSOR;",
          "607:  goto yy29;",
          "",
          "[Removed Lines]",
          "583: #line 333 \"ext/standard/url_scanner_ex.re\"",
          "585: #line 586 \"ext/standard/url_scanner_ex.c\"",
          "589: #line 330 \"ext/standard/url_scanner_ex.re\"",
          "591: #line 592 \"ext/standard/url_scanner_ex.c\"",
          "597: #line 331 \"ext/standard/url_scanner_ex.re\"",
          "599: #line 600 \"ext/standard/url_scanner_ex.c\"",
          "602: #line 332 \"ext/standard/url_scanner_ex.re\"",
          "604: #line 605 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "619:  yych = *YYCURSOR;",
          "620:  goto yy31;",
          "621: }",
          "625: state_arg:",
          "626:  start = YYCURSOR;",
          "629: {",
          "630:  YYCTYPE yych;",
          "631:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "622: #line 334 \"ext/standard/url_scanner_ex.re\"",
          "628: #line 629 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "673:  yych = *YYCURSOR;",
          "674:  goto yy47;",
          "675: yy43:",
          "677:  { passthru(STD_ARGS); handle_arg(STD_ARGS); STATE = STATE_BEFORE_VAL; goto state_before_val; }",
          "679: yy44:",
          "680:  ++YYCURSOR;",
          "682:  { passthru(STD_ARGS); STATE = STATE_NEXT_ARG; goto state_next_arg; }",
          "684: yy46:",
          "685:  ++YYCURSOR;",
          "686:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "676: #line 339 \"ext/standard/url_scanner_ex.re\"",
          "678: #line 679 \"ext/standard/url_scanner_ex.c\"",
          "681: #line 340 \"ext/standard/url_scanner_ex.re\"",
          "683: #line 684 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "691:  }",
          "692:  goto yy43;",
          "693: }",
          "697: state_before_val:",
          "698:  start = YYCURSOR;",
          "701: {",
          "702:  YYCTYPE yych;",
          "703:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "694: #line 341 \"ext/standard/url_scanner_ex.re\"",
          "700: #line 701 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "744:  if (yych == ' ') goto yy57;",
          "745:  if (yych == '=') goto yy55;",
          "746: yy51:",
          "748:  { --YYCURSOR; goto state_next_arg_begin; }",
          "750: yy52:",
          "751:  ++YYCURSOR;",
          "752:  yych = *YYCURSOR;",
          "753:  goto yy56;",
          "754: yy53:",
          "756:  { passthru(STD_ARGS); STATE = STATE_VAL; goto state_val; }",
          "758: yy54:",
          "759:  yych = *++YYCURSOR;",
          "760:  goto yy51;",
          "",
          "[Removed Lines]",
          "747: #line 347 \"ext/standard/url_scanner_ex.re\"",
          "749: #line 750 \"ext/standard/url_scanner_ex.c\"",
          "755: #line 346 \"ext/standard/url_scanner_ex.re\"",
          "757: #line 758 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "776:  YYCURSOR = YYMARKER;",
          "777:  goto yy51;",
          "778: }",
          "783: state_val:",
          "784:  start = YYCURSOR;",
          "787: {",
          "788:  YYCTYPE yych;",
          "789:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "779: #line 348 \"ext/standard/url_scanner_ex.re\"",
          "786: #line 787 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "844:  yych = *(YYMARKER = ++YYCURSOR);",
          "845:  if (yych != '>') goto yy76;",
          "846: yy63:",
          "848:  { passthru(STD_ARGS); goto state_next_arg_begin; }",
          "850: yy64:",
          "851:  yych = *(YYMARKER = ++YYCURSOR);",
          "852:  if (yych == '>') goto yy63;",
          "",
          "[Removed Lines]",
          "847: #line 357 \"ext/standard/url_scanner_ex.re\"",
          "849: #line 850 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "856:  yych = *YYCURSOR;",
          "857:  goto yy69;",
          "858: yy66:",
          "860:  { handle_val(STD_ARGS, 0, ' '); goto state_next_arg_begin; }",
          "862: yy67:",
          "863:  yych = *++YYCURSOR;",
          "864:  goto yy63;",
          "",
          "[Removed Lines]",
          "859: #line 356 \"ext/standard/url_scanner_ex.re\"",
          "861: #line 862 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "885:  goto yy63;",
          "886: yy73:",
          "887:  ++YYCURSOR;",
          "889:  { handle_val(STD_ARGS, 1, '\\''); goto state_next_arg_begin; }",
          "891: yy75:",
          "892:  ++YYCURSOR;",
          "893:  if (YYLIMIT <= YYCURSOR) YYFILL(1);",
          "",
          "[Removed Lines]",
          "888: #line 355 \"ext/standard/url_scanner_ex.re\"",
          "890: #line 891 \"ext/standard/url_scanner_ex.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "898:  }",
          "899:  if (yych >= '>') goto yy72;",
          "900:  ++YYCURSOR;",
          "902:  { handle_val(STD_ARGS, 1, '\"'); goto state_next_arg_begin; }",
          "904: }",
          "908: stop:",
          "",
          "[Removed Lines]",
          "901: #line 354 \"ext/standard/url_scanner_ex.re\"",
          "903: #line 904 \"ext/standard/url_scanner_ex.c\"",
          "905: #line 358 \"ext/standard/url_scanner_ex.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:   +----------------------------------------------------------------------+",
          "5:   | PHP Version 5                                                        |",
          "",
          "[Removed Lines]",
          "2: #line 1 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "233: #define YYMARKER marker",
          "",
          "[Removed Lines]",
          "236: #line 241 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "481:  start = cursor;",
          "485: {",
          "486:  YYCTYPE yych;",
          "487:  static const unsigned char yybm[] = {",
          "",
          "[Removed Lines]",
          "484: #line 485 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "541:  yych = *(YYMARKER = ++YYCURSOR);",
          "542:  if (yych == ':') goto yy95;",
          "543: yy3:",
          "545:  { return 0; }",
          "547: yy4:",
          "548:  yych = *(YYMARKER = ++YYCURSOR);",
          "549:  if (yych == ':') goto yy89;",
          "",
          "[Removed Lines]",
          "544: #line 826 \"ext/standard/var_unserializer.re\"",
          "546: #line 547 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "586:  goto yy3;",
          "587: yy14:",
          "588:  ++YYCURSOR;",
          "590:  {",
          "592:  php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"Unexpected end of serialized data\");",
          "594: }",
          "596: yy16:",
          "597:  yych = *++YYCURSOR;",
          "598:  goto yy3;",
          "",
          "[Removed Lines]",
          "589: #line 820 \"ext/standard/var_unserializer.re\"",
          "595: #line 596 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "622:  yych = *++YYCURSOR;",
          "623:  if (yych != '\"') goto yy18;",
          "624:  ++YYCURSOR;",
          "626:  {",
          "627:  size_t len, len2, len3, maxlen;",
          "628:  php_int_t elements;",
          "",
          "[Removed Lines]",
          "625: #line 681 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "762:  return object_common2(UNSERIALIZE_PASSTHRU, elements);",
          "763: }",
          "765: yy25:",
          "766:  yych = *++YYCURSOR;",
          "767:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "764: #line 765 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "786:  yych = *++YYCURSOR;",
          "787:  if (yych != '\"') goto yy18;",
          "788:  ++YYCURSOR;",
          "790:  {",
          "",
          "[Removed Lines]",
          "789: #line 673 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "794:  return object_common2(UNSERIALIZE_PASSTHRU,",
          "795:    object_common1(UNSERIALIZE_PASSTHRU, ZEND_STANDARD_CLASS_DEF_PTR));",
          "796: }",
          "798: yy32:",
          "799:  yych = *++YYCURSOR;",
          "800:  if (yych == '+') goto yy33;",
          "",
          "[Removed Lines]",
          "797: #line 798 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "815:  yych = *++YYCURSOR;",
          "816:  if (yych != '{') goto yy18;",
          "817:  ++YYCURSOR;",
          "819:  {",
          "820:  php_int_t elements = parse_iv(start + 2);",
          "",
          "[Removed Lines]",
          "818: #line 652 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "837:  return finish_nested_data(UNSERIALIZE_PASSTHRU);",
          "838: }",
          "840: yy39:",
          "841:  yych = *++YYCURSOR;",
          "842:  if (yych == '+') goto yy40;",
          "",
          "[Removed Lines]",
          "839: #line 840 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "857:  yych = *++YYCURSOR;",
          "858:  if (yych != '\"') goto yy18;",
          "859:  ++YYCURSOR;",
          "861:  {",
          "862:  size_t len, maxlen;",
          "863:  zend_string *str;",
          "",
          "[Removed Lines]",
          "860: #line 624 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 13 ---",
          "[Context before]",
          "885:  ZVAL_STR(rval, str);",
          "886:  return 1;",
          "887: }",
          "889: yy46:",
          "890:  yych = *++YYCURSOR;",
          "891:  if (yych == '+') goto yy47;",
          "",
          "[Removed Lines]",
          "888: #line 889 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 14 ---",
          "[Context before]",
          "906:  yych = *++YYCURSOR;",
          "907:  if (yych != '\"') goto yy18;",
          "908:  ++YYCURSOR;",
          "910:  {",
          "911:  size_t len, maxlen;",
          "912:  char *str;",
          "",
          "[Removed Lines]",
          "909: #line 597 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 15 ---",
          "[Context before]",
          "933:  ZVAL_STRINGL(rval, str, len);",
          "934:  return 1;",
          "935: }",
          "937: yy53:",
          "938:  yych = *++YYCURSOR;",
          "939:  if (yych <= '/') {",
          "",
          "[Removed Lines]",
          "936: #line 937 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 16 ---",
          "[Context before]",
          "1021:  }",
          "1022: yy63:",
          "1023:  ++YYCURSOR;",
          "1025:  {",
          "1026: #if SIZEOF_ZEND_INT == 4",
          "1027: use_double:",
          "",
          "[Removed Lines]",
          "1024: #line 588 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 17 ---",
          "[Context before]",
          "1030:  ZVAL_DOUBLE(rval, zend_strtod((const char *)start + 2, NULL));",
          "1031:  return 1;",
          "1032: }",
          "1034: yy65:",
          "1035:  yych = *++YYCURSOR;",
          "1036:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1033: #line 1034 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 18 ---",
          "[Context before]",
          "1089:  yych = *++YYCURSOR;",
          "1090:  if (yych != ';') goto yy18;",
          "1091:  ++YYCURSOR;",
          "1093:  {",
          "",
          "[Removed Lines]",
          "1092: #line 572 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 19 ---",
          "[Context before]",
          "1106:  return 1;",
          "1107: }",
          "1109: yy76:",
          "1110:  yych = *++YYCURSOR;",
          "1111:  if (yych == 'N') goto yy73;",
          "",
          "[Removed Lines]",
          "1108: #line 1109 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 20 ---",
          "[Context before]",
          "1132:  if (yych <= '9') goto yy79;",
          "1133:  if (yych != ';') goto yy18;",
          "1134:  ++YYCURSOR;",
          "1136:  {",
          "1137: #if SIZEOF_ZEND_INT == 4",
          "1138:  int digits = YYCURSOR - start - 3;",
          "",
          "[Removed Lines]",
          "1135: #line 546 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 21 ---",
          "[Context before]",
          "1158:  ZVAL_INT(rval, parse_iv(start + 2));",
          "1159:  return 1;",
          "1160: }",
          "1162: yy83:",
          "1163:  yych = *++YYCURSOR;",
          "1164:  if (yych <= '/') goto yy18;",
          "",
          "[Removed Lines]",
          "1161: #line 1162 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 22 ---",
          "[Context before]",
          "1166:  yych = *++YYCURSOR;",
          "1167:  if (yych != ';') goto yy18;",
          "1168:  ++YYCURSOR;",
          "1170:  {",
          "1172:  ZVAL_BOOL(rval, parse_iv(start + 2));",
          "1173:  return 1;",
          "1174: }",
          "1176: yy87:",
          "1177:  ++YYCURSOR;",
          "1179:  {",
          "1181:  ZVAL_NULL(rval);",
          "1182:  return 1;",
          "1183: }",
          "1185: yy89:",
          "1186:  yych = *++YYCURSOR;",
          "1187:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1169: #line 540 \"ext/standard/var_unserializer.re\"",
          "1175: #line 1176 \"ext/standard/var_unserializer.c\"",
          "1178: #line 534 \"ext/standard/var_unserializer.re\"",
          "1184: #line 1185 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 23 ---",
          "[Context before]",
          "1204:  if (yych <= '9') goto yy91;",
          "1205:  if (yych != ';') goto yy18;",
          "1206:  ++YYCURSOR;",
          "1208:  {",
          "1209:  php_int_t id;",
          "",
          "[Removed Lines]",
          "1207: #line 511 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 24 ---",
          "[Context before]",
          "1228:  return 1;",
          "1229: }",
          "1231: yy95:",
          "1232:  yych = *++YYCURSOR;",
          "1233:  if (yych <= ',') {",
          "",
          "[Removed Lines]",
          "1230: #line 1231 \"ext/standard/var_unserializer.c\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 25 ---",
          "[Context before]",
          "1250:  if (yych <= '9') goto yy97;",
          "1251:  if (yych != ';') goto yy18;",
          "1252:  ++YYCURSOR;",
          "1254:  {",
          "1255:  php_int_t id;",
          "",
          "[Removed Lines]",
          "1253: #line 489 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 26 ---",
          "[Context before]",
          "1273:  return 1;",
          "1274: }",
          "1276: }",
          "1280:  return 0;",
          "",
          "[Removed Lines]",
          "1275: #line 1276 \"ext/standard/var_unserializer.c\"",
          "1277: #line 828 \"ext/standard/var_unserializer.re\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "sapi/cli/php_cli.c||sapi/cli/php_cli.c": [
          "File: sapi/cli/php_cli.c -> sapi/cli/php_cli.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "252:  return ret != -1;",
          "253: }",
          "256: {",
          "257: #ifdef PHP_WRITE_STDOUT",
          "259: #else",
          "260:  php_size_t ret;",
          "261: #endif",
          "",
          "[Removed Lines]",
          "258:  long ret;",
          "",
          "[Added Lines]",
          "258:  php_int_t ret;",
          "",
          "---------------"
        ]
      }
    }
  ]
}