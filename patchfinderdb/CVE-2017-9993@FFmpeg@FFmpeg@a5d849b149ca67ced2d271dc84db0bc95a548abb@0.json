{
  "cve_id": "CVE-2017-9993",
  "cve_desc": "FFmpeg before 2.8.12, 3.0.x and 3.1.x before 3.1.9, 3.2.x before 3.2.6, and 3.3.x before 3.3.2 does not properly restrict HTTP Live Streaming filename extensions and demuxer names, which allows attackers to read arbitrary files via crafted playlist data.",
  "repo": "FFmpeg/FFmpeg",
  "patch_hash": "a5d849b149ca67ced2d271dc84db0bc95a548abb",
  "patch_info": {
    "commit_hash": "a5d849b149ca67ced2d271dc84db0bc95a548abb",
    "repo": "FFmpeg/FFmpeg",
    "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/a5d849b149ca67ced2d271dc84db0bc95a548abb",
    "files": [
      "libavformat/avidec.c"
    ],
    "message": "avformat/avidec: Limit formats in gab2 to srt and ass/ssa\n\nThis prevents part of one exploit leading to an information leak\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "before_after_code_files": [
      "libavformat/avidec.c||libavformat/avidec.c"
    ]
  },
  "patch_diff": {
    "libavformat/avidec.c||libavformat/avidec.c": [
      "File: libavformat/avidec.c -> libavformat/avidec.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1099:         if (!sub_demuxer)",
      "1100:             goto error;",
      "1102:         if (!(ast->sub_ctx = avformat_alloc_context()))",
      "1103:             goto error;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1102:         if (strcmp(sub_demuxer->name, \"srt\") && strcmp(sub_demuxer->name, \"ass\"))",
      "1103:             goto error;",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "bb7df22328731af64129469e6bcfa1fe6241c6ad",
      "candidate_info": {
        "commit_hash": "bb7df22328731af64129469e6bcfa1fe6241c6ad",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/bb7df22328731af64129469e6bcfa1fe6241c6ad",
        "files": [
          "libavformat/avidec.c"
        ],
        "message": "avformat/avidec: Limit formats in gab2 to srt and ass/ssa\n\nThis prevents part of one exploit leading to an information leak\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a5d849b149ca67ced2d271dc84db0bc95a548abb)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/avidec.c||libavformat/avidec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ],
          "candidate": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/avidec.c||libavformat/avidec.c": [
          "File: libavformat/avidec.c -> libavformat/avidec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1081:         if (!sub_demuxer)",
          "1082:             goto error;",
          "1084:         if (!(ast->sub_ctx = avformat_alloc_context()))",
          "1085:             goto error;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1084:         if (strcmp(sub_demuxer->name, \"srt\") && strcmp(sub_demuxer->name, \"ass\"))",
          "1085:             goto error;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "39c729c375a67eb87d420e2079a003af6f0c7bf2",
      "candidate_info": {
        "commit_hash": "39c729c375a67eb87d420e2079a003af6f0c7bf2",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/39c729c375a67eb87d420e2079a003af6f0c7bf2",
        "files": [
          "libavformat/avidec.c"
        ],
        "message": "avformat/avidec: Limit formats in gab2 to srt and ass/ssa\n\nThis prevents part of one exploit leading to an information leak\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a5d849b149ca67ced2d271dc84db0bc95a548abb)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/avidec.c||libavformat/avidec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ],
          "candidate": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/avidec.c||libavformat/avidec.c": [
          "File: libavformat/avidec.c -> libavformat/avidec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1088:         if (!sub_demuxer)",
          "1089:             goto error;",
          "1091:         if (!(ast->sub_ctx = avformat_alloc_context()))",
          "1092:             goto error;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1091:         if (strcmp(sub_demuxer->name, \"srt\") && strcmp(sub_demuxer->name, \"ass\"))",
          "1092:             goto error;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5415c88e370692a3cf10b998ab230b4a02fc237f",
      "candidate_info": {
        "commit_hash": "5415c88e370692a3cf10b998ab230b4a02fc237f",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/5415c88e370692a3cf10b998ab230b4a02fc237f",
        "files": [
          "libavformat/avidec.c"
        ],
        "message": "avformat/avidec: Limit formats in gab2 to srt and ass/ssa\n\nThis prevents part of one exploit leading to an information leak\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a5d849b149ca67ced2d271dc84db0bc95a548abb)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/avidec.c||libavformat/avidec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ],
          "candidate": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/avidec.c||libavformat/avidec.c": [
          "File: libavformat/avidec.c -> libavformat/avidec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1098:         if (!sub_demuxer)",
          "1099:             goto error;",
          "1101:         if (!(ast->sub_ctx = avformat_alloc_context()))",
          "1102:             goto error;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1101:         if (strcmp(sub_demuxer->name, \"srt\") && strcmp(sub_demuxer->name, \"ass\"))",
          "1102:             goto error;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "794bcc6eca21a4ac64a282a4150036426e641f7b",
      "candidate_info": {
        "commit_hash": "794bcc6eca21a4ac64a282a4150036426e641f7b",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/794bcc6eca21a4ac64a282a4150036426e641f7b",
        "files": [
          "libavformat/avidec.c"
        ],
        "message": "avformat/avidec: Limit formats in gab2 to srt and ass/ssa\n\nThis prevents part of one exploit leading to an information leak\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a5d849b149ca67ced2d271dc84db0bc95a548abb)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/avidec.c||libavformat/avidec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ],
          "candidate": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/avidec.c||libavformat/avidec.c": [
          "File: libavformat/avidec.c -> libavformat/avidec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1085:         if (!sub_demuxer)",
          "1086:             goto error;",
          "1088:         if (!(ast->sub_ctx = avformat_alloc_context()))",
          "1089:             goto error;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1088:         if (strcmp(sub_demuxer->name, \"srt\") && strcmp(sub_demuxer->name, \"ass\"))",
          "1089:             goto error;",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1998147f2ebcb0eff33438339b2051d159edb688",
      "candidate_info": {
        "commit_hash": "1998147f2ebcb0eff33438339b2051d159edb688",
        "repo": "FFmpeg/FFmpeg",
        "commit_url": "https://github.com/FFmpeg/FFmpeg/commit/1998147f2ebcb0eff33438339b2051d159edb688",
        "files": [
          "libavformat/avidec.c"
        ],
        "message": "avformat/avidec: Limit formats in gab2 to srt and ass/ssa\n\nThis prevents part of one exploit leading to an information leak\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit a5d849b149ca67ced2d271dc84db0bc95a548abb)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
        "before_after_code_files": [
          "libavformat/avidec.c||libavformat/avidec.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_cherry_pick": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ],
          "candidate": [
            "libavformat/avidec.c||libavformat/avidec.c"
          ]
        }
      },
      "candidate_diff": {
        "libavformat/avidec.c||libavformat/avidec.c": [
          "File: libavformat/avidec.c -> libavformat/avidec.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1098:         if (!sub_demuxer)",
          "1099:             goto error;",
          "1101:         if (!(ast->sub_ctx = avformat_alloc_context()))",
          "1102:             goto error;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1101:         if (strcmp(sub_demuxer->name, \"srt\") && strcmp(sub_demuxer->name, \"ass\"))",
          "1102:             goto error;",
          "",
          "---------------"
        ]
      }
    }
  ]
}