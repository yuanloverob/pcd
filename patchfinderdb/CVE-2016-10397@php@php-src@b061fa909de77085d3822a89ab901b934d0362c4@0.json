{
  "cve_id": "CVE-2016-10397",
  "cve_desc": "In PHP before 5.6.28 and 7.x before 7.0.13, incorrect handling of various URI components in the URL parser could be used by attackers to bypass hostname-specific URL checks, as demonstrated by evil.example.com:80#@good.example.com/ and evil.example.com:80?@good.example.com/ inputs to the parse_url function (implemented in the php_url_parse_ex function in ext/standard/url.c).",
  "repo": "php/php-src",
  "patch_hash": "b061fa909de77085d3822a89ab901b934d0362c4",
  "patch_info": {
    "commit_hash": "b061fa909de77085d3822a89ab901b934d0362c4",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/b061fa909de77085d3822a89ab901b934d0362c4",
    "files": [
      "ext/standard/tests/url/bug73192.phpt",
      "ext/standard/tests/url/parse_url_basic_001.phpt",
      "ext/standard/tests/url/parse_url_basic_002.phpt",
      "ext/standard/tests/url/parse_url_basic_003.phpt",
      "ext/standard/tests/url/parse_url_basic_004.phpt",
      "ext/standard/tests/url/parse_url_basic_005.phpt",
      "ext/standard/tests/url/parse_url_basic_006.phpt",
      "ext/standard/tests/url/parse_url_basic_007.phpt",
      "ext/standard/tests/url/parse_url_basic_008.phpt",
      "ext/standard/tests/url/parse_url_basic_009.phpt",
      "ext/standard/url.c"
    ],
    "message": "Fix bug #73192",
    "before_after_code_files": [
      "ext/standard/tests/url/bug73192.phpt||ext/standard/tests/url/bug73192.phpt",
      "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt",
      "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt",
      "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt",
      "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt",
      "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt",
      "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt",
      "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt",
      "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt",
      "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt",
      "ext/standard/url.c||ext/standard/url.c"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/url/bug73192.phpt||ext/standard/tests/url/bug73192.phpt": [
      "File: ext/standard/tests/url/bug73192.phpt -> ext/standard/tests/url/bug73192.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #73192: parse_url return wrong hostname",
      "3: --FILE--",
      "4: <?php",
      "6: var_dump(parse_url(\"http://example.com:80#@google.com/\"));",
      "7: var_dump(parse_url(\"http://example.com:80?@google.com/\"));",
      "9: ?>",
      "10: --EXPECT--",
      "11: array(4) {",
      "12:   [\"scheme\"]=>",
      "13:   string(4) \"http\"",
      "14:   [\"host\"]=>",
      "15:   string(11) \"example.com\"",
      "16:   [\"port\"]=>",
      "17:   int(80)",
      "18:   [\"fragment\"]=>",
      "19:   string(12) \"@google.com/\"",
      "20: }",
      "21: array(4) {",
      "22:   [\"scheme\"]=>",
      "23:   string(4) \"http\"",
      "24:   [\"host\"]=>",
      "25:   string(11) \"example.com\"",
      "26:   [\"port\"]=>",
      "27:   int(80)",
      "28:   [\"query\"]=>",
      "29:   string(12) \"@google.com/\"",
      "30: }",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_001.phpt -> ext/standard/tests/url/parse_url_basic_001.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "763:   int(6)",
      "764: }",
      "786: --> file:///:: array(2) {",
      "787:   [\"scheme\"]=>",
      "",
      "[Removed Lines]",
      "766: --> http://?:/: array(3) {",
      "767:   [\"scheme\"]=>",
      "768:   string(4) \"http\"",
      "769:   [\"host\"]=>",
      "770:   string(1) \"?\"",
      "771:   [\"path\"]=>",
      "772:   string(1) \"/\"",
      "773: }",
      "775: --> http://@?:/: array(4) {",
      "776:   [\"scheme\"]=>",
      "777:   string(4) \"http\"",
      "778:   [\"host\"]=>",
      "779:   string(1) \"?\"",
      "780:   [\"user\"]=>",
      "781:   string(0) \"\"",
      "782:   [\"path\"]=>",
      "783:   string(1) \"/\"",
      "784: }",
      "",
      "[Added Lines]",
      "766: --> http://?:/: bool(false)",
      "768: --> http://@?:/: bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_002.phpt -> ext/standard/tests/url/parse_url_basic_002.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "98: --> http://::?   : string(4) \"http\"",
      "99: --> http://::#   : string(4) \"http\"",
      "100: --> x://::6.5   : string(1) \"x\"",
      "103: --> file:///:   : string(4) \"file\"",
      "104: --> file:///a:/   : string(4) \"file\"",
      "105: --> file:///ab:/   : string(4) \"file\"",
      "",
      "[Removed Lines]",
      "101: --> http://?:/   : string(4) \"http\"",
      "102: --> http://@?:/   : string(4) \"http\"",
      "",
      "[Added Lines]",
      "101: --> http://?:/   : bool(false)",
      "102: --> http://@?:/   : bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_003.phpt -> ext/standard/tests/url/parse_url_basic_003.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "97: --> http://::?   : string(1) \":\"",
      "98: --> http://::#   : string(1) \":\"",
      "99: --> x://::6.5   : string(1) \":\"",
      "102: --> file:///:   : NULL",
      "103: --> file:///a:/   : NULL",
      "104: --> file:///ab:/   : NULL",
      "",
      "[Removed Lines]",
      "100: --> http://?:/   : string(1) \"?\"",
      "101: --> http://@?:/   : string(1) \"?\"",
      "",
      "[Added Lines]",
      "100: --> http://?:/   : bool(false)",
      "101: --> http://@?:/   : bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_004.phpt -> ext/standard/tests/url/parse_url_basic_004.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "97: --> http://::?   : NULL",
      "98: --> http://::#   : NULL",
      "99: --> x://::6.5   : int(6)",
      "102: --> file:///:   : NULL",
      "103: --> file:///a:/   : NULL",
      "104: --> file:///ab:/   : NULL",
      "",
      "[Removed Lines]",
      "100: --> http://?:/   : NULL",
      "101: --> http://@?:/   : NULL",
      "",
      "[Added Lines]",
      "100: --> http://?:/   : bool(false)",
      "101: --> http://@?:/   : bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_005.phpt -> ext/standard/tests/url/parse_url_basic_005.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "97: --> http://::?   : NULL",
      "98: --> http://::#   : NULL",
      "99: --> x://::6.5   : NULL",
      "102: --> file:///:   : NULL",
      "103: --> file:///a:/   : NULL",
      "104: --> file:///ab:/   : NULL",
      "",
      "[Removed Lines]",
      "100: --> http://?:/   : NULL",
      "101: --> http://@?:/   : string(0) \"\"",
      "",
      "[Added Lines]",
      "100: --> http://?:/   : bool(false)",
      "101: --> http://@?:/   : bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_006.phpt -> ext/standard/tests/url/parse_url_basic_006.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "97: --> http://::?   : NULL",
      "98: --> http://::#   : NULL",
      "99: --> x://::6.5   : NULL",
      "102: --> file:///:   : NULL",
      "103: --> file:///a:/   : NULL",
      "104: --> file:///ab:/   : NULL",
      "",
      "[Removed Lines]",
      "100: --> http://?:/   : NULL",
      "101: --> http://@?:/   : NULL",
      "",
      "[Added Lines]",
      "100: --> http://?:/   : bool(false)",
      "101: --> http://@?:/   : bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_007.phpt -> ext/standard/tests/url/parse_url_basic_007.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "97: --> http://::?   : NULL",
      "98: --> http://::#   : NULL",
      "99: --> x://::6.5   : NULL",
      "102: --> file:///:   : string(2) \"/:\"",
      "103: --> file:///a:/   : string(3) \"a:/\"",
      "104: --> file:///ab:/   : string(5) \"/ab:/\"",
      "",
      "[Removed Lines]",
      "100: --> http://?:/   : string(1) \"/\"",
      "101: --> http://@?:/   : string(1) \"/\"",
      "",
      "[Added Lines]",
      "100: --> http://?:/   : bool(false)",
      "101: --> http://@?:/   : bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_008.phpt -> ext/standard/tests/url/parse_url_basic_008.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "97: --> http://::?   : NULL",
      "98: --> http://::#   : NULL",
      "99: --> x://::6.5   : NULL",
      "102: --> file:///:   : NULL",
      "103: --> file:///a:/   : NULL",
      "104: --> file:///ab:/   : NULL",
      "",
      "[Removed Lines]",
      "100: --> http://?:/   : NULL",
      "101: --> http://@?:/   : NULL",
      "",
      "[Added Lines]",
      "100: --> http://?:/   : bool(false)",
      "101: --> http://@?:/   : bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt": [
      "File: ext/standard/tests/url/parse_url_basic_009.phpt -> ext/standard/tests/url/parse_url_basic_009.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "97: --> http://::?   : NULL",
      "98: --> http://::#   : NULL",
      "99: --> x://::6.5   : NULL",
      "102: --> file:///:   : NULL",
      "103: --> file:///a:/   : NULL",
      "104: --> file:///ab:/   : NULL",
      "",
      "[Removed Lines]",
      "100: --> http://?:/   : NULL",
      "101: --> http://@?:/   : NULL",
      "",
      "[Added Lines]",
      "100: --> http://?:/   : bool(false)",
      "101: --> http://@?:/   : bool(false)",
      "",
      "---------------"
    ],
    "ext/standard/url.c||ext/standard/url.c": [
      "File: ext/standard/url.c -> ext/standard/url.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "217:   goto nohost;",
      "218:  }",
      "244:  if ((p = zend_memrchr(s, '@', (e-s)))) {",
      "",
      "[Removed Lines]",
      "220:  e = ue;",
      "222:  if (!(p = memchr(s, '/', (ue - s)))) {",
      "223:   char *query, *fragment;",
      "225:   query = memchr(s, '?', (ue - s));",
      "226:   fragment = memchr(s, '#', (ue - s));",
      "228:   if (query && fragment) {",
      "229:    if (query > fragment) {",
      "230:     e = fragment;",
      "231:    } else {",
      "232:     e = query;",
      "233:    }",
      "234:   } else if (query) {",
      "235:    e = query;",
      "236:   } else if (fragment) {",
      "237:    e = fragment;",
      "238:   }",
      "239:  } else {",
      "240:   e = p;",
      "241:  }",
      "",
      "[Added Lines]",
      "220:  e = s + strcspn(s, \"/?#\");",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "2d19c92fc2f14aa97db9094eaa0b67d1c3b12409",
      "candidate_info": {
        "commit_hash": "2d19c92fc2f14aa97db9094eaa0b67d1c3b12409",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/2d19c92fc2f14aa97db9094eaa0b67d1c3b12409",
        "files": [
          "ext/standard/url.c"
        ],
        "message": "Make php_url_parse_ex() respect length argument\n\nThis should fix all out-of-bounds reads that could previously\noccur if the string passed to php_url_parse_ex() is not NUL\nterminated.",
        "before_after_code_files": [
          "ext/standard/url.c||ext/standard/url.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/url.c||ext/standard/url.c"
          ],
          "candidate": [
            "ext/standard/url.c||ext/standard/url.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/url.c||ext/standard/url.c": [
          "File: ext/standard/url.c -> ext/standard/url.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "104:  ue = s + length;",
          "109:   p = s;",
          "110:   while (p < e) {",
          "",
          "[Removed Lines]",
          "107:  if ((e = memchr(s, ':', length)) && (e - s)) {",
          "",
          "[Added Lines]",
          "107:  if ((e = memchr(s, ':', length)) && e != s) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "136:    p = e + 1;",
          "138:     p++;",
          "139:    }",
          "142:     goto parse_port;",
          "143:    }",
          "",
          "[Removed Lines]",
          "137:    while (isdigit(*p)) {",
          "141:    if ((*p == '\\0' || *p == '/') && (p - e) < 7) {",
          "",
          "[Added Lines]",
          "137:    while (p < ue && isdigit(*p)) {",
          "141:    if ((p == ue || *p == '/') && (p - e) < 7) {",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "151:    ret->scheme = estrndup(s, (e-s));",
          "152:    php_replace_controlchars_ex(ret->scheme, (e - s));",
          "155:     s = e + 3;",
          "156:     if (!strncasecmp(\"file\", ret->scheme, sizeof(\"file\"))) {",
          "159:          file:///c:/somedir/file.txt",
          "162:        s = e + 4;",
          "163:       }",
          "164:       goto just_path;",
          "",
          "[Removed Lines]",
          "154:    if (*(e+2) == '/') {",
          "157:      if (*(e + 3) == '/') {",
          "161:       if (*(e + 5) == ':') {",
          "",
          "[Added Lines]",
          "154:    if (e + 2 < ue && *(e + 2) == '/') {",
          "157:      if (e + 3 < ue && *(e + 3) == '/') {",
          "161:       if (e + 5 < ue && *(e + 5) == ':') {",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "174:   p = e + 1;",
          "175:   pp = p;",
          "178:    pp++;",
          "179:   }",
          "182:    long port;",
          "183:    memcpy(port_buf, p, (pp - p));",
          "184:    port_buf[pp - p] = '\\0';",
          "185:    port = strtol(port_buf, NULL, 10);",
          "186:    if (port > 0 && port <= 65535) {",
          "187:     ret->port = (unsigned short) port;",
          "189:         s += 2;",
          "190:     }",
          "191:    } else {",
          "",
          "[Removed Lines]",
          "177:   while (pp-p < 6 && isdigit(*pp)) {",
          "181:   if (pp - p > 0 && pp - p < 6 && (*pp == '/' || *pp == '\\0')) {",
          "",
          "[Added Lines]",
          "177:   while (pp < ue && pp - p < 6 && isdigit(*pp)) {",
          "181:   if (pp - p > 0 && pp - p < 6 && (pp == ue || *pp == '/')) {",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "193:     efree(ret);",
          "194:     return NULL;",
          "195:    }",
          "197:    STR_FREE(ret->scheme);",
          "198:    efree(ret);",
          "199:    return NULL;",
          "201:    s += 2;",
          "202:   } else {",
          "203:    goto just_path;",
          "204:   }",
          "206:   s += 2;",
          "207:  } else {",
          "208:   goto just_path;",
          "209:  }",
          "214:  if ((p = zend_memrchr(s, '@', (e-s)))) {",
          "",
          "[Removed Lines]",
          "196:   } else if (p == pp && *pp == '\\0') {",
          "211:  e = s + strcspn(s, \"/?#\");",
          "",
          "[Added Lines]",
          "196:   } else if (p == pp && pp == ue) {",
          "212:  e = ue;",
          "213:  if ((p = memchr(s, '/', e - s))) {",
          "214:   e = p;",
          "215:  }",
          "216:  if ((p = memchr(s, '?', e - s))) {",
          "217:   e = p;",
          "218:  }",
          "219:  if ((p = memchr(s, '#', e - s))) {",
          "220:   e = p;",
          "221:  }",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "228:  }",
          "233:      we're dealing with an",
          "236:  } else {",
          "240:  }",
          "243:   if (!ret->port) {",
          "244:    p++;",
          "",
          "[Removed Lines]",
          "231:  if (*s == '[' && *(e-1) == ']') {",
          "235:   p = s;",
          "239:   for(p = e; p >= s && *p != ':'; p--);",
          "242:  if (p >= s && *p == ':') {",
          "",
          "[Added Lines]",
          "241:  if (s < ue && *s == '[' && *(e-1) == ']') {",
          "245:   p = NULL;",
          "247:   p = zend_memrchr(s, ':', (e-s));",
          "250:  if (p) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "085dfca02b64588317a233eb191d07a75511fff2",
      "candidate_info": {
        "commit_hash": "085dfca02b64588317a233eb191d07a75511fff2",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/085dfca02b64588317a233eb191d07a75511fff2",
        "files": [
          "ext/standard/tests/url/parse_url_basic_001.phpt",
          "ext/standard/tests/url/parse_url_basic_002.phpt",
          "ext/standard/tests/url/parse_url_basic_003.phpt",
          "ext/standard/tests/url/parse_url_basic_004.phpt",
          "ext/standard/tests/url/parse_url_basic_005.phpt",
          "ext/standard/tests/url/parse_url_basic_006.phpt",
          "ext/standard/tests/url/parse_url_basic_007.phpt",
          "ext/standard/tests/url/parse_url_basic_008.phpt",
          "ext/standard/tests/url/parse_url_basic_009.phpt",
          "ext/standard/tests/url/urls.inc",
          "ext/standard/url.c"
        ],
        "message": "Added validation to parse_url() to prohibit restricted characters inside login/pass components based on RFC3986",
        "before_after_code_files": [
          "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt",
          "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt",
          "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt",
          "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt",
          "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt",
          "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt",
          "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt",
          "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt",
          "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt",
          "ext/standard/tests/url/urls.inc||ext/standard/tests/url/urls.inc",
          "ext/standard/url.c||ext/standard/url.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt",
            "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt",
            "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt",
            "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt",
            "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt",
            "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt",
            "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt",
            "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt",
            "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt",
            "ext/standard/url.c||ext/standard/url.c"
          ],
          "candidate": [
            "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt",
            "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt",
            "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt",
            "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt",
            "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt",
            "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt",
            "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt",
            "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt",
            "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt",
            "ext/standard/url.c||ext/standard/url.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_001.phpt -> ext/standard/tests/url/parse_url_basic_001.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "507:   string(16) \"some_page_ref123\"",
          "508: }",
          "527: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123: array(8) {",
          "528:   [\"scheme\"]=>",
          "529:   string(4) \"http\"",
          "",
          "[Removed Lines]",
          "510: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123: array(7) {",
          "511:   [\"scheme\"]=>",
          "512:   string(4) \"http\"",
          "513:   [\"host\"]=>",
          "514:   string(11) \"www.php.net\"",
          "515:   [\"port\"]=>",
          "516:   int(80)",
          "517:   [\"user\"]=>",
          "518:   string(14) \"secret@hideout\"",
          "519:   [\"path\"]=>",
          "520:   string(10) \"/index.php\"",
          "521:   [\"query\"]=>",
          "522:   string(31) \"test=1&test2=char&test3=mixesCI\"",
          "523:   [\"fragment\"]=>",
          "524:   string(16) \"some_page_ref123\"",
          "525: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "691:   string(7) \"9130731\"",
          "692: }",
          "711: --> http://10.10.10.10/:80: array(3) {",
          "712:   [\"scheme\"]=>",
          "713:   string(4) \"http\"",
          "",
          "[Removed Lines]",
          "694: --> http://user:@pass@host/path?argument?value#etc: array(7) {",
          "695:   [\"scheme\"]=>",
          "696:   string(4) \"http\"",
          "697:   [\"host\"]=>",
          "698:   string(4) \"host\"",
          "699:   [\"user\"]=>",
          "700:   string(4) \"user\"",
          "701:   [\"pass\"]=>",
          "702:   string(5) \"@pass\"",
          "703:   [\"path\"]=>",
          "704:   string(5) \"/path\"",
          "705:   [\"query\"]=>",
          "706:   string(14) \"argument?value\"",
          "707:   [\"fragment\"]=>",
          "708:   string(3) \"etc\"",
          "709: }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "883: --> http://blah.com:123456: bool(false)",
          "885: --> http://blah.com:abcdef: bool(false)",
          "886: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "853: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123: bool(false)",
          "855: --> http://user:@pass@host/path?argument?value#etc: bool(false)",
          "857: --> http://foo.com\\@bar.com: bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_002.phpt -> ext/standard/tests/url/parse_url_basic_002.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "69: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "70: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "71: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "73: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "74: --> nntp://news.php.net   : string(4) \"nntp\"",
          "75: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : string(3) \"ftp\"",
          "",
          "[Removed Lines]",
          "72: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "89: --> scheme:   : string(6) \"scheme\"",
          "90: --> foo+bar://baz@bang/bla   : string(7) \"foo+bar\"",
          "91: --> gg:9130731   : string(2) \"gg\"",
          "93: --> http://10.10.10.10/:80   : string(4) \"http\"",
          "94: --> http://x:?   : string(4) \"http\"",
          "95: --> x:blah.com   : string(1) \"x\"",
          "",
          "[Removed Lines]",
          "92: --> http://user:@pass@host/path?argument?value#etc   : string(4) \"http\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "125: --> http://:?   : bool(false)",
          "126: --> http://blah.com:123456   : bool(false)",
          "127: --> http://blah.com:abcdef   : bool(false)",
          "128: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "126: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "127: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "128: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_003.phpt -> ext/standard/tests/url/parse_url_basic_003.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "72: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "73: --> nntp://news.php.net   : string(12) \"news.php.net\"",
          "74: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : string(11) \"ftp.gnu.org\"",
          "",
          "[Removed Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88: --> scheme:   : NULL",
          "89: --> foo+bar://baz@bang/bla   : string(4) \"bang\"",
          "90: --> gg:9130731   : NULL",
          "92: --> http://10.10.10.10/:80   : string(11) \"10.10.10.10\"",
          "93: --> http://x:?   : string(1) \"x\"",
          "94: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(4) \"host\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124: --> http://:?   : bool(false)",
          "125: --> http://blah.com:123456   : bool(false)",
          "126: --> http://blah.com:abcdef   : bool(false)",
          "127: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_004.phpt -> ext/standard/tests/url/parse_url_basic_004.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : NULL",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : int(80)",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : NULL",
          "72: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : int(80)",
          "73: --> nntp://news.php.net   : NULL",
          "74: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : int(80)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88: --> scheme:   : NULL",
          "89: --> foo+bar://baz@bang/bla   : NULL",
          "90: --> gg:9130731   : NULL",
          "92: --> http://10.10.10.10/:80   : NULL",
          "93: --> http://x:?   : NULL",
          "94: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : NULL",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124: --> http://:?   : bool(false)",
          "125: --> http://blah.com:123456   : bool(false)",
          "126: --> http://blah.com:abcdef   : bool(false)",
          "127: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_005.phpt -> ext/standard/tests/url/parse_url_basic_005.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(6) \"secret\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(0) \"\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(6) \"secret\"",
          "72: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(6) \"secret\"",
          "73: --> nntp://news.php.net   : NULL",
          "74: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(14) \"secret@hideout\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88: --> scheme:   : NULL",
          "89: --> foo+bar://baz@bang/bla   : string(3) \"baz\"",
          "90: --> gg:9130731   : NULL",
          "92: --> http://10.10.10.10/:80   : NULL",
          "93: --> http://x:?   : NULL",
          "94: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(4) \"user\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124: --> http://:?   : bool(false)",
          "125: --> http://blah.com:123456   : bool(false)",
          "126: --> http://blah.com:abcdef   : bool(false)",
          "127: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_006.phpt -> ext/standard/tests/url/parse_url_basic_006.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(0) \"\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(7) \"hideout\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(7) \"hideout\"",
          "72: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(7) \"hid:out\"",
          "73: --> nntp://news.php.net   : NULL",
          "74: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : NULL",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88: --> scheme:   : NULL",
          "89: --> foo+bar://baz@bang/bla   : NULL",
          "90: --> gg:9130731   : NULL",
          "92: --> http://10.10.10.10/:80   : NULL",
          "93: --> http://x:?   : NULL",
          "94: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(5) \"@pass\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124: --> http://:?   : bool(false)",
          "125: --> http://blah.com:123456   : bool(false)",
          "126: --> http://blah.com:abcdef   : bool(false)",
          "127: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_007.phpt -> ext/standard/tests/url/parse_url_basic_007.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "72: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "73: --> nntp://news.php.net   : NULL",
          "74: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : string(22) \"/gnu/glic/glibc.tar.gz\"",
          "",
          "[Removed Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88: --> scheme:   : NULL",
          "89: --> foo+bar://baz@bang/bla   : string(4) \"/bla\"",
          "90: --> gg:9130731   : string(7) \"9130731\"",
          "92: --> http://10.10.10.10/:80   : string(4) \"/:80\"",
          "93: --> http://x:?   : NULL",
          "94: --> x:blah.com   : string(8) \"blah.com\"",
          "",
          "[Removed Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(5) \"/path\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124: --> http://:?   : bool(false)",
          "125: --> http://blah.com:123456   : bool(false)",
          "126: --> http://blah.com:abcdef   : bool(false)",
          "127: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_008.phpt -> ext/standard/tests/url/parse_url_basic_008.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "72: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "73: --> nntp://news.php.net   : NULL",
          "74: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88: --> scheme:   : NULL",
          "89: --> foo+bar://baz@bang/bla   : NULL",
          "90: --> gg:9130731   : NULL",
          "92: --> http://10.10.10.10/:80   : NULL",
          "93: --> http://x:?   : NULL",
          "94: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(14) \"argument?value\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124: --> http://:?   : bool(false)",
          "125: --> http://blah.com:123456   : bool(false)",
          "126: --> http://blah.com:abcdef   : bool(false)",
          "127: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_009.phpt -> ext/standard/tests/url/parse_url_basic_009.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "72: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "73: --> nntp://news.php.net   : NULL",
          "74: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88: --> scheme:   : NULL",
          "89: --> foo+bar://baz@bang/bla   : NULL",
          "90: --> gg:9130731   : NULL",
          "92: --> http://10.10.10.10/:80   : NULL",
          "93: --> http://x:?   : NULL",
          "94: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(3) \"etc\"",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124: --> http://:?   : bool(false)",
          "125: --> http://blah.com:123456   : bool(false)",
          "126: --> http://blah.com:abcdef   : bool(false)",
          "127: Done",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/urls.inc||ext/standard/tests/url/urls.inc": [
          "File: ext/standard/tests/url/urls.inc -> ext/standard/tests/url/urls.inc",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: 'http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "49: 'http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "50: 'http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "52: 'http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "53: 'nntp://news.php.net',",
          "54: 'ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz',",
          "",
          "[Removed Lines]",
          "51: 'http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "68: 'scheme:',",
          "69: 'foo+bar://baz@bang/bla',",
          "70: 'gg:9130731',",
          "72: 'http://10.10.10.10/:80',",
          "73: 'http://x:?',",
          "74: 'x:blah.com',",
          "",
          "[Removed Lines]",
          "71: 'http://user:@pass@host/path?argument?value#etc',",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "106: 'http://:?',",
          "107: 'http://blah.com:123456',",
          "108: 'http://blah.com:abcdef',",
          "109: );",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "107: 'http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "108: 'http://user:@pass@host/path?argument?value#etc',",
          "109: 'http://foo.com\\\\@bar.com'",
          "",
          "---------------"
        ],
        "ext/standard/url.c||ext/standard/url.c": [
          "File: ext/standard/url.c -> ext/standard/url.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "244:  if ((p = zend_memrchr(s, '@', (e-s)))) {",
          "245:   if ((pp = memchr(s, ':', (p-s)))) {",
          "246:    ret->user = estrndup(s, (pp-s));",
          "247:    php_replace_controlchars_ex(ret->user, (pp - s));",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "246:   pp = s;",
          "247:   while (pp < p) {",
          "248:    if (!isalnum(*pp) && *pp != ':' && *pp != ';' && *pp != '=' && !(*pp >= '!' && *pp <= ',')) {",
          "249:     if (ret->scheme) {",
          "250:      efree(ret->scheme);",
          "251:     }",
          "252:     efree(ret);",
          "253:     return NULL;",
          "254:    }",
          "255:    pp++;",
          "256:   }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1c468ee044289661c8c4118a0653222596668432",
      "candidate_info": {
        "commit_hash": "1c468ee044289661c8c4118a0653222596668432",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/1c468ee044289661c8c4118a0653222596668432",
        "files": [
          "ext/standard/tests/url/parse_url_basic_001.phpt",
          "ext/standard/tests/url/parse_url_basic_002.phpt",
          "ext/standard/tests/url/parse_url_basic_003.phpt",
          "ext/standard/tests/url/parse_url_basic_004.phpt",
          "ext/standard/tests/url/parse_url_basic_005.phpt",
          "ext/standard/tests/url/parse_url_basic_006.phpt",
          "ext/standard/tests/url/parse_url_basic_007.phpt",
          "ext/standard/tests/url/parse_url_basic_008.phpt",
          "ext/standard/tests/url/parse_url_basic_009.phpt",
          "ext/standard/tests/url/urls.inc",
          "ext/standard/url.c"
        ],
        "message": "Revert \"Added validation to parse_url() to prohibit restricted characters inside login/pass components based on RFC3986\"\n\nThis reverts commit 085dfca02b64588317a233eb191d07a75511fff2.",
        "before_after_code_files": [
          "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt",
          "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt",
          "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt",
          "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt",
          "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt",
          "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt",
          "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt",
          "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt",
          "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt",
          "ext/standard/tests/url/urls.inc||ext/standard/tests/url/urls.inc",
          "ext/standard/url.c||ext/standard/url.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt",
            "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt",
            "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt",
            "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt",
            "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt",
            "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt",
            "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt",
            "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt",
            "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt",
            "ext/standard/url.c||ext/standard/url.c"
          ],
          "candidate": [
            "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt",
            "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt",
            "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt",
            "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt",
            "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt",
            "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt",
            "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt",
            "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt",
            "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt",
            "ext/standard/url.c||ext/standard/url.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/url/parse_url_basic_001.phpt||ext/standard/tests/url/parse_url_basic_001.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_001.phpt -> ext/standard/tests/url/parse_url_basic_001.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "507:   string(16) \"some_page_ref123\"",
          "508: }",
          "510: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123: array(8) {",
          "511:   [\"scheme\"]=>",
          "512:   string(4) \"http\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "510: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123: array(7) {",
          "511:   [\"scheme\"]=>",
          "512:   string(4) \"http\"",
          "513:   [\"host\"]=>",
          "514:   string(11) \"www.php.net\"",
          "515:   [\"port\"]=>",
          "516:   int(80)",
          "517:   [\"user\"]=>",
          "518:   string(14) \"secret@hideout\"",
          "519:   [\"path\"]=>",
          "520:   string(10) \"/index.php\"",
          "521:   [\"query\"]=>",
          "522:   string(31) \"test=1&test2=char&test3=mixesCI\"",
          "523:   [\"fragment\"]=>",
          "524:   string(16) \"some_page_ref123\"",
          "525: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "674:   string(7) \"9130731\"",
          "675: }",
          "677: --> http://10.10.10.10/:80: array(3) {",
          "678:   [\"scheme\"]=>",
          "679:   string(4) \"http\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "694: --> http://user:@pass@host/path?argument?value#etc: array(7) {",
          "695:   [\"scheme\"]=>",
          "696:   string(4) \"http\"",
          "697:   [\"host\"]=>",
          "698:   string(4) \"host\"",
          "699:   [\"user\"]=>",
          "700:   string(4) \"user\"",
          "701:   [\"pass\"]=>",
          "702:   string(5) \"@pass\"",
          "703:   [\"path\"]=>",
          "704:   string(5) \"/path\"",
          "705:   [\"query\"]=>",
          "706:   string(14) \"argument?value\"",
          "707:   [\"fragment\"]=>",
          "708:   string(3) \"etc\"",
          "709: }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "849: --> http://blah.com:123456: bool(false)",
          "851: --> http://blah.com:abcdef: bool(false)",
          "858: Done",
          "",
          "[Removed Lines]",
          "853: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123: bool(false)",
          "855: --> http://user:@pass@host/path?argument?value#etc: bool(false)",
          "857: --> http://foo.com\\@bar.com: bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_002.phpt||ext/standard/tests/url/parse_url_basic_002.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_002.phpt -> ext/standard/tests/url/parse_url_basic_002.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "69: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "70: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "71: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "72: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "73: --> nntp://news.php.net   : string(4) \"nntp\"",
          "74: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : string(3) \"ftp\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "72: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(4) \"http\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "88: --> scheme:   : string(6) \"scheme\"",
          "89: --> foo+bar://baz@bang/bla   : string(7) \"foo+bar\"",
          "90: --> gg:9130731   : string(2) \"gg\"",
          "91: --> http://10.10.10.10/:80   : string(4) \"http\"",
          "92: --> http://x:?   : string(4) \"http\"",
          "93: --> x:blah.com   : string(1) \"x\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "92: --> http://user:@pass@host/path?argument?value#etc   : string(4) \"http\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "123: --> http://:?   : bool(false)",
          "124: --> http://blah.com:123456   : bool(false)",
          "125: --> http://blah.com:abcdef   : bool(false)",
          "129: Done",
          "",
          "[Removed Lines]",
          "126: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "127: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "128: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_003.phpt||ext/standard/tests/url/parse_url_basic_003.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_003.phpt -> ext/standard/tests/url/parse_url_basic_003.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "71: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "72: --> nntp://news.php.net   : string(12) \"news.php.net\"",
          "73: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : string(11) \"ftp.gnu.org\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(11) \"www.php.net\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87: --> scheme:   : NULL",
          "88: --> foo+bar://baz@bang/bla   : string(4) \"bang\"",
          "89: --> gg:9130731   : NULL",
          "90: --> http://10.10.10.10/:80   : string(11) \"10.10.10.10\"",
          "91: --> http://x:?   : string(1) \"x\"",
          "92: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(4) \"host\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "122: --> http://:?   : bool(false)",
          "123: --> http://blah.com:123456   : bool(false)",
          "124: --> http://blah.com:abcdef   : bool(false)",
          "128: Done",
          "",
          "[Removed Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_004.phpt||ext/standard/tests/url/parse_url_basic_004.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_004.phpt -> ext/standard/tests/url/parse_url_basic_004.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : NULL",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : int(80)",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : NULL",
          "71: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : int(80)",
          "72: --> nntp://news.php.net   : NULL",
          "73: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : int(80)",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87: --> scheme:   : NULL",
          "88: --> foo+bar://baz@bang/bla   : NULL",
          "89: --> gg:9130731   : NULL",
          "90: --> http://10.10.10.10/:80   : NULL",
          "91: --> http://x:?   : NULL",
          "92: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : NULL",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "122: --> http://:?   : bool(false)",
          "123: --> http://blah.com:123456   : bool(false)",
          "124: --> http://blah.com:abcdef   : bool(false)",
          "128: Done",
          "",
          "[Removed Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_005.phpt||ext/standard/tests/url/parse_url_basic_005.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_005.phpt -> ext/standard/tests/url/parse_url_basic_005.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(6) \"secret\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(0) \"\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(6) \"secret\"",
          "71: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(6) \"secret\"",
          "72: --> nntp://news.php.net   : NULL",
          "73: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(14) \"secret@hideout\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87: --> scheme:   : NULL",
          "88: --> foo+bar://baz@bang/bla   : string(3) \"baz\"",
          "89: --> gg:9130731   : NULL",
          "90: --> http://10.10.10.10/:80   : NULL",
          "91: --> http://x:?   : NULL",
          "92: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(4) \"user\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "122: --> http://:?   : bool(false)",
          "123: --> http://blah.com:123456   : bool(false)",
          "124: --> http://blah.com:abcdef   : bool(false)",
          "128: Done",
          "",
          "[Removed Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_006.phpt||ext/standard/tests/url/parse_url_basic_006.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_006.phpt -> ext/standard/tests/url/parse_url_basic_006.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(0) \"\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(7) \"hideout\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(7) \"hideout\"",
          "71: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(7) \"hid:out\"",
          "72: --> nntp://news.php.net   : NULL",
          "73: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : NULL",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87: --> scheme:   : NULL",
          "88: --> foo+bar://baz@bang/bla   : NULL",
          "89: --> gg:9130731   : NULL",
          "90: --> http://10.10.10.10/:80   : NULL",
          "91: --> http://x:?   : NULL",
          "92: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(5) \"@pass\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "122: --> http://:?   : bool(false)",
          "123: --> http://blah.com:123456   : bool(false)",
          "124: --> http://blah.com:abcdef   : bool(false)",
          "128: Done",
          "",
          "[Removed Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_007.phpt||ext/standard/tests/url/parse_url_basic_007.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_007.phpt -> ext/standard/tests/url/parse_url_basic_007.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "71: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "72: --> nntp://news.php.net   : NULL",
          "73: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : string(22) \"/gnu/glic/glibc.tar.gz\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(10) \"/index.php\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87: --> scheme:   : NULL",
          "88: --> foo+bar://baz@bang/bla   : string(4) \"/bla\"",
          "89: --> gg:9130731   : string(7) \"9130731\"",
          "90: --> http://10.10.10.10/:80   : string(4) \"/:80\"",
          "91: --> http://x:?   : NULL",
          "92: --> x:blah.com   : string(8) \"blah.com\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(5) \"/path\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "122: --> http://:?   : bool(false)",
          "123: --> http://blah.com:123456   : bool(false)",
          "124: --> http://blah.com:abcdef   : bool(false)",
          "128: Done",
          "",
          "[Removed Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_008.phpt||ext/standard/tests/url/parse_url_basic_008.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_008.phpt -> ext/standard/tests/url/parse_url_basic_008.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "71: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "72: --> nntp://news.php.net   : NULL",
          "73: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(31) \"test=1&test2=char&test3=mixesCI\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87: --> scheme:   : NULL",
          "88: --> foo+bar://baz@bang/bla   : NULL",
          "89: --> gg:9130731   : NULL",
          "90: --> http://10.10.10.10/:80   : NULL",
          "91: --> http://x:?   : NULL",
          "92: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(14) \"argument?value\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "122: --> http://:?   : bool(false)",
          "123: --> http://blah.com:123456   : bool(false)",
          "124: --> http://blah.com:abcdef   : bool(false)",
          "128: Done",
          "",
          "[Removed Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/parse_url_basic_009.phpt||ext/standard/tests/url/parse_url_basic_009.phpt": [
          "File: ext/standard/tests/url/parse_url_basic_009.phpt -> ext/standard/tests/url/parse_url_basic_009.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "68: --> http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "69: --> http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "70: --> http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "71: --> http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "72: --> nntp://news.php.net   : NULL",
          "73: --> ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : string(16) \"some_page_ref123\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "87: --> scheme:   : NULL",
          "88: --> foo+bar://baz@bang/bla   : NULL",
          "89: --> gg:9130731   : NULL",
          "90: --> http://10.10.10.10/:80   : NULL",
          "91: --> http://x:?   : NULL",
          "92: --> x:blah.com   : NULL",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "91: --> http://user:@pass@host/path?argument?value#etc   : string(3) \"etc\"",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "122: --> http://:?   : bool(false)",
          "123: --> http://blah.com:123456   : bool(false)",
          "124: --> http://blah.com:abcdef   : bool(false)",
          "128: Done",
          "",
          "[Removed Lines]",
          "125: --> http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123   : bool(false)",
          "126: --> http://user:@pass@host/path?argument?value#etc   : bool(false)",
          "127: --> http://foo.com\\@bar.com   : bool(false)",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/tests/url/urls.inc||ext/standard/tests/url/urls.inc": [
          "File: ext/standard/tests/url/urls.inc -> ext/standard/tests/url/urls.inc",
          "--- Hunk 1 ---",
          "[Context before]",
          "48: 'http://secret:@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "49: 'http://:hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "50: 'http://secret:hideout@www.php.net/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "51: 'http://secret:hid:out@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "52: 'nntp://news.php.net',",
          "53: 'ftp://ftp.gnu.org/gnu/glic/glibc.tar.gz',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "51: 'http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "67: 'scheme:',",
          "68: 'foo+bar://baz@bang/bla',",
          "69: 'gg:9130731',",
          "70: 'http://10.10.10.10/:80',",
          "71: 'http://x:?',",
          "72: 'x:blah.com',",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "71: 'http://user:@pass@host/path?argument?value#etc',",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "104: 'http://:?',",
          "105: 'http://blah.com:123456',",
          "106: 'http://blah.com:abcdef',",
          "110: );",
          "",
          "[Removed Lines]",
          "107: 'http://secret@hideout@www.php.net:80/index.php?test=1&test2=char&test3=mixesCI#some_page_ref123',",
          "108: 'http://user:@pass@host/path?argument?value#etc',",
          "109: 'http://foo.com\\\\@bar.com'",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "ext/standard/url.c||ext/standard/url.c": [
          "File: ext/standard/url.c -> ext/standard/url.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "244:  if ((p = zend_memrchr(s, '@', (e-s)))) {",
          "258:   if ((pp = memchr(s, ':', (p-s)))) {",
          "259:    ret->user = estrndup(s, (pp-s));",
          "260:    php_replace_controlchars_ex(ret->user, (pp - s));",
          "",
          "[Removed Lines]",
          "246:   pp = s;",
          "247:   while (pp < p) {",
          "248:    if (!isalnum(*pp) && *pp != ':' && *pp != ';' && *pp != '=' && !(*pp >= '!' && *pp <= ',')) {",
          "249:     if (ret->scheme) {",
          "250:      efree(ret->scheme);",
          "251:     }",
          "252:     efree(ret);",
          "253:     return NULL;",
          "254:    }",
          "255:    pp++;",
          "256:   }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "88746d60ab3ad51797612ee62603bb3e08d4aac4",
      "candidate_info": {
        "commit_hash": "88746d60ab3ad51797612ee62603bb3e08d4aac4",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/88746d60ab3ad51797612ee62603bb3e08d4aac4",
        "files": [
          "ext/standard/string.c",
          "ext/standard/url.c"
        ],
        "message": "Fix bug #72400 and #72403 - prevent signed int overflows for string lengths",
        "before_after_code_files": [
          "ext/standard/string.c||ext/standard/string.c",
          "ext/standard/url.c||ext/standard/url.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/url.c||ext/standard/url.c"
          ],
          "candidate": [
            "ext/standard/url.c||ext/standard/url.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/string.c||ext/standard/string.c": [
          "File: ext/standard/string.c -> ext/standard/string.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "137:  register unsigned char *result = NULL;",
          "138:  size_t i, j;",
          "140:  result = (unsigned char *) safe_emalloc(oldlen, 2 * sizeof(char), 1);",
          "142:  for (i = j = 0; i < oldlen; i++) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "140:  if (UNEXPECTED(oldlen * 2 * sizeof(char) > INT_MAX)) {",
          "141:   zend_error(E_ERROR, \"String size overflow\");",
          "142:  }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2613:  char *p, *q;",
          "2614:  char c;",
          "2615:  int  old_len;",
          "2617:  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"s\", &old, &old_len) == FAILURE) {",
          "2618:   return;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2619:  size_t new_len;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "2647:   }",
          "2648:  }",
          "2652: }",
          "",
          "[Removed Lines]",
          "2651:  RETURN_STRINGL(erealloc(str, q - str + 1), q - str, 0);",
          "",
          "[Added Lines]",
          "2654:  new_len = q - str;",
          "2655:  if (UNEXPECTED(new_len > INT_MAX)) {",
          "2656:   efree(str);",
          "2657:   zend_error(E_ERROR, \"String size overflow\");",
          "2658:  }",
          "2660:  RETURN_STRINGL(erealloc(str, new_len + 1), new_len, 0);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "3500:  char *source, *target;",
          "3501:  char *end;",
          "3502:  char c;",
          "3505:  if (!wlength) {",
          "3506:   wlength = strlen(what);",
          "",
          "[Removed Lines]",
          "3503:  int  newlen;",
          "",
          "[Added Lines]",
          "3512:  size_t  newlen;",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "3531:  }",
          "3533:  newlen = target - new_str;",
          "3534:  if (target - new_str < length * 4) {",
          "3535:   new_str = erealloc(new_str, newlen + 1);",
          "3536:  }",
          "3537:  if (new_length) {",
          "3539:  }",
          "3540:  if (should_free) {",
          "3541:   STR_FREE((char*)str);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3543:  if (UNEXPECTED(newlen > INT_MAX)) {",
          "3544:   efree(new_str);",
          "3545:   zend_error(E_ERROR, \"String size overflow\");",
          "3546:  }",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "3590:  if (should_free) {",
          "3591:   STR_FREE(str);",
          "3592:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3603:  if (UNEXPECTED(*new_length < 0)) {",
          "3604:   zend_error(E_ERROR, \"String size overflow\");",
          "3605:  }",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "4290:   size_t repl_len = is_xhtml ? (sizeof(\"<br />\") - 1) : (sizeof(\"<br>\") - 1);",
          "4292:   new_length = str_len + repl_cnt * repl_len;",
          "4293:   tmp = target = safe_emalloc(repl_cnt, repl_len, str_len + 1);",
          "4294:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4309:   if (UNEXPECTED(new_length > INT_MAX)) {",
          "4310:    zend_error(E_ERROR, \"String size overflow\");",
          "4311:   }",
          "",
          "---------------"
        ],
        "ext/standard/url.c||ext/standard/url.c": [
          "File: ext/standard/url.c -> ext/standard/url.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "65: {",
          "66:  unsigned char *s = (unsigned char *)str;",
          "67:  unsigned char *e = (unsigned char *)str + len;",
          "69:  if (!str) {",
          "70:   return (NULL);",
          "71:  }",
          "73:  while (s < e) {",
          "75:   if (iscntrl(*s)) {",
          "78:   s++;",
          "79:  }",
          "81:  return (str);",
          "85: PHPAPI char *php_replace_controlchars(char *str)",
          "86: {",
          "87:  return php_replace_controlchars_ex(str, strlen(str));",
          "90: PHPAPI php_url *php_url_parse(char const *str)",
          "91: {",
          "",
          "[Removed Lines]",
          "77:   }",
          "82: }",
          "88: }",
          "",
          "[Added Lines]",
          "77:   }",
          "82: }",
          "88: }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "173:      length -= ++e - s;",
          "174:      s = e;",
          "175:      goto just_path;",
          "177:    }",
          "180:   parse_port:",
          "181:   p = e + 1;",
          "",
          "[Removed Lines]",
          "176:     }",
          "178:   }",
          "",
          "[Added Lines]",
          "176:     }",
          "178:   }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "238:   }",
          "239:  } else {",
          "240:   e = p;",
          "244:  if ((p = zend_memrchr(s, '@', (e-s)))) {",
          "245:   if ((pp = memchr(s, ':', (p-s)))) {",
          "246:    ret->user = estrndup(s, (pp-s));",
          "247:    php_replace_controlchars_ex(ret->user, (pp - s));",
          "249:    pp++;",
          "250:    ret->pass = estrndup(pp, (p-pp));",
          "251:    php_replace_controlchars_ex(ret->pass, (p-pp));",
          "",
          "[Removed Lines]",
          "241:  }",
          "",
          "[Added Lines]",
          "241:  }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "253:    ret->user = estrndup(s, (p-s));",
          "254:    php_replace_controlchars_ex(ret->user, (p-s));",
          "255:   }",
          "257:   s = p + 1;",
          "258:  }",
          "261:  if (*s == '[' && *(e-1) == ']') {",
          "265:   p = s;",
          "266:  } else {",
          "",
          "[Removed Lines]",
          "263:      we're dealing with an",
          "",
          "[Added Lines]",
          "263:      we're dealing with an",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "294:     }",
          "295:    }",
          "296:    p--;",
          "298:  } else {",
          "299:   p = e;",
          "300:  }",
          "303:  if ((p-s) < 1) {",
          "304:   STR_FREE(ret->scheme);",
          "",
          "[Removed Lines]",
          "297:   }",
          "",
          "[Added Lines]",
          "297:   }",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "330:    p = pp;",
          "331:    goto label_parse;",
          "332:   }",
          "334:   if (p - s) {",
          "335:    ret->path = estrndup(s, (p-s));",
          "336:    php_replace_controlchars_ex(ret->path, (p - s));",
          "339:   if (pp) {",
          "341:     ret->query = estrndup(p, (pp-p));",
          "342:     php_replace_controlchars_ex(ret->query, (pp - p));",
          "343:    }",
          "",
          "[Removed Lines]",
          "337:   }",
          "340:    if (pp - ++p) {",
          "",
          "[Added Lines]",
          "337:   }",
          "340:    if (pp - ++p) {",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "351:   if (p - s) {",
          "352:    ret->path = estrndup(s, (p-s));",
          "353:    php_replace_controlchars_ex(ret->path, (p - s));",
          "356:   label_parse:",
          "357:   p++;",
          "359:   if (ue - p) {",
          "360:    ret->fragment = estrndup(p, (ue-p));",
          "361:    php_replace_controlchars_ex(ret->fragment, (ue - p));",
          "363:  } else {",
          "364:   ret->path = estrndup(s, (ue-s));",
          "365:   php_replace_controlchars_ex(ret->path, (ue - s));",
          "",
          "[Removed Lines]",
          "354:   }",
          "362:   }",
          "",
          "[Added Lines]",
          "354:   }",
          "362:   }",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "441:   add_assoc_string(return_value, \"query\", resource->query, 1);",
          "442:  if (resource->fragment != NULL)",
          "443:   add_assoc_string(return_value, \"fragment\", resource->fragment, 1);",
          "445:  php_url_free(resource);",
          "446: }",
          "",
          "[Removed Lines]",
          "444: done:",
          "",
          "[Added Lines]",
          "444: done:",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "575:   if (*data == '+') {",
          "577:   }",
          "579:      && isxdigit((int) *(data + 2))) {",
          "580: #ifndef CHARSET_EBCDIC",
          "",
          "[Removed Lines]",
          "578:   else if (*data == '%' && len >= 2 && isxdigit((int) *(data + 1))",
          "",
          "[Added Lines]",
          "578:   else if (*data == '%' && len >= 2 && isxdigit((int) *(data + 1))",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "625:  if (new_length) {",
          "627:  }",
          "628:  return ((char *) str);",
          "629: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "628:  if (UNEXPECTED(y > INT_MAX)) {",
          "629:   efree(str);",
          "630:   zend_error(E_ERROR, \"String size overflow\");",
          "631:  }",
          "",
          "---------------",
          "--- Hunk 11 ---",
          "[Context before]",
          "673:  char *data = str;",
          "675:  while (len--) {",
          "677:    && isxdigit((int) *(data + 2))) {",
          "678: #ifndef CHARSET_EBCDIC",
          "",
          "[Removed Lines]",
          "676:   if (*data == '%' && len >= 2 && isxdigit((int) *(data + 1))",
          "",
          "[Added Lines]",
          "680:   if (*data == '%' && len >= 2 && isxdigit((int) *(data + 1))",
          "",
          "---------------",
          "--- Hunk 12 ---",
          "[Context before]",
          "726:  if (zend_hash_find(HASH_OF(stream->wrapperdata), \"headers\", sizeof(\"headers\"), (void **)&h) != FAILURE && Z_TYPE_PP(h) == IS_ARRAY) {",
          "728:   if (!Z_ARRVAL_PP(h)->nNumOfElements) {",
          "729:    php_stream_getc(stream);",
          "730:   }",
          "731:   zend_hash_find(HASH_OF(stream->wrapperdata), \"headers\", sizeof(\"headers\"), (void **)&h);",
          "733:  } else {",
          "734:   hashT = HASH_OF(stream->wrapperdata);",
          "735:  }",
          "",
          "[Removed Lines]",
          "732:   hashT = Z_ARRVAL_PP(h);",
          "",
          "[Added Lines]",
          "736:   hashT = Z_ARRVAL_PP(h);",
          "",
          "---------------"
        ]
      }
    }
  ]
}