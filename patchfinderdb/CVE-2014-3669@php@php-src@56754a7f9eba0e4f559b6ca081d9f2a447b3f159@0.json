{
  "cve_id": "CVE-2014-3669",
  "cve_desc": "Integer overflow in the object_custom function in ext/standard/var_unserializer.c in PHP before 5.4.34, 5.5.x before 5.5.18, and 5.6.x before 5.6.2 allows remote attackers to cause a denial of service (application crash) or possibly execute arbitrary code via an argument to the unserialize function that triggers calculation of a large length value.",
  "repo": "php/php-src",
  "patch_hash": "56754a7f9eba0e4f559b6ca081d9f2a447b3f159",
  "patch_info": {
    "commit_hash": "56754a7f9eba0e4f559b6ca081d9f2a447b3f159",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/56754a7f9eba0e4f559b6ca081d9f2a447b3f159",
    "files": [
      "NEWS",
      "ext/standard/tests/serialize/bug68044.phpt",
      "ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re"
    ],
    "message": "Fixed bug #68044: Integer overflow in unserialize() (32-bits only)",
    "before_after_code_files": [
      "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
      "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
      "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
    ]
  },
  "patch_diff": {
    "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt": [
      "File: ext/standard/tests/serialize/bug68044.phpt -> ext/standard/tests/serialize/bug68044.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #68044 Integer overflow in unserialize() (32-bits only)",
      "3: --FILE--",
      "4: <?php",
      "5:  echo unserialize('C:3:\"XYZ\":18446744075857035259:{}');",
      "6: ?>",
      "7: ===DONE==",
      "8: --EXPECTF--",
      "9: Warning: Insufficient data for unserializing - %d required, 1 present in %s/bug68044.php on line 2",
      "11: Notice: unserialize(): Error at offset 32 of 33 bytes in %s/bug68044.php on line 2",
      "12: ===DONE==",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
      "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "373:  (*p) += 2;",
      "376:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
      "377:   return 0;",
      "378:  }",
      "",
      "[Removed Lines]",
      "375:  if (datalen < 0 || (*p) + datalen >= max) {",
      "",
      "[Added Lines]",
      "375:  if (datalen < 0 || (max - (*p)) <= datalen) {",
      "",
      "---------------"
    ],
    "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
      "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
      "--- Hunk 1 ---",
      "[Context before]",
      "377:  (*p) += 2;",
      "380:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
      "381:   return 0;",
      "382:  }",
      "",
      "[Removed Lines]",
      "379:  if (datalen < 0 || (*p) + datalen >= max) {",
      "",
      "[Added Lines]",
      "379:  if (datalen < 0 || (max - (*p)) <= datalen) {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "3eb679b952f4655f178cf576584ef172602325ab",
      "candidate_info": {
        "commit_hash": "3eb679b952f4655f178cf576584ef172602325ab",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/3eb679b952f4655f178cf576584ef172602325ab",
        "files": [
          "ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #68044: Integer overflow in unserialize() (32-bits only)",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt": [
          "File: ext/standard/tests/serialize/bug68044.phpt -> ext/standard/tests/serialize/bug68044.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68044 Integer overflow in unserialize() (32-bits only)",
          "3: --FILE--",
          "4: <?php",
          "5:  echo unserialize('C:3:\"XYZ\":18446744075857035259:{}');",
          "6: ?>",
          "7: ===DONE==",
          "8: --EXPECTF--",
          "9: Warning: Insufficient data for unserializing - %d required, 1 present in %s/bug68044.php on line 2",
          "11: Notice: unserialize(): Error at offset 32 of 33 bytes in %s/bug68044.php on line 2",
          "12: ===DONE==",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "387:  (*p) += 2;",
          "390:   zend_error(E_WARNING, \"Insufficient data for unserializing - %pd required, %pd present\", datalen, (zend_long)(max - (*p)));",
          "391:   return 0;",
          "392:  }",
          "",
          "[Removed Lines]",
          "389:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "389:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "391:  (*p) += 2;",
          "394:   zend_error(E_WARNING, \"Insufficient data for unserializing - %pd required, %pd present\", datalen, (zend_long)(max - (*p)));",
          "395:   return 0;",
          "396:  }",
          "",
          "[Removed Lines]",
          "393:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "393:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "88eb7ea47dd6d23378b116aa76428ef4907c5373",
      "candidate_info": {
        "commit_hash": "88eb7ea47dd6d23378b116aa76428ef4907c5373",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/88eb7ea47dd6d23378b116aa76428ef4907c5373",
        "files": [
          "ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #68044: Integer overflow in unserialize() (32-bits only)",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt": [
          "File: ext/standard/tests/serialize/bug68044.phpt -> ext/standard/tests/serialize/bug68044.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68044 Integer overflow in unserialize() (32-bits only)",
          "3: --FILE--",
          "4: <?php",
          "5:  echo unserialize('C:3:\"XYZ\":18446744075857035259:{}');",
          "6: ?>",
          "7: ===DONE==",
          "8: --EXPECTF--",
          "9: Warning: Insufficient data for unserializing - %d required, 1 present in %s/bug68044.php on line 2",
          "11: Notice: unserialize(): Error at offset 32 of 33 bytes in %s/bug68044.php on line 2",
          "12: ===DONE==",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "372:  (*p) += 2;",
          "375:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "376:   return 0;",
          "377:  }",
          "",
          "[Removed Lines]",
          "374:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "374:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "376:  (*p) += 2;",
          "379:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "380:   return 0;",
          "381:  }",
          "",
          "[Removed Lines]",
          "378:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "378:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9aa90145239bae82d2af0a99fdae4ab27eb5f4f2",
      "candidate_info": {
        "commit_hash": "9aa90145239bae82d2af0a99fdae4ab27eb5f4f2",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/9aa90145239bae82d2af0a99fdae4ab27eb5f4f2",
        "files": [
          "ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #68044: Integer overflow in unserialize() (32-bits only)",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt": [
          "File: ext/standard/tests/serialize/bug68044.phpt -> ext/standard/tests/serialize/bug68044.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68044 Integer overflow in unserialize() (32-bits only)",
          "3: --FILE--",
          "4: <?php",
          "5:  echo unserialize('C:3:\"XYZ\":18446744075857035259:{}');",
          "6: ?>",
          "7: ===DONE==",
          "8: --EXPECTF--",
          "9: Warning: Insufficient data for unserializing - %d required, 1 present in %s/bug68044.php on line 2",
          "11: Notice: unserialize(): Error at offset 32 of 33 bytes in %s/bug68044.php on line 2",
          "12: ===DONE==",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "373:  (*p) += 2;",
          "376:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "377:   return 0;",
          "378:  }",
          "",
          "[Removed Lines]",
          "375:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "375:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "377:  (*p) += 2;",
          "380:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "381:   return 0;",
          "382:  }",
          "",
          "[Removed Lines]",
          "379:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "379:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2d7461f7bf5e4a7a134fdb13bda4ba6143ab13e3",
      "candidate_info": {
        "commit_hash": "2d7461f7bf5e4a7a134fdb13bda4ba6143ab13e3",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/2d7461f7bf5e4a7a134fdb13bda4ba6143ab13e3",
        "files": [
          "ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #68044: Integer overflow in unserialize() (32-bits only)\n\nConflicts:\n\text/standard/var_unserializer.c",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt": [
          "File: ext/standard/tests/serialize/bug68044.phpt -> ext/standard/tests/serialize/bug68044.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68044 Integer overflow in unserialize() (32-bits only)",
          "3: --FILE--",
          "4: <?php",
          "5:  echo unserialize('C:3:\"XYZ\":18446744075857035259:{}');",
          "6: ?>",
          "7: ===DONE==",
          "8: --EXPECTF--",
          "9: Warning: Insufficient data for unserializing - %d required, 1 present in %s/bug68044.php on line 2",
          "11: Notice: unserialize(): Error at offset 32 of 33 bytes in %s/bug68044.php on line 2",
          "12: ===DONE==",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "372:  (*p) += 2;",
          "375:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "376:   return 0;",
          "377:  }",
          "",
          "[Removed Lines]",
          "374:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "374:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "376:  (*p) += 2;",
          "379:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "380:   return 0;",
          "381:  }",
          "",
          "[Removed Lines]",
          "378:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "378:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4af06aca40ac4c592a71a0b1206a50fad994de21",
      "candidate_info": {
        "commit_hash": "4af06aca40ac4c592a71a0b1206a50fad994de21",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/4af06aca40ac4c592a71a0b1206a50fad994de21",
        "files": [
          "ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re"
        ],
        "message": "Fixed bug #68044: Integer overflow in unserialize() (32-bits only)",
        "before_after_code_files": [
          "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
          "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
          "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ],
          "candidate": [
            "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt",
            "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c",
            "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re"
          ]
        }
      },
      "candidate_diff": {
        "ext/standard/tests/serialize/bug68044.phpt||ext/standard/tests/serialize/bug68044.phpt": [
          "File: ext/standard/tests/serialize/bug68044.phpt -> ext/standard/tests/serialize/bug68044.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #68044 Integer overflow in unserialize() (32-bits only)",
          "3: --FILE--",
          "4: <?php",
          "5:  echo unserialize('C:3:\"XYZ\":18446744075857035259:{}');",
          "6: ?>",
          "7: ===DONE==",
          "8: --EXPECTF--",
          "9: Warning: Insufficient data for unserializing - %d required, 1 present in %s/bug68044.php on line 2",
          "11: Notice: unserialize(): Error at offset 32 of 33 bytes in %s/bug68044.php on line 2",
          "12: ===DONE==",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.c||ext/standard/var_unserializer.c": [
          "File: ext/standard/var_unserializer.c -> ext/standard/var_unserializer.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "373:  (*p) += 2;",
          "376:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "377:   return 0;",
          "378:  }",
          "",
          "[Removed Lines]",
          "375:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "375:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ],
        "ext/standard/var_unserializer.re||ext/standard/var_unserializer.re": [
          "File: ext/standard/var_unserializer.re -> ext/standard/var_unserializer.re",
          "--- Hunk 1 ---",
          "[Context before]",
          "377:  (*p) += 2;",
          "380:   zend_error(E_WARNING, \"Insufficient data for unserializing - %ld required, %ld present\", datalen, (long)(max - (*p)));",
          "381:   return 0;",
          "382:  }",
          "",
          "[Removed Lines]",
          "379:  if (datalen < 0 || (*p) + datalen >= max) {",
          "",
          "[Added Lines]",
          "379:  if (datalen < 0 || (max - (*p)) <= datalen) {",
          "",
          "---------------"
        ]
      }
    }
  ]
}