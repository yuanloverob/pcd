{
  "cve_id": "CVE-2014-8626",
  "cve_desc": "Stack-based buffer overflow in the date_from_ISO8601 function in ext/xmlrpc/libxmlrpc/xmlrpc.c in PHP before 5.2.7 allows remote attackers to cause a denial of service (application crash) or possibly execute arbitrary code by including a timezone field in a date, leading to improper XML-RPC encoding.",
  "repo": "php/php-src",
  "patch_hash": "c818d0d01341907fee82bdb81cab07b7d93bb9db",
  "patch_info": {
    "commit_hash": "c818d0d01341907fee82bdb81cab07b7d93bb9db",
    "repo": "php/php-src",
    "commit_url": "https://github.com/php/php-src/commit/c818d0d01341907fee82bdb81cab07b7d93bb9db",
    "files": [
      "ext/xmlrpc/libxmlrpc/xmlrpc.c",
      "ext/xmlrpc/tests/bug18916.phpt",
      "ext/xmlrpc/tests/bug45226.phpt"
    ],
    "message": "MFH: - Merged fix from SF project (Import Jeff Lawsons patches for XML datetime bug fixes)   Fixed bugs:   #45226 (xmlrpc_set_type() segfaults with valid ISO8601 date string)   #18916 (xmlrpc_set_type() \"not working\")",
    "before_after_code_files": [
      "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
      "ext/xmlrpc/tests/bug18916.phpt||ext/xmlrpc/tests/bug18916.phpt",
      "ext/xmlrpc/tests/bug45226.phpt||ext/xmlrpc/tests/bug45226.phpt"
    ]
  },
  "patch_diff": {
    "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
      "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "164: static int date_from_ISO8601 (const char *text, time_t * value) {",
      "165:    struct tm tm;",
      "166:    int n;",
      "167:    int i;",
      "170:  if (strchr (text, '-')) {",
      "171:   char *p = (char *) text, *p2 = buf;",
      "",
      "[Removed Lines]",
      "168:  char buf[18];",
      "",
      "[Added Lines]",
      "169: static time_t mkgmtime(struct tm *tm)",
      "170: {",
      "171:     static const int mdays[12] = {0,31,59,90,120,151,181,212,243,273,304,334};",
      "173:     return ((((((tm->tm_year - 70) * 365) + mdays[tm->tm_mon] + tm->tm_mday-1 +",
      "174:                   (tm->tm_year-68-1+(tm->tm_mon>=2))/4) * 24) + tm->tm_hour) * 60 +",
      "175:         tm->tm_min) * 60 + tm->tm_sec;",
      "176: }",
      "182:    char buf[30];",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "173:    if (*p != '-') {",
      "175:     p2++;",
      "176:    }",
      "177:    p++;",
      "178:   }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "191:     if (p2-buf >= sizeof(buf)) {",
      "192:      return -1;",
      "193:     }",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "183:    tm.tm_isdst = -1;",
      "189: #define XMLRPC_IS_NUMBER(x) if (x < '0' || x > '9') return -1;",
      "191:    n = 1000;",
      "",
      "[Removed Lines]",
      "185:    if(strlen(text) < 17) {",
      "186:       return -1;",
      "187:    }",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "247: static int date_to_ISO8601 (time_t value, char *buf, int length) {",
      "248:    struct tm *tm, tmbuf;",
      "250:    if (!tm) {",
      "251:     return 0;",
      "252:    }",
      "254:  return strftime (buf, length, \"%Y-%m-%dT%H:%M:%SZ\", tm);",
      "255: #else",
      "257: #endif",
      "258: }",
      "",
      "[Removed Lines]",
      "249:    tm = php_localtime_r(&value, &tmbuf);",
      "256:    return strftime(buf, length, \"%Y%m%dT%H:%M:%S\", tm);",
      "",
      "[Added Lines]",
      "263:    tm = php_gmtime_r(&value, &tmbuf);",
      "270:    return strftime(buf, length, \"%Y%m%dT%H:%M:%SZ\", tm);",
      "",
      "---------------",
      "--- Hunk 5 ---",
      "[Context before]",
      "1524:       date_to_ISO8601(time, timeBuf, sizeof(timeBuf));",
      "1526:       if(timeBuf[0]) {",
      "1529:       }",
      "1530:    }",
      "1531: }",
      "",
      "[Removed Lines]",
      "1527:          simplestring_clear(&value->str);",
      "1528:          simplestring_add(&value->str, timeBuf);",
      "",
      "[Added Lines]",
      "1541:          XMLRPC_SetValueDateTime_ISO8601 (value, timeBuf);",
      "",
      "---------------",
      "--- Hunk 6 ---",
      "[Context before]",
      "1701:    if(value) {",
      "1702:       time_t time_val = 0;",
      "1703:       if(s) {",
      "1704:          date_from_ISO8601(s, &time_val);",
      "1706:       }",
      "1707:    }",
      "1708: }",
      "",
      "[Removed Lines]",
      "1705:          XMLRPC_SetValueDateTime(value, time_val);",
      "",
      "[Added Lines]",
      "1717:          value->type = xmlrpc_datetime;",
      "1719:          value->i = time_val;",
      "1720:          simplestring_clear(&value->str);",
      "1721:          simplestring_add(&value->str, s);",
      "",
      "---------------"
    ],
    "ext/xmlrpc/tests/bug18916.phpt||ext/xmlrpc/tests/bug18916.phpt": [
      "File: ext/xmlrpc/tests/bug18916.phpt -> ext/xmlrpc/tests/bug18916.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #18916 (xmlrpc_set_type() not working)",
      "3: --INI--",
      "4: date.timezone=\"America/Sao_Paulo\"",
      "5: --FILE--",
      "6: <?php",
      "8: $params = date(\"Ymd\\TH:i:s\", time());",
      "9: xmlrpc_set_type($params, 'datetime');",
      "10: echo xmlrpc_encode($params);",
      "12: ?>",
      "13: --EXPECTF--",
      "14: <?xml version=\"1.0\" encoding=\"utf-8\"?>",
      "15: <params>",
      "16: <param>",
      "17:  <value>",
      "18:   <dateTime.iso8601>%dT%d:%d:%d</dateTime.iso8601>",
      "19:  </value>",
      "20: </param>",
      "21: </params>",
      "",
      "---------------"
    ],
    "ext/xmlrpc/tests/bug45226.phpt||ext/xmlrpc/tests/bug45226.phpt": [
      "File: ext/xmlrpc/tests/bug45226.phpt -> ext/xmlrpc/tests/bug45226.phpt",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: --TEST--",
      "2: Bug #45226 (xmlrpc_set_type() segfaults with valid ISO8601 date string)",
      "3: --INI--",
      "4: date.timezone=\"America/Sao_Paulo\"",
      "5: --FILE--",
      "6: <?php",
      "8: $d = date(DATE_ISO8601);",
      "9: xmlrpc_set_type($d, 'datetime');",
      "10: echo xmlrpc_encode_request('method.call', array('date' => $d));",
      "12: $d = '2008-01-01 20:00:00';",
      "13: xmlrpc_set_type($d, 'datetime');",
      "14: echo xmlrpc_encode_request('method.call', array('date' => $d));",
      "16: ?>",
      "17: --EXPECTF--",
      "18: <?xml version=\"1.0\" encoding=\"iso-8859-1\"?>",
      "19: <methodCall>",
      "20: <methodName>method.call</methodName>",
      "21: <params>",
      "22:  <param>",
      "23:   <value>",
      "24:    <struct>",
      "25:     <member>",
      "26:      <name>date</name>",
      "27:      <value>",
      "28:       <dateTime.iso8601>%d-%d-%dT%d:%d:%d%s%d</dateTime.iso8601>",
      "29:      </value>",
      "30:     </member>",
      "31:    </struct>",
      "32:   </value>",
      "33:  </param>",
      "34: </params>",
      "35: </methodCall>",
      "36: <?xml version=\"1.0\" encoding=\"iso-8859-1\"?>",
      "37: <methodCall>",
      "38: <methodName>method.call</methodName>",
      "39: <params>",
      "40:  <param>",
      "41:   <value>",
      "42:    <struct>",
      "43:     <member>",
      "44:      <name>date</name>",
      "45:      <value>",
      "46:       <dateTime.iso8601>%d-%d-%d %d:%d:%d</dateTime.iso8601>",
      "47:      </value>",
      "48:     </member>",
      "49:    </struct>",
      "50:   </value>",
      "51:  </param>",
      "52: </params>",
      "53: </methodCall>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "da2f2ab13053effaedbae19fed49bde98c4f4c1f",
      "candidate_info": {
        "commit_hash": "da2f2ab13053effaedbae19fed49bde98c4f4c1f",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/da2f2ab13053effaedbae19fed49bde98c4f4c1f",
        "files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug18916.phpt",
          "ext/xmlrpc/tests/bug45226.phpt"
        ],
        "message": "MFH: - Merged fix from SF project (Import Jeff Lawsons patches for XML datetime bug fixes)   Fixed bugs:   #45226 (xmlrpc_set_type() segfaults with valid ISO8601 date string)   #18916 (xmlrpc_set_type() \"not working\")",
        "before_after_code_files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "ext/xmlrpc/tests/bug18916.phpt||ext/xmlrpc/tests/bug18916.phpt",
          "ext/xmlrpc/tests/bug45226.phpt||ext/xmlrpc/tests/bug45226.phpt"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug18916.phpt||ext/xmlrpc/tests/bug18916.phpt",
            "ext/xmlrpc/tests/bug45226.phpt||ext/xmlrpc/tests/bug45226.phpt"
          ],
          "candidate": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c",
            "ext/xmlrpc/tests/bug18916.phpt||ext/xmlrpc/tests/bug18916.phpt",
            "ext/xmlrpc/tests/bug45226.phpt||ext/xmlrpc/tests/bug45226.phpt"
          ]
        }
      },
      "candidate_diff": {
        "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
          "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "164: static int date_from_ISO8601 (const char *text, time_t * value) {",
          "165:    struct tm tm;",
          "166:    int n;",
          "167:    int i;",
          "170:  if (strchr (text, '-')) {",
          "171:   char *p = (char *) text, *p2 = buf;",
          "",
          "[Removed Lines]",
          "168:  char buf[18];",
          "",
          "[Added Lines]",
          "169: static time_t mkgmtime(struct tm *tm)",
          "170: {",
          "171:     static const int mdays[12] = {0,31,59,90,120,151,181,212,243,273,304,334};",
          "173:     return ((((((tm->tm_year - 70) * 365) + mdays[tm->tm_mon] + tm->tm_mday-1 +",
          "174:                   (tm->tm_year-68-1+(tm->tm_mon>=2))/4) * 24) + tm->tm_hour) * 60 +",
          "175:         tm->tm_min) * 60 + tm->tm_sec;",
          "176: }",
          "182:    char buf[30];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "173:    if (*p != '-') {",
          "175:     p2++;",
          "176:    }",
          "177:    p++;",
          "178:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "191:     if (p2-buf >= sizeof(buf)) {",
          "192:      return -1;",
          "193:     }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "183:    tm.tm_isdst = -1;",
          "189: #define XMLRPC_IS_NUMBER(x) if (x < '0' || x > '9') return -1;",
          "191:    n = 1000;",
          "",
          "[Removed Lines]",
          "185:    if(strlen(text) < 17) {",
          "186:       return -1;",
          "187:    }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "247: static int date_to_ISO8601 (time_t value, char *buf, int length) {",
          "248:    struct tm *tm, tmbuf;",
          "250:    if (!tm) {",
          "251:     return 0;",
          "252:    }",
          "254:  return strftime (buf, length, \"%Y-%m-%dT%H:%M:%SZ\", tm);",
          "255: #else",
          "257: #endif",
          "258: }",
          "",
          "[Removed Lines]",
          "249:    tm = php_localtime_r(&value, &tmbuf);",
          "256:    return strftime(buf, length, \"%Y%m%dT%H:%M:%S\", tm);",
          "",
          "[Added Lines]",
          "263:    tm = php_gmtime_r(&value, &tmbuf);",
          "270:    return strftime(buf, length, \"%Y%m%dT%H:%M:%SZ\", tm);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1524:       date_to_ISO8601(time, timeBuf, sizeof(timeBuf));",
          "1526:       if(timeBuf[0]) {",
          "1529:       }",
          "1530:    }",
          "1531: }",
          "",
          "[Removed Lines]",
          "1527:          simplestring_clear(&value->str);",
          "1528:          simplestring_add(&value->str, timeBuf);",
          "",
          "[Added Lines]",
          "1541:          XMLRPC_SetValueDateTime_ISO8601 (value, timeBuf);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1701:    if(value) {",
          "1702:       time_t time_val = 0;",
          "1703:       if(s) {",
          "1704:          date_from_ISO8601(s, &time_val);",
          "1706:       }",
          "1707:    }",
          "1708: }",
          "",
          "[Removed Lines]",
          "1705:          XMLRPC_SetValueDateTime(value, time_val);",
          "",
          "[Added Lines]",
          "1717:          value->type = xmlrpc_datetime;",
          "1719:          value->i = time_val;",
          "1720:          simplestring_clear(&value->str);",
          "1721:          simplestring_add(&value->str, s);",
          "",
          "---------------"
        ],
        "ext/xmlrpc/tests/bug18916.phpt||ext/xmlrpc/tests/bug18916.phpt": [
          "File: ext/xmlrpc/tests/bug18916.phpt -> ext/xmlrpc/tests/bug18916.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #18916 (xmlrpc_set_type() not working)",
          "3: --INI--",
          "4: date.timezone=\"America/Sao_Paulo\"",
          "5: --FILE--",
          "6: <?php",
          "8: $params = date(\"Ymd\\TH:i:s\", time());",
          "9: xmlrpc_set_type($params, 'datetime');",
          "10: echo xmlrpc_encode($params);",
          "12: ?>",
          "13: --EXPECTF--",
          "14: <?xml version=\"1.0\" encoding=\"utf-8\"?>",
          "15: <params>",
          "16: <param>",
          "17:  <value>",
          "18:   <dateTime.iso8601>%dT%d:%d:%d</dateTime.iso8601>",
          "19:  </value>",
          "20: </param>",
          "21: </params>",
          "",
          "---------------"
        ],
        "ext/xmlrpc/tests/bug45226.phpt||ext/xmlrpc/tests/bug45226.phpt": [
          "File: ext/xmlrpc/tests/bug45226.phpt -> ext/xmlrpc/tests/bug45226.phpt",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: --TEST--",
          "2: Bug #45226 (xmlrpc_set_type() segfaults with valid ISO8601 date string)",
          "3: --INI--",
          "4: date.timezone=\"America/Sao_Paulo\"",
          "5: --FILE--",
          "6: <?php",
          "8: $d = date(DATE_ISO8601);",
          "9: xmlrpc_set_type($d, 'datetime');",
          "10: echo xmlrpc_encode_request('method.call', array('date' => $d));",
          "12: $d = '2008-01-01 20:00:00';",
          "13: xmlrpc_set_type($d, 'datetime');",
          "14: echo xmlrpc_encode_request('method.call', array('date' => $d));",
          "16: ?>",
          "17: --EXPECTF--",
          "18: <?xml version=\"1.0\" encoding=\"iso-8859-1\"?>",
          "19: <methodCall>",
          "20: <methodName>method.call</methodName>",
          "21: <params>",
          "22:  <param>",
          "23:   <value>",
          "24:    <struct>",
          "25:     <member>",
          "26:      <name>date</name>",
          "27:      <value>",
          "28:       <dateTime.iso8601>%d-%d-%dT%d:%d:%d%s%d</dateTime.iso8601>",
          "29:      </value>",
          "30:     </member>",
          "31:    </struct>",
          "32:   </value>",
          "33:  </param>",
          "34: </params>",
          "35: </methodCall>",
          "36: <?xml version=\"1.0\" encoding=\"iso-8859-1\"?>",
          "37: <methodCall>",
          "38: <methodName>method.call</methodName>",
          "39: <params>",
          "40:  <param>",
          "41:   <value>",
          "42:    <struct>",
          "43:     <member>",
          "44:      <name>date</name>",
          "45:      <value>",
          "46:       <dateTime.iso8601>%d-%d-%d %d:%d:%d</dateTime.iso8601>",
          "47:      </value>",
          "48:     </member>",
          "49:    </struct>",
          "50:   </value>",
          "51:  </param>",
          "52: </params>",
          "53: </methodCall>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "ba2f87b50667f147c198abd31fc31eb09522f3d7",
      "candidate_info": {
        "commit_hash": "ba2f87b50667f147c198abd31fc31eb09522f3d7",
        "repo": "php/php-src",
        "commit_url": "https://github.com/php/php-src/commit/ba2f87b50667f147c198abd31fc31eb09522f3d7",
        "files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c"
        ],
        "message": "- Merged fix from SF project (Import Jeff Lawsons patches for XML datetime bug fixes)   Fixed bugs:   #45226 (xmlrpc_set_type() segfaults with valid ISO8601 date string)   #18916 (xmlrpc_set_type() \"not working\")",
        "before_after_code_files": [
          "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c"
          ],
          "candidate": [
            "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c"
          ]
        }
      },
      "candidate_diff": {
        "ext/xmlrpc/libxmlrpc/xmlrpc.c||ext/xmlrpc/libxmlrpc/xmlrpc.c": [
          "File: ext/xmlrpc/libxmlrpc/xmlrpc.c -> ext/xmlrpc/libxmlrpc/xmlrpc.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "167: static int date_from_ISO8601 (const char *text, time_t * value) {",
          "168:    struct tm tm;",
          "169:    int n;",
          "170:    int i;",
          "173:  if (strchr (text, '-')) {",
          "174:   char *p = (char *) text, *p2 = buf;",
          "",
          "[Removed Lines]",
          "171:  char buf[18];",
          "",
          "[Added Lines]",
          "172: static time_t mkgmtime(struct tm *tm)",
          "173: {",
          "174:     static const int mdays[12] = {0,31,59,90,120,151,181,212,243,273,304,334};",
          "176:     return ((((((tm->tm_year - 70) * 365) + mdays[tm->tm_mon] + tm->tm_mday-1 +",
          "177:                   (tm->tm_year-68-1+(tm->tm_mon>=2))/4) * 24) + tm->tm_hour) * 60 +",
          "178:         tm->tm_min) * 60 + tm->tm_sec;",
          "179: }",
          "185:    char buf[30];",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "176:    if (*p != '-') {",
          "178:     p2++;",
          "179:    }",
          "180:    p++;",
          "181:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "194:     if (p2-buf >= sizeof(buf)) {",
          "195:      return -1;",
          "196:     }",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "186:    tm.tm_isdst = -1;",
          "192: #define XMLRPC_IS_NUMBER(x) if (x < '0' || x > '9') return -1;",
          "194:    n = 1000;",
          "",
          "[Removed Lines]",
          "188:    if(strlen(text) < 17) {",
          "189:       return -1;",
          "190:    }",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "250: static int date_to_ISO8601 (time_t value, char *buf, int length) {",
          "251:    struct tm *tm, tmbuf;",
          "253:    if (!tm) {",
          "254:     return 0;",
          "255:    }",
          "257:  return strftime (buf, length, \"%Y-%m-%dT%H:%M:%SZ\", tm);",
          "258: #else",
          "260: #endif",
          "261: }",
          "",
          "[Removed Lines]",
          "252:    tm = php_localtime_r(&value, &tmbuf);",
          "259:    return strftime(buf, length, \"%Y%m%dT%H:%M:%S\", tm);",
          "",
          "[Added Lines]",
          "266:    tm = php_gmtime_r(&value, &tmbuf);",
          "273:    return strftime(buf, length, \"%Y%m%dT%H:%M:%SZ\", tm);",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "1527:       date_to_ISO8601(time, timeBuf, sizeof(timeBuf));",
          "1529:       if(timeBuf[0]) {",
          "1532:       }",
          "1533:    }",
          "1534: }",
          "",
          "[Removed Lines]",
          "1530:          simplestring_clear(&value->str);",
          "1531:          simplestring_add(&value->str, timeBuf);",
          "",
          "[Added Lines]",
          "1544:          XMLRPC_SetValueDateTime_ISO8601 (value, timeBuf);",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "1704:    if(value) {",
          "1705:       time_t time_val = 0;",
          "1706:       if(s) {",
          "1707:          date_from_ISO8601(s, &time_val);",
          "1709:       }",
          "1710:    }",
          "1711: }",
          "",
          "[Removed Lines]",
          "1708:          XMLRPC_SetValueDateTime(value, time_val);",
          "",
          "[Added Lines]",
          "1720:          value->type = xmlrpc_datetime;",
          "1722:          value->i = time_val;",
          "1723:          simplestring_clear(&value->str);",
          "1724:          simplestring_add(&value->str, s);",
          "",
          "---------------"
        ]
      }
    }
  ]
}