{
  "cve_id": "CVE-2019-19646",
  "cve_desc": "pragma.c in SQLite through 3.30.1 mishandles NOT NULL in an integrity_check PRAGMA command in certain cases of generated columns.",
  "repo": "sqlite/sqlite",
  "patch_hash": "ebd70eedd5d6e6a890a670b5ee874a5eae86b4dd",
  "patch_info": {
    "commit_hash": "ebd70eedd5d6e6a890a670b5ee874a5eae86b4dd",
    "repo": "sqlite/sqlite",
    "commit_url": "https://github.com/sqlite/sqlite/commit/ebd70eedd5d6e6a890a670b5ee874a5eae86b4dd",
    "files": [
      "manifest",
      "manifest.uuid",
      "src/pragma.c",
      "test/gencol1.test"
    ],
    "message": "Fix the NOT NULL verification logic in PRAGMA integrity_check so that it works for generated columns whose value is the result of a comparison operator. Ticket [bd8c280671ba44a7]\n\nFossilOrigin-Name: f3b39c71b88cb6721f443de56cdce4c08252453a5e340b00a2bd88dc10c42400",
    "before_after_code_files": [
      "manifest.uuid||manifest.uuid",
      "src/pragma.c||src/pragma.c",
      "test/gencol1.test||test/gencol1.test"
    ]
  },
  "patch_diff": {
    "manifest.uuid||manifest.uuid": [
      "File: manifest.uuid -> manifest.uuid",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "1: e3398c5ffb060b2b26334b8598e2c63953741e2d6f5124dbd6bdfc8e94742539",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "src/pragma.c||src/pragma.c": [
      "File: src/pragma.c -> src/pragma.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "1596:           if( j==pTab->iPKey ) continue;",
      "1597:           if( pTab->aCol[j].notNull==0 ) continue;",
      "1598:           sqlite3ExprCodeGetColumnOfTable(v, pTab, iDataCur, j, 3);",
      "1600:           jmp2 = sqlite3VdbeAddOp1(v, OP_NotNull, 3); VdbeCoverage(v);",
      "1601:           zErr = sqlite3MPrintf(db, \"NULL value in %s.%s\", pTab->zName,",
      "1602:                               pTab->aCol[j].zName);",
      "",
      "[Removed Lines]",
      "1599:           sqlite3VdbeChangeP5(v, OPFLAG_TYPEOFARG);",
      "",
      "[Added Lines]",
      "1599:           if( sqlite3VdbeGetOp(v,-1)->opcode==OP_Column ){",
      "1600:             sqlite3VdbeChangeP5(v, OPFLAG_TYPEOFARG);",
      "1601:           }",
      "",
      "---------------"
    ],
    "test/gencol1.test||test/gencol1.test": [
      "File: test/gencol1.test -> test/gencol1.test",
      "--- Hunk 1 ---",
      "[Context before]",
      "328:   INSERT OR REPLACE INTO t0(c0, c1) VALUES (2, 1), (1, 0)",
      "329: } {1 {FOREIGN KEY constraint failed}}",
      "331: finish_test",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "331: # 2019-12-09 ticket bd8c280671ba44a7",
      "332: # With generated columns, the sqlite3ExprGetColumnOfTable() routine might",
      "333: # generate a code sequence that does not end with OP_Column.  So check to",
      "334: # make sure that the last instruction generated is an OP_column prior to",
      "335: # applying the OPFLAG_TYPEOFARG optimization to NOT NULL checks in the",
      "336: # PRAGMA integrity_check code.",
      "337: #",
      "338: sqlite3 db :memory:",
      "339: do_execsql_test gencol1-12.10 {",
      "340:   CREATE TABLE t0 (c0, c1 NOT NULL AS (c0==0));",
      "341:   INSERT INTO t0(c0) VALUES (0);",
      "342:   PRAGMA integrity_check;",
      "343: } {ok}",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "14e3e22773e64c78f2184b78ce83734d06713c7f",
      "candidate_info": {
        "commit_hash": "14e3e22773e64c78f2184b78ce83734d06713c7f",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/14e3e22773e64c78f2184b78ce83734d06713c7f",
        "files": [
          "ext/fts3/fts3.c",
          "manifest",
          "manifest.uuid",
          "test/fts3corrupt4.test"
        ],
        "message": "Fix an assert() in fts3 that could fail when accessing a corrupt database.\n\nFossilOrigin-Name: 601ce9532d34f97a5faa170b6d8a272e5c54f2eabff84660201a1840e0fd9929",
        "before_after_code_files": [
          "ext/fts3/fts3.c||ext/fts3/fts3.c",
          "manifest.uuid||manifest.uuid",
          "test/fts3corrupt4.test||test/fts3corrupt4.test"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "ext/fts3/fts3.c||ext/fts3/fts3.c": [
          "File: ext/fts3/fts3.c -> ext/fts3/fts3.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "2474:     iWrite = *piPrev - iVal;",
          "2475:   }",
          "2476:   assert( *pbFirst || *piPrev==0 );",
          "",
          "[Removed Lines]",
          "2477:   assert( *pbFirst==0 || iWrite>0 );",
          "",
          "[Added Lines]",
          "2477:   assert_fts3_nc( *pbFirst==0 || iWrite>0 );",
          "2478:   assert( *pbFirst==0 || iWrite>=0 );",
          "",
          "---------------"
        ],
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: b6f2a7f9cdb547c925f08306df82519e41a7a0dd2cabd9861a48917bb6eef845",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "test/fts3corrupt4.test||test/fts3corrupt4.test": [
          "File: test/fts3corrupt4.test -> test/fts3corrupt4.test",
          "--- Hunk 1 ---",
          "[Context before]",
          "5329:   INSERT INTO t1(t1) SELECT x FROM t2;",
          "5330: } {1 {database disk image is malformed}}",
          "5332: finish_test",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5332: #-------------------------------------------------------------------------",
          "5333: #",
          "5334: reset_db",
          "5335: do_test 30.0 {",
          "5336:   sqlite3 db {}",
          "5337:   db deserialize [decode_hexdb {",
          "5338: | size 28672 pagesize 4096 filename crash-e6e3857edf9b26.db",
          "5339: | page 1 offset 0",
          "5340: |      0: 53 51 4c 69 74 65 20 66 6f 72 6d 61 74 20 33 00   SQLite format 3.",
          "5341: |     16: 10 00 01 01 00 40 20 20 00 00 00 00 00 00 00 00   .....@  ........",
          "5342: |     96: 00 00 00 00 0d 0e b1 00 06 0d a4 00 0f 8d 0f 21   ...............!",
          "5343: |    112: 0e b9 0d c8 0e 7e 0d a4 00 00 00 00 00 00 00 00   .....~..........",
          "5344: |   3488: 00 00 00 00 22 07 06 17 11 11 01 31 74 61 62 6c   ...........1tabl",
          "5345: |   3504: 65 74 32 74 32 07 43 52 45 41 54 45 20 54 41 42   et2t2.CREATE TAB",
          "5346: |   3520: 4c 45 20 74 32 28 78 29 81 33 05 07 17 1f 1f 01   LE t2(x).3......",
          "5347: |   3536: 82 35 74 61 62 6c 65 74 31 5f 73 65 67 64 69 72   .5tablet1_segdir",
          "5348: |   3552: 74 31 5f 73 65 67 64 69 72 05 43 52 45 41 54 45   t1_segdir.CREATE",
          "5349: |   3568: 20 54 41 42 4c 45 20 27 74 31 5f 73 65 67 64 69    TABLE 't1_segdi",
          "5350: |   3584: 72 27 28 6c 65 76 65 6c 20 49 4e 54 45 47 45 52   r'(level INTEGER",
          "5351: |   3600: 2c 69 64 78 20 49 4e 54 45 47 45 52 2c 73 74 61   ,idx INTEGER,sta",
          "5352: |   3616: 72 74 5f 62 6c 6f 63 6b 20 49 4e 54 45 47 45 52   rt_block INTEGER",
          "5353: |   3632: 2c 6c 65 61 76 65 73 5f 65 6e 64 5f 62 6c 6f 63   ,leaves_end_bloc",
          "5354: |   3648: 6b 20 49 4e 54 45 47 45 52 2c 65 6e 64 5f 62 6c   k INTEGER,end_bl",
          "5355: |   3664: 6f 63 6b 20 49 4e 54 45 47 45 62 2c 72 6f 6f 74   ock INTEGEb,root",
          "5356: |   3680: 20 42 4c 4f 42 2c 50 52 49 4d 41 52 59 20 4b 45    BLOB,PRIMARY KE",
          "5357: |   3696: 59 28 6c 65 76 65 6c 2c 20 69 64 78 29 29 31 06   Y(level, idx))1.",
          "5358: |   3712: 06 17 45 1f 01 00 69 6e 64 65 78 73 71 6c 69 74   ..E...indexsqlit",
          "5359: |   3728: 65 5f 61 75 74 6f 69 6e 64 65 78 5f 74 31 5f 73   e_autoindex_t1_s",
          "5360: |   3744: 65 67 64 69 72 5f 31 74 31 5f 73 65 67 64 69 72   egdir_1t1_segdir",
          "5361: |   3760: 06 0f c7 00 08 00 00 00 00 66 04 07 17 23 23 01   .........f...##.",
          "5362: |   3776: 81 13 74 61 62 6c 65 74 31 5f 73 65 67 6d 65 6e   ..tablet1_segmen",
          "5363: |   3792: 74 73 74 31 5f 73 65 67 6d 65 6e 74 73 04 43 52   tst1_segments.CR",
          "5364: |   3808: 45 41 54 45 20 54 41 42 4c 45 20 27 74 31 5f 73   EATE TABLE 't1_s",
          "5365: |   3824: 65 67 6d 65 6e 74 73 27 28 62 6c 6f 63 6b 69 64   egments'(blockid",
          "5366: |   3840: 20 49 4e 54 45 47 45 52 20 50 52 49 4d 41 52 59    INTEGER PRIMARY",
          "5367: |   3856: 20 4b 45 59 2c 20 62 6c 6f 63 6b 20 42 4c 4f 42    KEY, block BLOB",
          "5368: |   3872: 29 6a 03 07 17 21 21 01 81 1f 74 61 62 6c 65 74   )j...!!...tablet",
          "5369: |   3888: 31 5f 63 6f 6e 74 65 6e 74 74 31 5f 63 6f 6e 74   1_contentt1_cont",
          "5370: |   3904: 65 6e 74 03 43 52 45 41 54 45 20 54 41 42 4c 45   ent.CREATE TABLE",
          "5371: |   3920: 20 27 74 31 5f 63 6f 6e 74 65 6e 74 27 28 64 6f    't1_content'(do",
          "5372: |   3936: 63 69 64 20 49 4e 54 45 47 45 52 20 50 52 49 4d   cid INTEGER PRIM",
          "5373: |   3952: 41 52 59 20 4b 45 59 2c 20 27 63 30 61 27 2c 20   ARY KEY, 'c0a',",
          "5374: |   3968: 27 63 31 62 27 2c 20 27 63 32 63 27 29 38 02 06   'c1b', 'c2c')8..",
          "5375: |   3984: 17 11 11 08 5f 74 61 62 6c 65 74 31 74 31 43 52   ...._tablet1t1CR",
          "5376: |   4000: 45 41 54 45 20 56 49 52 54 55 41 4c 20 54 41 42   EATE VIRTUAL TAB",
          "5377: |   4016: 4c 45 20 74 31 20 55 53 49 4e 47 20 66 74 73 33   LE t1 USING fts3",
          "5378: |   4032: 28 61 2c 62 2c 63 29 00 00 00 00 00 00 00 00 00   (a,b,c).........",
          "5379: | page 3 offset 8192",
          "5380: |      0: 0d 00 00 00 25 0b 48 00 0f d8 0f af 0f 86 0f 74   ....%.H........t",
          "5381: |     16: 0f 61 0f 4e 0f 2f 0f 0f 0e ef 0e d7 0e be 0e a5   .a.N./..........",
          "5382: |     32: 0e 8d 0e 74 0e 5b 0e 40 0e 24 0e 08 0d ef 00 00   ...t.[.@.$......",
          "5383: |   2880: 00 00 00 00 00 00 00 00 81 3f 25 06 00 82 7e f0   .........?%...~.",
          "5384: |   2896: 00 43 4f 4d 50 49 4c 45 52 3d 67 63 63 2d 35 2e   .COMPILER=gcc-5.",
          "5385: |   2912: 34 23 00 20 32 30 31 36 30 36 30 39 20 44 45 42   4#. 20160609 DEB",
          "5386: |   2928: 55 47 20 45 4e 41 42 4c 45 20 44 42 53 54 41 54   UG ENABLE DBSTAT",
          "5387: |   2944: 20 56 54 41 42 20 45 4e 42 92 4c 45 20 46 54 53    VTAB ENB.LE FTS",
          "5388: |   2960: 34 20 45 4e 41 42 4c 45 20 46 54 53 35 20 45 4e   4 ENABLE FTS5 EN",
          "5389: |   2976: 41 42 4c 45 20 47 45 4f 50 4f 4c 59 20 45 4e 41   ABLE GEOPOLY ENA",
          "5390: |   2992: 42 4c 45 1f 4a 53 4f 4e 31 20 45 4e 41 42 4c 49   BLE.JSON1 ENABLI",
          "5391: |   3008: 00 4d 45 4d 53 59 53 35 20 45 4e 41 42 4c 45 20   .MEMSYS5 ENABLE",
          "5392: |   3024: 52 54 52 45 45 20 4d 41 58 20 4d 45 4d 4f 52 59   RTREE MAX MEMORY",
          "5393: |   3040: 3d 35 30 30 30 30 30 30 30 20 4f 4d 49 54 20 4c   =50000000 OMIT L",
          "5394: |   3056: 4f 41 44 20 45 58 54 45 4e 53 49 4f 4e 20 54 48   OAD EXTENSION TH",
          "5395: |   3072: 52 45 41 44 53 41 46 45 3d 30 18 24 05 00 25 0f   READSAFE=0.$..%.",
          "5396: |   3088: 19 54 48 52 45 41 44 53 41 46 45 3d 30 58 42 49   .THREADSAFE=0XBI",
          "5397: |   3104: 4e 41 52 59 18 23 05 00 25 0f 19 54 48 52 45 41   NARY.#..%..THREA",
          "5398: |   3120: 44 53 41 46 45 3d 30 88 4e 4f 43 41 53 45 17 22   DSAFE=0.NOCASE..",
          "5399: |   3136: 05 00 25 0f 17 54 48 52 45 41 44 53 41 46 45 3d   ..%..THREADSAFE=",
          "5400: |   3152: 30 58 52 54 52 49 4d 1f 21 05 00 33 0f 19 4f 4d   0XRTRIM.!..3..OM",
          "5401: |   3168: 49 54 20 4c 4f 41 44 20 45 58 54 45 4e 53 49 4f   IT LOAD EXTENSIO",
          "5402: |   3184: 4e 58 42 49 4e 41 52 59 1f 20 05 00 33 0f 19 4f   NXBINARY. ..3..O",
          "5403: |   3200: 4d 49 54 20 4c 4f 41 44 20 45 58 54 45 4e 53 49   MIT LOAD EXTENSI",
          "5404: |   3216: 4f 4e 58 4e 4f 43 41 53 45 1e 20 05 00 33 0f 17   ONXNOCASE. ..3..",
          "5405: |   3232: 4f 4d 49 54 20 4c 4f 41 54 20 45 58 54 45 4e 53   OMIT LOAT EXTENS",
          "5406: |   3248: 49 4f 4e 58 52 54 52 49 4d 1f 1e 04 00 33 0f 19   IONXRTRIM....3..",
          "5407: |   3264: 82 41 58 20 4d 45 4d 4f 52 59 3d 35 30 30 30 30   .AX MEMORY=50000",
          "5408: |   3280: 30 30 30 58 42 49 4e 41 52 59 1f 1d 05 00 33 0f   000XBINARY....3.",
          "5409: |   3296: 19 4d 41 58 20 4d 45 4d 4f 52 59 3d 35 30 30 30   .MAX MEMORY=5000",
          "5410: |   3312: 30 30 30 30 58 4e 4f 43 41 53 45 1e 1c 05 00 33   0000XNOCASE....3",
          "5411: |   3328: 0f 17 4d 41 58 20 4d 45 4d fa 52 59 3d 35 30 20   ..MAX MEM.RY=50",
          "5412: |   3344: 30 30 30 30 30 58 52 54 52 49 4d 18 1b 05 00 25   00000XRTRIM....%",
          "5413: |   3360: 0f 19 45 4e 41 42 4c 45 20 52 53 52 45 45 58 42   ..ENABLE RSREEXB",
          "5414: |   3376: 49 4e 41 52 59 18 1a 05 00 25 0f 19 45 4e 41 42   INARY....%..ENAB",
          "5415: |   3392: 4c 45 20 52 54 52 45 45 58 4e 4f 53 41 53 45 17   LE RTREEXNOSASE.",
          "5416: |   3408: 19 05 00 25 0f 17 45 4e 42 42 4c 45 20 52 54 52   ...%..ENBBLE RTR",
          "5417: |   3424: 45 45 58 52 54 52 49 4d 1a 18 05 00 29 0f 19 45   EEXRTRIM....)..E",
          "5418: |   3440: 4e 41 42 4c 45 20 4d 45 4d 53 5a 53 35 58 42 49   NABLE MEMSZS5XBI",
          "5419: |   3456: 4e 41 52 59 1a 17 05 00 29 0f 19 45 4e 41 42 3c   NARY....)..ENAB<",
          "5420: |   3472: 45 20 4d 45 4d 53 59 53 35 58 4e 4f 43 41 53 45   E MEMSYS5XNOCASE",
          "5421: |   3488: 19 16 05 00 29 0f 17 45 4e 41 42 4c 45 20 4d 45   ....)..ENABLE ME",
          "5422: |   3504: 4d 53 59 53 35 58 52 54 52 49 4d 18 15 05 00 25   MSYS5XRTRIM....%",
          "5423: |   3520: 0f 19 45 4e 41 42 4c 45 20 4a 53 4f 4e 31 58 42   ..ENABLE JSON1XB",
          "5424: |   3536: 49 4e 41 52 59 18 14 05 00 25 0f 19 45 4e 41 42   INARY....%..ENAB",
          "5425: |   3552: 4c 45 20 4a 53 4f 4e 31 58 4e 4f 43 41 53 45 17   LE JSON1XNOCASE.",
          "5426: |   3568: 13 05 00 25 0f 17 45 4e 41 42 4c 45 20 4a 53 4f   ...%..ENABLE JSO",
          "5427: |   3584: 4e 31 58 52 54 52 49 4d 1a 12 05 00 29 0f 19 45   N1XRTRIM....)..E",
          "5428: |   3600: 4e 31 42 4c 45 20 47 45 4e 50 4f 4c 59 58 42 49   N1BLE GENPOLYXBI",
          "5429: |   3616: 4e 41 52 59 1a 11 05 00 29 0f 19 45 4e f2 1e 4c   NARY....)..EN..L",
          "5430: |   3632: 45 20 47 45 4f 50 4f 4c 59 58 4e 4f 43 41 53 45   E GEOPOLYXNOCASE",
          "5431: |   3648: 19 10 05 00 29 0f 17 45 4e 41 42 4c 45 20 47 45   ....)..ENABLE GE",
          "5432: |   3664: 4f 50 4f 4c 59 58 52 54 52 49 4d 17 0f 05 00 23   OPOLYXRTRIM....#",
          "5433: |   3680: 0f 19 45 4e 41 42 4c 45 20 46 54 53 35 58 42 49   ..ENABLE FTS5XBI",
          "5434: |   3696: 4e 41 52 59 17 0e 05 00 23 0f 19 45 4e 41 42 3c   NARY....#..ENAB<",
          "5435: |   3712: 45 20 46 54 53 35 58 4e 4f 43 41 53 45 16 0d 05   E FTS5XNOCASE...",
          "5436: |   3728: 00 23 0f 17 45 4e 41 42 4c 45 20 46 54 53 35 58   .#..ENABLE FTS5X",
          "5437: |   3744: 52 54 52 49 4d 17 0c 05 00 23 0f 19 45 4e 41 42   RTRIM....#..ENAB",
          "5438: |   3760: 4c 45 20 46 54 53 34 58 42 49 4e 41 52 59 17 0b   LE FTS4XBINARY..",
          "5439: |   3776: 05 00 23 0f 19 45 4e 41 43 4c 45 20 46 54 53 35   ..#..ENACLE FTS5",
          "5440: |   3792: 58 4e 4f 43 40 53 45 16 0a 05 00 23 0f 17 45 4e   XNOC@SE....#..EN",
          "5441: |   3808: 41 42 4c 45 20 46 54 53 34 58 52 54 52 49 4d 1e   ABLE FTS4XRTRIM.",
          "5442: |   3824: 09 05 00 31 0f 19 45 4e 41 42 4c 45 20 44 42 53   ...1..ENABLE DBS",
          "5443: |   3840: 54 41 55 20 56 54 41 42 58 42 49 4e 41 52 59 1e   TAU VTABXBINARY.",
          "5444: |   3856: 08 05 00 31 0f 19 45 4e 41 42 4c 45 20 44 42 53   ...1..ENABLE DBS",
          "5445: |   3872: 54 41 54 20 56 54 41 42 58 4e 4f 43 41 53 45 1d   TAT VTABXNOCASE.",
          "5446: |   3888: 07 05 00 31 0f 17 45 4e 41 42 4c 45 20 44 42 53   ...1..ENABLE DBS",
          "5447: |   3904: 54 41 54 20 56 54 41 42 58 52 54 62 49 4d 11 06   TAT VTABXRTbIM..",
          "5448: |   3920: 05 00 17 0f 19 44 45 42 54 47 58 42 49 4e 41 52   .....DEBTGXBINAR",
          "5449: |   3936: 59 11 05 05 00 17 0f 19 54 45 42 55 47 58 4e 4f   Y.......TEBUGXNO",
          "5450: |   3952: 43 41 53 45 10 04 05 00 17 0f 17 44 45 42 55 47   CASE.......DEBUG",
          "5451: |   3968: 68 52 54 52 49 4d 27 03 05 00 43 0f 19 43 4f 4d   hRTRIM'...C..COM",
          "5452: |   3984: 50 49 4c 45 52 3d 67 63 63 2d 35 2e 34 2e 30 20   PILER=gcc-5.4.0",
          "5453: |   4000: 32 30 31 36 30 36 30 39 58 42 49 4e 41 52 59 27   20160609XBINARY'",
          "5454: |   4016: 02 05 00 43 0f 19 43 4f 4d 50 49 4c 45 52 3d 67   ...C..COMPILER=g",
          "5455: |   4032: 63 63 2d 35 2e 34 2e 30 20 32 30 31 36 30 36 30   cc-5.4.0 2016060",
          "5456: |   4048: 39 58 4f 4f 43 41 53 45 26 01 05 00 43 0f 17 43   9XOOCASE&...C..C",
          "5457: |   4064: 4f 4d 50 49 4c 45 52 3d 67 63 63 2d 35 2e 34 2e   OMPILER=gcc-5.4.",
          "5458: |   4080: 30 20 32 30 31 36 30 36 30 39 58 52 54 52 49 4d   0 20160609XRTRIM",
          "5459: | page 4 offset 12288",
          "5460: |      0: 0d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................",
          "5461: | page 5 offset 16384",
          "5462: |      0: 0d 00 00 00 02 0b a0 00 0c ad 0b a0 00 00 00 00   ................",
          "5463: |   2976: 82 0a 02 08 08 09 08 08 17 84 06 30 20 32 35 33   ...........0 253",
          "5464: |   2992: 00 01 30 04 25 06 1b 00 00 08 32 30 31 36 30 36   ..0.%.....201606",
          "5465: |   3008: 30 39 03 25 07 00 00 01 34 03 25 05 00 00 01 35   09.%....4.%....5",
          "5466: |   3024: 03 25 04 00 01 07 30 30 30 30 30 30 30 03 25 1a   .%....0000000.%.",
          "5467: |   3040: 00 00 08 63 6f 6d 70 69 6c 65 72 03 25 02 00 00   ...compiler.%...",
          "5468: |   3056: 06 64 62 73 74 61 74 03 25 0a 00 01 04 65 62 75   .dbstat.%....ebu",
          "5469: |   3072: 67 03 25 08 00 00 06 65 6e 61 62 6c 65 09 25 09   g.%....enable.%.",
          "5470: |   3088: 05 04 04 04 04 04 00 01 08 78 74 65 6e 73 69 6f   .........xtensio",
          "5471: |   3104: 6e 03 25 1d 00 00 04 66 74 73 34 03 25 0d 00 03   n.%....fts4.%...",
          "5472: |   3120: 01 35 03 25 0f 00 00 03 67 63 63 03 25 03 00 01   .5.%....gcc.%...",
          "5473: |   3136: 06 65 6f 70 6f 6c 79 03 25 11 00 00 05 6a 73 6f   .eopoly.%....jso",
          "5474: |   3152: 6e 31 03 25 14 00 e8 04 6c 6f 61 64 03 25 1c 00   n1.%....load.%..",
          "5475: |   3168: 00 03 6d 61 78 03 25 18 00 01 05 65 6d 6f 72 79   ..max.%....emory",
          "5476: |   3184: 03 25 19 00 03 04 73 79 73 35 03 25 15 00 00 04   .%....sys5.%....",
          "5477: |   3200: 6f 6d 69 74 03 25 1b 00 00 05 72 74 72 65 65 03   omit.%....rtree.",
          "5478: |   3216: 25 17 00 00 0a 74 68 72 65 61 64 73 61 66 65 03   %....threadsafe.",
          "5479: |   3232: 25 1e 00 00 04 76 74 61 62 03 25 0b 00 86 50 01   %....vtab.%...P.",
          "5480: |   3248: 08 08 08 08 08 17 8d 12 30 20 38 33 35 00 01 30   ........0 835..0",
          "5481: |   3264: 12 01 06 00 01 06 00 01 06 00 1f 03 00 01 03 00   ................",
          "5482: |   3280: 01 03 00 00 08 32 30 31 36 30 36 30 39 09 01 07   .....20160609...",
          "5483: |   3296: 00 01 07 00 01 07 00 00 01 34 09 01 05 00 01 05   .........4......",
          "5484: |   3312: 00 01 05 00 00 01 35 09 01 04 00 01 04 00 01 04   ......5.........",
          "5485: |   3328: 00 01 07 30 30 30 30 30 30 30 09 1c 04 00 01 04   ...0000000......",
          "5486: |   3344: 00 01 04 00 00 06 62 69 6e 61 72 79 3c 03 01 02   ......binary<...",
          "5487: |   3360: 02 00 03 01 02 02 00 03 01 02 02 00 03 01 02 02   ................",
          "5488: |   3376: 00 03 01 02 f2 00 03 01 02 02 00 03 01 02 02 00   ................",
          "5489: |   3392: 03 01 02 02 00 03 01 02 02 00 03 01 02 02 00 03   ................",
          "5490: |   3408: 01 02 02 00 03 01 02 02 00 00 08 63 6f 6d 70 69   ...........compi",
          "5491: |   3424: 6c 65 72 09 01 02 00 01 02 00 01 02 00 00 06 64   ler............d",
          "5492: |   3440: 62 73 74 61 74 09 07 03 00 01 03 00 01 03 00 01   bstat...........",
          "5493: |   3456: 04 65 62 75 67 09 04 02 00 01 02 00 01 02 00 00   .ebug...........",
          "5494: |   3472: 06 65 6e 60 62 6c 65 3f 07 02 00 01 02 00 01 01   .en`ble?........",
          "5495: |   3488: ff f1 b1 00 00 02 3f 01 01 f0 f1 02 00 57 02 00   ......?......W..",
          "5496: |   3504: 01 02 00 01 02 00 01 02 00 01 02 00 01 02 10 01   ................",
          "5497: |   3520: 02 00 01 02 00 01 02 00 01 02 01 01 02 00 01 02   ................",
          "5498: |   3536: 00 01 02 00 00 f2 00 01 08 78 74 65 6e 73 69 6f   .........xtensio",
          "5499: |   3552: 6e 09 1f 04 00 01 04 00 01 04 00 00 04 66 74 73   n............fts",
          "5500: |   3568: 34 09 0a 03 00 01 03 00 01 03 00 03 01 35 09 0d   4............5..",
          "5501: |   3584: 03 00 01 03 00 01 03 00 00 03 67 63 63 09 01 03   ..........gcc...",
          "5502: |   3600: 00 01 03 00 01 03 00 01 06 65 6f 70 6f 6c 79 09   .........eopoly.",
          "5503: |   3616: 10 03 00 01 03 00 01 03 00 00 b3 6a 73 6f 6e 31   ...........json1",
          "5504: |   3632: 09 13 03 00 01 03 00 01 03 00 00 04 6c 6f 61 64   ............load",
          "5505: |   3648: 09 1f 03 00 01 03 00 01 03 00 00 03 6d 61 78 09   ............max.",
          "5506: |   3664: 1c 02 00 01 02 00 01 02 00 01 05 65 6d 6f 72 79   ...........emory",
          "5507: |   3680: 09 1c 03 00 01 03 00 01 03 00 03 04 73 79 73 35   ............sys5",
          "5508: |   3696: 09 16 03 00 01 03 00 01 03 cc 00 06 6e 6f 63 61   ............noca",
          "5509: |   3712: 73 65 3c 02 01 02 02 00 03 01 02 02 00 03 01 02   se<.............",
          "5510: |   3728: 02 00 03 01 02 02 00 03 01 02 02 00 03 01 02 02   ................",
          "5511: |   3744: 00 03 01 02 02 00 03 01 02 02 00 03 01 02 02 00   ................",
          "5512: |   3760: 03 01 02 02 00 03 01 02 02 00 03 01 02 02 00 00   ................",
          "5513: |   3776: 04 6f 6d 69 74 09 1f 02 00 01 02 00 01 02 00 00   .omit...........",
          "5514: |   3792: 05 72 74 62 65 65 09 19 03 00 01 03 00 01 03 00   .rtbee..........",
          "5515: |   3808: 03 02 69 6d 3c 01 01 02 02 00 03 01 02 02 00 03   ..im<...........",
          "5516: |   3824: 01 02 02 00 03 01 02 02 00 03 01 02 02 00 03 01   ................",
          "5517: |   3840: 02 02 00 03 01 02 02 00 03 01 02 02 00 03 01 02   ................",
          "5518: |   3856: 02 00 03 01 02 02 00 03 01 02 01 00 03 01 02 02   ................",
          "5519: |   3872: 00 00 0a 74 68 72 65 61 64 73 61 66 65 09 22 02   ...threadsafe...",
          "5520: |   3888: 00 01 02 00 02 02 00 00 04 76 74 61 62 09 07 04   .........vtab...",
          "5521: |   3904: 00 01 03 00 01 04 00 00 01 78 b4 01 01 01 01 02   .........x......",
          "5522: |   3920: 00 01 01 01 02 00 01 01 01 02 00 01 01 01 02 00   ................",
          "5523: |   3936: 01 01 01 02 00 01 01 01 02 00 01 01 01 02 00 01   ................",
          "5524: |   3952: 01 01 02 00 01 01 01 02 00 01 01 01 02 00 01 01   ................",
          "5525: |   3968: 01 02 00 01 01 01 02 00 01 01 01 02 00 01 01 01   ................",
          "5526: |   3984: 02 01 01 01 01 02 00 01 01 01 02 00 01 01 01 02   ................",
          "5527: |   4000: 00 01 01 01 02 00 01 01 01 02 00 01 01 01 02 00   ................",
          "5528: |   4016: 01 01 01 02 00 01 01 01 02 00 01 01 01 02 00 01   ................",
          "5529: |   4032: 01 01 02 00 01 01 01 da 00 01 01 01 02 00 01 01   ................",
          "5530: |   4048: 01 02 00 01 01 01 01 ff ff 01 01 02 00 01 01 01   ................",
          "5531: |   4064: 02 00 01 01 01 02 00 01 01 01 02 00 01 01 01 02   ................",
          "5532: |   4080: 00 01 01 01 02 00 01 01 01 02 00 01 01 01 02 00   ................",
          "5533: | page 6 offset 20480",
          "5534: |      0: 0a 00 00 00 02 0f f5 00 0f fb 0f f5 01 00 00 00   ................",
          "5535: |   4080: 00 00 00 00 00 05 04 08 09 01 02 04 04 08 08 09   ................",
          "5536: | page 7 offset 24576",
          "5537: |      0: 01 6f 00 00 00 00 00 00 00 00 00 00 00 00 00 00   .o..............",
          "5538: | end crash-e6e3857edf9b26.db",
          "5539: }]} {}",
          "5541: do_execsql_test 30.1 {",
          "5542:   UPDATE t1 SET b=a;",
          "5543: }",
          "5545: do_catchsql_test 30.2 {",
          "5546:   SELECT (matchinfo(null)) FROM t1 WHERE t1 MATCH 'ee*e*e*e*e*e*e*Re*e*e*e**'",
          "5547: } {1 {database disk image is malformed}}",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "871b13492d12c8279954ba047d992e8ef3bbfb96",
      "candidate_info": {
        "commit_hash": "871b13492d12c8279954ba047d992e8ef3bbfb96",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/871b13492d12c8279954ba047d992e8ef3bbfb96",
        "files": [
          "ext/misc/prefixes.c",
          "manifest",
          "manifest.uuid",
          "src/test1.c"
        ],
        "message": "Fix a problem preventing testfixture from being built with SQLITE_OMIT_VIRTUALTABLE.\n\nFossilOrigin-Name: d2cca36adc69d2c8e7707d70cbd75c497eae6a1a3f8a9dd18249ca6804c9db5f",
        "before_after_code_files": [
          "ext/misc/prefixes.c||ext/misc/prefixes.c",
          "manifest.uuid||manifest.uuid",
          "src/test1.c||src/test1.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "ext/misc/prefixes.c||ext/misc/prefixes.c": [
          "File: ext/misc/prefixes.c -> ext/misc/prefixes.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "22: #if !defined(SQLITEINT_H)",
          "23: #include \"sqlite3ext.h\"",
          "24: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22: #if !defined(SQLITE_CORE) || !defined(SQLITE_OMIT_VIRTUALTABLE)",
          "",
          "---------------"
        ],
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 3087a0c31e9fbfaedb7cf10a2fda59bc22318ff178614aefcc00ac83d9a7bb14",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/test1.c||src/test1.c": [
          "File: src/test1.c -> src/test1.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "7141:   extern int sqlite3_ieee_init(sqlite3*,char**,const sqlite3_api_routines*);",
          "7142:   extern int sqlite3_nextchar_init(sqlite3*,char**,const sqlite3_api_routines*);",
          "7143:   extern int sqlite3_percentile_init(sqlite3*,char**,const sqlite3_api_routines*);",
          "7144:   extern int sqlite3_prefixes_init(sqlite3*,char**,const sqlite3_api_routines*);",
          "7145:   extern int sqlite3_regexp_init(sqlite3*,char**,const sqlite3_api_routines*);",
          "7146:   extern int sqlite3_remember_init(sqlite3*,char**,const sqlite3_api_routines*);",
          "7147:   extern int sqlite3_series_init(sqlite3*,char**,const sqlite3_api_routines*);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7144: #ifndef SQLITE_OMIT_VIRTUALTABLE",
          "7146: #endif",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "7167:     { \"ieee754\",               sqlite3_ieee_init                 },",
          "7168:     { \"nextchar\",              sqlite3_nextchar_init             },",
          "7169:     { \"percentile\",            sqlite3_percentile_init           },",
          "7170:     { \"prefixes\",              sqlite3_prefixes_init             },",
          "7171:     { \"regexp\",                sqlite3_regexp_init               },",
          "7172:     { \"remember\",              sqlite3_remember_init             },",
          "7173:     { \"series\",                sqlite3_series_init               },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7172: #ifndef SQLITE_OMIT_VIRTUALTABLE",
          "7174: #endif",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "11d88e68abdf23f131dca81ad8d3517a5cf8449b",
      "candidate_info": {
        "commit_hash": "11d88e68abdf23f131dca81ad8d3517a5cf8449b",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/11d88e68abdf23f131dca81ad8d3517a5cf8449b",
        "files": [
          "manifest",
          "manifest.uuid",
          "src/main.c",
          "src/select.c",
          "src/shell.c.in",
          "src/sqlite.h.in",
          "src/sqliteInt.h",
          "src/tclsqlite.c",
          "test/tclsqlite.test",
          "test/view.test"
        ],
        "message": "Add the SQLITE_DBCONFIG_ENABLE_VIEW option, together with a \"db config\" command in the TCL interface that can access that option as well as all the other sqlite3_db_config() boolean options.\n\nFossilOrigin-Name: 61b4bccd2984f4c2cf50f58ef08677588e57aa7e079af07473b2e188d9ce4f52",
        "before_after_code_files": [
          "manifest.uuid||manifest.uuid",
          "src/main.c||src/main.c",
          "src/select.c||src/select.c",
          "src/shell.c.in||src/shell.c.in",
          "src/sqlite.h.in||src/sqlite.h.in",
          "src/sqliteInt.h||src/sqliteInt.h",
          "src/tclsqlite.c||src/tclsqlite.c",
          "test/tclsqlite.test||test/tclsqlite.test",
          "test/view.test||test/view.test"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 98357d8c1263920b33a3648ef9214a63c99728bafa7a8d3dd6a1241b2303fd42",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/main.c||src/main.c": [
          "File: src/main.c -> src/main.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "836:       } aFlagOp[] = {",
          "837:         { SQLITE_DBCONFIG_ENABLE_FKEY,           SQLITE_ForeignKeys    },",
          "838:         { SQLITE_DBCONFIG_ENABLE_TRIGGER,        SQLITE_EnableTrigger  },",
          "839:         { SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER, SQLITE_Fts3Tokenizer  },",
          "840:         { SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION, SQLITE_LoadExtension  },",
          "841:         { SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE,      SQLITE_NoCkptOnClose  },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "839:         { SQLITE_DBCONFIG_ENABLE_VIEW,           SQLITE_EnableView     },",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "3075:   db->nMaxSorterMmap = 0x7FFFFFFF;",
          "3076:   db->flags |= SQLITE_ShortColNames",
          "3077:                  | SQLITE_EnableTrigger",
          "3078:                  | SQLITE_CacheSpill",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3079:                  | SQLITE_EnableView",
          "",
          "---------------"
        ],
        "src/select.c||src/select.c": [
          "File: src/select.c -> src/select.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "4906:         u8 eCodeOrig = pWalker->eCode;",
          "4907:         if( sqlite3ViewGetColumnNames(pParse, pTab) ) return WRC_Abort;",
          "4908:         assert( pFrom->pSelect==0 );",
          "4909:         pFrom->pSelect = sqlite3SelectDup(db, pTab->pSelect, 0);",
          "4910:         nCol = pTab->nCol;",
          "4911:         pTab->nCol = -1;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "4909:         if( pTab->pSelect && (db->flags & SQLITE_EnableView)==0 ){",
          "4910:           sqlite3ErrorMsg(pParse, \"access to view \\\"%s\\\" prohibited\",",
          "4911:               pTab->zName);",
          "4912:         }",
          "",
          "---------------"
        ],
        "src/shell.c.in||src/shell.c.in": [
          "File: src/shell.c.in -> src/shell.c.in",
          "--- Hunk 1 ---",
          "[Context before]",
          "7135:     } aDbConfig[] = {",
          "7136:         { \"enable_fkey\",        SQLITE_DBCONFIG_ENABLE_FKEY           },",
          "7137:         { \"enable_trigger\",     SQLITE_DBCONFIG_ENABLE_TRIGGER        },",
          "7138:         { \"fts3_tokenizer\",     SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER },",
          "7139:         { \"load_extension\",     SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION },",
          "7140:         { \"no_ckpt_on_close\",   SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE      },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7138:         { \"enable_view\",        SQLITE_DBCONFIG_ENABLE_VIEW           },",
          "",
          "---------------"
        ],
        "src/sqlite.h.in||src/sqlite.h.in": [
          "File: src/sqlite.h.in -> src/sqlite.h.in"
        ],
        "src/sqliteInt.h||src/sqliteInt.h": [
          "File: src/sqliteInt.h -> src/sqliteInt.h"
        ],
        "src/tclsqlite.c||src/tclsqlite.c": [
          "File: src/tclsqlite.c -> src/tclsqlite.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "1917:     \"authorizer\",             \"backup\",                \"bind_fallback\",",
          "1918:     \"busy\",                   \"cache\",                 \"changes\",",
          "1919:     \"close\",                  \"collate\",               \"collation_needed\",",
          "1931:   };",
          "1932:   enum DB_enum {",
          "1933:     DB_AUTHORIZER,            DB_BACKUP,               DB_BIND_FALLBACK,",
          "1934:     DB_BUSY,                  DB_CACHE,                DB_CHANGES,",
          "1935:     DB_CLOSE,                 DB_COLLATE,              DB_COLLATION_NEEDED,",
          "1947:   };",
          "",
          "[Removed Lines]",
          "1920:     \"commit_hook\",            \"complete\",              \"copy\",",
          "1921:     \"deserialize\",            \"enable_load_extension\", \"errorcode\",",
          "1922:     \"eval\",                   \"exists\",                \"function\",",
          "1923:     \"incrblob\",               \"interrupt\",             \"last_insert_rowid\",",
          "1924:     \"nullvalue\",              \"onecolumn\",             \"preupdate\",",
          "1925:     \"profile\",                \"progress\",              \"rekey\",",
          "1926:     \"restore\",                \"rollback_hook\",         \"serialize\",",
          "1927:     \"status\",                 \"timeout\",               \"total_changes\",",
          "1928:     \"trace\",                  \"trace_v2\",              \"transaction\",",
          "1929:     \"unlock_notify\",          \"update_hook\",           \"version\",",
          "1930:     \"wal_hook\",               0",
          "1936:     DB_COMMIT_HOOK,           DB_COMPLETE,             DB_COPY,",
          "1937:     DB_DESERIALIZE,           DB_ENABLE_LOAD_EXTENSION,DB_ERRORCODE,",
          "1938:     DB_EVAL,                  DB_EXISTS,               DB_FUNCTION,",
          "1939:     DB_INCRBLOB,              DB_INTERRUPT,            DB_LAST_INSERT_ROWID,",
          "1940:     DB_NULLVALUE,             DB_ONECOLUMN,            DB_PREUPDATE,",
          "1941:     DB_PROFILE,               DB_PROGRESS,             DB_REKEY,",
          "1942:     DB_RESTORE,               DB_ROLLBACK_HOOK,        DB_SERIALIZE,",
          "1943:     DB_STATUS,                DB_TIMEOUT,              DB_TOTAL_CHANGES,",
          "1944:     DB_TRACE,                 DB_TRACE_V2,             DB_TRANSACTION,",
          "1945:     DB_UNLOCK_NOTIFY,         DB_UPDATE_HOOK,          DB_VERSION,",
          "1946:     DB_WAL_HOOK",
          "",
          "[Added Lines]",
          "1920:     \"commit_hook\",            \"complete\",              \"config\",",
          "1921:     \"copy\",                   \"deserialize\",           \"enable_load_extension\",",
          "1922:     \"errorcode\",              \"eval\",                  \"exists\",",
          "1923:     \"function\",               \"incrblob\",              \"interrupt\",",
          "1924:     \"last_insert_rowid\",      \"nullvalue\",             \"onecolumn\",",
          "1925:     \"preupdate\",              \"profile\",               \"progress\",",
          "1926:     \"rekey\",                  \"restore\",               \"rollback_hook\",",
          "1927:     \"serialize\",              \"status\",                \"timeout\",",
          "1928:     \"total_changes\",          \"trace\",                 \"trace_v2\",",
          "1929:     \"transaction\",            \"unlock_notify\",         \"update_hook\",",
          "1930:     \"version\",                \"wal_hook\",              0",
          "1936:     DB_COMMIT_HOOK,           DB_COMPLETE,             DB_CONFIG,",
          "1937:     DB_COPY,                  DB_DESERIALIZE,          DB_ENABLE_LOAD_EXTENSION,",
          "1938:     DB_ERRORCODE,             DB_EVAL,                 DB_EXISTS,",
          "1939:     DB_FUNCTION,              DB_INCRBLOB,             DB_INTERRUPT,",
          "1940:     DB_LAST_INSERT_ROWID,     DB_NULLVALUE,            DB_ONECOLUMN,",
          "1941:     DB_PREUPDATE,             DB_PROFILE,              DB_PROGRESS,",
          "1942:     DB_REKEY,                 DB_RESTORE,              DB_ROLLBACK_HOOK,",
          "1943:     DB_SERIALIZE,             DB_STATUS,               DB_TIMEOUT,",
          "1944:     DB_TOTAL_CHANGES,         DB_TRACE,                DB_TRACE_V2,",
          "1945:     DB_TRANSACTION,           DB_UNLOCK_NOTIFY,        DB_UPDATE_HOOK,",
          "1946:     DB_VERSION,               DB_WAL_HOOK",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "2331:     break;",
          "2332:   }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2339:   case DB_CONFIG: {",
          "2340:     static const struct DbConfigChoices {",
          "2341:       const char *zName;",
          "2342:       int op;",
          "2343:     } aDbConfig[] = {",
          "2344:         { \"enable_fkey\",        SQLITE_DBCONFIG_ENABLE_FKEY           },",
          "2345:         { \"enable_trigger\",     SQLITE_DBCONFIG_ENABLE_TRIGGER        },",
          "2346:         { \"enable_view\",        SQLITE_DBCONFIG_ENABLE_VIEW           },",
          "2347:         { \"fts3_tokenizer\",     SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER },",
          "2348:         { \"load_extension\",     SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION },",
          "2349:         { \"no_ckpt_on_close\",   SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE      },",
          "2350:         { \"enable_qpsg\",        SQLITE_DBCONFIG_ENABLE_QPSG           },",
          "2351:         { \"trigger_eqp\",        SQLITE_DBCONFIG_TRIGGER_EQP           },",
          "2352:         { \"reset_database\",     SQLITE_DBCONFIG_RESET_DATABASE        },",
          "2353:         { \"defensive\",          SQLITE_DBCONFIG_DEFENSIVE             },",
          "2354:         { \"writable_schema\",    SQLITE_DBCONFIG_WRITABLE_SCHEMA       },",
          "2355:         { \"legacy_alter_table\", SQLITE_DBCONFIG_LEGACY_ALTER_TABLE    },",
          "2356:         { \"dqs_dml\",            SQLITE_DBCONFIG_DQS_DML               },",
          "2357:         { \"dqs_ddl\",            SQLITE_DBCONFIG_DQS_DDL               },",
          "2358:     };",
          "2359:     Tcl_Obj *pResult;",
          "2360:     int ii;",
          "2361:     if( objc>4 ){",
          "2362:       Tcl_WrongNumArgs(interp, 2, objv, \"?OPTION? ?BOOLEAN?\");",
          "2363:       return TCL_ERROR;",
          "2364:     }",
          "2365:     if( objc==2 ){",
          "2368:       pResult = Tcl_NewListObj(0,0);",
          "2369:       for(ii=0; ii<sizeof(aDbConfig)/sizeof(aDbConfig[0]); ii++){",
          "2370:         int v = 0;",
          "2371:         int rc = sqlite3_db_config(pDb->db, aDbConfig[ii].op, -1, &v);",
          "2372:         if( rc!=SQLITE_OK ) continue;",
          "2373:         Tcl_ListObjAppendElement(interp, pResult,",
          "2374:            Tcl_NewStringObj(aDbConfig[ii].zName,-1));",
          "2375:         Tcl_ListObjAppendElement(interp, pResult,",
          "2376:            Tcl_NewIntObj(v));",
          "2377:       }",
          "2378:     }else{",
          "2379:       const char *zOpt = Tcl_GetString(objv[2]);",
          "2380:       int rc;",
          "2381:       int onoff = -1;",
          "2382:       int v = 0;",
          "2383:       if( zOpt[0]=='-' ) zOpt++;",
          "2384:       for(ii=0; ii<sizeof(aDbConfig)/sizeof(aDbConfig[0]); ii++){",
          "2385:         if( strcmp(aDbConfig[ii].zName, zOpt)==0 ) break;",
          "2386:       }",
          "2387:       if( ii>=sizeof(aDbConfig)/sizeof(aDbConfig[0]) ){",
          "2388:         Tcl_AppendResult(interp, \"unknown config option: \\\"\", zOpt,",
          "2389:                                 \"\\\"\", (void*)0);",
          "2390:         return TCL_ERROR;",
          "2391:       }",
          "2392:       if( objc==4 ){",
          "2393:         if( Tcl_GetBooleanFromObj(interp, objv[3], &onoff) ){",
          "2394:           return TCL_ERROR;",
          "2395:         }",
          "2396:       }",
          "2397:       rc = sqlite3_db_config(pDb->db, aDbConfig[ii].op, onoff, &v);",
          "2398:       pResult = Tcl_NewIntObj(v);",
          "2399:     }",
          "2400:     Tcl_SetObjResult(interp, pResult);",
          "2401:     break;",
          "2402:   }",
          "",
          "---------------"
        ],
        "test/tclsqlite.test||test/tclsqlite.test": [
          "File: test/tclsqlite.test -> test/tclsqlite.test",
          "--- Hunk 1 ---",
          "[Context before]",
          "42: do_test tcl-1.2 {",
          "43:   set v [catch {db bogus} msg]",
          "44:   lappend v $msg",
          "46: do_test tcl-1.2.1 {",
          "47:   set v [catch {db cache bogus} msg]",
          "48:   lappend v $msg",
          "",
          "[Removed Lines]",
          "45: } {1 {bad option \"bogus\": must be authorizer, backup, bind_fallback, busy, cache, changes, close, collate, collation_needed, commit_hook, complete, copy, deserialize, enable_load_extension, errorcode, eval, exists, function, incrblob, interrupt, last_insert_rowid, nullvalue, onecolumn, preupdate, profile, progress, rekey, restore, rollback_hook, serialize, status, timeout, total_changes, trace, trace_v2, transaction, unlock_notify, update_hook, version, or wal_hook}}",
          "",
          "[Added Lines]",
          "45: } {1 {bad option \"bogus\": must be authorizer, backup, bind_fallback, busy, cache, changes, close, collate, collation_needed, commit_hook, complete, config, copy, deserialize, enable_load_extension, errorcode, eval, exists, function, incrblob, interrupt, last_insert_rowid, nullvalue, onecolumn, preupdate, profile, progress, rekey, restore, rollback_hook, serialize, status, timeout, total_changes, trace, trace_v2, transaction, unlock_notify, update_hook, version, or wal_hook}}",
          "",
          "---------------"
        ],
        "test/view.test||test/view.test": [
          "File: test/view.test -> test/view.test",
          "--- Hunk 1 ---",
          "[Context before]",
          "38:     SELECT * FROM v1 ORDER BY a;",
          "39:   }",
          "40: } {1 2 4 5 7 8}",
          "41: do_test view-1.2 {",
          "42:   catchsql {",
          "43:     ROLLBACK;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "41: do_test view-1.1.100 {",
          "42:   db config enable_view off",
          "43:   catchsql {",
          "44:     SELECT * FROM v1 ORDER BY a;",
          "45:   }",
          "46: } {1 {access to view \"v1\" prohibited}}",
          "47: do_test view-1.1.110 {",
          "48:   db config enable_view on",
          "49:   catchsql {",
          "50:     SELECT * FROM v1 ORDER BY a;",
          "51:   }",
          "52: } {0 {1 2 4 5 7 8}}",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "9a6d01bff53cc0dd705f8d73525774d5cde52cb9",
      "candidate_info": {
        "commit_hash": "9a6d01bff53cc0dd705f8d73525774d5cde52cb9",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/9a6d01bff53cc0dd705f8d73525774d5cde52cb9",
        "files": [
          "manifest",
          "manifest.uuid",
          "src/printf.c"
        ],
        "message": "Performance improvement in the parsing of options to %-formats in the printf implementation.\n\nFossilOrigin-Name: 40d8f8ae87abf928542c4e558a4c3a3eab18776a3e8db7ca1c5e5f744ca0bce3",
        "before_after_code_files": [
          "manifest.uuid||manifest.uuid",
          "src/printf.c||src/printf.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 4ca9d5d53d41d08fbce29f9da8cc0948df9c4c3136210af88b499cf889b5ccb8",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/printf.c||src/printf.c": [
          "File: src/printf.c -> src/printf.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "237:     flag_leftjustify = flag_prefix = cThousand =",
          "238:      flag_alternateform = flag_altform2 = flag_zeropad = 0;",
          "239:     done = 0;",
          "240:     do{",
          "241:       switch( c ){",
          "242:         case '-':   flag_leftjustify = 1;     break;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "240:     width = 0;",
          "241:     flag_long = 0;",
          "242:     precision = -1;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "247:         case '0':   flag_zeropad = 1;         break;",
          "248:         case ',':   cThousand = ',';          break;",
          "249:         default:    done = 1;                 break;",
          "274: #ifdef SQLITE_PRINTF_PRECISION_LIMIT",
          "278: #endif",
          "288:         }",
          "292:         }",
          "297:           c = *++fmt;",
          "306: #ifdef SQLITE_PRINTF_PRECISION_LIMIT",
          "310: #endif",
          "320:       }",
          "325:     infop = &fmtinfo[0];",
          "326:     xtype = etINVALID;",
          "",
          "[Removed Lines]",
          "250:       }",
          "251:     }while( !done && (c=(*++fmt))!=0 );",
          "253:     if( c=='*' ){",
          "254:       if( bArgList ){",
          "255:         width = (int)getIntArg(pArgList);",
          "256:       }else{",
          "257:         width = va_arg(ap,int);",
          "258:       }",
          "259:       if( width<0 ){",
          "260:         flag_leftjustify = 1;",
          "261:         width = width >= -2147483647 ? -width : 0;",
          "262:       }",
          "263:       c = *++fmt;",
          "264:     }else{",
          "265:       unsigned wx = 0;",
          "266:       while( c>='0' && c<='9' ){",
          "267:         wx = wx*10 + c - '0';",
          "268:         c = *++fmt;",
          "269:       }",
          "270:       testcase( wx>0x7fffffff );",
          "271:       width = wx & 0x7fffffff;",
          "272:     }",
          "273:     assert( width>=0 );",
          "275:     if( width>SQLITE_PRINTF_PRECISION_LIMIT ){",
          "276:       width = SQLITE_PRINTF_PRECISION_LIMIT;",
          "277:     }",
          "281:     if( c=='.' ){",
          "282:       c = *++fmt;",
          "283:       if( c=='*' ){",
          "284:         if( bArgList ){",
          "285:           precision = (int)getIntArg(pArgList);",
          "286:         }else{",
          "287:           precision = va_arg(ap,int);",
          "289:         c = *++fmt;",
          "290:         if( precision<0 ){",
          "291:           precision = precision >= -2147483647 ? -precision : -1;",
          "293:       }else{",
          "294:         unsigned px = 0;",
          "295:         while( c>='0' && c<='9' ){",
          "296:           px = px*10 + c - '0';",
          "298:         }",
          "299:         testcase( px>0x7fffffff );",
          "300:         precision = px & 0x7fffffff;",
          "301:       }",
          "302:     }else{",
          "303:       precision = -1;",
          "304:     }",
          "305:     assert( precision>=(-1) );",
          "307:     if( precision>SQLITE_PRINTF_PRECISION_LIMIT ){",
          "308:       precision = SQLITE_PRINTF_PRECISION_LIMIT;",
          "309:     }",
          "314:     if( c=='l' ){",
          "315:       flag_long = 1;",
          "316:       c = *++fmt;",
          "317:       if( c=='l' ){",
          "318:         flag_long = 2;",
          "319:         c = *++fmt;",
          "321:     }else{",
          "322:       flag_long = 0;",
          "323:     }",
          "",
          "[Added Lines]",
          "253:         case 'l': {",
          "254:           flag_long = 1;",
          "255:           c = *++fmt;",
          "256:           if( c=='l' ){",
          "257:             c = *++fmt;",
          "258:             flag_long = 2;",
          "259:           }",
          "260:           done = 1;",
          "261:           break;",
          "262:         }",
          "263:         case '1': case '2': case '3': case '4': case '5':",
          "264:         case '6': case '7': case '8': case '9': {",
          "265:           unsigned wx = c - '0';",
          "266:           while( (c = *++fmt)>='0' && c<='9' ){",
          "267:             wx = wx*10 + c - '0';",
          "268:           }",
          "269:           testcase( wx>0x7fffffff );",
          "270:           width = wx & 0x7fffffff;",
          "272:           if( width>SQLITE_PRINTF_PRECISION_LIMIT ){",
          "273:             width = SQLITE_PRINTF_PRECISION_LIMIT;",
          "274:           }",
          "276:           if( c!='.' && c!='l' ){",
          "277:             done = 1;",
          "278:           }else{",
          "279:             fmt--;",
          "280:           }",
          "281:           break;",
          "283:         case '*': {",
          "284:           if( bArgList ){",
          "285:             width = (int)getIntArg(pArgList);",
          "286:           }else{",
          "287:             width = va_arg(ap,int);",
          "288:           }",
          "289:           if( width<0 ){",
          "290:             flag_leftjustify = 1;",
          "291:             width = width >= -2147483647 ? -width : 0;",
          "292:           }",
          "293: #ifdef SQLITE_PRINTF_PRECISION_LIMIT",
          "294:           if( width>SQLITE_PRINTF_PRECISION_LIMIT ){",
          "295:             width = SQLITE_PRINTF_PRECISION_LIMIT;",
          "296:           }",
          "297: #endif",
          "298:           if( (c = fmt[1])!='.' && c!='l' ){",
          "299:             c = *++fmt;",
          "300:             done = 1;",
          "301:           }",
          "302:           break;",
          "304:         case '.': {",
          "306:           if( c=='*' ){",
          "307:             if( bArgList ){",
          "308:               precision = (int)getIntArg(pArgList);",
          "309:             }else{",
          "310:               precision = va_arg(ap,int);",
          "311:             }",
          "312:             if( precision<0 ){",
          "313:               precision = precision >= -2147483647 ? -precision : -1;",
          "314:             }",
          "315:             c = *++fmt;",
          "316:           }else{",
          "317:             unsigned px = 0;",
          "318:             while( c>='0' && c<='9' ){",
          "319:               px = px*10 + c - '0';",
          "320:               c = *++fmt;",
          "321:             }",
          "322:             testcase( px>0x7fffffff );",
          "323:             precision = px & 0x7fffffff;",
          "324:           }",
          "326:           if( precision>SQLITE_PRINTF_PRECISION_LIMIT ){",
          "327:             precision = SQLITE_PRINTF_PRECISION_LIMIT;",
          "328:           }",
          "330:           if( c=='l' ){",
          "331:             --fmt;",
          "332:           }else{",
          "333:             done = 1;",
          "334:           }",
          "335:           break;",
          "336:         }",
          "338:     }while( !done && (c=(*++fmt))!=0 );",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "aadf8327be6e54d52a8887897bd65983c6dc3a4e",
      "candidate_info": {
        "commit_hash": "aadf8327be6e54d52a8887897bd65983c6dc3a4e",
        "repo": "sqlite/sqlite",
        "commit_url": "https://github.com/sqlite/sqlite/commit/aadf8327be6e54d52a8887897bd65983c6dc3a4e",
        "files": [
          "manifest",
          "manifest.uuid",
          "src/os_unix.c"
        ],
        "message": "Back out the change to support Fuchsia, since it turns out fuchsia does not like dot-file locks.\n\nFossilOrigin-Name: 1d801a3b2c48dc8a918d6da047bc877acf033d5f5c4e1d4b412ba7678ed6f8b3",
        "before_after_code_files": [
          "manifest.uuid||manifest.uuid",
          "src/os_unix.c||src/os_unix.c"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "manifest.uuid||manifest.uuid"
          ],
          "candidate": [
            "manifest.uuid||manifest.uuid"
          ]
        }
      },
      "candidate_diff": {
        "manifest.uuid||manifest.uuid": [
          "File: manifest.uuid -> manifest.uuid",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "1: 73c4abc90264355f3ea6e8c34e5aad6ed665b70fb136c4d416e2a98e46562bbd",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/os_unix.c||src/os_unix.c": [
          "File: src/os_unix.c -> src/os_unix.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "7822:     UNIXVFS(\"unix\",          autolockIoFinder ),",
          "7823: #elif OS_VXWORKS",
          "7824:     UNIXVFS(\"unix\",          vxworksIoFinder ),",
          "7828: #else",
          "7829:     UNIXVFS(\"unix\",          posixIoFinder ),",
          "7830: #endif",
          "",
          "[Removed Lines]",
          "7825: #elif __Fuchsia__",
          "7827:     UNIXVFS(\"unix\",          dotlockIoFinder ),",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}