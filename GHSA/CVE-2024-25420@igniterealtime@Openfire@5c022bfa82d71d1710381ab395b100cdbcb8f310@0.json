{
  "cve_id": "CVE-2024-25420",
  "cve_desc": "An issue in Ignite Realtime Openfire v.4.9.0 and before allows a remote attacker to escalate privileges via the admin.authorizedJIDs system property component.",
  "repo": "igniterealtime/Openfire",
  "patch_hash": "5c022bfa82d71d1710381ab395b100cdbcb8f310",
  "patch_info": {
    "commit_hash": "5c022bfa82d71d1710381ab395b100cdbcb8f310",
    "repo": "igniterealtime/Openfire",
    "commit_url": "https://github.com/igniterealtime/Openfire/commit/5c022bfa82d71d1710381ab395b100cdbcb8f310",
    "files": [
      "xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java"
    ],
    "message": "OF-2758: Remove admin flag when deleting user\n\nWhen a user is being deleted, that user should no longer be marked as an admin.",
    "before_after_code_files": [
      "xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java||xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java"
    ]
  },
  "patch_diff": {
    "xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java||xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java": [
      "File: xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java -> xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "18: import java.util.ArrayList;",
      "19: import java.util.List;",
      "21: import org.jivesoftware.openfire.XMPPServer;",
      "22: import org.jivesoftware.util.SystemProperty;",
      "23: import org.slf4j.Logger;",
      "24: import org.slf4j.LoggerFactory;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "20: import java.util.Map;",
      "23: import org.jivesoftware.openfire.event.UserEventDispatcher;",
      "24: import org.jivesoftware.openfire.event.UserEventListener;",
      "25: import org.jivesoftware.openfire.user.User;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "85:     private AdminManager() {",
      "87:         initProvider(ADMIN_PROVIDER.getValue());",
      "88:     }",
      "90:     private static void initProvider(final Class clazz) {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "93:         UserEventDispatcher.addListener(new UserEventListener() {",
      "94:             @Override",
      "95:             public void userDeleting(final User user, final Map<String, Object> params) {",
      "97:                 removeAdminAccount(user.getUsername());",
      "98:             }",
      "100:             @Override public void userCreated(final User user, final Map<String, Object> params) {}",
      "101:             @Override public void userModified(final User user, final Map<String, Object> params) {}",
      "102:         });",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "18313be836a695ca4a65f55ba4d75b1a44c1a8bb",
      "candidate_info": {
        "commit_hash": "18313be836a695ca4a65f55ba4d75b1a44c1a8bb",
        "repo": "igniterealtime/Openfire",
        "commit_url": "https://github.com/igniterealtime/Openfire/commit/18313be836a695ca4a65f55ba4d75b1a44c1a8bb",
        "files": [
          "xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java"
        ],
        "message": "OF-2758: Remove admin flag when deleting user\n\nWhen a user is being deleted, that user should no longer be marked as an admin.\n\n(cherry picked from commit 0da14ca99a2196cd42351c3fbca8737a8d6c2640)",
        "before_after_code_files": [
          "xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java||xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java||xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java"
          ],
          "candidate": [
            "xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java||xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java"
          ]
        }
      },
      "candidate_diff": {
        "xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java||xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java": [
          "File: xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java -> xmppserver/src/main/java/org/jivesoftware/openfire/admin/AdminManager.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: import java.util.ArrayList;",
          "19: import java.util.List;",
          "21: import org.jivesoftware.openfire.XMPPServer;",
          "22: import org.jivesoftware.util.SystemProperty;",
          "23: import org.slf4j.Logger;",
          "24: import org.slf4j.LoggerFactory;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "20: import java.util.Map;",
          "23: import org.jivesoftware.openfire.event.UserEventDispatcher;",
          "24: import org.jivesoftware.openfire.event.UserEventListener;",
          "25: import org.jivesoftware.openfire.user.User;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "85:     private AdminManager() {",
          "87:         initProvider(ADMIN_PROVIDER.getValue());",
          "88:     }",
          "90:     private static void initProvider(final Class clazz) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "93:         UserEventDispatcher.addListener(new UserEventListener() {",
          "94:             @Override",
          "95:             public void userDeleting(final User user, final Map<String, Object> params) {",
          "97:                 removeAdminAccount(user.getUsername());",
          "98:             }",
          "100:             @Override public void userCreated(final User user, final Map<String, Object> params) {}",
          "101:             @Override public void userModified(final User user, final Map<String, Object> params) {}",
          "102:         });",
          "",
          "---------------"
        ]
      }
    }
  ]
}