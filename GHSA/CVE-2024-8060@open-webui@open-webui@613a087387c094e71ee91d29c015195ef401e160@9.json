{
  "cve_id": "CVE-2024-8060",
  "cve_desc": "OpenWebUI version 0.3.0 contains a vulnerability in the audio API endpoint `/audio/api/v1/transcriptions` that allows for arbitrary file upload. The application performs insufficient validation on the `file.content_type` and allows user-controlled filenames, leading to a path traversal vulnerability. This can be exploited by an authenticated user to overwrite critical files within the Docker container, potentially leading to remote code execution as the root user.",
  "repo": "open-webui/open-webui",
  "patch_hash": "613a087387c094e71ee91d29c015195ef401e160",
  "patch_info": {
    "commit_hash": "613a087387c094e71ee91d29c015195ef401e160",
    "repo": "open-webui/open-webui",
    "commit_url": "https://github.com/open-webui/open-webui/commit/613a087387c094e71ee91d29c015195ef401e160",
    "files": [
      "backend/open_webui/routers/audio.py"
    ],
    "message": "refac",
    "before_after_code_files": [
      "backend/open_webui/routers/audio.py||backend/open_webui/routers/audio.py"
    ]
  },
  "patch_diff": {
    "backend/open_webui/routers/audio.py||backend/open_webui/routers/audio.py": [
      "File: backend/open_webui/routers/audio.py -> backend/open_webui/routers/audio.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "681:     available_models = []",
      "682:     if request.app.state.config.TTS_ENGINE == \"openai\":",
      "683:         # Use custom endpoint if not using the official OpenAI API URL",
      "685:             try:",
      "687:                 response.raise_for_status()",
      "688:                 data = response.json()",
      "689:                 available_models = data.get(\"models\", [])",
      "690:             except Exception as e:",
      "691:                 log.error(f\"Error fetching models from custom endpoint: {str(e)}\")",
      "693:         else:",
      "694:             available_models = [{\"id\": \"tts-1\"}, {\"id\": \"tts-1-hd\"}]",
      "695:     elif request.app.state.config.TTS_ENGINE == \"elevenlabs\":",
      "",
      "[Removed Lines]",
      "684:         if not request.app.state.config.TTS_OPENAI_API_BASE_URL.startswith(\"https://api.openai.com\"):",
      "686:                 response = requests.get(f\"{request.app.state.config.TTS_OPENAI_API_BASE_URL}/audio/models\")",
      "692:                 available_models = []",
      "",
      "[Added Lines]",
      "684:         if not request.app.state.config.TTS_OPENAI_API_BASE_URL.startswith(",
      "685:             \"https://api.openai.com\"",
      "686:         ):",
      "688:                 response = requests.get(",
      "689:                     f\"{request.app.state.config.TTS_OPENAI_API_BASE_URL}/audio/models\"",
      "690:                 )",
      "696:                 available_models = [{\"id\": \"tts-1\"}, {\"id\": \"tts-1-hd\"}]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "723:     available_voices = {}",
      "724:     if request.app.state.config.TTS_ENGINE == \"openai\":",
      "725:         # Use custom endpoint if not using the official OpenAI API URL",
      "727:             try:",
      "729:                 response.raise_for_status()",
      "730:                 data = response.json()",
      "731:                 voices_list = data.get(\"voices\", [])",
      "732:                 available_voices = {voice[\"id\"]: voice[\"name\"] for voice in voices_list}",
      "733:             except Exception as e:",
      "734:                 log.error(f\"Error fetching voices from custom endpoint: {str(e)}\")",
      "736:         else:",
      "737:             available_voices = {",
      "738:                 \"alloy\": \"alloy\",",
      "",
      "[Removed Lines]",
      "726:         if not request.app.state.config.TTS_OPENAI_API_BASE_URL.startswith(\"https://api.openai.com\"):",
      "728:                 response = requests.get(f\"{request.app.state.config.TTS_OPENAI_API_BASE_URL}/audio/voices\")",
      "735:                 available_voices = {}",
      "",
      "[Added Lines]",
      "730:         if not request.app.state.config.TTS_OPENAI_API_BASE_URL.startswith(",
      "731:             \"https://api.openai.com\"",
      "732:         ):",
      "734:                 response = requests.get(",
      "735:                     f\"{request.app.state.config.TTS_OPENAI_API_BASE_URL}/audio/voices\"",
      "736:                 )",
      "743:                 available_voices = {",
      "744:                     \"alloy\": \"alloy\",",
      "745:                     \"echo\": \"echo\",",
      "746:                     \"fable\": \"fable\",",
      "747:                     \"onyx\": \"onyx\",",
      "748:                     \"nova\": \"nova\",",
      "749:                     \"shimmer\": \"shimmer\",",
      "750:                 }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "426f8f29adf3a69c00ee5547587a963dcc6ca6d0",
      "candidate_info": {
        "commit_hash": "426f8f29adf3a69c00ee5547587a963dcc6ca6d0",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/426f8f29adf3a69c00ee5547587a963dcc6ca6d0",
        "files": [
          "src/lib/components/admin/Evaluations/Feedbacks.svelte",
          "src/lib/components/admin/Functions.svelte",
          "src/lib/components/chat/MessageInput.svelte",
          "src/lib/components/chat/ShareChatModal.svelte",
          "src/lib/components/workspace/Models.svelte",
          "src/lib/components/workspace/Prompts.svelte",
          "src/lib/components/workspace/Tools.svelte",
          "src/lib/i18n/locales/ar-BH/translation.json",
          "src/lib/i18n/locales/bg-BG/translation.json",
          "src/lib/i18n/locales/bn-BD/translation.json",
          "src/lib/i18n/locales/ca-ES/translation.json",
          "src/lib/i18n/locales/ceb-PH/translation.json",
          "src/lib/i18n/locales/cs-CZ/translation.json",
          "src/lib/i18n/locales/da-DK/translation.json",
          "src/lib/i18n/locales/de-DE/translation.json",
          "src/lib/i18n/locales/dg-DG/translation.json",
          "src/lib/i18n/locales/el-GR/translation.json",
          "src/lib/i18n/locales/en-GB/translation.json",
          "src/lib/i18n/locales/en-US/translation.json",
          "src/lib/i18n/locales/es-ES/translation.json",
          "src/lib/i18n/locales/eu-ES/translation.json",
          "src/lib/i18n/locales/fa-IR/translation.json",
          "src/lib/i18n/locales/fi-FI/translation.json",
          "src/lib/i18n/locales/fr-CA/translation.json",
          "src/lib/i18n/locales/fr-FR/translation.json",
          "src/lib/i18n/locales/he-IL/translation.json",
          "src/lib/i18n/locales/hi-IN/translation.json",
          "src/lib/i18n/locales/hr-HR/translation.json",
          "src/lib/i18n/locales/hu-HU/translation.json",
          "src/lib/i18n/locales/id-ID/translation.json",
          "src/lib/i18n/locales/ie-GA/translation.json",
          "src/lib/i18n/locales/it-IT/translation.json",
          "src/lib/i18n/locales/ja-JP/translation.json",
          "src/lib/i18n/locales/ka-GE/translation.json",
          "src/lib/i18n/locales/ko-KR/translation.json",
          "src/lib/i18n/locales/lt-LT/translation.json",
          "src/lib/i18n/locales/ms-MY/translation.json",
          "src/lib/i18n/locales/nb-NO/translation.json",
          "src/lib/i18n/locales/nl-NL/translation.json",
          "src/lib/i18n/locales/pa-IN/translation.json",
          "src/lib/i18n/locales/pl-PL/translation.json",
          "src/lib/i18n/locales/pt-BR/translation.json",
          "src/lib/i18n/locales/pt-PT/translation.json",
          "src/lib/i18n/locales/ro-RO/translation.json",
          "src/lib/i18n/locales/ru-RU/translation.json",
          "src/lib/i18n/locales/sk-SK/translation.json",
          "src/lib/i18n/locales/sr-RS/translation.json",
          "src/lib/i18n/locales/sv-SE/translation.json",
          "src/lib/i18n/locales/th-TH/translation.json",
          "src/lib/i18n/locales/tk-TW/translation.json",
          "src/lib/i18n/locales/tr-TR/translation.json",
          "src/lib/i18n/locales/uk-UA/translation.json",
          "src/lib/i18n/locales/ur-PK/translation.json",
          "src/lib/i18n/locales/vi-VN/translation.json",
          "src/lib/i18n/locales/zh-CN/translation.json",
          "src/lib/i18n/locales/zh-TW/translation.json"
        ],
        "message": "refac",
        "before_after_code_files": [
          "src/lib/components/admin/Evaluations/Feedbacks.svelte||src/lib/components/admin/Evaluations/Feedbacks.svelte",
          "src/lib/components/admin/Functions.svelte||src/lib/components/admin/Functions.svelte",
          "src/lib/components/chat/MessageInput.svelte||src/lib/components/chat/MessageInput.svelte",
          "src/lib/components/chat/ShareChatModal.svelte||src/lib/components/chat/ShareChatModal.svelte",
          "src/lib/components/workspace/Models.svelte||src/lib/components/workspace/Models.svelte",
          "src/lib/components/workspace/Prompts.svelte||src/lib/components/workspace/Prompts.svelte",
          "src/lib/components/workspace/Tools.svelte||src/lib/components/workspace/Tools.svelte"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/lib/components/admin/Evaluations/Feedbacks.svelte||src/lib/components/admin/Evaluations/Feedbacks.svelte": [
          "File: src/lib/components/admin/Evaluations/Feedbacks.svelte -> src/lib/components/admin/Evaluations/Feedbacks.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "65:  };",
          "67:  const shareHandler = async () => {",
          "71:   const feedbacksToShare = feedbacks.map((f) => {",
          "",
          "[Removed Lines]",
          "68:   toast.success($i18n.t('Redirecting you to OpenWebUI Community'));",
          "",
          "[Added Lines]",
          "68:   toast.success($i18n.t('Redirecting you to Open WebUI Community'));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "266:      }}",
          "267:     >",
          "268:      <div class=\" self-center mr-2 font-medium line-clamp-1\">",
          "270:      </div>",
          "272:      <div class=\" self-center\">",
          "",
          "[Removed Lines]",
          "269:       {$i18n.t('Share to OpenWebUI Community')}",
          "",
          "[Added Lines]",
          "269:       {$i18n.t('Share to Open WebUI Community')}",
          "",
          "---------------"
        ],
        "src/lib/components/admin/Functions.svelte||src/lib/components/admin/Functions.svelte": [
          "File: src/lib/components/admin/Functions.svelte -> src/lib/components/admin/Functions.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "65:    return null;",
          "66:   });",
          "70:   const url = 'https://openwebui.com';",
          "",
          "[Removed Lines]",
          "68:   toast.success($i18n.t('Redirecting you to OpenWebUI Community'));",
          "",
          "[Added Lines]",
          "68:   toast.success($i18n.t('Redirecting you to Open WebUI Community'));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "453: {#if $config?.features.enable_community_sharing}",
          "454:  <div class=\" my-16\">",
          "455:   <div class=\" text-xl font-medium mb-1 line-clamp-1\">",
          "457:   </div>",
          "459:   <a",
          "",
          "[Removed Lines]",
          "456:    {$i18n.t('Made by OpenWebUI Community')}",
          "",
          "[Added Lines]",
          "456:    {$i18n.t('Made by Open WebUI Community')}",
          "",
          "---------------"
        ],
        "src/lib/components/chat/MessageInput.svelte||src/lib/components/chat/MessageInput.svelte": [
          "File: src/lib/components/chat/MessageInput.svelte -> src/lib/components/chat/MessageInput.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "638:                 xmlns=\"http://www.w3.org/2000/svg\"",
          "639:                 viewBox=\"0 0 20 20\"",
          "640:                 fill=\"currentColor\"",
          "642:                >",
          "643:                 <path",
          "644:                  d=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"",
          "",
          "[Removed Lines]",
          "641:                 class=\"w-4 h-4\"",
          "",
          "[Added Lines]",
          "641:                 class=\"size-4\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1242:           {/if}",
          "1244:           {#if !history.currentId || history.messages[history.currentId]?.done == true}",
          "1246:             <div class=\" flex items-center\">",
          "1247:              <Tooltip content={$i18n.t('Call')}>",
          "1248:               <button",
          "",
          "[Removed Lines]",
          "1245:            {#if prompt === ''}",
          "",
          "[Added Lines]",
          "1245:            {#if prompt === '' && files.length === 0}",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "1301:              <Tooltip content={$i18n.t('Send message')}>",
          "1302:               <button",
          "1303:                id=\"send-message-button\"",
          "1305:                 ? webSearchEnabled || ($settings?.webSearch ?? false) === 'always'",
          "1306:                  ? 'bg-blue-500 text-white hover:bg-blue-400 '",
          "1307:                  : 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 '",
          "1308:                 : 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled'} transition rounded-full p-1.5 self-center\"",
          "1309:                type=\"submit\"",
          "1311:               >",
          "1312:                <svg",
          "1313:                 xmlns=\"http://www.w3.org/2000/svg\"",
          "",
          "[Removed Lines]",
          "1304:                class=\"{prompt !== ''",
          "1310:                disabled={prompt === ''}",
          "",
          "[Added Lines]",
          "1304:                class=\"{!(prompt === '' && files.length === 0)",
          "1310:                disabled={prompt === '' && files.length === 0}",
          "",
          "---------------"
        ],
        "src/lib/components/chat/ShareChatModal.svelte||src/lib/components/chat/ShareChatModal.svelte": [
          "File: src/lib/components/chat/ShareChatModal.svelte -> src/lib/components/chat/ShareChatModal.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "30:   const _chat = chat.chat;",
          "31:   console.log('share', _chat);",
          "34:   const url = 'https://openwebui.com';",
          "",
          "[Removed Lines]",
          "33:   toast.success($i18n.t('Redirecting you to OpenWebUI Community'));",
          "",
          "[Added Lines]",
          "33:   toast.success($i18n.t('Redirecting you to Open WebUI Community'));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "143:           show = false;",
          "144:          }}",
          "145:         >",
          "147:         </button>",
          "148:        {/if}",
          "",
          "[Removed Lines]",
          "146:          {$i18n.t('Share to OpenWebUI Community')}",
          "",
          "[Added Lines]",
          "146:          {$i18n.t('Share to Open WebUI Community')}",
          "",
          "---------------"
        ],
        "src/lib/components/workspace/Models.svelte||src/lib/components/workspace/Models.svelte": [
          "File: src/lib/components/workspace/Models.svelte -> src/lib/components/workspace/Models.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "82:  };",
          "84:  const shareModelHandler = async (model) => {",
          "87:   const url = 'https://openwebui.com';",
          "",
          "[Removed Lines]",
          "85:   toast.success($i18n.t('Redirecting you to OpenWebUI Community'));",
          "",
          "[Added Lines]",
          "85:   toast.success($i18n.t('Redirecting you to Open WebUI Community'));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "479:  {#if $config?.features.enable_community_sharing}",
          "480:   <div class=\" my-16\">",
          "481:    <div class=\" text-xl font-medium mb-1 line-clamp-1\">",
          "483:    </div>",
          "485:    <a",
          "",
          "[Removed Lines]",
          "482:     {$i18n.t('Made by OpenWebUI Community')}",
          "",
          "[Added Lines]",
          "482:     {$i18n.t('Made by Open WebUI Community')}",
          "",
          "---------------"
        ],
        "src/lib/components/workspace/Prompts.svelte||src/lib/components/workspace/Prompts.svelte": [
          "File: src/lib/components/workspace/Prompts.svelte -> src/lib/components/workspace/Prompts.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "40:  $: filteredItems = prompts.filter((p) => query === '' || p.command.includes(query));",
          "42:  const shareHandler = async (prompt) => {",
          "45:   const url = 'https://openwebui.com';",
          "",
          "[Removed Lines]",
          "43:   toast.success($i18n.t('Redirecting you to OpenWebUI Community'));",
          "",
          "[Added Lines]",
          "43:   toast.success($i18n.t('Redirecting you to Open WebUI Community'));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "319:  {#if $config?.features.enable_community_sharing}",
          "320:   <div class=\" my-16\">",
          "321:    <div class=\" text-xl font-medium mb-1 line-clamp-1\">",
          "323:    </div>",
          "325:    <a",
          "",
          "[Removed Lines]",
          "322:     {$i18n.t('Made by OpenWebUI Community')}",
          "",
          "[Added Lines]",
          "322:     {$i18n.t('Made by Open WebUI Community')}",
          "",
          "---------------"
        ],
        "src/lib/components/workspace/Tools.svelte||src/lib/components/workspace/Tools.svelte": [
          "File: src/lib/components/workspace/Tools.svelte -> src/lib/components/workspace/Tools.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "65:    return null;",
          "66:   });",
          "70:   const url = 'https://openwebui.com';",
          "",
          "[Removed Lines]",
          "68:   toast.success($i18n.t('Redirecting you to OpenWebUI Community'));",
          "",
          "[Added Lines]",
          "68:   toast.success($i18n.t('Redirecting you to Open WebUI Community'));",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "438:  {#if $config?.features.enable_community_sharing}",
          "439:   <div class=\" my-16\">",
          "440:    <div class=\" text-xl font-medium mb-1 line-clamp-1\">",
          "442:    </div>",
          "444:    <a",
          "",
          "[Removed Lines]",
          "441:     {$i18n.t('Made by OpenWebUI Community')}",
          "",
          "[Added Lines]",
          "441:     {$i18n.t('Made by Open WebUI Community')}",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "085f48366b3a2876c88001b0b52fee7b396aa853",
      "candidate_info": {
        "commit_hash": "085f48366b3a2876c88001b0b52fee7b396aa853",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/085f48366b3a2876c88001b0b52fee7b396aa853",
        "files": [
          "src/lib/components/layout/Sidebar/ChannelItem.svelte"
        ],
        "message": "refac",
        "before_after_code_files": [
          "src/lib/components/layout/Sidebar/ChannelItem.svelte||src/lib/components/layout/Sidebar/ChannelItem.svelte"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/lib/components/layout/Sidebar/ChannelItem.svelte||src/lib/components/layout/Sidebar/ChannelItem.svelte": [
          "File: src/lib/components/layout/Sidebar/ChannelItem.svelte -> src/lib/components/layout/Sidebar/ChannelItem.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "81:  {#if $user?.role === 'admin'}",
          "82:   <button",
          "83:    class=\"absolute z-10 right-2 invisible group-hover:visible self-center flex items-center dark:text-gray-300\"",
          "85:     e.stopPropagation();",
          "87:     showEditChannelModal = true;",
          "88:    }}",
          "89:   >",
          "",
          "[Removed Lines]",
          "84:    on:pointerup={(e) => {",
          "",
          "[Added Lines]",
          "84:    on:click={(e) => {",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "bef7a532cc9cbc8a6143a8f4324638cf98c1d27c",
      "candidate_info": {
        "commit_hash": "bef7a532cc9cbc8a6143a8f4324638cf98c1d27c",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/bef7a532cc9cbc8a6143a8f4324638cf98c1d27c",
        "files": [
          "backend/open_webui/routers/images.py"
        ],
        "message": "refac",
        "before_after_code_files": [
          "backend/open_webui/routers/images.py||backend/open_webui/routers/images.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "backend/open_webui/routers/images.py||backend/open_webui/routers/images.py": [
          "File: backend/open_webui/routers/images.py -> backend/open_webui/routers/images.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "144:     request.app.state.config.COMFYUI_BASE_URL = (",
          "145:         form_data.comfyui.COMFYUI_BASE_URL.strip(\"/\")",
          "146:     )",
          "147:     request.app.state.config.COMFYUI_WORKFLOW = form_data.comfyui.COMFYUI_WORKFLOW",
          "148:     request.app.state.config.COMFYUI_WORKFLOW_NODES = (",
          "149:         form_data.comfyui.COMFYUI_WORKFLOW_NODES",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "147:     request.app.state.config.COMFYUI_API_KEY = form_data.comfyui.COMFYUI_API_KEY",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "203:             request.app.state.config.ENABLE_IMAGE_GENERATION = False",
          "204:             raise HTTPException(status_code=400, detail=ERROR_MESSAGES.INVALID_URL)",
          "205:     elif request.app.state.config.IMAGE_GENERATION_ENGINE == \"comfyui\":",
          "206:         try:",
          "207:             r = requests.get(",
          "209:             )",
          "210:             r.raise_for_status()",
          "211:             return True",
          "",
          "[Removed Lines]",
          "208:                 url=f\"{request.app.state.config.COMFYUI_BASE_URL}/object_info\"",
          "",
          "[Added Lines]",
          "209:         headers = None",
          "210:         if request.app.state.config.COMFYUI_API_KEY:",
          "211:             headers = {",
          "212:                 \"Authorization\": f\"Bearer {request.app.state.config.COMFYUI_API_KEY}\"",
          "213:             }",
          "217:                 url=f\"{request.app.state.config.COMFYUI_BASE_URL}/object_info\",",
          "218:                 headers=headers,",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "1c2e36f1b7e1c059a07e96e29967bb89e870e87c",
      "candidate_info": {
        "commit_hash": "1c2e36f1b7e1c059a07e96e29967bb89e870e87c",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/1c2e36f1b7e1c059a07e96e29967bb89e870e87c",
        "files": [
          "src/lib/components/admin/Settings/Documents.svelte"
        ],
        "message": "refac",
        "before_after_code_files": [
          "src/lib/components/admin/Settings/Documents.svelte||src/lib/components/admin/Settings/Documents.svelte"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/lib/components/admin/Settings/Documents.svelte||src/lib/components/admin/Settings/Documents.svelte": [
          "File: src/lib/components/admin/Settings/Documents.svelte -> src/lib/components/admin/Settings/Documents.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "319:     <hr class=\" border-gray-100 dark:border-gray-850 my-2\" />",
          "321:     <div class=\"  mb-2.5 flex flex-col w-full justify-between\">",
          "322:      <div class=\"flex w-full justify-between\">",
          "323:       <div class=\" self-center text-xs font-medium\">{$i18n.t('Embedding Model Engine')}</div>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "321:     <div class=\"  mb-2.5 flex flex-col w-full justify-between\">",
          "322:      <div class=\"flex w-full justify-between\">",
          "323:       <div class=\" self-center text-xs font-medium\">",
          "324:        {$i18n.t('Content Extraction Engine')}",
          "325:       </div>",
          "327:       <div class=\"\">",
          "328:        <select",
          "329:         class=\"dark:bg-gray-900 w-fit pr-8 rounded-sm px-2 text-xs bg-transparent outline-hidden text-right\"",
          "330:         bind:value={contentExtractionEngine}",
          "331:         on:change={(e) => {",
          "332:          showDocumentIntelligenceConfig = e.target.value === 'document_intelligence';",
          "333:         }}",
          "334:        >",
          "335:         <option value=\"\">{$i18n.t('Default')} </option>",
          "336:         <option value=\"tika\">{$i18n.t('Tika')}</option>",
          "337:         <option value=\"document_intelligence\">{$i18n.t('Document Intelligence')}</option>",
          "338:        </select>",
          "339:       </div>",
          "340:      </div>",
          "341:      {#if contentExtractionEngine === 'tika'}",
          "342:       <div class=\"flex w-full mt-1\">",
          "343:        <div class=\"flex-1 mr-2\">",
          "344:         <input",
          "345:          class=\"flex-1 w-full rounded-lg text-sm bg-transparent outline-hidden\"",
          "346:          placeholder={$i18n.t('Enter Tika Server URL')}",
          "347:          bind:value={tikaServerUrl}",
          "348:         />",
          "349:        </div>",
          "350:       </div>",
          "351:      {:else if contentExtractionEngine === 'document_intelligence'}",
          "352:       <div class=\"my-0.5 flex gap-2 pr-2\">",
          "353:        <input",
          "354:         class=\"flex-1 w-full rounded-lg text-sm bg-transparent outline-hidden\"",
          "355:         placeholder={$i18n.t('Enter Document Intelligence Endpoint')}",
          "356:         bind:value={documentIntelligenceEndpoint}",
          "357:        />",
          "359:        <SensitiveInput",
          "360:         placeholder={$i18n.t('Enter Document Intelligence Key')}",
          "361:         bind:value={documentIntelligenceKey}",
          "362:        />",
          "363:       </div>",
          "364:      {/if}",
          "365:     </div>",
          "367:     {#if contentExtractionEngine === ''}",
          "368:      <div class=\"  mb-2.5 flex w-full justify-between\">",
          "369:       <div class=\" self-center text-xs font-medium\">",
          "370:        {$i18n.t('PDF Extract Images (OCR)')}",
          "371:       </div>",
          "372:       <div class=\"flex items-center relative\">",
          "373:        <Switch bind:state={pdfExtractImages} />",
          "374:       </div>",
          "375:      </div>",
          "376:     {/if}",
          "378:     <div class=\"  mb-2.5 flex w-full justify-between\">",
          "379:      <div class=\" self-center text-xs font-medium\">{$i18n.t('Text Splitter')}</div>",
          "380:      <div class=\"flex items-center relative\">",
          "381:       <select",
          "382:        class=\"dark:bg-gray-900 w-fit pr-8 rounded-sm px-2 text-xs bg-transparent outline-hidden text-right\"",
          "383:        bind:value={textSplitter}",
          "384:       >",
          "385:        <option value=\"\">{$i18n.t('Default')} ({$i18n.t('Character')})</option>",
          "386:        <option value=\"token\">{$i18n.t('Token')} ({$i18n.t('Tiktoken')})</option>",
          "387:       </select>",
          "388:      </div>",
          "389:     </div>",
          "391:     <div class=\"  mb-2.5 flex w-full justify-between\">",
          "392:      <div class=\" flex gap-1.5 w-full\">",
          "393:       <div class=\"  w-full justify-between\">",
          "394:        <div class=\"self-center text-xs font-medium min-w-fit mb-1\">",
          "395:         {$i18n.t('Chunk Size')}",
          "396:        </div>",
          "397:        <div class=\"self-center\">",
          "398:         <input",
          "399:          class=\" w-full rounded-lg py-1.5 px-4 text-sm bg-gray-50 dark:text-gray-300 dark:bg-gray-850 outline-hidden\"",
          "400:          type=\"number\"",
          "401:          placeholder={$i18n.t('Enter Chunk Size')}",
          "402:          bind:value={chunkSize}",
          "403:          autocomplete=\"off\"",
          "404:          min=\"0\"",
          "405:         />",
          "406:        </div>",
          "407:       </div>",
          "409:       <div class=\"w-full\">",
          "410:        <div class=\" self-center text-xs font-medium min-w-fit mb-1\">",
          "411:         {$i18n.t('Chunk Overlap')}",
          "412:        </div>",
          "414:        <div class=\"self-center\">",
          "415:         <input",
          "416:          class=\"w-full rounded-lg py-1.5 px-4 text-sm bg-gray-50 dark:text-gray-300 dark:bg-gray-850 outline-hidden\"",
          "417:          type=\"number\"",
          "418:          placeholder={$i18n.t('Enter Chunk Overlap')}",
          "419:          bind:value={chunkOverlap}",
          "420:          autocomplete=\"off\"",
          "421:          min=\"0\"",
          "422:         />",
          "423:        </div>",
          "424:       </div>",
          "425:      </div>",
          "426:     </div>",
          "427:    </div>",
          "429:    <div class=\"mb-3\">",
          "430:     <div class=\" mb-2.5 text-base font-medium\">{$i18n.t('Embedding')}</div>",
          "432:     <hr class=\" border-gray-100 dark:border-gray-850 my-2\" />",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "644:     </div>",
          "645:    </div>",
          "757:    <div class=\"mb-3\">",
          "758:     <div class=\" mb-2.5 text-base font-medium\">{$i18n.t('Files')}</div>",
          "",
          "[Removed Lines]",
          "647:    <div class=\"mb-3\">",
          "648:     <div class=\" mb-2.5 text-base font-medium\">{$i18n.t('Content')}</div>",
          "650:     <hr class=\" border-gray-100 dark:border-gray-850 my-2\" />",
          "652:     <div class=\"  mb-2.5 flex flex-col w-full justify-between\">",
          "653:      <div class=\"flex w-full justify-between\">",
          "654:       <div class=\" self-center text-xs font-medium\">",
          "655:        {$i18n.t('Content Extraction Engine')}",
          "656:       </div>",
          "658:       <div class=\"\">",
          "659:        <select",
          "660:         class=\"dark:bg-gray-900 w-fit pr-8 rounded-sm px-2 text-xs bg-transparent outline-hidden text-right\"",
          "661:         bind:value={contentExtractionEngine}",
          "662:         on:change={(e) => {",
          "663:          showDocumentIntelligenceConfig = e.target.value === 'document_intelligence';",
          "664:         }}",
          "665:        >",
          "666:         <option value=\"\">{$i18n.t('Default')} </option>",
          "667:         <option value=\"tika\">{$i18n.t('Tika')}</option>",
          "668:         <option value=\"document_intelligence\">{$i18n.t('Document Intelligence')}</option>",
          "669:        </select>",
          "670:       </div>",
          "671:      </div>",
          "672:      {#if contentExtractionEngine === ''}",
          "673:       <div class=\"flex w-full mt-1\">",
          "674:        <div class=\"flex w-full justify-between items-center text-xs\">",
          "675:         <div class=\" text-xs font-medium\">{$i18n.t('PDF Extract Images (OCR)')}</div>",
          "677:         <div>",
          "678:          <Switch bind:state={pdfExtractImages} />",
          "679:         </div>",
          "680:        </div>",
          "681:       </div>",
          "682:      {:else if contentExtractionEngine === 'tika'}",
          "683:       <div class=\"flex w-full mt-1\">",
          "684:        <div class=\"flex-1 mr-2\">",
          "685:         <input",
          "686:          class=\"flex-1 w-full rounded-lg text-sm bg-transparent outline-hidden\"",
          "687:          placeholder={$i18n.t('Enter Tika Server URL')}",
          "688:          bind:value={tikaServerUrl}",
          "689:         />",
          "690:        </div>",
          "691:       </div>",
          "692:      {:else if contentExtractionEngine === 'document_intelligence'}",
          "693:       <div class=\"my-0.5 flex gap-2 pr-2\">",
          "694:        <input",
          "695:         class=\"flex-1 w-full rounded-lg text-sm bg-transparent outline-hidden\"",
          "696:         placeholder={$i18n.t('Enter Document Intelligence Endpoint')}",
          "697:         bind:value={documentIntelligenceEndpoint}",
          "698:        />",
          "700:        <SensitiveInput",
          "701:         placeholder={$i18n.t('Enter Document Intelligence Key')}",
          "702:         bind:value={documentIntelligenceKey}",
          "703:        />",
          "704:       </div>",
          "705:      {/if}",
          "706:     </div>",
          "708:     <div class=\"  mb-2.5 flex w-full justify-between\">",
          "709:      <div class=\" self-center text-xs font-medium\">{$i18n.t('Text Splitter')}</div>",
          "710:      <div class=\"flex items-center relative\">",
          "711:       <select",
          "712:        class=\"dark:bg-gray-900 w-fit pr-8 rounded-sm px-2 text-xs bg-transparent outline-hidden text-right\"",
          "713:        bind:value={textSplitter}",
          "714:       >",
          "715:        <option value=\"\">{$i18n.t('Default')} ({$i18n.t('Character')})</option>",
          "716:        <option value=\"token\">{$i18n.t('Token')} ({$i18n.t('Tiktoken')})</option>",
          "717:       </select>",
          "718:      </div>",
          "719:     </div>",
          "721:     <div class=\" flex gap-1.5\">",
          "722:      <div class=\"  w-full justify-between\">",
          "723:       <div class=\"self-center text-xs font-medium min-w-fit mb-1\">",
          "724:        {$i18n.t('Chunk Size')}",
          "725:       </div>",
          "726:       <div class=\"self-center\">",
          "727:        <input",
          "728:         class=\" w-full rounded-lg py-1.5 px-4 text-sm bg-gray-50 dark:text-gray-300 dark:bg-gray-850 outline-hidden\"",
          "729:         type=\"number\"",
          "730:         placeholder={$i18n.t('Enter Chunk Size')}",
          "731:         bind:value={chunkSize}",
          "732:         autocomplete=\"off\"",
          "733:         min=\"0\"",
          "734:        />",
          "735:       </div>",
          "736:      </div>",
          "738:      <div class=\"w-full\">",
          "739:       <div class=\" self-center text-xs font-medium min-w-fit mb-1\">",
          "740:        {$i18n.t('Chunk Overlap')}",
          "741:       </div>",
          "743:       <div class=\"self-center\">",
          "744:        <input",
          "745:         class=\"w-full rounded-lg py-1.5 px-4 text-sm bg-gray-50 dark:text-gray-300 dark:bg-gray-850 outline-hidden\"",
          "746:         type=\"number\"",
          "747:         placeholder={$i18n.t('Enter Chunk Overlap')}",
          "748:         bind:value={chunkOverlap}",
          "749:         autocomplete=\"off\"",
          "750:         min=\"0\"",
          "751:        />",
          "752:       </div>",
          "753:      </div>",
          "754:     </div>",
          "755:    </div>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "fba25c6cec3ee7b82c0093520574c2c04ed88fc5",
      "candidate_info": {
        "commit_hash": "fba25c6cec3ee7b82c0093520574c2c04ed88fc5",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/fba25c6cec3ee7b82c0093520574c2c04ed88fc5",
        "files": [
          "backend/open_webui/config.py"
        ],
        "message": "refac",
        "before_after_code_files": [
          "backend/open_webui/config.py||backend/open_webui/config.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "backend/open_webui/config.py||backend/open_webui/config.py": [
          "File: backend/open_webui/config.py -> backend/open_webui/config.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1337:    - If the results are unclear, unexpected, or require validation, refine the code and execute it again as needed. Always aim to deliver meaningful insights from the results, iterating if necessary.",
          "1338:    - If a link is provided for an image, audio, or any file, include it in the response exactly as given to ensure the user has access to the original resource.",
          "1339:    - All responses should be communicated in the chat's primary language, ensuring seamless understanding. If the chat is multilingual, default to English for clarity.",
          "1342: Ensure that the tools are effectively utilized to achieve the highest-quality analysis for the user.\"\"\"",
          "",
          "[Removed Lines]",
          "1340:    - **If a link to an image, audio, or any file is provided in markdown format, explicitly display it as part of the response to ensure the user can access it easily.**",
          "",
          "[Added Lines]",
          "1340:    - **If a link to an image, audio, or any file is provided in markdown format, explicitly display it as part of the response to ensure the user can access it easily, do NOT change the link.**",
          "",
          "---------------"
        ]
      }
    }
  ]
}