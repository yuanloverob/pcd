{
  "cve_id": "CVE-2024-2352",
  "cve_desc": "A vulnerability, which was classified as critical, has been found in 1Panel up to 1.10.1-lts. Affected by this issue is the function baseApi.UpdateDeviceSwap of the file /api/v1/toolbox/device/update/swap. The manipulation of the argument Path with the input 123123123\\nopen -a Calculator leads to command injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-256304.",
  "repo": "1Panel-dev/1Panel",
  "patch_hash": "0edd7a9f6f5100aab98a0ea6e5deedff7700396c",
  "patch_info": {
    "commit_hash": "0edd7a9f6f5100aab98a0ea6e5deedff7700396c",
    "repo": "1Panel-dev/1Panel",
    "commit_url": "https://github.com/1Panel-dev/1Panel/pull/4131/commits/0edd7a9f6f5100aab98a0ea6e5deedff7700396c",
    "files": [
      "backend/utils/cmd/cmd.go"
    ],
    "message": "fix: \u89e3\u51b3\u547d\u4ee4\u6ce8\u5165waf\u88ab\u7ed5\u8fc7\u7684\u95ee\u9898",
    "before_after_code_files": [
      "backend/utils/cmd/cmd.go||backend/utils/cmd/cmd.go"
    ]
  },
  "patch_diff": {
    "backend/utils/cmd/cmd.go||backend/utils/cmd/cmd.go": [
      "File: backend/utils/cmd/cmd.go -> backend/utils/cmd/cmd.go",
      "--- Hunk 1 ---",
      "[Context before]",
      "177:  for _, arg := range args {",
      "178:   if strings.Contains(arg, \"&\") || strings.Contains(arg, \"|\") || strings.Contains(arg, \";\") ||",
      "179:    strings.Contains(arg, \"$\") || strings.Contains(arg, \"'\") || strings.Contains(arg, \"`\") ||",
      "181:    return true",
      "182:   }",
      "183:  }",
      "",
      "[Removed Lines]",
      "180:    strings.Contains(arg, \"(\") || strings.Contains(arg, \")\") || strings.Contains(arg, \"\\\"\") {",
      "",
      "[Added Lines]",
      "180:    strings.Contains(arg, \"(\") || strings.Contains(arg, \")\") || strings.Contains(arg, \"\\\"\") ||",
      "181:    strings.Contains(arg, \"\\n\") || strings.Contains(arg, \"\\r\") {",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ba63907a65debc67222ce76dca25486049a35bea",
      "candidate_info": {
        "commit_hash": "ba63907a65debc67222ce76dca25486049a35bea",
        "repo": "1Panel-dev/1Panel",
        "commit_url": "https://github.com/1Panel-dev/1Panel/commit/ba63907a65debc67222ce76dca25486049a35bea",
        "files": [
          "backend/utils/cmd/cmd.go"
        ],
        "message": "fix: \u89e3\u51b3\u547d\u4ee4\u6ce8\u5165waf\u88ab\u7ed5\u8fc7\u7684\u95ee\u9898 (#4131)",
        "before_after_code_files": [
          "backend/utils/cmd/cmd.go||backend/utils/cmd/cmd.go"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/1Panel-dev/1Panel/pull/4131"
        ],
        "olp_code_files": {
          "patch": [
            "backend/utils/cmd/cmd.go||backend/utils/cmd/cmd.go"
          ],
          "candidate": [
            "backend/utils/cmd/cmd.go||backend/utils/cmd/cmd.go"
          ]
        }
      },
      "candidate_diff": {
        "backend/utils/cmd/cmd.go||backend/utils/cmd/cmd.go": [
          "File: backend/utils/cmd/cmd.go -> backend/utils/cmd/cmd.go",
          "--- Hunk 1 ---",
          "[Context before]",
          "177:  for _, arg := range args {",
          "178:   if strings.Contains(arg, \"&\") || strings.Contains(arg, \"|\") || strings.Contains(arg, \";\") ||",
          "179:    strings.Contains(arg, \"$\") || strings.Contains(arg, \"'\") || strings.Contains(arg, \"`\") ||",
          "181:    return true",
          "182:   }",
          "183:  }",
          "",
          "[Removed Lines]",
          "180:    strings.Contains(arg, \"(\") || strings.Contains(arg, \")\") || strings.Contains(arg, \"\\\"\") {",
          "",
          "[Added Lines]",
          "180:    strings.Contains(arg, \"(\") || strings.Contains(arg, \")\") || strings.Contains(arg, \"\\\"\") ||",
          "181:    strings.Contains(arg, \"\\n\") || strings.Contains(arg, \"\\r\") {",
          "",
          "---------------"
        ]
      }
    }
  ]
}