{
  "cve_id": "CVE-2024-55893",
  "cve_desc": "TYPO3 is a free and open source Content Management Framework. A vulnerability has been identified in the backend user interface functionality involving deep links. Specifically, this functionality is susceptible to Cross-Site Request Forgery (CSRF). Additionally, state-changing actions in downstream components incorrectly accepted submissions via HTTP GET and did not enforce the appropriate HTTP method. Successful exploitation of this vulnerability requires the victim to have an active session on the backend user interface and to be deceived into interacting with a malicious URL targeting the backend, which can occur under the following conditions: The user opens a malicious link, such as one sent via email. The user visits a compromised or manipulated website while the following settings are misconfigured: 1. `security.backend.enforceReferrer` feature is disabled, 2. `BE/cookieSameSite` configuration is set to lax or none. The vulnerability in the affected downstream component \u201cLog Module\u201d allows attackers to remove log entries. Users are advised to update to TYPO3 versions 11.5.42 ELTS, 12.4.25 LTS, 13.4.3 LTS which fix the problem described. There are no known workarounds for this vulnerability.",
  "repo": "TYPO3-CMS/belog",
  "patch_hash": "ece08246dbcea416ff97d4cc013bf24fb622fe5f",
  "patch_info": {
    "commit_hash": "ece08246dbcea416ff97d4cc013bf24fb622fe5f",
    "repo": "TYPO3-CMS/belog",
    "commit_url": "https://github.com/TYPO3-CMS/belog/commit/ece08246dbcea416ff97d4cc013bf24fb622fe5f",
    "files": [
      "Classes/Controller/BackendLogController.php",
      "Resources/Private/Partials/Content/LogEntries.html"
    ],
    "message": "[SECURITY] Enforce HTTP method assertions for backend modules\n\nResolves: #104456\nReleases: main, 13.4, 12.4\nChange-Id: Ic679584a343b6d35e81325a03148b0cff81f1d27\nSecurity-Bulletin: TYPO3-CORE-SA-2025-003\nSecurity-Bulletin: TYPO3-CORE-SA-2025-004\nSecurity-Bulletin: TYPO3-CORE-SA-2025-005\nSecurity-Bulletin: TYPO3-CORE-SA-2025-006\nSecurity-Bulletin: TYPO3-CORE-SA-2025-007\nSecurity-Bulletin: TYPO3-CORE-SA-2025-008\nSecurity-References: CVE-2024-55893\nSecurity-References: CVE-2024-55894\nSecurity-References: CVE-2024-55920\nSecurity-References: CVE-2024-55921\nSecurity-References: CVE-2024-55922\nSecurity-References: CVE-2024-55923\nReviewed-on: https://review.typo3.org/c/Packages/TYPO3.CMS/+/87744\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
    "before_after_code_files": [
      "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php",
      "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
    ]
  },
  "patch_diff": {
    "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php": [
      "File: Classes/Controller/BackendLogController.php -> Classes/Controller/BackendLogController.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "25: use TYPO3\\CMS\\Belog\\Domain\\Repository\\LogEntryRepository;",
      "26: use TYPO3\\CMS\\Core\\Authentication\\BackendUserAuthentication;",
      "27: use TYPO3\\CMS\\Core\\Database\\ConnectionPool;",
      "28: use TYPO3\\CMS\\Core\\Type\\Bitmask\\Permission;",
      "29: use TYPO3\\CMS\\Core\\Type\\ContextualFeedbackSeverity;",
      "30: use TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "28: use TYPO3\\CMS\\Core\\Http\\AllowedMethodsTrait;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "40: class BackendLogController extends ActionController",
      "41: {",
      "42:     public function __construct(",
      "43:         protected readonly ModuleTemplateFactory $moduleTemplateFactory,",
      "44:         protected readonly LogEntryRepository $logEntryRepository,",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "43:     use AllowedMethodsTrait;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "124:             ->renderResponse('BackendLog/List');",
      "125:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "130:     public function initializeDeleteMessageAction(): void",
      "131:     {",
      "132:         $this->assertAllowedHttpMethod($this->request, 'POST');",
      "133:     }",
      "",
      "---------------"
    ],
    "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html": [
      "File: Resources/Private/Partials/Content/LogEntries.html -> Resources/Private/Partials/Content/LogEntries.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "96:                                     </td>",
      "97:                                     <td class=\"col-control\">",
      "98:                                         <f:if condition=\"{logItem.error} == 1\">",
      "100:                                                 <core:icon identifier=\"actions-delete\" size=\"small\"/>",
      "101:                                                 <f:translate key=\"actions.deleteWarnings\"/>",
      "103:                                         </f:if>",
      "104:                                         <f:if condition=\"{logItem.error} == 2\">",
      "106:                                                 <core:icon identifier=\"actions-delete\" size=\"small\"/>",
      "107:                                                 <f:translate key=\"actions.delete\"/>",
      "109:                                         </f:if>",
      "110:                                         <f:if condition=\"{logItem.logData.history}\">",
      "111:                                             <a class=\"btn btn-sm btn-default\" href=\"{be:moduleLink(route: 'record_history', arguments: '{historyEntry: logItem.logData.history}')}\" title=\"{f:translate(key: 'showHistory')}\">",
      "",
      "[Removed Lines]",
      "99:                                             <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-warning\">",
      "102:                                             </f:link.action>",
      "105:                                             <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-danger\">",
      "108:                                             </f:link.action>",
      "",
      "[Added Lines]",
      "99:                                             <f:form.button class=\"btn btn-sm btn-warning\" form=\"form-delete-message\" type=\"submit\" name=\"errorUid\" value=\"{logItem.uid}\">",
      "102:                                             </f:form.button>",
      "105:                                             <f:form.button class=\"btn btn-sm btn-danger\" form=\"form-delete-message\" type=\"submit\" name=\"errorUid\" value=\"{logItem.uid}\">",
      "108:                                             </f:form.button>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "121:                 </div>",
      "122:             </f:for>",
      "123:         </f:for>",
      "124:     </f:then>",
      "125:     <f:else>",
      "126:         <f:be.infobox",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "125:         <f:form action=\"deleteMessage\" id=\"form-delete-message\" method=\"post\" class=\"hidden\"/>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "1f5195fec6e903c634a07a7586bc79f412b70ed9",
      "candidate_info": {
        "commit_hash": "1f5195fec6e903c634a07a7586bc79f412b70ed9",
        "repo": "TYPO3-CMS/belog",
        "commit_url": "https://github.com/TYPO3-CMS/belog/commit/1f5195fec6e903c634a07a7586bc79f412b70ed9",
        "files": [
          "Resources/Private/Language/locallang.xlf",
          "Resources/Private/Partials/Content/LogEntries.html"
        ],
        "message": "[TASK] Show information if no records exists in \"Log\" backend module\n\nIf there are no records or the filter/search does not return a result,\nan information is now displayed in the \"Log\" backend module.\n\nResolves: #103738\nReleases: main, 12.4\nChange-Id: I388e1e4db0885a143d3a626cd35199728b5c395b\nReviewed-on: https://review.typo3.org/c/Packages/TYPO3.CMS/+/84043\nReviewed-by: Garvin Hicking <gh@faktor-e.de>\nTested-by: core-ci <typo3@b13.com>\nTested-by: Christian Kuhn <lolli@schwarzbu.ch>\nReviewed-by: Christian Kuhn <lolli@schwarzbu.ch>\nReviewed-by: Jasmina Lie\u00dfmann <minapokhalo+typo3@gmail.com>\nTested-by: Garvin Hicking <gh@faktor-e.de>\nTested-by: Jasmina Lie\u00dfmann <minapokhalo+typo3@gmail.com>",
        "before_after_code_files": [
          "Resources/Private/Language/locallang.xlf||Resources/Private/Language/locallang.xlf",
          "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
          ],
          "candidate": [
            "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
          ]
        }
      },
      "candidate_diff": {
        "Resources/Private/Language/locallang.xlf||Resources/Private/Language/locallang.xlf": [
          "File: Resources/Private/Language/locallang.xlf -> Resources/Private/Language/locallang.xlf",
          "--- Hunk 1 ---",
          "[Context before]",
          "339:    <trans-unit id=\"actions.delete.noRowFound\" resname=\"actions.delete.noRowFound\">",
          "340:     <source>Log entry could not be found.</source>",
          "341:    </trans-unit>",
          "342:    <trans-unit id=\"info.selectPage.title\" resname=\"info.selectPage.title\">",
          "343:     <source>No page selected</source>",
          "344:    </trans-unit>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "342:    <trans-unit id=\"info.noRecords.message\" resname=\"info.noRecords.message\">",
          "343:     <source>No records found.</source>",
          "344:    </trans-unit>",
          "",
          "---------------"
        ],
        "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html": [
          "File: Resources/Private/Partials/Content/LogEntries.html -> Resources/Private/Partials/Content/LogEntries.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "5:     xmlns:belog=\"http://typo3.org/ns/TYPO3/CMS/Belog/ViewHelpers\"",
          "6:     data-namespace-typo3-fluid=\"true\">",
          "62:                                         <f:then>",
          "64:                                         </f:then>",
          "66:                                     </f:if>",
          "75:                                         </f:if>",
          "123: </html>",
          "",
          "[Removed Lines]",
          "8: <f:for each=\"{groupedLogEntries}\" as=\"pidEntry\" key=\"pid\">",
          "9:     <f:for each=\"{pidEntry}\" as=\"day\" key=\"dayTimestamp\">",
          "10:         <h3>",
          "11:             <f:format.date format=\"{settings.dateFormat}\">@{dayTimestamp}</f:format.date>",
          "12:         </h3>",
          "14:         <div class=\"table-fit\">",
          "15:             <table class=\"table table-striped table-hover\">",
          "16:                 <thead>",
          "17:                     <tr>",
          "18:                         <th></th>",
          "19:                         <th><f:translate key=\"chLog_l_time\"/></th>",
          "20:                         <th colspan=\"2\"><f:translate key=\"chLog_l_user\"/></th>",
          "21:                         <th>",
          "22:                             <f:if condition=\"{pageId}\">",
          "23:                                 <f:then>",
          "24:                                     <f:translate key=\"chLog_l_table\"/>",
          "25:                                 </f:then>",
          "26:                                 <f:else>",
          "27:                                     <f:translate key=\"chLog_l_level\"/>",
          "28:                                 </f:else>",
          "29:                             </f:if>",
          "30:                         </th>",
          "31:                         <th><f:translate key=\"chLog_l_channel\"/></th>",
          "32:                         <th><f:translate key=\"chLog_l_details\"/></th>",
          "33:                         <th class=\"col-control\"></th>",
          "34:                     </tr>",
          "35:                 </thead>",
          "36:                 <tbody>",
          "37:                     <f:for each=\"{day}\" as=\"logItem\">",
          "38:                         <tr>",
          "39:                             <td class=\"col-icon\">",
          "40:                                 <f:if condition=\"{logItem.errorIconClass}\">",
          "41:                                     <core:icon identifier=\"{logItem.errorIconClass}\" />",
          "42:                                 </f:if>",
          "43:                             </td>",
          "44:                             <td class=\"col-time\">",
          "45:                                 <f:format.date format=\"H:i:s\">@{logItem.tstamp}</f:format.date>",
          "46:                             </td>",
          "47:                             <td class=\"col-avatar\">",
          "48:                                 <f:if condition=\"{belog:username(uid:logItem.backendUserUid)}\">",
          "49:                                     <be:avatar backendUser=\"{logItem.backendUserUid}\" showIcon=\"true\"/>",
          "50:                                 </f:if>",
          "51:                             </td>",
          "52:                             <td>",
          "53:                                 <f:if condition=\"{belog:username(uid:logItem.backendUserUid)}\">",
          "54:                                     <f:then>",
          "55:                                         <belog:username uid=\"{logItem.backendUserUid}\"/>",
          "56:                                     </f:then>",
          "57:                                     <f:else>[{logItem.backendUserUid}]</f:else>",
          "58:                                 </f:if>",
          "59:                                 <f:if condition=\"{logItem.logData.originalUser}\">",
          "60:                                     ({f:translate(key:'viaUser')}",
          "61:                                     <f:if condition=\"{belog:username(uid:logItem.logData.originalUser)}\">",
          "63:                                             <belog:username uid=\"{logItem.logData.originalUser}\"/>",
          "65:                                         <f:else>[{logItem.logData.originalUser}]</f:else>",
          "67:                                     )",
          "68:                                 </f:if>",
          "69:                                 <f:if condition=\"{workspaces}\">",
          "70:                                     <br>",
          "71:                                     <span class=\"text-body-secondary\">",
          "72:                                         <f:if condition=\"{belog:workspaceTitle(uid:logItem.workspaceUid)}\">",
          "73:                                             <f:then><belog:workspaceTitle uid=\"{logItem.workspaceUid}\"/></f:then>",
          "74:                                             <f:else>[{logItem.workspaceUid}]</f:else>",
          "76:                                     </span>",
          "77:                                 </f:if>",
          "78:                             </td>",
          "79:                             <td>",
          "80:                                 <f:if condition=\"{pageId}\">",
          "81:                                     <f:then>",
          "82:                                         {logItem.tableName}",
          "83:                                     </f:then>",
          "84:                                     <f:else>",
          "85:                                         {logItem.level}",
          "86:                                     </f:else>",
          "87:                                 </f:if>",
          "88:                             </td>",
          "89:                             <td>",
          "90:                                 {logItem.channel}",
          "91:                             </td>",
          "92:                             <td class=\"col-word-break\">",
          "93:                                 <belog:formatDetails logEntry=\"{logItem}\"/>",
          "94:                             </td>",
          "95:                             <td class=\"col-control\">",
          "96:                                 <f:if condition=\"{logItem.error} == 1\">",
          "97:                                     <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-warning\">",
          "98:                                         <core:icon identifier=\"actions-delete\" size=\"small\"/>",
          "99:                                         <f:translate key=\"actions.deleteWarnings\"/>",
          "100:                                     </f:link.action>",
          "101:                                 </f:if>",
          "102:                                 <f:if condition=\"{logItem.error} == 2\">",
          "103:                                     <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-danger\">",
          "104:                                         <core:icon identifier=\"actions-delete\" size=\"small\"/>",
          "105:                                         <f:translate key=\"actions.delete\"/>",
          "106:                                     </f:link.action>",
          "107:                                 </f:if>",
          "108:                                 <f:if condition=\"{logItem.logData.history}\">",
          "109:                                     <a class=\"btn btn-sm btn-default\" href=\"{be:moduleLink(route: 'record_history', arguments: '{historyEntry: logItem.logData.history}')}\" title=\"{f:translate(key: 'showHistory')}\">",
          "110:                                         <core:icon identifier=\"actions-document-history-open\" />",
          "111:                                         <f:translate id=\"showHistory\" />",
          "112:                                     </a>",
          "113:                                 </f:if>",
          "114:                             </td>",
          "115:                         </tr>",
          "116:                     </f:for>",
          "117:                 </tbody>",
          "118:             </table>",
          "119:         </div>",
          "120:     </f:for>",
          "121: </f:for>",
          "",
          "[Added Lines]",
          "8: <f:if condition=\"{groupedLogEntries -> f:count()} > 0\">",
          "9:     <f:then>",
          "10:         <f:for each=\"{groupedLogEntries}\" as=\"pidEntry\" key=\"pid\">",
          "11:             <f:for each=\"{pidEntry}\" as=\"day\" key=\"dayTimestamp\">",
          "12:                 <h3>",
          "13:                     <f:format.date format=\"{settings.dateFormat}\">@{dayTimestamp}</f:format.date>",
          "14:                 </h3>",
          "16:                 <div class=\"table-fit\">",
          "17:                     <table class=\"table table-striped table-hover\">",
          "18:                         <thead>",
          "19:                             <tr>",
          "20:                                 <th></th>",
          "21:                                 <th><f:translate key=\"chLog_l_time\"/></th>",
          "22:                                 <th colspan=\"2\"><f:translate key=\"chLog_l_user\"/></th>",
          "23:                                 <th>",
          "24:                                     <f:if condition=\"{pageId}\">",
          "26:                                             <f:translate key=\"chLog_l_table\"/>",
          "28:                                         <f:else>",
          "29:                                             <f:translate key=\"chLog_l_level\"/>",
          "30:                                         </f:else>",
          "32:                                 </th>",
          "33:                                 <th><f:translate key=\"chLog_l_channel\"/></th>",
          "34:                                 <th><f:translate key=\"chLog_l_details\"/></th>",
          "35:                                 <th class=\"col-control\"></th>",
          "36:                             </tr>",
          "37:                         </thead>",
          "38:                         <tbody>",
          "39:                             <f:for each=\"{day}\" as=\"logItem\">",
          "40:                                 <tr>",
          "41:                                     <td class=\"col-icon\">",
          "42:                                         <f:if condition=\"{logItem.errorIconClass}\">",
          "43:                                             <core:icon identifier=\"{logItem.errorIconClass}\" />",
          "45:                                     </td>",
          "46:                                     <td class=\"col-time\">",
          "47:                                         <f:format.date format=\"H:i:s\">@{logItem.tstamp}</f:format.date>",
          "48:                                     </td>",
          "49:                                     <td class=\"col-avatar\">",
          "50:                                         <f:if condition=\"{belog:username(uid:logItem.backendUserUid)}\">",
          "51:                                             <be:avatar backendUser=\"{logItem.backendUserUid}\" showIcon=\"true\"/>",
          "52:                                         </f:if>",
          "53:                                     </td>",
          "54:                                     <td>",
          "55:                                         <f:if condition=\"{belog:username(uid:logItem.backendUserUid)}\">",
          "56:                                             <f:then>",
          "57:                                                 <belog:username uid=\"{logItem.backendUserUid}\"/>",
          "58:                                             </f:then>",
          "59:                                             <f:else>[{logItem.backendUserUid}]</f:else>",
          "60:                                         </f:if>",
          "61:                                         <f:if condition=\"{logItem.logData.originalUser}\">",
          "62:                                             ({f:translate(key:'viaUser')}",
          "63:                                             <f:if condition=\"{belog:username(uid:logItem.logData.originalUser)}\">",
          "64:                                                 <f:then>",
          "65:                                                     <belog:username uid=\"{logItem.logData.originalUser}\"/>",
          "66:                                                 </f:then>",
          "67:                                                 <f:else>[{logItem.logData.originalUser}]</f:else>",
          "68:                                             </f:if>",
          "69:                                             )",
          "70:                                         </f:if>",
          "71:                                         <f:if condition=\"{workspaces}\">",
          "72:                                             <br>",
          "73:                                             <span class=\"text-body-secondary\">",
          "74:                                                 <f:if condition=\"{belog:workspaceTitle(uid:logItem.workspaceUid)}\">",
          "75:                                                     <f:then><belog:workspaceTitle uid=\"{logItem.workspaceUid}\"/></f:then>",
          "76:                                                     <f:else>[{logItem.workspaceUid}]</f:else>",
          "77:                                                 </f:if>",
          "78:                                             </span>",
          "79:                                         </f:if>",
          "80:                                     </td>",
          "81:                                     <td>",
          "82:                                         <f:if condition=\"{pageId}\">",
          "83:                                             <f:then>",
          "84:                                                 {logItem.tableName}",
          "85:                                             </f:then>",
          "86:                                             <f:else>",
          "87:                                                 {logItem.level}",
          "88:                                             </f:else>",
          "89:                                         </f:if>",
          "90:                                     </td>",
          "91:                                     <td>",
          "92:                                         {logItem.channel}",
          "93:                                     </td>",
          "94:                                     <td class=\"col-word-break\">",
          "95:                                         <belog:formatDetails logEntry=\"{logItem}\"/>",
          "96:                                     </td>",
          "97:                                     <td class=\"col-control\">",
          "98:                                         <f:if condition=\"{logItem.error} == 1\">",
          "99:                                             <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-warning\">",
          "100:                                                 <core:icon identifier=\"actions-delete\" size=\"small\"/>",
          "101:                                                 <f:translate key=\"actions.deleteWarnings\"/>",
          "102:                                             </f:link.action>",
          "103:                                         </f:if>",
          "104:                                         <f:if condition=\"{logItem.error} == 2\">",
          "105:                                             <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-danger\">",
          "106:                                                 <core:icon identifier=\"actions-delete\" size=\"small\"/>",
          "107:                                                 <f:translate key=\"actions.delete\"/>",
          "108:                                             </f:link.action>",
          "109:                                         </f:if>",
          "110:                                         <f:if condition=\"{logItem.logData.history}\">",
          "111:                                             <a class=\"btn btn-sm btn-default\" href=\"{be:moduleLink(route: 'record_history', arguments: '{historyEntry: logItem.logData.history}')}\" title=\"{f:translate(key: 'showHistory')}\">",
          "112:                                                 <core:icon identifier=\"actions-document-history-open\" />",
          "113:                                                 <f:translate id=\"showHistory\" />",
          "114:                                             </a>",
          "115:                                         </f:if>",
          "116:                                     </td>",
          "117:                                 </tr>",
          "118:                             </f:for>",
          "119:                         </tbody>",
          "120:                     </table>",
          "121:                 </div>",
          "122:             </f:for>",
          "123:         </f:for>",
          "124:     </f:then>",
          "125:     <f:else>",
          "126:         <f:be.infobox",
          "127:             message=\"{f:translate(key: 'LLL:EXT:belog/Resources/Private/Language/locallang.xlf:info.noRecords.message')}\"",
          "128:             state=\"-2\"",
          "129:         />",
          "130:     </f:else>",
          "131: </f:if>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0eb171fcc5863c74f4890af0c6b3ccecb7e30cce",
      "candidate_info": {
        "commit_hash": "0eb171fcc5863c74f4890af0c6b3ccecb7e30cce",
        "repo": "TYPO3-CMS/belog",
        "commit_url": "https://github.com/TYPO3-CMS/belog/commit/0eb171fcc5863c74f4890af0c6b3ccecb7e30cce",
        "files": [
          "Classes/Controller/BackendLogController.php",
          "Resources/Private/Partials/Content/LogEntries.html"
        ],
        "message": "[SECURITY] Enforce HTTP method assertions for backend modules\n\nResolves: #104456\nReleases: main, 13.4, 12.4\nChange-Id: Ic679584a343b6d35e81325a03148b0cff81f1d27\nSecurity-Bulletin: TYPO3-CORE-SA-2025-003\nSecurity-Bulletin: TYPO3-CORE-SA-2025-004\nSecurity-Bulletin: TYPO3-CORE-SA-2025-005\nSecurity-Bulletin: TYPO3-CORE-SA-2025-006\nSecurity-Bulletin: TYPO3-CORE-SA-2025-007\nSecurity-Bulletin: TYPO3-CORE-SA-2025-008\nSecurity-References: CVE-2024-55893\nSecurity-References: CVE-2024-55894\nSecurity-References: CVE-2024-55920\nSecurity-References: CVE-2024-55921\nSecurity-References: CVE-2024-55922\nSecurity-References: CVE-2024-55923\nReviewed-on: https://review.typo3.org/c/Packages/TYPO3.CMS/+/87741\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
        "before_after_code_files": [
          "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php",
          "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php",
            "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
          ],
          "candidate": [
            "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php",
            "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
          ]
        }
      },
      "candidate_diff": {
        "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php": [
          "File: Classes/Controller/BackendLogController.php -> Classes/Controller/BackendLogController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: use TYPO3\\CMS\\Belog\\Domain\\Repository\\LogEntryRepository;",
          "26: use TYPO3\\CMS\\Core\\Authentication\\BackendUserAuthentication;",
          "27: use TYPO3\\CMS\\Core\\Database\\ConnectionPool;",
          "28: use TYPO3\\CMS\\Core\\Type\\Bitmask\\Permission;",
          "29: use TYPO3\\CMS\\Core\\Type\\ContextualFeedbackSeverity;",
          "30: use TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "28: use TYPO3\\CMS\\Core\\Http\\AllowedMethodsTrait;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "40: class BackendLogController extends ActionController",
          "41: {",
          "42:     public function __construct(",
          "43:         protected readonly ModuleTemplateFactory $moduleTemplateFactory,",
          "44:         protected readonly LogEntryRepository $logEntryRepository,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "43:     use AllowedMethodsTrait;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "124:             ->renderResponse('BackendLog/List');",
          "125:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "130:     public function initializeDeleteMessageAction(): void",
          "131:     {",
          "132:         $this->assertAllowedHttpMethod($this->request, 'POST');",
          "133:     }",
          "",
          "---------------"
        ],
        "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html": [
          "File: Resources/Private/Partials/Content/LogEntries.html -> Resources/Private/Partials/Content/LogEntries.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "96:                                     </td>",
          "97:                                     <td class=\"col-control\">",
          "98:                                         <f:if condition=\"{logItem.error} == 1\">",
          "100:                                                 <core:icon identifier=\"actions-delete\" size=\"small\"/>",
          "101:                                                 <f:translate key=\"actions.deleteWarnings\"/>",
          "103:                                         </f:if>",
          "104:                                         <f:if condition=\"{logItem.error} == 2\">",
          "106:                                                 <core:icon identifier=\"actions-delete\" size=\"small\"/>",
          "107:                                                 <f:translate key=\"actions.delete\"/>",
          "109:                                         </f:if>",
          "110:                                         <f:if condition=\"{logItem.logData.history}\">",
          "111:                                             <a class=\"btn btn-sm btn-default\" href=\"{be:moduleLink(route: 'record_history', arguments: '{historyEntry: logItem.logData.history}')}\" title=\"{f:translate(key: 'showHistory')}\">",
          "",
          "[Removed Lines]",
          "99:                                             <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-warning\">",
          "102:                                             </f:link.action>",
          "105:                                             <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-danger\">",
          "108:                                             </f:link.action>",
          "",
          "[Added Lines]",
          "99:                                             <f:form.button class=\"btn btn-sm btn-warning\" form=\"form-delete-message\" type=\"submit\" name=\"errorUid\" value=\"{logItem.uid}\">",
          "102:                                             </f:form.button>",
          "105:                                             <f:form.button class=\"btn btn-sm btn-danger\" form=\"form-delete-message\" type=\"submit\" name=\"errorUid\" value=\"{logItem.uid}\">",
          "108:                                             </f:form.button>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "121:                 </div>",
          "122:             </f:for>",
          "123:         </f:for>",
          "124:     </f:then>",
          "125:     <f:else>",
          "126:         <f:be.infobox",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125:         <f:form action=\"deleteMessage\" id=\"form-delete-message\" method=\"post\" class=\"hidden\"/>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "db399b80d94bd174e6699eccaf3fac7772a898a9",
      "candidate_info": {
        "commit_hash": "db399b80d94bd174e6699eccaf3fac7772a898a9",
        "repo": "TYPO3-CMS/belog",
        "commit_url": "https://github.com/TYPO3-CMS/belog/commit/db399b80d94bd174e6699eccaf3fac7772a898a9",
        "files": [
          "Classes/Controller/BackendLogController.php",
          "Resources/Private/Partials/Content/LogEntries.html"
        ],
        "message": "[SECURITY] Enforce HTTP method assertions for backend modules\n\nResolves: #104456\nReleases: main, 13.4, 12.4\nChange-Id: Ic679584a343b6d35e81325a03148b0cff81f1d27\nSecurity-Bulletin: TYPO3-CORE-SA-2025-003\nSecurity-Bulletin: TYPO3-CORE-SA-2025-004\nSecurity-Bulletin: TYPO3-CORE-SA-2025-005\nSecurity-Bulletin: TYPO3-CORE-SA-2025-006\nSecurity-Bulletin: TYPO3-CORE-SA-2025-007\nSecurity-Bulletin: TYPO3-CORE-SA-2025-008\nSecurity-References: CVE-2024-55893\nSecurity-References: CVE-2024-55894\nSecurity-References: CVE-2024-55920\nSecurity-References: CVE-2024-55921\nSecurity-References: CVE-2024-55922\nSecurity-References: CVE-2024-55923\nReviewed-on: https://review.typo3.org/c/Packages/TYPO3.CMS/+/87738\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
        "before_after_code_files": [
          "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php",
          "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php",
            "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
          ],
          "candidate": [
            "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php",
            "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html"
          ]
        }
      },
      "candidate_diff": {
        "Classes/Controller/BackendLogController.php||Classes/Controller/BackendLogController.php": [
          "File: Classes/Controller/BackendLogController.php -> Classes/Controller/BackendLogController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "25: use TYPO3\\CMS\\Belog\\Domain\\Repository\\LogEntryRepository;",
          "26: use TYPO3\\CMS\\Core\\Authentication\\BackendUserAuthentication;",
          "27: use TYPO3\\CMS\\Core\\Database\\ConnectionPool;",
          "28: use TYPO3\\CMS\\Core\\Type\\Bitmask\\Permission;",
          "29: use TYPO3\\CMS\\Core\\Type\\ContextualFeedbackSeverity;",
          "30: use TYPO3\\CMS\\Core\\Utility\\ExtensionManagementUtility;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "28: use TYPO3\\CMS\\Core\\Http\\AllowedMethodsTrait;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "41: class BackendLogController extends ActionController",
          "42: {",
          "43:     public function __construct(",
          "44:         protected readonly ModuleTemplateFactory $moduleTemplateFactory,",
          "45:         protected readonly LogEntryRepository $logEntryRepository,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "44:     use AllowedMethodsTrait;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "125:             ->renderResponse('BackendLog/List');",
          "126:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "131:     public function initializeDeleteMessageAction(): void",
          "132:     {",
          "133:         $this->assertAllowedHttpMethod($this->request, 'POST');",
          "134:     }",
          "",
          "---------------"
        ],
        "Resources/Private/Partials/Content/LogEntries.html||Resources/Private/Partials/Content/LogEntries.html": [
          "File: Resources/Private/Partials/Content/LogEntries.html -> Resources/Private/Partials/Content/LogEntries.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "96:                                     </td>",
          "97:                                     <td class=\"col-control\">",
          "98:                                         <f:if condition=\"{logItem.error} == 1\">",
          "100:                                                 <core:icon identifier=\"actions-delete\" size=\"small\"/>",
          "101:                                                 <f:translate key=\"actions.deleteWarnings\"/>",
          "103:                                         </f:if>",
          "104:                                         <f:if condition=\"{logItem.error} == 2\">",
          "106:                                                 <core:icon identifier=\"actions-delete\" size=\"small\"/>",
          "107:                                                 <f:translate key=\"actions.delete\"/>",
          "109:                                         </f:if>",
          "110:                                         <f:if condition=\"{logItem.logData.history}\">",
          "111:                                             <a class=\"btn btn-sm btn-default\" href=\"{be:moduleLink(route: 'record_history', arguments: '{historyEntry: logItem.logData.history}')}\" title=\"{f:translate(key: 'showHistory')}\">",
          "",
          "[Removed Lines]",
          "99:                                             <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-warning\">",
          "102:                                             </f:link.action>",
          "105:                                             <f:link.action action=\"deleteMessage\" arguments=\"{errorUid:logItem.uid}\" class=\"btn btn-sm btn-danger\">",
          "108:                                             </f:link.action>",
          "",
          "[Added Lines]",
          "99:                                             <f:form.button class=\"btn btn-sm btn-warning\" form=\"form-delete-message\" type=\"submit\" name=\"errorUid\" value=\"{logItem.uid}\">",
          "102:                                             </f:form.button>",
          "105:                                             <f:form.button class=\"btn btn-sm btn-danger\" form=\"form-delete-message\" type=\"submit\" name=\"errorUid\" value=\"{logItem.uid}\">",
          "108:                                             </f:form.button>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "121:                 </div>",
          "122:             </f:for>",
          "123:         </f:for>",
          "124:     </f:then>",
          "125:     <f:else>",
          "126:         <f:be.infobox",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125:         <f:form action=\"deleteMessage\" id=\"form-delete-message\" method=\"post\" class=\"hidden\"/>",
          "",
          "---------------"
        ]
      }
    }
  ]
}