{
  "cve_id": "CVE-2024-55923",
  "cve_desc": "TYPO3 is a free and open source Content Management Framework. A vulnerability has been identified in the backend user interface functionality involving deep links. Specifically, this functionality is susceptible to Cross-Site Request Forgery (CSRF). Additionally, state-changing actions in downstream components incorrectly accepted submissions via HTTP GET and did not enforce the appropriate HTTP method. Successful exploitation of this vulnerability requires the victim to have an active session on the backend user interface and to be deceived into interacting with a malicious URL targeting the backend, which can occur under the following conditions: The user opens a malicious link, such as one sent via email. The user visits a compromised or manipulated website while the following settings are misconfigured: 1. `security.backend.enforceReferrer` feature is disabled, 2. `BE/cookieSameSite` configuration is set to lax or none. The vulnerability in the affected downstream component \u201cIndexed Search Module\u201d allows attackers to delete items of the component. Users are advised to update to TYPO3 versions 11.5.42 ELTS, 12.4.25 LTS, 13.4.3 LTS which fix the problem described. There are no known workarounds for this issue.",
  "repo": "TYPO3-CMS/indexed_search",
  "patch_hash": "cfda3f1edeea3c50034bce5c25393e297408c2b4",
  "patch_info": {
    "commit_hash": "cfda3f1edeea3c50034bce5c25393e297408c2b4",
    "repo": "TYPO3-CMS/indexed_search",
    "commit_url": "https://github.com/TYPO3-CMS/indexed_search/commit/cfda3f1edeea3c50034bce5c25393e297408c2b4",
    "files": [
      "Classes/Controller/AdministrationController.php",
      "Resources/Private/Templates/Administration/Statistic.html"
    ],
    "message": "[SECURITY] Enforce HTTP method assertions for backend modules\n\nResolves: #104456\nReleases: main, 13.4, 12.4\nChange-Id: Ic679584a343b6d35e81325a03148b0cff81f1d27\nSecurity-Bulletin: TYPO3-CORE-SA-2025-003\nSecurity-Bulletin: TYPO3-CORE-SA-2025-004\nSecurity-Bulletin: TYPO3-CORE-SA-2025-005\nSecurity-Bulletin: TYPO3-CORE-SA-2025-006\nSecurity-Bulletin: TYPO3-CORE-SA-2025-007\nSecurity-Bulletin: TYPO3-CORE-SA-2025-008\nSecurity-References: CVE-2024-55893\nSecurity-References: CVE-2024-55894\nSecurity-References: CVE-2024-55920\nSecurity-References: CVE-2024-55921\nSecurity-References: CVE-2024-55922\nSecurity-References: CVE-2024-55923\nReviewed-on: https://review.typo3.org/c/Packages/TYPO3.CMS/+/87744\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
    "before_after_code_files": [
      "Classes/Controller/AdministrationController.php||Classes/Controller/AdministrationController.php",
      "Resources/Private/Templates/Administration/Statistic.html||Resources/Private/Templates/Administration/Statistic.html"
    ]
  },
  "patch_diff": {
    "Classes/Controller/AdministrationController.php||Classes/Controller/AdministrationController.php": [
      "File: Classes/Controller/AdministrationController.php -> Classes/Controller/AdministrationController.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "26: use TYPO3\\CMS\\Core\\Configuration\\ExtensionConfiguration;",
      "27: use TYPO3\\CMS\\Core\\Database\\Connection;",
      "28: use TYPO3\\CMS\\Core\\Database\\ConnectionPool;",
      "29: use TYPO3\\CMS\\Core\\Imaging\\IconFactory;",
      "30: use TYPO3\\CMS\\Core\\Imaging\\IconSize;",
      "31: use TYPO3\\CMS\\Core\\Localization\\LanguageService;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "29: use TYPO3\\CMS\\Core\\Http\\AllowedMethodsTrait;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "45: class AdministrationController extends ActionController",
      "46: {",
      "47:     protected int $pageUid = 0;",
      "48:     protected array $indexerConfig = [];",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "48:     use AllowedMethodsTrait;",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "300:         return $view->renderResponse('Administration/StatisticDetails');",
      "301:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "306:     protected function initializeSaveStopwordsAction(): void",
      "307:     {",
      "308:         $this->assertAllowedHttpMethod($this->request, 'POST');",
      "309:     }",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "391:         return $view->renderResponse('Administration/Statistic');",
      "392:     }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "402:     protected function initializeDeleteIndexedItemAction(): void",
      "403:     {",
      "404:         $this->assertAllowedHttpMethod($this->request, 'POST');",
      "405:     }",
      "",
      "---------------"
    ],
    "Resources/Private/Templates/Administration/Statistic.html||Resources/Private/Templates/Administration/Statistic.html": [
      "File: Resources/Private/Templates/Administration/Statistic.html -> Resources/Private/Templates/Administration/Statistic.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "128:                                                 </f:defaultCase>",
      "129:                                             </f:switch>",
      "130:                                             <td class=\"col-control\">",
      "132:                                                     <f:link.action",
      "133:                                                         action=\"statisticDetails\"",
      "134:                                                         arguments=\"{pageHash:l.phash}\"",
      "",
      "[Removed Lines]",
      "131:                                                 <div class=\"btn-group btn-group-sm\">",
      "",
      "[Added Lines]",
      "131:                                                 <f:form action=\"deleteIndexedItem\" class=\"btn-group btn-group-sm\">",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "137:                                                     >",
      "138:                                                         <core:icon identifier=\"actions-options\" />",
      "139:                                                     </f:link.action>",
      "142:                                                         title=\"{f:translate(key:'administration.removeEntry')}\"",
      "143:                                                         class=\"btn btn-default\"",
      "144:                                                     >",
      "145:                                                         <core:icon identifier=\"actions-edit-delete\" />",
      "148:                                             </td>",
      "149:                                         </tr>",
      "150:                                     </f:for>",
      "",
      "[Removed Lines]",
      "140:                                                     <a",
      "141:                                                         href=\"{f:uri.action(action:'deleteIndexedItem',arguments:'{itemId:l.phash,depth:depth,mode:mode}')}\"",
      "146:                                                     </a>",
      "147:                                                 </div>",
      "",
      "[Added Lines]",
      "141:                                                     <f:form.hidden name=\"itemId\" value=\"{l.phash}\" />",
      "142:                                                     <f:form.hidden name=\"depth\" value=\"{depth}\" />",
      "143:                                                     <f:form.hidden name=\"mode\" value=\"{mode}\" />",
      "145:                                                     <button",
      "146:                                                         type=\"submit\"",
      "151:                                                     </button>",
      "152:                                                 </f:form>",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "181:                     </tbody>",
      "182:                 </table>",
      "183:             </div>",
      "192:         </f:then>",
      "193:         <f:else>",
      "194:             <f:be.infobox",
      "",
      "[Removed Lines]",
      "184:             <a",
      "185:                 href=\"{f:uri.action(action:'deleteIndexedItem', arguments:'{itemId:\\'ALL\\', depth:depth, mode:mode}')}\"",
      "186:                 title=\"{f:translate(key:'administration.removeAllEntries')}\"",
      "187:                 class=\"btn btn-default\"",
      "188:             >",
      "189:                 <core:icon identifier=\"actions-edit-delete\" />",
      "190:                 <f:translate key=\"LLL:EXT:indexed_search/Resources/Private/Language/locallang.xlf:administration.removeAllEntries\" />",
      "191:             </a>",
      "",
      "[Added Lines]",
      "189:             <f:form action=\"deleteIndexedItem\">",
      "190:                 <f:form.hidden name=\"itemId\" value=\"ALL\" />",
      "191:                 <f:form.hidden name=\"depth\" value=\"{depth}\" />",
      "192:                 <f:form.hidden name=\"mode\" value=\"{mode}\" />",
      "194:                 <button",
      "195:                     type=\"submit\"",
      "196:                     title=\"{f:translate(key:'administration.removeAllEntries')}\"",
      "197:                     class=\"btn btn-default\"",
      "198:                 >",
      "199:                     <core:icon identifier=\"actions-edit-delete\" />",
      "200:                     <f:translate key=\"LLL:EXT:indexed_search/Resources/Private/Language/locallang.xlf:administration.removeAllEntries\" />",
      "201:                 </button>",
      "202:             </f:form>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "7835cda33f4bff7b28078f6307e94b746ac55890",
      "candidate_info": {
        "commit_hash": "7835cda33f4bff7b28078f6307e94b746ac55890",
        "repo": "TYPO3-CMS/indexed_search",
        "commit_url": "https://github.com/TYPO3-CMS/indexed_search/commit/7835cda33f4bff7b28078f6307e94b746ac55890",
        "files": [
          "Classes/Controller/AdministrationController.php",
          "Resources/Private/Templates/Administration/Statistic.html"
        ],
        "message": "[SECURITY] Enforce HTTP method assertions for backend modules\n\nResolves: #104456\nReleases: main, 13.4, 12.4\nChange-Id: Ic679584a343b6d35e81325a03148b0cff81f1d27\nSecurity-Bulletin: TYPO3-CORE-SA-2025-003\nSecurity-Bulletin: TYPO3-CORE-SA-2025-004\nSecurity-Bulletin: TYPO3-CORE-SA-2025-005\nSecurity-Bulletin: TYPO3-CORE-SA-2025-006\nSecurity-Bulletin: TYPO3-CORE-SA-2025-007\nSecurity-Bulletin: TYPO3-CORE-SA-2025-008\nSecurity-References: CVE-2024-55893\nSecurity-References: CVE-2024-55894\nSecurity-References: CVE-2024-55920\nSecurity-References: CVE-2024-55921\nSecurity-References: CVE-2024-55922\nSecurity-References: CVE-2024-55923\nReviewed-on: https://review.typo3.org/c/Packages/TYPO3.CMS/+/87738\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
        "before_after_code_files": [
          "Classes/Controller/AdministrationController.php||Classes/Controller/AdministrationController.php",
          "Resources/Private/Templates/Administration/Statistic.html||Resources/Private/Templates/Administration/Statistic.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_message": 1,
        "olp_code_files": {
          "patch": [
            "Classes/Controller/AdministrationController.php||Classes/Controller/AdministrationController.php",
            "Resources/Private/Templates/Administration/Statistic.html||Resources/Private/Templates/Administration/Statistic.html"
          ],
          "candidate": [
            "Classes/Controller/AdministrationController.php||Classes/Controller/AdministrationController.php",
            "Resources/Private/Templates/Administration/Statistic.html||Resources/Private/Templates/Administration/Statistic.html"
          ]
        }
      },
      "candidate_diff": {
        "Classes/Controller/AdministrationController.php||Classes/Controller/AdministrationController.php": [
          "File: Classes/Controller/AdministrationController.php -> Classes/Controller/AdministrationController.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: use TYPO3\\CMS\\Core\\Configuration\\ExtensionConfiguration;",
          "27: use TYPO3\\CMS\\Core\\Database\\Connection;",
          "28: use TYPO3\\CMS\\Core\\Database\\ConnectionPool;",
          "29: use TYPO3\\CMS\\Core\\Imaging\\Icon;",
          "30: use TYPO3\\CMS\\Core\\Imaging\\IconFactory;",
          "31: use TYPO3\\CMS\\Core\\Localization\\LanguageService;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29: use TYPO3\\CMS\\Core\\Http\\AllowedMethodsTrait;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "45: class AdministrationController extends ActionController",
          "46: {",
          "47:     protected int $pageUid = 0;",
          "48:     protected array $indexerConfig = [];",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "48:     use AllowedMethodsTrait;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "398:         return $view->renderResponse('Administration/StatisticDetails');",
          "399:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "404:     protected function initializeSaveStopwordsKeywordsAction(): void",
          "405:     {",
          "406:         $this->assertAllowedHttpMethod($this->request, 'POST');",
          "407:     }",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "490:         return $view->renderResponse('Administration/Statistic');",
          "491:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "501:     protected function initializeDeleteIndexedItemAction(): void",
          "502:     {",
          "503:         $this->assertAllowedHttpMethod($this->request, 'POST');",
          "504:     }",
          "",
          "---------------"
        ],
        "Resources/Private/Templates/Administration/Statistic.html||Resources/Private/Templates/Administration/Statistic.html": [
          "File: Resources/Private/Templates/Administration/Statistic.html -> Resources/Private/Templates/Administration/Statistic.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "36:                         <tr>",
          "37:                             <th></th>",
          "38:                             <th>",
          "42:                             </th>",
          "43:                             <th>",
          "44:                                 <f:translate key=\"field.fileName\" />",
          "",
          "[Removed Lines]",
          "39:                                 <a href=\"{f:uri.action(action:'deleteIndexedItem', arguments:'{itemId:\\'ALL\\', depth:depth, mode:mode}')}\" title=\"{f:translate(key:'administration.removeAllEntries')}\">",
          "40:                                     <core:icon identifier=\"actions-edit-delete\" />",
          "41:                                 </a>",
          "",
          "[Added Lines]",
          "39:                                 <f:form action=\"deleteIndexedItem\">",
          "40:                                     <f:form.hidden name=\"itemId\" value=\"ALL\" />",
          "41:                                     <f:form.hidden name=\"depth\" value=\"{depth}\" />",
          "42:                                     <f:form.hidden name=\"mode\" value=\"{mode}\" />",
          "44:                                     <button",
          "45:                                         type=\"submit\"",
          "46:                                         title=\"{f:translate(key:'administration.removeAllEntries')}\"",
          "47:                                         class=\"btn btn-default\"",
          "48:                                     >",
          "49:                                         <core:icon identifier=\"actions-edit-delete\" />",
          "50:                                         <f:translate key=\"LLL:EXT:indexed_search/Resources/Private/Language/locallang.xlf:administration.removeAllEntries\" />",
          "51:                                     </button>",
          "52:                                 </f:form>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "81:                                                 <f:if condition=\"{i.index} == 0\"> {line.row.title}</f:if>",
          "82:                                             </td>",
          "83:                                             <td>",
          "87:                                             </td>",
          "88:                                             <td>",
          "89:                                                 <f:image src=\"{l.icon}\" />",
          "",
          "[Removed Lines]",
          "84:                                                 <a href=\"{f:uri.action(action:'deleteIndexedItem',arguments:'{itemId:l.phash,depth:depth,mode:mode}')}\" title=\"{f:translate(key:'administration.removeEntry')}\">",
          "85:                                                     <core:icon identifier=\"actions-edit-delete\" />",
          "86:                                                 </a>",
          "",
          "[Added Lines]",
          "95:                                                 <f:form action=\"deleteIndexedItem\" class=\"btn-group btn-group-sm\">",
          "97:                                                     <f:form.hidden name=\"itemId\" value=\"{l.phash}\" />",
          "98:                                                     <f:form.hidden name=\"depth\" value=\"{depth}\" />",
          "99:                                                     <f:form.hidden name=\"mode\" value=\"{mode}\" />",
          "101:                                                     <button",
          "102:                                                         type=\"submit\"",
          "103:                                                         title=\"{f:translate(key:'administration.removeEntry')}\"",
          "104:                                                         class=\"btn btn-default\"",
          "105:                                                     >",
          "106:                                                         <core:icon identifier=\"actions-edit-delete\" />",
          "107:                                                     </button>",
          "108:                                                 </f:form>",
          "",
          "---------------"
        ]
      }
    }
  ]
}