{
  "cve_id": "CVE-2024-8060",
  "cve_desc": "OpenWebUI version 0.3.0 contains a vulnerability in the audio API endpoint `/audio/api/v1/transcriptions` that allows for arbitrary file upload. The application performs insufficient validation on the `file.content_type` and allows user-controlled filenames, leading to a path traversal vulnerability. This can be exploited by an authenticated user to overwrite critical files within the Docker container, potentially leading to remote code execution as the root user.",
  "repo": "open-webui/open-webui",
  "patch_hash": "613a087387c094e71ee91d29c015195ef401e160",
  "patch_info": {
    "commit_hash": "613a087387c094e71ee91d29c015195ef401e160",
    "repo": "open-webui/open-webui",
    "commit_url": "https://github.com/open-webui/open-webui/commit/613a087387c094e71ee91d29c015195ef401e160",
    "files": [
      "backend/open_webui/routers/audio.py"
    ],
    "message": "refac",
    "before_after_code_files": [
      "backend/open_webui/routers/audio.py||backend/open_webui/routers/audio.py"
    ]
  },
  "patch_diff": {
    "backend/open_webui/routers/audio.py||backend/open_webui/routers/audio.py": [
      "File: backend/open_webui/routers/audio.py -> backend/open_webui/routers/audio.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "681:     available_models = []",
      "682:     if request.app.state.config.TTS_ENGINE == \"openai\":",
      "683:         # Use custom endpoint if not using the official OpenAI API URL",
      "685:             try:",
      "687:                 response.raise_for_status()",
      "688:                 data = response.json()",
      "689:                 available_models = data.get(\"models\", [])",
      "690:             except Exception as e:",
      "691:                 log.error(f\"Error fetching models from custom endpoint: {str(e)}\")",
      "693:         else:",
      "694:             available_models = [{\"id\": \"tts-1\"}, {\"id\": \"tts-1-hd\"}]",
      "695:     elif request.app.state.config.TTS_ENGINE == \"elevenlabs\":",
      "",
      "[Removed Lines]",
      "684:         if not request.app.state.config.TTS_OPENAI_API_BASE_URL.startswith(\"https://api.openai.com\"):",
      "686:                 response = requests.get(f\"{request.app.state.config.TTS_OPENAI_API_BASE_URL}/audio/models\")",
      "692:                 available_models = []",
      "",
      "[Added Lines]",
      "684:         if not request.app.state.config.TTS_OPENAI_API_BASE_URL.startswith(",
      "685:             \"https://api.openai.com\"",
      "686:         ):",
      "688:                 response = requests.get(",
      "689:                     f\"{request.app.state.config.TTS_OPENAI_API_BASE_URL}/audio/models\"",
      "690:                 )",
      "696:                 available_models = [{\"id\": \"tts-1\"}, {\"id\": \"tts-1-hd\"}]",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "723:     available_voices = {}",
      "724:     if request.app.state.config.TTS_ENGINE == \"openai\":",
      "725:         # Use custom endpoint if not using the official OpenAI API URL",
      "727:             try:",
      "729:                 response.raise_for_status()",
      "730:                 data = response.json()",
      "731:                 voices_list = data.get(\"voices\", [])",
      "732:                 available_voices = {voice[\"id\"]: voice[\"name\"] for voice in voices_list}",
      "733:             except Exception as e:",
      "734:                 log.error(f\"Error fetching voices from custom endpoint: {str(e)}\")",
      "736:         else:",
      "737:             available_voices = {",
      "738:                 \"alloy\": \"alloy\",",
      "",
      "[Removed Lines]",
      "726:         if not request.app.state.config.TTS_OPENAI_API_BASE_URL.startswith(\"https://api.openai.com\"):",
      "728:                 response = requests.get(f\"{request.app.state.config.TTS_OPENAI_API_BASE_URL}/audio/voices\")",
      "735:                 available_voices = {}",
      "",
      "[Added Lines]",
      "730:         if not request.app.state.config.TTS_OPENAI_API_BASE_URL.startswith(",
      "731:             \"https://api.openai.com\"",
      "732:         ):",
      "734:                 response = requests.get(",
      "735:                     f\"{request.app.state.config.TTS_OPENAI_API_BASE_URL}/audio/voices\"",
      "736:                 )",
      "743:                 available_voices = {",
      "744:                     \"alloy\": \"alloy\",",
      "745:                     \"echo\": \"echo\",",
      "746:                     \"fable\": \"fable\",",
      "747:                     \"onyx\": \"onyx\",",
      "748:                     \"nova\": \"nova\",",
      "749:                     \"shimmer\": \"shimmer\",",
      "750:                 }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "396c28817c65b62ab1168994f6913b63d55af6c9",
      "candidate_info": {
        "commit_hash": "396c28817c65b62ab1168994f6913b63d55af6c9",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/396c28817c65b62ab1168994f6913b63d55af6c9",
        "files": [
          "backend/open_webui/env.py",
          "backend/open_webui/main.py",
          "backend/open_webui/utils/telemetry/__init__.py",
          "backend/open_webui/utils/telemetry/constants.py",
          "backend/open_webui/utils/telemetry/exporters.py",
          "backend/open_webui/utils/telemetry/instrumentors.py",
          "backend/open_webui/utils/telemetry/setup.py",
          "backend/requirements.txt"
        ],
        "message": "refac",
        "before_after_code_files": [
          "backend/open_webui/env.py||backend/open_webui/env.py",
          "backend/open_webui/main.py||backend/open_webui/main.py",
          "backend/open_webui/utils/trace/instrumentors.py||backend/open_webui/utils/telemetry/instrumentors.py",
          "backend/open_webui/utils/trace/setup.py||backend/open_webui/utils/telemetry/setup.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "backend/open_webui/env.py||backend/open_webui/env.py": [
          "File: backend/open_webui/env.py -> backend/open_webui/env.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "437: # OPENTELEMETRY",
          "438: ####################################",
          "441: OTEL_EXPORTER_OTLP_ENDPOINT = os.environ.get(",
          "442:     \"OTEL_EXPORTER_OTLP_ENDPOINT\", \"http://localhost:4317\"",
          "443: )",
          "",
          "[Removed Lines]",
          "440: OTEL_SDK_DISABLED = os.environ.get(\"OTEL_SDK_DISABLED\", \"true\").lower() == \"true\"",
          "",
          "[Added Lines]",
          "440: ENABLE_OTEL = os.environ.get(\"ENABLE_OTEL\", \"False\").lower() == \"true\"",
          "",
          "---------------"
        ],
        "backend/open_webui/main.py||backend/open_webui/main.py": [
          "File: backend/open_webui/main.py -> backend/open_webui/main.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "330:     BYPASS_MODEL_ACCESS_CONTROL,",
          "331:     RESET_CONFIG_ON_START,",
          "332:     OFFLINE_MODE,",
          "334: )",
          "",
          "[Removed Lines]",
          "333:     OTEL_SDK_DISABLED,",
          "",
          "[Added Lines]",
          "333:     ENABLE_OTEL,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "357: from open_webui.utils.security_headers import SecurityHeadersMiddleware",
          "359: from open_webui.tasks import stop_task, list_tasks  # Import from tasks.py",
          "362: if SAFE_MODE:",
          "363:     print(\"SAFE MODE ENABLED\")",
          "",
          "[Removed Lines]",
          "360: from open_webui.utils.trace.setup import setup",
          "",
          "[Added Lines]",
          "360: from open_webui.utils.telemetry.setup import setup as setup_opentelemetry",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "434: #",
          "435: ########################################",
          "441: ########################################",
          "",
          "[Removed Lines]",
          "437: if not OTEL_SDK_DISABLED:",
          "438:     setup(app=app, db_engine=engine)",
          "",
          "[Added Lines]",
          "437: if not ENABLE_OTEL:",
          "438:     setup_opentelemetry(app=app, db_engine=engine)",
          "",
          "---------------"
        ],
        "backend/open_webui/utils/trace/instrumentors.py||backend/open_webui/utils/telemetry/instrumentors.py": [
          "File: backend/open_webui/utils/trace/instrumentors.py -> backend/open_webui/utils/telemetry/instrumentors.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "26: from sqlalchemy import Engine",
          "27: from fastapi import status",
          "31: from open_webui.env import SRC_LOG_LEVELS",
          "",
          "[Removed Lines]",
          "29: from open_webui.utils.trace.constants import SPAN_REDIS_TYPE, SpanAttributes",
          "",
          "[Added Lines]",
          "29: from open_webui.utils.telemetry.constants import SPAN_REDIS_TYPE, SpanAttributes",
          "",
          "---------------"
        ],
        "backend/open_webui/utils/trace/setup.py||backend/open_webui/utils/telemetry/setup.py": [
          "File: backend/open_webui/utils/trace/setup.py -> backend/open_webui/utils/telemetry/setup.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: from opentelemetry.sdk.trace import TracerProvider",
          "6: from sqlalchemy import Engine",
          "10: from open_webui.env import OTEL_SERVICE_NAME, OTEL_EXPORTER_OTLP_ENDPOINT",
          "",
          "[Removed Lines]",
          "8: from open_webui.utils.trace.exporters import LazyBatchSpanProcessor",
          "9: from open_webui.utils.trace.instrumentors import Instrumentor",
          "",
          "[Added Lines]",
          "8: from open_webui.utils.telemetry.exporters import LazyBatchSpanProcessor",
          "9: from open_webui.utils.telemetry.instrumentors import Instrumentor",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "052531ac1318cd0319ccae9d202b22b3d5e6326d",
      "candidate_info": {
        "commit_hash": "052531ac1318cd0319ccae9d202b22b3d5e6326d",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/052531ac1318cd0319ccae9d202b22b3d5e6326d",
        "files": [
          "src/lib/components/admin/Settings/General.svelte"
        ],
        "message": "refac",
        "before_after_code_files": [
          "src/lib/components/admin/Settings/General.svelte||src/lib/components/admin/Settings/General.svelte"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/lib/components/admin/Settings/General.svelte||src/lib/components/admin/Settings/General.svelte": [
          "File: src/lib/components/admin/Settings/General.svelte -> src/lib/components/admin/Settings/General.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "116:   {#if adminConfig !== null}",
          "117:    <div class=\"\">",
          "118:     <div class=\"mb-3.5\">",
          "121:      <hr class=\" border-gray-50 dark:border-gray-850 my-2\" />",
          "124:       <div class=\" mb-1 text-xs font-medium flex space-x-2 items-center\">",
          "125:        <div>",
          "126:         {$i18n.t('Version')}",
          "",
          "[Removed Lines]",
          "119:      <div class=\" mb-2 text-base font-medium\">{$i18n.t('General')}</div>",
          "123:      <div class=\"mb-2\">",
          "",
          "[Added Lines]",
          "119:      <div class=\" mb-2.5 text-base font-medium\">{$i18n.t('General')}</div>",
          "123:      <div class=\"mb-2.5\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "168:       </div>",
          "169:      </div>",
          "172:       <div class=\"flex w-full justify-between items-center\">",
          "173:        <div class=\"text-xs\">",
          "174:         <div class=\"\">",
          "",
          "[Removed Lines]",
          "171:      <div class=\"mb-2\">",
          "",
          "[Added Lines]",
          "171:      <div class=\"mb-2.5\">",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "214:       </div>",
          "215:      </div>",
          "218:       <div class=\"flex w-full justify-between items-center\">",
          "219:        <div class=\"text-xs\">",
          "220:         <div class=\"\">",
          "",
          "[Removed Lines]",
          "217:      <div class=\"mb-2\">",
          "",
          "[Added Lines]",
          "217:      <div class=\"mb-2.5\">",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "239:     </div>",
          "241:     <div class=\"mb-3\">",
          "244:      <hr class=\" border-gray-50 dark:border-gray-850 my-2\" />",
          "247:       <div class=\" self-center text-xs font-medium\">{$i18n.t('Default User Role')}</div>",
          "248:       <div class=\"flex items-center relative\">",
          "249:        <select",
          "",
          "[Removed Lines]",
          "242:      <div class=\" mb-2 text-base font-medium\">{$i18n.t('Authentication')}</div>",
          "246:      <div class=\"  mb-2 flex w-full justify-between\">",
          "",
          "[Added Lines]",
          "242:      <div class=\" mb-2.5 text-base font-medium\">{$i18n.t('Authentication')}</div>",
          "246:      <div class=\"  mb-2.5 flex w-full justify-between\">",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "258:       </div>",
          "259:      </div>",
          "262:       <div class=\" self-center text-xs font-medium\">{$i18n.t('Enable New Sign Ups')}</div>",
          "264:       <Switch bind:state={adminConfig.ENABLE_SIGNUP} />",
          "265:      </div>",
          "268:       <div class=\" self-center text-xs font-medium\">",
          "269:        {$i18n.t('Show Admin Details in Account Pending Overlay')}",
          "270:       </div>",
          "",
          "[Removed Lines]",
          "261:      <div class=\" mb-2 flex w-full justify-between pr-2\">",
          "267:      <div class=\"mb-2 flex w-full items-center justify-between pr-2\">",
          "",
          "[Added Lines]",
          "261:      <div class=\" mb-2.5 flex w-full justify-between pr-2\">",
          "267:      <div class=\"mb-2.5 flex w-full items-center justify-between pr-2\">",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "272:       <Switch bind:state={adminConfig.SHOW_ADMIN_DETAILS} />",
          "273:      </div>",
          "276:       <div class=\" self-center text-xs font-medium\">{$i18n.t('Enable API Key')}</div>",
          "278:       <Switch bind:state={adminConfig.ENABLE_API_KEY} />",
          "279:      </div>",
          "281:      {#if adminConfig?.ENABLE_API_KEY}",
          "283:        <div class=\" self-center text-xs font-medium\">",
          "284:         {$i18n.t('API Key Endpoint Restrictions')}",
          "285:        </div>",
          "",
          "[Removed Lines]",
          "275:      <div class=\"mb-2 flex w-full justify-between pr-2\">",
          "282:       <div class=\"mb-2 flex w-full justify-between pr-2\">",
          "",
          "[Added Lines]",
          "275:      <div class=\"mb-2.5 flex w-full justify-between pr-2\">",
          "282:       <div class=\"mb-2.5 flex w-full justify-between pr-2\">",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "314:       {/if}",
          "315:      {/if}",
          "318:       <div class=\"flex w-full justify-between\">",
          "319:        <div class=\" self-center text-xs font-medium\">{$i18n.t('JWT Expiration')}</div>",
          "320:       </div>",
          "",
          "[Removed Lines]",
          "317:      <div class=\" mb-2 w-full justify-between\">",
          "",
          "[Added Lines]",
          "317:      <div class=\" mb-2.5 w-full justify-between\">",
          "",
          "---------------",
          "--- Hunk 8 ---",
          "[Context before]",
          "551:     </div>",
          "553:     <div class=\"mb-3\">",
          "556:      <hr class=\" border-gray-50 dark:border-gray-850 my-2\" />",
          "559:       <div class=\" self-center text-xs font-medium\">",
          "560:        {$i18n.t('Enable Community Sharing')}",
          "561:       </div>",
          "",
          "[Removed Lines]",
          "554:      <div class=\" mb-2 text-base font-medium\">{$i18n.t('Features')}</div>",
          "558:      <div class=\"mb-2 flex w-full items-center justify-between pr-2\">",
          "",
          "[Added Lines]",
          "554:      <div class=\" mb-2.5 text-base font-medium\">{$i18n.t('Features')}</div>",
          "558:      <div class=\"mb-2.5 flex w-full items-center justify-between pr-2\">",
          "",
          "---------------",
          "--- Hunk 9 ---",
          "[Context before]",
          "563:       <Switch bind:state={adminConfig.ENABLE_COMMUNITY_SHARING} />",
          "564:      </div>",
          "567:       <div class=\" self-center text-xs font-medium\">{$i18n.t('Enable Message Rating')}</div>",
          "569:       <Switch bind:state={adminConfig.ENABLE_MESSAGE_RATING} />",
          "570:      </div>",
          "573:       <div class=\" self-center text-xs font-medium\">",
          "574:        {$i18n.t('Channels')} ({$i18n.t('Beta')})",
          "575:       </div>",
          "",
          "[Removed Lines]",
          "566:      <div class=\"mb-2 flex w-full items-center justify-between pr-2\">",
          "572:      <div class=\"mb-2 flex w-full items-center justify-between pr-2\">",
          "",
          "[Added Lines]",
          "566:      <div class=\"mb-2.5 flex w-full items-center justify-between pr-2\">",
          "572:      <div class=\"mb-2.5 flex w-full items-center justify-between pr-2\">",
          "",
          "---------------",
          "--- Hunk 10 ---",
          "[Context before]",
          "577:       <Switch bind:state={adminConfig.ENABLE_CHANNELS} />",
          "578:      </div>",
          "581:       <div class=\"flex w-full justify-between\">",
          "582:        <div class=\" self-center text-xs font-medium\">{$i18n.t('WebUI URL')}</div>",
          "583:       </div>",
          "",
          "[Removed Lines]",
          "580:      <div class=\"mb-2 w-full justify-between\">",
          "",
          "[Added Lines]",
          "580:      <div class=\"mb-2.5 w-full justify-between\">",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "b94de4f0026008ab18c96be5475f68252b509cce",
      "candidate_info": {
        "commit_hash": "b94de4f0026008ab18c96be5475f68252b509cce",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/b94de4f0026008ab18c96be5475f68252b509cce",
        "files": [
          "backend/open_webui/main.py",
          "src/lib/components/admin/Settings/General.svelte",
          "src/lib/components/admin/Users/UserList.svelte",
          "src/lib/components/chat/Chat.svelte",
          "src/lib/components/chat/Settings/About.svelte",
          "src/lib/components/common/Banner.svelte"
        ],
        "message": "refac",
        "before_after_code_files": [
          "backend/open_webui/main.py||backend/open_webui/main.py",
          "src/lib/components/admin/Settings/General.svelte||src/lib/components/admin/Settings/General.svelte",
          "src/lib/components/admin/Users/UserList.svelte||src/lib/components/admin/Users/UserList.svelte",
          "src/lib/components/chat/Chat.svelte||src/lib/components/chat/Chat.svelte",
          "src/lib/components/chat/Settings/About.svelte||src/lib/components/chat/Settings/About.svelte",
          "src/lib/components/common/Banner.svelte||src/lib/components/common/Banner.svelte"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "backend/open_webui/main.py||backend/open_webui/main.py": [
          "File: backend/open_webui/main.py -> backend/open_webui/main.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1191:             {",
          "1192:                 \"default_models\": app.state.config.DEFAULT_MODELS,",
          "1193:                 \"default_prompt_suggestions\": app.state.config.DEFAULT_PROMPT_SUGGESTIONS,",
          "1194:                 \"code\": {",
          "1195:                     \"engine\": app.state.config.CODE_EXECUTION_ENGINE,",
          "1196:                 },",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1194:                 \"user_count\": user_count,",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "1214:                     \"api_key\": GOOGLE_DRIVE_API_KEY.value,",
          "1215:                 },",
          "1216:                 \"onedrive\": {\"client_id\": ONEDRIVE_CLIENT_ID.value},",
          "1218:                     {",
          "1220:                         \"active_entries\": app.state.USER_COUNT,",
          "1222:                     }",
          "1223:                     if user.role == \"admin\"",
          "1224:                     else {}",
          "",
          "[Removed Lines]",
          "1219:                         \"record_count\": user_count,",
          "1221:                         \"license_metadata\": app.state.LICENSE_METADATA,",
          "",
          "[Added Lines]",
          "1218:                 \"license_metadata\": app.state.LICENSE_METADATA,",
          "",
          "---------------"
        ],
        "src/lib/components/admin/Settings/General.svelte||src/lib/components/admin/Settings/General.svelte": [
          "File: src/lib/components/admin/Settings/General.svelte -> src/lib/components/admin/Settings/General.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <script lang=\"ts\">",
          "2:  import { getBackendConfig, getVersionUpdates, getWebhookUrl, updateWebhookUrl } from '$lib/apis';",
          "3:  import {",
          "4:   getAdminConfig,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2:  import DOMPurify from 'dompurify';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "220:         <div class=\"\">",
          "221:          {$i18n.t('License')}",
          "222:         </div>",
          "232:        </div>",
          "234:        <!-- <button",
          "",
          "[Removed Lines]",
          "223:         <a",
          "224:          class=\" text-xs text-gray-500 hover:underline\"",
          "225:          href=\"https://docs.openwebui.com/enterprise\"",
          "226:          target=\"_blank\"",
          "227:         >",
          "228:          {$i18n.t(",
          "229:           'Upgrade to a licensed plan for enhanced capabilities, including custom theming and branding, and dedicated support.'",
          "230:          )}",
          "231:         </a>",
          "",
          "[Added Lines]",
          "226:         {#if $config?.license_metadata}",
          "227:          <a",
          "228:           href=\"https://docs.openwebui.com/enterprise\"",
          "229:           target=\"_blank\"",
          "230:           class=\"text-gray-500 mt-0.5\"",
          "231:          >",
          "232:           <span class=\" capitalize text-black dark:text-white\"",
          "233:            >{$config?.license_metadata?.type}",
          "234:            license</span",
          "235:           >",
          "236:           registered to",
          "237:           <span class=\" capitalize text-black dark:text-white\"",
          "238:            >{$config?.license_metadata?.organization_name}</span",
          "239:           >",
          "240:           for",
          "241:           <span class=\" font-medium text-black dark:text-white\"",
          "242:            >{$config?.license_metadata?.seats ?? 'Unlimited'} users.</span",
          "243:           >",
          "244:          </a>",
          "245:          {#if $config?.license_metadata?.html}",
          "246:           <div class=\"mt-0.5\">",
          "247:            {@html DOMPurify.sanitize($config?.license_metadata?.html)}",
          "248:           </div>",
          "249:          {/if}",
          "250:         {:else}",
          "251:          <a",
          "252:           class=\" text-xs hover:underline\"",
          "253:           href=\"https://docs.openwebui.com/enterprise\"",
          "254:           target=\"_blank\"",
          "255:          >",
          "256:           <span class=\"text-gray-500\">",
          "257:            {$i18n.t(",
          "258:             'Upgrade to a licensed plan for enhanced capabilities, including custom theming and branding, and dedicated support.'",
          "259:            )}",
          "260:           </span>",
          "261:          </a>",
          "262:         {/if}",
          "",
          "---------------"
        ],
        "src/lib/components/admin/Users/UserList.svelte||src/lib/components/admin/Users/UserList.svelte": [
          "File: src/lib/components/admin/Users/UserList.svelte -> src/lib/components/admin/Users/UserList.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:  import ChevronUp from '$lib/components/icons/ChevronUp.svelte';",
          "29:  import ChevronDown from '$lib/components/icons/ChevronDown.svelte';",
          "30:  import About from '$lib/components/chat/Settings/About.svelte';",
          "32:  const i18n = getContext('i18n');",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "31:  import Banner from '$lib/components/common/Banner.svelte';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "124: />",
          "125: <UserChatsModal bind:show={showUserChatsModal} user={selectedUser} />",
          "127: <div class=\"mt-0.5 mb-2 gap-1 flex flex-col md:flex-row justify-between\">",
          "128:  <div class=\"flex md:self-center text-lg font-medium px-0.5\">",
          "130:   <div class=\"flex self-center w-[1px] h-6 mx-2.5 bg-gray-50 dark:bg-gray-850\" />",
          "133:  </div>",
          "135:  <div class=\"flex gap-1\">",
          "",
          "[Removed Lines]",
          "129:   {$i18n.t('Users')}",
          "132:   <span class=\"text-lg font-medium text-gray-500 dark:text-gray-300\">{users.length}</span>",
          "",
          "[Added Lines]",
          "128: {#if ($config?.license_metadata?.seats ?? null) !== null && users.length > $config?.license_metadata?.seats}",
          "129:  <div class=\" mt-1 mb-2 text-xs text-red-500\">",
          "130:   <Banner",
          "131:    className=\"mx-0\"",
          "132:    banner={{",
          "133:     type: 'error',",
          "134:     title: 'License Error',",
          "135:     content:",
          "136:      'Exceeded the number of seats in your license. Please contact support to increase the number of seats.',",
          "137:     dismissable: true",
          "138:    }}",
          "139:   />",
          "140:  </div>",
          "141: {/if}",
          "145:   <div class=\"flex-shrink-0\">",
          "146:    {$i18n.t('Users')}",
          "147:   </div>",
          "150:   {#if ($config?.license_metadata?.seats ?? null) !== null}",
          "151:    {#if users.length > $config?.license_metadata?.seats}",
          "152:     <span class=\"text-lg font-medium text-red-500\"",
          "153:      >{users.length} of {$config?.license_metadata?.seats}",
          "154:      <span class=\"text-sm font-normal\">available users</span></span",
          "155:     >",
          "156:    {:else}",
          "157:     <span class=\"text-lg font-medium text-gray-500 dark:text-gray-300\"",
          "158:      >{users.length} of {$config?.license_metadata?.seats}",
          "159:      <span class=\"text-sm font-normal\">available users</span></span",
          "160:     >",
          "161:    {/if}",
          "162:   {:else}",
          "163:    <span class=\"text-lg font-medium text-gray-500 dark:text-gray-300\">{users.length}</span>",
          "164:   {/if}",
          "",
          "---------------"
        ],
        "src/lib/components/chat/Chat.svelte||src/lib/components/chat/Chat.svelte": [
          "File: src/lib/components/chat/Chat.svelte -> src/lib/components/chat/Chat.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "1940:     {#if $banners.length > 0 && !history.currentId && !$chatId && selectedModels.length <= 1}",
          "1941:      <div class=\"absolute top-12 left-0 right-0 w-full z-30\">",
          "1942:       <div class=\" flex flex-col gap-1 w-full\">",
          "1943:        {#each $banners.filter( (b) => (b.dismissible ? !JSON.parse(localStorage.getItem('dismissedBannerIds') ?? '[]').includes(b.id) : true) ) as banner}",
          "1944:         <Banner",
          "1945:          {banner}",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1943:        {#if ($config?.license_metadata?.seats ?? null) !== null && $config?.user_count > $config?.license_metadata?.seats}",
          "1944:         <Banner",
          "1945:          banner={{",
          "1946:           type: 'error',",
          "1947:           title: 'License Error',",
          "1948:           content: $i18n.t(",
          "1949:            'Exceeded the number of seats in your license. Please contact support to increase the number of seats.'",
          "1950:           )",
          "1951:          }}",
          "1952:         />",
          "1953:        {/if}",
          "",
          "---------------"
        ],
        "src/lib/components/chat/Settings/About.svelte||src/lib/components/chat/Settings/About.svelte": [
          "File: src/lib/components/chat/Settings/About.svelte -> src/lib/components/chat/Settings/About.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "136:   </div>",
          "138:   <div>",
          "139:    <pre",
          "140:     class=\"text-xs text-gray-400 dark:text-gray-500\">Copyright (c) {new Date().getFullYear()} <a",
          "141:      href=\"https://openwebui.com\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "139:    {#if $config?.license_metadata}",
          "140:     <div class=\"mb-2 text-xs\">",
          "141:      {#if !$WEBUI_NAME.includes('Open WebUI')}",
          "142:       <span class=\" text-gray-500 dark:text-gray-300 font-medium\">{$WEBUI_NAME}</span> -",
          "143:      {/if}",
          "145:      <span class=\" capitalize\">{$config?.license_metadata?.type}</span> license purchased by",
          "146:      <span class=\" capitalize\">{$config?.license_metadata?.organization_name}</span>",
          "147:     </div>",
          "148:    {/if}",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "172:   </div>",
          "174:   <div class=\"mt-2 text-xs text-gray-400 dark:text-gray-500\">",
          "178:    {$i18n.t('Created by')}",
          "179:    <a",
          "180:     class=\" text-gray-500 dark:text-gray-300 font-medium\"",
          "",
          "[Removed Lines]",
          "175:    {#if !$WEBUI_NAME.includes('Open WebUI')}",
          "176:     <span class=\" text-gray-500 dark:text-gray-300 font-medium\">{$WEBUI_NAME}</span> -",
          "177:    {/if}",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/lib/components/common/Banner.svelte||src/lib/components/common/Banner.svelte": [
          "File: src/lib/components/common/Banner.svelte -> src/lib/components/common/Banner.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "16:   dismissable: true,",
          "17:   timestamp: Math.floor(Date.now() / 1000)",
          "18:  };",
          "20:  export let dismissed = false;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "19:  export let className = 'mx-4';",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "41: {#if !dismissed}",
          "42:  {#if mounted}",
          "43:   <div",
          "45:    transition:fade={{ delay: 100, duration: 300 }}",
          "46:   >",
          "47:    <div class=\" flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5\">",
          "",
          "[Removed Lines]",
          "44:    class=\" top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-100 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30\"",
          "",
          "[Added Lines]",
          "45:    class=\"{className} top-0 left-0 right-0 p-2 px-3 flex justify-center items-center relative rounded-xl border border-gray-100 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30\"",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "69dee19568dfd037a46f8f3b176a827a466577c4",
      "candidate_info": {
        "commit_hash": "69dee19568dfd037a46f8f3b176a827a466577c4",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/69dee19568dfd037a46f8f3b176a827a466577c4",
        "files": [
          "src/lib/components/AddConnectionModal.svelte",
          "src/lib/components/AddServerModal.svelte"
        ],
        "message": "refac",
        "before_after_code_files": [
          "src/lib/components/AddConnectionModal.svelte||src/lib/components/AddConnectionModal.svelte",
          "src/lib/components/AddServerModal.svelte||src/lib/components/AddServerModal.svelte"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/lib/components/AddConnectionModal.svelte||src/lib/components/AddConnectionModal.svelte": [
          "File: src/lib/components/AddConnectionModal.svelte -> src/lib/components/AddConnectionModal.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "85:    return;",
          "86:   }",
          "88:   const connection = {",
          "89:    url,",
          "90:    key,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "89:   url = url.replace(/\\/$/, '');",
          "",
          "---------------"
        ],
        "src/lib/components/AddServerModal.svelte||src/lib/components/AddServerModal.svelte": [
          "File: src/lib/components/AddServerModal.svelte -> src/lib/components/AddServerModal.svelte",
          "--- Hunk 1 ---",
          "[Context before]",
          "33:  const submitHandler = async () => {",
          "34:   loading = true;",
          "36:   const connection = {",
          "37:    url,",
          "38:    key,",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "37:   url = url.replace(/\\/$/, '');",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c714bd87390d12812ef1fea3d387bbfb70cda57d",
      "candidate_info": {
        "commit_hash": "c714bd87390d12812ef1fea3d387bbfb70cda57d",
        "repo": "open-webui/open-webui",
        "commit_url": "https://github.com/open-webui/open-webui/commit/c714bd87390d12812ef1fea3d387bbfb70cda57d",
        "files": [
          "backend/open_webui/utils/middleware.py"
        ],
        "message": "refac",
        "before_after_code_files": [
          "backend/open_webui/utils/middleware.py||backend/open_webui/utils/middleware.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_message": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "backend/open_webui/utils/middleware.py||backend/open_webui/utils/middleware.py": [
          "File: backend/open_webui/utils/middleware.py -> backend/open_webui/utils/middleware.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "1079:         for filter_id in get_sorted_filter_ids(model)",
          "1080:     ]",
          "1084:     # Streaming response",
          "1085:     if event_emitter and event_caller:",
          "1086:         task_id = str(uuid4())  # Create a unique task ID.",
          "",
          "[Removed Lines]",
          "1082:     print(f\"{filter_functions=}\")",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ]
      }
    }
  ]
}