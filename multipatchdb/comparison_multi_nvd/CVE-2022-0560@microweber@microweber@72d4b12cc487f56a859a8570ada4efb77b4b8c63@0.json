{
  "cve_id": "CVE-2022-0560",
  "cve_desc": "Open Redirect in Packagist microweber/microweber prior to 1.2.11.",
  "repo": "microweber/microweber",
  "patch_hash": "72d4b12cc487f56a859a8570ada4efb77b4b8c63",
  "patch_info": {
    "commit_hash": "72d4b12cc487f56a859a8570ada4efb77b4b8c63",
    "repo": "microweber/microweber",
    "commit_url": "https://github.com/microweber/microweber/commit/72d4b12cc487f56a859a8570ada4efb77b4b8c63",
    "files": [
      "src/MicroweberPackages/Page/routes/web.php",
      "tests/Browser/AdminXssTest.php"
    ],
    "message": "update",
    "before_after_code_files": [
      "src/MicroweberPackages/Page/routes/web.php||src/MicroweberPackages/Page/routes/web.php",
      "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
    ]
  },
  "patch_diff": {
    "src/MicroweberPackages/Page/routes/web.php||src/MicroweberPackages/Page/routes/web.php": [
      "File: src/MicroweberPackages/Page/routes/web.php -> src/MicroweberPackages/Page/routes/web.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "11:     ->middleware(['admin'])",
      "12:     ->namespace('\\MicroweberPackages\\Page\\Http\\Controllers\\Admin')",
      "13:     ->group(function () {",
      "15:     });",
      "",
      "[Removed Lines]",
      "14:         Route::resource('page', 'PageController');",
      "",
      "[Added Lines]",
      "14:         Route::resource('page', 'PageController', ['except' => ['show']]);",
      "",
      "---------------"
    ],
    "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php": [
      "File: tests/Browser/AdminXssTest.php -> tests/Browser/AdminXssTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "33:                         $browser->validate();",
      "34:                     });",
      "37:                 }",
      "38:             }",
      "",
      "[Removed Lines]",
      "36:                     $browser->pause(2000);",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "1adcbfe761923dbba57bd1f84e054d3d106ad992",
      "candidate_info": {
        "commit_hash": "1adcbfe761923dbba57bd1f84e054d3d106ad992",
        "repo": "microweber/microweber",
        "commit_url": "https://github.com/microweber/microweber/commit/1adcbfe761923dbba57bd1f84e054d3d106ad992",
        "files": [
          "tests/Browser/AdminXssTest.php"
        ],
        "message": "Update AdminXssTest.php",
        "before_after_code_files": [
          "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
          ],
          "candidate": [
            "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
          ]
        }
      },
      "candidate_diff": {
        "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php": [
          "File: tests/Browser/AdminXssTest.php -> tests/Browser/AdminXssTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "84:                     }",
          "86:                     $browser->visit($visitPage);",
          "89:                     $browser->within(new ChekForJavascriptErrors(), function ($browser) {",
          "90:                         $browser->validate();",
          "91:                     });",
          "94:                 }",
          "95:             }",
          "",
          "[Removed Lines]",
          "87:                     $browser->assertStatus(200);",
          "93:                     $browser->pause(1000);",
          "",
          "[Added Lines]",
          "92:                     $browser->assertDontSee('There is some error');",
          "93:                     $browser->pause(700);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "77b21da99339fa0b548f5391279e6280f896ac96",
      "candidate_info": {
        "commit_hash": "77b21da99339fa0b548f5391279e6280f896ac96",
        "repo": "microweber/microweber",
        "commit_url": "https://github.com/microweber/microweber/commit/77b21da99339fa0b548f5391279e6280f896ac96",
        "files": [
          "tests/Browser/AdminXssTest.php"
        ],
        "message": "Update AdminXssTest.php",
        "before_after_code_files": [
          "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
          ],
          "candidate": [
            "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
          ]
        }
      },
      "candidate_diff": {
        "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php": [
          "File: tests/Browser/AdminXssTest.php -> tests/Browser/AdminXssTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "35:                         $browser->validate();",
          "36:                     });",
          "39:                 }",
          "40:             }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "38:                     $browser->pause(1000);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "4d1ff933c817c6a6cc5528fc904bf1d816ad80f3",
      "candidate_info": {
        "commit_hash": "4d1ff933c817c6a6cc5528fc904bf1d816ad80f3",
        "repo": "microweber/microweber",
        "commit_url": "https://github.com/microweber/microweber/commit/4d1ff933c817c6a6cc5528fc904bf1d816ad80f3",
        "files": [
          "tests/Browser/AdminXssTest.php"
        ],
        "message": "Update AdminXssTest.php",
        "before_after_code_files": [
          "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
          ],
          "candidate": [
            "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
          ]
        }
      },
      "candidate_diff": {
        "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php": [
          "File: tests/Browser/AdminXssTest.php -> tests/Browser/AdminXssTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "21:                 $browser->fillForm();",
          "22:             });",
          "25:             $routeCollection = Route::getRoutes();",
          "26:             foreach ($routeCollection as $value) {",
          "29:                 }",
          "39:         });",
          "",
          "[Removed Lines]",
          "24:             $adminUrls = [];",
          "27:                 if (strpos($value->uri(), 'admin') !== false) {",
          "28:                     $adminUrls[] = $value->uri();",
          "30:             }",
          "32:             dd($adminUrls);",
          "34:             $browser->within(new ChekForJavascriptErrors(), function ($browser) {",
          "35:                 $browser->validate();",
          "36:             });",
          "",
          "[Added Lines]",
          "26:                 if ($value->getActionMethod() == 'GET') {",
          "27:                     continue;",
          "29:                 if (strpos($value->uri(), 'admin') !== false) {",
          "30:                     $browser->visit($value->uri());",
          "32:                     $browser->within(new ChekForJavascriptErrors(), function ($browser) {",
          "33:                         $browser->validate();",
          "34:                     });",
          "36:                     $browser->pause(2000);",
          "37:                 }",
          "38:             }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "f3ec5485c00e973be1ab0b70d9171754e9994a29",
      "candidate_info": {
        "commit_hash": "f3ec5485c00e973be1ab0b70d9171754e9994a29",
        "repo": "microweber/microweber",
        "commit_url": "https://github.com/microweber/microweber/commit/f3ec5485c00e973be1ab0b70d9171754e9994a29",
        "files": [
          "tests/Browser/AdminXssTest.php",
          "userfiles/modules/tags/manage_tagging_tagged.php"
        ],
        "message": "update",
        "before_after_code_files": [
          "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php",
          "userfiles/modules/tags/manage_tagging_tagged.php||userfiles/modules/tags/manage_tagging_tagged.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
          ],
          "candidate": [
            "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php"
          ]
        }
      },
      "candidate_diff": {
        "tests/Browser/AdminXssTest.php||tests/Browser/AdminXssTest.php": [
          "File: tests/Browser/AdminXssTest.php -> tests/Browser/AdminXssTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "3: namespace Tests\\Browser;",
          "6: use Laravel\\Dusk\\Browser;",
          "7: use Tests\\Browser\\Components\\AdminLogin;",
          "8: use Tests\\Browser\\Components\\ChekForJavascriptErrors;",
          "10: class AdminXssTest extends DuskTestCase",
          "11: {",
          "13:     public function testPages()",
          "14:     {",
          "15:         \\MicroweberPackages\\Multilanguage\\MultilanguageHelpers::setMultilanguageEnabled(false);",
          "17:         $this->browse(function (Browser $browser) {",
          "19:             $browser->within(new AdminLogin(), function ($browser) {",
          "20:                 $browser->fillForm();",
          "21:             });",
          "24:             $browser->within(new ChekForJavascriptErrors(), function ($browser) {",
          "25:                 $browser->validate();",
          "26:             });",
          "32:         });",
          "34:     }",
          "35: }",
          "",
          "---------------"
        ],
        "userfiles/modules/tags/manage_tagging_tagged.php||userfiles/modules/tags/manage_tagging_tagged.php": [
          "File: userfiles/modules/tags/manage_tagging_tagged.php -> userfiles/modules/tags/manage_tagging_tagged.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "180:         var tags = '';",
          "181:         var keyword = $('.js-search-tags-keyword').val();",
          "183:         $('.js-all-tags').html('Searching for: ' + keyword);",
          "185:         $.get(mw.settings.api_url + 'tagging_tag/get', {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "183:         keyword = String(keyword).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "212:         var keyword = $('.js-search-posts-keyword').val();",
          "213:         var filter = $('.js-posts-filter-by').val();",
          "215:         $('.js-select-posts').html('Searching for: ' + keyword);",
          "217:         var content_type = '[neq]page';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "217:         keyword = String(keyword).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');",
          "",
          "---------------"
        ]
      }
    }
  ]
}