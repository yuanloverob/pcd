{
  "cve_id": "CVE-2023-23082",
  "cve_desc": "A heap buffer overflow vulnerability in Kodi Home Theater Software up to 19.5 allows attackers to cause a denial of service due to an improper length of the value passed to the offset argument.",
  "repo": "xbmc/xbmc",
  "patch_hash": "00fec1dbdd1df827872c7b55ad93059636dfc076",
  "patch_info": {
    "commit_hash": "00fec1dbdd1df827872c7b55ad93059636dfc076",
    "repo": "xbmc/xbmc",
    "commit_url": "https://github.com/xbmc/xbmc/pull/22380/commits/00fec1dbdd1df827872c7b55ad93059636dfc076",
    "files": [
      "xbmc/pictures/ExifParse.cpp"
    ],
    "message": "ExifParse: Don't run outside exif information\n\nWhen parsing exif information the number of entries could be tainted. Make\nsure to not run behind the exif data by properly checking out of bounds.\n\nUpstream? fix: https://android.googlesource.com/platform/external/jhead/+/34a2564d3268a5ca1472c5076675782fbaf724d6",
    "before_after_code_files": [
      "xbmc/pictures/ExifParse.cpp||xbmc/pictures/ExifParse.cpp"
    ]
  },
  "patch_diff": {
    "xbmc/pictures/ExifParse.cpp||xbmc/pictures/ExifParse.cpp": [
      "File: xbmc/pictures/ExifParse.cpp -> xbmc/pictures/ExifParse.cpp",
      "--- Hunk 1 ---",
      "[Context before]",
      "878:   {",
      "879:     const unsigned char* DirEntry = DIR_ENTRY_ADDR(DirStart, de);",
      "881:     unsigned Tag        = Get16(DirEntry, m_MotorolaOrder);",
      "882:     unsigned Format     = Get16(DirEntry+2, m_MotorolaOrder);",
      "883:     unsigned Components = (unsigned)Get32(DirEntry+4, m_MotorolaOrder);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "882:     if (DirEntry + 12 > OffsetBase + ExifLength)",
      "883:     {",
      "884:       ErrNonfatal(\"GPS info directory goes past end of exif\", 0, 0);",
      "885:       return;",
      "886:     }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8021cb728b789fe59b57722e0fdf699808194e50",
      "candidate_info": {
        "commit_hash": "8021cb728b789fe59b57722e0fdf699808194e50",
        "repo": "xbmc/xbmc",
        "commit_url": "https://github.com/xbmc/xbmc/commit/8021cb728b789fe59b57722e0fdf699808194e50",
        "files": [
          "xbmc/pictures/ExifParse.cpp"
        ],
        "message": "ExifParse: Don't run outside exif information\n\nWhen parsing exif information the number of entries could be tainted. Make\nsure to not run behind the exif data by properly checking out of bounds.\n\nUpstream? fix: https://android.googlesource.com/platform/external/jhead/+/34a2564d3268a5ca1472c5076675782fbaf724d6",
        "before_after_code_files": [
          "xbmc/pictures/ExifParse.cpp||xbmc/pictures/ExifParse.cpp"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "xbmc/pictures/ExifParse.cpp||xbmc/pictures/ExifParse.cpp"
          ],
          "candidate": [
            "xbmc/pictures/ExifParse.cpp||xbmc/pictures/ExifParse.cpp"
          ]
        }
      },
      "candidate_diff": {
        "xbmc/pictures/ExifParse.cpp||xbmc/pictures/ExifParse.cpp": [
          "File: xbmc/pictures/ExifParse.cpp -> xbmc/pictures/ExifParse.cpp",
          "--- Hunk 1 ---",
          "[Context before]",
          "878:   {",
          "879:     const unsigned char* DirEntry = DIR_ENTRY_ADDR(DirStart, de);",
          "881:     unsigned Tag        = Get16(DirEntry, m_MotorolaOrder);",
          "882:     unsigned Format     = Get16(DirEntry+2, m_MotorolaOrder);",
          "883:     unsigned Components = (unsigned)Get32(DirEntry+4, m_MotorolaOrder);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "882:     if (DirEntry + 12 > OffsetBase + ExifLength)",
          "883:     {",
          "884:       ErrNonfatal(\"GPS info directory goes past end of exif\", 0, 0);",
          "885:       return;",
          "886:     }",
          "",
          "---------------"
        ]
      }
    }
  ]
}