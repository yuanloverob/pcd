{
  "cve_id": "CVE-2011-4293",
  "cve_desc": "The theme implementation in Moodle 2.0.x before 2.0.4 and 2.1.x before 2.1.1 triggers duplicate caching of Cascading Style Sheets (CSS) and JavaScript content, which allows remote attackers to bypass intended access restrictions and write to an operating-system temporary directory via unspecified vectors.",
  "repo": "moodle/moodle",
  "patch_hash": "e1c2a211f259821910be2cba23679d4176fb00a3",
  "patch_info": {
    "commit_hash": "e1c2a211f259821910be2cba23679d4176fb00a3",
    "repo": "moodle/moodle",
    "commit_url": "https://github.com/moodle/moodle/commit/e1c2a211f259821910be2cba23679d4176fb00a3",
    "files": [
      "theme/javascript.php",
      "theme/styles.php"
    ],
    "message": "MDL-28147 do not double cache theme css/js",
    "before_after_code_files": [
      "theme/javascript.php||theme/javascript.php",
      "theme/styles.php||theme/styles.php"
    ]
  },
  "patch_diff": {
    "theme/javascript.php||theme/javascript.php": [
      "File: theme/javascript.php -> theme/javascript.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "118: }",
      "120: function minify($files) {",
      "123:     if (0 === stripos(PHP_OS, 'win')) {",
      "124:         Minify::setDocRoot(); // IIS may need help",
      "125:     }",
      "128:     $options = array(",
      "129:         'bubbleCssImports' => false,",
      "",
      "[Removed Lines]",
      "121:     global $CFG;",
      "126:     Minify::setCache('', true);",
      "",
      "[Added Lines]",
      "125:     Minify::setCache(null, false);",
      "",
      "---------------"
    ],
    "theme/styles.php||theme/styles.php": [
      "File: theme/styles.php -> theme/styles.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "160:     if (0 === stripos(PHP_OS, 'win')) {",
      "161:         Minify::setDocRoot(); // IIS may need help",
      "162:     }",
      "165:     $options = array(",
      "166:         'bubbleCssImports' => false,",
      "",
      "[Removed Lines]",
      "163:     Minify::setCache('', true);",
      "",
      "[Added Lines]",
      "164:     Minify::setCache(null, false);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "05f4555422278190ec24a88466ac43c914a7e5d6",
      "candidate_info": {
        "commit_hash": "05f4555422278190ec24a88466ac43c914a7e5d6",
        "repo": "moodle/moodle",
        "commit_url": "https://github.com/moodle/moodle/commit/05f4555422278190ec24a88466ac43c914a7e5d6",
        "files": [
          "theme/javascript.php",
          "theme/styles.php"
        ],
        "message": "MDL-28147 do not double cache theme css/js",
        "before_after_code_files": [
          "theme/javascript.php||theme/javascript.php",
          "theme/styles.php||theme/styles.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "theme/javascript.php||theme/javascript.php",
            "theme/styles.php||theme/styles.php"
          ],
          "candidate": [
            "theme/javascript.php||theme/javascript.php",
            "theme/styles.php||theme/styles.php"
          ]
        }
      },
      "candidate_diff": {
        "theme/javascript.php||theme/javascript.php": [
          "File: theme/javascript.php -> theme/javascript.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "118: }",
          "120: function minify($files) {",
          "123:     if (0 === stripos(PHP_OS, 'win')) {",
          "124:         Minify::setDocRoot(); // IIS may need help",
          "125:     }",
          "128:     $options = array(",
          "129:         'bubbleCssImports' => false,",
          "",
          "[Removed Lines]",
          "121:     global $CFG;",
          "126:     Minify::setCache('', true);",
          "",
          "[Added Lines]",
          "125:     Minify::setCache(null, false);",
          "",
          "---------------"
        ],
        "theme/styles.php||theme/styles.php": [
          "File: theme/styles.php -> theme/styles.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "160:     if (0 === stripos(PHP_OS, 'win')) {",
          "161:         Minify::setDocRoot(); // IIS may need help",
          "162:     }",
          "165:     $options = array(",
          "166:         'bubbleCssImports' => false,",
          "",
          "[Removed Lines]",
          "163:     Minify::setCache('', true);",
          "",
          "[Added Lines]",
          "164:     Minify::setCache(null, false);",
          "",
          "---------------"
        ]
      }
    }
  ]
}