{
  "cve_id": "CVE-2023-27480",
  "cve_desc": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions any user with edit rights on a document can trigger an XAR import on a forged XAR file, leading to the ability to display the content of any file on the XWiki server host. This vulnerability has been patched in XWiki 13.10.11, 14.4.7 and 14.10-rc-1. Users are advised to upgrade. Users unable to upgrade may apply the patch `e3527b98fd` manually.",
  "repo": "xwiki/xwiki-platform",
  "patch_hash": "e3527b98fdd8dc8179c24dc55e662b2c55199434",
  "patch_info": {
    "commit_hash": "e3527b98fdd8dc8179c24dc55e662b2c55199434",
    "repo": "xwiki/xwiki-platform",
    "commit_url": "https://github.com/xwiki/xwiki-platform/commit/e3527b98fdd8dc8179c24dc55e662b2c55199434",
    "files": [
      "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
    ],
    "message": "XWIKI-20320: Disallow DOCTYPE in the XAR descriptor",
    "before_after_code_files": [
      "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
    ]
  },
  "patch_diff": {
    "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java": [
      "File: xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java -> xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java",
      "--- Hunk 1 ---",
      "[Context before]",
      "516:         DocumentBuilder dBuilder;",
      "517:         try {",
      "518:             dBuilder = dbFactory.newDocumentBuilder();",
      "519:         } catch (ParserConfigurationException e) {",
      "520:             throw new XarException(\"Failed to create a new Document builder\", e);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "519:             dbFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "fd863465f94826d46871ac6558078c3a60979914",
      "candidate_info": {
        "commit_hash": "fd863465f94826d46871ac6558078c3a60979914",
        "repo": "xwiki/xwiki-platform",
        "commit_url": "https://github.com/xwiki/xwiki-platform/commit/fd863465f94826d46871ac6558078c3a60979914",
        "files": [
          "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
        ],
        "message": "XWIKI-20320: Disallow DOCTYPE in the XAR descriptor",
        "before_after_code_files": [
          "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
          ],
          "candidate": [
            "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
          ]
        }
      },
      "candidate_diff": {
        "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java": [
          "File: xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java -> xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "516:         DocumentBuilder dBuilder;",
          "517:         try {",
          "518:             dBuilder = dbFactory.newDocumentBuilder();",
          "519:         } catch (ParserConfigurationException e) {",
          "520:             throw new XarException(\"Failed to create a new Document builder\", e);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "519:             dbFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "61081ec17eb093bab1cec517dcb16f83a020f403",
      "candidate_info": {
        "commit_hash": "61081ec17eb093bab1cec517dcb16f83a020f403",
        "repo": "xwiki/xwiki-platform",
        "commit_url": "https://github.com/xwiki/xwiki-platform/commit/61081ec17eb093bab1cec517dcb16f83a020f403",
        "files": [
          "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
        ],
        "message": "XWIKI-20320: Disallow DOCTYPE in the XAR descriptor",
        "before_after_code_files": [
          "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
          ],
          "candidate": [
            "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
          ]
        }
      },
      "candidate_diff": {
        "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java": [
          "File: xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java -> xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "516:         DocumentBuilder dBuilder;",
          "517:         try {",
          "518:             dBuilder = dbFactory.newDocumentBuilder();",
          "519:         } catch (ParserConfigurationException e) {",
          "520:             throw new XarException(\"Failed to create a new Document builder\", e);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "519:             dbFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "e3527b98fdd8dc8179c24dc55e662b2c55199434",
      "candidate_info": {
        "commit_hash": "e3527b98fdd8dc8179c24dc55e662b2c55199434",
        "repo": "xwiki/xwiki-platform",
        "commit_url": "https://github.com/xwiki/xwiki-platform/commit/e3527b98fdd8dc8179c24dc55e662b2c55199434",
        "files": [
          "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
        ],
        "message": "XWIKI-20320: Disallow DOCTYPE in the XAR descriptor",
        "before_after_code_files": [
          "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
          ],
          "candidate": [
            "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java"
          ]
        }
      },
      "candidate_diff": {
        "xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java||xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java": [
          "File: xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java -> xwiki-platform-core/xwiki-platform-xar/xwiki-platform-xar-model/src/main/java/org/xwiki/xar/XarPackage.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "516:         DocumentBuilder dBuilder;",
          "517:         try {",
          "518:             dBuilder = dbFactory.newDocumentBuilder();",
          "519:         } catch (ParserConfigurationException e) {",
          "520:             throw new XarException(\"Failed to create a new Document builder\", e);",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "519:             dbFactory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);",
          "",
          "---------------"
        ]
      }
    }
  ]
}