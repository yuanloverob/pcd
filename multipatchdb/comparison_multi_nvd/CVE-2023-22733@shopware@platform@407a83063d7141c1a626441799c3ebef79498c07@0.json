{
  "cve_id": "CVE-2023-22733",
  "cve_desc": "Shopware is an open source commerce platform based on Symfony Framework and Vue js. In affected versions the log module would write out all kind of sent mails. An attacker with access to either the local system logs or a centralized logging store may have access to other users accounts. This issue has been addressed in version 6.4.18.1. For older versions of 6.1, 6.2, and 6.3, corresponding security measures are also available via a plugin. For the full range of functions, we recommend updating to the latest Shopware version. Users unable to upgrade may remove from all users the log module ACL rights or disable logging.",
  "repo": "shopware/platform",
  "patch_hash": "407a83063d7141c1a626441799c3ebef79498c07",
  "patch_info": {
    "commit_hash": "407a83063d7141c1a626441799c3ebef79498c07",
    "repo": "shopware/platform",
    "commit_url": "https://github.com/shopware/platform/commit/407a83063d7141c1a626441799c3ebef79498c07",
    "files": [
      "src/Core/Content/Flow/Dispatching/Action/SendMailAction.php"
    ],
    "message": "NEXT-24679 - Fix hiding reset password of mail in log",
    "before_after_code_files": [
      "src/Core/Content/Flow/Dispatching/Action/SendMailAction.php||src/Core/Content/Flow/Dispatching/Action/SendMailAction.php"
    ]
  },
  "patch_diff": {
    "src/Core/Content/Flow/Dispatching/Action/SendMailAction.php||src/Core/Content/Flow/Dispatching/Action/SendMailAction.php": [
      "File: src/Core/Content/Flow/Dispatching/Action/SendMailAction.php -> src/Core/Content/Flow/Dispatching/Action/SendMailAction.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "239:             );",
      "240:         }",
      "243:     }",
      "",
      "[Removed Lines]",
      "242:         $this->send($data, $event->getContext(), $this->getTemplateData($mailEvent), $attachments, $extension, $injectedTranslator);",
      "",
      "[Added Lines]",
      "242:         $templateData = array_merge([",
      "243:             'eventName' => $mailEvent->getName(),",
      "244:         ], $this->getTemplateData($mailEvent));",
      "246:         $this->send($data, $event->getContext(), $templateData, $attachments, $extension, $injectedTranslator);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "169fe4099ddb5a9bdbc21e01f5a02c63b712aa14",
      "candidate_info": {
        "commit_hash": "169fe4099ddb5a9bdbc21e01f5a02c63b712aa14",
        "repo": "shopware/platform",
        "commit_url": "https://github.com/shopware/platform/commit/169fe4099ddb5a9bdbc21e01f5a02c63b712aa14",
        "files": [
          "src/Core/Content/Flow/Dispatching/Action/SendMailAction.php"
        ],
        "message": "NEXT-24688 - Remove superfluous argument",
        "before_after_code_files": [
          "src/Core/Content/Flow/Dispatching/Action/SendMailAction.php||src/Core/Content/Flow/Dispatching/Action/SendMailAction.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/Core/Content/Flow/Dispatching/Action/SendMailAction.php||src/Core/Content/Flow/Dispatching/Action/SendMailAction.php"
          ],
          "candidate": [
            "src/Core/Content/Flow/Dispatching/Action/SendMailAction.php||src/Core/Content/Flow/Dispatching/Action/SendMailAction.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Core/Content/Flow/Dispatching/Action/SendMailAction.php||src/Core/Content/Flow/Dispatching/Action/SendMailAction.php": [
          "File: src/Core/Content/Flow/Dispatching/Action/SendMailAction.php -> src/Core/Content/Flow/Dispatching/Action/SendMailAction.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "214:             'eventName' => $mailEvent->getName(),",
          "215:         ], $this->getTemplateData($mailEvent));",
          "218:     }",
          "",
          "[Removed Lines]",
          "217:         $this->send($data, $event->getContext(), $templateData, $attachments, $extension, $injectedTranslator);",
          "",
          "[Added Lines]",
          "217:         $this->send($data, $event->getContext(), $templateData, $extension, $injectedTranslator);",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "302:             'eventName' => $flow->getName(),",
          "303:         ], $flow->data());",
          "306:     }",
          "",
          "[Removed Lines]",
          "305:         $this->send($data, $flow->getContext(), $templateData, $attachments, $extension, $injectedTranslator);",
          "",
          "[Added Lines]",
          "305:         $this->send($data, $flow->getContext(), $templateData, $extension, $injectedTranslator);",
          "",
          "---------------"
        ]
      }
    }
  ]
}