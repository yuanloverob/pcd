{
  "cve_id": "CVE-2023-1879",
  "cve_desc": "Cross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.1.12.",
  "repo": "thorsten/phpmyfaq",
  "patch_hash": "0dc8e527c375007cd4b8dbf61f7167393a6f6e91",
  "patch_info": {
    "commit_hash": "0dc8e527c375007cd4b8dbf61f7167393a6f6e91",
    "repo": "thorsten/phpmyfaq",
    "commit_url": "https://github.com/thorsten/phpmyfaq/commit/0dc8e527c375007cd4b8dbf61f7167393a6f6e91",
    "files": [
      "phpmyfaq/admin/category.edit.php",
      "phpmyfaq/admin/category.main.php"
    ],
    "message": "fix: added missing conversion to HTML entities",
    "before_after_code_files": [
      "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php",
      "phpmyfaq/admin/category.main.php||phpmyfaq/admin/category.main.php"
    ]
  },
  "patch_diff": {
    "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php": [
      "File: phpmyfaq/admin/category.edit.php -> phpmyfaq/admin/category.edit.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "19: use phpMyFAQ\\Category\\CategoryPermission;",
      "20: use phpMyFAQ\\Filter;",
      "21: use phpMyFAQ\\Helper\\UserHelper;",
      "23: if (!defined('IS_VALID_PHPMYFAQ')) {",
      "24:     http_response_code(400);",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "22: use phpMyFAQ\\Strings;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "58:         $restrictedGroups = true;",
      "59:     }",
      "62:     ?>",
      "63:         <div class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\">",
      "64:           <h1 class=\"h2\">",
      "",
      "[Removed Lines]",
      "61:     $header = $PMF_LANG['ad_categ_edit_1'] . ' \"' . $categoryData->getName() . '\" ' . $PMF_LANG['ad_categ_edit_2'];",
      "",
      "[Added Lines]",
      "62:     $header = $PMF_LANG['ad_categ_edit_1'] . ' \"' . Strings::htmlentities($categoryData->getName()) .",
      "63:         '\" ' . $PMF_LANG['ad_categ_edit_2'];",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "81:                   <?= $PMF_LANG['ad_categ_titel'] ?>:",
      "82:               </label>",
      "83:               <div class=\"col-lg-4\">",
      "85:                        class=\"form-control\">",
      "86:               </div>",
      "87:             </div>",
      "",
      "[Removed Lines]",
      "84:                 <input type=\"text\" id=\"name\" name=\"name\" value=\"<?= $categoryData->getName() ?>\"",
      "",
      "[Added Lines]",
      "86:                 <input type=\"text\" id=\"name\" name=\"name\" value=\"<?= Strings::htmlentities($categoryData->getName()) ?>\"",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "92:               </label>",
      "93:               <div class=\"col-lg-4\">",
      "94:                 <textarea id=\"description\" name=\"description\" rows=\"3\"",
      "96:               </div>",
      "97:             </div>",
      "",
      "[Removed Lines]",
      "95:                           class=\"form-control\"><?= $categoryData->getDescription() ?></textarea>",
      "",
      "[Added Lines]",
      "97:                           class=\"form-control\"><?= Strings::htmlentities($categoryData->getDescription()) ?></textarea>",
      "",
      "---------------"
    ],
    "phpmyfaq/admin/category.main.php||phpmyfaq/admin/category.main.php": [
      "File: phpmyfaq/admin/category.main.php -> phpmyfaq/admin/category.main.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "156:                 $parentId = Filter::filterInput(INPUT_POST, 'parent_id', FILTER_VALIDATE_INT);",
      "157:                 $categoryId = Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);",
      "160:                 $image = count($uploadedFile) ? $categoryImage->getFileName(",
      "161:                     $categoryId,",
      "162:                     $categoryLang",
      "",
      "[Removed Lines]",
      "158:                 $categoryLang = Filter::filterInput(INPUT_POST, 'catlang', FILTER_UNSAFE_RAW);",
      "159:                 $existingImage = Filter::filterInput(INPUT_POST, 'existing_image', FILTER_UNSAFE_RAW);",
      "",
      "[Added Lines]",
      "158:                 $categoryLang = Filter::filterInput(INPUT_POST, 'catlang', FILTER_SANITIZE_SPECIAL_CHARS);",
      "159:                 $existingImage = Filter::filterInput(INPUT_POST, 'existing_image', FILTER_SANITIZE_SPECIAL_CHARS);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "8d4f5a21b4b0fbf3328995a2bd94477c26bd7cef",
      "candidate_info": {
        "commit_hash": "8d4f5a21b4b0fbf3328995a2bd94477c26bd7cef",
        "repo": "thorsten/phpmyfaq",
        "commit_url": "https://github.com/thorsten/phpmyfaq/commit/8d4f5a21b4b0fbf3328995a2bd94477c26bd7cef",
        "files": [
          "CHANGELOG.md",
          "Dockerfile",
          "phpmyfaq/admin/category.edit.php",
          "phpmyfaq/src/phpMyFAQ/News.php"
        ],
        "message": "Merge branch '3.2' into 'main'",
        "before_after_code_files": [
          "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php",
          "phpmyfaq/src/phpMyFAQ/News.php||phpmyfaq/src/phpMyFAQ/News.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ],
          "candidate": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ]
        }
      },
      "candidate_diff": {
        "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php": [
          "File: phpmyfaq/admin/category.edit.php -> phpmyfaq/admin/category.edit.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "130:                     <div class=\"input-group\">",
          "131:                       <input class=\"form-control\" type=\"file\" name=\"image\" id=\"pmf-category-image-upload\"",
          "132:                              value=\"<?= $categoryData->getImage() ?>\">",
          "134:                     </div>",
          "135:                       <div class=\"input-group mt-2\">",
          "136:                           <button type=\"button\" class=\"btn btn-info\" id=\"button-reset-category-image\">",
          "",
          "[Removed Lines]",
          "133:                       <span class=\"input-group-text\"><?= $categoryData->getImage() ?></span>",
          "",
          "[Added Lines]",
          "133:                       <span class=\"input-group-text\" id=\"pmf-category-image-label\"><?= $categoryData->getImage() ?></span>",
          "",
          "---------------"
        ],
        "phpmyfaq/src/phpMyFAQ/News.php||phpmyfaq/src/phpMyFAQ/News.php": [
          "File: phpmyfaq/src/phpMyFAQ/News.php -> phpmyfaq/src/phpMyFAQ/News.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "82:                 );",
          "83:             }",
          "86:         }",
          "88:         return ('' == $output) ? Translation::get('msgNoNews') : $output;",
          "",
          "[Removed Lines]",
          "85:             $output .= sprintf('<small class=\"text-muted\">%s</small>', $date->format($item['date']));",
          "",
          "[Added Lines]",
          "85:             $output .= sprintf('<small class=\"text-muted ms-1\">%s</small>', $date->format($item['date']));",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "afd926645a6ff6154c334864a2a8d45a348721c6",
      "candidate_info": {
        "commit_hash": "afd926645a6ff6154c334864a2a8d45a348721c6",
        "repo": "thorsten/phpmyfaq",
        "commit_url": "https://github.com/thorsten/phpmyfaq/commit/afd926645a6ff6154c334864a2a8d45a348721c6",
        "files": [
          "phpmyfaq/admin/category.edit.php"
        ],
        "message": "refactor: re-formatted file",
        "before_after_code_files": [
          "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ],
          "candidate": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ]
        }
      },
      "candidate_diff": {
        "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php": [
          "File: phpmyfaq/admin/category.edit.php -> phpmyfaq/admin/category.edit.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "61:         $restrictedGroups = true;",
          "62:     }",
          "66:     ?>",
          "69:             <i aria-hidden=\"true\" class=\"fa fa-folder\"></i> <?= $header ?>",
          "97:                 <textarea id=\"description\" name=\"description\" rows=\"3\"",
          "98:                           class=\"form-control\"><?= Strings::htmlentities($categoryData->getDescription()) ?></textarea>",
          "108:                 </div>",
          "118:                 </div>",
          "132:                     </div>",
          "224:         </div>",
          "225:     <?php",
          "226: } else {",
          "227:     echo Translation::get('err_NotAuth');",
          "",
          "[Removed Lines]",
          "64:     $header = Translation::get('ad_categ_edit_1') . ' \"' . Strings::htmlentities($categoryData->getName()) . '\" ' .",
          "65:         Translation::get('ad_categ_edit_2');",
          "67:         <div class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\">",
          "68:           <h1 class=\"h2\">",
          "70:           </h1>",
          "71:         </div>",
          "73:         <div class=\"row mb-2\">",
          "74:           <div class=\"col-lg-12\">",
          "75:           <form enctype=\"multipart/form-data\" action=\"?action=updatecategory\" method=\"post\">",
          "76:             <input type=\"hidden\" name=\"id\" value=\"<?= $categoryId ?>\">",
          "77:             <input type=\"hidden\" name=\"catlang\" id=\"catlang\" value=\"<?= $categoryData->getLang() ?>\">",
          "78:             <input type=\"hidden\" name=\"parent_id\" value=\"<?= $categoryData->getParentId() ?>\">",
          "79:               <?= Token::getInstance()->getTokenInput('update-category') ?>",
          "80:             <input type=\"hidden\" name=\"existing_image\" value=\"<?= $categoryData->getImage() ?>\"",
          "81:                    id=\"pmf-category-existing-image\">",
          "83:             <div class=\"row mb-2\">",
          "84:               <label class=\"col-lg-2 col-form-label\" for=\"name\">",
          "85:                   <?= Translation::get('ad_categ_titel') ?>",
          "86:               </label>",
          "87:               <div class=\"col-lg-4\">",
          "88:                 <input type=\"text\" id=\"name\" name=\"name\" value=\"<?= Strings::htmlentities($categoryData->getName()) ?>\" class=\"form-control\">",
          "89:               </div>",
          "90:             </div>",
          "92:             <div class=\"row mb-2\">",
          "93:               <label class=\"col-lg-2 col-form-label\" for=\"description\">",
          "94:                   <?= Translation::get('ad_categ_desc') ?>",
          "95:               </label>",
          "96:               <div class=\"col-lg-4\">",
          "99:               </div>",
          "100:             </div>",
          "102:             <div class=\"row mb-2\">",
          "103:               <div class=\"offset-lg-2 col-lg-4\">",
          "104:                 <div class=\"form-check\">",
          "105:                     <input class=\"form-check-input\" type=\"checkbox\" name=\"active\" id='active' value=\"1\"",
          "106:                         <?= (1 === (int)$categoryData->getActive() ? 'checked' : '') ?>>",
          "107:                     <label class=\"form-check-label\" for=\"active\"><?= Translation::get('ad_user_active') ?></label>",
          "109:               </div>",
          "110:             </div>",
          "112:             <div class=\"row mb-2\">",
          "113:               <div class=\"offset-lg-2 col-lg-4\">",
          "114:                 <div class=\"form-check\">",
          "115:                     <input class=\"form-check-input\" type=\"checkbox\" name=\"show_home\" id='show_home' value=\"1\"",
          "116:                         <?= (1 === (int)$categoryData->getShowHome() ? 'checked' : '') ?>>",
          "117:                     <label class=\"form-check-label\" for=\"show_home\"><?= Translation::get('ad_user_show_home') ?></label>",
          "119:               </div>",
          "120:             </div>",
          "123:               <div class=\"row mb-2\">",
          "124:                   <label class=\"col-lg-2 col-form-label\" for=\"pmf-category-image-upload\">",
          "125:                       <?= Translation::get('ad_category_image') ?>:",
          "126:                   </label>",
          "127:                   <div class=\"col-lg-4\">",
          "128:                     <div class=\"input-group\">",
          "129:                       <input class=\"form-control\" type=\"file\" name=\"image\" id=\"pmf-category-image-upload\"",
          "130:                              value=\"<?= $categoryData->getImage() ?>\">",
          "131:                       <span class=\"input-group-text\" id=\"pmf-category-image-label\"><?= $categoryData->getImage() ?></span>",
          "133:                       <div class=\"input-group mt-2\">",
          "134:                           <button type=\"button\" class=\"btn btn-info\" id=\"button-reset-category-image\">",
          "135:                               Reset category image",
          "136:                           </button>",
          "137:                       </div>",
          "138:                   </div>",
          "139:               </div>",
          "141:             <div class=\"row mb-2\">",
          "142:               <label class=\"col-lg-2 col-form-label\" for=\"user_id\">",
          "143:                   <?= Translation::get('ad_categ_owner') ?>",
          "144:               </label>",
          "145:               <div class=\"col-lg-4\">",
          "146:                 <select id=\"user_id\" name=\"user_id\" class=\"form-select\">",
          "147:                     <?= $userHelper->getAllUserOptions($categoryData->getUserId()) ?>",
          "148:                 </select>",
          "149:               </div>",
          "150:             </div>",
          "152:               <?php if ($faqConfig->get('security.permLevel') != 'basic') { ?>",
          "153:                   <div class=\"row mb-2\">",
          "154:                       <label class=\"col-lg-2 col-form-label\" for=\"group_id\"><?= Translation::get('ad_categ_moderator') ?>:</label>",
          "155:                       <div class=\"col-lg-4\">",
          "156:                           <select name=\"group_id\" id=\"group_id\" class=\"form-select\">",
          "157:                               <?= $user->perm->getAllGroupsOptions([$categoryData->getGroupId()], $user) ?>",
          "158:                           </select>",
          "159:                       </div>",
          "160:                   </div>",
          "162:                   <div class=\"row mb-2\">",
          "163:                       <label class=\"col-lg-2 col-form-label\" for=\"restricted_groups\">",
          "164:                           <?= Translation::get('ad_entry_grouppermission') ?>",
          "165:                       </label>",
          "166:                       <div class=\"col-lg-4\">",
          "167:                           <div class=\"form-check\">",
          "168:                               <input type=\"radio\" name=\"grouppermission\" id=\"grouppermission_all\" value=\"all\"",
          "169:                                      class=\"form-check-input\" <?php echo($allGroups ? 'checked' : '') ?>>",
          "170:                               <label class=\"form-check-label\" for=\"grouppermission_all\">",
          "171:                                   <?= Translation::get('ad_entry_all_groups') ?>",
          "172:                               </label>",
          "173:                           </div>",
          "174:                           <div class=\"form-check\">",
          "175:                               <input type=\"radio\" name=\"grouppermission\" id=\"grouppermission\" value=\"restricted\"",
          "176:                                      class=\"form-check-input\" <?php echo($restrictedGroups ? 'checked' : '') ?>>",
          "177:                               <label class=\"form-check-label\" for=\"grouppermission\">",
          "178:                                   <?= Translation::get('ad_entry_restricted_groups') ?>",
          "179:                               </label>",
          "180:                           </div>",
          "181:                           <select name=\"restricted_groups[]\" id=\"restricted_groups\" size=\"3\" class=\"form-select\"",
          "182:                                   multiple>",
          "183:                               <?= $user->perm->getAllGroupsOptions($groupPermission, $user) ?>",
          "184:                           </select>",
          "185:                       </div>",
          "186:                   </div>",
          "188:               <?php } else { ?>",
          "189:                 <input type=\"hidden\" name=\"grouppermission\" value=\"all\">",
          "190:               <?php } ?>",
          "191:               <div class=\"row mb-2\">",
          "192:                   <label class=\"col-lg-2 col-form-label\" for=\"restricted_users\">",
          "193:                       <?= Translation::get('ad_entry_userpermission') ?>",
          "194:                   </label>",
          "195:                   <div class=\"col-lg-4\">",
          "196:                       <div class=\"form-check\">",
          "197:                           <input type=\"radio\" name=\"userpermission\" id=\"userpermission_all\" value=\"all\"",
          "198:                                  class=\"form-check-input\" <?= ($allUsers ? 'checked' : '') ?>>",
          "199:                           <label class=\"form-check-label\" for=\"userpermission_all\">",
          "200:                               <?= Translation::get('ad_entry_all_users') ?>",
          "201:                           </label>",
          "202:                       </div>",
          "203:                       <div class=\"form-check\">",
          "204:                           <input type=\"radio\" name=\"userpermission\" id=\"userpermission\" value=\"restricted\" class=\"form-check-input\">",
          "205:                           <label class=\"form-check-label\" for=\"userpermission\"<?= ($restrictedUsers ? 'checked' : '') ?>>",
          "206:                               <?= Translation::get('ad_entry_restricted_users') ?>",
          "207:                           </label>",
          "208:                       </div>",
          "209:                       <select name=\"restricted_users\" id=\"restricted_users\" class=\"form-select\">",
          "210:                           <?= $userHelper->getAllUserOptions($categoryData->getUserId()) ?>",
          "211:                       </select>",
          "212:                   </div>",
          "213:               </div>",
          "215:             <div class=\"row mb-2\">",
          "216:               <div class=\"offset-lg-2 col-lg-4 text-end\">",
          "217:                 <button class=\"btn btn-primary\" type=\"submit\" name=\"submit\">",
          "218:                     <?= Translation::get('ad_categ_updatecateg') ?>",
          "219:                 </button>",
          "220:               </div>",
          "221:             </div>",
          "222:           </form>",
          "223:           </div>",
          "",
          "[Added Lines]",
          "63:     $header = Translation::get('ad_categ_edit_1') . ' \"' . Strings::htmlentities(",
          "64:             $categoryData->getName()",
          "65:         ) . '\" ' . Translation::get('ad_categ_edit_2');",
          "67:     <div",
          "68:         class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\">",
          "69:         <h1 class=\"h2\">",
          "71:         </h1>",
          "72:     </div>",
          "74:     <div class=\"row mb-2\">",
          "75:         <div class=\"col-lg-12\">",
          "76:             <form enctype=\"multipart/form-data\" action=\"?action=updatecategory\" method=\"post\">",
          "77:                 <input type=\"hidden\" name=\"id\" value=\"<?= $categoryId ?>\">",
          "78:                 <input type=\"hidden\" name=\"catlang\" id=\"catlang\" value=\"<?= $categoryData->getLang() ?>\">",
          "79:                 <input type=\"hidden\" name=\"parent_id\" value=\"<?= $categoryData->getParentId() ?>\">",
          "80:                 <?= Token::getInstance()->getTokenInput('update-category') ?>",
          "81:                 <input type=\"hidden\" name=\"existing_image\" value=\"<?= $categoryData->getImage() ?>\"",
          "82:                        id=\"pmf-category-existing-image\">",
          "84:                 <div class=\"row mb-2\">",
          "85:                     <label class=\"col-lg-2 col-form-label\" for=\"name\">",
          "86:                         <?= Translation::get('ad_categ_titel') ?>",
          "87:                     </label>",
          "88:                     <div class=\"col-lg-4\">",
          "89:                         <input type=\"text\" id=\"name\" name=\"name\"",
          "90:                                value=\"<?= Strings::htmlentities($categoryData->getName()) ?>\" class=\"form-control\">",
          "91:                     </div>",
          "92:                 </div>",
          "94:                 <div class=\"row mb-2\">",
          "95:                     <label class=\"col-lg-2 col-form-label\" for=\"description\">",
          "96:                         <?= Translation::get('ad_categ_desc') ?>",
          "97:                     </label>",
          "98:                     <div class=\"col-lg-4\">",
          "101:                     </div>",
          "104:                 <div class=\"row mb-2\">",
          "105:                     <div class=\"offset-lg-2 col-lg-4\">",
          "106:                         <div class=\"form-check\">",
          "107:                             <input class=\"form-check-input\" type=\"checkbox\" name=\"active\" id='active' value=\"1\"",
          "108:                                 <?= (1 === (int)$categoryData->getActive() ? 'checked' : '') ?>>",
          "109:                             <label class=\"form-check-label\" for=\"active\"><?= Translation::get(",
          "110:                                     'ad_user_active'",
          "111:                                 ) ?></label>",
          "112:                         </div>",
          "113:                     </div>",
          "116:                 <div class=\"row mb-2\">",
          "117:                     <div class=\"offset-lg-2 col-lg-4\">",
          "118:                         <div class=\"form-check\">",
          "119:                             <input class=\"form-check-input\" type=\"checkbox\" name=\"show_home\" id='show_home' value=\"1\"",
          "120:                                 <?= (1 === (int)$categoryData->getShowHome() ? 'checked' : '') ?>>",
          "121:                             <label class=\"form-check-label\" for=\"show_home\"><?= Translation::get(",
          "122:                                     'ad_user_show_home'",
          "123:                                 ) ?></label>",
          "124:                         </div>",
          "125:                     </div>",
          "126:                 </div>",
          "128:                 <div class=\"row mb-2\">",
          "129:                     <label class=\"col-lg-2 col-form-label\" for=\"pmf-category-image-upload\">",
          "130:                         <?= Translation::get('ad_category_image') ?>:",
          "131:                     </label>",
          "132:                     <div class=\"col-lg-4\">",
          "133:                         <div class=\"input-group\">",
          "134:                             <input class=\"form-control\" type=\"file\" name=\"image\" id=\"pmf-category-image-upload\"",
          "135:                                    value=\"<?= $categoryData->getImage() ?>\">",
          "136:                             <span class=\"input-group-text\" id=\"pmf-category-image-label\"><?= $categoryData->getImage(",
          "137:                                 ) ?></span>",
          "138:                         </div>",
          "139:                         <div class=\"input-group mt-2\">",
          "140:                             <button type=\"button\" class=\"btn btn-info\" id=\"button-reset-category-image\">",
          "141:                                 Reset category image",
          "142:                             </button>",
          "143:                         </div>",
          "145:                 </div>",
          "147:                 <div class=\"row mb-2\">",
          "148:                     <label class=\"col-lg-2 col-form-label\" for=\"user_id\">",
          "149:                         <?= Translation::get('ad_categ_owner') ?>",
          "150:                     </label>",
          "151:                     <div class=\"col-lg-4\">",
          "152:                         <select id=\"user_id\" name=\"user_id\" class=\"form-select\">",
          "153:                             <?= $userHelper->getAllUserOptions($categoryData->getUserId()) ?>",
          "154:                         </select>",
          "155:                     </div>",
          "156:                 </div>",
          "158:                 <?php",
          "159:                 if ($faqConfig->get('security.permLevel') != 'basic') { ?>",
          "160:                     <div class=\"row mb-2\">",
          "161:                         <label class=\"col-lg-2 col-form-label\" for=\"group_id\"><?= Translation::get(",
          "162:                                 'ad_categ_moderator'",
          "163:                             ) ?>:</label>",
          "164:                         <div class=\"col-lg-4\">",
          "165:                             <select name=\"group_id\" id=\"group_id\" class=\"form-select\">",
          "166:                                 <?= $user->perm->getAllGroupsOptions([$categoryData->getGroupId()], $user) ?>",
          "167:                             </select>",
          "168:                         </div>",
          "169:                     </div>",
          "171:                     <div class=\"row mb-2\">",
          "172:                         <label class=\"col-lg-2 col-form-label\" for=\"restricted_groups\">",
          "173:                             <?= Translation::get('ad_entry_grouppermission') ?>",
          "174:                         </label>",
          "175:                         <div class=\"col-lg-4\">",
          "176:                             <div class=\"form-check\">",
          "177:                                 <input type=\"radio\" name=\"grouppermission\" id=\"grouppermission_all\" value=\"all\"",
          "178:                                        class=\"form-check-input\" <?php",
          "179:                                 echo($allGroups ? 'checked' : '') ?>>",
          "180:                                 <label class=\"form-check-label\" for=\"grouppermission_all\">",
          "181:                                     <?= Translation::get('ad_entry_all_groups') ?>",
          "182:                                 </label>",
          "183:                             </div>",
          "184:                             <div class=\"form-check\">",
          "185:                                 <input type=\"radio\" name=\"grouppermission\" id=\"grouppermission\" value=\"restricted\"",
          "186:                                        class=\"form-check-input\" <?php",
          "187:                                 echo($restrictedGroups ? 'checked' : '') ?>>",
          "188:                                 <label class=\"form-check-label\" for=\"grouppermission\">",
          "189:                                     <?= Translation::get('ad_entry_restricted_groups') ?>",
          "190:                                 </label>",
          "191:                             </div>",
          "192:                             <select name=\"restricted_groups[]\" id=\"restricted_groups\" size=\"3\" class=\"form-select\"",
          "193:                                     multiple>",
          "194:                                 <?= $user->perm->getAllGroupsOptions($groupPermission, $user) ?>",
          "195:                             </select>",
          "196:                         </div>",
          "197:                     </div>",
          "199:                 <?php",
          "200:                 } else { ?>",
          "201:                     <input type=\"hidden\" name=\"grouppermission\" value=\"all\">",
          "202:                 <?php",
          "203:                 } ?>",
          "204:                 <div class=\"row mb-2\">",
          "205:                     <label class=\"col-lg-2 col-form-label\" for=\"restricted_users\">",
          "206:                         <?= Translation::get('ad_entry_userpermission') ?>",
          "207:                     </label>",
          "208:                     <div class=\"col-lg-4\">",
          "209:                         <div class=\"form-check\">",
          "210:                             <input type=\"radio\" name=\"userpermission\" id=\"userpermission_all\" value=\"all\"",
          "211:                                    class=\"form-check-input\" <?= ($allUsers ? 'checked' : '') ?>>",
          "212:                             <label class=\"form-check-label\" for=\"userpermission_all\">",
          "213:                                 <?= Translation::get('ad_entry_all_users') ?>",
          "214:                             </label>",
          "215:                         </div>",
          "216:                         <div class=\"form-check\">",
          "217:                             <input type=\"radio\" name=\"userpermission\" id=\"userpermission\" value=\"restricted\"",
          "218:                                    class=\"form-check-input\">",
          "219:                             <label class=\"form-check-label\"",
          "220:                                    for=\"userpermission\"<?= ($restrictedUsers ? 'checked' : '') ?>>",
          "221:                                 <?= Translation::get('ad_entry_restricted_users') ?>",
          "222:                             </label>",
          "223:                         </div>",
          "224:                         <select name=\"restricted_users\" id=\"restricted_users\" class=\"form-select\">",
          "225:                             <?= $userHelper->getAllUserOptions($categoryData->getUserId()) ?>",
          "226:                         </select>",
          "227:                     </div>",
          "228:                 </div>",
          "230:                 <div class=\"row mb-2\">",
          "231:                     <div class=\"offset-lg-2 col-lg-4 text-end\">",
          "232:                         <button class=\"btn btn-primary\" type=\"submit\" name=\"submit\">",
          "233:                             <?= Translation::get('ad_categ_updatecateg') ?>",
          "234:                         </button>",
          "235:                     </div>",
          "236:                 </div>",
          "237:             </form>",
          "239:     </div>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2f550956c7c3b3f2f2bc9df80a1e2a045fc78202",
      "candidate_info": {
        "commit_hash": "2f550956c7c3b3f2f2bc9df80a1e2a045fc78202",
        "repo": "thorsten/phpmyfaq",
        "commit_url": "https://github.com/thorsten/phpmyfaq/commit/2f550956c7c3b3f2f2bc9df80a1e2a045fc78202",
        "files": [
          "phpmyfaq/admin/assets/src/content/category.js",
          "phpmyfaq/admin/category.edit.php"
        ],
        "message": "fix: re-add possibility to remove category image, closes #2836",
        "before_after_code_files": [
          "phpmyfaq/admin/assets/src/content/category.js||phpmyfaq/admin/assets/src/content/category.js",
          "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ],
          "candidate": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ]
        }
      },
      "candidate_diff": {
        "phpmyfaq/admin/assets/src/content/category.js||phpmyfaq/admin/assets/src/content/category.js": [
          "File: phpmyfaq/admin/assets/src/content/category.js -> phpmyfaq/admin/assets/src/content/category.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: export const handleCategories = () => {",
          "20:   const listGroupItems = document.querySelectorAll('.list-group-item');",
          "21:   const sortableCategories = document.querySelector('.list-group.list-group-root');",
          "23:   listGroupItems.forEach((element) => {",
          "24:     element.addEventListener('click', (event) => {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "22:   const resetButton = document.getElementById('button-reset-category-image');",
          "24:   if (resetButton) {",
          "25:     const categoryExistingImage = document.getElementById('pmf-category-existing-image');",
          "26:     const categoryImageInput = document.getElementById('pmf-category-image-upload');",
          "27:     const categoryImageLabel = document.getElementById('pmf-category-image-label');",
          "28:     resetButton.addEventListener('click', () => {",
          "29:       categoryImageInput.value = '';",
          "30:       categoryExistingImage.value = '';",
          "31:       categoryImageLabel.innerHTML = '';",
          "32:     });",
          "33:   }",
          "",
          "---------------"
        ],
        "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php": [
          "File: phpmyfaq/admin/category.edit.php -> phpmyfaq/admin/category.edit.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "128:                     <div class=\"input-group\">",
          "129:                       <input class=\"form-control\" type=\"file\" name=\"image\" id=\"pmf-category-image-upload\"",
          "130:                              value=\"<?= $categoryData->getImage() ?>\">",
          "132:                     </div>",
          "133:                       <div class=\"input-group mt-2\">",
          "134:                           <button type=\"button\" class=\"btn btn-info\" id=\"button-reset-category-image\">",
          "",
          "[Removed Lines]",
          "131:                       <span class=\"input-group-text\"><?= $categoryData->getImage() ?></span>",
          "",
          "[Added Lines]",
          "131:                       <span class=\"input-group-text\" id=\"pmf-category-image-label\"><?= $categoryData->getImage() ?></span>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "0bbed74ade540e37a95796c2b50daa5ce101088f",
      "candidate_info": {
        "commit_hash": "0bbed74ade540e37a95796c2b50daa5ce101088f",
        "repo": "thorsten/phpmyfaq",
        "commit_url": "https://github.com/thorsten/phpmyfaq/commit/0bbed74ade540e37a95796c2b50daa5ce101088f",
        "files": [
          "phpmyfaq/admin/category.add.php",
          "phpmyfaq/admin/category.edit.php",
          "phpmyfaq/assets/templates/admin/content/category.edit.twig"
        ],
        "message": "refactor: rewritten edit category to Twig (#2791)",
        "before_after_code_files": [
          "phpmyfaq/admin/category.add.php||phpmyfaq/admin/category.add.php",
          "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php",
          "phpmyfaq/assets/templates/admin/content/category.edit.twig||phpmyfaq/assets/templates/admin/content/category.edit.twig"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ],
          "candidate": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ]
        }
      },
      "candidate_diff": {
        "phpmyfaq/admin/category.add.php||phpmyfaq/admin/category.add.php": [
          "File: phpmyfaq/admin/category.add.php -> phpmyfaq/admin/category.add.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: use phpMyFAQ\\Category;",
          "20: use phpMyFAQ\\Category\\CategoryPermission;",
          "21: use phpMyFAQ\\Enums\\PermissionType;",
          "22: use phpMyFAQ\\Filter;",
          "23: use phpMyFAQ\\Helper\\UserHelper;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "21: use phpMyFAQ\\Configuration;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "25: use phpMyFAQ\\Session\\Token;",
          "26: use phpMyFAQ\\Translation;",
          "27: use phpMyFAQ\\Template\\TwigWrapper;",
          "28: use Twig\\Extension\\DebugExtension;",
          "30: if (!defined('IS_VALID_PHPMYFAQ')) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "29: use phpMyFAQ\\User\\CurrentUser;",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "32:     exit();",
          "33: }",
          "39:     $category = new Category($faqConfig, [], false);",
          "40:     $category->setUser($currentAdminUser);",
          "41:     $category->setGroups($currentAdminGroups);",
          "43:     $categoryPermission = new CategoryPermission($faqConfig);",
          "47:     $parentId = Filter::filterInput(INPUT_GET, 'cat', FILTER_VALIDATE_INT, 0);",
          "",
          "[Removed Lines]",
          "36: $currentUserId = $user->getUserId();",
          "38: if ($user->perm->hasPermission($user->getUserId(), PermissionType::CATEGORY_ADD->value)) {",
          "45:     $userHelper = new UserHelper($user);",
          "",
          "[Added Lines]",
          "37: $faqConfig = Configuration::getConfigurationInstance();",
          "38: $currentUser = CurrentUser::getCurrentUser($faqConfig);",
          "40: if ($currentUser->perm->hasPermission($currentUser->getUserId(), PermissionType::CATEGORY_ADD->value)) {",
          "47:     $userHelper = new UserHelper($currentUser);",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "82:     if ($faqConfig->get('security.permLevel') !== 'basic') {",
          "83:         $templateVars = [",
          "84:             ...$templateVars,",
          "86:             'ad_categ_moderator' => Translation::get('ad_categ_moderator')",
          "87:         ];",
          "88:     }",
          "",
          "[Removed Lines]",
          "85:             'groupsOptions' => $user->perm->getAllGroupsOptions([], $user),",
          "",
          "[Added Lines]",
          "87:             'groupsOptions' => $currentUser->perm->getAllGroupsOptions([], $currentUser),",
          "",
          "---------------"
        ],
        "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php": [
          "File: phpmyfaq/admin/category.edit.php -> phpmyfaq/admin/category.edit.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "18: use phpMyFAQ\\Category;",
          "19: use phpMyFAQ\\Category\\CategoryPermission;",
          "20: use phpMyFAQ\\Enums\\PermissionType;",
          "21: use phpMyFAQ\\Filter;",
          "22: use phpMyFAQ\\Helper\\UserHelper;",
          "23: use phpMyFAQ\\Session\\Token;",
          "24: use phpMyFAQ\\Strings;",
          "25: use phpMyFAQ\\Translation;",
          "27: if (!defined('IS_VALID_PHPMYFAQ')) {",
          "28:     http_response_code(400);",
          "29:     exit();",
          "30: }",
          "35:     $categoryId = Filter::filterInput(INPUT_GET, 'cat', FILTER_VALIDATE_INT, 0);",
          "37:     $category = new Category($faqConfig, [], false);",
          "",
          "[Removed Lines]",
          "32: $currentUserId = $user->getUserId();",
          "34: if ($user->perm->hasPermission($user->getUserId(), PermissionType::CATEGORY_EDIT->value)) {",
          "",
          "[Added Lines]",
          "20: use phpMyFAQ\\Configuration;",
          "26: use phpMyFAQ\\Template\\TwigWrapper;",
          "28: use phpMyFAQ\\User\\CurrentUser;",
          "35: $faqConfig = Configuration::getConfigurationInstance();",
          "36: $currentUser = CurrentUser::getCurrentUser($faqConfig);",
          "38: $currentUserId = $currentUser->getUserId();",
          "40: if ($currentUser->perm->hasPermission($currentUser->getUserId(), PermissionType::CATEGORY_EDIT->value)) {",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "41:     $categoryPermission = new CategoryPermission($faqConfig);",
          "45:     $categoryData = $category->getCategoryData($categoryId);",
          "46:     $userPermission = $categoryPermission->get(CategoryPermission::USER, [$categoryId]);",
          "",
          "[Removed Lines]",
          "43:     $userHelper = new UserHelper($user);",
          "",
          "[Added Lines]",
          "49:     $userHelper = new UserHelper($currentUser);",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "65:     $header = Translation::get('ad_categ_edit_1') . ' \"' . Strings::htmlentities($categoryData->getName()) . '\" ' .",
          "66:         Translation::get('ad_categ_edit_2');",
          "228: } else {",
          "229:     require 'no-permission.php';",
          "230: }",
          "",
          "[Removed Lines]",
          "67:     ?>",
          "68:         <div class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\">",
          "69:           <h1 class=\"h2\">",
          "70:             <i aria-hidden=\"true\" class=\"bi bi-folder\"></i> <?= $header ?>",
          "71:           </h1>",
          "72:         </div>",
          "74:         <div class=\"row mb-2\">",
          "75:           <div class=\"col-lg-12\">",
          "76:           <form enctype=\"multipart/form-data\" action=\"?action=updatecategory\" method=\"post\">",
          "77:             <input type=\"hidden\" name=\"id\" value=\"<?= $categoryId ?>\">",
          "78:             <input type=\"hidden\" name=\"catlang\" id=\"catlang\" value=\"<?= $categoryData->getLang() ?>\">",
          "79:             <input type=\"hidden\" name=\"parent_id\" value=\"<?= $categoryData->getParentId() ?>\">",
          "80:               <?= Token::getInstance()->getTokenInput('update-category') ?>",
          "81:             <input type=\"hidden\" name=\"existing_image\" value=\"<?= $categoryData->getImage() ?>\"",
          "82:                    id=\"pmf-category-existing-image\">",
          "84:             <div class=\"row mb-2\">",
          "85:               <label class=\"col-lg-2 col-form-label\" for=\"name\">",
          "86:                   <?= Translation::get('ad_categ_titel') ?>",
          "87:               </label>",
          "88:               <div class=\"col-lg-4\">",
          "89:                 <input type=\"text\" id=\"name\" name=\"name\" value=\"<?= Strings::htmlentities($categoryData->getName()) ?>\"",
          "90:                        class=\"form-control\">",
          "91:               </div>",
          "92:             </div>",
          "94:             <div class=\"row mb-2\">",
          "95:               <label class=\"col-lg-2 col-form-label\" for=\"description\">",
          "96:                   <?= Translation::get('ad_categ_desc') ?>",
          "97:               </label>",
          "98:               <div class=\"col-lg-4\">",
          "99:                 <textarea id=\"description\" name=\"description\" rows=\"3\"",
          "100:                           class=\"form-control\"><?= Strings::htmlentities($categoryData->getDescription()) ?></textarea>",
          "101:               </div>",
          "102:             </div>",
          "104:             <div class=\"row mb-2\">",
          "105:               <div class=\"offset-lg-2 col-lg-4\">",
          "106:                 <div class=\"form-check\">",
          "107:                     <input class=\"form-check-input\" type=\"checkbox\" name=\"active\" id='active' value=\"1\"",
          "108:                         <?= (1 === (int)$categoryData->getActive() ? 'checked' : '') ?>>",
          "109:                     <label class=\"form-check-label\" for=\"active\"><?= Translation::get('ad_user_active') ?></label>",
          "110:                 </div>",
          "111:               </div>",
          "112:             </div>",
          "114:             <div class=\"row mb-2\">",
          "115:               <div class=\"offset-lg-2 col-lg-4\">",
          "116:                 <div class=\"form-check\">",
          "117:                     <input class=\"form-check-input\" type=\"checkbox\" name=\"show_home\" id='show_home' value=\"1\"",
          "118:                         <?= (1 === (int)$categoryData->getShowHome() ? 'checked' : '') ?>>",
          "119:                     <label class=\"form-check-label\" for=\"show_home\"><?= Translation::get('ad_user_show_home') ?></label>",
          "120:                 </div>",
          "121:               </div>",
          "122:             </div>",
          "125:               <div class=\"row mb-2\">",
          "126:                   <label class=\"col-lg-2 col-form-label\" for=\"pmf-category-image-upload\">",
          "127:                       <?= Translation::get('ad_category_image') ?>:",
          "128:                   </label>",
          "129:                   <div class=\"col-lg-4\">",
          "130:                     <div class=\"input-group\">",
          "131:                       <input class=\"form-control\" type=\"file\" name=\"image\" id=\"pmf-category-image-upload\"",
          "132:                              value=\"<?= $categoryData->getImage() ?>\">",
          "133:                       <span class=\"input-group-text\" id=\"pmf-category-image-label\"><?= $categoryData->getImage() ?></span>",
          "134:                     </div>",
          "135:                       <div class=\"input-group mt-2\">",
          "136:                           <button type=\"button\" class=\"btn btn-info\" id=\"button-reset-category-image\">",
          "137:                               Reset category image",
          "138:                           </button>",
          "139:                       </div>",
          "140:                   </div>",
          "141:               </div>",
          "143:             <div class=\"row mb-2\">",
          "144:               <label class=\"col-lg-2 col-form-label\" for=\"user_id\">",
          "145:                   <?= Translation::get('ad_categ_owner') ?>",
          "146:               </label>",
          "147:               <div class=\"col-lg-4\">",
          "148:                 <select id=\"user_id\" name=\"user_id\" class=\"form-select\">",
          "149:                     <?= $userHelper->getAllUserOptions($categoryData->getUserId()) ?>",
          "150:                 </select>",
          "151:               </div>",
          "152:             </div>",
          "154:               <?php if ($faqConfig->get('security.permLevel') != 'basic') { ?>",
          "155:                   <div class=\"row mb-2\">",
          "156:                       <label class=\"col-lg-2 col-form-label\" for=\"group_id\"><?= Translation::get('ad_categ_moderator') ?>:</label>",
          "157:                       <div class=\"col-lg-4\">",
          "158:                           <select name=\"group_id\" id=\"group_id\" class=\"form-select\">",
          "159:                               <?= $user->perm->getAllGroupsOptions([$categoryData->getGroupId()], $user) ?>",
          "160:                           </select>",
          "161:                       </div>",
          "162:                   </div>",
          "164:                   <div class=\"row mb-2\">",
          "165:                       <label class=\"col-lg-2 col-form-label\" for=\"restricted_groups\">",
          "166:                           <?= Translation::get('ad_entry_grouppermission') ?>",
          "167:                       </label>",
          "168:                       <div class=\"col-lg-4\">",
          "169:                           <div class=\"form-check\">",
          "170:                               <input type=\"radio\" name=\"grouppermission\" id=\"grouppermission_all\" value=\"all\"",
          "171:                                      class=\"form-check-input\" <?php echo($allGroups ? 'checked' : '') ?>>",
          "172:                               <label class=\"form-check-label\" for=\"grouppermission_all\">",
          "173:                                   <?= Translation::get('ad_entry_all_groups') ?>",
          "174:                               </label>",
          "175:                           </div>",
          "176:                           <div class=\"form-check\">",
          "177:                               <input type=\"radio\" name=\"grouppermission\" id=\"grouppermission\" value=\"restricted\"",
          "178:                                      class=\"form-check-input\" <?php echo($restrictedGroups ? 'checked' : '') ?>>",
          "179:                               <label class=\"form-check-label\" for=\"grouppermission\">",
          "180:                                   <?= Translation::get('ad_entry_restricted_groups') ?>",
          "181:                               </label>",
          "182:                           </div>",
          "183:                           <select name=\"restricted_groups[]\" id=\"restricted_groups\" size=\"3\" class=\"form-select\"",
          "184:                                   multiple>",
          "185:                               <?= $user->perm->getAllGroupsOptions($groupPermission, $user) ?>",
          "186:                           </select>",
          "187:                       </div>",
          "188:                   </div>",
          "190:               <?php } else { ?>",
          "191:                 <input type=\"hidden\" name=\"grouppermission\" value=\"all\">",
          "192:               <?php } ?>",
          "193:               <div class=\"row mb-2\">",
          "194:                   <label class=\"col-lg-2 col-form-label\" for=\"restricted_users\">",
          "195:                       <?= Translation::get('ad_entry_userpermission') ?>",
          "196:                   </label>",
          "197:                   <div class=\"col-lg-4\">",
          "198:                       <div class=\"form-check\">",
          "199:                           <input type=\"radio\" name=\"userpermission\" id=\"userpermission_all\" value=\"all\"",
          "200:                                  class=\"form-check-input\" <?= ($allUsers ? 'checked' : '') ?>>",
          "201:                           <label class=\"form-check-label\" for=\"userpermission_all\">",
          "202:                               <?= Translation::get('ad_entry_all_users') ?>",
          "203:                           </label>",
          "204:                       </div>",
          "205:                       <div class=\"form-check\">",
          "206:                           <input type=\"radio\" name=\"userpermission\" id=\"userpermission\" value=\"restricted\" class=\"form-check-input\">",
          "207:                           <label class=\"form-check-label\" for=\"userpermission\"<?= ($restrictedUsers ? 'checked' : '') ?>>",
          "208:                               <?= Translation::get('ad_entry_restricted_users') ?>",
          "209:                           </label>",
          "210:                       </div>",
          "211:                       <select name=\"restricted_users\" id=\"restricted_users\" class=\"form-select\">",
          "212:                           <?= $userHelper->getAllUserOptions($categoryData->getUserId()) ?>",
          "213:                       </select>",
          "214:                   </div>",
          "215:               </div>",
          "217:             <div class=\"row mb-2\">",
          "218:               <div class=\"offset-lg-2 col-lg-4 text-end\">",
          "219:                 <button class=\"btn btn-primary\" type=\"submit\" name=\"submit\">",
          "220:                     <?= Translation::get('ad_categ_updatecateg') ?>",
          "221:                 </button>",
          "222:               </div>",
          "223:             </div>",
          "224:           </form>",
          "225:           </div>",
          "226:         </div>",
          "227:     <?php",
          "",
          "[Added Lines]",
          "74:     $templateVars = [",
          "75:         'header' => $header,",
          "76:         'categoryId' => $categoryId,",
          "77:         'categoryLanguage' => $categoryData->getLang(),",
          "78:         'parentId' => $categoryData->getParentId(),",
          "79:         'csrfInputToken' => Token::getInstance()->getTokenInput('update-category'),",
          "80:         'categoryImage' => $categoryData->getImage(),",
          "81:         'categoryNameLabel' => Translation::get('ad_categ_titel'),",
          "82:         'categoryName' => $categoryData->getName(),",
          "83:         'categoryDescriptionLabel' => Translation::get('ad_categ_desc'),",
          "84:         'categoryDescription' => $categoryData->getDescription(),",
          "85:         'categoryActiveLabel' => Translation::get('ad_user_active'),",
          "86:         'categoryActive' => 1 === (int)$categoryData->getActive() ? 'checked' : '',",
          "87:         'categoryShowHomeLabel' => Translation::get('ad_user_show_home'),",
          "88:         'categoryShowHome' => 1 === (int)$categoryData->getShowHome() ? 'checked' : '',",
          "89:         'categoryImageLabel' => Translation::get('ad_category_image'),",
          "90:         'categoryImageReset' => 'Reset category image',",
          "91:         'categoryOwnerLabel' => Translation::get('ad_categ_owner'),",
          "92:         'categoryOwnerOptions' => $userHelper->getAllUserOptions($categoryData->getUserId()),",
          "93:         'isMediumPermission' => $faqConfig->get('security.permLevel') !== 'basic',",
          "94:         'categoryModeratorLabel' => Translation::get('ad_categ_moderator'),",
          "95:         'allGroupsOptions' => $currentUser->perm->getAllGroupsOptions([$categoryData->getGroupId()], $currentUser),",
          "96:         'categoryGroupPermissionLabel' => Translation::get('ad_entry_grouppermission'),",
          "97:         'allGroups' => $allGroups ? 'checked' : '',",
          "98:         'categoryGroupPermissionAllLabel' => Translation::get('ad_entry_all_groups'),",
          "99:         'restrictedGroups' => $restrictedGroups ? 'checked' : '',",
          "100:         'restrictedGroupsLabel' => Translation::get('ad_entry_restricted_groups'),",
          "101:         'restrictedGroupsOptions' => $currentUser->perm->getAllGroupsOptions($groupPermission, $currentUser),",
          "102:         'userPermissionLabel' => Translation::get('ad_entry_userpermission'),",
          "103:         'allUsers' => $allUsers ? 'checked' : '',",
          "104:         'allUsersLabel' => Translation::get('ad_entry_all_users'),",
          "105:         'restrictedUsers' => $restrictedUsers ? 'checked' : '',",
          "106:         'restrictedUsersLabel' => Translation::get('ad_entry_restricted_users'),",
          "107:         'allUsersOptions' => $userHelper->getAllUserOptions($categoryData->getUserId()),",
          "108:         'buttonUpdate' => Translation::get('ad_categ_update'),",
          "109:     ];",
          "112:     $twig = new TwigWrapper(PMF_ROOT_DIR . '/assets/templates');",
          "113:     $template = $twig->loadTemplate('./admin/content/category.edit.twig');",
          "115:     echo $template->render($templateVars);",
          "",
          "---------------"
        ],
        "phpmyfaq/assets/templates/admin/content/category.edit.twig||phpmyfaq/assets/templates/admin/content/category.edit.twig": [
          "File: phpmyfaq/assets/templates/admin/content/category.edit.twig -> phpmyfaq/assets/templates/admin/content/category.edit.twig",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <div class=\"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom\">",
          "2:   <h1 class=\"h2\">",
          "3:     <i aria-hidden=\"true\" class=\"bi bi-folder\"></i> {{ header }}",
          "4:   </h1>",
          "5: </div>",
          "7: <div class=\"row mb-2\">",
          "8:   <div class=\"col-12\">",
          "9:     <form enctype=\"multipart/form-data\" action=\"?action=updatecategory\" method=\"post\">",
          "10:       <input type=\"hidden\" name=\"id\" value=\"{{ categoryId }}\">",
          "11:       <input type=\"hidden\" name=\"catlang\" id=\"catlang\" value=\"{{ categoryLanguage }}\">",
          "12:       <input type=\"hidden\" name=\"parent_id\" value=\"{{ parentId }}\">",
          "13:       {{ csrfInputToken | raw }}",
          "14:       <input type=\"hidden\" name=\"existing_image\" value=\"{{ categoryImage }}\" id=\"pmf-category-existing-image\">",
          "16:       <div class=\"row mb-2\">",
          "17:         <label class=\"col-lg-2 col-form-label\" for=\"name\">",
          "18:           {{ categoryNameLabel }}",
          "19:         </label>",
          "20:         <div class=\"col-lg-4\">",
          "21:           <input type=\"text\" id=\"name\" name=\"name\" value=\"{{ categoryName }}\" class=\"form-control\">",
          "22:         </div>",
          "23:       </div>",
          "25:       <div class=\"row mb-2\">",
          "26:         <label class=\"col-lg-2 col-form-label\" for=\"description\">",
          "27:           {{ categoryDescriptionLabel }}",
          "28:         </label>",
          "29:         <div class=\"col-lg-4\">",
          "30:                 <textarea id=\"description\" name=\"description\" rows=\"3\"",
          "31:                           class=\"form-control\">{{ categoryDescription }}</textarea>",
          "32:         </div>",
          "33:       </div>",
          "35:       <div class=\"row mb-2\">",
          "36:         <div class=\"offset-lg-2 col-lg-4\">",
          "37:           <div class=\"form-check\">",
          "38:             <input class=\"form-check-input\" type=\"checkbox\" name=\"active\" id='active' value=\"1\" {{ categoryActive }}>",
          "39:             <label class=\"form-check-label\" for=\"active\">{{ categoryActiveLabel }}</label>",
          "40:           </div>",
          "41:         </div>",
          "42:       </div>",
          "44:       <div class=\"row mb-2\">",
          "45:         <div class=\"offset-lg-2 col-lg-4\">",
          "46:           <div class=\"form-check\">",
          "47:             <input class=\"form-check-input\" type=\"checkbox\" name=\"show_home\" id='show_home' value=\"1\"",
          "48:               {{ categoryShowHome }}>",
          "49:             <label class=\"form-check-label\" for=\"show_home\">{{ categoryShowHomeLabel }}</label>",
          "50:           </div>",
          "51:         </div>",
          "52:       </div>",
          "55:       <div class=\"row mb-2\">",
          "56:         <label class=\"col-lg-2 col-form-label\" for=\"pmf-category-image-upload\">",
          "57:           {{ categoryImageLabel }}",
          "58:         </label>",
          "59:         <div class=\"col-lg-4\">",
          "60:           <div class=\"input-group\">",
          "61:             <input class=\"form-control\" type=\"file\" name=\"image\" id=\"pmf-category-image-upload\"",
          "62:                    value=\"{{ categoryImage }}\">",
          "63:             <span class=\"input-group-text\" id=\"pmf-category-image-label\">{{ categoryImage }}</span>",
          "64:           </div>",
          "65:           <div class=\"input-group mt-2\">",
          "66:             <button type=\"button\" class=\"btn btn-info\" id=\"button-reset-category-image\">",
          "67:               {{ categoryImageReset }}",
          "68:             </button>",
          "69:           </div>",
          "70:         </div>",
          "71:       </div>",
          "73:       <div class=\"row mb-2\">",
          "74:         <label class=\"col-lg-2 col-form-label\" for=\"user_id\">",
          "75:           {{ categoryOwnerLabel }}",
          "76:         </label>",
          "77:         <div class=\"col-lg-4\">",
          "78:           <select id=\"user_id\" name=\"user_id\" class=\"form-select\">",
          "79:             {{ categoryOwnerOptions | raw }}",
          "80:           </select>",
          "81:         </div>",
          "82:       </div>",
          "84:       {% if isMediumPermission %}",
          "85:         <div class=\"row mb-2\">",
          "86:           <label class=\"col-lg-2 col-form-label\" for=\"group_id\">",
          "87:             {{ categoryModeratorLabel }}",
          "88:           </label>",
          "89:           <div class=\"col-lg-4\">",
          "90:             <select name=\"group_id\" id=\"group_id\" class=\"form-select\">",
          "91:               {{ allGroupsOptions | raw }}",
          "92:             </select>",
          "93:           </div>",
          "94:         </div>",
          "96:         <div class=\"row mb-2\">",
          "97:           <label class=\"col-lg-2 col-form-label\" for=\"restricted_groups\">",
          "98:             {{ categoryGroupPermissionLabel }}",
          "99:           </label>",
          "100:           <div class=\"col-lg-4\">",
          "101:             <div class=\"form-check\">",
          "102:               <input type=\"radio\" name=\"grouppermission\" id=\"grouppermission_all\" value=\"all\"",
          "103:                      class=\"form-check-input\" {{ allGroups }}>",
          "104:               <label class=\"form-check-label\" for=\"grouppermission_all\">",
          "105:                 {{ categoryGroupPermissionAllLabel }}",
          "106:               </label>",
          "107:             </div>",
          "108:             <div class=\"form-check\">",
          "109:               <input type=\"radio\" name=\"grouppermission\" id=\"grouppermission\" value=\"restricted\"",
          "110:                      class=\"form-check-input\" {{ restrictedGroups }}>",
          "111:               <label class=\"form-check-label\" for=\"grouppermission\">",
          "112:                 {{ restrictedGroupsLabel }}",
          "113:               </label>",
          "114:             </div>",
          "115:             <select name=\"restricted_groups[]\" id=\"restricted_groups\" size=\"3\" class=\"form-select\" multiple>",
          "116:               {{ restrictedGroupsOptions | raw }}",
          "117:             </select>",
          "118:           </div>",
          "119:         </div>",
          "121:       {% else %}",
          "122:         <input type=\"hidden\" name=\"grouppermission\" value=\"all\">",
          "123:       {% endif %}",
          "124:       <div class=\"row mb-2\">",
          "125:         <label class=\"col-lg-2 col-form-label\" for=\"restricted_users\">",
          "126:           {{ userPermissionLabel }}",
          "127:         </label>",
          "128:         <div class=\"col-lg-4\">",
          "129:           <div class=\"form-check\">",
          "130:             <input type=\"radio\" name=\"userpermission\" id=\"userpermission_all\" value=\"all\"",
          "131:                    class=\"form-check-input\" {{ allUsers }}>",
          "132:             <label class=\"form-check-label\" for=\"userpermission_all\">",
          "133:               {{ allUsersLabel }}",
          "134:             </label>",
          "135:           </div>",
          "136:           <div class=\"form-check\">",
          "137:             <input type=\"radio\" name=\"userpermission\" id=\"userpermission\" value=\"restricted\"",
          "138:                    class=\"form-check-input\">",
          "139:             <label class=\"form-check-label\" for=\"userpermission\" {{ restrictedUsers }}>",
          "140:               {{ restrictedUsersLabel }}",
          "141:             </label>",
          "142:           </div>",
          "143:           <select name=\"restricted_users\" id=\"restricted_users\" class=\"form-select\">",
          "144:             {{ allUsersOptions | raw }}",
          "145:           </select>",
          "146:         </div>",
          "147:       </div>",
          "149:       <div class=\"row mb-2\">",
          "150:         <div class=\"offset-lg-2 col-lg-4 text-end\">",
          "151:           <button class=\"btn btn-primary\" type=\"submit\" name=\"submit\">",
          "152:             {{ buttonUpdate }}",
          "153:           </button>",
          "154:         </div>",
          "155:       </div>",
          "156:     </form>",
          "157:   </div>",
          "158: </div>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7a4b00442f8908f05fdf80f1f458939f748f4998",
      "candidate_info": {
        "commit_hash": "7a4b00442f8908f05fdf80f1f458939f748f4998",
        "repo": "thorsten/phpmyfaq",
        "commit_url": "https://github.com/thorsten/phpmyfaq/commit/7a4b00442f8908f05fdf80f1f458939f748f4998",
        "files": [
          "phpmyfaq/admin/category.edit.php"
        ],
        "message": "fix: avoid null values, closes #2809",
        "before_after_code_files": [
          "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ],
          "candidate": [
            "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php"
          ]
        }
      },
      "candidate_diff": {
        "phpmyfaq/admin/category.edit.php||phpmyfaq/admin/category.edit.php": [
          "File: phpmyfaq/admin/category.edit.php -> phpmyfaq/admin/category.edit.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "207:                           </label>",
          "208:                       </div>",
          "209:                       <select name=\"restricted_users\" id=\"restricted_users\" class=\"form-select\">",
          "211:                       </select>",
          "212:                   </div>",
          "213:               </div>",
          "",
          "[Removed Lines]",
          "210:                           <?= $userHelper->getAllUserOptions($userPermission[0]) ?>",
          "",
          "[Added Lines]",
          "210:                           <?= $userHelper->getAllUserOptions($categoryData->getUserId()) ?>",
          "",
          "---------------"
        ]
      }
    }
  ]
}