{
  "cve_id": "CVE-2023-0748",
  "cve_desc": "Open Redirect in GitHub repository btcpayserver/btcpayserver prior to 1.7.6.\n\n",
  "repo": "btcpayserver/btcpayserver",
  "patch_hash": "c2cfa17e9619046b43987627b8429541d2834109",
  "patch_info": {
    "commit_hash": "c2cfa17e9619046b43987627b8429541d2834109",
    "repo": "btcpayserver/btcpayserver",
    "commit_url": "https://github.com/btcpayserver/btcpayserver/pull/4575/commits/c2cfa17e9619046b43987627b8429541d2834109",
    "files": [
      "BTCPayServer.Tests/SeleniumTester.cs",
      "BTCPayServer/Extensions/UrlHelperExtensions.cs",
      "BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs",
      "BTCPayServer/Views/Shared/ConfirmModal.cshtml",
      "BTCPayServer/Views/Shared/PostRedirect.cshtml",
      "BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml",
      "BTCPayServer/Views/UIStores/WalletSettings.cshtml",
      "BTCPayServer/Views/UIWallets/SignWithSeed.cshtml",
      "BTCPayServer/Views/UIWallets/WalletPSBT.cshtml",
      "BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml",
      "BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml",
      "BTCPayServer/Views/UIWallets/WalletReceive.cshtml",
      "BTCPayServer/Views/UIWallets/WalletSend.cshtml",
      "BTCPayServer/Views/UIWallets/WalletSendVault.cshtml",
      "BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml"
    ],
    "message": "Fix a bunch of open redirect",
    "before_after_code_files": [
      "BTCPayServer.Tests/SeleniumTester.cs||BTCPayServer.Tests/SeleniumTester.cs",
      "BTCPayServer/Extensions/UrlHelperExtensions.cs||BTCPayServer/Extensions/UrlHelperExtensions.cs",
      "BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs||BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs",
      "BTCPayServer/Views/Shared/ConfirmModal.cshtml||BTCPayServer/Views/Shared/ConfirmModal.cshtml",
      "BTCPayServer/Views/Shared/PostRedirect.cshtml||BTCPayServer/Views/Shared/PostRedirect.cshtml",
      "BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml||BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml",
      "BTCPayServer/Views/UIStores/WalletSettings.cshtml||BTCPayServer/Views/UIStores/WalletSettings.cshtml",
      "BTCPayServer/Views/UIWallets/SignWithSeed.cshtml||BTCPayServer/Views/UIWallets/SignWithSeed.cshtml",
      "BTCPayServer/Views/UIWallets/WalletPSBT.cshtml||BTCPayServer/Views/UIWallets/WalletPSBT.cshtml",
      "BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml",
      "BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml",
      "BTCPayServer/Views/UIWallets/WalletReceive.cshtml||BTCPayServer/Views/UIWallets/WalletReceive.cshtml",
      "BTCPayServer/Views/UIWallets/WalletSend.cshtml||BTCPayServer/Views/UIWallets/WalletSend.cshtml",
      "BTCPayServer/Views/UIWallets/WalletSendVault.cshtml||BTCPayServer/Views/UIWallets/WalletSendVault.cshtml",
      "BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml||BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml"
    ]
  },
  "patch_diff": {
    "BTCPayServer.Tests/SeleniumTester.cs||BTCPayServer.Tests/SeleniumTester.cs": [
      "File: BTCPayServer.Tests/SeleniumTester.cs -> BTCPayServer.Tests/SeleniumTester.cs",
      "--- Hunk 1 ---",
      "[Context before]",
      "203:         {",
      "204:             var isImport = !string.IsNullOrEmpty(seed);",
      "205:             GoToWalletSettings(cryptoCode);",
      "208:             if (Driver.PageSource.Contains(\"id=\\\"ChangeWalletLink\\\"\"))",
      "209:             {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "BTCPayServer/Extensions/UrlHelperExtensions.cs||BTCPayServer/Extensions/UrlHelperExtensions.cs": [
      "File: BTCPayServer/Extensions/UrlHelperExtensions.cs -> BTCPayServer/Extensions/UrlHelperExtensions.cs",
      "--- Hunk 1 ---",
      "[Context before]",
      "2: using BTCPayServer;",
      "3: using BTCPayServer.Client.Models;",
      "4: using BTCPayServer.Controllers;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "2: using System;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "10: {",
      "11:     public static class UrlHelperExtensions",
      "12:     {",
      "13:         public static string EmailConfirmationLink(this LinkGenerator urlHelper, string userId, string code, string scheme, HostString host, string pathbase)",
      "14:         {",
      "15:             return urlHelper.GetUriByAction(nameof(UIAccountController.ConfirmEmail), \"UIAccount\",",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #nullable enable",
      "15:         public static string? EnsureLocal(this IUrlHelper helper, string? url, HttpRequest? httpRequest = null)",
      "16:         {",
      "17:             if (url is null || helper.IsLocalUrl(url))",
      "18:                 return url;",
      "19:             if (httpRequest is null)",
      "20:                 return null;",
      "21:             if (Uri.TryCreate(url, UriKind.Absolute, out var r) && r.Host.Equals(httpRequest.Host.Host))",
      "22:                 return url;",
      "23:             return null;",
      "24:         }",
      "25: #nullable restore",
      "",
      "---------------"
    ],
    "BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs||BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs": [
      "File: BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs -> BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: using System.Collections.Generic;",
      "2: using System.ComponentModel.DataAnnotations;",
      "3: using Microsoft.AspNetCore.Http;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: using System;",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "17:         public string[] Words",
      "18:         {",
      "20:         }",
      "21:     }",
      "22: }",
      "",
      "[Removed Lines]",
      "19:             get => Mnemonic.Split((char[])null, System.StringSplitOptions.RemoveEmptyEntries);",
      "",
      "[Added Lines]",
      "20:             get => Mnemonic?.Split((char[])null, System.StringSplitOptions.RemoveEmptyEntries) ?? Array.Empty<string>();",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/Shared/ConfirmModal.cshtml||BTCPayServer/Views/Shared/ConfirmModal.cshtml": [
      "File: BTCPayServer/Views/Shared/ConfirmModal.cshtml -> BTCPayServer/Views/Shared/ConfirmModal.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "33:         @if (!string.IsNullOrEmpty(Model.Action))",
      "34:         {",
      "36:                 <div class=\"modal-body pt-0\" id=\"ConfirmText\" hidden>",
      "37:                     <label for=\"ConfirmInput\" class=\"form-label\">Confirm the action by typing <strong id=\"ConfirmInputText\"></strong>:</label>",
      "38:                     <input id=\"ConfirmInput\" class=\"form-control\"/>",
      "",
      "[Removed Lines]",
      "35:             <form id=\"ConfirmForm\" method=\"post\" action=\"@actionUrl\" rel=\"noreferrer noopener\">",
      "",
      "[Added Lines]",
      "35:             <form id=\"ConfirmForm\" method=\"post\" action=\"@Url.EnsureLocal(actionUrl)\" rel=\"noreferrer noopener\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/Shared/PostRedirect.cshtml||BTCPayServer/Views/Shared/PostRedirect.cshtml": [
      "File: BTCPayServer/Views/Shared/PostRedirect.cshtml -> BTCPayServer/Views/Shared/PostRedirect.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "38:  }",
      "39:  else",
      "40:  {",
      "42:    @Html.AntiForgeryToken()",
      "43:    @foreach (var o in Model.FormParameters)",
      "44:    {",
      "",
      "[Removed Lines]",
      "41:   <form method=\"post\" id=\"postform\" action=\"@Model.FormUrl\" rel=\"noreferrer noopener\">",
      "",
      "[Added Lines]",
      "41:   <form method=\"post\" id=\"postform\" action=\"@Url.EnsureLocal(Model.FormUrl, this.Context.Request)\" rel=\"noreferrer noopener\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml||BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml": [
      "File: BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml -> BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "73:         </div>",
      "74:         @if (Model.RequireConfirm)",
      "75:         {",
      "77:                 <label class=\"form-check-label lead order-2\" for=\"confirm\">I have written down my recovery phrase and stored it in a secure location</label>",
      "78:                 <input type=\"checkbox\" class=\"me-3 order-1 form-check-input\" id=\"confirm\" style=\"margin-top:.35rem;flex-shrink:0\">",
      "79:                 <button type=\"submit\" class=\"btn btn-primary btn-lg px-5 order-3\" id=\"submit\">Done</button>",
      "",
      "[Removed Lines]",
      "76:             <form id=\"RecoveryConfirmation\" action=\"@Model.ReturnUrl\" class=\"position-relative d-flex align-items-start justify-content-center\" style=\"margin-top:4rem;padding-bottom: 80px\" rel=\"noreferrer noopener\">",
      "",
      "[Added Lines]",
      "76:             <form id=\"RecoveryConfirmation\" action=\"@Url.EnsureLocal(Model.ReturnUrl)\" class=\"position-relative d-flex align-items-start justify-content-center\" style=\"margin-top:4rem;padding-bottom: 80px\" rel=\"noreferrer noopener\">",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "82:         }",
      "83:         else",
      "84:         {",
      "86:         }",
      "87:     </div>",
      "88: </div>",
      "",
      "[Removed Lines]",
      "85:             <a href=\"@Model.ReturnUrl\" class=\"btn btn-primary btn-lg mt-3 px-5 order-3\" id=\"proceed\" rel=\"noreferrer noopener\">Done</a>",
      "",
      "[Added Lines]",
      "85:             <a href=\"@Url.EnsureLocal(Model.ReturnUrl)\" class=\"btn btn-primary btn-lg mt-3 px-5 order-3\" id=\"proceed\" rel=\"noreferrer noopener\">Done</a>",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIStores/WalletSettings.cshtml||BTCPayServer/Views/UIStores/WalletSettings.cshtml": [
      "File: BTCPayServer/Views/UIStores/WalletSettings.cshtml -> BTCPayServer/Views/UIStores/WalletSettings.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "52:                            data-bs-toggle=\"modal\"",
      "53:                            data-bs-target=\"#ConfirmModal\"",
      "54:                            data-title=\"Replace @Model.CryptoCode wallet\"",
      "56:                            data-confirm=\"Setup new wallet\"",
      "57:                            data-confirm-input=\"REPLACE\">",
      "58:                             Replace wallet",
      "",
      "[Removed Lines]",
      "55:                            data-description=\"@Html.Encode(ViewData[\"ReplaceDescription\"])\"",
      "",
      "[Added Lines]",
      "55:                            data-description=\"@ViewData[\"ReplaceDescription\"]\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "64:                                     data-bs-toggle=\"modal\"",
      "65:                                     data-bs-target=\"#ConfirmModal\"",
      "66:                                     data-title=\"Remove @Model.CryptoCode wallet\"",
      "68:                                     data-confirm=\"Remove\"",
      "69:                                     data-confirm-input=\"REMOVE\">Remove wallet</button>",
      "70:                         </form>",
      "",
      "[Removed Lines]",
      "67:                                     data-description=\"@Html.Encode(ViewData[\"RemoveDescription\"])\"",
      "",
      "[Added Lines]",
      "67:                                     data-description=\"@ViewData[\"RemoveDescription\"]\"",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIWallets/SignWithSeed.cshtml||BTCPayServer/Views/UIWallets/SignWithSeed.cshtml": [
      "File: BTCPayServer/Views/UIWallets/SignWithSeed.cshtml -> BTCPayServer/Views/UIWallets/SignWithSeed.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: @section Navbar {",
      "12:     @if (backUrl != null)",
      "13:     {",
      "15:             <vc:icon symbol=\"back\" />",
      "16:         </a>",
      "17:     }",
      "19:         <vc:icon symbol=\"close\" />",
      "20:     </a>",
      "21: }",
      "",
      "[Removed Lines]",
      "14:         <a href=\"@backUrl\" id=\"GoBack\">",
      "18:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "[Added Lines]",
      "14:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
      "18:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIWallets/WalletPSBT.cshtml||BTCPayServer/Views/UIWallets/WalletPSBT.cshtml": [
      "File: BTCPayServer/Views/UIWallets/WalletPSBT.cshtml -> BTCPayServer/Views/UIWallets/WalletPSBT.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: @section Navbar {",
      "12:     @if (backUrl != null)",
      "13:     {",
      "15:             <vc:icon symbol=\"back\" />",
      "16:         </a>",
      "17:     }",
      "19:         <vc:icon symbol=\"close\" />",
      "20:     </a>",
      "21: }",
      "",
      "[Removed Lines]",
      "14:         <a href=\"@backUrl\" id=\"GoBack\">",
      "18:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "[Added Lines]",
      "14:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
      "18:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml": [
      "File: BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml -> BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: @section Navbar {",
      "12:     @if (backUrl != null)",
      "13:     {",
      "15:             <vc:icon symbol=\"back\" />",
      "16:         </a>",
      "17:     }",
      "19:         <vc:icon symbol=\"close\" />",
      "20:     </a>",
      "21: }",
      "",
      "[Removed Lines]",
      "14:         <a href=\"@backUrl\" id=\"GoBack\">",
      "18:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "[Added Lines]",
      "14:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
      "18:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml": [
      "File: BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml -> BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "75: @section Navbar {",
      "76:     @if (backUrl != null)",
      "77:     {",
      "79:             <vc:icon symbol=\"back\" />",
      "80:         </a>",
      "81:     }",
      "83:         <vc:icon symbol=\"close\" />",
      "84:     </a>",
      "85: }",
      "",
      "[Removed Lines]",
      "78:         <a href=\"@backUrl\" id=\"GoBack\">",
      "82:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "[Added Lines]",
      "78:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
      "82:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIWallets/WalletReceive.cshtml||BTCPayServer/Views/UIWallets/WalletReceive.cshtml": [
      "File: BTCPayServer/Views/UIWallets/WalletReceive.cshtml -> BTCPayServer/Views/UIWallets/WalletReceive.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "2: @using BTCPayServer.Controllers",
      "3: @using BTCPayServer.Components.QRCode",
      "4: @model BTCPayServer.Controllers.WalletReceiveViewModel",
      "",
      "[Removed Lines]",
      "1: \ufeff@inject BTCPayServer.Services.BTCPayServerEnvironment env",
      "",
      "[Added Lines]",
      "1: @inject BTCPayServer.Services.BTCPayServerEnvironment env",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "15: }",
      "17: @section Navbar {",
      "19:         <vc:icon symbol=\"close\" />",
      "20:     </a>",
      "21: }",
      "",
      "[Removed Lines]",
      "18:     <a href=\"@returnUrl\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "[Added Lines]",
      "18:     <a href=\"@Url.EnsureLocal(returnUrl)\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIWallets/WalletSend.cshtml||BTCPayServer/Views/UIWallets/WalletSend.cshtml": [
      "File: BTCPayServer/Views/UIWallets/WalletSend.cshtml -> BTCPayServer/Views/UIWallets/WalletSend.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "14: @section Navbar {",
      "15:     @if (backUrl != null)",
      "16:     {",
      "18:             <vc:icon symbol=\"back\" />",
      "19:         </a>",
      "20:     }",
      "22:         <vc:icon symbol=\"close\" />",
      "23:     </a>",
      "24: }",
      "",
      "[Removed Lines]",
      "17:         <a href=\"@backUrl\" id=\"GoBack\">",
      "21:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "[Added Lines]",
      "17:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
      "21:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIWallets/WalletSendVault.cshtml||BTCPayServer/Views/UIWallets/WalletSendVault.cshtml": [
      "File: BTCPayServer/Views/UIWallets/WalletSendVault.cshtml -> BTCPayServer/Views/UIWallets/WalletSendVault.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: @section Navbar {",
      "12:     @if (backUrl != null)",
      "13:     {",
      "15:             <vc:icon symbol=\"back\" />",
      "16:         </a>",
      "17:     }",
      "19:         <vc:icon symbol=\"close\" />",
      "20:     </a>",
      "21: }",
      "",
      "[Removed Lines]",
      "14:         <a href=\"@backUrl\" id=\"GoBack\">",
      "18:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "[Added Lines]",
      "14:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
      "18:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "---------------"
    ],
    "BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml||BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml": [
      "File: BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml -> BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml",
      "--- Hunk 1 ---",
      "[Context before]",
      "12: @section Navbar {",
      "13:     @if (backUrl != null)",
      "14:     {",
      "16:             <vc:icon symbol=\"back\" />",
      "17:         </a>",
      "18:     }",
      "20:         <vc:icon symbol=\"close\" />",
      "21:     </a>",
      "22: }",
      "",
      "[Removed Lines]",
      "15:         <a href=\"@backUrl\" id=\"GoBack\">",
      "19:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "[Added Lines]",
      "15:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
      "19:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f2ced20c420c827f5c2ebf1fb405b35056687914",
      "candidate_info": {
        "commit_hash": "f2ced20c420c827f5c2ebf1fb405b35056687914",
        "repo": "btcpayserver/btcpayserver",
        "commit_url": "https://github.com/btcpayserver/btcpayserver/commit/f2ced20c420c827f5c2ebf1fb405b35056687914",
        "files": [
          "BTCPayServer.Tests/SeleniumTester.cs",
          "BTCPayServer/Extensions/UrlHelperExtensions.cs",
          "BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs",
          "BTCPayServer/Views/Shared/ConfirmModal.cshtml",
          "BTCPayServer/Views/Shared/PostRedirect.cshtml",
          "BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml",
          "BTCPayServer/Views/UIStores/WalletSettings.cshtml",
          "BTCPayServer/Views/UIWallets/SignWithSeed.cshtml",
          "BTCPayServer/Views/UIWallets/WalletPSBT.cshtml",
          "BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml",
          "BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml",
          "BTCPayServer/Views/UIWallets/WalletReceive.cshtml",
          "BTCPayServer/Views/UIWallets/WalletSend.cshtml",
          "BTCPayServer/Views/UIWallets/WalletSendVault.cshtml",
          "BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml"
        ],
        "message": "Fix a bunch of open redirect (#4575)",
        "before_after_code_files": [
          "BTCPayServer.Tests/SeleniumTester.cs||BTCPayServer.Tests/SeleniumTester.cs",
          "BTCPayServer/Extensions/UrlHelperExtensions.cs||BTCPayServer/Extensions/UrlHelperExtensions.cs",
          "BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs||BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs",
          "BTCPayServer/Views/Shared/ConfirmModal.cshtml||BTCPayServer/Views/Shared/ConfirmModal.cshtml",
          "BTCPayServer/Views/Shared/PostRedirect.cshtml||BTCPayServer/Views/Shared/PostRedirect.cshtml",
          "BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml||BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml",
          "BTCPayServer/Views/UIStores/WalletSettings.cshtml||BTCPayServer/Views/UIStores/WalletSettings.cshtml",
          "BTCPayServer/Views/UIWallets/SignWithSeed.cshtml||BTCPayServer/Views/UIWallets/SignWithSeed.cshtml",
          "BTCPayServer/Views/UIWallets/WalletPSBT.cshtml||BTCPayServer/Views/UIWallets/WalletPSBT.cshtml",
          "BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml",
          "BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml",
          "BTCPayServer/Views/UIWallets/WalletReceive.cshtml||BTCPayServer/Views/UIWallets/WalletReceive.cshtml",
          "BTCPayServer/Views/UIWallets/WalletSend.cshtml||BTCPayServer/Views/UIWallets/WalletSend.cshtml",
          "BTCPayServer/Views/UIWallets/WalletSendVault.cshtml||BTCPayServer/Views/UIWallets/WalletSendVault.cshtml",
          "BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml||BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/btcpayserver/btcpayserver/pull/4575"
        ],
        "olp_code_files": {
          "patch": [
            "BTCPayServer.Tests/SeleniumTester.cs||BTCPayServer.Tests/SeleniumTester.cs",
            "BTCPayServer/Extensions/UrlHelperExtensions.cs||BTCPayServer/Extensions/UrlHelperExtensions.cs",
            "BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs||BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs",
            "BTCPayServer/Views/Shared/ConfirmModal.cshtml||BTCPayServer/Views/Shared/ConfirmModal.cshtml",
            "BTCPayServer/Views/Shared/PostRedirect.cshtml||BTCPayServer/Views/Shared/PostRedirect.cshtml",
            "BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml||BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml",
            "BTCPayServer/Views/UIStores/WalletSettings.cshtml||BTCPayServer/Views/UIStores/WalletSettings.cshtml",
            "BTCPayServer/Views/UIWallets/SignWithSeed.cshtml||BTCPayServer/Views/UIWallets/SignWithSeed.cshtml",
            "BTCPayServer/Views/UIWallets/WalletPSBT.cshtml||BTCPayServer/Views/UIWallets/WalletPSBT.cshtml",
            "BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml",
            "BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml",
            "BTCPayServer/Views/UIWallets/WalletReceive.cshtml||BTCPayServer/Views/UIWallets/WalletReceive.cshtml",
            "BTCPayServer/Views/UIWallets/WalletSend.cshtml||BTCPayServer/Views/UIWallets/WalletSend.cshtml",
            "BTCPayServer/Views/UIWallets/WalletSendVault.cshtml||BTCPayServer/Views/UIWallets/WalletSendVault.cshtml",
            "BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml||BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml"
          ],
          "candidate": [
            "BTCPayServer.Tests/SeleniumTester.cs||BTCPayServer.Tests/SeleniumTester.cs",
            "BTCPayServer/Extensions/UrlHelperExtensions.cs||BTCPayServer/Extensions/UrlHelperExtensions.cs",
            "BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs||BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs",
            "BTCPayServer/Views/Shared/ConfirmModal.cshtml||BTCPayServer/Views/Shared/ConfirmModal.cshtml",
            "BTCPayServer/Views/Shared/PostRedirect.cshtml||BTCPayServer/Views/Shared/PostRedirect.cshtml",
            "BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml||BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml",
            "BTCPayServer/Views/UIStores/WalletSettings.cshtml||BTCPayServer/Views/UIStores/WalletSettings.cshtml",
            "BTCPayServer/Views/UIWallets/SignWithSeed.cshtml||BTCPayServer/Views/UIWallets/SignWithSeed.cshtml",
            "BTCPayServer/Views/UIWallets/WalletPSBT.cshtml||BTCPayServer/Views/UIWallets/WalletPSBT.cshtml",
            "BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml",
            "BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml",
            "BTCPayServer/Views/UIWallets/WalletReceive.cshtml||BTCPayServer/Views/UIWallets/WalletReceive.cshtml",
            "BTCPayServer/Views/UIWallets/WalletSend.cshtml||BTCPayServer/Views/UIWallets/WalletSend.cshtml",
            "BTCPayServer/Views/UIWallets/WalletSendVault.cshtml||BTCPayServer/Views/UIWallets/WalletSendVault.cshtml",
            "BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml||BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml"
          ]
        }
      },
      "candidate_diff": {
        "BTCPayServer.Tests/SeleniumTester.cs||BTCPayServer.Tests/SeleniumTester.cs": [
          "File: BTCPayServer.Tests/SeleniumTester.cs -> BTCPayServer.Tests/SeleniumTester.cs"
        ],
        "BTCPayServer/Extensions/UrlHelperExtensions.cs||BTCPayServer/Extensions/UrlHelperExtensions.cs": [
          "File: BTCPayServer/Extensions/UrlHelperExtensions.cs -> BTCPayServer/Extensions/UrlHelperExtensions.cs",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: using BTCPayServer;",
          "3: using BTCPayServer.Client.Models;",
          "4: using BTCPayServer.Controllers;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "2: using System;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "10: {",
          "11:     public static class UrlHelperExtensions",
          "12:     {",
          "13:         public static string EmailConfirmationLink(this LinkGenerator urlHelper, string userId, string code, string scheme, HostString host, string pathbase)",
          "14:         {",
          "15:             return urlHelper.GetUriByAction(nameof(UIAccountController.ConfirmEmail), \"UIAccount\",",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #nullable enable",
          "15:         public static string? EnsureLocal(this IUrlHelper helper, string? url, HttpRequest? httpRequest = null)",
          "16:         {",
          "17:             if (url is null || helper.IsLocalUrl(url))",
          "18:                 return url;",
          "19:             if (httpRequest is null)",
          "20:                 return null;",
          "21:             if (Uri.TryCreate(url, UriKind.Absolute, out var r) && r.Host.Equals(httpRequest.Host.Host))",
          "22:                 return url;",
          "23:             return null;",
          "24:         }",
          "25: #nullable restore",
          "",
          "---------------"
        ],
        "BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs||BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs": [
          "File: BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs -> BTCPayServer/Models/StoreViewModels/RecoverySeedBackupViewModel.cs",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: using System.Collections.Generic;",
          "2: using System.ComponentModel.DataAnnotations;",
          "3: using Microsoft.AspNetCore.Http;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: using System;",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "17:         public string[] Words",
          "18:         {",
          "20:         }",
          "21:     }",
          "22: }",
          "",
          "[Removed Lines]",
          "19:             get => Mnemonic.Split((char[])null, System.StringSplitOptions.RemoveEmptyEntries);",
          "",
          "[Added Lines]",
          "20:             get => Mnemonic?.Split((char[])null, System.StringSplitOptions.RemoveEmptyEntries) ?? Array.Empty<string>();",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/Shared/ConfirmModal.cshtml||BTCPayServer/Views/Shared/ConfirmModal.cshtml": [
          "File: BTCPayServer/Views/Shared/ConfirmModal.cshtml -> BTCPayServer/Views/Shared/ConfirmModal.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "33:         @if (!string.IsNullOrEmpty(Model.Action))",
          "34:         {",
          "36:                 <div class=\"modal-body pt-0\" id=\"ConfirmText\" hidden>",
          "37:                     <label for=\"ConfirmInput\" class=\"form-label\">Confirm the action by typing <strong id=\"ConfirmInputText\"></strong>:</label>",
          "38:                     <input id=\"ConfirmInput\" class=\"form-control\"/>",
          "",
          "[Removed Lines]",
          "35:             <form id=\"ConfirmForm\" method=\"post\" action=\"@actionUrl\" rel=\"noreferrer noopener\">",
          "",
          "[Added Lines]",
          "35:             <form id=\"ConfirmForm\" method=\"post\" action=\"@Url.EnsureLocal(actionUrl)\" rel=\"noreferrer noopener\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/Shared/PostRedirect.cshtml||BTCPayServer/Views/Shared/PostRedirect.cshtml": [
          "File: BTCPayServer/Views/Shared/PostRedirect.cshtml -> BTCPayServer/Views/Shared/PostRedirect.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "38:  }",
          "39:  else",
          "40:  {",
          "42:    @Html.AntiForgeryToken()",
          "43:    @foreach (var o in Model.FormParameters)",
          "44:    {",
          "",
          "[Removed Lines]",
          "41:   <form method=\"post\" id=\"postform\" action=\"@Model.FormUrl\" rel=\"noreferrer noopener\">",
          "",
          "[Added Lines]",
          "41:   <form method=\"post\" id=\"postform\" action=\"@Url.EnsureLocal(Model.FormUrl, this.Context.Request)\" rel=\"noreferrer noopener\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml||BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml": [
          "File: BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml -> BTCPayServer/Views/UIHome/RecoverySeedBackup.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "73:         </div>",
          "74:         @if (Model.RequireConfirm)",
          "75:         {",
          "77:                 <label class=\"form-check-label lead order-2\" for=\"confirm\">I have written down my recovery phrase and stored it in a secure location</label>",
          "78:                 <input type=\"checkbox\" class=\"me-3 order-1 form-check-input\" id=\"confirm\" style=\"margin-top:.35rem;flex-shrink:0\">",
          "79:                 <button type=\"submit\" class=\"btn btn-primary btn-lg px-5 order-3\" id=\"submit\">Done</button>",
          "",
          "[Removed Lines]",
          "76:             <form id=\"RecoveryConfirmation\" action=\"@Model.ReturnUrl\" class=\"position-relative d-flex align-items-start justify-content-center\" style=\"margin-top:4rem;padding-bottom: 80px\" rel=\"noreferrer noopener\">",
          "",
          "[Added Lines]",
          "76:             <form id=\"RecoveryConfirmation\" action=\"@Url.EnsureLocal(Model.ReturnUrl)\" class=\"position-relative d-flex align-items-start justify-content-center\" style=\"margin-top:4rem;padding-bottom: 80px\" rel=\"noreferrer noopener\">",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "82:         }",
          "83:         else",
          "84:         {",
          "86:         }",
          "87:     </div>",
          "88: </div>",
          "",
          "[Removed Lines]",
          "85:             <a href=\"@Model.ReturnUrl\" class=\"btn btn-primary btn-lg mt-3 px-5 order-3\" id=\"proceed\" rel=\"noreferrer noopener\">Done</a>",
          "",
          "[Added Lines]",
          "85:             <a href=\"@Url.EnsureLocal(Model.ReturnUrl)\" class=\"btn btn-primary btn-lg mt-3 px-5 order-3\" id=\"proceed\" rel=\"noreferrer noopener\">Done</a>",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIStores/WalletSettings.cshtml||BTCPayServer/Views/UIStores/WalletSettings.cshtml": [
          "File: BTCPayServer/Views/UIStores/WalletSettings.cshtml -> BTCPayServer/Views/UIStores/WalletSettings.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "52:                            data-bs-toggle=\"modal\"",
          "53:                            data-bs-target=\"#ConfirmModal\"",
          "54:                            data-title=\"Replace @Model.CryptoCode wallet\"",
          "56:                            data-confirm=\"Setup new wallet\"",
          "57:                            data-confirm-input=\"REPLACE\">",
          "58:                             Replace wallet",
          "",
          "[Removed Lines]",
          "55:                            data-description=\"@Html.Encode(ViewData[\"ReplaceDescription\"])\"",
          "",
          "[Added Lines]",
          "55:                            data-description=\"@ViewData[\"ReplaceDescription\"]\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "64:                                     data-bs-toggle=\"modal\"",
          "65:                                     data-bs-target=\"#ConfirmModal\"",
          "66:                                     data-title=\"Remove @Model.CryptoCode wallet\"",
          "68:                                     data-confirm=\"Remove\"",
          "69:                                     data-confirm-input=\"REMOVE\">Remove wallet</button>",
          "70:                         </form>",
          "",
          "[Removed Lines]",
          "67:                                     data-description=\"@Html.Encode(ViewData[\"RemoveDescription\"])\"",
          "",
          "[Added Lines]",
          "67:                                     data-description=\"@ViewData[\"RemoveDescription\"]\"",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIWallets/SignWithSeed.cshtml||BTCPayServer/Views/UIWallets/SignWithSeed.cshtml": [
          "File: BTCPayServer/Views/UIWallets/SignWithSeed.cshtml -> BTCPayServer/Views/UIWallets/SignWithSeed.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: @section Navbar {",
          "12:     @if (backUrl != null)",
          "13:     {",
          "15:             <vc:icon symbol=\"back\" />",
          "16:         </a>",
          "17:     }",
          "19:         <vc:icon symbol=\"close\" />",
          "20:     </a>",
          "21: }",
          "",
          "[Removed Lines]",
          "14:         <a href=\"@backUrl\" id=\"GoBack\">",
          "18:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "[Added Lines]",
          "14:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
          "18:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIWallets/WalletPSBT.cshtml||BTCPayServer/Views/UIWallets/WalletPSBT.cshtml": [
          "File: BTCPayServer/Views/UIWallets/WalletPSBT.cshtml -> BTCPayServer/Views/UIWallets/WalletPSBT.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: @section Navbar {",
          "12:     @if (backUrl != null)",
          "13:     {",
          "15:             <vc:icon symbol=\"back\" />",
          "16:         </a>",
          "17:     }",
          "19:         <vc:icon symbol=\"close\" />",
          "20:     </a>",
          "21: }",
          "",
          "[Removed Lines]",
          "14:         <a href=\"@backUrl\" id=\"GoBack\">",
          "18:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "[Added Lines]",
          "14:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
          "18:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml": [
          "File: BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml -> BTCPayServer/Views/UIWallets/WalletPSBTCombine.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: @section Navbar {",
          "12:     @if (backUrl != null)",
          "13:     {",
          "15:             <vc:icon symbol=\"back\" />",
          "16:         </a>",
          "17:     }",
          "19:         <vc:icon symbol=\"close\" />",
          "20:     </a>",
          "21: }",
          "",
          "[Removed Lines]",
          "14:         <a href=\"@backUrl\" id=\"GoBack\">",
          "18:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "[Added Lines]",
          "14:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
          "18:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml||BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml": [
          "File: BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml -> BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "75: @section Navbar {",
          "76:     @if (backUrl != null)",
          "77:     {",
          "79:             <vc:icon symbol=\"back\" />",
          "80:         </a>",
          "81:     }",
          "83:         <vc:icon symbol=\"close\" />",
          "84:     </a>",
          "85: }",
          "",
          "[Removed Lines]",
          "78:         <a href=\"@backUrl\" id=\"GoBack\">",
          "82:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "[Added Lines]",
          "78:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
          "82:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIWallets/WalletReceive.cshtml||BTCPayServer/Views/UIWallets/WalletReceive.cshtml": [
          "File: BTCPayServer/Views/UIWallets/WalletReceive.cshtml -> BTCPayServer/Views/UIWallets/WalletReceive.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: @using BTCPayServer.Controllers",
          "3: @using BTCPayServer.Components.QRCode",
          "4: @model BTCPayServer.Controllers.WalletReceiveViewModel",
          "",
          "[Removed Lines]",
          "1: \ufeff@inject BTCPayServer.Services.BTCPayServerEnvironment env",
          "",
          "[Added Lines]",
          "1: @inject BTCPayServer.Services.BTCPayServerEnvironment env",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "15: }",
          "17: @section Navbar {",
          "19:         <vc:icon symbol=\"close\" />",
          "20:     </a>",
          "21: }",
          "",
          "[Removed Lines]",
          "18:     <a href=\"@returnUrl\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "[Added Lines]",
          "18:     <a href=\"@Url.EnsureLocal(returnUrl)\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIWallets/WalletSend.cshtml||BTCPayServer/Views/UIWallets/WalletSend.cshtml": [
          "File: BTCPayServer/Views/UIWallets/WalletSend.cshtml -> BTCPayServer/Views/UIWallets/WalletSend.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: @section Navbar {",
          "15:     @if (backUrl != null)",
          "16:     {",
          "18:             <vc:icon symbol=\"back\" />",
          "19:         </a>",
          "20:     }",
          "22:         <vc:icon symbol=\"close\" />",
          "23:     </a>",
          "24: }",
          "",
          "[Removed Lines]",
          "17:         <a href=\"@backUrl\" id=\"GoBack\">",
          "21:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "[Added Lines]",
          "17:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
          "21:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIWallets/WalletSendVault.cshtml||BTCPayServer/Views/UIWallets/WalletSendVault.cshtml": [
          "File: BTCPayServer/Views/UIWallets/WalletSendVault.cshtml -> BTCPayServer/Views/UIWallets/WalletSendVault.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: @section Navbar {",
          "12:     @if (backUrl != null)",
          "13:     {",
          "15:             <vc:icon symbol=\"back\" />",
          "16:         </a>",
          "17:     }",
          "19:         <vc:icon symbol=\"close\" />",
          "20:     </a>",
          "21: }",
          "",
          "[Removed Lines]",
          "14:         <a href=\"@backUrl\" id=\"GoBack\">",
          "18:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "[Added Lines]",
          "14:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
          "18:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "---------------"
        ],
        "BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml||BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml": [
          "File: BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml -> BTCPayServer/Views/UIWallets/WalletSigningOptions.cshtml",
          "--- Hunk 1 ---",
          "[Context before]",
          "12: @section Navbar {",
          "13:     @if (backUrl != null)",
          "14:     {",
          "16:             <vc:icon symbol=\"back\" />",
          "17:         </a>",
          "18:     }",
          "20:         <vc:icon symbol=\"close\" />",
          "21:     </a>",
          "22: }",
          "",
          "[Removed Lines]",
          "15:         <a href=\"@backUrl\" id=\"GoBack\">",
          "19:     <a href=\"@cancelUrl\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "[Added Lines]",
          "15:         <a href=\"@Url.EnsureLocal(backUrl)\" id=\"GoBack\">",
          "19:     <a href=\"@Url.EnsureLocal(cancelUrl)\" id=\"CancelWizard\" class=\"cancel\">",
          "",
          "---------------"
        ]
      }
    }
  ]
}