{
  "cve_id": "CVE-2024-28181",
  "cve_desc": " turbo_boost-commands is a set of commands to help you build robust reactive applications with Rails & Hotwire. TurboBoost Commands has existing protections in place to guarantee that only public methods on Command classes can be invoked; however, the existing checks aren't as robust as they should be. It's possible for a sophisticated attacker to invoke more methods than should be permitted depending on the the strictness of authorization checks that individual applications enforce. Being able to call some of these methods can have security implications. Commands verify that the class must be a `Command` and that the method requested is defined as a public method; however, this isn't robust enough to guard against all unwanted code execution. The library should more strictly enforce which methods are considered safe before allowing them to be executed. This issue has been addressed in versions 0.1.3, and 0.2.2. Users are advised to upgrade. Users unable to upgrade should see the repository GHSA for workaround advice.",
  "repo": "hopsoft/turbo_boost-commands",
  "patch_hash": "88af4fc0ac39cc1799d16c49fab52f6dfbcec9ba",
  "patch_info": {
    "commit_hash": "88af4fc0ac39cc1799d16c49fab52f6dfbcec9ba",
    "repo": "hopsoft/turbo_boost-commands",
    "commit_url": "https://github.com/hopsoft/turbo_boost-commands/commit/88af4fc0ac39cc1799d16c49fab52f6dfbcec9ba",
    "files": [
      "lib/turbo_boost/commands/runner.rb"
    ],
    "message": "Merge pull request from GHSA-mp76-7w5v-pr75",
    "before_after_code_files": [
      "lib/turbo_boost/commands/runner.rb||lib/turbo_boost/commands/runner.rb"
    ]
  },
  "patch_diff": {
    "lib/turbo_boost/commands/runner.rb||lib/turbo_boost/commands/runner.rb": [
      "File: lib/turbo_boost/commands/runner.rb -> lib/turbo_boost/commands/runner.rb",
      "--- Hunk 1 ---",
      "[Context before]",
      "40:     end",
      "42:     # validate method",
      "44:       raise TurboBoost::Commands::InvalidMethodError,",
      "45:         \"`#{command_class_name}` does not define the public method `#{command_method_name}`!\"",
      "46:     end",
      "",
      "[Removed Lines]",
      "43:     unless command_instance.respond_to?(command_method_name)",
      "",
      "[Added Lines]",
      "43:     ancestors = command_class.ancestors[0..command_class.ancestors.index(TurboBoost::Commands::Command) - 1]",
      "44:     unless ancestors.any? { |a| a.public_instance_methods(false).any? command_method_name.to_sym }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "337cda7d9222f1f449905454a7374222017a7477",
      "candidate_info": {
        "commit_hash": "337cda7d9222f1f449905454a7374222017a7477",
        "repo": "hopsoft/turbo_boost-commands",
        "commit_url": "https://github.com/hopsoft/turbo_boost-commands/commit/337cda7d9222f1f449905454a7374222017a7477",
        "files": [
          "lib/turbo_boost/commands/runner.rb"
        ],
        "message": "Merge pull request from GHSA-mp76-7w5v-pr75",
        "before_after_code_files": [
          "lib/turbo_boost/commands/runner.rb||lib/turbo_boost/commands/runner.rb"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "lib/turbo_boost/commands/runner.rb||lib/turbo_boost/commands/runner.rb"
          ],
          "candidate": [
            "lib/turbo_boost/commands/runner.rb||lib/turbo_boost/commands/runner.rb"
          ]
        }
      },
      "candidate_diff": {
        "lib/turbo_boost/commands/runner.rb||lib/turbo_boost/commands/runner.rb": [
          "File: lib/turbo_boost/commands/runner.rb -> lib/turbo_boost/commands/runner.rb",
          "--- Hunk 1 ---",
          "[Context before]",
          "38:     end",
          "40:     # validate method",
          "42:       raise TurboBoost::Commands::InvalidMethodError,",
          "43:         \"`#{command_class_name}` does not define the public method `#{command_method_name}`!\"",
          "44:     end",
          "",
          "[Removed Lines]",
          "41:     unless command_instance.respond_to?(command_method_name)",
          "",
          "[Added Lines]",
          "41:     ancestors = command_class.ancestors[0..command_class.ancestors.index(TurboBoost::Commands::Command) - 1]",
          "42:     unless ancestors.any? { |a| a.public_instance_methods(false).any? command_method_name.to_sym }",
          "",
          "---------------"
        ]
      }
    }
  ]
}