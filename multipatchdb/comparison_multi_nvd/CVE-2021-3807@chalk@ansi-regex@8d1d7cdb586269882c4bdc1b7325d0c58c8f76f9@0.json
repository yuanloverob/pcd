{
  "cve_id": "CVE-2021-3807",
  "cve_desc": "ansi-regex is vulnerable to Inefficient Regular Expression Complexity",
  "repo": "chalk/ansi-regex",
  "patch_hash": "8d1d7cdb586269882c4bdc1b7325d0c58c8f76f9",
  "patch_info": {
    "commit_hash": "8d1d7cdb586269882c4bdc1b7325d0c58c8f76f9",
    "repo": "chalk/ansi-regex",
    "commit_url": "https://github.com/chalk/ansi-regex/commit/8d1d7cdb586269882c4bdc1b7325d0c58c8f76f9",
    "files": [
      "index.js"
    ],
    "message": "Fix potential ReDoS (#37)",
    "before_after_code_files": [
      "index.js||index.js"
    ]
  },
  "patch_diff": {
    "index.js||index.js": [
      "File: index.js -> index.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: export default function ansiRegex({onlyFirst = false} = {}) {",
      "2:  const pattern = [",
      "4:   '(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-ntqry=><~]))'",
      "5:  ].join('|');",
      "",
      "[Removed Lines]",
      "3:   '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:[a-zA-Z\\\\d]*(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',",
      "",
      "[Added Lines]",
      "3:      '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "a28b8e7ee67aa9996ba44bf123f0436eea62d285",
      "candidate_info": {
        "commit_hash": "a28b8e7ee67aa9996ba44bf123f0436eea62d285",
        "repo": "chalk/ansi-regex",
        "commit_url": "https://github.com/chalk/ansi-regex/commit/a28b8e7ee67aa9996ba44bf123f0436eea62d285",
        "files": [
          "index.js"
        ],
        "message": "fix incorrect format",
        "before_after_code_files": [
          "index.js||index.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "index.js||index.js"
          ],
          "candidate": [
            "index.js||index.js"
          ]
        }
      },
      "candidate_diff": {
        "index.js||index.js": [
          "File: index.js -> index.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: export default function ansiRegex({onlyFirst = false} = {}) {",
          "2:  const pattern = [",
          "4:   '(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-ntqry=><~]))'",
          "5:  ].join('|');",
          "",
          "[Removed Lines]",
          "3:      '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',",
          "",
          "[Added Lines]",
          "3:   '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "75a657da7af875b2e2724fd6331bf0a4b23d3c9a",
      "candidate_info": {
        "commit_hash": "75a657da7af875b2e2724fd6331bf0a4b23d3c9a",
        "repo": "chalk/ansi-regex",
        "commit_url": "https://github.com/chalk/ansi-regex/commit/75a657da7af875b2e2724fd6331bf0a4b23d3c9a",
        "files": [
          "index.js"
        ],
        "message": "Fix potential ReDoS (#37)",
        "before_after_code_files": [
          "index.js||index.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "index.js||index.js"
          ],
          "candidate": [
            "index.js||index.js"
          ]
        }
      },
      "candidate_diff": {
        "index.js||index.js": [
          "File: index.js -> index.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "6:  }, options);",
          "8:  const pattern = [",
          "10:   '(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-ntqry=><~]))'",
          "11:  ].join('|');",
          "",
          "[Removed Lines]",
          "9:   '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:[a-zA-Z\\\\d]*(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',",
          "",
          "[Added Lines]",
          "9:   '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "c3c0b3f2736b9c01feec0fef33980c43720dcde8",
      "candidate_info": {
        "commit_hash": "c3c0b3f2736b9c01feec0fef33980c43720dcde8",
        "repo": "chalk/ansi-regex",
        "commit_url": "https://github.com/chalk/ansi-regex/commit/c3c0b3f2736b9c01feec0fef33980c43720dcde8",
        "files": [
          "index.js"
        ],
        "message": "Fix potential ReDoS (#37)",
        "before_after_code_files": [
          "index.js||index.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "index.js||index.js"
          ],
          "candidate": [
            "index.js||index.js"
          ]
        }
      },
      "candidate_diff": {
        "index.js||index.js": [
          "File: index.js -> index.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: module.exports = ({onlyFirst = false} = {}) => {",
          "4:  const pattern = [",
          "6:   '(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-ntqry=><~]))'",
          "7:  ].join('|');",
          "",
          "[Removed Lines]",
          "5:   '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:[a-zA-Z\\\\d]*(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',",
          "",
          "[Added Lines]",
          "5:      '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "419250fa510bf31b4cc672e76537a64f9332e1f1",
      "candidate_info": {
        "commit_hash": "419250fa510bf31b4cc672e76537a64f9332e1f1",
        "repo": "chalk/ansi-regex",
        "commit_url": "https://github.com/chalk/ansi-regex/commit/419250fa510bf31b4cc672e76537a64f9332e1f1",
        "files": [
          "index.js"
        ],
        "message": "Fix potential ReDoS (#37)",
        "before_after_code_files": [
          "index.js||index.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "index.js||index.js"
          ],
          "candidate": [
            "index.js||index.js"
          ]
        }
      },
      "candidate_diff": {
        "index.js||index.js": [
          "File: index.js -> index.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "3: module.exports = () => {",
          "4:  const pattern = [",
          "6:   '(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PRZcf-ntqry=><~]))'",
          "7:  ].join('|');",
          "",
          "[Removed Lines]",
          "5:   '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:[a-zA-Z\\\\d]*(?:;[a-zA-Z\\\\d]*)*)?\\\\u0007)',",
          "",
          "[Added Lines]",
          "5:   '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]+)*|[a-zA-Z\\\\d]+(?:;[a-zA-Z\\\\d]*)*)?\\\\u0007)',",
          "",
          "---------------"
        ]
      }
    }
  ]
}