{
  "cve_id": "CVE-2017-9841",
  "cve_desc": "Util/PHP/eval-stdin.php in PHPUnit before 4.8.28 and 5.x before 5.6.3 allows remote attackers to execute arbitrary PHP code via HTTP POST data beginning with a \"<?php \" substring, as demonstrated by an attack on a site with an exposed /vendor folder, i.e., external access to the /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI.",
  "repo": "sebastianbergmann/phpunit",
  "patch_hash": "284a69fb88a2d0845d23f42974a583d8f59bf5a5",
  "patch_info": {
    "commit_hash": "284a69fb88a2d0845d23f42974a583d8f59bf5a5",
    "repo": "sebastianbergmann/phpunit",
    "commit_url": "https://github.com/sebastianbergmann/phpunit/commit/284a69fb88a2d0845d23f42974a583d8f59bf5a5",
    "files": [
      "src/Util/PHP/Template/TestCaseMethod.tpl.dist",
      "src/Util/PHP/eval-stdin.php"
    ],
    "message": "Correct fix for #1956",
    "before_after_code_files": [
      "src/Util/PHP/Template/TestCaseMethod.tpl.dist||src/Util/PHP/Template/TestCaseMethod.tpl.dist",
      "src/Util/PHP/eval-stdin.php||src/Util/PHP/eval-stdin.php"
    ]
  },
  "patch_diff": {
    "src/Util/PHP/Template/TestCaseMethod.tpl.dist||src/Util/PHP/Template/TestCaseMethod.tpl.dist": [
      "File: src/Util/PHP/Template/TestCaseMethod.tpl.dist -> src/Util/PHP/Template/TestCaseMethod.tpl.dist",
      "--- Hunk 1 ---",
      "[Context before]",
      "55:         $output = $test->getActualOutput();",
      "56:     }",
      "59:     if ($stdout = stream_get_contents(STDOUT)) {",
      "60:         $output = $stdout . $output;",
      "61:     }",
      "",
      "[Removed Lines]",
      "58:     rewind(STDOUT);",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "src/Util/PHP/eval-stdin.php||src/Util/PHP/eval-stdin.php": [
      "File: src/Util/PHP/eval-stdin.php -> src/Util/PHP/eval-stdin.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: <?php",
      "",
      "[Removed Lines]",
      "3: eval('?>' . file_get_contents('php://input'));",
      "",
      "[Added Lines]",
      "3: eval('?>' . file_get_contents('php://stdin'));",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0c1ae1b5324fa10f96129c5679b788cc1ca9468e",
      "candidate_info": {
        "commit_hash": "0c1ae1b5324fa10f96129c5679b788cc1ca9468e",
        "repo": "sebastianbergmann/phpunit",
        "commit_url": "https://github.com/sebastianbergmann/phpunit/commit/0c1ae1b5324fa10f96129c5679b788cc1ca9468e",
        "files": [
          "src/Util/PHP/Template/TestCaseMethod.tpl.dist",
          "src/Util/PHP/eval-stdin.php"
        ],
        "message": "Correct fix for #1956",
        "before_after_code_files": [
          "src/Util/PHP/Template/TestCaseMethod.tpl.dist||src/Util/PHP/Template/TestCaseMethod.tpl.dist",
          "src/Util/PHP/eval-stdin.php||src/Util/PHP/eval-stdin.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [
            "src/Util/PHP/Template/TestCaseMethod.tpl.dist||src/Util/PHP/Template/TestCaseMethod.tpl.dist",
            "src/Util/PHP/eval-stdin.php||src/Util/PHP/eval-stdin.php"
          ],
          "candidate": [
            "src/Util/PHP/Template/TestCaseMethod.tpl.dist||src/Util/PHP/Template/TestCaseMethod.tpl.dist",
            "src/Util/PHP/eval-stdin.php||src/Util/PHP/eval-stdin.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Util/PHP/Template/TestCaseMethod.tpl.dist||src/Util/PHP/Template/TestCaseMethod.tpl.dist": [
          "File: src/Util/PHP/Template/TestCaseMethod.tpl.dist -> src/Util/PHP/Template/TestCaseMethod.tpl.dist",
          "--- Hunk 1 ---",
          "[Context before]",
          "58:         $output = $test->getActualOutput();",
          "59:     }",
          "62:     if ($stdout = stream_get_contents(STDOUT)) {",
          "63:         $output = $stdout . $output;",
          "64:     }",
          "",
          "[Removed Lines]",
          "61:     rewind(STDOUT);",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "src/Util/PHP/eval-stdin.php||src/Util/PHP/eval-stdin.php": [
          "File: src/Util/PHP/eval-stdin.php -> src/Util/PHP/eval-stdin.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <?php",
          "",
          "[Removed Lines]",
          "3: eval('?>' . file_get_contents('php://input'));",
          "",
          "[Added Lines]",
          "3: eval('?>' . file_get_contents('php://stdin'));",
          "",
          "---------------"
        ]
      }
    }
  ]
}