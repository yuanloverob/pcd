{
  "cve_id": "CVE-2024-36405",
  "cve_desc": "liboqs is a C-language cryptographic library that provides implementations of post-quantum cryptography algorithms. A control-flow timing lean has been identified in the reference implementation of the Kyber key encapsulation mechanism when it is compiled with Clang 15-18 for `-Os`, `-O1`, and other compilation options. A proof-of-concept local attack on the reference implementation leaks the entire ML-KEM 512 secret key in ~10 minutes using end-to-end decapsulation timing measurements. The issue has been fixed in version 0.10.1. As a possible workaround, some compiler options may produce vectorized code that does not leak secret information, however relying on these compiler options as a workaround may not be reliable.",
  "repo": "open-quantum-safe/liboqs",
  "patch_hash": "982c762c242ef549c914891b47bf6e0ed6321f91",
  "patch_info": {
    "commit_hash": "982c762c242ef549c914891b47bf6e0ed6321f91",
    "repo": "open-quantum-safe/liboqs",
    "commit_url": "https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91",
    "files": [
      "docs/algorithms/kem/kyber.md",
      "docs/algorithms/kem/kyber.yml",
      "docs/algorithms/kem/ml_kem.md",
      "docs/algorithms/kem/ml_kem.yml",
      "scripts/copy_from_upstream/copy_from_upstream.yml",
      "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c",
      "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c",
      "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c",
      "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c",
      "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c",
      "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c",
      "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h"
    ],
    "message": "Pull Kyber/ML-KEM CT-Fix from upstream\n\nSigned-off-by: Basil Hess <bhe@zurich.ibm.com>",
    "before_after_code_files": [
      "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c",
      "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c",
      "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c",
      "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c",
      "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h",
      "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c",
      "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c",
      "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c",
      "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h"
    ]
  },
  "patch_diff": {
    "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c -> src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: #include \"reduce.h\"",
      "6: #include \"cbd.h\"",
      "7: #include \"symmetric.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "8: #include \"verify.h\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "166: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
      "167: {",
      "168:   unsigned int i,j;",
      "171: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
      "172: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
      "",
      "[Removed Lines]",
      "169:   int16_t mask;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "175:   for(i=0;i<KYBER_N/8;i++) {",
      "176:     for(j=0;j<8;j++) {",
      "179:     }",
      "180:   }",
      "181: }",
      "",
      "[Removed Lines]",
      "177:       mask = -(int16_t)((msg[i] >> j)&1);",
      "178:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
      "",
      "[Added Lines]",
      "177:       r->coeffs[8*i+j] = 0;",
      "178:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c -> src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "55:   for(i=0;i<len;i++)",
      "56:     r[i] ^= b & (r[i] ^ x[i]);",
      "57: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "70: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
      "71: {",
      "72:   b = -b;",
      "74: }",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c -> src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: #include \"reduce.h\"",
      "6: #include \"cbd.h\"",
      "7: #include \"symmetric.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "8: #include \"verify.h\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "166: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
      "167: {",
      "168:   unsigned int i,j;",
      "171: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
      "172: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
      "",
      "[Removed Lines]",
      "169:   int16_t mask;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "175:   for(i=0;i<KYBER_N/8;i++) {",
      "176:     for(j=0;j<8;j++) {",
      "179:     }",
      "180:   }",
      "181: }",
      "",
      "[Removed Lines]",
      "177:       mask = -(int16_t)((msg[i] >> j)&1);",
      "178:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
      "",
      "[Added Lines]",
      "177:       r->coeffs[8*i+j] = 0;",
      "178:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c -> src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "55:   for(i=0;i<len;i++)",
      "56:     r[i] ^= b & (r[i] ^ x[i]);",
      "57: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "70: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
      "71: {",
      "72:   b = -b;",
      "74: }",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c -> src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: #include \"reduce.h\"",
      "6: #include \"cbd.h\"",
      "7: #include \"symmetric.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "8: #include \"verify.h\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "166: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
      "167: {",
      "168:   unsigned int i,j;",
      "171: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
      "172: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
      "",
      "[Removed Lines]",
      "169:   int16_t mask;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "175:   for(i=0;i<KYBER_N/8;i++) {",
      "176:     for(j=0;j<8;j++) {",
      "179:     }",
      "180:   }",
      "181: }",
      "",
      "[Removed Lines]",
      "177:       mask = -(int16_t)((msg[i] >> j)&1);",
      "178:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
      "",
      "[Added Lines]",
      "177:       r->coeffs[8*i+j] = 0;",
      "178:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c -> src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "55:   for(i=0;i<len;i++)",
      "56:     r[i] ^= b & (r[i] ^ x[i]);",
      "57: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "70: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
      "71: {",
      "72:   b = -b;",
      "74: }",
      "",
      "---------------"
    ],
    "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h": [
      "File: src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: #include \"reduce.h\"",
      "6: #include \"cbd.h\"",
      "7: #include \"symmetric.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "8: #include \"verify.h\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "167: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
      "168: {",
      "169:   unsigned int i,j;",
      "172: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
      "173: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
      "",
      "[Removed Lines]",
      "170:   int16_t mask;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "176:   for(i=0;i<KYBER_N/8;i++) {",
      "177:     for(j=0;j<8;j++) {",
      "180:     }",
      "181:   }",
      "182: }",
      "",
      "[Removed Lines]",
      "178:       mask = -(int16_t)((msg[i] >> j)&1);",
      "179:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
      "",
      "[Added Lines]",
      "178:       r->coeffs[8*i+j] = 0;",
      "179:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "45:   for(i=0;i<len;i++)",
      "46:     r[i] ^= b & (r[i] ^ x[i]);",
      "47: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "61: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
      "62: {",
      "63:   b = -b;",
      "65: }",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: #include \"reduce.h\"",
      "6: #include \"cbd.h\"",
      "7: #include \"symmetric.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "8: #include \"verify.h\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "167: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
      "168: {",
      "169:   unsigned int i,j;",
      "172: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
      "173: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
      "",
      "[Removed Lines]",
      "170:   int16_t mask;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "176:   for(i=0;i<KYBER_N/8;i++) {",
      "177:     for(j=0;j<8;j++) {",
      "180:     }",
      "181:   }",
      "182: }",
      "",
      "[Removed Lines]",
      "178:       mask = -(int16_t)((msg[i] >> j)&1);",
      "179:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
      "",
      "[Added Lines]",
      "178:       r->coeffs[8*i+j] = 0;",
      "179:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "45:   for(i=0;i<len;i++)",
      "46:     r[i] ^= b & (r[i] ^ x[i]);",
      "47: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "61: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
      "62: {",
      "63:   b = -b;",
      "65: }",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: #include \"reduce.h\"",
      "6: #include \"cbd.h\"",
      "7: #include \"symmetric.h\"",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "8: #include \"verify.h\"",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "167: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
      "168: {",
      "169:   unsigned int i,j;",
      "172: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
      "173: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
      "",
      "[Removed Lines]",
      "170:   int16_t mask;",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "176:   for(i=0;i<KYBER_N/8;i++) {",
      "177:     for(j=0;j<8;j++) {",
      "180:     }",
      "181:   }",
      "182: }",
      "",
      "[Removed Lines]",
      "178:       mask = -(int16_t)((msg[i] >> j)&1);",
      "179:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
      "",
      "[Added Lines]",
      "178:       r->coeffs[8*i+j] = 0;",
      "179:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c",
      "--- Hunk 1 ---",
      "[Context before]",
      "45:   for(i=0;i<len;i++)",
      "46:     r[i] ^= b & (r[i] ^ x[i]);",
      "47: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "61: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
      "62: {",
      "63:   b = -b;",
      "65: }",
      "",
      "---------------"
    ],
    "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h": [
      "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: #define cmov KYBER_NAMESPACE(cmov)",
      "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
      "14: #endif",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
      "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "fbfac754585d788c19b49cac569e4e2ea182f579",
      "candidate_info": {
        "commit_hash": "fbfac754585d788c19b49cac569e4e2ea182f579",
        "repo": "open-quantum-safe/liboqs",
        "commit_url": "https://github.com/open-quantum-safe/liboqs/commit/fbfac754585d788c19b49cac569e4e2ea182f579",
        "files": [
          "docs/algorithms/kem/kyber.md",
          "docs/algorithms/kem/kyber.yml",
          "docs/algorithms/kem/ml_kem.md",
          "docs/algorithms/kem/ml_kem.yml",
          "scripts/copy_from_upstream/copy_from_upstream.yml",
          "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c",
          "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c",
          "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c",
          "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c",
          "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c",
          "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c",
          "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h"
        ],
        "message": "Pull Kyber/ML-KEM CT-Fix from upstream\n\nSigned-off-by: Basil Hess <bhe@zurich.ibm.com>",
        "before_after_code_files": [
          "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c",
          "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c",
          "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c",
          "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c",
          "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h",
          "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c",
          "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c",
          "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c",
          "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c",
            "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c",
            "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c",
            "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c",
            "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c",
            "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c",
            "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h"
          ],
          "candidate": [
            "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c",
            "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c",
            "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c",
            "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c",
            "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h",
            "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c",
            "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c",
            "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c",
            "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h"
          ]
        }
      },
      "candidate_diff": {
        "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c -> src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #include \"reduce.h\"",
          "6: #include \"cbd.h\"",
          "7: #include \"symmetric.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: #include \"verify.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "166: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
          "167: {",
          "168:   unsigned int i,j;",
          "171: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
          "172: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
          "",
          "[Removed Lines]",
          "169:   int16_t mask;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "175:   for(i=0;i<KYBER_N/8;i++) {",
          "176:     for(j=0;j<8;j++) {",
          "179:     }",
          "180:   }",
          "181: }",
          "",
          "[Removed Lines]",
          "177:       mask = -(int16_t)((msg[i] >> j)&1);",
          "178:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
          "",
          "[Added Lines]",
          "177:       r->coeffs[8*i+j] = 0;",
          "178:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c -> src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "55:   for(i=0;i<len;i++)",
          "56:     r[i] ^= b & (r[i] ^ x[i]);",
          "57: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "70: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
          "71: {",
          "72:   b = -b;",
          "74: }",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c -> src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #include \"reduce.h\"",
          "6: #include \"cbd.h\"",
          "7: #include \"symmetric.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: #include \"verify.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "166: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
          "167: {",
          "168:   unsigned int i,j;",
          "171: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
          "172: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
          "",
          "[Removed Lines]",
          "169:   int16_t mask;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "175:   for(i=0;i<KYBER_N/8;i++) {",
          "176:     for(j=0;j<8;j++) {",
          "179:     }",
          "180:   }",
          "181: }",
          "",
          "[Removed Lines]",
          "177:       mask = -(int16_t)((msg[i] >> j)&1);",
          "178:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
          "",
          "[Added Lines]",
          "177:       r->coeffs[8*i+j] = 0;",
          "178:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c -> src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "55:   for(i=0;i<len;i++)",
          "56:     r[i] ^= b & (r[i] ^ x[i]);",
          "57: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "70: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
          "71: {",
          "72:   b = -b;",
          "74: }",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c -> src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #include \"reduce.h\"",
          "6: #include \"cbd.h\"",
          "7: #include \"symmetric.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: #include \"verify.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "166: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
          "167: {",
          "168:   unsigned int i,j;",
          "171: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
          "172: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
          "",
          "[Removed Lines]",
          "169:   int16_t mask;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "175:   for(i=0;i<KYBER_N/8;i++) {",
          "176:     for(j=0;j<8;j++) {",
          "179:     }",
          "180:   }",
          "181: }",
          "",
          "[Removed Lines]",
          "177:       mask = -(int16_t)((msg[i] >> j)&1);",
          "178:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
          "",
          "[Added Lines]",
          "177:       r->coeffs[8*i+j] = 0;",
          "178:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c -> src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "55:   for(i=0;i<len;i++)",
          "56:     r[i] ^= b & (r[i] ^ x[i]);",
          "57: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "70: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
          "71: {",
          "72:   b = -b;",
          "74: }",
          "",
          "---------------"
        ],
        "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h||src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h": [
          "File: src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h -> src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #include \"reduce.h\"",
          "6: #include \"cbd.h\"",
          "7: #include \"symmetric.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: #include \"verify.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "167: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
          "168: {",
          "169:   unsigned int i,j;",
          "172: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
          "173: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
          "",
          "[Removed Lines]",
          "170:   int16_t mask;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "176:   for(i=0;i<KYBER_N/8;i++) {",
          "177:     for(j=0;j<8;j++) {",
          "180:     }",
          "181:   }",
          "182: }",
          "",
          "[Removed Lines]",
          "178:       mask = -(int16_t)((msg[i] >> j)&1);",
          "179:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
          "",
          "[Added Lines]",
          "178:       r->coeffs[8*i+j] = 0;",
          "179:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "45:   for(i=0;i<len;i++)",
          "46:     r[i] ^= b & (r[i] ^ x[i]);",
          "47: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "61: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
          "62: {",
          "63:   b = -b;",
          "65: }",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #include \"reduce.h\"",
          "6: #include \"cbd.h\"",
          "7: #include \"symmetric.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: #include \"verify.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "167: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
          "168: {",
          "169:   unsigned int i,j;",
          "172: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
          "173: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
          "",
          "[Removed Lines]",
          "170:   int16_t mask;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "176:   for(i=0;i<KYBER_N/8;i++) {",
          "177:     for(j=0;j<8;j++) {",
          "180:     }",
          "181:   }",
          "182: }",
          "",
          "[Removed Lines]",
          "178:       mask = -(int16_t)((msg[i] >> j)&1);",
          "179:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
          "",
          "[Added Lines]",
          "178:       r->coeffs[8*i+j] = 0;",
          "179:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "45:   for(i=0;i<len;i++)",
          "46:     r[i] ^= b & (r[i] ^ x[i]);",
          "47: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "61: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
          "62: {",
          "63:   b = -b;",
          "65: }",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/poly.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: #include \"reduce.h\"",
          "6: #include \"cbd.h\"",
          "7: #include \"symmetric.h\"",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "8: #include \"verify.h\"",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "167: void poly_frommsg(poly *r, const uint8_t msg[KYBER_INDCPA_MSGBYTES])",
          "168: {",
          "169:   unsigned int i,j;",
          "172: #if (KYBER_INDCPA_MSGBYTES != KYBER_N/8)",
          "173: #error \"KYBER_INDCPA_MSGBYTES must be equal to KYBER_N/8 bytes!\"",
          "",
          "[Removed Lines]",
          "170:   int16_t mask;",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "176:   for(i=0;i<KYBER_N/8;i++) {",
          "177:     for(j=0;j<8;j++) {",
          "180:     }",
          "181:   }",
          "182: }",
          "",
          "[Removed Lines]",
          "178:       mask = -(int16_t)((msg[i] >> j)&1);",
          "179:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);",
          "",
          "[Added Lines]",
          "178:       r->coeffs[8*i+j] = 0;",
          "179:       cmov_int16(r->coeffs+8*i+j, ((KYBER_Q+1)/2), (msg[i] >> j)&1);",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.c",
          "--- Hunk 1 ---",
          "[Context before]",
          "45:   for(i=0;i<len;i++)",
          "46:     r[i] ^= b & (r[i] ^ x[i]);",
          "47: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "61: void cmov_int16(int16_t *r, int16_t v, uint16_t b)",
          "62: {",
          "63:   b = -b;",
          "65: }",
          "",
          "---------------"
        ],
        "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h||src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h": [
          "File: src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h -> src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_ref/verify.h",
          "--- Hunk 1 ---",
          "[Context before]",
          "11: #define cmov KYBER_NAMESPACE(cmov)",
          "12: void cmov(uint8_t *r, const uint8_t *x, size_t len, uint8_t b);",
          "14: #endif",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14: #define cmov_int16 KYBER_NAMESPACE(cmov_int16)",
          "15: void cmov_int16(int16_t *r, int16_t v, uint16_t b);",
          "",
          "---------------"
        ]
      }
    }
  ]
}