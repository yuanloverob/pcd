{
  "cve_id": "CVE-2020-8945",
  "cve_desc": "The proglottis Go wrapper before 0.1.1 for the GPGME library has a use-after-free, as demonstrated by use for container image pulls by Docker or CRI-O. This leads to a crash or potential code execution during GPG signature verification.",
  "repo": "containers/image",
  "patch_hash": "4c7a23f82ef09127b0ff28366d1cf31316dd6cc1",
  "patch_info": {
    "commit_hash": "4c7a23f82ef09127b0ff28366d1cf31316dd6cc1",
    "repo": "containers/image",
    "commit_url": "https://github.com/containers/image/commit/4c7a23f82ef09127b0ff28366d1cf31316dd6cc1",
    "files": [
      "go.mod",
      "go.sum"
    ],
    "message": "Update to github.com/mtrmac/gpgme@v0.1.1\n\nThis primarily includes https://github.com/proglottis/gpgme/pull/23 ,\nfixing use-after-free crashes.\n\nSigned-off-by: Miloslav Trma\u010d <mitr@redhat.com>",
    "before_after_code_files": [
      "go.mod||go.mod",
      "go.sum||go.sum"
    ]
  },
  "patch_diff": {
    "go.mod||go.mod": [
      "File: go.mod -> go.mod",
      "--- Hunk 1 ---",
      "[Context before]",
      "24:  github.com/konsorten/go-windows-terminal-sequences v1.0.2 // indirect",
      "25:  github.com/kr/pretty v0.1.0 // indirect",
      "26:  github.com/mattn/go-isatty v0.0.4 // indirect",
      "28:  github.com/opencontainers/go-digest v1.0.0-rc1",
      "29:  github.com/opencontainers/image-spec v1.0.2-0.20190823105129-775207bd45b6",
      "30:  github.com/opencontainers/selinux v1.3.0",
      "",
      "[Removed Lines]",
      "27:  github.com/mtrmac/gpgme v0.0.0-20170102180018-b2432428689c",
      "",
      "[Added Lines]",
      "27:  github.com/mtrmac/gpgme v0.1.1",
      "",
      "---------------"
    ],
    "go.sum||go.sum": [
      "File: go.sum -> go.sum",
      "--- Hunk 1 ---",
      "[Context before]",
      "115: github.com/mistifyio/go-zfs v2.1.1+incompatible/go.mod h1:8AuVvqP/mXw1px98n46wfvcGfQ4ci2FwoAjKYxuo3Z4=",
      "116: github.com/mtrmac/gpgme v0.0.0-20170102180018-b2432428689c h1:xa+eQWKuJ9MbB9FBL/eoNvDFvveAkz2LQoz8PzX7Q/4=",
      "117: github.com/mtrmac/gpgme v0.0.0-20170102180018-b2432428689c/go.mod h1:GhAqVMEWnTcW2dxoD/SO3n2enrgWl3y6Dnx4m59GvcA=",
      "118: github.com/opencontainers/go-digest v0.0.0-20180430190053-c9281466c8b2/go.mod h1:cMLVZDEM3+U2I4VmLI6N8jQYUd2OVphdqWwCJHrFt2s=",
      "119: github.com/opencontainers/go-digest v1.0.0-rc1 h1:WzifXhOVOEOuFYOJAW6aQqW0TooG2iki3E3Ii+WN7gQ=",
      "120: github.com/opencontainers/go-digest v1.0.0-rc1/go.mod h1:cMLVZDEM3+U2I4VmLI6N8jQYUd2OVphdqWwCJHrFt2s=",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "118: github.com/mtrmac/gpgme v0.0.0-20200118211431-ce00817b8a3f h1:Td/Gr8BXYbQ0vXQUHhkleCzd7f+WTDQdVCmlqOUwMKo=",
      "119: github.com/mtrmac/gpgme v0.0.0-20200118211431-ce00817b8a3f/go.mod h1:GYYHnGSuS7HK3zVS2n3y73y0okK/BeKzwnn5jgiVFNI=",
      "120: github.com/mtrmac/gpgme v0.1.1 h1:a5ISnvahzTzBH0m/klhehN68N+9+/jLwhpPFtH3oPAQ=",
      "121: github.com/mtrmac/gpgme v0.1.1/go.mod h1:GYYHnGSuS7HK3zVS2n3y73y0okK/BeKzwnn5jgiVFNI=",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "220: golang.org/x/sys v0.0.0-20191127021746-63cb32ae39b2/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=",
      "221: golang.org/x/text v0.3.0 h1:g61tztE5qeGQ89tm6NTjjM9VPIm088od1l6aSorWRWg=",
      "222: golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=",
      "223: golang.org/x/text v0.3.2/go.mod h1:bEr9sfX3Q8Zfm5fL9x+3itogRgK3+ptLWKqgva+5dAk=",
      "224: golang.org/x/tools v0.0.0-20180221164845-07fd8470d635/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=",
      "225: golang.org/x/tools v0.0.0-20180810170437-e96c4e24768d/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "227: golang.org/x/text v0.3.2 h1:tW2bmiBqwgJj/UpqtC8EpXEZVYOwU0yG4iWbprSVAcs=",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "e7af7efde57158634b722a18e1097cf1362fd253",
      "candidate_info": {
        "commit_hash": "e7af7efde57158634b722a18e1097cf1362fd253",
        "repo": "containers/image",
        "commit_url": "https://github.com/containers/image/commit/e7af7efde57158634b722a18e1097cf1362fd253",
        "files": [
          "go.mod",
          "go.sum"
        ],
        "message": "Bump github.com/mtrmac/gpgme from 0.1.1 to 0.1.2\n\nBumps [github.com/mtrmac/gpgme](https://github.com/mtrmac/gpgme) from 0.1.1 to 0.1.2.\n- [Release notes](https://github.com/mtrmac/gpgme/releases)\n- [Commits](https://github.com/mtrmac/gpgme/compare/v0.1.1...v0.1.2)\n\nSigned-off-by: dependabot-preview[bot] <support@dependabot.com>\nSigned-off-by: Valentin Rothberg <rothberg@redhat.com>",
        "before_after_code_files": [
          "go.mod||go.mod",
          "go.sum||go.sum"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ],
          "candidate": [
            "go.mod||go.mod",
            "go.sum||go.sum"
          ]
        }
      },
      "candidate_diff": {
        "go.mod||go.mod": [
          "File: go.mod -> go.mod",
          "--- Hunk 1 ---",
          "[Context before]",
          "24:  github.com/konsorten/go-windows-terminal-sequences v1.0.2 // indirect",
          "25:  github.com/kr/pretty v0.1.0 // indirect",
          "26:  github.com/mattn/go-isatty v0.0.4 // indirect",
          "28:  github.com/opencontainers/go-digest v1.0.0-rc1",
          "29:  github.com/opencontainers/image-spec v1.0.2-0.20190823105129-775207bd45b6",
          "30:  github.com/opencontainers/selinux v1.3.1",
          "",
          "[Removed Lines]",
          "27:  github.com/mtrmac/gpgme v0.1.1",
          "",
          "[Added Lines]",
          "27:  github.com/mtrmac/gpgme v0.1.2",
          "",
          "---------------"
        ],
        "go.sum||go.sum": [
          "File: go.sum -> go.sum",
          "--- Hunk 1 ---",
          "[Context before]",
          "130: github.com/mtrmac/gpgme v0.0.0-20200118211431-ce00817b8a3f/go.mod h1:GYYHnGSuS7HK3zVS2n3y73y0okK/BeKzwnn5jgiVFNI=",
          "131: github.com/mtrmac/gpgme v0.1.1 h1:a5ISnvahzTzBH0m/klhehN68N+9+/jLwhpPFtH3oPAQ=",
          "132: github.com/mtrmac/gpgme v0.1.1/go.mod h1:GYYHnGSuS7HK3zVS2n3y73y0okK/BeKzwnn5jgiVFNI=",
          "133: github.com/opencontainers/go-digest v0.0.0-20180430190053-c9281466c8b2/go.mod h1:cMLVZDEM3+U2I4VmLI6N8jQYUd2OVphdqWwCJHrFt2s=",
          "134: github.com/opencontainers/go-digest v1.0.0-rc1 h1:WzifXhOVOEOuFYOJAW6aQqW0TooG2iki3E3Ii+WN7gQ=",
          "135: github.com/opencontainers/go-digest v1.0.0-rc1/go.mod h1:cMLVZDEM3+U2I4VmLI6N8jQYUd2OVphdqWwCJHrFt2s=",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "133: github.com/mtrmac/gpgme v0.1.2 h1:dNOmvYmsrakgW7LcgiprD0yfRuQQe8/C8F6Z+zogO3s=",
          "134: github.com/mtrmac/gpgme v0.1.2/go.mod h1:GYYHnGSuS7HK3zVS2n3y73y0okK/BeKzwnn5jgiVFNI=",
          "",
          "---------------"
        ]
      }
    }
  ]
}