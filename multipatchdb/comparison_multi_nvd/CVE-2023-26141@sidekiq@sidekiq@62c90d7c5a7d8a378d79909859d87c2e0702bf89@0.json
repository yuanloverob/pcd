{
  "cve_id": "CVE-2023-26141",
  "cve_desc": "Versions of the package sidekiq before 7.1.3 are vulnerable to Denial of Service (DoS) due to insufficient checks in the dashboard-charts.js file. An attacker can exploit this vulnerability by manipulating the localStorage value which will cause excessive polling requests.",
  "repo": "sidekiq/sidekiq",
  "patch_hash": "62c90d7c5a7d8a378d79909859d87c2e0702bf89",
  "patch_info": {
    "commit_hash": "62c90d7c5a7d8a378d79909859d87c2e0702bf89",
    "repo": "sidekiq/sidekiq",
    "commit_url": "https://github.com/sidekiq/sidekiq/commit/62c90d7c5a7d8a378d79909859d87c2e0702bf89",
    "files": [
      "web/assets/javascripts/application.js",
      "web/assets/javascripts/dashboard-charts.js"
    ],
    "message": "Validate page refresh interval to ensure a minimum amount of delay",
    "before_after_code_files": [
      "web/assets/javascripts/application.js||web/assets/javascripts/application.js",
      "web/assets/javascripts/dashboard-charts.js||web/assets/javascripts/dashboard-charts.js"
    ]
  },
  "patch_diff": {
    "web/assets/javascripts/application.js||web/assets/javascripts/application.js": [
      "File: web/assets/javascripts/application.js -> web/assets/javascripts/application.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "141: function scheduleLivePoll() {",
      "142:   let ti = parseInt(localStorage.sidekiqTimeInterval) || 5000;",
      "143:   livePollTimer = setTimeout(livePollCallback, ti);",
      "144: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "143:   if (ti < 2000) { ti = 2000 }",
      "",
      "---------------"
    ],
    "web/assets/javascripts/dashboard-charts.js||web/assets/javascripts/dashboard-charts.js": [
      "File: web/assets/javascripts/dashboard-charts.js -> web/assets/javascripts/dashboard-charts.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "57: class RealtimeChart extends DashboardChart {",
      "58:   constructor(el, options) {",
      "59:     super(el, options);",
      "61:     this.startPolling();",
      "62:     document.addEventListener(\"interval:update\", this.handleUpdate.bind(this));",
      "63:   }",
      "",
      "[Removed Lines]",
      "60:     this.delay = parseInt(localStorage.sidekiqTimeInterval) || 5000;",
      "",
      "[Added Lines]",
      "60:     let d = parseInt(localStorage.sidekiqTimeInterval) || 5000;",
      "61:     if (d < 2000) { d = 2000; }",
      "62:     this.delay = d",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "101435c5a73095ca62b610d5d6456e7e5dc7f81a",
      "candidate_info": {
        "commit_hash": "101435c5a73095ca62b610d5d6456e7e5dc7f81a",
        "repo": "sidekiq/sidekiq",
        "commit_url": "https://github.com/sidekiq/sidekiq/commit/101435c5a73095ca62b610d5d6456e7e5dc7f81a",
        "files": [
          "web/assets/javascripts/application.js"
        ],
        "message": "Merge 62c90d7",
        "before_after_code_files": [
          "web/assets/javascripts/application.js||web/assets/javascripts/application.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "web/assets/javascripts/application.js||web/assets/javascripts/application.js"
          ],
          "candidate": [
            "web/assets/javascripts/application.js||web/assets/javascripts/application.js"
          ]
        }
      },
      "candidate_diff": {
        "web/assets/javascripts/application.js||web/assets/javascripts/application.js": [
          "File: web/assets/javascripts/application.js -> web/assets/javascripts/application.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "123: function scheduleLivePoll() {",
          "124:   let ti = parseInt(localStorage.sidekiqTimeInterval) || 5000;",
          "125:   livePollTimer = setTimeout(livePollCallback, ti);",
          "126: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "125:   if (ti < 2000) { ti = 2000 }",
          "",
          "---------------"
        ]
      }
    }
  ]
}