{
  "cve_id": "CVE-2023-31285",
  "cve_desc": "An XSS issue was discovered in Serenity Serene (and StartSharp) before 6.7.0. When users upload temporary files, some specific file endings are not allowed, but it is possible to upload .html or .htm files containing an XSS payload. The resulting link can be sent to an administrator user.",
  "repo": "serenity-is/Serenity",
  "patch_hash": "11b9d267f840513d04b4f4d4876de7823a6e48d2",
  "patch_info": {
    "commit_hash": "11b9d267f840513d04b4f4d4876de7823a6e48d2",
    "repo": "serenity-is/Serenity",
    "commit_url": "https://github.com/serenity-is/Serenity/commit/11b9d267f840513d04b4f4d4876de7823a6e48d2",
    "files": [
      "CHANGELOG.md",
      "build/Package.Build.props"
    ],
    "message": ":up: 6.7.0",
    "before_after_code_files": [
      "build/Package.Build.props||build/Package.Build.props"
    ]
  },
  "patch_diff": {
    "build/Package.Build.props||build/Package.Build.props": [
      "File: build/Package.Build.props -> build/Package.Build.props",
      "--- Hunk 1 ---",
      "[Context before]",
      "1: <Project>",
      "2:   <PropertyGroup>",
      "4:   </PropertyGroup>",
      "5: </Project>",
      "",
      "[Removed Lines]",
      "3:     <Version>6.6.6</Version>",
      "",
      "[Added Lines]",
      "3:     <Version>6.7.0</Version>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "879f988d183010580f0106a02e865ee844e9f89b",
      "candidate_info": {
        "commit_hash": "879f988d183010580f0106a02e865ee844e9f89b",
        "repo": "serenity-is/Serenity",
        "commit_url": "https://github.com/serenity-is/Serenity/commit/879f988d183010580f0106a02e865ee844e9f89b",
        "files": [
          "CHANGELOG.md",
          "build/Package.Build.props",
          "src/Serenity.Net.CodeGenerator/TypeScript/TSModuleResolver.cs"
        ],
        "message": ":up: 8.1.4",
        "before_after_code_files": [
          "build/Package.Build.props||build/Package.Build.props",
          "src/Serenity.Net.CodeGenerator/TypeScript/TSModuleResolver.cs||src/Serenity.Net.CodeGenerator/TypeScript/TSModuleResolver.cs"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "build/Package.Build.props||build/Package.Build.props"
          ],
          "candidate": [
            "build/Package.Build.props||build/Package.Build.props"
          ]
        }
      },
      "candidate_diff": {
        "build/Package.Build.props||build/Package.Build.props": [
          "File: build/Package.Build.props -> build/Package.Build.props",
          "--- Hunk 1 ---",
          "[Context before]",
          "1: <Project>",
          "2:   <PropertyGroup>",
          "4:   </PropertyGroup>",
          "5: </Project>",
          "",
          "[Removed Lines]",
          "3:     <Version>8.1.3</Version>",
          "",
          "[Added Lines]",
          "3:     <Version>8.1.4</Version>",
          "",
          "---------------"
        ],
        "src/Serenity.Net.CodeGenerator/TypeScript/TSModuleResolver.cs||src/Serenity.Net.CodeGenerator/TypeScript/TSModuleResolver.cs": [
          "File: src/Serenity.Net.CodeGenerator/TypeScript/TSModuleResolver.cs -> src/Serenity.Net.CodeGenerator/TypeScript/TSModuleResolver.cs",
          "--- Hunk 1 ---",
          "[Context before]",
          "381:         var nugetPackages = fileSystem.Combine(Environment.GetFolderPath(",
          "382:             Environment.SpecialFolder.UserProfile), \".nuget\", \"packages\");",
          "383:         var packageRoot = fileSystem.Combine(nugetPackages,",
          "386:         if (Version.TryParse(value, out _))",
          "387:         {",
          "",
          "[Removed Lines]",
          "384:             GetPossibleNuGetPackageId(moduleName)?.ToLowerInvariant());",
          "",
          "[Added Lines]",
          "384:             GetPossibleNuGetPackageId(moduleName));",
          "",
          "---------------"
        ]
      }
    }
  ]
}