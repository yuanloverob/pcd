{
  "cve_id": "CVE-2021-3932",
  "cve_desc": "twill is vulnerable to Cross-Site Request Forgery (CSRF)",
  "repo": "area17/twill",
  "patch_hash": "81d80d1fbbdd8bb73c020f03c623fd4487bd9b78",
  "patch_info": {
    "commit_hash": "81d80d1fbbdd8bb73c020f03c623fd4487bd9b78",
    "repo": "area17/twill",
    "commit_url": "https://github.com/area17/twill/commit/81d80d1fbbdd8bb73c020f03c623fd4487bd9b78",
    "files": [
      "frontend/js/behaviors/logoutButton.js",
      "frontend/js/main.js",
      "routes/auth.php",
      "views/layouts/main.blade.php",
      "views/partials/navigation/_overlay_navigation.blade.php",
      "views/partials/navigation/_user.blade.php"
    ],
    "message": "Use POST action for logout links",
    "before_after_code_files": [
      "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js",
      "frontend/js/main.js||frontend/js/main.js",
      "routes/auth.php||routes/auth.php",
      "views/layouts/main.blade.php||views/layouts/main.blade.php",
      "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php",
      "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php"
    ]
  },
  "patch_diff": {
    "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js": [
      "File: frontend/js/behaviors/logoutButton.js -> frontend/js/behaviors/logoutButton.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "3: const logoutButton = function () {",
      "4:   const logoutForm = document.querySelector('[data-logout-form]')",
      "6:   if (!logoutForm) return",
      "8:   document.body.addEventListener('click', e => {",
      "9:     if (e.target.hasAttribute('data-logout-btn')) {",
      "10:       e.preventDefault()",
      "11:       logoutForm.submit()",
      "12:     }",
      "13:   })",
      "14: }",
      "16: export default logoutButton",
      "",
      "---------------"
    ],
    "frontend/js/main.js||frontend/js/main.js": [
      "File: frontend/js/main.js -> frontend/js/main.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "4: import Vue from 'vue'",
      "5: import navToggle from '@/behaviors/navToggle'",
      "6: import showEnvLine from '@/behaviors/showEnvLine'",
      "7: import search from '@/main-search'",
      "8: import merge from 'lodash/merge'",
      "10: const A17Init = function () {",
      "11:   navToggle()",
      "12:   showEnvLine()",
      "13: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "7: import logoutButton from '@/behaviors/logoutButton'",
      "14:   logoutButton()",
      "",
      "---------------"
    ],
    "routes/auth.php||routes/auth.php": [
      "File: routes/auth.php -> routes/auth.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "5: if (config('twill.enabled.users-management')) {",
      "6:     Route::get('login', 'LoginController@showLoginForm')->name('login.form');",
      "7:     Route::post('login', 'LoginController@login')->name('login');",
      "10:     Route::get('password/reset', 'ForgotPasswordController@showLinkRequestForm')->name('password.reset.link');",
      "11:     Route::post('password/email', 'ForgotPasswordController@sendResetLinkEmail')->name('password.reset.email');",
      "",
      "[Removed Lines]",
      "8:     Route::get('logout', 'LoginController@logout')->name('logout');",
      "",
      "[Added Lines]",
      "8:     Route::post('logout', 'LoginController@logout')->name('logout');",
      "",
      "---------------"
    ],
    "views/layouts/main.blade.php||views/layouts/main.blade.php": [
      "File: views/layouts/main.blade.php -> views/layouts/main.blade.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "71:                 @include('twill::partials.footer')",
      "72:             </section>",
      "73:         </div>",
      "74:         <script>",
      "75:             window['{{ config('twill.js_namespace') }}'] = {};",
      "76:             window['{{ config('twill.js_namespace') }}'].version = '{{ config('twill.version') }}';",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "75:         <form class=\"visually-hidden\" method=\"POST\" action=\"{{ route('admin.logout') }}\" data-logout-form>",
      "76:             @csrf",
      "77:         </form>",
      "",
      "---------------"
    ],
    "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php": [
      "File: views/partials/navigation/_overlay_navigation.blade.php -> views/partials/navigation/_overlay_navigation.blade.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "22:                     @if(isset($currentUser))",
      "23:                         <a href=\"{{ route('admin.users.index') }}\">{{ twillTrans('twill::lang.nav.cms-users') }}</a><br />",
      "24:                         <a href=\"{{ route('admin.users.edit', $currentUser->id) }}\">{{ twillTrans('twill::lang.nav.settings') }}</a><br />",
      "26:                     @endif",
      "27:                 </div>",
      "28:             </div>",
      "",
      "[Removed Lines]",
      "25:                         <a href=\"{{ route('admin.logout') }}\">{{ twillTrans('twill::lang.nav.logout') }}</a>",
      "",
      "[Added Lines]",
      "25:                         <a href=\"#\" data-logout-btn>{{ twillTrans('twill::lang.nav.logout') }}</a>",
      "",
      "---------------"
    ],
    "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php": [
      "File: views/partials/navigation/_user.blade.php -> views/partials/navigation/_user.blade.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "14:                 <a href=\"{{ route('admin.users.index') }}\">{{ twillTrans('twill::lang.nav.cms-users') }}</a>",
      "15:             @endcan",
      "16:             <a href=\"{{ route('admin.users.edit', $currentUser->id) }}\">{{ twillTrans('twill::lang.nav.settings') }}</a>",
      "18:         </div>",
      "19:     </a17-dropdown>",
      "20: @endif",
      "",
      "[Removed Lines]",
      "17:             <a href=\"{{ route('admin.logout') }}\">{{ twillTrans('twill::lang.nav.logout') }}</a>",
      "",
      "[Added Lines]",
      "17:             <a href=\"#\" data-logout-btn>{{ twillTrans('twill::lang.nav.logout') }}</a>",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "0e1352c3d9a4062fe852d204f5f047d5027f49a1",
      "candidate_info": {
        "commit_hash": "0e1352c3d9a4062fe852d204f5f047d5027f49a1",
        "repo": "area17/twill",
        "commit_url": "https://github.com/area17/twill/commit/0e1352c3d9a4062fe852d204f5f047d5027f49a1",
        "files": [
          "src/TwillNavigation.php",
          "src/View/Components/Navigation/NavigationLink.php",
          "src/View/Components/Partials/Navigation/Overlay.php",
          "views/layouts/main.blade.php",
          "views/partials/navigation/_overlay_navigation.blade.php",
          "views/partials/navigation/navigation_link.blade.php"
        ],
        "message": "Fix overlay navigation.",
        "before_after_code_files": [
          "src/TwillNavigation.php||src/TwillNavigation.php",
          "src/View/Components/Navigation/NavigationLink.php||src/View/Components/Navigation/NavigationLink.php",
          "src/View/Components/Partials/Navigation/Overlay.php||src/View/Components/Partials/Navigation/Overlay.php",
          "views/layouts/main.blade.php||views/layouts/main.blade.php",
          "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php",
          "views/partials/navigation/navigation_link.blade.php||views/partials/navigation/navigation_link.blade.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "views/layouts/main.blade.php||views/layouts/main.blade.php",
            "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php"
          ],
          "candidate": [
            "views/layouts/main.blade.php||views/layouts/main.blade.php",
            "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php"
          ]
        }
      },
      "candidate_diff": {
        "src/TwillNavigation.php||src/TwillNavigation.php": [
          "File: src/TwillNavigation.php -> src/TwillNavigation.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "141:         $tree['right'][] = NavigationLink::make()",
          "142:             ->withAttributes(['data-medialib-btn'])",
          "143:             ->title(twillTrans('twill::lang.nav.media-library'))",
          "147:         $tree['right'][] = NavigationLink::make()",
          "148:             ->title(twillTrans('twill::lang.nav.open-live-site'))",
          "149:             ->onlyWhen(fn() => config('twill.enable.site-link', false))",
          "150:             ->toExternalUrl(config('app.url'));",
          "152:         return $tree;",
          "153:     }",
          "154: }",
          "",
          "[Removed Lines]",
          "144:             ->onlyWhen(function () {",
          "145:                 return Auth::user()->can('access-media-library');",
          "146:             });",
          "",
          "[Added Lines]",
          "141:             ->onlyWhen(fn() => Auth::user()->can('access-media-library'));",
          "148:         foreach ($tree as $groupKey => $group) {",
          "149:             $tree[$groupKey] = Arr::where($group, function(NavigationLink $link): bool {",
          "150:                 return $link->shouldShow();",
          "151:             });",
          "152:         }",
          "",
          "---------------"
        ],
        "src/View/Components/Navigation/NavigationLink.php||src/View/Components/Navigation/NavigationLink.php": [
          "File: src/View/Components/Navigation/NavigationLink.php -> src/View/Components/Navigation/NavigationLink.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "180:         return $this->hasActiveChild();",
          "181:     }",
          "183:     protected function hasActiveChild(): bool",
          "184:     {",
          "185:         foreach ($this->children as $navigationLink) {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "183:     public function getTitle(): string",
          "184:     {",
          "185:         return $this->title;",
          "186:     }",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "201:         return view('twill::partials.navigation.navigation_link', [",
          "202:             'class' => $class,",
          "203:             'is_active' => $this->isActive(),",
          "205:             'href' => $this->getHref(),",
          "206:             'target_blank' => $this->isTargetBlank(),",
          "207:             'attributes' => $this->customAttributes,",
          "",
          "[Removed Lines]",
          "204:             'title' => $this->title,",
          "",
          "[Added Lines]",
          "209:             'title' => $this->getTitle(),",
          "",
          "---------------"
        ],
        "src/View/Components/Partials/Navigation/Overlay.php||src/View/Components/Partials/Navigation/Overlay.php": [
          "File: src/View/Components/Partials/Navigation/Overlay.php -> src/View/Components/Partials/Navigation/Overlay.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "1: <?php",
          "3: namespace A17\\Twill\\View\\Components\\Partials\\Navigation;",
          "5: use A17\\Twill\\Facades\\TwillNavigation;",
          "6: use Illuminate\\Contracts\\View\\View;",
          "7: use Illuminate\\View\\Component;",
          "9: class Overlay extends Component",
          "10: {",
          "11:     public function render(): View",
          "12:     {",
          "13:         return view(",
          "14:             'twill::partials.navigation._overlay_navigation',",
          "15:             [",
          "16:                 'linkGroups' => TwillNavigation::buildNavigationTree(),",
          "17:                 'active_title' => TwillNavigation::getActivePrimaryNavigationLink()?->getTitle(),",
          "18:                 'search' => config('twill.enabled.search', true),",
          "19:             ]",
          "20:         );",
          "21:     }",
          "22: }",
          "",
          "---------------"
        ],
        "views/layouts/main.blade.php||views/layouts/main.blade.php": [
          "File: views/layouts/main.blade.php -> views/layouts/main.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: <body class=\"env env--{{ app()->environment() }} @yield('appTypeClass')\">",
          "9:     @include('twill::partials.icons.svg-sprite')",
          "16:     <div class=\"a17\">",
          "17:         <header class=\"header\">",
          "18:             <div class=\"container\">",
          "",
          "[Removed Lines]",
          "10:     {{-- @prtodo: Fix when done --}}",
          "11:     {{-- @if (config('twill.enabled.search', false)) --}}",
          "12:     {{-- @partialView($moduleName ?? null, 'navigation._overlay_navigation', ['search' => true]) --}}",
          "13:     {{-- @else --}}",
          "14:     {{-- @partialView($moduleName ?? null, 'navigation._overlay_navigation') --}}",
          "15:     {{-- @endif --}}",
          "",
          "[Added Lines]",
          "10:     <x-twill.partials::navigation.overlay />",
          "",
          "---------------"
        ],
        "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php": [
          "File: views/partials/navigation/_overlay_navigation.blade.php -> views/partials/navigation/_overlay_navigation.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:             </div>",
          "37:                 @endif",
          "45:         </span>",
          "",
          "[Removed Lines]",
          "1: @if (config()->has('twill-navigation'))",
          "2:     <header class=\"headerMobile\" data-header-mobile>",
          "3:         <nav class=\"headerMobile__nav\">",
          "4:             <div class=\"container\">",
          "5:                 @partialView(($moduleName ?? null), 'navigation._title')",
          "7:                 <div class=\"headerMobile__list\">",
          "8:                     @foreach(config('twill-navigation') as $global_navigation_key => $global_navigation_element)",
          "9:                         @can($global_navigation_element['can'] ?? 'access-module-list', $global_navigation_key)",
          "10:                             @if(isActiveNavigation($global_navigation_element, $global_navigation_key, $_global_active_navigation))",
          "11:                                 <a class=\"s--on\" href=\"{{ getNavigationUrl($global_navigation_element, $global_navigation_key) }}\">{{ $global_navigation_element['title'] }}</a><br />",
          "12:                             @else",
          "13:                                 <a href=\"{{ getNavigationUrl($global_navigation_element, $global_navigation_key) }}\" @if (isset($global_navigation_element['target']) && $global_navigation_element['target'] == 'external') target=\"_blank\" @endif>{{ $global_navigation_element['title'] }}</a><br />",
          "14:                             @endif",
          "15:                         @endcan",
          "16:                     @endforeach",
          "17:                 </div>",
          "18:                 <div class=\"headerMobile__list\">",
          "19:                     @if (config('twill.enabled.media-library') || config('twill.enabled.file-library'))",
          "20:                         <a href=\"#\" data-closenav-btn data-medialib-btn>{{ twillTrans('twill::lang.nav.media-library') }}</a><br />",
          "21:                     @endif",
          "22:                     @if(isset($currentUser))",
          "23:                         <a href=\"{{ route('twill.users.index') }}\">{{ twillTrans('twill::lang.nav.cms-users') }}</a><br />",
          "24:                         <a href=\"{{ route('twill.users.edit', $currentUser->id) }}\">{{ twillTrans('twill::lang.nav.profile') }}</a><br />",
          "25:                         <a href=\"#\" data-logout-btn>{{ twillTrans('twill::lang.nav.logout') }}</a>",
          "26:                     @endif",
          "27:                 </div>",
          "29:         </nav>",
          "30:     </header>",
          "32:     <button class=\"ham @if(isset($search) && $search) ham--search @endif\" data-ham-btn>",
          "33:         @foreach(config('twill-navigation') as $global_navigation_key => $global_navigation_element)",
          "34:             @can($global_navigation_element['can'] ?? 'access-module-list', $global_navigation_key)",
          "35:                 @if(isActiveNavigation($global_navigation_element, $global_navigation_key, $_global_active_navigation))",
          "36:                     <span class=\"ham__label\">{{ $global_navigation_element['title'] }}</span>",
          "38:             @endcan",
          "39:         @endforeach",
          "40:         <span class=\"btn ham__btn\">",
          "41:             <span class=\"ham__icon\">",
          "42:                 <span class=\"ham__line\"></span>",
          "43:             </span>",
          "44:             <span class=\"icon icon--close_modal\"><svg><title>{{ twillTrans('twill::lang.nav.close-menu') }}</title><use xlink:href=\"#icon--close_modal\"></use></svg></span>",
          "46:     </button>",
          "47: @endif",
          "",
          "[Added Lines]",
          "1: <header class=\"headerMobile\" data-header-mobile>",
          "2:     <nav class=\"headerMobile__nav\">",
          "3:         <div class=\"container\">",
          "4:             <x-twill.partials::navigation.title />",
          "5:             <div class=\"headerMobile__list\">",
          "6:                 @foreach ($linkGroups['left'] as $link)",
          "7:                     {!! $link->render('mobile') !!} <br />",
          "8:                 @endforeach",
          "10:             <div class=\"headerMobile__list\">",
          "11:                 @foreach ($linkGroups['right'] as $link)",
          "12:                     {!! $link->render('mobile') !!}<br />",
          "13:                 @endforeach",
          "14:                 @if ($currentUser = auth()->user())",
          "15:                     <a",
          "16:                         href=\"{{ route('twill.users.index') }}\">{{ twillTrans('twill::lang.nav.cms-users') }}</a><br />",
          "17:                     <a",
          "18:                         href=\"{{ route('twill.users.edit', $currentUser->id) }}\">{{ twillTrans('twill::lang.nav.profile') }}</a><br />",
          "19:                     <a href=\"#\" data-logout-btn>{{ twillTrans('twill::lang.nav.logout') }}</a>",
          "21:             </div>",
          "22:         </div>",
          "23:     </nav>",
          "24: </header>",
          "26: <button class=\"ham @if (isset($search) && $search) ham--search @endif\" data-ham-btn>",
          "27:     @if ($active_title)",
          "28:         <span class=\"ham__label\">{{ $active_title }}</span>",
          "29:     @endif",
          "30:     <span class=\"btn ham__btn\">",
          "31:         <span class=\"ham__icon\">",
          "32:             <span class=\"ham__line\"></span>",
          "34:         <span class=\"icon icon--close_modal\"><svg>",
          "35:                 <title>{{ twillTrans('twill::lang.nav.close-menu') }}</title>",
          "36:                 <use xlink:href=\"#icon--close_modal\"></use>",
          "37:             </svg></span>",
          "38:     </span>",
          "39: </button>",
          "",
          "---------------"
        ],
        "views/partials/navigation/navigation_link.blade.php||views/partials/navigation/navigation_link.blade.php": [
          "File: views/partials/navigation/navigation_link.blade.php -> views/partials/navigation/navigation_link.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "4:         {{ $title }}",
          "5:     </a>",
          "",
          "[Removed Lines]",
          "1: <li class=\"{{ $class ?? '' }} @if ($is_active) s--on @endif\">",
          "2:     <a href=\"{{ $href }}\" @foreach ($attributes as $attribute) {{ $attribute }} @endforeach",
          "3:         @if ($target_blank) target=\"_blank\" @endif>",
          "6: </li>",
          "",
          "[Added Lines]",
          "1: @if ($class === 'mobile')",
          "2:     <a href=\"{{ $href }}\" @foreach ($attributes as $attribute) {{ $attribute }} @endforeach class=\"@if ($is_active) s--on @endif\" @if ($target_blank) target=\"_blank\" @endif>",
          "5: @else",
          "6:     <li class=\"{{ $class ?? '' }} @if ($is_active) s--on @endif\">",
          "7:         <a href=\"{{ $href }}\" @foreach ($attributes as $attribute) {{ $attribute }} @endforeach @if ($target_blank) target=\"_blank\" @endif>",
          "8:             {{ $title }}",
          "9:         </a>",
          "10:     </li>",
          "11: @endif",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "5cded9fc3350a01c6f9f3f0313a7cd47fa54ec9f",
      "candidate_info": {
        "commit_hash": "5cded9fc3350a01c6f9f3f0313a7cd47fa54ec9f",
        "repo": "area17/twill",
        "commit_url": "https://github.com/area17/twill/commit/5cded9fc3350a01c6f9f3f0313a7cd47fa54ec9f",
        "files": [
          "frontend/js/behaviors/logoutButton.js",
          "frontend/js/main.js",
          "routes/auth.php",
          "views/layouts/main.blade.php",
          "views/partials/navigation/_overlay_navigation.blade.php",
          "views/partials/navigation/_user.blade.php"
        ],
        "message": "Use POST action for logout links",
        "before_after_code_files": [
          "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js",
          "frontend/js/main.js||frontend/js/main.js",
          "routes/auth.php||routes/auth.php",
          "views/layouts/main.blade.php||views/layouts/main.blade.php",
          "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php",
          "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js",
            "frontend/js/main.js||frontend/js/main.js",
            "routes/auth.php||routes/auth.php",
            "views/layouts/main.blade.php||views/layouts/main.blade.php",
            "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php",
            "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php"
          ],
          "candidate": [
            "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js",
            "frontend/js/main.js||frontend/js/main.js",
            "routes/auth.php||routes/auth.php",
            "views/layouts/main.blade.php||views/layouts/main.blade.php",
            "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php",
            "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php"
          ]
        }
      },
      "candidate_diff": {
        "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js": [
          "File: frontend/js/behaviors/logoutButton.js -> frontend/js/behaviors/logoutButton.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: const logoutButton = function () {",
          "4:   const logoutForm = document.querySelector('[data-logout-form]')",
          "6:   if (!logoutForm) return",
          "8:   document.body.addEventListener('click', e => {",
          "9:     if (e.target.hasAttribute('data-logout-btn')) {",
          "10:       e.preventDefault()",
          "11:       logoutForm.submit()",
          "12:     }",
          "13:   })",
          "14: }",
          "16: export default logoutButton",
          "",
          "---------------"
        ],
        "frontend/js/main.js||frontend/js/main.js": [
          "File: frontend/js/main.js -> frontend/js/main.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "4: import Vue from 'vue'",
          "5: import navToggle from '@/behaviors/navToggle'",
          "6: import showEnvLine from '@/behaviors/showEnvLine'",
          "7: import search from '@/main-search'",
          "8: import merge from 'lodash/merge'",
          "10: const A17Init = function () {",
          "11:   navToggle()",
          "12:   showEnvLine()",
          "13: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "7: import logoutButton from '@/behaviors/logoutButton'",
          "14:   logoutButton()",
          "",
          "---------------"
        ],
        "routes/auth.php||routes/auth.php": [
          "File: routes/auth.php -> routes/auth.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: if (config('twill.enabled.users-management')) {",
          "6:     Route::get('login', 'LoginController@showLoginForm')->name('login.form');",
          "7:     Route::post('login', 'LoginController@login')->name('login');",
          "10:     Route::get('password/reset', 'ForgotPasswordController@showLinkRequestForm')->name('password.reset.link');",
          "11:     Route::post('password/email', 'ForgotPasswordController@sendResetLinkEmail')->name('password.reset.email');",
          "",
          "[Removed Lines]",
          "8:     Route::get('logout', 'LoginController@logout')->name('logout');",
          "",
          "[Added Lines]",
          "8:     Route::post('logout', 'LoginController@logout')->name('logout');",
          "",
          "---------------"
        ],
        "views/layouts/main.blade.php||views/layouts/main.blade.php": [
          "File: views/layouts/main.blade.php -> views/layouts/main.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "71:                 @include('twill::partials.footer')",
          "72:             </section>",
          "73:         </div>",
          "74:         <script>",
          "75:             window['{{ config('twill.js_namespace') }}'] = {};",
          "76:             window['{{ config('twill.js_namespace') }}'].version = '{{ config('twill.version') }}';",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "75:         <form class=\"visually-hidden\" method=\"POST\" action=\"{{ route('admin.logout') }}\" data-logout-form>",
          "76:             @csrf",
          "77:         </form>",
          "",
          "---------------"
        ],
        "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php": [
          "File: views/partials/navigation/_overlay_navigation.blade.php -> views/partials/navigation/_overlay_navigation.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "22:                     @if(isset($currentUser))",
          "23:                         <a href=\"{{ route('admin.users.index') }}\">{{ twillTrans('twill::lang.nav.cms-users') }}</a><br />",
          "24:                         <a href=\"{{ route('admin.users.edit', $currentUser->id) }}\">{{ twillTrans('twill::lang.nav.settings') }}</a><br />",
          "26:                     @endif",
          "27:                 </div>",
          "28:             </div>",
          "",
          "[Removed Lines]",
          "25:                         <a href=\"{{ route('admin.logout') }}\">{{ twillTrans('twill::lang.nav.logout') }}</a>",
          "",
          "[Added Lines]",
          "25:                         <a href=\"#\" data-logout-btn>{{ twillTrans('twill::lang.nav.logout') }}</a>",
          "",
          "---------------"
        ],
        "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php": [
          "File: views/partials/navigation/_user.blade.php -> views/partials/navigation/_user.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "14:                 <a href=\"{{ route('admin.users.index') }}\">{{ twillTrans('twill::lang.nav.cms-users') }}</a>",
          "15:             @endcan",
          "16:             <a href=\"{{ route('admin.users.edit', $currentUser->id) }}\">{{ twillTrans('twill::lang.nav.settings') }}</a>",
          "18:         </div>",
          "19:     </a17-dropdown>",
          "20: @endif",
          "",
          "[Removed Lines]",
          "17:             <a href=\"{{ route('admin.logout') }}\">{{ twillTrans('twill::lang.nav.logout') }}</a>",
          "",
          "[Added Lines]",
          "17:             <a href=\"#\" data-logout-btn>{{ twillTrans('twill::lang.nav.logout') }}</a>",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "2692d0c2839d3cd101e1b3ac81b73ffdad889da4",
      "candidate_info": {
        "commit_hash": "2692d0c2839d3cd101e1b3ac81b73ffdad889da4",
        "repo": "area17/twill",
        "commit_url": "https://github.com/area17/twill/commit/2692d0c2839d3cd101e1b3ac81b73ffdad889da4",
        "files": [
          "frontend/js/behaviors/logoutButton.js",
          "frontend/js/main.js",
          "routes/auth.php",
          "views/layouts/main.blade.php",
          "views/partials/navigation/_overlay_navigation.blade.php",
          "views/partials/navigation/_user.blade.php"
        ],
        "message": "Use POST action for logout links",
        "before_after_code_files": [
          "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js",
          "frontend/js/main.js||frontend/js/main.js",
          "routes/auth.php||routes/auth.php",
          "views/layouts/main.blade.php||views/layouts/main.blade.php",
          "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php",
          "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js",
            "frontend/js/main.js||frontend/js/main.js",
            "routes/auth.php||routes/auth.php",
            "views/layouts/main.blade.php||views/layouts/main.blade.php",
            "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php",
            "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php"
          ],
          "candidate": [
            "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js",
            "frontend/js/main.js||frontend/js/main.js",
            "routes/auth.php||routes/auth.php",
            "views/layouts/main.blade.php||views/layouts/main.blade.php",
            "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php",
            "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php"
          ]
        }
      },
      "candidate_diff": {
        "frontend/js/behaviors/logoutButton.js||frontend/js/behaviors/logoutButton.js": [
          "File: frontend/js/behaviors/logoutButton.js -> frontend/js/behaviors/logoutButton.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "[No context available]",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "3: const logoutButton = function () {",
          "4:   const logoutForm = document.querySelector('[data-logout-form]')",
          "6:   if (!logoutForm) return",
          "8:   document.body.addEventListener('click', e => {",
          "9:     if (e.target.hasAttribute('data-logout-btn')) {",
          "10:       e.preventDefault()",
          "11:       logoutForm.submit()",
          "12:     }",
          "13:   })",
          "14: }",
          "16: export default logoutButton",
          "",
          "---------------"
        ],
        "frontend/js/main.js||frontend/js/main.js": [
          "File: frontend/js/main.js -> frontend/js/main.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "2: import Vue from 'vue'",
          "3: import navToggle from '@/behaviors/navToggle'",
          "4: import showEnvLine from '@/behaviors/showEnvLine'",
          "5: import search from '@/main-search'",
          "7: const A17Init = function () {",
          "8:   navToggle()",
          "9:   showEnvLine()",
          "10: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "5: import logoutButton from '@/behaviors/logoutButton'",
          "11:   logoutButton()",
          "",
          "---------------"
        ],
        "routes/auth.php||routes/auth.php": [
          "File: routes/auth.php -> routes/auth.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "5: if (config('twill.enabled.users-management')) {",
          "6:     Route::get('login', 'LoginController@showLoginForm')->name('login.form');",
          "7:     Route::post('login', 'LoginController@login')->name('login');",
          "10:     Route::get('password/reset', 'ForgotPasswordController@showLinkRequestForm')->name('password.reset.link');",
          "11:     Route::post('password/email', 'ForgotPasswordController@sendResetLinkEmail')->name('password.reset.email');",
          "",
          "[Removed Lines]",
          "8:     Route::get('logout', 'LoginController@logout')->name('logout');",
          "",
          "[Added Lines]",
          "8:     Route::post('logout', 'LoginController@logout')->name('logout');",
          "",
          "---------------"
        ],
        "views/layouts/main.blade.php||views/layouts/main.blade.php": [
          "File: views/layouts/main.blade.php -> views/layouts/main.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "71:             </section>",
          "72:         </div>",
          "74:         <script>",
          "75:             window.STORE = {}",
          "76:             window.STORE.form = {}",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "74:         <form class=\"visually-hidden\" method=\"POST\" action=\"{{ route('admin.logout') }}\" data-logout-form>",
          "75:             @csrf",
          "76:         </form>",
          "",
          "---------------"
        ],
        "views/partials/navigation/_overlay_navigation.blade.php||views/partials/navigation/_overlay_navigation.blade.php": [
          "File: views/partials/navigation/_overlay_navigation.blade.php -> views/partials/navigation/_overlay_navigation.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "22:                     @if(isset($currentUser))",
          "23:                         <a href=\"{{ route('admin.users.index') }}\">CMS Users</a><br />",
          "24:                         <a href=\"{{ route('admin.users.edit', $currentUser->id) }}\">Settings</a><br />",
          "26:                     @endif",
          "27:                 </div>",
          "28:             </div>",
          "",
          "[Removed Lines]",
          "25:                         <a href=\"{{ route('admin.logout') }}\">Logout</a>",
          "",
          "[Added Lines]",
          "25:                         <a href=\"#\" data-logout-btn>Logout</a>",
          "",
          "---------------"
        ],
        "views/partials/navigation/_user.blade.php||views/partials/navigation/_user.blade.php": [
          "File: views/partials/navigation/_user.blade.php -> views/partials/navigation/_user.blade.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "6:                 <a href=\"{{ route('admin.users.index') }}\">CMS Users</a>",
          "7:             @endcan",
          "8:             <a href=\"{{ route('admin.users.edit', $currentUser->id) }}\">Settings</a>",
          "10:         </div>",
          "11:     </a17-dropdown>",
          "12: @endif",
          "",
          "[Removed Lines]",
          "9:             <a href=\"{{ route('admin.logout') }}\">Logout</a>",
          "",
          "[Added Lines]",
          "9:             <a href=\"#\" data-logout-btn>Logout</a>",
          "",
          "---------------"
        ]
      }
    }
  ]
}