{
  "cve_id": "CVE-2012-4968",
  "cve_desc": "Multiple cross-site scripting (XSS) vulnerabilities in SilverStripe 2.3.x before 2.3.13 and 2.4.x before 2.4.7 allow remote attackers to inject arbitrary web script or HTML via (1) a crafted string to the AbsoluteLinks, (2) BigSummary, (3) ContextSummary, (4) EscapeXML, (5) FirstParagraph, (6) FirstSentence, (7) Initial, (8) LimitCharacters, (9) LimitSentences, (10) LimitWordCount, (11) LimitWordCountXML, (12) Lower, (13) LowerCase, (14) NoHTML, (15) Summary, (16) Upper, (17) UpperCase, or (18) URL method in a template, different vectors than CVE-2012-0976.",
  "repo": "silverstripe/sapphire",
  "patch_hash": "0085876495f0f8dda5dc58cb24a8f2220e7baf1e",
  "patch_info": {
    "commit_hash": "0085876495f0f8dda5dc58cb24a8f2220e7baf1e",
    "repo": "silverstripe/sapphire",
    "commit_url": "https://github.com/silverstripe/sapphire/commit/0085876",
    "files": [
      "core/model/fieldtypes/HTMLText.php",
      "core/model/fieldtypes/StringField.php",
      "core/model/fieldtypes/Text.php",
      "core/model/fieldtypes/Varchar.php",
      "tests/fieldtypes/HTMLTextTest.php",
      "tests/fieldtypes/TextTest.php"
    ],
    "message": "BUGFIX Casting return values on text helper methods in StringField, Text, Varchar",
    "before_after_code_files": [
      "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php",
      "core/model/fieldtypes/StringField.php||core/model/fieldtypes/StringField.php",
      "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php",
      "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php",
      "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php",
      "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php"
    ]
  },
  "patch_diff": {
    "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php": [
      "File: core/model/fieldtypes/HTMLText.php -> core/model/fieldtypes/HTMLText.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "28:   return (strlen($value) > $limit) ? substr($value, 0, $limit) . $add : $value;",
      "29:  }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "31:  static $casting = array(",
      "32:   \"AbsoluteLinks\" => \"HTMLText\",",
      "33:   \"BigSummary\" => \"HTMLText\",",
      "34:   \"ContextSummary\" => \"HTMLText\",",
      "35:   \"FirstParagraph\" => \"HTMLText\",",
      "36:   \"FirstSentence\" => \"HTMLText\",",
      "37:   \"LimitCharacters\" => \"HTMLText\",",
      "38:   \"LimitSentences\" => \"HTMLText\",",
      "39:   \"Lower\" => \"HTMLText\",",
      "40:   \"LowerCase\" => \"HTMLText\",",
      "41:   \"Summary\" => \"HTMLText\",",
      "42:   \"Upper\" => \"HTMLText\",",
      "43:   \"UpperCase\" => \"HTMLText\",",
      "44:   'EscapeXML' => 'HTMLText',",
      "45:   'LimitWordCount' => 'HTMLText',",
      "46:   'LimitWordCountXML' => 'HTMLText',",
      "47:   'NoHTML' => 'Text',",
      "48:  );",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "134: }",
      "",
      "[Removed Lines]",
      "136: ?>",
      "",
      "[Added Lines]",
      "[None]",
      "",
      "---------------"
    ],
    "core/model/fieldtypes/StringField.php||core/model/fieldtypes/StringField.php": [
      "File: core/model/fieldtypes/StringField.php -> core/model/fieldtypes/StringField.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "9: abstract class StringField extends DBField {",
      "10:  protected $nullifyEmpty = true;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "12:  static $casting = array(",
      "13:   \"LimitCharacters\" => \"Text\",",
      "14:   \"Lower\" => \"Text\",",
      "15:   \"Upper\" => \"Text\",",
      "16:  );",
      "",
      "---------------"
    ],
    "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php": [
      "File: core/model/fieldtypes/Text.php -> core/model/fieldtypes/Text.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "19: class Text extends StringField {",
      "20:  static $casting = array(",
      "22:  );",
      "",
      "[Removed Lines]",
      "21:   \"AbsoluteLinks\" => \"HTMLText\",",
      "",
      "[Added Lines]",
      "22:   \"AbsoluteLinks\" => \"Text\",",
      "23:   \"BigSummary\" => \"Text\",",
      "24:   \"ContextSummary\" => \"Text\",",
      "25:   \"FirstParagraph\" => \"Text\",",
      "26:   \"FirstSentence\" => \"Text\",",
      "27:   \"LimitCharacters\" => \"Text\",",
      "28:   \"LimitSentences\" => \"Text\",",
      "29:   \"Summary\" => \"Text\",",
      "30:   'EscapeXML' => 'Text',",
      "31:   'LimitWordCount' => 'Text',",
      "32:   'LimitWordCountXML' => 'HTMLText',",
      "33:   'NoHTML' => 'Text',",
      "",
      "---------------"
    ],
    "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php": [
      "File: core/model/fieldtypes/Varchar.php -> core/model/fieldtypes/Varchar.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "12: class Varchar extends StringField {",
      "14:  protected $size;",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14:  static $casting = array(",
      "15:   \"Initial\" => \"Text\",",
      "16:   \"URL\" => \"Text\",",
      "17:  );",
      "",
      "---------------"
    ],
    "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php": [
      "File: tests/fieldtypes/HTMLTextTest.php -> tests/fieldtypes/HTMLTextTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "102:    $this->assertEquals($match, $textObj->FirstSentence());",
      "103:   }",
      "104:  }",
      "105: }",
      "106: ?>",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "106:  public function testRAW() {",
      "107:   $data = DBField::create('HTMLText', 'This &amp; This');",
      "108:   $this->assertEquals($data->RAW(), 'This &amp; This');",
      "110:   $data = DBField::create('HTMLText', 'This & This');",
      "111:   $this->assertEquals($data->RAW(), 'This & This');",
      "112:  }",
      "114:  public function testXML() {",
      "115:   $data = DBField::create('HTMLText', 'This & This');",
      "116:   $this->assertEquals($data->XML(), 'This &amp; This');",
      "117:  }",
      "119:  public function testHTML() {",
      "120:   $data = DBField::create('HTMLText', 'This & This');",
      "121:   $this->assertEquals($data->HTML(), 'This &amp; This');",
      "122:  }",
      "124:  public function testJS() {",
      "125:   $data = DBField::create('HTMLText', '\"this is a test\"');",
      "126:   $this->assertEquals($data->JS(), '\\\"this is a test\\\"');",
      "127:  }",
      "129:  public function testATT() {",
      "130:   $data = DBField::create('HTMLText', '\"this is a test\"');",
      "131:   $this->assertEquals($data->ATT(), '&quot;this is a test&quot;');",
      "132:  }",
      "",
      "---------------"
    ],
    "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php": [
      "File: tests/fieldtypes/TextTest.php -> tests/fieldtypes/TextTest.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "142:    'A dog <span class=\"highlight\">ate</span> a cat while looking at a Foobar',",
      "143:    $textObj->ContextSummary(100, $testKeyword3a)",
      "144:   );",
      "146:  }",
      "147: }",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "147:  public function testRAW() {",
      "148:   $data = DBField::create('Text', 'This &amp; This');",
      "149:   $this->assertEquals($data->RAW(), 'This &amp; This');",
      "150:  }",
      "152:  public function testXML() {",
      "153:   $data = DBField::create('Text', 'This & This');",
      "154:   $this->assertEquals($data->XML(), 'This &amp; This');",
      "155:  }",
      "157:  public function testHTML() {",
      "158:   $data = DBField::create('Text', 'This & This');",
      "159:   $this->assertEquals($data->HTML(), 'This &amp; This');",
      "160:  }",
      "162:  public function testJS() {",
      "163:   $data = DBField::create('Text', '\"this is a test\"');",
      "164:   $this->assertEquals($data->JS(), '\\\"this is a test\\\"');",
      "165:  }",
      "167:  public function testATT() {",
      "168:   $data = DBField::create('Text', '\"this is a test\"');",
      "169:   $this->assertEquals($data->ATT(), '&quot;this is a test&quot;');",
      "170:  }",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "15e9e059e5948ccf8f5a36dfcb435ad26ecec334",
      "candidate_info": {
        "commit_hash": "15e9e059e5948ccf8f5a36dfcb435ad26ecec334",
        "repo": "silverstripe/sapphire",
        "commit_url": "https://github.com/silverstripe/sapphire/commit/15e9e059e5948ccf8f5a36dfcb435ad26ecec334",
        "files": [
          "core/model/fieldtypes/HTMLText.php",
          "core/model/fieldtypes/Text.php",
          "core/model/fieldtypes/Varchar.php",
          "tests/fieldtypes/HTMLTextTest.php",
          "tests/fieldtypes/TextTest.php"
        ],
        "message": "BUGFIX Casting return values on text helper methods in StringField, Text, Varchar",
        "before_after_code_files": [
          "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php",
          "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php",
          "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php",
          "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php",
          "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php",
            "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php",
            "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php",
            "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php",
            "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php"
          ],
          "candidate": [
            "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php",
            "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php",
            "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php",
            "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php",
            "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php"
          ]
        }
      },
      "candidate_diff": {
        "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php": [
          "File: core/model/fieldtypes/HTMLText.php -> core/model/fieldtypes/HTMLText.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "22:   return (strlen($value) > $limit) ? substr($value, 0, $limit) . $add : $value;",
          "23:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "25:  static $casting = array(",
          "26:   \"AbsoluteLinks\" => \"HTMLText\",",
          "27:   \"BigSummary\" => \"HTMLText\",",
          "28:   \"ContextSummary\" => \"HTMLText\",",
          "29:   \"FirstParagraph\" => \"HTMLText\",",
          "30:   \"FirstSentence\" => \"HTMLText\",",
          "31:   \"LimitCharacters\" => \"HTMLText\",",
          "32:   \"LimitSentences\" => \"HTMLText\",",
          "33:   \"LimitWordCount\" => \"HTMLText\",",
          "34:   \"LimitWordCountXML\" => \"HTMLText\",",
          "35:   \"LimitWordCountPlainText\" => \"Text\",",
          "36:   \"Lower\" => \"HTMLText\",",
          "37:   \"LowerCase\" => \"HTMLText\",",
          "38:   \"Summary\" => \"HTMLText\",",
          "39:   \"Upper\" => \"HTMLText\",",
          "40:   \"UpperCase\" => \"HTMLText\",",
          "41:   'EscapeXML' => 'HTMLText',",
          "42:   'LimitWordCount' => 'HTMLText',",
          "43:   'LimitWordCountXML' => 'HTMLText',",
          "44:   'NoHTML' => 'Text',",
          "45:  );",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "118: }",
          "",
          "[Removed Lines]",
          "120: ?>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php": [
          "File: core/model/fieldtypes/Text.php -> core/model/fieldtypes/Text.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: class Text extends DBField {",
          "8:  static $casting = array(",
          "10:  );",
          "12:  function requireField() {",
          "",
          "[Removed Lines]",
          "9:   \"AbsoluteLinks\" => \"HTMLText\",",
          "",
          "[Added Lines]",
          "9:   \"AbsoluteLinks\" => \"Text\",",
          "10:   \"BigSummary\" => \"Text\",",
          "11:   \"ContextSummary\" => \"Text\",",
          "12:   \"FirstParagraph\" => \"Text\",",
          "13:   \"FirstSentence\" => \"Text\",",
          "14:   \"LimitCharacters\" => \"Text\",",
          "15:   \"LimitSentences\" => \"Text\",",
          "16:   \"LimitWordCount\" => \"Text\",",
          "17:   \"LimitWordCountXML\" => \"Text\",",
          "18:   \"LimitWordCountPlainText\" => \"Text\",",
          "19:   \"Summary\" => \"Text\",",
          "20:   'EscapeXML' => 'Text',",
          "21:   'LimitWordCount' => 'Text',",
          "22:   'LimitWordCountXML' => 'HTMLText',",
          "23:   'NoHTML' => 'Text',",
          "",
          "---------------"
        ],
        "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php": [
          "File: core/model/fieldtypes/Varchar.php -> core/model/fieldtypes/Varchar.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "7: class Varchar extends DBField {",
          "9:  protected $size;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "9:  static $casting = array(",
          "10:   \"Initial\" => \"Text\",",
          "11:   \"URL\" => \"Text\",",
          "12:   \"LimitCharacters\" => \"Text\",",
          "13:  );",
          "",
          "---------------"
        ],
        "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php": [
          "File: tests/fieldtypes/HTMLTextTest.php -> tests/fieldtypes/HTMLTextTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "102:    $this->assertEquals($match, $textObj->FirstSentence());",
          "103:   }",
          "104:  }",
          "105: }",
          "106: ?>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "106:  public function testRAW() {",
          "107:   $data = DBField::create('HTMLText', 'This &amp; This');",
          "108:   $this->assertEquals($data->RAW(), 'This &amp; This');",
          "110:   $data = DBField::create('HTMLText', 'This & This');",
          "111:   $this->assertEquals($data->RAW(), 'This & This');",
          "112:  }",
          "114:  public function testXML() {",
          "115:   $data = DBField::create('HTMLText', 'This & This');",
          "116:   $this->assertEquals($data->XML(), 'This &amp; This');",
          "117:  }",
          "119:  public function testHTML() {",
          "120:   $data = DBField::create('HTMLText', 'This & This');",
          "121:   $this->assertEquals($data->HTML(), 'This &amp; This');",
          "122:  }",
          "124:  public function testJS() {",
          "125:   $data = DBField::create('HTMLText', '\"this is a test\"');",
          "126:   $this->assertEquals($data->JS(), '\\\"this is a test\\\"');",
          "127:  }",
          "129:  public function testATT() {",
          "130:   $data = DBField::create('HTMLText', '\"this is a test\"');",
          "131:   $this->assertEquals($data->ATT(), '&quot;this is a test&quot;');",
          "132:  }",
          "",
          "---------------"
        ],
        "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php": [
          "File: tests/fieldtypes/TextTest.php -> tests/fieldtypes/TextTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "84:    'This is <span class=\"highlight\">some</span> <span class=\"highlight\">test</span> text. <span class=\"highlight\">test</span> <span class=\"highlight\">test</span> what if you have',",
          "85:    $textObj->ContextSummary(50, $testKeywords2)",
          "86:   );",
          "87:  }",
          "",
          "[Removed Lines]",
          "89: }",
          "90: ?>",
          "",
          "[Added Lines]",
          "87:  }",
          "89:  public function testRAW() {",
          "90:   $data = DBField::create('Text', 'This &amp; This');",
          "91:   $this->assertEquals($data->RAW(), 'This &amp; This');",
          "95:   $data = DBField::create('Text', 'This & This');",
          "96:   $this->assertEquals($data->XML(), 'This &amp; This');",
          "97:  }",
          "99:  public function testHTML() {",
          "100:   $data = DBField::create('Text', 'This & This');",
          "101:   $this->assertEquals($data->HTML(), 'This &amp; This');",
          "102:  }",
          "104:  public function testJS() {",
          "105:   $data = DBField::create('Text', '\"this is a test\"');",
          "106:   $this->assertEquals($data->JS(), '\\\"this is a test\\\"');",
          "107:  }",
          "109:  public function testATT() {",
          "110:   $data = DBField::create('Text', '\"this is a test\"');",
          "111:   $this->assertEquals($data->ATT(), '&quot;this is a test&quot;');",
          "112:  }",
          "113: }",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "029f77f5a414ec806d89311690281398a4898285",
      "candidate_info": {
        "commit_hash": "029f77f5a414ec806d89311690281398a4898285",
        "repo": "silverstripe/sapphire",
        "commit_url": "https://github.com/silverstripe/sapphire/commit/029f77f5a414ec806d89311690281398a4898285",
        "files": [
          "core/model/fieldtypes/HTMLText.php",
          "core/model/fieldtypes/StringField.php",
          "core/model/fieldtypes/Text.php",
          "core/model/fieldtypes/Varchar.php",
          "tests/fieldtypes/HTMLTextTest.php",
          "tests/fieldtypes/TextTest.php"
        ],
        "message": "BUGFIX Casting return values on text helper methods in StringField, Text, Varchar",
        "before_after_code_files": [
          "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php",
          "core/model/fieldtypes/StringField.php||core/model/fieldtypes/StringField.php",
          "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php",
          "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php",
          "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php",
          "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 1,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php",
            "core/model/fieldtypes/StringField.php||core/model/fieldtypes/StringField.php",
            "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php",
            "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php",
            "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php",
            "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php"
          ],
          "candidate": [
            "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php",
            "core/model/fieldtypes/StringField.php||core/model/fieldtypes/StringField.php",
            "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php",
            "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php",
            "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php",
            "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php"
          ]
        }
      },
      "candidate_diff": {
        "core/model/fieldtypes/HTMLText.php||core/model/fieldtypes/HTMLText.php": [
          "File: core/model/fieldtypes/HTMLText.php -> core/model/fieldtypes/HTMLText.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "28:   return (strlen($value) > $limit) ? substr($value, 0, $limit) . $add : $value;",
          "29:  }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "31:  static $casting = array(",
          "32:   \"AbsoluteLinks\" => \"HTMLText\",",
          "33:   \"BigSummary\" => \"HTMLText\",",
          "34:   \"ContextSummary\" => \"HTMLText\",",
          "35:   \"FirstParagraph\" => \"HTMLText\",",
          "36:   \"FirstSentence\" => \"HTMLText\",",
          "37:   \"LimitCharacters\" => \"HTMLText\",",
          "38:   \"LimitSentences\" => \"HTMLText\",",
          "39:   \"Lower\" => \"HTMLText\",",
          "40:   \"LowerCase\" => \"HTMLText\",",
          "41:   \"Summary\" => \"HTMLText\",",
          "42:   \"Upper\" => \"HTMLText\",",
          "43:   \"UpperCase\" => \"HTMLText\",",
          "44:   'EscapeXML' => 'HTMLText',",
          "45:   'LimitWordCount' => 'HTMLText',",
          "46:   'LimitWordCountXML' => 'HTMLText',",
          "47:   'NoHTML' => 'Text',",
          "48:  );",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "134: }",
          "",
          "[Removed Lines]",
          "136: ?>",
          "",
          "[Added Lines]",
          "[None]",
          "",
          "---------------"
        ],
        "core/model/fieldtypes/StringField.php||core/model/fieldtypes/StringField.php": [
          "File: core/model/fieldtypes/StringField.php -> core/model/fieldtypes/StringField.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "9: abstract class StringField extends DBField {",
          "10:  protected $nullifyEmpty = true;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "12:  static $casting = array(",
          "13:   \"LimitCharacters\" => \"Text\",",
          "14:   \"Lower\" => \"Text\",",
          "15:   \"Upper\" => \"Text\",",
          "16:  );",
          "",
          "---------------"
        ],
        "core/model/fieldtypes/Text.php||core/model/fieldtypes/Text.php": [
          "File: core/model/fieldtypes/Text.php -> core/model/fieldtypes/Text.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "19: class Text extends StringField {",
          "20:  static $casting = array(",
          "22:  );",
          "",
          "[Removed Lines]",
          "21:   \"AbsoluteLinks\" => \"HTMLText\",",
          "",
          "[Added Lines]",
          "22:   \"AbsoluteLinks\" => \"Text\",",
          "23:   \"BigSummary\" => \"Text\",",
          "24:   \"ContextSummary\" => \"Text\",",
          "25:   \"FirstParagraph\" => \"Text\",",
          "26:   \"FirstSentence\" => \"Text\",",
          "27:   \"LimitCharacters\" => \"Text\",",
          "28:   \"LimitSentences\" => \"Text\",",
          "29:   \"Summary\" => \"Text\",",
          "30:   'EscapeXML' => 'Text',",
          "31:   'LimitWordCount' => 'Text',",
          "32:   'LimitWordCountXML' => 'HTMLText',",
          "33:   'NoHTML' => 'Text',",
          "",
          "---------------"
        ],
        "core/model/fieldtypes/Varchar.php||core/model/fieldtypes/Varchar.php": [
          "File: core/model/fieldtypes/Varchar.php -> core/model/fieldtypes/Varchar.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "12: class Varchar extends StringField {",
          "14:  protected $size;",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "14:  static $casting = array(",
          "15:   \"Initial\" => \"Text\",",
          "16:   \"URL\" => \"Text\",",
          "17:  );",
          "",
          "---------------"
        ],
        "tests/fieldtypes/HTMLTextTest.php||tests/fieldtypes/HTMLTextTest.php": [
          "File: tests/fieldtypes/HTMLTextTest.php -> tests/fieldtypes/HTMLTextTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "102:    $this->assertEquals($match, $textObj->FirstSentence());",
          "103:   }",
          "104:  }",
          "105: }",
          "106: ?>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "106:  public function testRAW() {",
          "107:   $data = DBField::create('HTMLText', 'This &amp; This');",
          "108:   $this->assertEquals($data->RAW(), 'This &amp; This');",
          "110:   $data = DBField::create('HTMLText', 'This & This');",
          "111:   $this->assertEquals($data->RAW(), 'This & This');",
          "112:  }",
          "114:  public function testXML() {",
          "115:   $data = DBField::create('HTMLText', 'This & This');",
          "116:   $this->assertEquals($data->XML(), 'This &amp; This');",
          "117:  }",
          "119:  public function testHTML() {",
          "120:   $data = DBField::create('HTMLText', 'This & This');",
          "121:   $this->assertEquals($data->HTML(), 'This &amp; This');",
          "122:  }",
          "124:  public function testJS() {",
          "125:   $data = DBField::create('HTMLText', '\"this is a test\"');",
          "126:   $this->assertEquals($data->JS(), '\\\"this is a test\\\"');",
          "127:  }",
          "129:  public function testATT() {",
          "130:   $data = DBField::create('HTMLText', '\"this is a test\"');",
          "131:   $this->assertEquals($data->ATT(), '&quot;this is a test&quot;');",
          "132:  }",
          "",
          "---------------"
        ],
        "tests/fieldtypes/TextTest.php||tests/fieldtypes/TextTest.php": [
          "File: tests/fieldtypes/TextTest.php -> tests/fieldtypes/TextTest.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "142:    'A dog <span class=\"highlight\">ate</span> a cat while looking at a Foobar',",
          "143:    $textObj->ContextSummary(100, $testKeyword3a)",
          "144:   );",
          "146:  }",
          "147: }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "147:  public function testRAW() {",
          "148:   $data = DBField::create('Text', 'This &amp; This');",
          "149:   $this->assertEquals($data->RAW(), 'This &amp; This');",
          "150:  }",
          "152:  public function testXML() {",
          "153:   $data = DBField::create('Text', 'This & This');",
          "154:   $this->assertEquals($data->XML(), 'This &amp; This');",
          "155:  }",
          "157:  public function testHTML() {",
          "158:   $data = DBField::create('Text', 'This & This');",
          "159:   $this->assertEquals($data->HTML(), 'This &amp; This');",
          "160:  }",
          "162:  public function testJS() {",
          "163:   $data = DBField::create('Text', '\"this is a test\"');",
          "164:   $this->assertEquals($data->JS(), '\\\"this is a test\\\"');",
          "165:  }",
          "167:  public function testATT() {",
          "168:   $data = DBField::create('Text', '\"this is a test\"');",
          "169:   $this->assertEquals($data->ATT(), '&quot;this is a test&quot;');",
          "170:  }",
          "",
          "---------------"
        ]
      }
    }
  ]
}