{
  "cve_id": "CVE-2021-23370",
  "cve_desc": "This affects the package swiper before 6.5.1.",
  "repo": "nolimits4web/swiper",
  "patch_hash": "9dad2739b7474f383474773d5ab898a0c29ac178",
  "patch_info": {
    "commit_hash": "9dad2739b7474f383474773d5ab898a0c29ac178",
    "repo": "nolimits4web/swiper",
    "commit_url": "https://github.com/nolimits4web/swiper/commit/9dad2739b7474f383474773d5ab898a0c29ac178",
    "files": [
      "src/utils/utils.js"
    ],
    "message": "fix(core): fixed __proto__ pollution",
    "before_after_code_files": [
      "src/utils/utils.js||src/utils/utils.js"
    ]
  },
  "patch_diff": {
    "src/utils/utils.js||src/utils/utils.js": [
      "File: src/utils/utils.js -> src/utils/utils.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "92:   for (let i = 1; i < args.length; i += 1) {",
      "93:     const nextSource = args[i];",
      "94:     if (nextSource !== undefined && nextSource !== null) {",
      "96:       for (let nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex += 1) {",
      "97:         const nextKey = keysArray[nextIndex];",
      "98:         const desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);",
      "",
      "[Removed Lines]",
      "95:       const keysArray = Object.keys(Object(nextSource));",
      "",
      "[Added Lines]",
      "95:       const keysArray = Object.keys(Object(nextSource)).filter((key) => key !== '__proto__');",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "ec358deab79a8cd2529465f07a0ead5dbcc264ad",
      "candidate_info": {
        "commit_hash": "ec358deab79a8cd2529465f07a0ead5dbcc264ad",
        "repo": "nolimits4web/swiper",
        "commit_url": "https://github.com/nolimits4web/swiper/commit/ec358deab79a8cd2529465f07a0ead5dbcc264ad",
        "files": [
          "src/angular/src/utils/utils.ts",
          "src/react/utils.js",
          "src/svelte/utils.js",
          "src/utils/utils.js",
          "src/vue/utils.js"
        ],
        "message": "fix(core): fixed __proto__ pollution",
        "before_after_code_files": [
          "src/angular/src/utils/utils.ts||src/angular/src/utils/utils.ts",
          "src/react/utils.js||src/react/utils.js",
          "src/svelte/utils.js||src/svelte/utils.js",
          "src/utils/utils.js||src/utils/utils.js",
          "src/vue/utils.js||src/vue/utils.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_evolution": 1,
        "olp_code_files": {
          "patch": [
            "src/utils/utils.js||src/utils/utils.js"
          ],
          "candidate": [
            "src/utils/utils.js||src/utils/utils.js"
          ]
        }
      },
      "candidate_diff": {
        "src/angular/src/utils/utils.ts||src/angular/src/utils/utils.ts": [
          "File: src/angular/src/utils/utils.ts -> src/angular/src/utils/utils.ts",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: }",
          "10: export function extend(target, src) {",
          "25: }",
          "27: export function coerceBooleanProperty(value: any): boolean {",
          "",
          "[Removed Lines]",
          "11:   Object.keys(src).forEach((key) => {",
          "12:     if (typeof target[key] === 'undefined') {",
          "13:       target[key] = src[key];",
          "14:       return;",
          "15:     }",
          "16:     if (target[key] && !src[key]) {",
          "17:       return;",
          "18:     }",
          "19:     if (isObject(src[key]) && isObject(target[key]) && Object.keys(src[key]).length > 0) {",
          "20:       extend(target[key], src[key]);",
          "21:     } else {",
          "22:       target[key] = src[key];",
          "23:     }",
          "24:   });",
          "",
          "[Added Lines]",
          "11:   const noExtend = ['__proto__', 'constructor', 'prototype'];",
          "12:   Object.keys(src)",
          "13:     .filter((key) => noExtend.indexOf(key) < 0)",
          "14:     .forEach((key) => {",
          "15:       if (typeof target[key] === 'undefined') {",
          "16:         target[key] = src[key];",
          "17:         return;",
          "18:       }",
          "19:       if (target[key] && !src[key]) {",
          "20:         return;",
          "21:       }",
          "22:       if (isObject(src[key]) && isObject(target[key]) && Object.keys(src[key]).length > 0) {",
          "23:         extend(target[key], src[key]);",
          "24:       } else {",
          "25:         target[key] = src[key];",
          "26:       }",
          "27:     });",
          "",
          "---------------"
        ],
        "src/react/utils.js||src/react/utils.js": [
          "File: src/react/utils.js -> src/react/utils.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: }",
          "10: function extend(target, src) {",
          "19: }",
          "21: function needsNavigation(params = {}) {",
          "",
          "[Removed Lines]",
          "11:   Object.keys(src).forEach((key) => {",
          "12:     if (typeof target[key] === 'undefined') target[key] = src[key];",
          "13:     else if (isObject(src[key]) && isObject(target[key]) && Object.keys(src[key]).length > 0) {",
          "14:       extend(target[key], src[key]);",
          "15:     } else {",
          "16:       target[key] = src[key];",
          "17:     }",
          "18:   });",
          "",
          "[Added Lines]",
          "11:   const noExtend = ['__proto__', 'constructor', 'prototype'];",
          "12:   Object.keys(src)",
          "13:     .filter((key) => noExtend.indexOf(key) < 0)",
          "14:     .forEach((key) => {",
          "15:       if (typeof target[key] === 'undefined') target[key] = src[key];",
          "16:       else if (isObject(src[key]) && isObject(target[key]) && Object.keys(src[key]).length > 0) {",
          "17:         extend(target[key], src[key]);",
          "18:       } else {",
          "19:         target[key] = src[key];",
          "20:       }",
          "21:     });",
          "",
          "---------------"
        ],
        "src/svelte/utils.js||src/svelte/utils.js": [
          "File: src/svelte/utils.js -> src/svelte/utils.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: }",
          "10: function extend(target, src) {",
          "19: }",
          "21: function needsNavigation(params = {}) {",
          "",
          "[Removed Lines]",
          "11:   Object.keys(src).forEach((key) => {",
          "12:     if (typeof target[key] === 'undefined') target[key] = src[key];",
          "13:     else if (isObject(src[key]) && isObject(target[key]) && Object.keys(src[key]).length > 0) {",
          "14:       extend(target[key], src[key]);",
          "15:     } else {",
          "16:       target[key] = src[key];",
          "17:     }",
          "18:   });",
          "",
          "[Added Lines]",
          "11:   const noExtend = ['__proto__', 'constructor', 'prototype'];",
          "12:   Object.keys(src)",
          "13:     .filter((key) => noExtend.indexOf(key) < 0)",
          "14:     .forEach((key) => {",
          "15:       if (typeof target[key] === 'undefined') target[key] = src[key];",
          "16:       else if (isObject(src[key]) && isObject(target[key]) && Object.keys(src[key]).length > 0) {",
          "17:         extend(target[key], src[key]);",
          "18:       } else {",
          "19:         target[key] = src[key];",
          "20:       }",
          "21:     });",
          "",
          "---------------"
        ],
        "src/utils/utils.js||src/utils/utils.js": [
          "File: src/utils/utils.js -> src/utils/utils.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "94: }",
          "95: function extend(...args) {",
          "96:   const to = Object(args[0]);",
          "97:   for (let i = 1; i < args.length; i += 1) {",
          "98:     const nextSource = args[i];",
          "99:     if (nextSource !== undefined && nextSource !== null) {",
          "101:       for (let nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex += 1) {",
          "102:         const nextKey = keysArray[nextIndex];",
          "103:         const desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);",
          "",
          "[Removed Lines]",
          "100:       const keysArray = Object.keys(Object(nextSource)).filter((key) => key !== '__proto__');",
          "",
          "[Added Lines]",
          "97:   const noExtend = ['__proto__', 'constructor', 'prototype'];",
          "101:       const keysArray = Object.keys(Object(nextSource)).filter((key) => noExtend.indexOf(key) < 0);",
          "",
          "---------------"
        ],
        "src/vue/utils.js||src/vue/utils.js": [
          "File: src/vue/utils.js -> src/vue/utils.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "8: }",
          "10: function extend(target, src) {",
          "19: }",
          "21: function needsNavigation(props = {}) {",
          "",
          "[Removed Lines]",
          "11:   Object.keys(src).forEach((key) => {",
          "12:     if (typeof target[key] === 'undefined') target[key] = src[key];",
          "13:     else if (isObject(src[key]) && isObject(target[key]) && Object.keys(src[key]).length > 0) {",
          "14:       extend(target[key], src[key]);",
          "15:     } else {",
          "16:       target[key] = src[key];",
          "17:     }",
          "18:   });",
          "",
          "[Added Lines]",
          "11:   const noExtend = ['__proto__', 'constructor', 'prototype'];",
          "12:   Object.keys(src)",
          "13:     .filter((key) => noExtend.indexOf(key) < 0)",
          "14:     .forEach((key) => {",
          "15:       if (typeof target[key] === 'undefined') target[key] = src[key];",
          "16:       else if (isObject(src[key]) && isObject(target[key]) && Object.keys(src[key]).length > 0) {",
          "17:         extend(target[key], src[key]);",
          "18:       } else {",
          "19:         target[key] = src[key];",
          "20:       }",
          "21:     });",
          "",
          "---------------"
        ]
      }
    }
  ]
}