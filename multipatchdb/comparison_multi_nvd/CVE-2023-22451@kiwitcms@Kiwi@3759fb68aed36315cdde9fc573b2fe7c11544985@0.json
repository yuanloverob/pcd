{
  "cve_id": "CVE-2023-22451",
  "cve_desc": "Kiwi TCMS is an open source test management system. In version 11.6 and prior, when users register new accounts and/or change passwords, there is no validation in place which would prevent them from picking an easy to guess password. This issue is resolved by providing defaults for the `AUTH_PASSWORD_VALIDATORS` configuration setting. As of version 11.7, the password can\u2019t be too similar to other personal information, must contain at least 10 characters, can\u2019t be a commonly used password, and can\u2019t be entirely numeric. As a workaround, an administrator may reset all passwords in Kiwi TCMS if they think a weak password may have been chosen. ",
  "repo": "kiwitcms/Kiwi",
  "patch_hash": "3759fb68aed36315cdde9fc573b2fe7c11544985",
  "patch_info": {
    "commit_hash": "3759fb68aed36315cdde9fc573b2fe7c11544985",
    "repo": "kiwitcms/Kiwi",
    "commit_url": "https://github.com/kiwitcms/Kiwi/commit/3759fb68aed36315cdde9fc573b2fe7c11544985",
    "files": [
      "tcms/kiwi_auth/tests/__init__.py",
      "tcms/kiwi_auth/tests/test_admin.py",
      "tcms/kiwi_auth/tests/test_forms.py",
      "tcms/kiwi_auth/tests/test_views.py"
    ],
    "message": "Update tests to use a stronger password",
    "before_after_code_files": [
      "tcms/kiwi_auth/tests/__init__.py||tcms/kiwi_auth/tests/__init__.py",
      "tcms/kiwi_auth/tests/test_admin.py||tcms/kiwi_auth/tests/test_admin.py",
      "tcms/kiwi_auth/tests/test_forms.py||tcms/kiwi_auth/tests/test_forms.py",
      "tcms/kiwi_auth/tests/test_views.py||tcms/kiwi_auth/tests/test_views.py"
    ]
  },
  "patch_diff": {
    "tcms/kiwi_auth/tests/__init__.py||tcms/kiwi_auth/tests/__init__.py": [
      "File: tcms/kiwi_auth/tests/__init__.py -> tcms/kiwi_auth/tests/__init__.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "[No context available]",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "1: __FOR_TESTING__ = \"5a5b6e17f9c34025a75b052fc06c50ab\"",
      "",
      "---------------"
    ],
    "tcms/kiwi_auth/tests/test_admin.py||tcms/kiwi_auth/tests/test_admin.py": [
      "File: tcms/kiwi_auth/tests/test_admin.py -> tcms/kiwi_auth/tests/test_admin.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "11: from tcms.tests import LoggedInTestCase, user_should_have_perm",
      "12: from tcms.tests.factories import GroupFactory, UserFactory",
      "15: class TestUserAdmin(LoggedInTestCase):  # pylint: disable=too-many-public-methods",
      "16:     @classmethod",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "14: from . import __FOR_TESTING__",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "65:             \"/admin/auth/user/add/\",",
      "66:             {",
      "67:                 \"username\": \"added-by-admin\",",
      "70:             },",
      "71:             follow=True,",
      "72:         )",
      "",
      "[Removed Lines]",
      "68:                 \"password1\": \"xo-xo-xo\",",
      "69:                 \"password2\": \"xo-xo-xo\",",
      "",
      "[Added Lines]",
      "70:                 \"password1\": __FOR_TESTING__,",
      "71:                 \"password2\": __FOR_TESTING__,",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "225:             \"/admin/auth/user/add/\",",
      "226:             {",
      "227:                 \"username\": \"added-by-moderator\",",
      "230:             },",
      "231:             follow=True,",
      "232:         )",
      "",
      "[Removed Lines]",
      "228:                 \"password1\": \"xo-xo-xo\",",
      "229:                 \"password2\": \"xo-xo-xo\",",
      "",
      "[Added Lines]",
      "230:                 \"password1\": __FOR_TESTING__,",
      "231:                 \"password2\": __FOR_TESTING__,",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "373:             \"/admin/auth/user/add/\",",
      "374:             {",
      "375:                 \"username\": \"added-by-regular-user\",",
      "378:             },",
      "379:             follow=True,",
      "380:         )",
      "",
      "[Removed Lines]",
      "376:                 \"password1\": \"xo-xo-xo\",",
      "377:                 \"password2\": \"xo-xo-xo\",",
      "",
      "[Added Lines]",
      "378:                 \"password1\": __FOR_TESTING__,",
      "379:                 \"password2\": __FOR_TESTING__,",
      "",
      "---------------"
    ],
    "tcms/kiwi_auth/tests/test_forms.py||tcms/kiwi_auth/tests/test_forms.py": [
      "File: tcms/kiwi_auth/tests/test_forms.py -> tcms/kiwi_auth/tests/test_forms.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "6: from tcms.kiwi_auth import forms",
      "9: class TestCaptchaField(TestCase):",
      "10:     def setUp(self):",
      "11:         self.data = {",
      "12:             \"username\": \"test_user\",",
      "15:             \"email\": \"new-tester@example.com\",",
      "16:         }",
      "",
      "[Removed Lines]",
      "13:             \"password1\": \"password\",",
      "14:             \"password2\": \"password\",",
      "",
      "[Added Lines]",
      "8: from . import __FOR_TESTING__",
      "15:             \"password1\": __FOR_TESTING__,",
      "16:             \"password2\": __FOR_TESTING__,",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "49:     def setUp(self):",
      "50:         self.data = {",
      "51:             \"username\": \"test_user\",",
      "54:             \"email\": \"new-tester@example.com\",",
      "55:         }",
      "",
      "[Removed Lines]",
      "52:             \"password1\": \"password\",",
      "53:             \"password2\": \"password\",",
      "",
      "[Added Lines]",
      "54:             \"password1\": __FOR_TESTING__,",
      "55:             \"password2\": __FOR_TESTING__,",
      "",
      "---------------"
    ],
    "tcms/kiwi_auth/tests/test_views.py||tcms/kiwi_auth/tests/test_views.py": [
      "File: tcms/kiwi_auth/tests/test_views.py -> tcms/kiwi_auth/tests/test_views.py",
      "--- Hunk 1 ---",
      "[Context before]",
      "17: from tcms.kiwi_auth.models import UserActivationKey",
      "18: from tcms.tests.factories import UserFactory",
      "20: User = get_user_model()  # pylint: disable=invalid-name",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "20: from . import __FOR_TESTING__",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "117:                     self.register_url,",
      "118:                     {",
      "119:                         \"username\": username,",
      "122:                         \"email\": \"new-tester@example.com\",",
      "123:                         \"captcha_0\": \"PASSED\",",
      "124:                         \"captcha_1\": \"PASSED\",",
      "",
      "[Removed Lines]",
      "120:                         \"password1\": \"password\",",
      "121:                         \"password2\": \"password\",",
      "",
      "[Added Lines]",
      "122:                         \"password1\": __FOR_TESTING__,",
      "123:                         \"password2\": __FOR_TESTING__,",
      "",
      "---------------",
      "--- Hunk 3 ---",
      "[Context before]",
      "254:             self.register_url,",
      "255:             {",
      "256:                 \"username\": \"kiwi-tester\",",
      "259:                 \"email\": \"new-tester@example.com\",",
      "260:             },",
      "261:             follow=False,",
      "",
      "[Removed Lines]",
      "257:                 \"password1\": \"password-1\",",
      "258:                 \"password2\": \"password-2\",",
      "",
      "[Added Lines]",
      "259:                 \"password1\": __FOR_TESTING__,",
      "260:                 \"password2\": f\"000-{__FOR_TESTING__}\",",
      "",
      "---------------",
      "--- Hunk 4 ---",
      "[Context before]",
      "272:             self.register_url,",
      "273:             {",
      "274:                 \"username\": \"test_user\",",
      "277:                 \"email\": \"new-tester@example.com\",",
      "278:             },",
      "279:             follow=False,",
      "",
      "[Removed Lines]",
      "275:                 \"password1\": \"password\",",
      "276:                 \"password2\": \"password\",",
      "",
      "[Added Lines]",
      "277:                 \"password1\": __FOR_TESTING__,",
      "278:                 \"password2\": __FOR_TESTING__,",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "802ee508f83a9ffb86b00f39837b7312145d4a06",
      "candidate_info": {
        "commit_hash": "802ee508f83a9ffb86b00f39837b7312145d4a06",
        "repo": "kiwitcms/Kiwi",
        "commit_url": "https://github.com/kiwitcms/Kiwi/commit/802ee508f83a9ffb86b00f39837b7312145d4a06",
        "files": [
          "tcms/settings/common.py"
        ],
        "message": "Enable password validators to avoid users chosing weak passwords\n\n- password can\u2019t be too similar to your other personal information.\n- password must contain at least 10 characters.\n- password can\u2019t be a commonly used password.\n- password can\u2019t be entirely numeric.\n\nExisting users are advised to reset their passwords!",
        "before_after_code_files": [
          "tcms/settings/common.py||tcms/settings/common.py"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_pr": 1,
        "olp_pr_links": [
          "https://github.com/kiwitcms/Kiwi/pull/3025"
        ],
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tcms/settings/common.py||tcms/settings/common.py": [
          "File: tcms/settings/common.py -> tcms/settings/common.py",
          "--- Hunk 1 ---",
          "[Context before]",
          "92: # handler!",
          "93: AUTO_APPROVE_NEW_USERS = True",
          "96: # Set to False if you want to enforce account creation by admins.",
          "97: REGISTRATION_ENABLED = (",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "95: # Password validation rules, see",
          "96: # https://docs.djangoproject.com/en/4.1/topics/auth/passwords/#enabling-password-validation",
          "97: AUTH_PASSWORD_VALIDATORS = [",
          "98:     {",
          "99:         \"NAME\": \"django.contrib.auth.password_validation.UserAttributeSimilarityValidator\",",
          "100:     },",
          "101:     {",
          "102:         \"NAME\": \"django.contrib.auth.password_validation.MinimumLengthValidator\",",
          "103:         \"OPTIONS\": {",
          "104:             \"min_length\": 10,",
          "105:         },",
          "106:     },",
          "107:     {",
          "108:         \"NAME\": \"django.contrib.auth.password_validation.CommonPasswordValidator\",",
          "109:     },",
          "110:     {",
          "111:         \"NAME\": \"django.contrib.auth.password_validation.NumericPasswordValidator\",",
          "112:     },",
          "113: ]",
          "",
          "---------------"
        ]
      }
    }
  ]
}