{
  "cve_id": "CVE-2016-7103",
  "cve_desc": "Cross-site scripting (XSS) vulnerability in jQuery UI before 1.12.0 might allow remote attackers to inject arbitrary web script or HTML via the closeText parameter of the dialog function.",
  "repo": "jquery/jquery-ui",
  "patch_hash": "9644e7bae9116edaf8d37c5b38cb32b892f10ff6",
  "patch_info": {
    "commit_hash": "9644e7bae9116edaf8d37c5b38cb32b892f10ff6",
    "repo": "jquery/jquery-ui",
    "commit_url": "https://github.com/jquery/jquery-ui/commit/9644e7bae9116edaf8d37c5b38cb32b892f10ff6",
    "files": [
      "tests/unit/dialog/options.js",
      "ui/widgets/dialog.js"
    ],
    "message": "Dialog: Escape closeText option before passing it to button\n\nRef gh-1632\nFixes jquery/api.jqueryui.com#281",
    "before_after_code_files": [
      "tests/unit/dialog/options.js||tests/unit/dialog/options.js",
      "ui/widgets/dialog.js||ui/widgets/dialog.js"
    ]
  },
  "patch_diff": {
    "tests/unit/dialog/options.js||tests/unit/dialog/options.js": [
      "File: tests/unit/dialog/options.js -> tests/unit/dialog/options.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "206: } );",
      "208: test( \"closeText\", function() {",
      "211:  var element = $( \"<div></div>\" ).dialog();",
      "212:   equal( $.trim( element.dialog( \"widget\" ).find( \".ui-dialog-titlebar-close\" ).text() ), \"Close\",",
      "",
      "[Removed Lines]",
      "209:  expect( 3 );",
      "",
      "[Added Lines]",
      "209:  expect( 4 );",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "222:   equal( $.trim( element.dialog( \"widget\" ).find( \".ui-dialog-titlebar-close\" ).text() ), \"bar\",",
      "223:    \"closeText via option method\" );",
      "224:  element.remove();",
      "225: } );",
      "227: test( \"draggable\", function() {",
      "",
      "[Removed Lines]",
      "[None]",
      "",
      "[Added Lines]",
      "226:  element = $( \"<div></div>\" ).dialog( { closeText: \"<span>foo</span>\" } );",
      "227:   equal( $.trim( element.dialog( \"widget\" ).find( \".ui-dialog-titlebar-close\" ).text() ), \"<span>foo</span>\",",
      "228:    \"closeText is escaped\" );",
      "229:  element.remove();",
      "",
      "---------------"
    ],
    "ui/widgets/dialog.js||ui/widgets/dialog.js": [
      "File: ui/widgets/dialog.js -> ui/widgets/dialog.js",
      "--- Hunk 1 ---",
      "[Context before]",
      "427:   this.uiDialogTitlebarClose = $( \"<button type='button'></button>\" )",
      "428:    .button( {",
      "430:     icon: \"ui-icon-closethick\",",
      "431:     showLabel: false",
      "432:    } )",
      "",
      "[Removed Lines]",
      "429:     label: this.options.closeText,",
      "",
      "[Added Lines]",
      "429:     label: $( \"<a>\" ).text( this.options.closeText ).html(),",
      "",
      "---------------",
      "--- Hunk 2 ---",
      "[Context before]",
      "715:    this.uiDialogTitlebarClose.button( {",
      "719:    } );",
      "720:   }",
      "",
      "[Removed Lines]",
      "718:     label: \"\" + value",
      "",
      "[Added Lines]",
      "718:     label: $( \"<a>\" ).text( \"\" + this.options.closeText ).html()",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "f1b643ec67c7c8d96e1612c4b7d73fc49b6ae3cd",
      "candidate_info": {
        "commit_hash": "f1b643ec67c7c8d96e1612c4b7d73fc49b6ae3cd",
        "repo": "jquery/jquery-ui",
        "commit_url": "https://github.com/jquery/jquery-ui/commit/f1b643ec67c7c8d96e1612c4b7d73fc49b6ae3cd",
        "files": [
          "tests/unit/button/button.html",
          "tests/unit/button/deprecated.html",
          "tests/unit/button/options.js"
        ],
        "message": "Button: Add tests for button with html markup\n\nRef gh-1632\nRef jquery/api.jqueryui.com#281",
        "before_after_code_files": [
          "tests/unit/button/button.html||tests/unit/button/button.html",
          "tests/unit/button/deprecated.html||tests/unit/button/deprecated.html",
          "tests/unit/button/options.js||tests/unit/button/options.js"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "tests/unit/button/button.html||tests/unit/button/button.html": [
          "File: tests/unit/button/button.html -> tests/unit/button/button.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: <div id=\"qunit-fixture\">",
          "15: <form id=\"form1\">",
          "16:  <div><button id=\"button\">Label</button></div>",
          "18:  <div><input id=\"submit\" type=\"submit\" value=\"Label\"></div>",
          "19: </form>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "17:  <div><button id=\"button2\">label <span>with span</span></button></div>",
          "",
          "---------------"
        ],
        "tests/unit/button/deprecated.html||tests/unit/button/deprecated.html": [
          "File: tests/unit/button/deprecated.html -> tests/unit/button/deprecated.html",
          "--- Hunk 1 ---",
          "[Context before]",
          "14: <div id=\"qunit-fixture\">",
          "16: <div class=\"buttonset\"><button id=\"button\">Label</button><button>button 2</button></div>",
          "18: <div id=\"radio0\" style=\"margin-top: 2em;\">",
          "19:  <input type=\"radio\" id=\"radio01\" name=\"radio\" checked=\"checked\"><label for=\"radio01\">Choice 1</label>",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "17: <div><button id=\"button2\">label <span>with span</span></button></div>",
          "",
          "---------------"
        ],
        "tests/unit/button/options.js||tests/unit/button/options.js": [
          "File: tests/unit/button/options.js -> tests/unit/button/options.js",
          "--- Hunk 1 ---",
          "[Context before]",
          "76:  deepEqual( button.button( \"option\", \"label\" ), \"Label\" );",
          "77: } );",
          "79: test( \"label, explicit value\", function() {",
          "80:  expect( 2 );",
          "81:  var button = $( \"#button\" ).button( {",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "79: test( \"label, with html markup\", function() {",
          "80:  expect( 3 );",
          "81:  var button = $( \"#button2\" ).button();",
          "83:  deepEqual( button.text(), \"label with span\" );",
          "84:  deepEqual( button.html().toLowerCase(), \"label <span>with span</span>\" );",
          "85:  deepEqual( button.button( \"option\", \"label\" ).toLowerCase(), \"label <span>with span</span>\" );",
          "86: } );",
          "",
          "---------------"
        ]
      }
    }
  ]
}