{
  "cve_id": "CVE-2020-24750",
  "cve_desc": "FasterXML jackson-databind 2.x before 2.9.10.6 mishandles the interaction between serialization gadgets and typing, related to com.pastdev.httpcomponents.configuration.JndiConfiguration.",
  "repo": "FasterXML/jackson-databind",
  "patch_hash": "ad5a630174f08d279504bc51ebba8772fd71b86b",
  "patch_info": {
    "commit_hash": "ad5a630174f08d279504bc51ebba8772fd71b86b",
    "repo": "FasterXML/jackson-databind",
    "commit_url": "https://github.com/FasterXML/jackson-databind/commit/ad5a630174f08d279504bc51ebba8772fd71b86b",
    "files": [
      "release-notes/VERSION-2.x"
    ],
    "message": "Add cve id for #2798",
    "before_after_code_files": []
  },
  "patch_diff": {},
  "candidates": [
    {
      "candidate_hash": "08fbfacf89a4a4c026a6227a1b470ab7a13e2e88",
      "candidate_info": {
        "commit_hash": "08fbfacf89a4a4c026a6227a1b470ab7a13e2e88",
        "repo": "FasterXML/jackson-databind",
        "commit_url": "https://github.com/FasterXML/jackson-databind/commit/08fbfacf89a4a4c026a6227a1b470ab7a13e2e88",
        "files": [
          "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java"
        ],
        "message": "fix: merge fix from 2.9 branch #2653 #2658 #2659 #2660 #2662 #2664 #2666 #2670 #2680 #2682 #2688 #2698 #2704 #2765 #2798 #2814 #2826 #2827 #2854 (#2858)\n\n1. generated diff CVE diff\ngit diff ad5a63017 -- src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java\n\n2. cleanup the diff ,just remain the CVE change\n\n3. apply the diff\n\n4. check and make sure only commit the AutoType CVE change.\n\n```\nPR_LIST=$(git log1 -n 17 ad5a63017 -- src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java | awk -F'[ ,]+' '{for(i=1;i<=NF;i++){a=$(i);if(match(a,/#[0-9]+/)){print a;}}}' | sort | uniq);echo \"$PR_LIST\" | wc -l\necho $PR_LIST\n```",
        "before_after_code_files": [
          "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java||src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "same_branch_issue": 1,
        "olp_code_files": {
          "patch": [],
          "candidate": []
        }
      },
      "candidate_diff": {
        "src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java||src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java": [
          "File: src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java -> src/main/java/com/fasterxml/jackson/databind/jsontype/impl/SubTypeValidator.java",
          "--- Hunk 1 ---",
          "[Context before]",
          "50:         s.add(\"org.springframework.beans.factory.config.PropertyPathFactoryBean\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "52:         s.add(\"org.springframework.aop.config.MethodLocatingFactoryBean\");",
          "53:         s.add(\"org.springframework.beans.factory.config.BeanReferenceFactoryBean\");",
          "",
          "---------------",
          "--- Hunk 2 ---",
          "[Context before]",
          "73:         s.add(\"com.sun.deploy.security.ruleset.DRSHelper\");",
          "74:         s.add(\"org.apache.axis2.jaxws.spi.handler.HandlerResolverImpl\");",
          "77:         s.add(\"org.jboss.util.propertyeditor.DocumentEditor\");",
          "78:         s.add(\"org.apache.openjpa.ee.RegistryManagedRuntime\");",
          "79:         s.add(\"org.apache.openjpa.ee.JNDIManagedRuntime\");",
          "83:         s.add(\"com.mysql.cj.jdbc.admin.MiniAdmin\");",
          "86:         s.add(\"ch.qos.logback.core.db.DriverManagerConnectionSource\");",
          "89:         s.add(\"org.jdom.transform.XSLTransformer\");",
          "90:         s.add(\"org.jdom2.transform.XSLTransformer\");",
          "93:         s.add(\"net.sf.ehcache.transaction.manager.DefaultTransactionManagerLookup\");",
          "96:         s.add(\"ch.qos.logback.core.db.JNDIConnectionSource\");",
          "",
          "[Removed Lines]",
          "80:         s.add(\"org.apache.axis2.transport.jms.JMSOutTransportInfo\");",
          "",
          "[Added Lines]",
          "83:         s.add(\"org.apache.openjpa.ee.WASRegistryManagedRuntime\"); // [#2670] addition",
          "84:         s.add(\"org.apache.axis2.transport.jms.JMSOutTransportInfo\");",
          "98:         s.add(\"net.sf.ehcache.hibernate.EhcacheJtaTransactionManagerLookup\");",
          "",
          "---------------",
          "--- Hunk 3 ---",
          "[Context before]",
          "107:         s.add(\"org.apache.commons.configuration.JNDIConfiguration\");",
          "108:         s.add(\"org.apache.commons.configuration2.JNDIConfiguration\");",
          "111:         s.add(\"org.apache.xalan.lib.sql.JNDIConnectionPool\");",
          "114:         s.add(\"org.apache.commons.dbcp.datasources.PerUserPoolDataSource\");",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "118:         s.add(\"com.sun.org.apache.xalan.internal.lib.sql.JNDIConnectionPool\");",
          "",
          "---------------",
          "--- Hunk 4 ---",
          "[Context before]",
          "130:         s.add(\"org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig\");",
          "133:         s.add(\"com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig\");",
          "134:         s.add(\"br.com.anteros.dbcp.AnterosDBCPConfig\");",
          "137:         s.add(\"javax.swing.JEditorPane\");",
          "140:         s.add(\"org.apache.shiro.realm.jndi.JndiRealmFactory\");",
          "142:         DEFAULT_NO_DESER_CLASS_NAMES = Collections.unmodifiableSet(s);",
          "143:     }",
          "",
          "[Removed Lines]",
          "[None]",
          "",
          "[Added Lines]",
          "143:         s.add(\"br.com.anteros.dbcp.AnterosDBCPDataSource\");",
          "147:         s.add(\"javax.swing.JTextPane\");",
          "151:         s.add(\"org.apache.shiro.jndi.JndiObjectFactory\");",
          "154:         s.add(\"org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup\");",
          "155:         s.add(\"org.apache.ignite.cache.jta.jndi.CacheJndiTmFactory\");",
          "156:         s.add(\"org.quartz.utils.JNDIConnectionProvider\");",
          "159:         s.add(\"org.apache.aries.transaction.jms.internal.XaPooledConnectionFactory\");",
          "160:         s.add(\"org.apache.aries.transaction.jms.RecoverablePooledConnectionFactory\");",
          "163:         s.add(\"com.caucho.config.types.ResourceRef\");",
          "166:         s.add(\"org.aoju.bus.proxy.provider.RmiProvider\");",
          "167:         s.add(\"org.aoju.bus.proxy.provider.remoting.RmiProvider\");",
          "171:         s.add(\"org.apache.activemq.ActiveMQConnectionFactory\"); // core",
          "172:         s.add(\"org.apache.activemq.ActiveMQXAConnectionFactory\");",
          "173:         s.add(\"org.apache.activemq.spring.ActiveMQConnectionFactory\");",
          "174:         s.add(\"org.apache.activemq.spring.ActiveMQXAConnectionFactory\");",
          "175:         s.add(\"org.apache.activemq.pool.JcaPooledConnectionFactory\"); // pool",
          "176:         s.add(\"org.apache.activemq.pool.PooledConnectionFactory\");",
          "177:         s.add(\"org.apache.activemq.pool.XaPooledConnectionFactory\");",
          "178:         s.add(\"org.apache.activemq.jms.pool.XaPooledConnectionFactory\"); // pool-jms",
          "179:         s.add(\"org.apache.activemq.jms.pool.JcaPooledConnectionFactory\");",
          "182:         s.add(\"org.apache.commons.proxy.provider.remoting.RmiProvider\");",
          "185:         s.add(\"org.apache.commons.jelly.impl.Embedded\");",
          "188:         s.add(\"oadd.org.apache.xalan.lib.sql.JNDIConnectionPool\");",
          "193:         s.add(\"oracle.jms.AQjmsQueueConnectionFactory\");",
          "194:         s.add(\"oracle.jms.AQjmsXATopicConnectionFactory\");",
          "195:         s.add(\"oracle.jms.AQjmsTopicConnectionFactory\");",
          "196:         s.add(\"oracle.jms.AQjmsXAQueueConnectionFactory\");",
          "197:         s.add(\"oracle.jms.AQjmsXAConnectionFactory\");",
          "200:         s.add(\"org.jsecurity.realm.jndi.JndiRealmFactory\");",
          "203:         s.add(\"com.pastdev.httpcomponents.configuration.JndiConfiguration\");",
          "206:         s.add(\"com.nqadmin.rowset.JdbcRowSetImpl\");",
          "207:         s.add(\"org.arrah.framework.rdbms.UpdatableJdbcRowsetImpl\");",
          "",
          "---------------"
        ]
      }
    }
  ]
}