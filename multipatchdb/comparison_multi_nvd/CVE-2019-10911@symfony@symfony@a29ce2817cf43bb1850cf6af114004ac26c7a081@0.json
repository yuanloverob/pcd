{
  "cve_id": "CVE-2019-10911",
  "cve_desc": "In Symfony before 2.7.51, 2.8.x before 2.8.50, 3.x before 3.4.26, 4.x before 4.1.12, and 4.2.x before 4.2.7, a vulnerability would allow an attacker to authenticate as a privileged user on sites with user registration and remember me login functionality enabled. This is related to symfony/security.",
  "repo": "symfony/symfony",
  "patch_hash": "a29ce2817cf43bb1850cf6af114004ac26c7a081",
  "patch_info": {
    "commit_hash": "a29ce2817cf43bb1850cf6af114004ac26c7a081",
    "repo": "symfony/symfony",
    "commit_url": "https://github.com/symfony/symfony/commit/a29ce2817cf43bb1850cf6af114004ac26c7a081",
    "files": [
      "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
    ],
    "message": "[Security] Add a separator in the remember me cookie hash",
    "before_after_code_files": [
      "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
    ]
  },
  "patch_diff": {
    "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php": [
      "File: src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php -> src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php",
      "--- Hunk 1 ---",
      "[Context before]",
      "121:     protected function generateCookieHash($class, $username, $expires, $password)",
      "122:     {",
      "124:     }",
      "125: }",
      "",
      "[Removed Lines]",
      "123:         return hash_hmac('sha256', $class.$username.$expires.$password, $this->getSecret());",
      "",
      "[Added Lines]",
      "123:         return hash_hmac('sha256', $class.self::COOKIE_DELIMITER.$username.self::COOKIE_DELIMITER.$expires.self::COOKIE_DELIMITER.$password, $this->getSecret());",
      "",
      "---------------"
    ]
  },
  "candidates": [
    {
      "candidate_hash": "eacf243dcd068885a5b839f8ddf13c22add72bbd",
      "candidate_info": {
        "commit_hash": "eacf243dcd068885a5b839f8ddf13c22add72bbd",
        "repo": "symfony/symfony",
        "commit_url": "https://github.com/symfony/symfony/commit/eacf243dcd068885a5b839f8ddf13c22add72bbd",
        "files": [
          "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
        ],
        "message": "[Security] Add a separator in the remember me cookie hash",
        "before_after_code_files": [
          "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_same_aad": 1,
        "olp_code_files": {
          "patch": [
            "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
          ],
          "candidate": [
            "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php": [
          "File: src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php -> src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "121:     protected function generateCookieHash($class, $username, $expires, $password)",
          "122:     {",
          "124:     }",
          "125: }",
          "",
          "[Removed Lines]",
          "123:         return hash_hmac('sha256', $class.$username.$expires.$password, $this->getSecret());",
          "",
          "[Added Lines]",
          "123:         return hash_hmac('sha256', $class.self::COOKIE_DELIMITER.$username.self::COOKIE_DELIMITER.$expires.self::COOKIE_DELIMITER.$password, $this->getSecret());",
          "",
          "---------------"
        ]
      }
    },
    {
      "candidate_hash": "938b21a72e847fe4fdb762299a1b761c89bba56e",
      "candidate_info": {
        "commit_hash": "938b21a72e847fe4fdb762299a1b761c89bba56e",
        "repo": "symfony/symfony",
        "commit_url": "https://github.com/symfony/symfony/commit/938b21a72e847fe4fdb762299a1b761c89bba56e",
        "files": [
          "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
        ],
        "message": "security #cve-2019-10911 [Security] Add a separator in the remember me cookie hash (pborreli)\n\nThis PR was merged into the 2.8 branch.\n\nDiscussion\n----------\n\n[Security] Add a separator in the remember me cookie hash\n\nBased on #89\n\nCommits\n-------\n\n9044e3b65d [Security] Add a separator in the remember me cookie hash",
        "before_after_code_files": [
          "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
        ]
      },
      "candidate_patch_features": {
        "candidate_earlier_than_patch": 0,
        "diff_branch_olp_changes": 1,
        "olp_code_files": {
          "patch": [
            "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
          ],
          "candidate": [
            "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php"
          ]
        }
      },
      "candidate_diff": {
        "src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php||src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php": [
          "File: src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php -> src/Symfony/Component/Security/Http/RememberMe/TokenBasedRememberMeServices.php",
          "--- Hunk 1 ---",
          "[Context before]",
          "121:     protected function generateCookieHash($class, $username, $expires, $password)",
          "122:     {",
          "124:     }",
          "125: }",
          "",
          "[Removed Lines]",
          "123:         return hash_hmac('sha256', $class.$username.$expires.$password, $this->getSecret());",
          "",
          "[Added Lines]",
          "123:         return hash_hmac('sha256', $class.self::COOKIE_DELIMITER.$username.self::COOKIE_DELIMITER.$expires.self::COOKIE_DELIMITER.$password, $this->getSecret());",
          "",
          "---------------"
        ]
      }
    }
  ]
}